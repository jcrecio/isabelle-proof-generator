{"file_name": "/home/qj213/afp-2021-10-22/thys/Approximation_Algorithms/Approx_BP_Hoare.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Approximation_Algorithms", "problem_names": ["lemma wrap_card:\n  \"card (wrap B) \\<le> 1\"", "lemma pairwise_disjnt_Un:\n  assumes \"pairwise disjnt ({M} \\<union> {N} \\<union> V)\" \"M \\<notin> V\" \"N \\<notin> V\"\n  shows \"pairwise disjnt ({M \\<union> N} \\<union> V)\"", "lemma bpE:\n  assumes \"bp P\"\n  shows \"pairwise disjnt P\" \"{} \\<notin> P\" \"\\<Union>P = U\" \"\\<forall>B \\<in> P. W(B) \\<le> c\"", "lemma bpI:\n  assumes \"pairwise disjnt P\" \"{} \\<notin> P\" \"\\<Union>P = U\" \"\\<forall>B \\<in> P. W(B) \\<le> c\"\n  shows \"bp P\"", "lemma S_L_set_generation:\n\"VARS S L W u\n  {True}\n  S := {}; L := {}; W := U;\n  WHILE W \\<noteq> {}\n  INV {W \\<subseteq> U \\<and> S = {v \\<in> U - W. w(v) \\<le> c / 2} \\<and> L = {v \\<in> U - W. w(v) > c / 2}} DO\n    u := (SOME u. u \\<in> W);\n    IF 2 * w(u) \\<le> c\n    THEN S := S \\<union> {u}\n    ELSE L := L \\<union> {u} FI;\n    W := W - {u}\n  OD\n  {S = {v \\<in> U. w(v) \\<le> c / 2} \\<and> L = {v \\<in> U. w(v) > c / 2}}\"", "lemma inv\\<^sub>1E:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n  shows \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\"\n    and \"\\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V\"\n    and \"B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\"\n    and \"B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2)\"\n    and \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\"", "lemma inv\\<^sub>1I:\n  assumes \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\"\n    and \"\\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V\"\n    and \"B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\"\n    and \"B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2)\"\n    and \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"", "lemma wrap_Un [simp]: \"wrap (M \\<union> {x}) = {M \\<union> {x}}\"", "lemma wrap_empty [simp]: \"wrap {} = {}\"", "lemma wrap_not_empty [simp]: \"M \\<noteq> {} \\<longleftrightarrow> wrap M = {M}\"", "lemma inv\\<^sub>1_stepA:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\" \"W(B\\<^sub>1) + w(u) \\<le> c\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (V - {u})\"", "lemma inv\\<^sub>1_stepB:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\" \"W B\\<^sub>2 + w u \\<le> c\"\n  shows \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\"", "lemma inv\\<^sub>1_stepC:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\"\n  shows \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\"", "lemma simple_bp_correct:\n\"VARS P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u\n  {True}\n  P\\<^sub>1 := {}; P\\<^sub>2 := {}; B\\<^sub>1 := {}; B\\<^sub>2 := {}; V := U;\n  WHILE V \\<inter> S \\<noteq> {} INV {inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V} DO\n    u := (SOME u. u \\<in> V); V := V - {u};\n    IF W(B\\<^sub>1) + w(u) \\<le> c\n    THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u}\n    ELSE IF W(B\\<^sub>2) + w(u) \\<le> c\n         THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u}\n         ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2; B\\<^sub>2 := {u} FI;\n         P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1; B\\<^sub>1 := {} FI\n  OD;\n  P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} | v. v \\<in> V}\n  {bp P}\"", "lemma bp_bins_finite [simp]:\n  assumes \"bp P\"\n  shows \"\\<forall>B \\<in> P. finite B\"", "lemma bp_sol_finite [simp]:\n  assumes \"bp P\"\n  shows \"finite P\"", "lemma only_one_L_per_bin:\n  assumes \"bp P\" \"B \\<in> P\"\n  shows \"\\<forall>x \\<in> B. \\<forall>y \\<in> B. x \\<noteq> y \\<longrightarrow> x \\<notin> L \\<or> y \\<notin> L\"", "lemma L_lower_bound_card:\n  assumes \"bp P\"\n  shows \"card L \\<le> card P\"", "lemma subset_bp_card:\n  assumes \"bp P\" \"M \\<subseteq> P\" \"\\<forall>B \\<in> M. B \\<inter> L \\<noteq> {}\"\n  shows \"card M \\<le> card L\"", "lemma L_bins_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"\\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L}) \\<le> card P\"", "lemma sum_Un_eq_sum_sum:\n  assumes \"bp P\"\n  shows \"(\\<Sum>u \\<in> U. w u) = (\\<Sum>B \\<in> P. W B)\"", "lemma sum_lower_bound_card:\n  assumes \"bp P\"\n  shows \"(\\<Sum>u \\<in> U. w u) \\<le> c * card P\"", "lemma bp_NE:\n  assumes \"bp P\"\n  shows \"P \\<noteq> {}\"", "lemma sum_Un_ge:\n  fixes f :: \"_ \\<Rightarrow> real\"\n  assumes \"finite M\" \"finite N\" \"\\<forall>B \\<in> M \\<union> N. 0 < f B\"\n  shows \"sum f M \\<le> sum f (M \\<union> N)\"", "lemma P\\<^sub>1_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"card P\\<^sub>1 + 1 \\<le> card P\"", "lemma P\\<^sub>1_B\\<^sub>1_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\"", "lemma P\\<^sub>2_B\\<^sub>2_lower_bound_P\\<^sub>1:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\"", "lemma inv\\<^sub>2E:\n  assumes \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n    and \"V \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\"\n    and \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n    and \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\"", "lemma inv\\<^sub>2I:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n    and \"V \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\"\n    and \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n    and \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\"\n  shows \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"", "lemma bin_packing_lower_bound_card:\n  assumes \"V \\<inter> S = {}\" \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"bp P\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}) \\<le> 3 / 2 * card P\"", "lemma inv\\<^sub>3E:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n  shows \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" and \"B\\<^sub>2 \\<subseteq> S\"", "lemma inv\\<^sub>3I:\n  assumes \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" and \"B\\<^sub>2 \\<subseteq> S\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"", "lemma loop_init:\n  \"inv\\<^sub>3 {} {} {} {} U\"", "lemma loop_stepA:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 = {}\" \"V \\<inter> L = {}\" \"u \\<in> V \\<inter> S\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\"", "lemma loop_stepB:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 = {}\" \"u \\<in> V \\<inter> L\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\"", "lemma loop_stepC:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> V \\<inter> S\" \"W B\\<^sub>1 + w(u) \\<le> c\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (V - {u})\"", "lemma loop_stepD:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> V \\<inter> S\" \"W B\\<^sub>1 + w(u) > c\" \"W B\\<^sub>2 + w(u) \\<le> c\"\n  shows \"inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\"", "lemma B\\<^sub>2_at_least_two_objects:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V \\<inter> S\" \"W B\\<^sub>2 + w(u) > c\"\n  shows \"2 \\<le> card B\\<^sub>2\"", "lemma loop_stepE:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> V \\<inter> S\" \"W B\\<^sub>1 + w(u) > c\" \"W B\\<^sub>2 + w(u) > c\"\n  shows \"inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\"", "lemma bp_approx:\n\"VARS P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u\n  {True}\n  P\\<^sub>1 := {}; P\\<^sub>2 := {}; B\\<^sub>1 := {}; B\\<^sub>2 := {}; V := U;\n  WHILE V \\<inter> S \\<noteq> {} INV {inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V} DO \n    IF B\\<^sub>1 \\<noteq> {}\n    THEN u := (SOME u. u \\<in> V \\<inter> S)\n    ELSE IF V \\<inter> L \\<noteq> {}\n         THEN u := (SOME u. u \\<in> V \\<inter> L)\n         ELSE u := (SOME u. u \\<in> V \\<inter> S) FI FI;\n    V := V - {u};\n    IF W(B\\<^sub>1) + w(u) \\<le> c\n    THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u}\n    ELSE IF W(B\\<^sub>2) + w(u) \\<le> c\n         THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u}\n         ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2; B\\<^sub>2 := {u} FI;\n         P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1; B\\<^sub>1 := {} FI\n  OD;\n  P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} | v. v \\<in> V}\n  {bp P \\<and> (\\<forall>Q. bp Q \\<longrightarrow> card P \\<le> 3 / 2 * card Q)}\"", "lemma bpE:\n  assumes \"bp P\"\n  shows \"pairwise disjnt P\" \"{} \\<notin> P\" \"\\<Union>P = U\" \"\\<forall>B \\<in> P. W(B) \\<le> c\"", "lemma bpI:\n  assumes \"pairwise disjnt P\" \"{} \\<notin> P\" \"\\<Union>P = U\" \"\\<forall>B \\<in> P. W(B) \\<le> c\"\n  shows \"bp P\"", "lemma inv\\<^sub>1E:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n  shows \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\"\n    and \"\\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V\"\n    and \"B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\"\n    and \"B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2)\"\n    and \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\"", "lemma inv\\<^sub>1I:\n  assumes \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\"\n    and \"\\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V\"\n    and \"B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\"\n    and \"B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2)\"\n    and \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"", "lemma wrap_Un [simp]: \"wrap (M \\<union> {x}) = {M \\<union> {x}}\"", "lemma wrap_empty [simp]: \"wrap {} = {}\"", "lemma wrap_not_empty [simp]: \"M \\<noteq> {} \\<longleftrightarrow> wrap M = {M}\"", "lemma inv\\<^sub>1_stepA:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\" \"W(B\\<^sub>1) + w(u) \\<le> c\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (V - {u})\"", "lemma inv\\<^sub>1_stepB:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\" \"W B\\<^sub>2 + w u \\<le> c\"\n  shows \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\"", "lemma inv\\<^sub>1_stepC:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\"\n  shows \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\"", "lemma bp_bins_finite [simp]:\n  assumes \"bp P\"\n  shows \"\\<forall>B \\<in> P. finite B\"", "lemma bp_sol_finite [simp]:\n  assumes \"bp P\"\n  shows \"finite P\"", "lemma only_one_L_per_bin:\n  assumes \"bp P\" \"B \\<in> P\"\n  shows \"\\<forall>x \\<in> B. \\<forall>y \\<in> B. x \\<noteq> y \\<longrightarrow> x \\<notin> L\\<^sub>U \\<or> y \\<notin> L\\<^sub>U\"", "lemma L_lower_bound_card:\n  assumes \"bp P\"\n  shows \"card L\\<^sub>U \\<le> card P\"", "lemma subset_bp_card:\n  assumes \"bp P\" \"M \\<subseteq> P\" \"\\<forall>B \\<in> M. B \\<inter> L\\<^sub>U \\<noteq> {}\"\n  shows \"card M \\<le> card L\\<^sub>U\"", "lemma L_bins_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\" \"\\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {}\"\n      and SL_def: \"SL S L\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) \\<le> card P\"", "lemma sum_Un_eq_sum_sum:\n  assumes \"bp P\"\n  shows \"(\\<Sum>u \\<in> U. w u) = (\\<Sum>B \\<in> P. W B)\"", "lemma sum_lower_bound_card:\n  assumes \"bp P\"\n  shows \"(\\<Sum>u \\<in> U. w u) \\<le> c * card P\"", "lemma bp_NE:\n  assumes \"bp P\"\n  shows \"P \\<noteq> {}\"", "lemma sum_Un_ge:\n  fixes f :: \"_ \\<Rightarrow> real\"\n  assumes \"finite M\" \"finite N\" \"\\<forall>B \\<in> M \\<union> N. 0 < f B\"\n  shows \"sum f M \\<le> sum f (M \\<union> N)\"", "lemma P\\<^sub>1_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"card P\\<^sub>1 + 1 \\<le> card P\"", "lemma P\\<^sub>1_B\\<^sub>1_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\"", "lemma P\\<^sub>2_B\\<^sub>2_lower_bound_P\\<^sub>1:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\" \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\"", "lemma inv\\<^sub>2E:\n  assumes \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\"\n    and \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {}\"\n    and \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n    and \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\"\n    and \"SL S L\"", "lemma inv\\<^sub>2I:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\"\n    and \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {}\"\n    and \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n    and \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\"\n    and \"SL S L\"\n  shows \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\"", "lemma bin_packing_lower_bound_card:\n  assumes \"S = {}\" \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"bp P\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> S \\<union> L}) \\<le> 3 / 2 * card P\"", "lemma inv\\<^sub>3E:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\"\n  shows \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" and \"B\\<^sub>2 \\<subseteq> S\\<^sub>U\"", "lemma inv\\<^sub>3I:\n  assumes \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" and \"B\\<^sub>2 \\<subseteq> S\\<^sub>U\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\"", "lemma loop_init:\n  \"inv\\<^sub>3 {} {} {} {} S\\<^sub>U L\\<^sub>U\"", "lemma loop_stepA:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 = {}\" \"L = {}\" \"u \\<in> S\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L\"", "lemma loop_stepB:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 = {}\" \"u \\<in> L\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})\"", "lemma loop_stepC:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> S\" \"W B\\<^sub>1 + w(u) \\<le> c\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (S - {u}) L\"", "lemma loop_stepD:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> S\" \"W B\\<^sub>1 + w(u) > c\" \"W B\\<^sub>2 + w(u) \\<le> c\"\n  shows \"inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (S - {u}) L\"", "lemma B\\<^sub>2_at_least_two_objects:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"u \\<in> S\" \"W B\\<^sub>2 + w(u) > c\"\n  shows \"2 \\<le> card B\\<^sub>2\"", "lemma loop_stepE:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> S\" \"W B\\<^sub>1 + w(u) > c\" \"W B\\<^sub>2 + w(u) > c\"\n  shows \"inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\"", "lemma bp_approx:\n\"VARS P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u\n  {True}\n  S := {}; L:= {}; V := U;\n  WHILE V \\<noteq> {} INV {V \\<subseteq> U \\<and> S = {u \\<in> U - V. w(u) \\<le> c / 2} \\<and> L = {u \\<in> U - V. c / 2 < w(u)}} DO\n    u := (SOME u. u \\<in> V);\n    IF w(u) \\<le> c / 2\n    THEN S := S \\<union> {u}\n    ELSE L := L \\<union> {u} FI;\n    V := V - {u}\n  OD;\n  P\\<^sub>1 := {}; P\\<^sub>2 := {}; B\\<^sub>1 := {}; B\\<^sub>2 := {};\n  WHILE S \\<noteq> {} INV {inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L} DO \n    IF B\\<^sub>1 \\<noteq> {}\n    THEN u := (SOME u. u \\<in> S); S := S - {u}\n    ELSE IF L \\<noteq> {}\n         THEN u := (SOME u. u \\<in> L); L := L - {u}\n         ELSE u := (SOME u. u \\<in> S); S := S - {u} FI FI;\n    IF W(B\\<^sub>1) + w(u) \\<le> c\n    THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u}\n    ELSE IF W(B\\<^sub>2) + w(u) \\<le> c\n         THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u}\n         ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2; B\\<^sub>2 := {u} FI;\n         P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1; B\\<^sub>1 := {} FI\n  OD;\n  P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2; V := L;\n  WHILE V \\<noteq> {}\n  INV {S = {} \\<and> inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and> V \\<subseteq> L \\<and> P = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v}|v. v \\<in> L - V}} DO\n    u := (SOME u. u \\<in> V); P := P \\<union> {{u}}; V := V - {u}\n  OD\n  {bp P \\<and> (\\<forall>Q. bp Q \\<longrightarrow> card P \\<le> 3 / 2 * card Q)}\""], "translations": [["", "lemma wrap_card:\n  \"card (wrap B) \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (wrap B) \\<le> 1", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. card (if B = {} then {} else {B}) \\<le> 1", "by auto"], ["", "text \\<open>If \\<open>M\\<close> and \\<open>N\\<close> are pairwise disjoint with \\<open>V\\<close> and not yet contained in V,\n      then the union of \\<open>M\\<close> and \\<open>N\\<close> is also pairwise disjoint with \\<open>V\\<close>.\\<close>"], ["", "lemma pairwise_disjnt_Un:\n  assumes \"pairwise disjnt ({M} \\<union> {N} \\<union> V)\" \"M \\<notin> V\" \"N \\<notin> V\"\n  shows \"pairwise disjnt ({M \\<union> N} \\<union> V)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint ({M \\<union> N} \\<union> V)", "using assms"], ["proof (prove)\nusing this:\n  disjoint ({M} \\<union> {N} \\<union> V)\n  M \\<notin> V\n  N \\<notin> V\n\ngoal (1 subgoal):\n 1. disjoint ({M \\<union> N} \\<union> V)", "unfolding pairwise_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{M} \\<union> {N} \\<union> V.\n     \\<forall>y\\<in>{M} \\<union> {N} \\<union> V.\n        x \\<noteq> y \\<longrightarrow> disjnt x y\n  M \\<notin> V\n  N \\<notin> V\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{M \\<union> N} \\<union> V.\n       \\<forall>y\\<in>{M \\<union> N} \\<union> V.\n          x \\<noteq> y \\<longrightarrow> disjnt x y", "by auto"], ["", "text \\<open>A Bin Packing Problem is defined like in the article:\\<close>"], ["", "locale BinPacking =\n  fixes U :: \"'a set\" \\<comment> \\<open>A finite, non-empty set of objects\\<close>\n    and w :: \"'a \\<Rightarrow> real\" \\<comment> \\<open>A mapping from objects to their respective weights (positive real numbers)\\<close>\n    and c :: nat \\<comment> \\<open>The maximum capacity of a bin (a natural number)\\<close>\n    and S :: \"'a set\" \\<comment> \\<open>The set of \\<open>small\\<close> objects (weight no larger than \\<open>1/2\\<close> of \\<open>c\\<close>)\\<close>\n    and L :: \"'a set\" \\<comment> \\<open>The set of \\<open>large\\<close> objects (weight larger than \\<open>1/2\\<close> of \\<open>c\\<close>)\\<close>\n  assumes weight: \"\\<forall>u \\<in> U. 0 < w(u) \\<and> w(u) \\<le> c\"\n      and U_Finite: \"finite U\"\n      and U_NE: \"U \\<noteq> {}\"\n      and S_def: \"S = {u \\<in> U. w(u) \\<le> c / 2}\"\n      and L_def: \"L = U - S\"\nbegin"], ["", "text \\<open>In the article, this is defined as \\<open>w\\<close> as well. However, to avoid ambiguity,\n      we will abbreviate the weight of a bin as \\<open>W\\<close>.\\<close>"], ["", "abbreviation W :: \"'a set \\<Rightarrow> real\" where\n  \"W B \\<equiv> (\\<Sum>u \\<in> B. w(u))\""], ["", "text \\<open>\\<open>P\\<close> constitutes as a correct bin packing if \\<open>P\\<close> is a partition of \\<open>U\\<close>\n      (as defined in @{thm [source] partition_on_def}) and the weights of\n      the bins do not exceed their maximum capacity \\<open>c\\<close>.\\<close>"], ["", "definition bp :: \"'a set set \\<Rightarrow> bool\" where\n  \"bp P \\<longleftrightarrow> partition_on U P \\<and> (\\<forall>B \\<in> P. W(B) \\<le> c)\""], ["", "lemma bpE:\n  assumes \"bp P\"\n  shows \"pairwise disjnt P\" \"{} \\<notin> P\" \"\\<Union>P = U\" \"\\<forall>B \\<in> P. W(B) \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (disjoint P &&& {} \\<notin> P) &&&\n    \\<Union> P = U &&& \\<forall>B\\<in>P. W B \\<le> real c", "using assms"], ["proof (prove)\nusing this:\n  bp P\n\ngoal (1 subgoal):\n 1. (disjoint P &&& {} \\<notin> P) &&&\n    \\<Union> P = U &&& \\<forall>B\\<in>P. W B \\<le> real c", "unfolding bp_def partition_on_def"], ["proof (prove)\nusing this:\n  (\\<Union> P = U \\<and> disjoint P \\<and> {} \\<notin> P) \\<and>\n  (\\<forall>B\\<in>P. W B \\<le> real c)\n\ngoal (1 subgoal):\n 1. (disjoint P &&& {} \\<notin> P) &&&\n    \\<Union> P = U &&& \\<forall>B\\<in>P. W B \\<le> real c", "by blast+"], ["", "lemma bpI:\n  assumes \"pairwise disjnt P\" \"{} \\<notin> P\" \"\\<Union>P = U\" \"\\<forall>B \\<in> P. W(B) \\<le> c\"\n  shows \"bp P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bp P", "using assms"], ["proof (prove)\nusing this:\n  disjoint P\n  {} \\<notin> P\n  \\<Union> P = U\n  \\<forall>B\\<in>P. W B \\<le> real c\n\ngoal (1 subgoal):\n 1. bp P", "unfolding bp_def partition_on_def"], ["proof (prove)\nusing this:\n  disjoint P\n  {} \\<notin> P\n  \\<Union> P = U\n  \\<forall>B\\<in>P. W B \\<le> real c\n\ngoal (1 subgoal):\n 1. (\\<Union> P = U \\<and> disjoint P \\<and> {} \\<notin> P) \\<and>\n    (\\<forall>B\\<in>P. W B \\<le> real c)", "by blast"], ["", "text \\<open>Although we assume the \\<open>S\\<close> and \\<open>L\\<close> sets as given, manually obtaining them from \\<open>U\\<close> is trivial\n      and can be achieved in linear time. Proposed by the article @{cite \"BerghammerR03\"}.\\<close>"], ["", "lemma S_L_set_generation:\n\"VARS S L W u\n  {True}\n  S := {}; L := {}; W := U;\n  WHILE W \\<noteq> {}\n  INV {W \\<subseteq> U \\<and> S = {v \\<in> U - W. w(v) \\<le> c / 2} \\<and> L = {v \\<in> U - W. w(v) > c / 2}} DO\n    u := (SOME u. u \\<in> W);\n    IF 2 * w(u) \\<le> c\n    THEN S := S \\<union> {u}\n    ELSE L := L \\<union> {u} FI;\n    W := W - {u}\n  OD\n  {S = {v \\<in> U. w(v) \\<le> c / 2} \\<and> L = {v \\<in> U. w(v) > c / 2}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {True} \n     S := {};\n     L := {};\n     W := U;\n     WHILE W \\<noteq> {}\n      INV {W \\<subseteq> U \\<and>\n           S = {v \\<in> U - W. w v \\<le> real c / 2} \\<and>\n           L = {v \\<in> U - W. real c / 2 < w v}} \n      VAR {\\<lambda>(S, L, W, u). 0} \n      DO u := (SOME u. u \\<in> W);\n         IF 2 * w u \\<le> real c THEN S := S \\<union> {u} \n          ELSE L := L \\<union> {u} FI;\n         W := W - {u} \n      OD \n     {S = {v \\<in> U. w v \\<le> real c / 2} \\<and>\n      L = {v \\<in> U. real c / 2 < w v}}", "by vcg (auto simp: some_in_eq)"], ["", "subsection \\<open>The Proposed Approximation Algorithm\\<close>"], ["", "subsubsection \\<open>Functional Correctness\\<close>"], ["", "text \\<open>According to the article, \\<open>inv\\<^sub>1\\<close> holds if \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}\\<close>\n      is a correct solution for the bin packing problem @{cite BerghammerR03}. However, various\n      assumptions made in the article seem to suggest that more information is demanded from this\n      invariant and, indeed, mere correctness (as defined in @{thm [source] bp_def}) does not appear to suffice.\n      To amend this, four additional conjuncts have been added to this invariant, whose necessity\n      will be explained in the following proofs. It should be noted that there may be other (shorter) ways to amend this invariant.\n      This approach, however, makes for rather straight-forward proofs, as these conjuncts can be utilized and proved in relatively few steps.\\<close>"], ["", "definition inv\\<^sub>1 :: \"'a set set \\<Rightarrow> 'a set set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> bool\" where\n  \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<longleftrightarrow> bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}) \\<comment> \\<open>A correct solution to the bin packing problem\\<close>\n                       \\<and> \\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V \\<comment> \\<open>The partial solution does not contain objects that have not yet been assigned\\<close>\n                       \\<and> B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<comment> \\<open>\\<open>B\\<^sub>1\\<close> is distinct from all the other bins\\<close>\n                       \\<and> B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2) \\<comment> \\<open>\\<open>B\\<^sub>2\\<close> is distinct from all the other bins\\<close>\n                       \\<and> (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {} \\<comment> \\<open>The first and second partial solutions are disjoint from each other.\\<close>\""], ["", "(*\nlemma \"partition_on U (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}) \\<Longrightarrow> u \\<in> V \\<Longrightarrow>\npartition_on U (P\\<^sub>1 \\<union> wrap (insert u B\\<^sub>1) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> (V-{u})})\"\n  nitpick*)"], ["", "lemma inv\\<^sub>1E:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n  shows \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\"\n    and \"\\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V\"\n    and \"B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\"\n    and \"B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2)\"\n    and \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n         wrap B\\<^sub>2 \\<union>\n         {{v} |v. v \\<in> V}) &&&\n     \\<Union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2) =\n     U - V) &&&\n    B\\<^sub>1\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 &&&\n    B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 &&&\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n\ngoal (1 subgoal):\n 1. (bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n         wrap B\\<^sub>2 \\<union>\n         {{v} |v. v \\<in> V}) &&&\n     \\<Union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2) =\n     U - V) &&&\n    B\\<^sub>1\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 &&&\n    B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 &&&\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "unfolding inv\\<^sub>1_def"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}) \\<and>\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V \\<and>\n  B\\<^sub>1\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<and>\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<and>\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. (bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n         wrap B\\<^sub>2 \\<union>\n         {{v} |v. v \\<in> V}) &&&\n     \\<Union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2) =\n     U - V) &&&\n    B\\<^sub>1\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 &&&\n    B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 &&&\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "by auto"], ["", "lemma inv\\<^sub>1I:\n  assumes \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\"\n    and \"\\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V\"\n    and \"B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\"\n    and \"B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2)\"\n    and \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", "using assms"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", "unfolding inv\\<^sub>1_def"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}) \\<and>\n    \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) =\n    U - V \\<and>\n    B\\<^sub>1\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<and>\n    B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<and>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "by blast"], ["", "lemma wrap_Un [simp]: \"wrap (M \\<union> {x}) = {M \\<union> {x}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wrap (M \\<union> {x}) = {M \\<union> {x}}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if M \\<union> {x} = {} then {} else {M \\<union> {x}}) =\n    {M \\<union> {x}}", "by simp"], ["", "lemma wrap_empty [simp]: \"wrap {} = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wrap {} = {}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if {} = {} then {} else {{}}) = {}", "by simp"], ["", "lemma wrap_not_empty [simp]: \"M \\<noteq> {} \\<longleftrightarrow> wrap M = {M}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (M \\<noteq> {}) = (wrap M = {M})", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (M \\<noteq> {}) = ((if M = {} then {} else {M}) = {M})", "by simp"], ["", "text \\<open>If \\<open>inv\\<^sub>1\\<close> holds for the current partial solution, and the weight of an object \\<open>u \\<in> V\\<close> added to \\<open>B\\<^sub>1\\<close> does\n      not exceed its capacity, then \\<open>inv\\<^sub>1\\<close> also holds if \\<open>B\\<^sub>1\\<close> and \\<open>{u}\\<close> are replaced by \\<open>B\\<^sub>1 \\<union> {u}\\<close>.\\<close>"], ["", "lemma inv\\<^sub>1_stepA:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\" \"W(B\\<^sub>1) + w(u) \\<le> c\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "note invrules = inv\\<^sub>1E[OF assms(1)] and bprules = bpE[OF invrules(1)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "text \\<open>In the proof for \\<open>Theorem 3.2\\<close> of the article it is erroneously argued that\n        if \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}\\<close> is a partition of \\<open>U\\<close>,\n        then the same holds if \\<open>B\\<^sub>1\\<close> is replaced by \\<open>B\\<^sub>1 \\<union> {u}\\<close>.\n        This is, however, not necessarily the case if \\<open>B\\<^sub>1\\<close> or \\<open>{u}\\<close> are already contained in the partial solution.\n        Suppose \\<open>P\\<^sub>1\\<close> contains the non-empty bin \\<open>B\\<^sub>1\\<close>, then \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1\\<close> would still be pairwise disjoint, provided \\<open>P\\<^sub>1\\<close> was pairwise disjoint before, as the union simply ignores the duplicate \\<open>B\\<^sub>1\\<close>. Now, if the algorithm modifies \\<open>B\\<^sub>1\\<close> by adding an element from \\<open>V\\<close> such that \\<open>B\\<^sub>1\\<close> becomes some non-empty \\<open>B\\<^sub>1'\\<close> with \\<open>B\\<^sub>1 \\<inter> B\\<^sub>1' \\<noteq> \\<emptyset>\\<close> and \\<open>B\\<^sub>1' \\<notin> P\\<^sub>1\\<close>, one can see that this property would no longer be preserved.\n        To avoid such a situation, we will use the first additional conjunct in \\<open>inv\\<^sub>1\\<close> to ensure that \\<open>{u}\\<close>\n        is not yet contained in the partial solution, and the second additional conjunct to ensure that \\<open>B\\<^sub>1\\<close>\n        is not yet contained in the partial solution.\\<close>\n\n  \\<comment> \\<open>Rule 1: Pairwise Disjoint\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have NOTIN: \"\\<forall>M \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. u \\<notin> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "using invrules(2) assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "by blast"], ["proof (state)\nthis:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"{{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "using assms(2)"], ["proof (prove)\nusing this:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "by blast"], ["proof (state)\nthis:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "have \"pairwise disjnt (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))", "using bprules(1) assms(2)"], ["proof (prove)\nusing this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))", "have \"pairwise disjnt (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})", "by (simp add: Un_commute)"], ["proof (state)\nthis:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}})", "have assm: \"pairwise disjnt (wrap B\\<^sub>1 \\<union> {{u}} \\<union> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. disjoint\n     (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by (simp add: Un_assoc)"], ["proof (state)\nthis:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"pairwise disjnt ({B\\<^sub>1 \\<union> {u}} \\<union> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "proof (cases \\<open>B\\<^sub>1 = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. B\\<^sub>1 = {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))\n 2. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "case True"], ["proof (state)\nthis:\n  B\\<^sub>1 = {}\n\ngoal (2 subgoals):\n 1. B\\<^sub>1 = {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))\n 2. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "with assm"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>1 = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>1 = {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "case False"], ["proof (state)\nthis:\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "with assm"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>1 \\<noteq> {}", "have assm: \"pairwise disjnt ({B\\<^sub>1} \\<union> {{u}} \\<union> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1} \\<union> {{u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>1} \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "from NOTIN"], ["proof (chain)\npicking this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M", "have \"{u} \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. {u}\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n             {{v} |v. v \\<in> V - {u}}", "by blast"], ["proof (state)\nthis:\n  {u}\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "from pairwise_disjnt_Un[OF assm _ this] invrules(2,3)"], ["proof (chain)\npicking this:\n  B\\<^sub>1\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>1\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "using False"], ["proof (prove)\nusing this:\n  B\\<^sub>1\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by auto"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))", "have 1: \"pairwise disjnt (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> {B\\<^sub>1 \\<union> {u}} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})", "by simp\n\n  \\<comment> \\<open>Rule 2: No empty sets\\<close>"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from bprules(2)"], ["proof (chain)\npicking this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}", "have 2: \"{} \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n                P\\<^sub>2 \\<union>\n                wrap B\\<^sub>2 \\<union>\n                {{v} |v. v \\<in> V - {u}}", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union>\n              (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n              P\\<^sub>2 \\<union>\n              (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n              {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union>\n                (if B\\<^sub>1 \\<union> {u} = {} then {}\n                 else {B\\<^sub>1 \\<union> {u}}) \\<union>\n                P\\<^sub>2 \\<union>\n                (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n                {{v} |v. v \\<in> V - {u}}", "by simp\n\n  \\<comment> \\<open>Rule 3: Union preserved\\<close>"], ["proof (state)\nthis:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n              P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from bprules(3)"], ["proof (chain)\npicking this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U", "have \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}} \\<union> {{v} |v. v \\<in> V - {u}}) = U\""], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "using assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "by blast"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U", "have 3: \"\\<Union> (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}) = U\""], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n    P\\<^sub>2 \\<union>\n    (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 \\<union> {u} = {} then {}\n       else {B\\<^sub>1 \\<union> {u}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "by force\n\n  \\<comment> \\<open>Rule 4: Weights below capacity\\<close>"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"0 < w u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < w u", "using weight assms(2) bprules(3)"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. 0 < w u", "by blast"], ["proof (state)\nthis:\n  0 < w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"finite B\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>1", "using bprules(3) U_Finite"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  finite U\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>1", "by (cases \\<open>B\\<^sub>1 = {}\\<close>) auto"], ["proof (state)\nthis:\n  finite B\\<^sub>1\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  finite B\\<^sub>1", "have \"W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u\""], ["proof (prove)\nusing this:\n  finite B\\<^sub>1\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u", "using \\<open>0 < w u\\<close>"], ["proof (prove)\nusing this:\n  finite B\\<^sub>1\n  0 < w u\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u", "by (cases \\<open>u \\<in> B\\<^sub>1\\<close>) (auto simp: insert_absorb)"], ["proof (state)\nthis:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "also"], ["proof (state)\nthis:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"... \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "using assms(3)"], ["proof (prove)\nusing this:\n  W B\\<^sub>1 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "."], ["proof (state)\nthis:\n  W B\\<^sub>1 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "finally"], ["proof (chain)\npicking this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c", "have \"W (B\\<^sub>1 \\<union> {u}) \\<le> c\""], ["proof (prove)\nusing this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>1 \\<union> {u}) \\<le> real c", "."], ["proof (state)\nthis:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c", "have \"\\<forall>B \\<in> wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> c\""], ["proof (prove)\nusing this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>{B\\<^sub>1 \\<union> {u}}. W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "moreover"], ["proof (state)\nthis:\n  \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"\\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. W B \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "using bprules(4)"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c", "have 4: \"\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. W B \\<le> c\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from bpI[OF 1 2 3 4]"], ["proof (chain)\npicking this:\n  bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})", "have 1: \"bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n        P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V - {u}})", ".\n\n  \\<comment> \\<open>Auxiliary information is preserved\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"u \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> U", "using assms(2) bprules(3)"], ["proof (prove)\nusing this:\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. u \\<in> U", "by blast"], ["proof (state)\nthis:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  u \\<in> U", "have R: \"U - (V - {u}) = U - V \\<union> {u}\""], ["proof (prove)\nusing this:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. U - (V - {u}) = U - V \\<union> {u}", "by blast"], ["proof (state)\nthis:\n  U - (V - {u}) = U - V \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have L: \"\\<Union> (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = \\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) =\n    \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) \\<union>\n    {u}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 \\<union> {u} = {} then {}\n       else {B\\<^sub>1 \\<union> {u}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n    {u}", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 \\<union> {u} = {} then {}\n       else {B\\<^sub>1 \\<union> {u}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n    {u}", "by auto"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) \\<union>\n  {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have 2: \"\\<Union> (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) =\n    U - (V - {u})", "unfolding L R invrules(2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. U - V \\<union> {u} = U - V \\<union> {u}", ".."], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have 3: \"B\\<^sub>1 \\<union> {u} \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<union> {u}\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<union> {u}\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2", "by auto"], ["proof (state)\nthis:\n  B\\<^sub>1 \\<union> {u}\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have 4: \"B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n             P\\<^sub>2", "using invrules(4) NOTIN"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n             P\\<^sub>2", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union>\n           (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n           P\\<^sub>2\n  \\<forall>M\\<in>P\\<^sub>1 \\<union>\n                 (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n                 P\\<^sub>2 \\<union>\n                 (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union>\n             (if B\\<^sub>1 \\<union> {u} = {} then {}\n              else {B\\<^sub>1 \\<union> {u}}) \\<union>\n             P\\<^sub>2", "by fastforce"], ["proof (state)\nthis:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n           P\\<^sub>2\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have 5: \"(P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u})) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u})) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "using invrules(5) NOTIN"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u})) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> {B\\<^sub>1 \\<union> {u}}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "by auto"], ["proof (state)\nthis:\n  (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u})) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from inv\\<^sub>1I[OF 1 2 3 4 5]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>inv\\<^sub>1\\<close> holds for the current partial solution, and the weight of an object \\<open>u \\<in> V\\<close> added to \\<open>B\\<^sub>2\\<close> does\n      not exceed its capacity, then \\<open>inv\\<^sub>1\\<close> also holds if \\<open>B\\<^sub>2\\<close> and \\<open>{u}\\<close> are replaced by \\<open>B\\<^sub>2 \\<union> {u}\\<close>.\\<close>"], ["", "lemma inv\\<^sub>1_stepB:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\" \"W B\\<^sub>2 + w u \\<le> c\"\n  shows \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "note invrules = inv\\<^sub>1E[OF assms(1)] and bprules = bpE[OF invrules(1)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "text \\<open>The argumentation here is similar to the one in @{thm [source] inv\\<^sub>1_stepA} with\n      \\<open>B\\<^sub>1\\<close> replaced with \\<open>B\\<^sub>2\\<close> and using the first and third additional conjuncts of \\<open>inv\\<^sub>1\\<close>\n      to amend the issue, instead of the first and second.\\<close>\n  \\<comment> \\<open>Rule 1: Pairwise Disjoint\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have NOTIN: \"\\<forall>M \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. u \\<notin> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "using invrules(2) assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "by blast"], ["proof (state)\nthis:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"{{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "using assms(2)"], ["proof (prove)\nusing this:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "by blast"], ["proof (state)\nthis:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "have \"pairwise disjnt (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}} \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}})", "using bprules(1) assms(2)"], ["proof (prove)\nusing this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}})", "by simp"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}})", "have assm: \"pairwise disjnt (wrap B\\<^sub>2 \\<union> {{u}} \\<union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. disjoint\n     (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by (simp add: Un_assoc Un_commute)"], ["proof (state)\nthis:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"pairwise disjnt ({B\\<^sub>2 \\<union> {u}} \\<union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "proof (cases \\<open>B\\<^sub>2 = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "case True"], ["proof (state)\nthis:\n  B\\<^sub>2 = {}\n\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "with assm"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>2 = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "case False"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "with assm"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>2 \\<noteq> {}", "have assm: \"pairwise disjnt ({B\\<^sub>2} \\<union> {{u}} \\<union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2} \\<union> {{u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>2} \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "from NOTIN"], ["proof (chain)\npicking this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M", "have \"{u} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n             {{v} |v. v \\<in> V - {u}}", "by blast"], ["proof (state)\nthis:\n  {u}\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "from pairwise_disjnt_Un[OF assm _ this] invrules(2,4)"], ["proof (chain)\npicking this:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "using False"], ["proof (prove)\nusing this:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by auto"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))", "have 1: \"pairwise disjnt (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}})", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      {B\\<^sub>2 \\<union> {u}} \\<union>\n      {{v} |v. v \\<in> V - {u}})", "by simp\n\n  \\<comment> \\<open>Rule 2: No empty sets\\<close>"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from bprules(2)"], ["proof (chain)\npicking this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}", "have 2: \"{} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n                P\\<^sub>2 \\<union>\n                wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n                {{v} |v. v \\<in> V - {u}}", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union>\n              (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n              P\\<^sub>2 \\<union>\n              (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n              {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union>\n                (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n                (if {} = {} then {} else {{}}) \\<union>\n                P\\<^sub>2 \\<union>\n                (if B\\<^sub>2 \\<union> {u} = {} then {}\n                 else {B\\<^sub>2 \\<union> {u}}) \\<union>\n                {{v} |v. v \\<in> V - {u}}", "by simp\n\n  \\<comment> \\<open>Rule 3: Union preserved\\<close>"], ["proof (state)\nthis:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n              P\\<^sub>2 \\<union>\n              wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n              {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from bprules(3)"], ["proof (chain)\npicking this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U", "have \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}} \\<union> {{v} |v. v \\<in> V - {u}}) = U\""], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "using assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "by blast"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U", "have 3: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}}) = U\""], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n    P\\<^sub>2 \\<union>\n    (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 \\<union> {u} = {} then {}\n       else {B\\<^sub>2 \\<union> {u}}) \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "by force\n\n  \\<comment> \\<open>Rule 4: Weights below capacity\\<close>"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"0 < w u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < w u", "using weight assms(2) bprules(3)"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. 0 < w u", "by blast"], ["proof (state)\nthis:\n  0 < w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"finite B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "using bprules(3) U_Finite"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  finite U\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "by (cases \\<open>B\\<^sub>2 = {}\\<close>) auto"], ["proof (state)\nthis:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  finite B\\<^sub>2", "have \"W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u\""], ["proof (prove)\nusing this:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u", "using \\<open>0 < w u\\<close>"], ["proof (prove)\nusing this:\n  finite B\\<^sub>2\n  0 < w u\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u", "by (cases \\<open>u \\<in> B\\<^sub>2\\<close>) (auto simp: insert_absorb)"], ["proof (state)\nthis:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "also"], ["proof (state)\nthis:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"... \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B\\<^sub>2 + w u \\<le> real c", "using assms(3)"], ["proof (prove)\nusing this:\n  W B\\<^sub>2 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. W B\\<^sub>2 + w u \\<le> real c", "."], ["proof (state)\nthis:\n  W B\\<^sub>2 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "finally"], ["proof (chain)\npicking this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c", "have \"W (B\\<^sub>2 \\<union> {u}) \\<le> c\""], ["proof (prove)\nusing this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>2 \\<union> {u}) \\<le> real c", "."], ["proof (state)\nthis:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c", "have \"\\<forall>B \\<in> wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> c\""], ["proof (prove)\nusing this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>{B\\<^sub>2 \\<union> {u}}. W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "moreover"], ["proof (state)\nthis:\n  \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. W B \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "using bprules(4)"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c", "have 4: \"\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}}. W B \\<le> c\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   wrap {} \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "by auto"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from bpI[OF 1 2 3 4]"], ["proof (chain)\npicking this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}})", "have 1: \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n        P\\<^sub>2 \\<union>\n        wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n        {{v} |v. v \\<in> V - {u}})", ".\n\n  \\<comment> \\<open>Auxiliary information is preserved\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"u \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> U", "using assms(2) bprules(3)"], ["proof (prove)\nusing this:\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. u \\<in> U", "by blast"], ["proof (state)\nthis:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  u \\<in> U", "have R: \"U - (V - {u}) = U - V \\<union> {u}\""], ["proof (prove)\nusing this:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. U - (V - {u}) = U - V \\<union> {u}", "by blast"], ["proof (state)\nthis:\n  U - (V - {u}) = U - V \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have L: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) = \\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) \\<union>\n    {u}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 \\<union> {u} = {} then {}\n       else {B\\<^sub>2 \\<union> {u}})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n    {u}", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 \\<union> {u} = {} then {}\n       else {B\\<^sub>2 \\<union> {u}})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n    {u}", "by auto"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) \\<union>\n  {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 2: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) = U - (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u})) =\n    U - (V - {u})", "unfolding L R"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) \\<union>\n    {u} =\n    U - V \\<union> {u}", "using invrules(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) \\<union>\n    {u} =\n    U - V \\<union> {u}", "by simp"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap (B\\<^sub>2 \\<union> {u})) =\n  U - (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 3: \"{} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                P\\<^sub>2 \\<union>\n                wrap (B\\<^sub>2 \\<union> {u})", "using bpE(2)[OF 1]"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n              P\\<^sub>2 \\<union>\n              wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n              {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                P\\<^sub>2 \\<union>\n                wrap (B\\<^sub>2 \\<union> {u})", "by simp"], ["proof (state)\nthis:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap (B\\<^sub>2 \\<union> {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 4: \"B\\<^sub>2 \\<union> {u} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<union> {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n             P\\<^sub>2", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<union> {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n             P\\<^sub>2", "by auto"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<union> {u}\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n           P\\<^sub>2\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 5: \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n    {}", "using invrules(5) NOTIN"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n    {}", "unfolding wrap_empty wrap_Un"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {}) \\<inter>\n    (P\\<^sub>2 \\<union> {B\\<^sub>2 \\<union> {u}}) =\n    {}", "by auto"], ["proof (state)\nthis:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n  (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from inv\\<^sub>1I[OF 1 2 3 4 5]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>inv\\<^sub>1\\<close> holds for the current partial solution, then \\<open>inv\\<^sub>1\\<close> also holds if \\<open>B\\<^sub>1\\<close> and \\<open>B\\<^sub>2\\<close> are\n      added to \\<open>P\\<^sub>1\\<close> and \\<open>P\\<^sub>2\\<close> respectively, \\<open>B\\<^sub>1\\<close> is emptied and \\<open>B\\<^sub>2\\<close> initialized with \\<open>u \\<in> V\\<close>.\\<close>"], ["", "lemma inv\\<^sub>1_stepC:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\"\n  shows \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "note invrules = inv\\<^sub>1E[OF assms(1)]\n  \\<comment> \\<open>Rule 1-4: Correct Bin Packing\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u} \\<union> {{v} |v. v \\<in> V - {u}}\n      = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n    wrap {u} \\<union>\n    {{v} |v. v \\<in> V - {u}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}", "by (metis (no_types, lifting) Un_assoc Un_empty_right insert_not_empty wrap_empty wrap_not_empty)"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{u}} \\<union>\n  {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "also"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{u}} \\<union>\n  {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"... = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}", "using assms(2)"], ["proof (prove)\nusing this:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}", "by auto"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{u}} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "finally"], ["proof (chain)\npicking this:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> V}", "have EQ: \"P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u} \\<union> {{v} |v. v \\<in> V - {u}}\n                  = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}\""], ["proof (prove)\nusing this:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n    wrap {u} \\<union>\n    {{v} |v. v \\<in> V - {u}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}", "."], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from invrules(1)"], ["proof (chain)\npicking this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})", "have 1: \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u} \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n        (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n        wrap {u} \\<union>\n        {{v} |v. v \\<in> V - {u}})", "unfolding EQ"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V})", ".\n\n  \\<comment> \\<open>Auxiliary information is preserved\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n      wrap {u} \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have NOTIN: \"\\<forall>M \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. u \\<notin> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "using invrules(2) assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "by blast"], ["proof (state)\nthis:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"u \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> U", "using assms(2) bpE(3)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. u \\<in> U", "by blast"], ["proof (state)\nthis:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "then"], ["proof (chain)\npicking this:\n  u \\<in> U", "have R: \"U - (V - {u}) = U - V \\<union> {u}\""], ["proof (prove)\nusing this:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. U - (V - {u}) = U - V \\<union> {u}", "by blast"], ["proof (state)\nthis:\n  U - (V - {u}) = U - V \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have L: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u}) = \\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n      wrap {u}) =\n    \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union>\n    {u}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      (P\\<^sub>2 \\<union>\n       (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n      (if {u} = {} then {} else {{u}})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      (P\\<^sub>2 \\<union>\n       (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}))) \\<union>\n    {u}", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      (P\\<^sub>2 \\<union>\n       (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n      (if {u} = {} then {} else {{u}})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      (P\\<^sub>2 \\<union>\n       (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}))) \\<union>\n    {u}", "by auto"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n    wrap {u}) =\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union>\n  {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 2: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u}) = U - (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n      wrap {u}) =\n    U - (V - {u})", "unfolding L R"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union>\n    {u} =\n    U - V \\<union> {u}", "using invrules(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union>\n    {u} =\n    U - V \\<union> {u}", "by auto"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n    wrap {u}) =\n  U - (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 3: \"{} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n                wrap {u}", "using bpE(2)[OF 1]"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n              (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n              wrap {u} \\<union>\n              {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n                wrap {u}", "by simp"], ["proof (state)\nthis:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n              (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n              wrap {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 4: \"{u} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n             (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n             (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by auto"], ["proof (state)\nthis:\n  {u}\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 5: \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n    {}", "using invrules(5) NOTIN"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n    {}", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> (if B\\<^sub>1 = {} then {} else {B\\<^sub>1})) \\<inter>\n  (P\\<^sub>2 \\<union> (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union>\n                 (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n                 P\\<^sub>2 \\<union>\n                 (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union>\n     (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n     (if {} = {} then {} else {{}})) \\<inter>\n    (P\\<^sub>2 \\<union>\n     (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n     (if {u} = {} then {} else {{u}})) =\n    {}", "by force"], ["proof (state)\nthis:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from inv\\<^sub>1I[OF 1 2 3 4 5]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>A simplified version of the bin packing algorithm proposed in the article.\n      It serves as an introduction into the approach taken, and, while it does not provide the desired\n      approximation factor, it does ensure that \\<open>P\\<close> is a correct solution of the bin packing problem.\\<close>"], ["", "lemma simple_bp_correct:\n\"VARS P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u\n  {True}\n  P\\<^sub>1 := {}; P\\<^sub>2 := {}; B\\<^sub>1 := {}; B\\<^sub>2 := {}; V := U;\n  WHILE V \\<inter> S \\<noteq> {} INV {inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V} DO\n    u := (SOME u. u \\<in> V); V := V - {u};\n    IF W(B\\<^sub>1) + w(u) \\<le> c\n    THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u}\n    ELSE IF W(B\\<^sub>2) + w(u) \\<le> c\n         THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u}\n         ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2; B\\<^sub>2 := {u} FI;\n         P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1; B\\<^sub>1 := {} FI\n  OD;\n  P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} | v. v \\<in> V}\n  {bp P}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {True} \n     P\\<^sub>1 := {};\n     P\\<^sub>2 := {};\n     B\\<^sub>1 := {};\n     B\\<^sub>2 := {};\n     V := U;\n     WHILE V \\<inter> S \\<noteq> {}\n      INV {inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V} \n      VAR {\\<lambda>(P, P\\<^sub>1, P\\<^sub>2, B\\<^sub>1, B\\<^sub>2, V, u).\n              0} \n      DO u := (SOME u. u \\<in> V);\n         V := V - {u};\n         IF W B\\<^sub>1 + w u \\<le> real c\n          THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u} \n          ELSE IF W B\\<^sub>2 + w u \\<le> real c\n                THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u} \n                ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2;\n                     B\\<^sub>2 := {u}\n                FI;\n               P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1;\n               B\\<^sub>1 := {}\n          FI \n      OD;\n     P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n          wrap B\\<^sub>2 \\<union>\n          {{v} |v. v \\<in> V} \n     {bp P}", "proof (vcg, goal_cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       True \\<Longrightarrow> inv\\<^sub>1 {} {} {} {} U\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n         (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n         (V - {SOME u. u \\<in> V})) \\<and>\n       (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n               \\<le> real c \\<longrightarrow>\n        (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n          (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n          (V - {SOME u. u \\<in> V})) \\<and>\n        (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n                \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n          (V - {SOME u. u \\<in> V})))\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "case (1 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u)"], ["proof (state)\nthis:\n  True\n\ngoal (3 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       True \\<Longrightarrow> inv\\<^sub>1 {} {} {} {} U\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n         (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n         (V - {SOME u. u \\<in> V})) \\<and>\n       (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n               \\<le> real c \\<longrightarrow>\n        (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n          (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n          (V - {SOME u. u \\<in> V})) \\<and>\n        (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n                \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n          (V - {SOME u. u \\<in> V})))\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 {} {} {} {} U", "unfolding bp_def partition_on_def pairwise_def wrap_def inv\\<^sub>1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<Union>\n       ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n        (if {} = {} then {} else {{}}) \\<union>\n        {{v} |v. v \\<in> U}) =\n      U \\<and>\n      (\\<forall>x\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                      {} \\<union>\n                      (if {} = {} then {} else {{}}) \\<union>\n                      {{v} |v. v \\<in> U}.\n          \\<forall>y\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                         {} \\<union>\n                         (if {} = {} then {} else {{}}) \\<union>\n                         {{v} |v. v \\<in> U}.\n             x \\<noteq> y \\<longrightarrow> disjnt x y) \\<and>\n      {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                  {} \\<union>\n                  (if {} = {} then {} else {{}}) \\<union>\n                  {{v} |v. v \\<in> U}) \\<and>\n     (\\<forall>B\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                     {} \\<union>\n                     (if {} = {} then {} else {{}}) \\<union>\n                     {{v} |v. v \\<in> U}.\n         W B \\<le> real c)) \\<and>\n    \\<Union>\n     ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n      (if {} = {} then {} else {{}})) =\n    U - U \\<and>\n    {} \\<notin> {} \\<union> {} \\<union>\n                (if {} = {} then {} else {{}}) \\<and>\n    {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                {} \\<and>\n    ({} \\<union> (if {} = {} then {} else {{}})) \\<inter>\n    ({} \\<union> (if {} = {} then {} else {{}})) =\n    {}", "using weight"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. ((\\<Union>\n       ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n        (if {} = {} then {} else {{}}) \\<union>\n        {{v} |v. v \\<in> U}) =\n      U \\<and>\n      (\\<forall>x\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                      {} \\<union>\n                      (if {} = {} then {} else {{}}) \\<union>\n                      {{v} |v. v \\<in> U}.\n          \\<forall>y\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                         {} \\<union>\n                         (if {} = {} then {} else {{}}) \\<union>\n                         {{v} |v. v \\<in> U}.\n             x \\<noteq> y \\<longrightarrow> disjnt x y) \\<and>\n      {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                  {} \\<union>\n                  (if {} = {} then {} else {{}}) \\<union>\n                  {{v} |v. v \\<in> U}) \\<and>\n     (\\<forall>B\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                     {} \\<union>\n                     (if {} = {} then {} else {{}}) \\<union>\n                     {{v} |v. v \\<in> U}.\n         W B \\<le> real c)) \\<and>\n    \\<Union>\n     ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n      (if {} = {} then {} else {{}})) =\n    U - U \\<and>\n    {} \\<notin> {} \\<union> {} \\<union>\n                (if {} = {} then {} else {{}}) \\<and>\n    {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                {} \\<and>\n    ({} \\<union> (if {} = {} then {} else {{}})) \\<inter>\n    ({} \\<union> (if {} = {} then {} else {{}})) =\n    {}", "by auto"], ["proof (state)\nthis:\n  inv\\<^sub>1 {} {} {} {} U\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n         (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n         (V - {SOME u. u \\<in> V})) \\<and>\n       (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n               \\<le> real c \\<longrightarrow>\n        (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n          (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n          (V - {SOME u. u \\<in> V})) \\<and>\n        (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n                \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n          (V - {SOME u. u \\<in> V})))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n         (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n         (V - {SOME u. u \\<in> V})) \\<and>\n       (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n               \\<le> real c \\<longrightarrow>\n        (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n          (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n          (V - {SOME u. u \\<in> V})) \\<and>\n        (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n                \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n          (V - {SOME u. u \\<in> V})))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "case (2 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u)"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n         (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n         (V - {SOME u. u \\<in> V})) \\<and>\n       (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n               \\<le> real c \\<longrightarrow>\n        (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n          (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n          (V - {SOME u. u \\<in> V})) \\<and>\n        (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n                \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n          (V - {SOME u. u \\<in> V})))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "then"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}", "have INV: \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", ".."], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n         (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n         (V - {SOME u. u \\<in> V})) \\<and>\n       (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n               \\<le> real c \\<longrightarrow>\n        (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n          (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n          (V - {SOME u. u \\<in> V})) \\<and>\n        (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n                \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n          (V - {SOME u. u \\<in> V})))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "from 2"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}", "have \"V \\<noteq> {}\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. V \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  V \\<noteq> {}\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n         (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n         (V - {SOME u. u \\<in> V})) \\<and>\n       (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n               \\<le> real c \\<longrightarrow>\n        (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n          (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n          (V - {SOME u. u \\<in> V})) \\<and>\n        (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n                \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n          (V - {SOME u. u \\<in> V})))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "then"], ["proof (chain)\npicking this:\n  V \\<noteq> {}", "have IN: \"(SOME u. u \\<in> V) \\<in> V\""], ["proof (prove)\nusing this:\n  V \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (SOME u. u \\<in> V) \\<in> V", "by (simp add: some_in_eq)"], ["proof (state)\nthis:\n  (SOME u. u \\<in> V) \\<in> V\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n         (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n         (V - {SOME u. u \\<in> V})) \\<and>\n       (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n               \\<le> real c \\<longrightarrow>\n        (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n          (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n          (V - {SOME u. u \\<in> V})) \\<and>\n        (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n                \\<le> real c \\<longrightarrow>\n         inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n          (V - {SOME u. u \\<in> V})))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "from inv\\<^sub>1_stepA[OF INV IN] inv\\<^sub>1_stepB[OF INV IN] inv\\<^sub>1_stepC[OF INV IN]"], ["proof (chain)\npicking this:\n  W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<Longrightarrow>\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {SOME u. u \\<in> V})\n   B\\<^sub>2 (V - {SOME u. u \\<in> V})\n  W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<Longrightarrow>\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {SOME u. u \\<in> V}) (V - {SOME u. u \\<in> V})\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n   (V - {SOME u. u \\<in> V})", "show ?case"], ["proof (prove)\nusing this:\n  W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<Longrightarrow>\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {SOME u. u \\<in> V})\n   B\\<^sub>2 (V - {SOME u. u \\<in> V})\n  W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<Longrightarrow>\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {SOME u. u \\<in> V}) (V - {SOME u. u \\<in> V})\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n   (V - {SOME u. u \\<in> V})\n\ngoal (1 subgoal):\n 1. (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n     inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2\n      (B\\<^sub>1 \\<union> {SOME u. u \\<in> V}) B\\<^sub>2\n      (V - {SOME u. u \\<in> V})) \\<and>\n    (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V)\n            \\<le> real c \\<longrightarrow>\n     (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n      inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n       (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n       (V - {SOME u. u \\<in> V})) \\<and>\n     (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n             \\<le> real c \\<longrightarrow>\n      inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n       (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n       (V - {SOME u. u \\<in> V})))", "by blast"], ["proof (state)\nthis:\n  (W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n   inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {SOME u. u \\<in> V})\n    B\\<^sub>2 (V - {SOME u. u \\<in> V})) \\<and>\n  (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n   (W B\\<^sub>2 + w (SOME u. u \\<in> V) \\<le> real c \\<longrightarrow>\n    inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {SOME u. u \\<in> V})\n     (V - {SOME u. u \\<in> V})) \\<and>\n   (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V)\n           \\<le> real c \\<longrightarrow>\n    inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V}\n     (V - {SOME u. u \\<in> V})))\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "case (3 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u)"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  \\<not> V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V})", "then"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  \\<not> V \\<inter> S \\<noteq> {}", "show ?case"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  \\<not> V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V})", "unfolding inv\\<^sub>1_def"], ["proof (prove)\nusing this:\n  (bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V}) \\<and>\n   \\<Union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     wrap B\\<^sub>2) =\n   U - V \\<and>\n   B\\<^sub>1\n   \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<and>\n   B\\<^sub>2\n   \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<and>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n   {}) \\<and>\n  \\<not> V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V})", "by blast"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Lower Bounds for the Bin Packing Problem\\<close>"], ["", "lemma bp_bins_finite [simp]:\n  assumes \"bp P\"\n  shows \"\\<forall>B \\<in> P. finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. finite B", "using bpE(3)[OF assms] U_Finite"], ["proof (prove)\nusing this:\n  \\<Union> P = U\n  finite U\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. finite B", "by (meson Sup_upper finite_subset)"], ["", "lemma bp_sol_finite [simp]:\n  assumes \"bp P\"\n  shows \"finite P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite P", "using bpE(3)[OF assms] U_Finite"], ["proof (prove)\nusing this:\n  \\<Union> P = U\n  finite U\n\ngoal (1 subgoal):\n 1. finite P", "by (simp add: finite_UnionD)"], ["", "text \\<open>If \\<open>P\\<close> is a solution of the bin packing problem, then no bin in \\<open>P\\<close> may contain more than\n      one large object.\\<close>"], ["", "lemma only_one_L_per_bin:\n  assumes \"bp P\" \"B \\<in> P\"\n  shows \"\\<forall>x \\<in> B. \\<forall>y \\<in> B. x \\<noteq> y \\<longrightarrow> x \\<notin> L \\<or> y \\<notin> L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>B.\n       \\<forall>y\\<in>B.\n          x \\<noteq> y \\<longrightarrow> x \\<notin> L \\<or> y \\<notin> L", "proof (rule ccontr, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "assume \"\\<exists>x\\<in>B. \\<exists>y\\<in>B. x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L\""], ["proof (state)\nthis:\n  \\<exists>x\\<in>B.\n     \\<exists>y\\<in>B. x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  \\<exists>x\\<in>B.\n     \\<exists>y\\<in>B. x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L", "obtain x y where *: \"x \\<in> B\" \"y \\<in> B\" \"x \\<noteq> y\" \"x \\<in> L\" \"y \\<in> L\""], ["proof (prove)\nusing this:\n  \\<exists>x\\<in>B.\n     \\<exists>y\\<in>B. x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L\n\ngoal (1 subgoal):\n 1. (\\<And>x y.\n        \\<lbrakk>x \\<in> B; y \\<in> B; x \\<noteq> y; x \\<in> L;\n         y \\<in> L\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  x \\<in> B\n  y \\<in> B\n  x \\<noteq> y\n  x \\<in> L\n  y \\<in> L\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  x \\<in> B\n  y \\<in> B\n  x \\<noteq> y\n  x \\<in> L\n  y \\<in> L", "have \"c < w x + w y\""], ["proof (prove)\nusing this:\n  x \\<in> B\n  y \\<in> B\n  x \\<noteq> y\n  x \\<in> L\n  y \\<in> L\n\ngoal (1 subgoal):\n 1. real c < w x + w y", "using L_def S_def"], ["proof (prove)\nusing this:\n  x \\<in> B\n  y \\<in> B\n  x \\<noteq> y\n  x \\<in> L\n  y \\<in> L\n  L = U - S\n  S = {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. real c < w x + w y", "by force"], ["proof (state)\nthis:\n  real c < w x + w y\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "have \"finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B", "using assms"], ["proof (prove)\nusing this:\n  bp P\n  B \\<in> P\n\ngoal (1 subgoal):\n 1. finite B", "by simp"], ["proof (state)\nthis:\n  finite B\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "have \"y \\<in> B - {x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> B - {x}", "using *(2,3)"], ["proof (prove)\nusing this:\n  y \\<in> B\n  x \\<noteq> y\n\ngoal (1 subgoal):\n 1. y \\<in> B - {x}", "by blast"], ["proof (state)\nthis:\n  y \\<in> B - {x}\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "have \"W B = W (B - {x}) + w x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B = W (B - {x}) + w x", "using *(1) \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> B\n  finite B\n\ngoal (1 subgoal):\n 1. W B = W (B - {x}) + w x", "by (simp add: sum.remove)"], ["proof (state)\nthis:\n  W B = W (B - {x}) + w x\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "also"], ["proof (state)\nthis:\n  W B = W (B - {x}) + w x\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "have \"... = W (B - {x} - {y}) + w x + w y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W (B - {x}) + w x = W (B - {x} - {y}) + w x + w y", "using \\<open>y \\<in> B - {x}\\<close> \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  y \\<in> B - {x}\n  finite B\n\ngoal (1 subgoal):\n 1. W (B - {x}) + w x = W (B - {x} - {y}) + w x + w y", "by (simp add: sum.remove)"], ["proof (state)\nthis:\n  W (B - {x}) + w x = W (B - {x} - {y}) + w x + w y\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "finally"], ["proof (chain)\npicking this:\n  W B = W (B - {x} - {y}) + w x + w y", "have *: \"W B = W (B - {x} - {y}) + w x + w y\""], ["proof (prove)\nusing this:\n  W B = W (B - {x} - {y}) + w x + w y\n\ngoal (1 subgoal):\n 1. W B = W (B - {x} - {y}) + w x + w y", "."], ["proof (state)\nthis:\n  W B = W (B - {x} - {y}) + w x + w y\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "have \"\\<forall>u \\<in> B. 0 < w u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u\\<in>B. 0 < w u", "using bpE(3)[OF assms(1)] assms(2) weight"], ["proof (prove)\nusing this:\n  \\<Union> P = U\n  B \\<in> P\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>u\\<in>B. 0 < w u", "by blast"], ["proof (state)\nthis:\n  \\<forall>u\\<in>B. 0 < w u\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  \\<forall>u\\<in>B. 0 < w u", "have \"0 \\<le> W (B - {x} - {y})\""], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>B. 0 < w u\n\ngoal (1 subgoal):\n 1. 0 \\<le> W (B - {x} - {y})", "by (smt DiffD1 sum_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> W (B - {x} - {y})\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "with *"], ["proof (chain)\npicking this:\n  W B = W (B - {x} - {y}) + w x + w y\n  0 \\<le> W (B - {x} - {y})", "have \"c < W B\""], ["proof (prove)\nusing this:\n  W B = W (B - {x} - {y}) + w x + w y\n  0 \\<le> W (B - {x} - {y})\n\ngoal (1 subgoal):\n 1. real c < W B", "using \\<open>c < w x + w y\\<close>"], ["proof (prove)\nusing this:\n  W B = W (B - {x} - {y}) + w x + w y\n  0 \\<le> W (B - {x} - {y})\n  real c < w x + w y\n\ngoal (1 subgoal):\n 1. real c < W B", "by simp"], ["proof (state)\nthis:\n  real c < W B\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and> x \\<in> L \\<and> y \\<in> L \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  real c < W B", "show False"], ["proof (prove)\nusing this:\n  real c < W B\n\ngoal (1 subgoal):\n 1. False", "using bpE(4)[OF assms(1)] assms(2)"], ["proof (prove)\nusing this:\n  real c < W B\n  \\<forall>B\\<in>P. W B \\<le> real c\n  B \\<in> P\n\ngoal (1 subgoal):\n 1. False", "by fastforce"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>P\\<close> is a solution of the bin packing problem, then the amount of large objects\n      is a lower bound for the amount of bins in P.\\<close>"], ["", "lemma L_lower_bound_card:\n  assumes \"bp P\"\n  shows \"card L \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card L \\<le> card P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card L \\<le> card P", "have \"\\<forall>x \\<in> L. \\<exists>B \\<in> P. x \\<in> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>L. \\<exists>B\\<in>P. x \\<in> B", "using bpE(3)[OF assms] L_def"], ["proof (prove)\nusing this:\n  \\<Union> P = U\n  L = U - S\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>L. \\<exists>B\\<in>P. x \\<in> B", "by blast"], ["proof (state)\nthis:\n  \\<forall>x\\<in>L. \\<exists>B\\<in>P. x \\<in> B\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "then"], ["proof (chain)\npicking this:\n  \\<forall>x\\<in>L. \\<exists>B\\<in>P. x \\<in> B", "obtain f where f_def: \"\\<forall>u \\<in> L. u \\<in> f u \\<and> f u \\<in> P\""], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>L. \\<exists>B\\<in>P. x \\<in> B\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<forall>u\\<in>L. u \\<in> f u \\<and> f u \\<in> P \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  \\<forall>u\\<in>L. u \\<in> f u \\<and> f u \\<in> P\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "then"], ["proof (chain)\npicking this:\n  \\<forall>u\\<in>L. u \\<in> f u \\<and> f u \\<in> P", "have \"inj_on f L\""], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>L. u \\<in> f u \\<and> f u \\<in> P\n\ngoal (1 subgoal):\n 1. inj_on f L", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>L. u \\<in> f u \\<and> f u \\<in> P\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>L. \\<forall>y\\<in>L. f x = f y \\<longrightarrow> x = y", "using only_one_L_per_bin[OF assms]"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>L. u \\<in> f u \\<and> f u \\<in> P\n  ?B \\<in> P \\<Longrightarrow>\n  \\<forall>x\\<in>?B.\n     \\<forall>y\\<in>?B.\n        x \\<noteq> y \\<longrightarrow> x \\<notin> L \\<or> y \\<notin> L\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>L. \\<forall>y\\<in>L. f x = f y \\<longrightarrow> x = y", "by blast"], ["proof (state)\nthis:\n  inj_on f L\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "then"], ["proof (chain)\npicking this:\n  inj_on f L", "have card_eq: \"card L = card (f ` L)\""], ["proof (prove)\nusing this:\n  inj_on f L\n\ngoal (1 subgoal):\n 1. card L = card (f ` L)", "by (simp add: card_image)"], ["proof (state)\nthis:\n  card L = card (f ` L)\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "have \"f ` L \\<subseteq> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ` L \\<subseteq> P", "using f_def"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>L. u \\<in> f u \\<and> f u \\<in> P\n\ngoal (1 subgoal):\n 1. f ` L \\<subseteq> P", "by blast"], ["proof (state)\nthis:\n  f ` L \\<subseteq> P\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "moreover"], ["proof (state)\nthis:\n  f ` L \\<subseteq> P\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "have \"finite P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite P", "using assms"], ["proof (prove)\nusing this:\n  bp P\n\ngoal (1 subgoal):\n 1. finite P", "by simp"], ["proof (state)\nthis:\n  finite P\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "ultimately"], ["proof (chain)\npicking this:\n  f ` L \\<subseteq> P\n  finite P", "have \"card (f ` L) \\<le> card P\""], ["proof (prove)\nusing this:\n  f ` L \\<subseteq> P\n  finite P\n\ngoal (1 subgoal):\n 1. card (f ` L) \\<le> card P", "by (simp add: card_mono)"], ["proof (state)\nthis:\n  card (f ` L) \\<le> card P\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "then"], ["proof (chain)\npicking this:\n  card (f ` L) \\<le> card P", "show ?thesis"], ["proof (prove)\nusing this:\n  card (f ` L) \\<le> card P\n\ngoal (1 subgoal):\n 1. card L \\<le> card P", "unfolding card_eq"], ["proof (prove)\nusing this:\n  card (f ` L) \\<le> card P\n\ngoal (1 subgoal):\n 1. card (f ` L) \\<le> card P", "."], ["proof (state)\nthis:\n  card L \\<le> card P\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>P\\<close> is a solution of the bin packing problem, then the amount of bins of a subset of P\n      in which every bin contains a large object is a lower bound on the amount of large objects.\\<close>"], ["", "lemma subset_bp_card:\n  assumes \"bp P\" \"M \\<subseteq> P\" \"\\<forall>B \\<in> M. B \\<inter> L \\<noteq> {}\"\n  shows \"card M \\<le> card L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card M \\<le> card L", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card M \\<le> card L", "have \"\\<forall>B \\<in> M. \\<exists>u \\<in> L. u \\<in> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>M. \\<exists>u\\<in>L. u \\<in> B", "using assms(3)"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>M. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>M. \\<exists>u\\<in>L. u \\<in> B", "by fast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>M. \\<exists>u\\<in>L. u \\<in> B\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "then"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>M. \\<exists>u\\<in>L. u \\<in> B", "have \"\\<exists>f. \\<forall>B \\<in> M. f B \\<in> L \\<and> f B \\<in> B\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>M. \\<exists>u\\<in>L. u \\<in> B\n\ngoal (1 subgoal):\n 1. \\<exists>f. \\<forall>B\\<in>M. f B \\<in> L \\<and> f B \\<in> B", "by metis"], ["proof (state)\nthis:\n  \\<exists>f. \\<forall>B\\<in>M. f B \\<in> L \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "then"], ["proof (chain)\npicking this:\n  \\<exists>f. \\<forall>B\\<in>M. f B \\<in> L \\<and> f B \\<in> B", "obtain f where f_def: \"\\<forall>B \\<in> M. f B \\<in> L \\<and> f B \\<in> B\""], ["proof (prove)\nusing this:\n  \\<exists>f. \\<forall>B\\<in>M. f B \\<in> L \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<forall>B\\<in>M. f B \\<in> L \\<and> f B \\<in> B \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", ".."], ["proof (state)\nthis:\n  \\<forall>B\\<in>M. f B \\<in> L \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "have \"inj_on f M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f M", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "assume \"\\<not> inj_on f M\""], ["proof (state)\nthis:\n  \\<not> inj_on f M\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<not> inj_on f M", "have \"\\<exists>x \\<in> M. \\<exists>y \\<in> M. x \\<noteq> y \\<and> f x = f y\""], ["proof (prove)\nusing this:\n  \\<not> inj_on f M\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<not> (\\<forall>x\\<in>M.\n             \\<forall>y\\<in>M. f x = f y \\<longrightarrow> x = y)\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y", "by blast"], ["proof (state)\nthis:\n  \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y", "obtain x y where *: \"x \\<in> M\" \"y \\<in> M\" \"x \\<noteq> y\" \"f x = f y\""], ["proof (prove)\nusing this:\n  \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y\n\ngoal (1 subgoal):\n 1. (\\<And>x y.\n        \\<lbrakk>x \\<in> M; y \\<in> M; x \\<noteq> y; f x = f y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y", "have \"\\<exists>u. u \\<in> x \\<and> u \\<in> y\""], ["proof (prove)\nusing this:\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n\ngoal (1 subgoal):\n 1. \\<exists>u. u \\<in> x \\<and> u \\<in> y", "using f_def"], ["proof (prove)\nusing this:\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n  \\<forall>B\\<in>M. f B \\<in> L \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. \\<exists>u. u \\<in> x \\<and> u \\<in> y", "by metis"], ["proof (state)\nthis:\n  \\<exists>u. u \\<in> x \\<and> u \\<in> y\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<exists>u. u \\<in> x \\<and> u \\<in> y", "have \"x \\<inter> y \\<noteq> {}\""], ["proof (prove)\nusing this:\n  \\<exists>u. u \\<in> x \\<and> u \\<in> y\n\ngoal (1 subgoal):\n 1. x \\<inter> y \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  x \\<inter> y \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  x \\<inter> y \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "have \"pairwise disjnt M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint M", "using pairwise_subset[OF bpE(1)[OF assms(1)] assms(2)]"], ["proof (prove)\nusing this:\n  disjoint M\n\ngoal (1 subgoal):\n 1. disjoint M", "."], ["proof (state)\nthis:\n  disjoint M\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  x \\<inter> y \\<noteq> {}\n  disjoint M", "show False"], ["proof (prove)\nusing this:\n  x \\<inter> y \\<noteq> {}\n  disjoint M\n\ngoal (1 subgoal):\n 1. False", "using *"], ["proof (prove)\nusing this:\n  x \\<inter> y \\<noteq> {}\n  disjoint M\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n\ngoal (1 subgoal):\n 1. False", "unfolding pairwise_def disjnt_def"], ["proof (prove)\nusing this:\n  x \\<inter> y \\<noteq> {}\n  \\<forall>x\\<in>M.\n     \\<forall>y\\<in>M. x \\<noteq> y \\<longrightarrow> x \\<inter> y = {}\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj_on f M\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "moreover"], ["proof (state)\nthis:\n  inj_on f M\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "have \"finite L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite L", "using L_def U_Finite"], ["proof (prove)\nusing this:\n  L = U - S\n  finite U\n\ngoal (1 subgoal):\n 1. finite L", "by blast"], ["proof (state)\nthis:\n  finite L\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "moreover"], ["proof (state)\nthis:\n  finite L\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "have \"f ` M \\<subseteq> L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ` M \\<subseteq> L", "using f_def"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>M. f B \\<in> L \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. f ` M \\<subseteq> L", "by blast"], ["proof (state)\nthis:\n  f ` M \\<subseteq> L\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "ultimately"], ["proof (chain)\npicking this:\n  inj_on f M\n  finite L\n  f ` M \\<subseteq> L", "show ?thesis"], ["proof (prove)\nusing this:\n  inj_on f M\n  finite L\n  f ` M \\<subseteq> L\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "using card_inj_on_le"], ["proof (prove)\nusing this:\n  inj_on f M\n  finite L\n  f ` M \\<subseteq> L\n  \\<lbrakk>inj_on ?f ?A; ?f ` ?A \\<subseteq> ?B; finite ?B\\<rbrakk>\n  \\<Longrightarrow> card ?A \\<le> card ?B\n\ngoal (1 subgoal):\n 1. card M \\<le> card L", "by blast"], ["proof (state)\nthis:\n  card M \\<le> card L\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>P\\<close> is a correct solution of the bin packing problem, \\<open>inv\\<^sub>1\\<close> holds for the partial solution,\n      and every bin in \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1\\<close> contains a large object, then the amount of bins in\n      \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L}\\<close> is a lower bound for the amount of bins in \\<open>P\\<close>.\\<close>"], ["", "lemma L_bins_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"\\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L}) \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L})\n    \\<le> card P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L})\n    \\<le> card P", "note invrules = inv\\<^sub>1E[OF assms(2)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L})\n    \\<le> card P", "have \"\\<forall>B \\<in> {{v} |v. v \\<in> V \\<inter> L}. B \\<inter> L \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>{{v} |v. v \\<in> V \\<inter> L}. B \\<inter> L \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>{{v} |v. v \\<in> V \\<inter> L}. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L})\n    \\<le> card P", "with assms(3)"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  \\<forall>B\\<in>{{v} |v. v \\<in> V \\<inter> L}. B \\<inter> L \\<noteq> {}", "have\n    \"P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L} \\<subseteq> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}\"\n    \"\\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L}. B \\<inter> L \\<noteq> {}\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  \\<forall>B\\<in>{{v} |v. v \\<in> V \\<inter> L}. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L}\n    \\<subseteq> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                P\\<^sub>2 \\<union>\n                wrap B\\<^sub>2 \\<union>\n                {{v} |v. v \\<in> V} &&&\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   {{v} |v. v \\<in> V \\<inter> L}.\n       B \\<inter> L \\<noteq> {}", "by blast+"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L}\n  \\<subseteq> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 {{v} |v. v \\<in> V \\<inter> L}.\n     B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L})\n    \\<le> card P", "from subset_bp_card[OF invrules(1) this]"], ["proof (chain)\npicking this:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L})\n  \\<le> card L", "show ?thesis"], ["proof (prove)\nusing this:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L})\n  \\<le> card L\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L})\n    \\<le> card P", "using L_lower_bound_card[OF assms(1)]"], ["proof (prove)\nusing this:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L})\n  \\<le> card L\n  card L \\<le> card P\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L})\n    \\<le> card P", "by linarith"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L})\n  \\<le> card P\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>P\\<close> is a correct solution of the bin packing problem, then the sum of the weights of the\n      objects is equal to the sum of the weights of the bins in \\<open>P\\<close>.\\<close>"], ["", "lemma sum_Un_eq_sum_sum:\n  assumes \"bp P\"\n  shows \"(\\<Sum>u \\<in> U. w u) = (\\<Sum>B \\<in> P. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W U = sum W P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. W U = sum W P", "have FINITE: \"\\<forall>B \\<in> P. finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. finite B", "using assms"], ["proof (prove)\nusing this:\n  bp P\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. finite B", "by simp"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P. finite B\n\ngoal (1 subgoal):\n 1. W U = sum W P", "have DISJNT: \"\\<forall>A \\<in> P. \\<forall>B \\<in> P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P.\n       \\<forall>B\\<in>P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "using bpE(1)[OF assms]"], ["proof (prove)\nusing this:\n  disjoint P\n\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P.\n       \\<forall>B\\<in>P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "unfolding pairwise_def disjnt_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>P.\n     \\<forall>y\\<in>P. x \\<noteq> y \\<longrightarrow> x \\<inter> y = {}\n\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P.\n       \\<forall>B\\<in>P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "."], ["proof (state)\nthis:\n  \\<forall>A\\<in>P.\n     \\<forall>B\\<in>P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. W U = sum W P", "have \"(\\<Sum>u \\<in> (\\<Union>P). w u) = (\\<Sum>B \\<in> P. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W (\\<Union> P) = sum W P", "using sum.Union_disjoint[OF FINITE DISJNT]"], ["proof (prove)\nusing this:\n  sum ?g (\\<Union> P) = (sum \\<circ> sum) ?g P\n\ngoal (1 subgoal):\n 1. W (\\<Union> P) = sum W P", "by auto"], ["proof (state)\nthis:\n  W (\\<Union> P) = sum W P\n\ngoal (1 subgoal):\n 1. W U = sum W P", "then"], ["proof (chain)\npicking this:\n  W (\\<Union> P) = sum W P", "show ?thesis"], ["proof (prove)\nusing this:\n  W (\\<Union> P) = sum W P\n\ngoal (1 subgoal):\n 1. W U = sum W P", "unfolding bpE(3)[OF assms]"], ["proof (prove)\nusing this:\n  W U = sum W P\n\ngoal (1 subgoal):\n 1. W U = sum W P", "."], ["proof (state)\nthis:\n  W U = sum W P\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>P\\<close> is a correct solution of the bin packing problem, then the sum of the weights of the items\n      is a lower bound of amount of bins in \\<open>P\\<close> multiplied by their maximum capacity.\\<close>"], ["", "lemma sum_lower_bound_card:\n  assumes \"bp P\"\n  shows \"(\\<Sum>u \\<in> U. w u) \\<le> c * card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "have *: \"\\<forall>B \\<in> P. 0 < W B \\<and> W B \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. 0 < W B \\<and> W B \\<le> real c", "using bpE(2-4)[OF assms] weight"], ["proof (prove)\nusing this:\n  {} \\<notin> P\n  \\<Union> P = U\n  \\<forall>B\\<in>P. W B \\<le> real c\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. 0 < W B \\<and> W B \\<le> real c", "by (metis UnionI assms bp_bins_finite sum_pos)"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P. 0 < W B \\<and> W B \\<le> real c\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "have \"(\\<Sum>u \\<in> U. w u) = (\\<Sum>B \\<in> P. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W U = sum W P", "using sum_Un_eq_sum_sum[OF assms]"], ["proof (prove)\nusing this:\n  W U = sum W P\n\ngoal (1 subgoal):\n 1. W U = sum W P", "."], ["proof (state)\nthis:\n  W U = sum W P\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "also"], ["proof (state)\nthis:\n  W U = sum W P\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "have \"... \\<le> (\\<Sum>B \\<in> P. c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P \\<le> real (\\<Sum>B\\<in>P. c)", "using sum_mono *"], ["proof (prove)\nusing this:\n  (\\<And>i. i \\<in> ?K \\<Longrightarrow> ?f i \\<le> ?g i) \\<Longrightarrow>\n  sum ?f ?K \\<le> sum ?g ?K\n  \\<forall>B\\<in>P. 0 < W B \\<and> W B \\<le> real c\n\ngoal (1 subgoal):\n 1. sum W P \\<le> real (\\<Sum>B\\<in>P. c)", "by fastforce"], ["proof (state)\nthis:\n  sum W P \\<le> real (\\<Sum>B\\<in>P. c)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "also"], ["proof (state)\nthis:\n  sum W P \\<le> real (\\<Sum>B\\<in>P. c)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "have \"... = c * card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (\\<Sum>B\\<in>P. c) = real (c * card P)", "by simp"], ["proof (state)\nthis:\n  real (\\<Sum>B\\<in>P. c) = real (c * card P)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "finally"], ["proof (chain)\npicking this:\n  W U \\<le> real (c * card P)", "show ?thesis"], ["proof (prove)\nusing this:\n  W U \\<le> real (c * card P)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "."], ["proof (state)\nthis:\n  W U \\<le> real (c * card P)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bp_NE:\n  assumes \"bp P\"\n  shows \"P \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P \\<noteq> {}", "using U_NE bpE(3)[OF assms]"], ["proof (prove)\nusing this:\n  U \\<noteq> {}\n  \\<Union> P = U\n\ngoal (1 subgoal):\n 1. P \\<noteq> {}", "by blast"], ["", "lemma sum_Un_ge:\n  fixes f :: \"_ \\<Rightarrow> real\"\n  assumes \"finite M\" \"finite N\" \"\\<forall>B \\<in> M \\<union> N. 0 < f B\"\n  shows \"sum f M \\<le> sum f (M \\<union> N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "have \"0 \\<le> sum f N - sum f (M \\<inter> N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> sum f N - sum f (M \\<inter> N)", "using assms"], ["proof (prove)\nusing this:\n  finite M\n  finite N\n  \\<forall>B\\<in>M \\<union> N. 0 < f B\n\ngoal (1 subgoal):\n 1. 0 \\<le> sum f N - sum f (M \\<inter> N)", "by (smt DiffD1 inf.cobounded2 UnCI sum_mono2)"], ["proof (state)\nthis:\n  0 \\<le> sum f N - sum f (M \\<inter> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "then"], ["proof (chain)\npicking this:\n  0 \\<le> sum f N - sum f (M \\<inter> N)", "have \"sum f M \\<le> sum f M + sum f N - sum f (M \\<inter> N)\""], ["proof (prove)\nusing this:\n  0 \\<le> sum f N - sum f (M \\<inter> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f M + sum f N - sum f (M \\<inter> N)", "by simp"], ["proof (state)\nthis:\n  sum f M \\<le> sum f M + sum f N - sum f (M \\<inter> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "also"], ["proof (state)\nthis:\n  sum f M \\<le> sum f M + sum f N - sum f (M \\<inter> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "have \"... = sum f (M \\<union> N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f M + sum f N - sum f (M \\<inter> N) = sum f (M \\<union> N)", "using sum_Un[OF assms(1,2), symmetric]"], ["proof (prove)\nusing this:\n  sum ?f M + sum ?f N - sum ?f (M \\<inter> N) = sum ?f (M \\<union> N)\n\ngoal (1 subgoal):\n 1. sum f M + sum f N - sum f (M \\<inter> N) = sum f (M \\<union> N)", "."], ["proof (state)\nthis:\n  sum f M + sum f N - sum f (M \\<inter> N) = sum f (M \\<union> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "finally"], ["proof (chain)\npicking this:\n  sum f M \\<le> sum f (M \\<union> N)", "show ?thesis"], ["proof (prove)\nusing this:\n  sum f M \\<le> sum f (M \\<union> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "."], ["proof (state)\nthis:\n  sum f M \\<le> sum f (M \\<union> N)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>bij_exists\\<close> holds, one can obtain a function which is bijective between the bins in \\<open>P\\<close>\nand the objects in \\<open>V\\<close> such that an object returned by the function would cause the bin to\nexceed its capacity.\\<close>"], ["", "definition bij_exists :: \"'a set set \\<Rightarrow> 'a set \\<Rightarrow> bool\" where\n  \"bij_exists P V = (\\<exists>f. bij_betw f P V \\<and> (\\<forall>B \\<in> P. W B + w (f B) > c))\""], ["", "text \\<open>If \\<open>P\\<close> is a functionally correct solution of the bin packing problem, \\<open>inv\\<^sub>1\\<close> holds for the\npartial solution, and such a bijective function exists between the bins in \\<open>P\\<^sub>1\\<close> and the objects in\n@{term \"P\\<^sub>2 \\<union> wrap B\\<^sub>2\"}, the following strict lower bound can be shown:\\<close>"], ["", "lemma P\\<^sub>1_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"card P\\<^sub>1 + 1 \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "proof (cases \\<open>P\\<^sub>1 = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. P\\<^sub>1 = {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P\n 2. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "case True"], ["proof (state)\nthis:\n  P\\<^sub>1 = {}\n\ngoal (2 subgoals):\n 1. P\\<^sub>1 = {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P\n 2. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"finite P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite P", "using assms(1)"], ["proof (prove)\nusing this:\n  bp P\n\ngoal (1 subgoal):\n 1. finite P", "by simp"], ["proof (state)\nthis:\n  finite P\n\ngoal (2 subgoals):\n 1. P\\<^sub>1 = {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P\n 2. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "then"], ["proof (chain)\npicking this:\n  finite P", "have \"1 \\<le> card P\""], ["proof (prove)\nusing this:\n  finite P\n\ngoal (1 subgoal):\n 1. 1 \\<le> card P", "using bp_NE[OF assms(1)]"], ["proof (prove)\nusing this:\n  finite P\n  P \\<noteq> {}\n\ngoal (1 subgoal):\n 1. 1 \\<le> card P", "by (metis Nat.add_0_right Suc_diff_1 Suc_le_mono card_gt_0_iff le0 mult_Suc_right nat_mult_1)"], ["proof (state)\nthis:\n  1 \\<le> card P\n\ngoal (2 subgoals):\n 1. P\\<^sub>1 = {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P\n 2. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "then"], ["proof (chain)\npicking this:\n  1 \\<le> card P", "show ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> card P\n\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "unfolding True"], ["proof (prove)\nusing this:\n  1 \\<le> card P\n\ngoal (1 subgoal):\n 1. card {} + 1 \\<le> card P", "by simp"], ["proof (state)\nthis:\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "note invrules = inv\\<^sub>1E[OF assms(2)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "case False"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "obtain f where f_def: \"bij_betw f P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\" \"\\<forall>B \\<in> P\\<^sub>1. W B + w (f B) > c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms(3)"], ["proof (prove)\nusing this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     bij_betw f P\\<^sub>1\n      (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n     (\\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have FINITE: \"finite P\\<^sub>1\" \"finite (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\" \"finite (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\" \"finite (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (finite P\\<^sub>1 &&& finite (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    finite (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) &&&\n    finite (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V})", "using inv\\<^sub>1E(1)[OF assms(2)] bp_sol_finite"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  bp ?P \\<Longrightarrow> finite ?P\n\ngoal (1 subgoal):\n 1. (finite P\\<^sub>1 &&& finite (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    finite (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) &&&\n    finite (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V})", "by blast+"], ["proof (state)\nthis:\n  finite P\\<^sub>1\n  finite (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  finite (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  finite (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have F: \"\\<forall>B \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2. finite B", "using invrules(1)"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2. finite B", "by simp"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2. finite B\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have D: \"\\<forall>A \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. \\<forall>B \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n       \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n          A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "using bpE(1)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n       \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n          A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "unfolding pairwise_def disjnt_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     \\<forall>y\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                    P\\<^sub>2 \\<union>\n                    wrap B\\<^sub>2 \\<union>\n                    {{v} |v. v \\<in> V}.\n        x \\<noteq> y \\<longrightarrow> x \\<inter> y = {}\n\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n       \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n          A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "by auto"], ["proof (state)\nthis:\n  \\<forall>A\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n     \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n        A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have sum_eq: \"W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) = (\\<Sum>B \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n    sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using sum.Union_disjoint[OF F D]"], ["proof (prove)\nusing this:\n  sum ?g (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  (sum \\<circ> sum) ?g (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n    sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by auto"], ["proof (state)\nthis:\n  W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}. 0 < W B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V}.\n       0 < W B", "using bpE(2,3)[OF invrules(1)] weight"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V}.\n       0 < W B", "by (metis (no_types, lifting) UnionI bp_bins_finite invrules(1) sum_pos)"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     0 < W B\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "then"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     0 < W B", "have \"(\\<Sum>B \\<in> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B) \\<le> (\\<Sum>B \\<in> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V}). W B)\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     0 < W B\n\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> sum W\n           (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n            (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V}))", "using sum_Un_ge[OF FINITE(3,4), of W]"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     0 < W B\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V}).\n     0 < W B \\<Longrightarrow>\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> sum W\n         (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n          (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V}))\n\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> sum W\n           (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n            (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V}))", "by blast"], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> sum W\n         (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n          (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V}))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> sum W\n         (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n          (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V}))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W\n     (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n      (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V})) =\n    sum W\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})", "by (smt Un_assoc Un_commute)"], ["proof (state)\nthis:\n  sum W\n   (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n    (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V})) =\n  sum W\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W\n   (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n    (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V})) =\n  sum W\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = W U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}) =\n    W U", "using sum_Un_eq_sum_sum[OF invrules(1), symmetric]"], ["proof (prove)\nusing this:\n  sum W\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  W U\n\ngoal (1 subgoal):\n 1. sum W\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}) =\n    W U", "."], ["proof (state)\nthis:\n  sum W\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  W U\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "finally"], ["proof (chain)\npicking this:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U", "have *: \"(\\<Sum>B \\<in> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B) \\<le> W U\""], ["proof (prove)\nusing this:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U", ".\n\n  \\<comment> \\<open>This follows from the fourth and final additional conjunct of \\<open>inv\\<^sub>1\\<close> and is necessary to combine the sums of the bins\n      of the two partial solutions. This does not inherently follow from the union being a correct solution,\n      as this need not be the case if \\<open>P\\<^sub>1\\<close> and \\<open>P\\<^sub>2 \\<union> wrap B\\<^sub>2\\<close> happened to be equal.\\<close>"], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have DISJNT: \"P\\<^sub>1 \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}", "using invrules(5)"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}", "by blast\n\n  \\<comment> \\<open>This part of the proof is based on the proof on page 72 of the article @{cite BerghammerR03}.\\<close>"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"c * card P\\<^sub>1 = (\\<Sum>B \\<in> P\\<^sub>1. c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c * card P\\<^sub>1 = (\\<Sum>B\\<in>P\\<^sub>1. c)", "by simp"], ["proof (state)\nthis:\n  c * card P\\<^sub>1 = (\\<Sum>B\\<in>P\\<^sub>1. c)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  c * card P\\<^sub>1 = (\\<Sum>B\\<in>P\\<^sub>1. c)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... < (\\<Sum>B \\<in> P\\<^sub>1. W B + w (f B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (\\<Sum>B\\<in>P\\<^sub>1. c) < (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B))", "using f_def(2) sum_strict_mono[OF FINITE(1) False]"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n  (\\<And>x.\n      x \\<in> P\\<^sub>1 \\<Longrightarrow> ?f x < ?g x) \\<Longrightarrow>\n  sum ?f P\\<^sub>1 < sum ?g P\\<^sub>1\n\ngoal (1 subgoal):\n 1. real (\\<Sum>B\\<in>P\\<^sub>1. c) < (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B))", "by fastforce"], ["proof (state)\nthis:\n  real (\\<Sum>B\\<in>P\\<^sub>1. c) < (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  real (\\<Sum>B\\<in>P\\<^sub>1. c) < (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1. W B) + (\\<Sum>B \\<in> P\\<^sub>1. w (f B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B)) =\n    sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B))", "by (simp add: Groups_Big.comm_monoid_add_class.sum.distrib)"], ["proof (state)\nthis:\n  (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B)) =\n  sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B)) =\n  sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1. W B) + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B)) =\n    sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "unfolding sum.reindex_bij_betw[OF f_def(1), of w]"], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n    sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", ".."], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B)) =\n  sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B)) =\n  sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1. W B) + (\\<Sum>B \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n    sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "unfolding sum_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", ".."], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using sum.union_disjoint[OF FINITE(1,2) DISJNT, of W]"], ["proof (prove)\nusing this:\n  sum W (P\\<^sub>1 \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by (simp add: Un_assoc)"], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... \\<le> (\\<Sum>u \\<in> U. w u)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U", "using *"], ["proof (prove)\nusing this:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U", "."], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... \\<le> c * card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "using sum_lower_bound_card[OF assms(1)]"], ["proof (prove)\nusing this:\n  W U \\<le> real (c * card P)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "."], ["proof (state)\nthis:\n  W U \\<le> real (c * card P)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "finally"], ["proof (chain)\npicking this:\n  real (c * card P\\<^sub>1) < real (c * card P)", "show ?thesis"], ["proof (prove)\nusing this:\n  real (c * card P\\<^sub>1) < real (c * card P)\n\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "by (meson discrete nat_mult_less_cancel_disj of_nat_less_imp_less)"], ["proof (state)\nthis:\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>As @{thm wrap_card} holds, it follows that the amount of bins in \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1\\<close>\n      are a lower bound for the amount of bins in \\<open>P\\<close>.\\<close>"], ["", "lemma P\\<^sub>1_B\\<^sub>1_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "have \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n    \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)", "using card_Un_le"], ["proof (prove)\nusing this:\n  card (?A \\<union> ?B) \\<le> card ?A + card ?B\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n    \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)", "by blast"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n  \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "also"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n  \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "have \"... \\<le> card P\\<^sub>1 + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + card (wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + 1", "using wrap_card"], ["proof (prove)\nusing this:\n  card (wrap ?B) \\<le> 1\n\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + card (wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + 1", "by simp"], ["proof (state)\nthis:\n  card P\\<^sub>1 + card (wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + 1\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "also"], ["proof (state)\nthis:\n  card P\\<^sub>1 + card (wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + 1\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "have \"... \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "using P\\<^sub>1_lower_bound_card[OF assms]"], ["proof (prove)\nusing this:\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "."], ["proof (state)\nthis:\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "finally"], ["proof (chain)\npicking this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "show ?thesis"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "."], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>inv\\<^sub>1\\<close> holds, there are at most half as many bins in \\<open>P\\<^sub>2\\<close> as there are objects in \\<open>P\\<^sub>2\\<close>, and we can again\n      obtain a bijective function between the bins in \\<open>P\\<^sub>1\\<close> and the objects of the second partial solution,\n      then the amount of bins in the second partial solution are a strict lower bound for half the bins of\n      the first partial solution.\\<close>"], ["", "lemma P\\<^sub>2_B\\<^sub>2_lower_bound_P\\<^sub>1:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "note invrules = inv\\<^sub>1E[OF assms(1)] and bprules = bpE[OF invrules(1)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"pairwise disjnt (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using bprules(1) pairwise_subset"], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  \\<lbrakk>pairwise ?P ?S; ?T \\<subseteq> ?S\\<rbrakk>\n  \\<Longrightarrow> pairwise ?P ?T\n\ngoal (1 subgoal):\n 1. disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by blast"], ["proof (state)\nthis:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "moreover"], ["proof (state)\nthis:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"B\\<^sub>2 \\<notin> P\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<notin> P\\<^sub>2", "using invrules(4)"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<notin> P\\<^sub>2", "by simp"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "ultimately"], ["proof (chain)\npicking this:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  B\\<^sub>2 \\<notin> P\\<^sub>2", "have DISJNT: \"\\<Union>P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\""], ["proof (prove)\nusing this:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}", "by (auto, metis (no_types, hide_lams) sup_bot.right_neutral Un_insert_right disjnt_iff mk_disjoint_insert pairwise_insert wrap_Un)"], ["proof (state)\nthis:\n  \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"finite (\\<Union>P\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (\\<Union> P\\<^sub>2)", "using U_Finite bprules(3)"], ["proof (prove)\nusing this:\n  finite U\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. finite (\\<Union> P\\<^sub>2)", "by auto"], ["proof (state)\nthis:\n  finite (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"finite B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "using bp_bins_finite[OF invrules(1)] wrap_not_empty"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     finite B\n  (?M \\<noteq> {}) = (wrap ?M = {?M})\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "by blast"], ["proof (state)\nthis:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"finite P\\<^sub>2\" \"finite (wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite P\\<^sub>2 &&& finite (wrap B\\<^sub>2)", "using bp_sol_finite[OF invrules(1)]"], ["proof (prove)\nusing this:\n  finite\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. finite P\\<^sub>2 &&& finite (wrap B\\<^sub>2)", "by blast+"], ["proof (state)\nthis:\n  finite P\\<^sub>2\n  finite (wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have DISJNT2: \"P\\<^sub>2 \\<inter> wrap B\\<^sub>2 = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>2 \\<inter> wrap B\\<^sub>2 = {}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>2 \\<inter> (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) = {}", "using \\<open>B\\<^sub>2 \\<notin> P\\<^sub>2\\<close>"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. P\\<^sub>2 \\<inter> (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) = {}", "by auto"], ["proof (state)\nthis:\n  P\\<^sub>2 \\<inter> wrap B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "proof (cases \\<open>B\\<^sub>2 = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "case False"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "then"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<noteq> {}", "have \"1 \\<le> card B\\<^sub>2\""], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. 1 \\<le> card B\\<^sub>2", "by (simp add: leI \\<open>finite B\\<^sub>2\\<close>)"], ["proof (state)\nthis:\n  1 \\<le> card B\\<^sub>2\n\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "then"], ["proof (chain)\npicking this:\n  1 \\<le> card B\\<^sub>2", "show ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "using wrap_card[of B\\<^sub>2]"], ["proof (prove)\nusing this:\n  1 \\<le> card B\\<^sub>2\n  card (wrap B\\<^sub>2) \\<le> 1\n\ngoal (1 subgoal):\n 1. card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "by linarith"], ["proof (state)\nthis:\n  card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "qed simp\n\n  \\<comment> \\<open>This part of the proof is based on the proof on page 73 of the article @{cite BerghammerR03}.\\<close>"], ["proof (state)\nthis:\n  card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "from assms(2)"], ["proof (chain)\npicking this:\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "have \"2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2) \\<le> card (\\<Union>P\\<^sub>2) + card (wrap B\\<^sub>2) + 1\""], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n    \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1", "using wrap_card[of B\\<^sub>2]"], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  card (wrap B\\<^sub>2) \\<le> 1\n\ngoal (1 subgoal):\n 1. 2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n    \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1", "by linarith"], ["proof (state)\nthis:\n  2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "then"], ["proof (chain)\npicking this:\n  2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1", "have \"2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2)) \\<le> card (\\<Union>P\\<^sub>2) + card B\\<^sub>2 + 1\""], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1\n\ngoal (1 subgoal):\n 1. 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n    \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1", "using \\<open>card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\\<close>"], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1\n  card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n    \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1", "by simp"], ["proof (state)\nthis:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "then"], ["proof (chain)\npicking this:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1", "have \"2 * (card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<le> card (\\<Union>P\\<^sub>2 \\<union> B\\<^sub>2) + 1\""], ["proof (prove)\nusing this:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1", "using card_Un_disjoint[OF \\<open>finite (\\<Union>P\\<^sub>2)\\<close> \\<open>finite B\\<^sub>2\\<close> DISJNT]\n      and card_Un_disjoint[OF \\<open>finite P\\<^sub>2\\<close> \\<open>finite (wrap B\\<^sub>2)\\<close> DISJNT2]"], ["proof (prove)\nusing this:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1\n  card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) =\n  card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  card P\\<^sub>2 + card (wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1", "by argo"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "then"], ["proof (chain)\npicking this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1", "have \"2 * (card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<le> card (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\""], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1", "by (cases \\<open>B\\<^sub>2 = {}\\<close>) (auto simp: Un_commute)"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "then"], ["proof (chain)\npicking this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1", "show \"2 * (card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<le> card P\\<^sub>1 + 1\""], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "using assms(3) bij_betw_same_card"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  bij_betw ?f ?A ?B \\<Longrightarrow> card ?A = card ?B\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\n  \\<exists>f.\n     bij_betw f P\\<^sub>1\n      (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n     (\\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B))\n  bij_betw ?f ?A ?B \\<Longrightarrow> card ?A = card ?B\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "by metis"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Proving the Approximation Factor\\<close>"], ["", "text \\<open>We define \\<open>inv\\<^sub>2\\<close> as it is defined in the article.\n      These conjuncts allow us to prove the desired approximation factor.\\<close>"], ["", "definition inv\\<^sub>2 :: \"'a set set \\<Rightarrow> 'a set set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> bool\" where\n  \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<longleftrightarrow> inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<comment> \\<open>\\<open>inv\\<^sub>1\\<close> holds for the partial solution\\<close>\n                       \\<and> (V \\<inter> L \\<noteq> {} \\<longrightarrow> (\\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {})) \\<comment> \\<open>If there are still large objects left, then every bin of the first partial solution must contain a large object\\<close>\n                       \\<and> bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<comment> \\<open>There exists a bijective function between the bins of the first partial solution and the objects of the second one\\<close>\n                       \\<and> (2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)) \\<comment> \\<open>There are at most twice as many bins in \\<open>P\\<^sub>2\\<close> as there are objects in \\<open>P\\<^sub>2\\<close>\\<close>\""], ["", "lemma inv\\<^sub>2E:\n  assumes \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n    and \"V \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\"\n    and \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n    and \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V &&&\n     (V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n      \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n         B \\<inter> L \\<noteq> {})) &&&\n    bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n\ngoal (1 subgoal):\n 1. (inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V &&&\n     (V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n      \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n         B \\<inter> L \\<noteq> {})) &&&\n    bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "unfolding inv\\<^sub>2_def"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n   (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       B \\<inter> L \\<noteq> {})) \\<and>\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. (inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V &&&\n     (V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n      \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n         B \\<inter> L \\<noteq> {})) &&&\n    bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "by blast+"], ["", "lemma inv\\<^sub>2I:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n    and \"V \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\"\n    and \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n    and \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\"\n  shows \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", "unfolding inv\\<^sub>2_def"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n    (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n     (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n         B \\<inter> L \\<noteq> {})) \\<and>\n    bij_exists P\\<^sub>1\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n    2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "by blast"], ["", "text \\<open>If \\<open>P\\<close> is a correct solution of the bin packing problem, \\<open>inv\\<^sub>2\\<close> holds for the partial solution,\n      and there are no more small objects left to be distributed, then the amount of bins of the partial solution\n      is no larger than \\<open>3 / 2\\<close> of the amount of bins in \\<open>P\\<close>. This proof strongly follows the proof in\n      \\<open>Theorem 4.1\\<close> of the article @{cite BerghammerR03}.\\<close>"], ["", "lemma bin_packing_lower_bound_card:\n  assumes \"V \\<inter> S = {}\" \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"bp P\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}) \\<le> 3 / 2 * card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "proof (cases \\<open>V = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "note invrules = inv\\<^sub>2E[OF assms(2)]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "case True"], ["proof (state)\nthis:\n  V = {}\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "then"], ["proof (chain)\npicking this:\n  V = {}", "have \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\n           = card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\nusing this:\n  V = {}\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}) =\n    card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)", "by simp"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)\n    \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n          card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using card_Un_le[of \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1\\<close>]"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> ?B)\n  \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) + card ?B\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)\n    \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n          card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by (simp add: Un_assoc)"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n  \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n        card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n  \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n        card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n    card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using P\\<^sub>1_B\\<^sub>1_lower_bound_card[OF assms(3) invrules(1,3)]"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n    card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by simp"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card P + card P / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n    \\<le> real (card P) + real (card P) / 2", "using P\\<^sub>2_B\\<^sub>2_lower_bound_P\\<^sub>1[OF invrules(1,4,3)]\n      and P\\<^sub>1_lower_bound_card[OF assms(3) invrules(1,3)]"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n    \\<le> real (card P) + real (card P) / 2", "by linarith"], ["proof (state)\nthis:\n  real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<le> real (card P) + real (card P) / 2\n\ngoal (2 subgoals):\n 1. V = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)\n 2. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}))\n  \\<le> real (card P) + real (card P) / 2", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}))\n  \\<le> real (card P) + real (card P) / 2\n\ngoal (1 subgoal):\n 1. real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "by linarith"], ["proof (state)\nthis:\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}))\n  \\<le> 3 / 2 * real (card P)\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "note invrules = inv\\<^sub>2E[OF assms(2)]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "case False"], ["proof (state)\nthis:\n  V \\<noteq> {}\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "have \"U = S \\<union> L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U = S \\<union> L", "using S_def L_def"], ["proof (prove)\nusing this:\n  S = {u \\<in> U. w u \\<le> real c / 2}\n  L = U - S\n\ngoal (1 subgoal):\n 1. U = S \\<union> L", "by blast"], ["proof (state)\nthis:\n  U = S \\<union> L\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "then"], ["proof (chain)\npicking this:\n  U = S \\<union> L", "have *: \"V = V \\<inter> L\""], ["proof (prove)\nusing this:\n  U = S \\<union> L\n\ngoal (1 subgoal):\n 1. V = V \\<inter> L", "using bpE(3)[OF inv\\<^sub>1E(1)[OF invrules(1)]]\n      and assms(1)"], ["proof (prove)\nusing this:\n  U = S \\<union> L\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  V \\<inter> S = {}\n\ngoal (1 subgoal):\n 1. V = V \\<inter> L", "by blast"], ["proof (state)\nthis:\n  V = V \\<inter> L\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "with False"], ["proof (chain)\npicking this:\n  V \\<noteq> {}\n  V = V \\<inter> L", "have NE: \"V \\<inter> L \\<noteq> {}\""], ["proof (prove)\nusing this:\n  V \\<noteq> {}\n  V = V \\<inter> L\n\ngoal (1 subgoal):\n 1. V \\<inter> L \\<noteq> {}", "by simp"], ["proof (state)\nthis:\n  V \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "have \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\n      = card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L} \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}) =\n    card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)", "using *"], ["proof (prove)\nusing this:\n  V = V \\<inter> L\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}) =\n    card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)", "by (simp add: Un_commute Un_assoc)"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L}) + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)\n    \\<le> card\n           (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n            {{v} |v. v \\<in> V \\<inter> L}) +\n          card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using card_Un_le[of \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> V \\<inter> L}\\<close>]"], ["proof (prove)\nusing this:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L} \\<union>\n    ?B)\n  \\<le> card\n         (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n          {{v} |v. v \\<in> V \\<inter> L}) +\n        card ?B\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)\n    \\<le> card\n           (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n            {{v} |v. v \\<in> V \\<inter> L}) +\n          card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by (simp add: Un_assoc)"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n  \\<le> card\n         (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n          {{v} |v. v \\<in> V \\<inter> L}) +\n        card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n  \\<le> card\n         (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n          {{v} |v. v \\<in> V \\<inter> L}) +\n        card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L}) +\n    card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using L_bins_lower_bound_card[OF assms(3) invrules(1) invrules(2)[OF NE]]"], ["proof (prove)\nusing this:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L})\n  \\<le> card P\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> V \\<inter> L}) +\n    card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by linarith"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L}) +\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n    {{v} |v. v \\<in> V \\<inter> L}) +\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card P + card P / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n    \\<le> real (card P) + real (card P) / 2", "using P\\<^sub>2_B\\<^sub>2_lower_bound_P\\<^sub>1[OF invrules(1,4,3)]\n      and P\\<^sub>1_lower_bound_card[OF assms(3) invrules(1,3)]"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n    \\<le> real (card P) + real (card P) / 2", "by linarith"], ["proof (state)\nthis:\n  real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<le> real (card P) + real (card P) / 2\n\ngoal (1 subgoal):\n 1. V \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}))\n  \\<le> real (card P) + real (card P) / 2", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}))\n  \\<le> real (card P) + real (card P) / 2\n\ngoal (1 subgoal):\n 1. real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}))\n    \\<le> 3 / 2 * real (card P)", "by linarith"], ["proof (state)\nthis:\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}))\n  \\<le> 3 / 2 * real (card P)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>We define \\<open>inv\\<^sub>3\\<close> as it is defined in the article.\n      This final conjunct allows us to prove that the invariant will be maintained by the algorithm.\\<close>"], ["", "definition inv\\<^sub>3 :: \"'a set set \\<Rightarrow> 'a set set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> bool\" where\n  \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<longleftrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and> B\\<^sub>2 \\<subseteq> S\""], ["", "lemma inv\\<^sub>3E:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n  shows \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" and \"B\\<^sub>2 \\<subseteq> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V &&&\n    B\\<^sub>2 \\<subseteq> S", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V &&&\n    B\\<^sub>2 \\<subseteq> S", "unfolding inv\\<^sub>3_def"], ["proof (prove)\nusing this:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  B\\<^sub>2 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V &&&\n    B\\<^sub>2 \\<subseteq> S", "by blast+"], ["", "lemma inv\\<^sub>3I:\n  assumes \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" and \"B\\<^sub>2 \\<subseteq> S\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  B\\<^sub>2 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", "unfolding inv\\<^sub>3_def"], ["proof (prove)\nusing this:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  B\\<^sub>2 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n    B\\<^sub>2 \\<subseteq> S", "by blast"], ["", "lemma loop_init:\n  \"inv\\<^sub>3 {} {} {} {} U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} U", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} U", "have *: \"inv\\<^sub>1 {} {} {} {} U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 {} {} {} {} U", "unfolding bp_def partition_on_def pairwise_def wrap_def inv\\<^sub>1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<Union>\n       ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n        (if {} = {} then {} else {{}}) \\<union>\n        {{v} |v. v \\<in> U}) =\n      U \\<and>\n      (\\<forall>x\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                      {} \\<union>\n                      (if {} = {} then {} else {{}}) \\<union>\n                      {{v} |v. v \\<in> U}.\n          \\<forall>y\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                         {} \\<union>\n                         (if {} = {} then {} else {{}}) \\<union>\n                         {{v} |v. v \\<in> U}.\n             x \\<noteq> y \\<longrightarrow> disjnt x y) \\<and>\n      {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                  {} \\<union>\n                  (if {} = {} then {} else {{}}) \\<union>\n                  {{v} |v. v \\<in> U}) \\<and>\n     (\\<forall>B\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                     {} \\<union>\n                     (if {} = {} then {} else {{}}) \\<union>\n                     {{v} |v. v \\<in> U}.\n         W B \\<le> real c)) \\<and>\n    \\<Union>\n     ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n      (if {} = {} then {} else {{}})) =\n    U - U \\<and>\n    {} \\<notin> {} \\<union> {} \\<union>\n                (if {} = {} then {} else {{}}) \\<and>\n    {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                {} \\<and>\n    ({} \\<union> (if {} = {} then {} else {{}})) \\<inter>\n    ({} \\<union> (if {} = {} then {} else {{}})) =\n    {}", "using weight"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. ((\\<Union>\n       ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n        (if {} = {} then {} else {{}}) \\<union>\n        {{v} |v. v \\<in> U}) =\n      U \\<and>\n      (\\<forall>x\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                      {} \\<union>\n                      (if {} = {} then {} else {{}}) \\<union>\n                      {{v} |v. v \\<in> U}.\n          \\<forall>y\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                         {} \\<union>\n                         (if {} = {} then {} else {{}}) \\<union>\n                         {{v} |v. v \\<in> U}.\n             x \\<noteq> y \\<longrightarrow> disjnt x y) \\<and>\n      {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                  {} \\<union>\n                  (if {} = {} then {} else {{}}) \\<union>\n                  {{v} |v. v \\<in> U}) \\<and>\n     (\\<forall>B\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                     {} \\<union>\n                     (if {} = {} then {} else {{}}) \\<union>\n                     {{v} |v. v \\<in> U}.\n         W B \\<le> real c)) \\<and>\n    \\<Union>\n     ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n      (if {} = {} then {} else {{}})) =\n    U - U \\<and>\n    {} \\<notin> {} \\<union> {} \\<union>\n                (if {} = {} then {} else {{}}) \\<and>\n    {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                {} \\<and>\n    ({} \\<union> (if {} = {} then {} else {{}})) \\<inter>\n    ({} \\<union> (if {} = {} then {} else {{}})) =\n    {}", "by auto"], ["proof (state)\nthis:\n  inv\\<^sub>1 {} {} {} {} U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} U", "have \"bij_exists {} (\\<Union> ({} \\<union> wrap {}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_exists {} (\\<Union> ({} \\<union> wrap {}))", "using bij_betwI'"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              \\<lbrakk>x \\<in> ?X; y \\<in> ?X\\<rbrakk>\n              \\<Longrightarrow> (?f x = ?f y) = (x = y);\n   \\<And>x. x \\<in> ?X \\<Longrightarrow> ?f x \\<in> ?Y;\n   \\<And>y.\n      y \\<in> ?Y \\<Longrightarrow> \\<exists>x\\<in>?X. y = ?f x\\<rbrakk>\n  \\<Longrightarrow> bij_betw ?f ?X ?Y\n\ngoal (1 subgoal):\n 1. bij_exists {} (\\<Union> ({} \\<union> wrap {}))", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              \\<lbrakk>x \\<in> ?X; y \\<in> ?X\\<rbrakk>\n              \\<Longrightarrow> (?f x = ?f y) = (x = y);\n   \\<And>x. x \\<in> ?X \\<Longrightarrow> ?f x \\<in> ?Y;\n   \\<And>y.\n      y \\<in> ?Y \\<Longrightarrow> \\<exists>x\\<in>?X. y = ?f x\\<rbrakk>\n  \\<Longrightarrow> bij_betw ?f ?X ?Y\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       bij_betw f {} (\\<Union> ({} \\<union> wrap {})) \\<and>\n       (\\<forall>B\\<in>{}. real c < W B + w (f B))", "by fastforce"], ["proof (state)\nthis:\n  bij_exists {} (\\<Union> ({} \\<union> wrap {}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} U", "from inv\\<^sub>2I[OF * _ this]"], ["proof (chain)\npicking this:\n  \\<lbrakk>U \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           \\<forall>B\\<in>{} \\<union> wrap {}. B \\<inter> L \\<noteq> {};\n   2 * card {} \\<le> card (\\<Union> {})\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 {} {} {} {} U", "have \"inv\\<^sub>2 {} {} {} {} U\""], ["proof (prove)\nusing this:\n  \\<lbrakk>U \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           \\<forall>B\\<in>{} \\<union> wrap {}. B \\<inter> L \\<noteq> {};\n   2 * card {} \\<le> card (\\<Union> {})\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 {} {} {} {} U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 {} {} {} {} U", "by auto"], ["proof (state)\nthis:\n  inv\\<^sub>2 {} {} {} {} U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} U", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  {} \\<subseteq> S \\<Longrightarrow> inv\\<^sub>3 {} {} {} {} U", "show ?thesis"], ["proof (prove)\nusing this:\n  {} \\<subseteq> S \\<Longrightarrow> inv\\<^sub>3 {} {} {} {} U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} U", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>3 {} {} {} {} U\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>B\\<^sub>1\\<close> is empty and there are no large objects left, then \\<open>inv\\<^sub>3\\<close> will be maintained\n      if \\<open>B\\<^sub>1\\<close> is initialized with \\<open>u \\<in> V \\<inter> S\\<close>.\\<close>"], ["", "lemma loop_stepA:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 = {}\" \"V \\<inter> L = {}\" \"u \\<in> V \\<inter> S\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "have WEIGHT: \"W B\\<^sub>1 + w u \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "using S_def assms(2,4)"], ["proof (prove)\nusing this:\n  S = {u \\<in> U. w u \\<le> real c / 2}\n  B\\<^sub>1 = {}\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "by simp"], ["proof (state)\nthis:\n  W B\\<^sub>1 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "from assms(4)"], ["proof (chain)\npicking this:\n  u \\<in> V \\<inter> S", "have \"u \\<in> V\""], ["proof (prove)\nusing this:\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. u \\<in> V", "by blast"], ["proof (state)\nthis:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "from inv\\<^sub>1_stepA[OF invrules(1) this WEIGHT] assms(2)"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n  B\\<^sub>1 = {}", "have 1: \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n  B\\<^sub>1 = {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "by simp"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "have 2: \"(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L \\<noteq> {}", "using assms(3)"], ["proof (prove)\nusing this:\n  V \\<inter> L = {}\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "from inv\\<^sub>2I[OF 1 2] invrules"], ["proof (chain)\npicking this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "have \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\""], ["proof (prove)\nusing this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "using inv\\<^sub>3E(2)[OF assms(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n  B\\<^sub>2 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>B\\<^sub>1\\<close> is empty and there are large objects left, then \\<open>inv\\<^sub>3\\<close> will be maintained\n      if \\<open>B\\<^sub>1\\<close> is initialized with \\<open>u \\<in> V \\<inter> L\\<close>.\\<close>"], ["", "lemma loop_stepB:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 = {}\" \"u \\<in> V \\<inter> L\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "have WEIGHT: \"W B\\<^sub>1 + w u \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "using L_def weight assms(2,3)"], ["proof (prove)\nusing this:\n  L = U - S\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n  B\\<^sub>1 = {}\n  u \\<in> V \\<inter> L\n\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "by simp"], ["proof (state)\nthis:\n  W B\\<^sub>1 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "from assms(3)"], ["proof (chain)\npicking this:\n  u \\<in> V \\<inter> L", "have \"u \\<in> V\""], ["proof (prove)\nusing this:\n  u \\<in> V \\<inter> L\n\ngoal (1 subgoal):\n 1. u \\<in> V", "by blast"], ["proof (state)\nthis:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "from inv\\<^sub>1_stepA[OF invrules(1) this WEIGHT] assms(2)"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n  B\\<^sub>1 = {}", "have 1: \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n  B\\<^sub>1 = {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "by simp"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "have \"\\<forall>B\\<in>P\\<^sub>1. B \\<inter> L \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1. B \\<inter> L \\<noteq> {}", "using assms(3) invrules(2)"], ["proof (prove)\nusing this:\n  u \\<in> V \\<inter> L\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1. B \\<inter> L \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "then"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>P\\<^sub>1. B \\<inter> L \\<noteq> {}", "have 2: \"(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L \\<noteq> {}\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L \\<noteq> {}", "using assms(3)"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1. B \\<inter> L \\<noteq> {}\n  u \\<in> V \\<inter> L\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L \\<noteq> {}", "by (metis Int_iff UnE empty_iff insertE singletonI wrap_not_empty)"], ["proof (state)\nthis:\n  (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "from inv\\<^sub>2I[OF 1 2] invrules"], ["proof (chain)\npicking this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "have \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\""], ["proof (prove)\nusing this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "using inv\\<^sub>3E(2)[OF assms(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n  B\\<^sub>2 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>B\\<^sub>1\\<close> is not empty and \\<open>u \\<in> V \\<inter> S\\<close> does not exceed its maximum capacity, then \\<open>inv\\<^sub>3\\<close>\n      will be maintained if \\<open>B\\<^sub>1\\<close> and \\<open>{u}\\<close> are replaced with \\<open>B\\<^sub>1 \\<union> {u}\\<close>.\\<close>"], ["", "lemma loop_stepC:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> V \\<inter> S\" \"W B\\<^sub>1 + w(u) \\<le> c\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from assms(3)"], ["proof (chain)\npicking this:\n  u \\<in> V \\<inter> S", "have \"u \\<in> V\""], ["proof (prove)\nusing this:\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. u \\<in> V", "by blast"], ["proof (state)\nthis:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from inv\\<^sub>1_stepA[OF invrules(1) this assms(4)]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})", "have 1: \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (V - {u})\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       B \\<inter> L \\<noteq> {}", "using invrules(2)"], ["proof (prove)\nusing this:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       B \\<inter> L \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}", "have 2: \"(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}). B \\<inter> L \\<noteq> {}\""], ["proof (prove)\nusing this:\n  (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}).\n       B \\<inter> L \\<noteq> {}", "by (metis Int_commute Un_empty_right Un_insert_right assms(2) disjoint_insert(2) insert_iff wrap_not_empty)"], ["proof (state)\nthis:\n  (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}).\n     B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from inv\\<^sub>2I[OF 1 2] invrules"], ["proof (chain)\npicking this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u})\n                     B\\<^sub>2 (V - {u})\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "have \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (V - {u})\""], ["proof (prove)\nusing this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u})\n                     B\\<^sub>2 (V - {u})\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "using inv\\<^sub>3E(2)[OF assms(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n  B\\<^sub>2 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>B\\<^sub>1\\<close> is not empty and \\<open>u \\<in> V \\<inter> S\\<close> does exceed its maximum capacity but not the capacity of \\<open>B\\<^sub>2\\<close>,\n      then \\<open>inv\\<^sub>3\\<close> will be maintained if \\<open>B\\<^sub>1\\<close> is added to \\<open>P\\<^sub>1\\<close> and emptied, and \\<open>B\\<^sub>2\\<close> and \\<open>{u}\\<close> are replaced with \\<open>B\\<^sub>2 \\<union> {u}\\<close>.\\<close>"], ["", "lemma loop_stepD:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> V \\<inter> S\" \"W B\\<^sub>1 + w(u) > c\" \"W B\\<^sub>2 + w(u) \\<le> c\"\n  shows \"inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from assms(3)"], ["proof (chain)\npicking this:\n  u \\<in> V \\<inter> S", "have \"u \\<in> V\""], ["proof (prove)\nusing this:\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. u \\<in> V", "by blast"], ["proof (state)\nthis:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from inv\\<^sub>1_stepB[OF invrules(1) this assms(5)]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 1: \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 2: \"(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}. B \\<inter> L \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n       B \\<inter> L \\<noteq> {}", "using invrules(2)"], ["proof (prove)\nusing this:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n       B \\<inter> L \\<noteq> {}", "unfolding wrap_empty"], ["proof (prove)\nusing this:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {}.\n       B \\<inter> L \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n     B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from invrules(3)"], ["proof (chain)\npicking this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "obtain f where f_def: \"bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\" \"\\<forall>B\\<in>P\\<^sub>1. c < W B + w (f B)\""], ["proof (prove)\nusing this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     bij_betw f P\\<^sub>1\n      (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n     (\\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"B\\<^sub>1 \\<notin> P\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<notin> P\\<^sub>1", "using inv\\<^sub>1E(3)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<notin> P\\<^sub>1", "by blast"], ["proof (state)\nthis:\n  B\\<^sub>1 \\<notin> P\\<^sub>1\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"u \\<notin> (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using inv\\<^sub>1E(2)[OF invrules(1)] assms(3)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by blast"], ["proof (state)\nthis:\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "have \"(\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}))\""], ["proof (prove)\nusing this:\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})", "by (metis Sup_empty Un_assoc Union_Un_distrib ccpo_Sup_singleton wrap_empty wrap_not_empty)"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "also"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"... = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "by simp"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "finally"], ["proof (chain)\npicking this:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "have UN: \"(\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\nusing this:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "."], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"wrap B\\<^sub>1 = {B\\<^sub>1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wrap B\\<^sub>1 = {B\\<^sub>1}", "using wrap_not_empty[of B\\<^sub>1] assms(2)"], ["proof (prove)\nusing this:\n  (B\\<^sub>1 \\<noteq> {}) = (wrap B\\<^sub>1 = {B\\<^sub>1})\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. wrap B\\<^sub>1 = {B\\<^sub>1}", "by simp"], ["proof (state)\nthis:\n  wrap B\\<^sub>1 = {B\\<^sub>1}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "let ?f = \"f (B\\<^sub>1 := u)\""], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have BIJ: \"bij_betw ?f (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))", "unfolding wrap_empty \\<open>wrap B\\<^sub>1 = {B\\<^sub>1}\\<close> UN"], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> {B\\<^sub>1})\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u})", "using f_def(1) \\<open>B\\<^sub>1 \\<notin> P\\<^sub>1\\<close> \\<open>u \\<notin> (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\\<close>"], ["proof (prove)\nusing this:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  B\\<^sub>1 \\<notin> P\\<^sub>1\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> {B\\<^sub>1})\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u})", "by (metis (no_types, lifting) bij_betw_cong fun_upd_other fun_upd_same notIn_Un_bij_betw3)"], ["proof (state)\nthis:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"c < W B\\<^sub>1 + w (?f B\\<^sub>1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "using assms(4)"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w u\n\ngoal (1 subgoal):\n 1. real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "by simp"], ["proof (state)\nthis:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "have \"(\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. c < W B + w (?f B))\""], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "unfolding \\<open>wrap B\\<^sub>1 = {B\\<^sub>1}\\<close>"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> {B\\<^sub>1}.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "using f_def(2)"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> {B\\<^sub>1}.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "by simp"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "with BIJ"], ["proof (chain)\npicking this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)", "have \"bij_betw ?f (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n              \\<and> (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. c < W B + w (?f B))\""], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)\n\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n    (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n        real c < W B + w ((f(B\\<^sub>1 := u)) B))", "by blast"], ["proof (state)\nthis:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))", "have 3: \"bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\""], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       bij_betw f (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n        (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n       (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n           real c < W B + w (f B))", "by blast"], ["proof (state)\nthis:\n  bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from inv\\<^sub>2I[OF 1 2 3]"], ["proof (chain)\npicking this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\""], ["proof (prove)\nusing this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "using invrules(4)"], ["proof (prove)\nusing this:\n  \\<lbrakk>(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n           (V - {u}) \\<inter> L \\<noteq> {};\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<union> {u} \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<union> {u} \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "using inv\\<^sub>3E(2)[OF assms(1)] assms(3)"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<union> {u} \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n  B\\<^sub>2 \\<subseteq> S\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If the maximum capacity of \\<open>B\\<^sub>2\\<close> is exceeded by \\<open>u \\<in> V \\<inter> S\\<close>,\n      then \\<open>B\\<^sub>2\\<close> must contain at least two objects.\\<close>"], ["", "lemma B\\<^sub>2_at_least_two_objects:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V \\<inter> S\" \"W B\\<^sub>2 + w(u) > c\"\n  shows \"2 \\<le> card B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<le> card B\\<^sub>2", "proof (rule ccontr, simp add: not_le)"], ["proof (state)\ngoal (1 subgoal):\n 1. card B\\<^sub>2 < 2 \\<Longrightarrow> False", "have FINITE: \"finite B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "using inv\\<^sub>1E(1)[OF inv\\<^sub>2E(1)[OF inv\\<^sub>3E(1)[OF assms(1)]]]"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "by (metis (no_types, lifting) Finite_Set.finite.simps U_Finite Union_Un_distrib bpE(3) ccpo_Sup_singleton finite_Un wrap_not_empty)"], ["proof (state)\nthis:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 < 2 \\<Longrightarrow> False", "assume \"card B\\<^sub>2 < 2\""], ["proof (state)\nthis:\n  card B\\<^sub>2 < 2\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 < 2 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  card B\\<^sub>2 < 2", "consider (0) \"card B\\<^sub>2 = 0\" | (1) \"card B\\<^sub>2 = 1\""], ["proof (prove)\nusing this:\n  card B\\<^sub>2 < 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>card B\\<^sub>2 = 0 \\<Longrightarrow> thesis;\n     card B\\<^sub>2 = 1 \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by linarith"], ["proof (state)\nthis:\n  \\<lbrakk>card B\\<^sub>2 = 0 \\<Longrightarrow> ?thesis;\n   card B\\<^sub>2 = 1 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 < 2 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>card B\\<^sub>2 = 0 \\<Longrightarrow> ?thesis;\n   card B\\<^sub>2 = 1 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis", "show False"], ["proof (prove)\nusing this:\n  \\<lbrakk>card B\\<^sub>2 = 0 \\<Longrightarrow> ?thesis;\n   card B\\<^sub>2 = 1 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. False", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. card B\\<^sub>2 = 0 \\<Longrightarrow> False\n 2. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "case 0"], ["proof (state)\nthis:\n  card B\\<^sub>2 = 0\n\ngoal (2 subgoals):\n 1. card B\\<^sub>2 = 0 \\<Longrightarrow> False\n 2. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  card B\\<^sub>2 = 0", "have \"B\\<^sub>2 = {}\""], ["proof (prove)\nusing this:\n  card B\\<^sub>2 = 0\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 = {}", "using FINITE"], ["proof (prove)\nusing this:\n  card B\\<^sub>2 = 0\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 = {}", "by simp"], ["proof (state)\nthis:\n  B\\<^sub>2 = {}\n\ngoal (2 subgoals):\n 1. card B\\<^sub>2 = 0 \\<Longrightarrow> False\n 2. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  B\\<^sub>2 = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. False", "using assms(2,3) S_def"], ["proof (prove)\nusing this:\n  B\\<^sub>2 = {}\n  u \\<in> V \\<inter> S\n  real c < W B\\<^sub>2 + w u\n  S = {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "case 1"], ["proof (state)\nthis:\n  card B\\<^sub>2 = 1\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  card B\\<^sub>2 = 1", "obtain v where \"B\\<^sub>2 = {v}\""], ["proof (prove)\nusing this:\n  card B\\<^sub>2 = 1\n\ngoal (1 subgoal):\n 1. (\\<And>v. B\\<^sub>2 = {v} \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using card_1_singletonE"], ["proof (prove)\nusing this:\n  card B\\<^sub>2 = 1\n  \\<lbrakk>card ?A = 1; \\<And>x. ?A = {x} \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>v. B\\<^sub>2 = {v} \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  B\\<^sub>2 = {v}\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "with inv\\<^sub>3E(2)[OF assms(1)]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<subseteq> S\n  B\\<^sub>2 = {v}", "have \"2 * w v \\<le> c\""], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> S\n  B\\<^sub>2 = {v}\n\ngoal (1 subgoal):\n 1. 2 * w v \\<le> real c", "using S_def"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> S\n  B\\<^sub>2 = {v}\n  S = {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. 2 * w v \\<le> real c", "by simp"], ["proof (state)\nthis:\n  2 * w v \\<le> real c\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  2 * w v \\<le> real c\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "from \\<open>B\\<^sub>2 = {v}\\<close>"], ["proof (chain)\npicking this:\n  B\\<^sub>2 = {v}", "have \"W B\\<^sub>2 = w v\""], ["proof (prove)\nusing this:\n  B\\<^sub>2 = {v}\n\ngoal (1 subgoal):\n 1. W B\\<^sub>2 = w v", "by simp"], ["proof (state)\nthis:\n  W B\\<^sub>2 = w v\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  2 * w v \\<le> real c\n  W B\\<^sub>2 = w v", "show ?thesis"], ["proof (prove)\nusing this:\n  2 * w v \\<le> real c\n  W B\\<^sub>2 = w v\n\ngoal (1 subgoal):\n 1. False", "using assms(2,3) S_def"], ["proof (prove)\nusing this:\n  2 * w v \\<le> real c\n  W B\\<^sub>2 = w v\n  u \\<in> V \\<inter> S\n  real c < W B\\<^sub>2 + w u\n  S = {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If \\<open>B\\<^sub>1\\<close> is not empty and \\<open>u \\<in> V \\<inter> S\\<close> exceeds the maximum capacity of both \\<open>B\\<^sub>1\\<close> and \\<open>B\\<^sub>2\\<close>,\n      then \\<open>inv\\<^sub>3\\<close> will be maintained if \\<open>B\\<^sub>1\\<close> and \\<open>B\\<^sub>2\\<close> are added to \\<open>P\\<^sub>1\\<close> and \\<open>P\\<^sub>2\\<close> respectively,\n      emptied, and \\<open>B\\<^sub>2\\<close> initialized with \\<open>u\\<close>.\\<close>"], ["", "lemma loop_stepE:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> V \\<inter> S\" \"W B\\<^sub>1 + w(u) > c\" \"W B\\<^sub>2 + w(u) > c\"\n  shows \"inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from assms(3)"], ["proof (chain)\npicking this:\n  u \\<in> V \\<inter> S", "have \"u \\<in> V\""], ["proof (prove)\nusing this:\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. u \\<in> V", "by blast"], ["proof (state)\nthis:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from inv\\<^sub>1_stepC[OF invrules(1) this]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 1: \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 2: \"(V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}. B \\<inter> L \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n       B \\<inter> L \\<noteq> {}", "using invrules(2)"], ["proof (prove)\nusing this:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n       B \\<inter> L \\<noteq> {}", "unfolding wrap_empty"], ["proof (prove)\nusing this:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {}.\n       B \\<inter> L \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  (V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n     B \\<inter> L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from invrules(3)"], ["proof (chain)\npicking this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "obtain f where f_def: \"bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\" \"\\<forall>B\\<in>P\\<^sub>1. c < W B + w (f B)\""], ["proof (prove)\nusing this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     bij_betw f P\\<^sub>1\n      (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n     (\\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"B\\<^sub>1 \\<notin> P\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<notin> P\\<^sub>1", "using inv\\<^sub>1E(3)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<notin> P\\<^sub>1", "by blast"], ["proof (state)\nthis:\n  B\\<^sub>1 \\<notin> P\\<^sub>1\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"u \\<notin> (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using inv\\<^sub>1E(2)[OF invrules(1)] assms(3)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by blast"], ["proof (state)\nthis:\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"(\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n      (if {u} = {} then {} else {{u}})) =\n    \\<Union>\n     (P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n      {{u}})", "by simp"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "also"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"... = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "by simp"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "finally"], ["proof (chain)\npicking this:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "have UN: \"(\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\nusing this:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "."], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"wrap B\\<^sub>1 = {B\\<^sub>1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wrap B\\<^sub>1 = {B\\<^sub>1}", "using wrap_not_empty[of B\\<^sub>1] assms(2)"], ["proof (prove)\nusing this:\n  (B\\<^sub>1 \\<noteq> {}) = (wrap B\\<^sub>1 = {B\\<^sub>1})\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. wrap B\\<^sub>1 = {B\\<^sub>1}", "by simp"], ["proof (state)\nthis:\n  wrap B\\<^sub>1 = {B\\<^sub>1}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "let ?f = \"f (B\\<^sub>1 := u)\""], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have BIJ: \"bij_betw ?f (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))", "unfolding wrap_empty \\<open>wrap B\\<^sub>1 = {B\\<^sub>1}\\<close> UN"], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> {B\\<^sub>1})\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u})", "using f_def(1) \\<open>B\\<^sub>1 \\<notin> P\\<^sub>1\\<close> \\<open>u \\<notin> (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\\<close>"], ["proof (prove)\nusing this:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  B\\<^sub>1 \\<notin> P\\<^sub>1\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> {B\\<^sub>1})\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u})", "by (metis (no_types, lifting) bij_betw_cong fun_upd_other fun_upd_same notIn_Un_bij_betw3)"], ["proof (state)\nthis:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"c < W B\\<^sub>1 + w (?f B\\<^sub>1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "using assms(4)"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w u\n\ngoal (1 subgoal):\n 1. real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "by simp"], ["proof (state)\nthis:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "then"], ["proof (chain)\npicking this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "have \"(\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. c < W B + w (?f B))\""], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "unfolding \\<open>wrap B\\<^sub>1 = {B\\<^sub>1}\\<close>"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> {B\\<^sub>1}.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "using f_def(2)"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> {B\\<^sub>1}.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "by simp"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "with BIJ"], ["proof (chain)\npicking this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)", "have \"bij_betw ?f (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n              \\<and> (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. c < W B + w (?f B))\""], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)\n\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n    (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n        real c < W B + w ((f(B\\<^sub>1 := u)) B))", "by blast"], ["proof (state)\nthis:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "then"], ["proof (chain)\npicking this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))", "have 3: \"bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\""], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       bij_betw f (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n        (\\<Union>\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n       (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n           real c < W B + w (f B))", "by blast"], ["proof (state)\nthis:\n  bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 4: \"2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "note bprules = bpE[OF inv\\<^sub>1E(1)[OF invrules(1)]]"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"pairwise disjnt (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using bprules(1) pairwise_subset"], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  \\<lbrakk>pairwise ?P ?S; ?T \\<subseteq> ?S\\<rbrakk>\n  \\<Longrightarrow> pairwise ?P ?T\n\ngoal (1 subgoal):\n 1. disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by blast"], ["proof (state)\nthis:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "moreover"], ["proof (state)\nthis:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"B\\<^sub>2 \\<notin> P\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<notin> P\\<^sub>2", "using inv\\<^sub>1E(4)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<notin> P\\<^sub>2", "by simp"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "ultimately"], ["proof (chain)\npicking this:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  B\\<^sub>2 \\<notin> P\\<^sub>2", "have DISJNT: \"\\<Union>P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\""], ["proof (prove)\nusing this:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}", "by (auto, metis (no_types, hide_lams) sup_bot.right_neutral Un_insert_right disjnt_iff mk_disjoint_insert pairwise_insert wrap_Un)"], ["proof (state)\nthis:\n  \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"finite (\\<Union>P\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (\\<Union> P\\<^sub>2)", "using U_Finite bprules(3)"], ["proof (prove)\nusing this:\n  finite U\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. finite (\\<Union> P\\<^sub>2)", "by auto"], ["proof (state)\nthis:\n  finite (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"finite B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "using inv\\<^sub>1E(1)[OF invrules(1)] bp_bins_finite wrap_not_empty"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  bp ?P \\<Longrightarrow> \\<forall>B\\<in>?P. finite B\n  (?M \\<noteq> {}) = (wrap ?M = {?M})\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "by blast"], ["proof (state)\nthis:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))", "using card_Un_le[of P\\<^sub>2 \\<open>wrap B\\<^sub>2\\<close>]"], ["proof (prove)\nusing this:\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P\\<^sub>2 + card (wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))", "by simp"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... \\<le> 2 * card P\\<^sub>2 + 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n    \\<le> 2 * card P\\<^sub>2 + 2", "using wrap_card"], ["proof (prove)\nusing this:\n  card (wrap ?B) \\<le> 1\n\ngoal (1 subgoal):\n 1. 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n    \\<le> 2 * card P\\<^sub>2 + 2", "by auto"], ["proof (state)\nthis:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2)) \\<le> 2 * card P\\<^sub>2 + 2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2)) \\<le> 2 * card P\\<^sub>2 + 2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... \\<le> card (\\<Union> P\\<^sub>2) + 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * card P\\<^sub>2 + 2 \\<le> card (\\<Union> P\\<^sub>2) + 2", "using invrules(4)"], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card P\\<^sub>2 + 2 \\<le> card (\\<Union> P\\<^sub>2) + 2", "by simp"], ["proof (state)\nthis:\n  2 * card P\\<^sub>2 + 2 \\<le> card (\\<Union> P\\<^sub>2) + 2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  2 * card P\\<^sub>2 + 2 \\<le> card (\\<Union> P\\<^sub>2) + 2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (\\<Union> P\\<^sub>2) + 2\n    \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2", "using B\\<^sub>2_at_least_two_objects[OF assms(1,3,5)]"], ["proof (prove)\nusing this:\n  2 \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. card (\\<Union> P\\<^sub>2) + 2\n    \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2", "by simp"], ["proof (state)\nthis:\n  card (\\<Union> P\\<^sub>2) + 2\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  card (\\<Union> P\\<^sub>2) + 2\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... = card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 =\n    card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))", "using DISJNT card_Un_disjoint[OF \\<open>finite (\\<Union>P\\<^sub>2)\\<close> \\<open>finite B\\<^sub>2\\<close>]"], ["proof (prove)\nusing this:\n  \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\n  \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {} \\<Longrightarrow>\n  card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) =\n  card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 =\n    card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))", "by (simp add: Un_commute)"], ["proof (state)\nthis:\n  card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 =\n  card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 =\n  card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... = card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2})) =\n    card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "by (cases \\<open>B\\<^sub>2 = {}\\<close>) auto"], ["proof (state)\nthis:\n  card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2})) =\n  card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "finally"], ["proof (chain)\npicking this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "show ?thesis"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "."], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from inv\\<^sub>2I[OF 1 2 3 4]"], ["proof (chain)\npicking this:\n  ((V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n   (V - {u}) \\<inter> L \\<noteq> {}) \\<Longrightarrow>\n  inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\""], ["proof (prove)\nusing this:\n  ((V - {u}) \\<inter> L \\<noteq> {} \\<Longrightarrow>\n   (V - {u}) \\<inter> L \\<noteq> {}) \\<Longrightarrow>\n  inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  {u} \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  {u} \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "using assms(3)"], ["proof (prove)\nusing this:\n  {u} \\<subseteq> S \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n  u \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The bin packing algorithm as it is proposed in the article @{cite BerghammerR03}.\n      \\<open>P\\<close> will not only be a correct solution of the bin packing problem, but the amount of bins\n      will be a lower bound for \\<open>3 / 2\\<close> of the amount of bins of any correct solution \\<open>Q\\<close>, and thus\n      guarantee an approximation factor of \\<open>3 / 2\\<close> for the optimum.\\<close>"], ["", "lemma bp_approx:\n\"VARS P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u\n  {True}\n  P\\<^sub>1 := {}; P\\<^sub>2 := {}; B\\<^sub>1 := {}; B\\<^sub>2 := {}; V := U;\n  WHILE V \\<inter> S \\<noteq> {} INV {inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V} DO \n    IF B\\<^sub>1 \\<noteq> {}\n    THEN u := (SOME u. u \\<in> V \\<inter> S)\n    ELSE IF V \\<inter> L \\<noteq> {}\n         THEN u := (SOME u. u \\<in> V \\<inter> L)\n         ELSE u := (SOME u. u \\<in> V \\<inter> S) FI FI;\n    V := V - {u};\n    IF W(B\\<^sub>1) + w(u) \\<le> c\n    THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u}\n    ELSE IF W(B\\<^sub>2) + w(u) \\<le> c\n         THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u}\n         ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2; B\\<^sub>2 := {u} FI;\n         P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1; B\\<^sub>1 := {} FI\n  OD;\n  P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} | v. v \\<in> V}\n  {bp P \\<and> (\\<forall>Q. bp Q \\<longrightarrow> card P \\<le> 3 / 2 * card Q)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {True} \n     P\\<^sub>1 := {};\n     P\\<^sub>2 := {};\n     B\\<^sub>1 := {};\n     B\\<^sub>2 := {};\n     V := U;\n     WHILE V \\<inter> S \\<noteq> {}\n      INV {inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V} \n      VAR {\\<lambda>(P, P\\<^sub>1, P\\<^sub>2, B\\<^sub>1, B\\<^sub>2, V, u).\n              0} \n      DO IF B\\<^sub>1 \\<noteq> {} THEN u := (SOME u. u \\<in> V \\<inter> S) \n          ELSE IF V \\<inter> L \\<noteq> {}\n                THEN u := (SOME u. u \\<in> V \\<inter> L) \n                ELSE u := (SOME u. u \\<in> V \\<inter> S) FI\n          FI;\n         V := V - {u};\n         IF W B\\<^sub>1 + w u \\<le> real c\n          THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u} \n          ELSE IF W B\\<^sub>2 + w u \\<le> real c\n                THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u} \n                ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2;\n                     B\\<^sub>2 := {u}\n                FI;\n               P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1;\n               B\\<^sub>1 := {}\n          FI \n      OD;\n     P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n          wrap B\\<^sub>2 \\<union>\n          {{v} |v. v \\<in> V} \n     {bp P \\<and>\n      (\\<forall>Q.\n          bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))}", "proof (vcg, goal_cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       True \\<Longrightarrow> inv\\<^sub>3 {} {} {} {} U\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "case (1 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u)"], ["proof (state)\nthis:\n  True\n\ngoal (3 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       True \\<Longrightarrow> inv\\<^sub>3 {} {} {} {} U\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  True", "show ?case"], ["proof (prove)\nusing this:\n  True\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} U", "by (simp add: loop_init)"], ["proof (state)\nthis:\n  inv\\<^sub>3 {} {} {} {} U\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "case (2 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u)"], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}", "have INV: \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\""], ["proof (prove)\nusing this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", ".."], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "let ?s = \"SOME u. u \\<in> V \\<inter> S\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "let ?l = \"SOME u. u \\<in> V \\<inter> L\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "have LIN: \"V \\<inter> L \\<noteq> {} \\<Longrightarrow> ?l \\<in> V \\<inter> L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    (SOME u. u \\<in> V \\<inter> L) \\<in> V \\<inter> L", "using some_in_eq"], ["proof (prove)\nusing this:\n  ((SOME x. x \\<in> ?A) \\<in> ?A) = (?A \\<noteq> {})\n\ngoal (1 subgoal):\n 1. V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    (SOME u. u \\<in> V \\<inter> L) \\<in> V \\<inter> L", "by metis"], ["proof (state)\nthis:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  (SOME u. u \\<in> V \\<inter> L) \\<in> V \\<inter> L\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  (SOME u. u \\<in> V \\<inter> L) \\<in> V \\<inter> L", "have LWEIGHT: \"V \\<inter> L \\<noteq> {} \\<Longrightarrow> w ?l \\<le> c\""], ["proof (prove)\nusing this:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  (SOME u. u \\<in> V \\<inter> L) \\<in> V \\<inter> L\n\ngoal (1 subgoal):\n 1. V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    w (SOME u. u \\<in> V \\<inter> L) \\<le> real c", "using L_def weight"], ["proof (prove)\nusing this:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  (SOME u. u \\<in> V \\<inter> L) \\<in> V \\<inter> L\n  L = U - S\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n    w (SOME u. u \\<in> V \\<inter> L) \\<le> real c", "by blast"], ["proof (state)\nthis:\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  w (SOME u. u \\<in> V \\<inter> L) \\<le> real c\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "from 2"], ["proof (chain)\npicking this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}", "have \"V \\<inter> S \\<noteq> {}\""], ["proof (prove)\nusing this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. V \\<inter> S \\<noteq> {}", ".."], ["proof (state)\nthis:\n  V \\<inter> S \\<noteq> {}\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  V \\<inter> S \\<noteq> {}", "have IN: \"?s \\<in> V \\<inter> S\""], ["proof (prove)\nusing this:\n  V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (SOME u. u \\<in> V \\<inter> S) \\<in> V \\<inter> S", "using some_in_eq"], ["proof (prove)\nusing this:\n  V \\<inter> S \\<noteq> {}\n  ((SOME x. x \\<in> ?A) \\<in> ?A) = (?A \\<noteq> {})\n\ngoal (1 subgoal):\n 1. (SOME u. u \\<in> V \\<inter> S) \\<in> V \\<inter> S", "by metis"], ["proof (state)\nthis:\n  (SOME u. u \\<in> V \\<inter> S) \\<in> V \\<inter> S\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  (SOME u. u \\<in> V \\<inter> S) \\<in> V \\<inter> S", "have \"w ?s \\<le> c\""], ["proof (prove)\nusing this:\n  (SOME u. u \\<in> V \\<inter> S) \\<in> V \\<inter> S\n\ngoal (1 subgoal):\n 1. w (SOME u. u \\<in> V \\<inter> S) \\<le> real c", "using S_def"], ["proof (prove)\nusing this:\n  (SOME u. u \\<in> V \\<inter> S) \\<in> V \\<inter> S\n  S = {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. w (SOME u. u \\<in> V \\<inter> S) \\<le> real c", "by simp"], ["proof (state)\nthis:\n  w (SOME u. u \\<in> V \\<inter> S) \\<le> real c\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n         \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n          (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n           {SOME u. u \\<in> V \\<inter> S}\n           (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n            (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> L}\n            (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n        (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n          \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n           (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n            (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n            {SOME u. u \\<in> V \\<inter> S}\n            (V - {SOME u. u \\<in> V \\<inter> S})))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  w (SOME u. u \\<in> V \\<inter> S) \\<le> real c", "show ?case"], ["proof (prove)\nusing this:\n  w (SOME u. u \\<in> V \\<inter> S) \\<le> real c\n\ngoal (1 subgoal):\n 1. (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n     (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n      \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n       (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n       (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n     (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n             \\<le> real c \\<longrightarrow>\n      (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n       \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n        (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n        (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n      (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n              \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n        (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n        {SOME u. u \\<in> V \\<inter> S}\n        (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n    (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n     (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n      (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n       \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n        (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n        (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n      (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n              \\<le> real c \\<longrightarrow>\n       (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n        \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n         (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n         (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n       (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n               \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n         (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n         {SOME u. u \\<in> V \\<inter> L}\n         (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n     (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n      (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n       \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n        (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n        (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n      (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n              \\<le> real c \\<longrightarrow>\n       (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n        \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n         (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n         (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n       (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n               \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n         (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n         {SOME u. u \\<in> V \\<inter> S}\n         (V - {SOME u. u \\<in> V \\<inter> S})))))", "using LWEIGHT loop_stepA[OF INV _ _ IN] loop_stepB[OF INV _ LIN] loop_stepC[OF INV _ IN]\n      and loop_stepD[OF INV _ IN] loop_stepE[OF INV _ IN]"], ["proof (prove)\nusing this:\n  w (SOME u. u \\<in> V \\<inter> S) \\<le> real c\n  V \\<inter> L \\<noteq> {} \\<Longrightarrow>\n  w (SOME u. u \\<in> V \\<inter> L) \\<le> real c\n  \\<lbrakk>B\\<^sub>1 = {}; V \\<inter> L = {}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n                     {SOME u. u \\<in> V \\<inter> S} B\\<^sub>2\n                     (V - {SOME u. u \\<in> V \\<inter> S})\n  \\<lbrakk>B\\<^sub>1 = {}; V \\<inter> L \\<noteq> {}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n                     {SOME u. u \\<in> V \\<inter> L} B\\<^sub>2\n                     (V - {SOME u. u \\<in> V \\<inter> L})\n  \\<lbrakk>B\\<^sub>1 \\<noteq> {};\n   W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S) \\<le> real c\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n                     (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S})\n                     B\\<^sub>2 (V - {SOME u. u \\<in> V \\<inter> S})\n  \\<lbrakk>B\\<^sub>1 \\<noteq> {};\n   real c < W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S);\n   W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S) \\<le> real c\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     P\\<^sub>2 {}\n                     (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n                     (V - {SOME u. u \\<in> V \\<inter> S})\n  \\<lbrakk>B\\<^sub>1 \\<noteq> {};\n   real c < W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S);\n   real c < W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n                     {SOME u. u \\<in> V \\<inter> S}\n                     (V - {SOME u. u \\<in> V \\<inter> S})\n\ngoal (1 subgoal):\n 1. (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n     (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n      \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n       (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n       (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n     (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n             \\<le> real c \\<longrightarrow>\n      (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n       \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n        (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n        (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n      (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n              \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n        (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n        {SOME u. u \\<in> V \\<inter> S}\n        (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n    (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n     (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n      (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n       \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n        (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n        (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n      (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n              \\<le> real c \\<longrightarrow>\n       (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n        \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n         (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n         (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n       (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n               \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n         (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n         {SOME u. u \\<in> V \\<inter> L}\n         (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n     (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n      (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n       \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n        (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n        (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n      (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n              \\<le> real c \\<longrightarrow>\n       (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n        \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n         (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n         (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n       (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n               \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n         (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n         {SOME u. u \\<in> V \\<inter> S}\n         (V - {SOME u. u \\<in> V \\<inter> S})))))", "by (cases \\<open>B\\<^sub>1 = {}\\<close>, cases \\<open>V \\<inter> L = {}\\<close>) auto"], ["proof (state)\nthis:\n  (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n   (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n    \\<le> real c \\<longrightarrow>\n    inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n     (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n     (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n   (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n           \\<le> real c \\<longrightarrow>\n    (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n     \\<le> real c \\<longrightarrow>\n     inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n      (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n      (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n    (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n            \\<le> real c \\<longrightarrow>\n     inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V \\<inter> S}\n      (V - {SOME u. u \\<in> V \\<inter> S})))) \\<and>\n  (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n   (V \\<inter> L \\<noteq> {} \\<longrightarrow>\n    (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n     \\<le> real c \\<longrightarrow>\n     inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n      (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> L}) B\\<^sub>2\n      (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n    (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> L)\n            \\<le> real c \\<longrightarrow>\n     (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n      \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n       (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> L})\n       (V - {SOME u. u \\<in> V \\<inter> L})) \\<and>\n     (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> L)\n             \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n       (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V \\<inter> L}\n       (V - {SOME u. u \\<in> V \\<inter> L})))) \\<and>\n   (\\<not> V \\<inter> L \\<noteq> {} \\<longrightarrow>\n    (W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n     \\<le> real c \\<longrightarrow>\n     inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n      (B\\<^sub>1 \\<union> {SOME u. u \\<in> V \\<inter> S}) B\\<^sub>2\n      (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n    (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> V \\<inter> S)\n            \\<le> real c \\<longrightarrow>\n     (W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n      \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n       (B\\<^sub>2 \\<union> {SOME u. u \\<in> V \\<inter> S})\n       (V - {SOME u. u \\<in> V \\<inter> S})) \\<and>\n     (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> V \\<inter> S)\n             \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n       (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> V \\<inter> S}\n       (V - {SOME u. u \\<in> V \\<inter> S})))))\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "case (3 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u)"], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  \\<not> V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  \\<not> V \\<inter> S \\<noteq> {}", "have INV: \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" and EMPTY: \"V \\<inter> S = {}\""], ["proof (prove)\nusing this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n  \\<not> V \\<inter> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V &&&\n    V \\<inter> S = {}", "by blast+"], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n  V \\<inter> S = {}\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<and>\n       \\<not> V \\<inter> S \\<noteq> {} \\<Longrightarrow>\n       bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V}) \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow>\n           real\n            (card\n              (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n               wrap B\\<^sub>2 \\<union>\n               {{v} |v. v \\<in> V}))\n           \\<le> 3 / 2 * real (card Q))", "from inv\\<^sub>1E(1)[OF inv\\<^sub>2E(1)[OF inv\\<^sub>3E(1)[OF INV]]] and bin_packing_lower_bound_card[OF EMPTY inv\\<^sub>3E(1)[OF INV]]"], ["proof (chain)\npicking this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  bp ?P \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}))\n  \\<le> 3 / 2 * real (card ?P)", "show ?case"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  bp ?P \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}))\n  \\<le> 3 / 2 * real (card ?P)\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}) \\<and>\n    (\\<forall>Q.\n        bp Q \\<longrightarrow>\n        real\n         (card\n           (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n            wrap B\\<^sub>2 \\<union>\n            {{v} |v. v \\<in> V}))\n        \\<le> 3 / 2 * real (card Q))", "by blast"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}) \\<and>\n  (\\<forall>Q.\n      bp Q \\<longrightarrow>\n      real\n       (card\n         (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n          wrap B\\<^sub>2 \\<union>\n          {{v} |v. v \\<in> V}))\n      \\<le> 3 / 2 * real (card Q))\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "(* BinPacking *)"], ["", "subsection \\<open>The Full Linear Time Version of the Proposed Algorithm\\<close>"], ["", "text \\<open>Finally, we prove the Algorithm proposed on page 78 of the article @{cite BerghammerR03}.\n      This version generates the S and L sets beforehand and uses them directly to calculate the solution,\n      thus removing the need for intersection operations, and ensuring linear time if we can\n      perform \\<open>insertion, removal, and selection of an element, the union of two sets,\n      and the emptiness test in constant time\\<close> @{cite BerghammerR03}.\\<close>"], ["", "locale BinPacking_Complete =\n  fixes U :: \"'a set\" \\<comment> \\<open>A finite, non-empty set of objects\\<close>\n    and w :: \"'a \\<Rightarrow> real\" \\<comment> \\<open>A mapping from objects to their respective weights (positive real numbers)\\<close>\n    and c :: nat \\<comment> \\<open>The maximum capacity of a bin (as a natural number)\\<close>\n  assumes weight: \"\\<forall>u \\<in> U. 0 < w(u) \\<and> w(u) \\<le> c\"\n      and U_Finite: \"finite U\"\n      and U_NE: \"U \\<noteq> {}\"\nbegin"], ["", "text \\<open>The correctness proofs will be identical to the ones of the simplified algorithm.\\<close>"], ["", "abbreviation W :: \"'a set \\<Rightarrow> real\" where\n  \"W B \\<equiv> (\\<Sum>u \\<in> B. w(u))\""], ["", "definition bp :: \"'a set set \\<Rightarrow> bool\" where\n  \"bp P \\<longleftrightarrow> partition_on U P \\<and> (\\<forall>B \\<in> P. W(B) \\<le> c)\""], ["", "lemma bpE:\n  assumes \"bp P\"\n  shows \"pairwise disjnt P\" \"{} \\<notin> P\" \"\\<Union>P = U\" \"\\<forall>B \\<in> P. W(B) \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (disjoint P &&& {} \\<notin> P) &&&\n    \\<Union> P = U &&& \\<forall>B\\<in>P. W B \\<le> real c", "using assms"], ["proof (prove)\nusing this:\n  bp P\n\ngoal (1 subgoal):\n 1. (disjoint P &&& {} \\<notin> P) &&&\n    \\<Union> P = U &&& \\<forall>B\\<in>P. W B \\<le> real c", "unfolding bp_def partition_on_def"], ["proof (prove)\nusing this:\n  (\\<Union> P = U \\<and> disjoint P \\<and> {} \\<notin> P) \\<and>\n  (\\<forall>B\\<in>P. W B \\<le> real c)\n\ngoal (1 subgoal):\n 1. (disjoint P &&& {} \\<notin> P) &&&\n    \\<Union> P = U &&& \\<forall>B\\<in>P. W B \\<le> real c", "by blast+"], ["", "lemma bpI:\n  assumes \"pairwise disjnt P\" \"{} \\<notin> P\" \"\\<Union>P = U\" \"\\<forall>B \\<in> P. W(B) \\<le> c\"\n  shows \"bp P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bp P", "using assms"], ["proof (prove)\nusing this:\n  disjoint P\n  {} \\<notin> P\n  \\<Union> P = U\n  \\<forall>B\\<in>P. W B \\<le> real c\n\ngoal (1 subgoal):\n 1. bp P", "unfolding bp_def partition_on_def"], ["proof (prove)\nusing this:\n  disjoint P\n  {} \\<notin> P\n  \\<Union> P = U\n  \\<forall>B\\<in>P. W B \\<le> real c\n\ngoal (1 subgoal):\n 1. (\\<Union> P = U \\<and> disjoint P \\<and> {} \\<notin> P) \\<and>\n    (\\<forall>B\\<in>P. W B \\<le> real c)", "by blast"], ["", "definition inv\\<^sub>1 :: \"'a set set \\<Rightarrow> 'a set set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> bool\" where\n  \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V \\<longleftrightarrow> bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}) \\<comment> \\<open>A correct solution to the bin packing problem\\<close>\n                       \\<and> \\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V \\<comment> \\<open>The partial solution does not contain objects that have not yet been assigned\\<close>\n                       \\<and> B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<comment> \\<open>\\<open>B\\<^sub>1\\<close> is distinct from all the other bins\\<close>\n                       \\<and> B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2) \\<comment> \\<open>\\<open>B\\<^sub>2\\<close> is distinct from all the other bins\\<close>\n                       \\<and> (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {} \\<comment> \\<open>The first and second partial solutions are disjoint from each other.\\<close>\""], ["", "lemma inv\\<^sub>1E:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\"\n  shows \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\"\n    and \"\\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V\"\n    and \"B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\"\n    and \"B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2)\"\n    and \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n         wrap B\\<^sub>2 \\<union>\n         {{v} |v. v \\<in> V}) &&&\n     \\<Union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2) =\n     U - V) &&&\n    B\\<^sub>1\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 &&&\n    B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 &&&\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\n\ngoal (1 subgoal):\n 1. (bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n         wrap B\\<^sub>2 \\<union>\n         {{v} |v. v \\<in> V}) &&&\n     \\<Union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2) =\n     U - V) &&&\n    B\\<^sub>1\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 &&&\n    B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 &&&\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "unfolding inv\\<^sub>1_def"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V}) \\<and>\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V \\<and>\n  B\\<^sub>1\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<and>\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<and>\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. (bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n         wrap B\\<^sub>2 \\<union>\n         {{v} |v. v \\<in> V}) &&&\n     \\<Union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2) =\n     U - V) &&&\n    B\\<^sub>1\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 &&&\n    B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 &&&\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "by auto"], ["", "lemma inv\\<^sub>1I:\n  assumes \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V})\"\n    and \"\\<Union>(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - V\"\n    and \"B\\<^sub>1 \\<notin> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\"\n    and \"B\\<^sub>2 \\<notin> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2)\"\n    and \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", "using assms"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V", "unfolding inv\\<^sub>1_def"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V}) \\<and>\n    \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) =\n    U - V \\<and>\n    B\\<^sub>1\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<and>\n    B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<and>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "by blast"], ["", "lemma wrap_Un [simp]: \"wrap (M \\<union> {x}) = {M \\<union> {x}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wrap (M \\<union> {x}) = {M \\<union> {x}}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if M \\<union> {x} = {} then {} else {M \\<union> {x}}) =\n    {M \\<union> {x}}", "by simp"], ["", "lemma wrap_empty [simp]: \"wrap {} = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wrap {} = {}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if {} = {} then {} else {{}}) = {}", "by simp"], ["", "lemma wrap_not_empty [simp]: \"M \\<noteq> {} \\<longleftrightarrow> wrap M = {M}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (M \\<noteq> {}) = (wrap M = {M})", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (M \\<noteq> {}) = ((if M = {} then {} else {M}) = {M})", "by simp"], ["", "lemma inv\\<^sub>1_stepA:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\" \"W(B\\<^sub>1) + w(u) \\<le> c\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "note invrules = inv\\<^sub>1E[OF assms(1)] and bprules = bpE[OF invrules(1)]\n\n  \\<comment> \\<open>Rule 1: Pairwise Disjoint\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have NOTIN: \"\\<forall>M \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. u \\<notin> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "using invrules(2) assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "by blast"], ["proof (state)\nthis:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"{{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "using assms(2)"], ["proof (prove)\nusing this:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "by blast"], ["proof (state)\nthis:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "have \"pairwise disjnt (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))", "using bprules(1) assms(2)"], ["proof (prove)\nusing this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))", "have \"pairwise disjnt (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    ({{u}} \\<union> {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})", "by (simp add: Un_commute)"], ["proof (state)\nthis:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}})", "have assm: \"pairwise disjnt (wrap B\\<^sub>1 \\<union> {{u}} \\<union> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union> P\\<^sub>1 \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. disjoint\n     (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by (simp add: Un_assoc)"], ["proof (state)\nthis:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"pairwise disjnt ({B\\<^sub>1 \\<union> {u}} \\<union> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "proof (cases \\<open>B\\<^sub>1 = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. B\\<^sub>1 = {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))\n 2. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "case True"], ["proof (state)\nthis:\n  B\\<^sub>1 = {}\n\ngoal (2 subgoals):\n 1. B\\<^sub>1 = {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))\n 2. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "with assm"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>1 = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>1 = {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "case False"], ["proof (state)\nthis:\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "with assm"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>1 \\<noteq> {}", "have assm: \"pairwise disjnt ({B\\<^sub>1} \\<union> {{u}} \\<union> (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>1 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1} \\<union> {{u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>1} \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "from NOTIN"], ["proof (chain)\npicking this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M", "have \"{u} \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. {u}\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n             {{v} |v. v \\<in> V - {u}}", "by blast"], ["proof (state)\nthis:\n  {u}\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "from pairwise_disjnt_Un[OF assm _ this] invrules(2,3)"], ["proof (chain)\npicking this:\n  B\\<^sub>1\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>1\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "using False"], ["proof (prove)\nusing this:\n  B\\<^sub>1\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>1 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by auto"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))", "have 1: \"pairwise disjnt (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  disjoint\n   ({B\\<^sub>1 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> {B\\<^sub>1 \\<union> {u}} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})", "by simp\n\n  \\<comment> \\<open>Rule 2: No empty sets\\<close>"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from bprules(2)"], ["proof (chain)\npicking this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}", "have 2: \"{} \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n                P\\<^sub>2 \\<union>\n                wrap B\\<^sub>2 \\<union>\n                {{v} |v. v \\<in> V - {u}}", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union>\n              (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n              P\\<^sub>2 \\<union>\n              (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n              {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union>\n                (if B\\<^sub>1 \\<union> {u} = {} then {}\n                 else {B\\<^sub>1 \\<union> {u}}) \\<union>\n                P\\<^sub>2 \\<union>\n                (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n                {{v} |v. v \\<in> V - {u}}", "by simp\n\n  \\<comment> \\<open>Rule 3: Union preserved\\<close>"], ["proof (state)\nthis:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n              P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from bprules(3)"], ["proof (chain)\npicking this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U", "have \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}} \\<union> {{v} |v. v \\<in> V - {u}}) = U\""], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "using assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "by blast"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U", "have 3: \"\\<Union> (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}) = U\""], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n    P\\<^sub>2 \\<union>\n    (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 \\<union> {u} = {} then {}\n       else {B\\<^sub>1 \\<union> {u}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "by force\n\n  \\<comment> \\<open>Rule 4: Weights below capacity\\<close>"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"0 < w u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < w u", "using weight assms(2) bprules(3)"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. 0 < w u", "by blast"], ["proof (state)\nthis:\n  0 < w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"finite B\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>1", "using bprules(3) U_Finite"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  finite U\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>1", "by (cases \\<open>B\\<^sub>1 = {}\\<close>) auto"], ["proof (state)\nthis:\n  finite B\\<^sub>1\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  finite B\\<^sub>1", "have \"W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u\""], ["proof (prove)\nusing this:\n  finite B\\<^sub>1\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u", "using \\<open>0 < w u\\<close>"], ["proof (prove)\nusing this:\n  finite B\\<^sub>1\n  0 < w u\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u", "by (cases \\<open>u \\<in> B\\<^sub>1\\<close>) (auto simp: insert_absorb)"], ["proof (state)\nthis:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "also"], ["proof (state)\nthis:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> W B\\<^sub>1 + w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"... \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "using assms(3)"], ["proof (prove)\nusing this:\n  W B\\<^sub>1 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "."], ["proof (state)\nthis:\n  W B\\<^sub>1 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "finally"], ["proof (chain)\npicking this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c", "have \"W (B\\<^sub>1 \\<union> {u}) \\<le> c\""], ["proof (prove)\nusing this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>1 \\<union> {u}) \\<le> real c", "."], ["proof (state)\nthis:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c", "have \"\\<forall>B \\<in> wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> c\""], ["proof (prove)\nusing this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  W (B\\<^sub>1 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>{B\\<^sub>1 \\<union> {u}}. W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "moreover"], ["proof (state)\nthis:\n  \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"\\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. W B \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "using bprules(4)"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c", "have 4: \"\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. W B \\<le> c\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>wrap (B\\<^sub>1 \\<union> {u}). W B \\<le> real c\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from bpI[OF 1 2 3 4]"], ["proof (chain)\npicking this:\n  bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})", "have 1: \"bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n        P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V - {u}})", ".\n\n  \\<comment> \\<open>Auxiliary information is preserved\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have \"u \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> U", "using assms(2) bprules(3)"], ["proof (prove)\nusing this:\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. u \\<in> U", "by blast"], ["proof (state)\nthis:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "then"], ["proof (chain)\npicking this:\n  u \\<in> U", "have R: \"U - (V - {u}) = U - V \\<union> {u}\""], ["proof (prove)\nusing this:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. U - (V - {u}) = U - V \\<union> {u}", "by blast"], ["proof (state)\nthis:\n  U - (V - {u}) = U - V \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have L: \"\\<Union> (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = \\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) =\n    \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) \\<union>\n    {u}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 \\<union> {u} = {} then {}\n       else {B\\<^sub>1 \\<union> {u}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n    {u}", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 \\<union> {u} = {} then {}\n       else {B\\<^sub>1 \\<union> {u}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n    {u}", "by auto"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) \\<union>\n  {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have 2: \"\\<Union> (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) = U - (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) =\n    U - (V - {u})", "unfolding L R invrules(2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. U - V \\<union> {u} = U - V \\<union> {u}", ".."], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have 3: \"B\\<^sub>1 \\<union> {u} \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<union> {u}\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<union> {u}\n    \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2", "by auto"], ["proof (state)\nthis:\n  B\\<^sub>1 \\<union> {u}\n  \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have 4: \"B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union> P\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n             P\\<^sub>2", "using invrules(4) NOTIN"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n             P\\<^sub>2", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union>\n           (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n           P\\<^sub>2\n  \\<forall>M\\<in>P\\<^sub>1 \\<union>\n                 (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n                 P\\<^sub>2 \\<union>\n                 (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. B\\<^sub>2\n    \\<notin> P\\<^sub>1 \\<union>\n             (if B\\<^sub>1 \\<union> {u} = {} then {}\n              else {B\\<^sub>1 \\<union> {u}}) \\<union>\n             P\\<^sub>2", "by fastforce"], ["proof (state)\nthis:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}) \\<union>\n           P\\<^sub>2\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "have 5: \"(P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u})) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u})) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "using invrules(5) NOTIN"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u})) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> {B\\<^sub>1 \\<union> {u}}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    {}", "by auto"], ["proof (state)\nthis:\n  (P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u})) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "from inv\\<^sub>1I[OF 1 2 3 4 5]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma inv\\<^sub>1_stepB:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\" \"W B\\<^sub>2 + w u \\<le> c\"\n  shows \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "note invrules = inv\\<^sub>1E[OF assms(1)] and bprules = bpE[OF invrules(1)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have NOTIN: \"\\<forall>M \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. u \\<notin> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "using invrules(2) assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "by blast"], ["proof (state)\nthis:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"{{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "using assms(2)"], ["proof (prove)\nusing this:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "by blast"], ["proof (state)\nthis:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}", "have \"pairwise disjnt (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}} \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}})", "using bprules(1) assms(2)"], ["proof (prove)\nusing this:\n  {{v} |v. v \\<in> V} = {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V})\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}})", "by simp"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}})", "have assm: \"pairwise disjnt (wrap B\\<^sub>2 \\<union> {{u}} \\<union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. disjoint\n     (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by (simp add: Un_assoc Un_commute)"], ["proof (state)\nthis:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"pairwise disjnt ({B\\<^sub>2 \\<union> {u}} \\<union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "proof (cases \\<open>B\\<^sub>2 = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "case True"], ["proof (state)\nthis:\n  B\\<^sub>2 = {}\n\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "with assm"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>2 = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "case False"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "with assm"], ["proof (chain)\npicking this:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>2 \\<noteq> {}", "have assm: \"pairwise disjnt ({B\\<^sub>2} \\<union> {{u}} \\<union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}))\""], ["proof (prove)\nusing this:\n  disjoint\n   (wrap B\\<^sub>2 \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2} \\<union> {{u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by simp"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>2} \\<union> {{u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "from NOTIN"], ["proof (chain)\npicking this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M", "have \"{u} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n             {{v} |v. v \\<in> V - {u}}", "by blast"], ["proof (state)\nthis:\n  {u}\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "from pairwise_disjnt_Un[OF assm _ this] invrules(2,4)"], ["proof (chain)\npicking this:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "using False"], ["proof (prove)\nusing this:\n  B\\<^sub>2\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> V - {u}} \\<Longrightarrow>\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. disjoint\n     ({B\\<^sub>2 \\<union> {u}} \\<union>\n      (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> V - {u}}))", "by auto"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))", "have 1: \"pairwise disjnt (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}})", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  disjoint\n   ({B\\<^sub>2 \\<union> {u}} \\<union>\n    (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n     {{v} |v. v \\<in> V - {u}}))\n\ngoal (1 subgoal):\n 1. disjoint\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      {B\\<^sub>2 \\<union> {u}} \\<union>\n      {{v} |v. v \\<in> V - {u}})", "by simp\n\n  \\<comment> \\<open>Rule 2: No empty sets\\<close>"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n    {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from bprules(2)"], ["proof (chain)\npicking this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}", "have 2: \"{} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n                P\\<^sub>2 \\<union>\n                wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n                {{v} |v. v \\<in> V - {u}}", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union>\n              (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n              P\\<^sub>2 \\<union>\n              (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n              {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union>\n                (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n                (if {} = {} then {} else {{}}) \\<union>\n                P\\<^sub>2 \\<union>\n                (if B\\<^sub>2 \\<union> {u} = {} then {}\n                 else {B\\<^sub>2 \\<union> {u}}) \\<union>\n                {{v} |v. v \\<in> V - {u}}", "by simp\n\n  \\<comment> \\<open>Rule 3: Union preserved\\<close>"], ["proof (state)\nthis:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n              P\\<^sub>2 \\<union>\n              wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n              {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from bprules(3)"], ["proof (chain)\npicking this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U", "have \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}} \\<union> {{v} |v. v \\<in> V - {u}}) = U\""], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "using assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{u}} \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "by blast"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U", "have 3: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}}) = U\""], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n    P\\<^sub>2 \\<union>\n    (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 \\<union> {u} = {} then {}\n       else {B\\<^sub>2 \\<union> {u}}) \\<union>\n      {{v} |v. v \\<in> V - {u}}) =\n    U", "by force\n\n  \\<comment> \\<open>Rule 4: Weights below capacity\\<close>"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n    {{v} |v. v \\<in> V - {u}}) =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"0 < w u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < w u", "using weight assms(2) bprules(3)"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. 0 < w u", "by blast"], ["proof (state)\nthis:\n  0 < w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"finite B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "using bprules(3) U_Finite"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n  finite U\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "by (cases \\<open>B\\<^sub>2 = {}\\<close>) auto"], ["proof (state)\nthis:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  finite B\\<^sub>2", "have \"W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u\""], ["proof (prove)\nusing this:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u", "using \\<open>0 < w u\\<close>"], ["proof (prove)\nusing this:\n  finite B\\<^sub>2\n  0 < w u\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u", "by (cases \\<open>u \\<in> B\\<^sub>2\\<close>) (auto simp: insert_absorb)"], ["proof (state)\nthis:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "also"], ["proof (state)\nthis:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> W B\\<^sub>2 + w u\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"... \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B\\<^sub>2 + w u \\<le> real c", "using assms(3)"], ["proof (prove)\nusing this:\n  W B\\<^sub>2 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. W B\\<^sub>2 + w u \\<le> real c", "."], ["proof (state)\nthis:\n  W B\\<^sub>2 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "finally"], ["proof (chain)\npicking this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c", "have \"W (B\\<^sub>2 \\<union> {u}) \\<le> c\""], ["proof (prove)\nusing this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. W (B\\<^sub>2 \\<union> {u}) \\<le> real c", "."], ["proof (state)\nthis:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c", "have \"\\<forall>B \\<in> wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> c\""], ["proof (prove)\nusing this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c", "unfolding wrap_Un"], ["proof (prove)\nusing this:\n  W (B\\<^sub>2 \\<union> {u}) \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>{B\\<^sub>2 \\<union> {u}}. W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "moreover"], ["proof (state)\nthis:\n  \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. W B \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "using bprules(4)"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c", "have 4: \"\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}}. W B \\<le> c\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>wrap (B\\<^sub>2 \\<union> {u}). W B \\<le> real c\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   wrap {} \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       W B \\<le> real c", "by auto"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from bpI[OF 1 2 3 4]"], ["proof (chain)\npicking this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}})", "have 1: \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}) \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n        P\\<^sub>2 \\<union>\n        wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n        {{v} |v. v \\<in> V - {u}})", ".\n\n  \\<comment> \\<open>Auxiliary information is preserved\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have \"u \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> U", "using assms(2) bprules(3)"], ["proof (prove)\nusing this:\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. u \\<in> U", "by blast"], ["proof (state)\nthis:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "then"], ["proof (chain)\npicking this:\n  u \\<in> U", "have R: \"U - (V - {u}) = U - V \\<union> {u}\""], ["proof (prove)\nusing this:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. U - (V - {u}) = U - V \\<union> {u}", "by blast"], ["proof (state)\nthis:\n  U - (V - {u}) = U - V \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have L: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) = \\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) \\<union>\n    {u}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 \\<union> {u} = {} then {}\n       else {B\\<^sub>2 \\<union> {u}})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n    {u}", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 \\<union> {u} = {} then {}\n       else {B\\<^sub>2 \\<union> {u}})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n    {u}", "by auto"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) \\<union>\n  {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 2: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) = U - (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap (B\\<^sub>2 \\<union> {u})) =\n    U - (V - {u})", "unfolding L R"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) \\<union>\n    {u} =\n    U - V \\<union> {u}", "using invrules(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2) \\<union>\n    {u} =\n    U - V \\<union> {u}", "by simp"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap (B\\<^sub>2 \\<union> {u})) =\n  U - (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 3: \"{} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                P\\<^sub>2 \\<union>\n                wrap (B\\<^sub>2 \\<union> {u})", "using bpE(2)[OF 1]"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n              P\\<^sub>2 \\<union>\n              wrap (B\\<^sub>2 \\<union> {u}) \\<union>\n              {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                P\\<^sub>2 \\<union>\n                wrap (B\\<^sub>2 \\<union> {u})", "by simp"], ["proof (state)\nthis:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap (B\\<^sub>2 \\<union> {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 4: \"B\\<^sub>2 \\<union> {u} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> P\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<union> {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n             P\\<^sub>2", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<union> {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n             P\\<^sub>2", "by auto"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<union> {u}\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n           P\\<^sub>2\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "have 5: \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n    {}", "using invrules(5) NOTIN"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n    {}", "unfolding wrap_empty wrap_Un"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {}) \\<inter>\n    (P\\<^sub>2 \\<union> {B\\<^sub>2 \\<union> {u}}) =\n    {}", "by auto"], ["proof (state)\nthis:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n  (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "from inv\\<^sub>1I[OF 1 2 3 4 5]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma inv\\<^sub>1_stepC:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V\" \"u \\<in> V\"\n  shows \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "note invrules = inv\\<^sub>1E[OF assms(1)]\n  \\<comment> \\<open>Rule 1-4: Correct Bin Packing\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u} \\<union> {{v} |v. v \\<in> V - {u}}\n      = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}} \\<union> {{v} |v. v \\<in> V - {u}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n    wrap {u} \\<union>\n    {{v} |v. v \\<in> V - {u}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}}", "by (metis (no_types, lifting) Un_assoc Un_empty_right insert_not_empty wrap_empty wrap_not_empty)"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{u}} \\<union>\n  {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "also"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{u}} \\<union>\n  {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"... = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}", "using assms(2)"], ["proof (prove)\nusing this:\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{u}} \\<union>\n    {{v} |v. v \\<in> V - {u}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}", "by auto"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{u}} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "finally"], ["proof (chain)\npicking this:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> V}", "have EQ: \"P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u} \\<union> {{v} |v. v \\<in> V - {u}}\n                  = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V}\""], ["proof (prove)\nusing this:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n    wrap {u} \\<union>\n    {{v} |v. v \\<in> V - {u}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}", "."], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n  wrap {u} \\<union>\n  {{v} |v. v \\<in> V - {u}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> V}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from invrules(1)"], ["proof (chain)\npicking this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})", "have 1: \"bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u} \\<union> {{v} |v. v \\<in> V - {u}})\""], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n        (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n        wrap {u} \\<union>\n        {{v} |v. v \\<in> V - {u}})", "unfolding EQ"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> V})\n\ngoal (1 subgoal):\n 1. bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> V})", ".\n\n  \\<comment> \\<open>Auxiliary information is preserved\\<close>"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n      wrap {u} \\<union>\n      {{v} |v. v \\<in> V - {u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have NOTIN: \"\\<forall>M \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> V - {u}}. u \\<notin> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "using invrules(2) assms(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n  u \\<in> V\n\ngoal (1 subgoal):\n 1. \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> V - {u}}.\n       u \\<notin> M", "by blast"], ["proof (state)\nthis:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have \"u \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> U", "using assms(2) bpE(3)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  u \\<in> V\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> V}) =\n  U\n\ngoal (1 subgoal):\n 1. u \\<in> U", "by blast"], ["proof (state)\nthis:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "then"], ["proof (chain)\npicking this:\n  u \\<in> U", "have R: \"U - (V - {u}) = U - V \\<union> {u}\""], ["proof (prove)\nusing this:\n  u \\<in> U\n\ngoal (1 subgoal):\n 1. U - (V - {u}) = U - V \\<union> {u}", "by blast"], ["proof (state)\nthis:\n  U - (V - {u}) = U - V \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have L: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u}) = \\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n      wrap {u}) =\n    \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union>\n    {u}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      (P\\<^sub>2 \\<union>\n       (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n      (if {u} = {} then {} else {{u}})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      (P\\<^sub>2 \\<union>\n       (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}))) \\<union>\n    {u}", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      (P\\<^sub>2 \\<union>\n       (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) \\<union>\n      (if {u} = {} then {} else {{u}})) =\n    \\<Union>\n     (P\\<^sub>1 \\<union>\n      (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n      (if {} = {} then {} else {{}}) \\<union>\n      (P\\<^sub>2 \\<union>\n       (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}))) \\<union>\n    {u}", "by auto"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n    wrap {u}) =\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union>\n  {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 2: \"\\<Union> (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u}) = U - (V - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n      wrap {u}) =\n    U - (V - {u})", "unfolding L R"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union>\n    {u} =\n    U - V \\<union> {u}", "using invrules(2)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - V\n\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union>\n    {u} =\n    U - V \\<union> {u}", "by auto"], ["proof (state)\nthis:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n    wrap {u}) =\n  U - (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 3: \"{} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> wrap {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n                wrap {u}", "using bpE(2)[OF 1]"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n              (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n              wrap {u} \\<union>\n              {{v} |v. v \\<in> V - {u}}\n\ngoal (1 subgoal):\n 1. {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n                wrap {u}", "by simp"], ["proof (state)\nthis:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n              (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union>\n              wrap {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 4: \"{u} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n             (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using NOTIN"], ["proof (prove)\nusing this:\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. {u}\n    \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n             (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by auto"], ["proof (state)\nthis:\n  {u}\n  \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {} \\<union>\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "have 5: \"(P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n    {}", "using invrules(5) NOTIN"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n    (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n    {}", "unfolding wrap_def"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> (if B\\<^sub>1 = {} then {} else {B\\<^sub>1})) \\<inter>\n  (P\\<^sub>2 \\<union> (if B\\<^sub>2 = {} then {} else {B\\<^sub>2})) =\n  {}\n  \\<forall>M\\<in>P\\<^sub>1 \\<union>\n                 (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n                 P\\<^sub>2 \\<union>\n                 (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n                 {{v} |v. v \\<in> V - {u}}.\n     u \\<notin> M\n\ngoal (1 subgoal):\n 1. (P\\<^sub>1 \\<union>\n     (if B\\<^sub>1 = {} then {} else {B\\<^sub>1}) \\<union>\n     (if {} = {} then {} else {{}})) \\<inter>\n    (P\\<^sub>2 \\<union>\n     (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n     (if {u} = {} then {} else {{u}})) =\n    {}", "by force"], ["proof (state)\nthis:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "from inv\\<^sub>1I[OF 1 2 3 4 5]"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (V - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>From this point onward, we will require a different approach for proving lower bounds.\n      Instead of fixing and assuming the definitions of the \\<open>S\\<close> and \\<open>L\\<close> sets, we will introduce\n      the abbreviations \\<open>S\\<^sub>U\\<close> and \\<open>L\\<^sub>U\\<close> for any occurrences of the original \\<open>S\\<close> and \\<open>L\\<close> sets.\n      The union of \\<open>S\\<close> and \\<open>L\\<close> can be interpreted as \\<open>V\\<close>. As a result, occurrences of \\<open>V \\<inter> S\\<close>\n      become \\<open>(S \\<union> L) \\<inter> S = S\\<close>, and \\<open>V \\<inter> L\\<close> become \\<open>(S \\<union> L) \\<inter> L = L\\<close>.\n      Occurrences of these sets will have to be replaced appropriately.\\<close>"], ["", "abbreviation S\\<^sub>U where\n  \"S\\<^sub>U \\<equiv> {u \\<in> U. w u \\<le> c / 2}\""], ["", "abbreviation L\\<^sub>U where\n  \"L\\<^sub>U \\<equiv> {u \\<in> U. c / 2 < w u}\""], ["", "text \\<open>As we will remove elements from \\<open>S\\<close> and \\<open>L\\<close>, we will only be able to show that they remain\n      subsets of \\<open>S\\<^sub>U\\<close> and \\<open>L\\<^sub>U\\<close> respectively.\\<close>"], ["", "abbreviation SL where\n  \"SL S L \\<equiv> S \\<subseteq> S\\<^sub>U \\<and> L \\<subseteq> L\\<^sub>U\""], ["", "lemma bp_bins_finite [simp]:\n  assumes \"bp P\"\n  shows \"\\<forall>B \\<in> P. finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. finite B", "using bpE(3)[OF assms] U_Finite"], ["proof (prove)\nusing this:\n  \\<Union> P = U\n  finite U\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. finite B", "by (meson Sup_upper finite_subset)"], ["", "lemma bp_sol_finite [simp]:\n  assumes \"bp P\"\n  shows \"finite P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite P", "using bpE(3)[OF assms] U_Finite"], ["proof (prove)\nusing this:\n  \\<Union> P = U\n  finite U\n\ngoal (1 subgoal):\n 1. finite P", "by (simp add: finite_UnionD)"], ["", "lemma only_one_L_per_bin:\n  assumes \"bp P\" \"B \\<in> P\"\n  shows \"\\<forall>x \\<in> B. \\<forall>y \\<in> B. x \\<noteq> y \\<longrightarrow> x \\<notin> L\\<^sub>U \\<or> y \\<notin> L\\<^sub>U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>B.\n       \\<forall>y\\<in>B.\n          x \\<noteq> y \\<longrightarrow>\n          x \\<notin> {u \\<in> U. real c / 2 < w u} \\<or>\n          y \\<notin> {u \\<in> U. real c / 2 < w u}", "proof (rule ccontr, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "assume \"\\<exists>x\\<in>B. \\<exists>y\\<in>B. x \\<noteq> y \\<and> y \\<in> U \\<and> x \\<in> U \\<and> real c < w x * 2 \\<and> real c < w y * 2\""], ["proof (state)\nthis:\n  \\<exists>x\\<in>B.\n     \\<exists>y\\<in>B.\n        x \\<noteq> y \\<and>\n        y \\<in> U \\<and>\n        x \\<in> U \\<and> real c < w x * 2 \\<and> real c < w y * 2\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  \\<exists>x\\<in>B.\n     \\<exists>y\\<in>B.\n        x \\<noteq> y \\<and>\n        y \\<in> U \\<and>\n        x \\<in> U \\<and> real c < w x * 2 \\<and> real c < w y * 2", "obtain x y where *: \"x \\<in> B\" \"y \\<in> B\" \"x \\<noteq> y\" \"x \\<in> L\\<^sub>U\" \"y \\<in> L\\<^sub>U\""], ["proof (prove)\nusing this:\n  \\<exists>x\\<in>B.\n     \\<exists>y\\<in>B.\n        x \\<noteq> y \\<and>\n        y \\<in> U \\<and>\n        x \\<in> U \\<and> real c < w x * 2 \\<and> real c < w y * 2\n\ngoal (1 subgoal):\n 1. (\\<And>x y.\n        \\<lbrakk>x \\<in> B; y \\<in> B; x \\<noteq> y;\n         x \\<in> {u \\<in> U. real c / 2 < w u};\n         y \\<in> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x \\<in> B\n  y \\<in> B\n  x \\<noteq> y\n  x \\<in> {u \\<in> U. real c / 2 < w u}\n  y \\<in> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  x \\<in> B\n  y \\<in> B\n  x \\<noteq> y\n  x \\<in> {u \\<in> U. real c / 2 < w u}\n  y \\<in> {u \\<in> U. real c / 2 < w u}", "have \"c < w x + w y\""], ["proof (prove)\nusing this:\n  x \\<in> B\n  y \\<in> B\n  x \\<noteq> y\n  x \\<in> {u \\<in> U. real c / 2 < w u}\n  y \\<in> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. real c < w x + w y", "by force"], ["proof (state)\nthis:\n  real c < w x + w y\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "have \"finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B", "using assms"], ["proof (prove)\nusing this:\n  bp P\n  B \\<in> P\n\ngoal (1 subgoal):\n 1. finite B", "by simp"], ["proof (state)\nthis:\n  finite B\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "have \"y \\<in> B - {x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> B - {x}", "using *(2,3)"], ["proof (prove)\nusing this:\n  y \\<in> B\n  x \\<noteq> y\n\ngoal (1 subgoal):\n 1. y \\<in> B - {x}", "by blast"], ["proof (state)\nthis:\n  y \\<in> B - {x}\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "have \"W B = W (B - {x}) + w x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B = W (B - {x}) + w x", "using *(1) \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> B\n  finite B\n\ngoal (1 subgoal):\n 1. W B = W (B - {x}) + w x", "by (simp add: sum.remove)"], ["proof (state)\nthis:\n  W B = W (B - {x}) + w x\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "also"], ["proof (state)\nthis:\n  W B = W (B - {x}) + w x\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "have \"... = W (B - {x} - {y}) + w x + w y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W (B - {x}) + w x = W (B - {x} - {y}) + w x + w y", "using \\<open>y \\<in> B - {x}\\<close> \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  y \\<in> B - {x}\n  finite B\n\ngoal (1 subgoal):\n 1. W (B - {x}) + w x = W (B - {x} - {y}) + w x + w y", "by (simp add: sum.remove)"], ["proof (state)\nthis:\n  W (B - {x}) + w x = W (B - {x} - {y}) + w x + w y\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "finally"], ["proof (chain)\npicking this:\n  W B = W (B - {x} - {y}) + w x + w y", "have *: \"W B = W (B - {x} - {y}) + w x + w y\""], ["proof (prove)\nusing this:\n  W B = W (B - {x} - {y}) + w x + w y\n\ngoal (1 subgoal):\n 1. W B = W (B - {x} - {y}) + w x + w y", "."], ["proof (state)\nthis:\n  W B = W (B - {x} - {y}) + w x + w y\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "have \"\\<forall>u \\<in> B. 0 < w u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u\\<in>B. 0 < w u", "using bpE(3)[OF assms(1)] assms(2) weight"], ["proof (prove)\nusing this:\n  \\<Union> P = U\n  B \\<in> P\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>u\\<in>B. 0 < w u", "by blast"], ["proof (state)\nthis:\n  \\<forall>u\\<in>B. 0 < w u\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  \\<forall>u\\<in>B. 0 < w u", "have \"0 \\<le> W (B - {x} - {y})\""], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>B. 0 < w u\n\ngoal (1 subgoal):\n 1. 0 \\<le> W (B - {x} - {y})", "by (smt DiffD1 sum_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> W (B - {x} - {y})\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "with *"], ["proof (chain)\npicking this:\n  W B = W (B - {x} - {y}) + w x + w y\n  0 \\<le> W (B - {x} - {y})", "have \"c < W B\""], ["proof (prove)\nusing this:\n  W B = W (B - {x} - {y}) + w x + w y\n  0 \\<le> W (B - {x} - {y})\n\ngoal (1 subgoal):\n 1. real c < W B", "using \\<open>c < w x + w y\\<close>"], ["proof (prove)\nusing this:\n  W B = W (B - {x} - {y}) + w x + w y\n  0 \\<le> W (B - {x} - {y})\n  real c < w x + w y\n\ngoal (1 subgoal):\n 1. real c < W B", "by simp"], ["proof (state)\nthis:\n  real c < W B\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>B.\n       \\<exists>y\\<in>B.\n          x \\<noteq> y \\<and>\n          y \\<in> U \\<and>\n          x \\<in> U \\<and>\n          real c < w x * 2 \\<and> real c < w y * 2 \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  real c < W B", "show False"], ["proof (prove)\nusing this:\n  real c < W B\n\ngoal (1 subgoal):\n 1. False", "using bpE(4)[OF assms(1)] assms(2)"], ["proof (prove)\nusing this:\n  real c < W B\n  \\<forall>B\\<in>P. W B \\<le> real c\n  B \\<in> P\n\ngoal (1 subgoal):\n 1. False", "by fastforce"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma L_lower_bound_card:\n  assumes \"bp P\"\n  shows \"card L\\<^sub>U \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "have \"\\<forall>x \\<in> L\\<^sub>U. \\<exists>B \\<in> P. x \\<in> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{u \\<in> U. real c / 2 < w u}.\n       \\<exists>B\\<in>P. x \\<in> B", "using bpE(3)[OF assms]"], ["proof (prove)\nusing this:\n  \\<Union> P = U\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{u \\<in> U. real c / 2 < w u}.\n       \\<exists>B\\<in>P. x \\<in> B", "by blast"], ["proof (state)\nthis:\n  \\<forall>x\\<in>{u \\<in> U. real c / 2 < w u}. \\<exists>B\\<in>P. x \\<in> B\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "then"], ["proof (chain)\npicking this:\n  \\<forall>x\\<in>{u \\<in> U. real c / 2 < w u}. \\<exists>B\\<in>P. x \\<in> B", "obtain f where f_def: \"\\<forall>u \\<in> L\\<^sub>U. u \\<in> f u \\<and> f u \\<in> P\""], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{u \\<in> U. real c / 2 < w u}. \\<exists>B\\<in>P. x \\<in> B\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<forall>u\\<in>{u \\<in> U. real c / 2 < w u}.\n           u \\<in> f u \\<and> f u \\<in> P \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  \\<forall>u\\<in>{u \\<in> U. real c / 2 < w u}.\n     u \\<in> f u \\<and> f u \\<in> P\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "then"], ["proof (chain)\npicking this:\n  \\<forall>u\\<in>{u \\<in> U. real c / 2 < w u}.\n     u \\<in> f u \\<and> f u \\<in> P", "have \"inj_on f L\\<^sub>U\""], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>{u \\<in> U. real c / 2 < w u}.\n     u \\<in> f u \\<and> f u \\<in> P\n\ngoal (1 subgoal):\n 1. inj_on f {u \\<in> U. real c / 2 < w u}", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>{u \\<in> U. real c / 2 < w u}.\n     u \\<in> f u \\<and> f u \\<in> P\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{u \\<in> U. real c / 2 < w u}.\n       \\<forall>y\\<in>{u \\<in> U. real c / 2 < w u}.\n          f x = f y \\<longrightarrow> x = y", "using only_one_L_per_bin[OF assms]"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>{u \\<in> U. real c / 2 < w u}.\n     u \\<in> f u \\<and> f u \\<in> P\n  ?B \\<in> P \\<Longrightarrow>\n  \\<forall>x\\<in>?B.\n     \\<forall>y\\<in>?B.\n        x \\<noteq> y \\<longrightarrow>\n        x \\<notin> {u \\<in> U. real c / 2 < w u} \\<or>\n        y \\<notin> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{u \\<in> U. real c / 2 < w u}.\n       \\<forall>y\\<in>{u \\<in> U. real c / 2 < w u}.\n          f x = f y \\<longrightarrow> x = y", "by blast"], ["proof (state)\nthis:\n  inj_on f {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "then"], ["proof (chain)\npicking this:\n  inj_on f {u \\<in> U. real c / 2 < w u}", "have card_eq: \"card L\\<^sub>U = card (f ` L\\<^sub>U)\""], ["proof (prove)\nusing this:\n  inj_on f {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} =\n    card (f ` {u \\<in> U. real c / 2 < w u})", "by (simp add: card_image)"], ["proof (state)\nthis:\n  card {u \\<in> U. real c / 2 < w u} =\n  card (f ` {u \\<in> U. real c / 2 < w u})\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "have \"f ` L\\<^sub>U \\<subseteq> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ` {u \\<in> U. real c / 2 < w u} \\<subseteq> P", "using f_def"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>{u \\<in> U. real c / 2 < w u}.\n     u \\<in> f u \\<and> f u \\<in> P\n\ngoal (1 subgoal):\n 1. f ` {u \\<in> U. real c / 2 < w u} \\<subseteq> P", "by blast"], ["proof (state)\nthis:\n  f ` {u \\<in> U. real c / 2 < w u} \\<subseteq> P\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "moreover"], ["proof (state)\nthis:\n  f ` {u \\<in> U. real c / 2 < w u} \\<subseteq> P\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "have \"finite P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite P", "using assms"], ["proof (prove)\nusing this:\n  bp P\n\ngoal (1 subgoal):\n 1. finite P", "by simp"], ["proof (state)\nthis:\n  finite P\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "ultimately"], ["proof (chain)\npicking this:\n  f ` {u \\<in> U. real c / 2 < w u} \\<subseteq> P\n  finite P", "have \"card (f ` L\\<^sub>U) \\<le> card P\""], ["proof (prove)\nusing this:\n  f ` {u \\<in> U. real c / 2 < w u} \\<subseteq> P\n  finite P\n\ngoal (1 subgoal):\n 1. card (f ` {u \\<in> U. real c / 2 < w u}) \\<le> card P", "by (simp add: card_mono)"], ["proof (state)\nthis:\n  card (f ` {u \\<in> U. real c / 2 < w u}) \\<le> card P\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "then"], ["proof (chain)\npicking this:\n  card (f ` {u \\<in> U. real c / 2 < w u}) \\<le> card P", "show ?thesis"], ["proof (prove)\nusing this:\n  card (f ` {u \\<in> U. real c / 2 < w u}) \\<le> card P\n\ngoal (1 subgoal):\n 1. card {u \\<in> U. real c / 2 < w u} \\<le> card P", "unfolding card_eq"], ["proof (prove)\nusing this:\n  card (f ` {u \\<in> U. real c / 2 < w u}) \\<le> card P\n\ngoal (1 subgoal):\n 1. card (f ` {u \\<in> U. real c / 2 < w u}) \\<le> card P", "."], ["proof (state)\nthis:\n  card {u \\<in> U. real c / 2 < w u} \\<le> card P\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma subset_bp_card:\n  assumes \"bp P\" \"M \\<subseteq> P\" \"\\<forall>B \\<in> M. B \\<inter> L\\<^sub>U \\<noteq> {}\"\n  shows \"card M \\<le> card L\\<^sub>U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "have \"\\<forall>B \\<in> M. \\<exists>u \\<in> L\\<^sub>U. u \\<in> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>M.\n       \\<exists>u\\<in>{u \\<in> U. real c / 2 < w u}. u \\<in> B", "using assms(3)"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>M. B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>M.\n       \\<exists>u\\<in>{u \\<in> U. real c / 2 < w u}. u \\<in> B", "by fast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>M. \\<exists>u\\<in>{u \\<in> U. real c / 2 < w u}. u \\<in> B\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "then"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>M. \\<exists>u\\<in>{u \\<in> U. real c / 2 < w u}. u \\<in> B", "have \"\\<exists>f. \\<forall>B \\<in> M. f B \\<in> L\\<^sub>U \\<and> f B \\<in> B\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>M. \\<exists>u\\<in>{u \\<in> U. real c / 2 < w u}. u \\<in> B\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       \\<forall>B\\<in>M.\n          f B \\<in> {u \\<in> U. real c / 2 < w u} \\<and> f B \\<in> B", "by metis"], ["proof (state)\nthis:\n  \\<exists>f.\n     \\<forall>B\\<in>M.\n        f B \\<in> {u \\<in> U. real c / 2 < w u} \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "then"], ["proof (chain)\npicking this:\n  \\<exists>f.\n     \\<forall>B\\<in>M.\n        f B \\<in> {u \\<in> U. real c / 2 < w u} \\<and> f B \\<in> B", "obtain f where f_def: \"\\<forall>B \\<in> M. f B \\<in> L\\<^sub>U \\<and> f B \\<in> B\""], ["proof (prove)\nusing this:\n  \\<exists>f.\n     \\<forall>B\\<in>M.\n        f B \\<in> {u \\<in> U. real c / 2 < w u} \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<forall>B\\<in>M.\n           f B \\<in> {u \\<in> U. real c / 2 < w u} \\<and>\n           f B \\<in> B \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", ".."], ["proof (state)\nthis:\n  \\<forall>B\\<in>M.\n     f B \\<in> {u \\<in> U. real c / 2 < w u} \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "have \"inj_on f M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f M", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "assume \"\\<not> inj_on f M\""], ["proof (state)\nthis:\n  \\<not> inj_on f M\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<not> inj_on f M", "have \"\\<exists>x \\<in> M. \\<exists>y \\<in> M. x \\<noteq> y \\<and> f x = f y\""], ["proof (prove)\nusing this:\n  \\<not> inj_on f M\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<not> (\\<forall>x\\<in>M.\n             \\<forall>y\\<in>M. f x = f y \\<longrightarrow> x = y)\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y", "by blast"], ["proof (state)\nthis:\n  \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y", "obtain x y where *: \"x \\<in> M\" \"y \\<in> M\" \"x \\<noteq> y\" \"f x = f y\""], ["proof (prove)\nusing this:\n  \\<exists>x\\<in>M. \\<exists>y\\<in>M. x \\<noteq> y \\<and> f x = f y\n\ngoal (1 subgoal):\n 1. (\\<And>x y.\n        \\<lbrakk>x \\<in> M; y \\<in> M; x \\<noteq> y; f x = f y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y", "have \"\\<exists>u. u \\<in> x \\<and> u \\<in> y\""], ["proof (prove)\nusing this:\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n\ngoal (1 subgoal):\n 1. \\<exists>u. u \\<in> x \\<and> u \\<in> y", "using f_def"], ["proof (prove)\nusing this:\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n  \\<forall>B\\<in>M.\n     f B \\<in> {u \\<in> U. real c / 2 < w u} \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. \\<exists>u. u \\<in> x \\<and> u \\<in> y", "by metis"], ["proof (state)\nthis:\n  \\<exists>u. u \\<in> x \\<and> u \\<in> y\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<exists>u. u \\<in> x \\<and> u \\<in> y", "have \"x \\<inter> y \\<noteq> {}\""], ["proof (prove)\nusing this:\n  \\<exists>u. u \\<in> x \\<and> u \\<in> y\n\ngoal (1 subgoal):\n 1. x \\<inter> y \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  x \\<inter> y \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  x \\<inter> y \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "have \"pairwise disjnt M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint M", "using pairwise_subset[OF bpE(1)[OF assms(1)] assms(2)]"], ["proof (prove)\nusing this:\n  disjoint M\n\ngoal (1 subgoal):\n 1. disjoint M", "."], ["proof (state)\nthis:\n  disjoint M\n\ngoal (1 subgoal):\n 1. \\<not> inj_on f M \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  x \\<inter> y \\<noteq> {}\n  disjoint M", "show False"], ["proof (prove)\nusing this:\n  x \\<inter> y \\<noteq> {}\n  disjoint M\n\ngoal (1 subgoal):\n 1. False", "using *"], ["proof (prove)\nusing this:\n  x \\<inter> y \\<noteq> {}\n  disjoint M\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n\ngoal (1 subgoal):\n 1. False", "unfolding pairwise_def disjnt_def"], ["proof (prove)\nusing this:\n  x \\<inter> y \\<noteq> {}\n  \\<forall>x\\<in>M.\n     \\<forall>y\\<in>M. x \\<noteq> y \\<longrightarrow> x \\<inter> y = {}\n  x \\<in> M\n  y \\<in> M\n  x \\<noteq> y\n  f x = f y\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj_on f M\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "moreover"], ["proof (state)\nthis:\n  inj_on f M\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "have \"finite L\\<^sub>U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {u \\<in> U. real c / 2 < w u}", "using U_Finite"], ["proof (prove)\nusing this:\n  finite U\n\ngoal (1 subgoal):\n 1. finite {u \\<in> U. real c / 2 < w u}", "by auto"], ["proof (state)\nthis:\n  finite {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "moreover"], ["proof (state)\nthis:\n  finite {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "have \"f ` M \\<subseteq> L\\<^sub>U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ` M \\<subseteq> {u \\<in> U. real c / 2 < w u}", "using f_def"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>M.\n     f B \\<in> {u \\<in> U. real c / 2 < w u} \\<and> f B \\<in> B\n\ngoal (1 subgoal):\n 1. f ` M \\<subseteq> {u \\<in> U. real c / 2 < w u}", "by blast"], ["proof (state)\nthis:\n  f ` M \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "ultimately"], ["proof (chain)\npicking this:\n  inj_on f M\n  finite {u \\<in> U. real c / 2 < w u}\n  f ` M \\<subseteq> {u \\<in> U. real c / 2 < w u}", "show ?thesis"], ["proof (prove)\nusing this:\n  inj_on f M\n  finite {u \\<in> U. real c / 2 < w u}\n  f ` M \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "using card_inj_on_le"], ["proof (prove)\nusing this:\n  inj_on f M\n  finite {u \\<in> U. real c / 2 < w u}\n  f ` M \\<subseteq> {u \\<in> U. real c / 2 < w u}\n  \\<lbrakk>inj_on ?f ?A; ?f ` ?A \\<subseteq> ?B; finite ?B\\<rbrakk>\n  \\<Longrightarrow> card ?A \\<le> card ?B\n\ngoal (1 subgoal):\n 1. card M \\<le> card {u \\<in> U. real c / 2 < w u}", "by blast"], ["proof (state)\nthis:\n  card M \\<le> card {u \\<in> U. real c / 2 < w u}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma L_bins_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\" \"\\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {}\"\n      and SL_def: \"SL S L\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n    \\<le> card P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n    \\<le> card P", "note invrules = inv\\<^sub>1E[OF assms(2)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - (S \\<union> L)\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n    \\<le> card P", "have \"\\<forall>B \\<in> {{v} |v. v \\<in> L}. B \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>{{v} |v. v \\<in> L}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "using SL_def"], ["proof (prove)\nusing this:\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>{{v} |v. v \\<in> L}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  \\<forall>B\\<in>{{v} |v. v \\<in> L}.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n    \\<le> card P", "with assms(3)"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  \\<forall>B\\<in>{{v} |v. v \\<in> L}.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "have\n    \"P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L} \\<subseteq> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> S \\<union> L}\"\n    \"\\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}. B \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  \\<forall>B\\<in>{{v} |v. v \\<in> L}.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}\n    \\<subseteq> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                P\\<^sub>2 \\<union>\n                wrap B\\<^sub>2 \\<union>\n                {{v} |v. v \\<in> S \\<union> L} &&&\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   {{v} |v. v \\<in> L}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by blast+"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}\n  \\<subseteq> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> S \\<union> L}\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 {{v} |v. v \\<in> L}.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n    \\<le> card P", "from subset_bp_card[OF invrules(1) this]"], ["proof (chain)\npicking this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n  \\<le> card {u \\<in> U. real c / 2 < w u}", "show ?thesis"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n  \\<le> card {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n    \\<le> card P", "using L_lower_bound_card[OF assms(1)]"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n  \\<le> card {u \\<in> U. real c / 2 < w u}\n  card {u \\<in> U. real c / 2 < w u} \\<le> card P\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n    \\<le> card P", "by linarith"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n  \\<le> card P\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma sum_Un_eq_sum_sum:\n  assumes \"bp P\"\n  shows \"(\\<Sum>u \\<in> U. w u) = (\\<Sum>B \\<in> P. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W U = sum W P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. W U = sum W P", "have FINITE: \"\\<forall>B \\<in> P. finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. finite B", "using assms"], ["proof (prove)\nusing this:\n  bp P\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. finite B", "by simp"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P. finite B\n\ngoal (1 subgoal):\n 1. W U = sum W P", "have DISJNT: \"\\<forall>A \\<in> P. \\<forall>B \\<in> P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P.\n       \\<forall>B\\<in>P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "using bpE(1)[OF assms]"], ["proof (prove)\nusing this:\n  disjoint P\n\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P.\n       \\<forall>B\\<in>P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "unfolding pairwise_def disjnt_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>P.\n     \\<forall>y\\<in>P. x \\<noteq> y \\<longrightarrow> x \\<inter> y = {}\n\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P.\n       \\<forall>B\\<in>P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "."], ["proof (state)\nthis:\n  \\<forall>A\\<in>P.\n     \\<forall>B\\<in>P. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. W U = sum W P", "have \"(\\<Sum>u \\<in> (\\<Union>P). w u) = (\\<Sum>B \\<in> P. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W (\\<Union> P) = sum W P", "using sum.Union_disjoint[OF FINITE DISJNT]"], ["proof (prove)\nusing this:\n  sum ?g (\\<Union> P) = (sum \\<circ> sum) ?g P\n\ngoal (1 subgoal):\n 1. W (\\<Union> P) = sum W P", "by auto"], ["proof (state)\nthis:\n  W (\\<Union> P) = sum W P\n\ngoal (1 subgoal):\n 1. W U = sum W P", "then"], ["proof (chain)\npicking this:\n  W (\\<Union> P) = sum W P", "show ?thesis"], ["proof (prove)\nusing this:\n  W (\\<Union> P) = sum W P\n\ngoal (1 subgoal):\n 1. W U = sum W P", "unfolding bpE(3)[OF assms]"], ["proof (prove)\nusing this:\n  W U = sum W P\n\ngoal (1 subgoal):\n 1. W U = sum W P", "."], ["proof (state)\nthis:\n  W U = sum W P\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma sum_lower_bound_card:\n  assumes \"bp P\"\n  shows \"(\\<Sum>u \\<in> U. w u) \\<le> c * card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "have *: \"\\<forall>B \\<in> P. 0 < W B \\<and> W B \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. 0 < W B \\<and> W B \\<le> real c", "using bpE(2-4)[OF assms] weight"], ["proof (prove)\nusing this:\n  {} \\<notin> P\n  \\<Union> P = U\n  \\<forall>B\\<in>P. W B \\<le> real c\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P. 0 < W B \\<and> W B \\<le> real c", "by (metis UnionI assms bp_bins_finite sum_pos)"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P. 0 < W B \\<and> W B \\<le> real c\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "have \"(\\<Sum>u \\<in> U. w u) = (\\<Sum>B \\<in> P. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W U = sum W P", "using sum_Un_eq_sum_sum[OF assms]"], ["proof (prove)\nusing this:\n  W U = sum W P\n\ngoal (1 subgoal):\n 1. W U = sum W P", "."], ["proof (state)\nthis:\n  W U = sum W P\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "also"], ["proof (state)\nthis:\n  W U = sum W P\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "have \"... \\<le> (\\<Sum>B \\<in> P. c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P \\<le> real (\\<Sum>B\\<in>P. c)", "using sum_mono *"], ["proof (prove)\nusing this:\n  (\\<And>i. i \\<in> ?K \\<Longrightarrow> ?f i \\<le> ?g i) \\<Longrightarrow>\n  sum ?f ?K \\<le> sum ?g ?K\n  \\<forall>B\\<in>P. 0 < W B \\<and> W B \\<le> real c\n\ngoal (1 subgoal):\n 1. sum W P \\<le> real (\\<Sum>B\\<in>P. c)", "by fastforce"], ["proof (state)\nthis:\n  sum W P \\<le> real (\\<Sum>B\\<in>P. c)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "also"], ["proof (state)\nthis:\n  sum W P \\<le> real (\\<Sum>B\\<in>P. c)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "have \"... = c * card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (\\<Sum>B\\<in>P. c) = real (c * card P)", "by simp"], ["proof (state)\nthis:\n  real (\\<Sum>B\\<in>P. c) = real (c * card P)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "finally"], ["proof (chain)\npicking this:\n  W U \\<le> real (c * card P)", "show ?thesis"], ["proof (prove)\nusing this:\n  W U \\<le> real (c * card P)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "."], ["proof (state)\nthis:\n  W U \\<le> real (c * card P)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bp_NE:\n  assumes \"bp P\"\n  shows \"P \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P \\<noteq> {}", "using U_NE bpE(3)[OF assms]"], ["proof (prove)\nusing this:\n  U \\<noteq> {}\n  \\<Union> P = U\n\ngoal (1 subgoal):\n 1. P \\<noteq> {}", "by blast"], ["", "lemma sum_Un_ge:\n  fixes f :: \"_ \\<Rightarrow> real\"\n  assumes \"finite M\" \"finite N\" \"\\<forall>B \\<in> M \\<union> N. 0 < f B\"\n  shows \"sum f M \\<le> sum f (M \\<union> N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "have \"0 \\<le> sum f N - sum f (M \\<inter> N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> sum f N - sum f (M \\<inter> N)", "using assms"], ["proof (prove)\nusing this:\n  finite M\n  finite N\n  \\<forall>B\\<in>M \\<union> N. 0 < f B\n\ngoal (1 subgoal):\n 1. 0 \\<le> sum f N - sum f (M \\<inter> N)", "by (smt DiffD1 inf.cobounded2 UnCI sum_mono2)"], ["proof (state)\nthis:\n  0 \\<le> sum f N - sum f (M \\<inter> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "then"], ["proof (chain)\npicking this:\n  0 \\<le> sum f N - sum f (M \\<inter> N)", "have \"sum f M \\<le> sum f M + sum f N - sum f (M \\<inter> N)\""], ["proof (prove)\nusing this:\n  0 \\<le> sum f N - sum f (M \\<inter> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f M + sum f N - sum f (M \\<inter> N)", "by simp"], ["proof (state)\nthis:\n  sum f M \\<le> sum f M + sum f N - sum f (M \\<inter> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "also"], ["proof (state)\nthis:\n  sum f M \\<le> sum f M + sum f N - sum f (M \\<inter> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "have \"... = sum f (M \\<union> N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f M + sum f N - sum f (M \\<inter> N) = sum f (M \\<union> N)", "using sum_Un[OF assms(1,2), symmetric]"], ["proof (prove)\nusing this:\n  sum ?f M + sum ?f N - sum ?f (M \\<inter> N) = sum ?f (M \\<union> N)\n\ngoal (1 subgoal):\n 1. sum f M + sum f N - sum f (M \\<inter> N) = sum f (M \\<union> N)", "."], ["proof (state)\nthis:\n  sum f M + sum f N - sum f (M \\<inter> N) = sum f (M \\<union> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "finally"], ["proof (chain)\npicking this:\n  sum f M \\<le> sum f (M \\<union> N)", "show ?thesis"], ["proof (prove)\nusing this:\n  sum f M \\<le> sum f (M \\<union> N)\n\ngoal (1 subgoal):\n 1. sum f M \\<le> sum f (M \\<union> N)", "."], ["proof (state)\nthis:\n  sum f M \\<le> sum f (M \\<union> N)\n\ngoal:\nNo subgoals!", "qed"], ["", "definition bij_exists :: \"'a set set \\<Rightarrow> 'a set \\<Rightarrow> bool\" where\n  \"bij_exists P V = (\\<exists>f. bij_betw f P V \\<and> (\\<forall>B \\<in> P. W B + w (f B) > c))\""], ["", "lemma P\\<^sub>1_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"card P\\<^sub>1 + 1 \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "proof (cases \\<open>P\\<^sub>1 = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. P\\<^sub>1 = {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P\n 2. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "case True"], ["proof (state)\nthis:\n  P\\<^sub>1 = {}\n\ngoal (2 subgoals):\n 1. P\\<^sub>1 = {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P\n 2. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"finite P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite P", "using assms(1)"], ["proof (prove)\nusing this:\n  bp P\n\ngoal (1 subgoal):\n 1. finite P", "by simp"], ["proof (state)\nthis:\n  finite P\n\ngoal (2 subgoals):\n 1. P\\<^sub>1 = {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P\n 2. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "then"], ["proof (chain)\npicking this:\n  finite P", "have \"1 \\<le> card P\""], ["proof (prove)\nusing this:\n  finite P\n\ngoal (1 subgoal):\n 1. 1 \\<le> card P", "using bp_NE[OF assms(1)]"], ["proof (prove)\nusing this:\n  finite P\n  P \\<noteq> {}\n\ngoal (1 subgoal):\n 1. 1 \\<le> card P", "by (metis Nat.add_0_right Suc_diff_1 Suc_le_mono card_gt_0_iff le0 mult_Suc_right nat_mult_1)"], ["proof (state)\nthis:\n  1 \\<le> card P\n\ngoal (2 subgoals):\n 1. P\\<^sub>1 = {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P\n 2. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "then"], ["proof (chain)\npicking this:\n  1 \\<le> card P", "show ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> card P\n\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "unfolding True"], ["proof (prove)\nusing this:\n  1 \\<le> card P\n\ngoal (1 subgoal):\n 1. card {} + 1 \\<le> card P", "by simp"], ["proof (state)\nthis:\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "note invrules = inv\\<^sub>1E[OF assms(2)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - (S \\<union> L)\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "case False"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "obtain f where f_def: \"bij_betw f P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\" \"\\<forall>B \\<in> P\\<^sub>1. W B + w (f B) > c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms(3)"], ["proof (prove)\nusing this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     bij_betw f P\\<^sub>1\n      (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n     (\\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have FINITE: \"finite P\\<^sub>1\" \"finite (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\" \"finite (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\" \"finite (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (finite P\\<^sub>1 &&& finite (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    finite (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) &&&\n    finite (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L})", "using inv\\<^sub>1E(1)[OF assms(2)] bp_sol_finite"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n  bp ?P \\<Longrightarrow> finite ?P\n\ngoal (1 subgoal):\n 1. (finite P\\<^sub>1 &&& finite (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    finite (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) &&&\n    finite (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L})", "by blast+"], ["proof (state)\nthis:\n  finite P\\<^sub>1\n  finite (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  finite (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  finite (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L})\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have F: \"\\<forall>B \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2. finite B", "using invrules(1)"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2. finite B", "by simp"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2. finite B\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have D: \"\\<forall>A \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. \\<forall>B \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n       \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n          A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "using bpE(1)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L})\n\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n       \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n          A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "unfolding pairwise_def disjnt_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> S \\<union> L}.\n     \\<forall>y\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                    P\\<^sub>2 \\<union>\n                    wrap B\\<^sub>2 \\<union>\n                    {{v} |v. v \\<in> S \\<union> L}.\n        x \\<noteq> y \\<longrightarrow> x \\<inter> y = {}\n\ngoal (1 subgoal):\n 1. \\<forall>A\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n       \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n          A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}", "by auto"], ["proof (state)\nthis:\n  \\<forall>A\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n     \\<forall>B\\<in>P\\<^sub>2 \\<union> wrap B\\<^sub>2.\n        A \\<noteq> B \\<longrightarrow> A \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have sum_eq: \"W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) = (\\<Sum>B \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n    sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using sum.Union_disjoint[OF F D]"], ["proof (prove)\nusing this:\n  sum ?g (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  (sum \\<circ> sum) ?g (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n    sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by auto"], ["proof (state)\nthis:\n  W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> S \\<union> L}. 0 < W B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> S \\<union> L}.\n       0 < W B", "using bpE(2,3)[OF invrules(1)] weight"], ["proof (prove)\nusing this:\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> S \\<union> L}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  U\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                   P\\<^sub>2 \\<union>\n                   wrap B\\<^sub>2 \\<union>\n                   {{v} |v. v \\<in> S \\<union> L}.\n       0 < W B", "by (metis (no_types, lifting) UnionI bp_bins_finite invrules(1) sum_pos)"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> S \\<union> L}.\n     0 < W B\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "then"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> S \\<union> L}.\n     0 < W B", "have \"(\\<Sum>B \\<in> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B) \\<le> (\\<Sum>B \\<in> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L}). W B)\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> S \\<union> L}.\n     0 < W B\n\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> sum W\n           (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n            (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L}))", "using sum_Un_ge[OF FINITE(3,4), of W]"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> S \\<union> L}.\n     0 < W B\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L}).\n     0 < W B \\<Longrightarrow>\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> sum W\n         (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n          (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L}))\n\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> sum W\n           (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n            (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L}))", "by blast"], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> sum W\n         (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n          (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L}))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> sum W\n         (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n          (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L}))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> S \\<union> L}. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W\n     (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n      (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L})) =\n    sum W\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})", "by (smt Un_assoc Un_commute)"], ["proof (state)\nthis:\n  sum W\n   (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n    (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L})) =\n  sum W\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L})\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W\n   (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union>\n    (wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> S \\<union> L})) =\n  sum W\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L})\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = W U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}) =\n    W U", "using sum_Un_eq_sum_sum[OF invrules(1), symmetric]"], ["proof (prove)\nusing this:\n  sum W\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  W U\n\ngoal (1 subgoal):\n 1. sum W\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}) =\n    W U", "."], ["proof (state)\nthis:\n  sum W\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  W U\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "finally"], ["proof (chain)\npicking this:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U", "have *: \"(\\<Sum>B \\<in> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B) \\<le> W U\""], ["proof (prove)\nusing this:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U", "."], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have DISJNT: \"P\\<^sub>1 \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}", "using invrules(5)"], ["proof (prove)\nusing this:\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}", "by blast\n\n  \\<comment> \\<open>This part of the proof is based on the proof on page 72 of the article @{cite BerghammerR03}.\\<close>"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<inter> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) = {}\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"c * card P\\<^sub>1 = (\\<Sum>B \\<in> P\\<^sub>1. c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c * card P\\<^sub>1 = (\\<Sum>B\\<in>P\\<^sub>1. c)", "by simp"], ["proof (state)\nthis:\n  c * card P\\<^sub>1 = (\\<Sum>B\\<in>P\\<^sub>1. c)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  c * card P\\<^sub>1 = (\\<Sum>B\\<in>P\\<^sub>1. c)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... < (\\<Sum>B \\<in> P\\<^sub>1. W B + w (f B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (\\<Sum>B\\<in>P\\<^sub>1. c) < (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B))", "using f_def(2) sum_strict_mono[OF FINITE(1) False]"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n  (\\<And>x.\n      x \\<in> P\\<^sub>1 \\<Longrightarrow> ?f x < ?g x) \\<Longrightarrow>\n  sum ?f P\\<^sub>1 < sum ?g P\\<^sub>1\n\ngoal (1 subgoal):\n 1. real (\\<Sum>B\\<in>P\\<^sub>1. c) < (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B))", "by fastforce"], ["proof (state)\nthis:\n  real (\\<Sum>B\\<in>P\\<^sub>1. c) < (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  real (\\<Sum>B\\<in>P\\<^sub>1. c) < (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1. W B) + (\\<Sum>B \\<in> P\\<^sub>1. w (f B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B)) =\n    sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B))", "by (simp add: Groups_Big.comm_monoid_add_class.sum.distrib)"], ["proof (state)\nthis:\n  (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B)) =\n  sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  (\\<Sum>B\\<in>P\\<^sub>1. W B + w (f B)) =\n  sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1. W B) + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B)) =\n    sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "unfolding sum.reindex_bij_betw[OF f_def(1), of w]"], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n    sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", ".."], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B)) =\n  sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + (\\<Sum>B\\<in>P\\<^sub>1. w (f B)) =\n  sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1. W B) + (\\<Sum>B \\<in> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n    sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "unfolding sum_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", ".."], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + W (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... = (\\<Sum>B \\<in> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2. W B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using sum.union_disjoint[OF FINITE(1,2) DISJNT, of W]"], ["proof (prove)\nusing this:\n  sum W (P\\<^sub>1 \\<union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) =\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n    sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by (simp add: Un_assoc)"], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W P\\<^sub>1 + sum W (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... \\<le> (\\<Sum>u \\<in> U. w u)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U", "using *"], ["proof (prove)\nusing this:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U", "."], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "also"], ["proof (state)\nthis:\n  sum W (P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> W U\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "have \"... \\<le> c * card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "using sum_lower_bound_card[OF assms(1)]"], ["proof (prove)\nusing this:\n  W U \\<le> real (c * card P)\n\ngoal (1 subgoal):\n 1. W U \\<le> real (c * card P)", "."], ["proof (state)\nthis:\n  W U \\<le> real (c * card P)\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<noteq> {} \\<Longrightarrow> card P\\<^sub>1 + 1 \\<le> card P", "finally"], ["proof (chain)\npicking this:\n  real (c * card P\\<^sub>1) < real (c * card P)", "show ?thesis"], ["proof (prove)\nusing this:\n  real (c * card P\\<^sub>1) < real (c * card P)\n\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "by (meson discrete nat_mult_less_cancel_disj of_nat_less_imp_less)"], ["proof (state)\nthis:\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma P\\<^sub>1_B\\<^sub>1_lower_bound_card:\n  assumes \"bp P\" \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "have \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n    \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)", "using card_Un_le"], ["proof (prove)\nusing this:\n  card (?A \\<union> ?B) \\<le> card ?A + card ?B\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n    \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)", "by blast"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n  \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "also"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n  \\<le> card P\\<^sub>1 + card (wrap B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "have \"... \\<le> card P\\<^sub>1 + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + card (wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + 1", "using wrap_card"], ["proof (prove)\nusing this:\n  card (wrap ?B) \\<le> 1\n\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + card (wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + 1", "by simp"], ["proof (state)\nthis:\n  card P\\<^sub>1 + card (wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + 1\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "also"], ["proof (state)\nthis:\n  card P\\<^sub>1 + card (wrap B\\<^sub>1) \\<le> card P\\<^sub>1 + 1\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "have \"... \\<le> card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "using P\\<^sub>1_lower_bound_card[OF assms]"], ["proof (prove)\nusing this:\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. card P\\<^sub>1 + 1 \\<le> card P", "."], ["proof (state)\nthis:\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "finally"], ["proof (chain)\npicking this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "show ?thesis"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P", "."], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma P\\<^sub>2_B\\<^sub>2_lower_bound_P\\<^sub>1:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\" \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\" \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n  shows \"2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "note invrules = inv\\<^sub>1E[OF assms(1)] and bprules = bpE[OF invrules(1)]"], ["proof (state)\nthis:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - (S \\<union> L)\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n  (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<inter>\n  (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  {}\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> S \\<union> L}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> S \\<union> L}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"pairwise disjnt (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using bprules(1) pairwise_subset"], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L})\n  \\<lbrakk>pairwise ?P ?S; ?T \\<subseteq> ?S\\<rbrakk>\n  \\<Longrightarrow> pairwise ?P ?T\n\ngoal (1 subgoal):\n 1. disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by blast"], ["proof (state)\nthis:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "moreover"], ["proof (state)\nthis:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"B\\<^sub>2 \\<notin> P\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<notin> P\\<^sub>2", "using invrules(4)"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<notin> P\\<^sub>2", "by simp"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "ultimately"], ["proof (chain)\npicking this:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  B\\<^sub>2 \\<notin> P\\<^sub>2", "have DISJNT: \"\\<Union>P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\""], ["proof (prove)\nusing this:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}", "by (auto, metis (no_types, hide_lams) sup_bot.right_neutral Un_insert_right disjnt_iff mk_disjoint_insert pairwise_insert wrap_Un)"], ["proof (state)\nthis:\n  \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"finite (\\<Union>P\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (\\<Union> P\\<^sub>2)", "using U_Finite bprules(3)"], ["proof (prove)\nusing this:\n  finite U\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  U\n\ngoal (1 subgoal):\n 1. finite (\\<Union> P\\<^sub>2)", "by auto"], ["proof (state)\nthis:\n  finite (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"finite B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "using bp_bins_finite[OF invrules(1)] wrap_not_empty"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> S \\<union> L}.\n     finite B\n  (?M \\<noteq> {}) = (wrap ?M = {?M})\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "by blast"], ["proof (state)\nthis:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"finite P\\<^sub>2\" \"finite (wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite P\\<^sub>2 &&& finite (wrap B\\<^sub>2)", "using bp_sol_finite[OF invrules(1)]"], ["proof (prove)\nusing this:\n  finite\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L})\n\ngoal (1 subgoal):\n 1. finite P\\<^sub>2 &&& finite (wrap B\\<^sub>2)", "by blast+"], ["proof (state)\nthis:\n  finite P\\<^sub>2\n  finite (wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have DISJNT2: \"P\\<^sub>2 \\<inter> wrap B\\<^sub>2 = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>2 \\<inter> wrap B\\<^sub>2 = {}", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. P\\<^sub>2 \\<inter> (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) = {}", "using \\<open>B\\<^sub>2 \\<notin> P\\<^sub>2\\<close>"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. P\\<^sub>2 \\<inter> (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) = {}", "by auto"], ["proof (state)\nthis:\n  P\\<^sub>2 \\<inter> wrap B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "have \"card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "proof (cases \\<open>B\\<^sub>2 = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "case False"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "then"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<noteq> {}", "have \"1 \\<le> card B\\<^sub>2\""], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. 1 \\<le> card B\\<^sub>2", "by (simp add: leI \\<open>finite B\\<^sub>2\\<close>)"], ["proof (state)\nthis:\n  1 \\<le> card B\\<^sub>2\n\ngoal (2 subgoals):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n 2. B\\<^sub>2 \\<noteq> {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "then"], ["proof (chain)\npicking this:\n  1 \\<le> card B\\<^sub>2", "show ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "using wrap_card[of B\\<^sub>2]"], ["proof (prove)\nusing this:\n  1 \\<le> card B\\<^sub>2\n  card (wrap B\\<^sub>2) \\<le> 1\n\ngoal (1 subgoal):\n 1. card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "by linarith"], ["proof (state)\nthis:\n  card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 = {} \\<Longrightarrow>\n    card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2", "qed simp\n\n  \\<comment> \\<open>This part of the proof is based on the proof on page 73 of the article @{cite BerghammerR03}.\\<close>"], ["proof (state)\nthis:\n  card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "from assms(2)"], ["proof (chain)\npicking this:\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)", "have \"2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2) \\<le> card (\\<Union>P\\<^sub>2) + card (wrap B\\<^sub>2) + 1\""], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n    \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1", "using wrap_card[of B\\<^sub>2]"], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  card (wrap B\\<^sub>2) \\<le> 1\n\ngoal (1 subgoal):\n 1. 2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n    \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1", "by linarith"], ["proof (state)\nthis:\n  2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "then"], ["proof (chain)\npicking this:\n  2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1", "have \"2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2)) \\<le> card (\\<Union>P\\<^sub>2) + card B\\<^sub>2 + 1\""], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1\n\ngoal (1 subgoal):\n 1. 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n    \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1", "using \\<open>card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\\<close>"], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 + 2 * card (wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2) + card (wrap B\\<^sub>2) + 1\n  card (wrap B\\<^sub>2) \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n    \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1", "by simp"], ["proof (state)\nthis:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "then"], ["proof (chain)\npicking this:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1", "have \"2 * (card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<le> card (\\<Union>P\\<^sub>2 \\<union> B\\<^sub>2) + 1\""], ["proof (prove)\nusing this:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1", "using card_Un_disjoint[OF \\<open>finite (\\<Union>P\\<^sub>2)\\<close> \\<open>finite B\\<^sub>2\\<close> DISJNT]\n      and card_Un_disjoint[OF \\<open>finite P\\<^sub>2\\<close> \\<open>finite (wrap B\\<^sub>2)\\<close> DISJNT2]"], ["proof (prove)\nusing this:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 + 1\n  card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) =\n  card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) =\n  card P\\<^sub>2 + card (wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1", "by argo"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "then"], ["proof (chain)\npicking this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1", "have \"2 * (card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<le> card (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\""], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1", "by (cases \\<open>B\\<^sub>2 = {}\\<close>) (auto simp: Un_commute)"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "then"], ["proof (chain)\npicking this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1", "show \"2 * (card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<le> card P\\<^sub>1 + 1\""], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "using assms(3) bij_betw_same_card"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  bij_betw ?f ?A ?B \\<Longrightarrow> card ?A = card ?B\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) + 1\n  \\<exists>f.\n     bij_betw f P\\<^sub>1\n      (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n     (\\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B))\n  bij_betw ?f ?A ?B \\<Longrightarrow> card ?A = card ?B\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1", "by metis"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>We add \\<open>SL S L\\<close> to \\<open>inv\\<^sub>2\\<close> to ensure that the \\<open>S\\<close> and \\<open>L\\<close> sets only contain objects with correct weights.\\<close>"], ["", "definition inv\\<^sub>2 :: \"'a set set \\<Rightarrow> 'a set set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> bool\" where\n  \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<longleftrightarrow> inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L) \\<comment> \\<open>\\<open>inv\\<^sub>1\\<close> holds for the partial solution\\<close>\n                       \\<and> (L \\<noteq> {} \\<longrightarrow> (\\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {})) \\<comment> \\<open>If there are still large objects left, then every bin of the first partial solution must contain a large object\\<close>\n                       \\<and> bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<comment> \\<open>There exists a bijective function between the bins of the first partial solution and the objects of the second one\\<close>\n                       \\<and> (2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)) \\<comment> \\<open>There are at most twice as many bins in \\<open>P\\<^sub>2\\<close> as there are objects in \\<open>P\\<^sub>2\\<close>\\<close>\n                       \\<and> SL S L \\<comment> \\<open>\\<open>S\\<close> and \\<open>L\\<close> are subsets of \\<open>S\\<^sub>U\\<close> and \\<open>L\\<^sub>U\\<close>\\<close>\""], ["", "lemma inv\\<^sub>2E:\n  assumes \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\"\n  shows \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\"\n    and \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {}\"\n    and \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n    and \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\"\n    and \"SL S L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L) &&&\n     (L \\<noteq> {} \\<Longrightarrow>\n      \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n         B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {})) &&&\n    bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2) &&&\n    S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n    L \\<subseteq> {u \\<in> U. real c / 2 < w u}", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\n\ngoal (1 subgoal):\n 1. (inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L) &&&\n     (L \\<noteq> {} \\<Longrightarrow>\n      \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n         B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {})) &&&\n    bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2) &&&\n    S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n    L \\<subseteq> {u \\<in> U. real c / 2 < w u}", "unfolding inv\\<^sub>2_def"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L) \\<and>\n  (L \\<noteq> {} \\<longrightarrow>\n   (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {})) \\<and>\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2) \\<and>\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. (inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L) &&&\n     (L \\<noteq> {} \\<Longrightarrow>\n      \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n         B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {})) &&&\n    bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) &&&\n    2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2) &&&\n    S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n    L \\<subseteq> {u \\<in> U. real c / 2 < w u}", "by blast+"], ["", "lemma inv\\<^sub>2I:\n  assumes \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\"\n    and \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B \\<in> P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {}\"\n    and \"bij_exists P\\<^sub>1 (\\<Union>(P\\<^sub>2 \\<union> wrap B\\<^sub>2))\"\n    and \"2 * card P\\<^sub>2 \\<le> card (\\<Union>P\\<^sub>2)\"\n    and \"SL S L\"\n  shows \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L", "unfolding inv\\<^sub>2_def"], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2\n     (S \\<union> L) \\<and>\n    (L \\<noteq> {} \\<longrightarrow>\n     (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n         B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {})) \\<and>\n    bij_exists P\\<^sub>1\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n    2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2) \\<and>\n    S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n    L \\<subseteq> {u \\<in> U. real c / 2 < w u}", "by blast"], ["", "lemma bin_packing_lower_bound_card:\n  assumes \"S = {}\" \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"bp P\"\n  shows \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> S \\<union> L}) \\<le> 3 / 2 * card P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "proof (cases \\<open>L = {}\\<close>)"], ["proof (state)\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "note invrules = inv\\<^sub>2E[OF assms(2)]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "case True"], ["proof (state)\nthis:\n  L = {}\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "then"], ["proof (chain)\npicking this:\n  L = {}", "have \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> S \\<union> L})\n           = card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\nusing this:\n  L = {}\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}) =\n    card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)", "using assms(1)"], ["proof (prove)\nusing this:\n  L = {}\n  S = {}\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}) =\n    card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)", "by simp"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)\n    \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n          card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using card_Un_le[of \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1\\<close>]"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> ?B)\n  \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) + card ?B\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)\n    \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n          card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by (simp add: Un_assoc)"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n  \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n        card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n  \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n        card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n    card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using P\\<^sub>1_B\\<^sub>1_lower_bound_card[OF assms(3) invrules(1,3)]"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) \\<le> card P\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n    card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by simp"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1) +\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card P + card P / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n    \\<le> real (card P) + real (card P) / 2", "using P\\<^sub>2_B\\<^sub>2_lower_bound_P\\<^sub>1[OF invrules(1,4,3)]\n      and P\\<^sub>1_lower_bound_card[OF assms(3) invrules(1,3)]"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n    \\<le> real (card P) + real (card P) / 2", "by linarith"], ["proof (state)\nthis:\n  real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<le> real (card P) + real (card P) / 2\n\ngoal (2 subgoals):\n 1. L = {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)\n 2. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}))\n  \\<le> real (card P) + real (card P) / 2", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}))\n  \\<le> real (card P) + real (card P) / 2\n\ngoal (1 subgoal):\n 1. real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "by linarith"], ["proof (state)\nthis:\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}))\n  \\<le> 3 / 2 * real (card P)\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "note invrules = inv\\<^sub>2E[OF assms(2)]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "case False"], ["proof (state)\nthis:\n  L \\<noteq> {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "have \"card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> S \\<union> L})\n      = card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L} \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}) =\n    card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> L} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)", "using assms(1)"], ["proof (prove)\nusing this:\n  S = {}\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}) =\n    card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> L} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)", "by (simp add: Un_commute Un_assoc)"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> L} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)\n    \\<le> card\n           (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n            {{v} |v. v \\<in> L}) +\n          card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using card_Un_le[of \\<open>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}\\<close>]"], ["proof (prove)\nusing this:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L} \\<union>\n    ?B)\n  \\<le> card\n         (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) +\n        card ?B\n\ngoal (1 subgoal):\n 1. card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n      {{v} |v. v \\<in> L} \\<union>\n      P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2)\n    \\<le> card\n           (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n            {{v} |v. v \\<in> L}) +\n          card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by (simp add: Un_assoc)"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n  \\<le> card\n         (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) +\n        card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L} \\<union>\n    P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2)\n  \\<le> card\n         (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) +\n        card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) +\n    card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using L_bins_lower_bound_card[OF assms(3) invrules(1) invrules(2)[OF False] invrules(5)]"], ["proof (prove)\nusing this:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L})\n  \\<le> card P\n\ngoal (1 subgoal):\n 1. card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) +\n    card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by linarith"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) +\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "also"], ["proof (state)\nthis:\n  card (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {{v} |v. v \\<in> L}) +\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "have \"... \\<le> card P + card P / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n    \\<le> real (card P) + real (card P) / 2", "using P\\<^sub>2_B\\<^sub>2_lower_bound_P\\<^sub>1[OF invrules(1,4,3)]\n      and P\\<^sub>1_lower_bound_card[OF assms(3) invrules(1,3)]"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card P\\<^sub>1 + 1\n  card P\\<^sub>1 + 1 \\<le> card P\n\ngoal (1 subgoal):\n 1. real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n    \\<le> real (card P) + real (card P) / 2", "by linarith"], ["proof (state)\nthis:\n  real (card P + card (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<le> real (card P) + real (card P) / 2\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}))\n  \\<le> real (card P) + real (card P) / 2", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}))\n  \\<le> real (card P) + real (card P) / 2\n\ngoal (1 subgoal):\n 1. real\n     (card\n       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> S \\<union> L}))\n    \\<le> 3 / 2 * real (card P)", "by linarith"], ["proof (state)\nthis:\n  real\n   (card\n     (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L}))\n  \\<le> 3 / 2 * real (card P)\n\ngoal:\nNo subgoals!", "qed"], ["", "definition inv\\<^sub>3 :: \"'a set set \\<Rightarrow> 'a set set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> 'a set \\<Rightarrow> bool\" where\n  \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<longleftrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and> B\\<^sub>2 \\<subseteq> S\\<^sub>U\""], ["", "lemma inv\\<^sub>3E:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\"\n  shows \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" and \"B\\<^sub>2 \\<subseteq> S\\<^sub>U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L &&&\n    B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L &&&\n    B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}", "unfolding inv\\<^sub>3_def"], ["proof (prove)\nusing this:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L &&&\n    B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}", "by blast+"], ["", "lemma inv\\<^sub>3I:\n  assumes \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" and \"B\\<^sub>2 \\<subseteq> S\\<^sub>U\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L", "using assms"], ["proof (prove)\nusing this:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L", "unfolding inv\\<^sub>3_def"], ["proof (prove)\nusing this:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n    B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}", "by blast"], ["", "lemma loop_init:\n  \"inv\\<^sub>3 {} {} {} {} S\\<^sub>U L\\<^sub>U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n     {u \\<in> U. real c / 2 < w u}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n     {u \\<in> U. real c / 2 < w u}", "have \"S\\<^sub>U \\<union> L\\<^sub>U = U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {u \\<in> U. w u \\<le> real c / 2} \\<union>\n    {u \\<in> U. real c / 2 < w u} =\n    U", "by auto"], ["proof (state)\nthis:\n  {u \\<in> U. w u \\<le> real c / 2} \\<union> {u \\<in> U. real c / 2 < w u} =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n     {u \\<in> U. real c / 2 < w u}", "then"], ["proof (chain)\npicking this:\n  {u \\<in> U. w u \\<le> real c / 2} \\<union> {u \\<in> U. real c / 2 < w u} =\n  U", "have *: \"inv\\<^sub>1 {} {} {} {} (S\\<^sub>U \\<union> L\\<^sub>U)\""], ["proof (prove)\nusing this:\n  {u \\<in> U. w u \\<le> real c / 2} \\<union> {u \\<in> U. real c / 2 < w u} =\n  U\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 {} {} {} {}\n     ({u \\<in> U. w u \\<le> real c / 2} \\<union>\n      {u \\<in> U. real c / 2 < w u})", "unfolding bp_def partition_on_def pairwise_def wrap_def inv\\<^sub>1_def"], ["proof (prove)\nusing this:\n  {u \\<in> U. w u \\<le> real c / 2} \\<union> {u \\<in> U. real c / 2 < w u} =\n  U\n\ngoal (1 subgoal):\n 1. ((\\<Union>\n       ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n        (if {} = {} then {} else {{}}) \\<union>\n        {{v} |v.\n         v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                 {u \\<in> U. real c / 2 < w u}}) =\n      U \\<and>\n      (\\<forall>x\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                      {} \\<union>\n                      (if {} = {} then {} else {{}}) \\<union>\n                      {{v} |v.\n                       v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                               {u \\<in> U. real c / 2 < w u}}.\n          \\<forall>y\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                         {} \\<union>\n                         (if {} = {} then {} else {{}}) \\<union>\n                         {{v} |v.\n                          v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                                  {u \\<in> U. real c / 2 < w u}}.\n             x \\<noteq> y \\<longrightarrow> disjnt x y) \\<and>\n      {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                  {} \\<union>\n                  (if {} = {} then {} else {{}}) \\<union>\n                  {{v} |v.\n                   v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                           {u \\<in> U. real c / 2 < w u}}) \\<and>\n     (\\<forall>B\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                     {} \\<union>\n                     (if {} = {} then {} else {{}}) \\<union>\n                     {{v} |v.\n                      v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                              {u \\<in> U. real c / 2 < w u}}.\n         W B \\<le> real c)) \\<and>\n    \\<Union>\n     ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n      (if {} = {} then {} else {{}})) =\n    U -\n    ({u \\<in> U. w u \\<le> real c / 2} \\<union>\n     {u \\<in> U. real c / 2 < w u}) \\<and>\n    {} \\<notin> {} \\<union> {} \\<union>\n                (if {} = {} then {} else {{}}) \\<and>\n    {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                {} \\<and>\n    ({} \\<union> (if {} = {} then {} else {{}})) \\<inter>\n    ({} \\<union> (if {} = {} then {} else {{}})) =\n    {}", "using weight"], ["proof (prove)\nusing this:\n  {u \\<in> U. w u \\<le> real c / 2} \\<union> {u \\<in> U. real c / 2 < w u} =\n  U\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n\ngoal (1 subgoal):\n 1. ((\\<Union>\n       ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n        (if {} = {} then {} else {{}}) \\<union>\n        {{v} |v.\n         v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                 {u \\<in> U. real c / 2 < w u}}) =\n      U \\<and>\n      (\\<forall>x\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                      {} \\<union>\n                      (if {} = {} then {} else {{}}) \\<union>\n                      {{v} |v.\n                       v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                               {u \\<in> U. real c / 2 < w u}}.\n          \\<forall>y\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                         {} \\<union>\n                         (if {} = {} then {} else {{}}) \\<union>\n                         {{v} |v.\n                          v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                                  {u \\<in> U. real c / 2 < w u}}.\n             x \\<noteq> y \\<longrightarrow> disjnt x y) \\<and>\n      {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                  {} \\<union>\n                  (if {} = {} then {} else {{}}) \\<union>\n                  {{v} |v.\n                   v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                           {u \\<in> U. real c / 2 < w u}}) \\<and>\n     (\\<forall>B\\<in>{} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                     {} \\<union>\n                     (if {} = {} then {} else {{}}) \\<union>\n                     {{v} |v.\n                      v \\<in> {u \\<in> U. w u \\<le> real c / 2} \\<union>\n                              {u \\<in> U. real c / 2 < w u}}.\n         W B \\<le> real c)) \\<and>\n    \\<Union>\n     ({} \\<union> (if {} = {} then {} else {{}}) \\<union> {} \\<union>\n      (if {} = {} then {} else {{}})) =\n    U -\n    ({u \\<in> U. w u \\<le> real c / 2} \\<union>\n     {u \\<in> U. real c / 2 < w u}) \\<and>\n    {} \\<notin> {} \\<union> {} \\<union>\n                (if {} = {} then {} else {{}}) \\<and>\n    {} \\<notin> {} \\<union> (if {} = {} then {} else {{}}) \\<union>\n                {} \\<and>\n    ({} \\<union> (if {} = {} then {} else {{}})) \\<inter>\n    ({} \\<union> (if {} = {} then {} else {{}})) =\n    {}", "by auto"], ["proof (state)\nthis:\n  inv\\<^sub>1 {} {} {} {}\n   ({u \\<in> U. w u \\<le> real c / 2} \\<union>\n    {u \\<in> U. real c / 2 < w u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n     {u \\<in> U. real c / 2 < w u}", "have \"bij_exists {} (\\<Union> ({} \\<union> wrap {}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_exists {} (\\<Union> ({} \\<union> wrap {}))", "using bij_betwI'"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              \\<lbrakk>x \\<in> ?X; y \\<in> ?X\\<rbrakk>\n              \\<Longrightarrow> (?f x = ?f y) = (x = y);\n   \\<And>x. x \\<in> ?X \\<Longrightarrow> ?f x \\<in> ?Y;\n   \\<And>y.\n      y \\<in> ?Y \\<Longrightarrow> \\<exists>x\\<in>?X. y = ?f x\\<rbrakk>\n  \\<Longrightarrow> bij_betw ?f ?X ?Y\n\ngoal (1 subgoal):\n 1. bij_exists {} (\\<Union> ({} \\<union> wrap {}))", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              \\<lbrakk>x \\<in> ?X; y \\<in> ?X\\<rbrakk>\n              \\<Longrightarrow> (?f x = ?f y) = (x = y);\n   \\<And>x. x \\<in> ?X \\<Longrightarrow> ?f x \\<in> ?Y;\n   \\<And>y.\n      y \\<in> ?Y \\<Longrightarrow> \\<exists>x\\<in>?X. y = ?f x\\<rbrakk>\n  \\<Longrightarrow> bij_betw ?f ?X ?Y\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       bij_betw f {} (\\<Union> ({} \\<union> wrap {})) \\<and>\n       (\\<forall>B\\<in>{}. real c < W B + w (f B))", "by fastforce"], ["proof (state)\nthis:\n  bij_exists {} (\\<Union> ({} \\<union> wrap {}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n     {u \\<in> U. real c / 2 < w u}", "from inv\\<^sub>2I[OF * _ this]"], ["proof (chain)\npicking this:\n  \\<lbrakk>{u \\<in> U. real c / 2 < w u} \\<noteq> {} \\<Longrightarrow>\n           \\<forall>B\\<in>{} \\<union> wrap {}.\n              B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {};\n   2 * card {} \\<le> card (\\<Union> {});\n   {u \\<in> U. w u \\<le> real c / 2}\n   \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   {u \\<in> U. real c / 2 < w u}\n   \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 {} {} {} {}\n                     {u \\<in> U. w u \\<le> real c / 2}\n                     {u \\<in> U. real c / 2 < w u}", "have \"inv\\<^sub>2 {} {} {} {} S\\<^sub>U L\\<^sub>U\""], ["proof (prove)\nusing this:\n  \\<lbrakk>{u \\<in> U. real c / 2 < w u} \\<noteq> {} \\<Longrightarrow>\n           \\<forall>B\\<in>{} \\<union> wrap {}.\n              B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {};\n   2 * card {} \\<le> card (\\<Union> {});\n   {u \\<in> U. w u \\<le> real c / 2}\n   \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   {u \\<in> U. real c / 2 < w u}\n   \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 {} {} {} {}\n                     {u \\<in> U. w u \\<le> real c / 2}\n                     {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n     {u \\<in> U. real c / 2 < w u}", "by auto"], ["proof (state)\nthis:\n  inv\\<^sub>2 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n   {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n     {u \\<in> U. real c / 2 < w u}", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  {} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n   {u \\<in> U. real c / 2 < w u}", "show ?thesis"], ["proof (prove)\nusing this:\n  {} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n   {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n     {u \\<in> U. real c / 2 < w u}", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n   {u \\<in> U. real c / 2 < w u}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma loop_stepA:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 = {}\" \"L = {}\" \"u \\<in> S\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "have WEIGHT: \"W B\\<^sub>1 + w u \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "using invrules(5) assms(2,4)"], ["proof (prove)\nusing this:\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n  B\\<^sub>1 = {}\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "by fastforce"], ["proof (state)\nthis:\n  W B\\<^sub>1 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "from assms(4)"], ["proof (chain)\npicking this:\n  u \\<in> S", "have \"u \\<in> S \\<union> L\""], ["proof (prove)\nusing this:\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. u \\<in> S \\<union> L", "by blast"], ["proof (state)\nthis:\n  u \\<in> S \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "from inv\\<^sub>1_stepA[OF invrules(1) this WEIGHT] assms(2,3)"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S \\<union> L - {u})\n  B\\<^sub>1 = {}\n  L = {}", "have 1: \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u} \\<union> L)\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S \\<union> L - {u})\n  B\\<^sub>1 = {}\n  L = {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u} \\<union> L)", "by simp"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u} \\<union> L)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "have 2: \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "using assms(3)"], ["proof (prove)\nusing this:\n  L = {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "from inv\\<^sub>2I[OF 1 2] invrules"], ["proof (chain)\npicking this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u})\n                     L\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}", "have \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L\""], ["proof (prove)\nusing this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u})\n                     L\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "using inv\\<^sub>3E(2)[OF assms(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L", "."], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S - {u}) L\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma loop_stepB:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 = {}\" \"u \\<in> L\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "have WEIGHT: \"W B\\<^sub>1 + w u \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "using weight invrules(5) assms(2,3)"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n  B\\<^sub>1 = {}\n  u \\<in> L\n\ngoal (1 subgoal):\n 1. W B\\<^sub>1 + w u \\<le> real c", "by fastforce\n\n  \\<comment> \\<open>This observation follows from the fact that the \\<open>S\\<close> and \\<open>L\\<close> sets have to be disjoint from each other,\n      and allows us to reuse our proofs of the preservation of \\<open>inv\\<^sub>1\\<close> by simply replacing \\<open>V\\<close> with \\<open>S \\<union> L\\<close>\\<close>"], ["proof (state)\nthis:\n  W B\\<^sub>1 + w u \\<le> real c\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "have *: \"S \\<union> L - {u} = S \\<union> (L - {u})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<union> L - {u} = S \\<union> (L - {u})", "using invrules(5) assms(3)"], ["proof (prove)\nusing this:\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n  u \\<in> L\n\ngoal (1 subgoal):\n 1. S \\<union> L - {u} = S \\<union> (L - {u})", "by force"], ["proof (state)\nthis:\n  S \\<union> L - {u} = S \\<union> (L - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "from assms(3)"], ["proof (chain)\npicking this:\n  u \\<in> L", "have \"u \\<in> S \\<union> L\""], ["proof (prove)\nusing this:\n  u \\<in> L\n\ngoal (1 subgoal):\n 1. u \\<in> S \\<union> L", "by blast"], ["proof (state)\nthis:\n  u \\<in> S \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "from inv\\<^sub>1_stepA[OF invrules(1) this WEIGHT] assms(2) *"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S \\<union> L - {u})\n  B\\<^sub>1 = {}\n  S \\<union> L - {u} = S \\<union> (L - {u})", "have 1: \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S \\<union> (L - {u}))\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S \\<union> L - {u})\n  B\\<^sub>1 = {}\n  S \\<union> L - {u} = S \\<union> (L - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S \\<union> (L - {u}))", "by simp"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 (S \\<union> (L - {u}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "have \"\\<forall>B\\<in>P\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {}\" \"{u} \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {} &&&\n    {u} \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "using assms(3) invrules(2,5)"], ["proof (prove)\nusing this:\n  u \\<in> L\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {} &&&\n    {u} \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by blast+"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  {u} \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "then"], ["proof (chain)\npicking this:\n  \\<forall>B\\<in>P\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  {u} \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "have 2: \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}. B \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  {u} \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "using assms(3)"], ["proof (prove)\nusing this:\n  \\<forall>B\\<in>P\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  {u} \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  u \\<in> L\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by (metis (full_types) Un_iff empty_iff insert_iff wrap_not_empty)"], ["proof (state)\nthis:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap {u}.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "from inv\\<^sub>2I[OF 1 2] invrules"], ["proof (chain)\npicking this:\n  \\<lbrakk>L - {u} \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L - {u} \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S\n                     (L - {u})\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}", "have \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})\""], ["proof (prove)\nusing this:\n  \\<lbrakk>L - {u} \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L - {u} \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S\n                     (L - {u})\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "using inv\\<^sub>3E(2)[OF assms(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})", "."], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {u} B\\<^sub>2 S (L - {u})\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma loop_stepC:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> S\" \"W B\\<^sub>1 + w(u) \\<le> c\"\n  shows \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (S - {u}) L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]\n\n  \\<comment> \\<open>Same approach, but removing \\<open>{u}\\<close> from \\<open>S\\<close> instead of \\<open>L\\<close>\\<close>"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "have *: \"S \\<union> L - {u} = (S - {u}) \\<union> L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<union> L - {u} = S - {u} \\<union> L", "using invrules(5) assms(3)"], ["proof (prove)\nusing this:\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. S \\<union> L - {u} = S - {u} \\<union> L", "by force"], ["proof (state)\nthis:\n  S \\<union> L - {u} = S - {u} \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "from assms(3)"], ["proof (chain)\npicking this:\n  u \\<in> S", "have \"u \\<in> S \\<union> L\""], ["proof (prove)\nusing this:\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. u \\<in> S \\<union> L", "by blast"], ["proof (state)\nthis:\n  u \\<in> S \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "from inv\\<^sub>1_stepA[OF invrules(1) this assms(4)] *"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S \\<union> L - {u})\n  S \\<union> L - {u} = S - {u} \\<union> L", "have 1: \"inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (S - {u} \\<union> L)\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S \\<union> L - {u})\n  S \\<union> L - {u} = S - {u} \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u} \\<union> L)", "by simp"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S - {u} \\<union> L)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "have \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. B \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "using invrules(2)"], ["proof (prove)\nusing this:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "then"], ["proof (chain)\npicking this:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "have 2: \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}). B \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\nusing this:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}).\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by (smt Int_insert_left Un_empty_right Un_iff Un_insert_right assms(2) insert_not_empty singletonD singletonI wrap_def)"], ["proof (state)\nthis:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap (B\\<^sub>1 \\<union> {u}).\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "from inv\\<^sub>2I[OF 1 2] invrules"], ["proof (chain)\npicking this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u})\n                     B\\<^sub>2 (S - {u}) L\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}", "have \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2 (S - {u}) L\""], ["proof (prove)\nusing this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u})\n                     B\\<^sub>2 (S - {u}) L\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S - {u}) L", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "using inv\\<^sub>3E(2)[OF assms(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S - {u}) L\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n     (S - {u}) L", "."], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {u}) B\\<^sub>2\n   (S - {u}) L\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma loop_stepD:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> S\" \"W B\\<^sub>1 + w(u) > c\" \"W B\\<^sub>2 + w(u) \\<le> c\"\n  shows \"inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (S - {u}) L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have *: \"S \\<union> L - {u} = (S - {u}) \\<union> L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<union> L - {u} = S - {u} \\<union> L", "using invrules(5) assms(3)"], ["proof (prove)\nusing this:\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. S \\<union> L - {u} = S - {u} \\<union> L", "by force"], ["proof (state)\nthis:\n  S \\<union> L - {u} = S - {u} \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "from assms(3)"], ["proof (chain)\npicking this:\n  u \\<in> S", "have \"u \\<in> S \\<union> L\""], ["proof (prove)\nusing this:\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. u \\<in> S \\<union> L", "by blast"], ["proof (state)\nthis:\n  u \\<in> S \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "from inv\\<^sub>1_stepB[OF invrules(1) this assms(5)] *"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (S \\<union> L - {u})\n  S \\<union> L - {u} = S - {u} \\<union> L", "have 1: \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (S - {u} \\<union> L)\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (S \\<union> L - {u})\n  S \\<union> L - {u} = S - {u} \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u} \\<union> L)", "by simp"], ["proof (state)\nthis:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (S - {u} \\<union> L)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have 2: \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}. B \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "using invrules(2)"], ["proof (prove)\nusing this:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "unfolding wrap_empty"], ["proof (prove)\nusing this:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "from invrules(3)"], ["proof (chain)\npicking this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "obtain f where f_def: \"bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\" \"\\<forall>B\\<in>P\\<^sub>1. c < W B + w (f B)\""], ["proof (prove)\nusing this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     bij_betw f P\\<^sub>1\n      (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n     (\\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have \"B\\<^sub>1 \\<notin> P\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<notin> P\\<^sub>1", "using inv\\<^sub>1E(3)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<notin> P\\<^sub>1", "by blast"], ["proof (state)\nthis:\n  B\\<^sub>1 \\<notin> P\\<^sub>1\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have \"u \\<notin> (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using inv\\<^sub>1E(2)[OF invrules(1)] assms(3)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - (S \\<union> L)\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by blast"], ["proof (state)\nthis:\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "then"], ["proof (chain)\npicking this:\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "have \"(\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}))\""], ["proof (prove)\nusing this:\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})", "by (metis Sup_empty Un_assoc Union_Un_distrib ccpo_Sup_singleton wrap_empty wrap_not_empty)"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "also"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have \"... = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "by simp"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "finally"], ["proof (chain)\npicking this:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "have UN: \"(\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\nusing this:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "."], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have \"wrap B\\<^sub>1 = {B\\<^sub>1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wrap B\\<^sub>1 = {B\\<^sub>1}", "using wrap_not_empty[of B\\<^sub>1] assms(2)"], ["proof (prove)\nusing this:\n  (B\\<^sub>1 \\<noteq> {}) = (wrap B\\<^sub>1 = {B\\<^sub>1})\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. wrap B\\<^sub>1 = {B\\<^sub>1}", "by simp"], ["proof (state)\nthis:\n  wrap B\\<^sub>1 = {B\\<^sub>1}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "let ?f = \"f (B\\<^sub>1 := u)\""], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have BIJ: \"bij_betw ?f (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))", "unfolding wrap_empty \\<open>wrap B\\<^sub>1 = {B\\<^sub>1}\\<close> UN"], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> {B\\<^sub>1})\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u})", "using f_def(1) \\<open>B\\<^sub>1 \\<notin> P\\<^sub>1\\<close> \\<open>u \\<notin> (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\\<close>"], ["proof (prove)\nusing this:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  B\\<^sub>1 \\<notin> P\\<^sub>1\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> {B\\<^sub>1})\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u})", "by (metis (no_types, lifting) bij_betw_cong fun_upd_other fun_upd_same notIn_Un_bij_betw3)"], ["proof (state)\nthis:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have \"c < W B\\<^sub>1 + w (?f B\\<^sub>1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "using assms(4)"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w u\n\ngoal (1 subgoal):\n 1. real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "by simp"], ["proof (state)\nthis:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "then"], ["proof (chain)\npicking this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "have \"(\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. c < W B + w (?f B))\""], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "unfolding \\<open>wrap B\\<^sub>1 = {B\\<^sub>1}\\<close>"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> {B\\<^sub>1}.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "using f_def(2)"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> {B\\<^sub>1}.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "by simp"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "with BIJ"], ["proof (chain)\npicking this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)", "have \"bij_betw ?f (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n              \\<and> (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. c < W B + w (?f B))\""], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)\n\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n    (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n        real c < W B + w ((f(B\\<^sub>1 := u)) B))", "by blast"], ["proof (state)\nthis:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "then"], ["proof (chain)\npicking this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))", "have 3: \"bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\""], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       bij_betw f (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n        (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u}))) \\<and>\n       (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n           real c < W B + w (f B))", "by blast"], ["proof (state)\nthis:\n  bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap (B\\<^sub>2 \\<union> {u})))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "from inv\\<^sub>2I[OF 1 2 3]"], ["proof (chain)\npicking this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "have \"inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (S - {u}) L\""], ["proof (prove)\nusing this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "using invrules(4,5)"], ["proof (prove)\nusing this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2);\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     P\\<^sub>2 {} (B\\<^sub>2 \\<union> {u}) (S - {u}) L\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<union> {u}\n  \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<union> {u}\n  \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "using inv\\<^sub>3E(2)[OF assms(1)] assms(3) invrules(5)"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<union> {u}\n  \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (S - {u}) L\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n  u \\<in> S\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n     (B\\<^sub>2 \\<union> {u}) (S - {u}) L", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n   (B\\<^sub>2 \\<union> {u}) (S - {u}) L\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma B\\<^sub>2_at_least_two_objects:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"u \\<in> S\" \"W B\\<^sub>2 + w(u) > c\"\n  shows \"2 \\<le> card B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<le> card B\\<^sub>2", "proof (rule ccontr, simp add: not_le)"], ["proof (state)\ngoal (1 subgoal):\n 1. card B\\<^sub>2 < 2 \\<Longrightarrow> False", "have FINITE: \"finite B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "using inv\\<^sub>1E(1)[OF inv\\<^sub>2E(1)[OF inv\\<^sub>3E(1)[OF assms(1)]]]"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "by (metis (no_types, lifting) Finite_Set.finite.simps U_Finite Union_Un_distrib bpE(3) ccpo_Sup_singleton finite_Un wrap_not_empty)"], ["proof (state)\nthis:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 < 2 \\<Longrightarrow> False", "assume \"card B\\<^sub>2 < 2\""], ["proof (state)\nthis:\n  card B\\<^sub>2 < 2\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 < 2 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  card B\\<^sub>2 < 2", "consider (0) \"card B\\<^sub>2 = 0\" | (1) \"card B\\<^sub>2 = 1\""], ["proof (prove)\nusing this:\n  card B\\<^sub>2 < 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>card B\\<^sub>2 = 0 \\<Longrightarrow> thesis;\n     card B\\<^sub>2 = 1 \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by linarith"], ["proof (state)\nthis:\n  \\<lbrakk>card B\\<^sub>2 = 0 \\<Longrightarrow> ?thesis;\n   card B\\<^sub>2 = 1 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 < 2 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>card B\\<^sub>2 = 0 \\<Longrightarrow> ?thesis;\n   card B\\<^sub>2 = 1 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis", "show False"], ["proof (prove)\nusing this:\n  \\<lbrakk>card B\\<^sub>2 = 0 \\<Longrightarrow> ?thesis;\n   card B\\<^sub>2 = 1 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. False", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. card B\\<^sub>2 = 0 \\<Longrightarrow> False\n 2. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "case 0"], ["proof (state)\nthis:\n  card B\\<^sub>2 = 0\n\ngoal (2 subgoals):\n 1. card B\\<^sub>2 = 0 \\<Longrightarrow> False\n 2. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  card B\\<^sub>2 = 0", "have \"B\\<^sub>2 = {}\""], ["proof (prove)\nusing this:\n  card B\\<^sub>2 = 0\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 = {}", "using FINITE"], ["proof (prove)\nusing this:\n  card B\\<^sub>2 = 0\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 = {}", "by simp"], ["proof (state)\nthis:\n  B\\<^sub>2 = {}\n\ngoal (2 subgoals):\n 1. card B\\<^sub>2 = 0 \\<Longrightarrow> False\n 2. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  B\\<^sub>2 = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. False", "using assms(2,3) inv\\<^sub>2E(5)[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 = {}\n  u \\<in> S\n  real c < W B\\<^sub>2 + w u\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. False", "by force"], ["proof (state)\nthis:\n  False\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "case 1"], ["proof (state)\nthis:\n  card B\\<^sub>2 = 1\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  card B\\<^sub>2 = 1", "obtain v where \"B\\<^sub>2 = {v}\""], ["proof (prove)\nusing this:\n  card B\\<^sub>2 = 1\n\ngoal (1 subgoal):\n 1. (\\<And>v. B\\<^sub>2 = {v} \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using card_1_singletonE"], ["proof (prove)\nusing this:\n  card B\\<^sub>2 = 1\n  \\<lbrakk>card ?A = 1; \\<And>x. ?A = {x} \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>v. B\\<^sub>2 = {v} \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  B\\<^sub>2 = {v}\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "with inv\\<^sub>3E(2)[OF assms(1)]"], ["proof (chain)\npicking this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n  B\\<^sub>2 = {v}", "have \"2 * w v \\<le> c\""], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n  B\\<^sub>2 = {v}\n\ngoal (1 subgoal):\n 1. 2 * w v \\<le> real c", "using inv\\<^sub>2E(5)[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<subseteq> {u \\<in> U. w u \\<le> real c / 2}\n  B\\<^sub>2 = {v}\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. 2 * w v \\<le> real c", "by simp"], ["proof (state)\nthis:\n  2 * w v \\<le> real c\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  2 * w v \\<le> real c\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "from \\<open>B\\<^sub>2 = {v}\\<close>"], ["proof (chain)\npicking this:\n  B\\<^sub>2 = {v}", "have \"W B\\<^sub>2 = w v\""], ["proof (prove)\nusing this:\n  B\\<^sub>2 = {v}\n\ngoal (1 subgoal):\n 1. W B\\<^sub>2 = w v", "by simp"], ["proof (state)\nthis:\n  W B\\<^sub>2 = w v\n\ngoal (1 subgoal):\n 1. card B\\<^sub>2 = 1 \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  2 * w v \\<le> real c\n  W B\\<^sub>2 = w v", "show ?thesis"], ["proof (prove)\nusing this:\n  2 * w v \\<le> real c\n  W B\\<^sub>2 = w v\n\ngoal (1 subgoal):\n 1. False", "using assms(2,3) inv\\<^sub>2E(5)[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (prove)\nusing this:\n  2 * w v \\<le> real c\n  W B\\<^sub>2 = w v\n  u \\<in> S\n  real c < W B\\<^sub>2 + w u\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. False", "by force"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma loop_stepE:\n  assumes \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\" \"B\\<^sub>1 \\<noteq> {}\" \"u \\<in> S\" \"W B\\<^sub>1 + w(u) > c\" \"W B\\<^sub>2 + w(u) > c\"\n  shows \"inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "note invrules = inv\\<^sub>2E[OF inv\\<^sub>3E(1)[OF assms(1)]]"], ["proof (state)\nthis:\n  inv\\<^sub>1 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 (S \\<union> L)\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have *: \"S \\<union> L - {u} = (S - {u}) \\<union> L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<union> L - {u} = S - {u} \\<union> L", "using invrules(5) assms(3)"], ["proof (prove)\nusing this:\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. S \\<union> L - {u} = S - {u} \\<union> L", "by force"], ["proof (state)\nthis:\n  S \\<union> L - {u} = S - {u} \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "from assms(3)"], ["proof (chain)\npicking this:\n  u \\<in> S", "have \"u \\<in> S \\<union> L\""], ["proof (prove)\nusing this:\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. u \\<in> S \\<union> L", "by blast"], ["proof (state)\nthis:\n  u \\<in> S \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "from inv\\<^sub>1_stepC[OF invrules(1) this] *"], ["proof (chain)\npicking this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S \\<union> L - {u})\n  S \\<union> L - {u} = S - {u} \\<union> L", "have 1: \"inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u} \\<union> L)\""], ["proof (prove)\nusing this:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S \\<union> L - {u})\n  S \\<union> L - {u} = S - {u} \\<union> L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u} \\<union> L)", "by simp"], ["proof (state)\nthis:\n  inv\\<^sub>1 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u} \\<union> L)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have 2: \"L \\<noteq> {} \\<Longrightarrow> \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}. B \\<inter> L\\<^sub>U \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "using invrules(2)"], ["proof (prove)\nusing this:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "unfolding wrap_empty"], ["proof (prove)\nusing this:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow>\n    \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> {}.\n       B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  L \\<noteq> {} \\<Longrightarrow>\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> wrap {}.\n     B \\<inter> {u \\<in> U. real c / 2 < w u} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "from invrules(3)"], ["proof (chain)\npicking this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "obtain f where f_def: \"bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\" \"\\<forall>B\\<in>P\\<^sub>1. c < W B + w (f B)\""], ["proof (prove)\nusing this:\n  bij_exists P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     bij_betw f P\\<^sub>1\n      (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<and>\n     (\\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B))\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>bij_betw f P\\<^sub>1\n                  (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2));\n         \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have \"B\\<^sub>1 \\<notin> P\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<notin> P\\<^sub>1", "using inv\\<^sub>1E(3)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>1 \\<notin> P\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>1 \\<notin> P\\<^sub>1", "by blast"], ["proof (state)\nthis:\n  B\\<^sub>1 \\<notin> P\\<^sub>1\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have \"u \\<notin> (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using inv\\<^sub>1E(2)[OF invrules(1)] assms(3)"], ["proof (prove)\nusing this:\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2) =\n  U - (S \\<union> L)\n  u \\<in> S\n\ngoal (1 subgoal):\n 1. u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by blast"], ["proof (state)\nthis:\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have \"(\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})", "unfolding wrap_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     (P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n      (if {u} = {} then {} else {{u}})) =\n    \\<Union>\n     (P\\<^sub>2 \\<union>\n      (if B\\<^sub>2 = {} then {} else {B\\<^sub>2}) \\<union>\n      {{u}})", "by simp"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "also"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}})\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have \"... = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "by simp"], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{u}}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "finally"], ["proof (chain)\npicking this:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "have UN: \"(\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) = (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)) \\<union> {u}\""], ["proof (prove)\nusing this:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n    \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}", "."], ["proof (state)\nthis:\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}) =\n  \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have \"wrap B\\<^sub>1 = {B\\<^sub>1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wrap B\\<^sub>1 = {B\\<^sub>1}", "using wrap_not_empty[of B\\<^sub>1] assms(2)"], ["proof (prove)\nusing this:\n  (B\\<^sub>1 \\<noteq> {}) = (wrap B\\<^sub>1 = {B\\<^sub>1})\n  B\\<^sub>1 \\<noteq> {}\n\ngoal (1 subgoal):\n 1. wrap B\\<^sub>1 = {B\\<^sub>1}", "by simp"], ["proof (state)\nthis:\n  wrap B\\<^sub>1 = {B\\<^sub>1}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "let ?f = \"f (B\\<^sub>1 := u)\""], ["proof (state)\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have BIJ: \"bij_betw ?f (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))", "unfolding wrap_empty \\<open>wrap B\\<^sub>1 = {B\\<^sub>1}\\<close> UN"], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> {B\\<^sub>1})\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u})", "using f_def(1) \\<open>B\\<^sub>1 \\<notin> P\\<^sub>1\\<close> \\<open>u \\<notin> (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\\<close>"], ["proof (prove)\nusing this:\n  bij_betw f P\\<^sub>1 (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n  B\\<^sub>1 \\<notin> P\\<^sub>1\n  u \\<notin> \\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> {B\\<^sub>1})\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<union> {u})", "by (metis (no_types, lifting) bij_betw_cong fun_upd_other fun_upd_same notIn_Un_bij_betw3)"], ["proof (state)\nthis:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have \"c < W B\\<^sub>1 + w (?f B\\<^sub>1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "using assms(4)"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w u\n\ngoal (1 subgoal):\n 1. real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "by simp"], ["proof (state)\nthis:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "then"], ["proof (chain)\npicking this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)", "have \"(\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. c < W B + w (?f B))\""], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "unfolding \\<open>wrap B\\<^sub>1 = {B\\<^sub>1}\\<close>"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> {B\\<^sub>1}.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "using f_def(2)"], ["proof (prove)\nusing this:\n  real c < W B\\<^sub>1 + w ((f(B\\<^sub>1 := u)) B\\<^sub>1)\n  \\<forall>B\\<in>P\\<^sub>1. real c < W B + w (f B)\n\ngoal (1 subgoal):\n 1. \\<forall>B\\<in>P\\<^sub>1 \\<union> {B\\<^sub>1}.\n       real c < W B + w ((f(B\\<^sub>1 := u)) B)", "by simp"], ["proof (state)\nthis:\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "with BIJ"], ["proof (chain)\npicking this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)", "have \"bij_betw ?f (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n              \\<and> (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1. c < W B + w (?f B))\""], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n     real c < W B + w ((f(B\\<^sub>1 := u)) B)\n\ngoal (1 subgoal):\n 1. bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n    (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n        real c < W B + w ((f(B\\<^sub>1 := u)) B))", "by blast"], ["proof (state)\nthis:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "then"], ["proof (chain)\npicking this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))", "have 3: \"bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\""], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))", "unfolding bij_exists_def"], ["proof (prove)\nusing this:\n  bij_betw (f(B\\<^sub>1 := u)) (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n  (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n      real c < W B + w ((f(B\\<^sub>1 := u)) B))\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       bij_betw f (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n        (\\<Union>\n          (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u})) \\<and>\n       (\\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1.\n           real c < W B + w (f B))", "by blast"], ["proof (state)\nthis:\n  bij_exists (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> wrap {u}))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have 4: \"2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "note bprules = bpE[OF inv\\<^sub>1E(1)[OF invrules(1)]]"], ["proof (state)\nthis:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L})\n  {} \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n              wrap B\\<^sub>2 \\<union>\n              {{v} |v. v \\<in> S \\<union> L}\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  U\n  \\<forall>B\\<in>P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                 P\\<^sub>2 \\<union>\n                 wrap B\\<^sub>2 \\<union>\n                 {{v} |v. v \\<in> S \\<union> L}.\n     W B \\<le> real c\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"pairwise disjnt (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "using bprules(1) pairwise_subset"], ["proof (prove)\nusing this:\n  disjoint\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L})\n  \\<lbrakk>pairwise ?P ?S; ?T \\<subseteq> ?S\\<rbrakk>\n  \\<Longrightarrow> pairwise ?P ?T\n\ngoal (1 subgoal):\n 1. disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)", "by blast"], ["proof (state)\nthis:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "moreover"], ["proof (state)\nthis:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"B\\<^sub>2 \\<notin> P\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<notin> P\\<^sub>2", "using inv\\<^sub>1E(4)[OF invrules(1)]"], ["proof (prove)\nusing this:\n  B\\<^sub>2 \\<notin> P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. B\\<^sub>2 \\<notin> P\\<^sub>2", "by simp"], ["proof (state)\nthis:\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "ultimately"], ["proof (chain)\npicking this:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  B\\<^sub>2 \\<notin> P\\<^sub>2", "have DISJNT: \"\\<Union>P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\""], ["proof (prove)\nusing this:\n  disjoint (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  B\\<^sub>2 \\<notin> P\\<^sub>2\n\ngoal (1 subgoal):\n 1. \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}", "by (auto, metis (no_types, hide_lams) sup_bot.right_neutral Un_insert_right disjnt_iff mk_disjoint_insert pairwise_insert wrap_Un)"], ["proof (state)\nthis:\n  \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"finite (\\<Union>P\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (\\<Union> P\\<^sub>2)", "using U_Finite bprules(3)"], ["proof (prove)\nusing this:\n  finite U\n  \\<Union>\n   (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> S \\<union> L}) =\n  U\n\ngoal (1 subgoal):\n 1. finite (\\<Union> P\\<^sub>2)", "by auto"], ["proof (state)\nthis:\n  finite (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"finite B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "using inv\\<^sub>1E(1)[OF invrules(1)] bp_bins_finite wrap_not_empty"], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n  bp ?P \\<Longrightarrow> \\<forall>B\\<in>?P. finite B\n  (?M \\<noteq> {}) = (wrap ?M = {?M})\n\ngoal (1 subgoal):\n 1. finite B\\<^sub>2", "by blast"], ["proof (state)\nthis:\n  finite B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2) \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))", "using card_Un_le[of P\\<^sub>2 \\<open>wrap B\\<^sub>2\\<close>]"], ["proof (prove)\nusing this:\n  card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card P\\<^sub>2 + card (wrap B\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))", "by simp"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... \\<le> 2 * card P\\<^sub>2 + 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n    \\<le> 2 * card P\\<^sub>2 + 2", "using wrap_card"], ["proof (prove)\nusing this:\n  card (wrap ?B) \\<le> 1\n\ngoal (1 subgoal):\n 1. 2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2))\n    \\<le> 2 * card P\\<^sub>2 + 2", "by auto"], ["proof (state)\nthis:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2)) \\<le> 2 * card P\\<^sub>2 + 2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  2 * (card P\\<^sub>2 + card (wrap B\\<^sub>2)) \\<le> 2 * card P\\<^sub>2 + 2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... \\<le> card (\\<Union> P\\<^sub>2) + 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * card P\\<^sub>2 + 2 \\<le> card (\\<Union> P\\<^sub>2) + 2", "using invrules(4)"], ["proof (prove)\nusing this:\n  2 * card P\\<^sub>2 \\<le> card (\\<Union> P\\<^sub>2)\n\ngoal (1 subgoal):\n 1. 2 * card P\\<^sub>2 + 2 \\<le> card (\\<Union> P\\<^sub>2) + 2", "by simp"], ["proof (state)\nthis:\n  2 * card P\\<^sub>2 + 2 \\<le> card (\\<Union> P\\<^sub>2) + 2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  2 * card P\\<^sub>2 + 2 \\<le> card (\\<Union> P\\<^sub>2) + 2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (\\<Union> P\\<^sub>2) + 2\n    \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2", "using B\\<^sub>2_at_least_two_objects[OF assms(1,3,5)]"], ["proof (prove)\nusing this:\n  2 \\<le> card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. card (\\<Union> P\\<^sub>2) + 2\n    \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2", "by simp"], ["proof (state)\nthis:\n  card (\\<Union> P\\<^sub>2) + 2\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  card (\\<Union> P\\<^sub>2) + 2\n  \\<le> card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... = card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 =\n    card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))", "using DISJNT card_Un_disjoint[OF \\<open>finite (\\<Union>P\\<^sub>2)\\<close> \\<open>finite B\\<^sub>2\\<close>]"], ["proof (prove)\nusing this:\n  \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {}\n  \\<Union> P\\<^sub>2 \\<inter> B\\<^sub>2 = {} \\<Longrightarrow>\n  card (\\<Union> P\\<^sub>2 \\<union> B\\<^sub>2) =\n  card (\\<Union> P\\<^sub>2) + card B\\<^sub>2\n\ngoal (1 subgoal):\n 1. card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 =\n    card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))", "by (simp add: Un_commute)"], ["proof (state)\nthis:\n  card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 =\n  card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "also"], ["proof (state)\nthis:\n  card (\\<Union> P\\<^sub>2) + card B\\<^sub>2 =\n  card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2}))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "have \"... = card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2})) =\n    card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "by (cases \\<open>B\\<^sub>2 = {}\\<close>) auto"], ["proof (state)\nthis:\n  card (\\<Union> (P\\<^sub>2 \\<union> {B\\<^sub>2})) =\n  card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "finally"], ["proof (chain)\npicking this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "show ?thesis"], ["proof (prove)\nusing this:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. 2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n    \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))", "."], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  2 * card (P\\<^sub>2 \\<union> wrap B\\<^sub>2)\n  \\<le> card (\\<Union> (P\\<^sub>2 \\<union> wrap B\\<^sub>2))\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "from inv\\<^sub>2I[OF 1 2 3 4]"], ["proof (chain)\npicking this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "have \"inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\""], ["proof (prove)\nusing this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "using invrules(5)"], ["proof (prove)\nusing this:\n  \\<lbrakk>L \\<noteq> {} \\<Longrightarrow> L \\<noteq> {};\n   S - {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n   L \\<subseteq> {u \\<in> U. real c / 2 < w u}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "from inv\\<^sub>3I[OF this]"], ["proof (chain)\npicking this:\n  {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "show ?thesis"], ["proof (prove)\nusing this:\n  {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "using assms(3) invrules(5)"], ["proof (prove)\nusing this:\n  {u} \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<Longrightarrow>\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\n  u \\<in> S\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n   (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {u} (S - {u}) L\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The bin packing algorithm as it is proposed on page 78 of the article @{cite BerghammerR03}.\n      \\<open>P\\<close> will not only be a correct solution of the bin packing problem, but the amount of bins\n      will be a lower bound for \\<open>3 / 2\\<close> of the amount of bins of any correct solution \\<open>Q\\<close>, and thus\n      guarantee an approximation factor of \\<open>3 / 2\\<close> for the optimum.\\<close>"], ["", "lemma bp_approx:\n\"VARS P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u\n  {True}\n  S := {}; L:= {}; V := U;\n  WHILE V \\<noteq> {} INV {V \\<subseteq> U \\<and> S = {u \\<in> U - V. w(u) \\<le> c / 2} \\<and> L = {u \\<in> U - V. c / 2 < w(u)}} DO\n    u := (SOME u. u \\<in> V);\n    IF w(u) \\<le> c / 2\n    THEN S := S \\<union> {u}\n    ELSE L := L \\<union> {u} FI;\n    V := V - {u}\n  OD;\n  P\\<^sub>1 := {}; P\\<^sub>2 := {}; B\\<^sub>1 := {}; B\\<^sub>2 := {};\n  WHILE S \\<noteq> {} INV {inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L} DO \n    IF B\\<^sub>1 \\<noteq> {}\n    THEN u := (SOME u. u \\<in> S); S := S - {u}\n    ELSE IF L \\<noteq> {}\n         THEN u := (SOME u. u \\<in> L); L := L - {u}\n         ELSE u := (SOME u. u \\<in> S); S := S - {u} FI FI;\n    IF W(B\\<^sub>1) + w(u) \\<le> c\n    THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u}\n    ELSE IF W(B\\<^sub>2) + w(u) \\<le> c\n         THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u}\n         ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2; B\\<^sub>2 := {u} FI;\n         P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1; B\\<^sub>1 := {} FI\n  OD;\n  P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2; V := L;\n  WHILE V \\<noteq> {}\n  INV {S = {} \\<and> inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and> V \\<subseteq> L \\<and> P = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v}|v. v \\<in> L - V}} DO\n    u := (SOME u. u \\<in> V); P := P \\<union> {{u}}; V := V - {u}\n  OD\n  {bp P \\<and> (\\<forall>Q. bp Q \\<longrightarrow> card P \\<le> 3 / 2 * card Q)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {True} \n     S := {};\n     L := {};\n     V := U;\n     WHILE V \\<noteq> {}\n      INV {V \\<subseteq> U \\<and>\n           S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n           L = {u \\<in> U - V. real c / 2 < w u}} \n      VAR {\\<lambda>(P, P\\<^sub>1, P\\<^sub>2, B\\<^sub>1, B\\<^sub>2, V, S, L,\n              u). 0} \n      DO u := (SOME u. u \\<in> V);\n         IF w u \\<le> real c / 2 THEN S := S \\<union> {u} \n          ELSE L := L \\<union> {u} FI;\n         V := V - {u} \n      OD;\n     P\\<^sub>1 := {};\n     P\\<^sub>2 := {};\n     B\\<^sub>1 := {};\n     B\\<^sub>2 := {};\n     WHILE S \\<noteq> {}\n      INV {inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L} \n      VAR {\\<lambda>(P, P\\<^sub>1, P\\<^sub>2, B\\<^sub>1, B\\<^sub>2, V, S, L,\n              u). 0} \n      DO IF B\\<^sub>1 \\<noteq> {}\n          THEN u := (SOME u. u \\<in> S); S := S - {u} \n          ELSE IF L \\<noteq> {} THEN u := (SOME u. u \\<in> L); L := L - {u} \n                ELSE u := (SOME u. u \\<in> S); S := S - {u} FI\n          FI;\n         IF W B\\<^sub>1 + w u \\<le> real c\n          THEN B\\<^sub>1 := B\\<^sub>1 \\<union> {u} \n          ELSE IF W B\\<^sub>2 + w u \\<le> real c\n                THEN B\\<^sub>2 := B\\<^sub>2 \\<union> {u} \n                ELSE P\\<^sub>2 := P\\<^sub>2 \\<union> wrap B\\<^sub>2;\n                     B\\<^sub>2 := {u}\n                FI;\n               P\\<^sub>1 := P\\<^sub>1 \\<union> wrap B\\<^sub>1;\n               B\\<^sub>1 := {}\n          FI \n      OD;\n     P := P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n          wrap B\\<^sub>2;\n     V := L;\n     WHILE V \\<noteq> {}\n      INV {S = {} \\<and>\n           inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n           V \\<subseteq> L \\<and>\n           P =\n           P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n           wrap B\\<^sub>2 \\<union>\n           {{v} |v. v \\<in> L - V}} \n      VAR {\\<lambda>(P, P\\<^sub>1, P\\<^sub>2, B\\<^sub>1, B\\<^sub>2, V, S, L,\n              u). 0} \n      DO u := (SOME u. u \\<in> V); P := P \\<union> {{u}}; V := V - {u} OD \n     {bp P \\<and>\n      (\\<forall>Q.\n          bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))}", "proof (vcg, goal_cases)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       True \\<Longrightarrow>\n       U \\<subseteq> U \\<and>\n       {} = {u \\<in> U - U. w u \\<le> real c / 2} \\<and>\n       {} = {u \\<in> U - U. real c / 2 < w u}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       (w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u}) \\<and>\n       (\\<not> w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u})\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       inv\\<^sub>3 {} {} {} {} S L\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 5. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 6. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 7. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "case (1 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u)"], ["proof (state)\nthis:\n  True\n\ngoal (7 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       True \\<Longrightarrow>\n       U \\<subseteq> U \\<and>\n       {} = {u \\<in> U - U. w u \\<le> real c / 2} \\<and>\n       {} = {u \\<in> U - U. real c / 2 < w u}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       (w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u}) \\<and>\n       (\\<not> w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u})\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       inv\\<^sub>3 {} {} {} {} S L\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 5. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 6. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 7. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  True", "show ?case"], ["proof (prove)\nusing this:\n  True\n\ngoal (1 subgoal):\n 1. U \\<subseteq> U \\<and>\n    {} = {u \\<in> U - U. w u \\<le> real c / 2} \\<and>\n    {} = {u \\<in> U - U. real c / 2 < w u}", "by blast"], ["proof (state)\nthis:\n  U \\<subseteq> U \\<and>\n  {} = {u \\<in> U - U. w u \\<le> real c / 2} \\<and>\n  {} = {u \\<in> U - U. real c / 2 < w u}\n\ngoal (6 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       (w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u}) \\<and>\n       (\\<not> w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u})\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       inv\\<^sub>3 {} {} {} {} S L\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 5. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 6. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       (w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u}) \\<and>\n       (\\<not> w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u})\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       inv\\<^sub>3 {} {} {} {} S L\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 5. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 6. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "case (2 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u)"], ["proof (state)\nthis:\n  (V \\<subseteq> U \\<and>\n   S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n   L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n  V \\<noteq> {}\n\ngoal (6 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       (w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u}) \\<and>\n       (\\<not> w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n        V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n        S =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n        L \\<union> {SOME u. u \\<in> V} =\n        {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u})\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       inv\\<^sub>3 {} {} {} {} S L\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 5. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 6. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  (V \\<subseteq> U \\<and>\n   S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n   L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n  V \\<noteq> {}", "show ?case"], ["proof (prove)\nusing this:\n  (V \\<subseteq> U \\<and>\n   S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n   L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n  V \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n     V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n     S \\<union> {SOME u. u \\<in> V} =\n     {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n     L = {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u}) \\<and>\n    (\\<not> w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n     V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n     S =\n     {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n     L \\<union> {SOME u. u \\<in> V} =\n     {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u})", "by (auto simp: some_in_eq)"], ["proof (state)\nthis:\n  (w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n   V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n   S \\<union> {SOME u. u \\<in> V} =\n   {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n   L = {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u}) \\<and>\n  (\\<not> w (SOME u. u \\<in> V) \\<le> real c / 2 \\<longrightarrow>\n   V - {SOME u. u \\<in> V} \\<subseteq> U \\<and>\n   S = {u \\<in> U - (V - {SOME u. u \\<in> V}). w u \\<le> real c / 2} \\<and>\n   L \\<union> {SOME u. u \\<in> V} =\n   {u \\<in> U - (V - {SOME u. u \\<in> V}). real c / 2 < w u})\n\ngoal (5 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       inv\\<^sub>3 {} {} {} {} S L\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 5. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "next"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       inv\\<^sub>3 {} {} {} {} S L\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 5. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "case (3 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u)"], ["proof (state)\nthis:\n  (V \\<subseteq> U \\<and>\n   S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n   L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n  \\<not> V \\<noteq> {}\n\ngoal (5 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (V \\<subseteq> U \\<and>\n        S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n        L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       inv\\<^sub>3 {} {} {} {} S L\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 5. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  (V \\<subseteq> U \\<and>\n   S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n   L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n  \\<not> V \\<noteq> {}", "show ?case"], ["proof (prove)\nusing this:\n  (V \\<subseteq> U \\<and>\n   S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n   L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n  \\<not> V \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} S L", "using loop_init"], ["proof (prove)\nusing this:\n  (V \\<subseteq> U \\<and>\n   S = {u \\<in> U - V. w u \\<le> real c / 2} \\<and>\n   L = {u \\<in> U - V. real c / 2 < w u}) \\<and>\n  \\<not> V \\<noteq> {}\n  inv\\<^sub>3 {} {} {} {} {u \\<in> U. w u \\<le> real c / 2}\n   {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 {} {} {} {} S L", "by force"], ["proof (state)\nthis:\n  inv\\<^sub>3 {} {} {} {} S L\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "case (4 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u)"], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  S \\<noteq> {}\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  S \\<noteq> {}", "have INV: \"inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\""], ["proof (prove)\nusing this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L", ".."], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "let ?s = \"SOME u. u \\<in> S\""], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "let ?l = \"SOME u. u \\<in> L\""], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "note SL_def = inv\\<^sub>2E(5)[OF inv\\<^sub>3E(1)[OF INV]]"], ["proof (state)\nthis:\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "have LIN: \"L \\<noteq> {} \\<Longrightarrow> ?l \\<in> L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow> (SOME u. u \\<in> L) \\<in> L", "using some_in_eq"], ["proof (prove)\nusing this:\n  ((SOME x. x \\<in> ?A) \\<in> ?A) = (?A \\<noteq> {})\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow> (SOME u. u \\<in> L) \\<in> L", "by metis"], ["proof (state)\nthis:\n  L \\<noteq> {} \\<Longrightarrow> (SOME u. u \\<in> L) \\<in> L\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  L \\<noteq> {} \\<Longrightarrow> (SOME u. u \\<in> L) \\<in> L", "have LWEIGHT: \"L \\<noteq> {} \\<Longrightarrow> w ?l \\<le> c\""], ["proof (prove)\nusing this:\n  L \\<noteq> {} \\<Longrightarrow> (SOME u. u \\<in> L) \\<in> L\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow> w (SOME u. u \\<in> L) \\<le> real c", "using weight SL_def"], ["proof (prove)\nusing this:\n  L \\<noteq> {} \\<Longrightarrow> (SOME u. u \\<in> L) \\<in> L\n  \\<forall>u\\<in>U. 0 < w u \\<and> w u \\<le> real c\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. L \\<noteq> {} \\<Longrightarrow> w (SOME u. u \\<in> L) \\<le> real c", "by blast"], ["proof (state)\nthis:\n  L \\<noteq> {} \\<Longrightarrow> w (SOME u. u \\<in> L) \\<le> real c\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "from 4"], ["proof (chain)\npicking this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  S \\<noteq> {}", "have \"S \\<noteq> {}\""], ["proof (prove)\nusing this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", ".."], ["proof (state)\nthis:\n  S \\<noteq> {}\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  S \\<noteq> {}", "have IN: \"?s \\<in> S\""], ["proof (prove)\nusing this:\n  S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (SOME u. u \\<in> S) \\<in> S", "using some_in_eq"], ["proof (prove)\nusing this:\n  S \\<noteq> {}\n  ((SOME x. x \\<in> ?A) \\<in> ?A) = (?A \\<noteq> {})\n\ngoal (1 subgoal):\n 1. (SOME u. u \\<in> S) \\<in> S", "by metis"], ["proof (state)\nthis:\n  (SOME u. u \\<in> S) \\<in> S\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  (SOME u. u \\<in> S) \\<in> S", "have \"w ?s \\<le> c\""], ["proof (prove)\nusing this:\n  (SOME u. u \\<in> S) \\<in> S\n\ngoal (1 subgoal):\n 1. w (SOME u. u \\<in> S) \\<le> real c", "using SL_def"], ["proof (prove)\nusing this:\n  (SOME u. u \\<in> S) \\<in> S\n  S \\<subseteq> {u \\<in> U. w u \\<le> real c / 2} \\<and>\n  L \\<subseteq> {u \\<in> U. real c / 2 < w u}\n\ngoal (1 subgoal):\n 1. w (SOME u. u \\<in> S) \\<le> real c", "by auto"], ["proof (state)\nthis:\n  w (SOME u. u \\<in> S) \\<le> real c\n\ngoal (4 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       S \\<noteq> {} \\<Longrightarrow>\n       (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n         inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n          (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n          (S - {SOME u. u \\<in> S}) L) \\<and>\n        (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                \\<le> real c \\<longrightarrow>\n         (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n           (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n           (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n           (S - {SOME u. u \\<in> S}) L))) \\<and>\n       (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n        (L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n           (L - {SOME u. u \\<in> L})) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> L)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n            (L - {SOME u. u \\<in> L})) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n            (L - {SOME u. u \\<in> L})))) \\<and>\n        (\\<not> L \\<noteq> {} \\<longrightarrow>\n         (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n          inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n           (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n           (S - {SOME u. u \\<in> S}) L) \\<and>\n         (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n                 \\<le> real c \\<longrightarrow>\n          (W B\\<^sub>2 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n            (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n            (S - {SOME u. u \\<in> S}) L) \\<and>\n          (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n                  \\<le> real c \\<longrightarrow>\n           inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n            (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n            (S - {SOME u. u \\<in> S}) L))))\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 4. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  w (SOME u. u \\<in> S) \\<le> real c", "show ?case"], ["proof (prove)\nusing this:\n  w (SOME u. u \\<in> S) \\<le> real c\n\ngoal (1 subgoal):\n 1. (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n     (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n       (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n       (S - {SOME u. u \\<in> S}) L) \\<and>\n     (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n             \\<le> real c \\<longrightarrow>\n      (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n        (B\\<^sub>2 \\<union> {SOME u. u \\<in> S}) (S - {SOME u. u \\<in> S})\n        L) \\<and>\n      (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n              \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n        (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n        (S - {SOME u. u \\<in> S}) L))) \\<and>\n    (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n     (L \\<noteq> {} \\<longrightarrow>\n      (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n        (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n        (L - {SOME u. u \\<in> L})) \\<and>\n      (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n              \\<le> real c \\<longrightarrow>\n       (W B\\<^sub>2 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n         (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n         (L - {SOME u. u \\<in> L})) \\<and>\n       (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n               \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n         (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n         (L - {SOME u. u \\<in> L})))) \\<and>\n     (\\<not> L \\<noteq> {} \\<longrightarrow>\n      (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n        (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n        (S - {SOME u. u \\<in> S}) L) \\<and>\n      (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n              \\<le> real c \\<longrightarrow>\n       (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n         (B\\<^sub>2 \\<union> {SOME u. u \\<in> S}) (S - {SOME u. u \\<in> S})\n         L) \\<and>\n       (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n               \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n         (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n         (S - {SOME u. u \\<in> S}) L))))", "using LWEIGHT loop_stepA[OF INV _ _ IN] loop_stepB[OF INV _ LIN] loop_stepC[OF INV _ IN]\n      and loop_stepD[OF INV _ IN] loop_stepE[OF INV _ IN]"], ["proof (prove)\nusing this:\n  w (SOME u. u \\<in> S) \\<le> real c\n  L \\<noteq> {} \\<Longrightarrow> w (SOME u. u \\<in> L) \\<le> real c\n  \\<lbrakk>B\\<^sub>1 = {}; L = {}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {SOME u. u \\<in> S}\n                     B\\<^sub>2 (S - {SOME u. u \\<in> S}) L\n  \\<lbrakk>B\\<^sub>1 = {}; L \\<noteq> {}\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 {SOME u. u \\<in> L}\n                     B\\<^sub>2 S (L - {SOME u. u \\<in> L})\n  \\<lbrakk>B\\<^sub>1 \\<noteq> {};\n   W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n                     (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n                     (S - {SOME u. u \\<in> S}) L\n  \\<lbrakk>B\\<^sub>1 \\<noteq> {};\n   real c < W B\\<^sub>1 + w (SOME u. u \\<in> S);\n   W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     P\\<^sub>2 {} (B\\<^sub>2 \\<union> {SOME u. u \\<in> S})\n                     (S - {SOME u. u \\<in> S}) L\n  \\<lbrakk>B\\<^sub>1 \\<noteq> {};\n   real c < W B\\<^sub>1 + w (SOME u. u \\<in> S);\n   real c < W B\\<^sub>2 + w (SOME u. u \\<in> S)\\<rbrakk>\n  \\<Longrightarrow> inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n                     (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {}\n                     {SOME u. u \\<in> S} (S - {SOME u. u \\<in> S}) L\n\ngoal (1 subgoal):\n 1. (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n     (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n       (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n       (S - {SOME u. u \\<in> S}) L) \\<and>\n     (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n             \\<le> real c \\<longrightarrow>\n      (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n        (B\\<^sub>2 \\<union> {SOME u. u \\<in> S}) (S - {SOME u. u \\<in> S})\n        L) \\<and>\n      (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n              \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n        (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n        (S - {SOME u. u \\<in> S}) L))) \\<and>\n    (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n     (L \\<noteq> {} \\<longrightarrow>\n      (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n        (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n        (L - {SOME u. u \\<in> L})) \\<and>\n      (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n              \\<le> real c \\<longrightarrow>\n       (W B\\<^sub>2 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n         (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n         (L - {SOME u. u \\<in> L})) \\<and>\n       (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n               \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n         (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n         (L - {SOME u. u \\<in> L})))) \\<and>\n     (\\<not> L \\<noteq> {} \\<longrightarrow>\n      (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n        (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n        (S - {SOME u. u \\<in> S}) L) \\<and>\n      (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n              \\<le> real c \\<longrightarrow>\n       (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n         (B\\<^sub>2 \\<union> {SOME u. u \\<in> S}) (S - {SOME u. u \\<in> S})\n         L) \\<and>\n       (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n               \\<le> real c \\<longrightarrow>\n        inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n         (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n         (S - {SOME u. u \\<in> S}) L))))", "by (cases \\<open>B\\<^sub>1 = {}\\<close>, cases \\<open>L = {}\\<close>) auto"], ["proof (state)\nthis:\n  (B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n   (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n    inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 (B\\<^sub>1 \\<union> {SOME u. u \\<in> S})\n     B\\<^sub>2 (S - {SOME u. u \\<in> S}) L) \\<and>\n   (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n           \\<le> real c \\<longrightarrow>\n    (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n     inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n      (B\\<^sub>2 \\<union> {SOME u. u \\<in> S}) (S - {SOME u. u \\<in> S})\n      L) \\<and>\n    (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n            \\<le> real c \\<longrightarrow>\n     inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n      (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n      (S - {SOME u. u \\<in> S}) L))) \\<and>\n  (\\<not> B\\<^sub>1 \\<noteq> {} \\<longrightarrow>\n   (L \\<noteq> {} \\<longrightarrow>\n    (W B\\<^sub>1 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n     inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n      (B\\<^sub>1 \\<union> {SOME u. u \\<in> L}) B\\<^sub>2 S\n      (L - {SOME u. u \\<in> L})) \\<and>\n    (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> L)\n            \\<le> real c \\<longrightarrow>\n     (W B\\<^sub>2 + w (SOME u. u \\<in> L) \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n       (B\\<^sub>2 \\<union> {SOME u. u \\<in> L}) S\n       (L - {SOME u. u \\<in> L})) \\<and>\n     (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> L)\n             \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n       (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> L} S\n       (L - {SOME u. u \\<in> L})))) \\<and>\n   (\\<not> L \\<noteq> {} \\<longrightarrow>\n    (W B\\<^sub>1 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n     inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2\n      (B\\<^sub>1 \\<union> {SOME u. u \\<in> S}) B\\<^sub>2\n      (S - {SOME u. u \\<in> S}) L) \\<and>\n    (\\<not> W B\\<^sub>1 + w (SOME u. u \\<in> S)\n            \\<le> real c \\<longrightarrow>\n     (W B\\<^sub>2 + w (SOME u. u \\<in> S) \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1) P\\<^sub>2 {}\n       (B\\<^sub>2 \\<union> {SOME u. u \\<in> S}) (S - {SOME u. u \\<in> S})\n       L) \\<and>\n     (\\<not> W B\\<^sub>2 + w (SOME u. u \\<in> S)\n             \\<le> real c \\<longrightarrow>\n      inv\\<^sub>3 (P\\<^sub>1 \\<union> wrap B\\<^sub>1)\n       (P\\<^sub>2 \\<union> wrap B\\<^sub>2) {} {SOME u. u \\<in> S}\n       (S - {SOME u. u \\<in> S}) L))))\n\ngoal (3 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "case (5 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u)"], ["proof (state)\nthis:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  \\<not> S \\<noteq> {}\n\ngoal (3 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       \\<not> S \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       L \\<subseteq> L \\<and>\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - L}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 3. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  \\<not> S \\<noteq> {}", "show ?case"], ["proof (prove)\nusing this:\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  \\<not> S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. S = {} \\<and>\n    inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n    L \\<subseteq> L \\<and>\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> L - L}", "by blast"], ["proof (state)\nthis:\n  S = {} \\<and>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  L \\<subseteq> L \\<and>\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> L - L}\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "case (6 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u)"], ["proof (state)\nthis:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  V \\<noteq> {}\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  V \\<noteq> {}", "have *: \"(SOME u. u \\<in> V) \\<in> V\" \"(SOME u. u \\<in> V) \\<in> L\""], ["proof (prove)\nusing this:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  V \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (SOME u. u \\<in> V) \\<in> V &&& (SOME u. u \\<in> V) \\<in> L", "by (auto simp add: some_in_eq)"], ["proof (state)\nthis:\n  (SOME u. u \\<in> V) \\<in> V\n  (SOME u. u \\<in> V) \\<in> L\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  (SOME u. u \\<in> V) \\<in> V\n  (SOME u. u \\<in> V) \\<in> L", "have \"P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n           = P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union> wrap B\\<^sub>2 \\<union> {{v} |v. v \\<in> L - V \\<union> {SOME u. u \\<in> V}}\""], ["proof (prove)\nusing this:\n  (SOME u. u \\<in> V) \\<in> V\n  (SOME u. u \\<in> V) \\<in> L\n\ngoal (1 subgoal):\n 1. P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> L - V \\<union> {SOME u. u \\<in> V}}", "by blast"], ["proof (state)\nthis:\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> L - V \\<union> {SOME u. u \\<in> V}}\n\ngoal (2 subgoals):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       V \\<noteq> {} \\<Longrightarrow>\n       S = {} \\<and>\n       inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n       V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n       P \\<union> {{SOME u. u \\<in> V}} =\n       P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n       wrap B\\<^sub>2 \\<union>\n       {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n 2. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "with 6 *"], ["proof (chain)\npicking this:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  V \\<noteq> {}\n  (SOME u. u \\<in> V) \\<in> V\n  (SOME u. u \\<in> V) \\<in> L\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> L - V \\<union> {SOME u. u \\<in> V}}", "show ?case"], ["proof (prove)\nusing this:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  V \\<noteq> {}\n  (SOME u. u \\<in> V) \\<in> V\n  (SOME u. u \\<in> V) \\<in> L\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> L - V \\<union> {SOME u. u \\<in> V}}\n\ngoal (1 subgoal):\n 1. S = {} \\<and>\n    inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n    V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n    P \\<union> {{SOME u. u \\<in> V}} =\n    P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n    wrap B\\<^sub>2 \\<union>\n    {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}", "by blast"], ["proof (state)\nthis:\n  S = {} \\<and>\n  inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n  V - {SOME u. u \\<in> V} \\<subseteq> L \\<and>\n  P \\<union> {{SOME u. u \\<in> V}} =\n  P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n  wrap B\\<^sub>2 \\<union>\n  {{v} |v. v \\<in> L - (V - {SOME u. u \\<in> V})}\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "case (7 P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u)"], ["proof (state)\nthis:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  \\<not> V \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "then"], ["proof (chain)\npicking this:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  \\<not> V \\<noteq> {}", "have *: \"inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\""], ["proof (prove)\nusing this:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  \\<not> V \\<noteq> {}\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L", "using inv\\<^sub>3E(1)"], ["proof (prove)\nusing this:\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  \\<not> V \\<noteq> {}\n  inv\\<^sub>3 ?P\\<^sub>1 ?P\\<^sub>2 ?B\\<^sub>1 ?B\\<^sub>2 ?S\n   ?L \\<Longrightarrow>\n  inv\\<^sub>2 ?P\\<^sub>1 ?P\\<^sub>2 ?B\\<^sub>1 ?B\\<^sub>2 ?S ?L\n\ngoal (1 subgoal):\n 1. inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L", "by blast"], ["proof (state)\nthis:\n  inv\\<^sub>2 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "from inv\\<^sub>1E(1)[OF inv\\<^sub>2E(1)[OF *]] 7"], ["proof (chain)\npicking this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  \\<not> V \\<noteq> {}", "have \"bp P\""], ["proof (prove)\nusing this:\n  bp (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n      wrap B\\<^sub>2 \\<union>\n      {{v} |v. v \\<in> S \\<union> L})\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  \\<not> V \\<noteq> {}\n\ngoal (1 subgoal):\n 1. bp P", "by fastforce"], ["proof (state)\nthis:\n  bp P\n\ngoal (1 subgoal):\n 1. \\<And>P P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 V S L u.\n       (S = {} \\<and>\n        inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n        V \\<subseteq> L \\<and>\n        P =\n        P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n        wrap B\\<^sub>2 \\<union>\n        {{v} |v. v \\<in> L - V}) \\<and>\n       \\<not> V \\<noteq> {} \\<Longrightarrow>\n       bp P \\<and>\n       (\\<forall>Q.\n           bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "with bin_packing_lower_bound_card[OF _ *] 7"], ["proof (chain)\npicking this:\n  \\<lbrakk>S = {}; bp ?P\\<rbrakk>\n  \\<Longrightarrow> real\n                     (card\n                       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                        P\\<^sub>2 \\<union>\n                        wrap B\\<^sub>2 \\<union>\n                        {{v} |v. v \\<in> S \\<union> L}))\n                    \\<le> 3 / 2 * real (card ?P)\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  \\<not> V \\<noteq> {}\n  bp P", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>S = {}; bp ?P\\<rbrakk>\n  \\<Longrightarrow> real\n                     (card\n                       (P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union>\n                        P\\<^sub>2 \\<union>\n                        wrap B\\<^sub>2 \\<union>\n                        {{v} |v. v \\<in> S \\<union> L}))\n                    \\<le> 3 / 2 * real (card ?P)\n  (S = {} \\<and>\n   inv\\<^sub>3 P\\<^sub>1 P\\<^sub>2 B\\<^sub>1 B\\<^sub>2 S L \\<and>\n   V \\<subseteq> L \\<and>\n   P =\n   P\\<^sub>1 \\<union> wrap B\\<^sub>1 \\<union> P\\<^sub>2 \\<union>\n   wrap B\\<^sub>2 \\<union>\n   {{v} |v. v \\<in> L - V}) \\<and>\n  \\<not> V \\<noteq> {}\n  bp P\n\ngoal (1 subgoal):\n 1. bp P \\<and>\n    (\\<forall>Q.\n        bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))", "by fastforce"], ["proof (state)\nthis:\n  bp P \\<and>\n  (\\<forall>Q.\n      bp Q \\<longrightarrow> real (card P) \\<le> 3 / 2 * real (card Q))\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "(* BinPacking_Complete *)"], ["", "end"], ["", "(* Theory *)"]]}