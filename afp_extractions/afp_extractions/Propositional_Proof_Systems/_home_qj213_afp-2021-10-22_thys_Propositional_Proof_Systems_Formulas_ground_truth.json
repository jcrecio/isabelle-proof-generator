{"file_name": "/home/qj213/afp-2021-10-22/thys/Propositional_Proof_Systems/Formulas.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Propositional_Proof_Systems", "problem_names": ["lemma atoms_finite[simp,intro!]: \"finite (atoms F)\"", "lemma atoms_are_subformulae: \"Atom ` atoms F \\<subseteq> set (subformulae F)\"", "lemma subsubformulae: \"G \\<in> set (subformulae F) \\<Longrightarrow> H \\<in> set (subformulae G) \\<Longrightarrow> H \\<in> set (subformulae F)\"", "lemma subformula_atoms: \"G \\<in> set (subformulae F) \\<Longrightarrow> atoms G \\<subseteq> atoms F\"", "lemma subformulae_self[simp,intro]: \"F \\<in> set (subformulae F)\"", "lemma subformulas_in_subformulas:\n  \"G \\<^bold>\\<and> H \\<in> set (subformulae F) \\<Longrightarrow> G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F)\"\n  \"G \\<^bold>\\<or> H \\<in> set (subformulae F) \\<Longrightarrow> G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F)\"\n  \"G \\<^bold>\\<rightarrow> H \\<in> set (subformulae F) \\<Longrightarrow> G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F)\"\n  \"\\<^bold>\\<not> G \\<in> set (subformulae F) \\<Longrightarrow> G \\<in> set (subformulae F)\"", "lemma length_subformulae: \"length (subformulae F) = size F\"", "lemma top_atoms_simp[simp]: \"atoms \\<top> = {}\"", "lemma atoms_BigAnd[simp]: \"atoms (\\<^bold>\\<And>Fs) = \\<Union>(atoms ` set Fs)\"", "lemma pn_atoms_atoms: \"atoms F = fst (pn_atoms F) \\<union> snd (pn_atoms F)\"", "lemma simplify_consts_size_le: \"size (simplify_consts F) \\<le> size F\"", "lemma simplify_const: \"atoms F = {} \\<Longrightarrow> isstop (simplify_consts F) \\<or> (simplify_consts F) = \\<bottom>\"", "lemma all_formulas_of_size: \"F \\<in> all_formulas_of_size K n \\<longleftrightarrow> (size F \\<le> Suc n \\<and> atoms F \\<subseteq> K)\" (is \"?l \\<longleftrightarrow> ?r\")"], "translations": [["", "lemma atoms_finite[simp,intro!]: \"finite (atoms F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (atoms F)", "by(induction F; simp)"], ["", "primrec subformulae where\n\"subformulae \\<bottom> = [\\<bottom>]\" |\n\"subformulae (Atom k) = [Atom k]\" |\n\"subformulae (Not F) = Not F # subformulae F\" |\n\"subformulae (And F G) = And F G # subformulae F @ subformulae G\" |\n\"subformulae (Imp F G) = Imp F G # subformulae F @ subformulae G\" |\n\"subformulae (Or F G) = Or F G # subformulae F @ subformulae G\""], ["", "lemma atoms_are_subformulae: \"Atom ` atoms F \\<subseteq> set (subformulae F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Atom ` atoms F \\<subseteq> set (subformulae F)", "by (induction F) auto"], ["", "lemma subsubformulae: \"G \\<in> set (subformulae F) \\<Longrightarrow> H \\<in> set (subformulae G) \\<Longrightarrow> H \\<in> set (subformulae F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>G \\<in> set (subformulae F);\n     H \\<in> set (subformulae G)\\<rbrakk>\n    \\<Longrightarrow> H \\<in> set (subformulae F)", "by(induction F; force)"], ["", "lemma subformula_atoms: \"G \\<in> set (subformulae F) \\<Longrightarrow> atoms G \\<subseteq> atoms F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G \\<in> set (subformulae F) \\<Longrightarrow>\n    atoms G \\<subseteq> atoms F", "by(induction F) auto"], ["", "lemma subformulae_self[simp,intro]: \"F \\<in> set (subformulae F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<in> set (subformulae F)", "by(induction F; simp)"], ["", "lemma subformulas_in_subformulas:\n  \"G \\<^bold>\\<and> H \\<in> set (subformulae F) \\<Longrightarrow> G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F)\"\n  \"G \\<^bold>\\<or> H \\<in> set (subformulae F) \\<Longrightarrow> G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F)\"\n  \"G \\<^bold>\\<rightarrow> H \\<in> set (subformulae F) \\<Longrightarrow> G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F)\"\n  \"\\<^bold>\\<not> G \\<in> set (subformulae F) \\<Longrightarrow> G \\<in> set (subformulae F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((G \\<^bold>\\<and> H \\<in> set (subformulae F) \\<Longrightarrow>\n      G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F)) &&&\n     (G \\<^bold>\\<or> H \\<in> set (subformulae F) \\<Longrightarrow>\n      G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F))) &&&\n    (G \\<^bold>\\<rightarrow> H \\<in> set (subformulae F) \\<Longrightarrow>\n     G \\<in> set (subformulae F) \\<and> H \\<in> set (subformulae F)) &&&\n    (\\<^bold>\\<not> G \\<in> set (subformulae F) \\<Longrightarrow>\n     G \\<in> set (subformulae F))", "by(fastforce elim: subsubformulae)+"], ["", "lemma length_subformulae: \"length (subformulae F) = size F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (subformulae F) = size F", "by(induction F; simp)"], ["", "subsection\\<open>Derived Connectives\\<close>"], ["", "definition Top (\"\\<top>\") where\n\"\\<top> \\<equiv> \\<bottom> \\<^bold>\\<rightarrow> \\<bottom>\""], ["", "lemma top_atoms_simp[simp]: \"atoms \\<top> = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. atoms \\<top> = {}", "unfolding Top_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. atoms (\\<bottom> \\<^bold>\\<rightarrow> \\<bottom>) = {}", "by simp"], ["", "primrec BigAnd :: \"'a formula list \\<Rightarrow> 'a formula\" (\"\\<^bold>\\<And>_\") where\n\"\\<^bold>\\<And>Nil = (\\<^bold>\\<not>\\<bottom>)\" \\<comment> \\<open>essentially, it doesn't matter what I use here. But since I want to use this in CNFs, implication is not a nice thing to have.\\<close> |\n\"\\<^bold>\\<And>(F#Fs) = F \\<^bold>\\<and> \\<^bold>\\<And>Fs\""], ["", "lemma atoms_BigAnd[simp]: \"atoms (\\<^bold>\\<And>Fs) = \\<Union>(atoms ` set Fs)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. atoms \\<^bold>\\<And>Fs = \\<Union> (atoms ` set Fs)", "by(induction Fs; simp)"], ["", "primrec BigOr :: \"'a formula list \\<Rightarrow> 'a formula\" (\"\\<^bold>\\<Or>_\") where\n\"\\<^bold>\\<Or>Nil = \\<bottom>\" |\n\"\\<^bold>\\<Or>(F#Fs) = F \\<^bold>\\<or> \\<^bold>\\<Or>Fs\""], ["", "text\\<open>Formulas are countable if their atoms are, and @{method countable_datatype} is really helpful with that.\\<close>"], ["", "instance formula :: (countable) countable"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a formula, countable_class)", "by countable_datatype"], ["", "definition \"prod_unions A B \\<equiv> case A of (a,b) \\<Rightarrow> case B of (c,d) \\<Rightarrow> (a \\<union> c, b \\<union> d)\""], ["", "primrec pn_atoms where\n\"pn_atoms (Atom A) = ({A},{})\" |\n\"pn_atoms Bot = ({},{})\" |\n\"pn_atoms (Not F) = prod.swap (pn_atoms F)\" |\n\"pn_atoms (And F G) = prod_unions (pn_atoms F) (pn_atoms G)\" |\n\"pn_atoms (Or F G) = prod_unions (pn_atoms F) (pn_atoms G)\" |\n\"pn_atoms (Imp F G) = prod_unions (prod.swap (pn_atoms F)) (pn_atoms G)\""], ["", "lemma pn_atoms_atoms: \"atoms F = fst (pn_atoms F) \\<union> snd (pn_atoms F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. atoms F = fst (pn_atoms F) \\<union> snd (pn_atoms F)", "by(induction F) (auto simp add: prod_unions_def split: prod.splits)"], ["", "text\\<open>A very trivial simplifier.\nDoes wonders as a postprocessor for the Harrison-style Craig interpolations.\\<close>"], ["", "context begin"], ["", "definition \"isstop F \\<equiv> F = \\<^bold>\\<not>\\<bottom> \\<or> F = \\<top>\""], ["", "fun simplify_consts where\n\"simplify_consts (Atom k) = Atom k\" |\n\"simplify_consts \\<bottom> = \\<bottom>\" |\n\"simplify_consts (Not F) = (let S = simplify_consts F in case S of (Not G) \\<Rightarrow> G | _ \\<Rightarrow>\n  if isstop S then \\<bottom> else \\<^bold>\\<not> S)\" |\n\"simplify_consts (And F G) = (let S = simplify_consts F; T = simplify_consts G in (\n  if S = \\<bottom> then \\<bottom> else\n  if isstop S then T \\<comment> \\<open>not \\<open>\\<top>\\<close>, \\<open>T\\<close>\\<close> else\n  if T = \\<bottom> then \\<bottom> else\n  if isstop T then S else\n  if S = T then S else\n  S \\<^bold>\\<and> T))\" |\n\"simplify_consts (Or F G) = (let S = simplify_consts F; T = simplify_consts G in (\n  if S = \\<bottom> then T else\n  if isstop S then \\<top> else\n  if T = \\<bottom> then S else\n  if isstop T then \\<top> else\n  if S = T then S else\n  S \\<^bold>\\<or> T))\" |\n\"simplify_consts (Imp F G) = (let S = simplify_consts F; T = simplify_consts G in (\n  if S = \\<bottom> then \\<top> else\n  if isstop S then T else\n  if isstop T then \\<top> else\n  if T = \\<bottom> then \\<^bold>\\<not> S else\n  if S = T then \\<top> else\n  case S of Not H \\<Rightarrow> (case T of Not I \\<Rightarrow> \n    I \\<^bold>\\<rightarrow> H | _ \\<Rightarrow> \n    H \\<^bold>\\<or> T) | _ \\<Rightarrow>\n    S \\<^bold>\\<rightarrow> T))\""], ["", "lemma simplify_consts_size_le: \"size (simplify_consts F) \\<le> size F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. size (simplify_consts F) \\<le> size F", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. size (simplify_consts F) \\<le> size F", "have [simp]: \"Suc (Suc 0) \\<le> size F + size G\" for F G :: \"'a formula\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Suc (Suc 0) \\<le> size F + size G", "by(cases F; cases G; simp)"], ["proof (state)\nthis:\n  Suc (Suc 0) \\<le> size ?F + size ?G\n\ngoal (1 subgoal):\n 1. size (simplify_consts F) \\<le> size F", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. size (simplify_consts F) \\<le> size F", "by(induction F; fastforce simp add: Let_def isstop_def Top_def split: formula.splits)"], ["proof (state)\nthis:\n  size (simplify_consts F) \\<le> size F\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma simplify_const: \"atoms F = {} \\<Longrightarrow> isstop (simplify_consts F) \\<or> (simplify_consts F) = \\<bottom>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. atoms F = {} \\<Longrightarrow>\n    isstop (simplify_consts F) \\<or> simplify_consts F = \\<bottom>", "by(induction F; fastforce simp add: Let_def isstop_def Top_def split: formula.splits)"], ["", "value \"(size \\<top>, size (\\<^bold>\\<not>\\<bottom>))\""], ["", "(* this is why I need isstop in this lemma and can't write simplify_consts\n  in a way that this lemma can say \\<in> {\\<top>, \\<bottom>} *)"], ["", "end"], ["", "(*\nHere's a useful little function for testing a conjecture on \"a few\" examples: \n*)"], ["", "fun all_formulas_of_size where\n\"all_formulas_of_size K 0 = {\\<bottom>} \\<union> Atom ` K\" |\n\"all_formulas_of_size K (Suc n) = (\n  let af = \\<Union>(set [all_formulas_of_size K m. m \\<leftarrow> [0..<Suc n]]) in\n  (\\<Union>F\\<in>af.\n    (\\<Union>G\\<in>af. if size F + size G \\<le> Suc n then {And F G, Or F G, Imp F G} else {}) \n   \\<union> (if size F \\<le> Suc n then {Not F} else {})) \n  \\<union> af)\""], ["", "(* this set obviously grows exponentially (with a base of 5 approximately).\n   size 7 produces 26032 formulas, which is probably the last value\n   where I can test anything meaningfully with this implementation. *)"], ["", "lemma all_formulas_of_size: \"F \\<in> all_formulas_of_size K n \\<longleftrightarrow> (size F \\<le> Suc n \\<and> atoms F \\<subseteq> K)\" (is \"?l \\<longleftrightarrow> ?r\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<in> all_formulas_of_size K n) =\n    (size F \\<le> Suc n \\<and> atoms F \\<subseteq> K)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (F \\<in> all_formulas_of_size K n) =\n    (size F \\<le> Suc n \\<and> atoms F \\<subseteq> K)", "have rl: \"?r \\<Longrightarrow> ?l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. size F \\<le> Suc n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n    F \\<in> all_formulas_of_size K n", "proof(induction F arbitrary: n)"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>x n.\n       size (Atom x) \\<le> Suc n \\<and>\n       atoms (Atom x) \\<subseteq> K \\<Longrightarrow>\n       Atom x \\<in> all_formulas_of_size K n\n 2. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 3. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 6. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "case (Atom x)"], ["proof (state)\nthis:\n  size (Atom x) \\<le> Suc n \\<and> atoms (Atom x) \\<subseteq> K\n\ngoal (6 subgoals):\n 1. \\<And>x n.\n       size (Atom x) \\<le> Suc n \\<and>\n       atoms (Atom x) \\<subseteq> K \\<Longrightarrow>\n       Atom x \\<in> all_formulas_of_size K n\n 2. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 3. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 6. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have *: \"Atom x \\<in> all_formulas_of_size K 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Atom x \\<in> all_formulas_of_size K 0", "using Atom"], ["proof (prove)\nusing this:\n  size (Atom x) \\<le> Suc n \\<and> atoms (Atom x) \\<subseteq> K\n\ngoal (1 subgoal):\n 1. Atom x \\<in> all_formulas_of_size K 0", "by simp"], ["proof (state)\nthis:\n  Atom x \\<in> all_formulas_of_size K 0\n\ngoal (6 subgoals):\n 1. \\<And>x n.\n       size (Atom x) \\<le> Suc n \\<and>\n       atoms (Atom x) \\<subseteq> K \\<Longrightarrow>\n       Atom x \\<in> all_formulas_of_size K n\n 2. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 3. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 6. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "hence **: \"Atom x \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc m])\" for m"], ["proof (prove)\nusing this:\n  Atom x \\<in> all_formulas_of_size K 0\n\ngoal (1 subgoal):\n 1. Atom x \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc m])", "by (simp; metis atLeastLessThan_iff le_zero_eq not_le)"], ["proof (state)\nthis:\n  Atom x \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc ?m])\n\ngoal (6 subgoals):\n 1. \\<And>x n.\n       size (Atom x) \\<le> Suc n \\<and>\n       atoms (Atom x) \\<subseteq> K \\<Longrightarrow>\n       Atom x \\<in> all_formulas_of_size K n\n 2. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 3. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 6. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "thus ?case"], ["proof (prove)\nusing this:\n  Atom x \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc ?m])\n\ngoal (1 subgoal):\n 1. Atom x \\<in> all_formulas_of_size K n", "using Atom"], ["proof (prove)\nusing this:\n  Atom x \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc ?m])\n  size (Atom x) \\<le> Suc n \\<and> atoms (Atom x) \\<subseteq> K\n\ngoal (1 subgoal):\n 1. Atom x \\<in> all_formulas_of_size K n", "by(cases n; simp)"], ["proof (state)\nthis:\n  Atom x \\<in> all_formulas_of_size K n\n\ngoal (5 subgoals):\n 1. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 2. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "next"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 2. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "case Bot"], ["proof (state)\nthis:\n  size \\<bottom> \\<le> Suc n \\<and> atoms \\<bottom> \\<subseteq> K\n\ngoal (5 subgoals):\n 1. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 2. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have *: \"Bot \\<in> all_formulas_of_size K 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bottom> \\<in> all_formulas_of_size K 0", "by simp"], ["proof (state)\nthis:\n  \\<bottom> \\<in> all_formulas_of_size K 0\n\ngoal (5 subgoals):\n 1. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 2. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "hence **: \"Bot \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc m])\" for m"], ["proof (prove)\nusing this:\n  \\<bottom> \\<in> all_formulas_of_size K 0\n\ngoal (1 subgoal):\n 1. \\<bottom> \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc m])", "by (simp; metis atLeastLessThan_iff le_zero_eq not_le)"], ["proof (state)\nthis:\n  \\<bottom> \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc ?m])\n\ngoal (5 subgoals):\n 1. \\<And>n.\n       size \\<bottom> \\<le> Suc n \\<and>\n       atoms \\<bottom> \\<subseteq> K \\<Longrightarrow>\n       \\<bottom> \\<in> all_formulas_of_size K n\n 2. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 5. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  \\<bottom> \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc ?m])", "show ?case"], ["proof (prove)\nusing this:\n  \\<bottom> \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc ?m])\n\ngoal (1 subgoal):\n 1. \\<bottom> \\<in> all_formulas_of_size K n", "using Bot"], ["proof (prove)\nusing this:\n  \\<bottom> \\<in> \\<Union> (all_formulas_of_size K ` set [0..<Suc ?m])\n  size \\<bottom> \\<le> Suc n \\<and> atoms \\<bottom> \\<subseteq> K\n\ngoal (1 subgoal):\n 1. \\<bottom> \\<in> all_formulas_of_size K n", "by(cases n; simp)"], ["proof (state)\nthis:\n  \\<bottom> \\<in> all_formulas_of_size K n\n\ngoal (4 subgoals):\n 1. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "case (Not F)"], ["proof (state)\nthis:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n  atoms (\\<^bold>\\<not> F) \\<subseteq> K\n\ngoal (4 subgoals):\n 1. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have *: \"size F \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. size F \\<le> n", "using Not"], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n  atoms (\\<^bold>\\<not> F) \\<subseteq> K\n\ngoal (1 subgoal):\n 1. size F \\<le> n", "by simp"], ["proof (state)\nthis:\n  size F \\<le> n\n\ngoal (4 subgoals):\n 1. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  size F \\<le> n", "obtain m where n[simp]: \"n = Suc m\""], ["proof (prove)\nusing this:\n  size F \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<And>m. n = Suc m \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (metis Suc_diff_1 formula.size_neq leD neq0_conv)"], ["proof (state)\nthis:\n  n = Suc m\n\ngoal (4 subgoals):\n 1. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "with Not"], ["proof (chain)\npicking this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n  atoms (\\<^bold>\\<not> F) \\<subseteq> K\n  n = Suc m", "have IH: \"F \\<in> all_formulas_of_size K m\""], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n  atoms (\\<^bold>\\<not> F) \\<subseteq> K\n  n = Suc m\n\ngoal (1 subgoal):\n 1. F \\<in> all_formulas_of_size K m", "by simp"], ["proof (state)\nthis:\n  F \\<in> all_formulas_of_size K m\n\ngoal (4 subgoals):\n 1. \\<And>F n.\n       \\<lbrakk>\\<And>n.\n                   size F \\<le> Suc n \\<and>\n                   atoms F \\<subseteq> K \\<Longrightarrow>\n                   F \\<in> all_formulas_of_size K n;\n        size (\\<^bold>\\<not> F) \\<le> Suc n \\<and>\n        atoms (\\<^bold>\\<not> F) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 4. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  F \\<in> all_formulas_of_size K m", "show ?case"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K m\n\ngoal (1 subgoal):\n 1. \\<^bold>\\<not> F \\<in> all_formulas_of_size K n", "using *"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K m\n  size F \\<le> n\n\ngoal (1 subgoal):\n 1. \\<^bold>\\<not> F \\<in> all_formulas_of_size K n", "by(simp add: bexI[where x=F])"], ["proof (state)\nthis:\n  \\<^bold>\\<not> F \\<in> all_formulas_of_size K n\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "case (And F G)"], ["proof (state)\nthis:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<and> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<and> G) \\<subseteq> K\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "with And"], ["proof (chain)\npicking this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<and> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<and> G) \\<subseteq> K\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<and> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<and> G) \\<subseteq> K", "have *: \"size F + size G \\<le> n\""], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<and> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<and> G) \\<subseteq> K\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<and> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<and> G) \\<subseteq> K\n\ngoal (1 subgoal):\n 1. size F + size G \\<le> n", "by simp"], ["proof (state)\nthis:\n  size F + size G \\<le> n\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  size F + size G \\<le> n", "obtain m where n[simp]: \"n = Suc m\""], ["proof (prove)\nusing this:\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<And>m. n = Suc m \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (metis Suc_diff_1 add_is_0 formula.size_neq le_zero_eq neq0_conv)"], ["proof (state)\nthis:\n  n = Suc m\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  n = Suc m", "obtain nF nG where nFG[simp]: \"size F \\<le> nF\" \"size G \\<le> nG\" \"n = nF + nG\""], ["proof (prove)\nusing this:\n  n = Suc m\n\ngoal (1 subgoal):\n 1. (\\<And>nF nG.\n        \\<lbrakk>size F \\<le> nF; size G \\<le> nG; n = nF + nG\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis * add.assoc nat_le_iff_add order_refl)"], ["proof (state)\nthis:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG", "obtain mF mG where mFG[simp]: \"nF = Suc mF\" \"nG = Suc mG\""], ["proof (prove)\nusing this:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. (\\<And>mF mG.\n        \\<lbrakk>nF = Suc mF; nG = Suc mG\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis Suc_diff_1 formula.size_neq leD neq0_conv)"], ["proof (state)\nthis:\n  nF = Suc mF\n  nG = Suc mG\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "with And"], ["proof (chain)\npicking this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<and> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<and> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG", "have IH: \"F \\<in> all_formulas_of_size K mF\" \"G \\<in> all_formulas_of_size K mG\""], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<and> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<and> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG\n\ngoal (1 subgoal):\n 1. F \\<in> all_formulas_of_size K mF &&& G \\<in> all_formulas_of_size K mG", "using nFG"], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<and> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<and> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. F \\<in> all_formulas_of_size K mF &&& G \\<in> all_formulas_of_size K mG", "by simp+"], ["proof (state)\nthis:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "let ?af = \"\\<Union>(set [all_formulas_of_size K m. m \\<leftarrow> [0..<Suc m]])\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have r: \"F \\<in> all_formulas_of_size K mF \\<Longrightarrow> mF \\<le> n \\<Longrightarrow> F \\<in> \\<Union>(set (map (all_formulas_of_size K) [0..<Suc n]))\"\n      for F mF n"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>F \\<in> all_formulas_of_size K mF; mF \\<le> n\\<rbrakk>\n    \\<Longrightarrow> F \\<in> \\<Union>\n                               (set (map (all_formulas_of_size K)\n[0..<Suc n]))", "by fastforce"], ["proof (state)\nthis:\n  \\<lbrakk>?F \\<in> all_formulas_of_size K ?mF; ?mF \\<le> ?n\\<rbrakk>\n  \\<Longrightarrow> ?F \\<in> \\<Union>\n                              (set (map (all_formulas_of_size K)\n                                     [0..<Suc ?n]))\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have af: \"F \\<in> ?af\" \"G \\<in> ?af\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m])) &&&\n    G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))", "using nFG(3)"], ["proof (prove)\nusing this:\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m])) &&&\n    G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))", "by(intro IH[THEN r]; simp)+"], ["proof (state)\nthis:\n  F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n  G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have m: \"F \\<^bold>\\<and> G \\<in> (if size F + size G \\<le> Suc m then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G, F \\<^bold>\\<rightarrow> G} else {})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<^bold>\\<and> G\n    \\<in> (if size F + size G \\<le> Suc m\n           then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n                 F \\<^bold>\\<rightarrow> G}\n           else {})", "using *"], ["proof (prove)\nusing this:\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<and> G\n    \\<in> (if size F + size G \\<le> Suc m\n           then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n                 F \\<^bold>\\<rightarrow> G}\n           else {})", "by simp"], ["proof (state)\nthis:\n  F \\<^bold>\\<and> G\n  \\<in> (if size F + size G \\<le> Suc m\n         then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n               F \\<^bold>\\<rightarrow> G}\n         else {})\n\ngoal (3 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<and> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<and> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<and> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 3. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "from IH *"], ["proof (chain)\npicking this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n", "show ?case"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<and> G \\<in> all_formulas_of_size K n", "using af"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n\n  F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n  G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<and> G \\<in> all_formulas_of_size K n", "by(simp only: n all_formulas_of_size.simps Let_def, insert m) fast"], ["proof (state)\nthis:\n  F \\<^bold>\\<and> G \\<in> all_formulas_of_size K n\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "case (Or F G)"], ["proof (state)\nthis:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "case (Imp F G) \\<comment> \\<open>analogous\\<close>"], ["proof (state)\nthis:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "(*<*)"], ["proof (state)\nthis:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "case (Or F G)"], ["proof (state)\nthis:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "with Or"], ["proof (chain)\npicking this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K", "have *: \"size F + size G \\<le> n\""], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K\n\ngoal (1 subgoal):\n 1. size F + size G \\<le> n", "by simp"], ["proof (state)\nthis:\n  size F + size G \\<le> n\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  size F + size G \\<le> n", "obtain m where n[simp]: \"n = Suc m\""], ["proof (prove)\nusing this:\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<And>m. n = Suc m \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (metis Suc_diff_1 add_is_0 formula.size_neq le_zero_eq neq0_conv)"], ["proof (state)\nthis:\n  n = Suc m\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  n = Suc m", "obtain nF nG where nFG[simp]: \"size F \\<le> nF\" \"size G \\<le> nG\" \"n = nF + nG\""], ["proof (prove)\nusing this:\n  n = Suc m\n\ngoal (1 subgoal):\n 1. (\\<And>nF nG.\n        \\<lbrakk>size F \\<le> nF; size G \\<le> nG; n = nF + nG\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis * add.assoc nat_le_iff_add order_refl)"], ["proof (state)\nthis:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG", "obtain mF mG where mFG[simp]: \"nF = Suc mF\" \"nG = Suc mG\""], ["proof (prove)\nusing this:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. (\\<And>mF mG.\n        \\<lbrakk>nF = Suc mF; nG = Suc mG\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis Suc_diff_1 formula.size_neq leD neq0_conv)"], ["proof (state)\nthis:\n  nF = Suc mF\n  nG = Suc mG\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "with Or"], ["proof (chain)\npicking this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG", "have IH: \"F \\<in> all_formulas_of_size K mF\" \"G \\<in> all_formulas_of_size K mG\""], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG\n\ngoal (1 subgoal):\n 1. F \\<in> all_formulas_of_size K mF &&& G \\<in> all_formulas_of_size K mG", "using nFG"], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<or> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<or> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. F \\<in> all_formulas_of_size K mF &&& G \\<in> all_formulas_of_size K mG", "by simp+"], ["proof (state)\nthis:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "let ?af = \"\\<Union>(set [all_formulas_of_size K m. m \\<leftarrow> [0..<Suc m]])\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have r: \"F \\<in> all_formulas_of_size K mF \\<Longrightarrow> mF \\<le> n \\<Longrightarrow> F \\<in> \\<Union>(set (map (all_formulas_of_size K) [0..<Suc n]))\"\n      for F mF n"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>F \\<in> all_formulas_of_size K mF; mF \\<le> n\\<rbrakk>\n    \\<Longrightarrow> F \\<in> \\<Union>\n                               (set (map (all_formulas_of_size K)\n[0..<Suc n]))", "by fastforce"], ["proof (state)\nthis:\n  \\<lbrakk>?F \\<in> all_formulas_of_size K ?mF; ?mF \\<le> ?n\\<rbrakk>\n  \\<Longrightarrow> ?F \\<in> \\<Union>\n                              (set (map (all_formulas_of_size K)\n                                     [0..<Suc ?n]))\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have af: \"F \\<in> ?af\" \"G \\<in> ?af\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m])) &&&\n    G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))", "using nFG(3)"], ["proof (prove)\nusing this:\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m])) &&&\n    G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))", "by(intro IH[THEN r]; simp)+"], ["proof (state)\nthis:\n  F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n  G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have m: \"Or F G \\<in> (if size F + size G \\<le> Suc m then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G, F \\<^bold>\\<rightarrow> G} else {})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<^bold>\\<or> G\n    \\<in> (if size F + size G \\<le> Suc m\n           then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n                 F \\<^bold>\\<rightarrow> G}\n           else {})", "using *"], ["proof (prove)\nusing this:\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<or> G\n    \\<in> (if size F + size G \\<le> Suc m\n           then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n                 F \\<^bold>\\<rightarrow> G}\n           else {})", "by simp"], ["proof (state)\nthis:\n  F \\<^bold>\\<or> G\n  \\<in> (if size F + size G \\<le> Suc m\n         then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n               F \\<^bold>\\<rightarrow> G}\n         else {})\n\ngoal (2 subgoals):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<or> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<or> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<or> F2 \\<in> all_formulas_of_size K n\n 2. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "from IH *"], ["proof (chain)\npicking this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n", "show ?case"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<or> G \\<in> all_formulas_of_size K n", "using af"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n\n  F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n  G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<or> G \\<in> all_formulas_of_size K n", "by(simp only: n all_formulas_of_size.simps Let_def, insert m) fast"], ["proof (state)\nthis:\n  F \\<^bold>\\<or> G \\<in> all_formulas_of_size K n\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "case (Imp F G)"], ["proof (state)\nthis:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "with Imp"], ["proof (chain)\npicking this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K", "have *: \"size F + size G \\<le> n\""], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n\ngoal (1 subgoal):\n 1. size F + size G \\<le> n", "by simp"], ["proof (state)\nthis:\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  size F + size G \\<le> n", "obtain m where n[simp]: \"n = Suc m\""], ["proof (prove)\nusing this:\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<And>m. n = Suc m \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (metis Suc_diff_1 add_is_0 formula.size_neq le_zero_eq neq0_conv)"], ["proof (state)\nthis:\n  n = Suc m\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  n = Suc m", "obtain nF nG where nFG[simp]: \"size F \\<le> nF\" \"size G \\<le> nG\" \"n = nF + nG\""], ["proof (prove)\nusing this:\n  n = Suc m\n\ngoal (1 subgoal):\n 1. (\\<And>nF nG.\n        \\<lbrakk>size F \\<le> nF; size G \\<le> nG; n = nF + nG\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis * add.assoc nat_le_iff_add order_refl)"], ["proof (state)\nthis:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "then"], ["proof (chain)\npicking this:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG", "obtain mF mG where mFG[simp]: \"nF = Suc mF\" \"nG = Suc mG\""], ["proof (prove)\nusing this:\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. (\\<And>mF mG.\n        \\<lbrakk>nF = Suc mF; nG = Suc mG\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis Suc_diff_1 formula.size_neq leD neq0_conv)"], ["proof (state)\nthis:\n  nF = Suc mF\n  nG = Suc mG\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "with Imp"], ["proof (chain)\npicking this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG", "have IH: \"F \\<in> all_formulas_of_size K mF\" \"G \\<in> all_formulas_of_size K mG\""], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG\n\ngoal (1 subgoal):\n 1. F \\<in> all_formulas_of_size K mF &&& G \\<in> all_formulas_of_size K mG", "using nFG"], ["proof (prove)\nusing this:\n  size F \\<le> Suc ?n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K ?n\n  size G \\<le> Suc ?n \\<and> atoms G \\<subseteq> K \\<Longrightarrow>\n  G \\<in> all_formulas_of_size K ?n\n  size (F \\<^bold>\\<rightarrow> G) \\<le> Suc n \\<and>\n  atoms (F \\<^bold>\\<rightarrow> G) \\<subseteq> K\n  nF = Suc mF\n  nG = Suc mG\n  size F \\<le> nF\n  size G \\<le> nG\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. F \\<in> all_formulas_of_size K mF &&& G \\<in> all_formulas_of_size K mG", "by simp+"], ["proof (state)\nthis:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "let ?af = \"\\<Union>(set [all_formulas_of_size K m. m \\<leftarrow> [0..<Suc m]])\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have r: \"F \\<in> all_formulas_of_size K mF \\<Longrightarrow> mF \\<le> n \\<Longrightarrow> F \\<in> \\<Union>(set (map (all_formulas_of_size K) [0..<Suc n]))\"\n      for F mF n"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>F \\<in> all_formulas_of_size K mF; mF \\<le> n\\<rbrakk>\n    \\<Longrightarrow> F \\<in> \\<Union>\n                               (set (map (all_formulas_of_size K)\n[0..<Suc n]))", "by fastforce"], ["proof (state)\nthis:\n  \\<lbrakk>?F \\<in> all_formulas_of_size K ?mF; ?mF \\<le> ?n\\<rbrakk>\n  \\<Longrightarrow> ?F \\<in> \\<Union>\n                              (set (map (all_formulas_of_size K)\n                                     [0..<Suc ?n]))\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have af: \"F \\<in> ?af\" \"G \\<in> ?af\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m])) &&&\n    G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))", "using nFG(3)"], ["proof (prove)\nusing this:\n  n = nF + nG\n\ngoal (1 subgoal):\n 1. F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m])) &&&\n    G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))", "by(intro IH[THEN r]; simp)+"], ["proof (state)\nthis:\n  F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n  G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "have m: \"Imp F G \\<in> (if size F + size G \\<le> Suc m then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G, F \\<^bold>\\<rightarrow> G} else {})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<^bold>\\<rightarrow> G\n    \\<in> (if size F + size G \\<le> Suc m\n           then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n                 F \\<^bold>\\<rightarrow> G}\n           else {})", "using *"], ["proof (prove)\nusing this:\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<rightarrow> G\n    \\<in> (if size F + size G \\<le> Suc m\n           then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n                 F \\<^bold>\\<rightarrow> G}\n           else {})", "by simp"], ["proof (state)\nthis:\n  F \\<^bold>\\<rightarrow> G\n  \\<in> (if size F + size G \\<le> Suc m\n         then {F \\<^bold>\\<and> G, F \\<^bold>\\<or> G,\n               F \\<^bold>\\<rightarrow> G}\n         else {})\n\ngoal (1 subgoal):\n 1. \\<And>F1 F2 n.\n       \\<lbrakk>\\<And>n.\n                   size F1 \\<le> Suc n \\<and>\n                   atoms F1 \\<subseteq> K \\<Longrightarrow>\n                   F1 \\<in> all_formulas_of_size K n;\n        \\<And>n.\n           size F2 \\<le> Suc n \\<and>\n           atoms F2 \\<subseteq> K \\<Longrightarrow>\n           F2 \\<in> all_formulas_of_size K n;\n        size (F1 \\<^bold>\\<rightarrow> F2) \\<le> Suc n \\<and>\n        atoms (F1 \\<^bold>\\<rightarrow> F2) \\<subseteq> K\\<rbrakk>\n       \\<Longrightarrow> F1 \\<^bold>\\<rightarrow> F2\n                         \\<in> all_formulas_of_size K n", "from IH *"], ["proof (chain)\npicking this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n", "show ?case"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<rightarrow> G \\<in> all_formulas_of_size K n", "using af"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K mF\n  G \\<in> all_formulas_of_size K mG\n  size F + size G \\<le> n\n  F \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n  G \\<in> \\<Union> (set (map (all_formulas_of_size K) [0..<Suc m]))\n\ngoal (1 subgoal):\n 1. F \\<^bold>\\<rightarrow> G \\<in> all_formulas_of_size K n", "by(simp only: n all_formulas_of_size.simps Let_def, insert m) fast"], ["proof (state)\nthis:\n  F \\<^bold>\\<rightarrow> G \\<in> all_formulas_of_size K n\n\ngoal:\nNo subgoals!", "(*>*)"], ["proof (state)\nthis:\n  F \\<^bold>\\<rightarrow> G \\<in> all_formulas_of_size K n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  size F \\<le> Suc n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K n\n\ngoal (1 subgoal):\n 1. (F \\<in> all_formulas_of_size K n) =\n    (size F \\<le> Suc n \\<and> atoms F \\<subseteq> K)", "have lr: ?r if l: ?l"], ["proof (prove)\ngoal (1 subgoal):\n 1. size F \\<le> Suc n \\<and> atoms F \\<subseteq> K", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. size F \\<le> Suc n\n 2. atoms F \\<subseteq> K", "have *: \"F \\<in> all_formulas_of_size K x \\<Longrightarrow> F \\<in> all_formulas_of_size K (x + n)\" for x n"], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<in> all_formulas_of_size K x \\<Longrightarrow>\n    F \\<in> all_formulas_of_size K (x + n)", "by(induction n; simp)"], ["proof (state)\nthis:\n  F \\<in> all_formulas_of_size K ?x \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K (?x + ?n)\n\ngoal (2 subgoals):\n 1. size F \\<le> Suc n\n 2. atoms F \\<subseteq> K", "show \"size F \\<le> Suc n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. size F \\<le> Suc n", "using l"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K n\n\ngoal (1 subgoal):\n 1. size F \\<le> Suc n", "by(induction n; auto split: if_splits) (metis \"*\" le_SucI le_eq_less_or_eq le_iff_add)"], ["proof (state)\nthis:\n  size F \\<le> Suc n\n\ngoal (1 subgoal):\n 1. atoms F \\<subseteq> K", "show \"atoms F \\<subseteq> K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. atoms F \\<subseteq> K", "using l"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K n\n\ngoal (1 subgoal):\n 1. atoms F \\<subseteq> K", "proof(induction n arbitrary: F rule: less_induct)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x F.\n       \\<lbrakk>\\<And>y F.\n                   \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                   \\<Longrightarrow> atoms F \\<subseteq> K;\n        F \\<in> all_formulas_of_size K x\\<rbrakk>\n       \\<Longrightarrow> atoms F \\<subseteq> K", "case (less x)"], ["proof (state)\nthis:\n  \\<lbrakk>?y < x; ?F \\<in> all_formulas_of_size K ?y\\<rbrakk>\n  \\<Longrightarrow> atoms ?F \\<subseteq> K\n  F \\<in> all_formulas_of_size K x\n\ngoal (1 subgoal):\n 1. \\<And>x F.\n       \\<lbrakk>\\<And>y F.\n                   \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                   \\<Longrightarrow> atoms F \\<subseteq> K;\n        F \\<in> all_formulas_of_size K x\\<rbrakk>\n       \\<Longrightarrow> atoms F \\<subseteq> K", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>?y < x; ?F \\<in> all_formulas_of_size K ?y\\<rbrakk>\n  \\<Longrightarrow> atoms ?F \\<subseteq> K\n  F \\<in> all_formulas_of_size K x", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>?y < x; ?F \\<in> all_formulas_of_size K ?y\\<rbrakk>\n  \\<Longrightarrow> atoms ?F \\<subseteq> K\n  F \\<in> all_formulas_of_size K x\n\ngoal (1 subgoal):\n 1. atoms F \\<subseteq> K", "proof(cases x)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y F.\n                \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                \\<Longrightarrow> atoms F \\<subseteq> K;\n     F \\<in> all_formulas_of_size K x; x = 0\\<rbrakk>\n    \\<Longrightarrow> atoms F \\<subseteq> K\n 2. \\<And>nat.\n       \\<lbrakk>\\<And>y F.\n                   \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                   \\<Longrightarrow> atoms F \\<subseteq> K;\n        F \\<in> all_formulas_of_size K x; x = Suc nat\\<rbrakk>\n       \\<Longrightarrow> atoms F \\<subseteq> K", "case 0"], ["proof (state)\nthis:\n  x = 0\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y F.\n                \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                \\<Longrightarrow> atoms F \\<subseteq> K;\n     F \\<in> all_formulas_of_size K x; x = 0\\<rbrakk>\n    \\<Longrightarrow> atoms F \\<subseteq> K\n 2. \\<And>nat.\n       \\<lbrakk>\\<And>y F.\n                   \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                   \\<Longrightarrow> atoms F \\<subseteq> K;\n        F \\<in> all_formulas_of_size K x; x = Suc nat\\<rbrakk>\n       \\<Longrightarrow> atoms F \\<subseteq> K", "with less"], ["proof (chain)\npicking this:\n  \\<lbrakk>?y < x; ?F \\<in> all_formulas_of_size K ?y\\<rbrakk>\n  \\<Longrightarrow> atoms ?F \\<subseteq> K\n  F \\<in> all_formulas_of_size K x\n  x = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?y < x; ?F \\<in> all_formulas_of_size K ?y\\<rbrakk>\n  \\<Longrightarrow> atoms ?F \\<subseteq> K\n  F \\<in> all_formulas_of_size K x\n  x = 0\n\ngoal (1 subgoal):\n 1. atoms F \\<subseteq> K", "by force"], ["proof (state)\nthis:\n  atoms F \\<subseteq> K\n\ngoal (1 subgoal):\n 1. \\<And>nat.\n       \\<lbrakk>\\<And>y F.\n                   \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                   \\<Longrightarrow> atoms F \\<subseteq> K;\n        F \\<in> all_formulas_of_size K x; x = Suc nat\\<rbrakk>\n       \\<Longrightarrow> atoms F \\<subseteq> K", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>nat.\n       \\<lbrakk>\\<And>y F.\n                   \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                   \\<Longrightarrow> atoms F \\<subseteq> K;\n        F \\<in> all_formulas_of_size K x; x = Suc nat\\<rbrakk>\n       \\<Longrightarrow> atoms F \\<subseteq> K", "case (Suc y)"], ["proof (state)\nthis:\n  x = Suc y\n\ngoal (1 subgoal):\n 1. \\<And>nat.\n       \\<lbrakk>\\<And>y F.\n                   \\<lbrakk>y < x; F \\<in> all_formulas_of_size K y\\<rbrakk>\n                   \\<Longrightarrow> atoms F \\<subseteq> K;\n        F \\<in> all_formulas_of_size K x; x = Suc nat\\<rbrakk>\n       \\<Longrightarrow> atoms F \\<subseteq> K", "with less"], ["proof (chain)\npicking this:\n  \\<lbrakk>?y < x; ?F \\<in> all_formulas_of_size K ?y\\<rbrakk>\n  \\<Longrightarrow> atoms ?F \\<subseteq> K\n  F \\<in> all_formulas_of_size K x\n  x = Suc y", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?y < x; ?F \\<in> all_formulas_of_size K ?y\\<rbrakk>\n  \\<Longrightarrow> atoms ?F \\<subseteq> K\n  F \\<in> all_formulas_of_size K x\n  x = Suc y\n\ngoal (1 subgoal):\n 1. atoms F \\<subseteq> K", "by(simp only: all_formulas_of_size.simps Let_def) (fastforce simp add: less_Suc_eq split: if_splits)"], ["proof (state)\nthis:\n  atoms F \\<subseteq> K\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  atoms F \\<subseteq> K\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  atoms F \\<subseteq> K\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F \\<in> all_formulas_of_size K n \\<Longrightarrow>\n  size F \\<le> Suc n \\<and> atoms F \\<subseteq> K\n\ngoal (1 subgoal):\n 1. (F \\<in> all_formulas_of_size K n) =\n    (size F \\<le> Suc n \\<and> atoms F \\<subseteq> K)", "from lr rl"], ["proof (chain)\npicking this:\n  F \\<in> all_formulas_of_size K n \\<Longrightarrow>\n  size F \\<le> Suc n \\<and> atoms F \\<subseteq> K\n  size F \\<le> Suc n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K n", "show ?thesis"], ["proof (prove)\nusing this:\n  F \\<in> all_formulas_of_size K n \\<Longrightarrow>\n  size F \\<le> Suc n \\<and> atoms F \\<subseteq> K\n  size F \\<le> Suc n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n  F \\<in> all_formulas_of_size K n\n\ngoal (1 subgoal):\n 1. (F \\<in> all_formulas_of_size K n) =\n    (size F \\<le> Suc n \\<and> atoms F \\<subseteq> K)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. F \\<in> all_formulas_of_size K n \\<Longrightarrow>\n    F \\<in> all_formulas_of_size K n\n 2. size F \\<le> Suc n \\<and> atoms F \\<subseteq> K \\<Longrightarrow>\n    size F \\<le> Suc n \\<and> atoms F \\<subseteq> K", "qed"], ["proof (state)\nthis:\n  (F \\<in> all_formulas_of_size K n) =\n  (size F \\<le> Suc n \\<and> atoms F \\<subseteq> K)\n\ngoal:\nNo subgoals!", "qed"], ["", "(* At first I thought: why would I prove anything about all_formulas_of_size, I only want to test a conjecture with it.\n   Guess why: it was broken.\n   Granted, I spent too much time on this. *)"], ["", "end"]]}