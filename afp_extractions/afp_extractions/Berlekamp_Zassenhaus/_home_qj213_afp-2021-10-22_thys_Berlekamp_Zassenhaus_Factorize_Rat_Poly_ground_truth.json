{"file_name": "/home/qj213/afp-2021-10-22/thys/Berlekamp_Zassenhaus/Factorize_Rat_Poly.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Berlekamp_Zassenhaus", "problem_names": ["lemma prod_dvd_1_imp_all_dvd_1:\n  assumes \"finite X\" and \"prod f X dvd 1\" and \"x \\<in> X\" shows \"f x dvd 1\"", "lemma factorize_rat_poly_0[simp]: \"factorize_rat_poly_generic 0 = (0,[])\"", "lemma factorize_rat_poly:\n  assumes res: \"factorize_rat_poly_generic f = (c,fs)\"\n  shows \"square_free_factorization f (c,fs)\"\n    and \"(fi,i) \\<in> set fs \\<Longrightarrow> irreducible fi\""], "translations": [["", "lemma prod_dvd_1_imp_all_dvd_1:\n  assumes \"finite X\" and \"prod f X dvd 1\" and \"x \\<in> X\" shows \"f x dvd 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f x dvd (1::'b)", "proof (insert assms, induct rule:finite_induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>prod f {} dvd (1::'b); x \\<in> {}\\<rbrakk>\n    \\<Longrightarrow> f x dvd (1::'b)\n 2. \\<And>xa F.\n       \\<lbrakk>finite F; xa \\<notin> F;\n        \\<lbrakk>prod f F dvd (1::'b); x \\<in> F\\<rbrakk>\n        \\<Longrightarrow> f x dvd (1::'b);\n        prod f (insert xa F) dvd (1::'b); x \\<in> insert xa F\\<rbrakk>\n       \\<Longrightarrow> f x dvd (1::'b)", "case IH: (insert x' X)"], ["proof (state)\nthis:\n  finite X\n  x' \\<notin> X\n  \\<lbrakk>prod f X dvd (1::'b); x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> f x dvd (1::'b)\n  prod f (insert x' X) dvd (1::'b)\n  x \\<in> insert x' X\n\ngoal (2 subgoals):\n 1. \\<lbrakk>prod f {} dvd (1::'b); x \\<in> {}\\<rbrakk>\n    \\<Longrightarrow> f x dvd (1::'b)\n 2. \\<And>xa F.\n       \\<lbrakk>finite F; xa \\<notin> F;\n        \\<lbrakk>prod f F dvd (1::'b); x \\<in> F\\<rbrakk>\n        \\<Longrightarrow> f x dvd (1::'b);\n        prod f (insert xa F) dvd (1::'b); x \\<in> insert xa F\\<rbrakk>\n       \\<Longrightarrow> f x dvd (1::'b)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. f x dvd (1::'b)", "proof (cases \"x = x'\")"], ["proof (state)\ngoal (2 subgoals):\n 1. x = x' \\<Longrightarrow> f x dvd (1::'b)\n 2. x \\<noteq> x' \\<Longrightarrow> f x dvd (1::'b)", "case True"], ["proof (state)\nthis:\n  x = x'\n\ngoal (2 subgoals):\n 1. x = x' \\<Longrightarrow> f x dvd (1::'b)\n 2. x \\<noteq> x' \\<Longrightarrow> f x dvd (1::'b)", "with IH"], ["proof (chain)\npicking this:\n  finite X\n  x' \\<notin> X\n  \\<lbrakk>prod f X dvd (1::'b); x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> f x dvd (1::'b)\n  prod f (insert x' X) dvd (1::'b)\n  x \\<in> insert x' X\n  x = x'", "show ?thesis"], ["proof (prove)\nusing this:\n  finite X\n  x' \\<notin> X\n  \\<lbrakk>prod f X dvd (1::'b); x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> f x dvd (1::'b)\n  prod f (insert x' X) dvd (1::'b)\n  x \\<in> insert x' X\n  x = x'\n\ngoal (1 subgoal):\n 1. f x dvd (1::'b)", "using  dvd_trans[of \"f x'\" \"f x' * _\" 1]"], ["proof (prove)\nusing this:\n  finite X\n  x' \\<notin> X\n  \\<lbrakk>prod f X dvd (1::'b); x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> f x dvd (1::'b)\n  prod f (insert x' X) dvd (1::'b)\n  x \\<in> insert x' X\n  x = x'\n  \\<lbrakk>f x' dvd f x' * ?uu3; f x' * ?uu3 dvd (1::'b)\\<rbrakk>\n  \\<Longrightarrow> f x' dvd (1::'b)\n\ngoal (1 subgoal):\n 1. f x dvd (1::'b)", "by (metis dvd_triv_left prod.insert)"], ["proof (state)\nthis:\n  f x dvd (1::'b)\n\ngoal (1 subgoal):\n 1. x \\<noteq> x' \\<Longrightarrow> f x dvd (1::'b)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<noteq> x' \\<Longrightarrow> f x dvd (1::'b)", "case False"], ["proof (state)\nthis:\n  x \\<noteq> x'\n\ngoal (1 subgoal):\n 1. x \\<noteq> x' \\<Longrightarrow> f x dvd (1::'b)", "then"], ["proof (chain)\npicking this:\n  x \\<noteq> x'", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<noteq> x'\n\ngoal (1 subgoal):\n 1. f x dvd (1::'b)", "using IH"], ["proof (prove)\nusing this:\n  x \\<noteq> x'\n  finite X\n  x' \\<notin> X\n  \\<lbrakk>prod f X dvd (1::'b); x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> f x dvd (1::'b)\n  prod f (insert x' X) dvd (1::'b)\n  x \\<in> insert x' X\n\ngoal (1 subgoal):\n 1. f x dvd (1::'b)", "by (auto intro!: IH(3) dvd_trans[of \"prod f X\" \"_ * prod f X\" 1])"], ["proof (state)\nthis:\n  f x dvd (1::'b)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f x dvd (1::'b)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>prod f {} dvd (1::'b); x \\<in> {}\\<rbrakk>\n    \\<Longrightarrow> f x dvd (1::'b)", "qed simp"], ["", "context\n  fixes alg :: int_poly_factorization_algorithm\nbegin"], ["", "definition factorize_rat_poly_generic :: \"rat poly \\<Rightarrow> rat \\<times> (rat poly \\<times> nat) list\" where\n  \"factorize_rat_poly_generic f = (case rat_to_normalized_int_poly f of\n     (c,g) \\<Rightarrow> case factorize_int_poly_generic alg g of (d,fs) \\<Rightarrow> (c * rat_of_int d, \n     map (\\<lambda> (fi,i). (map_poly rat_of_int fi, i)) fs))\""], ["", "lemma factorize_rat_poly_0[simp]: \"factorize_rat_poly_generic 0 = (0,[])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. local.factorize_rat_poly_generic 0 = (0, [])", "unfolding factorize_rat_poly_generic_def rat_to_normalized_int_poly_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (case if 0 = 0 then (1, 0)\n          else case rat_to_int_poly 0 of\n               (s, q) \\<Rightarrow>\n                 (rat_of_int (content q) / rat_of_int s,\n                  primitive_part q) of\n     (c, g) \\<Rightarrow>\n       case factorize_int_poly_generic alg g of\n       (d, fs) \\<Rightarrow>\n         (c * rat_of_int d,\n          map (\\<lambda>(fi, y). (of_int_poly fi, y)) fs)) =\n    (0, [])", "by simp"], ["", "lemma factorize_rat_poly:\n  assumes res: \"factorize_rat_poly_generic f = (c,fs)\"\n  shows \"square_free_factorization f (c,fs)\"\n    and \"(fi,i) \\<in> set fs \\<Longrightarrow> irreducible fi\""], ["proof (prove)\ngoal (1 subgoal):\n 1. square_free_factorization f (c, fs) &&&\n    ((fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi)", "proof(atomize(full), cases \"f=0\", goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. f = 0 \\<Longrightarrow>\n    square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)\n 2. f \\<noteq> 0 \\<Longrightarrow>\n    square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)", "case 1"], ["proof (state)\nthis:\n  f = 0\n\ngoal (2 subgoals):\n 1. f = 0 \\<Longrightarrow>\n    square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)\n 2. f \\<noteq> 0 \\<Longrightarrow>\n    square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)", "with res"], ["proof (chain)\npicking this:\n  local.factorize_rat_poly_generic f = (c, fs)\n  f = 0", "show ?case"], ["proof (prove)\nusing this:\n  local.factorize_rat_poly_generic f = (c, fs)\n  f = 0\n\ngoal (1 subgoal):\n 1. square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)", "by (auto simp: square_free_factorization_def)"], ["proof (state)\nthis:\n  square_free_factorization f (c, fs) \\<and>\n  ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)\n\ngoal (1 subgoal):\n 1. f \\<noteq> 0 \\<Longrightarrow>\n    square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f \\<noteq> 0 \\<Longrightarrow>\n    square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)", "case 2"], ["proof (state)\nthis:\n  f \\<noteq> 0\n\ngoal (1 subgoal):\n 1. f \\<noteq> 0 \\<Longrightarrow>\n    square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. square_free_factorization f (c, fs) \\<and>\n    ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)", "proof (unfold square_free_factorization_def split, intro conjI impI allI)"], ["proof (state)\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "let ?r = rat_of_int"], ["proof (state)\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "let ?rp = \"map_poly ?r\""], ["proof (state)\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "obtain d g where ri: \"rat_to_normalized_int_poly f = (d,g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>d g.\n        rat_to_normalized_int_poly f = (d, g) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  rat_to_normalized_int_poly f = (d, g)\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "obtain e gs where fi: \"factorize_int_poly_generic alg g = (e,gs)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>e gs.\n        factorize_int_poly_generic alg g = (e, gs) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  factorize_int_poly_generic alg g = (e, gs)\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "from res[unfolded factorize_rat_poly_generic_def ri fi split]"], ["proof (chain)\npicking this:\n  (d * rat_of_int e, map (\\<lambda>(fi, y). (of_int_poly fi, y)) gs) =\n  (c, fs)", "have c: \"c = d * ?r e\" and fs: \"fs = map (\\<lambda> (fi,i). (?rp fi, i)) gs\""], ["proof (prove)\nusing this:\n  (d * rat_of_int e, map (\\<lambda>(fi, y). (of_int_poly fi, y)) gs) =\n  (c, fs)\n\ngoal (1 subgoal):\n 1. c = d * rat_of_int e &&&\n    fs = map (\\<lambda>(fi, i). (of_int_poly fi, i)) gs", "by auto"], ["proof (state)\nthis:\n  c = d * rat_of_int e\n  fs = map (\\<lambda>(fi, i). (of_int_poly fi, i)) gs\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "from factorize_int_poly[OF fi]"], ["proof (chain)\npicking this:\n  square_free_factorization g (e, gs)\n  (?fi, ?i) \\<in> set gs \\<Longrightarrow> irreducible ?fi\n  (?fi, ?i) \\<in> set gs \\<Longrightarrow> degree ?fi \\<noteq> 0", "have irr: \"(fi, i) \\<in> set gs \\<Longrightarrow> irreducible fi \\<and> content fi = 1\" for fi i"], ["proof (prove)\nusing this:\n  square_free_factorization g (e, gs)\n  (?fi, ?i) \\<in> set gs \\<Longrightarrow> irreducible ?fi\n  (?fi, ?i) \\<in> set gs \\<Longrightarrow> degree ?fi \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (fi, i) \\<in> set gs \\<Longrightarrow>\n    irreducible fi \\<and> content fi = 1", "using irreducible_imp_primitive[of fi]"], ["proof (prove)\nusing this:\n  square_free_factorization g (e, gs)\n  (?fi, ?i) \\<in> set gs \\<Longrightarrow> irreducible ?fi\n  (?fi, ?i) \\<in> set gs \\<Longrightarrow> degree ?fi \\<noteq> 0\n  \\<lbrakk>irreducible fi; degree fi \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> primitive fi\n\ngoal (1 subgoal):\n 1. (fi, i) \\<in> set gs \\<Longrightarrow>\n    irreducible fi \\<and> content fi = 1", "by auto"], ["proof (state)\nthis:\n  (?fi, ?i) \\<in> set gs \\<Longrightarrow>\n  irreducible ?fi \\<and> content ?fi = 1\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "note sff = factorize_int_poly(1)[OF fi]"], ["proof (state)\nthis:\n  square_free_factorization g (e, gs)\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "note sff' = square_free_factorizationD[OF sff]"], ["proof (state)\nthis:\n  g = Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i)\n  (?a, ?i) \\<in> set gs \\<Longrightarrow>\n  square_free ?a \\<and> degree ?a \\<noteq> 0\n  \\<lbrakk>(?a, ?i) \\<in> set gs; (?b, ?j) \\<in> set gs;\n   (?a, ?i) \\<noteq> (?b, ?j)\\<rbrakk>\n  \\<Longrightarrow> algebraic_semidom_class.coprime ?a ?b\n  g = 0 \\<Longrightarrow> e = 0 \\<and> gs = []\n  distinct gs\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "{"], ["proof (state)\nthis:\n  g = Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i)\n  (?a, ?i) \\<in> set gs \\<Longrightarrow>\n  square_free ?a \\<and> degree ?a \\<noteq> 0\n  \\<lbrakk>(?a, ?i) \\<in> set gs; (?b, ?j) \\<in> set gs;\n   (?a, ?i) \\<noteq> (?b, ?j)\\<rbrakk>\n  \\<Longrightarrow> algebraic_semidom_class.coprime ?a ?b\n  g = 0 \\<Longrightarrow> e = 0 \\<and> gs = []\n  distinct gs\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "fix n f"], ["proof (state)\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "have \"?rp (f ^ n) = (?rp f) ^ n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_int_poly (f ^ n) = of_int_poly f ^ n", "by (induct n, auto simp: hom_distribs)"], ["proof (state)\nthis:\n  of_int_poly (f ^ n) = of_int_poly f ^ n\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "}"], ["proof (state)\nthis:\n  of_int_poly (?fa2 ^ ?n2) = of_int_poly ?fa2 ^ ?n2\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "note exp = this"], ["proof (state)\nthis:\n  of_int_poly (?fa2 ^ ?n2) = of_int_poly ?fa2 ^ ?n2\n\ngoal (8 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. distinct fs\n 8. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "show dist: \"distinct fs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distinct fs", "using sff'(5)"], ["proof (prove)\nusing this:\n  distinct gs\n\ngoal (1 subgoal):\n 1. distinct fs", "unfolding fs distinct_map inj_on_def"], ["proof (prove)\nusing this:\n  distinct gs\n\ngoal (1 subgoal):\n 1. distinct gs \\<and>\n    (\\<forall>x\\<in>set gs.\n        \\<forall>y\\<in>set gs.\n           (case x of (fi, x) \\<Rightarrow> (of_int_poly fi, x)) =\n           (case y of\n            (fi, x) \\<Rightarrow> (of_int_poly fi, x)) \\<longrightarrow>\n           x = y)", "by auto"], ["proof (state)\nthis:\n  distinct fs\n\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "interpret mh: map_poly_inj_idom_hom rat_of_int"], ["proof (prove)\ngoal (1 subgoal):\n 1. map_poly_inj_idom_hom rat_of_int", ".."], ["proof (state)\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "have \"f = smult d (?rp g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f = Polynomial.smult d (of_int_poly g)", "using rat_to_normalized_int_poly[OF ri]"], ["proof (prove)\nusing this:\n  f = Polynomial.smult d (of_int_poly g)\n  0 < d\n  f \\<noteq> 0 \\<Longrightarrow> content g = 1\n  degree g = degree f\n\ngoal (1 subgoal):\n 1. f = Polynomial.smult d (of_int_poly g)", "by auto"], ["proof (state)\nthis:\n  f = Polynomial.smult d (of_int_poly g)\n\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "also"], ["proof (state)\nthis:\n  f = Polynomial.smult d (of_int_poly g)\n\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "have \"\\<dots> = smult d (?rp (smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Polynomial.smult d (of_int_poly g) =\n    Polynomial.smult d\n     (of_int_poly\n       (Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i)))", "using sff'(1)"], ["proof (prove)\nusing this:\n  g = Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i)\n\ngoal (1 subgoal):\n 1. Polynomial.smult d (of_int_poly g) =\n    Polynomial.smult d\n     (of_int_poly\n       (Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i)))", "by simp"], ["proof (state)\nthis:\n  Polynomial.smult d (of_int_poly g) =\n  Polynomial.smult d\n   (of_int_poly (Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i)))\n\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "also"], ["proof (state)\nthis:\n  Polynomial.smult d (of_int_poly g) =\n  Polynomial.smult d\n   (of_int_poly (Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i)))\n\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "have \"\\<dots> = smult c (?rp (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Polynomial.smult d\n     (of_int_poly\n       (Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))) =\n    Polynomial.smult c (of_int_poly (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))", "unfolding c"], ["proof (prove)\ngoal (1 subgoal):\n 1. Polynomial.smult d\n     (of_int_poly\n       (Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))) =\n    Polynomial.smult (d * rat_of_int e)\n     (of_int_poly (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))", "by (simp add: hom_distribs)"], ["proof (state)\nthis:\n  Polynomial.smult d\n   (of_int_poly\n     (Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))) =\n  Polynomial.smult c (of_int_poly (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))\n\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "also"], ["proof (state)\nthis:\n  Polynomial.smult d\n   (of_int_poly\n     (Polynomial.smult e (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))) =\n  Polynomial.smult c (of_int_poly (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i))\n\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "have \"?rp (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i) = (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_int_poly (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i) =\n    (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)", "unfolding prod.distinct_set_conv_list[OF sff'(5)] prod.distinct_set_conv_list[OF dist]"], ["proof (prove)\ngoal (1 subgoal):\n 1. of_int_poly (\\<Prod>(a, i)\\<leftarrow>gs. a ^ Suc i) =\n    (\\<Prod>(a, i)\\<leftarrow>fs. a ^ Suc i)", "unfolding fs"], ["proof (prove)\ngoal (1 subgoal):\n 1. of_int_poly (\\<Prod>(a, i)\\<leftarrow>gs. a ^ Suc i) =\n    (\\<Prod>(a,\n        i)\\<leftarrow>map (\\<lambda>(fi, y). (of_int_poly fi, y))\n                       gs. a ^ Suc i)", "by (insert exp, auto intro!: arg_cong[of _ _ \"\\<lambda>x. prod_list (map x gs)\"] simp: hom_distribs of_int_poly_hom.hom_prod_list)"], ["proof (state)\nthis:\n  of_int_poly (\\<Prod>(a, i)\\<in>set gs. a ^ Suc i) =\n  (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n\ngoal (7 subgoals):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n 2. f = 0 \\<Longrightarrow> c = 0\n 3. f = 0 \\<Longrightarrow> fs = []\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 5. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 6. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 7. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "finally"], ["proof (chain)\npicking this:\n  f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)", "show f: \"f = smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\""], ["proof (prove)\nusing this:\n  f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n\ngoal (1 subgoal):\n 1. f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)", "by auto"], ["proof (state)\nthis:\n  f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "{"], ["proof (state)\nthis:\n  f = Polynomial.smult c (\\<Prod>(a, i)\\<in>set fs. a ^ Suc i)\n\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "fix a i"], ["proof (state)\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "assume ai: \"(a,i) \\<in> set fs\""], ["proof (state)\nthis:\n  (a, i) \\<in> set fs\n\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "from ai"], ["proof (chain)\npicking this:\n  (a, i) \\<in> set fs", "obtain A where a: \"a = ?rp A\" and A: \"(A,i) \\<in> set gs\""], ["proof (prove)\nusing this:\n  (a, i) \\<in> set fs\n\ngoal (1 subgoal):\n 1. (\\<And>A.\n        \\<lbrakk>a = of_int_poly A; (A, i) \\<in> set gs\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding fs"], ["proof (prove)\nusing this:\n  (a, i) \\<in> set (map (\\<lambda>(fi, y). (of_int_poly fi, y)) gs)\n\ngoal (1 subgoal):\n 1. (\\<And>A.\n        \\<lbrakk>a = of_int_poly A; (A, i) \\<in> set gs\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  a = of_int_poly A\n  (A, i) \\<in> set gs\n\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "fix b j"], ["proof (state)\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "assume \"(b,j) \\<in> set fs\" and diff: \"(a,i) \\<noteq> (b,j)\""], ["proof (state)\nthis:\n  (b, j) \\<in> set fs\n  (a, i) \\<noteq> (b, j)\n\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "from this(1)"], ["proof (chain)\npicking this:\n  (b, j) \\<in> set fs", "obtain B where b: \"b = ?rp B\" and B: \"(B,j) \\<in> set gs\""], ["proof (prove)\nusing this:\n  (b, j) \\<in> set fs\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>b = of_int_poly B; (B, j) \\<in> set gs\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding fs"], ["proof (prove)\nusing this:\n  (b, j) \\<in> set (map (\\<lambda>(fi, y). (of_int_poly fi, y)) gs)\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>b = of_int_poly B; (B, j) \\<in> set gs\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  b = of_int_poly B\n  (B, j) \\<in> set gs\n\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "from diff[unfolded a b]"], ["proof (chain)\npicking this:\n  (of_int_poly A, i) \\<noteq> (of_int_poly B, j)", "have \"(A,i) \\<noteq> (B,j)\""], ["proof (prove)\nusing this:\n  (of_int_poly A, i) \\<noteq> (of_int_poly B, j)\n\ngoal (1 subgoal):\n 1. (A, i) \\<noteq> (B, j)", "by auto"], ["proof (state)\nthis:\n  (A, i) \\<noteq> (B, j)\n\ngoal (6 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. \\<And>a i b j.\n       \\<lbrakk>(a, i) \\<in> set fs; (b, j) \\<in> set fs;\n        (a, i) \\<noteq> (b, j)\\<rbrakk>\n       \\<Longrightarrow> algebraic_semidom_class.coprime a b\n 6. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "from sff'(3)[OF A B this]"], ["proof (chain)\npicking this:\n  algebraic_semidom_class.coprime A B", "show \"Rings.coprime a b\""], ["proof (prove)\nusing this:\n  algebraic_semidom_class.coprime A B\n\ngoal (1 subgoal):\n 1. algebraic_semidom_class.coprime a b", "by (auto simp add: coprime_iff_gcd_eq_1 gcd_rat_to_gcd_int a b)"], ["proof (state)\nthis:\n  algebraic_semidom_class.coprime a b\n\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "}"], ["proof (state)\nthis:\n  \\<lbrakk>(?a2, ?ia2) \\<in> set fs; (?b2, ?j2) \\<in> set fs;\n   (?a2, ?ia2) \\<noteq> (?b2, ?j2)\\<rbrakk>\n  \\<Longrightarrow> algebraic_semidom_class.coprime ?a2 ?b2\n\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "{"], ["proof (state)\nthis:\n  \\<lbrakk>(?a2, ?ia2) \\<in> set fs; (?b2, ?j2) \\<in> set fs;\n   (?a2, ?ia2) \\<noteq> (?b2, ?j2)\\<rbrakk>\n  \\<Longrightarrow> algebraic_semidom_class.coprime ?a2 ?b2\n\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "fix fi i"], ["proof (state)\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "assume \"(fi,i) \\<in> set fs\""], ["proof (state)\nthis:\n  (fi, i) \\<in> set fs\n\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "then"], ["proof (chain)\npicking this:\n  (fi, i) \\<in> set fs", "obtain gi where fi: \"fi = ?rp gi\" and gi: \"(gi,i) \\<in> set gs\""], ["proof (prove)\nusing this:\n  (fi, i) \\<in> set fs\n\ngoal (1 subgoal):\n 1. (\\<And>gi.\n        \\<lbrakk>fi = of_int_poly gi; (gi, i) \\<in> set gs\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding fs"], ["proof (prove)\nusing this:\n  (fi, i) \\<in> set (map (\\<lambda>(fi, y). (of_int_poly fi, y)) gs)\n\ngoal (1 subgoal):\n 1. (\\<And>gi.\n        \\<lbrakk>fi = of_int_poly gi; (gi, i) \\<in> set gs\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  fi = of_int_poly gi\n  (gi, i) \\<in> set gs\n\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "from irr[OF gi]"], ["proof (chain)\npicking this:\n  irreducible gi \\<and> content gi = 1", "have cf_gi: \"primitive gi\""], ["proof (prove)\nusing this:\n  irreducible gi \\<and> content gi = 1\n\ngoal (1 subgoal):\n 1. primitive gi", "by auto"], ["proof (state)\nthis:\n  primitive gi\n\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "then"], ["proof (chain)\npicking this:\n  primitive gi", "have \"primitive (?rp gi)\""], ["proof (prove)\nusing this:\n  primitive gi\n\ngoal (1 subgoal):\n 1. primitive (of_int_poly gi)", "by (auto simp: content_field_poly)"], ["proof (state)\nthis:\n  primitive (of_int_poly gi)\n\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "note [simp] = irreducible_primitive_connect[OF cf_gi] irreducible_primitive_connect[OF this]"], ["proof (state)\nthis:\n  irreducible\\<^sub>d gi = irreducible gi\n  irreducible\\<^sub>d (of_int_poly gi) = irreducible (of_int_poly gi)\n\ngoal (5 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a\n 5. (fi, i) \\<in> set fs \\<Longrightarrow> irreducible fi", "show \"irreducible fi\""], ["proof (prove)\ngoal (1 subgoal):\n 1. irreducible fi", "using irr[OF gi] fi irreducible\\<^sub>d_int_rat[of gi,simplified]"], ["proof (prove)\nusing this:\n  irreducible gi \\<and> content gi = 1\n  fi = of_int_poly gi\n  irreducible gi \\<Longrightarrow> irreducible (of_int_poly gi)\n\ngoal (1 subgoal):\n 1. irreducible fi", "by auto"], ["proof (state)\nthis:\n  irreducible fi\n\ngoal (4 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []\n 3. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> square_free a\n 4. \\<And>a i. (a, i) \\<in> set fs \\<Longrightarrow> 0 < degree a", "then"], ["proof (chain)\npicking this:\n  irreducible fi", "show \"degree fi > 0\" \"square_free fi\""], ["proof (prove)\nusing this:\n  irreducible fi\n\ngoal (1 subgoal):\n 1. 0 < degree fi &&& square_free fi", "unfolding fi"], ["proof (prove)\nusing this:\n  irreducible (of_int_poly gi)\n\ngoal (1 subgoal):\n 1. 0 < degree (of_int_poly gi) &&& square_free (of_int_poly gi)", "by (auto intro: irreducible_imp_square_free)"], ["proof (state)\nthis:\n  0 < degree fi\n  square_free fi\n\ngoal (2 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []", "}"], ["proof (state)\nthis:\n  (?fia2, ?ia2) \\<in> set fs \\<Longrightarrow> 0 < degree ?fia2\n  (?fia2, ?ia2) \\<in> set fs \\<Longrightarrow> square_free ?fia2\n\ngoal (2 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []", "{"], ["proof (state)\nthis:\n  (?fia2, ?ia2) \\<in> set fs \\<Longrightarrow> 0 < degree ?fia2\n  (?fia2, ?ia2) \\<in> set fs \\<Longrightarrow> square_free ?fia2\n\ngoal (2 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []", "assume \"f = 0\""], ["proof (state)\nthis:\n  f = 0\n\ngoal (2 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []", "with ri"], ["proof (chain)\npicking this:\n  rat_to_normalized_int_poly f = (d, g)\n  f = 0", "have *: \"d = 1\" \"g = 0\""], ["proof (prove)\nusing this:\n  rat_to_normalized_int_poly f = (d, g)\n  f = 0\n\ngoal (1 subgoal):\n 1. d = 1 &&& g = 0", "unfolding rat_to_normalized_int_poly_def"], ["proof (prove)\nusing this:\n  (if f = 0 then (1, 0)\n   else case rat_to_int_poly f of\n        (s, q) \\<Rightarrow>\n          (rat_of_int (content q) / rat_of_int s, primitive_part q)) =\n  (d, g)\n  f = 0\n\ngoal (1 subgoal):\n 1. d = 1 &&& g = 0", "by auto"], ["proof (state)\nthis:\n  d = 1\n  g = 0\n\ngoal (2 subgoals):\n 1. f = 0 \\<Longrightarrow> c = 0\n 2. f = 0 \\<Longrightarrow> fs = []", "with sff'(4)[OF *(2)]"], ["proof (chain)\npicking this:\n  e = 0 \\<and> gs = []\n  d = 1\n  g = 0", "show \"c = 0\" \"fs = []\""], ["proof (prove)\nusing this:\n  e = 0 \\<and> gs = []\n  d = 1\n  g = 0\n\ngoal (1 subgoal):\n 1. c = 0 &&& fs = []", "unfolding c fs"], ["proof (prove)\nusing this:\n  e = 0 \\<and> gs = []\n  d = 1\n  g = 0\n\ngoal (1 subgoal):\n 1. d * rat_of_int e = 0 &&&\n    map (\\<lambda>(fi, y). (of_int_poly fi, y)) gs = []", "by auto"], ["proof (state)\nthis:\n  c = 0\n  fs = []\n\ngoal:\nNo subgoals!", "}"], ["proof (state)\nthis:\n  f = 0 \\<Longrightarrow> c = 0\n  f = 0 \\<Longrightarrow> fs = []\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  square_free_factorization f (c, fs) \\<and>\n  ((fi, i) \\<in> set fs \\<longrightarrow> irreducible fi)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "abbreviation factorize_rat_poly where \n  \"factorize_rat_poly \\<equiv> factorize_rat_poly_generic berlekamp_zassenhaus_factorization_algorithm\""], ["", "end"]]}