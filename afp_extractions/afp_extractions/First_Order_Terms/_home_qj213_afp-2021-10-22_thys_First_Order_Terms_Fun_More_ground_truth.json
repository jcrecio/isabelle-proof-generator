{"file_name": "/home/qj213/afp-2021-10-22/thys/First_Order_Terms/Fun_More.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/First_Order_Terms", "problem_names": ["lemma finite_card_eq_imp_bij_betw:\n  assumes \"finite A\"\n    and \"card (f ` A) = card A\"\n  shows \"bij_betw f A (f ` A)\"", "lemma bij_betw_extend:\n  assumes *: \"bij_betw f A B\"\n    and \"A \\<subseteq> V\"\n    and \"B \\<subseteq> V\"\n    and \"finite A\"\n  shows \"\\<exists>g. finite {x. g x \\<noteq> x} \\<and>\n    (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n    (\\<forall>x\\<in>A. g x = f x) \\<and>\n    bij_betw g V V\"", "lemma fun_merge_eq_nth:\n  assumes i: \"i < length as\"\n    and a: \"a \\<in> as ! i\"\n    and ident: \"\\<And> i j a. i < length as \\<Longrightarrow> j < length as \\<Longrightarrow> a \\<in> as ! i \\<Longrightarrow> a \\<in> as ! j \\<Longrightarrow> (fs ! i) a = (fs ! j) a\"\n  shows \"fun_merge fs as a = (fs ! i) a\"", "lemma fun_merge_part:\n  assumes \"\\<forall>i<length as.\\<forall>j<length as. i \\<noteq> j \\<longrightarrow> as ! i \\<inter> as ! j = {}\"\n    and \"i < length as\"\n    and \"a \\<in> as ! i\"\n  shows \"fun_merge fs as a = (fs ! i) a\"", "lemma fun_merge:\n  assumes part: \"\\<forall>i<length Xs.\\<forall>j<length Xs. i \\<noteq> j \\<longrightarrow> Xs ! i \\<inter> Xs ! j = {}\"\n  shows \"\\<exists>\\<sigma>. \\<forall>i<length Xs. \\<forall>x\\<in> Xs ! i. \\<sigma> x = \\<tau> i x\""], "translations": [["", "lemma finite_card_eq_imp_bij_betw:\n  assumes \"finite A\"\n    and \"card (f ` A) = card A\"\n  shows \"bij_betw f A (f ` A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw f A (f ` A)", "using \\<open>card (f ` A) = card A\\<close>"], ["proof (prove)\nusing this:\n  card (f ` A) = card A\n\ngoal (1 subgoal):\n 1. bij_betw f A (f ` A)", "unfolding inj_on_iff_eq_card [OF \\<open>finite A\\<close>, symmetric]"], ["proof (prove)\nusing this:\n  inj_on f A\n\ngoal (1 subgoal):\n 1. bij_betw f A (f ` A)", "by (rule inj_on_imp_bij_betw)"], ["", "text \\<open>Every bijective function between two subsets of a set can be turned\ninto a compatible renaming (with finite domain) on the full set.\\<close>"], ["", "lemma bij_betw_extend:\n  assumes *: \"bij_betw f A B\"\n    and \"A \\<subseteq> V\"\n    and \"B \\<subseteq> V\"\n    and \"finite A\"\n  shows \"\\<exists>g. finite {x. g x \\<noteq> x} \\<and>\n    (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n    (\\<forall>x\\<in>A. g x = f x) \\<and>\n    bij_betw g V V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B", "using assms"], ["proof (prove)\nusing this:\n  bij_betw f A B\n  A \\<subseteq> V\n  B \\<subseteq> V\n  finite A\n\ngoal (1 subgoal):\n 1. finite B", "by (metis bij_betw_finite)"], ["proof (state)\nthis:\n  finite B\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have [simp]: \"card A = card B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card A = card B", "by (metis * bij_betw_same_card)"], ["proof (state)\nthis:\n  card A = card B\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"card (A - B) = card (B - A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (A - B) = card (B - A)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card (A - B) = card (B - A)", "have \"card (A - B) = card A - card (A \\<inter> B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (A - B) = card A - card (A \\<inter> B)", "by (metis \\<open>finite A\\<close> card_Diff_subset_Int finite_Int)"], ["proof (state)\nthis:\n  card (A - B) = card A - card (A \\<inter> B)\n\ngoal (1 subgoal):\n 1. card (A - B) = card (B - A)", "moreover"], ["proof (state)\nthis:\n  card (A - B) = card A - card (A \\<inter> B)\n\ngoal (1 subgoal):\n 1. card (A - B) = card (B - A)", "have \"card (B - A) = card B - card (A \\<inter> B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (B - A) = card B - card (A \\<inter> B)", "by (metis \\<open>finite A\\<close> card_Diff_subset_Int finite_Int inf_commute)"], ["proof (state)\nthis:\n  card (B - A) = card B - card (A \\<inter> B)\n\ngoal (1 subgoal):\n 1. card (A - B) = card (B - A)", "ultimately"], ["proof (chain)\npicking this:\n  card (A - B) = card A - card (A \\<inter> B)\n  card (B - A) = card B - card (A \\<inter> B)", "show ?thesis"], ["proof (prove)\nusing this:\n  card (A - B) = card A - card (A \\<inter> B)\n  card (B - A) = card B - card (A \\<inter> B)\n\ngoal (1 subgoal):\n 1. card (A - B) = card (B - A)", "by simp"], ["proof (state)\nthis:\n  card (A - B) = card (B - A)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  card (A - B) = card (B - A)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "then"], ["proof (chain)\npicking this:\n  card (A - B) = card (B - A)", "obtain g where **: \"bij_betw g (B - A) (A - B)\""], ["proof (prove)\nusing this:\n  card (A - B) = card (B - A)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        bij_betw g (B - A) (A - B) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (metis \\<open>finite A\\<close> \\<open>finite B\\<close> bij_betw_iff_card finite_Diff)"], ["proof (state)\nthis:\n  bij_betw g (B - A) (A - B)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "define h where \"h = (\\<lambda>x. if x \\<in> A then f x else if x \\<in> B - A then g x else x)\""], ["proof (state)\nthis:\n  h =\n  (\\<lambda>x. if x \\<in> A then f x else if x \\<in> B - A then g x else x)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"bij_betw h A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw h A B", "by (metis (full_types) * bij_betw_cong h_def)"], ["proof (state)\nthis:\n  bij_betw h A B\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  bij_betw h A B\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"bij_betw h (V - (A \\<union> B)) (V - (A \\<union> B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw h (V - (A \\<union> B)) (V - (A \\<union> B))", "by (auto simp: bij_betw_def h_def inj_on_def)"], ["proof (state)\nthis:\n  bij_betw h (V - (A \\<union> B)) (V - (A \\<union> B))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  bij_betw h (V - (A \\<union> B)) (V - (A \\<union> B))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"B \\<inter> (V - (A \\<union> B)) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<inter> (V - (A \\<union> B)) = {}", "by blast"], ["proof (state)\nthis:\n  B \\<inter> (V - (A \\<union> B)) = {}\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "ultimately"], ["proof (chain)\npicking this:\n  bij_betw h A B\n  bij_betw h (V - (A \\<union> B)) (V - (A \\<union> B))\n  B \\<inter> (V - (A \\<union> B)) = {}", "have \"bij_betw h (A \\<union> (V - (A \\<union> B))) (B \\<union> (V - (A \\<union> B)))\""], ["proof (prove)\nusing this:\n  bij_betw h A B\n  bij_betw h (V - (A \\<union> B)) (V - (A \\<union> B))\n  B \\<inter> (V - (A \\<union> B)) = {}\n\ngoal (1 subgoal):\n 1. bij_betw h (A \\<union> (V - (A \\<union> B)))\n     (B \\<union> (V - (A \\<union> B)))", "by (rule bij_betw_combine)"], ["proof (state)\nthis:\n  bij_betw h (A \\<union> (V - (A \\<union> B)))\n   (B \\<union> (V - (A \\<union> B)))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  bij_betw h (A \\<union> (V - (A \\<union> B)))\n   (B \\<union> (V - (A \\<union> B)))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"A \\<union> (V - (A \\<union> B)) = V - (B - A)\"\n    and \"B \\<union> (V - (A \\<union> B)) = V - (A - B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<union> (V - (A \\<union> B)) = V - (B - A) &&&\n    B \\<union> (V - (A \\<union> B)) = V - (A - B)", "using \\<open>A \\<subseteq> V\\<close> and \\<open>B \\<subseteq> V\\<close>"], ["proof (prove)\nusing this:\n  A \\<subseteq> V\n  B \\<subseteq> V\n\ngoal (1 subgoal):\n 1. A \\<union> (V - (A \\<union> B)) = V - (B - A) &&&\n    B \\<union> (V - (A \\<union> B)) = V - (A - B)", "by blast+"], ["proof (state)\nthis:\n  A \\<union> (V - (A \\<union> B)) = V - (B - A)\n  B \\<union> (V - (A \\<union> B)) = V - (A - B)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "ultimately"], ["proof (chain)\npicking this:\n  bij_betw h (A \\<union> (V - (A \\<union> B)))\n   (B \\<union> (V - (A \\<union> B)))\n  A \\<union> (V - (A \\<union> B)) = V - (B - A)\n  B \\<union> (V - (A \\<union> B)) = V - (A - B)", "have \"bij_betw h (V - (B - A)) (V - (A - B))\""], ["proof (prove)\nusing this:\n  bij_betw h (A \\<union> (V - (A \\<union> B)))\n   (B \\<union> (V - (A \\<union> B)))\n  A \\<union> (V - (A \\<union> B)) = V - (B - A)\n  B \\<union> (V - (A \\<union> B)) = V - (A - B)\n\ngoal (1 subgoal):\n 1. bij_betw h (V - (B - A)) (V - (A - B))", "by simp"], ["proof (state)\nthis:\n  bij_betw h (V - (B - A)) (V - (A - B))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  bij_betw h (V - (B - A)) (V - (A - B))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"bij_betw h (B - A) (A - B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw h (B - A) (A - B)", "using **"], ["proof (prove)\nusing this:\n  bij_betw g (B - A) (A - B)\n\ngoal (1 subgoal):\n 1. bij_betw h (B - A) (A - B)", "by (auto simp: bij_betw_def h_def inj_on_def)"], ["proof (state)\nthis:\n  bij_betw h (B - A) (A - B)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  bij_betw h (B - A) (A - B)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"(V - (A - B)) \\<inter> (A - B) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (V - (A - B)) \\<inter> (A - B) = {}", "by blast"], ["proof (state)\nthis:\n  (V - (A - B)) \\<inter> (A - B) = {}\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "ultimately"], ["proof (chain)\npicking this:\n  bij_betw h (V - (B - A)) (V - (A - B))\n  bij_betw h (B - A) (A - B)\n  (V - (A - B)) \\<inter> (A - B) = {}", "have \"bij_betw h ((V - (B - A)) \\<union> (B - A)) ((V - (A - B)) \\<union> (A - B))\""], ["proof (prove)\nusing this:\n  bij_betw h (V - (B - A)) (V - (A - B))\n  bij_betw h (B - A) (A - B)\n  (V - (A - B)) \\<inter> (A - B) = {}\n\ngoal (1 subgoal):\n 1. bij_betw h (V - (B - A) \\<union> (B - A)) (V - (A - B) \\<union> (A - B))", "by (rule bij_betw_combine)"], ["proof (state)\nthis:\n  bij_betw h (V - (B - A) \\<union> (B - A)) (V - (A - B) \\<union> (A - B))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  bij_betw h (V - (B - A) \\<union> (B - A)) (V - (A - B) \\<union> (A - B))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"(V - (B - A)) \\<union> (B - A) = V\"\n    and \"(V - (A - B)) \\<union> (A - B) = V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. V - (B - A) \\<union> (B - A) = V &&& V - (A - B) \\<union> (A - B) = V", "using \\<open>A \\<subseteq> V\\<close> and \\<open>B \\<subseteq> V\\<close>"], ["proof (prove)\nusing this:\n  A \\<subseteq> V\n  B \\<subseteq> V\n\ngoal (1 subgoal):\n 1. V - (B - A) \\<union> (B - A) = V &&& V - (A - B) \\<union> (A - B) = V", "by auto"], ["proof (state)\nthis:\n  V - (B - A) \\<union> (B - A) = V\n  V - (A - B) \\<union> (A - B) = V\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "ultimately"], ["proof (chain)\npicking this:\n  bij_betw h (V - (B - A) \\<union> (B - A)) (V - (A - B) \\<union> (A - B))\n  V - (B - A) \\<union> (B - A) = V\n  V - (A - B) \\<union> (A - B) = V", "have \"bij_betw h V V\""], ["proof (prove)\nusing this:\n  bij_betw h (V - (B - A) \\<union> (B - A)) (V - (A - B) \\<union> (A - B))\n  V - (B - A) \\<union> (B - A) = V\n  V - (A - B) \\<union> (A - B) = V\n\ngoal (1 subgoal):\n 1. bij_betw h V V", "by simp"], ["proof (state)\nthis:\n  bij_betw h V V\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  bij_betw h V V\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"\\<forall>x\\<in>A. h x = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. h x = f x", "by (auto simp: h_def)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. h x = f x\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. h x = f x\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"finite {x. h x \\<noteq> x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {x. h x \\<noteq> x}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. finite {x. h x \\<noteq> x}", "have \"finite (A \\<union> (B - A))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (A \\<union> (B - A))", "using \\<open>finite A\\<close> and \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  finite A\n  finite B\n\ngoal (1 subgoal):\n 1. finite (A \\<union> (B - A))", "by auto"], ["proof (state)\nthis:\n  finite (A \\<union> (B - A))\n\ngoal (1 subgoal):\n 1. finite {x. h x \\<noteq> x}", "moreover"], ["proof (state)\nthis:\n  finite (A \\<union> (B - A))\n\ngoal (1 subgoal):\n 1. finite {x. h x \\<noteq> x}", "have \"{x. h x \\<noteq> x} \\<subseteq> (A \\<union> (B - A))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. h x \\<noteq> x} \\<subseteq> A \\<union> (B - A)", "by (auto simp: h_def)"], ["proof (state)\nthis:\n  {x. h x \\<noteq> x} \\<subseteq> A \\<union> (B - A)\n\ngoal (1 subgoal):\n 1. finite {x. h x \\<noteq> x}", "ultimately"], ["proof (chain)\npicking this:\n  finite (A \\<union> (B - A))\n  {x. h x \\<noteq> x} \\<subseteq> A \\<union> (B - A)", "show ?thesis"], ["proof (prove)\nusing this:\n  finite (A \\<union> (B - A))\n  {x. h x \\<noteq> x} \\<subseteq> A \\<union> (B - A)\n\ngoal (1 subgoal):\n 1. finite {x. h x \\<noteq> x}", "by (metis finite_subset)"], ["proof (state)\nthis:\n  finite {x. h x \\<noteq> x}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  finite {x. h x \\<noteq> x}\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "moreover"], ["proof (state)\nthis:\n  finite {x. h x \\<noteq> x}\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "have \"\\<forall>x\\<in>UNIV - (A \\<union> B). h x = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>UNIV - (A \\<union> B). h x = x", "by (simp add: h_def)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>UNIV - (A \\<union> B). h x = x\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "ultimately"], ["proof (chain)\npicking this:\n  bij_betw h V V\n  \\<forall>x\\<in>A. h x = f x\n  finite {x. h x \\<noteq> x}\n  \\<forall>x\\<in>UNIV - (A \\<union> B). h x = x", "show ?thesis"], ["proof (prove)\nusing this:\n  bij_betw h V V\n  \\<forall>x\\<in>A. h x = f x\n  finite {x. h x \\<noteq> x}\n  \\<forall>x\\<in>UNIV - (A \\<union> B). h x = x\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       finite {x. g x \\<noteq> x} \\<and>\n       (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n       (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V", "by blast"], ["proof (state)\nthis:\n  \\<exists>g.\n     finite {x. g x \\<noteq> x} \\<and>\n     (\\<forall>x\\<in>UNIV - (A \\<union> B). g x = x) \\<and>\n     (\\<forall>x\\<in>A. g x = f x) \\<and> bij_betw g V V\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Merging Functions\\<close>"], ["", "(* Copied and canonized from IsaFoR's Term theory and Polynomial Factorization in the AFP. *)"], ["", "definition fun_merge :: \"('a \\<Rightarrow> 'b)list \\<Rightarrow> 'a set list \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  where\n    \"fun_merge fs as a = (fs ! (LEAST i. i < length as \\<and> a \\<in> as ! i)) a\""], ["", "lemma fun_merge_eq_nth:\n  assumes i: \"i < length as\"\n    and a: \"a \\<in> as ! i\"\n    and ident: \"\\<And> i j a. i < length as \\<Longrightarrow> j < length as \\<Longrightarrow> a \\<in> as ! i \\<Longrightarrow> a \\<in> as ! j \\<Longrightarrow> (fs ! i) a = (fs ! j) a\"\n  shows \"fun_merge fs as a = (fs ! i) a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fun_merge fs as a = (fs ! i) a", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. fun_merge fs as a = (fs ! i) a", "let ?p = \"\\<lambda> i. i < length as \\<and> a \\<in> as ! i\""], ["proof (state)\ngoal (1 subgoal):\n 1. fun_merge fs as a = (fs ! i) a", "let ?l = \"LEAST i. ?p i\""], ["proof (state)\ngoal (1 subgoal):\n 1. fun_merge fs as a = (fs ! i) a", "have p: \"?p ?l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (LEAST i. i < length as \\<and> a \\<in> as ! i) < length as \\<and>\n    a \\<in> as ! (LEAST i. i < length as \\<and> a \\<in> as ! i)", "by (rule LeastI, insert i a, auto)"], ["proof (state)\nthis:\n  (LEAST i. i < length as \\<and> a \\<in> as ! i) < length as \\<and>\n  a \\<in> as ! (LEAST i. i < length as \\<and> a \\<in> as ! i)\n\ngoal (1 subgoal):\n 1. fun_merge fs as a = (fs ! i) a", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. fun_merge fs as a = (fs ! i) a", "unfolding fun_merge_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (fs ! (LEAST i. i < length as \\<and> a \\<in> as ! i)) a = (fs ! i) a", "by (rule ident[OF _ i _ a], insert p, auto)"], ["proof (state)\nthis:\n  fun_merge fs as a = (fs ! i) a\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma fun_merge_part:\n  assumes \"\\<forall>i<length as.\\<forall>j<length as. i \\<noteq> j \\<longrightarrow> as ! i \\<inter> as ! j = {}\"\n    and \"i < length as\"\n    and \"a \\<in> as ! i\"\n  shows \"fun_merge fs as a = (fs ! i) a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fun_merge fs as a = (fs ! i) a", "proof(rule fun_merge_eq_nth [OF assms(2, 3)])"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j a.\n       \\<lbrakk>i < length as; j < length as; a \\<in> as ! i;\n        a \\<in> as ! j\\<rbrakk>\n       \\<Longrightarrow> (fs ! i) a = (fs ! j) a", "fix i j a"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j a.\n       \\<lbrakk>i < length as; j < length as; a \\<in> as ! i;\n        a \\<in> as ! j\\<rbrakk>\n       \\<Longrightarrow> (fs ! i) a = (fs ! j) a", "assume \"i < length as\" and \"j < length as\" and \"a \\<in> as ! i\" and \"a \\<in> as ! j\""], ["proof (state)\nthis:\n  i < length as\n  j < length as\n  a \\<in> as ! i\n  a \\<in> as ! j\n\ngoal (1 subgoal):\n 1. \\<And>i j a.\n       \\<lbrakk>i < length as; j < length as; a \\<in> as ! i;\n        a \\<in> as ! j\\<rbrakk>\n       \\<Longrightarrow> (fs ! i) a = (fs ! j) a", "then"], ["proof (chain)\npicking this:\n  i < length as\n  j < length as\n  a \\<in> as ! i\n  a \\<in> as ! j", "have \"i = j\""], ["proof (prove)\nusing this:\n  i < length as\n  j < length as\n  a \\<in> as ! i\n  a \\<in> as ! j\n\ngoal (1 subgoal):\n 1. i = j", "using assms"], ["proof (prove)\nusing this:\n  i < length as\n  j < length as\n  a \\<in> as ! i\n  a \\<in> as ! j\n  \\<forall>i<length as.\n     \\<forall>j<length as.\n        i \\<noteq> j \\<longrightarrow> as ! i \\<inter> as ! j = {}\n  i < length as\n  a \\<in> as ! i\n\ngoal (1 subgoal):\n 1. i = j", "by (cases \"i = j\") auto"], ["proof (state)\nthis:\n  i = j\n\ngoal (1 subgoal):\n 1. \\<And>i j a.\n       \\<lbrakk>i < length as; j < length as; a \\<in> as ! i;\n        a \\<in> as ! j\\<rbrakk>\n       \\<Longrightarrow> (fs ! i) a = (fs ! j) a", "then"], ["proof (chain)\npicking this:\n  i = j", "show \"(fs ! i) a = (fs ! j) a\""], ["proof (prove)\nusing this:\n  i = j\n\ngoal (1 subgoal):\n 1. (fs ! i) a = (fs ! j) a", "by simp"], ["proof (state)\nthis:\n  (fs ! i) a = (fs ! j) a\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma fun_merge:\n  assumes part: \"\\<forall>i<length Xs.\\<forall>j<length Xs. i \\<noteq> j \\<longrightarrow> Xs ! i \\<inter> Xs ! j = {}\"\n  shows \"\\<exists>\\<sigma>. \\<forall>i<length Xs. \\<forall>x\\<in> Xs ! i. \\<sigma> x = \\<tau> i x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<sigma>.\n       \\<forall>i<length Xs. \\<forall>x\\<in>Xs ! i. \\<sigma> x = \\<tau> i x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<sigma>.\n       \\<forall>i<length Xs. \\<forall>x\\<in>Xs ! i. \\<sigma> x = \\<tau> i x", "let ?\\<tau> = \"map \\<tau> [0 ..< length Xs]\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<sigma>.\n       \\<forall>i<length Xs. \\<forall>x\\<in>Xs ! i. \\<sigma> x = \\<tau> i x", "let ?\\<sigma> = \"fun_merge ?\\<tau> Xs\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<sigma>.\n       \\<forall>i<length Xs. \\<forall>x\\<in>Xs ! i. \\<sigma> x = \\<tau> i x", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<sigma>.\n       \\<forall>i<length Xs. \\<forall>x\\<in>Xs ! i. \\<sigma> x = \\<tau> i x", "by (rule exI[of _ ?\\<sigma>], intro allI impI ballI,\n      insert fun_merge_part[OF part, of _ _ ?\\<tau>], auto)"], ["proof (state)\nthis:\n  \\<exists>\\<sigma>.\n     \\<forall>i<length Xs. \\<forall>x\\<in>Xs ! i. \\<sigma> x = \\<tau> i x\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}