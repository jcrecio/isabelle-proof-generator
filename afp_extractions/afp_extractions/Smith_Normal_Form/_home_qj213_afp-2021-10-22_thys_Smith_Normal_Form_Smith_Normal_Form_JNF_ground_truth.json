{"file_name": "/home/qj213/afp-2021-10-22/thys/Smith_Normal_Form/Smith_Normal_Form_JNF.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Smith_Normal_Form", "problem_names": ["lemma SNF_first_divides:\n  assumes SNF_A: \"Smith_normal_form_mat A\" and \"(A::('a::comm_ring_1) mat) \\<in> carrier_mat n m\"\n  and i: \"i < min (dim_row A) (dim_col A)\"\nshows \"A $$ (0,0) dvd A $$ (i,i)\"", "lemma Smith_normal_form_mat_intro:\n  assumes \"(\\<forall>a. a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow> A $$ (a,a) dvd A $$ (a+1,a+1))\"\n    and \"isDiagonal_mat A\" \n  shows \"Smith_normal_form_mat A\"", "lemma Smith_normal_form_mat_m0[simp]:\n  assumes A: \"A\\<in>carrier_mat m 0\"\n  shows \"Smith_normal_form_mat A\"", "lemma Smith_normal_form_mat_0m[simp]:\n  assumes A: \"A\\<in>carrier_mat 0 m\"\n  shows \"Smith_normal_form_mat A\"", "lemma S00_dvd_all_A:\n  assumes A: \"(A::'a::comm_ring_1 mat) \\<in> carrier_mat m n\"\n  and P: \"P \\<in> carrier_mat m m\"\n  and Q: \"Q \\<in> carrier_mat n n\"\n  and inv_P: \"invertible_mat P\"\n  and inv_Q: \"invertible_mat Q\"\n  and S_PAQ: \"S = P*A*Q\"\n  and SNF_S: \"Smith_normal_form_mat S\"\n  and i: \"i<m\" and j: \"j<n\"\nshows \"S$$(0,0) dvd A $$ (i,j)\"", "lemma SNF_first_divides_all:\n  assumes SNF_A: \"Smith_normal_form_mat A\" and A: \"(A::('a::comm_ring_1) mat) \\<in> carrier_mat m n\"\n  and i: \"i < m\" and j: \"j<n\"\nshows \"A $$ (0,0) dvd A $$ (i,j)\"", "lemma SNF_divides_diagonal:\n  fixes A::\"'a::comm_ring_1 mat\"\n  assumes A: \"A \\<in> carrier_mat n m\" \n    and SNF_A: \"Smith_normal_form_mat A\"\n    and j: \"j < min n m\"\n    and ij: \"i\\<le>j\"\n  shows \"A$$(i,i) dvd A$$(j,j)\"", "lemma Smith_zero_imp_zero:\n  fixes A::\"'a::comm_ring_1 mat\"\n  assumes  A: \"A \\<in> carrier_mat m n\"\n    and SNF: \"Smith_normal_form_mat A\"\n    and Aii: \"A$$(i,i) = 0\" \n    and j: \"j<min m n\" \n    and ij: \"i\\<le>j\"\n  shows \"A$$(j,j) = 0\"", "lemma SNF_preserved_multiples_identity:\n  assumes S: \"S \\<in> carrier_mat m n\" and SNF: \"Smith_normal_form_mat (S::'a::comm_ring_1 mat)\"\n  shows \"Smith_normal_form_mat (S*(k \\<cdot>\\<^sub>m 1\\<^sub>m n))\""], "translations": [["", "lemma SNF_first_divides:\n  assumes SNF_A: \"Smith_normal_form_mat A\" and \"(A::('a::comm_ring_1) mat) \\<in> carrier_mat n m\"\n  and i: \"i < min (dim_row A) (dim_col A)\"\nshows \"A $$ (0,0) dvd A $$ (i,i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (0, 0) dvd A $$ (i, i)", "using i"], ["proof (prove)\nusing this:\n  i < min (dim_row A) (dim_col A)\n\ngoal (1 subgoal):\n 1. A $$ (0, 0) dvd A $$ (i, i)", "proof (induct i)"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < min (dim_row A) (dim_col A) \\<Longrightarrow>\n    A $$ (0, 0) dvd A $$ (0, 0)\n 2. \\<And>i.\n       \\<lbrakk>i < min (dim_row A) (dim_col A) \\<Longrightarrow>\n                A $$ (0, 0) dvd A $$ (i, i);\n        Suc i < min (dim_row A) (dim_col A)\\<rbrakk>\n       \\<Longrightarrow> A $$ (0, 0) dvd A $$ (Suc i, Suc i)", "case 0"], ["proof (state)\nthis:\n  0 < min (dim_row A) (dim_col A)\n\ngoal (2 subgoals):\n 1. 0 < min (dim_row A) (dim_col A) \\<Longrightarrow>\n    A $$ (0, 0) dvd A $$ (0, 0)\n 2. \\<And>i.\n       \\<lbrakk>i < min (dim_row A) (dim_col A) \\<Longrightarrow>\n                A $$ (0, 0) dvd A $$ (i, i);\n        Suc i < min (dim_row A) (dim_col A)\\<rbrakk>\n       \\<Longrightarrow> A $$ (0, 0) dvd A $$ (Suc i, Suc i)", "then"], ["proof (chain)\npicking this:\n  0 < min (dim_row A) (dim_col A)", "show ?case"], ["proof (prove)\nusing this:\n  0 < min (dim_row A) (dim_col A)\n\ngoal (1 subgoal):\n 1. A $$ (0, 0) dvd A $$ (0, 0)", "by auto"], ["proof (state)\nthis:\n  A $$ (0, 0) dvd A $$ (0, 0)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>i < min (dim_row A) (dim_col A) \\<Longrightarrow>\n                A $$ (0, 0) dvd A $$ (i, i);\n        Suc i < min (dim_row A) (dim_col A)\\<rbrakk>\n       \\<Longrightarrow> A $$ (0, 0) dvd A $$ (Suc i, Suc i)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>i < min (dim_row A) (dim_col A) \\<Longrightarrow>\n                A $$ (0, 0) dvd A $$ (i, i);\n        Suc i < min (dim_row A) (dim_col A)\\<rbrakk>\n       \\<Longrightarrow> A $$ (0, 0) dvd A $$ (Suc i, Suc i)", "case (Suc i)"], ["proof (state)\nthis:\n  i < min (dim_row A) (dim_col A) \\<Longrightarrow>\n  A $$ (0, 0) dvd A $$ (i, i)\n  Suc i < min (dim_row A) (dim_col A)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>i < min (dim_row A) (dim_col A) \\<Longrightarrow>\n                A $$ (0, 0) dvd A $$ (i, i);\n        Suc i < min (dim_row A) (dim_col A)\\<rbrakk>\n       \\<Longrightarrow> A $$ (0, 0) dvd A $$ (Suc i, Suc i)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (0, 0) dvd A $$ (Suc i, Suc i)", "by (metis (full_types) Smith_normal_form_mat_def Suc.hyps Suc.prems \n        Suc_eq_plus1 Suc_lessD SNF_A dvd_trans)"], ["proof (state)\nthis:\n  A $$ (0, 0) dvd A $$ (Suc i, Suc i)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Smith_normal_form_mat_intro:\n  assumes \"(\\<forall>a. a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow> A $$ (a,a) dvd A $$ (a+1,a+1))\"\n    and \"isDiagonal_mat A\" \n  shows \"Smith_normal_form_mat A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Smith_normal_form_mat A", "unfolding Smith_normal_form_mat_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow>\n        A $$ (a, a) dvd A $$ (a + 1, a + 1)) \\<and>\n    isDiagonal_mat A", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>a.\n     a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow>\n     A $$ (a, a) dvd A $$ (a + 1, a + 1)\n  isDiagonal_mat A\n\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow>\n        A $$ (a, a) dvd A $$ (a + 1, a + 1)) \\<and>\n    isDiagonal_mat A", "by auto"], ["", "lemma Smith_normal_form_mat_m0[simp]:\n  assumes A: \"A\\<in>carrier_mat m 0\"\n  shows \"Smith_normal_form_mat A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Smith_normal_form_mat A", "using A"], ["proof (prove)\nusing this:\n  A \\<in> carrier_mat m 0\n\ngoal (1 subgoal):\n 1. Smith_normal_form_mat A", "unfolding Smith_normal_form_mat_def isDiagonal_mat_def"], ["proof (prove)\nusing this:\n  A \\<in> carrier_mat m 0\n\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow>\n        A $$ (a, a) dvd A $$ (a + 1, a + 1)) \\<and>\n    (\\<forall>i j.\n        i \\<noteq> j \\<and>\n        i < dim_row A \\<and> j < dim_col A \\<longrightarrow>\n        A $$ (i, j) = (0::'a))", "by auto"], ["", "lemma Smith_normal_form_mat_0m[simp]:\n  assumes A: \"A\\<in>carrier_mat 0 m\"\n  shows \"Smith_normal_form_mat A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Smith_normal_form_mat A", "using A"], ["proof (prove)\nusing this:\n  A \\<in> carrier_mat 0 m\n\ngoal (1 subgoal):\n 1. Smith_normal_form_mat A", "unfolding Smith_normal_form_mat_def isDiagonal_mat_def"], ["proof (prove)\nusing this:\n  A \\<in> carrier_mat 0 m\n\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow>\n        A $$ (a, a) dvd A $$ (a + 1, a + 1)) \\<and>\n    (\\<forall>i j.\n        i \\<noteq> j \\<and>\n        i < dim_row A \\<and> j < dim_col A \\<longrightarrow>\n        A $$ (i, j) = (0::'a))", "by auto"], ["", "lemma S00_dvd_all_A:\n  assumes A: \"(A::'a::comm_ring_1 mat) \\<in> carrier_mat m n\"\n  and P: \"P \\<in> carrier_mat m m\"\n  and Q: \"Q \\<in> carrier_mat n n\"\n  and inv_P: \"invertible_mat P\"\n  and inv_Q: \"invertible_mat Q\"\n  and S_PAQ: \"S = P*A*Q\"\n  and SNF_S: \"Smith_normal_form_mat S\"\n  and i: \"i<m\" and j: \"j<n\"\nshows \"S$$(0,0) dvd A $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "have S00: \"(\\<forall>i j. i<m \\<and> j<n \\<longrightarrow> S$$(0,0) dvd S$$(i,j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i j.\n       i < m \\<and> j < n \\<longrightarrow> S $$ (0, 0) dvd S $$ (i, j)", "using SNF_S"], ["proof (prove)\nusing this:\n  Smith_normal_form_mat S\n\ngoal (1 subgoal):\n 1. \\<forall>i j.\n       i < m \\<and> j < n \\<longrightarrow> S $$ (0, 0) dvd S $$ (i, j)", "unfolding Smith_normal_form_mat_def isDiagonal_mat_def"], ["proof (prove)\nusing this:\n  (\\<forall>a.\n      a + 1 < min (dim_row S) (dim_col S) \\<longrightarrow>\n      S $$ (a, a) dvd S $$ (a + 1, a + 1)) \\<and>\n  (\\<forall>i j.\n      i \\<noteq> j \\<and>\n      i < dim_row S \\<and> j < dim_col S \\<longrightarrow>\n      S $$ (i, j) = (0::'a))\n\ngoal (1 subgoal):\n 1. \\<forall>i j.\n       i < m \\<and> j < n \\<longrightarrow> S $$ (0, 0) dvd S $$ (i, j)", "by (smt P Q SNF_first_divides A S_PAQ SNF_S carrier_matD \n        dvd_0_right min_less_iff_conj mult_carrier_mat)"], ["proof (state)\nthis:\n  \\<forall>i j.\n     i < m \\<and> j < n \\<longrightarrow> S $$ (0, 0) dvd S $$ (i, j)\n\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "obtain P' where PP': \"inverts_mat P P'\" and P'P: \"inverts_mat P' P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>P'.\n        \\<lbrakk>inverts_mat P P'; inverts_mat P' P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using inv_P"], ["proof (prove)\nusing this:\n  invertible_mat P\n\ngoal (1 subgoal):\n 1. (\\<And>P'.\n        \\<lbrakk>inverts_mat P P'; inverts_mat P' P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding invertible_mat_def"], ["proof (prove)\nusing this:\n  square_mat P \\<and> (\\<exists>B. inverts_mat P B \\<and> inverts_mat B P)\n\ngoal (1 subgoal):\n 1. (\\<And>P'.\n        \\<lbrakk>inverts_mat P P'; inverts_mat P' P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  inverts_mat P P'\n  inverts_mat P' P\n\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "obtain Q' where QQ': \"inverts_mat Q Q'\" and Q'Q: \"inverts_mat Q' Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Q'.\n        \\<lbrakk>inverts_mat Q Q'; inverts_mat Q' Q\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using inv_Q"], ["proof (prove)\nusing this:\n  invertible_mat Q\n\ngoal (1 subgoal):\n 1. (\\<And>Q'.\n        \\<lbrakk>inverts_mat Q Q'; inverts_mat Q' Q\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding invertible_mat_def"], ["proof (prove)\nusing this:\n  square_mat Q \\<and> (\\<exists>B. inverts_mat Q B \\<and> inverts_mat B Q)\n\ngoal (1 subgoal):\n 1. (\\<And>Q'.\n        \\<lbrakk>inverts_mat Q Q'; inverts_mat Q' Q\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  inverts_mat Q Q'\n  inverts_mat Q' Q\n\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "have A_P'SQ': \"P'*S*Q' = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P' * S * Q' = A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. P' * S * Q' = A", "have \"P'*S*Q' = P'*(P*A*Q)*Q'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P' * S * Q' = P' * (P * A * Q) * Q'", "unfolding S_PAQ"], ["proof (prove)\ngoal (1 subgoal):\n 1. P' * (P * A * Q) * Q' = P' * (P * A * Q) * Q'", "by auto"], ["proof (state)\nthis:\n  P' * S * Q' = P' * (P * A * Q) * Q'\n\ngoal (1 subgoal):\n 1. P' * S * Q' = A", "also"], ["proof (state)\nthis:\n  P' * S * Q' = P' * (P * A * Q) * Q'\n\ngoal (1 subgoal):\n 1. P' * S * Q' = A", "have \"... = (P'*P)*A*(Q*Q')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P' * (P * A * Q) * Q' = P' * P * A * (Q * Q')", "by (smt A PP' Q Q'Q P assoc_mult_mat carrier_mat_triv index_mult_mat(2) index_mult_mat(3) \n            index_one_mat(3) inverts_mat_def right_mult_one_mat)"], ["proof (state)\nthis:\n  P' * (P * A * Q) * Q' = P' * P * A * (Q * Q')\n\ngoal (1 subgoal):\n 1. P' * S * Q' = A", "also"], ["proof (state)\nthis:\n  P' * (P * A * Q) * Q' = P' * P * A * (Q * Q')\n\ngoal (1 subgoal):\n 1. P' * S * Q' = A", "have \"... = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P' * P * A * (Q * Q') = A", "by (metis A P'P QQ' A Q P carrier_matD(1) index_mult_mat(3) index_one_mat(3) inverts_mat_def\n            left_mult_one_mat right_mult_one_mat)"], ["proof (state)\nthis:\n  P' * P * A * (Q * Q') = A\n\ngoal (1 subgoal):\n 1. P' * S * Q' = A", "finally"], ["proof (chain)\npicking this:\n  P' * S * Q' = A", "show ?thesis"], ["proof (prove)\nusing this:\n  P' * S * Q' = A\n\ngoal (1 subgoal):\n 1. P' * S * Q' = A", "."], ["proof (state)\nthis:\n  P' * S * Q' = A\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  P' * S * Q' = A\n\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "have \"(\\<forall>i j. i<m \\<and> j<n \\<longrightarrow> S$$(0,0) dvd (P'*S*Q')$$(i,j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i j.\n       i < m \\<and> j < n \\<longrightarrow>\n       S $$ (0, 0) dvd (P' * S * Q') $$ (i, j)", "proof (rule dvd_elements_mult_matrix_left_right[OF _ _ _ S00])"], ["proof (state)\ngoal (3 subgoals):\n 1. S \\<in> carrier_mat m n\n 2. P' \\<in> carrier_mat m m\n 3. Q' \\<in> carrier_mat n n", "show \"S \\<in> carrier_mat m n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<in> carrier_mat m n", "using P A Q S_PAQ"], ["proof (prove)\nusing this:\n  P \\<in> carrier_mat m m\n  A \\<in> carrier_mat m n\n  Q \\<in> carrier_mat n n\n  S = P * A * Q\n\ngoal (1 subgoal):\n 1. S \\<in> carrier_mat m n", "by auto"], ["proof (state)\nthis:\n  S \\<in> carrier_mat m n\n\ngoal (2 subgoals):\n 1. P' \\<in> carrier_mat m m\n 2. Q' \\<in> carrier_mat n n", "show \"P' \\<in> carrier_mat m m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P' \\<in> carrier_mat m m", "by (metis (mono_tags, lifting) A_P'SQ' PP' P A carrier_matD carrier_matI index_mult_mat(2) \n            index_mult_mat(3) inverts_mat_def one_carrier_mat)"], ["proof (state)\nthis:\n  P' \\<in> carrier_mat m m\n\ngoal (1 subgoal):\n 1. Q' \\<in> carrier_mat n n", "show \"Q' \\<in> carrier_mat n n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Q' \\<in> carrier_mat n n", "by (metis (mono_tags, lifting) A_P'SQ' Q'Q Q A carrier_matD(2) carrier_matI \n            index_mult_mat(3) inverts_mat_def one_carrier_mat)"], ["proof (state)\nthis:\n  Q' \\<in> carrier_mat n n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>i j.\n     i < m \\<and> j < n \\<longrightarrow>\n     S $$ (0, 0) dvd (P' * S * Q') $$ (i, j)\n\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>i j.\n     i < m \\<and> j < n \\<longrightarrow>\n     S $$ (0, 0) dvd (P' * S * Q') $$ (i, j)\n\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "using A_P'SQ' i j"], ["proof (prove)\nusing this:\n  \\<forall>i j.\n     i < m \\<and> j < n \\<longrightarrow>\n     S $$ (0, 0) dvd (P' * S * Q') $$ (i, j)\n  P' * S * Q' = A\n  i < m\n  j < n\n\ngoal (1 subgoal):\n 1. S $$ (0, 0) dvd A $$ (i, j)", "by auto"], ["proof (state)\nthis:\n  S $$ (0, 0) dvd A $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SNF_first_divides_all:\n  assumes SNF_A: \"Smith_normal_form_mat A\" and A: \"(A::('a::comm_ring_1) mat) \\<in> carrier_mat m n\"\n  and i: \"i < m\" and j: \"j<n\"\nshows \"A $$ (0,0) dvd A $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (0, 0) dvd A $$ (i, j)", "proof (cases \"i=j\")"], ["proof (state)\ngoal (2 subgoals):\n 1. i = j \\<Longrightarrow> A $$ (0, 0) dvd A $$ (i, j)\n 2. i \\<noteq> j \\<Longrightarrow> A $$ (0, 0) dvd A $$ (i, j)", "case True"], ["proof (state)\nthis:\n  i = j\n\ngoal (2 subgoals):\n 1. i = j \\<Longrightarrow> A $$ (0, 0) dvd A $$ (i, j)\n 2. i \\<noteq> j \\<Longrightarrow> A $$ (0, 0) dvd A $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i = j", "show ?thesis"], ["proof (prove)\nusing this:\n  i = j\n\ngoal (1 subgoal):\n 1. A $$ (0, 0) dvd A $$ (i, j)", "using assms SNF_first_divides"], ["proof (prove)\nusing this:\n  i = j\n  Smith_normal_form_mat A\n  A \\<in> carrier_mat m n\n  i < m\n  j < n\n  \\<lbrakk>Smith_normal_form_mat ?A; ?A \\<in> carrier_mat ?n ?m;\n   ?i < min (dim_row ?A) (dim_col ?A)\\<rbrakk>\n  \\<Longrightarrow> ?A $$ (0, 0) dvd ?A $$ (?i, ?i)\n\ngoal (1 subgoal):\n 1. A $$ (0, 0) dvd A $$ (i, j)", "by (metis carrier_matD min_less_iff_conj)"], ["proof (state)\nthis:\n  A $$ (0, 0) dvd A $$ (i, j)\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> A $$ (0, 0) dvd A $$ (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> A $$ (0, 0) dvd A $$ (i, j)", "case False"], ["proof (state)\nthis:\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> A $$ (0, 0) dvd A $$ (i, j)", "hence \"A$$(i,j) = 0\""], ["proof (prove)\nusing this:\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. A $$ (i, j) = (0::'a)", "using SNF_A i j A"], ["proof (prove)\nusing this:\n  i \\<noteq> j\n  Smith_normal_form_mat A\n  i < m\n  j < n\n  A \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. A $$ (i, j) = (0::'a)", "unfolding Smith_normal_form_mat_def isDiagonal_mat_def"], ["proof (prove)\nusing this:\n  i \\<noteq> j\n  (\\<forall>a.\n      a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow>\n      A $$ (a, a) dvd A $$ (a + 1, a + 1)) \\<and>\n  (\\<forall>i j.\n      i \\<noteq> j \\<and>\n      i < dim_row A \\<and> j < dim_col A \\<longrightarrow>\n      A $$ (i, j) = (0::'a))\n  i < m\n  j < n\n  A \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. A $$ (i, j) = (0::'a)", "by auto"], ["proof (state)\nthis:\n  A $$ (i, j) = (0::'a)\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> A $$ (0, 0) dvd A $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  A $$ (i, j) = (0::'a)", "show ?thesis"], ["proof (prove)\nusing this:\n  A $$ (i, j) = (0::'a)\n\ngoal (1 subgoal):\n 1. A $$ (0, 0) dvd A $$ (i, j)", "by auto"], ["proof (state)\nthis:\n  A $$ (0, 0) dvd A $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "(*This can also be obtained from HOL Analysis via local type definitions*)"], ["", "lemma SNF_divides_diagonal:\n  fixes A::\"'a::comm_ring_1 mat\"\n  assumes A: \"A \\<in> carrier_mat n m\" \n    and SNF_A: \"Smith_normal_form_mat A\"\n    and j: \"j < min n m\"\n    and ij: \"i\\<le>j\"\n  shows \"A$$(i,i) dvd A$$(j,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (j, j)", "using ij j"], ["proof (prove)\nusing this:\n  i \\<le> j\n  j < min n m\n\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (j, j)", "proof (induct j)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<le> 0; 0 < min n m\\<rbrakk>\n    \\<Longrightarrow> A $$ (i, i) dvd A $$ (0, 0)\n 2. \\<And>j.\n       \\<lbrakk>\\<lbrakk>i \\<le> j; j < min n m\\<rbrakk>\n                \\<Longrightarrow> A $$ (i, i) dvd A $$ (j, j);\n        i \\<le> Suc j; Suc j < min n m\\<rbrakk>\n       \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "case 0"], ["proof (state)\nthis:\n  i \\<le> 0\n  0 < min n m\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<le> 0; 0 < min n m\\<rbrakk>\n    \\<Longrightarrow> A $$ (i, i) dvd A $$ (0, 0)\n 2. \\<And>j.\n       \\<lbrakk>\\<lbrakk>i \\<le> j; j < min n m\\<rbrakk>\n                \\<Longrightarrow> A $$ (i, i) dvd A $$ (j, j);\n        i \\<le> Suc j; Suc j < min n m\\<rbrakk>\n       \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "then"], ["proof (chain)\npicking this:\n  i \\<le> 0\n  0 < min n m", "show ?case"], ["proof (prove)\nusing this:\n  i \\<le> 0\n  0 < min n m\n\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (0, 0)", "by auto"], ["proof (state)\nthis:\n  A $$ (i, i) dvd A $$ (0, 0)\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<lbrakk>i \\<le> j; j < min n m\\<rbrakk>\n                \\<Longrightarrow> A $$ (i, i) dvd A $$ (j, j);\n        i \\<le> Suc j; Suc j < min n m\\<rbrakk>\n       \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<lbrakk>i \\<le> j; j < min n m\\<rbrakk>\n                \\<Longrightarrow> A $$ (i, i) dvd A $$ (j, j);\n        i \\<le> Suc j; Suc j < min n m\\<rbrakk>\n       \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "case (Suc j)"], ["proof (state)\nthis:\n  \\<lbrakk>i \\<le> j; j < min n m\\<rbrakk>\n  \\<Longrightarrow> A $$ (i, i) dvd A $$ (j, j)\n  i \\<le> Suc j\n  Suc j < min n m\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<lbrakk>i \\<le> j; j < min n m\\<rbrakk>\n                \\<Longrightarrow> A $$ (i, i) dvd A $$ (j, j);\n        i \\<le> Suc j; Suc j < min n m\\<rbrakk>\n       \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (Suc j, Suc j)", "proof (cases \"i\\<le>j\")"], ["proof (state)\ngoal (2 subgoals):\n 1. i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)\n 2. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "case True"], ["proof (state)\nthis:\n  i \\<le> j\n\ngoal (2 subgoals):\n 1. i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)\n 2. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "have \"A $$ (i, i) dvd A $$ (j, j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (j, j)", "using Suc.hyps Suc.prems True"], ["proof (prove)\nusing this:\n  \\<lbrakk>i \\<le> j; j < min n m\\<rbrakk>\n  \\<Longrightarrow> A $$ (i, i) dvd A $$ (j, j)\n  i \\<le> Suc j\n  Suc j < min n m\n  i \\<le> j\n\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (j, j)", "by simp"], ["proof (state)\nthis:\n  A $$ (i, i) dvd A $$ (j, j)\n\ngoal (2 subgoals):\n 1. i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)\n 2. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "also"], ["proof (state)\nthis:\n  A $$ (i, i) dvd A $$ (j, j)\n\ngoal (2 subgoals):\n 1. i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)\n 2. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "have \"... dvd A $$ (Suc j, Suc j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (j, j) dvd A $$ (Suc j, Suc j)", "using SNF_A Suc.prems A"], ["proof (prove)\nusing this:\n  Smith_normal_form_mat A\n  i \\<le> Suc j\n  Suc j < min n m\n  A \\<in> carrier_mat n m\n\ngoal (1 subgoal):\n 1. A $$ (j, j) dvd A $$ (Suc j, Suc j)", "unfolding Smith_normal_form_mat_def"], ["proof (prove)\nusing this:\n  (\\<forall>a.\n      a + 1 < min (dim_row A) (dim_col A) \\<longrightarrow>\n      A $$ (a, a) dvd A $$ (a + 1, a + 1)) \\<and>\n  isDiagonal_mat A\n  i \\<le> Suc j\n  Suc j < min n m\n  A \\<in> carrier_mat n m\n\ngoal (1 subgoal):\n 1. A $$ (j, j) dvd A $$ (Suc j, Suc j)", "by auto"], ["proof (state)\nthis:\n  A $$ (j, j) dvd A $$ (Suc j, Suc j)\n\ngoal (2 subgoals):\n 1. i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)\n 2. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "finally"], ["proof (chain)\npicking this:\n  A $$ (i, i) dvd A $$ (Suc j, Suc j)", "show ?thesis"], ["proof (prove)\nusing this:\n  A $$ (i, i) dvd A $$ (Suc j, Suc j)\n\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (Suc j, Suc j)", "by auto"], ["proof (state)\nthis:\n  A $$ (i, i) dvd A $$ (Suc j, Suc j)\n\ngoal (1 subgoal):\n 1. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "case False"], ["proof (state)\nthis:\n  \\<not> i \\<le> j\n\ngoal (1 subgoal):\n 1. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "hence \"i=Suc j\""], ["proof (prove)\nusing this:\n  \\<not> i \\<le> j\n\ngoal (1 subgoal):\n 1. i = Suc j", "using Suc.prems"], ["proof (prove)\nusing this:\n  \\<not> i \\<le> j\n  i \\<le> Suc j\n  Suc j < min n m\n\ngoal (1 subgoal):\n 1. i = Suc j", "by auto"], ["proof (state)\nthis:\n  i = Suc j\n\ngoal (1 subgoal):\n 1. \\<not> i \\<le> j \\<Longrightarrow> A $$ (i, i) dvd A $$ (Suc j, Suc j)", "then"], ["proof (chain)\npicking this:\n  i = Suc j", "show ?thesis"], ["proof (prove)\nusing this:\n  i = Suc j\n\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (Suc j, Suc j)", "by auto"], ["proof (state)\nthis:\n  A $$ (i, i) dvd A $$ (Suc j, Suc j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  A $$ (i, i) dvd A $$ (Suc j, Suc j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Smith_zero_imp_zero:\n  fixes A::\"'a::comm_ring_1 mat\"\n  assumes  A: \"A \\<in> carrier_mat m n\"\n    and SNF: \"Smith_normal_form_mat A\"\n    and Aii: \"A$$(i,i) = 0\" \n    and j: \"j<min m n\" \n    and ij: \"i\\<le>j\"\n  shows \"A$$(j,j) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (j, j) = (0::'a)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A $$ (j, j) = (0::'a)", "have \"A$$(i,i) dvd A$$(j,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A $$ (i, i) dvd A $$ (j, j)", "by (rule SNF_divides_diagonal[OF A SNF j ij])"], ["proof (state)\nthis:\n  A $$ (i, i) dvd A $$ (j, j)\n\ngoal (1 subgoal):\n 1. A $$ (j, j) = (0::'a)", "thus ?thesis"], ["proof (prove)\nusing this:\n  A $$ (i, i) dvd A $$ (j, j)\n\ngoal (1 subgoal):\n 1. A $$ (j, j) = (0::'a)", "using Aii"], ["proof (prove)\nusing this:\n  A $$ (i, i) dvd A $$ (j, j)\n  A $$ (i, i) = (0::'a)\n\ngoal (1 subgoal):\n 1. A $$ (j, j) = (0::'a)", "by auto"], ["proof (state)\nthis:\n  A $$ (j, j) = (0::'a)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SNF_preserved_multiples_identity:\n  assumes S: \"S \\<in> carrier_mat m n\" and SNF: \"Smith_normal_form_mat (S::'a::comm_ring_1 mat)\"\n  shows \"Smith_normal_form_mat (S*(k \\<cdot>\\<^sub>m 1\\<^sub>m n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Smith_normal_form_mat (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))", "proof (rule Smith_normal_form_mat_intro)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>a.\n       a + 1\n       < min (dim_row (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)))\n          (dim_col (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))) \\<longrightarrow>\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a, a) dvd\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a + 1, a + 1)\n 2. isDiagonal_mat (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))", "have rw: \"S*(k \\<cdot>\\<^sub>m 1\\<^sub>m n) = Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n) =\n    Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k)", "unfolding mat_diag_smult[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. S * mat_diag n (\\<lambda>x. k) =\n    Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k)", "by (rule mat_diag_mult_right[OF S])"], ["proof (state)\nthis:\n  S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n) =\n  Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k)\n\ngoal (2 subgoals):\n 1. \\<forall>a.\n       a + 1\n       < min (dim_row (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)))\n          (dim_col (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))) \\<longrightarrow>\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a, a) dvd\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a + 1, a + 1)\n 2. isDiagonal_mat (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))", "show \"isDiagonal_mat (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. isDiagonal_mat (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))", "using SNF S"], ["proof (prove)\nusing this:\n  Smith_normal_form_mat S\n  S \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. isDiagonal_mat (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))", "unfolding Smith_normal_form_mat_def isDiagonal_mat_def rw"], ["proof (prove)\nusing this:\n  (\\<forall>a.\n      a + 1 < min (dim_row S) (dim_col S) \\<longrightarrow>\n      S $$ (a, a) dvd S $$ (a + 1, a + 1)) \\<and>\n  (\\<forall>i j.\n      i \\<noteq> j \\<and>\n      i < dim_row S \\<and> j < dim_col S \\<longrightarrow>\n      S $$ (i, j) = (0::'a))\n  S \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. \\<forall>i j.\n       i \\<noteq> j \\<and>\n       i < dim_row\n            (Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k)) \\<and>\n       j < dim_col\n            (Matrix.mat m n\n              (\\<lambda>(i, j). S $$ (i, j) * k)) \\<longrightarrow>\n       Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k) $$ (i, j) = (0::'a)", "by auto"], ["proof (state)\nthis:\n  isDiagonal_mat (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))\n\ngoal (1 subgoal):\n 1. \\<forall>a.\n       a + 1\n       < min (dim_row (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)))\n          (dim_col (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))) \\<longrightarrow>\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a, a) dvd\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a + 1, a + 1)", "show \"\\<forall>a. a + 1 < min (dim_row (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))) (dim_col (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))) \\<longrightarrow>\n        (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a, a) dvd (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a + 1, a + 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a.\n       a + 1\n       < min (dim_row (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)))\n          (dim_col (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))) \\<longrightarrow>\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a, a) dvd\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a + 1, a + 1)", "using SNF S"], ["proof (prove)\nusing this:\n  Smith_normal_form_mat S\n  S \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. \\<forall>a.\n       a + 1\n       < min (dim_row (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)))\n          (dim_col (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))) \\<longrightarrow>\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a, a) dvd\n       (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a + 1, a + 1)", "unfolding Smith_normal_form_mat_def isDiagonal_mat_def rw"], ["proof (prove)\nusing this:\n  (\\<forall>a.\n      a + 1 < min (dim_row S) (dim_col S) \\<longrightarrow>\n      S $$ (a, a) dvd S $$ (a + 1, a + 1)) \\<and>\n  (\\<forall>i j.\n      i \\<noteq> j \\<and>\n      i < dim_row S \\<and> j < dim_col S \\<longrightarrow>\n      S $$ (i, j) = (0::'a))\n  S \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. \\<forall>a.\n       a + 1\n       < min (dim_row (Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k)))\n          (dim_col\n            (Matrix.mat m n\n              (\\<lambda>(i, j). S $$ (i, j) * k))) \\<longrightarrow>\n       Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k) $$ (a, a) dvd\n       Matrix.mat m n (\\<lambda>(i, j). S $$ (i, j) * k) $$ (a + 1, a + 1)", "by (auto simp add: mult_dvd_mono)"], ["proof (state)\nthis:\n  \\<forall>a.\n     a + 1\n     < min (dim_row (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)))\n        (dim_col (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n))) \\<longrightarrow>\n     (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a, a) dvd\n     (S * (k \\<cdot>\\<^sub>m 1\\<^sub>m n)) $$ (a + 1, a + 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}