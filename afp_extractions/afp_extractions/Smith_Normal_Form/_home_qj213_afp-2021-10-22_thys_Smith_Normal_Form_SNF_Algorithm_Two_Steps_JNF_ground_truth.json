{"file_name": "/home/qj213/afp-2021-10-22/thys/Smith_Normal_Form/SNF_Algorithm_Two_Steps_JNF.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Smith_Normal_Form", "problem_names": ["lemma Smith_normal_form_of_JNF_soundness:\n  assumes b: \"is_bezout_ext bezout\" and A: \"A \\<in> carrier_mat m n\"\n  and n: \"1 < n\" and m: \"1 < m\" (*Same as previously, those assumptions arose from the requirements \nof mod_type. They could be dropped proving them as particular cases*)\n  and PSQ: \"Smith_normal_form_of_JNF A bezout = (P,S,Q)\"\nshows \"S = P*A*Q \\<and> invertible_mat P \\<and> invertible_mat Q \\<and> Smith_normal_form_mat S\n  \\<and> P \\<in> carrier_mat m m \\<and> S \\<in> carrier_mat m n \\<and> Q\\<in> carrier_mat n n\""], "translations": [["", "lemma Smith_normal_form_of_JNF_soundness:\n  assumes b: \"is_bezout_ext bezout\" and A: \"A \\<in> carrier_mat m n\"\n  and n: \"1 < n\" and m: \"1 < m\" (*Same as previously, those assumptions arose from the requirements \nof mod_type. They could be dropped proving them as particular cases*)\n  and PSQ: \"Smith_normal_form_of_JNF A bezout = (P,S,Q)\"\nshows \"S = P*A*Q \\<and> invertible_mat P \\<and> invertible_mat Q \\<and> Smith_normal_form_mat S\n  \\<and> P \\<in> carrier_mat m m \\<and> S \\<in> carrier_mat m n \\<and> Q\\<in> carrier_mat n n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "obtain P'' D Q'' where PDQ_diag: \"(P'',D,Q'') = diagonalize_JNF A bezout\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>P'' D Q''.\n        (P'', D, Q'') = diagonalize_JNF A bezout \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (metis prod_cases3)"], ["proof (state)\nthis:\n  (P'', D, Q'') = diagonalize_JNF A bezout\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "have 1: \"invertible_mat P'' \\<and> invertible_mat Q'' \\<and> isDiagonal_mat D \\<and> D = P''*A*Q''\n      \\<and> P'' \\<in> carrier_mat m m \\<and> Q'' \\<in> carrier_mat n n \\<and> D \\<in> carrier_mat m n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_mat P'' \\<and>\n    invertible_mat Q'' \\<and>\n    isDiagonal_mat D \\<and>\n    D = P'' * A * Q'' \\<and>\n    P'' \\<in> carrier_mat m m \\<and>\n    Q'' \\<in> carrier_mat n n \\<and> D \\<in> carrier_mat m n", "using soundness_diagonalize_JNF'[OF b A PDQ_diag[symmetric]]"], ["proof (prove)\nusing this:\n  P'' \\<in> carrier_mat m m \\<and>\n  Q'' \\<in> carrier_mat n n \\<and>\n  D \\<in> carrier_mat m n \\<and>\n  invertible_mat P'' \\<and>\n  invertible_mat Q'' \\<and> isDiagonal_mat D \\<and> D = P'' * A * Q''\n\ngoal (1 subgoal):\n 1. invertible_mat P'' \\<and>\n    invertible_mat Q'' \\<and>\n    isDiagonal_mat D \\<and>\n    D = P'' * A * Q'' \\<and>\n    P'' \\<in> carrier_mat m m \\<and>\n    Q'' \\<in> carrier_mat n n \\<and> D \\<in> carrier_mat m n", "by auto"], ["proof (state)\nthis:\n  invertible_mat P'' \\<and>\n  invertible_mat Q'' \\<and>\n  isDiagonal_mat D \\<and>\n  D = P'' * A * Q'' \\<and>\n  P'' \\<in> carrier_mat m m \\<and>\n  Q'' \\<in> carrier_mat n n \\<and> D \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "obtain P' Q' where PSQ_D: \"(P',S,Q') = diagonal_to_Smith_PQ_JNF D bezout\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>P' Q'.\n        (P', S, Q') = diagonal_to_Smith_PQ_JNF D bezout \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using PSQ PDQ_diag"], ["proof (prove)\nusing this:\n  Smith_normal_form_of_JNF A bezout = (P, S, Q)\n  (P'', D, Q'') = diagonalize_JNF A bezout\n\ngoal (1 subgoal):\n 1. (\\<And>P' Q'.\n        (P', S, Q') = diagonal_to_Smith_PQ_JNF D bezout \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "unfolding Smith_normal_form_of_JNF_def Let_def split_beta"], ["proof (prove)\nusing this:\n  (fst (diagonal_to_Smith_PQ_JNF (fst (snd (diagonalize_JNF A bezout)))\n         bezout) *\n   fst (diagonalize_JNF A bezout),\n   fst (snd (diagonal_to_Smith_PQ_JNF (fst (snd (diagonalize_JNF A bezout)))\n              bezout)),\n   snd (snd (diagonalize_JNF A bezout)) *\n   snd (snd (diagonal_to_Smith_PQ_JNF (fst (snd (diagonalize_JNF A bezout)))\n              bezout))) =\n  (P, S, Q)\n  (P'', D, Q'') = diagonalize_JNF A bezout\n\ngoal (1 subgoal):\n 1. (\\<And>P' Q'.\n        (P', S, Q') = diagonal_to_Smith_PQ_JNF D bezout \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (metis Pair_inject prod.collapse)"], ["proof (state)\nthis:\n  (P', S, Q') = diagonal_to_Smith_PQ_JNF D bezout\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "have 2: \"invertible_mat P' \\<and> invertible_mat Q' \\<and> Smith_normal_form_mat S \\<and> S = P'*D*Q'\n    \\<and> P' \\<in> carrier_mat m m \\<and> Q' \\<in> carrier_mat n n \\<and> S \\<in> carrier_mat m n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_mat P' \\<and>\n    invertible_mat Q' \\<and>\n    Smith_normal_form_mat S \\<and>\n    S = P' * D * Q' \\<and>\n    P' \\<in> carrier_mat m m \\<and>\n    Q' \\<in> carrier_mat n n \\<and> S \\<in> carrier_mat m n", "using diagonal_to_Smith_PQ_JNF[OF _ b _ PSQ_D n m] 1 n m"], ["proof (prove)\nusing this:\n  \\<lbrakk>isDiagonal_mat D; D \\<in> carrier_mat m n\\<rbrakk>\n  \\<Longrightarrow> S = P' * D * Q' \\<and>\n                    invertible_mat P' \\<and>\n                    invertible_mat Q' \\<and>\n                    Smith_normal_form_mat S \\<and>\n                    P' \\<in> carrier_mat m m \\<and>\n                    S \\<in> carrier_mat m n \\<and> Q' \\<in> carrier_mat n n\n  invertible_mat P'' \\<and>\n  invertible_mat Q'' \\<and>\n  isDiagonal_mat D \\<and>\n  D = P'' * A * Q'' \\<and>\n  P'' \\<in> carrier_mat m m \\<and>\n  Q'' \\<in> carrier_mat n n \\<and> D \\<in> carrier_mat m n\n  1 < n\n  1 < m\n\ngoal (1 subgoal):\n 1. invertible_mat P' \\<and>\n    invertible_mat Q' \\<and>\n    Smith_normal_form_mat S \\<and>\n    S = P' * D * Q' \\<and>\n    P' \\<in> carrier_mat m m \\<and>\n    Q' \\<in> carrier_mat n n \\<and> S \\<in> carrier_mat m n", "by auto"], ["proof (state)\nthis:\n  invertible_mat P' \\<and>\n  invertible_mat Q' \\<and>\n  Smith_normal_form_mat S \\<and>\n  S = P' * D * Q' \\<and>\n  P' \\<in> carrier_mat m m \\<and>\n  Q' \\<in> carrier_mat n n \\<and> S \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "have P: \"P = P'*P''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P = P' * P''", "by (metis (no_types, lifting) PDQ_diag PSQ PSQ_D Smith_normal_form_of_JNF_def fst_conv prod.simps(2))"], ["proof (state)\nthis:\n  P = P' * P''\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "have Q: \"Q = Q''*Q'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Q = Q'' * Q'", "by (metis (no_types, lifting) PDQ_diag PSQ PSQ_D Smith_normal_form_of_JNF_def snd_conv prod.simps(2))"], ["proof (state)\nthis:\n  Q = Q'' * Q'\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "have \"S = P'*(P''*A*Q'')*Q'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S = P' * (P'' * A * Q'') * Q'", "using 1 2"], ["proof (prove)\nusing this:\n  invertible_mat P'' \\<and>\n  invertible_mat Q'' \\<and>\n  isDiagonal_mat D \\<and>\n  D = P'' * A * Q'' \\<and>\n  P'' \\<in> carrier_mat m m \\<and>\n  Q'' \\<in> carrier_mat n n \\<and> D \\<in> carrier_mat m n\n  invertible_mat P' \\<and>\n  invertible_mat Q' \\<and>\n  Smith_normal_form_mat S \\<and>\n  S = P' * D * Q' \\<and>\n  P' \\<in> carrier_mat m m \\<and>\n  Q' \\<in> carrier_mat n n \\<and> S \\<in> carrier_mat m n\n\ngoal (1 subgoal):\n 1. S = P' * (P'' * A * Q'') * Q'", "by auto"], ["proof (state)\nthis:\n  S = P' * (P'' * A * Q'') * Q'\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "also"], ["proof (state)\nthis:\n  S = P' * (P'' * A * Q'') * Q'\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "have \"... = (P'*P'')*A*(Q''*Q')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P' * (P'' * A * Q'') * Q' = P' * P'' * A * (Q'' * Q')", "by (smt \"1\" \"2\" A assoc_mult_mat carrier_matD carrier_mat_triv index_mult_mat)"], ["proof (state)\nthis:\n  P' * (P'' * A * Q'') * Q' = P' * P'' * A * (Q'' * Q')\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "finally"], ["proof (chain)\npicking this:\n  S = P' * P'' * A * (Q'' * Q')", "have \"S = (P' * P'') * A * (Q'' * Q')\""], ["proof (prove)\nusing this:\n  S = P' * P'' * A * (Q'' * Q')\n\ngoal (1 subgoal):\n 1. S = P' * P'' * A * (Q'' * Q')", "."], ["proof (state)\nthis:\n  S = P' * P'' * A * (Q'' * Q')\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "moreover"], ["proof (state)\nthis:\n  S = P' * P'' * A * (Q'' * Q')\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "have \"invertible_mat P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_mat P", "unfolding P"], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_mat (P' * P'')", "by (rule invertible_mult_JNF, insert 1 2, auto)"], ["proof (state)\nthis:\n  invertible_mat P\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "moreover"], ["proof (state)\nthis:\n  invertible_mat P\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "have \"invertible_mat Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_mat Q", "unfolding Q"], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_mat (Q'' * Q')", "by (rule invertible_mult_JNF, insert 1 2, auto)"], ["proof (state)\nthis:\n  invertible_mat Q\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "ultimately"], ["proof (chain)\npicking this:\n  S = P' * P'' * A * (Q'' * Q')\n  invertible_mat P\n  invertible_mat Q", "show ?thesis"], ["proof (prove)\nusing this:\n  S = P' * P'' * A * (Q'' * Q')\n  invertible_mat P\n  invertible_mat Q\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "using 1 2 P Q"], ["proof (prove)\nusing this:\n  S = P' * P'' * A * (Q'' * Q')\n  invertible_mat P\n  invertible_mat Q\n  invertible_mat P'' \\<and>\n  invertible_mat Q'' \\<and>\n  isDiagonal_mat D \\<and>\n  D = P'' * A * Q'' \\<and>\n  P'' \\<in> carrier_mat m m \\<and>\n  Q'' \\<in> carrier_mat n n \\<and> D \\<in> carrier_mat m n\n  invertible_mat P' \\<and>\n  invertible_mat Q' \\<and>\n  Smith_normal_form_mat S \\<and>\n  S = P' * D * Q' \\<and>\n  P' \\<in> carrier_mat m m \\<and>\n  Q' \\<in> carrier_mat n n \\<and> S \\<in> carrier_mat m n\n  P = P' * P''\n  Q = Q'' * Q'\n\ngoal (1 subgoal):\n 1. S = P * A * Q \\<and>\n    invertible_mat P \\<and>\n    invertible_mat Q \\<and>\n    Smith_normal_form_mat S \\<and>\n    P \\<in> carrier_mat m m \\<and>\n    S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n", "by auto"], ["proof (state)\nthis:\n  S = P * A * Q \\<and>\n  invertible_mat P \\<and>\n  invertible_mat Q \\<and>\n  Smith_normal_form_mat S \\<and>\n  P \\<in> carrier_mat m m \\<and>\n  S \\<in> carrier_mat m n \\<and> Q \\<in> carrier_mat n n\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"]]}