{"file_name": "/home/qj213/afp-2021-10-22/thys/Key_Agreement_Strong_Adversaries/Payloads.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Key_Agreement_Strong_Adversaries", "problem_names": ["lemma eq_rep_abs: \"eq x (Re (Ab x))\"", "lemma eq_cpayload:\n  assumes \"eq x y\" and \"x \\<in> cpayload\"\n  shows \"y \\<in> cpayload\"", "lemma abs_payload: \"Ab x \\<in> payload \\<longleftrightarrow> x \\<in> cpayload\"", "lemma abs_cpayload_rep: \"x \\<in> Ab` cpayload \\<longleftrightarrow> Re x \\<in> cpayload\"", "lemma payload_rep_cpayload: \"Re x \\<in> cpayload \\<longleftrightarrow> x \\<in> payload\"", "lemma payload_AgentI: \"Agent A \\<in> payload\"", "lemma payload_NonceI: \"Nonce N \\<in> payload\"", "lemma payload_NumberI: \"Number N \\<in> payload\"", "lemma payload_EphKI: \"EphK X \\<in> payload\"", "lemma payload_HashI: \"x \\<in> payload \\<Longrightarrow> Hash x \\<in> payload\"", "lemma payload_PairI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Pair x y \\<in> payload\"", "lemma payload_EncI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Enc x y \\<in> payload\"", "lemma payload_AencI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Aenc x y \\<in> payload\"", "lemma payload_SignI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Sign x y \\<in> payload\"", "lemma payload_ExpI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Exp x y \\<in> payload\"", "lemmas payload_intros [simp, intro] =\n  payload_AgentI payload_NonceI payload_NumberI payload_EphKI payload_HashI\n  payload_PairI payload_EncI payload_AencI payload_SignI payload_ExpI", "lemma payload_Tag: \"Tag X \\<in> payload \\<Longrightarrow> P\"", "lemma payload_LtK: \"LtK X \\<in> payload \\<Longrightarrow> P\"", "lemma payload_Hash: \"Hash X \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\"", "lemma payload_Pair: \"Pair X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\"", "lemma payload_Enc: \"Enc X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\"", "lemma payload_Aenc: \"Aenc X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\"", "lemma payload_Sign: \"Sign X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\"", "lemma payload_Exp: \"Exp X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\"", "lemmas payload_inductive_cases =\n  payload_Tag payload_LtK payload_Hash\n  payload_Pair payload_Enc payload_Aenc payload_Sign payload_Exp", "lemma eq_exhaust:\n\"(\\<And>x. eq y (cAgent x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cNumber x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cNonce x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cLtK x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cEphK x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cHash x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cTag x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P) \\<Longrightarrow>\n P\"", "lemma msg_exhaust:\n\"(\\<And>x. y = Agent x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = Number x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = Nonce x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = LtK x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = EphK x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Pair x x' \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Enc x x' \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Aenc x x' \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Sign x x' \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = Hash x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = Tag x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Exp x x' \\<Longrightarrow> P) \\<Longrightarrow>\n P\"", "lemma payload_cases: \n\"a \\<in> payload \\<Longrightarrow>\n(\\<And>A. a = Agent A \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>T. a = Number T \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>N. a = Nonce N \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>K. a = EphK K \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X. a = Hash X \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Pair X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Enc X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Aenc X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Sign X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Exp X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n P\"", "lemma payload_parts [simp, dest]:\n  \"\\<lbrakk> X \\<in> parts S; S \\<subseteq> payload \\<rbrakk> \\<Longrightarrow> X \\<in> payload\"", "lemma payload_parts_singleton [simp, dest]:\n  \"\\<lbrakk> X \\<in> parts {Y}; Y \\<in> payload \\<rbrakk> \\<Longrightarrow> X \\<in> payload\"", "lemma payload_analz [simp, dest]:\n  \"\\<lbrakk> X \\<in> analz S; S \\<subseteq> payload \\<rbrakk> \\<Longrightarrow> X \\<in> payload\"", "lemma payload_synth_analz: \n  \"\\<lbrakk> X \\<in> synth (analz S); S \\<subseteq> payload \\<rbrakk> \\<Longrightarrow> X \\<in> payload\"", "lemma synth_payload: \n  \"Y \\<inter> payload = {} \\<Longrightarrow> synth (X \\<union> Y) \\<subseteq> synth X \\<union> -payload\"", "lemma synth_payload2:\n  \"Y \\<inter> payload = {} \\<Longrightarrow> synth (Y \\<union> X) \\<subseteq> synth X \\<union> -payload\"", "lemma synth_idem_payload:\n  \"X \\<subseteq> synth Y \\<union> -payload \\<Longrightarrow> synth X \\<subseteq> synth Y \\<union> -payload\"", "lemma LtKeys_payload [dest]: \"NI \\<subseteq> payload \\<Longrightarrow> NI \\<inter> range LtK = {}\"", "lemma LtKeys_parts_payload [dest]: \"NI \\<subseteq> payload \\<Longrightarrow> parts NI \\<inter> range LtK = {}\"", "lemma LtKeys_parts_payload_singleton [elim]: \"X \\<in> payload \\<Longrightarrow> LtK Y \\<in> parts {X} \\<Longrightarrow> False\"", "lemma parts_of_LtKeys [simp]: \"K \\<subseteq> range LtK \\<Longrightarrow> parts K = K\"", "lemma keys_of_Ltk [intro!]: \"keys_of A \\<subseteq> range LtK\"", "lemma priK_keys_of [intro!]:\n  \"priK A \\<in> keys_of A\"", "lemma shrK_keys_of_1 [intro!]:\n  \"shrK A B \\<in> keys_of A\"", "lemma shrK_keys_of_2 [intro!]:\n  \"shrK B A \\<in> keys_of A\"", "lemma priK_keys_of_eq [dest]:\n  \"priK B \\<in> keys_of A \\<Longrightarrow> A = B\"", "lemma shrK_keys_of_eq [dest]:\n  \"shrK A B \\<in> keys_of C \\<Longrightarrow> A = C \\<or> B = C\"", "lemma def_keys_of [dest]:\n  \"K \\<in> keys_of A \\<Longrightarrow> K = priK A \\<or> (\\<exists> B. K = shrK A B \\<or> K = shrK B A)\"", "lemma parts_keys_of [simp]: \"parts (keys_of A) = keys_of A\"", "lemma analz_keys_of [simp]: \"analz (keys_of A) = keys_of A\"", "lemma Keys_badI:\n  \"\\<lbrakk> IK \\<inter> range LtK \\<subseteq> range pubK \\<union> priK`Bad \\<union> {shrK A B | A B. A \\<in> Bad \\<or> B \\<in> Bad}; \n     range pubK \\<subseteq> IK  \\<rbrakk>\n \\<Longrightarrow> Keys_bad IK Bad\"", "lemma Keys_badE [elim]: \n  \"\\<lbrakk> Keys_bad IK Bad;\n     \\<lbrakk> range pubK \\<subseteq> IK; \n       IK \\<inter> range LtK \\<subseteq> range pubK \\<union> \\<Union> (keys_of ` Bad)\\<rbrakk>\n   \\<Longrightarrow> P \\<rbrakk> \n \\<Longrightarrow> P\"", "lemma Keys_bad_Ltk [simp]:\n  \"Keys_bad (IK \\<inter> range LtK) Bad \\<longleftrightarrow> Keys_bad IK Bad\"", "lemma Keys_bad_priK_D: \"\\<lbrakk> priK A \\<in> IK; Keys_bad IK Bad \\<rbrakk> \\<Longrightarrow> A \\<in> Bad\"", "lemma Keys_bad_shrK_D: \"\\<lbrakk> shrK A B \\<in> IK; Keys_bad IK Bad \\<rbrakk> \\<Longrightarrow> A \\<in> Bad \\<or> B \\<in> Bad\"", "lemmas Keys_bad_dests [dest] = Keys_bad_priK_D Keys_bad_shrK_D", "lemma Keys_bad_insert_non_LtK: \n  \"X \\<notin> range LtK \\<Longrightarrow> Keys_bad (insert X IK) Bad \\<longleftrightarrow> Keys_bad IK Bad\"", "lemma Keys_bad_insert_pubK: \n  \"\\<lbrakk> Keys_bad IK Bad \\<rbrakk> \\<Longrightarrow> Keys_bad (insert (pubK A) IK) Bad\"", "lemma Keys_bad_insert_priK_bad: \n  \"\\<lbrakk> Keys_bad IK Bad; A \\<in> Bad \\<rbrakk> \\<Longrightarrow> Keys_bad (insert (priK A) IK) Bad\"", "lemma Keys_bad_insert_shrK_bad: \n  \"\\<lbrakk> Keys_bad IK Bad; A \\<in> Bad \\<or> B \\<in> Bad \\<rbrakk> \\<Longrightarrow> Keys_bad (insert (shrK A B) IK) Bad\"", "lemmas Keys_bad_insert_lemmas [simp] = \n  Keys_bad_insert_non_LtK Keys_bad_insert_pubK \n  Keys_bad_insert_priK_bad Keys_bad_insert_shrK_bad", "lemma Keys_bad_insert_Fake:\nassumes \"Keys_bad IK Bad\" \n    and \"parts IK \\<inter> range LtK \\<subseteq> IK\"\n    and \"X \\<in> synth (analz IK)\"\nshows \"Keys_bad (insert X IK) Bad\"", "lemma Keys_bad_insert_keys_of:\n  \"Keys_bad Ik Bad \\<Longrightarrow>\n   Keys_bad (keys_of A \\<union> Ik) (insert A Bad)\"", "lemma Keys_bad_insert_payload:\n  \"Keys_bad Ik Bad \\<Longrightarrow>\n   x \\<in> payload \\<Longrightarrow>\n   Keys_bad (insert x Ik) Bad\"", "lemma brokenD [dest!]:\n  \"(A, B) \\<in> broken K \\<Longrightarrow> priK A \\<in> K \\<or> priK B \\<in> K \\<or> shrK A B \\<in> K \\<or> shrK B A \\<in> K\"", "lemma brokenI [intro!]:\n  \"priK A \\<in> K \\<or> priK B \\<in> K \\<or> shrK A B \\<in> K \\<or> shrK B A \\<in> K \\<Longrightarrow> (A, B) \\<in> broken K\"", "lemma Enc_keys_cleanI:\n  \"\\<forall>X Y. Enc X Y \\<in> parts S \\<longrightarrow> Y \\<in> range LtK \\<union> payload \\<Longrightarrow> Enc_keys_clean S\"", "lemma Enc_keys_clean_mono: \n  \"Enc_keys_clean H \\<Longrightarrow> G \\<subseteq> H \\<Longrightarrow> Enc_keys_clean G\"  \\<comment> \\<open>anti-tone\\<close>", "lemma Enc_keys_clean_Un [simp]: \n  \"Enc_keys_clean (G \\<union> H) \\<longleftrightarrow> Enc_keys_clean G \\<and> Enc_keys_clean H\"", "lemma Enc_keys_clean_analz:\n  \"Enc X K \\<in> analz S \\<Longrightarrow> Enc_keys_clean S \\<Longrightarrow> K \\<in> range LtK \\<union> payload\"", "lemma Enc_keys_clean_Tags [simp,intro]: \"Enc_keys_clean Tags\"", "lemma Enc_keys_clean_LtKeys [simp,intro]: \"K \\<subseteq> range LtK \\<Longrightarrow> Enc_keys_clean K\"", "lemma Enc_keys_clean_payload [simp,intro]: \"NI \\<subseteq> payload \\<Longrightarrow> Enc_keys_clean NI\"", "lemma parts_PairSet:\n  \"parts (PairSet G H) \\<subseteq> PairSet G H \\<union> parts G \\<union> parts H\"", "lemma parts_EncSet:\n  \"parts (EncSet G K) \\<subseteq> EncSet G K \\<union> PairSet (range Agent) G  \\<union> range Agent \\<union>  parts G\"", "lemma parts_AencSet:\n  \"parts (AencSet G K) \\<subseteq> AencSet G K \\<union> PairSet (range Agent) G  \\<union> range Agent \\<union>  parts G\"", "lemma parts_SignSet:\n  \"parts (SignSet G K) \\<subseteq> SignSet G K \\<union> PairSet (range Agent) G  \\<union> range Agent \\<union>  parts G\"", "lemma parts_HashSet:\n  \"parts (HashSet G) \\<subseteq> HashSet G\"", "lemmas parts_msgSet = parts_PairSet parts_EncSet parts_AencSet parts_SignSet parts_HashSet", "lemmas parts_msgSetD = parts_msgSet [THEN [2] rev_subsetD]", "lemma Enc_keys_clean_PairSet_Agent_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (PairSet (Agent`X) G \\<union> H)\"", "lemma Enc_keys_clean_PairSet_Tag_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (PairSet Tags G \\<union> H)\"", "lemma Enc_keys_clean_AencSet_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (AencSet G K \\<union> H)\"", "lemma Enc_keys_clean_EncSet_Un: \n  \"K \\<subseteq> range LtK \\<Longrightarrow> Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (EncSet G K \\<union> H)\"", "lemma Enc_keys_clean_SignSet_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (SignSet G K \\<union> H)\"", "lemma Enc_keys_clean_HashSet_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (HashSet G \\<union> H)\"", "lemmas Enc_keys_clean_msgSet_Un =\n  Enc_keys_clean_PairSet_Tag_Un Enc_keys_clean_PairSet_Agent_Un\n  Enc_keys_clean_EncSet_Un Enc_keys_clean_AencSet_Un\n  Enc_keys_clean_SignSet_Un Enc_keys_clean_HashSet_Un", "lemma analz_Un_EncSet:\nassumes \"K \\<subseteq> range LtK\" and \"Enc_keys_clean (G \\<union> H)\" \nshows \"analz (EncSet G K \\<union> H) \\<subseteq> EncSet G K \\<union> analz (G \\<union> H)\"", "lemma analz_Un_EncSet2:\nassumes \"Enc_keys_clean H\" and \"K \\<subseteq> range LtK\" and \"K \\<inter> synth (analz H) = {}\"\nshows \"analz (EncSet G K \\<union> H) \\<subseteq> EncSet G K \\<union> analz H\"", "lemma analz_Un_AencSet:\nassumes \"K \\<subseteq> range LtK\" and \"Enc_keys_clean (G \\<union> H)\" \nshows \"analz (AencSet G K \\<union> H) \\<subseteq> AencSet G K \\<union> analz (G \\<union> H)\"", "lemma analz_Un_AencSet2:\nassumes \"Enc_keys_clean H\" and \"priK`Ag \\<inter> synth (analz H) = {}\"\nshows \"analz (AencSet G (pubK`Ag) \\<union> H) \\<subseteq> AencSet G (pubK`Ag) \\<union> analz H\"", "lemma analz_Un_PairSet:\n  \"analz (PairSet G G' \\<union> H) \\<subseteq> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\"", "lemma analz_Un_SignSet:\nassumes \"K \\<subseteq> range LtK\" and \"Enc_keys_clean (G \\<union> H)\"\nshows \"analz (SignSet G K \\<union> H) \\<subseteq> SignSet G K \\<union> analz (G \\<union> H)\"", "lemma analz_Un_Tag:\nassumes \"Enc_keys_clean H\"\nshows \"analz (Tags \\<union> H) \\<subseteq> Tags \\<union> analz H\"", "lemma analz_Un_AgentSet:\nshows \"analz (AgentSet \\<union> H) \\<subseteq> AgentSet \\<union> analz H\"", "lemma analz_Un_HashSet:\nassumes \"Enc_keys_clean H\" and \"G \\<subseteq> - payload\" \nshows \"analz (HashSet G  \\<union> H) \\<subseteq> HashSet G \\<union> analz H\""], "translations": [["", "lemma eq_rep_abs: \"eq x (Re (Ab x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eq x (Re (Ab x))", "by (simp add: Quotient3_msg rep_abs_rsp)"], ["", "lemma eq_cpayload:\n  assumes \"eq x y\" and \"x \\<in> cpayload\"\n  shows \"y \\<in> cpayload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> cpayload", "using assms"], ["proof (prove)\nusing this:\n  eq x y\n  x \\<in> cpayload\n\ngoal (1 subgoal):\n 1. y \\<in> cpayload", "by (induction x y rule: eq.induct, auto intro: cpayload.intros elim: cpayload.cases)"], ["", "lemma abs_payload: \"Ab x \\<in> payload \\<longleftrightarrow> x \\<in> cpayload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Ab x \\<in> payload) = (x \\<in> cpayload)", "by (auto simp add: payload_def msg.abs_eq_iff eq_cpayload eq_sym cpayload.intros \n         elim: cpayload.cases)"], ["", "lemma abs_cpayload_rep: \"x \\<in> Ab` cpayload \\<longleftrightarrow> Re x \\<in> cpayload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<in> Ab ` cpayload) = (Re x \\<in> cpayload)", "apply (auto elim: eq_cpayload [OF eq_rep_abs])"], ["proof (prove)\ngoal (1 subgoal):\n 1. Re x \\<in> cpayload \\<Longrightarrow> x \\<in> Ab ` cpayload", "apply (subgoal_tac \"x = Ab (Re x)\", auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Re x \\<in> cpayload \\<Longrightarrow> x = Ab (Re x)", "using Quotient3_abs_rep Quotient3_msg"], ["proof (prove)\nusing this:\n  Quotient3 ?R ?Abs ?Rep \\<Longrightarrow> ?Abs (?Rep ?a) = ?a\n  Quotient3 eq Ab Re\n\ngoal (1 subgoal):\n 1. Re x \\<in> cpayload \\<Longrightarrow> x = Ab (Re x)", "by fastforce"], ["", "lemma payload_rep_cpayload: \"Re x \\<in> cpayload \\<longleftrightarrow> x \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Re x \\<in> cpayload) = (x \\<in> payload)", "by (auto simp add: payload_def abs_cpayload_rep)"], ["", "text \\<open>Manual proof of payload introduction rules. Transfer does not work for these\\<close>"], ["", "declare cpayload.intros [intro]"], ["", "lemma payload_AgentI: \"Agent A \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Messages.Agent A \\<in> payload", "by (auto simp add: msg_defs abs_payload)"], ["", "lemma payload_NonceI: \"Nonce N \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Nonce N \\<in> payload", "by (auto simp add: msg_defs abs_payload)"], ["", "lemma payload_NumberI: \"Number N \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Number N \\<in> payload", "by (auto simp add: msg_defs abs_payload)"], ["", "lemma payload_EphKI: \"EphK X \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. EphK X \\<in> payload", "by (auto simp add: msg_defs abs_payload)"], ["", "lemma payload_HashI: \"x \\<in> payload \\<Longrightarrow> Hash x \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> payload \\<Longrightarrow> Hash x \\<in> payload", "by (auto simp add: msg_defs payload_rep_cpayload abs_payload)"], ["", "lemma payload_PairI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Pair x y \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> payload; y \\<in> payload\\<rbrakk>\n    \\<Longrightarrow> \\<langle>x, y\\<rangle> \\<in> payload", "by (auto simp add: msg_defs payload_rep_cpayload abs_payload)"], ["", "lemma payload_EncI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Enc x y \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> payload; y \\<in> payload\\<rbrakk>\n    \\<Longrightarrow> Enc x y \\<in> payload", "by (auto simp add: msg_defs payload_rep_cpayload abs_payload)"], ["", "lemma payload_AencI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Aenc x y \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> payload; y \\<in> payload\\<rbrakk>\n    \\<Longrightarrow> Aenc x y \\<in> payload", "by (auto simp add: msg_defs payload_rep_cpayload abs_payload)"], ["", "lemma payload_SignI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Sign x y \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> payload; y \\<in> payload\\<rbrakk>\n    \\<Longrightarrow> Sign x y \\<in> payload", "by (auto simp add: msg_defs payload_rep_cpayload abs_payload)"], ["", "lemma payload_ExpI: \"x \\<in> payload \\<Longrightarrow> y \\<in> payload \\<Longrightarrow> Exp x y \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> payload; y \\<in> payload\\<rbrakk>\n    \\<Longrightarrow> Exp x y \\<in> payload", "by (auto simp add: msg_defs payload_rep_cpayload abs_payload)"], ["", "lemmas payload_intros [simp, intro] =\n  payload_AgentI payload_NonceI payload_NumberI payload_EphKI payload_HashI\n  payload_PairI payload_EncI payload_AencI payload_SignI payload_ExpI"], ["", "text \\<open>Manual proof of payload inversion rules, transfer does not work for these.\\<close>"], ["", "declare cpayload.cases[elim]"], ["", "lemma payload_Tag: \"Tag X \\<in> payload \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Tag X \\<in> payload \\<Longrightarrow> P", "apply (auto simp add: payload_def msg_defs msg.abs_eq_iff eq_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>eq x (cTag X); x \\<in> cpayload\\<rbrakk> \\<Longrightarrow> P", "apply (auto dest!: eq_cpayload simp add: abs_cpayload_rep)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma payload_LtK: \"LtK X \\<in> payload \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LtK X \\<in> payload \\<Longrightarrow> P", "apply (auto simp add: payload_def msg_defs msg.abs_eq_iff eq_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>eq x (cLtK X); x \\<in> cpayload\\<rbrakk> \\<Longrightarrow> P", "apply (auto dest!: eq_cpayload simp add: abs_cpayload_rep)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma payload_Hash: \"Hash X \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Hash X \\<in> payload;\n     X \\<in> payload \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply (auto simp add: payload_def msg_defs msg.abs_eq_iff eq_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>X \\<in> Ab ` cpayload \\<Longrightarrow> P;\n        eq x (cHash (Re X)); x \\<in> cpayload\\<rbrakk>\n       \\<Longrightarrow> P", "apply (auto dest!: eq_cpayload simp add: abs_cpayload_rep)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma payload_Pair: \"Pair X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> payload;\n     \\<lbrakk>X \\<in> payload; Y \\<in> payload\\<rbrakk>\n     \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply (auto simp add: payload_def msg_defs msg.abs_eq_iff eq_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<lbrakk>X \\<in> Ab ` cpayload;\n                 Y \\<in> Ab ` cpayload\\<rbrakk>\n                \\<Longrightarrow> P;\n        eq x (cPair (Re X) (Re Y)); x \\<in> cpayload\\<rbrakk>\n       \\<Longrightarrow> P", "apply (auto dest!: eq_cpayload simp add: abs_cpayload_rep)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma payload_Enc: \"Enc X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Enc X Y \\<in> payload;\n     \\<lbrakk>X \\<in> payload; Y \\<in> payload\\<rbrakk>\n     \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply (auto simp add: payload_def msg_defs msg.abs_eq_iff eq_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<lbrakk>X \\<in> Ab ` cpayload;\n                 Y \\<in> Ab ` cpayload\\<rbrakk>\n                \\<Longrightarrow> P;\n        eq x (cEnc (Re X) (Re Y)); x \\<in> cpayload\\<rbrakk>\n       \\<Longrightarrow> P", "apply (auto dest!: eq_cpayload simp add: abs_cpayload_rep)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma payload_Aenc: \"Aenc X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Aenc X Y \\<in> payload;\n     \\<lbrakk>X \\<in> payload; Y \\<in> payload\\<rbrakk>\n     \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply (auto simp add: payload_def msg_defs msg.abs_eq_iff eq_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<lbrakk>X \\<in> Ab ` cpayload;\n                 Y \\<in> Ab ` cpayload\\<rbrakk>\n                \\<Longrightarrow> P;\n        eq x (cAenc (Re X) (Re Y)); x \\<in> cpayload\\<rbrakk>\n       \\<Longrightarrow> P", "apply (auto dest!: eq_cpayload simp add: abs_cpayload_rep)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma payload_Sign: \"Sign X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Sign X Y \\<in> payload;\n     \\<lbrakk>X \\<in> payload; Y \\<in> payload\\<rbrakk>\n     \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply (auto simp add: payload_def msg_defs msg.abs_eq_iff eq_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<lbrakk>X \\<in> Ab ` cpayload;\n                 Y \\<in> Ab ` cpayload\\<rbrakk>\n                \\<Longrightarrow> P;\n        eq x (cSign (Re X) (Re Y)); x \\<in> cpayload\\<rbrakk>\n       \\<Longrightarrow> P", "apply (auto dest!: eq_cpayload simp add: abs_cpayload_rep)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma payload_Exp: \"Exp X Y \\<in> payload \\<Longrightarrow> (X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Exp X Y \\<in> payload;\n     \\<lbrakk>X \\<in> payload; Y \\<in> payload\\<rbrakk>\n     \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply (auto simp add: payload_def Exp_def msg.abs_eq_iff eq_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<lbrakk>X \\<in> Ab ` cpayload;\n                 Y \\<in> Ab ` cpayload\\<rbrakk>\n                \\<Longrightarrow> P;\n        eq x (cExp (Re X) (Re Y)); x \\<in> cpayload\\<rbrakk>\n       \\<Longrightarrow> P", "apply (auto dest!: eq_cpayload simp add: abs_cpayload_rep)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "declare cpayload.intros[rule del]"], ["", "declare cpayload.cases[rule del]"], ["", "lemmas payload_inductive_cases =\n  payload_Tag payload_LtK payload_Hash\n  payload_Pair payload_Enc payload_Aenc payload_Sign payload_Exp"], ["", "lemma eq_exhaust:\n\"(\\<And>x. eq y (cAgent x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cNumber x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cNonce x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cLtK x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cEphK x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cHash x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. eq y (cTag x) \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P) \\<Longrightarrow>\n P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n     \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n     \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n     \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n     \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n     \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n     \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n     \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n     \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n     \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n     \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n     \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply (cases y)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cAgent x1\\<rbrakk>\n       \\<Longrightarrow> P\n 2. \\<And>x2.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cNumber x2\\<rbrakk>\n       \\<Longrightarrow> P\n 3. \\<And>x3.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cNonce x3\\<rbrakk>\n       \\<Longrightarrow> P\n 4. \\<And>x4.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cLtK x4\\<rbrakk>\n       \\<Longrightarrow> P\n 5. \\<And>x5.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cEphK x5\\<rbrakk>\n       \\<Longrightarrow> P\n 6. \\<And>x61 x62.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cPair x61 x62\\<rbrakk>\n       \\<Longrightarrow> P\n 7. \\<And>x71 x72.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cEnc x71 x72\\<rbrakk>\n       \\<Longrightarrow> P\n 8. \\<And>x81 x82.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cAenc x81 x82\\<rbrakk>\n       \\<Longrightarrow> P\n 9. \\<And>x91 x92.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n        y = cSign x91 x92\\<rbrakk>\n       \\<Longrightarrow> P\n 10. \\<And>x10.\n        \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n         \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n         \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n         \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n         \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n         \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n         \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n         \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n         \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n         \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n         \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n         \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P;\n         y = cHash x10\\<rbrakk>\n        \\<Longrightarrow> P\nA total of 12 subgoals...", "apply (meson Messages.eq_refl)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma msg_exhaust:\n\"(\\<And>x. y = Agent x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = Number x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = Nonce x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = LtK x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = EphK x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Pair x x' \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Enc x x' \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Aenc x x' \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Sign x x' \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = Hash x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x. y = Tag x \\<Longrightarrow> P) \\<Longrightarrow>\n (\\<And>x x'. y = Exp x x' \\<Longrightarrow> P) \\<Longrightarrow>\n P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x. y = Messages.Agent x \\<Longrightarrow> P;\n     \\<And>x. y = Number x \\<Longrightarrow> P;\n     \\<And>x. y = Nonce x \\<Longrightarrow> P;\n     \\<And>x. y = LtK x \\<Longrightarrow> P;\n     \\<And>x. y = EphK x \\<Longrightarrow> P;\n     \\<And>x x'. y = \\<langle>x, x'\\<rangle> \\<Longrightarrow> P;\n     \\<And>x x'. y = Enc x x' \\<Longrightarrow> P;\n     \\<And>x x'. y = Aenc x x' \\<Longrightarrow> P;\n     \\<And>x x'. y = Sign x x' \\<Longrightarrow> P;\n     \\<And>x. y = Hash x \\<Longrightarrow> P;\n     \\<And>x. y = Tag x \\<Longrightarrow> P;\n     \\<And>x x'. y = Exp x x' \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply transfer"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y P.\n       \\<lbrakk>\\<And>x. eq y (cAgent x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNumber x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cNonce x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cLtK x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cEphK x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cPair x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cEnc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cAenc x x') \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cSign x x') \\<Longrightarrow> P;\n        \\<And>x. eq y (cHash x) \\<Longrightarrow> P;\n        \\<And>x. eq y (cTag x) \\<Longrightarrow> P;\n        \\<And>x x'. eq y (cExp x x') \\<Longrightarrow> P\\<rbrakk>\n       \\<Longrightarrow> P", "apply (erule eq_exhaust, auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma payload_cases: \n\"a \\<in> payload \\<Longrightarrow>\n(\\<And>A. a = Agent A \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>T. a = Number T \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>N. a = Nonce N \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>K. a = EphK K \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X. a = Hash X \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Pair X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Enc X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Aenc X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Sign X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n(\\<And>X Y. a = Exp X Y \\<Longrightarrow> X \\<in> payload \\<Longrightarrow> Y \\<in> payload \\<Longrightarrow> P) \\<Longrightarrow>\n P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> payload;\n     \\<And>A. a = Messages.Agent A \\<Longrightarrow> P;\n     \\<And>T. a = Number T \\<Longrightarrow> P;\n     \\<And>N. a = Nonce N \\<Longrightarrow> P;\n     \\<And>K. a = EphK K \\<Longrightarrow> P;\n     \\<And>X.\n        \\<lbrakk>a = Hash X; X \\<in> payload\\<rbrakk> \\<Longrightarrow> P;\n     \\<And>X Y.\n        \\<lbrakk>a = \\<langle>X, Y\\<rangle>; X \\<in> payload;\n         Y \\<in> payload\\<rbrakk>\n        \\<Longrightarrow> P;\n     \\<And>X Y.\n        \\<lbrakk>a = Enc X Y; X \\<in> payload; Y \\<in> payload\\<rbrakk>\n        \\<Longrightarrow> P;\n     \\<And>X Y.\n        \\<lbrakk>a = Aenc X Y; X \\<in> payload; Y \\<in> payload\\<rbrakk>\n        \\<Longrightarrow> P;\n     \\<And>X Y.\n        \\<lbrakk>a = Sign X Y; X \\<in> payload; Y \\<in> payload\\<rbrakk>\n        \\<Longrightarrow> P;\n     \\<And>X Y.\n        \\<lbrakk>a = Exp X Y; X \\<in> payload; Y \\<in> payload\\<rbrakk>\n        \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "by (erule msg_exhaust [of a], auto elim: payload_inductive_cases)"], ["", "declare payload_cases [elim]"], ["", "declare payload_inductive_cases [elim]"], ["", "text \\<open>Properties of payload; messages constructed from payload messages are also payloads.\\<close>"], ["", "lemma payload_parts [simp, dest]:\n  \"\\<lbrakk> X \\<in> parts S; S \\<subseteq> payload \\<rbrakk> \\<Longrightarrow> X \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> parts S; S \\<subseteq> payload\\<rbrakk>\n    \\<Longrightarrow> X \\<in> payload", "by (erule parts.induct) (auto)"], ["", "lemma payload_parts_singleton [simp, dest]:\n  \"\\<lbrakk> X \\<in> parts {Y}; Y \\<in> payload \\<rbrakk> \\<Longrightarrow> X \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> parts {Y}; Y \\<in> payload\\<rbrakk>\n    \\<Longrightarrow> X \\<in> payload", "by (erule parts.induct) (auto)"], ["", "lemma payload_analz [simp, dest]:\n  \"\\<lbrakk> X \\<in> analz S; S \\<subseteq> payload \\<rbrakk> \\<Longrightarrow> X \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> analz S; S \\<subseteq> payload\\<rbrakk>\n    \\<Longrightarrow> X \\<in> payload", "by (auto dest: analz_into_parts)"], ["", "lemma payload_synth_analz: \n  \"\\<lbrakk> X \\<in> synth (analz S); S \\<subseteq> payload \\<rbrakk> \\<Longrightarrow> X \\<in> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> synth (analz S); S \\<subseteq> payload\\<rbrakk>\n    \\<Longrightarrow> X \\<in> payload", "by (erule synth.induct) (auto intro: payload_analz)"], ["", "text \\<open>Important lemma: using messages with implementation material one can only \nsynthesise more such messages.\\<close>"], ["", "lemma synth_payload: \n  \"Y \\<inter> payload = {} \\<Longrightarrow> synth (X \\<union> Y) \\<subseteq> synth X \\<union> -payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y \\<inter> payload = {} \\<Longrightarrow>\n    synth (X \\<union> Y) \\<subseteq> synth X \\<union> - payload", "by (rule, erule synth.induct) (auto)"], ["", "lemma synth_payload2:\n  \"Y \\<inter> payload = {} \\<Longrightarrow> synth (Y \\<union> X) \\<subseteq> synth X \\<union> -payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y \\<inter> payload = {} \\<Longrightarrow>\n    synth (Y \\<union> X) \\<subseteq> synth X \\<union> - payload", "by (rule, erule synth.induct) (auto)"], ["", "text \\<open>Lemma: in the case of the previous lemma, @{term synth} can be applied on the \nleft with no consequence.\\<close>"], ["", "lemma synth_idem_payload:\n  \"X \\<subseteq> synth Y \\<union> -payload \\<Longrightarrow> synth X \\<subseteq> synth Y \\<union> -payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<subseteq> synth Y \\<union> - payload \\<Longrightarrow>\n    synth X \\<subseteq> synth Y \\<union> - payload", "by (auto dest: synth_mono subset_trans [OF _ synth_payload])"], ["", "subsection \\<open>\\<open>isLtKey\\<close>: is a long term key\\<close>"], ["", "(**************************************************************************************************)"], ["", "lemma LtKeys_payload [dest]: \"NI \\<subseteq> payload \\<Longrightarrow> NI \\<inter> range LtK = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. NI \\<subseteq> payload \\<Longrightarrow> NI \\<inter> range LtK = {}", "by (auto)"], ["", "lemma LtKeys_parts_payload [dest]: \"NI \\<subseteq> payload \\<Longrightarrow> parts NI \\<inter> range LtK = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. NI \\<subseteq> payload \\<Longrightarrow>\n    parts NI \\<inter> range LtK = {}", "by (auto)"], ["", "lemma LtKeys_parts_payload_singleton [elim]: \"X \\<in> payload \\<Longrightarrow> LtK Y \\<in> parts {X} \\<Longrightarrow> False\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> payload; LtK Y \\<in> parts {X}\\<rbrakk>\n    \\<Longrightarrow> False", "by (auto)"], ["", "lemma parts_of_LtKeys [simp]: \"K \\<subseteq> range LtK \\<Longrightarrow> parts K = K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K \\<subseteq> range LtK \\<Longrightarrow> parts K = K", "by (rule, rule, erule parts.induct, auto)"], ["", "subsection\\<open>\\<open>keys_of\\<close>: the long term keys of an agent\\<close>"], ["", "(**************************************************************************************************)"], ["", "definition\n  keys_of :: \"agent \\<Rightarrow> msg set\"\nwhere\n  \"keys_of A \\<equiv> insert (priK A) {shrK B C | B C. B = A \\<or> C = A}\""], ["", "lemma keys_of_Ltk [intro!]: \"keys_of A \\<subseteq> range LtK\""], ["proof (prove)\ngoal (1 subgoal):\n 1. keys_of A \\<subseteq> range LtK", "by (auto simp add: keys_of_def)"], ["", "lemma priK_keys_of [intro!]:\n  \"priK A \\<in> keys_of A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. priK A \\<in> keys_of A", "by (simp add: keys_of_def)"], ["", "lemma shrK_keys_of_1 [intro!]:\n  \"shrK A B \\<in> keys_of A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. shrK A B \\<in> keys_of A", "by (simp add: keys_of_def)"], ["", "lemma shrK_keys_of_2 [intro!]:\n  \"shrK B A \\<in> keys_of A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. shrK B A \\<in> keys_of A", "by (simp add: keys_of_def)"], ["", "lemma priK_keys_of_eq [dest]:\n  \"priK B \\<in> keys_of A \\<Longrightarrow> A = B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. priK B \\<in> keys_of A \\<Longrightarrow> A = B", "by (simp add: keys_of_def)"], ["", "lemma shrK_keys_of_eq [dest]:\n  \"shrK A B \\<in> keys_of C \\<Longrightarrow> A = C \\<or> B = C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. shrK A B \\<in> keys_of C \\<Longrightarrow> A = C \\<or> B = C", "by (simp add: keys_of_def)"], ["", "lemma def_keys_of [dest]:\n  \"K \\<in> keys_of A \\<Longrightarrow> K = priK A \\<or> (\\<exists> B. K = shrK A B \\<or> K = shrK B A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K \\<in> keys_of A \\<Longrightarrow>\n    K = priK A \\<or> (\\<exists>B. K = shrK A B \\<or> K = shrK B A)", "by (auto simp add: keys_of_def)"], ["", "lemma parts_keys_of [simp]: \"parts (keys_of A) = keys_of A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. parts (keys_of A) = keys_of A", "by (auto intro!: parts_of_LtKeys)"], ["", "lemma analz_keys_of [simp]: \"analz (keys_of A) = keys_of A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (keys_of A) = keys_of A", "by (rule, rule, erule analz.induct, auto)"], ["", "subsection \\<open>\\<open>Keys_bad\\<close>: bounds on the attacker's knowledge of long-term keys.\\<close>"], ["", "(**************************************************************************************************)"], ["", "text \\<open>A set of keys contains all public long term keys, and only the private/shared keys \nof bad agents.\\<close>"], ["", "definition\n  Keys_bad :: \"msg set \\<Rightarrow> agent set \\<Rightarrow> bool\"\nwhere\n  \"Keys_bad IK Bad \\<equiv>    \n    IK \\<inter> range LtK \\<subseteq> range pubK \\<union> \\<Union> (keys_of ` Bad)\n    \\<and> range pubK \\<subseteq> IK\"\n\n\\<comment> \\<open>basic lemmas\\<close>"], ["", "lemma Keys_badI:\n  \"\\<lbrakk> IK \\<inter> range LtK \\<subseteq> range pubK \\<union> priK`Bad \\<union> {shrK A B | A B. A \\<in> Bad \\<or> B \\<in> Bad}; \n     range pubK \\<subseteq> IK  \\<rbrakk>\n \\<Longrightarrow> Keys_bad IK Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>IK \\<inter> range LtK\n             \\<subseteq> range pubK \\<union> priK ` Bad \\<union>\n                         {shrK A B |A B. A \\<in> Bad \\<or> B \\<in> Bad};\n     range pubK \\<subseteq> IK\\<rbrakk>\n    \\<Longrightarrow> Keys_bad IK Bad", "by (auto simp add: Keys_bad_def)"], ["", "lemma Keys_badE [elim]: \n  \"\\<lbrakk> Keys_bad IK Bad;\n     \\<lbrakk> range pubK \\<subseteq> IK; \n       IK \\<inter> range LtK \\<subseteq> range pubK \\<union> \\<Union> (keys_of ` Bad)\\<rbrakk>\n   \\<Longrightarrow> P \\<rbrakk> \n \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Keys_bad IK Bad;\n     \\<lbrakk>range pubK \\<subseteq> IK;\n      IK \\<inter> range LtK\n      \\<subseteq> range pubK \\<union> \\<Union> (keys_of ` Bad)\\<rbrakk>\n     \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "by (auto simp add: Keys_bad_def)"], ["", "lemma Keys_bad_Ltk [simp]:\n  \"Keys_bad (IK \\<inter> range LtK) Bad \\<longleftrightarrow> Keys_bad IK Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Keys_bad (IK \\<inter> range LtK) Bad = Keys_bad IK Bad", "by (auto simp add: Keys_bad_def)"], ["", "lemma Keys_bad_priK_D: \"\\<lbrakk> priK A \\<in> IK; Keys_bad IK Bad \\<rbrakk> \\<Longrightarrow> A \\<in> Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>priK A \\<in> IK; Keys_bad IK Bad\\<rbrakk>\n    \\<Longrightarrow> A \\<in> Bad", "by (auto simp add: Keys_bad_def)"], ["", "lemma Keys_bad_shrK_D: \"\\<lbrakk> shrK A B \\<in> IK; Keys_bad IK Bad \\<rbrakk> \\<Longrightarrow> A \\<in> Bad \\<or> B \\<in> Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>shrK A B \\<in> IK; Keys_bad IK Bad\\<rbrakk>\n    \\<Longrightarrow> A \\<in> Bad \\<or> B \\<in> Bad", "by (auto simp add: Keys_bad_def)"], ["", "lemmas Keys_bad_dests [dest] = Keys_bad_priK_D Keys_bad_shrK_D"], ["", "text \\<open>interaction with @{term insert}.\\<close>"], ["", "lemma Keys_bad_insert_non_LtK: \n  \"X \\<notin> range LtK \\<Longrightarrow> Keys_bad (insert X IK) Bad \\<longleftrightarrow> Keys_bad IK Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<notin> range LtK \\<Longrightarrow>\n    Keys_bad (insert X IK) Bad = Keys_bad IK Bad", "by (auto simp add: Keys_bad_def)"], ["", "lemma Keys_bad_insert_pubK: \n  \"\\<lbrakk> Keys_bad IK Bad \\<rbrakk> \\<Longrightarrow> Keys_bad (insert (pubK A) IK) Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Keys_bad IK Bad \\<Longrightarrow> Keys_bad (insert (pubK A) IK) Bad", "by (auto simp add: Keys_bad_def)"], ["", "lemma Keys_bad_insert_priK_bad: \n  \"\\<lbrakk> Keys_bad IK Bad; A \\<in> Bad \\<rbrakk> \\<Longrightarrow> Keys_bad (insert (priK A) IK) Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Keys_bad IK Bad; A \\<in> Bad\\<rbrakk>\n    \\<Longrightarrow> Keys_bad (insert (priK A) IK) Bad", "by (auto simp add: Keys_bad_def)"], ["", "lemma Keys_bad_insert_shrK_bad: \n  \"\\<lbrakk> Keys_bad IK Bad; A \\<in> Bad \\<or> B \\<in> Bad \\<rbrakk> \\<Longrightarrow> Keys_bad (insert (shrK A B) IK) Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Keys_bad IK Bad; A \\<in> Bad \\<or> B \\<in> Bad\\<rbrakk>\n    \\<Longrightarrow> Keys_bad (insert (shrK A B) IK) Bad", "by (auto simp add: Keys_bad_def)"], ["", "lemmas Keys_bad_insert_lemmas [simp] = \n  Keys_bad_insert_non_LtK Keys_bad_insert_pubK \n  Keys_bad_insert_priK_bad Keys_bad_insert_shrK_bad"], ["", "lemma Keys_bad_insert_Fake:\nassumes \"Keys_bad IK Bad\" \n    and \"parts IK \\<inter> range LtK \\<subseteq> IK\"\n    and \"X \\<in> synth (analz IK)\"\nshows \"Keys_bad (insert X IK) Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Keys_bad (insert X IK) Bad", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> Keys_bad (insert X IK) Bad\n 2. \\<not> ?P \\<Longrightarrow> Keys_bad (insert X IK) Bad", "assume \"X \\<in> range LtK\""], ["proof (state)\nthis:\n  X \\<in> range LtK\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> Keys_bad (insert X IK) Bad\n 2. \\<not> ?P \\<Longrightarrow> Keys_bad (insert X IK) Bad", "then"], ["proof (chain)\npicking this:\n  X \\<in> range LtK", "obtain ltk where \"X = LtK ltk\""], ["proof (prove)\nusing this:\n  X \\<in> range LtK\n\ngoal (1 subgoal):\n 1. (\\<And>ltk. X = LtK ltk \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  X = LtK ltk\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> Keys_bad (insert X IK) Bad\n 2. \\<not> ?P \\<Longrightarrow> Keys_bad (insert X IK) Bad", "thus ?thesis"], ["proof (prove)\nusing this:\n  X = LtK ltk\n\ngoal (1 subgoal):\n 1. Keys_bad (insert X IK) Bad", "using assms"], ["proof (prove)\nusing this:\n  X = LtK ltk\n  Keys_bad IK Bad\n  parts IK \\<inter> range LtK \\<subseteq> IK\n  X \\<in> synth (analz IK)\n\ngoal (1 subgoal):\n 1. Keys_bad (insert X IK) Bad", "by (auto simp add: insert_absorb dest: analz_into_parts)"], ["proof (state)\nthis:\n  Keys_bad (insert X IK) Bad\n\ngoal (1 subgoal):\n 1. X \\<notin> range LtK \\<Longrightarrow> Keys_bad (insert X IK) Bad", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. X \\<notin> range LtK \\<Longrightarrow> Keys_bad (insert X IK) Bad", "assume \"X \\<notin> range LtK\""], ["proof (state)\nthis:\n  X \\<notin> range LtK\n\ngoal (1 subgoal):\n 1. X \\<notin> range LtK \\<Longrightarrow> Keys_bad (insert X IK) Bad", "thus ?thesis"], ["proof (prove)\nusing this:\n  X \\<notin> range LtK\n\ngoal (1 subgoal):\n 1. Keys_bad (insert X IK) Bad", "using assms(1)"], ["proof (prove)\nusing this:\n  X \\<notin> range LtK\n  Keys_bad IK Bad\n\ngoal (1 subgoal):\n 1. Keys_bad (insert X IK) Bad", "by simp"], ["proof (state)\nthis:\n  Keys_bad (insert X IK) Bad\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Keys_bad_insert_keys_of:\n  \"Keys_bad Ik Bad \\<Longrightarrow>\n   Keys_bad (keys_of A \\<union> Ik) (insert A Bad)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Keys_bad Ik Bad \\<Longrightarrow>\n    Keys_bad (keys_of A \\<union> Ik) (insert A Bad)", "by (auto simp add: Keys_bad_def)"], ["", "lemma Keys_bad_insert_payload:\n  \"Keys_bad Ik Bad \\<Longrightarrow>\n   x \\<in> payload \\<Longrightarrow>\n   Keys_bad (insert x Ik) Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Keys_bad Ik Bad; x \\<in> payload\\<rbrakk>\n    \\<Longrightarrow> Keys_bad (insert x Ik) Bad", "by (auto simp add: Keys_bad_def)"], ["", "subsection \\<open>\\<open>broken K\\<close>: pairs of agents where at least one is compromised.\\<close>"], ["", "(**************************************************************************************************)"], ["", "text \\<open>Set of pairs (A,B) such that the priK of A or B, or their shared key, is in K\\<close>"], ["", "definition\n  broken :: \"msg set \\<Rightarrow> (agent * agent) set\"\nwhere\n  \"broken K \\<equiv> {(A,B) | A B. priK A \\<in> K \\<or> priK B \\<in> K \\<or> shrK A B \\<in> K \\<or> shrK B A \\<in> K}\""], ["", "lemma brokenD [dest!]:\n  \"(A, B) \\<in> broken K \\<Longrightarrow> priK A \\<in> K \\<or> priK B \\<in> K \\<or> shrK A B \\<in> K \\<or> shrK B A \\<in> K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (A, B) \\<in> broken K \\<Longrightarrow>\n    priK A \\<in> K \\<or>\n    priK B \\<in> K \\<or> shrK A B \\<in> K \\<or> shrK B A \\<in> K", "by (simp add: broken_def)"], ["", "lemma brokenI [intro!]:\n  \"priK A \\<in> K \\<or> priK B \\<in> K \\<or> shrK A B \\<in> K \\<or> shrK B A \\<in> K \\<Longrightarrow> (A, B) \\<in> broken K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. priK A \\<in> K \\<or>\n    priK B \\<in> K \\<or>\n    shrK A B \\<in> K \\<or> shrK B A \\<in> K \\<Longrightarrow>\n    (A, B) \\<in> broken K", "by (auto simp add: broken_def)"], ["", "subsection \\<open>\\<open>Enc_keys_clean S\\<close>: messages with ``clean'' symmetric encryptions.\\<close>"], ["", "(**************************************************************************************************)"], ["", "text \\<open>All terms used as symmetric keys in S are either long term keys or messages without \nimplementation material.\\<close>"], ["", "definition\n  Enc_keys_clean :: \"msg set \\<Rightarrow> bool\"\nwhere\n  \"Enc_keys_clean S \\<equiv> \\<forall>X Y. Enc X Y \\<in> parts S \\<longrightarrow> Y \\<in> range LtK \\<union> payload\""], ["", "lemma Enc_keys_cleanI:\n  \"\\<forall>X Y. Enc X Y \\<in> parts S \\<longrightarrow> Y \\<in> range LtK \\<union> payload \\<Longrightarrow> Enc_keys_clean S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>X Y.\n       Enc X Y \\<in> parts S \\<longrightarrow>\n       Y \\<in> range LtK \\<union> payload \\<Longrightarrow>\n    Enc_keys_clean S", "by (simp add: Enc_keys_clean_def)\n\n\\<comment> \\<open>general lemmas about \\<open>Enc_keys_clean\\<close>\\<close>"], ["", "lemma Enc_keys_clean_mono: \n  \"Enc_keys_clean H \\<Longrightarrow> G \\<subseteq> H \\<Longrightarrow> Enc_keys_clean G\"  \\<comment> \\<open>anti-tone\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Enc_keys_clean H; G \\<subseteq> H\\<rbrakk>\n    \\<Longrightarrow> Enc_keys_clean G", "by (auto simp add: Enc_keys_clean_def dest!: parts_monotone [where G=G])"], ["", "lemma Enc_keys_clean_Un [simp]: \n  \"Enc_keys_clean (G \\<union> H) \\<longleftrightarrow> Enc_keys_clean G \\<and> Enc_keys_clean H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Enc_keys_clean (G \\<union> H) =\n    (Enc_keys_clean G \\<and> Enc_keys_clean H)", "by (auto simp add: Enc_keys_clean_def)\n\n\n\\<comment> \\<open>from \\<open>Enc_keys_clean S\\<close>, the property on \\<open>parts S\\<close> also holds for \\<open>analz S\\<close>\\<close>"], ["", "lemma Enc_keys_clean_analz:\n  \"Enc X K \\<in> analz S \\<Longrightarrow> Enc_keys_clean S \\<Longrightarrow> K \\<in> range LtK \\<union> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Enc X K \\<in> analz S; Enc_keys_clean S\\<rbrakk>\n    \\<Longrightarrow> K \\<in> range LtK \\<union> payload", "by (auto simp add: Enc_keys_clean_def dest: analz_into_parts)\n\n\n\\<comment> \\<open>\\<open>Enc_keys_clean\\<close> and different types of messages\\<close>"], ["", "lemma Enc_keys_clean_Tags [simp,intro]: \"Enc_keys_clean Tags\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Enc_keys_clean Tags", "by (auto simp add: Enc_keys_clean_def)"], ["", "lemma Enc_keys_clean_LtKeys [simp,intro]: \"K \\<subseteq> range LtK \\<Longrightarrow> Enc_keys_clean K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K \\<subseteq> range LtK \\<Longrightarrow> Enc_keys_clean K", "by (auto simp add: Enc_keys_clean_def)"], ["", "lemma Enc_keys_clean_payload [simp,intro]: \"NI \\<subseteq> payload \\<Longrightarrow> Enc_keys_clean NI\""], ["proof (prove)\ngoal (1 subgoal):\n 1. NI \\<subseteq> payload \\<Longrightarrow> Enc_keys_clean NI", "by (auto simp add: Enc_keys_clean_def)"], ["", "subsection \\<open>Sets of messages with particular constructors\\<close>"], ["", "(**************************************************************************************************)"], ["", "text \\<open>Sets of all pairs, ciphertexts, and signatures constructed from a set of messages.\\<close>"], ["", "(*\n FIX: These should probably be turned into definitions, since they may create automation problems \n*)"], ["", "abbreviation AgentSet :: \"msg set\"\nwhere \"AgentSet \\<equiv> range Agent\""], ["", "abbreviation PairSet :: \"msg set \\<Rightarrow> msg set \\<Rightarrow> msg set\"\nwhere \"PairSet G H \\<equiv> {Pair X Y | X Y. X \\<in> G \\<and> Y \\<in> H}\""], ["", "abbreviation EncSet :: \"msg set \\<Rightarrow> msg set \\<Rightarrow> msg set\"\nwhere \"EncSet G K \\<equiv> {Enc X Y | X Y. X \\<in> G \\<and> Y \\<in> K}\""], ["", "abbreviation AencSet :: \"msg set \\<Rightarrow> msg set \\<Rightarrow> msg set\"\nwhere \"AencSet G K \\<equiv> {Aenc X Y | X Y. X \\<in> G \\<and> Y \\<in> K}\""], ["", "abbreviation SignSet :: \"msg set \\<Rightarrow> msg set \\<Rightarrow> msg set\"\nwhere \"SignSet G K \\<equiv> {Sign X Y | X Y. X \\<in> G \\<and> Y \\<in> K}\""], ["", "abbreviation HashSet :: \"msg set \\<Rightarrow> msg set\"\nwhere \"HashSet G \\<equiv> {Hash X | X. X \\<in> G}\""], ["", "text \\<open>Move @{term Enc}, @{term Aenc}, @{term Sign}, and @{term Pair} sets out of @{term parts}. \n\\<close>"], ["", "lemma parts_PairSet:\n  \"parts (PairSet G H) \\<subseteq> PairSet G H \\<union> parts G \\<union> parts H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. parts (PairSet G H)\n    \\<subseteq> PairSet G H \\<union> parts G \\<union> parts H", "by (rule, erule parts.induct, auto)"], ["", "lemma parts_EncSet:\n  \"parts (EncSet G K) \\<subseteq> EncSet G K \\<union> PairSet (range Agent) G  \\<union> range Agent \\<union>  parts G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. parts (EncSet G K)\n    \\<subseteq> EncSet G K \\<union> PairSet AgentSet G \\<union>\n                AgentSet \\<union>\n                parts G", "by (rule, erule parts.induct, auto)"], ["", "lemma parts_AencSet:\n  \"parts (AencSet G K) \\<subseteq> AencSet G K \\<union> PairSet (range Agent) G  \\<union> range Agent \\<union>  parts G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. parts (AencSet G K)\n    \\<subseteq> AencSet G K \\<union> PairSet AgentSet G \\<union>\n                AgentSet \\<union>\n                parts G", "by (rule, erule parts.induct, auto)"], ["", "lemma parts_SignSet:\n  \"parts (SignSet G K) \\<subseteq> SignSet G K \\<union> PairSet (range Agent) G  \\<union> range Agent \\<union>  parts G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. parts (SignSet G K)\n    \\<subseteq> SignSet G K \\<union> PairSet AgentSet G \\<union>\n                AgentSet \\<union>\n                parts G", "by (rule, erule parts.induct, auto)"], ["", "lemma parts_HashSet:\n  \"parts (HashSet G) \\<subseteq> HashSet G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. parts (HashSet G) \\<subseteq> HashSet G", "by (rule, erule parts.induct, auto)"], ["", "lemmas parts_msgSet = parts_PairSet parts_EncSet parts_AencSet parts_SignSet parts_HashSet"], ["", "lemmas parts_msgSetD = parts_msgSet [THEN [2] rev_subsetD]"], ["", "text \\<open>\nRemove the message sets from under the @{term \"Enc_keys_clean\"} predicate.\nOnly when the first part is a set of agents or tags for @{term Pair}, this is sufficient.\\<close>"], ["", "lemma Enc_keys_clean_PairSet_Agent_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (PairSet (Agent`X) G \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Enc_keys_clean (G \\<union> H) \\<Longrightarrow>\n    Enc_keys_clean (PairSet (Messages.Agent ` X) G \\<union> H)", "by (auto simp add: Enc_keys_clean_def dest!: parts_msgSetD)"], ["", "lemma Enc_keys_clean_PairSet_Tag_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (PairSet Tags G \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Enc_keys_clean (G \\<union> H) \\<Longrightarrow>\n    Enc_keys_clean (PairSet Tags G \\<union> H)", "by (auto simp add: Enc_keys_clean_def dest!: parts_msgSetD)"], ["", "lemma Enc_keys_clean_AencSet_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (AencSet G K \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Enc_keys_clean (G \\<union> H) \\<Longrightarrow>\n    Enc_keys_clean (AencSet G K \\<union> H)", "by (auto simp add: Enc_keys_clean_def dest!: parts_msgSetD)"], ["", "lemma Enc_keys_clean_EncSet_Un: \n  \"K \\<subseteq> range LtK \\<Longrightarrow> Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (EncSet G K \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>K \\<subseteq> range LtK; Enc_keys_clean (G \\<union> H)\\<rbrakk>\n    \\<Longrightarrow> Enc_keys_clean (EncSet G K \\<union> H)", "by (auto simp add: Enc_keys_clean_def dest!: parts_msgSetD)"], ["", "lemma Enc_keys_clean_SignSet_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (SignSet G K \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Enc_keys_clean (G \\<union> H) \\<Longrightarrow>\n    Enc_keys_clean (SignSet G K \\<union> H)", "by (auto simp add: Enc_keys_clean_def dest!: parts_msgSetD)"], ["", "lemma Enc_keys_clean_HashSet_Un: \n  \"Enc_keys_clean (G \\<union> H) \\<Longrightarrow> Enc_keys_clean (HashSet G \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Enc_keys_clean (G \\<union> H) \\<Longrightarrow>\n    Enc_keys_clean (HashSet G \\<union> H)", "by (auto simp add: Enc_keys_clean_def dest!: parts_msgSetD)"], ["", "lemmas Enc_keys_clean_msgSet_Un =\n  Enc_keys_clean_PairSet_Tag_Un Enc_keys_clean_PairSet_Agent_Un\n  Enc_keys_clean_EncSet_Un Enc_keys_clean_AencSet_Un\n  Enc_keys_clean_SignSet_Un Enc_keys_clean_HashSet_Un"], ["", "subsubsection \\<open>Lemmas for moving message sets out of @{term \"analz\"}\\<close>"], ["", "(**************************************************************************************************)"], ["", "text \\<open>Pull @{term EncSet} out of @{term analz}.\\<close>"], ["", "lemma analz_Un_EncSet:\nassumes \"K \\<subseteq> range LtK\" and \"Enc_keys_clean (G \\<union> H)\" \nshows \"analz (EncSet G K \\<union> H) \\<subseteq> EncSet G K \\<union> analz (G \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (EncSet G K \\<union> H)\n    \\<subseteq> EncSet G K \\<union> analz (G \\<union> H)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (EncSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> EncSet G K \\<union> analz (G \\<union> H)", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (EncSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> EncSet G K \\<union> analz (G \\<union> H)", "assume \"X \\<in> analz (EncSet G K \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (EncSet G K \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (EncSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> EncSet G K \\<union> analz (G \\<union> H)", "thus \"X \\<in> EncSet G K \\<union> analz (G \\<union> H)\""], ["proof (prove)\nusing this:\n  X \\<in> analz (EncSet G K \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> EncSet G K \\<union> analz (G \\<union> H)", "proof (induction X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (EncSet G K \\<union> H);\n        Enc X Y \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (EncSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> EncSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)", "case (Dec Y K')"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (EncSet G K \\<union> H)\n  Enc Y K' \\<in> EncSet G K \\<union> analz (G \\<union> H)\n  K' \\<in> synth\n            (analz (EncSet G K \\<union> H) \\<inter>\n             {a. a \\<in> EncSet G K \\<union> analz (G \\<union> H)})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (EncSet G K \\<union> H);\n        Enc X Y \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (EncSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> EncSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)", "from Dec.IH(1)"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> EncSet G K \\<union> analz (G \\<union> H)", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> EncSet G K \\<union> analz (G \\<union> H)\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz (G \\<union> H)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. Enc Y K' \\<in> analz (G \\<union> H) \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz (G \\<union> H)", "assume \"Enc Y K' \\<in> analz (G \\<union> H)\""], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (G \\<union> H)\n\ngoal (2 subgoals):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. Enc Y K' \\<in> analz (G \\<union> H) \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz (G \\<union> H)", "have \"K' \\<in> synth (analz (G \\<union> H))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "have \"K' \\<in> range LtK \\<union> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "using \\<open>Enc Y K' \\<in> analz (G \\<union> H)\\<close> assms(2)"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz (G \\<union> H)\n  Enc_keys_clean (G \\<union> H)\n\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "by (blast dest: Enc_keys_clean_analz)"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "moreover"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "have \"K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))", "using Dec.IH(2)"], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (EncSet G K \\<union> H) \\<inter>\n             {a. a \\<in> EncSet G K \\<union> analz (G \\<union> H)})\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "moreover"], ["proof (state)\nthis:\n  K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "hence \"K' \\<in> synth (analz (G \\<union> H)) \\<union> -payload\""], ["proof (prove)\nusing this:\n  K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "using assms(1)"], ["proof (prove)\nusing this:\n  K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))\n  K \\<subseteq> range LtK\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "by (blast dest!: synth_payload2 [THEN [2] rev_subsetD])"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "ultimately"], ["proof (chain)\npicking this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (EncSet G K \\<union> analz (G \\<union> H))\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "by auto"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal (2 subgoals):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. Enc Y K' \\<in> analz (G \\<union> H) \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz (G \\<union> H)", "thus ?case"], ["proof (prove)\nusing this:\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz (G \\<union> H)", "using \\<open>Enc Y K' \\<in> analz (G \\<union> H)\\<close>"], ["proof (prove)\nusing this:\n  K' \\<in> synth (analz (G \\<union> H))\n  Enc Y K' \\<in> analz (G \\<union> H)\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz (G \\<union> H)", "by auto"], ["proof (state)\nthis:\n  Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz (G \\<union> H)", "qed auto"], ["proof (state)\nthis:\n  Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)", "case (Adec_eph Y K')"], ["proof (state)\nthis:\n  Aenc Y (epubK K') \\<in> analz (EncSet G K \\<union> H)\n  Aenc Y (epubK K') \\<in> EncSet G K \\<union> analz (G \\<union> H)\n  epriK K'\n  \\<in> synth\n         (analz (EncSet G K \\<union> H) \\<inter>\n          {a. a \\<in> EncSet G K \\<union> analz (G \\<union> H)})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K') \\<in> analz (EncSet G K \\<union> H)\n  Aenc Y (epubK K') \\<in> EncSet G K \\<union> analz (G \\<union> H)\n  epriK K'\n  \\<in> synth\n         (analz (EncSet G K \\<union> H) \\<inter>\n          {a. a \\<in> EncSet G K \\<union> analz (G \\<union> H)})\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz (G \\<union> H)", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz (G \\<union> H)", "qed (auto)"], ["proof (state)\nthis:\n  X \\<in> EncSet G K \\<union> analz (G \\<union> H)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Pull @{term EncSet} out of @{term analz}, 2nd case: the keys are unknown.\\<close>"], ["", "lemma analz_Un_EncSet2:\nassumes \"Enc_keys_clean H\" and \"K \\<subseteq> range LtK\" and \"K \\<inter> synth (analz H) = {}\"\nshows \"analz (EncSet G K \\<union> H) \\<subseteq> EncSet G K \\<union> analz H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (EncSet G K \\<union> H) \\<subseteq> EncSet G K \\<union> analz H", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (EncSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> EncSet G K \\<union> analz H", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (EncSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> EncSet G K \\<union> analz H", "assume \"X \\<in> analz (EncSet G K \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (EncSet G K \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (EncSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> EncSet G K \\<union> analz H", "thus \"X \\<in> EncSet G K \\<union> analz H\""], ["proof (prove)\nusing this:\n  X \\<in> analz (EncSet G K \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> EncSet G K \\<union> analz H", "proof (induction X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (EncSet G K \\<union> H);\n        Enc X Y \\<in> EncSet G K \\<union> analz H;\n        Y \\<in> synth\n                 (analz (EncSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> EncSet G K \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz H;\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz H;\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H", "case (Dec Y K')"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (EncSet G K \\<union> H)\n  Enc Y K' \\<in> EncSet G K \\<union> analz H\n  K' \\<in> synth\n            (analz (EncSet G K \\<union> H) \\<inter>\n             {a. a \\<in> EncSet G K \\<union> analz H})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (EncSet G K \\<union> H);\n        Enc X Y \\<in> EncSet G K \\<union> analz H;\n        Y \\<in> synth\n                 (analz (EncSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> EncSet G K \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz H;\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz H;\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H", "from Dec.IH(1)"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> EncSet G K \\<union> analz H", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> EncSet G K \\<union> analz H\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz H", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H\n 2. Enc Y K' \\<in> analz H \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "assume \"Enc Y K' \\<in> analz H\""], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (2 subgoals):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H\n 2. Enc Y K' \\<in> analz H \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "moreover"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (2 subgoals):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H\n 2. Enc Y K' \\<in> analz H \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "have \"K' \\<in> synth (analz H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "have \"K' \\<in> range LtK \\<union> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "using \\<open>Enc Y K' \\<in> analz H\\<close> assms(1)"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  Enc_keys_clean H\n\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "by (auto dest: Enc_keys_clean_analz)"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "from Dec.IH(2)"], ["proof (chain)\npicking this:\n  K' \\<in> synth\n            (analz (EncSet G K \\<union> H) \\<inter>\n             {a. a \\<in> EncSet G K \\<union> analz H})", "have H: \"K' \\<in> synth (EncSet G K \\<union> analz H)\""], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (EncSet G K \\<union> H) \\<inter>\n             {a. a \\<in> EncSet G K \\<union> analz H})\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (EncSet G K \\<union> analz H)", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (EncSet G K \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' \\<in> synth (EncSet G K \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "hence \"K' \\<in> synth (analz H) \\<union> -payload\""], ["proof (prove)\nusing this:\n  K' \\<in> synth (EncSet G K \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H) \\<union> - payload", "proof (rule synth_payload2 [THEN [2] rev_subsetD], auto elim!: payload_Enc)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>K' \\<in> synth (EncSet G K \\<union> analz H);\n        X \\<in> payload; Y \\<in> payload; X \\<in> G; Y \\<in> K\\<rbrakk>\n       \\<Longrightarrow> False", "fix X Y"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>K' \\<in> synth (EncSet G K \\<union> analz H);\n        X \\<in> payload; Y \\<in> payload; X \\<in> G; Y \\<in> K\\<rbrakk>\n       \\<Longrightarrow> False", "assume \"Y \\<in> K\" \"Y \\<in> payload\""], ["proof (state)\nthis:\n  Y \\<in> K\n  Y \\<in> payload\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>K' \\<in> synth (EncSet G K \\<union> analz H);\n        X \\<in> payload; Y \\<in> payload; X \\<in> G; Y \\<in> K\\<rbrakk>\n       \\<Longrightarrow> False", "with \\<open>K \\<subseteq> range LtK\\<close>"], ["proof (chain)\npicking this:\n  K \\<subseteq> range LtK\n  Y \\<in> K\n  Y \\<in> payload", "obtain KK where \"Y = LtK KK\""], ["proof (prove)\nusing this:\n  K \\<subseteq> range LtK\n  Y \\<in> K\n  Y \\<in> payload\n\ngoal (1 subgoal):\n 1. (\\<And>KK. Y = LtK KK \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  Y = LtK KK\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>K' \\<in> synth (EncSet G K \\<union> analz H);\n        X \\<in> payload; Y \\<in> payload; X \\<in> G; Y \\<in> K\\<rbrakk>\n       \\<Longrightarrow> False", "with \\<open>Y \\<in> payload\\<close>"], ["proof (chain)\npicking this:\n  Y \\<in> payload\n  Y = LtK KK", "show False"], ["proof (prove)\nusing this:\n  Y \\<in> payload\n  Y = LtK KK\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "ultimately"], ["proof (chain)\npicking this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (EncSet G K \\<union> analz H)\n  K' \\<in> synth (analz H) \\<union> - payload", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (EncSet G K \\<union> analz H)\n  K' \\<in> synth (analz H) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "by auto"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal (2 subgoals):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H\n 2. Enc Y K' \\<in> analz H \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz H", "by auto"], ["proof (state)\nthis:\n  Y \\<in> EncSet G K \\<union> analz H\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "assume \"Enc Y K' \\<in> EncSet G K\""], ["proof (state)\nthis:\n  Enc Y K' \\<in> EncSet G K\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "moreover"], ["proof (state)\nthis:\n  Enc Y K' \\<in> EncSet G K\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "hence \"K' \\<in> K\""], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> EncSet G K\n\ngoal (1 subgoal):\n 1. K' \\<in> K", "by auto"], ["proof (state)\nthis:\n  K' \\<in> K\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "moreover"], ["proof (state)\nthis:\n  K' \\<in> K\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "with \\<open>K \\<subseteq> range LtK\\<close>"], ["proof (chain)\npicking this:\n  K \\<subseteq> range LtK\n  K' \\<in> K", "obtain KK where \"K' = LtK KK\""], ["proof (prove)\nusing this:\n  K \\<subseteq> range LtK\n  K' \\<in> K\n\ngoal (1 subgoal):\n 1. (\\<And>KK. K' = LtK KK \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  K' = LtK KK\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "moreover"], ["proof (state)\nthis:\n  K' = LtK KK\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "with Dec.IH(2)"], ["proof (chain)\npicking this:\n  K' \\<in> synth\n            (analz (EncSet G K \\<union> H) \\<inter>\n             {a. a \\<in> EncSet G K \\<union> analz H})\n  K' = LtK KK", "have \"K' \\<in> analz H\""], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (EncSet G K \\<union> H) \\<inter>\n             {a. a \\<in> EncSet G K \\<union> analz H})\n  K' = LtK KK\n\ngoal (1 subgoal):\n 1. K' \\<in> analz H", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> analz H\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> EncSet G K \\<Longrightarrow>\n    Y \\<in> EncSet G K \\<union> analz H", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> EncSet G K\n  K' \\<in> K\n  K' = LtK KK\n  K' \\<in> analz H", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> EncSet G K\n  K' \\<in> K\n  K' = LtK KK\n  K' \\<in> analz H\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz H", "using \\<open>K \\<inter> synth (analz H) = {}\\<close>"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> EncSet G K\n  K' \\<in> K\n  K' = LtK KK\n  K' \\<in> analz H\n  K \\<inter> synth (analz H) = {}\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz H", "by auto"], ["proof (state)\nthis:\n  Y \\<in> EncSet G K \\<union> analz H\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Y \\<in> EncSet G K \\<union> analz H\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz H;\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz H;\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz H;\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz H;\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H", "case (Adec_eph Y K')"], ["proof (state)\nthis:\n  Aenc Y (epubK K') \\<in> analz (EncSet G K \\<union> H)\n  Aenc Y (epubK K') \\<in> EncSet G K \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (EncSet G K \\<union> H) \\<inter>\n          {a. a \\<in> EncSet G K \\<union> analz H})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz H;\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> EncSet G K \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (EncSet G K \\<union> H) \\<inter>\n                {a. a \\<in> EncSet G K \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz H;\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K') \\<in> analz (EncSet G K \\<union> H)\n  Aenc Y (epubK K') \\<in> EncSet G K \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (EncSet G K \\<union> H) \\<inter>\n          {a. a \\<in> EncSet G K \\<union> analz H})\n\ngoal (1 subgoal):\n 1. Y \\<in> EncSet G K \\<union> analz H", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> EncSet G K \\<union> analz H\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> EncSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> EncSet G K \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (EncSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> EncSet G K \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (EncSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> EncSet G K \\<union> analz H;\n        priK Y \\<in> analz (EncSet G K \\<union> H);\n        priK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (EncSet G K \\<union> H);\n        Sign X (priK Y) \\<in> EncSet G K \\<union> analz H;\n        pubK Y \\<in> analz (EncSet G K \\<union> H);\n        pubK Y \\<in> EncSet G K \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> EncSet G K \\<union> analz H", "qed (insert assms(2), auto)"], ["proof (state)\nthis:\n  X \\<in> EncSet G K \\<union> analz H\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Pull @{term AencSet} out of the @{term analz}.\\<close>"], ["", "lemma analz_Un_AencSet:\nassumes \"K \\<subseteq> range LtK\" and \"Enc_keys_clean (G \\<union> H)\" \nshows \"analz (AencSet G K \\<union> H) \\<subseteq> AencSet G K \\<union> analz (G \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (AencSet G K \\<union> H)\n    \\<subseteq> AencSet G K \\<union> analz (G \\<union> H)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AencSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> AencSet G K \\<union> analz (G \\<union> H)", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AencSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> AencSet G K \\<union> analz (G \\<union> H)", "assume \"X \\<in> analz (AencSet G K \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (AencSet G K \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AencSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> AencSet G K \\<union> analz (G \\<union> H)", "thus \"X \\<in> AencSet G K \\<union> analz (G \\<union> H)\""], ["proof (prove)\nusing this:\n  X \\<in> analz (AencSet G K \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "proof (induction X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G K \\<union> H);\n        Enc X Y \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (AencSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G K \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "case (Dec Y K')"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (AencSet G K \\<union> H)\n  Enc Y K' \\<in> AencSet G K \\<union> analz (G \\<union> H)\n  K' \\<in> synth\n            (analz (AencSet G K \\<union> H) \\<inter>\n             {a. a \\<in> AencSet G K \\<union> analz (G \\<union> H)})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G K \\<union> H);\n        Enc X Y \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (AencSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G K \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "from Dec.IH(1)"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> AencSet G K \\<union> analz (G \\<union> H)", "have \"Enc Y K' \\<in> analz (G \\<union> H)\""], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> AencSet G K \\<union> analz (G \\<union> H)\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> analz (G \\<union> H)", "by auto"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (G \\<union> H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G K \\<union> H);\n        Enc X Y \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (AencSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G K \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "moreover"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (G \\<union> H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G K \\<union> H);\n        Enc X Y \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (AencSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G K \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "have \"K' \\<in> synth (analz (G \\<union> H))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "have \"K' \\<in> range LtK \\<union> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "using \\<open>Enc Y K' \\<in> analz (G \\<union> H)\\<close> assms(2)"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz (G \\<union> H)\n  Enc_keys_clean (G \\<union> H)\n\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "by (blast dest: Enc_keys_clean_analz)"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "moreover"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "have \"K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))", "using Dec.IH(2)"], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (AencSet G K \\<union> H) \\<inter>\n             {a. a \\<in> AencSet G K \\<union> analz (G \\<union> H)})\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "moreover"], ["proof (state)\nthis:\n  K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "hence \"K' \\<in> synth (analz (G \\<union> H)) \\<union> -payload\""], ["proof (prove)\nusing this:\n  K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "using assms(1)"], ["proof (prove)\nusing this:\n  K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))\n  K \\<subseteq> range LtK\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "by (blast dest!: synth_payload2 [THEN [2] rev_subsetD])"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "ultimately"], ["proof (chain)\npicking this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (AencSet G K \\<union> analz (G \\<union> H))\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "by auto"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G K \\<union> H);\n        Enc X Y \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (AencSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G K \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> analz (G \\<union> H)\n  K' \\<in> synth (analz (G \\<union> H))", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz (G \\<union> H)\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. Y \\<in> AencSet G K \\<union> analz (G \\<union> H)", "by auto"], ["proof (state)\nthis:\n  Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G K \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G K \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "case (Adec_eph Y K')"], ["proof (state)\nthis:\n  Aenc Y (epubK K') \\<in> analz (AencSet G K \\<union> H)\n  Aenc Y (epubK K') \\<in> AencSet G K \\<union> analz (G \\<union> H)\n  epriK K'\n  \\<in> synth\n         (analz (AencSet G K \\<union> H) \\<inter>\n          {a. a \\<in> AencSet G K \\<union> analz (G \\<union> H)})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G K \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K') \\<in> analz (AencSet G K \\<union> H)\n  Aenc Y (epubK K') \\<in> AencSet G K \\<union> analz (G \\<union> H)\n  epriK K'\n  \\<in> synth\n         (analz (AencSet G K \\<union> H) \\<inter>\n          {a. a \\<in> AencSet G K \\<union> analz (G \\<union> H)})\n\ngoal (1 subgoal):\n 1. Y \\<in> AencSet G K \\<union> analz (G \\<union> H)", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AencSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AencSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (AencSet G K \\<union> H);\n        priK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AencSet G K \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (AencSet G K \\<union> H);\n        pubK Y \\<in> AencSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G K \\<union> analz (G \\<union> H)", "qed auto"], ["proof (state)\nthis:\n  X \\<in> AencSet G K \\<union> analz (G \\<union> H)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Pull @{term AencSet} out of @{term analz}, 2nd case: the keys are unknown.\\<close>"], ["", "lemma analz_Un_AencSet2:\nassumes \"Enc_keys_clean H\" and \"priK`Ag \\<inter> synth (analz H) = {}\"\nshows \"analz (AencSet G (pubK`Ag) \\<union> H) \\<subseteq> AencSet G (pubK`Ag) \\<union> analz H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (AencSet G (pubK ` Ag) \\<union> H)\n    \\<subseteq> AencSet G (pubK ` Ag) \\<union> analz H", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AencSet G (pubK ` Ag) \\<union> H) \\<Longrightarrow>\n       x \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AencSet G (pubK ` Ag) \\<union> H) \\<Longrightarrow>\n       x \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "assume \"X \\<in> analz (AencSet G (pubK` Ag) \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (AencSet G (pubK ` Ag) \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AencSet G (pubK ` Ag) \\<union> H) \\<Longrightarrow>\n       x \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "thus \"X \\<in> AencSet G (pubK` Ag) \\<union> analz H\""], ["proof (prove)\nusing this:\n  X \\<in> analz (AencSet G (pubK ` Ag) \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "proof (induction X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Enc X Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                              analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                            analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "case (Dec Y K')"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (AencSet G (pubK ` Ag) \\<union> H)\n  Enc Y K' \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n  K' \\<in> synth\n            (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n             {a. a \\<in> AencSet G (pubK ` Ag) \\<union> analz H})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Enc X Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                              analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                            analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "from Dec.IH(1)"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "have \"Enc Y K' \\<in> analz H\""], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> analz H", "by auto"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Enc X Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                              analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                            analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "moreover"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Enc X Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                              analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                            analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "have \"K' \\<in> synth (analz H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "have \"K' \\<in> range LtK \\<union> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "using \\<open>Enc Y K' \\<in> analz H\\<close> assms(1)"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  Enc_keys_clean H\n\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "by (auto dest: Enc_keys_clean_analz)"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "from Dec.IH(2)"], ["proof (chain)\npicking this:\n  K' \\<in> synth\n            (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n             {a. a \\<in> AencSet G (pubK ` Ag) \\<union> analz H})", "have H: \"K' \\<in> synth (AencSet G (pubK`Ag) \\<union> analz H)\""], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n             {a. a \\<in> AencSet G (pubK ` Ag) \\<union> analz H})\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (AencSet G (pubK ` Ag) \\<union> analz H)", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (AencSet G (pubK ` Ag) \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' \\<in> synth (AencSet G (pubK ` Ag) \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "hence \"K' \\<in> synth (analz H) \\<union> -payload\""], ["proof (prove)\nusing this:\n  K' \\<in> synth (AencSet G (pubK ` Ag) \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H) \\<union> - payload", "by (auto dest: synth_payload2 [THEN [2] rev_subsetD])"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "ultimately"], ["proof (chain)\npicking this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (AencSet G (pubK ` Ag) \\<union> analz H)\n  K' \\<in> synth (analz H) \\<union> - payload", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (AencSet G (pubK ` Ag) \\<union> analz H)\n  K' \\<in> synth (analz H) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "by auto"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Enc X Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                  {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                              analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                            analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)\n\ngoal (1 subgoal):\n 1. Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "by auto"], ["proof (state)\nthis:\n  Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                            analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                            analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "case (Adec_eph Y K')"], ["proof (state)\nthis:\n  Aenc Y (epubK K') \\<in> analz (AencSet G (pubK ` Ag) \\<union> H)\n  Aenc Y (epubK K') \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n          {a. a \\<in> AencSet G (pubK ` Ag) \\<union> analz H})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (epubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n                {a. a \\<in> AencSet G (pubK ` Ag) \\<union>\n                            analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K') \\<in> analz (AencSet G (pubK ` Ag) \\<union> H)\n  Aenc Y (epubK K') \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (AencSet G (pubK ` Ag) \\<union> H) \\<inter>\n          {a. a \\<in> AencSet G (pubK ` Ag) \\<union> analz H})\n\ngoal (1 subgoal):\n 1. Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> AencSet G (pubK ` Ag) \\<union> H \\<Longrightarrow>\n       X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Aenc X (pubK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        priK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        priK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y)\n                \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        Sign X (priK Y) \\<in> AencSet G (pubK ` Ag) \\<union> analz H;\n        pubK Y \\<in> analz (AencSet G (pubK ` Ag) \\<union> H);\n        pubK Y \\<in> AencSet G (pubK ` Ag) \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AencSet G (pubK ` Ag) \\<union> analz H", "qed (insert assms(2), auto)"], ["proof (state)\nthis:\n  X \\<in> AencSet G (pubK ` Ag) \\<union> analz H\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Pull @{term PairSet} out of @{term analz}.\\<close>"], ["", "lemma analz_Un_PairSet:\n  \"analz (PairSet G G' \\<union> H) \\<subseteq> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (PairSet G G' \\<union> H)\n    \\<subseteq> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (PairSet G G' \\<union> H) \\<Longrightarrow>\n       x \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (PairSet G G' \\<union> H) \\<Longrightarrow>\n       x \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)", "assume \"X \\<in> analz (PairSet G G' \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (PairSet G G' \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (PairSet G G' \\<union> H) \\<Longrightarrow>\n       x \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)", "thus \"X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\""], ["proof (prove)\nusing this:\n  X \\<in> analz (PairSet G G' \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)", "proof (induct X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (PairSet G G' \\<union> H);\n        Enc X Y\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        Y \\<in> synth\n                 (analz (PairSet G G' \\<union> H) \\<inter>\n                  {a. a \\<in> PairSet G G' \\<union>\n                              analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "case (Dec Y K)"], ["proof (state)\nthis:\n  Enc Y K \\<in> analz (PairSet G G' \\<union> H)\n  Enc Y K \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n  K \\<in> synth\n           (analz (PairSet G G' \\<union> H) \\<inter>\n            {a. a \\<in> PairSet G G' \\<union>\n                        analz (G \\<union> G' \\<union> H)})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (PairSet G G' \\<union> H);\n        Enc X Y\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        Y \\<in> synth\n                 (analz (PairSet G G' \\<union> H) \\<inter>\n                  {a. a \\<in> PairSet G G' \\<union>\n                              analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "from Dec.hyps(2)"], ["proof (chain)\npicking this:\n  Enc Y K \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)", "have \"Enc Y K \\<in> analz (G \\<union> G' \\<union> H)\""], ["proof (prove)\nusing this:\n  Enc Y K \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n\ngoal (1 subgoal):\n 1. Enc Y K \\<in> analz (G \\<union> G' \\<union> H)", "by auto"], ["proof (state)\nthis:\n  Enc Y K \\<in> analz (G \\<union> G' \\<union> H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (PairSet G G' \\<union> H);\n        Enc X Y\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        Y \\<in> synth\n                 (analz (PairSet G G' \\<union> H) \\<inter>\n                  {a. a \\<in> PairSet G G' \\<union>\n                              analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "moreover"], ["proof (state)\nthis:\n  Enc Y K \\<in> analz (G \\<union> G' \\<union> H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (PairSet G G' \\<union> H);\n        Enc X Y\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        Y \\<in> synth\n                 (analz (PairSet G G' \\<union> H) \\<inter>\n                  {a. a \\<in> PairSet G G' \\<union>\n                              analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "from Dec.hyps(3)"], ["proof (chain)\npicking this:\n  K \\<in> synth\n           (analz (PairSet G G' \\<union> H) \\<inter>\n            {a. a \\<in> PairSet G G' \\<union>\n                        analz (G \\<union> G' \\<union> H)})", "have \"K \\<in> synth (PairSet G G' \\<union> analz (G \\<union> G' \\<union> H))\""], ["proof (prove)\nusing this:\n  K \\<in> synth\n           (analz (PairSet G G' \\<union> H) \\<inter>\n            {a. a \\<in> PairSet G G' \\<union>\n                        analz (G \\<union> G' \\<union> H)})\n\ngoal (1 subgoal):\n 1. K \\<in> synth (PairSet G G' \\<union> analz (G \\<union> G' \\<union> H))", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K \\<in> synth (PairSet G G' \\<union> analz (G \\<union> G' \\<union> H))\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (PairSet G G' \\<union> H);\n        Enc X Y\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        Y \\<in> synth\n                 (analz (PairSet G G' \\<union> H) \\<inter>\n                  {a. a \\<in> PairSet G G' \\<union>\n                              analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "then"], ["proof (chain)\npicking this:\n  K \\<in> synth (PairSet G G' \\<union> analz (G \\<union> G' \\<union> H))", "have \"K \\<in> synth (analz (G \\<union> G' \\<union> H))\""], ["proof (prove)\nusing this:\n  K \\<in> synth (PairSet G G' \\<union> analz (G \\<union> G' \\<union> H))\n\ngoal (1 subgoal):\n 1. K \\<in> synth (analz (G \\<union> G' \\<union> H))", "by (elim synth_trans) auto"], ["proof (state)\nthis:\n  K \\<in> synth (analz (G \\<union> G' \\<union> H))\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (PairSet G G' \\<union> H);\n        Enc X Y\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        Y \\<in> synth\n                 (analz (PairSet G G' \\<union> H) \\<inter>\n                  {a. a \\<in> PairSet G G' \\<union>\n                              analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K \\<in> analz (G \\<union> G' \\<union> H)\n  K \\<in> synth (analz (G \\<union> G' \\<union> H))", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K \\<in> analz (G \\<union> G' \\<union> H)\n  K \\<in> synth (analz (G \\<union> G' \\<union> H))\n\ngoal (1 subgoal):\n 1. Y \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)", "by auto"], ["proof (state)\nthis:\n  Y \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "case (Adec_eph Y K)"], ["proof (state)\nthis:\n  Aenc Y (epubK K) \\<in> analz (PairSet G G' \\<union> H)\n  Aenc Y (epubK K)\n  \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n  epriK K\n  \\<in> synth\n         (analz (PairSet G G' \\<union> H) \\<inter>\n          {a. a \\<in> PairSet G G' \\<union>\n                      analz (G \\<union> G' \\<union> H)})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (epubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (PairSet G G' \\<union> H) \\<inter>\n                {a. a \\<in> PairSet G G' \\<union>\n                            analz (G \\<union> G' \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K) \\<in> analz (PairSet G G' \\<union> H)\n  Aenc Y (epubK K)\n  \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n  epriK K\n  \\<in> synth\n         (analz (PairSet G G' \\<union> H) \\<inter>\n          {a. a \\<in> PairSet G G' \\<union>\n                      analz (G \\<union> G' \\<union> H)})\n\ngoal (1 subgoal):\n 1. Y \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> PairSet G G' \\<union> H \\<Longrightarrow>\n       X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle>\n                \\<in> analz (PairSet G G' \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Aenc X (pubK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        priK Y \\<in> analz (PairSet G G' \\<union> H);\n        priK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (PairSet G G' \\<union> H);\n        Sign X (priK Y)\n        \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H);\n        pubK Y \\<in> analz (PairSet G G' \\<union> H);\n        pubK Y\n        \\<in> PairSet G G' \\<union>\n              analz (G \\<union> G' \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> PairSet G G' \\<union>\n                                 analz (G \\<union> G' \\<union> H)", "qed auto"], ["proof (state)\nthis:\n  X \\<in> PairSet G G' \\<union> analz (G \\<union> G' \\<union> H)\n\ngoal:\nNo subgoals!", "qed\n\n\\<comment> \\<open>move the \\<open>SignSet\\<close> out of the \\<open>analz\\<close>\\<close>"], ["", "lemma analz_Un_SignSet:\nassumes \"K \\<subseteq> range LtK\" and \"Enc_keys_clean (G \\<union> H)\"\nshows \"analz (SignSet G K \\<union> H) \\<subseteq> SignSet G K \\<union> analz (G \\<union> H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (SignSet G K \\<union> H)\n    \\<subseteq> SignSet G K \\<union> analz (G \\<union> H)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (SignSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> SignSet G K \\<union> analz (G \\<union> H)", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (SignSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> SignSet G K \\<union> analz (G \\<union> H)", "assume \"X \\<in> analz (SignSet G K \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (SignSet G K \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (SignSet G K \\<union> H) \\<Longrightarrow>\n       x \\<in> SignSet G K \\<union> analz (G \\<union> H)", "thus \"X \\<in> SignSet G K \\<union> analz (G \\<union> H)\""], ["proof (prove)\nusing this:\n  X \\<in> analz (SignSet G K \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "proof (induct X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (SignSet G K \\<union> H);\n        Enc X Y \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (SignSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> SignSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (SignSet G K \\<union> H) \\<inter>\n                {a. a \\<in> SignSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "case (Dec Y K')"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (SignSet G K \\<union> H)\n  Enc Y K' \\<in> SignSet G K \\<union> analz (G \\<union> H)\n  K' \\<in> synth\n            (analz (SignSet G K \\<union> H) \\<inter>\n             {a. a \\<in> SignSet G K \\<union> analz (G \\<union> H)})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (SignSet G K \\<union> H);\n        Enc X Y \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (SignSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> SignSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (SignSet G K \\<union> H) \\<inter>\n                {a. a \\<in> SignSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "from Dec.hyps(2)"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> SignSet G K \\<union> analz (G \\<union> H)", "have \"Enc Y K' \\<in> analz (G \\<union> H)\""], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> SignSet G K \\<union> analz (G \\<union> H)\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> analz (G \\<union> H)", "by auto"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (G \\<union> H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (SignSet G K \\<union> H);\n        Enc X Y \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (SignSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> SignSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (SignSet G K \\<union> H) \\<inter>\n                {a. a \\<in> SignSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "moreover"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (G \\<union> H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (SignSet G K \\<union> H);\n        Enc X Y \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (SignSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> SignSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (SignSet G K \\<union> H) \\<inter>\n                {a. a \\<in> SignSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "have \"K' \\<in> synth (analz (G \\<union> H))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "have \"K' \\<in> range LtK \\<union> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "using \\<open>Enc Y K' \\<in> analz (G \\<union> H)\\<close> assms(2)"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz (G \\<union> H)\n  Enc_keys_clean (G \\<union> H)\n\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "by (blast dest: Enc_keys_clean_analz)"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "moreover"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "from Dec.hyps(3)"], ["proof (chain)\npicking this:\n  K' \\<in> synth\n            (analz (SignSet G K \\<union> H) \\<inter>\n             {a. a \\<in> SignSet G K \\<union> analz (G \\<union> H)})", "have \"K' \\<in> synth (SignSet G K \\<union> analz (G \\<union> H)) \""], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (SignSet G K \\<union> H) \\<inter>\n             {a. a \\<in> SignSet G K \\<union> analz (G \\<union> H)})\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (SignSet G K \\<union> analz (G \\<union> H))", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (SignSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "moreover"], ["proof (state)\nthis:\n  K' \\<in> synth (SignSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "hence \"K' \\<in> synth (analz (G \\<union> H)) \\<union> -payload\""], ["proof (prove)\nusing this:\n  K' \\<in> synth (SignSet G K \\<union> analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "using assms(1)"], ["proof (prove)\nusing this:\n  K' \\<in> synth (SignSet G K \\<union> analz (G \\<union> H))\n  K \\<subseteq> range LtK\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "by (blast dest!: synth_payload2 [THEN [2] rev_subsetD])"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "ultimately"], ["proof (chain)\npicking this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (SignSet G K \\<union> analz (G \\<union> H))\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (SignSet G K \\<union> analz (G \\<union> H))\n  K' \\<in> synth (analz (G \\<union> H)) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz (G \\<union> H))", "by auto"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (SignSet G K \\<union> H);\n        Enc X Y \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        Y \\<in> synth\n                 (analz (SignSet G K \\<union> H) \\<inter>\n                  {a. a \\<in> SignSet G K \\<union>\n                              analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (SignSet G K \\<union> H) \\<inter>\n                {a. a \\<in> SignSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> analz (G \\<union> H)\n  K' \\<in> synth (analz (G \\<union> H))", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz (G \\<union> H)\n  K' \\<in> synth (analz (G \\<union> H))\n\ngoal (1 subgoal):\n 1. Y \\<in> SignSet G K \\<union> analz (G \\<union> H)", "by auto"], ["proof (state)\nthis:\n  Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (SignSet G K \\<union> H) \\<inter>\n                {a. a \\<in> SignSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (SignSet G K \\<union> H) \\<inter>\n                {a. a \\<in> SignSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "case (Adec_eph Y K)"], ["proof (state)\nthis:\n  Aenc Y (epubK K) \\<in> analz (SignSet G K \\<union> H)\n  Aenc Y (epubK K) \\<in> SignSet G K \\<union> analz (G \\<union> H)\n  epriK K\n  \\<in> synth\n         (analz (SignSet G K \\<union> H) \\<inter>\n          {a. a \\<in> SignSet G K \\<union> analz (G \\<union> H)})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (epubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        epriK Y\n        \\<in> synth\n               (analz (SignSet G K \\<union> H) \\<inter>\n                {a. a \\<in> SignSet G K \\<union>\n                            analz (G \\<union> H)})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K) \\<in> analz (SignSet G K \\<union> H)\n  Aenc Y (epubK K) \\<in> SignSet G K \\<union> analz (G \\<union> H)\n  epriK K\n  \\<in> synth\n         (analz (SignSet G K \\<union> H) \\<inter>\n          {a. a \\<in> SignSet G K \\<union> analz (G \\<union> H)})\n\ngoal (1 subgoal):\n 1. Y \\<in> SignSet G K \\<union> analz (G \\<union> H)", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> SignSet G K \\<union> H \\<Longrightarrow>\n       X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (SignSet G K \\<union> H);\n        \\<langle>X, Y\\<rangle>\n        \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (SignSet G K \\<union> H);\n        Aenc X (pubK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        priK Y \\<in> analz (SignSet G K \\<union> H);\n        priK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (SignSet G K \\<union> H);\n        Sign X (priK Y) \\<in> SignSet G K \\<union> analz (G \\<union> H);\n        pubK Y \\<in> analz (SignSet G K \\<union> H);\n        pubK Y \\<in> SignSet G K \\<union> analz (G \\<union> H)\\<rbrakk>\n       \\<Longrightarrow> X \\<in> SignSet G K \\<union> analz (G \\<union> H)", "qed auto"], ["proof (state)\nthis:\n  X \\<in> SignSet G K \\<union> analz (G \\<union> H)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Pull @{term Tags} out of @{term analz}.\\<close>"], ["", "lemma analz_Un_Tag:\nassumes \"Enc_keys_clean H\"\nshows \"analz (Tags \\<union> H) \\<subseteq> Tags \\<union> analz H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (Tags \\<union> H) \\<subseteq> Tags \\<union> analz H", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (Tags \\<union> H) \\<Longrightarrow>\n       x \\<in> Tags \\<union> analz H", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (Tags \\<union> H) \\<Longrightarrow>\n       x \\<in> Tags \\<union> analz H", "assume \"X \\<in> analz (Tags \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (Tags \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (Tags \\<union> H) \\<Longrightarrow>\n       x \\<in> Tags \\<union> analz H", "thus \"X \\<in> Tags \\<union> analz H\""], ["proof (prove)\nusing this:\n  X \\<in> analz (Tags \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> Tags \\<union> analz H", "proof (induction X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (Tags \\<union> H);\n        Enc X Y \\<in> Tags \\<union> analz H;\n        Y \\<in> synth\n                 (analz (Tags \\<union> H) \\<inter>\n                  {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (epubK Y) \\<in> Tags \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (Tags \\<union> H) \\<inter>\n                {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "case (Dec Y K')"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (Tags \\<union> H)\n  Enc Y K' \\<in> Tags \\<union> analz H\n  K' \\<in> synth\n            (analz (Tags \\<union> H) \\<inter>\n             {a. a \\<in> Tags \\<union> analz H})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (Tags \\<union> H);\n        Enc X Y \\<in> Tags \\<union> analz H;\n        Y \\<in> synth\n                 (analz (Tags \\<union> H) \\<inter>\n                  {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (epubK Y) \\<in> Tags \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (Tags \\<union> H) \\<inter>\n                {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "have \"Enc Y K' \\<in> analz H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> analz H", "using Dec.IH(1)"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> Tags \\<union> analz H\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> analz H", "by auto"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (Tags \\<union> H);\n        Enc X Y \\<in> Tags \\<union> analz H;\n        Y \\<in> synth\n                 (analz (Tags \\<union> H) \\<inter>\n                  {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (epubK Y) \\<in> Tags \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (Tags \\<union> H) \\<inter>\n                {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "moreover"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (Tags \\<union> H);\n        Enc X Y \\<in> Tags \\<union> analz H;\n        Y \\<in> synth\n                 (analz (Tags \\<union> H) \\<inter>\n                  {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (epubK Y) \\<in> Tags \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (Tags \\<union> H) \\<inter>\n                {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "have \"K' \\<in> synth (analz H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "have \"K' \\<in> range LtK \\<union> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "using \\<open>Enc Y K' \\<in> analz H\\<close> assms"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  Enc_keys_clean H\n\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "by (auto dest: Enc_keys_clean_analz)"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "from Dec.IH(2)"], ["proof (chain)\npicking this:\n  K' \\<in> synth\n            (analz (Tags \\<union> H) \\<inter>\n             {a. a \\<in> Tags \\<union> analz H})", "have \"K' \\<in> synth (Tags \\<union> analz H)\""], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (Tags \\<union> H) \\<inter>\n             {a. a \\<in> Tags \\<union> analz H})\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (Tags \\<union> analz H)", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (Tags \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' \\<in> synth (Tags \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "hence \"K' \\<in> synth (analz H) \\<union> -payload\""], ["proof (prove)\nusing this:\n  K' \\<in> synth (Tags \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H) \\<union> - payload", "by (auto dest: synth_payload2 [THEN [2] rev_subsetD])"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "ultimately"], ["proof (chain)\npicking this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (Tags \\<union> analz H)\n  K' \\<in> synth (analz H) \\<union> - payload", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> range LtK \\<union> payload\n  K' \\<in> synth (Tags \\<union> analz H)\n  K' \\<in> synth (analz H) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "by auto"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (Tags \\<union> H);\n        Enc X Y \\<in> Tags \\<union> analz H;\n        Y \\<in> synth\n                 (analz (Tags \\<union> H) \\<inter>\n                  {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (epubK Y) \\<in> Tags \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (Tags \\<union> H) \\<inter>\n                {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)\n\ngoal (1 subgoal):\n 1. Y \\<in> Tags \\<union> analz H", "by (auto)"], ["proof (state)\nthis:\n  Y \\<in> Tags \\<union> analz H\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (epubK Y) \\<in> Tags \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (Tags \\<union> H) \\<inter>\n                {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (epubK Y) \\<in> Tags \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (Tags \\<union> H) \\<inter>\n                {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "case (Adec_eph Y K')"], ["proof (state)\nthis:\n  Aenc Y (epubK K') \\<in> analz (Tags \\<union> H)\n  Aenc Y (epubK K') \\<in> Tags \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (Tags \\<union> H) \\<inter>\n          {a. a \\<in> Tags \\<union> analz H})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (epubK Y) \\<in> Tags \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (Tags \\<union> H) \\<inter>\n                {a. a \\<in> Tags \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K') \\<in> analz (Tags \\<union> H)\n  Aenc Y (epubK K') \\<in> Tags \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (Tags \\<union> H) \\<inter>\n          {a. a \\<in> Tags \\<union> analz H})\n\ngoal (1 subgoal):\n 1. Y \\<in> Tags \\<union> analz H", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> Tags \\<union> analz H\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> Tags \\<union> H \\<Longrightarrow>\n       X \\<in> Tags \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (Tags \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> Tags \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (Tags \\<union> H);\n        Aenc X (pubK Y) \\<in> Tags \\<union> analz H;\n        priK Y \\<in> analz (Tags \\<union> H);\n        priK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (Tags \\<union> H);\n        Sign X (priK Y) \\<in> Tags \\<union> analz H;\n        pubK Y \\<in> analz (Tags \\<union> H);\n        pubK Y \\<in> Tags \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Tags \\<union> analz H", "qed auto"], ["proof (state)\nthis:\n  X \\<in> Tags \\<union> analz H\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Pull the @{term AgentSet} out of the @{term analz}.\\<close>"], ["", "lemma analz_Un_AgentSet:\nshows \"analz (AgentSet \\<union> H) \\<subseteq> AgentSet \\<union> analz H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (AgentSet \\<union> H) \\<subseteq> AgentSet \\<union> analz H", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AgentSet \\<union> H) \\<Longrightarrow>\n       x \\<in> AgentSet \\<union> analz H", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AgentSet \\<union> H) \\<Longrightarrow>\n       x \\<in> AgentSet \\<union> analz H", "assume \"X \\<in> analz (AgentSet \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (AgentSet \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (AgentSet \\<union> H) \\<Longrightarrow>\n       x \\<in> AgentSet \\<union> analz H", "thus \"X \\<in> AgentSet \\<union> analz H\""], ["proof (prove)\nusing this:\n  X \\<in> analz (AgentSet \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> AgentSet \\<union> analz H", "proof (induction X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AgentSet \\<union> H);\n        Enc X Y \\<in> AgentSet \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AgentSet \\<union> H) \\<inter>\n                  {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (epubK Y) \\<in> AgentSet \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AgentSet \\<union> H) \\<inter>\n                {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "case (Dec Y K')"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (AgentSet \\<union> H)\n  Enc Y K' \\<in> AgentSet \\<union> analz H\n  K' \\<in> synth\n            (analz (AgentSet \\<union> H) \\<inter>\n             {a. a \\<in> AgentSet \\<union> analz H})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AgentSet \\<union> H);\n        Enc X Y \\<in> AgentSet \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AgentSet \\<union> H) \\<inter>\n                  {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (epubK Y) \\<in> AgentSet \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AgentSet \\<union> H) \\<inter>\n                {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "from Dec.IH(1)"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> AgentSet \\<union> analz H", "have \"Enc Y K' \\<in> analz H\""], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> AgentSet \\<union> analz H\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> analz H", "by auto"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AgentSet \\<union> H);\n        Enc X Y \\<in> AgentSet \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AgentSet \\<union> H) \\<inter>\n                  {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (epubK Y) \\<in> AgentSet \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AgentSet \\<union> H) \\<inter>\n                {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "moreover"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AgentSet \\<union> H);\n        Enc X Y \\<in> AgentSet \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AgentSet \\<union> H) \\<inter>\n                  {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (epubK Y) \\<in> AgentSet \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AgentSet \\<union> H) \\<inter>\n                {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "have \"K' \\<in> synth (analz H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "from Dec.IH(2)"], ["proof (chain)\npicking this:\n  K' \\<in> synth\n            (analz (AgentSet \\<union> H) \\<inter>\n             {a. a \\<in> AgentSet \\<union> analz H})", "have \"K' \\<in> synth (AgentSet \\<union> analz H)\""], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (AgentSet \\<union> H) \\<inter>\n             {a. a \\<in> AgentSet \\<union> analz H})\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (AgentSet \\<union> analz H)", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (AgentSet \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' \\<in> synth (AgentSet \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "have \"synth (AgentSet \\<union> analz H) \\<subseteq> synth (analz H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. synth (AgentSet \\<union> analz H) \\<subseteq> synth (analz H)", "by (auto simp add: synth_subset_iff)"], ["proof (state)\nthis:\n  synth (AgentSet \\<union> analz H) \\<subseteq> synth (analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "ultimately"], ["proof (chain)\npicking this:\n  K' \\<in> synth (AgentSet \\<union> analz H)\n  synth (AgentSet \\<union> analz H) \\<subseteq> synth (analz H)", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> synth (AgentSet \\<union> analz H)\n  synth (AgentSet \\<union> analz H) \\<subseteq> synth (analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "by auto"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (AgentSet \\<union> H);\n        Enc X Y \\<in> AgentSet \\<union> analz H;\n        Y \\<in> synth\n                 (analz (AgentSet \\<union> H) \\<inter>\n                  {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (epubK Y) \\<in> AgentSet \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AgentSet \\<union> H) \\<inter>\n                {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)\n\ngoal (1 subgoal):\n 1. Y \\<in> AgentSet \\<union> analz H", "by (auto)"], ["proof (state)\nthis:\n  Y \\<in> AgentSet \\<union> analz H\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (epubK Y) \\<in> AgentSet \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AgentSet \\<union> H) \\<inter>\n                {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (epubK Y) \\<in> AgentSet \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AgentSet \\<union> H) \\<inter>\n                {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "case (Adec_eph Y K')"], ["proof (state)\nthis:\n  Aenc Y (epubK K') \\<in> analz (AgentSet \\<union> H)\n  Aenc Y (epubK K') \\<in> AgentSet \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (AgentSet \\<union> H) \\<inter>\n          {a. a \\<in> AgentSet \\<union> analz H})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (epubK Y) \\<in> AgentSet \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (AgentSet \\<union> H) \\<inter>\n                {a. a \\<in> AgentSet \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K') \\<in> analz (AgentSet \\<union> H)\n  Aenc Y (epubK K') \\<in> AgentSet \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (AgentSet \\<union> H) \\<inter>\n          {a. a \\<in> AgentSet \\<union> analz H})\n\ngoal (1 subgoal):\n 1. Y \\<in> AgentSet \\<union> analz H", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> AgentSet \\<union> analz H\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> AgentSet \\<union> H \\<Longrightarrow>\n       X \\<in> AgentSet \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (AgentSet \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> AgentSet \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (AgentSet \\<union> H);\n        Aenc X (pubK Y) \\<in> AgentSet \\<union> analz H;\n        priK Y \\<in> analz (AgentSet \\<union> H);\n        priK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (AgentSet \\<union> H);\n        Sign X (priK Y) \\<in> AgentSet \\<union> analz H;\n        pubK Y \\<in> analz (AgentSet \\<union> H);\n        pubK Y \\<in> AgentSet \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> AgentSet \\<union> analz H", "qed auto"], ["proof (state)\nthis:\n  X \\<in> AgentSet \\<union> analz H\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Pull @{term HashSet} out of @{term analz}.\\<close>"], ["", "lemma analz_Un_HashSet:\nassumes \"Enc_keys_clean H\" and \"G \\<subseteq> - payload\" \nshows \"analz (HashSet G  \\<union> H) \\<subseteq> HashSet G \\<union> analz H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. analz (HashSet G \\<union> H) \\<subseteq> HashSet G \\<union> analz H", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (HashSet G \\<union> H) \\<Longrightarrow>\n       x \\<in> HashSet G \\<union> analz H", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (HashSet G \\<union> H) \\<Longrightarrow>\n       x \\<in> HashSet G \\<union> analz H", "assume \"X \\<in> analz (HashSet G \\<union> H)\""], ["proof (state)\nthis:\n  X \\<in> analz (HashSet G \\<union> H)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> analz (HashSet G \\<union> H) \\<Longrightarrow>\n       x \\<in> HashSet G \\<union> analz H", "thus \"X \\<in> HashSet G \\<union> analz H\""], ["proof (prove)\nusing this:\n  X \\<in> analz (HashSet G \\<union> H)\n\ngoal (1 subgoal):\n 1. X \\<in> HashSet G \\<union> analz H", "proof (induction X rule: analz.induct)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (HashSet G \\<union> H);\n        Enc X Y \\<in> HashSet G \\<union> analz H;\n        Y \\<in> synth\n                 (analz (HashSet G \\<union> H) \\<inter>\n                  {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (epubK Y) \\<in> HashSet G \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (HashSet G \\<union> H) \\<inter>\n                {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "case (Dec Y K')"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz (HashSet G \\<union> H)\n  Enc Y K' \\<in> HashSet G \\<union> analz H\n  K' \\<in> synth\n            (analz (HashSet G \\<union> H) \\<inter>\n             {a. a \\<in> HashSet G \\<union> analz H})\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (HashSet G \\<union> H);\n        Enc X Y \\<in> HashSet G \\<union> analz H;\n        Y \\<in> synth\n                 (analz (HashSet G \\<union> H) \\<inter>\n                  {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (epubK Y) \\<in> HashSet G \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (HashSet G \\<union> H) \\<inter>\n                {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "from Dec.IH(1)"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> HashSet G \\<union> analz H", "have \"Enc Y K' \\<in> analz H\""], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> HashSet G \\<union> analz H\n\ngoal (1 subgoal):\n 1. Enc Y K' \\<in> analz H", "by auto"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (HashSet G \\<union> H);\n        Enc X Y \\<in> HashSet G \\<union> analz H;\n        Y \\<in> synth\n                 (analz (HashSet G \\<union> H) \\<inter>\n                  {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (epubK Y) \\<in> HashSet G \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (HashSet G \\<union> H) \\<inter>\n                {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "moreover"], ["proof (state)\nthis:\n  Enc Y K' \\<in> analz H\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (HashSet G \\<union> H);\n        Enc X Y \\<in> HashSet G \\<union> analz H;\n        Y \\<in> synth\n                 (analz (HashSet G \\<union> H) \\<inter>\n                  {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (epubK Y) \\<in> HashSet G \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (HashSet G \\<union> H) \\<inter>\n                {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "have \"K' \\<in> synth (analz H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "have \"K' \\<in> range LtK \\<union> payload\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "using \\<open>Enc Y K' \\<in> analz H\\<close> assms(1)"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  Enc_keys_clean H\n\ngoal (1 subgoal):\n 1. K' \\<in> range LtK \\<union> payload", "by (auto dest: Enc_keys_clean_analz)"], ["proof (state)\nthis:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "thus ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> range LtK \\<union> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. K' \\<in> range LtK \\<Longrightarrow> K' \\<in> synth (analz H)\n 2. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "assume \"K' \\<in> range LtK\""], ["proof (state)\nthis:\n  K' \\<in> range LtK\n\ngoal (2 subgoals):\n 1. K' \\<in> range LtK \\<Longrightarrow> K' \\<in> synth (analz H)\n 2. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "then"], ["proof (chain)\npicking this:\n  K' \\<in> range LtK", "obtain KK where \"K' = LtK KK\""], ["proof (prove)\nusing this:\n  K' \\<in> range LtK\n\ngoal (1 subgoal):\n 1. (\\<And>KK. K' = LtK KK \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  K' = LtK KK\n\ngoal (2 subgoals):\n 1. K' \\<in> range LtK \\<Longrightarrow> K' \\<in> synth (analz H)\n 2. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' = LtK KK\n\ngoal (2 subgoals):\n 1. K' \\<in> range LtK \\<Longrightarrow> K' \\<in> synth (analz H)\n 2. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "with Dec.IH(2)"], ["proof (chain)\npicking this:\n  K' \\<in> synth\n            (analz (HashSet G \\<union> H) \\<inter>\n             {a. a \\<in> HashSet G \\<union> analz H})\n  K' = LtK KK", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (HashSet G \\<union> H) \\<inter>\n             {a. a \\<in> HashSet G \\<union> analz H})\n  K' = LtK KK\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "assume \"K' \\<in> payload\""], ["proof (state)\nthis:\n  K' \\<in> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  K' \\<in> payload\n\ngoal (1 subgoal):\n 1. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "from assms"], ["proof (chain)\npicking this:\n  Enc_keys_clean H\n  G \\<subseteq> - payload", "have \"HashSet G \\<inter> payload = {}\""], ["proof (prove)\nusing this:\n  Enc_keys_clean H\n  G \\<subseteq> - payload\n\ngoal (1 subgoal):\n 1. HashSet G \\<inter> payload = {}", "by auto"], ["proof (state)\nthis:\n  HashSet G \\<inter> payload = {}\n\ngoal (1 subgoal):\n 1. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "moreover"], ["proof (state)\nthis:\n  HashSet G \\<inter> payload = {}\n\ngoal (1 subgoal):\n 1. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "from Dec.IH(2)"], ["proof (chain)\npicking this:\n  K' \\<in> synth\n            (analz (HashSet G \\<union> H) \\<inter>\n             {a. a \\<in> HashSet G \\<union> analz H})", "have \"K' \\<in> synth (HashSet G \\<union> analz H)\""], ["proof (prove)\nusing this:\n  K' \\<in> synth\n            (analz (HashSet G \\<union> H) \\<inter>\n             {a. a \\<in> HashSet G \\<union> analz H})\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (HashSet G \\<union> analz H)", "by (auto simp add: Collect_disj_eq dest: synth_Int2)"], ["proof (state)\nthis:\n  K' \\<in> synth (HashSet G \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "ultimately"], ["proof (chain)\npicking this:\n  K' \\<in> payload\n  HashSet G \\<inter> payload = {}\n  K' \\<in> synth (HashSet G \\<union> analz H)", "have \"K' \\<in> synth (analz H) \\<union> -payload\""], ["proof (prove)\nusing this:\n  K' \\<in> payload\n  HashSet G \\<inter> payload = {}\n  K' \\<in> synth (HashSet G \\<union> analz H)\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H) \\<union> - payload", "by (auto dest: synth_payload2 [THEN [2] rev_subsetD])"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> payload \\<Longrightarrow> K' \\<in> synth (analz H)", "with \\<open>K' \\<in> payload\\<close>"], ["proof (chain)\npicking this:\n  K' \\<in> payload\n  K' \\<in> synth (analz H) \\<union> - payload", "show ?thesis"], ["proof (prove)\nusing this:\n  K' \\<in> payload\n  K' \\<in> synth (analz H) \\<union> - payload\n\ngoal (1 subgoal):\n 1. K' \\<in> synth (analz H)", "by auto"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  K' \\<in> synth (analz H)\n\ngoal (7 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Enc X Y \\<in> analz (HashSet G \\<union> H);\n        Enc X Y \\<in> HashSet G \\<union> analz H;\n        Y \\<in> synth\n                 (analz (HashSet G \\<union> H) \\<inter>\n                  {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (epubK Y) \\<in> HashSet G \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (HashSet G \\<union> H) \\<inter>\n                {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 7. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "ultimately"], ["proof (chain)\npicking this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)", "show ?case"], ["proof (prove)\nusing this:\n  Enc Y K' \\<in> analz H\n  K' \\<in> synth (analz H)\n\ngoal (1 subgoal):\n 1. Y \\<in> HashSet G \\<union> analz H", "by auto"], ["proof (state)\nthis:\n  Y \\<in> HashSet G \\<union> analz H\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (epubK Y) \\<in> HashSet G \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (HashSet G \\<union> H) \\<inter>\n                {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (epubK Y) \\<in> HashSet G \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (HashSet G \\<union> H) \\<inter>\n                {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "case (Adec_eph Y K')"], ["proof (state)\nthis:\n  Aenc Y (epubK K') \\<in> analz (HashSet G \\<union> H)\n  Aenc Y (epubK K') \\<in> HashSet G \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (HashSet G \\<union> H) \\<inter>\n          {a. a \\<in> HashSet G \\<union> analz H})\n\ngoal (6 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Aenc X (epubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (epubK Y) \\<in> HashSet G \\<union> analz H;\n        epriK Y\n        \\<in> synth\n               (analz (HashSet G \\<union> H) \\<inter>\n                {a. a \\<in> HashSet G \\<union> analz H})\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 6. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "thus ?case"], ["proof (prove)\nusing this:\n  Aenc Y (epubK K') \\<in> analz (HashSet G \\<union> H)\n  Aenc Y (epubK K') \\<in> HashSet G \\<union> analz H\n  epriK K'\n  \\<in> synth\n         (analz (HashSet G \\<union> H) \\<inter>\n          {a. a \\<in> HashSet G \\<union> analz H})\n\ngoal (1 subgoal):\n 1. Y \\<in> HashSet G \\<union> analz H", "by (auto dest!: EpriK_synth)"], ["proof (state)\nthis:\n  Y \\<in> HashSet G \\<union> analz H\n\ngoal (5 subgoals):\n 1. \\<And>X.\n       X \\<in> HashSet G \\<union> H \\<Longrightarrow>\n       X \\<in> HashSet G \\<union> analz H\n 2. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 3. \\<And>X Y.\n       \\<lbrakk>\\<langle>X, Y\\<rangle> \\<in> analz (HashSet G \\<union> H);\n        \\<langle>X, Y\\<rangle> \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> Y \\<in> HashSet G \\<union> analz H\n 4. \\<And>X Y.\n       \\<lbrakk>Aenc X (pubK Y) \\<in> analz (HashSet G \\<union> H);\n        Aenc X (pubK Y) \\<in> HashSet G \\<union> analz H;\n        priK Y \\<in> analz (HashSet G \\<union> H);\n        priK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H\n 5. \\<And>X Y.\n       \\<lbrakk>Sign X (priK Y) \\<in> analz (HashSet G \\<union> H);\n        Sign X (priK Y) \\<in> HashSet G \\<union> analz H;\n        pubK Y \\<in> analz (HashSet G \\<union> H);\n        pubK Y \\<in> HashSet G \\<union> analz H\\<rbrakk>\n       \\<Longrightarrow> X \\<in> HashSet G \\<union> analz H", "qed (insert assms(2), auto)"], ["proof (state)\nthis:\n  X \\<in> HashSet G \\<union> analz H\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}