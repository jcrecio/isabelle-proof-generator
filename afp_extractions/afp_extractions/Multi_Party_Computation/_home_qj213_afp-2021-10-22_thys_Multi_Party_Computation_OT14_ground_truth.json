{"file_name": "/home/qj213/afp-2021-10-22/thys/Multi_Party_Computation/OT14.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Multi_Party_Computation", "problem_names": ["lemma OT_12_P1_assms_bound': \"\\<bar>spmf (bind_spmf (R1_OT12 (m0,m1) c) (\\<lambda> view. ((D::'v_OT121 \\<Rightarrow> bool spmf) view ))) True \n                - spmf (bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (D view ))) True\\<bar> \\<le> adv_OT12\"", "lemma OT_12_P2_assm: \"R2_OT12 (m0,m1) \\<sigma> = funct_OT_12 (m0,m1) \\<sigma> \\<bind> (\\<lambda> (out1, out2). S2_OT12 \\<sigma> out2)\"", "lemma lossless_protocol_14_OT: \"lossless_spmf (protocol_14_OT M C)\"", "lemma lossless_R1_14: \"lossless_spmf (R1_14 msgs C)\"", "lemma lossless_R1_14_interm1: \"lossless_spmf (R1_14_interm1 msgs C)\"", "lemma lossless_R1_14_interm2: \"lossless_spmf (R1_14_interm2 msgs C)\"", "lemma lossless_S1_14: \"lossless_spmf (S1_14 m out)\"", "lemma reduction_step1: \n  shows \"\\<exists> A1. \\<bar>spmf (bind_spmf (R1_14 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True\\<bar> =\n              \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c0) (\\<lambda> view. (A1 view (m0,m1))))) True -\n                  spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar>\"", "lemma reduction_step1':\n  shows \"\\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c0) (\\<lambda> view. (A1 view (m0,m1))))) True -\n                  spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar> \n                        \\<le> adv_OT12\"\n  (is \"?lhs \\<le> adv_OT12\")", "lemma reduction_step2: \n  shows \"\\<exists> A1. \\<bar>spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True\\<bar> =\n          \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A1 view (m0,m1))))) True -\n            spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar>\"", "lemma reduction_step3: \n  shows \"\\<exists> A1. \\<bar>spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True - spmf (bind_spmf (S1_14 M out) D) True\\<bar> =\n          \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A1 view (m0,m1))))) True -\n            spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar>\"", "lemma reduction_P1_interm: \n  shows \"\\<bar>spmf (bind_spmf (R1_14 M (c0,c1)) (D)) True - spmf (bind_spmf (S1_14 M out) (D)) True\\<bar> \\<le> 3 * adv_OT12\"\n    (is \"?lhs \\<le> ?rhs\")", "lemma reduction_P1: \"\\<bar>spmf (bind_spmf (R1_14 M (c0,c1)) (D)) True \n                        - spmf (funct_OT_14 M (c0,c1) \\<bind> (\\<lambda> (out1,out2). S1_14 M out1 \\<bind> (\\<lambda> view. D view))) True\\<bar> \n                              \\<le> 3 * adv_OT12\"", "lemma coin_coin: \"map_spmf (\\<lambda> S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf\"\n  (is \"?lhs = ?rhs\")", "lemma coin_coin': \"map_spmf (\\<lambda> S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf\"", "lemma lossless_R2_14: \"lossless_spmf (R2_14 M C)\"", "lemma lossless_S2_14: \"lossless_spmf (S2_14 c out)\"", "lemma P2_OT_14_FT: \"R2_14 (m0,m1,m2,m3) (False,True) = funct_OT_14 (m0,m1,m2,m3) (False,True) \\<bind> (\\<lambda> (out1, out2). S2_14 (False,True) out2)\"", "lemma P2_OT_14_TT: \"R2_14 (m0,m1,m2,m3) (True,True) = funct_OT_14 (m0,m1,m2,m3) (True,True) \\<bind> (\\<lambda> (out1, out2). S2_14 (True,True) out2)\"", "lemma P2_OT_14_FF: \"R2_14 (m0,m1,m2,m3) (False, False) = funct_OT_14 (m0,m1,m2,m3) (False, False) \\<bind> (\\<lambda> (out1, out2). S2_14 (False, False) out2)\"", "lemma P2_OT_14_TF: \"R2_14 (m0,m1,m2,m3) (True,False) = funct_OT_14 (m0,m1,m2,m3) (True,False) \\<bind> (\\<lambda> (out1, out2). S2_14 (True,False) out2)\"", "lemma P2_sec_OT_14_split: \"R2_14 (m0,m1,m2,m3) (c0,c1) = funct_OT_14 (m0,m1,m2,m3) (c0,c1) \\<bind> (\\<lambda> (out1, out2). S2_14 (c0,c1) out2)\"", "lemma P2_sec_OT_14: \"R2_14 M C = funct_OT_14 M C \\<bind> (\\<lambda> (out1, out2). S2_14 C out2)\"", "lemma correctness_OT_14: \n  shows \"funct_OT_14 M C = protocol_14_OT M C\"", "lemma OT_14_correct: \"OT_14.correctness M C\"", "lemma OT_14_P2_sec: \"OT_14.perfect_sec_P2 m1 m2\"", "lemma OT_14_P1_sec: \"OT_14.adv_P1 m1 m2 D \\<le> 3 * adv_OT12\"", "lemma OT_14_P1_sec: \"OT_14.adv_P1 (R1_12_0T n) n m1 m2 D \\<le> 3 * (adv_OT12 n)\"", "theorem OT_14_P1_asym_sec: \"negligible (\\<lambda> n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)\" if \"negligible (\\<lambda> n. adv_OT12 n)\"", "theorem OT_14_P2_asym_sec: \"OT_14.perfect_sec_P2 R2_OT12 n m1 m2\""], "translations": [["", "lemma OT_12_P1_assms_bound': \"\\<bar>spmf (bind_spmf (R1_OT12 (m0,m1) c) (\\<lambda> view. ((D::'v_OT121 \\<Rightarrow> bool spmf) view ))) True \n                - spmf (bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (D view ))) True\\<bar> \\<le> adv_OT12\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n    \\<le> adv_OT12", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n    \\<le> adv_OT12", "have \"sim_det_def.adv_P1 R1_OT12 S1_OT12 funct_OT_12 (m0,m1) c D =\n                      \\<bar>spmf (bind_spmf (R1_OT12 (m0,m1) c) (\\<lambda> view. (D view ))) True \n                                    - spmf (funct_OT_12 (m0,m1) c \\<bind> (\\<lambda> ((out1::unit), (out2::bool)). \n                                              S1_OT12 (m0,m1) out1 \\<bind> (\\<lambda> view. D view))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. OT_12_sim.adv_P1 (m0, m1) c D =\n    \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf\n           (funct_OT_12 (m0, m1) c \\<bind>\n            (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n           True\\<bar>", "using sim_det_def.adv_P1_def"], ["proof (prove)\nusing this:\n  sim_det_def ?R1.0 ?S1.0 ?R2.0 ?S2.0 ?funct \\<Longrightarrow>\n  sim_det_def.adv_P1 ?R1.0 ?S1.0 ?funct ?m1.0 ?m2.0 ?D \\<equiv>\n  \\<bar>spmf (?R1.0 ?m1.0 ?m2.0 \\<bind> ?D) True -\n        spmf\n         (?funct ?m1.0 ?m2.0 \\<bind>\n          (\\<lambda>(o1, o2). ?S1.0 ?m1.0 o1 \\<bind> ?D))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. OT_12_sim.adv_P1 (m0, m1) c D =\n    \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf\n           (funct_OT_12 (m0, m1) c \\<bind>\n            (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n           True\\<bar>", "using  OT_12_sim.adv_P1_def"], ["proof (prove)\nusing this:\n  sim_det_def ?R1.0 ?S1.0 ?R2.0 ?S2.0 ?funct \\<Longrightarrow>\n  sim_det_def.adv_P1 ?R1.0 ?S1.0 ?funct ?m1.0 ?m2.0 ?D \\<equiv>\n  \\<bar>spmf (?R1.0 ?m1.0 ?m2.0 \\<bind> ?D) True -\n        spmf\n         (?funct ?m1.0 ?m2.0 \\<bind>\n          (\\<lambda>(o1, o2). ?S1.0 ?m1.0 o1 \\<bind> ?D))\n         True\\<bar>\n  OT_12_sim.adv_P1 ?m1.0 ?m2.0 ?D \\<equiv>\n  \\<bar>spmf (R1_OT12 ?m1.0 ?m2.0 \\<bind> ?D) True -\n        spmf\n         (funct_OT_12 ?m1.0 ?m2.0 \\<bind>\n          (\\<lambda>(o1, o2). S1_OT12 ?m1.0 o1 \\<bind> ?D))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. OT_12_sim.adv_P1 (m0, m1) c D =\n    \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf\n           (funct_OT_12 (m0, m1) c \\<bind>\n            (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n           True\\<bar>", "by auto"], ["proof (state)\nthis:\n  OT_12_sim.adv_P1 (m0, m1) c D =\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf\n         (funct_OT_12 (m0, m1) c \\<bind>\n          (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n    \\<le> adv_OT12", "also"], ["proof (state)\nthis:\n  OT_12_sim.adv_P1 (m0, m1) c D =\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf\n         (funct_OT_12 (m0, m1) c \\<bind>\n          (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n    \\<le> adv_OT12", "have \"... = \\<bar>spmf (bind_spmf (R1_OT12 (m0,m1) c) (\\<lambda> view. ((D::'v_OT121 \\<Rightarrow> bool spmf) view ))) True \n                - spmf (bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (D view ))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf\n           (funct_OT_12 (m0, m1) c \\<bind>\n            (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n           True\\<bar> =\n    \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>", "by(simp add: funct_OT_12_def)"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf\n         (funct_OT_12 (m0, m1) c \\<bind>\n          (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n         True\\<bar> =\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n    \\<le> adv_OT12", "ultimately"], ["proof (chain)\npicking this:\n  OT_12_sim.adv_P1 (m0, m1) c D =\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf\n         (funct_OT_12 (m0, m1) c \\<bind>\n          (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n         True\\<bar>\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf\n         (funct_OT_12 (m0, m1) c \\<bind>\n          (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n         True\\<bar> =\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>", "show ?thesis"], ["proof (prove)\nusing this:\n  OT_12_sim.adv_P1 (m0, m1) c D =\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf\n         (funct_OT_12 (m0, m1) c \\<bind>\n          (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n         True\\<bar>\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf\n         (funct_OT_12 (m0, m1) c \\<bind>\n          (\\<lambda>(out1, out2). S1_OT12 (m0, m1) out1 \\<bind> D))\n         True\\<bar> =\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n          spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n    \\<le> adv_OT12", "by(metis ass_adv_OT12)"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_OT12 (m0, m1) c \\<bind> D) True -\n        spmf (S1_OT12 (m0, m1) () \\<bind> D) True\\<bar>\n  \\<le> adv_OT12\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma OT_12_P2_assm: \"R2_OT12 (m0,m1) \\<sigma> = funct_OT_12 (m0,m1) \\<sigma> \\<bind> (\\<lambda> (out1, out2). S2_OT12 \\<sigma> out2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_OT12 (m0, m1) \\<sigma> =\n    funct_OT_12 (m0, m1) \\<sigma> \\<bind>\n    (\\<lambda>(out1, out2). S2_OT12 \\<sigma> out2)", "using inf_th_OT12_P2 OT_12_sim.perfect_sec_P2_def"], ["proof (prove)\nusing this:\n  sim_det_def.perfect_sec_P2 R2_OT12 S2_OT12 ?funct_OT12.0 (?m0.0, ?m1.0)\n   ?\\<sigma>\n  OT_12_sim.perfect_sec_P2 ?m1.0 ?m2.0 \\<equiv>\n  R2_OT12 ?m1.0 ?m2.0 =\n  funct_OT_12 ?m1.0 ?m2.0 \\<bind> (\\<lambda>(s1, s2). S2_OT12 ?m2.0 s2)\n\ngoal (1 subgoal):\n 1. R2_OT12 (m0, m1) \\<sigma> =\n    funct_OT_12 (m0, m1) \\<sigma> \\<bind>\n    (\\<lambda>(out1, out2). S2_OT12 \\<sigma> out2)", "by blast"], ["", "definition protocol_14_OT :: \"input1 \\<Rightarrow> input2 \\<Rightarrow> (unit \\<times> bool) spmf\"\n  where \"protocol_14_OT M C = do {\n    let (c0,c1) = C;\n    let (m00, m01, m10, m11) = M;\n    S0 \\<leftarrow> coin_spmf;\n    S1 \\<leftarrow> coin_spmf;\n    S2 \\<leftarrow> coin_spmf;\n    S3 \\<leftarrow> coin_spmf;\n    S4 \\<leftarrow> coin_spmf;\n    S5 \\<leftarrow> coin_spmf;\n    let a0 = S0 \\<oplus> S2 \\<oplus> m00;\n    let a1 = S0 \\<oplus> S3 \\<oplus> m01;\n    let a2 = S1 \\<oplus> S4 \\<oplus> m10;\n    let a3 = S1 \\<oplus> S5 \\<oplus> m11;\n    (_,Si) \\<leftarrow> protocol_OT12 (S0, S1) c0;\n    (_,Sj) \\<leftarrow> protocol_OT12 (S2, S3) c1;\n    (_,Sk) \\<leftarrow> protocol_OT12 (S4, S5) c1;\n    let s2 = Si \\<oplus> (if c0 then Sk else Sj) \\<oplus> (if c0 then (if c1 then a3 else a2) else (if c1 then a1 else a0));\n    return_spmf ((), s2)}\""], ["", "lemma lossless_protocol_14_OT: \"lossless_spmf (protocol_14_OT M C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lossless_spmf (protocol_14_OT M C)", "by(simp add: protocol_14_OT_def lossless_protocol_OT12 split_def)"], ["", "definition R1_14 :: \"input1 \\<Rightarrow> input2 \\<Rightarrow> 'v_OT121 view1 spmf\"\n  where \"R1_14 msgs choice = do {\n    let (m00, m01, m10, m11) = msgs;\n    let (c0, c1) = choice;\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a :: 'v_OT121 \\<leftarrow> R1_OT12 (S0, S1) c0; \n    b :: 'v_OT121 \\<leftarrow> R1_OT12 (S2, S3) c1;\n    c :: 'v_OT121 \\<leftarrow> R1_OT12 (S4, S5) c1;\n    return_spmf (msgs, (S0, S1, S2, S3, S4, S5), a, b, c)}\""], ["", "lemma lossless_R1_14: \"lossless_spmf (R1_14 msgs C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lossless_spmf (R1_14 msgs C)", "by(simp add: R1_14_def split_def lossless_R1_12)"], ["", "definition R1_14_interm1 :: \"input1 \\<Rightarrow> input2 \\<Rightarrow> 'v_OT121 view1 spmf\"\n  where \"R1_14_interm1 msgs choice = do {\n    let (m00, m01, m10, m11) = msgs;\n    let (c0, c1) = choice;\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a :: 'v_OT121 \\<leftarrow> S1_OT12 (S0, S1) (); \n    b :: 'v_OT121 \\<leftarrow> R1_OT12 (S2, S3) c1;\n    c :: 'v_OT121 \\<leftarrow> R1_OT12 (S4, S5) c1;\n    return_spmf (msgs, (S0, S1, S2, S3, S4, S5), a, b, c)}\""], ["", "lemma lossless_R1_14_interm1: \"lossless_spmf (R1_14_interm1 msgs C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lossless_spmf (R1_14_interm1 msgs C)", "by(simp add: R1_14_interm1_def split_def lossless_R1_12 lossless_S1_12)"], ["", "definition R1_14_interm2 :: \"input1 \\<Rightarrow> input2 \\<Rightarrow> 'v_OT121 view1 spmf\"\n  where \"R1_14_interm2 msgs choice = do {\n    let (m00, m01, m10, m11) = msgs;\n    let (c0, c1) = choice;\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a :: 'v_OT121 \\<leftarrow> S1_OT12 (S0, S1) (); \n    b :: 'v_OT121 \\<leftarrow> S1_OT12 (S2, S3) ();\n    c :: 'v_OT121 \\<leftarrow> R1_OT12 (S4, S5) c1;\n    return_spmf (msgs, (S0, S1, S2, S3, S4, S5), a, b, c)}\""], ["", "lemma lossless_R1_14_interm2: \"lossless_spmf (R1_14_interm2 msgs C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lossless_spmf (R1_14_interm2 msgs C)", "by(simp add: R1_14_interm2_def split_def lossless_R1_12 lossless_S1_12)"], ["", "definition S1_14 :: \"input1 \\<Rightarrow> unit \\<Rightarrow> 'v_OT121 view1 spmf\"\n  where \"S1_14 msgs _ = do {   \n    let (m00, m01, m10, m11) = msgs;    \n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a :: 'v_OT121 \\<leftarrow> S1_OT12 (S0, S1) (); \n    b :: 'v_OT121 \\<leftarrow> S1_OT12 (S2, S3) ();\n    c :: 'v_OT121 \\<leftarrow> S1_OT12 (S4, S5) ();\n    return_spmf (msgs, (S0, S1, S2, S3, S4, S5), a, b, c)}\""], ["", "lemma lossless_S1_14: \"lossless_spmf (S1_14 m out)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lossless_spmf (S1_14 m out)", "by(simp add: S1_14_def lossless_S1_12)"], ["", "lemma reduction_step1: \n  shows \"\\<exists> A1. \\<bar>spmf (bind_spmf (R1_14 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True\\<bar> =\n              \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c0) (\\<lambda> view. (A1 view (m0,m1))))) True -\n                  spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c0 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "including monad_normalisation"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c0 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c0 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "define A1' where \"A1' == \\<lambda> (view :: 'v_OT121) (m0,m1). do {\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    b :: 'v_OT121 \\<leftarrow> R1_OT12 (S2, S3) c1;\n    c :: 'v_OT121 \\<leftarrow> R1_OT12 (S4, S5) c1;\n    let R = (M, (m0,m1, S2, S3, S4, S5), view, b, c);\n    D R}\""], ["proof (state)\nthis:\n  A1' \\<equiv>\n  \\<lambda>view (m0, m1).\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         coin_spmf \\<bind>\n         (\\<lambda>S3.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 coin_spmf \\<bind>\n                 (\\<lambda>S5.\n                     R1_OT12 (S2, S3) c1 \\<bind>\n                     (\\<lambda>b.\n                         R1_OT12 (S4, S5) c1 \\<bind>\n                         (\\<lambda>c.\n                             Let (M, (m0, m1, S2, S3, S4, S5), view, b, c)\n                              D))))))\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c0 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "have \"\\<bar>spmf (bind_spmf (R1_14 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True\\<bar> =\n       \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c0) (\\<lambda> view. (A1' view (m0,m1))))) True -\n        spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1' view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "apply(simp add: pair_spmf_alt_def R1_14_def R1_14_interm1_def A1'_def Let_def split_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      R1_OT12 (yf, yg) c1 \\<bind>\n      (\\<lambda>yh. D (M, (y, ya, yc, yd, yf, yg), yb, ye, yh)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      S1_OT12 (yf, yg) () \\<bind>\n      (\\<lambda>yh. D (M, (yf, yg, y, ya, yc, yd), yh, yb, ye)))))))))))\n           True\\<bar> =\n    \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S2.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S3.\n                                R1_OT12 (S2, S3) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, S2, S3, S4, S5), view, b, c)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    S1_OT12 (y, ya) () \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S2.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S3.\n                                R1_OT12 (S2, S3) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, S2, S3, S4, S5), view, b, c)))))))))))\n           True\\<bar>", "apply(subst bind_commute_spmf[of \"S1_OT12 _ _\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      R1_OT12 (yf, yg) c1 \\<bind>\n      (\\<lambda>yh. D (M, (y, ya, yc, yd, yf, yg), yb, ye, yh)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      S1_OT12 (yf, yg) () \\<bind>\n      (\\<lambda>yh. D (M, (yf, yg, y, ya, yc, yd), yh, yb, ye)))))))))))\n           True\\<bar> =\n    \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S2.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S3.\n                                R1_OT12 (S2, S3) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, S2, S3, S4, S5), view, b, c)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yb.\n                        S1_OT12 (y, ya) () \\<bind>\n                        (\\<lambda>x.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S3.\n                                R1_OT12 (yb, S3) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, yb, S3, S4, S5), x, b, c)))))))))))\n           True\\<bar>", "apply(subst bind_commute_spmf[of \"S1_OT12 _ _\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      R1_OT12 (yf, yg) c1 \\<bind>\n      (\\<lambda>yh. D (M, (y, ya, yc, yd, yf, yg), yb, ye, yh)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      S1_OT12 (yf, yg) () \\<bind>\n      (\\<lambda>yh. D (M, (yf, yg, y, ya, yc, yd), yh, yb, ye)))))))))))\n           True\\<bar> =\n    \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S2.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S3.\n                                R1_OT12 (S2, S3) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, S2, S3, S4, S5), view, b, c)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>x.\n                                R1_OT12 (yb, yc) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, yb, yc, S4, S5), x, b, c)))))))))))\n           True\\<bar>", "apply(subst bind_commute_spmf[of \"S1_OT12 _ _\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      R1_OT12 (yf, yg) c1 \\<bind>\n      (\\<lambda>yh. D (M, (y, ya, yc, yd, yf, yg), yb, ye, yh)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      S1_OT12 (yf, yg) () \\<bind>\n      (\\<lambda>yh. D (M, (yf, yg, y, ya, yc, yd), yh, yb, ye)))))))))))\n           True\\<bar> =\n    \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S2.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S3.\n                                R1_OT12 (S2, S3) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, S2, S3, S4, S5), view, b, c)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            R1_OT12 (yb, yc) c1 \\<bind>\n                            (\\<lambda>yd.\n                                S1_OT12 (y, ya) () \\<bind>\n                                (\\<lambda>x.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, yb, yc, S4, S5), x, yd, c)))))))))))\n           True\\<bar>", "apply(subst bind_commute_spmf[of \"S1_OT12 _ _\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      R1_OT12 (yf, yg) c1 \\<bind>\n      (\\<lambda>yh. D (M, (y, ya, yc, yd, yf, yg), yb, ye, yh)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      S1_OT12 (yf, yg) () \\<bind>\n      (\\<lambda>yh. D (M, (yf, yg, y, ya, yc, yd), yh, yb, ye)))))))))))\n           True\\<bar> =\n    \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S2.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S3.\n                                R1_OT12 (S2, S3) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, S2, S3, S4, S5), view, b, c)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            R1_OT12 (yb, yc) c1 \\<bind>\n                            (\\<lambda>yd.\n                                coin_spmf \\<bind>\n                                (\\<lambda>ye.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>x.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (ye, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, yb, yc, ye, S5), x, yd, c)))))))))))\n           True\\<bar>", "apply(subst bind_commute_spmf[of \"S1_OT12 _ _\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      R1_OT12 (yf, yg) c1 \\<bind>\n      (\\<lambda>yh. D (M, (y, ya, yc, yd, yf, yg), yb, ye, yh)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            coin_spmf \\<bind>\n                            (\\<lambda>yd.\n                                R1_OT12 (yc, yd) c1 \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  coin_spmf \\<bind>\n  (\\<lambda>yg.\n      S1_OT12 (yf, yg) () \\<bind>\n      (\\<lambda>yh. D (M, (yf, yg, y, ya, yc, yd), yh, yb, ye)))))))))))\n           True\\<bar> =\n    \\<bar>spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    R1_OT12 (y, ya) c0 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S2.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S3.\n                                R1_OT12 (S2, S3) c1 \\<bind>\n                                (\\<lambda>b.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S4.\n  coin_spmf \\<bind>\n  (\\<lambda>S5.\n      R1_OT12 (S4, S5) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, S2, S3, S4, S5), view, b, c)))))))))))\n           True -\n          spmf\n           (coin_spmf \\<bind>\n            (\\<lambda>y.\n                coin_spmf \\<bind>\n                (\\<lambda>ya.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yb.\n                        coin_spmf \\<bind>\n                        (\\<lambda>yc.\n                            R1_OT12 (yb, yc) c1 \\<bind>\n                            (\\<lambda>yd.\n                                coin_spmf \\<bind>\n                                (\\<lambda>ye.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>yf.\n  S1_OT12 (y, ya) () \\<bind>\n  (\\<lambda>x.\n      R1_OT12 (ye, yf) c1 \\<bind>\n      (\\<lambda>c. D (M, (y, ya, yb, yc, ye, yf), x, yd, c)))))))))))\n           True\\<bar>", "by auto"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c0 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "then"], ["proof (chain)\npicking this:\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c0 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "by auto"], ["proof (state)\nthis:\n  \\<exists>A1.\n     \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n           spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n     \\<bar>spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 R1_OT12 (m0, m1) c0 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True -\n           spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma reduction_step1':\n  shows \"\\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c0) (\\<lambda> view. (A1 view (m0,m1))))) True -\n                  spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar> \n                        \\<le> adv_OT12\"\n  (is \"?lhs \\<le> adv_OT12\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "have int1: \"integrable (measure_spmf (pair_spmf coin_spmf coin_spmf)) (\\<lambda>x. spmf (case x of (m0, m1) \\<Rightarrow> R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1))) True)\" \n    and int2: \"integrable (measure_spmf (pair_spmf coin_spmf coin_spmf)) (\\<lambda>x. spmf (case x of (m0, m1) \\<Rightarrow> S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1))) True)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n     (\\<lambda>x.\n         spmf\n          (case x of\n           (m0, m1) \\<Rightarrow>\n             R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n          True) &&&\n    integrable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n     (\\<lambda>x.\n         spmf\n          (case x of\n           (m0, m1) \\<Rightarrow>\n             S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n          True)", "by(rule measure_spmf.integrable_const_bound[where B=1]; simp add: pmf_le_1)+"], ["proof (state)\nthis:\n  integrable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n   (\\<lambda>x.\n       spmf\n        (case x of\n         (m0, m1) \\<Rightarrow>\n           R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n        True)\n  integrable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n   (\\<lambda>x.\n       spmf\n        (case x of\n         (m0, m1) \\<Rightarrow>\n           S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n        True)\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "have \"?lhs = \n            \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf). spmf (case x of (m0, m1) \\<Rightarrow> R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1))) True \n              - spmf (case x of (m0, m1) \\<Rightarrow> S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar> =\n    \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n             spmf\n              (case x of\n               (m0, m1) \\<Rightarrow>\n                 R1_OT12 (m0, m1) c0 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1)))\n              True -\n             spmf\n              (case x of\n               (m0, m1) \\<Rightarrow>\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1)))\n              True\\<bar>", "apply(subst (1 2) spmf_bind)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n              spmf\n               (case x of\n                (m0, m1) \\<Rightarrow>\n                  R1_OT12 (m0, m1) c0 \\<bind>\n                  (\\<lambda>view. A1 view (m0, m1)))\n               True) -\n          (LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n              spmf\n               (case x of\n                (m0, m1) \\<Rightarrow>\n                  S1_OT12 (m0, m1) () \\<bind>\n                  (\\<lambda>view. A1 view (m0, m1)))\n               True)\\<bar> =\n    \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n             spmf\n              (case x of\n               (m0, m1) \\<Rightarrow>\n                 R1_OT12 (m0, m1) c0 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1)))\n              True -\n             spmf\n              (case x of\n               (m0, m1) \\<Rightarrow>\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1)))\n              True\\<bar>", "using int1 int2"], ["proof (prove)\nusing this:\n  integrable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n   (\\<lambda>x.\n       spmf\n        (case x of\n         (m0, m1) \\<Rightarrow>\n           R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n        True)\n  integrable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n   (\\<lambda>x.\n       spmf\n        (case x of\n         (m0, m1) \\<Rightarrow>\n           S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n        True)\n\ngoal (1 subgoal):\n 1. \\<bar>(LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n              spmf\n               (case x of\n                (m0, m1) \\<Rightarrow>\n                  R1_OT12 (m0, m1) c0 \\<bind>\n                  (\\<lambda>view. A1 view (m0, m1)))\n               True) -\n          (LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n              spmf\n               (case x of\n                (m0, m1) \\<Rightarrow>\n                  S1_OT12 (m0, m1) () \\<bind>\n                  (\\<lambda>view. A1 view (m0, m1)))\n               True)\\<bar> =\n    \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n             spmf\n              (case x of\n               (m0, m1) \\<Rightarrow>\n                 R1_OT12 (m0, m1) c0 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1)))\n              True -\n             spmf\n              (case x of\n               (m0, m1) \\<Rightarrow>\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1)))\n              True\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar> =\n  \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               R1_OT12 (m0, m1) c0 \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True -\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               S1_OT12 (m0, m1) () \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "also"], ["proof (state)\nthis:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar> =\n  \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               R1_OT12 (m0, m1) c0 \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True -\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               S1_OT12 (m0, m1) () \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "have \"... \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf). \n               \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True - spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x)) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n             spmf\n              (case x of\n               (m0, m1) \\<Rightarrow>\n                 R1_OT12 (m0, m1) c0 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1)))\n              True -\n             spmf\n              (case x of\n               (m0, m1) \\<Rightarrow>\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1)))\n              True\\<bar>\n    \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n             \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                    True -\n                   spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                    True\\<bar>", "by(rule integral_abs_bound[THEN order_trans]; simp add: split_beta)"], ["proof (state)\nthis:\n  \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               R1_OT12 (m0, m1) c0 \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True -\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               S1_OT12 (m0, m1) () \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True\\<bar>\n  \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                  True -\n                 spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                  True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "ultimately"], ["proof (chain)\npicking this:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar> =\n  \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               R1_OT12 (m0, m1) c0 \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True -\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               S1_OT12 (m0, m1) () \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True\\<bar>\n  \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               R1_OT12 (m0, m1) c0 \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True -\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               S1_OT12 (m0, m1) () \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True\\<bar>\n  \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                  True -\n                 spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                  True\\<bar>", "have \"?lhs \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf). \n                      \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True - spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x)) True\\<bar>\""], ["proof (prove)\nusing this:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar> =\n  \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               R1_OT12 (m0, m1) c0 \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True -\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               S1_OT12 (m0, m1) () \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True\\<bar>\n  \\<bar>LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               R1_OT12 (m0, m1) c0 \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True -\n           spmf\n            (case x of\n             (m0, m1) \\<Rightarrow>\n               S1_OT12 (m0, m1) () \\<bind>\n               (\\<lambda>view. A1 view (m0, m1)))\n            True\\<bar>\n  \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                  True -\n                 spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                  True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n             \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                    True -\n                   spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                    True\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                  True -\n                 spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                  True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "also"], ["proof (state)\nthis:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                  True -\n                 spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                  True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "have \"LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf). \n                \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view::'v_OT121. A1 view x)) True \n                    - spmf (S1_OT12 x () \\<bind> (\\<lambda>view::'v_OT121. A1 view x)) True\\<bar> \\<le> adv_OT12\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n       \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n             spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n              True\\<bar>\n    \\<le> adv_OT12", "apply(rule integral_mono[THEN order_trans])"], ["proof (prove)\ngoal (4 subgoals):\n 1. integrable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n     (\\<lambda>x.\n         \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n               spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                True\\<bar>)\n 2. integrable (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n 3. \\<And>x.\n       x \\<in> space\n                (measure_spmf\n                  (pair_spmf coin_spmf coin_spmf)) \\<Longrightarrow>\n       \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n             spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n              True\\<bar>\n       \\<le> ?g1 x\n 4. integral\\<^sup>L (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n    \\<le> adv_OT12", "apply(rule measure_spmf.integrable_const_bound[where B=2])"], ["proof (prove)\ngoal (5 subgoals):\n 1. AE x in measure_spmf\n             (pair_spmf coin_spmf\n               coin_spmf). norm\n                            \\<bar>spmf\n                                   (R1_OT12 x c0 \\<bind>\n                                    (\\<lambda>view. A1 view x))\n                                   True -\n                                  spmf\n                                   (S1_OT12 x () \\<bind>\n                                    (\\<lambda>view. A1 view x))\n                                   True\\<bar>\n                           \\<le> 2\n 2. (\\<lambda>x.\n        \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n              spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n               True\\<bar>)\n    \\<in> borel_measurable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n 3. integrable (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n 4. \\<And>x.\n       x \\<in> space\n                (measure_spmf\n                  (pair_spmf coin_spmf coin_spmf)) \\<Longrightarrow>\n       \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n             spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n              True\\<bar>\n       \\<le> ?g1 x\n 5. integral\\<^sup>L (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n    \\<le> adv_OT12", "apply clarsimp"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<bar>spmf\n              (R1_OT12 (a, b) c0 \\<bind> (\\<lambda>view. A1 view (a, b)))\n              True -\n             spmf\n              (S1_OT12 (a, b) () \\<bind> (\\<lambda>view. A1 view (a, b)))\n              True\\<bar>\n       \\<le> 2\n 2. (\\<lambda>x.\n        \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n              spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n               True\\<bar>)\n    \\<in> borel_measurable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n 3. integrable (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n 4. \\<And>x.\n       x \\<in> space\n                (measure_spmf\n                  (pair_spmf coin_spmf coin_spmf)) \\<Longrightarrow>\n       \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n             spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n              True\\<bar>\n       \\<le> ?g1 x\n 5. integral\\<^sup>L (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n    \\<le> adv_OT12", "apply(rule abs_triangle_ineq4[THEN order_trans])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<bar>spmf\n              (R1_OT12 (a, b) c0 \\<bind> (\\<lambda>view. A1 view (a, b)))\n              True\\<bar> +\n       \\<bar>spmf\n              (S1_OT12 (a, b) () \\<bind> (\\<lambda>view. A1 view (a, b)))\n              True\\<bar>\n       \\<le> 2\n 2. (\\<lambda>x.\n        \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n              spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n               True\\<bar>)\n    \\<in> borel_measurable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n 3. integrable (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n 4. \\<And>x.\n       x \\<in> space\n                (measure_spmf\n                  (pair_spmf coin_spmf coin_spmf)) \\<Longrightarrow>\n       \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n             spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n              True\\<bar>\n       \\<le> ?g1 x\n 5. integral\\<^sup>L (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n    \\<le> adv_OT12", "subgoal for m0 m1"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n           True\\<bar> +\n    \\<bar>spmf\n           (S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n           True\\<bar>\n    \\<le> 2", "using pmf_le_1[of \"R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1))\" \"Some True\"]\n        pmf_le_1[of \"S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1))\" \"Some True\"]"], ["proof (prove)\nusing this:\n  spmf (R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1))) True\n  \\<le> 1\n  spmf (S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1))) True\n  \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (R1_OT12 (m0, m1) c0 \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n           True\\<bar> +\n    \\<bar>spmf\n           (S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1 view (m0, m1)))\n           True\\<bar>\n    \\<le> 2", "by simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. (\\<lambda>x.\n        \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n              spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n               True\\<bar>)\n    \\<in> borel_measurable (measure_spmf (pair_spmf coin_spmf coin_spmf))\n 2. integrable (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n 3. \\<And>x.\n       x \\<in> space\n                (measure_spmf\n                  (pair_spmf coin_spmf coin_spmf)) \\<Longrightarrow>\n       \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n             spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n              True\\<bar>\n       \\<le> ?g1 x\n 4. integral\\<^sup>L (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n    \\<le> adv_OT12", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. integrable (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n 2. \\<And>x.\n       x \\<in> space\n                (measure_spmf\n                  (pair_spmf coin_spmf coin_spmf)) \\<Longrightarrow>\n       \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n             spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n              True\\<bar>\n       \\<le> ?g1 x\n 3. integral\\<^sup>L (measure_spmf (pair_spmf coin_spmf coin_spmf)) ?g1\n    \\<le> adv_OT12", "apply(rule measure_spmf.integrable_const)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> space\n                (measure_spmf\n                  (pair_spmf coin_spmf coin_spmf)) \\<Longrightarrow>\n       \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n             spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n              True\\<bar>\n       \\<le> ?g17\n 2. LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf). ?g17 \\<le> adv_OT12", "apply clarify"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       (a, b)\n       \\<in> space\n              (measure_spmf\n                (pair_spmf coin_spmf coin_spmf)) \\<Longrightarrow>\n       \\<bar>spmf\n              (R1_OT12 (a, b) c0 \\<bind> (\\<lambda>view. A1 view (a, b)))\n              True -\n             spmf\n              (S1_OT12 (a, b) () \\<bind> (\\<lambda>view. A1 view (a, b)))\n              True\\<bar>\n       \\<le> ?g17\n 2. LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf). ?g17 \\<le> adv_OT12", "apply(rule OT_12_P1_assms_bound'[rule_format])"], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf). adv_OT12\n    \\<le> adv_OT12", "by simp"], ["proof (state)\nthis:\n  LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n     \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n           spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x)) True\\<bar>\n  \\<le> adv_OT12\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "ultimately"], ["proof (chain)\npicking this:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                  True -\n                 spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                  True\\<bar>\n  LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n     \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n           spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x)) True\\<bar>\n  \\<le> adv_OT12", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<le> LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n           \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x))\n                  True -\n                 spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x))\n                  True\\<bar>\n  LINT x|measure_spmf (pair_spmf coin_spmf coin_spmf).\n     \\<bar>spmf (R1_OT12 x c0 \\<bind> (\\<lambda>view. A1 view x)) True -\n           spmf (S1_OT12 x () \\<bind> (\\<lambda>view. A1 view x)) True\\<bar>\n  \\<le> adv_OT12\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "by simp"], ["proof (state)\nthis:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma reduction_step2: \n  shows \"\\<exists> A1. \\<bar>spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True\\<bar> =\n          \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A1 view (m0,m1))))) True -\n            spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "define A1' where \"A1' == \\<lambda> (view :: 'v_OT121) (m0,m1). do {\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a :: 'v_OT121 \\<leftarrow> S1_OT12 (S2,S3) ();\n    c :: 'v_OT121 \\<leftarrow> R1_OT12 (S4, S5) c1;\n    let R = (M, (S2,S3, m0, m1, S4, S5), a, view, c);\n    D R}\""], ["proof (state)\nthis:\n  A1' \\<equiv>\n  \\<lambda>view (m0, m1).\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         coin_spmf \\<bind>\n         (\\<lambda>S3.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 coin_spmf \\<bind>\n                 (\\<lambda>S5.\n                     S1_OT12 (S2, S3) () \\<bind>\n                     (\\<lambda>a.\n                         R1_OT12 (S4, S5) c1 \\<bind>\n                         (\\<lambda>c.\n                             Let (M, (S2, S3, m0, m1, S4, S5), a, view, c)\n                              D))))))\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "have \"\\<bar>spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True\\<bar> =\n       \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A1' view (m0,m1))))) True -\n        spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1' view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n          spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n          spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "have \"(bind_spmf (R1_14_interm1 M (c0, c1)) D) = (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A1' view (m0,m1)))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R1_14_interm1 M (c0, c1) \\<bind> D =\n    pair_spmf coin_spmf coin_spmf \\<bind>\n    (\\<lambda>(m0, m1).\n        R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))", "unfolding R1_14_interm1_def R1_14_interm2_def A1'_def Let_def split_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S3.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S5.\n                            S1_OT12 (S0, S1) () \\<bind>\n                            (\\<lambda>a.\n                                R1_OT12 (S2, S3) (snd (c0, c1)) \\<bind>\n                                (\\<lambda>b.\n                                    R1_OT12 (S4, S5) (snd (c0, c1)) \\<bind>\n                                    (\\<lambda>c.\n  return_spmf (M, (S0, S1, S2, S3, S4, S5), a, b, c)))))))))) \\<bind>\n    D =\n    pair_spmf coin_spmf coin_spmf \\<bind>\n    (\\<lambda>p.\n        R1_OT12 (fst p, snd p) c1 \\<bind>\n        (\\<lambda>view.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S3.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S5.\n                            S1_OT12 (S2, S3) () \\<bind>\n                            (\\<lambda>a.\n                                R1_OT12 (S4, S5) c1 \\<bind>\n                                (\\<lambda>c.\n                                    D (M,\n (S2, S3, fst (fst p, snd p), snd (fst p, snd p), S4, S5), a, view,\n c)))))))))", "apply(simp add: pair_spmf_alt_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                R1_OT12 (yb, yc) c1 \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            R1_OT12 (y, ya) c1 \\<bind>\n            (\\<lambda>view.\n                coin_spmf \\<bind>\n                (\\<lambda>S2.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S3.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (S2, S3) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (S4, S5) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (S2, S3, y, ya, S4, S5), a, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                R1_OT12 (yb, yc) c1 \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                R1_OT12 (y, ya) c1 \\<bind>\n                (\\<lambda>view.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S3.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, S3) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (S4, S5) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (yb, S3, y, ya, S4, S5), a, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                R1_OT12 (yb, yc) c1 \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (S4, S5) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (yb, yc, y, ya, S4, S5), a, view, c))))))))))", "including monad_normalisation"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                R1_OT12 (yb, yc) c1 \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (S4, S5) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (yb, yc, y, ya, S4, S5), a, view, c))))))))))", "by(simp)"], ["proof (state)\nthis:\n  R1_14_interm1 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n          spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "also"], ["proof (state)\nthis:\n  R1_14_interm1 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n          spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "have \"(bind_spmf (R1_14_interm2 M (c0, c1)) D) =  (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1' view (m0,m1)))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R1_14_interm2 M (c0, c1) \\<bind> D =\n    pair_spmf coin_spmf coin_spmf \\<bind>\n    (\\<lambda>(m0, m1).\n        S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1' view (m0, m1)))", "unfolding R1_14_interm1_def R1_14_interm2_def A1'_def Let_def split_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S3.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S5.\n                            S1_OT12 (S0, S1) () \\<bind>\n                            (\\<lambda>a.\n                                S1_OT12 (S2, S3) () \\<bind>\n                                (\\<lambda>b.\n                                    R1_OT12 (S4, S5) (snd (c0, c1)) \\<bind>\n                                    (\\<lambda>c.\n  return_spmf (M, (S0, S1, S2, S3, S4, S5), a, b, c)))))))))) \\<bind>\n    D =\n    pair_spmf coin_spmf coin_spmf \\<bind>\n    (\\<lambda>p.\n        S1_OT12 (fst p, snd p) () \\<bind>\n        (\\<lambda>view.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S3.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S5.\n                            S1_OT12 (S2, S3) () \\<bind>\n                            (\\<lambda>a.\n                                R1_OT12 (S4, S5) c1 \\<bind>\n                                (\\<lambda>c.\n                                    D (M,\n (S2, S3, fst (fst p, snd p), snd (fst p, snd p), S4, S5), a, view,\n c)))))))))", "apply(simp add: pair_spmf_alt_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            S1_OT12 (y, ya) () \\<bind>\n            (\\<lambda>view.\n                coin_spmf \\<bind>\n                (\\<lambda>S2.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S3.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (S2, S3) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (S4, S5) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (S2, S3, y, ya, S4, S5), a, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                S1_OT12 (y, ya) () \\<bind>\n                (\\<lambda>view.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S3.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, S3) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (S4, S5) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (yb, S3, y, ya, S4, S5), a, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    S1_OT12 (y, ya) () \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (S4, S5) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (yb, yc, y, ya, S4, S5), a, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        S1_OT12 (y, ya) () \\<bind>\n                        (\\<lambda>view.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (yd, S5) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (yb, yc, y, ya, yd, S5), a, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>view.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (yb, yc, y, ya, yd, ye), a, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (y, ya) () \\<bind>\n                                (\\<lambda>view.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (yb, yc, y, ya, yd, ye), yf, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\"  in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (ya, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (y, yb) () \\<bind>\n                                (\\<lambda>view.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (ya, yc, y, yb, yd, ye), yf, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (ya, yb) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (y, yc) () \\<bind>\n                                (\\<lambda>view.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (ya, yb, y, yc, yd, ye), yf, view, c))))))))))", "apply(rewrite in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, yb) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (ya, yc) () \\<bind>\n                                (\\<lambda>view.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (y, yb, ya, yc, yd, ye), yf, view, c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\"  in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>view.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>c.\n  D (M, (y, ya, yb, yc, yd, ye), yf, view, c))))))))))", "by(simp)"], ["proof (state)\nthis:\n  R1_14_interm2 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n          spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "ultimately"], ["proof (chain)\npicking this:\n  R1_14_interm1 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n  R1_14_interm2 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1' view (m0, m1)))", "show ?thesis"], ["proof (prove)\nusing this:\n  R1_14_interm1 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n  R1_14_interm2 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n          spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "then"], ["proof (chain)\npicking this:\n  \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n             spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "by auto"], ["proof (state)\nthis:\n  \\<exists>A1.\n     \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n           spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n     \\<bar>spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 R1_OT12 (m0, m1) c1 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True -\n           spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma reduction_step3: \n  shows \"\\<exists> A1. \\<bar>spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True - spmf (bind_spmf (S1_14 M out) D) True\\<bar> =\n          \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A1 view (m0,m1))))) True -\n            spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n             spmf (S1_14 M out \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n             spmf (S1_14 M out \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "define A1' where \"A1' == \\<lambda> (view :: 'v_OT121) (m0,m1). do {\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a :: 'v_OT121 \\<leftarrow> S1_OT12 (S2,S3) ();\n    b :: 'v_OT121 \\<leftarrow> S1_OT12 (S4, S5) ();\n    let R = (M, (S2,S3, S4, S5,m0, m1), a, b, view);\n    D R}\""], ["proof (state)\nthis:\n  A1' \\<equiv>\n  \\<lambda>view (m0, m1).\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         coin_spmf \\<bind>\n         (\\<lambda>S3.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 coin_spmf \\<bind>\n                 (\\<lambda>S5.\n                     S1_OT12 (S2, S3) () \\<bind>\n                     (\\<lambda>a.\n                         S1_OT12 (S4, S5) () \\<bind>\n                         (\\<lambda>b.\n                             Let (M, (S2, S3, S4, S5, m0, m1), a, b, view)\n                              D))))))\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n             spmf (S1_14 M out \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "have \"\\<bar>spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True - spmf (bind_spmf (S1_14 M out) D) True\\<bar> =\n       \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A1' view (m0,m1))))) True -\n        spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1' view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "have \"(bind_spmf (R1_14_interm2 M (c0, c1)) D) = (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A1' view (m0,m1)))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R1_14_interm2 M (c0, c1) \\<bind> D =\n    pair_spmf coin_spmf coin_spmf \\<bind>\n    (\\<lambda>(m0, m1).\n        R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))", "unfolding  R1_14_interm2_def A1'_def Let_def split_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S3.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S5.\n                            S1_OT12 (S0, S1) () \\<bind>\n                            (\\<lambda>a.\n                                S1_OT12 (S2, S3) () \\<bind>\n                                (\\<lambda>b.\n                                    R1_OT12 (S4, S5) (snd (c0, c1)) \\<bind>\n                                    (\\<lambda>c.\n  return_spmf (M, (S0, S1, S2, S3, S4, S5), a, b, c)))))))))) \\<bind>\n    D =\n    pair_spmf coin_spmf coin_spmf \\<bind>\n    (\\<lambda>p.\n        R1_OT12 (fst p, snd p) c1 \\<bind>\n        (\\<lambda>view.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S3.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S5.\n                            S1_OT12 (S2, S3) () \\<bind>\n                            (\\<lambda>a.\n                                S1_OT12 (S4, S5) () \\<bind>\n                                (\\<lambda>b.\n                                    D (M,\n (S2, S3, S4, S5, fst (fst p, snd p), snd (fst p, snd p)), a, b,\n view)))))))))", "apply(simp add: pair_spmf_alt_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            R1_OT12 (y, ya) c1 \\<bind>\n            (\\<lambda>view.\n                coin_spmf \\<bind>\n                (\\<lambda>S2.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S3.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (S2, S3) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (S4, S5) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (S2, S3, S4, S5, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                R1_OT12 (y, ya) c1 \\<bind>\n                (\\<lambda>view.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S3.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, S3) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (S4, S5) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, S3, S4, S5, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    R1_OT12 (y, ya) c1 \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (S4, S5) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, yc, S4, S5, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        R1_OT12 (y, ya) c1 \\<bind>\n                        (\\<lambda>view.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (yd, S5) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, yc, yd, S5, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            R1_OT12 (y, ya) c1 \\<bind>\n                            (\\<lambda>view.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, yc, yd, ye, y, ya), a, b, view))))))))))", "including monad_normalisation"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    R1_OT12 (yd, ye) c1 \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            R1_OT12 (y, ya) c1 \\<bind>\n                            (\\<lambda>view.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, yc, yd, ye, y, ya), a, b, view))))))))))", "by(simp)"], ["proof (state)\nthis:\n  R1_14_interm2 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "also"], ["proof (state)\nthis:\n  R1_14_interm2 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "have \"(bind_spmf (S1_14 M out) D) = (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1' view (m0,m1)))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S1_14 M out \\<bind> D =\n    pair_spmf coin_spmf coin_spmf \\<bind>\n    (\\<lambda>(m0, m1).\n        S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1' view (m0, m1)))", "unfolding S1_14_def Let_def A1'_def split_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S3.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S5.\n                            S1_OT12 (S0, S1) () \\<bind>\n                            (\\<lambda>a.\n                                S1_OT12 (S2, S3) () \\<bind>\n                                (\\<lambda>b.\n                                    S1_OT12 (S4, S5) () \\<bind>\n                                    (\\<lambda>c.\n  return_spmf (M, (S0, S1, S2, S3, S4, S5), a, b, c)))))))))) \\<bind>\n    D =\n    pair_spmf coin_spmf coin_spmf \\<bind>\n    (\\<lambda>p.\n        S1_OT12 (fst p, snd p) () \\<bind>\n        (\\<lambda>view.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S3.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S5.\n                            S1_OT12 (S2, S3) () \\<bind>\n                            (\\<lambda>a.\n                                S1_OT12 (S4, S5) () \\<bind>\n                                (\\<lambda>b.\n                                    D (M,\n (S2, S3, S4, S5, fst (fst p, snd p), snd (fst p, snd p)), a, b,\n view)))))))))", "apply(simp add: pair_spmf_alt_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            S1_OT12 (y, ya) () \\<bind>\n            (\\<lambda>view.\n                coin_spmf \\<bind>\n                (\\<lambda>S2.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S3.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (S2, S3) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (S4, S5) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (S2, S3, S4, S5, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                S1_OT12 (y, ya) () \\<bind>\n                (\\<lambda>view.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S3.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, S3) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (S4, S5) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, S3, S4, S5, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    S1_OT12 (y, ya) () \\<bind>\n                    (\\<lambda>view.\n                        coin_spmf \\<bind>\n                        (\\<lambda>S4.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (S4, S5) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, yc, S4, S5, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        S1_OT12 (y, ya) () \\<bind>\n                        (\\<lambda>view.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S5.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (yd, S5) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, yc, yd, S5, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>view.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>a.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, yc, yd, ye, y, ya), a, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (y, ya) () \\<bind>\n                                (\\<lambda>view.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>b.\n  D (M, (yb, yc, yd, ye, y, ya), yf, b, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (y, ya) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (y, ya, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "apply(rewrite in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (ya, y) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (ya, y, yb, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, y) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (ya, yc) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (yb, y, ya, yc, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yc, y) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (ya, yb) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yd, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (yc, y, ya, yb, yd, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yd, y) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (ya, yb) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yc, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (yd, y, ya, yb, yc, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yd, y) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yb, ya) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yc, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (yd, y, yb, ya, yc, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yd, y) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yc, ya) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yb, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (yd, y, yc, ya, yb, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yc, y) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ya) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yb, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (yc, y, yd, ya, yb, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "including monad_normalisation"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yc, y) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ya) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (yb, ye) () \\<bind>\n                                    (\\<lambda>yh.\n  D (M, (yc, y, yd, ya, yb, ye), yf, yg, yh)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>y.\n        coin_spmf \\<bind>\n        (\\<lambda>ya.\n            coin_spmf \\<bind>\n            (\\<lambda>yb.\n                coin_spmf \\<bind>\n                (\\<lambda>yc.\n                    coin_spmf \\<bind>\n                    (\\<lambda>yd.\n                        coin_spmf \\<bind>\n                        (\\<lambda>ye.\n                            S1_OT12 (yb, yc) () \\<bind>\n                            (\\<lambda>yf.\n                                S1_OT12 (yd, ye) () \\<bind>\n                                (\\<lambda>yg.\n                                    S1_OT12 (y, ya) () \\<bind>\n                                    (\\<lambda>view.\n  D (M, (yb, yc, yd, ye, y, ya), yf, yg, view))))))))))", "by(simp)"], ["proof (state)\nthis:\n  S1_14 M out \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "ultimately"], ["proof (chain)\npicking this:\n  R1_14_interm2 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n  S1_14 M out \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1' view (m0, m1)))", "show ?thesis"], ["proof (prove)\nusing this:\n  R1_14_interm2 M (c0, c1) \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      R1_OT12 (m0, m1) c1 \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n  S1_14 M out \\<bind> D =\n  pair_spmf coin_spmf coin_spmf \\<bind>\n  (\\<lambda>(m0, m1).\n      S1_OT12 (m0, m1) () \\<bind> (\\<lambda>view. A1' view (m0, m1)))\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar> =\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1' view (m0, m1))))\n           True\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n             spmf (S1_14 M out \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "then"], ["proof (chain)\npicking this:\n  \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1' view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<exists>A1.\n       \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n             spmf (S1_14 M out \\<bind> D) True\\<bar> =\n       \\<bar>spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   R1_OT12 (m0, m1) c1 \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True -\n             spmf\n              (pair_spmf coin_spmf coin_spmf \\<bind>\n               (\\<lambda>(m0, m1).\n                   S1_OT12 (m0, m1) () \\<bind>\n                   (\\<lambda>view. A1 view (m0, m1))))\n              True\\<bar>", "by auto"], ["proof (state)\nthis:\n  \\<exists>A1.\n     \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n           spmf (S1_14 M out \\<bind> D) True\\<bar> =\n     \\<bar>spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 R1_OT12 (m0, m1) c1 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True -\n           spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma reduction_P1_interm: \n  shows \"\\<bar>spmf (bind_spmf (R1_14 M (c0,c1)) (D)) True - spmf (bind_spmf (S1_14 M out) (D)) True\\<bar> \\<le> 3 * adv_OT12\"\n    (is \"?lhs \\<le> ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "have lhs: \"?lhs \\<le> \\<bar>spmf (bind_spmf (R1_14 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True\\<bar> + \n                     \\<bar>spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True\\<bar> +\n                      \\<bar>spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True - spmf (bind_spmf (S1_14 M out) D) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n                spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> +\n          \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n                spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> +\n          \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n                spmf (S1_14 M out \\<bind> D) True\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar>\n  \\<le> \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n              spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> +\n        \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n              spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> +\n        \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n              spmf (S1_14 M out \\<bind> D) True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "obtain A1 where A1: \"\\<bar>spmf (bind_spmf (R1_14 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True\\<bar> =\n                        \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c0) (\\<lambda> view. (A1 view (m0,m1))))) True -\n                          spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A1.\n        \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n              spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c0 \\<bind>\n                    (\\<lambda>view. A1 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A1 view (m0, m1))))\n               True\\<bar> \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using reduction_step1"], ["proof (prove)\nusing this:\n  \\<exists>A1.\n     \\<bar>spmf (R1_14 ?M (?c0.0, ?c1.0) \\<bind> ?D) True -\n           spmf (R1_14_interm1 ?M (?c0.0, ?c1.0) \\<bind> ?D) True\\<bar> =\n     \\<bar>spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 R1_OT12 (m0, m1) ?c0.0 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True -\n           spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True\\<bar>\n\ngoal (1 subgoal):\n 1. (\\<And>A1.\n        \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n              spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c0 \\<bind>\n                    (\\<lambda>view. A1 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A1 view (m0, m1))))\n               True\\<bar> \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "obtain A2 where A2: \"\\<bar>spmf (bind_spmf (R1_14_interm1 M (c0, c1)) D) True - spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True\\<bar> = \n                        \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A2 view (m0,m1))))) True -\n                          spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A2 view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A2.\n        \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n              spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c1 \\<bind>\n                    (\\<lambda>view. A2 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A2 view (m0, m1))))\n               True\\<bar> \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using reduction_step2"], ["proof (prove)\nusing this:\n  \\<exists>A1.\n     \\<bar>spmf (R1_14_interm1 ?M (?c0.0, ?c1.0) \\<bind> ?D) True -\n           spmf (R1_14_interm2 ?M (?c0.0, ?c1.0) \\<bind> ?D) True\\<bar> =\n     \\<bar>spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 R1_OT12 (m0, m1) ?c1.0 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True -\n           spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True\\<bar>\n\ngoal (1 subgoal):\n 1. (\\<And>A2.\n        \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n              spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c1 \\<bind>\n                    (\\<lambda>view. A2 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A2 view (m0, m1))))\n               True\\<bar> \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "obtain A3 where A3: \"\\<bar>spmf (bind_spmf (R1_14_interm2 M (c0, c1)) D) True - spmf (bind_spmf (S1_14 M out) D) True\\<bar> =\n                        \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A3 view (m0,m1))))) True -\n                          spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A3 view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A3.\n        \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n              spmf (S1_14 M out \\<bind> D) True\\<bar> =\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c1 \\<bind>\n                    (\\<lambda>view. A3 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A3 view (m0, m1))))\n               True\\<bar> \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using reduction_step3"], ["proof (prove)\nusing this:\n  \\<exists>A1.\n     \\<bar>spmf (R1_14_interm2 ?M (?c0.0, ?c1.0) \\<bind> ?D) True -\n           spmf (S1_14 ?M ?out \\<bind> ?D) True\\<bar> =\n     \\<bar>spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 R1_OT12 (m0, m1) ?c1.0 \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True -\n           spmf\n            (pair_spmf coin_spmf coin_spmf \\<bind>\n             (\\<lambda>(m0, m1).\n                 S1_OT12 (m0, m1) () \\<bind>\n                 (\\<lambda>view. A1 view (m0, m1))))\n            True\\<bar>\n\ngoal (1 subgoal):\n 1. (\\<And>A3.\n        \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n              spmf (S1_14 M out \\<bind> D) True\\<bar> =\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c1 \\<bind>\n                    (\\<lambda>view. A3 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A3 view (m0, m1))))\n               True\\<bar> \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "have lhs_bound: \"?lhs \\<le> \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c0) (\\<lambda> view. (A1 view (m0,m1))))) True -\n                  spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar> + \n                   \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A2 view (m0,m1))))) True -\n                    spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A2 view (m0,m1))))) True\\<bar> +\n                     \\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A3 view (m0,m1))))) True -\n                      spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A3 view (m0,m1))))) True\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> \\<bar>spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      R1_OT12 (m0, m1) c0 \\<bind>\n                      (\\<lambda>view. A1 view (m0, m1))))\n                 True -\n                spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      S1_OT12 (m0, m1) () \\<bind>\n                      (\\<lambda>view. A1 view (m0, m1))))\n                 True\\<bar> +\n          \\<bar>spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      R1_OT12 (m0, m1) c1 \\<bind>\n                      (\\<lambda>view. A2 view (m0, m1))))\n                 True -\n                spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      S1_OT12 (m0, m1) () \\<bind>\n                      (\\<lambda>view. A2 view (m0, m1))))\n                 True\\<bar> +\n          \\<bar>spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      R1_OT12 (m0, m1) c1 \\<bind>\n                      (\\<lambda>view. A3 view (m0, m1))))\n                 True -\n                spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      S1_OT12 (m0, m1) () \\<bind>\n                      (\\<lambda>view. A3 view (m0, m1))))\n                 True\\<bar>", "using A1 A2 A3 lhs"], ["proof (prove)\nusing this:\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n        spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True\\<bar>\n  \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar> =\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True\\<bar>\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar>\n  \\<le> \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n              spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True\\<bar> +\n        \\<bar>spmf (R1_14_interm1 M (c0, c1) \\<bind> D) True -\n              spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True\\<bar> +\n        \\<bar>spmf (R1_14_interm2 M (c0, c1) \\<bind> D) True -\n              spmf (S1_14 M out \\<bind> D) True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> \\<bar>spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      R1_OT12 (m0, m1) c0 \\<bind>\n                      (\\<lambda>view. A1 view (m0, m1))))\n                 True -\n                spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      S1_OT12 (m0, m1) () \\<bind>\n                      (\\<lambda>view. A1 view (m0, m1))))\n                 True\\<bar> +\n          \\<bar>spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      R1_OT12 (m0, m1) c1 \\<bind>\n                      (\\<lambda>view. A2 view (m0, m1))))\n                 True -\n                spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      S1_OT12 (m0, m1) () \\<bind>\n                      (\\<lambda>view. A2 view (m0, m1))))\n                 True\\<bar> +\n          \\<bar>spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      R1_OT12 (m0, m1) c1 \\<bind>\n                      (\\<lambda>view. A3 view (m0, m1))))\n                 True -\n                spmf\n                 (pair_spmf coin_spmf coin_spmf \\<bind>\n                  (\\<lambda>(m0, m1).\n                      S1_OT12 (m0, m1) () \\<bind>\n                      (\\<lambda>view. A3 view (m0, m1))))\n                 True\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar>\n  \\<le> \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c0 \\<bind>\n                    (\\<lambda>view. A1 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A1 view (m0, m1))))\n               True\\<bar> +\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c1 \\<bind>\n                    (\\<lambda>view. A2 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A2 view (m0, m1))))\n               True\\<bar> +\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c1 \\<bind>\n                    (\\<lambda>view. A3 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A3 view (m0, m1))))\n               True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "have bound1: \"\\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c0) (\\<lambda> view. (A1 view (m0,m1))))) True -\n                  spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A1 view (m0,m1))))) True\\<bar> \n                      \\<le> adv_OT12\" \n    and bound2: \"\\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A2 view (m0,m1))))) True -\n                  spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A2 view (m0,m1))))) True\\<bar> \n                      \\<le> adv_OT12\" \n    and bound3: \"\\<bar>spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (R1_OT12 (m0,m1) c1) (\\<lambda> view. (A3 view (m0,m1))))) True -\n        spmf (bind_spmf (pair_spmf coin_spmf coin_spmf) (\\<lambda>(m0, m1). bind_spmf (S1_OT12 (m0,m1) ()) (\\<lambda> view. (A3 view (m0,m1))))) True\\<bar> \\<le> adv_OT12\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12 &&&\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A2 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A2 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12 &&&\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A3 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A3 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "using reduction_step1'"], ["proof (prove)\nusing this:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) ?c0.0 \\<bind>\n              (\\<lambda>view. ?A1.0 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. ?A1.0 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n\ngoal (1 subgoal):\n 1. \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c0 \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A1 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12 &&&\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A2 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A2 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12 &&&\n    \\<bar>spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                R1_OT12 (m0, m1) c1 \\<bind>\n                (\\<lambda>view. A3 view (m0, m1))))\n           True -\n          spmf\n           (pair_spmf coin_spmf coin_spmf \\<bind>\n            (\\<lambda>(m0, m1).\n                S1_OT12 (m0, m1) () \\<bind>\n                (\\<lambda>view. A3 view (m0, m1))))\n           True\\<bar>\n    \\<le> adv_OT12", "by auto"], ["proof (state)\nthis:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "using reduction_step1' lhs_bound"], ["proof (prove)\nusing this:\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c0 \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A1 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A2 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) c1 \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. A3 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n  \\<bar>spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              R1_OT12 (m0, m1) ?c0.0 \\<bind>\n              (\\<lambda>view. ?A1.0 view (m0, m1))))\n         True -\n        spmf\n         (pair_spmf coin_spmf coin_spmf \\<bind>\n          (\\<lambda>(m0, m1).\n              S1_OT12 (m0, m1) () \\<bind>\n              (\\<lambda>view. ?A1.0 view (m0, m1))))\n         True\\<bar>\n  \\<le> adv_OT12\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar>\n  \\<le> \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c0 \\<bind>\n                    (\\<lambda>view. A1 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A1 view (m0, m1))))\n               True\\<bar> +\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c1 \\<bind>\n                    (\\<lambda>view. A2 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A2 view (m0, m1))))\n               True\\<bar> +\n        \\<bar>spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    R1_OT12 (m0, m1) c1 \\<bind>\n                    (\\<lambda>view. A3 view (m0, m1))))\n               True -\n              spmf\n               (pair_spmf coin_spmf coin_spmf \\<bind>\n                (\\<lambda>(m0, m1).\n                    S1_OT12 (m0, m1) () \\<bind>\n                    (\\<lambda>view. A3 view (m0, m1))))\n               True\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf (S1_14 M out \\<bind> D) True\\<bar>\n    \\<le> 3 * adv_OT12", "by argo"], ["proof (state)\nthis:\n  \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n        spmf (S1_14 M out \\<bind> D) True\\<bar>\n  \\<le> 3 * adv_OT12\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma reduction_P1: \"\\<bar>spmf (bind_spmf (R1_14 M (c0,c1)) (D)) True \n                        - spmf (funct_OT_14 M (c0,c1) \\<bind> (\\<lambda> (out1,out2). S1_14 M out1 \\<bind> (\\<lambda> view. D view))) True\\<bar> \n                              \\<le> 3 * adv_OT12\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 M (c0, c1) \\<bind> D) True -\n          spmf\n           (funct_OT_14 M (c0, c1) \\<bind>\n            (\\<lambda>(out1, out2). S1_14 M out1 \\<bind> D))\n           True\\<bar>\n    \\<le> 3 * adv_OT12", "by(simp add: funct_OT_14_def split_def Let_def reduction_P1_interm )"], ["", "text\\<open>Party 2 security.\\<close>"], ["", "lemma coin_coin: \"map_spmf (\\<lambda> S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf\"\n  (is \"?lhs = ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "have lhs: \"?lhs = map_spmf (\\<lambda> S0. S0 \\<oplus> (S3 \\<oplus> m1)) coin_spmf\""], ["proof (prove)\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n    map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf", "by blast"], ["proof (state)\nthis:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "also"], ["proof (state)\nthis:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "have op_eq: \"... = map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf\""], ["proof (prove)\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n    map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf", "by (metis xor_bool_def)"], ["proof (state)\nthis:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "also"], ["proof (state)\nthis:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "have \"... = ?rhs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf = coin_spmf", "using xor_uni_samp"], ["proof (prove)\nusing this:\n  map_spmf ((\\<oplus>) ?y) coin_spmf = map_spmf (\\<lambda>b. b) coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf = coin_spmf", "by fastforce"], ["proof (state)\nthis:\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf = coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "ultimately"], ["proof (chain)\npicking this:\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf =\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf = coin_spmf", "show ?thesis"], ["proof (prove)\nusing this:\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf =\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf = coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "using op_eq"], ["proof (prove)\nusing this:\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf =\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf = coin_spmf\n  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n  map_spmf ((\\<oplus>) (S3 \\<oplus> m1)) coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "by auto"], ["proof (state)\nthis:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma coin_coin': \"map_spmf (\\<lambda> S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf\""], ["proof (prove)\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "have \"map_spmf (\\<lambda> S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = map_spmf (\\<lambda> S3. S3 \\<oplus> S0 \\<oplus> m1) coin_spmf\""], ["proof (prove)\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n    map_spmf (\\<lambda>S3. S3 \\<oplus> S0 \\<oplus> m1) coin_spmf", "by (metis xor_left_commute)"], ["proof (state)\nthis:\n  map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n  map_spmf (\\<lambda>S3. S3 \\<oplus> S0 \\<oplus> m1) coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "thus ?thesis"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n  map_spmf (\\<lambda>S3. S3 \\<oplus> S0 \\<oplus> m1) coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "using coin_coin"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf =\n  map_spmf (\\<lambda>S3. S3 \\<oplus> S0 \\<oplus> m1) coin_spmf\n  map_spmf (\\<lambda>S0. S0 \\<oplus> ?S3.0 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf", "by simp"], ["proof (state)\nthis:\n  map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf = coin_spmf\n\ngoal:\nNo subgoals!", "qed"], ["", "definition R2_14:: \"input1 \\<Rightarrow> input2 \\<Rightarrow> 'v_OT122 view2 spmf\"\n  where \"R2_14 M C = do {\n    let (m0,m1,m2,m3) = M;\n    let (c0,c1) = C;\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    let a0 = S0 \\<oplus> S2 \\<oplus> m0;\n    let a1 = S0 \\<oplus> S3 \\<oplus> m1;\n    let a2 = S1 \\<oplus> S4 \\<oplus> m2;\n    let a3 = S1 \\<oplus> S5 \\<oplus> m3; \n    a :: 'v_OT122 \\<leftarrow> R2_OT12 (S0,S1) c0;\n    b :: 'v_OT122 \\<leftarrow> R2_OT12 (S2,S3) c1;\n    c :: 'v_OT122 \\<leftarrow> R2_OT12 (S4,S5) c1;\n    return_spmf (C, (a0,a1,a2,a3), a,b,c)}\""], ["", "lemma lossless_R2_14: \"lossless_spmf (R2_14 M C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lossless_spmf (R2_14 M C)", "by(simp add: R2_14_def split_def lossless_R2_12)"], ["", "definition S2_14 :: \"input2 \\<Rightarrow> bool \\<Rightarrow> 'v_OT122 view2 spmf\"\n  where \"S2_14 C out = do {\n    let ((c0::bool),(c1::bool)) = C;\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> coin_spmf;\n    a1 :: bool \\<leftarrow> coin_spmf;\n    a2 :: bool \\<leftarrow> coin_spmf;\n    a3 :: bool \\<leftarrow> coin_spmf;\n    let a0' = (if ((\\<not> c0) \\<and> (\\<not> c1)) then (S0 \\<oplus> S2 \\<oplus> out) else a0);\n    let a1' = (if ((\\<not> c0) \\<and> c1) then (S0 \\<oplus> S3 \\<oplus> out) else a1);\n    let a2' = (if (c0 \\<and> (\\<not> c1)) then (S1 \\<oplus> S4 \\<oplus> out) else a2);\n    let a3' = (if (c0 \\<and> c1) then (S1 \\<oplus> S5 \\<oplus> out) else a3);\n    a :: 'v_OT122 \\<leftarrow> S2_OT12 (c0::bool) (if c0 then S1 else S0);\n    b :: 'v_OT122 \\<leftarrow> S2_OT12 (c1::bool) (if c1 then S3 else S2);\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 (c1::bool) (if c1 then S5 else S4);\n    return_spmf ((c0,c1), (a0',a1',a2',a3'), a,b,c)}\""], ["", "lemma lossless_S2_14: \"lossless_spmf (S2_14 c out)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lossless_spmf (S2_14 c out)", "by(simp add: S2_14_def lossless_S2_12 split_def)"], ["", "lemma P2_OT_14_FT: \"R2_14 (m0,m1,m2,m3) (False,True) = funct_OT_14 (m0,m1,m2,m3) (False,True) \\<bind> (\\<lambda> (out1, out2). S2_14 (False,True) out2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "including monad_normalisation"], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "have \"R2_14 (m0,m1,m2,m3) (False,True) =  do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> map_spmf (\\<lambda> S2. S0 \\<oplus> S2 \\<oplus> m0) coin_spmf;\n    let a1 = S0 \\<oplus> S3 \\<oplus> m1;\n    a2 \\<leftarrow> map_spmf (\\<lambda> S4. S1 \\<oplus> S4 \\<oplus> m2) coin_spmf;\n    let a3 = S1 \\<oplus> S5 \\<oplus> m3; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 False S0; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 True S3;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 True S5;\n    return_spmf ((False,True), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in map_spmf\n                            (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))", "by(simp add: bind_map_spmf o_def Let_def R2_14_def inf_th_OT12_P2 funct_OT_12_def OT_12_P2_assm)"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (False, True) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in map_spmf (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "also"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (False, True) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in map_spmf (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "have \"... =  do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> coin_spmf;\n    let a1 = S0 \\<oplus> S3 \\<oplus> m1;\n    a2 \\<leftarrow> coin_spmf;\n    let a3 = S1 \\<oplus> S5 \\<oplus> m3; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 False S0; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 True S3;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 True S5;\n    return_spmf ((False,True), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in map_spmf\n                            (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))", "using coin_coin'"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S3. ?S0.0 \\<oplus> S3 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in map_spmf\n                            (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))", "by simp"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in map_spmf (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "also"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in map_spmf (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "have \"... =  do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> coin_spmf;\n    let a1 = S0 \\<oplus> S3 \\<oplus> m1;\n    a2 :: bool \\<leftarrow> coin_spmf;\n    a3 \\<leftarrow> map_spmf (\\<lambda> S1. S1 \\<oplus> S5 \\<oplus> m3) coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 False S0; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 True S3;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 True S5;\n    return_spmf ((False,True), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           map_spmf\n                            (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))", "by(simp add: bind_map_spmf o_def Let_def)"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         map_spmf (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "also"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         map_spmf (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "have \"... =  do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> coin_spmf;\n    let a1 = S0 \\<oplus> S3 \\<oplus> m1;\n    a2 :: bool \\<leftarrow> coin_spmf;\n    a3 \\<leftarrow> coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 False S0; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 True S3;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 True S5;\n    return_spmf ((False,True), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           map_spmf\n                            (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))", "using coin_coin"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> ?S3.0 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           map_spmf\n                            (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))", "by simp"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         map_spmf (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "ultimately"], ["proof (chain)\npicking this:\n  R2_14 (m0, m1, m2, m3) (False, True) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         map_spmf (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         map_spmf (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))", "show ?thesis"], ["proof (prove)\nusing this:\n  R2_14 (m0, m1, m2, m3) (False, True) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         map_spmf (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         map_spmf (\\<lambda>S1. S1 \\<oplus> S5 \\<oplus> m3)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, True) =\n    funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, True) out2)", "by(simp add: funct_OT_14_def S2_14_def bind_spmf_const)"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (False, True) =\n  funct_OT_14 (m0, m1, m2, m3) (False, True) \\<bind>\n  (\\<lambda>(out1, out2). S2_14 (False, True) out2)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma P2_OT_14_TT: \"R2_14 (m0,m1,m2,m3) (True,True) = funct_OT_14 (m0,m1,m2,m3) (True,True) \\<bind> (\\<lambda> (out1, out2). S2_14 (True,True) out2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "including monad_normalisation"], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "have \"R2_14 (m0,m1,m2,m3) (True,True) =  do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> map_spmf (\\<lambda> S2. S0 \\<oplus> S2 \\<oplus> m0) coin_spmf;\n    let a1 = S0 \\<oplus> S3 \\<oplus> m1;\n    a2 \\<leftarrow> map_spmf (\\<lambda> S4. S1 \\<oplus> S4 \\<oplus> m2) coin_spmf;\n    let a3 = S1 \\<oplus> S5 \\<oplus> m3;\n    a :: 'v_OT122 \\<leftarrow> S2_OT12 True S1; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 True S3;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 True S5;\n    return_spmf ((True,True), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in map_spmf\n                            (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))", "by(simp add: bind_map_spmf o_def R2_14_def inf_th_OT12_P2 funct_OT_12_def OT_12_P2_assm Let_def)"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (True, True) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in map_spmf (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "also"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (True, True) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in map_spmf (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "have \"... = do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> coin_spmf;\n    let a1 = S0 \\<oplus> S3 \\<oplus> m1;\n    a2 \\<leftarrow> coin_spmf;\n    let a3 = S1 \\<oplus> S5 \\<oplus> m3;\n    a :: 'v_OT122 \\<leftarrow> S2_OT12 True S1; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 True S3;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 True S5;\n    return_spmf ((True,True), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in map_spmf\n                            (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))", "using coin_coin'"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S3. ?S0.0 \\<oplus> S3 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in map_spmf\n                            (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                            coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))", "by simp"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in map_spmf (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "also"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  map_spmf (\\<lambda>S2. S0 \\<oplus> S2 \\<oplus> m0)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in map_spmf (\\<lambda>S4. S1 \\<oplus> S4 \\<oplus> m2)\n                          coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "have \"... = do {\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> coin_spmf;\n    a1 :: bool \\<leftarrow> map_spmf (\\<lambda> S0. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf;\n    a2 \\<leftarrow> coin_spmf;\n    let a3 = S1 \\<oplus> S5 \\<oplus> m3;\n    a :: 'v_OT122 \\<leftarrow> S2_OT12 True S1; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 True S3;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 True S5;\n    return_spmf ((True,True), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S3.\n                coin_spmf \\<bind>\n                (\\<lambda>S5.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a0.\n                        let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a2.\n                               let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                               in S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 True S3 \\<bind>\n(\\<lambda>b.\n    S2_OT12 True S5 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        coin_spmf \\<bind>\n                        (\\<lambda>a2.\n                            let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                            in S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c. return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))", "by(simp add: bind_map_spmf o_def Let_def)"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "also"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S3.\n              coin_spmf \\<bind>\n              (\\<lambda>S5.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a0.\n                      let a1 = S0 \\<oplus> S3 \\<oplus> m1\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a2.\n                             let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                             in S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 True S3 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 True S5 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "have \"... = do {\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S3 :: bool \\<leftarrow> coin_spmf;\n    S5 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> coin_spmf;\n    a1 :: bool \\<leftarrow> coin_spmf;\n    a2 \\<leftarrow> coin_spmf;\n    let a3 = S1 \\<oplus> S5 \\<oplus> m3;\n    a :: 'v_OT122 \\<leftarrow> S2_OT12 True S1; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 True S3;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 True S5;\n    return_spmf ((True,True), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        coin_spmf \\<bind>\n                        (\\<lambda>a2.\n                            let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                            in S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c.\n     return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        coin_spmf \\<bind>\n                        (\\<lambda>a2.\n                            let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                            in S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c. return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))", "using coin_coin"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> ?S3.0 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                     coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        coin_spmf \\<bind>\n                        (\\<lambda>a2.\n                            let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                            in S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c.\n     return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S3.\n            coin_spmf \\<bind>\n            (\\<lambda>S5.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        coin_spmf \\<bind>\n                        (\\<lambda>a2.\n                            let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                            in S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 True S3 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 True S5 \\<bind>\n (\\<lambda>c. return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))", "by simp"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "ultimately"], ["proof (chain)\npicking this:\n  R2_14 (m0, m1, m2, m3) (True, True) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))", "show ?thesis"], ["proof (prove)\nusing this:\n  R2_14 (m0, m1, m2, m3) (True, True) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  map_spmf (\\<lambda>S0. S0 \\<oplus> S3 \\<oplus> m1)\n                   coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S3.\n          coin_spmf \\<bind>\n          (\\<lambda>S5.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      coin_spmf \\<bind>\n                      (\\<lambda>a2.\n                          let a3 = S1 \\<oplus> S5 \\<oplus> m3\n                          in S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 True S3 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 True S5 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, True), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, True) =\n    funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, True) out2)", "by(simp add: funct_OT_14_def S2_14_def bind_spmf_const)"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (True, True) =\n  funct_OT_14 (m0, m1, m2, m3) (True, True) \\<bind>\n  (\\<lambda>(out1, out2). S2_14 (True, True) out2)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma P2_OT_14_FF: \"R2_14 (m0,m1,m2,m3) (False, False) = funct_OT_14 (m0,m1,m2,m3) (False, False) \\<bind> (\\<lambda> (out1, out2). S2_14 (False, False) out2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "including monad_normalisation"], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "have \"R2_14 (m0,m1,m2,m3) (False,False) =  do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    let a0 = S0 \\<oplus> S2 \\<oplus> m0;\n    a1 :: bool \\<leftarrow> map_spmf (\\<lambda> S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf;\n    let a2 = S1 \\<oplus> S4 \\<oplus> m2;\n    a3 \\<leftarrow> map_spmf (\\<lambda> S5. S1 \\<oplus> S5 \\<oplus> m3) coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 False S0; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 False S2;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 False S4;\n    return_spmf ((False,False), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in map_spmf\n                               (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                               coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))", "by(simp add: bind_map_spmf o_def R2_14_def inf_th_OT12_P2 funct_OT_12_def OT_12_P2_assm Let_def)"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (False, False) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in map_spmf\n                             (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                             coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "also"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (False, False) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in map_spmf\n                             (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                             coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "have \"... = do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    let a0 = S0 \\<oplus> S2 \\<oplus> m0;\n    a1 :: bool \\<leftarrow> coin_spmf;\n    let a2 = S1 \\<oplus> S4 \\<oplus> m2;\n    a3 \\<leftarrow> coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 False S0; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 False S2;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 False S4;\n    return_spmf ((False,False), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in map_spmf\n                               (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                               coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))", "using coin_coin'"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S3. ?S0.0 \\<oplus> S3 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in map_spmf\n                               (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                               coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))", "by simp"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in map_spmf\n                             (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                             coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "also"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in map_spmf\n                             (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                             coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "have \"... = do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    let a0 = S0 \\<oplus> S2 \\<oplus> m0;\n    a1 :: bool \\<leftarrow> coin_spmf;\n    a2 :: bool \\<leftarrow> map_spmf (\\<lambda> S1. S1 \\<oplus> S4 \\<oplus> m2) coin_spmf;\n    a3 \\<leftarrow> coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 False S0; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 False S2;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 False S4;\n    return_spmf ((False,False), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 False S0 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                in coin_spmf \\<bind>\n                   (\\<lambda>a1.\n                       map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))", "by(simp add: bind_map_spmf o_def Let_def)"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "also"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 False S0 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "have \"... = do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    let a0 = S0 \\<oplus> S2 \\<oplus> m0;\n    a1 :: bool \\<leftarrow> coin_spmf;\n    a2 :: bool \\<leftarrow> coin_spmf;\n    a3 \\<leftarrow> coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 False S0; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 False S2;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 False S4;\n    return_spmf ((False,False), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                in coin_spmf \\<bind>\n                   (\\<lambda>a1.\n                       map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                in coin_spmf \\<bind>\n                   (\\<lambda>a1.\n                       coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))", "using coin_coin"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> ?S3.0 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                in coin_spmf \\<bind>\n                   (\\<lambda>a1.\n                       map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                in coin_spmf \\<bind>\n                   (\\<lambda>a1.\n                       coin_spmf \\<bind>\n                       (\\<lambda>a2.\n                           coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 False S0 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))", "by simp"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "ultimately"], ["proof (chain)\npicking this:\n  R2_14 (m0, m1, m2, m3) (False, False) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))", "show ?thesis"], ["proof (prove)\nusing this:\n  R2_14 (m0, m1, m2, m3) (False, False) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     map_spmf (\\<lambda>S1. S1 \\<oplus> S4 \\<oplus> m2)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              let a0 = S0 \\<oplus> S2 \\<oplus> m0\n              in coin_spmf \\<bind>\n                 (\\<lambda>a1.\n                     coin_spmf \\<bind>\n                     (\\<lambda>a2.\n                         coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 False S0 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((False, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (False, False) =\n    funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (False, False) out2)", "by(simp add: funct_OT_14_def S2_14_def bind_spmf_const)"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (False, False) =\n  funct_OT_14 (m0, m1, m2, m3) (False, False) \\<bind>\n  (\\<lambda>(out1, out2). S2_14 (False, False) out2)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma P2_OT_14_TF: \"R2_14 (m0,m1,m2,m3) (True,False) = funct_OT_14 (m0,m1,m2,m3) (True,False) \\<bind> (\\<lambda> (out1, out2). S2_14 (True,False) out2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "including monad_normalisation"], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "have \"R2_14 (m0,m1,m2,m3) (True,False) = do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    let a0 = S0 \\<oplus> S2 \\<oplus> m0;\n    a1 :: bool \\<leftarrow> map_spmf (\\<lambda> S3. S0 \\<oplus> S3 \\<oplus> m1) coin_spmf;\n    let a2 = S1 \\<oplus> S4 \\<oplus> m2;\n    a3 \\<leftarrow> map_spmf (\\<lambda> S5. S1 \\<oplus> S5 \\<oplus> m3) coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 True S1; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 False S2;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 False S4;\n    return_spmf ((True,False), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in map_spmf\n                               (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                               coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))", "apply(simp add: R2_14_def inf_th_OT12_P2 OT_12_P2_assm funct_OT_12_def Let_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S1.\n        S2_OT12 True S1 \\<bind>\n        (\\<lambda>a.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                S2_OT12 False S2 \\<bind>\n                (\\<lambda>b.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        S2_OT12 False S4 \\<bind>\n                        (\\<lambda>c.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S0.\n                                coin_spmf \\<bind>\n                                (\\<lambda>S3.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S5.\n  return_spmf\n   ((True, False),\n    (S0 = (S2 = m0), S0 = (S3 = m1), S1 = (S4 = m2), S1 = (S5 = m3)), a, b,\n    c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S2.\n        S2_OT12 False S2 \\<bind>\n        (\\<lambda>b.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                S2_OT12 False S4 \\<bind>\n                (\\<lambda>c.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S1.\n                        S2_OT12 True S1 \\<bind>\n                        (\\<lambda>a.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S0.\n                                map_spmf (\\<lambda>S5. S1 = (S5 = m3))\n                                 coin_spmf \\<bind>\n                                (\\<lambda>a3.\n                                    map_spmf (\\<lambda>S3. S0 = (S3 = m1))\n                                     coin_spmf \\<bind>\n                                    (\\<lambda>a1.\n  return_spmf\n   ((True, False), (S0 = (S2 = m0), a1, S1 = (S4 = m2), a3), a, b,\n    c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>y.\n            S2_OT12 True S1 \\<bind>\n            (\\<lambda>a.\n                S2_OT12 False y \\<bind>\n                (\\<lambda>b.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        S2_OT12 False S4 \\<bind>\n                        (\\<lambda>c.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S0.\n                                coin_spmf \\<bind>\n                                (\\<lambda>S3.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S5.\n  return_spmf\n   ((True, False),\n    (S0 = (y = m0), S0 = (S3 = m1), S1 = (S4 = m2), S1 = (S5 = m3)), a, b,\n    c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S2.\n        S2_OT12 False S2 \\<bind>\n        (\\<lambda>b.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                S2_OT12 False S4 \\<bind>\n                (\\<lambda>c.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S1.\n                        S2_OT12 True S1 \\<bind>\n                        (\\<lambda>a.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S0.\n                                map_spmf (\\<lambda>S5. S1 = (S5 = m3))\n                                 coin_spmf \\<bind>\n                                (\\<lambda>a3.\n                                    map_spmf (\\<lambda>S3. S0 = (S3 = m1))\n                                     coin_spmf \\<bind>\n                                    (\\<lambda>a1.\n  return_spmf\n   ((True, False), (S0 = (S2 = m0), a1, S1 = (S4 = m2), a3), a, b,\n    c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>y.\n            S2_OT12 False y \\<bind>\n            (\\<lambda>ya.\n                S2_OT12 True S1 \\<bind>\n                (\\<lambda>a.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S4.\n                        S2_OT12 False S4 \\<bind>\n                        (\\<lambda>c.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S0.\n                                coin_spmf \\<bind>\n                                (\\<lambda>S3.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S5.\n  return_spmf\n   ((True, False),\n    (S0 = (y = m0), S0 = (S3 = m1), S1 = (S4 = m2), S1 = (S5 = m3)), a, ya,\n    c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S2.\n        S2_OT12 False S2 \\<bind>\n        (\\<lambda>b.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                S2_OT12 False S4 \\<bind>\n                (\\<lambda>c.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S1.\n                        S2_OT12 True S1 \\<bind>\n                        (\\<lambda>a.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S0.\n                                map_spmf (\\<lambda>S5. S1 = (S5 = m3))\n                                 coin_spmf \\<bind>\n                                (\\<lambda>a3.\n                                    map_spmf (\\<lambda>S3. S0 = (S3 = m1))\n                                     coin_spmf \\<bind>\n                                    (\\<lambda>a1.\n  return_spmf\n   ((True, False), (S0 = (S2 = m0), a1, S1 = (S4 = m2), a3), a, b,\n    c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\"  in \"bind_spmf _ \\<hole>\" in \"\\<hole> = _\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>y.\n            S2_OT12 False y \\<bind>\n            (\\<lambda>ya.\n                coin_spmf \\<bind>\n                (\\<lambda>yb.\n                    S2_OT12 True S1 \\<bind>\n                    (\\<lambda>a.\n                        S2_OT12 False yb \\<bind>\n                        (\\<lambda>c.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S0.\n                                coin_spmf \\<bind>\n                                (\\<lambda>S3.\n                                    coin_spmf \\<bind>\n                                    (\\<lambda>S5.\n  return_spmf\n   ((True, False),\n    (S0 = (y = m0), S0 = (S3 = m1), S1 = (yb = m2), S1 = (S5 = m3)), a, ya,\n    c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S2.\n        S2_OT12 False S2 \\<bind>\n        (\\<lambda>b.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                S2_OT12 False S4 \\<bind>\n                (\\<lambda>c.\n                    coin_spmf \\<bind>\n                    (\\<lambda>S1.\n                        S2_OT12 True S1 \\<bind>\n                        (\\<lambda>a.\n                            coin_spmf \\<bind>\n                            (\\<lambda>S0.\n                                map_spmf (\\<lambda>S5. S1 = (S5 = m3))\n                                 coin_spmf \\<bind>\n                                (\\<lambda>a3.\n                                    map_spmf (\\<lambda>S3. S0 = (S3 = m1))\n                                     coin_spmf \\<bind>\n                                    (\\<lambda>a1.\n  return_spmf\n   ((True, False), (S0 = (S2 = m0), a1, S1 = (S4 = m2), a3), a, b,\n    c))))))))))", "by(simp add: bind_map_spmf o_def Let_def)"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (True, False) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in map_spmf\n                             (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                             coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "also"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (True, False) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in map_spmf\n                             (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                             coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "have \"... = do {\n    S0 :: bool \\<leftarrow> coin_spmf;\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    let a0 = S0 \\<oplus> S2 \\<oplus> m0;\n    a1 :: bool \\<leftarrow> coin_spmf;\n    let a2 = S1 \\<oplus> S4 \\<oplus> m2;\n    a3 \\<leftarrow> coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 True S1; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 False S2;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 False S4;\n    return_spmf ((True,False), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in map_spmf\n                               (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                               coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))", "using coin_coin'"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S3. ?S0.0 \\<oplus> S3 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                        coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in map_spmf\n                               (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                               coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))", "by simp"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in map_spmf\n                             (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                             coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "also"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in map_spmf (\\<lambda>S3. S0 \\<oplus> S3 \\<oplus> m1)\n                      coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in map_spmf\n                             (\\<lambda>S5. S1 \\<oplus> S5 \\<oplus> m3)\n                             coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "have \"... = do {\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> map_spmf (\\<lambda> S0. S0 \\<oplus> S2 \\<oplus> m0) coin_spmf;\n    a1 :: bool \\<leftarrow> coin_spmf;\n    let a2 = S1 \\<oplus> S4 \\<oplus> m2;\n    a3 \\<leftarrow> coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 True S1; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 False S2;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 False S4;\n    return_spmf ((True,False), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S0.\n        coin_spmf \\<bind>\n        (\\<lambda>S1.\n            coin_spmf \\<bind>\n            (\\<lambda>S2.\n                coin_spmf \\<bind>\n                (\\<lambda>S4.\n                    let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                    in coin_spmf \\<bind>\n                       (\\<lambda>a1.\n                           let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                           in coin_spmf \\<bind>\n                              (\\<lambda>a3.\n                                  S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\nS2_OT12 False S2 \\<bind>\n(\\<lambda>b.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n                 coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))", "by(simp add: bind_map_spmf o_def Let_def)"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n               coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "also"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S0.\n      coin_spmf \\<bind>\n      (\\<lambda>S1.\n          coin_spmf \\<bind>\n          (\\<lambda>S2.\n              coin_spmf \\<bind>\n              (\\<lambda>S4.\n                  let a0 = S0 \\<oplus> S2 \\<oplus> m0\n                  in coin_spmf \\<bind>\n                     (\\<lambda>a1.\n                         let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                         in coin_spmf \\<bind>\n                            (\\<lambda>a3.\n                                S2_OT12 True S1 \\<bind>\n                                (\\<lambda>a.\n                                    S2_OT12 False S2 \\<bind>\n                                    (\\<lambda>b.\n  S2_OT12 False S4 \\<bind>\n  (\\<lambda>c.\n      return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n               coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "have \"... = do {\n    S1 :: bool \\<leftarrow> coin_spmf;\n    S2 :: bool \\<leftarrow> coin_spmf;\n    S4 :: bool \\<leftarrow> coin_spmf;\n    a0 :: bool \\<leftarrow> coin_spmf;\n    a1 :: bool \\<leftarrow> coin_spmf;\n    let a2 = S1 \\<oplus> S4 \\<oplus> m2;\n    a3 \\<leftarrow> coin_spmf; \n    a :: 'v_OT122 \\<leftarrow> S2_OT12 True S1; \n    b :: 'v_OT122 \\<leftarrow> S2_OT12 False S2;\n    c :: 'v_OT122 \\<leftarrow> S2_OT12 False S4;\n    return_spmf ((True,False), (a0,a1,a2,a3), a,b,c)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n                 coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))", "using coin_coin"], ["proof (prove)\nusing this:\n  map_spmf (\\<lambda>S0. S0 \\<oplus> ?S3.0 \\<oplus> ?m1.0) coin_spmf =\n  coin_spmf\n\ngoal (1 subgoal):\n 1. coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n                 coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n    coin_spmf \\<bind>\n    (\\<lambda>S1.\n        coin_spmf \\<bind>\n        (\\<lambda>S2.\n            coin_spmf \\<bind>\n            (\\<lambda>S4.\n                coin_spmf \\<bind>\n                (\\<lambda>a0.\n                    coin_spmf \\<bind>\n                    (\\<lambda>a1.\n                        let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                        in coin_spmf \\<bind>\n                           (\\<lambda>a3.\n                               S2_OT12 True S1 \\<bind>\n                               (\\<lambda>a.\n                                   S2_OT12 False S2 \\<bind>\n                                   (\\<lambda>b.\n S2_OT12 False S4 \\<bind>\n (\\<lambda>c.\n     return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))", "by simp"], ["proof (state)\nthis:\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n               coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "ultimately"], ["proof (chain)\npicking this:\n  R2_14 (m0, m1, m2, m3) (True, False) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n               coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n               coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))", "show ?thesis"], ["proof (prove)\nusing this:\n  R2_14 (m0, m1, m2, m3) (True, False) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n               coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              map_spmf (\\<lambda>S0. S0 \\<oplus> S2 \\<oplus> m0)\n               coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c)))))))))) =\n  coin_spmf \\<bind>\n  (\\<lambda>S1.\n      coin_spmf \\<bind>\n      (\\<lambda>S2.\n          coin_spmf \\<bind>\n          (\\<lambda>S4.\n              coin_spmf \\<bind>\n              (\\<lambda>a0.\n                  coin_spmf \\<bind>\n                  (\\<lambda>a1.\n                      let a2 = S1 \\<oplus> S4 \\<oplus> m2\n                      in coin_spmf \\<bind>\n                         (\\<lambda>a3.\n                             S2_OT12 True S1 \\<bind>\n                             (\\<lambda>a.\n                                 S2_OT12 False S2 \\<bind>\n                                 (\\<lambda>b.\n                                     S2_OT12 False S4 \\<bind>\n                                     (\\<lambda>c.\n   return_spmf ((True, False), (a0, a1, a2, a3), a, b, c))))))))))\n\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (True, False) =\n    funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (True, False) out2)", "apply(simp add: funct_OT_14_def S2_14_def bind_spmf_const)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R2_14 (m0, m1, m2, m3) (True, False) =\n             coin_spmf \\<bind>\n             (\\<lambda>S2.\n                 S2_OT12 False S2 \\<bind>\n                 (\\<lambda>b.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S4.\n                         S2_OT12 False S4 \\<bind>\n                         (\\<lambda>c.\n                             coin_spmf \\<bind>\n                             (\\<lambda>S1.\n                                 S2_OT12 True S1 \\<bind>\n                                 (\\<lambda>a.\n                                     coin_spmf \\<bind>\n                                     (\\<lambda>a0.\n   coin_spmf \\<bind>\n   (\\<lambda>a1.\n       coin_spmf \\<bind>\n       (\\<lambda>a3.\n           return_spmf\n            ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c))))))))));\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         S2_OT12 False S2 \\<bind>\n         (\\<lambda>b.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 S2_OT12 False S4 \\<bind>\n                 (\\<lambda>c.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S1.\n                         S2_OT12 True S1 \\<bind>\n                         (\\<lambda>a.\n                             coin_spmf \\<bind>\n                             (\\<lambda>a1.\n                                 coin_spmf \\<bind>\n                                 (\\<lambda>a3.\n                                     map_spmf (\\<lambda>S0. S0 = (S2 = m0))\ncoin_spmf \\<bind>\n                                     (\\<lambda>a0.\n   return_spmf\n    ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c)))))))))) =\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         S2_OT12 False S2 \\<bind>\n         (\\<lambda>b.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 S2_OT12 False S4 \\<bind>\n                 (\\<lambda>c.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S1.\n                         S2_OT12 True S1 \\<bind>\n                         (\\<lambda>a.\n                             coin_spmf \\<bind>\n                             (\\<lambda>a0.\n                                 coin_spmf \\<bind>\n                                 (\\<lambda>a1.\n                                     coin_spmf \\<bind>\n                                     (\\<lambda>a3.\n   return_spmf\n    ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c))))))))))\\<rbrakk>\n    \\<Longrightarrow> coin_spmf \\<bind>\n                      (\\<lambda>S2.\n                          S2_OT12 False S2 \\<bind>\n                          (\\<lambda>b.\n                              coin_spmf \\<bind>\n                              (\\<lambda>S4.\n                                  S2_OT12 False S4 \\<bind>\n                                  (\\<lambda>c.\ncoin_spmf \\<bind>\n(\\<lambda>S1.\n    S2_OT12 True S1 \\<bind>\n    (\\<lambda>a.\n        coin_spmf \\<bind>\n        (\\<lambda>a0.\n            coin_spmf \\<bind>\n            (\\<lambda>a1.\n                coin_spmf \\<bind>\n                (\\<lambda>a3.\n                    return_spmf\n                     ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b,\n                      c)))))))))) =\n                      coin_spmf \\<bind>\n                      (\\<lambda>S1.\n                          S2_OT12 True S1 \\<bind>\n                          (\\<lambda>a.\n                              coin_spmf \\<bind>\n                              (\\<lambda>S2.\n                                  S2_OT12 False S2 \\<bind>\n                                  (\\<lambda>b.\ncoin_spmf \\<bind>\n(\\<lambda>S4.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        coin_spmf \\<bind>\n        (\\<lambda>a0.\n            coin_spmf \\<bind>\n            (\\<lambda>a1.\n                coin_spmf \\<bind>\n                (\\<lambda>a3.\n                    return_spmf\n                     ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b,\n                      c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\"  in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R2_14 (m0, m1, m2, m3) (True, False) =\n             coin_spmf \\<bind>\n             (\\<lambda>S2.\n                 S2_OT12 False S2 \\<bind>\n                 (\\<lambda>b.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S4.\n                         S2_OT12 False S4 \\<bind>\n                         (\\<lambda>c.\n                             coin_spmf \\<bind>\n                             (\\<lambda>S1.\n                                 S2_OT12 True S1 \\<bind>\n                                 (\\<lambda>a.\n                                     coin_spmf \\<bind>\n                                     (\\<lambda>a0.\n   coin_spmf \\<bind>\n   (\\<lambda>a1.\n       coin_spmf \\<bind>\n       (\\<lambda>a3.\n           return_spmf\n            ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c))))))))));\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         S2_OT12 False S2 \\<bind>\n         (\\<lambda>b.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 S2_OT12 False S4 \\<bind>\n                 (\\<lambda>c.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S1.\n                         S2_OT12 True S1 \\<bind>\n                         (\\<lambda>a.\n                             coin_spmf \\<bind>\n                             (\\<lambda>a1.\n                                 coin_spmf \\<bind>\n                                 (\\<lambda>a3.\n                                     map_spmf (\\<lambda>S0. S0 = (S2 = m0))\ncoin_spmf \\<bind>\n                                     (\\<lambda>a0.\n   return_spmf\n    ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c)))))))))) =\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         S2_OT12 False S2 \\<bind>\n         (\\<lambda>b.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 S2_OT12 False S4 \\<bind>\n                 (\\<lambda>c.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S1.\n                         S2_OT12 True S1 \\<bind>\n                         (\\<lambda>a.\n                             coin_spmf \\<bind>\n                             (\\<lambda>a0.\n                                 coin_spmf \\<bind>\n                                 (\\<lambda>a1.\n                                     coin_spmf \\<bind>\n                                     (\\<lambda>a3.\n   return_spmf\n    ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c))))))))))\\<rbrakk>\n    \\<Longrightarrow> coin_spmf \\<bind>\n                      (\\<lambda>S2.\n                          S2_OT12 False S2 \\<bind>\n                          (\\<lambda>b.\n                              coin_spmf \\<bind>\n                              (\\<lambda>S4.\n                                  S2_OT12 False S4 \\<bind>\n                                  (\\<lambda>c.\ncoin_spmf \\<bind>\n(\\<lambda>S1.\n    S2_OT12 True S1 \\<bind>\n    (\\<lambda>a.\n        coin_spmf \\<bind>\n        (\\<lambda>a0.\n            coin_spmf \\<bind>\n            (\\<lambda>a1.\n                coin_spmf \\<bind>\n                (\\<lambda>a3.\n                    return_spmf\n                     ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b,\n                      c)))))))))) =\n                      coin_spmf \\<bind>\n                      (\\<lambda>S1.\n                          coin_spmf \\<bind>\n                          (\\<lambda>y.\n                              S2_OT12 True S1 \\<bind>\n                              (\\<lambda>a.\n                                  S2_OT12 False y \\<bind>\n                                  (\\<lambda>b.\ncoin_spmf \\<bind>\n(\\<lambda>S4.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        coin_spmf \\<bind>\n        (\\<lambda>a0.\n            coin_spmf \\<bind>\n            (\\<lambda>a1.\n                coin_spmf \\<bind>\n                (\\<lambda>a3.\n                    return_spmf\n                     ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b,\n                      c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R2_14 (m0, m1, m2, m3) (True, False) =\n             coin_spmf \\<bind>\n             (\\<lambda>S2.\n                 S2_OT12 False S2 \\<bind>\n                 (\\<lambda>b.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S4.\n                         S2_OT12 False S4 \\<bind>\n                         (\\<lambda>c.\n                             coin_spmf \\<bind>\n                             (\\<lambda>S1.\n                                 S2_OT12 True S1 \\<bind>\n                                 (\\<lambda>a.\n                                     coin_spmf \\<bind>\n                                     (\\<lambda>a0.\n   coin_spmf \\<bind>\n   (\\<lambda>a1.\n       coin_spmf \\<bind>\n       (\\<lambda>a3.\n           return_spmf\n            ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c))))))))));\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         S2_OT12 False S2 \\<bind>\n         (\\<lambda>b.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 S2_OT12 False S4 \\<bind>\n                 (\\<lambda>c.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S1.\n                         S2_OT12 True S1 \\<bind>\n                         (\\<lambda>a.\n                             coin_spmf \\<bind>\n                             (\\<lambda>a1.\n                                 coin_spmf \\<bind>\n                                 (\\<lambda>a3.\n                                     map_spmf (\\<lambda>S0. S0 = (S2 = m0))\ncoin_spmf \\<bind>\n                                     (\\<lambda>a0.\n   return_spmf\n    ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c)))))))))) =\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         S2_OT12 False S2 \\<bind>\n         (\\<lambda>b.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 S2_OT12 False S4 \\<bind>\n                 (\\<lambda>c.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S1.\n                         S2_OT12 True S1 \\<bind>\n                         (\\<lambda>a.\n                             coin_spmf \\<bind>\n                             (\\<lambda>a0.\n                                 coin_spmf \\<bind>\n                                 (\\<lambda>a1.\n                                     coin_spmf \\<bind>\n                                     (\\<lambda>a3.\n   return_spmf\n    ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c))))))))))\\<rbrakk>\n    \\<Longrightarrow> coin_spmf \\<bind>\n                      (\\<lambda>S2.\n                          S2_OT12 False S2 \\<bind>\n                          (\\<lambda>b.\n                              coin_spmf \\<bind>\n                              (\\<lambda>S4.\n                                  S2_OT12 False S4 \\<bind>\n                                  (\\<lambda>c.\ncoin_spmf \\<bind>\n(\\<lambda>S1.\n    S2_OT12 True S1 \\<bind>\n    (\\<lambda>a.\n        coin_spmf \\<bind>\n        (\\<lambda>a0.\n            coin_spmf \\<bind>\n            (\\<lambda>a1.\n                coin_spmf \\<bind>\n                (\\<lambda>a3.\n                    return_spmf\n                     ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b,\n                      c)))))))))) =\n                      coin_spmf \\<bind>\n                      (\\<lambda>S1.\n                          coin_spmf \\<bind>\n                          (\\<lambda>y.\n                              S2_OT12 False y \\<bind>\n                              (\\<lambda>y.\n                                  S2_OT12 True S1 \\<bind>\n                                  (\\<lambda>a.\ncoin_spmf \\<bind>\n(\\<lambda>S4.\n    S2_OT12 False S4 \\<bind>\n    (\\<lambda>c.\n        coin_spmf \\<bind>\n        (\\<lambda>a0.\n            coin_spmf \\<bind>\n            (\\<lambda>a1.\n                coin_spmf \\<bind>\n                (\\<lambda>a3.\n                    return_spmf\n                     ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, y,\n                      c))))))))))", "apply(rewrite in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"bind_spmf _ \\<hole>\" in \"_ = \\<hole>\" bind_commute_spmf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>R2_14 (m0, m1, m2, m3) (True, False) =\n             coin_spmf \\<bind>\n             (\\<lambda>S2.\n                 S2_OT12 False S2 \\<bind>\n                 (\\<lambda>b.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S4.\n                         S2_OT12 False S4 \\<bind>\n                         (\\<lambda>c.\n                             coin_spmf \\<bind>\n                             (\\<lambda>S1.\n                                 S2_OT12 True S1 \\<bind>\n                                 (\\<lambda>a.\n                                     coin_spmf \\<bind>\n                                     (\\<lambda>a0.\n   coin_spmf \\<bind>\n   (\\<lambda>a1.\n       coin_spmf \\<bind>\n       (\\<lambda>a3.\n           return_spmf\n            ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c))))))))));\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         S2_OT12 False S2 \\<bind>\n         (\\<lambda>b.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 S2_OT12 False S4 \\<bind>\n                 (\\<lambda>c.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S1.\n                         S2_OT12 True S1 \\<bind>\n                         (\\<lambda>a.\n                             coin_spmf \\<bind>\n                             (\\<lambda>a1.\n                                 coin_spmf \\<bind>\n                                 (\\<lambda>a3.\n                                     map_spmf (\\<lambda>S0. S0 = (S2 = m0))\ncoin_spmf \\<bind>\n                                     (\\<lambda>a0.\n   return_spmf\n    ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c)))))))))) =\n     coin_spmf \\<bind>\n     (\\<lambda>S2.\n         S2_OT12 False S2 \\<bind>\n         (\\<lambda>b.\n             coin_spmf \\<bind>\n             (\\<lambda>S4.\n                 S2_OT12 False S4 \\<bind>\n                 (\\<lambda>c.\n                     coin_spmf \\<bind>\n                     (\\<lambda>S1.\n                         S2_OT12 True S1 \\<bind>\n                         (\\<lambda>a.\n                             coin_spmf \\<bind>\n                             (\\<lambda>a0.\n                                 coin_spmf \\<bind>\n                                 (\\<lambda>a1.\n                                     coin_spmf \\<bind>\n                                     (\\<lambda>a3.\n   return_spmf\n    ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b, c))))))))))\\<rbrakk>\n    \\<Longrightarrow> coin_spmf \\<bind>\n                      (\\<lambda>S2.\n                          S2_OT12 False S2 \\<bind>\n                          (\\<lambda>b.\n                              coin_spmf \\<bind>\n                              (\\<lambda>S4.\n                                  S2_OT12 False S4 \\<bind>\n                                  (\\<lambda>c.\ncoin_spmf \\<bind>\n(\\<lambda>S1.\n    S2_OT12 True S1 \\<bind>\n    (\\<lambda>a.\n        coin_spmf \\<bind>\n        (\\<lambda>a0.\n            coin_spmf \\<bind>\n            (\\<lambda>a1.\n                coin_spmf \\<bind>\n                (\\<lambda>a3.\n                    return_spmf\n                     ((True, False), (a0, a1, S1 = (S4 = m2), a3), a, b,\n                      c)))))))))) =\n                      coin_spmf \\<bind>\n                      (\\<lambda>S1.\n                          coin_spmf \\<bind>\n                          (\\<lambda>y.\n                              S2_OT12 False y \\<bind>\n                              (\\<lambda>y.\n                                  coin_spmf \\<bind>\n                                  (\\<lambda>ya.\nS2_OT12 True S1 \\<bind>\n(\\<lambda>a.\n    S2_OT12 False ya \\<bind>\n    (\\<lambda>c.\n        coin_spmf \\<bind>\n        (\\<lambda>a0.\n            coin_spmf \\<bind>\n            (\\<lambda>a1.\n                coin_spmf \\<bind>\n                (\\<lambda>a3.\n                    return_spmf\n                     ((True, False), (a0, a1, S1 = (ya = m2), a3), a, y,\n                      c))))))))))", "by simp"], ["proof (state)\nthis:\n  R2_14 (m0, m1, m2, m3) (True, False) =\n  funct_OT_14 (m0, m1, m2, m3) (True, False) \\<bind>\n  (\\<lambda>(out1, out2). S2_14 (True, False) out2)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma P2_sec_OT_14_split: \"R2_14 (m0,m1,m2,m3) (c0,c1) = funct_OT_14 (m0,m1,m2,m3) (c0,c1) \\<bind> (\\<lambda> (out1, out2). S2_14 (c0,c1) out2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 (m0, m1, m2, m3) (c0, c1) =\n    funct_OT_14 (m0, m1, m2, m3) (c0, c1) \\<bind>\n    (\\<lambda>(out1, out2). S2_14 (c0, c1) out2)", "by(cases c0; cases c1; auto simp add: P2_OT_14_FF P2_OT_14_TF P2_OT_14_FT P2_OT_14_TT)"], ["", "lemma P2_sec_OT_14: \"R2_14 M C = funct_OT_14 M C \\<bind> (\\<lambda> (out1, out2). S2_14 C out2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 M C =\n    funct_OT_14 M C \\<bind> (\\<lambda>(out1, out2). S2_14 C out2)", "by(metis P2_sec_OT_14_split surj_pair)"], ["", "sublocale OT_14: sim_det_def R1_14 S1_14 R2_14 S2_14 funct_OT_14 protocol_14_OT"], ["proof (prove)\ngoal (1 subgoal):\n 1. sim_det_def R1_14 S1_14 R2_14 S2_14 funct_OT_14", "unfolding sim_det_def_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<forall>m1 m2. lossless_spmf (R1_14 m1 m2)) \\<and>\n     (\\<forall>m1 out1. lossless_spmf (S1_14 m1 out1))) \\<and>\n    (\\<forall>m1 m2. lossless_spmf (R2_14 m1 m2)) \\<and>\n    (\\<forall>m2 out2. lossless_spmf (S2_14 m2 out2)) \\<and>\n    (\\<forall>m1 m2. lossless_spmf (funct_OT_14 m1 m2))", "by(simp add: lossless_R1_14 lossless_S1_14 lossless_funct_14_OT lossless_R2_14 lossless_S2_14 )"], ["", "lemma correctness_OT_14: \n  shows \"funct_OT_14 M C = protocol_14_OT M C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. funct_OT_14 M C = protocol_14_OT M C", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. funct_OT_14 M C = protocol_14_OT M C", "have \"S1 = (S5 = (S1 = (S5 = d))) = d\" for S1 S5 d"], ["proof (prove)\ngoal (1 subgoal):\n 1. (S1 = (S5 = (S1 = (S5 = d)))) = d", "by auto"], ["proof (state)\nthis:\n  (?S1.0 = (?S5.0 = (?S1.0 = (?S5.0 = ?d)))) = ?d\n\ngoal (1 subgoal):\n 1. funct_OT_14 M C = protocol_14_OT M C", "thus ?thesis"], ["proof (prove)\nusing this:\n  (?S1.0 = (?S5.0 = (?S1.0 = (?S5.0 = ?d)))) = ?d\n\ngoal (1 subgoal):\n 1. funct_OT_14 M C = protocol_14_OT M C", "by(cases \"fst C\"; cases \"snd C\"; simp add: funct_OT_14_def protocol_14_OT_def correct funct_OT_12_def lossless_funct_OT_12 bind_spmf_const split_def)"], ["proof (state)\nthis:\n  funct_OT_14 M C = protocol_14_OT M C\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma OT_14_correct: \"OT_14.correctness M C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. OT_14.correctness M C", "unfolding OT_14.correctness_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. protocol_14_OT M C = funct_OT_14 M C", "using correctness_OT_14"], ["proof (prove)\nusing this:\n  funct_OT_14 ?M ?C = protocol_14_OT ?M ?C\n\ngoal (1 subgoal):\n 1. protocol_14_OT M C = funct_OT_14 M C", "by auto"], ["", "lemma OT_14_P2_sec: \"OT_14.perfect_sec_P2 m1 m2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. OT_14.perfect_sec_P2 m1 m2", "unfolding OT_14.perfect_sec_P2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. R2_14 m1 m2 = funct_OT_14 m1 m2 \\<bind> (\\<lambda>(s1, s2). S2_14 m2 s2)", "using P2_sec_OT_14"], ["proof (prove)\nusing this:\n  R2_14 ?M ?C =\n  funct_OT_14 ?M ?C \\<bind> (\\<lambda>(out1, out2). S2_14 ?C out2)\n\ngoal (1 subgoal):\n 1. R2_14 m1 m2 = funct_OT_14 m1 m2 \\<bind> (\\<lambda>(s1, s2). S2_14 m2 s2)", "by blast"], ["", "lemma OT_14_P1_sec: \"OT_14.adv_P1 m1 m2 D \\<le> 3 * adv_OT12\""], ["proof (prove)\ngoal (1 subgoal):\n 1. OT_14.adv_P1 m1 m2 D \\<le> 3 * adv_OT12", "unfolding OT_14.adv_P1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 m1 m2 \\<bind> D) True -\n          spmf\n           (funct_OT_14 m1 m2 \\<bind>\n            (\\<lambda>(o1, o2). S1_14 m1 o1 \\<bind> D))\n           True\\<bar>\n    \\<le> 3 * adv_OT12", "by (metis reduction_P1 surj_pair)"], ["", "end"], ["", "locale OT_14_asymp = sim_det_def +\n  fixes S1_OT12 :: \"nat \\<Rightarrow> (bool \\<times> bool) \\<Rightarrow> unit \\<Rightarrow> 'v_OT121 spmf\"\n    and R1_OT12 :: \"nat \\<Rightarrow> (bool \\<times> bool) \\<Rightarrow> bool \\<Rightarrow> 'v_OT121 spmf\" \n    and adv_OT12 :: \"nat \\<Rightarrow> real\"\n    and S2_OT12 :: \"nat \\<Rightarrow> bool \\<Rightarrow> bool \\<Rightarrow> 'v_OT122 spmf\" \n    and R2_OT12 :: \"nat \\<Rightarrow> (bool \\<times> bool) \\<Rightarrow> bool \\<Rightarrow> 'v_OT122 spmf\"\n    and protocol_OT12 :: \"(bool \\<times> bool) \\<Rightarrow> bool \\<Rightarrow> (unit \\<times> bool) spmf\"\n  assumes ot14_base: \"\\<And> (n::nat). ot14_base (S1_OT12 n) (R1_12_0T n) (adv_OT12 n) (S2_OT12 n) (R2_12OT n) (protocol_OT12)\"\nbegin"], ["", "sublocale ot14_base \"(S1_OT12 n)\" \"(R1_12_0T n)\" \"(adv_OT12 n)\" \"(S2_OT12 n)\" \"(R2_12OT n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ot14_base (S1_OT12 n) (R1_12_0T n) (adv_OT12 n) (S2_OT12 n) (R2_12OT n)\n     protocol_OT12", "using local.ot14_base"], ["proof (prove)\nusing this:\n  ot14_base (S1_OT12 ?n) (?R1_12_0T ?n) (adv_OT12 ?n) (S2_OT12 ?n)\n   (?R2_12OT ?n) protocol_OT12\n\ngoal (1 subgoal):\n 1. ot14_base (S1_OT12 n) (R1_12_0T n) (adv_OT12 n) (S2_OT12 n) (R2_12OT n)\n     protocol_OT12", "by simp"], ["", "lemma OT_14_P1_sec: \"OT_14.adv_P1 (R1_12_0T n) n m1 m2 D \\<le> 3 * (adv_OT12 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D \\<le> 3 * adv_OT12 n", "unfolding OT_14.adv_P1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 (R1_12_0T n) n m1 m2 \\<bind> D) True -\n          spmf\n           (funct_OT_14 m1 m2 \\<bind>\n            (\\<lambda>(o1, o2). S1_14 n m1 o1 \\<bind> D))\n           True\\<bar>\n    \\<le> 3 * adv_OT12 n", "using reduction_P1 surj_pair"], ["proof (prove)\nusing this:\n  \\<bar>spmf (R1_14 ?R1_12_0T ?n ?M (?c0.0, ?c1.0) \\<bind> ?D) True -\n        spmf\n         (funct_OT_14 ?M (?c0.0, ?c1.0) \\<bind>\n          (\\<lambda>(out1, out2). S1_14 ?n ?M out1 \\<bind> ?D))\n         True\\<bar>\n  \\<le> 3 * adv_OT12 ?n\n  \\<exists>x y. ?p = (x, y)\n\ngoal (1 subgoal):\n 1. \\<bar>spmf (R1_14 (R1_12_0T n) n m1 m2 \\<bind> D) True -\n          spmf\n           (funct_OT_14 m1 m2 \\<bind>\n            (\\<lambda>(o1, o2). S1_14 n m1 o1 \\<bind> D))\n           True\\<bar>\n    \\<le> 3 * adv_OT12 n", "by metis"], ["", "theorem OT_14_P1_asym_sec: \"negligible (\\<lambda> n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)\" if \"negligible (\\<lambda> n. adv_OT12 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Negligible.negligible (\\<lambda>n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. Negligible.negligible (\\<lambda>n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)", "have adv_neg: \"negligible (\\<lambda>n. 3 * adv_OT12 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Negligible.negligible (\\<lambda>n. 3 * adv_OT12 n)", "using that negligible_cmultI"], ["proof (prove)\nusing this:\n  Negligible.negligible adv_OT12\n  (?c \\<noteq> 0 \\<Longrightarrow>\n   Negligible.negligible ?f) \\<Longrightarrow>\n  Negligible.negligible (\\<lambda>\\<eta>. ?c * ?f \\<eta>)\n\ngoal (1 subgoal):\n 1. Negligible.negligible (\\<lambda>n. 3 * adv_OT12 n)", "by simp"], ["proof (state)\nthis:\n  Negligible.negligible (\\<lambda>n. 3 * adv_OT12 n)\n\ngoal (1 subgoal):\n 1. Negligible.negligible (\\<lambda>n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)", "have \"\\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar> \\<le> \\<bar>3 * (adv_OT12 n)\\<bar>\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar>\n    \\<le> \\<bar>3 * adv_OT12 n\\<bar>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar>\n    \\<le> \\<bar>3 * adv_OT12 n\\<bar>", "have \"\\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar> \\<le> 3 * adv_OT12 n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar> \\<le> 3 * adv_OT12 n", "using OT_14.adv_P1_def OT_14_P1_sec"], ["proof (prove)\nusing this:\n  OT_14.adv_P1 ?R1_12_0T ?n ?m1.0 ?m2.0 ?D \\<equiv>\n  \\<bar>spmf (R1_14 ?R1_12_0T ?n ?m1.0 ?m2.0 \\<bind> ?D) True -\n        spmf\n         (funct_OT_14 ?m1.0 ?m2.0 \\<bind>\n          (\\<lambda>(o1, o2). S1_14 ?n ?m1.0 o1 \\<bind> ?D))\n         True\\<bar>\n  OT_14.adv_P1 (?R1_12_0T ?n) ?n ?m1.0 ?m2.0 ?D \\<le> 3 * adv_OT12 ?n\n\ngoal (1 subgoal):\n 1. \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar> \\<le> 3 * adv_OT12 n", "by auto"], ["proof (state)\nthis:\n  \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar> \\<le> 3 * adv_OT12 n\n\ngoal (1 subgoal):\n 1. \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar>\n    \\<le> \\<bar>3 * adv_OT12 n\\<bar>", "then"], ["proof (chain)\npicking this:\n  \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar> \\<le> 3 * adv_OT12 n", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar> \\<le> 3 * adv_OT12 n\n\ngoal (1 subgoal):\n 1. \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar>\n    \\<le> \\<bar>3 * adv_OT12 n\\<bar>", "by (meson abs_ge_self order_trans)"], ["proof (state)\nthis:\n  \\<bar>OT_14.adv_P1 (R1_12_0T n) n m1 m2 D\\<bar>\n  \\<le> \\<bar>3 * adv_OT12 n\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>OT_14.adv_P1 (R1_12_0T ?n) ?n m1 m2 D\\<bar>\n  \\<le> \\<bar>3 * adv_OT12 ?n\\<bar>\n\ngoal (1 subgoal):\n 1. Negligible.negligible (\\<lambda>n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>OT_14.adv_P1 (R1_12_0T ?n) ?n m1 m2 D\\<bar>\n  \\<le> \\<bar>3 * adv_OT12 ?n\\<bar>\n\ngoal (1 subgoal):\n 1. Negligible.negligible (\\<lambda>n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)", "using OT_14_P1_sec negligible_le adv_neg"], ["proof (prove)\nusing this:\n  \\<bar>OT_14.adv_P1 (R1_12_0T ?n) ?n m1 m2 D\\<bar>\n  \\<le> \\<bar>3 * adv_OT12 ?n\\<bar>\n  OT_14.adv_P1 (?R1_12_0T ?n) ?n ?m1.0 ?m2.0 ?D \\<le> 3 * adv_OT12 ?n\n  \\<lbrakk>Negligible.negligible ?g;\n   \\<And>\\<eta>. \\<bar>?f \\<eta>\\<bar> \\<le> ?g \\<eta>\\<rbrakk>\n  \\<Longrightarrow> Negligible.negligible ?f\n  Negligible.negligible (\\<lambda>n. 3 * adv_OT12 n)\n\ngoal (1 subgoal):\n 1. Negligible.negligible (\\<lambda>n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)", "by (metis (no_types, lifting) negligible_absI)"], ["proof (state)\nthis:\n  Negligible.negligible (\\<lambda>n. OT_14.adv_P1 (R1_12_0T n) n m1 m2 D)\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem OT_14_P2_asym_sec: \"OT_14.perfect_sec_P2 R2_OT12 n m1 m2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. OT_14.perfect_sec_P2 R2_OT12 n m1 m2", "using OT_14_P2_sec"], ["proof (prove)\nusing this:\n  OT_14.perfect_sec_P2 ?R2_12OT ?n ?m1.0 ?m2.0\n\ngoal (1 subgoal):\n 1. OT_14.perfect_sec_P2 R2_OT12 n m1 m2", "by simp"], ["", "end"], ["", "end"]]}