{"file_name": "/home/qj213/afp-2021-10-22/thys/Dirichlet_Series/Partial_Summation.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Dirichlet_Series", "problem_names": ["lemma finite_vimage_real_of_nat_greaterThanAtMost: \"finite (real -` {y<..x})\"", "lemma partial_summation_strong:\n  \"((\\<lambda>t. A t * f' t) has_integral \n       (A x * f x - A y * f y - (\\<Sum>n \\<in> real -` {y<..x}. a n * f n))) {y..x}\"", "lemma partial_summation_integrable_strong: \n        \"(\\<lambda>t. A t * f' t) integrable_on {y..x}\"\n  and partial_summation_strong': \n        \"(\\<Sum>n\\<in>real -` {y<..x}. a n * f n) = \n            A x * f x - A y * f y - integral {y..x} (\\<lambda>t. A t * f' t)\"", "lemma partial_summation_sum_upto_strong:\n  \"((\\<lambda>t. A t * f' t) has_integral (A x * f x - sum_upto (\\<lambda>n. a n * f n) x)) {0..x}\"", "lemma partial_summation_integrable_sum_upto_strong: \n        \"(\\<lambda>t. A t * f' t) integrable_on {0..x}\"\n  and partial_summation_sum_upto_strong': \n        \"sum_upto (\\<lambda>n. a n * f n) x = \n            A x * f x - integral {0..x} (\\<lambda>t. A t * f' t)\""], "translations": [["", "lemma finite_vimage_real_of_nat_greaterThanAtMost: \"finite (real -` {y<..x})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (real -` {y<..x})", "proof (rule finite_subset)"], ["proof (state)\ngoal (2 subgoals):\n 1. real -` {y<..x} \\<subseteq> ?B\n 2. finite ?B", "show \"real -` {y<..x} \\<subseteq> {nat \\<lfloor>y\\<rfloor>..nat \\<lceil>x\\<rceil>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real -` {y<..x}\n    \\<subseteq> {nat \\<lfloor>y\\<rfloor>..nat \\<lceil>x\\<rceil>}", "by (cases \"x \\<ge> 0\"; cases \"y \\<ge> 0\")\n        (auto simp: nat_le_iff le_nat_iff le_ceiling_iff floor_le_iff)"], ["proof (state)\nthis:\n  real -` {y<..x}\n  \\<subseteq> {nat \\<lfloor>y\\<rfloor>..nat \\<lceil>x\\<rceil>}\n\ngoal (1 subgoal):\n 1. finite {nat \\<lfloor>y\\<rfloor>..nat \\<lceil>x\\<rceil>}", "qed auto"], ["", "context\n  fixes a :: \"nat \\<Rightarrow> 'a :: {banach, real_normed_algebra}\"\n  fixes f f' :: \"real \\<Rightarrow> 'a\"\n  fixes A\n  fixes X :: \"real set\"\n  fixes x y :: real\n  defines \"A \\<equiv> sum_upto a\"\n  assumes fin: \"finite X\"\n  assumes xy: \"0 \\<le> y\" \"y < x\"\n  assumes deriv: \"\\<And>z. z \\<in> {y..x} - X \\<Longrightarrow> (f has_vector_derivative f' z) (at z)\"\n  assumes cont_f: \"continuous_on {y..x} f\"\nbegin"], ["", "lemma partial_summation_strong:\n  \"((\\<lambda>t. A t * f' t) has_integral \n       (A x * f x - A y * f y - (\\<Sum>n \\<in> real -` {y<..x}. a n * f n))) {y..x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "define chi :: \"nat \\<Rightarrow> real \\<Rightarrow> real\" where \"chi = (\\<lambda>n t. if n \\<le> t then 1 else 0)\""], ["proof (state)\nthis:\n  chi = (\\<lambda>n t. if real n \\<le> t then 1 else 0)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "have \"((\\<lambda>t. sum_upto (\\<lambda>n. a n * (chi n t *\\<^sub>R f' t)) x) has_integral \n          (sum_upto (\\<lambda>n. a n * (f x - f (max n y))) x)) {y..x}\" (is \"(_ has_integral ?I) _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         sum_upto (\\<lambda>n. a n * chi n t *\\<^sub>R f' t) x) has_integral\n     sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n     {y..x}", "unfolding sum_upto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         \\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n           a n * chi n t *\\<^sub>R f' t) has_integral\n     (\\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n        a n * (f x - f (max (real n) y))))\n     {y..x}", "proof (intro has_integral_sum ballI finite_Nats_le_real, goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n        a n * (f x - f (max (real n) y)))\n        {y..x}", "case (1 n)"], ["proof (state)\nthis:\n  n \\<in> {i. 0 < i \\<and> real i \\<le> x}\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n        a n * (f x - f (max (real n) y)))\n        {y..x}", "have \"(f' has_integral (f x - f (max n y))) {max n y..x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f' has_integral f x - f (max (real n) y)) {max (real n) y..x}", "using xy 1"], ["proof (prove)\nusing this:\n  0 \\<le> y\n  y < x\n  n \\<in> {i. 0 < i \\<and> real i \\<le> x}\n\ngoal (1 subgoal):\n 1. (f' has_integral f x - f (max (real n) y)) {max (real n) y..x}", "by (intro fundamental_theorem_of_calculus_strong[OF fin])\n         (auto intro!: continuous_on_subset[OF cont_f] deriv)"], ["proof (state)\nthis:\n  (f' has_integral f x - f (max (real n) y)) {max (real n) y..x}\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n        a n * (f x - f (max (real n) y)))\n        {y..x}", "also"], ["proof (state)\nthis:\n  (f' has_integral f x - f (max (real n) y)) {max (real n) y..x}\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n        a n * (f x - f (max (real n) y)))\n        {y..x}", "have \"?this \\<longleftrightarrow> ((\\<lambda>t. (if t \\<in> {max n y..x} then 1 else 0) *\\<^sub>R f' t) \n                  has_integral (f x - f (max n y))) {max n y..x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f' has_integral f x - f (max (real n) y)) {max (real n) y..x} =\n    ((\\<lambda>t.\n         (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n         f' t) has_integral\n     f x - f (max (real n) y))\n     {max (real n) y..x}", "by (intro has_integral_cong) (simp_all add: chi_def)"], ["proof (state)\nthis:\n  (f' has_integral f x - f (max (real n) y)) {max (real n) y..x} =\n  ((\\<lambda>t.\n       (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n       f' t) has_integral\n   f x - f (max (real n) y))\n   {max (real n) y..x}\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n        a n * (f x - f (max (real n) y)))\n        {y..x}", "finally"], ["proof (chain)\npicking this:\n  ((\\<lambda>t.\n       (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n       f' t) has_integral\n   f x - f (max (real n) y))\n   {max (real n) y..x}", "have \"((\\<lambda>t. (if t \\<in> {max n y..x} then 1 else 0) *\\<^sub>R f' t) \n                     has_integral (f x - f (max n y))) {y..x}\""], ["proof (prove)\nusing this:\n  ((\\<lambda>t.\n       (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n       f' t) has_integral\n   f x - f (max (real n) y))\n   {max (real n) y..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n         f' t) has_integral\n     f x - f (max (real n) y))\n     {y..x}", "by (rule has_integral_on_superset) auto"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n       f' t) has_integral\n   f x - f (max (real n) y))\n   {y..x}\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n        a n * (f x - f (max (real n) y)))\n        {y..x}", "also"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n       f' t) has_integral\n   f x - f (max (real n) y))\n   {y..x}\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n        a n * (f x - f (max (real n) y)))\n        {y..x}", "have \"?this \\<longleftrightarrow> ((\\<lambda>t. chi n t *\\<^sub>R f' t) has_integral (f x - f (max n y))) {y..x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n         f' t) has_integral\n     f x - f (max (real n) y))\n     {y..x} =\n    ((\\<lambda>t. chi n t *\\<^sub>R f' t) has_integral\n     f x - f (max (real n) y))\n     {y..x}", "by (intro has_integral_cong) (auto simp: chi_def)"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       (if t \\<in> {max (real n) y..x} then 1 else 0) *\\<^sub>R\n       f' t) has_integral\n   f x - f (max (real n) y))\n   {y..x} =\n  ((\\<lambda>t. chi n t *\\<^sub>R f' t) has_integral\n   f x - f (max (real n) y))\n   {y..x}\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n        a n * (f x - f (max (real n) y)))\n        {y..x}", "finally"], ["proof (chain)\npicking this:\n  ((\\<lambda>t. chi n t *\\<^sub>R f' t) has_integral\n   f x - f (max (real n) y))\n   {y..x}", "show ?case"], ["proof (prove)\nusing this:\n  ((\\<lambda>t. chi n t *\\<^sub>R f' t) has_integral\n   f x - f (max (real n) y))\n   {y..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n     a n * (f x - f (max (real n) y)))\n     {y..x}", "by (intro has_integral_mult_right)"], ["proof (state)\nthis:\n  ((\\<lambda>x. a n * chi n x *\\<^sub>R f' x) has_integral\n   a n * (f x - f (max (real n) y)))\n   {y..x}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       sum_upto (\\<lambda>n. a n * chi n t *\\<^sub>R f' t) x) has_integral\n   sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n   {y..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "also"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       sum_upto (\\<lambda>n. a n * chi n t *\\<^sub>R f' t) x) has_integral\n   sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n   {y..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "have \"?this \\<longleftrightarrow> ((\\<lambda>t. A t * f' t) has_integral ?I) {y..x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         sum_upto (\\<lambda>n. a n * chi n t *\\<^sub>R f' t) x) has_integral\n     sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n     {y..x} =\n    ((\\<lambda>t. A t * f' t) has_integral\n     sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n     {y..x}", "unfolding sum_upto_def A_def chi_def sum_distrib_right"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         \\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n           a n *\n           (if real n \\<le> t then 1 else 0) *\\<^sub>R f' t) has_integral\n     (\\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n        a n * (f x - f (max (real n) y))))\n     {y..x} =\n    ((\\<lambda>t.\n         \\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> t}.\n           a n * f' t) has_integral\n     (\\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n        a n * (f x - f (max (real n) y))))\n     {y..x}", "using xy"], ["proof (prove)\nusing this:\n  0 \\<le> y\n  y < x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         \\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n           a n *\n           (if real n \\<le> t then 1 else 0) *\\<^sub>R f' t) has_integral\n     (\\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n        a n * (f x - f (max (real n) y))))\n     {y..x} =\n    ((\\<lambda>t.\n         \\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> t}.\n           a n * f' t) has_integral\n     (\\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n        a n * (f x - f (max (real n) y))))\n     {y..x}", "by (intro has_integral_cong sum.mono_neutral_cong_right finite_Nats_le_real) auto"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       sum_upto (\\<lambda>n. a n * chi n t *\\<^sub>R f' t) x) has_integral\n   sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n   {y..x} =\n  ((\\<lambda>t. A t * f' t) has_integral\n   sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n   {y..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "also"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       sum_upto (\\<lambda>n. a n * chi n t *\\<^sub>R f' t) x) has_integral\n   sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n   {y..x} =\n  ((\\<lambda>t. A t * f' t) has_integral\n   sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x)\n   {y..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "have \"sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x =\n               A x * f x - (\\<Sum>n | n > 0 \\<and> real n \\<le> x.  a n * f (max (real n) y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x =\n    A x * f x -\n    (\\<Sum>n | 0 < n \\<and> real n \\<le> x. a n * f (max (real n) y))", "by (simp add: sum_upto_def ring_distribs sum_subtractf sum_distrib_right A_def)"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x =\n  A x * f x -\n  (\\<Sum>n | 0 < n \\<and> real n \\<le> x. a n * f (max (real n) y))\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "also"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>n. a n * (f x - f (max (real n) y))) x =\n  A x * f x -\n  (\\<Sum>n | 0 < n \\<and> real n \\<le> x. a n * f (max (real n) y))\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "have \"{n. n > 0 \\<and> real n \\<le> x} = {n. n > 0 \\<and> real n \\<le> y} \\<union> real -` {y<..x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. 0 < n \\<and> real n \\<le> x} =\n    {n. 0 < n \\<and> real n \\<le> y} \\<union> real -` {y<..x}", "using xy"], ["proof (prove)\nusing this:\n  0 \\<le> y\n  y < x\n\ngoal (1 subgoal):\n 1. {n. 0 < n \\<and> real n \\<le> x} =\n    {n. 0 < n \\<and> real n \\<le> y} \\<union> real -` {y<..x}", "by auto"], ["proof (state)\nthis:\n  {n. 0 < n \\<and> real n \\<le> x} =\n  {n. 0 < n \\<and> real n \\<le> y} \\<union> real -` {y<..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "also"], ["proof (state)\nthis:\n  {n. 0 < n \\<and> real n \\<le> x} =\n  {n. 0 < n \\<and> real n \\<le> y} \\<union> real -` {y<..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "have \"sum (\\<lambda>n. a n * f (max (real n) y)) \\<dots> = \n               (\\<Sum>n | 0 < n \\<and> real n \\<le> y. a n * f (max (real n) y)) +\n               (\\<Sum>n \\<in> real -` {y<..x}. a n * f (max (real n) y))\" (is \"_ = ?S1 + ?S2\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n\\<in>{n. 0 < n \\<and> real n \\<le> y} \\<union> real -` {y<..x}.\n       a n * f (max (real n) y)) =\n    (\\<Sum>n | 0 < n \\<and> real n \\<le> y. a n * f (max (real n) y)) +\n    (\\<Sum>n\\<in>real -` {y<..x}. a n * f (max (real n) y))", "by (intro sum.union_disjoint finite_Nats_le_real finite_vimage_real_of_nat_greaterThanAtMost) \n       auto"], ["proof (state)\nthis:\n  (\\<Sum>n\\<in>{n. 0 < n \\<and> real n \\<le> y} \\<union> real -` {y<..x}.\n     a n * f (max (real n) y)) =\n  (\\<Sum>n | 0 < n \\<and> real n \\<le> y. a n * f (max (real n) y)) +\n  (\\<Sum>n\\<in>real -` {y<..x}. a n * f (max (real n) y))\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "also"], ["proof (state)\nthis:\n  (\\<Sum>n\\<in>{n. 0 < n \\<and> real n \\<le> y} \\<union> real -` {y<..x}.\n     a n * f (max (real n) y)) =\n  (\\<Sum>n | 0 < n \\<and> real n \\<le> y. a n * f (max (real n) y)) +\n  (\\<Sum>n\\<in>real -` {y<..x}. a n * f (max (real n) y))\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "have \"?S1 = sum_upto (\\<lambda>n. a n * f y) y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n | 0 < n \\<and> real n \\<le> y. a n * f (max (real n) y)) =\n    sum_upto (\\<lambda>n. a n * f y) y", "unfolding sum_upto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n | 0 < n \\<and> real n \\<le> y. a n * f (max (real n) y)) =\n    (\\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> y}. a n * f y)", "by (intro sum.cong refl) (auto simp: max_def)"], ["proof (state)\nthis:\n  (\\<Sum>n | 0 < n \\<and> real n \\<le> y. a n * f (max (real n) y)) =\n  sum_upto (\\<lambda>n. a n * f y) y\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "also"], ["proof (state)\nthis:\n  (\\<Sum>n | 0 < n \\<and> real n \\<le> y. a n * f (max (real n) y)) =\n  sum_upto (\\<lambda>n. a n * f y) y\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "have \"\\<dots> = A y * f y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>n. a n * f y) y = A y * f y", "by (simp add: A_def sum_upto_def sum_distrib_right)"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>n. a n * f y) y = A y * f y\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "also"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>n. a n * f y) y = A y * f y\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "have \"?S2 = (\\<Sum>n \\<in> real -` {y<..x}. a n * f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n\\<in>real -` {y<..x}. a n * f (max (real n) y)) =\n    (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n))", "by (intro sum.cong refl) (auto simp: max_def)"], ["proof (state)\nthis:\n  (\\<Sum>n\\<in>real -` {y<..x}. a n * f (max (real n) y)) =\n  (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n))\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "finally"], ["proof (chain)\npicking this:\n  ((\\<lambda>t. A t * f' t) has_integral\n   A x * f x -\n   (A y * f y + (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n))))\n   {y..x}", "show ?thesis"], ["proof (prove)\nusing this:\n  ((\\<lambda>t. A t * f' t) has_integral\n   A x * f x -\n   (A y * f y + (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n))))\n   {y..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - A y * f y -\n     (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n     {y..x}", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  ((\\<lambda>t. A t * f' t) has_integral\n   A x * f x - A y * f y - (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n   {y..x}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma partial_summation_integrable_strong: \n        \"(\\<lambda>t. A t * f' t) integrable_on {y..x}\"\n  and partial_summation_strong': \n        \"(\\<Sum>n\\<in>real -` {y<..x}. a n * f n) = \n            A x * f x - A y * f y - integral {y..x} (\\<lambda>t. A t * f' t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t. A t * f' t) integrable_on {y..x} &&&\n    (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)) =\n    A x * f x - A y * f y - integral {y..x} (\\<lambda>t. A t * f' t)", "using partial_summation_strong"], ["proof (prove)\nusing this:\n  ((\\<lambda>t. A t * f' t) has_integral\n   A x * f x - A y * f y - (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)))\n   {y..x}\n\ngoal (1 subgoal):\n 1. (\\<lambda>t. A t * f' t) integrable_on {y..x} &&&\n    (\\<Sum>n\\<in>real -` {y<..x}. a n * f (real n)) =\n    A x * f x - A y * f y - integral {y..x} (\\<lambda>t. A t * f' t)", "by (simp_all add: has_integral_iff algebra_simps)"], ["", "end"], ["", "context\n  fixes a :: \"nat \\<Rightarrow> 'a :: {banach, real_normed_algebra}\"\n  fixes f f' :: \"real \\<Rightarrow> 'a\"\n  fixes A\n  fixes X :: \"real set\"\n  fixes x :: real\n  defines \"A \\<equiv> sum_upto a\"\n  assumes fin: \"finite X\"\n  assumes x: \"x > 0\"\n  assumes deriv: \"\\<And>z. z \\<in> {0..x} - X \\<Longrightarrow> (f has_vector_derivative f' z) (at z)\"\n  assumes cont_f: \"continuous_on {0..x} f\"\nbegin"], ["", "lemma partial_summation_sum_upto_strong:\n  \"((\\<lambda>t. A t * f' t) has_integral (A x * f x - sum_upto (\\<lambda>n. a n * f n) x)) {0..x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - sum_upto (\\<lambda>n. a n * f (real n)) x)\n     {0..x}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - sum_upto (\\<lambda>n. a n * f (real n)) x)\n     {0..x}", "have \"(\\<Sum>n\\<in>real -` {0<..x}. a n * f n) = sum_upto (\\<lambda>n. a n * f n) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n\\<in>real -` {0<..x}. a n * f (real n)) =\n    sum_upto (\\<lambda>n. a n * f (real n)) x", "unfolding sum_upto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n\\<in>real -` {0<..x}. a n * f (real n)) =\n    (\\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}. a n * f (real n))", "by (intro sum.cong refl) auto"], ["proof (state)\nthis:\n  (\\<Sum>n\\<in>real -` {0<..x}. a n * f (real n)) =\n  sum_upto (\\<lambda>n. a n * f (real n)) x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - sum_upto (\\<lambda>n. a n * f (real n)) x)\n     {0..x}", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>n\\<in>real -` {0<..x}. a n * f (real n)) =\n  sum_upto (\\<lambda>n. a n * f (real n)) x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - sum_upto (\\<lambda>n. a n * f (real n)) x)\n     {0..x}", "using partial_summation_strong[OF fin order.refl x deriv cont_f, of a]"], ["proof (prove)\nusing this:\n  (\\<Sum>n\\<in>real -` {0<..x}. a n * f (real n)) =\n  sum_upto (\\<lambda>n. a n * f (real n)) x\n  (\\<And>z.\n      z \\<in> {0..x} - X \\<Longrightarrow>\n      z \\<in> {0..x} - X) \\<Longrightarrow>\n  ((\\<lambda>t. sum_upto a t * f' t) has_integral\n   sum_upto a x * f x - sum_upto a 0 * f 0 -\n   (\\<Sum>n\\<in>real -` {0<..x}. a n * f (real n)))\n   {0..x}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. A t * f' t) has_integral\n     A x * f x - sum_upto (\\<lambda>n. a n * f (real n)) x)\n     {0..x}", "by (simp_all add: A_def)"], ["proof (state)\nthis:\n  ((\\<lambda>t. A t * f' t) has_integral\n   A x * f x - sum_upto (\\<lambda>n. a n * f (real n)) x)\n   {0..x}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma partial_summation_integrable_sum_upto_strong: \n        \"(\\<lambda>t. A t * f' t) integrable_on {0..x}\"\n  and partial_summation_sum_upto_strong': \n        \"sum_upto (\\<lambda>n. a n * f n) x = \n            A x * f x - integral {0..x} (\\<lambda>t. A t * f' t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t. A t * f' t) integrable_on {0..x} &&&\n    sum_upto (\\<lambda>n. a n * f (real n)) x =\n    A x * f x - integral {0..x} (\\<lambda>t. A t * f' t)", "using partial_summation_sum_upto_strong"], ["proof (prove)\nusing this:\n  ((\\<lambda>t. A t * f' t) has_integral\n   A x * f x - sum_upto (\\<lambda>n. a n * f (real n)) x)\n   {0..x}\n\ngoal (1 subgoal):\n 1. (\\<lambda>t. A t * f' t) integrable_on {0..x} &&&\n    sum_upto (\\<lambda>n. a n * f (real n)) x =\n    A x * f x - integral {0..x} (\\<lambda>t. A t * f' t)", "by (simp_all add: has_integral_iff algebra_simps)"], ["", "end"], ["", "end"]]}