{"file_name": "/home/qj213/afp-2021-10-22/thys/DiskPaxos/DiskPaxos_Inv4.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/DiskPaxos", "problem_names": ["theorem HInit_HInv4: \"HInit s \\<Longrightarrow> HInv4 s\"", "lemma HStartBallot_HInv4a1:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4a1 s p\"\n  and inv2a: \"Inv2a_inner s' p\"\n  shows \"HInv4a1 s' p\"", "lemma HStartBallot_HInv4a2:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4a2 s p\"\n  shows \"HInv4a2 s' p\"", "lemma HStartBallot_HInv4a_p:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4a s p\"\n  and inv2a: \"Inv2a_inner s' p\"\n  shows \"HInv4a s' p\"", "lemma HStartBallot_HInv4a_q:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4a s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4a s' q\"", "theorem HStartBallot_HInv4a:\n  assumes act: \"HStartBallot s s' p\"\n  and  inv: \"HInv4a s q\"\n  and inv2a: \"Inv2a s'\"\n  shows \"HInv4a s' q\"", "lemma Phase1or2Write_HInv4a1:\n  \"\\<lbrakk> Phase1or2Write s s' p d; HInv4a1 s q \\<rbrakk> \\<Longrightarrow> HInv4a1 s' q\"", "lemma Phase1or2Write_HInv4a2:\n  \"\\<lbrakk> Phase1or2Write s s' p d; HInv4a2 s q \\<rbrakk> \\<Longrightarrow> HInv4a2 s' q\"", "theorem HPhase1or2Write_HInv4a:\n  assumes act: \"HPhase1or2Write s s' p d\"\n  and inv: \"HInv4a s q\"\n  shows \"HInv4a s' q\"", "lemma HPhase1or2ReadThen_HInv4a1_p:\n  assumes act: \"HPhase1or2ReadThen s s' p d q\" \n  and     inv: \"HInv4a1 s p\"\n  shows \"HInv4a1 s' p\"", "lemma HPhase1or2ReadThen_HInv4a2:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d r; HInv4a2 s q \\<rbrakk> \\<Longrightarrow> HInv4a2 s' q\"", "lemma HPhase1or2ReadThen_HInv4a_p:\n  assumes act: \"HPhase1or2ReadThen s s' p d r\"\n  and inv: \"HInv4a s p\"\n  and inv2b: \"Inv2b s\"\n  shows \"HInv4a s' p\"", "lemma HPhase1or2ReadThen_HInv4a_q:\n  assumes act: \"HPhase1or2ReadThen s s' p d r\"\n  and inv: \"HInv4a s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4a s' q\"", "theorem HPhase1or2ReadThen_HInv4a:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d r; HInv4a s q; Inv2b s \\<rbrakk> \\<Longrightarrow> HInv4a s' q\"", "theorem HPhase1or2ReadElse_HInv4a:\n  assumes act: \"HPhase1or2ReadElse s s' p d r\" \n  and inv: \"HInv4a s q\" and inv2a: \"Inv2a s'\"\n  shows \"HInv4a s' q\"", "lemma HEndPhase1_HInv4a1:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4a1 s p\"\n  shows \"HInv4a1 s' p\"", "lemma HEndPhase1_HInv4a2:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4a2 s p\"\n  and inv2a: \"Inv2a s\"\n  shows \"HInv4a2 s' p\"", "lemma HEndPhase1_HInv4a_p:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4a s p\"\n  and inv2a: \"Inv2a s\"\n  shows \"HInv4a s' p\"", "lemma HEndPhase1_HInv4a_q:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4a s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4a s' q\"", "theorem HEndPhase1_HInv4a:\n  \"\\<lbrakk> HEndPhase1 s s' p; HInv4a s q;  Inv2a s \\<rbrakk> \\<Longrightarrow> HInv4a s' q\"", "theorem HFail_HInv4a:\n  \"\\<lbrakk> HFail s s' p; HInv4a s q \\<rbrakk> \\<Longrightarrow> HInv4a s' q\"", "theorem HPhase0Read_HInv4a:\n  \"\\<lbrakk> HPhase0Read s s' p d; HInv4a s q \\<rbrakk> \\<Longrightarrow> HInv4a s' q\"", "theorem HEndPhase2_HInv4a:\n  \"\\<lbrakk> HEndPhase2 s s' p; HInv4a s q \\<rbrakk> \\<Longrightarrow> HInv4a s' q\"", "lemma allSet: \n  assumes aPQ: \"\\<forall>a. \\<forall>r \\<in> P a. Q r\" and  rb: \"rb \\<in> P d\"\n  shows \"Q rb\"", "lemma EndPhase0_44:\n  assumes act: \"EndPhase0 s s' p\"\n  and bk: \"bk \\<in> blocksOf s p\"\n  and inv4d: \"HInv4d s p\"\n  and inv2c: \"Inv2c_inner s p\"\n  shows \"\\<exists>d. \\<exists>rb \\<in> blocksRead s p d. bal bk \\<le> mbal(block rb)\"", "lemma HEndPhase0_HInv4a1_p:\n  assumes act: \"HEndPhase0 s s' p\"\n  and   inv2a': \"Inv2a s'\"\n  and   inv2c: \"Inv2c_inner s p\"\n  and   inv4d: \"HInv4d s p\"\n  shows \"HInv4a1 s' p\"", "lemma hasRead_allBlks: \n  assumes inv2c: \"Inv2c_inner s p\"\n  and     phase: \"phase s p = 0\"\n  shows \"(\\<forall>d\\<in>{d. hasRead s p d p}. disk s d p \\<in> allBlocksRead s p)\"", "lemma HEndPhase0_41:\n  assumes act: \"HEndPhase0 s s' p\"\n  and    inv1:  \"Inv1 s\"\n  and   inv2c: \"Inv2c_inner s p\" \n  shows \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D.   mbal(disk s d p) \\<le> mbal(dblock s' p) \n                               \\<and> bal(disk s d p) \\<le> bal(dblock s' p)\"", "lemma Majority_exQ: \n  assumes asm1: \"\\<exists>D \\<in> MajoritySet. \\<forall>d\\<in>D. P d\"\n  shows \"\\<forall>D\\<in>MajoritySet.\\<exists>d\\<in>D. P d\"", "lemma HEndPhase0_HInv4a2_p:\n  assumes act: \"HEndPhase0 s s' p\"\n  and    inv1:  \"Inv1 s\"\n  and   inv2c: \"Inv2c_inner s p\"\n  shows \"HInv4a2 s' p\"", "lemma HEndPhase0_HInv4a_p:\n  assumes act: \"HEndPhase0 s s' p\"\n  and   inv2a: \"Inv2a s\"\n  and   inv2: \"Inv2c s\"\n  and   inv4d: \"HInv4d s p\"\n  and   inv1: \"Inv1 s\"\n  and inv: \"HInv4a s p\"\n  shows \"HInv4a s' p\"", "lemma HEndPhase0_HInv4a_q:\n  assumes act: \"HEndPhase0 s s' p\"\n  and inv: \"HInv4a s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4a s' q\"", "theorem HEndPhase0_HInv4a:\n  \"\\<lbrakk> HEndPhase0 s s' p; HInv4a s q; HInv4d s p;\n     Inv2a s;  Inv1 s;   Inv2a s; Inv2c s\\<rbrakk> \n  \\<Longrightarrow> HInv4a s' q\"", "lemma blocksRead_allBlocksRead: \n  \"rb \\<in> blocksRead s p d \\<Longrightarrow> block rb \\<in> allBlocksRead s p\"", "lemma HEndPhase0_dblock_mbal:\n  \"\\<lbrakk> HEndPhase0 s  s' p \\<rbrakk> \n     \\<Longrightarrow> \\<forall>br\\<in>allBlocksRead s p. mbal br < mbal(dblock s' p)\"", "lemma HEndPhase0_HInv4b_p_dblock:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv1:  \"Inv1 s\" \n  and inv2a: \"Inv2a s\"\n  and inv2c: \"Inv2c_inner s p\"\n  shows \"bal(dblock s' p) < mbal(dblock s' p)\"", "lemma HEndPhase0_HInv4b_p_blocksOf:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv4d: \"HInv4d s p\"\n  and inv2c: \"Inv2c_inner s p\"\n  and bk: \"bk \\<in> blocksOf s p\"\n  shows \"bal bk < mbal(dblock s' p)\"", "lemma HEndPhase0_HInv4b_p:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv4d: \"HInv4d s p\"\n  and inv1:  \"Inv1 s\" \n  and inv2a: \"Inv2a s\"\n  and inv2c: \"Inv2c_inner s p\"\n  shows \"HInv4b s' p\"", "lemma HEndPhase0_HInv4b_q:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "theorem HEndPhase0_HInv4b:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv: \"HInv4b s q\"\n  and inv4d: \"HInv4d s p\"\n  and inv1: \"Inv1 s\"\n  and inv2a: \"Inv2a s\" \n  and inv2c: \"Inv2c_inner s p\"\n  shows \"HInv4b s' q\"", "lemma HStartBallot_HInv4b_p:\n  assumes act: \"HStartBallot s  s' p\"\n  and inv2a: \"Inv2a_innermost s p (dblock s p)\"\n  and inv4b: \"HInv4b s p\"\n  and inv4a: \"HInv4a s p\"\n  shows \"HInv4b s' p\"", "lemma HStartBallot_HInv4b_q:\n  assumes act: \"HStartBallot s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "theorem HStartBallot_HInv4b:\n  assumes act: \"HStartBallot s  s' p\"\n  and inv2a: \"Inv2a s\"\n  and inv4b: \"HInv4b s q\"\n  and inv4a: \"HInv4a s p\"\n  shows \"HInv4b s' q\"", "theorem HPhase1or2Write_HInv4b:\n  \"\\<lbrakk> HPhase1or2Write s s' p d; HInv4b s q \\<rbrakk> \\<Longrightarrow> HInv4b s' q\"", "lemma HPhase1or2ReadThen_HInv4b_p:\n  assumes act: \"HPhase1or2ReadThen s s' p d q\"\n  and inv: \"HInv4b s p\"\n  shows \"HInv4b s' p\"", "lemma HPhase1or2ReadThen_HInv4b_q:\n  assumes act: \"HPhase1or2ReadThen s s' p d r\"\n  and inv: \"HInv4b s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4b s' q\"", "theorem HPhase1or2ReadThen_HInv4b:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d q; HInv4b s r\\<rbrakk> \\<Longrightarrow> HInv4b s' r\"", "theorem HPhase1or2ReadElse_HInv4b:\n  \"\\<lbrakk> HPhase1or2ReadElse s s' p d q; HInv4b s r;\n     Inv2a s; HInv4a s p \\<rbrakk>\n  \\<Longrightarrow> HInv4b s' r\"", "lemma HEndPhase1_HInv4b_p:\n  \"HEndPhase1 s s' p \\<Longrightarrow> HInv4b s' p\"", "lemma HEndPhase1_HInv4b_q:\n  assumes act: \"HEndPhase1 s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "theorem HEndPhase1_HInv4b:\n  assumes act: \"HEndPhase1 s  s' p\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "lemma HEndPhase2_HInv4b_p:\n  \"HEndPhase2 s s' p \\<Longrightarrow> HInv4b s' p\"", "lemma HEndPhase2_HInv4b_q:\n  assumes act: \"HEndPhase2 s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "theorem HEndPhase2_HInv4b:\n  assumes act: \"HEndPhase2 s  s' p\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "lemma HFail_HInv4b_p:\n  \"HFail s s' p \\<Longrightarrow> HInv4b s' p\"", "lemma HFail_HInv4b_q:\n  assumes act: \"HFail s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "theorem HFail_HInv4b:\n  assumes act: \"HFail s  s' p\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "lemma HPhase0Read_HInv4b_p:\n  \"HPhase0Read s s' p d \\<Longrightarrow> HInv4b s' p\"", "lemma HPhase0Read_HInv4b_q:\n  assumes act: \"HPhase0Read s  s' p d\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "theorem HPhase0Read_HInv4b:\n  assumes act: \"HPhase0Read s  s' p d\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\"", "lemma  HStartBallot_HInv4c_p:\n  \"\\<lbrakk> HStartBallot s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\"", "lemma  HStartBallot_HInv4c_q:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\"", "theorem HStartBallot_HInv4c:\n  \"\\<lbrakk> HStartBallot s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\"", "lemma  HPhase1or2Write_HInv4c_p:\n  assumes act: \"HPhase1or2Write s s' p d\" \n      and inv: \"HInv4c s p\" \n    and inv2c: \"Inv2c s\"\n  shows \"HInv4c s' p\"", "lemma  HPhase1or2Write_HInv4c_q:\n  assumes act: \"HPhase1or2Write s s' p d\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\"", "theorem HPhase1or2Write_HInv4c:\n  \"\\<lbrakk> HPhase1or2Write s s' p d; HInv4c s q; Inv2c s \\<rbrakk>\n             \\<Longrightarrow> HInv4c s' q\"", "lemma  HPhase1or2ReadThen_HInv4c_p:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d q; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\"", "lemma  HPhase1or2ReadThen_HInv4c_q:\n  assumes act: \"HPhase1or2ReadThen s s' p d r\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\"", "theorem HPhase1or2ReadThen_HInv4c:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d r; HInv4c s q\\<rbrakk>\n          \\<Longrightarrow> HInv4c s' q\"", "theorem HPhase1or2ReadElse_HInv4c:\n  \"\\<lbrakk> HPhase1or2ReadElse s s' p d r; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\"", "lemma  HEndPhase1_HInv4c_p:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv2b: \"Inv2b s\"\n  shows \"HInv4c s' p\"", "lemma  HEndPhase1_HInv4c_q:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\"", "theorem HEndPhase1_HInv4c:\n  \"\\<lbrakk> HEndPhase1 s s' p; HInv4c s q; Inv2b s\\<rbrakk> \\<Longrightarrow> HInv4c s' q\"", "lemma  HEndPhase2_HInv4c_p:\n  \"\\<lbrakk> HEndPhase2 s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\"", "lemma  HEndPhase2_HInv4c_q:\n  assumes act: \"HEndPhase2 s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\"", "theorem HEndPhase2_HInv4c:\n  \"\\<lbrakk> HEndPhase2 s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\"", "lemma  HFail_HInv4c_p:\n  \"\\<lbrakk> HFail s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\"", "lemma  HFail_HInv4c_q:\n  assumes act: \"HFail s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\"", "theorem HFail_HInv4c:\n  \"\\<lbrakk> HFail s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\"", "lemma  HPhase0Read_HInv4c_p:\n  \"\\<lbrakk> HPhase0Read s s' p d; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\"", "lemma  HPhase0Read_HInv4c_q:\n  assumes act: \"HPhase0Read s s' p d\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\"", "theorem HPhase0Read_HInv4c:\n  \"\\<lbrakk> HPhase0Read s s' p d; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\"", "lemma  HEndPhase0_HInv4c_p:\n  \"\\<lbrakk> HEndPhase0 s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\"", "lemma  HEndPhase0_HInv4c_q:\n  assumes act: \"HEndPhase0 s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\"", "theorem HEndPhase0_HInv4c:\n  \"\\<lbrakk> HEndPhase0 s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\"", "lemma  HStartBallot_HInv4d_p:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\"", "lemma HStartBallot_HInv4d_q:\n  assumes act: \"HStartBallot s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\"", "theorem HStartBallot_HInv4d:\n  \"\\<lbrakk> HStartBallot s s' p; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\"", "lemma  HPhase1or2Write_HInv4d_p:\n  assumes act: \"HPhase1or2Write s s' p d\"\n  and inv: \"HInv4d s p\"\n  and inv4a: \"HInv4a s p\"\n  shows \"HInv4d s' p\"", "lemma HPhase1or2Write_HInv4d_q:\n  assumes act: \"HPhase1or2Write s  s' p d\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\"", "theorem HPhase1or2Write_HInv4d:\n  \"\\<lbrakk> HPhase1or2Write s s' p d; HInv4d s q; HInv4a s p\\<rbrakk> \\<Longrightarrow> HInv4d s' q\"", "lemma  HPhase1or2ReadThen_HInv4d_p:\n  assumes act: \"HPhase1or2ReadThen s s' p d q\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\"", "lemma HPhase1or2ReadThen_HInv4d_q:\n  assumes act: \"HPhase1or2ReadThen s  s' p d r\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\"", "theorem HPhase1or2ReadThen_HInv4d:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d r; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\"", "theorem HPhase1or2ReadElse_HInv4d:\n  \"\\<lbrakk> HPhase1or2ReadElse s s' p d r; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\"", "lemma  HEndPhase1_HInv4d_p:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4d s p\"\n  and inv2b: \"Inv2b s\"\n  and inv4c: \"HInv4c s p\"\n  shows \"HInv4d s' p\"", "lemma HEndPhase1_HInv4d_q:\n  assumes act: \"HEndPhase1 s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\"", "theorem HEndPhase1_HInv4d:\n  \"\\<lbrakk> HEndPhase1 s s' p; HInv4d s q; Inv2b s; HInv4c s p\\<rbrakk>\n         \\<Longrightarrow> HInv4d s' q\"", "lemma  HEndPhase2_HInv4d_p:\n  assumes act: \"HEndPhase2 s s' p\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\"", "lemma HEndPhase2_HInv4d_q:\n  assumes act: \"HEndPhase2 s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\"", "theorem HEndPhase2_HInv4d:\n  \"\\<lbrakk> HEndPhase2 s s' p; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\"", "lemma  HFail_HInv4d_p:\n  assumes act: \"HFail s s' p\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\"", "lemma HFail_HInv4d_q:\n  assumes act: \"HFail s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\"", "theorem HFail_HInv4d:\n  \"\\<lbrakk> HFail s s' p; HInv4d s q \\<rbrakk> \\<Longrightarrow> HInv4d s' q\"", "lemma  HPhase0Read_HInv4d_p:\n  assumes act: \"HPhase0Read s s' p d\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\"", "lemma HPhase0Read_HInv4d_q:\n  assumes act: \"HPhase0Read s  s' p d\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\"", "theorem HPhase0Read_HInv4d:\n  \"\\<lbrakk> HPhase0Read s s' p d; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\"", "lemma HEndPhase0_blocksOf2:\n  assumes act: \"HEndPhase0 s s' p\"\n  and inv2c: \"Inv2c_inner s p\"\n  shows \"allBlocksRead s p \\<subseteq> blocksOf s p\"", "lemma  HEndPhase0_HInv4d_p:\n  assumes act: \"HEndPhase0 s s' p\"\n  and inv: \"HInv4d s p\"\n  and inv2c: \"Inv2c s\"\n  and inv1: \"Inv1 s\"\n  shows \"HInv4d s' p\"", "lemma HEndPhase0_HInv4d_q:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\"", "theorem HEndPhase0_HInv4d:\n  \"\\<lbrakk> HEndPhase0 s s' p; HInv4d s q; \n     Inv2c s; Inv1 s\\<rbrakk> \\<Longrightarrow> HInv4d s' q\"", "lemma I2d:\n  assumes nxt: \"HNext s s'\"\n  and inv: \"HInv1 s \\<and> HInv2 s \\<and> HInv2 s' \\<and> HInv4 s\"\n  shows \"HInv4 s'\""], "translations": [["", "theorem HInit_HInv4: \"HInit s \\<Longrightarrow> HInv4 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInit s \\<Longrightarrow> HInv4 s", "using Disk_isMajority"], ["proof (prove)\nusing this:\n  IsMajority UNIV\n\ngoal (1 subgoal):\n 1. HInit s \\<Longrightarrow> HInv4 s", "by(auto simp add: HInit_def Init_def HInv4_def HInv4a_def HInv4a1_def \n                    HInv4a2_def HInv4b_def HInv4c_def HInv4d_def \n                    MajoritySet_def blocksOf_def InitDB_def rdBy_def)"], ["", "text \\<open>To prove that the actions preserve $HInv4$,\n        we do it for one conjunct at a time.\n\n  For each action $action s s' q$ and conjunct $x\\in{a,b,c,d}$ of $HInv4x s' p$, \n  we prove two lemmas. \nThe first lemma $action$-$HInv4x$-$p$ proves the case of $p=q$, while \nlemma $action$-$HInv4x$-$q$ proves the other case.\n\\<close>"], ["", "subsubsection \\<open>Proofs of Invariant 4a\\<close>"], ["", "lemma HStartBallot_HInv4a1:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4a1 s p\"\n  and inv2a: \"Inv2a_inner s' p\"\n  shows \"HInv4a1 s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a1 s' p", "proof(auto simp add: HInv4a1_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "assume \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "with HStartBallot_blocksOf[OF act]"], ["proof (chain)\npicking this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n  bk \\<in> blocksOf s' p", "have \"bk \\<in> {dblock s' p} \\<union> blocksOf s p\""], ["proof (prove)\nusing this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<union> blocksOf s p", "by blast"], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "thus \"bal bk \\<le> mbal (dblock s' p)\""], ["proof (prove)\nusing this:\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (dblock s' p)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "assume \"bk \\<in> {dblock s' p}\""], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p}\n\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "with inv2a"], ["proof (chain)\npicking this:\n  Inv2a_inner s' p\n  bk \\<in> {dblock s' p}", "show ?thesis"], ["proof (prove)\nusing this:\n  Inv2a_inner s' p\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (dblock s' p)", "by(auto simp add: Inv2a_innermost_def Inv2a_inner_def blocksOf_def)"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (dblock s' p)\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "assume \"bk \\<in> blocksOf s p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "with inv act"], ["proof (chain)\npicking this:\n  HInv4a1 s p\n  HStartBallot s s' p\n  bk \\<in> blocksOf s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4a1 s p\n  HStartBallot s s' p\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (dblock s' p)", "by(auto simp add: StartBallot_def HInv4a1_def)"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HStartBallot_HInv4a2:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4a2 s p\"\n  shows \"HInv4a2 s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a2 s' p", "proof(auto simp add: HInv4a2_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "fix D"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "assume Dmaj: \"D \\<in> MajoritySet\""], ["proof (state)\nthis:\n  D \\<in> MajoritySet\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "from inv Dmaj"], ["proof (chain)\npicking this:\n  HInv4a2 s p\n  D \\<in> MajoritySet", "have \"\\<exists>d\\<in>D.   mbal (disk s d p) \\<le> mbal (dblock s p) \n              \\<and> bal (disk s d p) \\<le> bal (dblock s p)\""], ["proof (prove)\nusing this:\n  HInv4a2 s p\n  D \\<in> MajoritySet\n\ngoal (1 subgoal):\n 1. \\<exists>d\\<in>D.\n       mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n       bal (disk s d p) \\<le> bal (dblock s p)", "by(auto simp add: HInv4a2_def)"], ["proof (state)\nthis:\n  \\<exists>d\\<in>D.\n     mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "then"], ["proof (chain)\npicking this:\n  \\<exists>d\\<in>D.\n     mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s p)", "obtain d \n    where \"  d\\<in>D \n           \\<and> mbal (disk s d p) \\<le> mbal (dblock s p) \n           \\<and> bal (disk s d p) \\<le> bal (dblock s p)\""], ["proof (prove)\nusing this:\n  \\<exists>d\\<in>D.\n     mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s p)\n\ngoal (1 subgoal):\n 1. (\\<And>d.\n        d \\<in> D \\<and>\n        mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n        bal (disk s d p) \\<le> bal (dblock s p) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  d \\<in> D \\<and>\n  mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n  bal (disk s d p) \\<le> bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "with act"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  d \\<in> D \\<and>\n  mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n  bal (disk s d p) \\<le> bal (dblock s p)", "have \"  d\\<in>D \n        \\<and> mbal (disk s' d p) \\<le> mbal (dblock s' p) \n        \\<and> bal (disk s' d p) \\<le> bal (dblock s' p)\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  d \\<in> D \\<and>\n  mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n  bal (disk s d p) \\<le> bal (dblock s p)\n\ngoal (1 subgoal):\n 1. d \\<in> D \\<and>\n    mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n    bal (disk s' d p) \\<le> bal (dblock s' p)", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  d \\<in> D \\<and>\n  mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n  bal (disk s' d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "with Dmaj"], ["proof (chain)\npicking this:\n  D \\<in> MajoritySet\n  d \\<in> D \\<and>\n  mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n  bal (disk s' d p) \\<le> bal (dblock s' p)", "show \"\\<exists>d\\<in>D.   mbal (disk s' d p) \\<le> mbal (dblock s' p) \n              \\<and> bal (disk s' d p) \\<le> bal (dblock s' p)\""], ["proof (prove)\nusing this:\n  D \\<in> MajoritySet\n  d \\<in> D \\<and>\n  mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n  bal (disk s' d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<exists>d\\<in>D.\n       mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n       bal (disk s' d p) \\<le> bal (dblock s' p)", "by auto"], ["proof (state)\nthis:\n  \\<exists>d\\<in>D.\n     mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n     bal (disk s' d p) \\<le> bal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HStartBallot_HInv4a_p:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4a s p\"\n  and inv2a: \"Inv2a_inner s' p\"\n  shows \"HInv4a s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' p", "using act inv inv2a"], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  HInv4a s p\n  Inv2a_inner s' p\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>HStartBallot s s' p; HInv4a s p; Inv2a_inner s' p\\<rbrakk>\n    \\<Longrightarrow> HInv4a s' p", "from act"], ["proof (chain)\npicking this:\n  HStartBallot s s' p", "have phase: \"0 < phase s p\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n\ngoal (1 subgoal):\n 1. 0 < phase s p", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  0 < phase s p\n\ngoal (1 subgoal):\n 1. \\<lbrakk>HStartBallot s s' p; HInv4a s p; Inv2a_inner s' p\\<rbrakk>\n    \\<Longrightarrow> HInv4a s' p", "from act inv inv2a"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  HInv4a s p\n  Inv2a_inner s' p", "show ?thesis"], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  HInv4a s p\n  Inv2a_inner s' p\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "by(auto simp del: HStartBallot_def simp  add: HInv4a_def phase\n               elim: HStartBallot_HInv4a1 HStartBallot_HInv4a2)"], ["proof (state)\nthis:\n  HInv4a s' p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HStartBallot_HInv4a_q:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4a s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  p \\<noteq> q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: StartBallot_def InitializePhase_def \n                      blocksOf_def rdBy_def)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "with act inv pnq"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  HInv4a s q\n  p \\<noteq> q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  HInv4a s q\n  p \\<noteq> q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(auto simp add: StartBallot_def HInv4a_def \n                      HInv4a1_def HInv4a2_def)"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HStartBallot_HInv4a:\n  assumes act: \"HStartBallot s s' p\"\n  and  inv: \"HInv4a s q\"\n  and inv2a: \"Inv2a s'\"\n  shows \"HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' q", "proof(cases \"p=q\")"], ["proof (state)\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4a s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4a s' q", "case True"], ["proof (state)\nthis:\n  p = q\n\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4a s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4a s' q", "from inv2a"], ["proof (chain)\npicking this:\n  Inv2a s'", "have \"Inv2a_inner s' p\""], ["proof (prove)\nusing this:\n  Inv2a s'\n\ngoal (1 subgoal):\n 1. Inv2a_inner s' p", "by(auto simp add: Inv2a_def)"], ["proof (state)\nthis:\n  Inv2a_inner s' p\n\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4a s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4a s' q", "with act inv True"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  HInv4a s q\n  p = q\n  Inv2a_inner s' p", "show ?thesis"], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  HInv4a s q\n  p = q\n  Inv2a_inner s' p\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(blast dest: HStartBallot_HInv4a_p)"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4a s' q", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4a s' q", "case False"], ["proof (state)\nthis:\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4a s' q", "with act inv"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  HInv4a s q\n  p \\<noteq> q", "show ?thesis"], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  HInv4a s q\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(blast dest: HStartBallot_HInv4a_q)"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Phase1or2Write_HInv4a1:\n  \"\\<lbrakk> Phase1or2Write s s' p d; HInv4a1 s q \\<rbrakk> \\<Longrightarrow> HInv4a1 s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Phase1or2Write s s' p d; HInv4a1 s q\\<rbrakk>\n    \\<Longrightarrow> HInv4a1 s' q", "by(auto simp add: Phase1or2Write_def HInv4a1_def \n                    blocksOf_def rdBy_def)"], ["", "lemma Phase1or2Write_HInv4a2:\n  \"\\<lbrakk> Phase1or2Write s s' p d; HInv4a2 s q \\<rbrakk> \\<Longrightarrow> HInv4a2 s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Phase1or2Write s s' p d; HInv4a2 s q\\<rbrakk>\n    \\<Longrightarrow> HInv4a2 s' q", "by(auto simp add: Phase1or2Write_def HInv4a2_def)"], ["", "theorem HPhase1or2Write_HInv4a:\n  assumes act: \"HPhase1or2Write s s' p d\"\n  and inv: \"HInv4a s q\"\n  shows \"HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' q", "from act"], ["proof (chain)\npicking this:\n  HPhase1or2Write s s' p d", "have phase': \"phase s = phase s'\""], ["proof (prove)\nusing this:\n  HPhase1or2Write s s' p d\n\ngoal (1 subgoal):\n 1. phase s = phase s'", "by(simp add: Phase1or2Write_def)"], ["proof (state)\nthis:\n  phase s = phase s'\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' q", "proof(cases \"phase s q = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. phase s q = 0 \\<Longrightarrow> HInv4a s' q\n 2. phase s q \\<noteq> 0 \\<Longrightarrow> HInv4a s' q", "case True"], ["proof (state)\nthis:\n  phase s q = 0\n\ngoal (2 subgoals):\n 1. phase s q = 0 \\<Longrightarrow> HInv4a s' q\n 2. phase s q \\<noteq> 0 \\<Longrightarrow> HInv4a s' q", "with phase' act"], ["proof (chain)\npicking this:\n  phase s = phase s'\n  HPhase1or2Write s s' p d\n  phase s q = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  phase s = phase s'\n  HPhase1or2Write s s' p d\n  phase s q = 0\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(auto simp add: HInv4a_def)"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal (1 subgoal):\n 1. phase s q \\<noteq> 0 \\<Longrightarrow> HInv4a s' q", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. phase s q \\<noteq> 0 \\<Longrightarrow> HInv4a s' q", "case False"], ["proof (state)\nthis:\n  phase s q \\<noteq> 0\n\ngoal (1 subgoal):\n 1. phase s q \\<noteq> 0 \\<Longrightarrow> HInv4a s' q", "with phase' act inv"], ["proof (chain)\npicking this:\n  phase s = phase s'\n  HPhase1or2Write s s' p d\n  HInv4a s q\n  phase s q \\<noteq> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  phase s = phase s'\n  HPhase1or2Write s s' p d\n  HInv4a s q\n  phase s q \\<noteq> 0\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(auto simp add: HInv4a_def \n                dest: Phase1or2Write_HInv4a1 Phase1or2Write_HInv4a2)"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HPhase1or2ReadThen_HInv4a1_p:\n  assumes act: \"HPhase1or2ReadThen s s' p d q\" \n  and     inv: \"HInv4a1 s p\"\n  shows \"HInv4a1 s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a1 s' p", "proof(auto simp: HInv4a1_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "with HPhase1or2ReadThen_blocksOf[OF act]"], ["proof (chain)\npicking this:\n  blocksOf s' ?r \\<subseteq> blocksOf s ?r\n  bk \\<in> blocksOf s' p", "have \"bk \\<in> blocksOf s p\""], ["proof (prove)\nusing this:\n  blocksOf s' ?r \\<subseteq> blocksOf s ?r\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p", "by auto"], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "with inv act"], ["proof (chain)\npicking this:\n  HInv4a1 s p\n  HPhase1or2ReadThen s s' p d q\n  bk \\<in> blocksOf s p", "show \"bal bk \\<le> mbal (dblock s' p)\""], ["proof (prove)\nusing this:\n  HInv4a1 s p\n  HPhase1or2ReadThen s s' p d q\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (dblock s' p)", "by(auto simp add: HInv4a1_def Phase1or2ReadThen_def)"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HPhase1or2ReadThen_HInv4a2:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d r; HInv4a2 s q \\<rbrakk> \\<Longrightarrow> HInv4a2 s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadThen s s' p d r; HInv4a2 s q\\<rbrakk>\n    \\<Longrightarrow> HInv4a2 s' q", "by(auto simp add: Phase1or2ReadThen_def HInv4a2_def)"], ["", "lemma HPhase1or2ReadThen_HInv4a_p:\n  assumes act: \"HPhase1or2ReadThen s s' p d r\"\n  and inv: \"HInv4a s p\"\n  and inv2b: \"Inv2b s\"\n  shows \"HInv4a s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' p", "from act inv2b"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d r\n  Inv2b s", "have \"phase s p \\<in> {1,2}\""], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d r\n  Inv2b s\n\ngoal (1 subgoal):\n 1. phase s p \\<in> {1, 2}", "by(auto simp add: Phase1or2ReadThen_def Inv2b_def Inv2b_inner_def)"], ["proof (state)\nthis:\n  phase s p \\<in> {1, 2}\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "with act inv"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d r\n  HInv4a s p\n  phase s p \\<in> {1, 2}", "show ?thesis"], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d r\n  HInv4a s p\n  phase s p \\<in> {1, 2}\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "by(auto simp del: HPhase1or2ReadThen_def simp add: HInv4a_def\n          elim: HPhase1or2ReadThen_HInv4a1_p HPhase1or2ReadThen_HInv4a2)"], ["proof (state)\nthis:\n  HInv4a s' p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HPhase1or2ReadThen_HInv4a_q:\n  assumes act: \"HPhase1or2ReadThen s s' p d r\"\n  and inv: \"HInv4a s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d r\n  p \\<noteq> q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d r\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: Phase1or2ReadThen_def InitializePhase_def \n                      blocksOf_def rdBy_def)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "with act inv pnq"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d r\n  HInv4a s q\n  p \\<noteq> q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d r\n  HInv4a s q\n  p \\<noteq> q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(auto simp add: Phase1or2ReadThen_def HInv4a_def \n                      HInv4a1_def HInv4a2_def)"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase1or2ReadThen_HInv4a:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d r; HInv4a s q; Inv2b s \\<rbrakk> \\<Longrightarrow> HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadThen s s' p d r; HInv4a s q; Inv2b s\\<rbrakk>\n    \\<Longrightarrow> HInv4a s' q", "by(blast dest: HPhase1or2ReadThen_HInv4a_p HPhase1or2ReadThen_HInv4a_q)"], ["", "theorem HPhase1or2ReadElse_HInv4a:\n  assumes act: \"HPhase1or2ReadElse s s' p d r\" \n  and inv: \"HInv4a s q\" and inv2a: \"Inv2a s'\"\n  shows \"HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' q", "from act"], ["proof (chain)\npicking this:\n  HPhase1or2ReadElse s s' p d r", "have \"HStartBallot s s' p\""], ["proof (prove)\nusing this:\n  HPhase1or2ReadElse s s' p d r\n\ngoal (1 subgoal):\n 1. HStartBallot s s' p", "by(simp add: Phase1or2ReadElse_def)"], ["proof (state)\nthis:\n  HStartBallot s s' p\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "with inv inv2a"], ["proof (chain)\npicking this:\n  HInv4a s q\n  Inv2a s'\n  HStartBallot s s' p", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4a s q\n  Inv2a s'\n  HStartBallot s s' p\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(blast dest: dest: HStartBallot_HInv4a )"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase1_HInv4a1:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4a1 s p\"\n  shows \"HInv4a1 s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a1 s' p", "proof(auto simp add: HInv4a1_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "from bk HEndPhase1_blocksOf[OF act]"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s' p\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}", "have \"bk \\<in> {dblock s' p} \\<union> blocksOf s p\""], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s' p\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<union> blocksOf s p", "by blast"], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "with act inv"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  HInv4a1 s p\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p", "show \"bal bk \\<le> mbal (dblock s' p)\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  HInv4a1 s p\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (dblock s' p)", "by(auto simp add: HInv4a_def HInv4a1_def EndPhase1_def)"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase1_HInv4a2:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4a2 s p\"\n  and inv2a: \"Inv2a s\"\n  shows \"HInv4a2 s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a2 s' p", "proof(auto simp add: HInv4a2_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "fix D"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "assume Dmaj: \"D \\<in> MajoritySet\""], ["proof (state)\nthis:\n  D \\<in> MajoritySet\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "from inv Dmaj"], ["proof (chain)\npicking this:\n  HInv4a2 s p\n  D \\<in> MajoritySet", "have \"\\<exists>d\\<in>D.   mbal (disk s d p) \\<le> mbal (dblock s p) \n              \\<and> bal (disk s d p) \\<le> bal (dblock s p)\""], ["proof (prove)\nusing this:\n  HInv4a2 s p\n  D \\<in> MajoritySet\n\ngoal (1 subgoal):\n 1. \\<exists>d\\<in>D.\n       mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n       bal (disk s d p) \\<le> bal (dblock s p)", "by(auto simp add: HInv4a2_def)"], ["proof (state)\nthis:\n  \\<exists>d\\<in>D.\n     mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "then"], ["proof (chain)\npicking this:\n  \\<exists>d\\<in>D.\n     mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s p)", "obtain d \n    where d_cond: \"  d\\<in>D \n                   \\<and> mbal (disk s d p) \\<le> mbal (dblock s p) \n                   \\<and> bal (disk s d p) \\<le> bal (dblock s p)\""], ["proof (prove)\nusing this:\n  \\<exists>d\\<in>D.\n     mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s p)\n\ngoal (1 subgoal):\n 1. (\\<And>d.\n        d \\<in> D \\<and>\n        mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n        bal (disk s d p) \\<le> bal (dblock s p) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  d \\<in> D \\<and>\n  mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n  bal (disk s d p) \\<le> bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "have \"disk s d p \\<in> blocksOf s p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. disk s d p \\<in> blocksOf s p", "by(auto simp add: blocksOf_def)"], ["proof (state)\nthis:\n  disk s d p \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "with inv2a"], ["proof (chain)\npicking this:\n  Inv2a s\n  disk s d p \\<in> blocksOf s p", "have \"bal(disk s d p) \\<le> mbal (disk s d p)\""], ["proof (prove)\nusing this:\n  Inv2a s\n  disk s d p \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal (disk s d p) \\<le> mbal (disk s d p)", "by(auto simp add: Inv2a_def Inv2a_inner_def Inv2a_innermost_def)"], ["proof (state)\nthis:\n  bal (disk s d p) \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "with act d_cond"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  d \\<in> D \\<and>\n  mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n  bal (disk s d p) \\<le> bal (dblock s p)\n  bal (disk s d p) \\<le> mbal (disk s d p)", "have \"  d\\<in>D \n        \\<and> mbal (disk s' d p) \\<le> mbal (dblock s' p) \n        \\<and> bal (disk s' d p) \\<le> bal (dblock s' p)\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  d \\<in> D \\<and>\n  mbal (disk s d p) \\<le> mbal (dblock s p) \\<and>\n  bal (disk s d p) \\<le> bal (dblock s p)\n  bal (disk s d p) \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. d \\<in> D \\<and>\n    mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n    bal (disk s' d p) \\<le> bal (dblock s' p)", "by(auto simp add: EndPhase1_def)"], ["proof (state)\nthis:\n  d \\<in> D \\<and>\n  mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n  bal (disk s' d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<And>D.\n       D \\<in> MajoritySet \\<Longrightarrow>\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "with Dmaj"], ["proof (chain)\npicking this:\n  D \\<in> MajoritySet\n  d \\<in> D \\<and>\n  mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n  bal (disk s' d p) \\<le> bal (dblock s' p)", "show \"\\<exists>d\\<in>D.   mbal (disk s' d p) \\<le> mbal (dblock s' p) \n              \\<and> bal (disk s' d p) \\<le> bal (dblock s' p)\""], ["proof (prove)\nusing this:\n  D \\<in> MajoritySet\n  d \\<in> D \\<and>\n  mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n  bal (disk s' d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<exists>d\\<in>D.\n       mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n       bal (disk s' d p) \\<le> bal (dblock s' p)", "by auto"], ["proof (state)\nthis:\n  \\<exists>d\\<in>D.\n     mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n     bal (disk s' d p) \\<le> bal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase1_HInv4a_p:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4a s p\"\n  and inv2a: \"Inv2a s\"\n  shows \"HInv4a s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' p", "from act"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p", "have phase: \"0 < phase s p\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n\ngoal (1 subgoal):\n 1. 0 < phase s p", "by(auto simp add: EndPhase1_def)"], ["proof (state)\nthis:\n  0 < phase s p\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "with act inv inv2a"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  HInv4a s p\n  Inv2a s\n  0 < phase s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  HInv4a s p\n  Inv2a s\n  0 < phase s p\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "by(auto simp del: HEndPhase1_def simp  add: HInv4a_def \n               elim: HEndPhase1_HInv4a1 HEndPhase1_HInv4a2)"], ["proof (state)\nthis:\n  HInv4a s' p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase1_HInv4a_q:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4a s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  p \\<noteq> q", "have \"dblock s' q = dblock s q \\<and> disk s' = disk s\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. dblock s' q = dblock s q \\<and> disk s' = disk s", "by(auto simp add: EndPhase1_def)"], ["proof (state)\nthis:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "moreover"], ["proof (state)\nthis:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  p \\<noteq> q", "have \"\\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d", "by(auto simp add: EndPhase1_def InitializePhase_def rdBy_def)"], ["proof (state)\nthis:\n  \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "hence \"(UN p d. rdBy s' q p d) \\<subseteq> (UN p d. rdBy s q p d)\""], ["proof (prove)\nusing this:\n  \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\n\ngoal (1 subgoal):\n 1. (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n    \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))", "by(auto, blast)"], ["proof (state)\nthis:\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "ultimately"], ["proof (chain)\npicking this:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: blocksOf_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "with act inv pnq"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  HInv4a s q\n  p \\<noteq> q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  HInv4a s q\n  p \\<noteq> q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(auto simp add: EndPhase1_def HInv4a_def HInv4a1_def HInv4a2_def)"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase1_HInv4a:\n  \"\\<lbrakk> HEndPhase1 s s' p; HInv4a s q;  Inv2a s \\<rbrakk> \\<Longrightarrow> HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase1 s s' p; HInv4a s q; Inv2a s\\<rbrakk>\n    \\<Longrightarrow> HInv4a s' q", "by(blast dest: HEndPhase1_HInv4a_p HEndPhase1_HInv4a_q)"], ["", "theorem HFail_HInv4a:\n  \"\\<lbrakk> HFail s s' p; HInv4a s q \\<rbrakk> \\<Longrightarrow> HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HFail s s' p; HInv4a s q\\<rbrakk> \\<Longrightarrow> HInv4a s' q", "by(auto simp add: Fail_def HInv4a_def HInv4a1_def \n                    HInv4a2_def InitializePhase_def \n                    blocksOf_def rdBy_def)"], ["", "theorem HPhase0Read_HInv4a:\n  \"\\<lbrakk> HPhase0Read s s' p d; HInv4a s q \\<rbrakk> \\<Longrightarrow> HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase0Read s s' p d; HInv4a s q\\<rbrakk>\n    \\<Longrightarrow> HInv4a s' q", "by(auto simp add: Phase0Read_def HInv4a_def HInv4a1_def \n                    HInv4a2_def InitializePhase_def \n                    blocksOf_def rdBy_def)"], ["", "theorem HEndPhase2_HInv4a:\n  \"\\<lbrakk> HEndPhase2 s s' p; HInv4a s q \\<rbrakk> \\<Longrightarrow> HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase2 s s' p; HInv4a s q\\<rbrakk>\n    \\<Longrightarrow> HInv4a s' q", "by(auto simp add: EndPhase2_def HInv4a_def HInv4a1_def HInv4a2_def \n                    InitializePhase_def blocksOf_def rdBy_def)"], ["", "lemma allSet: \n  assumes aPQ: \"\\<forall>a. \\<forall>r \\<in> P a. Q r\" and  rb: \"rb \\<in> P d\"\n  shows \"Q rb\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Q rb", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. Q rb", "from aPQ"], ["proof (chain)\npicking this:\n  \\<forall>a. \\<forall>r\\<in>P a. Q r", "have \"\\<forall>r \\<in> P d. Q r\""], ["proof (prove)\nusing this:\n  \\<forall>a. \\<forall>r\\<in>P a. Q r\n\ngoal (1 subgoal):\n 1. \\<forall>r\\<in>P d. Q r", "by auto"], ["proof (state)\nthis:\n  \\<forall>r\\<in>P d. Q r\n\ngoal (1 subgoal):\n 1. Q rb", "with rb"], ["proof (chain)\npicking this:\n  rb \\<in> P d\n  \\<forall>r\\<in>P d. Q r", "show ?thesis"], ["proof (prove)\nusing this:\n  rb \\<in> P d\n  \\<forall>r\\<in>P d. Q r\n\ngoal (1 subgoal):\n 1. Q rb", "by auto"], ["proof (state)\nthis:\n  Q rb\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma EndPhase0_44:\n  assumes act: \"EndPhase0 s s' p\"\n  and bk: \"bk \\<in> blocksOf s p\"\n  and inv4d: \"HInv4d s p\"\n  and inv2c: \"Inv2c_inner s p\"\n  shows \"\\<exists>d. \\<exists>rb \\<in> blocksRead s p d. bal bk \\<le> mbal(block rb)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "from bk inv4d"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s p\n  HInv4d s p", "have \"\\<exists>D1 \\<in> MajoritySet.\\<forall>d \\<in> D1. bal bk \\<le> mbal(disk s d p)\"  \\<comment> \\<open>4.2\\<close>"], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s p\n  HInv4d s p\n\ngoal (1 subgoal):\n 1. \\<exists>D1\\<in>MajoritySet.\n       \\<forall>d\\<in>D1. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D1\\<in>MajoritySet.\n     \\<forall>d\\<in>D1. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "with majorities_intersect"], ["proof (chain)\npicking this:\n  \\<forall>S T.\n     IsMajority S \\<and> IsMajority T \\<longrightarrow>\n     S \\<inter> T \\<noteq> {}\n  \\<exists>D1\\<in>MajoritySet.\n     \\<forall>d\\<in>D1. bal bk \\<le> mbal (disk s d p)", "have p43: \"\\<forall>D\\<in>MajoritySet. \\<exists>d\\<in>D. bal bk \\<le> mbal(disk s d p)\""], ["proof (prove)\nusing this:\n  \\<forall>S T.\n     IsMajority S \\<and> IsMajority T \\<longrightarrow>\n     S \\<inter> T \\<noteq> {}\n  \\<exists>D1\\<in>MajoritySet.\n     \\<forall>d\\<in>D1. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet.\n       \\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(simp add: MajoritySet_def, blast)"], ["proof (state)\nthis:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "from act"], ["proof (chain)\npicking this:\n  EndPhase0 s s' p", "have \"phase s p = 0\""], ["proof (prove)\nusing this:\n  EndPhase0 s s' p\n\ngoal (1 subgoal):\n 1. phase s p = 0", "by(simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "with inv2c"], ["proof (chain)\npicking this:\n  Inv2c_inner s p\n  phase s p = 0", "have \"\\<forall>d. \\<forall>rb \\<in> blocksRead s p d. block rb = disk s d p\" \\<comment> \\<open>5.1\\<close>"], ["proof (prove)\nusing this:\n  Inv2c_inner s p\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. \\<forall>d. \\<forall>rb\\<in>blocksRead s p d. block rb = disk s d p", "by(simp add: Inv2c_inner_def)"], ["proof (state)\nthis:\n  \\<forall>d. \\<forall>rb\\<in>blocksRead s p d. block rb = disk s d p\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "hence \"\\<forall>d. hasRead s p d p  \n              \\<longrightarrow> (\\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p)\" \\<comment> \\<open>5.2\\<close>\n    (is \"\\<forall>d. ?H d \\<longrightarrow> ?P d\")"], ["proof (prove)\nusing this:\n  \\<forall>d. \\<forall>rb\\<in>blocksRead s p d. block rb = disk s d p\n\ngoal (1 subgoal):\n 1. \\<forall>d.\n       hasRead s p d p \\<longrightarrow>\n       (\\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p)", "by(auto simp add: hasRead_def)"], ["proof (state)\nthis:\n  \\<forall>d.\n     hasRead s p d p \\<longrightarrow>\n     (\\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "with act"], ["proof (chain)\npicking this:\n  EndPhase0 s s' p\n  \\<forall>d.\n     hasRead s p d p \\<longrightarrow>\n     (\\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p)", "have p53: \"\\<exists>D \\<in> MajoritySet. \\<forall>d\\<in>D. ?P d\""], ["proof (prove)\nusing this:\n  EndPhase0 s s' p\n  \\<forall>d.\n     hasRead s p d p \\<longrightarrow>\n     (\\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D.\n          \\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p", "by(auto simp add: MajoritySet_def EndPhase0_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D.\n        \\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "from p43 p53"], ["proof (chain)\npicking this:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D.\n        \\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p", "have \"\\<exists>D\\<in> MajoritySet.   (\\<exists>d\\<in>D. bal bk \\<le> mbal(disk s d p)) \n                           \\<and> (\\<forall>d\\<in>D. ?P d)\""], ["proof (prove)\nusing this:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D.\n        \\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       (\\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)) \\<and>\n       (\\<forall>d\\<in>D.\n           \\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p)", "by auto"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     (\\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)) \\<and>\n     (\\<forall>d\\<in>D.\n         \\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>D\\<in>MajoritySet.\n     (\\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)) \\<and>\n     (\\<forall>d\\<in>D.\n         \\<exists>rb\\<in>blocksRead s p d. block rb = disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "by force"], ["proof (state)\nthis:\n  \\<exists>d. \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>d. \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_HInv4a1_p:\n  assumes act: \"HEndPhase0 s s' p\"\n  and   inv2a': \"Inv2a s'\"\n  and   inv2c: \"Inv2c_inner s p\"\n  and   inv4d: \"HInv4d s p\"\n  shows \"HInv4a1 s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a1 s' p", "proof(auto simp add: HInv4a1_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "assume \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "with HEndPhase0_blocksOf[OF act]"], ["proof (chain)\npicking this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n  bk \\<in> blocksOf s' p", "have \"bk \\<in> {dblock s' p} \\<union> blocksOf s p\""], ["proof (prove)\nusing this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<union> blocksOf s p", "by auto"], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       bal bk \\<le> mbal (dblock s' p)", "thus \"bal bk \\<le> mbal (dblock s' p)\""], ["proof (prove)\nusing this:\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (dblock s' p)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "assume bk: \"bk \\<in> {dblock s' p}\""], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p}\n\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "with inv2a'"], ["proof (chain)\npicking this:\n  Inv2a s'\n  bk \\<in> {dblock s' p}", "have \"Inv2a_innermost s' p bk\""], ["proof (prove)\nusing this:\n  Inv2a s'\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. Inv2a_innermost s' p bk", "by(auto simp add: Inv2a_def Inv2a_inner_def blocksOf_def)"], ["proof (state)\nthis:\n  Inv2a_innermost s' p bk\n\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "with bk"], ["proof (chain)\npicking this:\n  bk \\<in> {dblock s' p}\n  Inv2a_innermost s' p bk", "show ?thesis"], ["proof (prove)\nusing this:\n  bk \\<in> {dblock s' p}\n  Inv2a_innermost s' p bk\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (dblock s' p)", "by(auto simp add: Inv2a_innermost_def)"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (dblock s' p)\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "assume bk: \"bk \\<in> blocksOf s p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "from act"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p", "have f1: \"\\<forall>r \\<in> allBlocksRead s p. mbal r < mbal (dblock s' p)\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n\ngoal (1 subgoal):\n 1. \\<forall>r\\<in>allBlocksRead s p. mbal r < mbal (dblock s' p)", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  \\<forall>r\\<in>allBlocksRead s p. mbal r < mbal (dblock s' p)\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "with act inv4d inv2c bk"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  HInv4d s p\n  Inv2c_inner s p\n  bk \\<in> blocksOf s p\n  \\<forall>r\\<in>allBlocksRead s p. mbal r < mbal (dblock s' p)", "have \"\\<exists>d. \\<exists>rb \\<in> blocksRead s p d. bal bk \\<le> mbal(block rb)\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  HInv4d s p\n  Inv2c_inner s p\n  bk \\<in> blocksOf s p\n  \\<forall>r\\<in>allBlocksRead s p. mbal r < mbal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<exists>d.\n       \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "by(auto dest: EndPhase0_44)"], ["proof (state)\nthis:\n  \\<exists>d. \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk \\<le> mbal (dblock s' p)", "with f1"], ["proof (chain)\npicking this:\n  \\<forall>r\\<in>allBlocksRead s p. mbal r < mbal (dblock s' p)\n  \\<exists>d. \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>r\\<in>allBlocksRead s p. mbal r < mbal (dblock s' p)\n  \\<exists>d. \\<exists>rb\\<in>blocksRead s p d. bal bk \\<le> mbal (block rb)\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (dblock s' p)", "by(auto simp add: EndPhase0_def allBlocksRead_def\n                        allRdBlks_def dest: allSet)"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma hasRead_allBlks: \n  assumes inv2c: \"Inv2c_inner s p\"\n  and     phase: \"phase s p = 0\"\n  shows \"(\\<forall>d\\<in>{d. hasRead s p d p}. disk s d p \\<in> allBlocksRead s p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>d\\<in>{d. hasRead s p d p}. disk s d p \\<in> allBlocksRead s p", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>d.\n       d \\<in> {d. hasRead s p d p} \\<Longrightarrow>\n       disk s d p \\<in> allBlocksRead s p", "fix d"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>d.\n       d \\<in> {d. hasRead s p d p} \\<Longrightarrow>\n       disk s d p \\<in> allBlocksRead s p", "assume d: \"d\\<in>{d. hasRead s p d p}\" (is \"d\\<in> ?D\")"], ["proof (state)\nthis:\n  d \\<in> {d. hasRead s p d p}\n\ngoal (1 subgoal):\n 1. \\<And>d.\n       d \\<in> {d. hasRead s p d p} \\<Longrightarrow>\n       disk s d p \\<in> allBlocksRead s p", "hence br_ne: \"blocksRead s p d\\<noteq>{}\""], ["proof (prove)\nusing this:\n  d \\<in> {d. hasRead s p d p}\n\ngoal (1 subgoal):\n 1. blocksRead s p d \\<noteq> {}", "by (auto simp add: hasRead_def)"], ["proof (state)\nthis:\n  blocksRead s p d \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>d.\n       d \\<in> {d. hasRead s p d p} \\<Longrightarrow>\n       disk s d p \\<in> allBlocksRead s p", "from inv2c phase"], ["proof (chain)\npicking this:\n  Inv2c_inner s p\n  phase s p = 0", "have \"\\<forall>br \\<in> blocksRead s p d. block br = disk s d p\""], ["proof (prove)\nusing this:\n  Inv2c_inner s p\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. \\<forall>br\\<in>blocksRead s p d. block br = disk s d p", "by(auto simp add: Inv2c_inner_def)"], ["proof (state)\nthis:\n  \\<forall>br\\<in>blocksRead s p d. block br = disk s d p\n\ngoal (1 subgoal):\n 1. \\<And>d.\n       d \\<in> {d. hasRead s p d p} \\<Longrightarrow>\n       disk s d p \\<in> allBlocksRead s p", "with br_ne"], ["proof (chain)\npicking this:\n  blocksRead s p d \\<noteq> {}\n  \\<forall>br\\<in>blocksRead s p d. block br = disk s d p", "have \"disk s d p \\<in> block ` blocksRead s p d\""], ["proof (prove)\nusing this:\n  blocksRead s p d \\<noteq> {}\n  \\<forall>br\\<in>blocksRead s p d. block br = disk s d p\n\ngoal (1 subgoal):\n 1. disk s d p \\<in> block ` blocksRead s p d", "by force"], ["proof (state)\nthis:\n  disk s d p \\<in> block ` blocksRead s p d\n\ngoal (1 subgoal):\n 1. \\<And>d.\n       d \\<in> {d. hasRead s p d p} \\<Longrightarrow>\n       disk s d p \\<in> allBlocksRead s p", "thus \"disk s d p \\<in> allBlocksRead s p\""], ["proof (prove)\nusing this:\n  disk s d p \\<in> block ` blocksRead s p d\n\ngoal (1 subgoal):\n 1. disk s d p \\<in> allBlocksRead s p", "by(auto simp add: allBlocksRead_def allRdBlks_def)"], ["proof (state)\nthis:\n  disk s d p \\<in> allBlocksRead s p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_41:\n  assumes act: \"HEndPhase0 s s' p\"\n  and    inv1:  \"Inv1 s\"\n  and   inv2c: \"Inv2c_inner s p\" \n  shows \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D.   mbal(disk s d p) \\<le> mbal(dblock s' p) \n                               \\<and> bal(disk s d p) \\<le> bal(dblock s' p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D.\n          mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s d p) \\<le> bal (dblock s' p)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D.\n          mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s d p) \\<le> bal (dblock s' p)", "from act HEndPhase0_some[OF act inv1]"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  (SOME b.\n      b \\<in> allBlocksRead s p \\<and>\n      (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b))\n  \\<in> allBlocksRead s p \\<and>\n  (\\<forall>t\\<in>allBlocksRead s p.\n      bal t\n      \\<le> bal (SOME b.\n                    b \\<in> allBlocksRead s p \\<and>\n                    (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b)))", "have p51: \"\\<forall>br\\<in>allBlocksRead s p.   mbal br < mbal(dblock s' p) \n                                    \\<and> bal br \\<le> bal(dblock s' p)\"     \n    and a: \"IsMajority({d. hasRead s p d p})\" \n    and phase: \"phase s p = 0\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  (SOME b.\n      b \\<in> allBlocksRead s p \\<and>\n      (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b))\n  \\<in> allBlocksRead s p \\<and>\n  (\\<forall>t\\<in>allBlocksRead s p.\n      bal t\n      \\<le> bal (SOME b.\n                    b \\<in> allBlocksRead s p \\<and>\n                    (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b)))\n\ngoal (1 subgoal):\n 1. \\<forall>br\\<in>allBlocksRead s p.\n       mbal br < mbal (dblock s' p) \\<and>\n       bal br \\<le> bal (dblock s' p) &&&\n    IsMajority {d. hasRead s p d p} &&& phase s p = 0", "by(auto simp add: EndPhase0_def)+"], ["proof (state)\nthis:\n  \\<forall>br\\<in>allBlocksRead s p.\n     mbal br < mbal (dblock s' p) \\<and> bal br \\<le> bal (dblock s' p)\n  IsMajority {d. hasRead s p d p}\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D.\n          mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s d p) \\<le> bal (dblock s' p)", "from inv2c phase"], ["proof (chain)\npicking this:\n  Inv2c_inner s p\n  phase s p = 0", "have \"(\\<forall>d\\<in>{d. hasRead s p d p}. disk s d p \\<in> allBlocksRead s p)\""], ["proof (prove)\nusing this:\n  Inv2c_inner s p\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. \\<forall>d\\<in>{d. hasRead s p d p}. disk s d p \\<in> allBlocksRead s p", "by(auto dest: hasRead_allBlks)"], ["proof (state)\nthis:\n  \\<forall>d\\<in>{d. hasRead s p d p}. disk s d p \\<in> allBlocksRead s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D.\n          mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s d p) \\<le> bal (dblock s' p)", "with p51"], ["proof (chain)\npicking this:\n  \\<forall>br\\<in>allBlocksRead s p.\n     mbal br < mbal (dblock s' p) \\<and> bal br \\<le> bal (dblock s' p)\n  \\<forall>d\\<in>{d. hasRead s p d p}. disk s d p \\<in> allBlocksRead s p", "have \"(\\<forall>d\\<in>{d. hasRead s p d p}.   mbal(disk s d p) \\<le> mbal(dblock s' p) \n                                  \\<and> bal(disk s d p) \\<le> bal(dblock s' p))\""], ["proof (prove)\nusing this:\n  \\<forall>br\\<in>allBlocksRead s p.\n     mbal br < mbal (dblock s' p) \\<and> bal br \\<le> bal (dblock s' p)\n  \\<forall>d\\<in>{d. hasRead s p d p}. disk s d p \\<in> allBlocksRead s p\n\ngoal (1 subgoal):\n 1. \\<forall>d\\<in>{d. hasRead s p d p}.\n       mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n       bal (disk s d p) \\<le> bal (dblock s' p)", "by force"], ["proof (state)\nthis:\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D.\n          mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s d p) \\<le> bal (dblock s' p)", "with a"], ["proof (chain)\npicking this:\n  IsMajority {d. hasRead s p d p}\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s' p)", "show ?thesis"], ["proof (prove)\nusing this:\n  IsMajority {d. hasRead s p d p}\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n     bal (disk s d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D.\n          mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s d p) \\<le> bal (dblock s' p)", "by(auto simp add: MajoritySet_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D.\n        mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n        bal (disk s d p) \\<le> bal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Majority_exQ: \n  assumes asm1: \"\\<exists>D \\<in> MajoritySet. \\<forall>d\\<in>D. P d\"\n  shows \"\\<forall>D\\<in>MajoritySet.\\<exists>d\\<in>D. P d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet. \\<exists>d\\<in>D. P d", "using asm1"], ["proof (prove)\nusing this:\n  \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. P d\n\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet. \\<exists>d\\<in>D. P d", "proof(auto simp add: MajoritySet_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>D Da.\n       \\<lbrakk>IsMajority D; \\<forall>x\\<in>D. P x; IsMajority Da\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>Da. P x", "fix D1 D2"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>D Da.\n       \\<lbrakk>IsMajority D; \\<forall>x\\<in>D. P x; IsMajority Da\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>Da. P x", "assume D1: \"IsMajority D1\" and D2: \"IsMajority D2\"\n     and Px: \"\\<forall>x\\<in>D1. P x\""], ["proof (state)\nthis:\n  IsMajority D1\n  IsMajority D2\n  \\<forall>x\\<in>D1. P x\n\ngoal (1 subgoal):\n 1. \\<And>D Da.\n       \\<lbrakk>IsMajority D; \\<forall>x\\<in>D. P x; IsMajority Da\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>Da. P x", "from D1 D2 majorities_intersect"], ["proof (chain)\npicking this:\n  IsMajority D1\n  IsMajority D2\n  \\<forall>S T.\n     IsMajority S \\<and> IsMajority T \\<longrightarrow>\n     S \\<inter> T \\<noteq> {}", "have \"\\<exists>d\\<in>D1. d\\<in>D2\""], ["proof (prove)\nusing this:\n  IsMajority D1\n  IsMajority D2\n  \\<forall>S T.\n     IsMajority S \\<and> IsMajority T \\<longrightarrow>\n     S \\<inter> T \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<exists>d\\<in>D1. d \\<in> D2", "by auto"], ["proof (state)\nthis:\n  \\<exists>d\\<in>D1. d \\<in> D2\n\ngoal (1 subgoal):\n 1. \\<And>D Da.\n       \\<lbrakk>IsMajority D; \\<forall>x\\<in>D. P x; IsMajority Da\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>Da. P x", "with Px"], ["proof (chain)\npicking this:\n  \\<forall>x\\<in>D1. P x\n  \\<exists>d\\<in>D1. d \\<in> D2", "show \"\\<exists>x\\<in>D2. P x\""], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>D1. P x\n  \\<exists>d\\<in>D1. d \\<in> D2\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>D2. P x", "by auto"], ["proof (state)\nthis:\n  \\<exists>x\\<in>D2. P x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_HInv4a2_p:\n  assumes act: \"HEndPhase0 s s' p\"\n  and    inv1:  \"Inv1 s\"\n  and   inv2c: \"Inv2c_inner s p\"\n  shows \"HInv4a2 s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a2 s' p", "proof(simp add: HInv4a2_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet.\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "from act"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p", "have disk': \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n\ngoal (1 subgoal):\n 1. disk s' = disk s", "by(simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet.\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "from act inv1 inv2c"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  Inv1 s\n  Inv2c_inner s p", "have \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D.   mbal(disk s d p) \\<le> mbal(dblock s' p) \n                              \\<and> bal(disk s d p) \\<le> bal(dblock s' p)\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  Inv1 s\n  Inv2c_inner s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D.\n          mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s d p) \\<le> bal (dblock s' p)", "by(blast dest: HEndPhase0_41)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D.\n        mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n        bal (disk s d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet.\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "from Majority_exQ[OF this]"], ["proof (chain)\npicking this:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D.\n        mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n        bal (disk s d p) \\<le> bal (dblock s' p)", "have  \"\\<forall>D\\<in>MajoritySet. \\<exists>d\\<in>D.   mbal(disk s d p) \\<le> mbal(dblock s' p) \n                               \\<and> bal(disk s d p) \\<le> bal(dblock s' p)\" \n    (is \"?P (disk s)\")"], ["proof (prove)\nusing this:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D.\n        mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n        bal (disk s d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet.\n       \\<exists>d\\<in>D.\n          mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s d p) \\<le> bal (dblock s' p)", "."], ["proof (state)\nthis:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D.\n        mbal (disk s d p) \\<le> mbal (dblock s' p) \\<and>\n        bal (disk s d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet.\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "from ssubst[OF disk', of ?P, OF this]"], ["proof (chain)\npicking this:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D.\n        mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n        bal (disk s' d p) \\<le> bal (dblock s' p)", "show \"\\<forall>D\\<in>MajoritySet. \\<exists>d\\<in>D.  mbal (disk s' d p) \\<le> mbal (dblock s' p) \n                              \\<and> bal (disk s' d p) \\<le> bal (dblock s' p)\""], ["proof (prove)\nusing this:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D.\n        mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n        bal (disk s' d p) \\<le> bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet.\n       \\<exists>d\\<in>D.\n          mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n          bal (disk s' d p) \\<le> bal (dblock s' p)", "."], ["proof (state)\nthis:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D.\n        mbal (disk s' d p) \\<le> mbal (dblock s' p) \\<and>\n        bal (disk s' d p) \\<le> bal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_HInv4a_p:\n  assumes act: \"HEndPhase0 s s' p\"\n  and   inv2a: \"Inv2a s\"\n  and   inv2: \"Inv2c s\"\n  and   inv4d: \"HInv4d s p\"\n  and   inv1: \"Inv1 s\"\n  and inv: \"HInv4a s p\"\n  shows \"HInv4a s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' p", "from inv2"], ["proof (chain)\npicking this:\n  Inv2c s", "have inv2c: \"Inv2c_inner s p\""], ["proof (prove)\nusing this:\n  Inv2c s\n\ngoal (1 subgoal):\n 1. Inv2c_inner s p", "by(auto simp add: Inv2c_def)"], ["proof (state)\nthis:\n  Inv2c_inner s p\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "with inv1 inv2a act"], ["proof (chain)\npicking this:\n  Inv1 s\n  Inv2a s\n  HEndPhase0 s s' p\n  Inv2c_inner s p", "have inv2a': \"Inv2a s'\""], ["proof (prove)\nusing this:\n  Inv1 s\n  Inv2a s\n  HEndPhase0 s s' p\n  Inv2c_inner s p\n\ngoal (1 subgoal):\n 1. Inv2a s'", "by(blast dest: HEndPhase0_Inv2a)"], ["proof (state)\nthis:\n  Inv2a s'\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "from act"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p", "have \"phase s' p = 1\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n\ngoal (1 subgoal):\n 1. phase s' p = 1", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  phase s' p = 1\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "with act inv inv2c inv4d inv2a' inv1"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  HInv4a s p\n  Inv2c_inner s p\n  HInv4d s p\n  Inv2a s'\n  Inv1 s\n  phase s' p = 1", "show ?thesis"], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  HInv4a s p\n  Inv2c_inner s p\n  HInv4d s p\n  Inv2a s'\n  Inv1 s\n  phase s' p = 1\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "by(auto simp  add: HInv4a_def simp del: HEndPhase0_def\n          elim: HEndPhase0_HInv4a1_p HEndPhase0_HInv4a2_p)"], ["proof (state)\nthis:\n  HInv4a s' p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_HInv4a_q:\n  assumes act: \"HEndPhase0 s s' p\"\n  and inv: \"HInv4a s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4a s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  p \\<noteq> q", "have \"dblock s' q = dblock s q \\<and> disk s' = disk s\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. dblock s' q = dblock s q \\<and> disk s' = disk s", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "moreover"], ["proof (state)\nthis:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  p \\<noteq> q", "have \"\\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d", "by(auto simp add: EndPhase0_def InitializePhase_def rdBy_def)"], ["proof (state)\nthis:\n  \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "hence \"(UN p d. rdBy s' q p d) \\<subseteq> (UN p d. rdBy s q p d)\""], ["proof (prove)\nusing this:\n  \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\n\ngoal (1 subgoal):\n 1. (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n    \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))", "by(auto, blast)"], ["proof (state)\nthis:\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "ultimately"], ["proof (chain)\npicking this:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: blocksOf_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "with act inv pnq"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  HInv4a s q\n  p \\<noteq> q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  HInv4a s q\n  p \\<noteq> q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4a s' q", "by(auto simp add: EndPhase0_def HInv4a_def HInv4a1_def HInv4a2_def)"], ["proof (state)\nthis:\n  HInv4a s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase0_HInv4a:\n  \"\\<lbrakk> HEndPhase0 s s' p; HInv4a s q; HInv4d s p;\n     Inv2a s;  Inv1 s;   Inv2a s; Inv2c s\\<rbrakk> \n  \\<Longrightarrow> HInv4a s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase0 s s' p; HInv4a s q; HInv4d s p; Inv2a s; Inv1 s;\n     Inv2a s; Inv2c s\\<rbrakk>\n    \\<Longrightarrow> HInv4a s' q", "by(blast dest: HEndPhase0_HInv4a_p HEndPhase0_HInv4a_q)"], ["", "subsubsection \\<open>Proofs of Invariant 4b\\<close>"], ["", "lemma blocksRead_allBlocksRead: \n  \"rb \\<in> blocksRead s p d \\<Longrightarrow> block rb \\<in> allBlocksRead s p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rb \\<in> blocksRead s p d \\<Longrightarrow>\n    block rb \\<in> allBlocksRead s p", "by(auto simp add: allBlocksRead_def allRdBlks_def)"], ["", "lemma HEndPhase0_dblock_mbal:\n  \"\\<lbrakk> HEndPhase0 s  s' p \\<rbrakk> \n     \\<Longrightarrow> \\<forall>br\\<in>allBlocksRead s p. mbal br < mbal(dblock s' p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HEndPhase0 s s' p \\<Longrightarrow>\n    \\<forall>br\\<in>allBlocksRead s p. mbal br < mbal (dblock s' p)", "by(auto simp add: EndPhase0_def)"], ["", "lemma HEndPhase0_HInv4b_p_dblock:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv1:  \"Inv1 s\" \n  and inv2a: \"Inv2a s\"\n  and inv2c: \"Inv2c_inner s p\"\n  shows \"bal(dblock s' p) < mbal(dblock s' p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "from act"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p", "have \"phase s p = 0\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n\ngoal (1 subgoal):\n 1. phase s p = 0", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "with inv2c"], ["proof (chain)\npicking this:\n  Inv2c_inner s p\n  phase s p = 0", "have \"\\<forall>d.\\<forall>br\\<in>blocksRead s p d. proc br = p \\<and> block br = disk s d p\""], ["proof (prove)\nusing this:\n  Inv2c_inner s p\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. \\<forall>d.\n       \\<forall>br\\<in>blocksRead s p d.\n          proc br = p \\<and> block br = disk s d p", "by(auto simp add: Inv2c_inner_def)"], ["proof (state)\nthis:\n  \\<forall>d.\n     \\<forall>br\\<in>blocksRead s p d.\n        proc br = p \\<and> block br = disk s d p\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "hence allBlks_in_blocksOf: \"allBlocksRead s p \\<subseteq> blocksOf s p\""], ["proof (prove)\nusing this:\n  \\<forall>d.\n     \\<forall>br\\<in>blocksRead s p d.\n        proc br = p \\<and> block br = disk s d p\n\ngoal (1 subgoal):\n 1. allBlocksRead s p \\<subseteq> blocksOf s p", "by(auto simp add: allBlocksRead_def allRdBlks_def blocksOf_def)"], ["proof (state)\nthis:\n  allBlocksRead s p \\<subseteq> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "from act HEndPhase0_some[OF act inv1]"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  (SOME b.\n      b \\<in> allBlocksRead s p \\<and>\n      (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b))\n  \\<in> allBlocksRead s p \\<and>\n  (\\<forall>t\\<in>allBlocksRead s p.\n      bal t\n      \\<le> bal (SOME b.\n                    b \\<in> allBlocksRead s p \\<and>\n                    (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b)))", "have p53: \"\\<exists>br\\<in>allBlocksRead s p. bal(dblock s' p)=bal br\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  (SOME b.\n      b \\<in> allBlocksRead s p \\<and>\n      (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b))\n  \\<in> allBlocksRead s p \\<and>\n  (\\<forall>t\\<in>allBlocksRead s p.\n      bal t\n      \\<le> bal (SOME b.\n                    b \\<in> allBlocksRead s p \\<and>\n                    (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b)))\n\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal (dblock s' p) = bal br", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  \\<exists>br\\<in>allBlocksRead s p. bal (dblock s' p) = bal br\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "from inv2a"], ["proof (chain)\npicking this:\n  Inv2a s", "have i2: \"\\<forall>p. \\<forall>bk\\<in>blocksOf s p. bal bk \\<le> mbal bk\""], ["proof (prove)\nusing this:\n  Inv2a s\n\ngoal (1 subgoal):\n 1. \\<forall>p. \\<forall>bk\\<in>blocksOf s p. bal bk \\<le> mbal bk", "by(auto simp add: Inv2a_def Inv2a_inner_def Inv2a_innermost_def)"], ["proof (state)\nthis:\n  \\<forall>p. \\<forall>bk\\<in>blocksOf s p. bal bk \\<le> mbal bk\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "with allBlks_in_blocksOf"], ["proof (chain)\npicking this:\n  allBlocksRead s p \\<subseteq> blocksOf s p\n  \\<forall>p. \\<forall>bk\\<in>blocksOf s p. bal bk \\<le> mbal bk", "have \"\\<forall>bk\\<in>allBlocksRead s p. bal bk \\<le> mbal bk\""], ["proof (prove)\nusing this:\n  allBlocksRead s p \\<subseteq> blocksOf s p\n  \\<forall>p. \\<forall>bk\\<in>blocksOf s p. bal bk \\<le> mbal bk\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>allBlocksRead s p. bal bk \\<le> mbal bk", "by auto"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>allBlocksRead s p. bal bk \\<le> mbal bk\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "with p53"], ["proof (chain)\npicking this:\n  \\<exists>br\\<in>allBlocksRead s p. bal (dblock s' p) = bal br\n  \\<forall>bk\\<in>allBlocksRead s p. bal bk \\<le> mbal bk", "have \"\\<exists>br\\<in>allBlocksRead s p. bal(dblock s' p)\\<le> mbal br\""], ["proof (prove)\nusing this:\n  \\<exists>br\\<in>allBlocksRead s p. bal (dblock s' p) = bal br\n  \\<forall>bk\\<in>allBlocksRead s p. bal bk \\<le> mbal bk\n\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal (dblock s' p) \\<le> mbal br", "by force"], ["proof (state)\nthis:\n  \\<exists>br\\<in>allBlocksRead s p. bal (dblock s' p) \\<le> mbal br\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "with HEndPhase0_dblock_mbal[OF act]"], ["proof (chain)\npicking this:\n  \\<forall>br\\<in>allBlocksRead s p. mbal br < mbal (dblock s' p)\n  \\<exists>br\\<in>allBlocksRead s p. bal (dblock s' p) \\<le> mbal br", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>br\\<in>allBlocksRead s p. mbal br < mbal (dblock s' p)\n  \\<exists>br\\<in>allBlocksRead s p. bal (dblock s' p) \\<le> mbal br\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) < mbal (dblock s' p)", "by auto"], ["proof (state)\nthis:\n  bal (dblock s' p) < mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_HInv4b_p_blocksOf:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv4d: \"HInv4d s p\"\n  and inv2c: \"Inv2c_inner s p\"\n  and bk: \"bk \\<in> blocksOf s p\"\n  shows \"bal bk < mbal(dblock s' p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "from inv4d  majorities_intersect bk"], ["proof (chain)\npicking this:\n  HInv4d s p\n  \\<forall>S T.\n     IsMajority S \\<and> IsMajority T \\<longrightarrow>\n     S \\<inter> T \\<noteq> {}\n  bk \\<in> blocksOf s p", "have p43: \"\\<forall>D\\<in>MajoritySet.\\<exists>d\\<in>D. bal bk \\<le> mbal(disk s d p)\""], ["proof (prove)\nusing this:\n  HInv4d s p\n  \\<forall>S T.\n     IsMajority S \\<and> IsMajority T \\<longrightarrow>\n     S \\<inter> T \\<noteq> {}\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<forall>D\\<in>MajoritySet.\n       \\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def MajoritySet_def Majority_exQ)"], ["proof (state)\nthis:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "have \"\\<exists>br \\<in> allBlocksRead s p. bal bk \\<le> mbal br\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br", "from act"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p", "have maj: \"IsMajority({d. hasRead s p d p})\" (is \"IsMajority(?D)\")\n     and phase: \"phase s p = 0\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n\ngoal (1 subgoal):\n 1. IsMajority {d. hasRead s p d p} &&& phase s p = 0", "by(simp add: EndPhase0_def)+"], ["proof (state)\nthis:\n  IsMajority {d. hasRead s p d p}\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br", "have br_ne: \"\\<forall>d\\<in>?D. blocksRead s p d \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>d\\<in>{d. hasRead s p d p}. blocksRead s p d \\<noteq> {}", "by(auto simp add: hasRead_def)"], ["proof (state)\nthis:\n  \\<forall>d\\<in>{d. hasRead s p d p}. blocksRead s p d \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br", "from phase inv2c"], ["proof (chain)\npicking this:\n  phase s p = 0\n  Inv2c_inner s p", "have \"\\<forall>d\\<in>?D.\\<forall>br\\<in>blocksRead s p d. block br = disk s d p\""], ["proof (prove)\nusing this:\n  phase s p = 0\n  Inv2c_inner s p\n\ngoal (1 subgoal):\n 1. \\<forall>d\\<in>{d. hasRead s p d p}.\n       \\<forall>br\\<in>blocksRead s p d. block br = disk s d p", "by(auto simp add: Inv2c_inner_def)"], ["proof (state)\nthis:\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     \\<forall>br\\<in>blocksRead s p d. block br = disk s d p\n\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br", "with br_ne"], ["proof (chain)\npicking this:\n  \\<forall>d\\<in>{d. hasRead s p d p}. blocksRead s p d \\<noteq> {}\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     \\<forall>br\\<in>blocksRead s p d. block br = disk s d p", "have \"\\<forall>d\\<in>?D. \\<exists>br\\<in> allBlocksRead s p. br = disk s d p\""], ["proof (prove)\nusing this:\n  \\<forall>d\\<in>{d. hasRead s p d p}. blocksRead s p d \\<noteq> {}\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     \\<forall>br\\<in>blocksRead s p d. block br = disk s d p\n\ngoal (1 subgoal):\n 1. \\<forall>d\\<in>{d. hasRead s p d p}.\n       \\<exists>br\\<in>allBlocksRead s p. br = disk s d p", "by(blast dest: blocksRead_allBlocksRead)"], ["proof (state)\nthis:\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     \\<exists>br\\<in>allBlocksRead s p. br = disk s d p\n\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br", "with p43 maj"], ["proof (chain)\npicking this:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n  IsMajority {d. hasRead s p d p}\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     \\<exists>br\\<in>allBlocksRead s p. br = disk s d p", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>D\\<in>MajoritySet.\n     \\<exists>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n  IsMajority {d. hasRead s p d p}\n  \\<forall>d\\<in>{d. hasRead s p d p}.\n     \\<exists>br\\<in>allBlocksRead s p. br = disk s d p\n\ngoal (1 subgoal):\n 1. \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br", "by(auto simp add: MajoritySet_def)"], ["proof (state)\nthis:\n  \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "with HEndPhase0_dblock_mbal[OF act]"], ["proof (chain)\npicking this:\n  \\<forall>br\\<in>allBlocksRead s p. mbal br < mbal (dblock s' p)\n  \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>br\\<in>allBlocksRead s p. mbal br < mbal (dblock s' p)\n  \\<exists>br\\<in>allBlocksRead s p. bal bk \\<le> mbal br\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "by auto"], ["proof (state)\nthis:\n  bal bk < mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_HInv4b_p:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv4d: \"HInv4d s p\"\n  and inv1:  \"Inv1 s\" \n  and inv2a: \"Inv2a s\"\n  and inv2c: \"Inv2c_inner s p\"\n  shows \"HInv4b s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' p", "proof(clarsimp simp add: HInv4b_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "from act"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p", "have  phase: \"phase s p = 0\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n\ngoal (1 subgoal):\n 1. phase s p = 0", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  phase s p = 0\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "assume bk: \"bk\\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "with HEndPhase0_blocksOf[OF act]"], ["proof (chain)\npicking this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n  bk \\<in> blocksOf s' p", "have \"bk\\<in>{dblock s' p} \\<or> bk\\<in>blocksOf s p\""], ["proof (prove)\nusing this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<or> bk \\<in> blocksOf s p", "by blast"], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p} \\<or> bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "thus \"bal bk < mbal (dblock s' p)\""], ["proof (prove)\nusing this:\n  bk \\<in> {dblock s' p} \\<or> bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk < mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "assume bk: \"bk\\<in>{dblock s' p}\""], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p}\n\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk < mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "with act inv1 inv2a inv2c"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  Inv1 s\n  Inv2a s\n  Inv2c_inner s p\n  bk \\<in> {dblock s' p}", "show ?thesis"], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  Inv1 s\n  Inv2a s\n  Inv2c_inner s p\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "by(auto simp del: HEndPhase0_def \n                  dest: HEndPhase0_HInv4b_p_dblock )"], ["proof (state)\nthis:\n  bal bk < mbal (dblock s' p)\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "assume bk: \"bk \\<in> blocksOf s p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "with act inv2c inv4d"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  Inv2c_inner s p\n  HInv4d s p\n  bk \\<in> blocksOf s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  Inv2c_inner s p\n  HInv4d s p\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "by(blast dest: HEndPhase0_HInv4b_p_blocksOf)"], ["proof (state)\nthis:\n  bal bk < mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  bal bk < mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_HInv4b_q:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\"\n   and phase': \"phase s' q =phase s q\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q &&& phase s' q = phase s q", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  phase s' q = phase s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: EndPhase0_def InitializePhase_def allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with disk' dblock'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: allRdBlks_def blocksOf_def rdBy_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with inv phase' dblock'"], ["proof (chain)\npicking this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(auto simp add: HInv4b_def)"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase0_HInv4b:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv: \"HInv4b s q\"\n  and inv4d: \"HInv4d s p\"\n  and inv1: \"Inv1 s\"\n  and inv2a: \"Inv2a s\" \n  and inv2c: \"Inv2c_inner s p\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof(cases \"p=q\")"], ["proof (state)\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case True"], ["proof (state)\nthis:\n  p = q\n\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "with HEndPhase0_HInv4b_p[OF act inv4d inv1 inv2a inv2c]"], ["proof (chain)\npicking this:\n  HInv4b s' p\n  p = q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' p\n  p = q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by simp"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case False"], ["proof (state)\nthis:\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "from HEndPhase0_HInv4b_q[OF act False inv]"], ["proof (chain)\npicking this:\n  HInv4b s' q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "."], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HStartBallot_HInv4b_p:\n  assumes act: \"HStartBallot s  s' p\"\n  and inv2a: \"Inv2a_innermost s p (dblock s p)\"\n  and inv4b: \"HInv4b s p\"\n  and inv4a: \"HInv4a s p\"\n  shows \"HInv4b s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' p", "proof(clarsimp simp add: HInv4b_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "from act"], ["proof (chain)\npicking this:\n  HStartBallot s s' p", "have phase': \"phase s' p = 1\"\n    and phase: \"phase s p \\<in> {1,2}\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n\ngoal (1 subgoal):\n 1. phase s' p = 1 &&& phase s p \\<in> {1, 2}", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  phase s' p = 1\n  phase s p \\<in> {1, 2}\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "from act"], ["proof (chain)\npicking this:\n  HStartBallot s s' p", "have p42: \"  mbal (dblock s p)< mbal (dblock s' p)\n        \\<and> bal(dblock s p) = bal(dblock s' p)\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n\ngoal (1 subgoal):\n 1. mbal (dblock s p) < mbal (dblock s' p) \\<and>\n    bal (dblock s p) = bal (dblock s' p)", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  mbal (dblock s p) < mbal (dblock s' p) \\<and>\n  bal (dblock s p) = bal (dblock s' p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "from HStartBallot_blocksOf[OF act] bk"], ["proof (chain)\npicking this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n  bk \\<in> blocksOf s' p", "have \"bk \\<in> {dblock s' p} \\<union> blocksOf s p\""], ["proof (prove)\nusing this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q \\<union> {dblock s' ?q}\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<union> blocksOf s p", "by blast"], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       \\<lbrakk>phase s' p = Suc 0; bk \\<in> blocksOf s' p\\<rbrakk>\n       \\<Longrightarrow> bal bk < mbal (dblock s' p)", "thus \"bal bk < mbal (dblock s' p)\""], ["proof (prove)\nusing this:\n  bk \\<in> {dblock s' p} \\<union> blocksOf s p\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk < mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "assume bk: \"bk \\<in> {dblock s' p}\""], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p}\n\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk < mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "from inv2a"], ["proof (chain)\npicking this:\n  Inv2a_innermost s p (dblock s p)", "have \"bal (dblock s p) \\<le> mbal (dblock s p)\""], ["proof (prove)\nusing this:\n  Inv2a_innermost s p (dblock s p)\n\ngoal (1 subgoal):\n 1. bal (dblock s p) \\<le> mbal (dblock s p)", "by(auto simp add: Inv2a_innermost_def)"], ["proof (state)\nthis:\n  bal (dblock s p) \\<le> mbal (dblock s p)\n\ngoal (2 subgoals):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow> bal bk < mbal (dblock s' p)\n 2. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "with p42 bk"], ["proof (chain)\npicking this:\n  mbal (dblock s p) < mbal (dblock s' p) \\<and>\n  bal (dblock s p) = bal (dblock s' p)\n  bk \\<in> {dblock s' p}\n  bal (dblock s p) \\<le> mbal (dblock s p)", "show ?thesis"], ["proof (prove)\nusing this:\n  mbal (dblock s p) < mbal (dblock s' p) \\<and>\n  bal (dblock s p) = bal (dblock s' p)\n  bk \\<in> {dblock s' p}\n  bal (dblock s p) \\<le> mbal (dblock s p)\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "by auto"], ["proof (state)\nthis:\n  bal bk < mbal (dblock s' p)\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "assume bk: \"bk \\<in> blocksOf s p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "from phase inv4a"], ["proof (chain)\npicking this:\n  phase s p \\<in> {1, 2}\n  HInv4a s p", "have p41: \"HInv4a1 s p\""], ["proof (prove)\nusing this:\n  phase s p \\<in> {1, 2}\n  HInv4a s p\n\ngoal (1 subgoal):\n 1. HInv4a1 s p", "by(auto simp add: HInv4a_def)"], ["proof (state)\nthis:\n  HInv4a1 s p\n\ngoal (1 subgoal):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow> bal bk < mbal (dblock s' p)", "with p42 bk"], ["proof (chain)\npicking this:\n  mbal (dblock s p) < mbal (dblock s' p) \\<and>\n  bal (dblock s p) = bal (dblock s' p)\n  bk \\<in> blocksOf s p\n  HInv4a1 s p", "show ?thesis"], ["proof (prove)\nusing this:\n  mbal (dblock s p) < mbal (dblock s' p) \\<and>\n  bal (dblock s p) = bal (dblock s' p)\n  bk \\<in> blocksOf s p\n  HInv4a1 s p\n\ngoal (1 subgoal):\n 1. bal bk < mbal (dblock s' p)", "by(auto simp add: HInv4a1_def)"], ["proof (state)\nthis:\n  bal bk < mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  bal bk < mbal (dblock s' p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HStartBallot_HInv4b_q:\n  assumes act: \"HStartBallot s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\"\n   and phase': \"phase s' q =phase s q\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q &&& phase s' q = phase s q", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  phase s' q = phase s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: StartBallot_def InitializePhase_def allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with disk' dblock'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: allRdBlks_def blocksOf_def rdBy_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with inv phase' dblock'"], ["proof (chain)\npicking this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(auto simp add: HInv4b_def)"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HStartBallot_HInv4b:\n  assumes act: \"HStartBallot s  s' p\"\n  and inv2a: \"Inv2a s\"\n  and inv4b: \"HInv4b s q\"\n  and inv4a: \"HInv4a s p\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "using act inv2a inv4b inv4a"], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  Inv2a s\n  HInv4b s q\n  HInv4a s p\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof (cases \"p=q\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p = q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q\n 2. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p \\<noteq> q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q", "case True"], ["proof (state)\nthis:\n  p = q\n\ngoal (2 subgoals):\n 1. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p = q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q\n 2. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p \\<noteq> q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q", "from inv2a"], ["proof (chain)\npicking this:\n  Inv2a s", "have \"Inv2a_innermost s p (dblock s p)\""], ["proof (prove)\nusing this:\n  Inv2a s\n\ngoal (1 subgoal):\n 1. Inv2a_innermost s p (dblock s p)", "by(auto simp add: Inv2a_def Inv2a_inner_def blocksOf_def)"], ["proof (state)\nthis:\n  Inv2a_innermost s p (dblock s p)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p = q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q\n 2. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p \\<noteq> q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q", "with act True inv4b inv4a"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  p = q\n  HInv4b s q\n  HInv4a s p\n  Inv2a_innermost s p (dblock s p)", "show ?thesis"], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  p = q\n  HInv4b s q\n  HInv4a s p\n  Inv2a_innermost s p (dblock s p)\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(blast dest: HStartBallot_HInv4b_p)"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p \\<noteq> q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p \\<noteq> q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q", "case False"], ["proof (state)\nthis:\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>HStartBallot s s' p; Inv2a s; HInv4b s q; HInv4a s p;\n     p \\<noteq> q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q", "with act inv4b"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  HInv4b s q\n  p \\<noteq> q", "show ?thesis"], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  HInv4b s q\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(blast dest: HStartBallot_HInv4b_q)"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase1or2Write_HInv4b:\n  \"\\<lbrakk> HPhase1or2Write s s' p d; HInv4b s q \\<rbrakk> \\<Longrightarrow> HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2Write s s' p d; HInv4b s q\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' q", "by(auto simp add: Phase1or2Write_def HInv4b_def \n                    blocksOf_def rdBy_def)"], ["", "lemma HPhase1or2ReadThen_HInv4b_p:\n  assumes act: \"HPhase1or2ReadThen s s' p d q\"\n  and inv: \"HInv4b s p\"\n  shows \"HInv4b s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4b s' p", "from HPhase1or2ReadThen_blocksOf[OF act] inv act"], ["proof (chain)\npicking this:\n  blocksOf s' ?r \\<subseteq> blocksOf s ?r\n  HInv4b s p\n  HPhase1or2ReadThen s s' p d q", "show ?thesis"], ["proof (prove)\nusing this:\n  blocksOf s' ?r \\<subseteq> blocksOf s ?r\n  HInv4b s p\n  HPhase1or2ReadThen s s' p d q\n\ngoal (1 subgoal):\n 1. HInv4b s' p", "by(auto simp add: HInv4b_def Phase1or2ReadThen_def)"], ["proof (state)\nthis:\n  HInv4b s' p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HPhase1or2ReadThen_HInv4b_q:\n  assumes act: \"HPhase1or2ReadThen s s' p d r\"\n  and inv: \"HInv4b s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "using assms HPhase1or2ReadThen_blocksOf[OF act]"], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d r\n  HInv4b s q\n  p \\<noteq> q\n  blocksOf s' ?r \\<subseteq> blocksOf s ?r\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(auto simp add: Phase1or2ReadThen_def HInv4b_def)"], ["", "theorem HPhase1or2ReadThen_HInv4b:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d q; HInv4b s r\\<rbrakk> \\<Longrightarrow> HInv4b s' r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadThen s s' p d q; HInv4b s r\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' r", "by(blast dest: HPhase1or2ReadThen_HInv4b_p \n                 HPhase1or2ReadThen_HInv4b_q)"], ["", "theorem HPhase1or2ReadElse_HInv4b:\n  \"\\<lbrakk> HPhase1or2ReadElse s s' p d q; HInv4b s r;\n     Inv2a s; HInv4a s p \\<rbrakk>\n  \\<Longrightarrow> HInv4b s' r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadElse s s' p d q; HInv4b s r; Inv2a s;\n     HInv4a s p\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' r", "using HStartBallot_HInv4b"], ["proof (prove)\nusing this:\n  \\<lbrakk>HStartBallot ?s ?s' ?p; Inv2a ?s; HInv4b ?s ?q;\n   HInv4a ?s ?p\\<rbrakk>\n  \\<Longrightarrow> HInv4b ?s' ?q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadElse s s' p d q; HInv4b s r; Inv2a s;\n     HInv4a s p\\<rbrakk>\n    \\<Longrightarrow> HInv4b s' r", "by(auto simp add: Phase1or2ReadElse_def)"], ["", "lemma HEndPhase1_HInv4b_p:\n  \"HEndPhase1 s s' p \\<Longrightarrow> HInv4b s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HEndPhase1 s s' p \\<Longrightarrow> HInv4b s' p", "by(auto simp add: EndPhase1_def HInv4b_def)"], ["", "lemma HEndPhase1_HInv4b_q:\n  assumes act: \"HEndPhase1 s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\"\n   and phase': \"phase s' q =phase s q\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q &&& phase s' q = phase s q", "by(auto simp add: EndPhase1_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  phase s' q = phase s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: EndPhase1_def InitializePhase_def allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with disk' dblock'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: allRdBlks_def blocksOf_def rdBy_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with inv phase' dblock'"], ["proof (chain)\npicking this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(auto simp add: HInv4b_def)"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase1_HInv4b:\n  assumes act: \"HEndPhase1 s  s' p\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof(cases \"p=q\")"], ["proof (state)\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case True"], ["proof (state)\nthis:\n  p = q\n\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "with HEndPhase1_HInv4b_p[OF act]"], ["proof (chain)\npicking this:\n  HInv4b s' p\n  p = q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' p\n  p = q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by simp"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case False"], ["proof (state)\nthis:\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "from HEndPhase1_HInv4b_q[OF act False inv]"], ["proof (chain)\npicking this:\n  HInv4b s' q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "."], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase2_HInv4b_p:\n  \"HEndPhase2 s s' p \\<Longrightarrow> HInv4b s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HEndPhase2 s s' p \\<Longrightarrow> HInv4b s' p", "by(auto simp add: EndPhase2_def HInv4b_def)"], ["", "lemma HEndPhase2_HInv4b_q:\n  assumes act: \"HEndPhase2 s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase2 s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\"\n   and phase': \"phase s' q =phase s q\""], ["proof (prove)\nusing this:\n  HEndPhase2 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q &&& phase s' q = phase s q", "by(auto simp add: EndPhase2_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  phase s' q = phase s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase2 s s' p\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HEndPhase2 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: EndPhase2_def InitializePhase_def allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with disk' dblock'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: allRdBlks_def blocksOf_def rdBy_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with inv phase' dblock'"], ["proof (chain)\npicking this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(auto simp add: HInv4b_def)"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase2_HInv4b:\n  assumes act: \"HEndPhase2 s  s' p\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof(cases \"p=q\")"], ["proof (state)\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case True"], ["proof (state)\nthis:\n  p = q\n\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "with HEndPhase2_HInv4b_p[OF act]"], ["proof (chain)\npicking this:\n  HInv4b s' p\n  p = q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' p\n  p = q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by simp"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case False"], ["proof (state)\nthis:\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "from HEndPhase2_HInv4b_q[OF act False inv]"], ["proof (chain)\npicking this:\n  HInv4b s' q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "."], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HFail_HInv4b_p:\n  \"HFail s s' p \\<Longrightarrow> HInv4b s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HFail s s' p \\<Longrightarrow> HInv4b s' p", "by(auto simp add: Fail_def HInv4b_def)"], ["", "lemma HFail_HInv4b_q:\n  assumes act: \"HFail s  s' p\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HFail s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\"\n   and phase': \"phase s' q =phase s q\""], ["proof (prove)\nusing this:\n  HFail s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q &&& phase s' q = phase s q", "by(auto simp add: Fail_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  phase s' q = phase s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HFail s s' p\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HFail s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: Fail_def InitializePhase_def allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with disk' dblock'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: allRdBlks_def blocksOf_def rdBy_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "with inv phase' dblock'"], ["proof (chain)\npicking this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(auto simp add: HInv4b_def)"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HFail_HInv4b:\n  assumes act: \"HFail s  s' p\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof(cases \"p=q\")"], ["proof (state)\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case True"], ["proof (state)\nthis:\n  p = q\n\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "with HFail_HInv4b_p[OF act]"], ["proof (chain)\npicking this:\n  HInv4b s' p\n  p = q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' p\n  p = q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by simp"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case False"], ["proof (state)\nthis:\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "from HFail_HInv4b_q[OF act False inv]"], ["proof (chain)\npicking this:\n  HInv4b s' q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "."], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HPhase0Read_HInv4b_p:\n  \"HPhase0Read s s' p d \\<Longrightarrow> HInv4b s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HPhase0Read s s' p d \\<Longrightarrow> HInv4b s' p", "by(auto simp add: Phase0Read_def HInv4b_def)"], ["", "lemma HPhase0Read_HInv4b_q:\n  assumes act: \"HPhase0Read s  s' p d\"\n  and pnq: \"p\\<noteq>q\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4b s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase0Read s s' p d\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\"\n   and phase': \"phase s' q =phase s q\""], ["proof (prove)\nusing this:\n  HPhase0Read s s' p d\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q &&& phase s' q = phase s q", "by(auto simp add: Phase0Read_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  phase s' q = phase s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "from HPhase0Read_blocksOf[OF act] inv phase' dblock'"], ["proof (chain)\npicking this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q", "show ?thesis"], ["proof (prove)\nusing this:\n  blocksOf s' ?q \\<subseteq> blocksOf s ?q\n  HInv4b s q\n  phase s' q = phase s q\n  dblock s' q = dblock s q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by(auto simp add: HInv4b_def)"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase0Read_HInv4b:\n  assumes act: \"HPhase0Read s  s' p d\"\n  and inv: \"HInv4b s q\"\n  shows \"HInv4b s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' q", "proof(cases \"p=q\")"], ["proof (state)\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case True"], ["proof (state)\nthis:\n  p = q\n\ngoal (2 subgoals):\n 1. p = q \\<Longrightarrow> HInv4b s' q\n 2. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "with HPhase0Read_HInv4b_p[OF act]"], ["proof (chain)\npicking this:\n  HInv4b s' p\n  p = q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' p\n  p = q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "by simp"], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "case False"], ["proof (state)\nthis:\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. p \\<noteq> q \\<Longrightarrow> HInv4b s' q", "from HPhase0Read_HInv4b_q[OF act False inv]"], ["proof (chain)\npicking this:\n  HInv4b s' q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4b s' q\n\ngoal (1 subgoal):\n 1. HInv4b s' q", "."], ["proof (state)\nthis:\n  HInv4b s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Proofs of Invariant 4c\\<close>"], ["", "lemma  HStartBallot_HInv4c_p:\n  \"\\<lbrakk> HStartBallot s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HStartBallot s s' p; HInv4c s p\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' p", "by(auto simp add: StartBallot_def HInv4c_def)"], ["", "lemma  HStartBallot_HInv4c_q:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  p \\<noteq> q", "have phase: \"phase s' q = phase s q\"\n   and dblock: \"dblock s q = dblock s' q\"\n   and disk: \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. phase s' q = phase s q &&& dblock s q = dblock s' q &&& disk s' = disk s", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "with inv"], ["proof (chain)\npicking this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "by(auto simp add: HInv4c_def)"], ["proof (state)\nthis:\n  HInv4c s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HStartBallot_HInv4c:\n  \"\\<lbrakk> HStartBallot s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HStartBallot s s' p; HInv4c s q\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "by(blast dest: HStartBallot_HInv4c_p HStartBallot_HInv4c_q)"], ["", "lemma  HPhase1or2Write_HInv4c_p:\n  assumes act: \"HPhase1or2Write s s' p d\" \n      and inv: \"HInv4c s p\" \n    and inv2c: \"Inv2c s\"\n  shows \"HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' p", "proof(cases \"phase s' p = 2\")"], ["proof (state)\ngoal (2 subgoals):\n 1. phase s' p = 2 \\<Longrightarrow> HInv4c s' p\n 2. phase s' p \\<noteq> 2 \\<Longrightarrow> HInv4c s' p", "assume phase': \"phase s' p = 2\""], ["proof (state)\nthis:\n  phase s' p = 2\n\ngoal (2 subgoals):\n 1. phase s' p = 2 \\<Longrightarrow> HInv4c s' p\n 2. phase s' p \\<noteq> 2 \\<Longrightarrow> HInv4c s' p", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' p", "proof(auto simp add: HInv4c_def phase' MajoritySet_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>D.\n       IsMajority D \\<and>\n       (\\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p))", "from act phase'"], ["proof (chain)\npicking this:\n  HPhase1or2Write s s' p d\n  phase s' p = 2", "have bal: \"bal(dblock s' p)=bal(dblock s p)\"\n      and phase: \"phase s p = 2\""], ["proof (prove)\nusing this:\n  HPhase1or2Write s s' p d\n  phase s' p = 2\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) = bal (dblock s p) &&& phase s p = 2", "by(auto simp add: Phase1or2Write_def)"], ["proof (state)\nthis:\n  bal (dblock s' p) = bal (dblock s p)\n  phase s p = 2\n\ngoal (1 subgoal):\n 1. \\<exists>D.\n       IsMajority D \\<and>\n       (\\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p))", "from phase' inv2c act"], ["proof (chain)\npicking this:\n  phase s' p = 2\n  Inv2c s\n  HPhase1or2Write s s' p d", "have \"mbal(disk s' d p)=bal(dblock s p)\""], ["proof (prove)\nusing this:\n  phase s' p = 2\n  Inv2c s\n  HPhase1or2Write s s' p d\n\ngoal (1 subgoal):\n 1. mbal (disk s' d p) = bal (dblock s p)", "by(auto simp add: Phase1or2Write_def Inv2c_def Inv2c_inner_def)"], ["proof (state)\nthis:\n  mbal (disk s' d p) = bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<exists>D.\n       IsMajority D \\<and>\n       (\\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p))", "with bal"], ["proof (chain)\npicking this:\n  bal (dblock s' p) = bal (dblock s p)\n  mbal (disk s' d p) = bal (dblock s p)", "have \"bal(dblock s' p) = mbal(disk s' d p)\""], ["proof (prove)\nusing this:\n  bal (dblock s' p) = bal (dblock s p)\n  mbal (disk s' d p) = bal (dblock s p)\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) = mbal (disk s' d p)", "by auto"], ["proof (state)\nthis:\n  bal (dblock s' p) = mbal (disk s' d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D.\n       IsMajority D \\<and>\n       (\\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p))", "with inv phase act"], ["proof (chain)\npicking this:\n  HInv4c s p\n  phase s p = 2\n  HPhase1or2Write s s' p d\n  bal (dblock s' p) = mbal (disk s' d p)", "show \"\\<exists>D.    IsMajority D \n              \\<and> (\\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p))\""], ["proof (prove)\nusing this:\n  HInv4c s p\n  phase s p = 2\n  HPhase1or2Write s s' p d\n  bal (dblock s' p) = mbal (disk s' d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D.\n       IsMajority D \\<and>\n       (\\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p))", "by(auto simp add: HInv4c_def Phase1or2Write_def MajoritySet_def)"], ["proof (state)\nthis:\n  \\<exists>D.\n     IsMajority D \\<and>\n     (\\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  HInv4c s' p\n\ngoal (1 subgoal):\n 1. phase s' p \\<noteq> 2 \\<Longrightarrow> HInv4c s' p", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. phase s' p \\<noteq> 2 \\<Longrightarrow> HInv4c s' p", "case False"], ["proof (state)\nthis:\n  phase s' p \\<noteq> 2\n\ngoal (1 subgoal):\n 1. phase s' p \\<noteq> 2 \\<Longrightarrow> HInv4c s' p", "with act"], ["proof (chain)\npicking this:\n  HPhase1or2Write s s' p d\n  phase s' p \\<noteq> 2", "show ?thesis"], ["proof (prove)\nusing this:\n  HPhase1or2Write s s' p d\n  phase s' p \\<noteq> 2\n\ngoal (1 subgoal):\n 1. HInv4c s' p", "by(auto simp add: HInv4c_def Phase1or2Write_def)"], ["proof (state)\nthis:\n  HInv4c s' p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma  HPhase1or2Write_HInv4c_q:\n  assumes act: \"HPhase1or2Write s s' p d\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase1or2Write s s' p d\n  p \\<noteq> q", "have phase: \"phase s' q = phase s q\"\n   and dblock: \"dblock s q = dblock s' q\"\n    and disk: \"\\<forall>d. disk s' d q  = disk s d q\""], ["proof (prove)\nusing this:\n  HPhase1or2Write s s' p d\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. phase s' q = phase s q &&&\n    dblock s q = dblock s' q &&& \\<forall>d. disk s' d q = disk s d q", "by(auto simp add: Phase1or2Write_def)"], ["proof (state)\nthis:\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  \\<forall>d. disk s' d q = disk s d q\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "with inv"], ["proof (chain)\npicking this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  \\<forall>d. disk s' d q = disk s d q", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  \\<forall>d. disk s' d q = disk s d q\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "by(auto simp add: HInv4c_def)"], ["proof (state)\nthis:\n  HInv4c s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase1or2Write_HInv4c:\n  \"\\<lbrakk> HPhase1or2Write s s' p d; HInv4c s q; Inv2c s \\<rbrakk>\n             \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2Write s s' p d; HInv4c s q; Inv2c s\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "by(blast dest: HPhase1or2Write_HInv4c_p\n                 HPhase1or2Write_HInv4c_q)"], ["", "lemma  HPhase1or2ReadThen_HInv4c_p:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d q; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadThen s s' p d q; HInv4c s p\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' p", "by(auto simp add: Phase1or2ReadThen_def HInv4c_def)"], ["", "lemma  HPhase1or2ReadThen_HInv4c_q:\n  assumes act: \"HPhase1or2ReadThen s s' p d r\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d r\n  p \\<noteq> q", "have phase: \"phase s' q = phase s q\"\n   and dblock: \"dblock s q = dblock s' q\"\n   and disk: \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d r\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. phase s' q = phase s q &&& dblock s q = dblock s' q &&& disk s' = disk s", "by(auto simp add: Phase1or2ReadThen_def)"], ["proof (state)\nthis:\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "with inv"], ["proof (chain)\npicking this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "by(auto simp add: HInv4c_def)"], ["proof (state)\nthis:\n  HInv4c s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase1or2ReadThen_HInv4c:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d r; HInv4c s q\\<rbrakk>\n          \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadThen s s' p d r; HInv4c s q\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "by(blast dest: HPhase1or2ReadThen_HInv4c_p\n                 HPhase1or2ReadThen_HInv4c_q)"], ["", "theorem HPhase1or2ReadElse_HInv4c:\n  \"\\<lbrakk> HPhase1or2ReadElse s s' p d r; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadElse s s' p d r; HInv4c s q\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "using HStartBallot_HInv4c"], ["proof (prove)\nusing this:\n  \\<lbrakk>HStartBallot ?s ?s' ?p; HInv4c ?s ?q\\<rbrakk>\n  \\<Longrightarrow> HInv4c ?s' ?q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadElse s s' p d r; HInv4c s q\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "by(auto simp add: Phase1or2ReadElse_def)"], ["", "lemma  HEndPhase1_HInv4c_p:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv2b: \"Inv2b s\"\n  shows \"HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' p", "from act"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p", "have maj: \"   IsMajority {d. d\\<in> disksWritten s p \n             \\<and> (\\<forall>q\\<in>(UNIV- {p}). hasRead s p d q)}\" \n    (is  \"IsMajority ?M\")"], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n\ngoal (1 subgoal):\n 1. IsMajority\n     {d \\<in> disksWritten s p. \\<forall>q\\<in>UNIV - {p}. hasRead s p d q}", "by(simp add: EndPhase1_def)"], ["proof (state)\nthis:\n  IsMajority\n   {d \\<in> disksWritten s p. \\<forall>q\\<in>UNIV - {p}. hasRead s p d q}\n\ngoal (1 subgoal):\n 1. HInv4c s' p", "from inv2b"], ["proof (chain)\npicking this:\n  Inv2b s", "have \"\\<forall>d\\<in>?M. disk s d p = dblock s p\""], ["proof (prove)\nusing this:\n  Inv2b s\n\ngoal (1 subgoal):\n 1. \\<forall>d\\<in>{d \\<in> disksWritten s p.\n                    \\<forall>q\\<in>UNIV - {p}. hasRead s p d q}.\n       disk s d p = dblock s p", "by(auto simp add: Inv2b_def Inv2b_inner_def)"], ["proof (state)\nthis:\n  \\<forall>d\\<in>{d \\<in> disksWritten s p.\n                  \\<forall>q\\<in>UNIV - {p}. hasRead s p d q}.\n     disk s d p = dblock s p\n\ngoal (1 subgoal):\n 1. HInv4c s' p", "with act maj"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  IsMajority\n   {d \\<in> disksWritten s p. \\<forall>q\\<in>UNIV - {p}. hasRead s p d q}\n  \\<forall>d\\<in>{d \\<in> disksWritten s p.\n                  \\<forall>q\\<in>UNIV - {p}. hasRead s p d q}.\n     disk s d p = dblock s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  IsMajority\n   {d \\<in> disksWritten s p. \\<forall>q\\<in>UNIV - {p}. hasRead s p d q}\n  \\<forall>d\\<in>{d \\<in> disksWritten s p.\n                  \\<forall>q\\<in>UNIV - {p}. hasRead s p d q}.\n     disk s d p = dblock s p\n\ngoal (1 subgoal):\n 1. HInv4c s' p", "by(auto simp add: HInv4c_def EndPhase1_def MajoritySet_def)"], ["proof (state)\nthis:\n  HInv4c s' p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma  HEndPhase1_HInv4c_q:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  p \\<noteq> q", "have phase: \"phase s' q = phase s q\"\n   and dblock: \"dblock s q = dblock s' q\"\n   and disk: \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. phase s' q = phase s q &&& dblock s q = dblock s' q &&& disk s' = disk s", "by(auto simp add: EndPhase1_def)"], ["proof (state)\nthis:\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "with inv"], ["proof (chain)\npicking this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "by(auto simp add: HInv4c_def)"], ["proof (state)\nthis:\n  HInv4c s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase1_HInv4c:\n  \"\\<lbrakk> HEndPhase1 s s' p; HInv4c s q; Inv2b s\\<rbrakk> \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase1 s s' p; HInv4c s q; Inv2b s\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "by(blast dest: HEndPhase1_HInv4c_p HEndPhase1_HInv4c_q)"], ["", "lemma  HEndPhase2_HInv4c_p:\n  \"\\<lbrakk> HEndPhase2 s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase2 s s' p; HInv4c s p\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' p", "by(auto simp add: EndPhase2_def HInv4c_def)"], ["", "lemma  HEndPhase2_HInv4c_q:\n  assumes act: \"HEndPhase2 s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase2 s s' p\n  p \\<noteq> q", "have phase: \"phase s' q = phase s q\"\n   and dblock: \"dblock s q = dblock s' q\"\n   and disk: \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HEndPhase2 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. phase s' q = phase s q &&& dblock s q = dblock s' q &&& disk s' = disk s", "by(auto simp add: EndPhase2_def)"], ["proof (state)\nthis:\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "with inv"], ["proof (chain)\npicking this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "by(auto simp add: HInv4c_def)"], ["proof (state)\nthis:\n  HInv4c s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase2_HInv4c:\n  \"\\<lbrakk> HEndPhase2 s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase2 s s' p; HInv4c s q\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "by(blast dest: HEndPhase2_HInv4c_p HEndPhase2_HInv4c_q)"], ["", "lemma  HFail_HInv4c_p:\n  \"\\<lbrakk> HFail s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HFail s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p", "by(auto simp add: Fail_def HInv4c_def)"], ["", "lemma  HFail_HInv4c_q:\n  assumes act: \"HFail s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HFail s s' p\n  p \\<noteq> q", "have phase: \"phase s' q = phase s q\"\n   and dblock: \"dblock s q = dblock s' q\"\n   and disk: \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HFail s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. phase s' q = phase s q &&& dblock s q = dblock s' q &&& disk s' = disk s", "by(auto simp add: Fail_def)"], ["proof (state)\nthis:\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "with inv"], ["proof (chain)\npicking this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "by(auto simp add: HInv4c_def)"], ["proof (state)\nthis:\n  HInv4c s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HFail_HInv4c:\n  \"\\<lbrakk> HFail s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HFail s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q", "by(blast dest: HFail_HInv4c_p HFail_HInv4c_q)"], ["", "lemma  HPhase0Read_HInv4c_p:\n  \"\\<lbrakk> HPhase0Read s s' p d; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase0Read s s' p d; HInv4c s p\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' p", "by(auto simp add: Phase0Read_def HInv4c_def)"], ["", "lemma  HPhase0Read_HInv4c_q:\n  assumes act: \"HPhase0Read s s' p d\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase0Read s s' p d\n  p \\<noteq> q", "have phase: \"phase s' q = phase s q\"\n   and dblock: \"dblock s q = dblock s' q\"\n   and disk: \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HPhase0Read s s' p d\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. phase s' q = phase s q &&& dblock s q = dblock s' q &&& disk s' = disk s", "by(auto simp add: Phase0Read_def)"], ["proof (state)\nthis:\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "with inv"], ["proof (chain)\npicking this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "by(auto simp add: HInv4c_def)"], ["proof (state)\nthis:\n  HInv4c s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase0Read_HInv4c:\n  \"\\<lbrakk> HPhase0Read s s' p d; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase0Read s s' p d; HInv4c s q\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "by(blast dest: HPhase0Read_HInv4c_p HPhase0Read_HInv4c_q)"], ["", "lemma  HEndPhase0_HInv4c_p:\n  \"\\<lbrakk> HEndPhase0 s s' p; HInv4c s p\\<rbrakk> \\<Longrightarrow> HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase0 s s' p; HInv4c s p\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' p", "by(auto simp add: EndPhase0_def HInv4c_def)"], ["", "lemma  HEndPhase0_HInv4c_q:\n  assumes act: \"HEndPhase0 s s' p\"\n  and inv: \"HInv4c s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4c s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  p \\<noteq> q", "have phase: \"phase s' q = phase s q\"\n   and dblock: \"dblock s q = dblock s' q\"\n   and disk: \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. phase s' q = phase s q &&& dblock s q = dblock s' q &&& disk s' = disk s", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "with inv"], ["proof (chain)\npicking this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4c s q\n  phase s' q = phase s q\n  dblock s q = dblock s' q\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4c s' q", "by(auto simp add: HInv4c_def)"], ["proof (state)\nthis:\n  HInv4c s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase0_HInv4c:\n  \"\\<lbrakk> HEndPhase0 s s' p; HInv4c s q\\<rbrakk> \\<Longrightarrow> HInv4c s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase0 s s' p; HInv4c s q\\<rbrakk>\n    \\<Longrightarrow> HInv4c s' q", "by(blast dest: HEndPhase0_HInv4c_p HEndPhase0_HInv4c_q)"], ["", "subsubsection \\<open>Proofs of Invariant 4d\\<close>"], ["", "lemma  HStartBallot_HInv4d_p:\n  assumes act: \"HStartBallot s s' p\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "proof(clarsimp simp add: HInv4d_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from act"], ["proof (chain)\npicking this:\n  HStartBallot s s' p", "have bal': \"bal (dblock s' p) = bal (dblock s p)\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) = bal (dblock s p)", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  bal (dblock s' p) = bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from subsetD[OF HStartBallot_blocksOf[OF act] bk]"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s p \\<union> {dblock s' p}", "have \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\""], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s p \\<union> {dblock s' p}\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n 2. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "assume bk: \"bk \\<in> blocksOf s p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (2 subgoals):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n 2. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "with inv"], ["proof (chain)\npicking this:\n  HInv4d s p\n  bk \\<in> blocksOf s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4d s p\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "assume bk: \"bk \\<in> {dblock s' p}\""], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "with bal' inv"], ["proof (chain)\npicking this:\n  bal (dblock s' p) = bal (dblock s p)\n  HInv4d s p\n  bk \\<in> {dblock s' p}", "show ?thesis"], ["proof (prove)\nusing this:\n  bal (dblock s' p) = bal (dblock s p)\n  HInv4d s p\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def blocksOf_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with act"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "show \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HStartBallot_HInv4d_q:\n  assumes act: \"HStartBallot s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q", "by(auto simp add: StartBallot_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HStartBallot s s' p\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HStartBallot s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: StartBallot_def InitializePhase_def allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk' dblock'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: allRdBlks_def blocksOf_def rdBy_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from subsetD[OF this] inv"], ["proof (chain)\npicking this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q", "have \"\\<forall>bk\\<in>blocksOf s' q. \n           \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal(disk s d q)\""], ["proof (prove)\nusing this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>blocksOf s' q.\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "show ?thesis"], ["proof (prove)\nusing this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  HInv4d s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HStartBallot_HInv4d:\n  \"\\<lbrakk> HStartBallot s s' p; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HStartBallot s s' p; HInv4d s q\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "by(blast dest: HStartBallot_HInv4d_p HStartBallot_HInv4d_q)"], ["", "lemma  HPhase1or2Write_HInv4d_p:\n  assumes act: \"HPhase1or2Write s s' p d\"\n  and inv: \"HInv4d s p\"\n  and inv4a: \"HInv4a s p\"\n  shows \"HInv4d s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "proof(clarsimp simp add: HInv4d_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from act"], ["proof (chain)\npicking this:\n  HPhase1or2Write s s' p d", "have ddisk: \"\\<forall>dd. disk s' dd p = (if d = dd \n                                       then dblock s p \n                                       else disk s dd p)\" \n    and phase: \"phase s p \\<noteq> 0\""], ["proof (prove)\nusing this:\n  HPhase1or2Write s s' p d\n\ngoal (1 subgoal):\n 1. \\<forall>dd.\n       disk s' dd p = (if d = dd then dblock s p else disk s dd p) &&&\n    phase s p \\<noteq> 0", "by(auto simp add: Phase1or2Write_def)"], ["proof (state)\nthis:\n  \\<forall>dd. disk s' dd p = (if d = dd then dblock s p else disk s dd p)\n  phase s p \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from inv subsetD[OF HPhase1or2Write_blocksOf[OF act] bk]"], ["proof (chain)\npicking this:\n  HInv4d s p\n  bk \\<in> blocksOf s p", "have asm3: \"\\<exists>D\\<in>MajoritySet. \\<forall>dd\\<in>D. bal bk \\<le> mbal (disk s dd p)\""], ["proof (prove)\nusing this:\n  HInv4d s p\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>dd\\<in>D. bal bk \\<le> mbal (disk s dd p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>dd\\<in>D. bal bk \\<le> mbal (disk s dd p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from phase inv4a subsetD[OF HPhase1or2Write_blocksOf[OF act] bk] ddisk"], ["proof (chain)\npicking this:\n  phase s p \\<noteq> 0\n  HInv4a s p\n  bk \\<in> blocksOf s p\n  \\<forall>dd. disk s' dd p = (if d = dd then dblock s p else disk s dd p)", "have p41: \"bal bk \\<le> mbal (disk s' d p)\""], ["proof (prove)\nusing this:\n  phase s p \\<noteq> 0\n  HInv4a s p\n  bk \\<in> blocksOf s p\n  \\<forall>dd. disk s' dd p = (if d = dd then dblock s p else disk s dd p)\n\ngoal (1 subgoal):\n 1. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: HInv4a_def HInv4a1_def)"], ["proof (state)\nthis:\n  bal bk \\<le> mbal (disk s' d p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with ddisk asm3"], ["proof (chain)\npicking this:\n  \\<forall>dd. disk s' dd p = (if d = dd then dblock s p else disk s dd p)\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>dd\\<in>D. bal bk \\<le> mbal (disk s dd p)\n  bal bk \\<le> mbal (disk s' d p)", "show \"\\<exists>D\\<in>MajoritySet. \\<forall>dd\\<in>D. bal bk \\<le> mbal (disk s' dd p)\""], ["proof (prove)\nusing this:\n  \\<forall>dd. disk s' dd p = (if d = dd then dblock s p else disk s dd p)\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>dd\\<in>D. bal bk \\<le> mbal (disk s dd p)\n  bal bk \\<le> mbal (disk s' d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>dd\\<in>D. bal bk \\<le> mbal (disk s' dd p)", "by(auto simp add: MajoritySet_def split: if_split_asm)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>dd\\<in>D. bal bk \\<le> mbal (disk s' dd p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HPhase1or2Write_HInv4d_q:\n  assumes act: \"HPhase1or2Write s  s' p d\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase1or2Write s s' p d\n  p \\<noteq> q", "have disk': \"\\<forall>d. disk s' d q =disk s  d q\""], ["proof (prove)\nusing this:\n  HPhase1or2Write s s' p d\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>d. disk s' d q = disk s d q", "by(auto simp add: Phase1or2Write_def)"], ["proof (state)\nthis:\n  \\<forall>d. disk s' d q = disk s d q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase1or2Write s s' p d\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HPhase1or2Write s s' p d\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: Phase1or2Write_def \n                      InitializePhase_def allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with act pnq"], ["proof (chain)\npicking this:\n  HPhase1or2Write s s' p d\n  p \\<noteq> q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  HPhase1or2Write s s' p d\n  p \\<noteq> q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: Phase1or2Write_def allRdBlks_def\n                      blocksOf_def rdBy_def)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from subsetD[OF this] inv"], ["proof (chain)\npicking this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q", "have \"\\<forall>bk\\<in>blocksOf s' q. \n            \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal(disk s d q)\""], ["proof (prove)\nusing this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>blocksOf s' q.\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk'"], ["proof (chain)\npicking this:\n  \\<forall>d. disk s' d q = disk s d q\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>d. disk s' d q = disk s d q\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  HInv4d s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase1or2Write_HInv4d:\n  \"\\<lbrakk> HPhase1or2Write s s' p d; HInv4d s q; HInv4a s p\\<rbrakk> \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2Write s s' p d; HInv4d s q; HInv4a s p\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "by(blast dest: HPhase1or2Write_HInv4d_p HPhase1or2Write_HInv4d_q)"], ["", "lemma  HPhase1or2ReadThen_HInv4d_p:\n  assumes act: \"HPhase1or2ReadThen s s' p d q\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "proof(clarsimp simp add: HInv4d_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from act"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d q", "have bal': \"bal (dblock s' p) = bal (dblock s p)\""], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d q\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) = bal (dblock s p)", "by(auto simp add: Phase1or2ReadThen_def)"], ["proof (state)\nthis:\n  bal (dblock s' p) = bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from subsetD[OF HPhase1or2ReadThen_blocksOf[OF act] bk] inv"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s p\n  HInv4d s p", "have \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\""], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s p\n  HInv4d s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with act"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d q\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "show \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\""], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d q\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: Phase1or2ReadThen_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HPhase1or2ReadThen_HInv4d_q:\n  assumes act: \"HPhase1or2ReadThen s  s' p d r\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d r\n  p \\<noteq> q", "have disk': \"disk s'=disk s\""], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d r\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s", "by(auto simp add: Phase1or2ReadThen_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase1or2ReadThen s s' p d r\n  p \\<noteq> q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  HPhase1or2ReadThen s s' p d r\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: Phase1or2ReadThen_def allRdBlks_def\n                      blocksOf_def rdBy_def)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from subsetD[OF this] inv"], ["proof (chain)\npicking this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q", "have \"\\<forall>bk\\<in>blocksOf s' q. \n             \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal(disk s d q)\""], ["proof (prove)\nusing this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>blocksOf s' q.\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "show ?thesis"], ["proof (prove)\nusing this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  HInv4d s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase1or2ReadThen_HInv4d:\n  \"\\<lbrakk> HPhase1or2ReadThen s s' p d r; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadThen s s' p d r; HInv4d s q\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "by(blast dest: HPhase1or2ReadThen_HInv4d_p\n                 HPhase1or2ReadThen_HInv4d_q)"], ["", "theorem HPhase1or2ReadElse_HInv4d:\n  \"\\<lbrakk> HPhase1or2ReadElse s s' p d r; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadElse s s' p d r; HInv4d s q\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "using HStartBallot_HInv4d"], ["proof (prove)\nusing this:\n  \\<lbrakk>HStartBallot ?s ?s' ?p; HInv4d ?s ?q\\<rbrakk>\n  \\<Longrightarrow> HInv4d ?s' ?q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase1or2ReadElse s s' p d r; HInv4d s q\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "by(auto simp add: Phase1or2ReadElse_def)"], ["", "lemma  HEndPhase1_HInv4d_p:\n  assumes act: \"HEndPhase1 s s' p\"\n  and inv: \"HInv4d s p\"\n  and inv2b: \"Inv2b s\"\n  and inv4c: \"HInv4c s p\"\n  shows \"HInv4d s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "proof(clarsimp simp add: HInv4d_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from HEndPhase1_HInv4c[OF act inv4c inv2b]"], ["proof (chain)\npicking this:\n  HInv4c s' p", "have \"HInv4c s' p\""], ["proof (prove)\nusing this:\n  HInv4c s' p\n\ngoal (1 subgoal):\n 1. HInv4c s' p", "."], ["proof (state)\nthis:\n  HInv4c s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with act"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  HInv4c s' p", "have p31: \"\\<exists>D\\<in>MajoritySet. \n               \\<forall>d\\<in>D. mbal (disk s' d p) = bal(dblock s' p)\"\n    and disk': \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  HInv4c s' p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p) &&&\n    disk s' = disk s", "by(auto simp add: EndPhase1_def HInv4c_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p)\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from subsetD[OF HEndPhase1_blocksOf[OF act] bk]"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s p \\<union> {dblock s' p}", "show \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\""], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s p \\<union> {dblock s' p}\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n 2. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (2 subgoals):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n 2. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with inv disk'"], ["proof (chain)\npicking this:\n  HInv4d s p\n  disk s' = disk s\n  bk \\<in> blocksOf s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4d s p\n  disk s' = disk s\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> {dblock s' p}\""], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with p31"], ["proof (chain)\npicking this:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p)\n  bk \\<in> {dblock s' p}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. mbal (disk s' d p) = bal (dblock s' p)\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by force"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase1_HInv4d_q:\n  assumes act: \"HEndPhase1 s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q", "by(auto simp add: EndPhase1_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase1 s s' p\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HEndPhase1 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: EndPhase1_def InitializePhase_def\n                      allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk' dblock'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: allRdBlks_def blocksOf_def rdBy_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from subsetD[OF this] inv"], ["proof (chain)\npicking this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q", "have \"\\<forall>bk\\<in>blocksOf s' q. \n           \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal(disk s d q)\""], ["proof (prove)\nusing this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>blocksOf s' q.\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "show ?thesis"], ["proof (prove)\nusing this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  HInv4d s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase1_HInv4d:\n  \"\\<lbrakk> HEndPhase1 s s' p; HInv4d s q; Inv2b s; HInv4c s p\\<rbrakk>\n         \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase1 s s' p; HInv4d s q; Inv2b s; HInv4c s p\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "by(blast dest: HEndPhase1_HInv4d_p HEndPhase1_HInv4d_q)"], ["", "lemma  HEndPhase2_HInv4d_p:\n  assumes act: \"HEndPhase2 s s' p\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "proof(clarsimp simp add: HInv4d_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from act"], ["proof (chain)\npicking this:\n  HEndPhase2 s s' p", "have bal': \"bal (dblock s' p) = bal (dblock s p)\""], ["proof (prove)\nusing this:\n  HEndPhase2 s s' p\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) = bal (dblock s p)", "by(auto simp add: EndPhase2_def)"], ["proof (state)\nthis:\n  bal (dblock s' p) = bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from subsetD[OF HEndPhase2_blocksOf[OF act] bk] inv"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s p\n  HInv4d s p", "have \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\""], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s p\n  HInv4d s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with act"], ["proof (chain)\npicking this:\n  HEndPhase2 s s' p\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "show \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\""], ["proof (prove)\nusing this:\n  HEndPhase2 s s' p\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: EndPhase2_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase2_HInv4d_q:\n  assumes act: \"HEndPhase2 s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase2 s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\""], ["proof (prove)\nusing this:\n  HEndPhase2 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s", "by(auto simp add: EndPhase2_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase2 s s' p\n  p \\<noteq> q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  HEndPhase2 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: EndPhase2_def InitializePhase_def\n                      allRdBlks_def blocksOf_def rdBy_def)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from subsetD[OF this] inv"], ["proof (chain)\npicking this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q", "have \"\\<forall>bk\\<in>blocksOf s' q.\n           \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal(disk s d q)\""], ["proof (prove)\nusing this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>blocksOf s' q.\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "show ?thesis"], ["proof (prove)\nusing this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  HInv4d s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase2_HInv4d:\n  \"\\<lbrakk> HEndPhase2 s s' p; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase2 s s' p; HInv4d s q\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "by(blast dest: HEndPhase2_HInv4d_p HEndPhase2_HInv4d_q)"], ["", "lemma  HFail_HInv4d_p:\n  assumes act: \"HFail s s' p\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "proof(clarsimp simp add: HInv4d_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from act"], ["proof (chain)\npicking this:\n  HFail s s' p", "have disk': \"disk s' = disk s\""], ["proof (prove)\nusing this:\n  HFail s s' p\n\ngoal (1 subgoal):\n 1. disk s' = disk s", "by(auto simp add: Fail_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from subsetD[OF HFail_blocksOf[OF act] bk]"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s p \\<union> {dblock s' p}", "show \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\""], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s p \\<union> {dblock s' p}\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n 2. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (2 subgoals):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n 2. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with inv disk'"], ["proof (chain)\npicking this:\n  HInv4d s p\n  disk s' = disk s\n  bk \\<in> blocksOf s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4d s p\n  disk s' = disk s\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> {dblock s' p}\""], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with act"], ["proof (chain)\npicking this:\n  HFail s s' p\n  bk \\<in> {dblock s' p}", "have \"bal bk = 0\""], ["proof (prove)\nusing this:\n  HFail s s' p\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. bal bk = 0", "by(auto simp add: Fail_def InitDB_def)"], ["proof (state)\nthis:\n  bal bk = 0\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with Disk_isMajority"], ["proof (chain)\npicking this:\n  IsMajority UNIV\n  bal bk = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  IsMajority UNIV\n  bal bk = 0\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: MajoritySet_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HFail_HInv4d_q:\n  assumes act: \"HFail s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HFail s s' p\n  p \\<noteq> q", "have disk': \"disk s'=disk s\" \n   and dblock': \"dblock s' q=dblock s q\""], ["proof (prove)\nusing this:\n  HFail s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s &&& dblock s' q = dblock s q", "by(auto simp add: Fail_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n  dblock s' q = dblock s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HFail s s' p\n  p \\<noteq> q", "have blocksRead': \"\\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\""], ["proof (prove)\nusing this:\n  HFail s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "by(auto simp add: Fail_def InitializePhase_def allRdBlks_def)"], ["proof (state)\nthis:\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk' dblock'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  disk s' = disk s\n  dblock s' q = dblock s q\n  \\<forall>q. allRdBlks s' q \\<subseteq> allRdBlks s q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: allRdBlks_def blocksOf_def rdBy_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from subsetD[OF this] inv"], ["proof (chain)\npicking this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q", "have \"\\<forall>bk\\<in>blocksOf s' q.\n          \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal(disk s d q)\""], ["proof (prove)\nusing this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>blocksOf s' q.\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "show ?thesis"], ["proof (prove)\nusing this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  HInv4d s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HFail_HInv4d:\n  \"\\<lbrakk> HFail s s' p; HInv4d s q \\<rbrakk> \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HFail s s' p; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q", "by(blast dest: HFail_HInv4d_p HFail_HInv4d_q)"], ["", "lemma  HPhase0Read_HInv4d_p:\n  assumes act: \"HPhase0Read s s' p d\"\n  and inv: \"HInv4d s p\"\n  shows \"HInv4d s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "proof(clarsimp simp add: HInv4d_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from act"], ["proof (chain)\npicking this:\n  HPhase0Read s s' p d", "have bal': \"bal (dblock s' p) = bal (dblock s p)\""], ["proof (prove)\nusing this:\n  HPhase0Read s s' p d\n\ngoal (1 subgoal):\n 1. bal (dblock s' p) = bal (dblock s p)", "by(auto simp add: Phase0Read_def)"], ["proof (state)\nthis:\n  bal (dblock s' p) = bal (dblock s p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from subsetD[OF HPhase0Read_blocksOf[OF act] bk] inv"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s p\n  HInv4d s p", "have \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\""], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s p\n  HInv4d s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with act"], ["proof (chain)\npicking this:\n  HPhase0Read s s' p d\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "show \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\""], ["proof (prove)\nusing this:\n  HPhase0Read s s' p d\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: Phase0Read_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HPhase0Read_HInv4d_q:\n  assumes act: \"HPhase0Read s  s' p d\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase0Read s s' p d\n  p \\<noteq> q", "have disk': \"disk s'=disk s\""], ["proof (prove)\nusing this:\n  HPhase0Read s s' p d\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. disk s' = disk s", "by(auto simp add: Phase0Read_def)"], ["proof (state)\nthis:\n  disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HPhase0Read s s' p d\n  p \\<noteq> q", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  HPhase0Read s s' p d\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: Phase0Read_def allRdBlks_def\n                      blocksOf_def rdBy_def)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from subsetD[OF this] inv"], ["proof (chain)\npicking this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q", "have \"\\<forall>bk\\<in>blocksOf s' q.\n           \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal(disk s d q)\""], ["proof (prove)\nusing this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>blocksOf s' q.\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with disk'"], ["proof (chain)\npicking this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "show ?thesis"], ["proof (prove)\nusing this:\n  disk s' = disk s\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  HInv4d s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HPhase0Read_HInv4d:\n  \"\\<lbrakk> HPhase0Read s s' p d; HInv4d s q\\<rbrakk> \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HPhase0Read s s' p d; HInv4d s q\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "by(blast dest: HPhase0Read_HInv4d_p HPhase0Read_HInv4d_q)"], ["", "lemma HEndPhase0_blocksOf2:\n  assumes act: \"HEndPhase0 s s' p\"\n  and inv2c: \"Inv2c_inner s p\"\n  shows \"allBlocksRead s p \\<subseteq> blocksOf s p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. allBlocksRead s p \\<subseteq> blocksOf s p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. allBlocksRead s p \\<subseteq> blocksOf s p", "from act inv2c"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  Inv2c_inner s p", "have \"\\<forall>d.\\<forall>br \\<in> blocksRead s p d.   proc br =p \n                                    \\<and> block br = disk s d p\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  Inv2c_inner s p\n\ngoal (1 subgoal):\n 1. \\<forall>d.\n       \\<forall>br\\<in>blocksRead s p d.\n          proc br = p \\<and> block br = disk s d p", "by(auto simp add: EndPhase0_def Inv2c_inner_def)"], ["proof (state)\nthis:\n  \\<forall>d.\n     \\<forall>br\\<in>blocksRead s p d.\n        proc br = p \\<and> block br = disk s d p\n\ngoal (1 subgoal):\n 1. allBlocksRead s p \\<subseteq> blocksOf s p", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>d.\n     \\<forall>br\\<in>blocksRead s p d.\n        proc br = p \\<and> block br = disk s d p\n\ngoal (1 subgoal):\n 1. allBlocksRead s p \\<subseteq> blocksOf s p", "by(auto simp add: allBlocksRead_def allRdBlks_def\n                      blocksOf_def)"], ["proof (state)\nthis:\n  allBlocksRead s p \\<subseteq> blocksOf s p\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma  HEndPhase0_HInv4d_p:\n  assumes act: \"HEndPhase0 s s' p\"\n  and inv: \"HInv4d s p\"\n  and inv2c: \"Inv2c s\"\n  and inv1: \"Inv1 s\"\n  shows \"HInv4d s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "proof(clarsimp simp add: HInv4d_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "fix bk"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "assume bk: \"bk \\<in> blocksOf s' p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s' p\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "from subsetD[OF HEndPhase0_blocksOf[OF act] bk]"], ["proof (chain)\npicking this:\n  bk \\<in> blocksOf s p \\<union> {dblock s' p}", "have \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\""], ["proof (prove)\nusing this:\n  bk \\<in> blocksOf s p \\<union> {dblock s' p}\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n 2. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "assume bk: \"bk \\<in> blocksOf s p\""], ["proof (state)\nthis:\n  bk \\<in> blocksOf s p\n\ngoal (2 subgoals):\n 1. bk \\<in> blocksOf s p \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n 2. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "with inv"], ["proof (chain)\npicking this:\n  HInv4d s p\n  bk \\<in> blocksOf s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4d s p\n  bk \\<in> blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "assume bk: \"bk\\<in> {dblock s' p}\""], ["proof (state)\nthis:\n  bk \\<in> {dblock s' p}\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "from inv2c"], ["proof (chain)\npicking this:\n  Inv2c s", "have inv2c_inner: \"Inv2c_inner s p\""], ["proof (prove)\nusing this:\n  Inv2c s\n\ngoal (1 subgoal):\n 1. Inv2c_inner s p", "by(auto simp add: Inv2c_def)"], ["proof (state)\nthis:\n  Inv2c_inner s p\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "from bk  HEndPhase0_some[OF act inv1] \n         HEndPhase0_blocksOf2[OF act inv2c_inner] act"], ["proof (chain)\npicking this:\n  bk \\<in> {dblock s' p}\n  (SOME b.\n      b \\<in> allBlocksRead s p \\<and>\n      (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b))\n  \\<in> allBlocksRead s p \\<and>\n  (\\<forall>t\\<in>allBlocksRead s p.\n      bal t\n      \\<le> bal (SOME b.\n                    b \\<in> allBlocksRead s p \\<and>\n                    (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b)))\n  allBlocksRead s p \\<subseteq> blocksOf s p\n  HEndPhase0 s s' p", "have \"bal bk \\<in> bal `(blocksOf s p)\""], ["proof (prove)\nusing this:\n  bk \\<in> {dblock s' p}\n  (SOME b.\n      b \\<in> allBlocksRead s p \\<and>\n      (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b))\n  \\<in> allBlocksRead s p \\<and>\n  (\\<forall>t\\<in>allBlocksRead s p.\n      bal t\n      \\<le> bal (SOME b.\n                    b \\<in> allBlocksRead s p \\<and>\n                    (\\<forall>t\\<in>allBlocksRead s p. bal t \\<le> bal b)))\n  allBlocksRead s p \\<subseteq> blocksOf s p\n  HEndPhase0 s s' p\n\ngoal (1 subgoal):\n 1. bal bk \\<in> bal ` blocksOf s p", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  bal bk \\<in> bal ` blocksOf s p\n\ngoal (1 subgoal):\n 1. bk \\<in> {dblock s' p} \\<Longrightarrow>\n    \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "with inv"], ["proof (chain)\npicking this:\n  HInv4d s p\n  bal bk \\<in> bal ` blocksOf s p", "show ?thesis"], ["proof (prove)\nusing this:\n  HInv4d s p\n  bal bk \\<in> bal ` blocksOf s p\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<And>bk.\n       bk \\<in> blocksOf s' p \\<Longrightarrow>\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "with act"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)", "show \"\\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d p)\n\ngoal (1 subgoal):\n 1. \\<exists>D\\<in>MajoritySet.\n       \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  \\<exists>D\\<in>MajoritySet.\n     \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s' d p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HEndPhase0_HInv4d_q:\n  assumes act: \"HEndPhase0 s  s' p\"\n  and inv: \"HInv4d s q\"\n  and pnq: \"p\\<noteq>q\"\n  shows \"HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' q", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  p \\<noteq> q", "have \"dblock s' q = dblock s q \\<and> disk s' = disk s\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. dblock s' q = dblock s q \\<and> disk s' = disk s", "by(auto simp add: EndPhase0_def)"], ["proof (state)\nthis:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "moreover"], ["proof (state)\nthis:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from act pnq"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  p \\<noteq> q", "have \"\\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\""], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  p \\<noteq> q\n\ngoal (1 subgoal):\n 1. \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d", "by(auto simp add: EndPhase0_def InitializePhase_def rdBy_def)"], ["proof (state)\nthis:\n  \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "hence \"(UN p d. rdBy s' q p d) \\<subseteq> (UN p d. rdBy s q p d)\""], ["proof (prove)\nusing this:\n  \\<forall>p d. rdBy s' q p d \\<subseteq> rdBy s q p d\n\ngoal (1 subgoal):\n 1. (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n    \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))", "by(auto, blast)"], ["proof (state)\nthis:\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "ultimately"], ["proof (chain)\npicking this:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))", "have \"blocksOf s' q \\<subseteq> blocksOf s q\""], ["proof (prove)\nusing this:\n  dblock s' q = dblock s q \\<and> disk s' = disk s\n  (\\<Union>p. \\<Union> (range (rdBy s' q p)))\n  \\<subseteq> (\\<Union>p. \\<Union> (range (rdBy s q p)))\n\ngoal (1 subgoal):\n 1. blocksOf s' q \\<subseteq> blocksOf s q", "by(auto simp add: blocksOf_def, blast)"], ["proof (state)\nthis:\n  blocksOf s' q \\<subseteq> blocksOf s q\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "from subsetD[OF this] inv"], ["proof (chain)\npicking this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q", "have \"\\<forall>bk\\<in>blocksOf s' q.\n           \\<exists>D\\<in>MajoritySet. \\<forall>d\\<in>D. bal bk \\<le> mbal(disk s d q)\""], ["proof (prove)\nusing this:\n  ?c \\<in> blocksOf s' q \\<Longrightarrow> ?c \\<in> blocksOf s q\n  HInv4d s q\n\ngoal (1 subgoal):\n 1. \\<forall>bk\\<in>blocksOf s' q.\n       \\<exists>D\\<in>MajoritySet.\n          \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "by(auto simp add: HInv4d_def)"], ["proof (state)\nthis:\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "with act"], ["proof (chain)\npicking this:\n  HEndPhase0 s s' p\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)", "show ?thesis"], ["proof (prove)\nusing this:\n  HEndPhase0 s s' p\n  \\<forall>bk\\<in>blocksOf s' q.\n     \\<exists>D\\<in>MajoritySet.\n        \\<forall>d\\<in>D. bal bk \\<le> mbal (disk s d q)\n\ngoal (1 subgoal):\n 1. HInv4d s' q", "by(auto simp add: EndPhase0_def HInv4d_def)"], ["proof (state)\nthis:\n  HInv4d s' q\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem HEndPhase0_HInv4d:\n  \"\\<lbrakk> HEndPhase0 s s' p; HInv4d s q; \n     Inv2c s; Inv1 s\\<rbrakk> \\<Longrightarrow> HInv4d s' q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>HEndPhase0 s s' p; HInv4d s q; Inv2c s; Inv1 s\\<rbrakk>\n    \\<Longrightarrow> HInv4d s' q", "by(blast dest: HEndPhase0_HInv4d_p HEndPhase0_HInv4d_q)"], ["", "text\\<open>Since we have already proved $HInv2$ is an invariant of $HNext$,\n$HInv1 \\wedge HInv2 \\wedge HInv4$ is also an invariant of $HNext$. \n\\<close>"], ["", "lemma I2d:\n  assumes nxt: \"HNext s s'\"\n  and inv: \"HInv1 s \\<and> HInv2 s \\<and> HInv2 s' \\<and> HInv4 s\"\n  shows \"HInv4 s'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4 s'", "proof(auto simp add: HInv4_def)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>p. HInv4a s' p\n 2. \\<And>p. HInv4b s' p\n 3. \\<And>p. HInv4c s' p\n 4. \\<And>p. HInv4d s' p", "fix p"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>p. HInv4a s' p\n 2. \\<And>p. HInv4b s' p\n 3. \\<And>p. HInv4c s' p\n 4. \\<And>p. HInv4d s' p", "show \"HInv4a s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4a s' p", "using assms"], ["proof (prove)\nusing this:\n  HNext s s'\n  HInv1 s \\<and> HInv2 s \\<and> HInv2 s' \\<and> HInv4 s\n\ngoal (1 subgoal):\n 1. HInv4a s' p", "by(auto simp add: HInv4_def HNext_def Next_def,\n        auto simp add: HInv2_def intro: HStartBallot_HInv4a,\n        auto intro: HPhase0Read_HInv4a,\n        auto intro: HPhase1or2Write_HInv4a,\n        auto simp add: Phase1or2Read_def\n             intro: HPhase1or2ReadThen_HInv4a\n                    HPhase1or2ReadElse_HInv4a,\n        auto simp add: EndPhase1or2_def\n             intro: HEndPhase1_HInv4a\n                    HEndPhase2_HInv4a,\n        auto intro: HFail_HInv4a,\n        auto intro: HEndPhase0_HInv4a simp add: HInv1_def)"], ["proof (state)\nthis:\n  HInv4a s' p\n\ngoal (3 subgoals):\n 1. \\<And>p. HInv4b s' p\n 2. \\<And>p. HInv4c s' p\n 3. \\<And>p. HInv4d s' p", "show \"HInv4b s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4b s' p", "using assms"], ["proof (prove)\nusing this:\n  HNext s s'\n  HInv1 s \\<and> HInv2 s \\<and> HInv2 s' \\<and> HInv4 s\n\ngoal (1 subgoal):\n 1. HInv4b s' p", "by(auto simp add: HInv4_def HNext_def Next_def,\n        auto simp add: HInv2_def \n             intro: HStartBallot_HInv4b,\n        auto intro: HPhase0Read_HInv4b,\n        auto intro: HPhase1or2Write_HInv4b,\n        auto simp add: Phase1or2Read_def\n             intro: HPhase1or2ReadThen_HInv4b\n                    HPhase1or2ReadElse_HInv4b,\n        auto simp add: EndPhase1or2_def\n             intro: HEndPhase1_HInv4b\n                    HEndPhase2_HInv4b,\n        auto intro: HFail_HInv4b,\n        auto intro: HEndPhase0_HInv4b simp add: HInv1_def Inv2c_def)"], ["proof (state)\nthis:\n  HInv4b s' p\n\ngoal (2 subgoals):\n 1. \\<And>p. HInv4c s' p\n 2. \\<And>p. HInv4d s' p", "show \"HInv4c s' p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4c s' p", "using assms"], ["proof (prove)\nusing this:\n  HNext s s'\n  HInv1 s \\<and> HInv2 s \\<and> HInv2 s' \\<and> HInv4 s\n\ngoal (1 subgoal):\n 1. HInv4c s' p", "by(auto simp add: HInv4_def HNext_def Next_def,\n        auto simp add: HInv2_def \n             intro: HStartBallot_HInv4c,\n        auto intro: HPhase0Read_HInv4c,\n        auto intro: HPhase1or2Write_HInv4c,\n        auto simp add: Phase1or2Read_def\n             intro: HPhase1or2ReadThen_HInv4c\n                    HPhase1or2ReadElse_HInv4c,\n        auto simp add: EndPhase1or2_def\n             intro: HEndPhase1_HInv4c\n                    HEndPhase2_HInv4c,\n        auto intro: HFail_HInv4c,\n        auto intro: HEndPhase0_HInv4c simp add: HInv1_def)"], ["proof (state)\nthis:\n  HInv4c s' p\n\ngoal (1 subgoal):\n 1. \\<And>p. HInv4d s' p", "show \"HInv4d s' p \""], ["proof (prove)\ngoal (1 subgoal):\n 1. HInv4d s' p", "using assms"], ["proof (prove)\nusing this:\n  HNext s s'\n  HInv1 s \\<and> HInv2 s \\<and> HInv2 s' \\<and> HInv4 s\n\ngoal (1 subgoal):\n 1. HInv4d s' p", "by(auto simp add: HInv4_def HNext_def Next_def,\n        auto simp add: HInv2_def \n             intro: HStartBallot_HInv4d,\n        auto intro: HPhase0Read_HInv4d,\n        auto intro: HPhase1or2Write_HInv4d,\n        auto simp add: Phase1or2Read_def\n             intro: HPhase1or2ReadThen_HInv4d\n                    HPhase1or2ReadElse_HInv4d,\n        auto simp add: EndPhase1or2_def\n             intro: HEndPhase1_HInv4d\n                    HEndPhase2_HInv4d,\n        auto intro: HFail_HInv4d,\n        auto intro: HEndPhase0_HInv4d simp add: HInv1_def)"], ["proof (state)\nthis:\n  HInv4d s' p\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}