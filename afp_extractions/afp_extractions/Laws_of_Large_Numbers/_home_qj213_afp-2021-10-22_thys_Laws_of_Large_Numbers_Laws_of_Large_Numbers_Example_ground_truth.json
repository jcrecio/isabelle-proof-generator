{"file_name": "/home/qj213/afp-2021-10-22/thys/Laws_of_Large_Numbers/Laws_of_Large_Numbers_Example.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Laws_of_Large_Numbers", "problem_names": ["lemma (in prob_space) indep_vars_iff_distr_eq_PiM':\n  fixes I :: \"'i set\" and X :: \"'i \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  assumes \"I \\<noteq> {}\"\n  assumes rv: \"\\<And>i. i \\<in> I \\<Longrightarrow> random_variable (M' i) (X i)\"\n  shows \"indep_vars M' X I \\<longleftrightarrow>\n           distr M (\\<Pi>\\<^sub>M i\\<in>I. M' i) (\\<lambda>x. \\<lambda>i\\<in>I. X i x) = (\\<Pi>\\<^sub>M i\\<in>I. distr M (M' i) (X i))\"", "lemma indep_vars_PiM_components:\n  assumes \"\\<And>i. i \\<in> A \\<Longrightarrow> prob_space (M i)\"\n  shows   \"prob_space.indep_vars (PiM A M) M (\\<lambda>i f. f i) A\"", "lemma indep_vars_PiM_components':\n  assumes \"\\<And>i. i \\<in> A \\<Longrightarrow> prob_space (M i)\"\n  assumes \"\\<And>i. i \\<in> A \\<Longrightarrow> g i \\<in> M i \\<rightarrow>\\<^sub>M N i\"\n  shows   \"prob_space.indep_vars (PiM A M) N (\\<lambda>i f. g i (f i)) A\"", "lemma integrable_bernoulli_pmf [intro]:\n  fixes f :: \"bool \\<Rightarrow> 'a :: {banach, second_countable_topology}\"\n  shows \"integrable (bernoulli_pmf p) f\"", "lemma expectation_bernoulli_pmf:\n  fixes f :: \"bool \\<Rightarrow> 'a :: {banach, second_countable_topology}\"\n  assumes p: \"p \\<in> {0..1}\"\n  shows   \"measure_pmf.expectation (bernoulli_pmf p) f = p *\\<^sub>R f True + (1 - p) *\\<^sub>R f False\"", "lemma random_variable_component: \"random_variable (count_space UNIV) (\\<lambda>f. f i)\"", "lemma random_variable_X [measurable]: \"random_variable borel (X i)\"", "lemma distr_M_component: \"distr M (count_space UNIV) (\\<lambda>f. f i) = measure_pmf (bernoulli_pmf p)\"", "lemma distr_M_X:\n  \"distr M borel (X i) = distr (measure_pmf (bernoulli_pmf p)) borel (\\<lambda>b. if b then 1 else 0)\"", "lemma X_has_expectation: \"integrable M (X 0)\"", "lemma indep: \"indep_vars (\\<lambda>_. borel) X UNIV\"", "lemma expectation_X: \"expectation (X i) = p\"", "theorem \"AE f in M. (\\<lambda>n. card {i. i < n \\<and> f i} / n) \\<longlonglongrightarrow> p\""], "translations": [["", "lemma (in prob_space) indep_vars_iff_distr_eq_PiM':\n  fixes I :: \"'i set\" and X :: \"'i \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  assumes \"I \\<noteq> {}\"\n  assumes rv: \"\\<And>i. i \\<in> I \\<Longrightarrow> random_variable (M' i) (X i)\"\n  shows \"indep_vars M' X I \\<longleftrightarrow>\n           distr M (\\<Pi>\\<^sub>M i\\<in>I. M' i) (\\<lambda>x. \\<lambda>i\\<in>I. X i x) = (\\<Pi>\\<^sub>M i\\<in>I. distr M (M' i) (X i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "from assms"], ["proof (chain)\npicking this:\n  I \\<noteq> {}\n  ?i12 \\<in> I \\<Longrightarrow> random_variable (M' ?i12) (X ?i12)", "obtain j where j: \"j \\<in> I\""], ["proof (prove)\nusing this:\n  I \\<noteq> {}\n  ?i12 \\<in> I \\<Longrightarrow> random_variable (M' ?i12) (X ?i12)\n\ngoal (1 subgoal):\n 1. (\\<And>j. j \\<in> I \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  j \\<in> I\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "define N' where \"N' = (\\<lambda>i. if i \\<in> I then M' i else M' j)\""], ["proof (state)\nthis:\n  N' = (\\<lambda>i. if i \\<in> I then M' i else M' j)\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "define Y where \"Y = (\\<lambda>i. if i \\<in> I then X i else X j)\""], ["proof (state)\nthis:\n  Y = (\\<lambda>i. if i \\<in> I then X i else X j)\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "have rv: \"random_variable (N' i) (Y i)\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable (N' i) (Y i)", "using j"], ["proof (prove)\nusing this:\n  j \\<in> I\n\ngoal (1 subgoal):\n 1. random_variable (N' i) (Y i)", "by (auto simp: N'_def Y_def intro: assms)"], ["proof (state)\nthis:\n  random_variable (N' ?i12) (Y ?i12)\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "have \"indep_vars M' X I = indep_vars N' Y I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. indep_vars M' X I = indep_vars N' Y I", "by (intro indep_vars_cong) (auto simp: N'_def Y_def)"], ["proof (state)\nthis:\n  indep_vars M' X I = indep_vars N' Y I\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "also"], ["proof (state)\nthis:\n  indep_vars M' X I = indep_vars N' Y I\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "have \"\\<dots> \\<longleftrightarrow> distr M (\\<Pi>\\<^sub>M i\\<in>I. N' i) (\\<lambda>x. \\<lambda>i\\<in>I. Y i x) = (\\<Pi>\\<^sub>M i\\<in>I. distr M (N' i) (Y i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. indep_vars N' Y I =\n    (distr M (Pi\\<^sub>M I N') (\\<lambda>x. \\<lambda>i\\<in>I. Y i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (N' i) (Y i)))", "by (intro indep_vars_iff_distr_eq_PiM rv assms)"], ["proof (state)\nthis:\n  indep_vars N' Y I =\n  (distr M (Pi\\<^sub>M I N') (\\<lambda>x. \\<lambda>i\\<in>I. Y i x) =\n   Pi\\<^sub>M I (\\<lambda>i. distr M (N' i) (Y i)))\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "also"], ["proof (state)\nthis:\n  indep_vars N' Y I =\n  (distr M (Pi\\<^sub>M I N') (\\<lambda>x. \\<lambda>i\\<in>I. Y i x) =\n   Pi\\<^sub>M I (\\<lambda>i. distr M (N' i) (Y i)))\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "have \"(\\<Pi>\\<^sub>M i\\<in>I. N' i) = (\\<Pi>\\<^sub>M i\\<in>I. M' i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Pi\\<^sub>M I N' = Pi\\<^sub>M I M'", "by (intro PiM_cong) (simp_all add: N'_def)"], ["proof (state)\nthis:\n  Pi\\<^sub>M I N' = Pi\\<^sub>M I M'\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "also"], ["proof (state)\nthis:\n  Pi\\<^sub>M I N' = Pi\\<^sub>M I M'\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "have \"(\\<lambda>x. \\<lambda>i\\<in>I. Y i x) = (\\<lambda>x. \\<lambda>i\\<in>I. X i x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. \\<lambda>i\\<in>I. Y i x) =\n    (\\<lambda>x. \\<lambda>i\\<in>I. X i x)", "by (simp_all add: Y_def fun_eq_iff)"], ["proof (state)\nthis:\n  (\\<lambda>x. \\<lambda>i\\<in>I. Y i x) =\n  (\\<lambda>x. \\<lambda>i\\<in>I. X i x)\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "also"], ["proof (state)\nthis:\n  (\\<lambda>x. \\<lambda>i\\<in>I. Y i x) =\n  (\\<lambda>x. \\<lambda>i\\<in>I. X i x)\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "have \"(\\<Pi>\\<^sub>M i\\<in>I. distr M (N' i) (Y i)) = (\\<Pi>\\<^sub>M i\\<in>I. distr M (M' i) (X i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Pi\\<^sub>M I (\\<lambda>i. distr M (N' i) (Y i)) =\n    Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i))", "by (intro PiM_cong distr_cong) (simp_all add: N'_def Y_def)"], ["proof (state)\nthis:\n  Pi\\<^sub>M I (\\<lambda>i. distr M (N' i) (Y i)) =\n  Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i))\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "finally"], ["proof (chain)\npicking this:\n  indep_vars M' X I =\n  (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n   Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "show ?thesis"], ["proof (prove)\nusing this:\n  indep_vars M' X I =\n  (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n   Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))\n\ngoal (1 subgoal):\n 1. indep_vars M' X I =\n    (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n     Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))", "."], ["proof (state)\nthis:\n  indep_vars M' X I =\n  (distr M (Pi\\<^sub>M I M') (\\<lambda>x. \\<lambda>i\\<in>I. X i x) =\n   Pi\\<^sub>M I (\\<lambda>i. distr M (M' i) (X i)))\n\ngoal:\nNo subgoals!", "qed"], ["", "(* TODO: Move *)"], ["", "lemma indep_vars_PiM_components:\n  assumes \"\\<And>i. i \\<in> A \\<Longrightarrow> prob_space (M i)\"\n  shows   \"prob_space.indep_vars (PiM A M) M (\\<lambda>i f. f i) A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "proof (cases \"A = {}\")"], ["proof (state)\ngoal (2 subgoals):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A\n 2. A \\<noteq> {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "case False"], ["proof (state)\nthis:\n  A \\<noteq> {}\n\ngoal (2 subgoals):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A\n 2. A \\<noteq> {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "have \"distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. restrict x A) = distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. restrict x A) =\n    distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. x)", "by (intro distr_cong) (auto simp: restrict_def space_PiM PiE_def extensional_def Pi_def)"], ["proof (state)\nthis:\n  distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. restrict x A) =\n  distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. x)\n\ngoal (2 subgoals):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A\n 2. A \\<noteq> {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "also"], ["proof (state)\nthis:\n  distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. restrict x A) =\n  distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. x)\n\ngoal (2 subgoals):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A\n 2. A \\<noteq> {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "have \"\\<dots> = Pi\\<^sub>M A M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. x) = Pi\\<^sub>M A M", "by simp"], ["proof (state)\nthis:\n  distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. x) = Pi\\<^sub>M A M\n\ngoal (2 subgoals):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A\n 2. A \\<noteq> {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "also"], ["proof (state)\nthis:\n  distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. x) = Pi\\<^sub>M A M\n\ngoal (2 subgoals):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A\n 2. A \\<noteq> {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "have \"\\<dots> = Pi\\<^sub>M A (\\<lambda>i. distr (Pi\\<^sub>M A M) (M i) (\\<lambda>f. f i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Pi\\<^sub>M A M =\n    Pi\\<^sub>M A\n     (\\<lambda>i. distr (Pi\\<^sub>M A M) (M i) (\\<lambda>f. f i))", "by (intro PiM_cong refl, subst distr_PiM_component) (auto simp: assms)"], ["proof (state)\nthis:\n  Pi\\<^sub>M A M =\n  Pi\\<^sub>M A (\\<lambda>i. distr (Pi\\<^sub>M A M) (M i) (\\<lambda>f. f i))\n\ngoal (2 subgoals):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A\n 2. A \\<noteq> {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "finally"], ["proof (chain)\npicking this:\n  distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. restrict x A) =\n  Pi\\<^sub>M A (\\<lambda>i. distr (Pi\\<^sub>M A M) (M i) (\\<lambda>f. f i))", "show ?thesis"], ["proof (prove)\nusing this:\n  distr (Pi\\<^sub>M A M) (Pi\\<^sub>M A M) (\\<lambda>x. restrict x A) =\n  Pi\\<^sub>M A (\\<lambda>i. distr (Pi\\<^sub>M A M) (M i) (\\<lambda>f. f i))\n\ngoal (1 subgoal):\n 1. prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "by (subst prob_space.indep_vars_iff_distr_eq_PiM') (simp_all add: prob_space_PiM assms False)"], ["proof (state)\nthis:\n  prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A\n\ngoal (1 subgoal):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "case True"], ["proof (state)\nthis:\n  A = {}\n\ngoal (1 subgoal):\n 1. A = {} \\<Longrightarrow>\n    prob_space.indep_vars (Pi\\<^sub>M A M) M (\\<lambda>i f. f i) A", "interpret prob_space \"PiM A M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob_space (Pi\\<^sub>M A M)", "by (intro prob_space_PiM assms)"], ["proof (state)\ngoal (1 subgoal):\n 1. A = {} \\<Longrightarrow> indep_vars M (\\<lambda>i f. f i) A", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. indep_vars M (\\<lambda>i f. f i) A", "unfolding indep_vars_def indep_sets_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>i\\<in>A. random_variable (M i) (\\<lambda>f. f i)) \\<and>\n    (\\<forall>i\\<in>A.\n        sigma_sets (space (Pi\\<^sub>M A M))\n         {(\\<lambda>f. f i) -` Aa \\<inter> space (Pi\\<^sub>M A M) |Aa.\n          Aa \\<in> sets (M i)}\n        \\<subseteq> events) \\<and>\n    (\\<forall>J\\<subseteq>A.\n        J \\<noteq> {} \\<longrightarrow>\n        finite J \\<longrightarrow>\n        (\\<forall>A\\<in>\\<Pi> i\\<in>J.\n                           sigma_sets (space (Pi\\<^sub>M A M))\n                            {(\\<lambda>f. f i) -` Aa \\<inter>\n                             space (Pi\\<^sub>M A M) |\n                             Aa. Aa \\<in> sets (M i)}.\n            prob (\\<Inter> (A ` J)) = (\\<Prod>j\\<in>J. prob (A j))))", "by (auto simp: True)"], ["proof (state)\nthis:\n  indep_vars M (\\<lambda>i f. f i) A\n\ngoal:\nNo subgoals!", "qed"], ["", "(* TODO: Move *)"], ["", "lemma indep_vars_PiM_components':\n  assumes \"\\<And>i. i \\<in> A \\<Longrightarrow> prob_space (M i)\"\n  assumes \"\\<And>i. i \\<in> A \\<Longrightarrow> g i \\<in> M i \\<rightarrow>\\<^sub>M N i\"\n  shows   \"prob_space.indep_vars (PiM A M) N (\\<lambda>i f. g i (f i)) A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob_space.indep_vars (Pi\\<^sub>M A M) N (\\<lambda>i f. g i (f i)) A", "by (rule prob_space.indep_vars_compose2[OF prob_space_PiM indep_vars_PiM_components])\n     (use assms in simp_all)"], ["", "(* TODO: Move *)"], ["", "lemma integrable_bernoulli_pmf [intro]:\n  fixes f :: \"bool \\<Rightarrow> 'a :: {banach, second_countable_topology}\"\n  shows \"integrable (bernoulli_pmf p) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable (measure_pmf (bernoulli_pmf p)) f", "by (rule integrable_measure_pmf_finite) auto"], ["", "(* TODO: Move *)"], ["", "lemma expectation_bernoulli_pmf:\n  fixes f :: \"bool \\<Rightarrow> 'a :: {banach, second_countable_topology}\"\n  assumes p: \"p \\<in> {0..1}\"\n  shows   \"measure_pmf.expectation (bernoulli_pmf p) f = p *\\<^sub>R f True + (1 - p) *\\<^sub>R f False\""], ["proof (prove)\ngoal (1 subgoal):\n 1. measure_pmf.expectation (bernoulli_pmf p) f =\n    p *\\<^sub>R f True + (1 - p) *\\<^sub>R f False", "using p"], ["proof (prove)\nusing this:\n  p \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. measure_pmf.expectation (bernoulli_pmf p) f =\n    p *\\<^sub>R f True + (1 - p) *\\<^sub>R f False", "by (subst integral_measure_pmf[of UNIV]) (auto simp: UNIV_bool)"], ["", "experiment\n  fixes p :: real\n  assumes p: \"p \\<in> {0..1}\"\nbegin"], ["", "definition M :: \"(nat \\<Rightarrow> bool) measure\"\n  where \"M = (\\<Pi>\\<^sub>M i\\<in>(UNIV :: nat set). measure_pmf (bernoulli_pmf p))\""], ["", "definition X :: \"nat \\<Rightarrow> (nat \\<Rightarrow> bool) \\<Rightarrow> real\"\n  where \"X = (\\<lambda>i f. if f i then 1 else 0)\""], ["", "interpretation prob_space M"], ["proof (prove)\ngoal (1 subgoal):\n 1. prob_space M", "unfolding M_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. prob_space (Pi\\<^sub>M UNIV (\\<lambda>i. measure_pmf (bernoulli_pmf p)))", "by (intro prob_space_PiM measure_pmf.prob_space_axioms)"], ["", "lemma random_variable_component: \"random_variable (count_space UNIV) (\\<lambda>f. f i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable (count_space UNIV) (\\<lambda>f. f i)", "unfolding X_def M_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Measurable.pred\n     (Pi\\<^sub>M UNIV (\\<lambda>i. measure_pmf (bernoulli_pmf p)))\n     (\\<lambda>f. f i)", "by measurable"], ["", "lemma random_variable_X [measurable]: \"random_variable borel (X i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable borel (X i)", "unfolding X_def M_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. if f i then 1 else 0)\n    \\<in> borel_measurable\n           (Pi\\<^sub>M UNIV (\\<lambda>i. measure_pmf (bernoulli_pmf p)))", "by measurable"], ["", "lemma distr_M_component: \"distr M (count_space UNIV) (\\<lambda>f. f i) = measure_pmf (bernoulli_pmf p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>f. f i) =\n    measure_pmf (bernoulli_pmf p)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>f. f i) =\n    measure_pmf (bernoulli_pmf p)", "have \"distr M (count_space UNIV) (\\<lambda>f. f i) = distr M (measure_pmf (bernoulli_pmf p)) (\\<lambda>f. f i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>f. f i) =\n    distr M (measure_pmf (bernoulli_pmf p)) (\\<lambda>f. f i)", "by (rule distr_cong) auto"], ["proof (state)\nthis:\n  distr M (count_space UNIV) (\\<lambda>f. f i) =\n  distr M (measure_pmf (bernoulli_pmf p)) (\\<lambda>f. f i)\n\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>f. f i) =\n    measure_pmf (bernoulli_pmf p)", "also"], ["proof (state)\nthis:\n  distr M (count_space UNIV) (\\<lambda>f. f i) =\n  distr M (measure_pmf (bernoulli_pmf p)) (\\<lambda>f. f i)\n\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>f. f i) =\n    measure_pmf (bernoulli_pmf p)", "have \"\\<dots> = measure_pmf (bernoulli_pmf p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M (measure_pmf (bernoulli_pmf p)) (\\<lambda>f. f i) =\n    measure_pmf (bernoulli_pmf p)", "unfolding M_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. distr (Pi\\<^sub>M UNIV (\\<lambda>i. measure_pmf (bernoulli_pmf p)))\n     (measure_pmf (bernoulli_pmf p)) (\\<lambda>f. f i) =\n    measure_pmf (bernoulli_pmf p)", "by (subst distr_PiM_component) (simp_all add: measure_pmf.prob_space_axioms)"], ["proof (state)\nthis:\n  distr M (measure_pmf (bernoulli_pmf p)) (\\<lambda>f. f i) =\n  measure_pmf (bernoulli_pmf p)\n\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>f. f i) =\n    measure_pmf (bernoulli_pmf p)", "finally"], ["proof (chain)\npicking this:\n  distr M (count_space UNIV) (\\<lambda>f. f i) =\n  measure_pmf (bernoulli_pmf p)", "show ?thesis"], ["proof (prove)\nusing this:\n  distr M (count_space UNIV) (\\<lambda>f. f i) =\n  measure_pmf (bernoulli_pmf p)\n\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>f. f i) =\n    measure_pmf (bernoulli_pmf p)", "."], ["proof (state)\nthis:\n  distr M (count_space UNIV) (\\<lambda>f. f i) =\n  measure_pmf (bernoulli_pmf p)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma distr_M_X:\n  \"distr M borel (X i) = distr (measure_pmf (bernoulli_pmf p)) borel (\\<lambda>b. if b then 1 else 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M borel (X i) =\n    distr (measure_pmf (bernoulli_pmf p)) borel\n     (\\<lambda>b. if b then 1 else 0)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. distr M borel (X i) =\n    distr (measure_pmf (bernoulli_pmf p)) borel\n     (\\<lambda>b. if b then 1 else 0)", "have \"distr M borel (X i) = distr (distr M (count_space UNIV) (\\<lambda>f. f i)) \n                                    borel (\\<lambda>b. if b then 1 else 0 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M borel (X i) =\n    distr (distr M (count_space UNIV) (\\<lambda>f. f i)) borel\n     (\\<lambda>b. if b then 1 else 0)", "by (subst distr_distr) (auto simp: M_def X_def o_def)"], ["proof (state)\nthis:\n  distr M borel (X i) =\n  distr (distr M (count_space UNIV) (\\<lambda>f. f i)) borel\n   (\\<lambda>b. if b then 1 else 0)\n\ngoal (1 subgoal):\n 1. distr M borel (X i) =\n    distr (measure_pmf (bernoulli_pmf p)) borel\n     (\\<lambda>b. if b then 1 else 0)", "also"], ["proof (state)\nthis:\n  distr M borel (X i) =\n  distr (distr M (count_space UNIV) (\\<lambda>f. f i)) borel\n   (\\<lambda>b. if b then 1 else 0)\n\ngoal (1 subgoal):\n 1. distr M borel (X i) =\n    distr (measure_pmf (bernoulli_pmf p)) borel\n     (\\<lambda>b. if b then 1 else 0)", "note distr_M_component[of i]"], ["proof (state)\nthis:\n  distr M (count_space UNIV) (\\<lambda>f. f i) =\n  measure_pmf (bernoulli_pmf p)\n\ngoal (1 subgoal):\n 1. distr M borel (X i) =\n    distr (measure_pmf (bernoulli_pmf p)) borel\n     (\\<lambda>b. if b then 1 else 0)", "finally"], ["proof (chain)\npicking this:\n  distr M borel (X i) =\n  distr (measure_pmf (bernoulli_pmf p)) borel\n   (\\<lambda>b. if b then 1 else 0)", "show ?thesis"], ["proof (prove)\nusing this:\n  distr M borel (X i) =\n  distr (measure_pmf (bernoulli_pmf p)) borel\n   (\\<lambda>b. if b then 1 else 0)\n\ngoal (1 subgoal):\n 1. distr M borel (X i) =\n    distr (measure_pmf (bernoulli_pmf p)) borel\n     (\\<lambda>b. if b then 1 else 0)", "by simp"], ["proof (state)\nthis:\n  distr M borel (X i) =\n  distr (measure_pmf (bernoulli_pmf p)) borel\n   (\\<lambda>b. if b then 1 else 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma X_has_expectation: \"integrable M (X 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (X 0)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. integrable M (X 0)", "have \"integrable (bernoulli_pmf p) (\\<lambda>b. if b then 1 else 0 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable (measure_pmf (bernoulli_pmf p))\n     (\\<lambda>b. if b then 1 else 0)", "by auto"], ["proof (state)\nthis:\n  integrable (measure_pmf (bernoulli_pmf p))\n   (\\<lambda>b. if b then 1 else 0)\n\ngoal (1 subgoal):\n 1. integrable M (X 0)", "also"], ["proof (state)\nthis:\n  integrable (measure_pmf (bernoulli_pmf p))\n   (\\<lambda>b. if b then 1 else 0)\n\ngoal (1 subgoal):\n 1. integrable M (X 0)", "have \"measure_pmf (bernoulli_pmf p) = distr M (count_space UNIV) (\\<lambda>f. f 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. measure_pmf (bernoulli_pmf p) =\n    distr M (count_space UNIV) (\\<lambda>f. f 0)", "by (simp add: distr_M_component)"], ["proof (state)\nthis:\n  measure_pmf (bernoulli_pmf p) =\n  distr M (count_space UNIV) (\\<lambda>f. f 0)\n\ngoal (1 subgoal):\n 1. integrable M (X 0)", "also"], ["proof (state)\nthis:\n  measure_pmf (bernoulli_pmf p) =\n  distr M (count_space UNIV) (\\<lambda>f. f 0)\n\ngoal (1 subgoal):\n 1. integrable M (X 0)", "have \"integrable \\<dots> (\\<lambda>b. if b then 1 else 0 :: real) = integrable M (X 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable (distr M (count_space UNIV) (\\<lambda>f. f 0))\n     (\\<lambda>b. if b then 1 else 0) =\n    integrable M (X 0)", "unfolding X_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable (distr M (count_space UNIV) (\\<lambda>f. f 0))\n     (\\<lambda>b. if b then 1 else 0) =\n    integrable M (\\<lambda>f. if f 0 then 1 else 0)", "using random_variable_component"], ["proof (prove)\nusing this:\n  random_variable (count_space UNIV) (\\<lambda>f. f ?i)\n\ngoal (1 subgoal):\n 1. integrable (distr M (count_space UNIV) (\\<lambda>f. f 0))\n     (\\<lambda>b. if b then 1 else 0) =\n    integrable M (\\<lambda>f. if f 0 then 1 else 0)", "by (subst integrable_distr_eq) auto"], ["proof (state)\nthis:\n  integrable (distr M (count_space UNIV) (\\<lambda>f. f 0))\n   (\\<lambda>b. if b then 1 else 0) =\n  integrable M (X 0)\n\ngoal (1 subgoal):\n 1. integrable M (X 0)", "finally"], ["proof (chain)\npicking this:\n  integrable M (X 0)", "show ?thesis"], ["proof (prove)\nusing this:\n  integrable M (X 0)\n\ngoal (1 subgoal):\n 1. integrable M (X 0)", "."], ["proof (state)\nthis:\n  integrable M (X 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma indep: \"indep_vars (\\<lambda>_. borel) X UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. indep_vars (\\<lambda>_. borel) X UNIV", "unfolding M_def X_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. prob_space.indep_vars\n     (Pi\\<^sub>M UNIV (\\<lambda>i. measure_pmf (bernoulli_pmf p)))\n     (\\<lambda>_. borel) (\\<lambda>i f. if f i then 1 else 0) UNIV", "by (rule indep_vars_PiM_components') (simp_all add: measure_pmf.prob_space_axioms)"], ["", "lemma expectation_X: \"expectation (X i) = p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (X i) = p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. expectation (X i) = p", "have \"expectation (X i) =\n        lebesgue_integral (distr M (count_space UNIV) (\\<lambda>f. f i)) (\\<lambda>b. if b then 1 else 0 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (X i) =\n    LINT b|distr M (count_space UNIV) (\\<lambda>f. f i).\n       (if b then 1 else 0)", "by (subst integral_distr) (simp_all add: random_variable_component X_def)"], ["proof (state)\nthis:\n  expectation (X i) =\n  LINT b|distr M (count_space UNIV) (\\<lambda>f. f i). (if b then 1 else 0)\n\ngoal (1 subgoal):\n 1. expectation (X i) = p", "also"], ["proof (state)\nthis:\n  expectation (X i) =\n  LINT b|distr M (count_space UNIV) (\\<lambda>f. f i). (if b then 1 else 0)\n\ngoal (1 subgoal):\n 1. expectation (X i) = p", "have \"distr M (count_space UNIV) (\\<lambda>x. x i) = measure_pmf (bernoulli_pmf p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>x. x i) =\n    measure_pmf (bernoulli_pmf p)", "by (rule distr_M_component)"], ["proof (state)\nthis:\n  distr M (count_space UNIV) (\\<lambda>x. x i) =\n  measure_pmf (bernoulli_pmf p)\n\ngoal (1 subgoal):\n 1. expectation (X i) = p", "also"], ["proof (state)\nthis:\n  distr M (count_space UNIV) (\\<lambda>x. x i) =\n  measure_pmf (bernoulli_pmf p)\n\ngoal (1 subgoal):\n 1. expectation (X i) = p", "have \"measure_pmf.expectation (bernoulli_pmf p) (\\<lambda>b. if b then 1 else 0 :: real) = p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. measure_pmf.expectation (bernoulli_pmf p)\n     (\\<lambda>b. if b then 1 else 0) =\n    p", "using p"], ["proof (prove)\nusing this:\n  p \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. measure_pmf.expectation (bernoulli_pmf p)\n     (\\<lambda>b. if b then 1 else 0) =\n    p", "by (subst integral_bernoulli_pmf) auto"], ["proof (state)\nthis:\n  measure_pmf.expectation (bernoulli_pmf p)\n   (\\<lambda>b. if b then 1 else 0) =\n  p\n\ngoal (1 subgoal):\n 1. expectation (X i) = p", "finally"], ["proof (chain)\npicking this:\n  expectation (X i) = p", "show ?thesis"], ["proof (prove)\nusing this:\n  expectation (X i) = p\n\ngoal (1 subgoal):\n 1. expectation (X i) = p", "."], ["proof (state)\nthis:\n  expectation (X i) = p\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem \"AE f in M. (\\<lambda>n. card {i. i < n \\<and> f i} / n) \\<longlonglongrightarrow> p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "have \"AE f in M. (\\<lambda>n. (\\<Sum>i<n. X i f) / real n) \\<longlonglongrightarrow> expectation (X 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. (\\<Sum>i<n. X i f) / real n)\n               \\<longlonglongrightarrow> expectation (X 0)", "by (rule strong_law_of_large_numbers_iid)\n       (use indep X_has_expectation in \\<open>simp_all add: distr_M_X\\<close>)"], ["proof (state)\nthis:\n  AE f in M. (\\<lambda>n. (\\<Sum>i<n. X i f) / real n)\n             \\<longlonglongrightarrow> expectation (X 0)\n\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "also"], ["proof (state)\nthis:\n  AE f in M. (\\<lambda>n. (\\<Sum>i<n. X i f) / real n)\n             \\<longlonglongrightarrow> expectation (X 0)\n\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "have \"expectation (X 0) = p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (X 0) = p", "by (simp add: expectation_X)"], ["proof (state)\nthis:\n  expectation (X 0) = p\n\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "also"], ["proof (state)\nthis:\n  expectation (X 0) = p\n\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "have \"(\\<lambda>x n. \\<Sum>i<n. X i x) = (\\<lambda>x n. \\<Sum>i\\<in>{i\\<in>{..<n}. x i}. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x n. \\<Sum>i<n. X i x) =\n    (\\<lambda>x n. \\<Sum>i | i \\<in> {..<n} \\<and> x i. 1)", "by (intro ext sum.mono_neutral_cong_right) (auto simp: X_def)"], ["proof (state)\nthis:\n  (\\<lambda>x n. \\<Sum>i<n. X i x) =\n  (\\<lambda>x n. \\<Sum>i | i \\<in> {..<n} \\<and> x i. 1)\n\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "also"], ["proof (state)\nthis:\n  (\\<lambda>x n. \\<Sum>i<n. X i x) =\n  (\\<lambda>x n. \\<Sum>i | i \\<in> {..<n} \\<and> x i. 1)\n\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "have \"\\<dots> = (\\<lambda>x n. real (card {i. i < n \\<and> x i}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x n. \\<Sum>i | i \\<in> {..<n} \\<and> x i. 1) =\n    (\\<lambda>x n. real (card {i. i < n \\<and> x i}))", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>x n. \\<Sum>i | i \\<in> {..<n} \\<and> x i. 1) =\n  (\\<lambda>x n. real (card {i. i < n \\<and> x i}))\n\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "finally"], ["proof (chain)\npicking this:\n  AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n             \\<longlonglongrightarrow> p", "show ?thesis"], ["proof (prove)\nusing this:\n  AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n             \\<longlonglongrightarrow> p\n\ngoal (1 subgoal):\n 1. AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n               \\<longlonglongrightarrow> p", "."], ["proof (state)\nthis:\n  AE f in M. (\\<lambda>n. real (card {i. i < n \\<and> f i}) / real n)\n             \\<longlonglongrightarrow> p\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"]]}