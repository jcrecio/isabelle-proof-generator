{"file_name": "/home/qj213/afp-2021-10-22/thys/Automated_Stateful_Protocol_Verification/Term_Variants.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Automated_Stateful_Protocol_Verification", "problem_names": ["lemma term_variants_pred_inv:\n  assumes \"term_variants_pred P (Fun f T) (Fun h S)\"\n  shows \"length T = length S\"\n    and \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i)\"\n    and \"f \\<noteq> h \\<Longrightarrow> h \\<in> set (P f)\"", "lemma term_variants_pred_inv':\n  assumes \"term_variants_pred P (Fun f T) t\"\n  shows \"is_Fun t\"\n    and \"length T = length (args t)\"\n    and \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (args t ! i)\"\n    and \"f \\<noteq> the_Fun t \\<Longrightarrow> the_Fun t \\<in> set (P f)\"\n    and \"P \\<equiv> (\\<lambda>_. [])(g := [h]) \\<Longrightarrow> f \\<noteq> the_Fun t \\<Longrightarrow> f = g \\<and> the_Fun t = h\"", "lemma term_variants_pred_inv'':\n  assumes \"term_variants_pred P t (Fun f T)\"\n  shows \"is_Fun t\"\n    and \"length T = length (args t)\"\n    and \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred P (args t ! i) (T ! i)\"\n    and \"f \\<noteq> the_Fun t \\<Longrightarrow> f \\<in> set (P (the_Fun t))\"\n    and \"P \\<equiv> (\\<lambda>_. [])(g := [h]) \\<Longrightarrow> f \\<noteq> the_Fun t \\<Longrightarrow> f = h \\<and> the_Fun t = g\"", "lemma term_variants_pred_inv_Var:\n  \"term_variants_pred P (Var x) t \\<longleftrightarrow> t = Var x\"\n  \"term_variants_pred P t (Var x) \\<longleftrightarrow> t = Var x\"", "lemma term_variants_pred_inv_const:\n  \"term_variants_pred P (Fun c []) t \\<longleftrightarrow> ((\\<exists>g \\<in> set (P c). t = Fun g []) \\<or> (t = Fun c []))\"", "lemma term_variants_pred_refl: \"term_variants_pred P t t\"", "lemma term_variants_pred_refl_inv:\n  assumes st: \"term_variants_pred P s t\"\n    and P: \"\\<forall>f. \\<forall>g \\<in> set (P f). f = g\"\n  shows \"s = t\"", "lemma term_variants_pred_const:\n  assumes \"b \\<in> set (P a)\"\n  shows \"term_variants_pred P (Fun a []) (Fun b [])\"", "lemma term_variants_pred_const_cases:\n  \"P a \\<noteq> [] \\<Longrightarrow> term_variants_pred P (Fun a []) t \\<longleftrightarrow>\n                 (t = Fun a [] \\<or> (\\<exists>b \\<in> set (P a). t = Fun b []))\"\n  \"P a = [] \\<Longrightarrow> term_variants_pred P (Fun a []) t \\<longleftrightarrow> t = Fun a []\"", "lemma term_variants_pred_param:\n  assumes \"term_variants_pred P t s\"\n    and fg: \"f = g \\<or> g \\<in> set (P f)\"\n  shows \"term_variants_pred P (Fun f (S@t#T)) (Fun g (S@s#T))\"", "lemma term_variants_pred_Cons:\n  assumes t: \"term_variants_pred P t s\"\n    and T: \"term_variants_pred P (Fun f T) (Fun f S)\"\n    and fg: \"f = g \\<or> g \\<in> set (P f)\"\n  shows \"term_variants_pred P (Fun f (t#T)) (Fun g (s#S))\"", "lemma term_variants_pred_dense:\n  fixes P Q::\"'a set\" and fs gs::\"'a list\"\n  defines \"P_fs x \\<equiv> if x \\<in> P then fs else []\"\n    and \"P_gs x \\<equiv> if x \\<in> P then gs else []\"\n    and \"Q_fs x \\<equiv> if x \\<in> Q then fs else []\"\n  assumes ut: \"term_variants_pred P_fs u t\"\n    and g: \"g \\<in> Q\" \"g \\<in> set gs\"\n  shows \"\\<exists>s. term_variants_pred P_gs u s \\<and> term_variants_pred Q_fs s t\"", "lemma term_variants_pred_dense':\n  assumes ut: \"term_variants_pred ((\\<lambda>_. [])(a := [b])) u t\"\n  shows \"\\<exists>s. term_variants_pred ((\\<lambda>_. [])(a := [c])) u s \\<and>\n             term_variants_pred ((\\<lambda>_. [])(c := [b])) s t\"", "lemma term_variants_pred_eq_case:\n  fixes t s::\"('a,'b) term\"\n  assumes \"term_variants_pred P t s\" \"\\<forall>f \\<in> funs_term t. P f = []\"\n  shows \"t = s\"", "lemma term_variants_pred_subst:\n  assumes \"term_variants_pred P t s\"\n  shows \"term_variants_pred P (t \\<cdot> \\<delta>) (s \\<cdot> \\<delta>)\"", "lemma term_variants_pred_subst':\n  fixes t s::\"('a,'b) term\" and \\<delta>::\"('a,'b) subst\"\n  assumes \"term_variants_pred P (t \\<cdot> \\<delta>) s\"\n    and \"\\<forall>x \\<in> fv t \\<union> fv s. (\\<exists>y. \\<delta> x = Var y) \\<or> (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\"\n  shows \"\\<exists>u. term_variants_pred P t u \\<and> s = u \\<cdot> \\<delta>\"", "lemma term_variants_pred_iff_in_term_variants:\n  fixes t::\"('a,'b) term\"\n  shows \"term_variants_pred P t s \\<longleftrightarrow> s \\<in> set (term_variants P t)\"\n    (is \"?A t s \\<longleftrightarrow> ?B t s\")", "lemma term_variants_pred_finite:\n  \"finite {s. term_variants_pred P t s}\"", "lemma term_variants_pred_fv_eq:\n  assumes \"term_variants_pred P s t\"\n  shows \"fv s = fv t\"", "lemma (in intruder_model) term_variants_pred_wf_trms:\n  assumes \"term_variants_pred P s t\"\n    and \"\\<And>f g. g \\<in> set (P f) \\<Longrightarrow> arity f = arity g\"\n    and \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\"\n  shows \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\"", "lemma term_variants_pred_funs_term:\n  assumes \"term_variants_pred P s t\"\n    and \"f \\<in> funs_term t\"\n  shows \"f \\<in> funs_term s \\<or> (\\<exists>g \\<in> funs_term s. f \\<in> set (P g))\""], "translations": [["", "lemma term_variants_pred_inv:\n  assumes \"term_variants_pred P (Fun f T) (Fun h S)\"\n  shows \"length T = length S\"\n    and \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i)\"\n    and \"f \\<noteq> h \\<Longrightarrow> h \\<in> set (P f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length T = length S &&&\n    (\\<And>i.\n        i < length T \\<Longrightarrow>\n        term_variants_pred P (T ! i) (S ! i)) &&&\n    (f \\<noteq> h \\<Longrightarrow> h \\<in> set (P f))", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P (Fun f T) (Fun h S)\n\ngoal (1 subgoal):\n 1. length T = length S &&&\n    (\\<And>i.\n        i < length T \\<Longrightarrow>\n        term_variants_pred P (T ! i) (S ! i)) &&&\n    (f \\<noteq> h \\<Longrightarrow> h \\<in> set (P f))", "by (auto elim: term_variants_pred.cases)"], ["", "lemma term_variants_pred_inv':\n  assumes \"term_variants_pred P (Fun f T) t\"\n  shows \"is_Fun t\"\n    and \"length T = length (args t)\"\n    and \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (args t ! i)\"\n    and \"f \\<noteq> the_Fun t \\<Longrightarrow> the_Fun t \\<in> set (P f)\"\n    and \"P \\<equiv> (\\<lambda>_. [])(g := [h]) \\<Longrightarrow> f \\<noteq> the_Fun t \\<Longrightarrow> f = g \\<and> the_Fun t = h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (is_Fun t &&& length T = length (args t)) &&&\n    (\\<And>i.\n        i < length T \\<Longrightarrow>\n        term_variants_pred P (T ! i) (args t ! i)) &&&\n    (f \\<noteq> the_Fun t \\<Longrightarrow> the_Fun t \\<in> set (P f)) &&&\n    (\\<lbrakk>P \\<equiv> (\\<lambda>_. [])(g := [h]);\n      f \\<noteq> the_Fun t\\<rbrakk>\n     \\<Longrightarrow> f = g \\<and> the_Fun t = h)", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P (Fun f T) t\n\ngoal (1 subgoal):\n 1. (is_Fun t &&& length T = length (args t)) &&&\n    (\\<And>i.\n        i < length T \\<Longrightarrow>\n        term_variants_pred P (T ! i) (args t ! i)) &&&\n    (f \\<noteq> the_Fun t \\<Longrightarrow> the_Fun t \\<in> set (P f)) &&&\n    (\\<lbrakk>P \\<equiv> (\\<lambda>_. [])(g := [h]);\n      f \\<noteq> the_Fun t\\<rbrakk>\n     \\<Longrightarrow> f = g \\<and> the_Fun t = h)", "by (auto elim: term_variants_pred.cases)"], ["", "lemma term_variants_pred_inv'':\n  assumes \"term_variants_pred P t (Fun f T)\"\n  shows \"is_Fun t\"\n    and \"length T = length (args t)\"\n    and \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred P (args t ! i) (T ! i)\"\n    and \"f \\<noteq> the_Fun t \\<Longrightarrow> f \\<in> set (P (the_Fun t))\"\n    and \"P \\<equiv> (\\<lambda>_. [])(g := [h]) \\<Longrightarrow> f \\<noteq> the_Fun t \\<Longrightarrow> f = h \\<and> the_Fun t = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (is_Fun t &&& length T = length (args t)) &&&\n    (\\<And>i.\n        i < length T \\<Longrightarrow>\n        term_variants_pred P (args t ! i) (T ! i)) &&&\n    (f \\<noteq> the_Fun t \\<Longrightarrow> f \\<in> set (P (the_Fun t))) &&&\n    (\\<lbrakk>P \\<equiv> (\\<lambda>_. [])(g := [h]);\n      f \\<noteq> the_Fun t\\<rbrakk>\n     \\<Longrightarrow> f = h \\<and> the_Fun t = g)", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P t (Fun f T)\n\ngoal (1 subgoal):\n 1. (is_Fun t &&& length T = length (args t)) &&&\n    (\\<And>i.\n        i < length T \\<Longrightarrow>\n        term_variants_pred P (args t ! i) (T ! i)) &&&\n    (f \\<noteq> the_Fun t \\<Longrightarrow> f \\<in> set (P (the_Fun t))) &&&\n    (\\<lbrakk>P \\<equiv> (\\<lambda>_. [])(g := [h]);\n      f \\<noteq> the_Fun t\\<rbrakk>\n     \\<Longrightarrow> f = h \\<and> the_Fun t = g)", "by (auto elim: term_variants_pred.cases)"], ["", "lemma term_variants_pred_inv_Var:\n  \"term_variants_pred P (Var x) t \\<longleftrightarrow> t = Var x\"\n  \"term_variants_pred P t (Var x) \\<longleftrightarrow> t = Var x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Var x) t = (t = Var x) &&&\n    term_variants_pred P t (Var x) = (t = Var x)", "by (auto intro: term_variants_Var elim: term_variants_pred.cases)"], ["", "lemma term_variants_pred_inv_const:\n  \"term_variants_pred P (Fun c []) t \\<longleftrightarrow> ((\\<exists>g \\<in> set (P c). t = Fun g []) \\<or> (t = Fun c []))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun c []) t =\n    ((\\<exists>g\\<in>set (P c). t = Fun g []) \\<or> t = Fun c [])", "by (auto intro: term_variants_P term_variants_Fun elim: term_variants_pred.cases)"], ["", "lemma term_variants_pred_refl: \"term_variants_pred P t t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P t t", "by (induct t) (auto intro: term_variants_pred.intros)"], ["", "lemma term_variants_pred_refl_inv:\n  assumes st: \"term_variants_pred P s t\"\n    and P: \"\\<forall>f. \\<forall>g \\<in> set (P f). f = g\"\n  shows \"s = t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. s = t", "using st P"], ["proof (prove)\nusing this:\n  term_variants_pred P s t\n  \\<forall>f. \\<forall>g\\<in>set (P f). f = g\n\ngoal (1 subgoal):\n 1. s = t", "proof (induction s t rule: term_variants_pred.induct)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P x.\n       \\<forall>f. Ball (set (P f)) ((=) f) \\<Longrightarrow> Var x = Var x\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f); \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "case (term_variants_Var P x)"], ["proof (state)\nthis:\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n\ngoal (3 subgoals):\n 1. \\<And>P x.\n       \\<forall>f. Ball (set (P f)) ((=) f) \\<Longrightarrow> Var x = Var x\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f); \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "thus ?case"], ["proof (prove)\nusing this:\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n\ngoal (1 subgoal):\n 1. Var x = Var x", "by blast"], ["proof (state)\nthis:\n  Var x = Var x\n\ngoal (2 subgoals):\n 1. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f); \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f); \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "case (term_variants_P T S P g f)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  g \\<in> set (P f)\n  \\<lbrakk>?i < length T;\n   \\<forall>f. \\<forall>a\\<in>set (P f). f = a\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n\ngoal (2 subgoals):\n 1. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f); \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "hence \"T ! i = S ! i\" when i: \"i < length T\" for i"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  g \\<in> set (P f)\n  \\<lbrakk>?i < length T;\n   \\<forall>f. \\<forall>a\\<in>set (P f). f = a\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n\ngoal (1 subgoal):\n 1. T ! i = S ! i", "using i"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  g \\<in> set (P f)\n  \\<lbrakk>?i < length T;\n   \\<forall>f. \\<forall>a\\<in>set (P f). f = a\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n  i < length T\n\ngoal (1 subgoal):\n 1. T ! i = S ! i", "by blast"], ["proof (state)\nthis:\n  ?i < length T \\<Longrightarrow> T ! ?i = S ! ?i\n\ngoal (2 subgoals):\n 1. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f); \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "hence \"T = S\""], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow> T ! ?i = S ! ?i\n\ngoal (1 subgoal):\n 1. T = S", "using term_variants_P.hyps(1)"], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow> T ! ?i = S ! ?i\n  length T = length S\n\ngoal (1 subgoal):\n 1. T = S", "by (simp add: nth_equalityI)"], ["proof (state)\nthis:\n  T = S\n\ngoal (2 subgoals):\n 1. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f); \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "thus ?case"], ["proof (prove)\nusing this:\n  T = S\n\ngoal (1 subgoal):\n 1. Fun f T = Fun g S", "using term_variants_P.prems term_variants_P.hyps(3)"], ["proof (prove)\nusing this:\n  T = S\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n  g \\<in> set (P f)\n\ngoal (1 subgoal):\n 1. Fun f T = Fun g S", "by fast"], ["proof (state)\nthis:\n  Fun f T = Fun g S\n\ngoal (1 subgoal):\n 1. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "case (term_variants_Fun T S P f)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T;\n   \\<forall>f. \\<forall>a\\<in>set (P f). f = a\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n\ngoal (1 subgoal):\n 1. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "hence \"T ! i = S ! i\" when i: \"i < length T\" for i"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T;\n   \\<forall>f. \\<forall>a\\<in>set (P f). f = a\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n\ngoal (1 subgoal):\n 1. T ! i = S ! i", "using i"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T;\n   \\<forall>f. \\<forall>a\\<in>set (P f). f = a\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f. \\<forall>a\\<in>set (P f). f = a\n  i < length T\n\ngoal (1 subgoal):\n 1. T ! i = S ! i", "by blast"], ["proof (state)\nthis:\n  ?i < length T \\<Longrightarrow> T ! ?i = S ! ?i\n\ngoal (1 subgoal):\n 1. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "hence \"T = S\""], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow> T ! ?i = S ! ?i\n\ngoal (1 subgoal):\n 1. T = S", "using term_variants_Fun.hyps(1)"], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow> T ! ?i = S ! ?i\n  length T = length S\n\ngoal (1 subgoal):\n 1. T = S", "by (simp add: nth_equalityI)"], ["proof (state)\nthis:\n  T = S\n\ngoal (1 subgoal):\n 1. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f. Ball (set (P f)) ((=) f)\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "thus ?case"], ["proof (prove)\nusing this:\n  T = S\n\ngoal (1 subgoal):\n 1. Fun f T = Fun f S", "by fast"], ["proof (state)\nthis:\n  Fun f T = Fun f S\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma term_variants_pred_const:\n  assumes \"b \\<in> set (P a)\"\n  shows \"term_variants_pred P (Fun a []) (Fun b [])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun a []) (Fun b [])", "using term_variants_P[of \"[]\" \"[]\"] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>length [] = length [];\n   \\<And>i.\n      i < length [] \\<Longrightarrow>\n      term_variants_pred ?P ([] ! i) ([] ! i);\n   ?g \\<in> set (?P ?f)\\<rbrakk>\n  \\<Longrightarrow> term_variants_pred ?P (Fun ?f []) (Fun ?g [])\n  b \\<in> set (P a)\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun a []) (Fun b [])", "by simp"], ["", "lemma term_variants_pred_const_cases:\n  \"P a \\<noteq> [] \\<Longrightarrow> term_variants_pred P (Fun a []) t \\<longleftrightarrow>\n                 (t = Fun a [] \\<or> (\\<exists>b \\<in> set (P a). t = Fun b []))\"\n  \"P a = [] \\<Longrightarrow> term_variants_pred P (Fun a []) t \\<longleftrightarrow> t = Fun a []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P a \\<noteq> [] \\<Longrightarrow>\n     term_variants_pred P (Fun a []) t =\n     (t = Fun a [] \\<or> (\\<exists>b\\<in>set (P a). t = Fun b []))) &&&\n    (P a = [] \\<Longrightarrow>\n     term_variants_pred P (Fun a []) t = (t = Fun a []))", "using term_variants_pred_inv_const[of P]"], ["proof (prove)\nusing this:\n  term_variants_pred P (Fun ?c []) ?t =\n  ((\\<exists>g\\<in>set (P ?c). ?t = Fun g []) \\<or> ?t = Fun ?c [])\n\ngoal (1 subgoal):\n 1. (P a \\<noteq> [] \\<Longrightarrow>\n     term_variants_pred P (Fun a []) t =\n     (t = Fun a [] \\<or> (\\<exists>b\\<in>set (P a). t = Fun b []))) &&&\n    (P a = [] \\<Longrightarrow>\n     term_variants_pred P (Fun a []) t = (t = Fun a []))", "by auto"], ["", "lemma term_variants_pred_param:\n  assumes \"term_variants_pred P t s\"\n    and fg: \"f = g \\<or> g \\<in> set (P f)\"\n  shows \"term_variants_pred P (Fun f (S@t#T)) (Fun g (S@s#T))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (S @ t # T)) (Fun g (S @ s # T))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (S @ t # T)) (Fun g (S @ s # T))", "have 1: \"length (S@t#T) = length (S@s#T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (S @ t # T) = length (S @ s # T)", "by simp"], ["proof (state)\nthis:\n  length (S @ t # T) = length (S @ s # T)\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (S @ t # T)) (Fun g (S @ s # T))", "have \"term_variants_pred P (T ! i) (T ! i)\" \"term_variants_pred P (S ! i) (S ! i)\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (T ! i) (T ! i) &&&\n    term_variants_pred P (S ! i) (S ! i)", "by (metis term_variants_pred_refl)+"], ["proof (state)\nthis:\n  term_variants_pred P (T ! ?i) (T ! ?i)\n  term_variants_pred P (S ! ?i) (S ! ?i)\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (S @ t # T)) (Fun g (S @ s # T))", "hence 2: \"term_variants_pred P ((S@t#T) ! i) ((S@s#T) ! i)\" for i"], ["proof (prove)\nusing this:\n  term_variants_pred P (T ! ?i) (T ! ?i)\n  term_variants_pred P (S ! ?i) (S ! ?i)\n\ngoal (1 subgoal):\n 1. term_variants_pred P ((S @ t # T) ! i) ((S @ s # T) ! i)", "by (simp add: assms nth_Cons' nth_append)"], ["proof (state)\nthis:\n  term_variants_pred P ((S @ t # T) ! ?i) ((S @ s # T) ! ?i)\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (S @ t # T)) (Fun g (S @ s # T))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (S @ t # T)) (Fun g (S @ s # T))", "by (metis term_variants_Fun[OF 1 2] term_variants_P[OF 1 2] fg)"], ["proof (state)\nthis:\n  term_variants_pred P (Fun f (S @ t # T)) (Fun g (S @ s # T))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma term_variants_pred_Cons:\n  assumes t: \"term_variants_pred P t s\"\n    and T: \"term_variants_pred P (Fun f T) (Fun f S)\"\n    and fg: \"f = g \\<or> g \\<in> set (P f)\"\n  shows \"term_variants_pred P (Fun f (t#T)) (Fun g (s#S))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (t # T)) (Fun g (s # S))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (t # T)) (Fun g (s # S))", "have 1: \"length (t#T) = length (s#S)\"\n       and \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (t # T) = length (s # S) &&&\n    (\\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i))", "using term_variants_pred_inv[OF T]"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  f \\<noteq> f \\<Longrightarrow> f \\<in> set (P f)\n\ngoal (1 subgoal):\n 1. length (t # T) = length (s # S) &&&\n    (\\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i))", "by simp_all"], ["proof (state)\nthis:\n  length (t # T) = length (s # S)\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (t # T)) (Fun g (s # S))", "hence 2: \"\\<And>i. i < length (t#T) \\<Longrightarrow> term_variants_pred P ((t#T) ! i) ((s#S) ! i)\""], ["proof (prove)\nusing this:\n  length (t # T) = length (s # S)\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       i < length (t # T) \\<Longrightarrow>\n       term_variants_pred P ((t # T) ! i) ((s # S) ! i)", "by (metis t One_nat_def diff_less length_Cons less_Suc_eq less_imp_diff_less nth_Cons'\n              zero_less_Suc)"], ["proof (state)\nthis:\n  ?i < length (t # T) \\<Longrightarrow>\n  term_variants_pred P ((t # T) ! ?i) ((s # S) ! ?i)\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (t # T)) (Fun g (s # S))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (t # T)) (Fun g (s # S))", "using 1 2 fg"], ["proof (prove)\nusing this:\n  length (t # T) = length (s # S)\n  ?i < length (t # T) \\<Longrightarrow>\n  term_variants_pred P ((t # T) ! ?i) ((s # S) ! ?i)\n  f = g \\<or> g \\<in> set (P f)\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f (t # T)) (Fun g (s # S))", "by (auto intro: term_variants_pred.intros)"], ["proof (state)\nthis:\n  term_variants_pred P (Fun f (t # T)) (Fun g (s # S))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma term_variants_pred_dense:\n  fixes P Q::\"'a set\" and fs gs::\"'a list\"\n  defines \"P_fs x \\<equiv> if x \\<in> P then fs else []\"\n    and \"P_gs x \\<equiv> if x \\<in> P then gs else []\"\n    and \"Q_fs x \\<equiv> if x \\<in> Q then fs else []\"\n  assumes ut: \"term_variants_pred P_fs u t\"\n    and g: \"g \\<in> Q\" \"g \\<in> set gs\"\n  shows \"\\<exists>s. term_variants_pred P_gs u s \\<and> term_variants_pred Q_fs s t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred P_gs u s \\<and> term_variants_pred Q_fs s t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred P_gs u s \\<and> term_variants_pred Q_fs s t", "define F where \"F \\<equiv> \\<lambda>(P::'a set) (fs::'a list) x. if x \\<in> P then fs else []\""], ["proof (state)\nthis:\n  F \\<equiv> \\<lambda>P fs x. if x \\<in> P then fs else []\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred P_gs u s \\<and> term_variants_pred Q_fs s t", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred P_gs u s \\<and> term_variants_pred Q_fs s t", "using ut g P_fs_def"], ["proof (prove)\nusing this:\n  term_variants_pred P_fs u t\n  g \\<in> Q\n  g \\<in> set gs\n  P_fs ?x \\<equiv> if ?x \\<in> P then fs else []\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred P_gs u s \\<and> term_variants_pred Q_fs s t", "unfolding P_gs_def Q_fs_def"], ["proof (prove)\nusing this:\n  term_variants_pred P_fs u t\n  g \\<in> Q\n  g \\<in> set gs\n  P_fs ?x \\<equiv> if ?x \\<in> P then fs else []\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) u\n        s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s t", "proof (induction P_fs u t arbitrary: g gs rule: term_variants_pred.induct)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>Pa x g gs.\n       \\<lbrakk>g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Var x) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Var x)\n 2. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 3. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "case (term_variants_Var P h x)"], ["proof (state)\nthis:\n  x \\<in> Q\n  x \\<in> set gs\n  P ?x = (if ?x \\<in> P then fs else [])\n\ngoal (3 subgoals):\n 1. \\<And>Pa x g gs.\n       \\<lbrakk>g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Var x) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Var x)\n 2. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 3. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "thus ?case"], ["proof (prove)\nusing this:\n  x \\<in> Q\n  x \\<in> set gs\n  P ?x = (if ?x \\<in> P then fs else [])\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (Var h)\n        s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (Var h)", "by (auto intro: term_variants_pred.term_variants_Var)"], ["proof (state)\nthis:\n  \\<exists>s.\n     term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (Var h)\n      s \\<and>\n     term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s (Var h)\n\ngoal (2 subgoals):\n 1. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 2. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 2. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "case (term_variants_P T S P' h' h g gs)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P' (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T; ?g \\<in> Q; ?g \\<in> set ?gs;\n   \\<And>x. P' x = (if x \\<in> P then fs else [])\\<rbrakk>\n  \\<Longrightarrow> \\<exists>s.\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> P then ?gs else []) (T ! ?i)\n                        s \\<and>\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> Q then fs else []) s\n                        (S ! ?i)\n  h' \\<in> set (P' h)\n  g \\<in> Q\n  g \\<in> set gs\n  P' ?x = (if ?x \\<in> P then fs else [])\n\ngoal (2 subgoals):\n 1. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 2. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "note hyps = term_variants_P.hyps(1,2,4,5,6,7)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P' (T ! ?i) (S ! ?i)\n  h' \\<in> set (P' h)\n  g \\<in> Q\n  g \\<in> set gs\n  P' ?x = (if ?x \\<in> P then fs else [])\n\ngoal (2 subgoals):\n 1. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 2. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "note IH = term_variants_P.hyps(3)"], ["proof (state)\nthis:\n  \\<lbrakk>?i < length T; ?g \\<in> Q; ?g \\<in> set ?gs;\n   \\<And>x. P' x = (if x \\<in> P then fs else [])\\<rbrakk>\n  \\<Longrightarrow> \\<exists>s.\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> P then ?gs else []) (T ! ?i)\n                        s \\<and>\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> Q then fs else []) s\n                        (S ! ?i)\n\ngoal (2 subgoals):\n 1. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 2. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "have \"\\<exists>s. term_variants_pred (F P gs) (T ! i) s \\<and> term_variants_pred (F Q fs) s (S ! i)\"\n      when i: \"i < length T\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (F P gs) (T ! i) s \\<and>\n       term_variants_pred (F Q fs) s (S ! i)", "using IH[OF i hyps(4,5,6)]"], ["proof (prove)\nusing this:\n  \\<exists>s.\n     term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (T ! i)\n      s \\<and>\n     term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s (S ! i)\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (F P gs) (T ! i) s \\<and>\n       term_variants_pred (F Q fs) s (S ! i)", "unfolding F_def"], ["proof (prove)\nusing this:\n  \\<exists>s.\n     term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (T ! i)\n      s \\<and>\n     term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s (S ! i)\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (T ! i)\n        s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (S ! i)", "by presburger"], ["proof (state)\nthis:\n  ?i < length T \\<Longrightarrow>\n  \\<exists>s.\n     term_variants_pred (F P gs) (T ! ?i) s \\<and>\n     term_variants_pred (F Q fs) s (S ! ?i)\n\ngoal (2 subgoals):\n 1. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 2. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "then"], ["proof (chain)\npicking this:\n  ?i < length T \\<Longrightarrow>\n  \\<exists>s.\n     term_variants_pred (F P gs) (T ! ?i) s \\<and>\n     term_variants_pred (F Q fs) s (S ! ?i)", "obtain U where U:\n        \"length T = length U\" \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred (F P gs) (T ! i) (U ! i)\"\n        \"length U = length S\" \"\\<And>i. i < length U \\<Longrightarrow> term_variants_pred (F Q fs) (U ! i) (S ! i)\""], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow>\n  \\<exists>s.\n     term_variants_pred (F P gs) (T ! ?i) s \\<and>\n     term_variants_pred (F Q fs) s (S ! ?i)\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>length T = length U;\n         \\<And>i.\n            i < length T \\<Longrightarrow>\n            term_variants_pred (F P gs) (T ! i) (U ! i);\n         length U = length S;\n         \\<And>i.\n            i < length U \\<Longrightarrow>\n            term_variants_pred (F Q fs) (U ! i) (S ! i)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using hyps(1) Skolem_list_nth[of _ \"\\<lambda>i s. term_variants_pred (F P gs) (T ! i) s \\<and>\n                                                term_variants_pred (F Q fs) s (S ! i)\"]"], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow>\n  \\<exists>s.\n     term_variants_pred (F P gs) (T ! ?i) s \\<and>\n     term_variants_pred (F Q fs) s (S ! ?i)\n  length T = length S\n  (\\<forall>i<?k.\n      \\<exists>x.\n         term_variants_pred (F P gs) (T ! i) x \\<and>\n         term_variants_pred (F Q fs) x (S ! i)) =\n  (\\<exists>xs.\n      length xs = ?k \\<and>\n      (\\<forall>i<?k.\n          term_variants_pred (F P gs) (T ! i) (xs ! i) \\<and>\n          term_variants_pred (F Q fs) (xs ! i) (S ! i)))\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>length T = length U;\n         \\<And>i.\n            i < length T \\<Longrightarrow>\n            term_variants_pred (F P gs) (T ! i) (U ! i);\n         length U = length S;\n         \\<And>i.\n            i < length U \\<Longrightarrow>\n            term_variants_pred (F Q fs) (U ! i) (S ! i)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  length T = length U\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred (F P gs) (T ! ?i) (U ! ?i)\n  length U = length S\n  ?i < length U \\<Longrightarrow>\n  term_variants_pred (F Q fs) (U ! ?i) (S ! ?i)\n\ngoal (2 subgoals):\n 1. \\<And>T S Pa g f ga gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> set (Pa f); ga \\<in> Q; ga \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun g S)\n 2. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else [])\n        (Fun h T) s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (Fun h' S)", "using term_variants_pred.term_variants_P[OF U(1,2), of g h]\n            term_variants_pred.term_variants_P[OF U(3,4), of h' g]\n            hyps(3)[unfolded hyps(6)] hyps(4,5)"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>i. i < length T \\<Longrightarrow> i < length T;\n   g \\<in> set (F P gs h)\\<rbrakk>\n  \\<Longrightarrow> term_variants_pred (F P gs) (Fun h T) (Fun g U)\n  \\<lbrakk>\\<And>i. i < length U \\<Longrightarrow> i < length U;\n   h' \\<in> set (F Q fs g)\\<rbrakk>\n  \\<Longrightarrow> term_variants_pred (F Q fs) (Fun g U) (Fun h' S)\n  h' \\<in> set (if h \\<in> P then fs else [])\n  g \\<in> Q\n  g \\<in> set gs\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else [])\n        (Fun h T) s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (Fun h' S)", "unfolding F_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>i. i < length T \\<Longrightarrow> i < length T;\n   g \\<in> set (if h \\<in> P then gs else [])\\<rbrakk>\n  \\<Longrightarrow> term_variants_pred\n                     (\\<lambda>x. if x \\<in> P then gs else []) (Fun h T)\n                     (Fun g U)\n  \\<lbrakk>\\<And>i. i < length U \\<Longrightarrow> i < length U;\n   h' \\<in> set (if g \\<in> Q then fs else [])\\<rbrakk>\n  \\<Longrightarrow> term_variants_pred\n                     (\\<lambda>x. if x \\<in> Q then fs else []) (Fun g U)\n                     (Fun h' S)\n  h' \\<in> set (if h \\<in> P then fs else [])\n  g \\<in> Q\n  g \\<in> set gs\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else [])\n        (Fun h T) s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (Fun h' S)", "by force"], ["proof (state)\nthis:\n  \\<exists>s.\n     term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (Fun h T)\n      s \\<and>\n     term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n      (Fun h' S)\n\ngoal (1 subgoal):\n 1. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "case (term_variants_Fun T S P' h' g gs)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P' (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T; ?g \\<in> Q; ?g \\<in> set ?gs;\n   \\<And>x. P' x = (if x \\<in> P then fs else [])\\<rbrakk>\n  \\<Longrightarrow> \\<exists>s.\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> P then ?gs else []) (T ! ?i)\n                        s \\<and>\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> Q then fs else []) s\n                        (S ! ?i)\n  g \\<in> Q\n  g \\<in> set gs\n  P' ?x = (if ?x \\<in> P then fs else [])\n\ngoal (1 subgoal):\n 1. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "note hyps = term_variants_Fun.hyps(1,2,4,5,6)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P' (T ! ?i) (S ! ?i)\n  g \\<in> Q\n  g \\<in> set gs\n  P' ?x = (if ?x \\<in> P then fs else [])\n\ngoal (1 subgoal):\n 1. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "note IH = term_variants_Fun.hyps(3)"], ["proof (state)\nthis:\n  \\<lbrakk>?i < length T; ?g \\<in> Q; ?g \\<in> set ?gs;\n   \\<And>x. P' x = (if x \\<in> P then fs else [])\\<rbrakk>\n  \\<Longrightarrow> \\<exists>s.\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> P then ?gs else []) (T ! ?i)\n                        s \\<and>\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> Q then fs else []) s\n                        (S ! ?i)\n\ngoal (1 subgoal):\n 1. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "have \"\\<exists>s. term_variants_pred (F P gs) (T ! i) s \\<and> term_variants_pred (F Q fs) s (S ! i)\"\n      when i: \"i < length T\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (F P gs) (T ! i) s \\<and>\n       term_variants_pred (F Q fs) s (S ! i)", "using IH[OF i hyps(3,4,5)]"], ["proof (prove)\nusing this:\n  \\<exists>s.\n     term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (T ! i)\n      s \\<and>\n     term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s (S ! i)\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (F P gs) (T ! i) s \\<and>\n       term_variants_pred (F Q fs) s (S ! i)", "unfolding F_def"], ["proof (prove)\nusing this:\n  \\<exists>s.\n     term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (T ! i)\n      s \\<and>\n     term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s (S ! i)\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (T ! i)\n        s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (S ! i)", "by presburger"], ["proof (state)\nthis:\n  ?i < length T \\<Longrightarrow>\n  \\<exists>s.\n     term_variants_pred (F P gs) (T ! ?i) s \\<and>\n     term_variants_pred (F Q fs) s (S ! ?i)\n\ngoal (1 subgoal):\n 1. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "then"], ["proof (chain)\npicking this:\n  ?i < length T \\<Longrightarrow>\n  \\<exists>s.\n     term_variants_pred (F P gs) (T ! ?i) s \\<and>\n     term_variants_pred (F Q fs) s (S ! ?i)", "obtain U where U:\n        \"length T = length U\" \"\\<And>i. i < length T \\<Longrightarrow> term_variants_pred (F P gs) (T ! i) (U ! i)\"\n        \"length U = length S\" \"\\<And>i. i < length U \\<Longrightarrow> term_variants_pred (F Q fs) (U ! i) (S ! i)\""], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow>\n  \\<exists>s.\n     term_variants_pred (F P gs) (T ! ?i) s \\<and>\n     term_variants_pred (F Q fs) s (S ! ?i)\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>length T = length U;\n         \\<And>i.\n            i < length T \\<Longrightarrow>\n            term_variants_pred (F P gs) (T ! i) (U ! i);\n         length U = length S;\n         \\<And>i.\n            i < length U \\<Longrightarrow>\n            term_variants_pred (F Q fs) (U ! i) (S ! i)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using hyps(1) Skolem_list_nth[of _ \"\\<lambda>i s. term_variants_pred (F P gs) (T ! i) s \\<and>\n                                                term_variants_pred (F Q fs) s (S ! i)\"]"], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow>\n  \\<exists>s.\n     term_variants_pred (F P gs) (T ! ?i) s \\<and>\n     term_variants_pred (F Q fs) s (S ! ?i)\n  length T = length S\n  (\\<forall>i<?k.\n      \\<exists>x.\n         term_variants_pred (F P gs) (T ! i) x \\<and>\n         term_variants_pred (F Q fs) x (S ! i)) =\n  (\\<exists>xs.\n      length xs = ?k \\<and>\n      (\\<forall>i<?k.\n          term_variants_pred (F P gs) (T ! i) (xs ! i) \\<and>\n          term_variants_pred (F Q fs) (xs ! i) (S ! i)))\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>length T = length U;\n         \\<And>i.\n            i < length T \\<Longrightarrow>\n            term_variants_pred (F P gs) (T ! i) (U ! i);\n         length U = length S;\n         \\<And>i.\n            i < length U \\<Longrightarrow>\n            term_variants_pred (F Q fs) (U ! i) (S ! i)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  length T = length U\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred (F P gs) (T ! ?i) (U ! ?i)\n  length U = length S\n  ?i < length U \\<Longrightarrow>\n  term_variants_pred (F Q fs) (U ! ?i) (S ! ?i)\n\ngoal (1 subgoal):\n 1. \\<And>T S Pa f g gs.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred Pa (T ! i) (S ! i);\n        \\<And>i g gs.\n           \\<lbrakk>i < length T; g \\<in> Q; g \\<in> set gs;\n            \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>s.\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> P then gs else [])\n                                 (T ! i) s \\<and>\n                                term_variants_pred\n                                 (\\<lambda>x. if x \\<in> Q then fs else [])\n                                 s (S ! i);\n        g \\<in> Q; g \\<in> set gs;\n        \\<And>x. Pa x = (if x \\<in> P then fs else [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>s.\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> P then gs else [])\n                             (Fun f T) s \\<and>\n                            term_variants_pred\n                             (\\<lambda>x. if x \\<in> Q then fs else []) s\n                             (Fun f S)", "thus ?case"], ["proof (prove)\nusing this:\n  length T = length U\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred (F P gs) (T ! ?i) (U ! ?i)\n  length U = length S\n  ?i < length U \\<Longrightarrow>\n  term_variants_pred (F Q fs) (U ! ?i) (S ! ?i)\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else [])\n        (Fun h' T) s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (Fun h' S)", "using term_variants_pred.term_variants_Fun[OF U(1,2)]\n            term_variants_pred.term_variants_Fun[OF U(3,4)]"], ["proof (prove)\nusing this:\n  length T = length U\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred (F P gs) (T ! ?i) (U ! ?i)\n  length U = length S\n  ?i < length U \\<Longrightarrow>\n  term_variants_pred (F Q fs) (U ! ?i) (S ! ?i)\n  (\\<And>i. i < length T \\<Longrightarrow> i < length T) \\<Longrightarrow>\n  term_variants_pred (F P gs) (Fun ?f T) (Fun ?f U)\n  (\\<And>i. i < length U \\<Longrightarrow> i < length U) \\<Longrightarrow>\n  term_variants_pred (F Q fs) (Fun ?f U) (Fun ?f S)\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else [])\n        (Fun h' T) s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (Fun h' S)", "unfolding F_def"], ["proof (prove)\nusing this:\n  length T = length U\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (T ! ?i)\n   (U ! ?i)\n  length U = length S\n  ?i < length U \\<Longrightarrow>\n  term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) (U ! ?i)\n   (S ! ?i)\n  (\\<And>i. i < length T \\<Longrightarrow> i < length T) \\<Longrightarrow>\n  term_variants_pred (\\<lambda>x. if x \\<in> P then gs else []) (Fun ?f T)\n   (Fun ?f U)\n  (\\<And>i. i < length U \\<Longrightarrow> i < length U) \\<Longrightarrow>\n  term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) (Fun ?f U)\n   (Fun ?f S)\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x \\<in> P then gs else [])\n        (Fun h' T) s \\<and>\n       term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n        (Fun h' S)", "by meson"], ["proof (state)\nthis:\n  \\<exists>s.\n     term_variants_pred (\\<lambda>x. if x \\<in> P then gs else [])\n      (Fun h' T) s \\<and>\n     term_variants_pred (\\<lambda>x. if x \\<in> Q then fs else []) s\n      (Fun h' S)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>s. term_variants_pred P_gs u s \\<and> term_variants_pred Q_fs s t\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma term_variants_pred_dense':\n  assumes ut: \"term_variants_pred ((\\<lambda>_. [])(a := [b])) u t\"\n  shows \"\\<exists>s. term_variants_pred ((\\<lambda>_. [])(a := [c])) u s \\<and>\n             term_variants_pred ((\\<lambda>_. [])(c := [b])) s t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred ((\\<lambda>_. [])(a := [c])) u s \\<and>\n       term_variants_pred ((\\<lambda>_. [])(c := [b])) s t", "using ut term_variants_pred_dense[of \"{a}\" \"[b]\" u t c \"{c}\" \"[c]\"]"], ["proof (prove)\nusing this:\n  term_variants_pred ((\\<lambda>_. [])(a := [b])) u t\n  \\<lbrakk>term_variants_pred (\\<lambda>x. if x \\<in> {a} then [b] else [])\n            u t;\n   c \\<in> {c}; c \\<in> set [c]\\<rbrakk>\n  \\<Longrightarrow> \\<exists>s.\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> {a} then [c] else []) u\n                        s \\<and>\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> {c} then [b] else []) s t\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred ((\\<lambda>_. [])(a := [c])) u s \\<and>\n       term_variants_pred ((\\<lambda>_. [])(c := [b])) s t", "unfolding fun_upd_def"], ["proof (prove)\nusing this:\n  term_variants_pred (\\<lambda>x. if x = a then [b] else []) u t\n  \\<lbrakk>term_variants_pred (\\<lambda>x. if x \\<in> {a} then [b] else [])\n            u t;\n   c \\<in> {c}; c \\<in> set [c]\\<rbrakk>\n  \\<Longrightarrow> \\<exists>s.\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> {a} then [c] else []) u\n                        s \\<and>\n                       term_variants_pred\n                        (\\<lambda>x. if x \\<in> {c} then [b] else []) s t\n\ngoal (1 subgoal):\n 1. \\<exists>s.\n       term_variants_pred (\\<lambda>x. if x = a then [c] else []) u s \\<and>\n       term_variants_pred (\\<lambda>x. if x = c then [b] else []) s t", "by simp"], ["", "lemma term_variants_pred_eq_case:\n  fixes t s::\"('a,'b) term\"\n  assumes \"term_variants_pred P t s\" \"\\<forall>f \\<in> funs_term t. P f = []\"\n  shows \"t = s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t = s", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P t s\n  \\<forall>f\\<in>funs_term t. P f = []\n\ngoal (1 subgoal):\n 1. t = s", "proof (induction P t s rule: term_variants_pred.induct)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P x.\n       \\<forall>f\\<in>funs_term (Var x). P f = [] \\<Longrightarrow>\n       Var x = Var x\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f\\<in>funs_term (T ! i). P f = []\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f);\n        \\<forall>f\\<in>funs_term (Fun f T). P f = []\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f\\<in>funs_term (T ! i). P f = []\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f\\<in>funs_term (Fun f T). P f = []\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "case (term_variants_Fun T S P f)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T;\n   \\<forall>f\\<in>funs_term (T ! ?i). P f = []\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f\\<in>funs_term (Fun f T). P f = []\n\ngoal (3 subgoals):\n 1. \\<And>P x.\n       \\<forall>f\\<in>funs_term (Var x). P f = [] \\<Longrightarrow>\n       Var x = Var x\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f\\<in>funs_term (T ! i). P f = []\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f);\n        \\<forall>f\\<in>funs_term (Fun f T). P f = []\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f\\<in>funs_term (T ! i). P f = []\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        \\<forall>f\\<in>funs_term (Fun f T). P f = []\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun f S", "thus ?case"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T;\n   \\<forall>f\\<in>funs_term (T ! ?i). P f = []\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f\\<in>funs_term (Fun f T). P f = []\n\ngoal (1 subgoal):\n 1. Fun f T = Fun f S", "using subtermeq_imp_funs_term_subset[OF Fun_param_in_subterms[OF nth_mem], of _ T f]\n          nth_equalityI[of T S]"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T;\n   \\<forall>f\\<in>funs_term (T ! ?i). P f = []\\<rbrakk>\n  \\<Longrightarrow> T ! ?i = S ! ?i\n  \\<forall>f\\<in>funs_term (Fun f T). P f = []\n  ?n2 < length T \\<Longrightarrow>\n  funs_term (T ! ?n2) \\<subseteq> funs_term (Fun f T)\n  \\<lbrakk>length T = length S;\n   \\<And>i. i < length T \\<Longrightarrow> T ! i = S ! i\\<rbrakk>\n  \\<Longrightarrow> T = S\n\ngoal (1 subgoal):\n 1. Fun f T = Fun f S", "by blast"], ["proof (state)\nthis:\n  Fun f T = Fun f S\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       \\<forall>f\\<in>funs_term (Var x). P f = [] \\<Longrightarrow>\n       Var x = Var x\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<forall>f\\<in>funs_term (T ! i). P f = []\\<rbrakk>\n           \\<Longrightarrow> T ! i = S ! i;\n        g \\<in> set (P f);\n        \\<forall>f\\<in>funs_term (Fun f T). P f = []\\<rbrakk>\n       \\<Longrightarrow> Fun f T = Fun g S", "qed (simp_all add: term_variants_pred_refl)"], ["", "lemma term_variants_pred_subst:\n  assumes \"term_variants_pred P t s\"\n  shows \"term_variants_pred P (t \\<cdot> \\<delta>) (s \\<cdot> \\<delta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (t \\<cdot> \\<delta>) (s \\<cdot> \\<delta>)", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P t s\n\ngoal (1 subgoal):\n 1. term_variants_pred P (t \\<cdot> \\<delta>) (s \\<cdot> \\<delta>)", "proof (induction P t s rule: term_variants_pred.induct)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>);\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun g S \\<cdot> \\<delta>)\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "case (term_variants_P T S P f g)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  f \\<in> set (P g)\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred P (T ! ?i \\<cdot> \\<delta>) (S ! ?i \\<cdot> \\<delta>)\n\ngoal (3 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>);\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun g S \\<cdot> \\<delta>)\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "have 1: \"length (map (\\<lambda>t. t \\<cdot> \\<delta>) T) = length (map (\\<lambda>t. t \\<cdot> \\<delta>) S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) =\n    length (S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "using term_variants_P.hyps"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  f \\<in> set (P g)\n\ngoal (1 subgoal):\n 1. length (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) =\n    length (S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "by simp"], ["proof (state)\nthis:\n  length (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) =\n  length (S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (3 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>);\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun g S \\<cdot> \\<delta>)\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "have 2: \"term_variants_pred P ((map (\\<lambda>t. t \\<cdot> \\<delta>) T) ! i) ((map (\\<lambda>t. t \\<cdot> \\<delta>) S) ! i)\"\n    when \"i < length (map (\\<lambda>t. t \\<cdot> \\<delta>) T)\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P\n     ((T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! i)\n     ((S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! i)", "using term_variants_P that"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  f \\<in> set (P g)\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred P (T ! ?i \\<cdot> \\<delta>) (S ! ?i \\<cdot> \\<delta>)\n  i < length (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. term_variants_pred P\n     ((T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! i)\n     ((S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! i)", "by fastforce"], ["proof (state)\nthis:\n  ?i < length\n        (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n         \\<delta>) \\<Longrightarrow>\n  term_variants_pred P\n   ((T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! ?i)\n   ((S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! ?i)\n\ngoal (3 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>);\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun g S \\<cdot> \\<delta>)\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun g T \\<cdot> \\<delta>)\n     (Fun f S \\<cdot> \\<delta>)", "using term_variants_pred.term_variants_P[OF 1 2 term_variants_P.hyps(3)]"], ["proof (prove)\nusing this:\n  (\\<And>i.\n      i < length\n           (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n            \\<delta>) \\<Longrightarrow>\n      i < length\n           (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n            \\<delta>)) \\<Longrightarrow>\n  term_variants_pred P\n   (Fun g (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n   (Fun f (S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun g T \\<cdot> \\<delta>)\n     (Fun f S \\<cdot> \\<delta>)", "by fastforce"], ["proof (state)\nthis:\n  term_variants_pred P (Fun g T \\<cdot> \\<delta>) (Fun f S \\<cdot> \\<delta>)\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "case (term_variants_Fun T S P f)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred P (T ! ?i \\<cdot> \\<delta>) (S ! ?i \\<cdot> \\<delta>)\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "have 1: \"length (map (\\<lambda>t. t \\<cdot> \\<delta>) T) = length (map (\\<lambda>t. t \\<cdot> \\<delta>) S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) =\n    length (S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "using term_variants_Fun.hyps"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n\ngoal (1 subgoal):\n 1. length (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) =\n    length (S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "by simp"], ["proof (state)\nthis:\n  length (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) =\n  length (S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "have 2: \"term_variants_pred P ((map (\\<lambda>t. t \\<cdot> \\<delta>) T) ! i) ((map (\\<lambda>t. t \\<cdot> \\<delta>) S) ! i)\"\n    when \"i < length (map (\\<lambda>t. t \\<cdot> \\<delta>) T)\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P\n     ((T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! i)\n     ((S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! i)", "using term_variants_Fun that"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  ?i < length T \\<Longrightarrow>\n  term_variants_pred P (T ! ?i \\<cdot> \\<delta>) (S ! ?i \\<cdot> \\<delta>)\n  i < length (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. term_variants_pred P\n     ((T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! i)\n     ((S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! i)", "by fastforce"], ["proof (state)\nthis:\n  ?i < length\n        (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n         \\<delta>) \\<Longrightarrow>\n  term_variants_pred P\n   ((T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! ?i)\n   ((S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>) ! ?i)\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i \\<cdot> \\<delta>)\n            (S ! i \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n                          (Fun f S \\<cdot> \\<delta>)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n     (Fun f S \\<cdot> \\<delta>)", "using term_variants_pred.term_variants_Fun[OF 1 2]"], ["proof (prove)\nusing this:\n  (\\<And>i.\n      i < length\n           (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n            \\<delta>) \\<Longrightarrow>\n      i < length\n           (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n            \\<delta>)) \\<Longrightarrow>\n  term_variants_pred P\n   (Fun ?f (T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n   (Fun ?f (S \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f T \\<cdot> \\<delta>)\n     (Fun f S \\<cdot> \\<delta>)", "by fastforce"], ["proof (state)\nthis:\n  term_variants_pred P (Fun f T \\<cdot> \\<delta>) (Fun f S \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       term_variants_pred P (Var x \\<cdot> \\<delta>)\n        (Var x \\<cdot> \\<delta>)", "qed (simp add: term_variants_pred_refl)"], ["", "lemma term_variants_pred_subst':\n  fixes t s::\"('a,'b) term\" and \\<delta>::\"('a,'b) subst\"\n  assumes \"term_variants_pred P (t \\<cdot> \\<delta>) s\"\n    and \"\\<forall>x \\<in> fv t \\<union> fv s. (\\<exists>y. \\<delta> x = Var y) \\<or> (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\"\n  shows \"\\<exists>u. term_variants_pred P t u \\<and> s = u \\<cdot> \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> s = u \\<cdot> \\<delta>", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P (t \\<cdot> \\<delta>) s\n  \\<forall>x\\<in>fv t \\<union> fv s.\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> s = u \\<cdot> \\<delta>", "proof (induction P \"t \\<cdot> \\<delta>\" s arbitrary: t rule: term_variants_pred.induct)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P x t.\n       \\<lbrakk>Var x = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Var x).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Var x = u \\<cdot> \\<delta>\n 2. \\<And>T S P g f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        g \\<in> set (P f); Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun g S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun g S = u \\<cdot> \\<delta>\n 3. \\<And>T S P f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun f S = u \\<cdot> \\<delta>", "case (term_variants_Var P x g)"], ["proof (state)\nthis:\n  Var x = g \\<cdot> \\<delta>\n  \\<forall>x\\<in>fv g \\<union> fv (Var x).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (3 subgoals):\n 1. \\<And>P x t.\n       \\<lbrakk>Var x = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Var x).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Var x = u \\<cdot> \\<delta>\n 2. \\<And>T S P g f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        g \\<in> set (P f); Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun g S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun g S = u \\<cdot> \\<delta>\n 3. \\<And>T S P f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun f S = u \\<cdot> \\<delta>", "thus ?case"], ["proof (prove)\nusing this:\n  Var x = g \\<cdot> \\<delta>\n  \\<forall>x\\<in>fv g \\<union> fv (Var x).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P g u \\<and> Var x = u \\<cdot> \\<delta>", "using term_variants_pred_refl"], ["proof (prove)\nusing this:\n  Var x = g \\<cdot> \\<delta>\n  \\<forall>x\\<in>fv g \\<union> fv (Var x).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n  term_variants_pred ?P ?t ?t\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P g u \\<and> Var x = u \\<cdot> \\<delta>", "by fast"], ["proof (state)\nthis:\n  \\<exists>u. term_variants_pred P g u \\<and> Var x = u \\<cdot> \\<delta>\n\ngoal (2 subgoals):\n 1. \\<And>T S P g f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        g \\<in> set (P f); Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun g S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun g S = u \\<cdot> \\<delta>\n 2. \\<And>T S P f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun f S = u \\<cdot> \\<delta>", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>T S P g f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        g \\<in> set (P f); Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun g S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun g S = u \\<cdot> \\<delta>\n 2. \\<And>T S P f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun f S = u \\<cdot> \\<delta>", "case (term_variants_P T S P g f)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T; T ! ?i = ?t \\<cdot> \\<delta>;\n   \\<forall>x\\<in>fv ?t \\<union> fv (S ! ?i).\n      (\\<exists>y. \\<delta> x = Var y) \\<or>\n      (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n  \\<Longrightarrow> \\<exists>u.\n                       term_variants_pred P ?t u \\<and>\n                       S ! ?i = u \\<cdot> \\<delta>\n  g \\<in> set (P f)\n  Fun f T = t \\<cdot> \\<delta>\n  \\<forall>x\\<in>fv t \\<union> fv (Fun g S).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (2 subgoals):\n 1. \\<And>T S P g f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        g \\<in> set (P f); Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun g S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun g S = u \\<cdot> \\<delta>\n 2. \\<And>T S P f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun f S = u \\<cdot> \\<delta>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "proof (cases t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "case (Var x)"], ["proof (state)\nthis:\n  t = Var x\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "thus ?thesis"], ["proof (prove)\nusing this:\n  t = Var x\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "using term_variants_P.hyps(4,5) term_variants_P.prems"], ["proof (prove)\nusing this:\n  t = Var x\n  g \\<in> set (P f)\n  Fun f T = t \\<cdot> \\<delta>\n  \\<forall>x\\<in>fv t \\<union> fv (Fun g S).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "by fastforce"], ["proof (state)\nthis:\n  \\<exists>u. term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "case (Fun h U)"], ["proof (state)\nthis:\n  t = Fun h U\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "hence 1: \"h = f\" \"T = map (\\<lambda>s. s \\<cdot> \\<delta>) U\" \"length U = length T\""], ["proof (prove)\nusing this:\n  t = Fun h U\n\ngoal (1 subgoal):\n 1. h = f &&&\n    T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> &&&\n    length U = length T", "using term_variants_P.hyps(5)"], ["proof (prove)\nusing this:\n  t = Fun h U\n  Fun f T = t \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. h = f &&&\n    T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> &&&\n    length U = length T", "by simp_all"], ["proof (state)\nthis:\n  h = f\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  length U = length T\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "hence 2: \"T ! i = U ! i \\<cdot> \\<delta>\" when \"i < length T\" for i"], ["proof (prove)\nusing this:\n  h = f\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  length U = length T\n\ngoal (1 subgoal):\n 1. T ! i = U ! i \\<cdot> \\<delta>", "using that"], ["proof (prove)\nusing this:\n  h = f\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  length U = length T\n  i < length T\n\ngoal (1 subgoal):\n 1. T ! i = U ! i \\<cdot> \\<delta>", "by simp"], ["proof (state)\nthis:\n  ?i < length T \\<Longrightarrow> T ! ?i = U ! ?i \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "have \"\\<forall>x \\<in> fv (U ! i) \\<union> fv (S ! i). (\\<exists>y. \\<delta> x = Var y) \\<or> (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\"\n      when \"i < length U\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (U ! i) \\<union> fv (S ! i).\n       (\\<exists>y. \\<delta> x = Var y) \\<or>\n       (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])", "using that Fun term_variants_P.prems term_variants_P.hyps(1) 1(3)"], ["proof (prove)\nusing this:\n  i < length U\n  t = Fun h U\n  \\<forall>x\\<in>fv t \\<union> fv (Fun g S).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n  length T = length S\n  length U = length T\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (U ! i) \\<union> fv (S ! i).\n       (\\<exists>y. \\<delta> x = Var y) \\<or>\n       (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])", "by force"], ["proof (state)\nthis:\n  ?i < length U \\<Longrightarrow>\n  \\<forall>x\\<in>fv (U ! ?i) \\<union> fv (S ! ?i).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "hence IH: \"\\<forall>i < length U. \\<exists>u. term_variants_pred P (U ! i) u \\<and> S ! i = u \\<cdot> \\<delta>\""], ["proof (prove)\nusing this:\n  ?i < length U \\<Longrightarrow>\n  \\<forall>x\\<in>fv (U ! ?i) \\<union> fv (S ! ?i).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. \\<forall>i<length U.\n       \\<exists>u.\n          term_variants_pred P (U ! i) u \\<and> S ! i = u \\<cdot> \\<delta>", "by (metis 1(3) term_variants_P.hyps(3)[OF _ 2])"], ["proof (state)\nthis:\n  \\<forall>i<length U.\n     \\<exists>u.\n        term_variants_pred P (U ! i) u \\<and> S ! i = u \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "have \"\\<exists>V. length U = length V \\<and> S = map (\\<lambda>v. v \\<cdot> \\<delta>) V \\<and>\n               (\\<forall>i < length U. term_variants_pred P (U ! i) (V ! i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>V.\n       length U = length V \\<and>\n       S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))", "using term_variants_P.hyps(1) 1(3) subst_term_list_obtain[OF IH]"], ["proof (prove)\nusing this:\n  length T = length S\n  length U = length T\n  length U = length S \\<Longrightarrow>\n  \\<exists>Ua.\n     length U = length Ua \\<and>\n     (\\<forall>i<length U. term_variants_pred P (U ! i) (Ua ! i)) \\<and>\n     S = Ua \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>V.\n       length U = length V \\<and>\n       S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))", "by metis"], ["proof (state)\nthis:\n  \\<exists>V.\n     length U = length V \\<and>\n     S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "then"], ["proof (chain)\npicking this:\n  \\<exists>V.\n     length U = length V \\<and>\n     S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))", "obtain V where V: \"length U = length V\" \"S = map (\\<lambda>v. v \\<cdot> \\<delta>) V\"\n                           \"\\<And>i. i < length U \\<Longrightarrow> term_variants_pred P (U ! i) (V ! i)\""], ["proof (prove)\nusing this:\n  \\<exists>V.\n     length U = length V \\<and>\n     S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))\n\ngoal (1 subgoal):\n 1. (\\<And>V.\n        \\<lbrakk>length U = length V;\n         S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>;\n         \\<And>i.\n            i < length U \\<Longrightarrow>\n            term_variants_pred P (U ! i) (V ! i)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  length U = length V\n  S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  ?i < length U \\<Longrightarrow> term_variants_pred P (U ! ?i) (V ! ?i)\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "have \"term_variants_pred P (Fun f U) (Fun g V)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f U) (Fun g V)", "by (metis term_variants_pred.term_variants_P[OF V(1,3) term_variants_P.hyps(4)])"], ["proof (state)\nthis:\n  term_variants_pred P (Fun f U) (Fun g V)\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "moreover"], ["proof (state)\nthis:\n  term_variants_pred P (Fun f U) (Fun g V)\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "have \"Fun g S = Fun g V \\<cdot> \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Fun g S = Fun g V \\<cdot> \\<delta>", "using V(2)"], ["proof (prove)\nusing this:\n  S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. Fun g S = Fun g V \\<cdot> \\<delta>", "by simp"], ["proof (state)\nthis:\n  Fun g S = Fun g V \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "ultimately"], ["proof (chain)\npicking this:\n  term_variants_pred P (Fun f U) (Fun g V)\n  Fun g S = Fun g V \\<cdot> \\<delta>", "show ?thesis"], ["proof (prove)\nusing this:\n  term_variants_pred P (Fun f U) (Fun g V)\n  Fun g S = Fun g V \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "using term_variants_P.hyps(1,4) Fun 1"], ["proof (prove)\nusing this:\n  term_variants_pred P (Fun f U) (Fun g V)\n  Fun g S = Fun g V \\<cdot> \\<delta>\n  length T = length S\n  g \\<in> set (P f)\n  t = Fun h U\n  h = f\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  length U = length T\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>", "by blast"], ["proof (state)\nthis:\n  \\<exists>u. term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>u. term_variants_pred P t u \\<and> Fun g S = u \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>T S P f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun f S = u \\<cdot> \\<delta>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>T S P f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun f S = u \\<cdot> \\<delta>", "case (term_variants_Fun T S P f t)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T; T ! ?i = ?t \\<cdot> \\<delta>;\n   \\<forall>x\\<in>fv ?t \\<union> fv (S ! ?i).\n      (\\<exists>y. \\<delta> x = Var y) \\<or>\n      (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n  \\<Longrightarrow> \\<exists>u.\n                       term_variants_pred P ?t u \\<and>\n                       S ! ?i = u \\<cdot> \\<delta>\n  Fun f T = t \\<cdot> \\<delta>\n  \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. \\<And>T S P f t.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i t.\n           \\<lbrakk>i < length T; T ! i = t \\<cdot> \\<delta>;\n            \\<forall>x\\<in>fv t \\<union> fv (S ! i).\n               (\\<exists>y. \\<delta> x = Var y) \\<or>\n               (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n           \\<Longrightarrow> \\<exists>u.\n                                term_variants_pred P t u \\<and>\n                                S ! i = u \\<cdot> \\<delta>;\n        Fun f T = t \\<cdot> \\<delta>;\n        \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n           (\\<exists>y. \\<delta> x = Var y) \\<or>\n           (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u.\n                            term_variants_pred P t u \\<and>\n                            Fun f S = u \\<cdot> \\<delta>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "proof (cases t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "case (Var x)"], ["proof (state)\nthis:\n  t = Var x\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "hence \"T = []\" \"P f = []\""], ["proof (prove)\nusing this:\n  t = Var x\n\ngoal (1 subgoal):\n 1. T = [] &&& P f = []", "using term_variants_Fun.hyps(4) term_variants_Fun.prems"], ["proof (prove)\nusing this:\n  t = Var x\n  Fun f T = t \\<cdot> \\<delta>\n  \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. T = [] &&& P f = []", "by fastforce+"], ["proof (state)\nthis:\n  T = []\n  P f = []\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "thus ?thesis"], ["proof (prove)\nusing this:\n  T = []\n  P f = []\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "using term_variants_pred_refl Var term_variants_Fun.hyps(1,4)"], ["proof (prove)\nusing this:\n  T = []\n  P f = []\n  term_variants_pred ?P ?t ?t\n  t = Var x\n  length T = length S\n  Fun f T = t \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "by fastforce"], ["proof (state)\nthis:\n  \\<exists>u. term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "case (Fun h U)"], ["proof (state)\nthis:\n  t = Fun h U\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "hence 1: \"h = f\" \"T = map (\\<lambda>s. s \\<cdot> \\<delta>) U\" \"length U = length T\""], ["proof (prove)\nusing this:\n  t = Fun h U\n\ngoal (1 subgoal):\n 1. h = f &&&\n    T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> &&&\n    length U = length T", "using term_variants_Fun.hyps(4)"], ["proof (prove)\nusing this:\n  t = Fun h U\n  Fun f T = t \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. h = f &&&\n    T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> &&&\n    length U = length T", "by simp_all"], ["proof (state)\nthis:\n  h = f\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  length U = length T\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "hence 2: \"T ! i = U ! i \\<cdot> \\<delta>\" when \"i < length T\" for i"], ["proof (prove)\nusing this:\n  h = f\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  length U = length T\n\ngoal (1 subgoal):\n 1. T ! i = U ! i \\<cdot> \\<delta>", "using that"], ["proof (prove)\nusing this:\n  h = f\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  length U = length T\n  i < length T\n\ngoal (1 subgoal):\n 1. T ! i = U ! i \\<cdot> \\<delta>", "by simp"], ["proof (state)\nthis:\n  ?i < length T \\<Longrightarrow> T ! ?i = U ! ?i \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "have \"\\<forall>x \\<in> fv (U ! i) \\<union> fv (S ! i). (\\<exists>y. \\<delta> x = Var y) \\<or> (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\"\n      when \"i < length U\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (U ! i) \\<union> fv (S ! i).\n       (\\<exists>y. \\<delta> x = Var y) \\<or>\n       (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])", "using that Fun term_variants_Fun.prems term_variants_Fun.hyps(1) 1(3)"], ["proof (prove)\nusing this:\n  i < length U\n  t = Fun h U\n  \\<forall>x\\<in>fv t \\<union> fv (Fun f S).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n  length T = length S\n  length U = length T\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (U ! i) \\<union> fv (S ! i).\n       (\\<exists>y. \\<delta> x = Var y) \\<or>\n       (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])", "by force"], ["proof (state)\nthis:\n  ?i < length U \\<Longrightarrow>\n  \\<forall>x\\<in>fv (U ! ?i) \\<union> fv (S ! ?i).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "hence IH: \"\\<forall>i < length U. \\<exists>u. term_variants_pred P (U ! i) u \\<and> S ! i = u \\<cdot> \\<delta>\""], ["proof (prove)\nusing this:\n  ?i < length U \\<Longrightarrow>\n  \\<forall>x\\<in>fv (U ! ?i) \\<union> fv (S ! ?i).\n     (\\<exists>y. \\<delta> x = Var y) \\<or>\n     (\\<exists>f. \\<delta> x = Fun f [] \\<and> P f = [])\n\ngoal (1 subgoal):\n 1. \\<forall>i<length U.\n       \\<exists>u.\n          term_variants_pred P (U ! i) u \\<and> S ! i = u \\<cdot> \\<delta>", "by (metis 1(3) term_variants_Fun.hyps(3)[OF _ 2 ])"], ["proof (state)\nthis:\n  \\<forall>i<length U.\n     \\<exists>u.\n        term_variants_pred P (U ! i) u \\<and> S ! i = u \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "have \"\\<exists>V. length U = length V \\<and> S = map (\\<lambda>v. v \\<cdot> \\<delta>) V \\<and>\n               (\\<forall>i < length U. term_variants_pred P (U ! i) (V ! i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>V.\n       length U = length V \\<and>\n       S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))", "using term_variants_Fun.hyps(1) 1(3) subst_term_list_obtain[OF IH]"], ["proof (prove)\nusing this:\n  length T = length S\n  length U = length T\n  length U = length S \\<Longrightarrow>\n  \\<exists>Ua.\n     length U = length Ua \\<and>\n     (\\<forall>i<length U. term_variants_pred P (U ! i) (Ua ! i)) \\<and>\n     S = Ua \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>V.\n       length U = length V \\<and>\n       S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))", "by metis"], ["proof (state)\nthis:\n  \\<exists>V.\n     length U = length V \\<and>\n     S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "then"], ["proof (chain)\npicking this:\n  \\<exists>V.\n     length U = length V \\<and>\n     S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))", "obtain V where V: \"length U = length V\" \"S = map (\\<lambda>v. v \\<cdot> \\<delta>) V\"\n                           \"\\<And>i. i < length U \\<Longrightarrow> term_variants_pred P (U ! i) (V ! i)\""], ["proof (prove)\nusing this:\n  \\<exists>V.\n     length U = length V \\<and>\n     S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     (\\<forall>i<length U. term_variants_pred P (U ! i) (V ! i))\n\ngoal (1 subgoal):\n 1. (\\<And>V.\n        \\<lbrakk>length U = length V;\n         S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>;\n         \\<And>i.\n            i < length U \\<Longrightarrow>\n            term_variants_pred P (U ! i) (V ! i)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  length U = length V\n  S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  ?i < length U \\<Longrightarrow> term_variants_pred P (U ! ?i) (V ! ?i)\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "have \"term_variants_pred P (Fun f U) (Fun f V)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f U) (Fun f V)", "by (metis term_variants_pred.term_variants_Fun[OF V(1,3)])"], ["proof (state)\nthis:\n  term_variants_pred P (Fun f U) (Fun f V)\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "moreover"], ["proof (state)\nthis:\n  term_variants_pred P (Fun f U) (Fun f V)\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "have \"Fun f S = Fun f V \\<cdot> \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Fun f S = Fun f V \\<cdot> \\<delta>", "using V(2)"], ["proof (prove)\nusing this:\n  S = V \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. Fun f S = Fun f V \\<cdot> \\<delta>", "by simp"], ["proof (state)\nthis:\n  Fun f S = Fun f V \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>u.\n          term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "ultimately"], ["proof (chain)\npicking this:\n  term_variants_pred P (Fun f U) (Fun f V)\n  Fun f S = Fun f V \\<cdot> \\<delta>", "show ?thesis"], ["proof (prove)\nusing this:\n  term_variants_pred P (Fun f U) (Fun f V)\n  Fun f S = Fun f V \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "using term_variants_Fun.hyps(1) Fun 1"], ["proof (prove)\nusing this:\n  term_variants_pred P (Fun f U) (Fun f V)\n  Fun f S = Fun f V \\<cdot> \\<delta>\n  length T = length S\n  t = Fun h U\n  h = f\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>\n  length U = length T\n\ngoal (1 subgoal):\n 1. \\<exists>u. term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>", "by blast"], ["proof (state)\nthis:\n  \\<exists>u. term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>u. term_variants_pred P t u \\<and> Fun f S = u \\<cdot> \\<delta>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma term_variants_pred_iff_in_term_variants:\n  fixes t::\"('a,'b) term\"\n  shows \"term_variants_pred P t s \\<longleftrightarrow> s \\<in> set (term_variants P t)\"\n    (is \"?A t s \\<longleftrightarrow> ?B t s\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P t s = (s \\<in> set (term_variants P t))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. term_variants_pred P t s \\<Longrightarrow>\n    s \\<in> set (term_variants P t)\n 2. s \\<in> set (term_variants P t) \\<Longrightarrow>\n    term_variants_pred P t s", "define U where \"U \\<equiv> \\<lambda>P (T::('a,'b) term list). product_lists (map (term_variants P) T)\""], ["proof (state)\nthis:\n  U \\<equiv> \\<lambda>P T. product_lists (map (term_variants P) T)\n\ngoal (2 subgoals):\n 1. term_variants_pred P t s \\<Longrightarrow>\n    s \\<in> set (term_variants P t)\n 2. s \\<in> set (term_variants P t) \\<Longrightarrow>\n    term_variants_pred P t s", "have a:\n      \"g \\<in> set (P f) \\<Longrightarrow> set (map (Fun g) (U P T)) \\<subseteq> set (term_variants P (Fun f T))\"\n      \"set (map (Fun f) (U P T)) \\<subseteq> set (term_variants P (Fun f T))\"\n    for f P g and T::\"('a,'b) term list\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (g \\<in> set (P f) \\<Longrightarrow>\n     set (map (Fun g) (U P T))\n     \\<subseteq> set (term_variants P (Fun f T))) &&&\n    set (map (Fun f) (U P T)) \\<subseteq> set (term_variants P (Fun f T))", "using term_variants.simps(2)[of P f T]"], ["proof (prove)\nusing this:\n  term_variants P (Fun f T) =\n  (let S = product_lists (map (term_variants P) T)\n   in map (Fun f) S @ concat (map (\\<lambda>g. map (Fun g) S) (P f)))\n\ngoal (1 subgoal):\n 1. (g \\<in> set (P f) \\<Longrightarrow>\n     set (map (Fun g) (U P T))\n     \\<subseteq> set (term_variants P (Fun f T))) &&&\n    set (map (Fun f) (U P T)) \\<subseteq> set (term_variants P (Fun f T))", "unfolding U_def Let_def"], ["proof (prove)\nusing this:\n  term_variants P (Fun f T) =\n  map (Fun f) (product_lists (map (term_variants P) T)) @\n  concat\n   (map (\\<lambda>g. map (Fun g) (product_lists (map (term_variants P) T)))\n     (P f))\n\ngoal (1 subgoal):\n 1. (g \\<in> set (P f) \\<Longrightarrow>\n     set (map (Fun g) (product_lists (map (term_variants P) T)))\n     \\<subseteq> set (term_variants P (Fun f T))) &&&\n    set (map (Fun f) (product_lists (map (term_variants P) T)))\n    \\<subseteq> set (term_variants P (Fun f T))", "by auto"], ["proof (state)\nthis:\n  ?g \\<in> set (?P ?f) \\<Longrightarrow>\n  set (map (Fun ?g) (U ?P ?T))\n  \\<subseteq> set (term_variants ?P (Fun ?f ?T))\n  set (map (Fun ?f) (U ?P ?T))\n  \\<subseteq> set (term_variants ?P (Fun ?f ?T))\n\ngoal (2 subgoals):\n 1. term_variants_pred P t s \\<Longrightarrow>\n    s \\<in> set (term_variants P t)\n 2. s \\<in> set (term_variants P t) \\<Longrightarrow>\n    term_variants_pred P t s", "have b: \"\\<exists>S \\<in> set (U P T). s = Fun f S \\<or> (\\<exists>g \\<in> set (P f). s = Fun g S)\"\n    when \"s \\<in> set (term_variants P (Fun f T))\" for P T f s"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>S\\<in>set (U P T).\n       s = Fun f S \\<or> (\\<exists>g\\<in>set (P f). s = Fun g S)", "using that"], ["proof (prove)\nusing this:\n  s \\<in> set (term_variants P (Fun f T))\n\ngoal (1 subgoal):\n 1. \\<exists>S\\<in>set (U P T).\n       s = Fun f S \\<or> (\\<exists>g\\<in>set (P f). s = Fun g S)", "by (cases \"P f\") (auto simp add: U_def Let_def)"], ["proof (state)\nthis:\n  ?s \\<in> set (term_variants ?P (Fun ?f ?T)) \\<Longrightarrow>\n  \\<exists>S\\<in>set (U ?P ?T).\n     ?s = Fun ?f S \\<or> (\\<exists>g\\<in>set (?P ?f). ?s = Fun g S)\n\ngoal (2 subgoals):\n 1. term_variants_pred P t s \\<Longrightarrow>\n    s \\<in> set (term_variants P t)\n 2. s \\<in> set (term_variants P t) \\<Longrightarrow>\n    term_variants_pred P t s", "have c: \"length T = length S\" when \"S \\<in> set (U P T)\" for S P T"], ["proof (prove)\ngoal (1 subgoal):\n 1. length T = length S", "using that"], ["proof (prove)\nusing this:\n  S \\<in> set (U P T)\n\ngoal (1 subgoal):\n 1. length T = length S", "unfolding U_def"], ["proof (prove)\nusing this:\n  S \\<in> set (product_lists (map (term_variants P) T))\n\ngoal (1 subgoal):\n 1. length T = length S", "by (simp add: in_set_product_lists_length)"], ["proof (state)\nthis:\n  ?S \\<in> set (U ?P ?T) \\<Longrightarrow> length ?T = length ?S\n\ngoal (2 subgoals):\n 1. term_variants_pred P t s \\<Longrightarrow>\n    s \\<in> set (term_variants P t)\n 2. s \\<in> set (term_variants P t) \\<Longrightarrow>\n    term_variants_pred P t s", "show \"?A t s \\<Longrightarrow> ?B t s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. term_variants_pred P t s \\<Longrightarrow>\n    s \\<in> set (term_variants P t)", "proof (induction P t s rule: term_variants_pred.induct)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i));\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> Fun g S \\<in> set (term_variants P (Fun f T))\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "case (term_variants_P T S P g f)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  g \\<in> set (P f)\n  ?i < length T \\<Longrightarrow>\n  S ! ?i \\<in> set (term_variants P (T ! ?i))\n\ngoal (3 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i));\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> Fun g S \\<in> set (term_variants P (Fun f T))\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "note hyps = term_variants_P.hyps"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  g \\<in> set (P f)\n\ngoal (3 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i));\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> Fun g S \\<in> set (term_variants P (Fun f T))\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "note IH = term_variants_P.IH"], ["proof (state)\nthis:\n  ?i < length T \\<Longrightarrow>\n  S ! ?i \\<in> set (term_variants P (T ! ?i))\n\ngoal (3 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i));\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> Fun g S \\<in> set (term_variants P (Fun f T))\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "have \"S \\<in> set (U P T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<in> set (U P T)", "using IH hyps(1) product_lists_in_set_nth'[of _ S]"], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow>\n  S ! ?i \\<in> set (term_variants P (T ! ?i))\n  length T = length S\n  \\<lbrakk>\\<forall>i<length ?xs. S ! i \\<in> set (?xs ! i);\n   length ?xs = length S\\<rbrakk>\n  \\<Longrightarrow> S \\<in> set (product_lists ?xs)\n\ngoal (1 subgoal):\n 1. S \\<in> set (U P T)", "unfolding U_def"], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow>\n  S ! ?i \\<in> set (term_variants P (T ! ?i))\n  length T = length S\n  \\<lbrakk>\\<forall>i<length ?xs. S ! i \\<in> set (?xs ! i);\n   length ?xs = length S\\<rbrakk>\n  \\<Longrightarrow> S \\<in> set (product_lists ?xs)\n\ngoal (1 subgoal):\n 1. S \\<in> set (product_lists (map (term_variants P) T))", "by simp"], ["proof (state)\nthis:\n  S \\<in> set (U P T)\n\ngoal (3 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i));\n        g \\<in> set (P f)\\<rbrakk>\n       \\<Longrightarrow> Fun g S \\<in> set (term_variants P (Fun f T))\n 3. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "thus ?case"], ["proof (prove)\nusing this:\n  S \\<in> set (U P T)\n\ngoal (1 subgoal):\n 1. Fun g S \\<in> set (term_variants P (Fun f T))", "using a(1)[of _ P, OF hyps(3)]"], ["proof (prove)\nusing this:\n  S \\<in> set (U P T)\n  set (map (Fun g) (U P ?T)) \\<subseteq> set (term_variants P (Fun f ?T))\n\ngoal (1 subgoal):\n 1. Fun g S \\<in> set (term_variants P (Fun f T))", "by auto"], ["proof (state)\nthis:\n  Fun g S \\<in> set (term_variants P (Fun f T))\n\ngoal (2 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "case (term_variants_Fun T S P f)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  ?i < length T \\<Longrightarrow>\n  S ! ?i \\<in> set (term_variants P (T ! ?i))\n\ngoal (2 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "note hyps = term_variants_Fun.hyps"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n\ngoal (2 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "note IH = term_variants_Fun.IH"], ["proof (state)\nthis:\n  ?i < length T \\<Longrightarrow>\n  S ! ?i \\<in> set (term_variants P (T ! ?i))\n\ngoal (2 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "have \"S \\<in> set (U P T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<in> set (U P T)", "using IH hyps(1) product_lists_in_set_nth'[of _ S]"], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow>\n  S ! ?i \\<in> set (term_variants P (T ! ?i))\n  length T = length S\n  \\<lbrakk>\\<forall>i<length ?xs. S ! i \\<in> set (?xs ! i);\n   length ?xs = length S\\<rbrakk>\n  \\<Longrightarrow> S \\<in> set (product_lists ?xs)\n\ngoal (1 subgoal):\n 1. S \\<in> set (U P T)", "unfolding U_def"], ["proof (prove)\nusing this:\n  ?i < length T \\<Longrightarrow>\n  S ! ?i \\<in> set (term_variants P (T ! ?i))\n  length T = length S\n  \\<lbrakk>\\<forall>i<length ?xs. S ! i \\<in> set (?xs ! i);\n   length ?xs = length S\\<rbrakk>\n  \\<Longrightarrow> S \\<in> set (product_lists ?xs)\n\ngoal (1 subgoal):\n 1. S \\<in> set (product_lists (map (term_variants P) T))", "by simp"], ["proof (state)\nthis:\n  S \\<in> set (U P T)\n\ngoal (2 subgoals):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           S ! i \\<in> set (term_variants P (T ! i))\\<rbrakk>\n       \\<Longrightarrow> Fun f S \\<in> set (term_variants P (Fun f T))", "thus ?case"], ["proof (prove)\nusing this:\n  S \\<in> set (U P T)\n\ngoal (1 subgoal):\n 1. Fun f S \\<in> set (term_variants P (Fun f T))", "using a(2)[of f P T]"], ["proof (prove)\nusing this:\n  S \\<in> set (U P T)\n  set (map (Fun f) (U P T)) \\<subseteq> set (term_variants P (Fun f T))\n\ngoal (1 subgoal):\n 1. Fun f S \\<in> set (term_variants P (Fun f T))", "by (cases \"P f\") auto"], ["proof (state)\nthis:\n  Fun f S \\<in> set (term_variants P (Fun f T))\n\ngoal (1 subgoal):\n 1. \\<And>P x. Var x \\<in> set (term_variants P (Var x))", "qed (simp add: term_variants_Var)"], ["proof (state)\nthis:\n  term_variants_pred P t s \\<Longrightarrow> s \\<in> set (term_variants P t)\n\ngoal (1 subgoal):\n 1. s \\<in> set (term_variants P t) \\<Longrightarrow>\n    term_variants_pred P t s", "show \"?B t s \\<Longrightarrow> ?A t s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. s \\<in> set (term_variants P t) \\<Longrightarrow>\n    term_variants_pred P t s", "proof (induction P t arbitrary: s rule: term_variants.induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P x s.\n       s \\<in> set (term_variants P (Var x)) \\<Longrightarrow>\n       term_variants_pred P (Var x) s\n 2. \\<And>P f T s.\n       \\<lbrakk>\\<And>x s.\n                   \\<lbrakk>x \\<in> set T;\n                    s \\<in> set (term_variants P x)\\<rbrakk>\n                   \\<Longrightarrow> term_variants_pred P x s;\n        s \\<in> set (term_variants P (Fun f T))\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T) s", "case (2 P f T)"], ["proof (state)\nthis:\n  \\<lbrakk>?x \\<in> set T; ?s \\<in> set (term_variants P ?x)\\<rbrakk>\n  \\<Longrightarrow> term_variants_pred P ?x ?s\n  s \\<in> set (term_variants P (Fun f T))\n\ngoal (2 subgoals):\n 1. \\<And>P x s.\n       s \\<in> set (term_variants P (Var x)) \\<Longrightarrow>\n       term_variants_pred P (Var x) s\n 2. \\<And>P f T s.\n       \\<lbrakk>\\<And>x s.\n                   \\<lbrakk>x \\<in> set T;\n                    s \\<in> set (term_variants P x)\\<rbrakk>\n                   \\<Longrightarrow> term_variants_pred P x s;\n        s \\<in> set (term_variants P (Fun f T))\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T) s", "obtain S where S:\n        \"s = Fun f S \\<or> (\\<exists>g \\<in> set (P f). s = Fun g S)\"\n        \"S \\<in> set (U P T)\" \"length T = length S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>S.\n        \\<lbrakk>s = Fun f S \\<or> (\\<exists>g\\<in>set (P f). s = Fun g S);\n         S \\<in> set (U P T); length T = length S\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using c b[OF \"2.prems\"]"], ["proof (prove)\nusing this:\n  ?S \\<in> set (U ?P ?T) \\<Longrightarrow> length ?T = length ?S\n  \\<exists>S\\<in>set (U P T).\n     s = Fun f S \\<or> (\\<exists>g\\<in>set (P f). s = Fun g S)\n\ngoal (1 subgoal):\n 1. (\\<And>S.\n        \\<lbrakk>s = Fun f S \\<or> (\\<exists>g\\<in>set (P f). s = Fun g S);\n         S \\<in> set (U P T); length T = length S\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  s = Fun f S \\<or> (\\<exists>g\\<in>set (P f). s = Fun g S)\n  S \\<in> set (U P T)\n  length T = length S\n\ngoal (2 subgoals):\n 1. \\<And>P x s.\n       s \\<in> set (term_variants P (Var x)) \\<Longrightarrow>\n       term_variants_pred P (Var x) s\n 2. \\<And>P f T s.\n       \\<lbrakk>\\<And>x s.\n                   \\<lbrakk>x \\<in> set T;\n                    s \\<in> set (term_variants P x)\\<rbrakk>\n                   \\<Longrightarrow> term_variants_pred P x s;\n        s \\<in> set (term_variants P (Fun f T))\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T) s", "have \"\\<forall>i < length T. term_variants_pred P (T ! i) (S ! i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<length T. term_variants_pred P (T ! i) (S ! i)", "using \"2.IH\" S product_lists_in_set_nth"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x \\<in> set T; ?s \\<in> set (term_variants P ?x)\\<rbrakk>\n  \\<Longrightarrow> term_variants_pred P ?x ?s\n  s = Fun f S \\<or> (\\<exists>g\\<in>set (P f). s = Fun g S)\n  S \\<in> set (U P T)\n  length T = length S\n  ?xs \\<in> set (product_lists ?ys) \\<Longrightarrow>\n  \\<forall>i<length ?ys. ?xs ! i \\<in> set (?ys ! i)\n\ngoal (1 subgoal):\n 1. \\<forall>i<length T. term_variants_pred P (T ! i) (S ! i)", "by (fastforce simp add: U_def)"], ["proof (state)\nthis:\n  \\<forall>i<length T. term_variants_pred P (T ! i) (S ! i)\n\ngoal (2 subgoals):\n 1. \\<And>P x s.\n       s \\<in> set (term_variants P (Var x)) \\<Longrightarrow>\n       term_variants_pred P (Var x) s\n 2. \\<And>P f T s.\n       \\<lbrakk>\\<And>x s.\n                   \\<lbrakk>x \\<in> set T;\n                    s \\<in> set (term_variants P x)\\<rbrakk>\n                   \\<Longrightarrow> term_variants_pred P x s;\n        s \\<in> set (term_variants P (Fun f T))\\<rbrakk>\n       \\<Longrightarrow> term_variants_pred P (Fun f T) s", "thus ?case"], ["proof (prove)\nusing this:\n  \\<forall>i<length T. term_variants_pred P (T ! i) (S ! i)\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f T) s", "using S"], ["proof (prove)\nusing this:\n  \\<forall>i<length T. term_variants_pred P (T ! i) (S ! i)\n  s = Fun f S \\<or> (\\<exists>g\\<in>set (P f). s = Fun g S)\n  S \\<in> set (U P T)\n  length T = length S\n\ngoal (1 subgoal):\n 1. term_variants_pred P (Fun f T) s", "by (auto intro: term_variants_pred.intros)"], ["proof (state)\nthis:\n  term_variants_pred P (Fun f T) s\n\ngoal (1 subgoal):\n 1. \\<And>P x s.\n       s \\<in> set (term_variants P (Var x)) \\<Longrightarrow>\n       term_variants_pred P (Var x) s", "qed (simp add: term_variants_Var)"], ["proof (state)\nthis:\n  s \\<in> set (term_variants P t) \\<Longrightarrow> term_variants_pred P t s\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma term_variants_pred_finite:\n  \"finite {s. term_variants_pred P t s}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {s. term_variants_pred P t s}", "using term_variants_pred_iff_in_term_variants[of P t]"], ["proof (prove)\nusing this:\n  term_variants_pred P t ?s = (?s \\<in> set (term_variants P t))\n\ngoal (1 subgoal):\n 1. finite {s. term_variants_pred P t s}", "by simp"], ["", "lemma term_variants_pred_fv_eq:\n  assumes \"term_variants_pred P s t\"\n  shows \"fv s = fv t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv s = fv t", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P s t\n\ngoal (1 subgoal):\n 1. fv s = fv t", "by (induct rule: term_variants_pred.induct)\n   (metis, metis fv_eq_FunI, metis fv_eq_FunI)"], ["", "lemma (in intruder_model) term_variants_pred_wf_trms:\n  assumes \"term_variants_pred P s t\"\n    and \"\\<And>f g. g \\<in> set (P f) \\<Longrightarrow> arity f = arity g\"\n    and \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\"\n  shows \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P s t\n  ?g2 \\<in> set (P ?f2) \\<Longrightarrow> arity ?f2 = arity ?g2\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "apply (induction rule: term_variants_pred.induct, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>T S P g f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<And>g f.\n               g \\<in> set (P f) \\<Longrightarrow> arity f = arity g;\n            wf\\<^sub>t\\<^sub>r\\<^sub>m (T ! i)\\<rbrakk>\n           \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (S ! i);\n        g \\<in> set (P f);\n        \\<And>g f. g \\<in> set (P f) \\<Longrightarrow> arity f = arity g;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g S)\n 2. \\<And>T S P f.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T;\n            \\<And>g f.\n               g \\<in> set (P f) \\<Longrightarrow> arity f = arity g;\n            wf\\<^sub>t\\<^sub>r\\<^sub>m (T ! i)\\<rbrakk>\n           \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (S ! i);\n        \\<And>g f. g \\<in> set (P f) \\<Longrightarrow> arity f = arity g;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f S)", "by (metis (no_types) wf_trmI wf_trm_arity in_set_conv_nth wf_trm_param_idx)+"], ["", "lemma term_variants_pred_funs_term:\n  assumes \"term_variants_pred P s t\"\n    and \"f \\<in> funs_term t\"\n  shows \"f \\<in> funs_term s \\<or> (\\<exists>g \\<in> funs_term s. f \\<in> set (P g))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> funs_term s \\<or>\n    (\\<exists>g\\<in>funs_term s. f \\<in> set (P g))", "using assms"], ["proof (prove)\nusing this:\n  term_variants_pred P s t\n  f \\<in> funs_term t\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term s \\<or>\n    (\\<exists>g\\<in>funs_term s. f \\<in> set (P g))", "proof (induction rule: term_variants_pred.induct)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P x.\n       f \\<in> funs_term (Var x) \\<Longrightarrow>\n       f \\<in> funs_term (Var x) \\<or>\n       (\\<exists>g\\<in>funs_term (Var x). f \\<in> set (P g))\n 2. \\<And>T S P g fa.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n           \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                             (\\<exists>g\\<in>funs_term (T ! i).\n                                 f \\<in> set (P g));\n        g \\<in> set (P fa); f \\<in> funs_term (Fun g S)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (Fun fa T) \\<or>\n                         (\\<exists>g\\<in>funs_term (Fun fa T).\n                             f \\<in> set (P g))\n 3. \\<And>T S P fa.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n           \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                             (\\<exists>g\\<in>funs_term (T ! i).\n                                 f \\<in> set (P g));\n        f \\<in> funs_term (Fun fa S)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (Fun fa T) \\<or>\n                         (\\<exists>g\\<in>funs_term (Fun fa T).\n                             f \\<in> set (P g))", "case (term_variants_P T S P g h)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  g \\<in> set (P h)\n  \\<lbrakk>?i < length T; f \\<in> funs_term (S ! ?i)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (T ! ?i) \\<or>\n                    (\\<exists>g\\<in>funs_term (T ! ?i). f \\<in> set (P g))\n  f \\<in> funs_term (Fun g S)\n\ngoal (3 subgoals):\n 1. \\<And>P x.\n       f \\<in> funs_term (Var x) \\<Longrightarrow>\n       f \\<in> funs_term (Var x) \\<or>\n       (\\<exists>g\\<in>funs_term (Var x). f \\<in> set (P g))\n 2. \\<And>T S P g fa.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n           \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                             (\\<exists>g\\<in>funs_term (T ! i).\n                                 f \\<in> set (P g));\n        g \\<in> set (P fa); f \\<in> funs_term (Fun g S)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (Fun fa T) \\<or>\n                         (\\<exists>g\\<in>funs_term (Fun fa T).\n                             f \\<in> set (P g))\n 3. \\<And>T S P fa.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n           \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                             (\\<exists>g\\<in>funs_term (T ! i).\n                                 f \\<in> set (P g));\n        f \\<in> funs_term (Fun fa S)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (Fun fa T) \\<or>\n                         (\\<exists>g\\<in>funs_term (Fun fa T).\n                             f \\<in> set (P g))", "thus ?case"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  g \\<in> set (P h)\n  \\<lbrakk>?i < length T; f \\<in> funs_term (S ! ?i)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (T ! ?i) \\<or>\n                    (\\<exists>g\\<in>funs_term (T ! ?i). f \\<in> set (P g))\n  f \\<in> funs_term (Fun g S)\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (Fun h T) \\<or>\n    (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))", "proof (cases \"f = g\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     g \\<in> set (P h);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun g S); f = g\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))\n 2. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     g \\<in> set (P h);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun g S); f \\<noteq> g\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))", "case False"], ["proof (state)\nthis:\n  f \\<noteq> g\n\ngoal (2 subgoals):\n 1. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     g \\<in> set (P h);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun g S); f = g\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))\n 2. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     g \\<in> set (P h);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun g S); f \\<noteq> g\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))", "then"], ["proof (chain)\npicking this:\n  f \\<noteq> g", "obtain s where \"s \\<in> set S\" \"f \\<in> funs_term s\""], ["proof (prove)\nusing this:\n  f \\<noteq> g\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> set S; f \\<in> funs_term s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using funs_term_subterms_eq(1)[of \"Fun g S\"] term_variants_P.prems"], ["proof (prove)\nusing this:\n  f \\<noteq> g\n  \\<Union> (funs_term ` subterms (Fun g S)) = funs_term (Fun g S)\n  f \\<in> funs_term (Fun g S)\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> set S; f \\<in> funs_term s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  s \\<in> set S\n  f \\<in> funs_term s\n\ngoal (2 subgoals):\n 1. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     g \\<in> set (P h);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun g S); f = g\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))\n 2. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     g \\<in> set (P h);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun g S); f \\<noteq> g\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))", "thus ?thesis"], ["proof (prove)\nusing this:\n  s \\<in> set S\n  f \\<in> funs_term s\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (Fun h T) \\<or>\n    (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))", "using term_variants_P.IH term_variants_P.hyps(1) in_set_conv_nth[of s S]"], ["proof (prove)\nusing this:\n  s \\<in> set S\n  f \\<in> funs_term s\n  \\<lbrakk>?i < length T; f \\<in> funs_term (S ! ?i)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (T ! ?i) \\<or>\n                    (\\<exists>g\\<in>funs_term (T ! ?i). f \\<in> set (P g))\n  length T = length S\n  (s \\<in> set S) = (\\<exists>i<length S. S ! i = s)\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (Fun h T) \\<or>\n    (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))", "by force"], ["proof (state)\nthis:\n  f \\<in> funs_term (Fun h T) \\<or>\n  (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     g \\<in> set (P h);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun g S); f = g\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))", "qed simp"], ["proof (state)\nthis:\n  f \\<in> funs_term (Fun h T) \\<or>\n  (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       f \\<in> funs_term (Var x) \\<Longrightarrow>\n       f \\<in> funs_term (Var x) \\<or>\n       (\\<exists>g\\<in>funs_term (Var x). f \\<in> set (P g))\n 2. \\<And>T S P fa.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n           \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                             (\\<exists>g\\<in>funs_term (T ! i).\n                                 f \\<in> set (P g));\n        f \\<in> funs_term (Fun fa S)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (Fun fa T) \\<or>\n                         (\\<exists>g\\<in>funs_term (Fun fa T).\n                             f \\<in> set (P g))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P x.\n       f \\<in> funs_term (Var x) \\<Longrightarrow>\n       f \\<in> funs_term (Var x) \\<or>\n       (\\<exists>g\\<in>funs_term (Var x). f \\<in> set (P g))\n 2. \\<And>T S P fa.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n           \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                             (\\<exists>g\\<in>funs_term (T ! i).\n                                 f \\<in> set (P g));\n        f \\<in> funs_term (Fun fa S)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (Fun fa T) \\<or>\n                         (\\<exists>g\\<in>funs_term (Fun fa T).\n                             f \\<in> set (P g))", "case (term_variants_Fun T S P h)"], ["proof (state)\nthis:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T; f \\<in> funs_term (S ! ?i)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (T ! ?i) \\<or>\n                    (\\<exists>g\\<in>funs_term (T ! ?i). f \\<in> set (P g))\n  f \\<in> funs_term (Fun h S)\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       f \\<in> funs_term (Var x) \\<Longrightarrow>\n       f \\<in> funs_term (Var x) \\<or>\n       (\\<exists>g\\<in>funs_term (Var x). f \\<in> set (P g))\n 2. \\<And>T S P fa.\n       \\<lbrakk>length T = length S;\n        \\<And>i.\n           i < length T \\<Longrightarrow>\n           term_variants_pred P (T ! i) (S ! i);\n        \\<And>i.\n           \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n           \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                             (\\<exists>g\\<in>funs_term (T ! i).\n                                 f \\<in> set (P g));\n        f \\<in> funs_term (Fun fa S)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (Fun fa T) \\<or>\n                         (\\<exists>g\\<in>funs_term (Fun fa T).\n                             f \\<in> set (P g))", "thus ?case"], ["proof (prove)\nusing this:\n  length T = length S\n  ?i < length T \\<Longrightarrow> term_variants_pred P (T ! ?i) (S ! ?i)\n  \\<lbrakk>?i < length T; f \\<in> funs_term (S ! ?i)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (T ! ?i) \\<or>\n                    (\\<exists>g\\<in>funs_term (T ! ?i). f \\<in> set (P g))\n  f \\<in> funs_term (Fun h S)\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (Fun h T) \\<or>\n    (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))", "proof (cases \"f = h\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun h S); f = h\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))\n 2. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun h S); f \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))", "case False"], ["proof (state)\nthis:\n  f \\<noteq> h\n\ngoal (2 subgoals):\n 1. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun h S); f = h\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))\n 2. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun h S); f \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))", "then"], ["proof (chain)\npicking this:\n  f \\<noteq> h", "obtain s where \"s \\<in> set S\" \"f \\<in> funs_term s\""], ["proof (prove)\nusing this:\n  f \\<noteq> h\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> set S; f \\<in> funs_term s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using funs_term_subterms_eq(1)[of \"Fun h S\"] term_variants_Fun.prems"], ["proof (prove)\nusing this:\n  f \\<noteq> h\n  \\<Union> (funs_term ` subterms (Fun h S)) = funs_term (Fun h S)\n  f \\<in> funs_term (Fun h S)\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> set S; f \\<in> funs_term s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  s \\<in> set S\n  f \\<in> funs_term s\n\ngoal (2 subgoals):\n 1. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun h S); f = h\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))\n 2. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun h S); f \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))", "thus ?thesis"], ["proof (prove)\nusing this:\n  s \\<in> set S\n  f \\<in> funs_term s\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (Fun h T) \\<or>\n    (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))", "using term_variants_Fun.IH term_variants_Fun.hyps(1) in_set_conv_nth[of s S]"], ["proof (prove)\nusing this:\n  s \\<in> set S\n  f \\<in> funs_term s\n  \\<lbrakk>?i < length T; f \\<in> funs_term (S ! ?i)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (T ! ?i) \\<or>\n                    (\\<exists>g\\<in>funs_term (T ! ?i). f \\<in> set (P g))\n  length T = length S\n  (s \\<in> set S) = (\\<exists>i<length S. S ! i = s)\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (Fun h T) \\<or>\n    (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))", "by force"], ["proof (state)\nthis:\n  f \\<in> funs_term (Fun h T) \\<or>\n  (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>length T = length S;\n     \\<And>i.\n        i < length T \\<Longrightarrow> term_variants_pred P (T ! i) (S ! i);\n     \\<And>i.\n        \\<lbrakk>i < length T; f \\<in> funs_term (S ! i)\\<rbrakk>\n        \\<Longrightarrow> f \\<in> funs_term (T ! i) \\<or>\n                          (\\<exists>g\\<in>funs_term (T ! i).\n                              f \\<in> set (P g));\n     f \\<in> funs_term (Fun h S); f = h\\<rbrakk>\n    \\<Longrightarrow> f \\<in> funs_term (Fun h T) \\<or>\n                      (\\<exists>g\\<in>funs_term (Fun h T).\n                          f \\<in> set (P g))", "qed simp"], ["proof (state)\nthis:\n  f \\<in> funs_term (Fun h T) \\<or>\n  (\\<exists>g\\<in>funs_term (Fun h T). f \\<in> set (P g))\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       f \\<in> funs_term (Var x) \\<Longrightarrow>\n       f \\<in> funs_term (Var x) \\<or>\n       (\\<exists>g\\<in>funs_term (Var x). f \\<in> set (P g))", "qed fast"], ["", "end"]]}