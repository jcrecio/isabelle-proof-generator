{"file_name": "/home/qj213/afp-2021-10-22/thys/Stable_Matching/Sotomayor.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Stable_Matching", "problem_names": ["lemma stable_match:\n  assumes \"stable \\<mu>\"\n  shows \"match \\<mu>\"", "lemma simple_match:\n  assumes \"simple \\<mu>\"\n  shows \"match \\<mu>\"", "lemma simple_ex:\n  \"\\<exists>\\<mu>. simple \\<mu>\"", "lemma simple_no_single_women_stable:\n  assumes \"simple \\<mu>\"\n  assumes \"\\<forall>w. w \\<in> Range \\<mu>\" \\<comment> \\<open>No woman is single\\<close>\n  shows \"stable \\<mu>\"", "lemma stable_simple:\n  assumes \"stable \\<mu>\"\n  shows \"simple \\<mu>\"", "lemma weakly_preferred_by_menI:\n  assumes \"\\<And>m w. (m, w) \\<in> \\<mu> \\<Longrightarrow> \\<exists>w'. (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>\"\n  shows \"weakly_preferred_by_men \\<mu> \\<mu>'\"", "lemmas simpleI = iffD2[OF simple_def, unfolded conj_imp_eq_imp_imp, rule_format]", "lemma weakly_Pareto_optimal_for_men_simple:\n  assumes \"weakly_Pareto_optimal_for_men \\<mu>\"\n  shows \"simple \\<mu>\"", "lemma m_weakly_prefers_Pm:\n  assumes \"match \\<mu>\"\n  assumes \"(m, w) \\<in> \\<mu>\"\n  shows \"w' \\<in> m_weakly_prefers m \\<mu> \\<longleftrightarrow> (w, w') \\<in> Pm m\"", "lemma match_Field:\n  assumes \"match \\<mu>\"\n  assumes \"(m, w) \\<in> \\<mu>\"\n  shows \"w \\<in> Field (Pm m)\"\n    and \"m \\<in> Field (Pw w)\"", "lemma weakly_preferred_by_men_refl:\n  assumes \"match \\<mu>\"\n  shows \"weakly_preferred_by_men \\<mu> \\<mu>\"", "lemma weakly_preferred_by_men_strictly_preferred_by_a_man:\n  assumes \"match \\<mu>\"\n  assumes \"match \\<mu>'\"\n  shows \"weakly_preferred_by_men \\<mu> \\<mu>' \\<longleftrightarrow> \\<not>strictly_preferred_by_a_man \\<mu>' \\<mu>\" (is \"?lhs \\<longleftrightarrow> ?rhs\")", "lemma weakly_Pareto_optimal_for_men_def2:\n  \"weakly_Pareto_optimal_for_men \\<mu>\n     \\<longleftrightarrow> simple \\<mu> \\<and> (\\<forall>\\<mu>'. simple \\<mu>' \\<and> strictly_preferred_by_a_man \\<mu> \\<mu>' \\<longrightarrow> strictly_preferred_by_a_man \\<mu>' \\<mu>)\"", "lemma trans_finite_has_maximal_elt:\n  assumes \"trans r\"\n  assumes \"finite (Field r)\"\n  assumes \"Field r \\<noteq> {}\"\n  shows \"\\<exists>x\\<in>Field r. (\\<forall>y\\<in>Field r. (x, y) \\<in> r \\<longrightarrow> (y, x) \\<in> r)\"", "lemma weakly_Pareto_optimal_for_men_ex:\n  \"\\<exists>\\<mu>. weakly_Pareto_optimal_for_men \\<mu>\"", "lemma weakly_Pareto_optimal_for_men_stable:\n  assumes \"weakly_Pareto_optimal_for_men \\<mu>\"\n  shows \"stable \\<mu>\"", "theorem stable_ex:\n  \"\\<exists>\\<mu>. stable \\<mu>\"", "lemma M_UNIV: \"UNIV = set [M1, M2, M3]\"", "lemma W_UNIV: \"UNIV = set [W1, W2, W3]\"", "lemma M_All:\n  shows \"(\\<forall>m. P m) \\<longleftrightarrow> (\\<forall>m\\<in>set [M1, M2, M3]. P m)\"", "lemma W_All:\n  shows \"(\\<forall>w. P w) \\<longleftrightarrow> (\\<forall>w\\<in>set [W1, W2, W3]. P w)\"", "lemma Pm: \"Preorder (Pm m) \\<and> Total (Pm m)\"", "lemma Pw: \"Preorder (Pw w) \\<and> Total (Pw w)\"", "lemma Non_Strict_stable1:\n  shows \"Non_Strict.stable {(M1, W2), (M2, W1), (M3, W3)}\"", "lemma Non_Strict_stable2:\n  shows \"Non_Strict.stable {(M1, W3), (M2, W2), (M3, W1)}\"", "lemma Non_Strict_stable_matches:\n  \"Non_Strict.stable \\<mu>\n     \\<longleftrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)}\n     \\<or> \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\" (is \"?lhs \\<longleftrightarrow> ?rhs\")", "lemma NonStrict_not_optimal:\n  assumes \"Non_Strict.stable \\<mu>\"\n  shows \"\\<not>Non_Strict.optimal_for_men \\<mu> \\<and> \\<not>Non_Strict.optimal_for_women \\<mu>\""], "translations": [["", "lemma stable_match:\n  assumes \"stable \\<mu>\"\n  shows \"match \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. match \\<mu>", "using assms"], ["proof (prove)\nusing this:\n  stable \\<mu>\n\ngoal (1 subgoal):\n 1. match \\<mu>", "unfolding stable_def"], ["proof (prove)\nusing this:\n  match \\<mu> \\<and> (\\<forall>m w. \\<not> blocks m w \\<mu>)\n\ngoal (1 subgoal):\n 1. match \\<mu>", "by blast"], ["", "text\\<open>\n\nOur goal is to show that for every preference order there is a stable\nmatch. Stable matches in this scenario form a lattice, and this proof\nimplicitly adopts the traditional view that men propose and women\nchoose.\n\nThe definitions above form the trust basis for this existence theorem;\nthe following are merely part of the proof apparatus, and Isabelle/HOL\nenforces their soundness with respect to the argument. We will see\nthese concepts again in later developments.\n\nFirstly, a match is @{emph \\<open>simple\\<close>} if every woman party to a blocking\npair is single. The most obvious such match leaves everyone single.\n\n\\<close>"], ["", "definition simple :: \"('m, 'w) match \\<Rightarrow> bool\" where\n  \"simple \\<mu> \\<longleftrightarrow> match \\<mu> \\<and> (\\<forall>m w. blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)\""], ["", "lemma simple_match:\n  assumes \"simple \\<mu>\"\n  shows \"match \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. match \\<mu>", "using assms"], ["proof (prove)\nusing this:\n  simple \\<mu>\n\ngoal (1 subgoal):\n 1. match \\<mu>", "unfolding simple_def"], ["proof (prove)\nusing this:\n  match \\<mu> \\<and>\n  (\\<forall>m w. blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)\n\ngoal (1 subgoal):\n 1. match \\<mu>", "by blast"], ["", "lemma simple_ex:\n  \"\\<exists>\\<mu>. simple \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ex simple", "unfolding simple_def blocks_def match_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<mu>.\n       (inj_on fst \\<mu> \\<and>\n        inj_on snd \\<mu> \\<and>\n        \\<mu>\n        \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n                    (\\<Union>w. Field (Pw w) \\<times> {w})) \\<and>\n       (\\<forall>m w.\n           w \\<in> m_strictly_prefers m \\<mu> \\<and>\n           m \\<in> w_strictly_prefers w \\<mu> \\<longrightarrow>\n           w \\<notin> Range \\<mu>)", "by auto"], ["", "text\\<open>\n\n\\citeauthor{Sotomayor:1996} observes the following:\n\n\\<close>"], ["", "lemma simple_no_single_women_stable:\n  assumes \"simple \\<mu>\"\n  assumes \"\\<forall>w. w \\<in> Range \\<mu>\" \\<comment> \\<open>No woman is single\\<close>\n  shows \"stable \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. stable \\<mu>", "using assms"], ["proof (prove)\nusing this:\n  simple \\<mu>\n  \\<forall>w. w \\<in> Range \\<mu>\n\ngoal (1 subgoal):\n 1. stable \\<mu>", "unfolding simple_def stable_def"], ["proof (prove)\nusing this:\n  match \\<mu> \\<and>\n  (\\<forall>m w. blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)\n  \\<forall>w. w \\<in> Range \\<mu>\n\ngoal (1 subgoal):\n 1. match \\<mu> \\<and> (\\<forall>m w. \\<not> blocks m w \\<mu>)", "by blast"], ["", "lemma stable_simple:\n  assumes \"stable \\<mu>\"\n  shows \"simple \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. simple \\<mu>", "using assms"], ["proof (prove)\nusing this:\n  stable \\<mu>\n\ngoal (1 subgoal):\n 1. simple \\<mu>", "unfolding simple_def stable_def"], ["proof (prove)\nusing this:\n  match \\<mu> \\<and> (\\<forall>m w. \\<not> blocks m w \\<mu>)\n\ngoal (1 subgoal):\n 1. match \\<mu> \\<and>\n    (\\<forall>m w.\n        blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)", "by blast"], ["", "text\\<open>\n\nSecondly, a @{emph \\<open>weakly Pareto optimal match for men (among all\nsimple matches)\\<close>} is one for which there is no other match that all men\nlike as much and some man likes more.\n\n\\<close>"], ["", "definition m_weakly_prefers :: \"'m \\<Rightarrow> ('m, 'w) match \\<Rightarrow> 'w set\" where\n  \"m_weakly_prefers m \\<mu> = {w' \\<in> Field (Pm m). \\<forall>w\\<in>w_for m \\<mu>. (w, w') \\<in> Pm m}\""], ["", "definition weakly_preferred_by_men :: \"('m, 'w) match \\<Rightarrow> ('m, 'w) match \\<Rightarrow> bool\" where\n  \"weakly_preferred_by_men \\<mu> \\<mu>'\n     \\<longleftrightarrow> (\\<forall>m. \\<forall>w\\<in>w_for m \\<mu>. \\<exists>w'\\<in>w_for m \\<mu>'. w' \\<in> m_weakly_prefers m \\<mu>)\""], ["", "definition strictly_preferred_by_a_man  :: \"('m, 'w) match \\<Rightarrow> ('m, 'w) match \\<Rightarrow> bool\" where\n  \"strictly_preferred_by_a_man \\<mu> \\<mu>'\n     \\<longleftrightarrow> (\\<exists>m. \\<exists>w\\<in>w_for m \\<mu>'. w \\<in> m_strictly_prefers m \\<mu>)\""], ["", "definition weakly_Pareto_optimal_for_men :: \"('m, 'w) match \\<Rightarrow> bool\" where\n  \"weakly_Pareto_optimal_for_men \\<mu>\n     \\<longleftrightarrow> simple \\<mu> \\<and> \\<not>(\\<exists>\\<mu>'. simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>' \\<and> strictly_preferred_by_a_man \\<mu> \\<mu>')\""], ["", "text\\<open>\n\nWe will often provide @{emph \\<open>introduction rules\\<close>} for more complex\npredicates, and sometimes derive these by elementary syntactic\nmanipulations expressed by the @{emph \\<open>attributes\\<close>}\nenclosed in square brackets after a use-mention of a lemma. The\n@{command \"lemmas\"} command binds a name to the result. To conform\nwith the Isar structured proof language, we use meta-logic (``Pure''\nin Isabelle terminology) connectives: \\<open>\\<And>\\<close> denotes\nuniversal quantification, and \\<open>\\<Longrightarrow>\\<close>\nimplication.\n\n\\<close>"], ["", "lemma weakly_preferred_by_menI:\n  assumes \"\\<And>m w. (m, w) \\<in> \\<mu> \\<Longrightarrow> \\<exists>w'. (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>\"\n  shows \"weakly_preferred_by_men \\<mu> \\<mu>'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. weakly_preferred_by_men \\<mu> \\<mu>'", "using assms"], ["proof (prove)\nusing this:\n  (?m, ?w) \\<in> \\<mu> \\<Longrightarrow>\n  \\<exists>w'.\n     (?m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers ?m \\<mu>\n\ngoal (1 subgoal):\n 1. weakly_preferred_by_men \\<mu> \\<mu>'", "unfolding weakly_preferred_by_men_def"], ["proof (prove)\nusing this:\n  (?m, ?w) \\<in> \\<mu> \\<Longrightarrow>\n  \\<exists>w'.\n     (?m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers ?m \\<mu>\n\ngoal (1 subgoal):\n 1. \\<forall>m.\n       \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n          \\<exists>w'\\<in>{w. (m, w) \\<in> \\<mu>'}.\n             w' \\<in> m_weakly_prefers m \\<mu>", "by blast"], ["", "lemmas simpleI = iffD2[OF simple_def, unfolded conj_imp_eq_imp_imp, rule_format]"], ["", "lemma weakly_Pareto_optimal_for_men_simple:\n  assumes \"weakly_Pareto_optimal_for_men \\<mu>\"\n  shows \"simple \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. simple \\<mu>", "using assms"], ["proof (prove)\nusing this:\n  weakly_Pareto_optimal_for_men \\<mu>\n\ngoal (1 subgoal):\n 1. simple \\<mu>", "unfolding weakly_Pareto_optimal_for_men_def"], ["proof (prove)\nusing this:\n  simple \\<mu> \\<and>\n  (\\<nexists>\\<mu>'.\n      simple \\<mu>' \\<and>\n      weakly_preferred_by_men \\<mu> \\<mu>' \\<and>\n      strictly_preferred_by_a_man \\<mu> \\<mu>')\n\ngoal (1 subgoal):\n 1. simple \\<mu>", "by simp"], ["", "text\\<open>\n\nLater we will elide obvious technical lemmas like the following. The\nmore obscure proofs are typically generated automatically by\nsledgehammer \\citep{Blanchette:2016}.\n\n\\<close>"], ["", "lemma m_weakly_prefers_Pm:\n  assumes \"match \\<mu>\"\n  assumes \"(m, w) \\<in> \\<mu>\"\n  shows \"w' \\<in> m_weakly_prefers m \\<mu> \\<longleftrightarrow> (w, w') \\<in> Pm m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (w' \\<in> m_weakly_prefers m \\<mu>) = ((w, w') \\<in> Pm m)", "using spec[OF Pm_pref, where x=m] assms"], ["proof (prove)\nusing this:\n  Preorder (Pm m) \\<and> Total (Pm m)\n  match \\<mu>\n  (m, w) \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. (w' \\<in> m_weakly_prefers m \\<mu>) = ((w, w') \\<in> Pm m)", "unfolding m_weakly_prefers_def match_def preorder_on_def"], ["proof (prove)\nusing this:\n  (Refl (Pm m) \\<and> trans (Pm m)) \\<and> Total (Pm m)\n  inj_on fst \\<mu> \\<and>\n  inj_on snd \\<mu> \\<and>\n  \\<mu>\n  \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n              (\\<Union>w. Field (Pw w) \\<times> {w})\n  (m, w) \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. (w' \\<in> {w' \\<in> Field (Pm m).\n               \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                  (w, w') \\<in> Pm m}) =\n    ((w, w') \\<in> Pm m)", "by simp (metis (no_types, hide_lams) FieldI2 fst_conv inj_on_contraD snd_conv)"], ["", "lemma match_Field:\n  assumes \"match \\<mu>\"\n  assumes \"(m, w) \\<in> \\<mu>\"\n  shows \"w \\<in> Field (Pm m)\"\n    and \"m \\<in> Field (Pw w)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w \\<in> Field (Pm m) &&& m \\<in> Field (Pw w)", "using assms"], ["proof (prove)\nusing this:\n  match \\<mu>\n  (m, w) \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. w \\<in> Field (Pm m) &&& m \\<in> Field (Pw w)", "unfolding match_def"], ["proof (prove)\nusing this:\n  inj_on fst \\<mu> \\<and>\n  inj_on snd \\<mu> \\<and>\n  \\<mu>\n  \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n              (\\<Union>w. Field (Pw w) \\<times> {w})\n  (m, w) \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. w \\<in> Field (Pm m) &&& m \\<in> Field (Pw w)", "by blast+"], ["", "lemma weakly_preferred_by_men_refl:\n  assumes \"match \\<mu>\"\n  shows \"weakly_preferred_by_men \\<mu> \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. weakly_preferred_by_men \\<mu> \\<mu>", "using assms"], ["proof (prove)\nusing this:\n  match \\<mu>\n\ngoal (1 subgoal):\n 1. weakly_preferred_by_men \\<mu> \\<mu>", "unfolding weakly_preferred_by_men_def m_weakly_prefers_def"], ["proof (prove)\nusing this:\n  match \\<mu>\n\ngoal (1 subgoal):\n 1. \\<forall>m.\n       \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n          \\<exists>w'\\<in>{w. (m, w) \\<in> \\<mu>}.\n             w' \\<in> {w' \\<in> Field (Pm m).\n                       \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                          (w, w') \\<in> Pm m}", "by clarsimp (meson Pm_pref m_weakly_prefers_Pm match_Field(1) preorder_on_def refl_onD)"], ["", "text\\<open>\n\n\\citeauthor[p137]{Sotomayor:1996} provides an alternative definition\nof @{const \"weakly_preferred_by_men\"}. The syntax @{theory_text \"(is\n?lhs \\<longleftrightarrow> pat)\"} binds the @{emph \\<open>schematic\nvariables\\<close>} \\<open>?lhs\\<close> and \\<open>?rhs\\<close> to the terms\nseparated by \\<open>\\<longleftrightarrow>\\<close>.\n\n\\<close>"], ["", "lemma weakly_preferred_by_men_strictly_preferred_by_a_man:\n  assumes \"match \\<mu>\"\n  assumes \"match \\<mu>'\"\n  shows \"weakly_preferred_by_men \\<mu> \\<mu>' \\<longleftrightarrow> \\<not>strictly_preferred_by_a_man \\<mu>' \\<mu>\" (is \"?lhs \\<longleftrightarrow> ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. weakly_preferred_by_men \\<mu> \\<mu>' =\n    (\\<not> strictly_preferred_by_a_man \\<mu>' \\<mu>)", "proof(rule iffI)"], ["proof (state)\ngoal (2 subgoals):\n 1. weakly_preferred_by_men \\<mu> \\<mu>' \\<Longrightarrow>\n    \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu>\n 2. \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu> \\<Longrightarrow>\n    weakly_preferred_by_men \\<mu> \\<mu>'", "assume ?lhs"], ["proof (state)\nthis:\n  weakly_preferred_by_men \\<mu> \\<mu>'\n\ngoal (2 subgoals):\n 1. weakly_preferred_by_men \\<mu> \\<mu>' \\<Longrightarrow>\n    \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu>\n 2. \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu> \\<Longrightarrow>\n    weakly_preferred_by_men \\<mu> \\<mu>'", "then"], ["proof (chain)\npicking this:\n  weakly_preferred_by_men \\<mu> \\<mu>'", "show ?rhs"], ["proof (prove)\nusing this:\n  weakly_preferred_by_men \\<mu> \\<mu>'\n\ngoal (1 subgoal):\n 1. \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu>", "unfolding weakly_preferred_by_men_def strictly_preferred_by_a_man_def\n              m_weakly_prefers_def m_strictly_prefers_def"], ["proof (prove)\nusing this:\n  \\<forall>m.\n     \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n        \\<exists>w'\\<in>{w. (m, w) \\<in> \\<mu>'}.\n           w' \\<in> {w' \\<in> Field (Pm m).\n                     \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                        (w, w') \\<in> Pm m}\n\ngoal (1 subgoal):\n 1. \\<nexists>m.\n       \\<exists>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n          w \\<in> {w' \\<in> Field (Pm m).\n                   \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>'}.\n                      (w, w') \\<in> Pm m \\<and> (w', w) \\<notin> Pm m}", "by fastforce"], ["proof (state)\nthis:\n  \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu>\n\ngoal (1 subgoal):\n 1. \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu> \\<Longrightarrow>\n    weakly_preferred_by_men \\<mu> \\<mu>'", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu> \\<Longrightarrow>\n    weakly_preferred_by_men \\<mu> \\<mu>'", "assume ?rhs"], ["proof (state)\nthis:\n  \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu>\n\ngoal (1 subgoal):\n 1. \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu> \\<Longrightarrow>\n    weakly_preferred_by_men \\<mu> \\<mu>'", "show ?lhs"], ["proof (prove)\ngoal (1 subgoal):\n 1. weakly_preferred_by_men \\<mu> \\<mu>'", "proof(rule weakly_preferred_by_menI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>m w.\n       (m, w) \\<in> \\<mu> \\<Longrightarrow>\n       \\<exists>w'.\n          (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>", "fix m w"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>m w.\n       (m, w) \\<in> \\<mu> \\<Longrightarrow>\n       \\<exists>w'.\n          (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>", "assume \"(m, w) \\<in> \\<mu>\""], ["proof (state)\nthis:\n  (m, w) \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. \\<And>m w.\n       (m, w) \\<in> \\<mu> \\<Longrightarrow>\n       \\<exists>w'.\n          (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>", "from assms \\<open>?rhs\\<close> \\<open>(m, w) \\<in> \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  match \\<mu>\n  match \\<mu>'\n  \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu>\n  (m, w) \\<in> \\<mu>", "obtain w' where XXX: \"(m, w') \\<in> \\<mu>'\" \"(w', w) \\<in> Pm m \\<longrightarrow> (w, w') \\<in> Pm m\""], ["proof (prove)\nusing this:\n  match \\<mu>\n  match \\<mu>'\n  \\<not> strictly_preferred_by_a_man \\<mu>' \\<mu>\n  (m, w) \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. (\\<And>w'.\n        \\<lbrakk>(m, w') \\<in> \\<mu>';\n         (w', w) \\<in> Pm m \\<longrightarrow> (w, w') \\<in> Pm m\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding match_def strictly_preferred_by_a_man_def m_strictly_prefers_def"], ["proof (prove)\nusing this:\n  inj_on fst \\<mu> \\<and>\n  inj_on snd \\<mu> \\<and>\n  \\<mu>\n  \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n              (\\<Union>w. Field (Pw w) \\<times> {w})\n  inj_on fst \\<mu>' \\<and>\n  inj_on snd \\<mu>' \\<and>\n  \\<mu>'\n  \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n              (\\<Union>w. Field (Pw w) \\<times> {w})\n  \\<nexists>m.\n     \\<exists>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n        w \\<in> {w' \\<in> Field (Pm m).\n                 \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>'}.\n                    (w, w') \\<in> Pm m \\<and> (w', w) \\<notin> Pm m}\n  (m, w) \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. (\\<And>w'.\n        \\<lbrakk>(m, w') \\<in> \\<mu>';\n         (w', w) \\<in> Pm m \\<longrightarrow> (w, w') \\<in> Pm m\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (m, w') \\<in> \\<mu>'\n  (w', w) \\<in> Pm m \\<longrightarrow> (w, w') \\<in> Pm m\n\ngoal (1 subgoal):\n 1. \\<And>m w.\n       (m, w) \\<in> \\<mu> \\<Longrightarrow>\n       \\<exists>w'.\n          (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>", "with spec[OF Pm_pref, where x=m] assms \\<open>(m, w) \\<in> \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  Preorder (Pm m) \\<and> Total (Pm m)\n  match \\<mu>\n  match \\<mu>'\n  (m, w) \\<in> \\<mu>\n  (m, w') \\<in> \\<mu>'\n  (w', w) \\<in> Pm m \\<longrightarrow> (w, w') \\<in> Pm m", "show \"\\<exists>w'. (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>\""], ["proof (prove)\nusing this:\n  Preorder (Pm m) \\<and> Total (Pm m)\n  match \\<mu>\n  match \\<mu>'\n  (m, w) \\<in> \\<mu>\n  (m, w') \\<in> \\<mu>'\n  (w', w) \\<in> Pm m \\<longrightarrow> (w, w') \\<in> Pm m\n\ngoal (1 subgoal):\n 1. \\<exists>w'.\n       (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>", "unfolding preorder_on_def total_on_def"], ["proof (prove)\nusing this:\n  (Refl (Pm m) \\<and> trans (Pm m)) \\<and>\n  (\\<forall>x\\<in>Field (Pm m).\n      \\<forall>y\\<in>Field (Pm m).\n         x \\<noteq> y \\<longrightarrow>\n         (x, y) \\<in> Pm m \\<or> (y, x) \\<in> Pm m)\n  match \\<mu>\n  match \\<mu>'\n  (m, w) \\<in> \\<mu>\n  (m, w') \\<in> \\<mu>'\n  (w', w) \\<in> Pm m \\<longrightarrow> (w, w') \\<in> Pm m\n\ngoal (1 subgoal):\n 1. \\<exists>w'.\n       (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>", "by (metis m_weakly_prefers_Pm match_Field(1) refl_onD)"], ["proof (state)\nthis:\n  \\<exists>w'. (m, w') \\<in> \\<mu>' \\<and> w' \\<in> m_weakly_prefers m \\<mu>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  weakly_preferred_by_men \\<mu> \\<mu>'\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma weakly_Pareto_optimal_for_men_def2:\n  \"weakly_Pareto_optimal_for_men \\<mu>\n     \\<longleftrightarrow> simple \\<mu> \\<and> (\\<forall>\\<mu>'. simple \\<mu>' \\<and> strictly_preferred_by_a_man \\<mu> \\<mu>' \\<longrightarrow> strictly_preferred_by_a_man \\<mu>' \\<mu>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. weakly_Pareto_optimal_for_men \\<mu> =\n    (simple \\<mu> \\<and>\n     (\\<forall>\\<mu>'.\n         simple \\<mu>' \\<and>\n         strictly_preferred_by_a_man \\<mu> \\<mu>' \\<longrightarrow>\n         strictly_preferred_by_a_man \\<mu>' \\<mu>))", "unfolding weakly_Pareto_optimal_for_men_def simple_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((match \\<mu> \\<and>\n      (\\<forall>m w.\n          blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)) \\<and>\n     (\\<nexists>\\<mu>'.\n         (match \\<mu>' \\<and>\n          (\\<forall>m w.\n              blocks m w \\<mu>' \\<longrightarrow>\n              w \\<notin> Range \\<mu>')) \\<and>\n         weakly_preferred_by_men \\<mu> \\<mu>' \\<and>\n         strictly_preferred_by_a_man \\<mu> \\<mu>')) =\n    ((match \\<mu> \\<and>\n      (\\<forall>m w.\n          blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)) \\<and>\n     (\\<forall>\\<mu>'.\n         (match \\<mu>' \\<and>\n          (\\<forall>m w.\n              blocks m w \\<mu>' \\<longrightarrow>\n              w \\<notin> Range \\<mu>')) \\<and>\n         strictly_preferred_by_a_man \\<mu> \\<mu>' \\<longrightarrow>\n         strictly_preferred_by_a_man \\<mu>' \\<mu>))", "by (meson weakly_preferred_by_men_strictly_preferred_by_a_man)"], ["", "text\\<open>\n\n\\citeauthor{Sotomayor:1996} claims that the existence of such a weakly\nPareto optimal match for men is ``guaranteed by the fact that\n@{emph \\<open>the set of simple matchings is nonempty\\<close>} [our @{thm [source]\n\"simple_ex\"} lemma] @{emph \\<open>and finite and the preferences are\ntransitive.\\<close>}'' The following lemmas express this intuition:\n\n\\<close>"], ["", "lemma trans_finite_has_maximal_elt:\n  assumes \"trans r\"\n  assumes \"finite (Field r)\"\n  assumes \"Field r \\<noteq> {}\"\n  shows \"\\<exists>x\\<in>Field r. (\\<forall>y\\<in>Field r. (x, y) \\<in> r \\<longrightarrow> (y, x) \\<in> r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>Field r.\n       \\<forall>y\\<in>Field r.\n          (x, y) \\<in> r \\<longrightarrow> (y, x) \\<in> r", "using assms(2,1,3)"], ["proof (prove)\nusing this:\n  finite (Field r)\n  trans r\n  Field r \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>Field r.\n       \\<forall>y\\<in>Field r.\n          (x, y) \\<in> r \\<longrightarrow> (y, x) \\<in> r", "by induct (auto elim: transE)"], ["", "lemma weakly_Pareto_optimal_for_men_ex:\n  \"\\<exists>\\<mu>. weakly_Pareto_optimal_for_men \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ex weakly_Pareto_optimal_for_men", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. Ex weakly_Pareto_optimal_for_men", "let ?r = \"{(\\<mu>, \\<mu>'). simple \\<mu> \\<and> simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\""], ["proof (state)\ngoal (1 subgoal):\n 1. Ex weakly_Pareto_optimal_for_men", "from trans_finite_has_maximal_elt[where r=\"?r\"]"], ["proof (chain)\npicking this:\n  \\<lbrakk>trans\n            {(\\<mu>, \\<mu>').\n             simple \\<mu> \\<and>\n             simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'};\n   finite\n    (Field\n      {(\\<mu>, \\<mu>').\n       simple \\<mu> \\<and>\n       simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'});\n   Field\n    {(\\<mu>, \\<mu>').\n     simple \\<mu> \\<and>\n     simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'} \\<noteq>\n   {}\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>Field\n                                    {(\\<mu>, \\<mu>').\n                                     simple \\<mu> \\<and>\n                                     simple \\<mu>' \\<and>\n                                     weakly_preferred_by_men \\<mu> \\<mu>'}.\n                       \\<forall>y\\<in>Field\n {(\\<mu>, \\<mu>').\n  simple \\<mu> \\<and>\n  simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}.\n                          (x, y)\n                          \\<in> {(\\<mu>, \\<mu>').\n                                 simple \\<mu> \\<and>\n                                 simple \\<mu>' \\<and>\n                                 weakly_preferred_by_men \\<mu>\n                                  \\<mu>'} \\<longrightarrow>\n                          (y, x)\n                          \\<in> {(\\<mu>, \\<mu>').\n                                 simple \\<mu> \\<and>\n                                 simple \\<mu>' \\<and>\n                                 weakly_preferred_by_men \\<mu> \\<mu>'}", "obtain x where \"x \\<in> Field ?r\" \"\\<forall>y\\<in>Field ?r. (x, y) \\<in> ?r \\<longrightarrow> (y, x) \\<in> ?r\""], ["proof (prove)\nusing this:\n  \\<lbrakk>trans\n            {(\\<mu>, \\<mu>').\n             simple \\<mu> \\<and>\n             simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'};\n   finite\n    (Field\n      {(\\<mu>, \\<mu>').\n       simple \\<mu> \\<and>\n       simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'});\n   Field\n    {(\\<mu>, \\<mu>').\n     simple \\<mu> \\<and>\n     simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'} \\<noteq>\n   {}\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>Field\n                                    {(\\<mu>, \\<mu>').\n                                     simple \\<mu> \\<and>\n                                     simple \\<mu>' \\<and>\n                                     weakly_preferred_by_men \\<mu> \\<mu>'}.\n                       \\<forall>y\\<in>Field\n {(\\<mu>, \\<mu>').\n  simple \\<mu> \\<and>\n  simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}.\n                          (x, y)\n                          \\<in> {(\\<mu>, \\<mu>').\n                                 simple \\<mu> \\<and>\n                                 simple \\<mu>' \\<and>\n                                 weakly_preferred_by_men \\<mu>\n                                  \\<mu>'} \\<longrightarrow>\n                          (y, x)\n                          \\<in> {(\\<mu>, \\<mu>').\n                                 simple \\<mu> \\<and>\n                                 simple \\<mu>' \\<and>\n                                 weakly_preferred_by_men \\<mu> \\<mu>'}\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> Field\n                          {(\\<mu>, \\<mu>').\n                           simple \\<mu> \\<and>\n                           simple \\<mu>' \\<and>\n                           weakly_preferred_by_men \\<mu> \\<mu>'};\n         \\<forall>y\\<in>Field\n                         {(\\<mu>, \\<mu>').\n                          simple \\<mu> \\<and>\n                          simple \\<mu>' \\<and>\n                          weakly_preferred_by_men \\<mu> \\<mu>'}.\n            (x, y)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n            (y, x)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof"], ["proof (state)\ngoal (4 subgoals):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> Field\n                          {(\\<mu>, \\<mu>').\n                           simple \\<mu> \\<and>\n                           simple \\<mu>' \\<and>\n                           weakly_preferred_by_men \\<mu> \\<mu>'};\n         \\<forall>y\\<in>Field\n                         {(\\<mu>, \\<mu>').\n                          simple \\<mu> \\<and>\n                          simple \\<mu>' \\<and>\n                          weakly_preferred_by_men \\<mu> \\<mu>'}.\n            (x, y)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n            (y, x)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    trans\n     {(\\<mu>, \\<mu>').\n      simple \\<mu> \\<and>\n      simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n 2. (\\<And>x.\n        \\<lbrakk>x \\<in> Field\n                          {(\\<mu>, \\<mu>').\n                           simple \\<mu> \\<and>\n                           simple \\<mu>' \\<and>\n                           weakly_preferred_by_men \\<mu> \\<mu>'};\n         \\<forall>y\\<in>Field\n                         {(\\<mu>, \\<mu>').\n                          simple \\<mu> \\<and>\n                          simple \\<mu>' \\<and>\n                          weakly_preferred_by_men \\<mu> \\<mu>'}.\n            (x, y)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n            (y, x)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    finite\n     (Field\n       {(\\<mu>, \\<mu>').\n        simple \\<mu> \\<and>\n        simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'})\n 3. (\\<And>x.\n        \\<lbrakk>x \\<in> Field\n                          {(\\<mu>, \\<mu>').\n                           simple \\<mu> \\<and>\n                           simple \\<mu>' \\<and>\n                           weakly_preferred_by_men \\<mu> \\<mu>'};\n         \\<forall>y\\<in>Field\n                         {(\\<mu>, \\<mu>').\n                          simple \\<mu> \\<and>\n                          simple \\<mu>' \\<and>\n                          weakly_preferred_by_men \\<mu> \\<mu>'}.\n            (x, y)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n            (y, x)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    Field\n     {(\\<mu>, \\<mu>').\n      simple \\<mu> \\<and>\n      simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'} \\<noteq>\n    {}\n 4. \\<And>x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>x \\<in> Field\n                                     {(\\<mu>, \\<mu>').\nsimple \\<mu> \\<and>\nsimple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'};\n                    \\<forall>y\\<in>Field\n                                    {(\\<mu>, \\<mu>').\n                                     simple \\<mu> \\<and>\n                                     simple \\<mu>' \\<and>\n                                     weakly_preferred_by_men \\<mu> \\<mu>'}.\n                       (x, y)\n                       \\<in> {(\\<mu>, \\<mu>').\n                              simple \\<mu> \\<and>\n                              simple \\<mu>' \\<and>\n                              weakly_preferred_by_men \\<mu>\n                               \\<mu>'} \\<longrightarrow>\n                       (y, x)\n                       \\<in> {(\\<mu>, \\<mu>').\n                              simple \\<mu> \\<and>\n                              simple \\<mu>' \\<and>\n                              weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n                   \\<Longrightarrow> thesis;\n        x \\<in> Field\n                 {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'};\n        \\<forall>y\\<in>Field\n                        {(\\<mu>, \\<mu>').\n                         simple \\<mu> \\<and>\n                         simple \\<mu>' \\<and>\n                         weakly_preferred_by_men \\<mu> \\<mu>'}.\n           (x, y)\n           \\<in> {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n           (y, x)\n           \\<in> {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n       \\<Longrightarrow> thesis", "from Pm_pref"], ["proof (chain)\npicking this:\n  \\<forall>m. Preorder (Pm m) \\<and> Total (Pm m)", "show \"trans ?r\""], ["proof (prove)\nusing this:\n  \\<forall>m. Preorder (Pm m) \\<and> Total (Pm m)\n\ngoal (1 subgoal):\n 1. trans\n     {(\\<mu>, \\<mu>').\n      simple \\<mu> \\<and>\n      simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}", "unfolding trans_def weakly_preferred_by_men_def m_weakly_prefers_def m_strictly_prefers_def"], ["proof (prove)\nusing this:\n  \\<forall>m. Preorder (Pm m) \\<and> Total (Pm m)\n\ngoal (1 subgoal):\n 1. \\<forall>x y z.\n       (x, y)\n       \\<in> {(\\<mu>, \\<mu>').\n              simple \\<mu> \\<and>\n              simple \\<mu>' \\<and>\n              (\\<forall>m.\n                  \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                     \\<exists>w'\\<in>{w. (m, w) \\<in> \\<mu>'}.\n                        w' \\<in> {w' \\<in> Field (Pm m).\n                                  \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                                     (w, w') \\<in> Pm m})} \\<longrightarrow>\n       (y, z)\n       \\<in> {(\\<mu>, \\<mu>').\n              simple \\<mu> \\<and>\n              simple \\<mu>' \\<and>\n              (\\<forall>m.\n                  \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                     \\<exists>w'\\<in>{w. (m, w) \\<in> \\<mu>'}.\n                        w' \\<in> {w' \\<in> Field (Pm m).\n                                  \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                                     (w, w') \\<in> Pm m})} \\<longrightarrow>\n       (x, z)\n       \\<in> {(\\<mu>, \\<mu>').\n              simple \\<mu> \\<and>\n              simple \\<mu>' \\<and>\n              (\\<forall>m.\n                  \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                     \\<exists>w'\\<in>{w. (m, w) \\<in> \\<mu>'}.\n                        w' \\<in> {w' \\<in> Field (Pm m).\n                                  \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                                     (w, w') \\<in> Pm m})}", "by simp (meson order_on_defs(1) transE)"], ["proof (state)\nthis:\n  trans\n   {(\\<mu>, \\<mu>').\n    simple \\<mu> \\<and>\n    simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n\ngoal (3 subgoals):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> Field\n                          {(\\<mu>, \\<mu>').\n                           simple \\<mu> \\<and>\n                           simple \\<mu>' \\<and>\n                           weakly_preferred_by_men \\<mu> \\<mu>'};\n         \\<forall>y\\<in>Field\n                         {(\\<mu>, \\<mu>').\n                          simple \\<mu> \\<and>\n                          simple \\<mu>' \\<and>\n                          weakly_preferred_by_men \\<mu> \\<mu>'}.\n            (x, y)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n            (y, x)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    finite\n     (Field\n       {(\\<mu>, \\<mu>').\n        simple \\<mu> \\<and>\n        simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'})\n 2. (\\<And>x.\n        \\<lbrakk>x \\<in> Field\n                          {(\\<mu>, \\<mu>').\n                           simple \\<mu> \\<and>\n                           simple \\<mu>' \\<and>\n                           weakly_preferred_by_men \\<mu> \\<mu>'};\n         \\<forall>y\\<in>Field\n                         {(\\<mu>, \\<mu>').\n                          simple \\<mu> \\<and>\n                          simple \\<mu>' \\<and>\n                          weakly_preferred_by_men \\<mu> \\<mu>'}.\n            (x, y)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n            (y, x)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    Field\n     {(\\<mu>, \\<mu>').\n      simple \\<mu> \\<and>\n      simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'} \\<noteq>\n    {}\n 3. \\<And>x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>x \\<in> Field\n                                     {(\\<mu>, \\<mu>').\nsimple \\<mu> \\<and>\nsimple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'};\n                    \\<forall>y\\<in>Field\n                                    {(\\<mu>, \\<mu>').\n                                     simple \\<mu> \\<and>\n                                     simple \\<mu>' \\<and>\n                                     weakly_preferred_by_men \\<mu> \\<mu>'}.\n                       (x, y)\n                       \\<in> {(\\<mu>, \\<mu>').\n                              simple \\<mu> \\<and>\n                              simple \\<mu>' \\<and>\n                              weakly_preferred_by_men \\<mu>\n                               \\<mu>'} \\<longrightarrow>\n                       (y, x)\n                       \\<in> {(\\<mu>, \\<mu>').\n                              simple \\<mu> \\<and>\n                              simple \\<mu>' \\<and>\n                              weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n                   \\<Longrightarrow> thesis;\n        x \\<in> Field\n                 {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'};\n        \\<forall>y\\<in>Field\n                        {(\\<mu>, \\<mu>').\n                         simple \\<mu> \\<and>\n                         simple \\<mu>' \\<and>\n                         weakly_preferred_by_men \\<mu> \\<mu>'}.\n           (x, y)\n           \\<in> {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n           (y, x)\n           \\<in> {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n       \\<Longrightarrow> thesis", "from simple_ex weakly_preferred_by_men_refl[OF simple_match]"], ["proof (chain)\npicking this:\n  Ex simple\n  simple ?\\<mu> \\<Longrightarrow> weakly_preferred_by_men ?\\<mu> ?\\<mu>", "show \"Field ?r \\<noteq> {}\""], ["proof (prove)\nusing this:\n  Ex simple\n  simple ?\\<mu> \\<Longrightarrow> weakly_preferred_by_men ?\\<mu> ?\\<mu>\n\ngoal (1 subgoal):\n 1. Field\n     {(\\<mu>, \\<mu>').\n      simple \\<mu> \\<and>\n      simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'} \\<noteq>\n    {}", "unfolding Field_def"], ["proof (prove)\nusing this:\n  Ex simple\n  simple ?\\<mu> \\<Longrightarrow> weakly_preferred_by_men ?\\<mu> ?\\<mu>\n\ngoal (1 subgoal):\n 1. Domain\n     {(\\<mu>, \\<mu>').\n      simple \\<mu> \\<and>\n      simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'} \\<union>\n    Range\n     {(\\<mu>, \\<mu>').\n      simple \\<mu> \\<and>\n      simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'} \\<noteq>\n    {}", "by force"], ["proof (state)\nthis:\n  Field\n   {(\\<mu>, \\<mu>').\n    simple \\<mu> \\<and>\n    simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'} \\<noteq>\n  {}\n\ngoal (2 subgoals):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> Field\n                          {(\\<mu>, \\<mu>').\n                           simple \\<mu> \\<and>\n                           simple \\<mu>' \\<and>\n                           weakly_preferred_by_men \\<mu> \\<mu>'};\n         \\<forall>y\\<in>Field\n                         {(\\<mu>, \\<mu>').\n                          simple \\<mu> \\<and>\n                          simple \\<mu>' \\<and>\n                          weakly_preferred_by_men \\<mu> \\<mu>'}.\n            (x, y)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n            (y, x)\n            \\<in> {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    finite\n     (Field\n       {(\\<mu>, \\<mu>').\n        simple \\<mu> \\<and>\n        simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'})\n 2. \\<And>x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>x \\<in> Field\n                                     {(\\<mu>, \\<mu>').\nsimple \\<mu> \\<and>\nsimple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'};\n                    \\<forall>y\\<in>Field\n                                    {(\\<mu>, \\<mu>').\n                                     simple \\<mu> \\<and>\n                                     simple \\<mu>' \\<and>\n                                     weakly_preferred_by_men \\<mu> \\<mu>'}.\n                       (x, y)\n                       \\<in> {(\\<mu>, \\<mu>').\n                              simple \\<mu> \\<and>\n                              simple \\<mu>' \\<and>\n                              weakly_preferred_by_men \\<mu>\n                               \\<mu>'} \\<longrightarrow>\n                       (y, x)\n                       \\<in> {(\\<mu>, \\<mu>').\n                              simple \\<mu> \\<and>\n                              simple \\<mu>' \\<and>\n                              weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n                   \\<Longrightarrow> thesis;\n        x \\<in> Field\n                 {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'};\n        \\<forall>y\\<in>Field\n                        {(\\<mu>, \\<mu>').\n                         simple \\<mu> \\<and>\n                         simple \\<mu>' \\<and>\n                         weakly_preferred_by_men \\<mu> \\<mu>'}.\n           (x, y)\n           \\<in> {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n           (y, x)\n           \\<in> {(\\<mu>, \\<mu>').\n                  simple \\<mu> \\<and>\n                  simple \\<mu>' \\<and>\n                  weakly_preferred_by_men \\<mu> \\<mu>'}\\<rbrakk>\n       \\<Longrightarrow> thesis", "qed simp_all"], ["proof (state)\nthis:\n  x \\<in> Field\n           {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n  \\<forall>y\\<in>Field\n                  {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}.\n     (x, y)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and>\n            weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n     (y, x)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n\ngoal (1 subgoal):\n 1. Ex weakly_Pareto_optimal_for_men", "then"], ["proof (chain)\npicking this:\n  x \\<in> Field\n           {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n  \\<forall>y\\<in>Field\n                  {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}.\n     (x, y)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and>\n            weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n     (y, x)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<in> Field\n           {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n  \\<forall>y\\<in>Field\n                  {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}.\n     (x, y)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and>\n            weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n     (y, x)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n\ngoal (1 subgoal):\n 1. Ex weakly_Pareto_optimal_for_men", "unfolding weakly_Pareto_optimal_for_men_def Field_def"], ["proof (prove)\nusing this:\n  x \\<in> Domain\n           {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and>\n            weakly_preferred_by_men \\<mu> \\<mu>'} \\<union>\n          Range\n           {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n  \\<forall>y\\<in>Domain\n                  {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<union>\n                 Range\n                  {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}.\n     (x, y)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and>\n            weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n     (y, x)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n\ngoal (1 subgoal):\n 1. \\<exists>\\<mu>.\n       simple \\<mu> \\<and>\n       (\\<nexists>\\<mu>'.\n           simple \\<mu>' \\<and>\n           weakly_preferred_by_men \\<mu> \\<mu>' \\<and>\n           strictly_preferred_by_a_man \\<mu> \\<mu>')", "using simple_match weakly_preferred_by_men_strictly_preferred_by_a_man"], ["proof (prove)\nusing this:\n  x \\<in> Domain\n           {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and>\n            weakly_preferred_by_men \\<mu> \\<mu>'} \\<union>\n          Range\n           {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n  \\<forall>y\\<in>Domain\n                  {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'} \\<union>\n                 Range\n                  {(\\<mu>, \\<mu>').\n                   simple \\<mu> \\<and>\n                   simple \\<mu>' \\<and>\n                   weakly_preferred_by_men \\<mu> \\<mu>'}.\n     (x, y)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and>\n            weakly_preferred_by_men \\<mu> \\<mu>'} \\<longrightarrow>\n     (y, x)\n     \\<in> {(\\<mu>, \\<mu>').\n            simple \\<mu> \\<and>\n            simple \\<mu>' \\<and> weakly_preferred_by_men \\<mu> \\<mu>'}\n  simple ?\\<mu> \\<Longrightarrow> match ?\\<mu>\n  \\<lbrakk>match ?\\<mu>; match ?\\<mu>'\\<rbrakk>\n  \\<Longrightarrow> weakly_preferred_by_men ?\\<mu> ?\\<mu>' =\n                    (\\<not> strictly_preferred_by_a_man ?\\<mu>' ?\\<mu>)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<mu>.\n       simple \\<mu> \\<and>\n       (\\<nexists>\\<mu>'.\n           simple \\<mu>' \\<and>\n           weakly_preferred_by_men \\<mu> \\<mu>' \\<and>\n           strictly_preferred_by_a_man \\<mu> \\<mu>')", "by auto"], ["proof (state)\nthis:\n  Ex weakly_Pareto_optimal_for_men\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>\n\nThe main result proceeds by contradiction.\n\n\\<close>"], ["", "lemma weakly_Pareto_optimal_for_men_stable:\n  assumes \"weakly_Pareto_optimal_for_men \\<mu>\"\n  shows \"stable \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. stable \\<mu>", "proof(rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "assume \"\\<not>stable \\<mu>\""], ["proof (state)\nthis:\n  \\<not> stable \\<mu>\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "from \\<open>weakly_Pareto_optimal_for_men \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  weakly_Pareto_optimal_for_men \\<mu>", "have \"simple \\<mu>\""], ["proof (prove)\nusing this:\n  weakly_Pareto_optimal_for_men \\<mu>\n\ngoal (1 subgoal):\n 1. simple \\<mu>", "by (rule weakly_Pareto_optimal_for_men_simple)"], ["proof (state)\nthis:\n  simple \\<mu>\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "from \\<open>\\<not>stable \\<mu>\\<close> \\<open>simple \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  \\<not> stable \\<mu>\n  simple \\<mu>", "obtain m' w where \"blocks m' w \\<mu>\" and \"w \\<notin> Range \\<mu>\""], ["proof (prove)\nusing this:\n  \\<not> stable \\<mu>\n  simple \\<mu>\n\ngoal (1 subgoal):\n 1. (\\<And>m' w.\n        \\<lbrakk>blocks m' w \\<mu>; w \\<notin> Range \\<mu>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding simple_def stable_def"], ["proof (prove)\nusing this:\n  \\<not> (match \\<mu> \\<and> (\\<forall>m w. \\<not> blocks m w \\<mu>))\n  match \\<mu> \\<and>\n  (\\<forall>m w. blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)\n\ngoal (1 subgoal):\n 1. (\\<And>m' w.\n        \\<lbrakk>blocks m' w \\<mu>; w \\<notin> Range \\<mu>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast+\n  \\<comment> \\<open>Choose an \\<open>m\\<close> that \\<open>w\\<close> weakly prefers to any blocking man.\\<close>\n  \\<comment> \\<open>We restrict the preference order \\<open>Pw w\\<close> to the men who strictly prefer \\<open>w\\<close> over their match in \\<open>\\<mu>\\<close>.\\<close>"], ["proof (state)\nthis:\n  blocks m' w \\<mu>\n  w \\<notin> Range \\<mu>\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "let ?r = \"Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "from trans_finite_has_maximal_elt[where r=\"?r\"]"], ["proof (chain)\npicking this:\n  \\<lbrakk>trans (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>});\n   finite (Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}));\n   Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<noteq>\n   {}\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>Field\n                                    (Restr (Pw w)\n{m. w \\<in> m_strictly_prefers m \\<mu>}).\n                       \\<forall>y\\<in>Field\n (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}).\n                          (x, y)\n                          \\<in> Restr (Pw w)\n                                 {m. w \\<in> m_strictly_prefers m\n        \\<mu>} \\<longrightarrow>\n                          (y, x)\n                          \\<in> Restr (Pw w)\n                                 {m. w \\<in> m_strictly_prefers m \\<mu>}", "obtain m where \"m \\<in> Field ?r\" \"\\<forall>m'\\<in>Field ?r. (m, m') \\<in> ?r \\<longrightarrow> (m', m) \\<in> ?r\""], ["proof (prove)\nusing this:\n  \\<lbrakk>trans (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>});\n   finite (Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}));\n   Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<noteq>\n   {}\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>Field\n                                    (Restr (Pw w)\n{m. w \\<in> m_strictly_prefers m \\<mu>}).\n                       \\<forall>y\\<in>Field\n (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}).\n                          (x, y)\n                          \\<in> Restr (Pw w)\n                                 {m. w \\<in> m_strictly_prefers m\n        \\<mu>} \\<longrightarrow>\n                          (y, x)\n                          \\<in> Restr (Pw w)\n                                 {m. w \\<in> m_strictly_prefers m \\<mu>}\n\ngoal (1 subgoal):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof"], ["proof (state)\ngoal (4 subgoals):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    trans (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>})\n 2. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    finite (Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}))\n 3. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<noteq> {}\n 4. \\<And>x.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>m \\<in> Field\n                                     (Restr (Pw w)\n {m. w \\<in> m_strictly_prefers m \\<mu>});\n                    \\<forall>m'\\<in>Field\n                                     (Restr (Pw w)\n {m. w \\<in> m_strictly_prefers m \\<mu>}).\n                       (m, m')\n                       \\<in> Restr (Pw w)\n                              {m. w \\<in> m_strictly_prefers m\n     \\<mu>} \\<longrightarrow>\n                       (m', m)\n                       \\<in> Restr (Pw w)\n                              {m. w \\<in> m_strictly_prefers m\n     \\<mu>}\\<rbrakk>\n                   \\<Longrightarrow> thesis;\n        x \\<in> Field\n                 (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>});\n        \\<forall>y\\<in>Field\n                        (Restr (Pw w)\n                          {m. w \\<in> m_strictly_prefers m \\<mu>}).\n           (x, y)\n           \\<in> Restr (Pw w)\n                  {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n           (y, x)\n           \\<in> Restr (Pw w)\n                  {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n       \\<Longrightarrow> thesis", "from Pw_pref"], ["proof (chain)\npicking this:\n  \\<forall>w. Preorder (Pw w) \\<and> Total (Pw w)", "show \"trans ?r\""], ["proof (prove)\nusing this:\n  \\<forall>w. Preorder (Pw w) \\<and> Total (Pw w)\n\ngoal (1 subgoal):\n 1. trans (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>})", "unfolding preorder_on_def"], ["proof (prove)\nusing this:\n  \\<forall>w. (Refl (Pw w) \\<and> trans (Pw w)) \\<and> Total (Pw w)\n\ngoal (1 subgoal):\n 1. trans (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>})", "by (blast intro: trans_Restr)"], ["proof (state)\nthis:\n  trans (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>})\n\ngoal (3 subgoals):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    finite (Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}))\n 2. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<noteq> {}\n 3. \\<And>x.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>m \\<in> Field\n                                     (Restr (Pw w)\n {m. w \\<in> m_strictly_prefers m \\<mu>});\n                    \\<forall>m'\\<in>Field\n                                     (Restr (Pw w)\n {m. w \\<in> m_strictly_prefers m \\<mu>}).\n                       (m, m')\n                       \\<in> Restr (Pw w)\n                              {m. w \\<in> m_strictly_prefers m\n     \\<mu>} \\<longrightarrow>\n                       (m', m)\n                       \\<in> Restr (Pw w)\n                              {m. w \\<in> m_strictly_prefers m\n     \\<mu>}\\<rbrakk>\n                   \\<Longrightarrow> thesis;\n        x \\<in> Field\n                 (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>});\n        \\<forall>y\\<in>Field\n                        (Restr (Pw w)\n                          {m. w \\<in> m_strictly_prefers m \\<mu>}).\n           (x, y)\n           \\<in> Restr (Pw w)\n                  {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n           (y, x)\n           \\<in> Restr (Pw w)\n                  {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n       \\<Longrightarrow> thesis", "from Pw_pref \\<open>blocks m' w \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  \\<forall>w. Preorder (Pw w) \\<and> Total (Pw w)\n  blocks m' w \\<mu>", "have \"(m', m') \\<in> ?r\""], ["proof (prove)\nusing this:\n  \\<forall>w. Preorder (Pw w) \\<and> Total (Pw w)\n  blocks m' w \\<mu>\n\ngoal (1 subgoal):\n 1. (m', m') \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}", "unfolding blocks_def w_strictly_prefers_def preorder_on_def"], ["proof (prove)\nusing this:\n  \\<forall>w. (Refl (Pw w) \\<and> trans (Pw w)) \\<and> Total (Pw w)\n  w \\<in> m_strictly_prefers m' \\<mu> \\<and>\n  m' \\<in> {m' \\<in> Field (Pw w).\n            \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n               (m, m') \\<in> Pw w \\<and> (m', m) \\<notin> Pw w}\n\ngoal (1 subgoal):\n 1. (m', m') \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}", "by (blast dest: refl_onD)"], ["proof (state)\nthis:\n  (m', m') \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}\n\ngoal (3 subgoals):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    finite (Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}))\n 2. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<noteq> {}\n 3. \\<And>x.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>m \\<in> Field\n                                     (Restr (Pw w)\n {m. w \\<in> m_strictly_prefers m \\<mu>});\n                    \\<forall>m'\\<in>Field\n                                     (Restr (Pw w)\n {m. w \\<in> m_strictly_prefers m \\<mu>}).\n                       (m, m')\n                       \\<in> Restr (Pw w)\n                              {m. w \\<in> m_strictly_prefers m\n     \\<mu>} \\<longrightarrow>\n                       (m', m)\n                       \\<in> Restr (Pw w)\n                              {m. w \\<in> m_strictly_prefers m\n     \\<mu>}\\<rbrakk>\n                   \\<Longrightarrow> thesis;\n        x \\<in> Field\n                 (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>});\n        \\<forall>y\\<in>Field\n                        (Restr (Pw w)\n                          {m. w \\<in> m_strictly_prefers m \\<mu>}).\n           (x, y)\n           \\<in> Restr (Pw w)\n                  {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n           (y, x)\n           \\<in> Restr (Pw w)\n                  {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n       \\<Longrightarrow> thesis", "then"], ["proof (chain)\npicking this:\n  (m', m') \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}", "show \"Field ?r \\<noteq> {}\""], ["proof (prove)\nusing this:\n  (m', m') \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}\n\ngoal (1 subgoal):\n 1. Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<noteq> {}", "by (metis FieldI2 empty_iff)"], ["proof (state)\nthis:\n  Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<noteq> {}\n\ngoal (2 subgoals):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>});\n         \\<forall>m'\\<in>Field\n                          (Restr (Pw w)\n                            {m. w \\<in> m_strictly_prefers m \\<mu>}).\n            (m, m')\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n            (m', m)\n            \\<in> Restr (Pw w)\n                   {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    finite (Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}))\n 2. \\<And>x.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>m \\<in> Field\n                                     (Restr (Pw w)\n {m. w \\<in> m_strictly_prefers m \\<mu>});\n                    \\<forall>m'\\<in>Field\n                                     (Restr (Pw w)\n {m. w \\<in> m_strictly_prefers m \\<mu>}).\n                       (m, m')\n                       \\<in> Restr (Pw w)\n                              {m. w \\<in> m_strictly_prefers m\n     \\<mu>} \\<longrightarrow>\n                       (m', m)\n                       \\<in> Restr (Pw w)\n                              {m. w \\<in> m_strictly_prefers m\n     \\<mu>}\\<rbrakk>\n                   \\<Longrightarrow> thesis;\n        x \\<in> Field\n                 (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>});\n        \\<forall>y\\<in>Field\n                        (Restr (Pw w)\n                          {m. w \\<in> m_strictly_prefers m \\<mu>}).\n           (x, y)\n           \\<in> Restr (Pw w)\n                  {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n           (y, x)\n           \\<in> Restr (Pw w)\n                  {m. w \\<in> m_strictly_prefers m \\<mu>}\\<rbrakk>\n       \\<Longrightarrow> thesis", "qed simp_all"], ["proof (state)\nthis:\n  m \\<in> Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>})\n  \\<forall>m'\\<in>Field\n                   (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}).\n     (m, m')\n     \\<in> Restr (Pw w)\n            {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n     (m', m) \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "with \\<open>blocks m' w \\<mu>\\<close> \\<open>w \\<notin> Range \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  blocks m' w \\<mu>\n  w \\<notin> Range \\<mu>\n  m \\<in> Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>})\n  \\<forall>m'\\<in>Field\n                   (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}).\n     (m, m')\n     \\<in> Restr (Pw w)\n            {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n     (m', m) \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}", "have \"blocks m w \\<mu>\" and \"\\<forall>m'. blocks m' w \\<mu> \\<and> (m, m') \\<in> Pw w \\<longrightarrow> (m', m) \\<in> Pw w\""], ["proof (prove)\nusing this:\n  blocks m' w \\<mu>\n  w \\<notin> Range \\<mu>\n  m \\<in> Field (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>})\n  \\<forall>m'\\<in>Field\n                   (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}).\n     (m, m')\n     \\<in> Restr (Pw w)\n            {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n     (m', m) \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}\n\ngoal (1 subgoal):\n 1. blocks m w \\<mu> &&&\n    \\<forall>m'.\n       blocks m' w \\<mu> \\<and> (m, m') \\<in> Pw w \\<longrightarrow>\n       (m', m) \\<in> Pw w", "unfolding blocks_def w_strictly_prefers_def Field_def"], ["proof (prove)\nusing this:\n  w \\<in> m_strictly_prefers m' \\<mu> \\<and>\n  m' \\<in> {m' \\<in> Domain (Pw w) \\<union> Range (Pw w).\n            \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n               (m, m') \\<in> Pw w \\<and> (m', m) \\<notin> Pw w}\n  w \\<notin> Range \\<mu>\n  m \\<in> Domain\n           (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<union>\n          Range (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>})\n  \\<forall>m'\\<in>Domain\n                   (Restr (Pw w)\n                     {m. w \\<in> m_strictly_prefers m \\<mu>}) \\<union>\n                  Range\n                   (Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}).\n     (m, m')\n     \\<in> Restr (Pw w)\n            {m. w \\<in> m_strictly_prefers m \\<mu>} \\<longrightarrow>\n     (m', m) \\<in> Restr (Pw w) {m. w \\<in> m_strictly_prefers m \\<mu>}\n\ngoal (1 subgoal):\n 1. w \\<in> m_strictly_prefers m \\<mu> \\<and>\n    m \\<in> {m' \\<in> Domain (Pw w) \\<union> Range (Pw w).\n             \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n                (m, m') \\<in> Pw w \\<and> (m', m) \\<notin> Pw w} &&&\n    \\<forall>m'.\n       (w \\<in> m_strictly_prefers m' \\<mu> \\<and>\n        m' \\<in> {m' \\<in> Domain (Pw w) \\<union> Range (Pw w).\n                  \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n                     (m, m') \\<in> Pw w \\<and>\n                     (m', m) \\<notin> Pw w}) \\<and>\n       (m, m') \\<in> Pw w \\<longrightarrow>\n       (m', m) \\<in> Pw w", "by auto\n  \\<comment> \\<open>Construct a new (simple) match containing the blocking pair\\ldots\\<close>"], ["proof (state)\nthis:\n  blocks m w \\<mu>\n  \\<forall>m'.\n     blocks m' w \\<mu> \\<and> (m, m') \\<in> Pw w \\<longrightarrow>\n     (m', m) \\<in> Pw w\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "let ?\\<mu>' = \"\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}\"\n  \\<comment> \\<open>{\\ldots}and show that it is a Pareto improvement for men over \\<open>\\<mu>\\<close>.\\<close>"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "have \"simple ?\\<mu>'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. simple (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "proof(rule simpleI)"], ["proof (state)\ngoal (2 subgoals):\n 1. match (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n 2. \\<And>ma wa.\n       blocks ma wa\n        (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}) \\<Longrightarrow>\n       wa \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "from \\<open>simple \\<mu>\\<close> \\<open>blocks m w \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  simple \\<mu>\n  blocks m w \\<mu>", "show \"match ?\\<mu>'\""], ["proof (prove)\nusing this:\n  simple \\<mu>\n  blocks m w \\<mu>\n\ngoal (1 subgoal):\n 1. match (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "unfolding blocks_def match_def simple_def m_strictly_prefers_def w_strictly_prefers_def"], ["proof (prove)\nusing this:\n  (inj_on fst \\<mu> \\<and>\n   inj_on snd \\<mu> \\<and>\n   \\<mu>\n   \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n               (\\<Union>w. Field (Pw w) \\<times> {w})) \\<and>\n  (\\<forall>m w.\n      w \\<in> {w' \\<in> Field (Pm m).\n               \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n                  (w, w') \\<in> Pm m \\<and> (w', w) \\<notin> Pm m} \\<and>\n      m \\<in> {m' \\<in> Field (Pw w).\n               \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n                  (m, m') \\<in> Pw w \\<and>\n                  (m', m) \\<notin> Pw w} \\<longrightarrow>\n      w \\<notin> Range \\<mu>)\n  w \\<in> {w' \\<in> Field (Pm m).\n           \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n              (w, w') \\<in> Pm m \\<and> (w', w) \\<notin> Pm m} \\<and>\n  m \\<in> {m' \\<in> Field (Pw w).\n           \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n              (m, m') \\<in> Pw w \\<and> (m', m) \\<notin> Pw w}\n\ngoal (1 subgoal):\n 1. inj_on fst (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}) \\<and>\n    inj_on snd (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}) \\<and>\n    \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}\n    \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n                (\\<Union>w. Field (Pw w) \\<times> {w})", "by (safe; clarsimp simp: inj_on_diff; blast)"], ["proof (state)\nthis:\n  match (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. \\<And>ma wa.\n       blocks ma wa\n        (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}) \\<Longrightarrow>\n       wa \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "fix m' w'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ma wa.\n       blocks ma wa\n        (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}) \\<Longrightarrow>\n       wa \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "assume \"blocks m' w' ?\\<mu>'\""], ["proof (state)\nthis:\n  blocks m' w' (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. \\<And>ma wa.\n       blocks ma wa\n        (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}) \\<Longrightarrow>\n       wa \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "from \\<open>blocks m' w' ?\\<mu>'\\<close> \\<open>\\<forall>m'. blocks m' w \\<mu> \\<and> (m, m') \\<in> Pw w \\<longrightarrow> (m', m) \\<in> Pw w\\<close>"], ["proof (chain)\npicking this:\n  blocks m' w' (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  \\<forall>m'.\n     blocks m' w \\<mu> \\<and> (m, m') \\<in> Pw w \\<longrightarrow>\n     (m', m) \\<in> Pw w", "have \"w' \\<noteq> w\""], ["proof (prove)\nusing this:\n  blocks m' w' (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  \\<forall>m'.\n     blocks m' w \\<mu> \\<and> (m, m') \\<in> Pw w \\<longrightarrow>\n     (m', m) \\<in> Pw w\n\ngoal (1 subgoal):\n 1. w' \\<noteq> w", "unfolding blocks_def m_strictly_prefers_def w_strictly_prefers_def"], ["proof (prove)\nusing this:\n  w' \\<in> {w' \\<in> Field (Pm m').\n            \\<forall>w\\<in>{wa.\n                            (m', wa)\n                            \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                                  {(m, w)}}.\n               (w, w') \\<in> Pm m' \\<and> (w', w) \\<notin> Pm m'} \\<and>\n  m' \\<in> {m' \\<in> Field (Pw w').\n            \\<forall>m\\<in>{ma.\n                            (ma, w')\n                            \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                                  {(m, w)}}.\n               (m, m') \\<in> Pw w' \\<and> (m', m) \\<notin> Pw w'}\n  \\<forall>m'.\n     (w \\<in> {w' \\<in> Field (Pm m').\n               \\<forall>w\\<in>{w. (m', w) \\<in> \\<mu>}.\n                  (w, w') \\<in> Pm m' \\<and> (w', w) \\<notin> Pm m'} \\<and>\n      m' \\<in> {m' \\<in> Field (Pw w).\n                \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n                   (m, m') \\<in> Pw w \\<and> (m', m) \\<notin> Pw w}) \\<and>\n     (m, m') \\<in> Pw w \\<longrightarrow>\n     (m', m) \\<in> Pw w\n\ngoal (1 subgoal):\n 1. w' \\<noteq> w", "by auto"], ["proof (state)\nthis:\n  w' \\<noteq> w\n\ngoal (1 subgoal):\n 1. \\<And>ma wa.\n       blocks ma wa\n        (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}) \\<Longrightarrow>\n       wa \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "show \"w' \\<notin> Range ?\\<mu>'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "proof(cases \"(m, w') \\<in> \\<mu>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. (m, w') \\<in> \\<mu> \\<Longrightarrow>\n    w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n 2. (m, w') \\<notin> \\<mu> \\<Longrightarrow>\n    w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "case True"], ["proof (state)\nthis:\n  (m, w') \\<in> \\<mu>\n\ngoal (2 subgoals):\n 1. (m, w') \\<in> \\<mu> \\<Longrightarrow>\n    w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n 2. (m, w') \\<notin> \\<mu> \\<Longrightarrow>\n    w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "from \\<open>simple \\<mu>\\<close> \\<open>blocks m' w' ?\\<mu>'\\<close> \\<open>w' \\<noteq> w\\<close> \\<open>(m, w') \\<in> \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  simple \\<mu>\n  blocks m' w' (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  w' \\<noteq> w\n  (m, w') \\<in> \\<mu>", "show ?thesis"], ["proof (prove)\nusing this:\n  simple \\<mu>\n  blocks m' w' (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  w' \\<noteq> w\n  (m, w') \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "unfolding simple_def match_def"], ["proof (prove)\nusing this:\n  (inj_on fst \\<mu> \\<and>\n   inj_on snd \\<mu> \\<and>\n   \\<mu>\n   \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n               (\\<Union>w. Field (Pw w) \\<times> {w})) \\<and>\n  (\\<forall>m w. blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)\n  blocks m' w' (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  w' \\<noteq> w\n  (m, w') \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "by clarsimp (metis (no_types, hide_lams) fst_conv inj_on_contraD snd_conv)"], ["proof (state)\nthis:\n  w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. (m, w') \\<notin> \\<mu> \\<Longrightarrow>\n    w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. (m, w') \\<notin> \\<mu> \\<Longrightarrow>\n    w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "case False"], ["proof (state)\nthis:\n  (m, w') \\<notin> \\<mu>\n\ngoal (1 subgoal):\n 1. (m, w') \\<notin> \\<mu> \\<Longrightarrow>\n    w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "from Pm_pref \\<open>blocks m w \\<mu>\\<close> \\<open>blocks m' w' ?\\<mu>'\\<close> \\<open>(m, w') \\<notin> \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  \\<forall>m. Preorder (Pm m) \\<and> Total (Pm m)\n  blocks m w \\<mu>\n  blocks m' w' (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  (m, w') \\<notin> \\<mu>", "have \"blocks m' w' \\<mu>\""], ["proof (prove)\nusing this:\n  \\<forall>m. Preorder (Pm m) \\<and> Total (Pm m)\n  blocks m w \\<mu>\n  blocks m' w' (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  (m, w') \\<notin> \\<mu>\n\ngoal (1 subgoal):\n 1. blocks m' w' \\<mu>", "unfolding preorder_on_def blocks_def m_strictly_prefers_def w_strictly_prefers_def"], ["proof (prove)\nusing this:\n  \\<forall>m. (Refl (Pm m) \\<and> trans (Pm m)) \\<and> Total (Pm m)\n  w \\<in> {w' \\<in> Field (Pm m).\n           \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n              (w, w') \\<in> Pm m \\<and> (w', w) \\<notin> Pm m} \\<and>\n  m \\<in> {m' \\<in> Field (Pw w).\n           \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n              (m, m') \\<in> Pw w \\<and> (m', m) \\<notin> Pw w}\n  w' \\<in> {w' \\<in> Field (Pm m').\n            \\<forall>w\\<in>{wa.\n                            (m', wa)\n                            \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                                  {(m, w)}}.\n               (w, w') \\<in> Pm m' \\<and> (w', w) \\<notin> Pm m'} \\<and>\n  m' \\<in> {m' \\<in> Field (Pw w').\n            \\<forall>m\\<in>{ma.\n                            (ma, w')\n                            \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                                  {(m, w)}}.\n               (m, m') \\<in> Pw w' \\<and> (m', m) \\<notin> Pw w'}\n  (m, w') \\<notin> \\<mu>\n\ngoal (1 subgoal):\n 1. w' \\<in> {w' \\<in> Field (Pm m').\n              \\<forall>w\\<in>{w. (m', w) \\<in> \\<mu>}.\n                 (w, w') \\<in> Pm m' \\<and> (w', w) \\<notin> Pm m'} \\<and>\n    m' \\<in> {m' \\<in> Field (Pw w').\n              \\<forall>m\\<in>{m. (m, w') \\<in> \\<mu>}.\n                 (m, m') \\<in> Pw w' \\<and> (m', m) \\<notin> Pw w'}", "by simp (metis transE)"], ["proof (state)\nthis:\n  blocks m' w' \\<mu>\n\ngoal (1 subgoal):\n 1. (m, w') \\<notin> \\<mu> \\<Longrightarrow>\n    w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "with \\<open>simple \\<mu>\\<close> \\<open>w' \\<noteq> w\\<close>"], ["proof (chain)\npicking this:\n  simple \\<mu>\n  w' \\<noteq> w\n  blocks m' w' \\<mu>", "show ?thesis"], ["proof (prove)\nusing this:\n  simple \\<mu>\n  w' \\<noteq> w\n  blocks m' w' \\<mu>\n\ngoal (1 subgoal):\n 1. w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "unfolding simple_def"], ["proof (prove)\nusing this:\n  match \\<mu> \\<and>\n  (\\<forall>m w. blocks m w \\<mu> \\<longrightarrow> w \\<notin> Range \\<mu>)\n  w' \\<noteq> w\n  blocks m' w' \\<mu>\n\ngoal (1 subgoal):\n 1. w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "by blast"], ["proof (state)\nthis:\n  w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  w' \\<notin> Range (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  simple (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  simple (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "have \"weakly_preferred_by_men \\<mu> ?\\<mu>'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. weakly_preferred_by_men \\<mu>\n     (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "proof(rule weakly_preferred_by_menI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ma wa.\n       (ma, wa) \\<in> \\<mu> \\<Longrightarrow>\n       \\<exists>w'.\n          (ma, w')\n          \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n          w' \\<in> m_weakly_prefers ma \\<mu>", "fix m' w'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ma wa.\n       (ma, wa) \\<in> \\<mu> \\<Longrightarrow>\n       \\<exists>w'.\n          (ma, w')\n          \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n          w' \\<in> m_weakly_prefers ma \\<mu>", "assume \"(m', w') \\<in> \\<mu>\""], ["proof (state)\nthis:\n  (m', w') \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. \\<And>ma wa.\n       (ma, wa) \\<in> \\<mu> \\<Longrightarrow>\n       \\<exists>w'.\n          (ma, w')\n          \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n          w' \\<in> m_weakly_prefers ma \\<mu>", "then"], ["proof (chain)\npicking this:\n  (m', w') \\<in> \\<mu>", "show \"\\<exists>w'. (m', w') \\<in> ?\\<mu>' \\<and> w' \\<in> m_weakly_prefers m' \\<mu>\""], ["proof (prove)\nusing this:\n  (m', w') \\<in> \\<mu>\n\ngoal (1 subgoal):\n 1. \\<exists>w'.\n       (m', w') \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n       w' \\<in> m_weakly_prefers m' \\<mu>", "proof(cases \"m' = m\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>(m', w') \\<in> \\<mu>; m' = m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>w'.\n                         (m', w')\n                         \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                               {(m, w)} \\<and>\n                         w' \\<in> m_weakly_prefers m' \\<mu>\n 2. \\<lbrakk>(m', w') \\<in> \\<mu>; m' \\<noteq> m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>w'.\n                         (m', w')\n                         \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                               {(m, w)} \\<and>\n                         w' \\<in> m_weakly_prefers m' \\<mu>", "case True"], ["proof (state)\nthis:\n  m' = m\n\ngoal (2 subgoals):\n 1. \\<lbrakk>(m', w') \\<in> \\<mu>; m' = m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>w'.\n                         (m', w')\n                         \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                               {(m, w)} \\<and>\n                         w' \\<in> m_weakly_prefers m' \\<mu>\n 2. \\<lbrakk>(m', w') \\<in> \\<mu>; m' \\<noteq> m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>w'.\n                         (m', w')\n                         \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                               {(m, w)} \\<and>\n                         w' \\<in> m_weakly_prefers m' \\<mu>", "from \\<open>blocks m w \\<mu>\\<close> \\<open>(m', w') \\<in> \\<mu>\\<close> \\<open>m' = m\\<close>"], ["proof (chain)\npicking this:\n  blocks m w \\<mu>\n  (m', w') \\<in> \\<mu>\n  m' = m", "show ?thesis"], ["proof (prove)\nusing this:\n  blocks m w \\<mu>\n  (m', w') \\<in> \\<mu>\n  m' = m\n\ngoal (1 subgoal):\n 1. \\<exists>w'.\n       (m', w') \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n       w' \\<in> m_weakly_prefers m' \\<mu>", "unfolding m_weakly_prefers_def blocks_def m_strictly_prefers_def"], ["proof (prove)\nusing this:\n  w \\<in> {w' \\<in> Field (Pm m).\n           \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>}.\n              (w, w') \\<in> Pm m \\<and> (w', w) \\<notin> Pm m} \\<and>\n  m \\<in> w_strictly_prefers w \\<mu>\n  (m', w') \\<in> \\<mu>\n  m' = m\n\ngoal (1 subgoal):\n 1. \\<exists>w'.\n       (m', w') \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n       w' \\<in> {w' \\<in> Field (Pm m').\n                 \\<forall>w\\<in>{w. (m', w) \\<in> \\<mu>}.\n                    (w, w') \\<in> Pm m'}", "by blast"], ["proof (state)\nthis:\n  \\<exists>w'.\n     (m', w') \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n     w' \\<in> m_weakly_prefers m' \\<mu>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(m', w') \\<in> \\<mu>; m' \\<noteq> m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>w'.\n                         (m', w')\n                         \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                               {(m, w)} \\<and>\n                         w' \\<in> m_weakly_prefers m' \\<mu>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>(m', w') \\<in> \\<mu>; m' \\<noteq> m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>w'.\n                         (m', w')\n                         \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                               {(m, w)} \\<and>\n                         w' \\<in> m_weakly_prefers m' \\<mu>", "case False"], ["proof (state)\nthis:\n  m' \\<noteq> m\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(m', w') \\<in> \\<mu>; m' \\<noteq> m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>w'.\n                         (m', w')\n                         \\<in> \\<mu> - {(m, w') |w'. True} \\<union>\n                               {(m, w)} \\<and>\n                         w' \\<in> m_weakly_prefers m' \\<mu>", "from Pm_pref \\<open>simple \\<mu>\\<close> \\<open>(m', w') \\<in> \\<mu>\\<close> \\<open>m' \\<noteq> m\\<close>"], ["proof (chain)\npicking this:\n  \\<forall>m. Preorder (Pm m) \\<and> Total (Pm m)\n  simple \\<mu>\n  (m', w') \\<in> \\<mu>\n  m' \\<noteq> m", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>m. Preorder (Pm m) \\<and> Total (Pm m)\n  simple \\<mu>\n  (m', w') \\<in> \\<mu>\n  m' \\<noteq> m\n\ngoal (1 subgoal):\n 1. \\<exists>w'.\n       (m', w') \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n       w' \\<in> m_weakly_prefers m' \\<mu>", "by clarsimp (meson m_weakly_prefers_Pm match_Field preorder_on_def refl_onD simple_match)"], ["proof (state)\nthis:\n  \\<exists>w'.\n     (m', w') \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n     w' \\<in> m_weakly_prefers m' \\<mu>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>w'.\n     (m', w') \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)} \\<and>\n     w' \\<in> m_weakly_prefers m' \\<mu>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  weakly_preferred_by_men \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  weakly_preferred_by_men \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "from \\<open>blocks m w \\<mu>\\<close>"], ["proof (chain)\npicking this:\n  blocks m w \\<mu>", "have \"strictly_preferred_by_a_man \\<mu> ?\\<mu>'\""], ["proof (prove)\nusing this:\n  blocks m w \\<mu>\n\ngoal (1 subgoal):\n 1. strictly_preferred_by_a_man \\<mu>\n     (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})", "unfolding strictly_preferred_by_a_man_def blocks_def"], ["proof (prove)\nusing this:\n  w \\<in> m_strictly_prefers m \\<mu> \\<and>\n  m \\<in> w_strictly_prefers w \\<mu>\n\ngoal (1 subgoal):\n 1. \\<exists>ma.\n       \\<exists>w\\<in>{wa.\n                       (ma, wa)\n                       \\<in> \\<mu> - {(m, w') |w'. True} \\<union> {(m, w)}}.\n          w \\<in> m_strictly_prefers ma \\<mu>", "by blast"], ["proof (state)\nthis:\n  strictly_preferred_by_a_man \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  strictly_preferred_by_a_man \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "note \\<open>weakly_Pareto_optimal_for_men \\<mu>\\<close>"], ["proof (state)\nthis:\n  weakly_Pareto_optimal_for_men \\<mu>\n\ngoal (1 subgoal):\n 1. \\<not> stable \\<mu> \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  simple (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  weakly_preferred_by_men \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  strictly_preferred_by_a_man \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  weakly_Pareto_optimal_for_men \\<mu>", "show False"], ["proof (prove)\nusing this:\n  simple (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  weakly_preferred_by_men \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  strictly_preferred_by_a_man \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  weakly_Pareto_optimal_for_men \\<mu>\n\ngoal (1 subgoal):\n 1. False", "unfolding weakly_Pareto_optimal_for_men_def"], ["proof (prove)\nusing this:\n  simple (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  weakly_preferred_by_men \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  strictly_preferred_by_a_man \\<mu>\n   (\\<mu> - {(m, w') |w'. True} \\<union> {(m, w)})\n  simple \\<mu> \\<and>\n  (\\<nexists>\\<mu>'.\n      simple \\<mu>' \\<and>\n      weakly_preferred_by_men \\<mu> \\<mu>' \\<and>\n      strictly_preferred_by_a_man \\<mu> \\<mu>')\n\ngoal (1 subgoal):\n 1. False", "by blast"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem stable_ex:\n  \"\\<exists>\\<mu>. stable \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ex stable", "using weakly_Pareto_optimal_for_men_stable weakly_Pareto_optimal_for_men_ex"], ["proof (prove)\nusing this:\n  weakly_Pareto_optimal_for_men ?\\<mu> \\<Longrightarrow> stable ?\\<mu>\n  Ex weakly_Pareto_optimal_for_men\n\ngoal (1 subgoal):\n 1. Ex stable", "by blast"], ["", "text\\<open>\n\nWe can exit the locale context and later re-enter it.\n\n\\<close>"], ["", "end"], ["", "text\\<open>\n\nWe @{emph \\<open>interpret\\<close>} the locale by supplying constants that instantiate\nthe variables we fixed earlier, and proving that these satisfy the\nassumptions. In this case we provide concrete preference orders, and\nby doing so we demonstrate that our theory is non-vacuous. We\narbitrarily choose \\citet[Example~2.15]{RothSotomayor:1990} which\ndemonstrates the non-existence of man- or woman-optimal matches if\npreferences are non-strict. (We define optimality shortly.) The\nfollowing bunch of types eases the description of this particular\nscenario.\n\n\\<close>"], ["", "datatype M = M1 | M2 | M3"], ["", "datatype W = W1 | W2 | W3"], ["", "lemma M_UNIV: \"UNIV = set [M1, M2, M3]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. UNIV = set [M1, M2, M3]", "using M.exhaust"], ["proof (prove)\nusing this:\n  \\<lbrakk>?y = M1 \\<Longrightarrow> ?P; ?y = M2 \\<Longrightarrow> ?P;\n   ?y = M3 \\<Longrightarrow> ?P\\<rbrakk>\n  \\<Longrightarrow> ?P\n\ngoal (1 subgoal):\n 1. UNIV = set [M1, M2, M3]", "by auto"], ["", "lemma W_UNIV: \"UNIV = set [W1, W2, W3]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. UNIV = set [W1, W2, W3]", "using W.exhaust"], ["proof (prove)\nusing this:\n  \\<lbrakk>?y = W1 \\<Longrightarrow> ?P; ?y = W2 \\<Longrightarrow> ?P;\n   ?y = W3 \\<Longrightarrow> ?P\\<rbrakk>\n  \\<Longrightarrow> ?P\n\ngoal (1 subgoal):\n 1. UNIV = set [W1, W2, W3]", "by auto"], ["", "instance M :: finite"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS(M, finite_class)", "by standard (simp add: M_UNIV)"], ["", "instance W :: finite"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS(W, finite_class)", "by standard (simp add: W_UNIV)"], ["", "lemma M_All:\n  shows \"(\\<forall>m. P m) \\<longleftrightarrow> (\\<forall>m\\<in>set [M1, M2, M3]. P m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>m. P m) = (\\<forall>m\\<in>set [M1, M2, M3]. P m)", "by (metis M_UNIV UNIV_I)"], ["", "lemma W_All:\n  shows \"(\\<forall>w. P w) \\<longleftrightarrow> (\\<forall>w\\<in>set [W1, W2, W3]. P w)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>w. P w) = (\\<forall>w\\<in>set [W1, W2, W3]. P w)", "by (metis W_UNIV UNIV_I)"], ["", "primrec Pm :: \"M \\<Rightarrow> W rel\" where\n  \"Pm M1 = { (W1, W1), (W1, W2), (W1, W3), (W2, W2), (W2, W3), (W3, W3), (W3, W2) }\"\n| \"Pm M2 = { (W1, W1), (W1, W2), (W2, W2) }\"\n| \"Pm M3 = { (W1, W1), (W1, W3), (W3, W3) }\""], ["", "primrec Pw :: \"W \\<Rightarrow> M rel\" where\n  \"Pw W1 = { (M3, M3), (M3, M2), (M3, M1), (M2, M2), (M2, M1), (M1, M1) }\"\n| \"Pw W2 = { (M2, M2), (M2, M1), (M1, M1) }\"\n| \"Pw W3 = { (M3, M3), (M3, M1), (M1, M1) }\""], ["", "lemma Pm: \"Preorder (Pm m) \\<and> Total (Pm m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Preorder (Pm m) \\<and> Total (Pm m)", "unfolding preorder_on_def refl_on_def trans_def total_on_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((Pm m \\<subseteq> Field (Pm m) \\<times> Field (Pm m) \\<and>\n      (\\<forall>x\\<in>Field (Pm m). (x, x) \\<in> Pm m)) \\<and>\n     (\\<forall>x y z.\n         (x, y) \\<in> Pm m \\<longrightarrow>\n         (y, z) \\<in> Pm m \\<longrightarrow> (x, z) \\<in> Pm m)) \\<and>\n    (\\<forall>x\\<in>Field (Pm m).\n        \\<forall>y\\<in>Field (Pm m).\n           x \\<noteq> y \\<longrightarrow>\n           (x, y) \\<in> Pm m \\<or> (y, x) \\<in> Pm m)", "by (cases m) (safe, auto)"], ["", "lemma Pw: \"Preorder (Pw w) \\<and> Total (Pw w)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Preorder (Pw w) \\<and> Total (Pw w)", "unfolding preorder_on_def refl_on_def trans_def total_on_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((Pw w \\<subseteq> Field (Pw w) \\<times> Field (Pw w) \\<and>\n      (\\<forall>x\\<in>Field (Pw w). (x, x) \\<in> Pw w)) \\<and>\n     (\\<forall>x y z.\n         (x, y) \\<in> Pw w \\<longrightarrow>\n         (y, z) \\<in> Pw w \\<longrightarrow> (x, z) \\<in> Pw w)) \\<and>\n    (\\<forall>x\\<in>Field (Pw w).\n        \\<forall>y\\<in>Field (Pw w).\n           x \\<noteq> y \\<longrightarrow>\n           (x, y) \\<in> Pw w \\<or> (y, x) \\<in> Pw w)", "by (cases w) (safe, auto)"], ["", "interpretation Non_Strict: StableMarriage Pm Pw"], ["proof (prove)\ngoal (1 subgoal):\n 1. StableMarriage Pm Pw", "using Pm Pw"], ["proof (prove)\nusing this:\n  Preorder (Pm ?m) \\<and> Total (Pm ?m)\n  Preorder (Pw ?w) \\<and> Total (Pw ?w)\n\ngoal (1 subgoal):\n 1. StableMarriage Pm Pw", "by unfold_locales blast+"], ["", "text\\<open>\n\nWe demonstrate that there are only two stable matches in this\nscenario.  Isabelle/HOL does not have any special support for these\ntypes of model checking problems, so we simply try all combinations of\nmen and women. Clearly this does not scale, and for larger domains we\nneed to be a bit cleverer (see \\S\\ref{sec:bossiness}).\n\n\\<close>"], ["", "lemma Non_Strict_stable1:\n  shows \"Non_Strict.stable {(M1, W2), (M2, W1), (M3, W3)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Non_Strict.stable {(M1, W2), (M2, W1), (M3, W3)}", "unfolding Non_Strict.stable_def Non_Strict.match_def Non_Strict.blocks_def Non_Strict.m_strictly_prefers_def\n          Non_Strict.w_strictly_prefers_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (inj_on fst {(M1, W2), (M2, W1), (M3, W3)} \\<and>\n     inj_on snd {(M1, W2), (M2, W1), (M3, W3)} \\<and>\n     {(M1, W2), (M2, W1), (M3, W3)}\n     \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n                 (\\<Union>w. Field (Pw w) \\<times> {w})) \\<and>\n    (\\<forall>m w.\n        \\<not> (w \\<in> {w' \\<in> Field (Pm m).\n                         \\<forall>w\\<in>{w.\n   (m, w) \\<in> {(M1, W2), (M2, W1), (M3, W3)}}.\n                            (w, w') \\<in> Pm m \\<and>\n                            (w', w) \\<notin> Pm m} \\<and>\n                m \\<in> {m' \\<in> Field (Pw w).\n                         \\<forall>m\\<in>{m.\n   (m, w) \\<in> {(M1, W2), (M2, W1), (M3, W3)}}.\n                            (m, m') \\<in> Pw w \\<and>\n                            (m', m) \\<notin> Pw w}))", "by clarsimp (metis M.exhaust)"], ["", "lemma Non_Strict_stable2:\n  shows \"Non_Strict.stable {(M1, W3), (M2, W2), (M3, W1)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Non_Strict.stable {(M1, W3), (M2, W2), (M3, W1)}", "unfolding Non_Strict.stable_def Non_Strict.match_def Non_Strict.blocks_def Non_Strict.m_strictly_prefers_def\n          Non_Strict.w_strictly_prefers_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (inj_on fst {(M1, W3), (M2, W2), (M3, W1)} \\<and>\n     inj_on snd {(M1, W3), (M2, W2), (M3, W1)} \\<and>\n     {(M1, W3), (M2, W2), (M3, W1)}\n     \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n                 (\\<Union>w. Field (Pw w) \\<times> {w})) \\<and>\n    (\\<forall>m w.\n        \\<not> (w \\<in> {w' \\<in> Field (Pm m).\n                         \\<forall>w\\<in>{w.\n   (m, w) \\<in> {(M1, W3), (M2, W2), (M3, W1)}}.\n                            (w, w') \\<in> Pm m \\<and>\n                            (w', w) \\<notin> Pm m} \\<and>\n                m \\<in> {m' \\<in> Field (Pw w).\n                         \\<forall>m\\<in>{m.\n   (m, w) \\<in> {(M1, W3), (M2, W2), (M3, W1)}}.\n                            (m, m') \\<in> Pw w \\<and>\n                            (m', m) \\<notin> Pw w}))", "by clarsimp (metis M.exhaust)"], ["", "lemma Non_Strict_stable_matches:\n  \"Non_Strict.stable \\<mu>\n     \\<longleftrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)}\n     \\<or> \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\" (is \"?lhs \\<longleftrightarrow> ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. Non_Strict.stable \\<mu> =\n    (\\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M3, W1)})", "proof(rule iffI)"], ["proof (state)\ngoal (2 subgoals):\n 1. Non_Strict.stable \\<mu> \\<Longrightarrow>\n    \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 2. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    Non_Strict.stable \\<mu>", "assume ?lhs"], ["proof (state)\nthis:\n  Non_Strict.stable \\<mu>\n\ngoal (2 subgoals):\n 1. Non_Strict.stable \\<mu> \\<Longrightarrow>\n    \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 2. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    Non_Strict.stable \\<mu>", "have \"\\<mu> \\<in> set ` set (subseqs (List.product [M1, M2, M3] [W1, W2, W3]))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<mu> \\<in> set ` set (subseqs (List.product [M1, M2, M3] [W1, W2, W3]))", "by (subst subseqs_powset; clarsimp; metis M.exhaust W.exhaust)"], ["proof (state)\nthis:\n  \\<mu> \\<in> set ` set (subseqs (List.product [M1, M2, M3] [W1, W2, W3]))\n\ngoal (2 subgoals):\n 1. Non_Strict.stable \\<mu> \\<Longrightarrow>\n    \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 2. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    Non_Strict.stable \\<mu>", "with \\<open>?lhs\\<close>"], ["proof (chain)\npicking this:\n  Non_Strict.stable \\<mu>\n  \\<mu> \\<in> set ` set (subseqs (List.product [M1, M2, M3] [W1, W2, W3]))", "show ?rhs"], ["proof (prove)\nusing this:\n  Non_Strict.stable \\<mu>\n  \\<mu> \\<in> set ` set (subseqs (List.product [M1, M2, M3] [W1, W2, W3]))\n\ngoal (1 subgoal):\n 1. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}", "unfolding Non_Strict.stable_def Non_Strict.match_def"], ["proof (prove)\nusing this:\n  (inj_on fst \\<mu> \\<and>\n   inj_on snd \\<mu> \\<and>\n   \\<mu>\n   \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<inter>\n               (\\<Union>w. Field (Pw w) \\<times> {w})) \\<and>\n  (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>)\n  \\<mu> \\<in> set ` set (subseqs (List.product [M1, M2, M3] [W1, W2, W3]))\n\ngoal (1 subgoal):\n 1. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}", "apply (simp cong: INF_cong_simp SUP_cong_simp cong del: image_cong_simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W2), (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3),\n      (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3),\n      (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1),\n      (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W1),\n      (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W1),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M1, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W1), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W1), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M1, W3), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M1, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M2, W1), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M2, W1), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M2, W1), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W1)} \\<or>\n     \\<mu> =\n     {(M1, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W1)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W1), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W1)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M1, W3), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M1, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M2, W1), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M2, W1), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W1)} \\<or>\n     \\<mu> =\n     {(M1, W2), (M2, W2), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W2)} \\<or>\n     \\<mu> =\n     {(M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2),\n      (M3, W3)} \\<or>\n     \\<mu> =\n     {(M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> =\n     {(M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> =\n     {(M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> =\n     {(M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W2)} \\<or>\n     \\<mu> =\n     {(M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W1)} \\<or>\n     \\<mu> =\n     {(M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M2, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M1, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M1, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M1, W3)} \\<or>\n     \\<mu> =\n     {(M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M2, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M2, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M3, W1)} \\<or>\n     \\<mu> = {(M2, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W1)} \\<or>\n     \\<mu> = {(M2, W2), (M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W2), (M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W2), (M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W2), (M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M2, W2), (M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W2), (M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W2), (M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W2), (M2, W3)} \\<or>\n     \\<mu> = {(M2, W2), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W2), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W2), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W2), (M3, W1)} \\<or>\n     \\<mu> = {(M2, W2), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W2), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W2)} \\<or>\n     \\<mu> = {(M2, W3), (M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W3), (M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W3), (M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W3), (M3, W1)} \\<or>\n     \\<mu> = {(M2, W3), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W3), (M3, W2)} \\<or>\n     \\<mu> = {(M2, W3), (M3, W3)} \\<or>\n     \\<mu> = {(M2, W3)} \\<or>\n     \\<mu> = {(M3, W1), (M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M3, W1), (M3, W2)} \\<or>\n     \\<mu> = {(M3, W1), (M3, W3)} \\<or>\n     \\<mu> = {(M3, W1)} \\<or>\n     \\<mu> = {(M3, W2), (M3, W3)} \\<or>\n     \\<mu> = {(M3, W2)} \\<or> \\<mu> = {(M3, W3)} \\<or> \\<mu> = {}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}", "apply (elim disjE)"], ["proof (prove)\ngoal (512 subgoals):\n 1. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W2), (M3, W3)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 2. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W2)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 3. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W1),\n      (M3, W3)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 4. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3),\n      (M3, W1)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 5. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3), (M3, W2),\n      (M3, W3)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 6. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3),\n      (M3, W2)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 7. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3),\n      (M3, W3)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 8. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M2, W3)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 9. \\<lbrakk>inj_on fst \\<mu> \\<and>\n             inj_on snd \\<mu> \\<and>\n             \\<mu> \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n             \\<mu> \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n             (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n     \\<mu> =\n     {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1), (M3, W2),\n      (M3, W3)}\\<rbrakk>\n    \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n 10. \\<lbrakk>inj_on fst \\<mu> \\<and>\n              inj_on snd \\<mu> \\<and>\n              \\<mu>\n              \\<subseteq> (\\<Union>m. {m} \\<times> Field (Pm m)) \\<and>\n              \\<mu>\n              \\<subseteq> (\\<Union>w. Field (Pw w) \\<times> {w}) \\<and>\n              (\\<forall>m w. \\<not> Non_Strict.blocks m w \\<mu>);\n      \\<mu> =\n      {(M1, W1), (M1, W2), (M1, W3), (M2, W1), (M2, W2), (M3, W1),\n       (M3, W2)}\\<rbrakk>\n     \\<Longrightarrow> \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                       \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\nA total of 512 subgoals...", "apply (simp_all cong: INF_cong_simp SUP_cong_simp cong del: image_cong_simp)"], ["proof (prove)\ngoal (20 subgoals):\n 1. \\<lbrakk>\\<forall>m w.\n                \\<not> Non_Strict.blocks m w {(M1, W1), (M2, W2), (M3, W3)};\n     \\<mu> = {(M1, W1), (M2, W2), (M3, W3)}\\<rbrakk>\n    \\<Longrightarrow> {(M1, W1), (M2, W2), (M3, W3)} =\n                      {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      {(M1, W1), (M2, W2), (M3, W3)} =\n                      {(M1, W3), (M2, W2), (M3, W1)}\n 2. \\<lbrakk>\\<forall>m w.\n                \\<not> Non_Strict.blocks m w {(M1, W1), (M2, W2)};\n     \\<mu> = {(M1, W1), (M2, W2)}\\<rbrakk>\n    \\<Longrightarrow> {(M1, W1), (M2, W2)} =\n                      {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      {(M1, W1), (M2, W2)} = {(M1, W3), (M2, W2), (M3, W1)}\n 3. \\<lbrakk>\\<forall>m w.\n                \\<not> Non_Strict.blocks m w {(M1, W1), (M3, W3)};\n     \\<mu> = {(M1, W1), (M3, W3)}\\<rbrakk>\n    \\<Longrightarrow> {(M1, W1), (M3, W3)} =\n                      {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      {(M1, W1), (M3, W3)} = {(M1, W3), (M2, W2), (M3, W1)}\n 4. \\<lbrakk>\\<forall>m w. \\<not> Non_Strict.blocks m w {(M1, W1)};\n     \\<mu> = {(M1, W1)}\\<rbrakk>\n    \\<Longrightarrow> False\n 5. \\<lbrakk>\\<forall>m w.\n                \\<not> Non_Strict.blocks m w {(M1, W2), (M2, W1)};\n     \\<mu> = {(M1, W2), (M2, W1)}\\<rbrakk>\n    \\<Longrightarrow> {(M1, W2), (M2, W1)} =\n                      {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      {(M1, W2), (M2, W1)} = {(M1, W3), (M2, W2), (M3, W1)}\n 6. \\<lbrakk>\\<forall>m w.\n                \\<not> Non_Strict.blocks m w {(M1, W2), (M3, W1)};\n     \\<mu> = {(M1, W2), (M3, W1)}\\<rbrakk>\n    \\<Longrightarrow> {(M1, W2), (M3, W1)} =\n                      {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      {(M1, W2), (M3, W1)} = {(M1, W3), (M2, W2), (M3, W1)}\n 7. \\<lbrakk>\\<forall>m w.\n                \\<not> Non_Strict.blocks m w {(M1, W2), (M3, W3)};\n     \\<mu> = {(M1, W2), (M3, W3)}\\<rbrakk>\n    \\<Longrightarrow> {(M1, W2), (M3, W3)} =\n                      {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      {(M1, W2), (M3, W3)} = {(M1, W3), (M2, W2), (M3, W1)}\n 8. \\<lbrakk>\\<forall>m w. \\<not> Non_Strict.blocks m w {(M1, W2)};\n     \\<mu> = {(M1, W2)}\\<rbrakk>\n    \\<Longrightarrow> False\n 9. \\<lbrakk>\\<forall>m w.\n                \\<not> Non_Strict.blocks m w {(M1, W3), (M2, W1)};\n     \\<mu> = {(M1, W3), (M2, W1)}\\<rbrakk>\n    \\<Longrightarrow> {(M1, W3), (M2, W1)} =\n                      {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                      {(M1, W3), (M2, W1)} = {(M1, W3), (M2, W2), (M3, W1)}\n 10. \\<lbrakk>\\<forall>m w.\n                 \\<not> Non_Strict.blocks m w {(M1, W3), (M2, W2)};\n      \\<mu> = {(M1, W3), (M2, W2)}\\<rbrakk>\n     \\<Longrightarrow> {(M1, W3), (M2, W2)} =\n                       {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                       {(M1, W3), (M2, W2)} = {(M1, W3), (M2, W2), (M3, W1)}\nA total of 20 subgoals...", "apply (simp_all add: M_All W_All Non_Strict.blocks_def Non_Strict.m_strictly_prefers_def\n                         Non_Strict.w_strictly_prefers_def cong: INF_cong_simp SUP_cong_simp cong del: image_cong_simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n\ngoal (1 subgoal):\n 1. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    Non_Strict.stable \\<mu>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    Non_Strict.stable \\<mu>", "assume ?rhs"], ["proof (state)\nthis:\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n\ngoal (1 subgoal):\n 1. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n    \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    Non_Strict.stable \\<mu>", "with Non_Strict_stable1 Non_Strict_stable2"], ["proof (chain)\npicking this:\n  Non_Strict.stable {(M1, W2), (M2, W1), (M3, W3)}\n  Non_Strict.stable {(M1, W3), (M2, W2), (M3, W1)}\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}", "show ?lhs"], ["proof (prove)\nusing this:\n  Non_Strict.stable {(M1, W2), (M2, W1), (M3, W3)}\n  Non_Strict.stable {(M1, W3), (M2, W2), (M3, W1)}\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n\ngoal (1 subgoal):\n 1. Non_Strict.stable \\<mu>", "by blast"], ["proof (state)\nthis:\n  Non_Strict.stable \\<mu>\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>\n\nSo far the only interesting result in this interpretation of\n\\<open>StableMarriage\\<close> is the @{thm [source]\n\"Non_Strict.stable_ex\"} theorem, i.e., that there is a stable\nmatch. We now add the notion of @{emph \\<open>optimality\\<close>} to our locale, and\nall interpretations will automatically inherit it. Later we will also\nextend locales by adding new fixed variables and assumptions.\n\nFollowing \\citet[Definition~2.11]{RothSotomayor:1990}, a stable match\nis @{emph \\<open>optimal for men\\<close>} if every man likes it at least as much as\nany other stable match (and similarly for an @{emph \\<open>optimal for\nwomen\\<close>} match).\n\n\\<close>"], ["", "context StableMarriage\nbegin"], ["", "definition optimal_for_men :: \"('m, 'w) match \\<Rightarrow> bool\" where\n  \"optimal_for_men \\<mu>\n     \\<longleftrightarrow> stable \\<mu> \\<and> (\\<forall>\\<mu>'. stable \\<mu>' \\<longrightarrow> weakly_preferred_by_men \\<mu>' \\<mu>)\""], ["", "definition w_weakly_prefers :: \"'w \\<Rightarrow> ('m, 'w) match \\<Rightarrow> 'm set\" where\n  \"w_weakly_prefers w \\<mu> = {m' \\<in> Field (Pw w). \\<forall>m\\<in>m_for w \\<mu>. (m, m') \\<in> Pw w}\""], ["", "definition weakly_preferred_by_women :: \"('m, 'w) match \\<Rightarrow> ('m, 'w) match \\<Rightarrow> bool\" where\n  \"weakly_preferred_by_women \\<mu> \\<mu>'\n     \\<longleftrightarrow> (\\<forall>w. \\<forall>m\\<in>m_for w \\<mu>. \\<exists>m'\\<in>m_for w \\<mu>'. m' \\<in> w_weakly_prefers w \\<mu>)\""], ["", "definition optimal_for_women :: \"('m, 'w) match \\<Rightarrow> bool\" where\n  \"optimal_for_women \\<mu>\n     \\<longleftrightarrow> stable \\<mu> \\<and> (\\<forall>\\<mu>'. stable \\<mu>' \\<longrightarrow> weakly_preferred_by_women \\<mu> \\<mu>')\""], ["", "end"], ["", "text\\<open>\n\nWe can show that there is no optimal stable match for these\npreferences:\n\n\\<close>"], ["", "lemma NonStrict_not_optimal:\n  assumes \"Non_Strict.stable \\<mu>\"\n  shows \"\\<not>Non_Strict.optimal_for_men \\<mu> \\<and> \\<not>Non_Strict.optimal_for_women \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "from assms[unfolded Non_Strict_stable_matches]"], ["proof (chain)\npicking this:\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n\ngoal (1 subgoal):\n 1. \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "proof(rule disjE)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<Longrightarrow>\n    \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>\n 2. \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "assume \"\\<mu> = {(M1, W2), (M2, W1), (M3, W3)}\""], ["proof (state)\nthis:\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)}\n\ngoal (2 subgoals):\n 1. \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<Longrightarrow>\n    \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>\n 2. \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "with assms"], ["proof (chain)\npicking this:\n  Non_Strict.stable \\<mu>\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)}", "show ?thesis"], ["proof (prove)\nusing this:\n  Non_Strict.stable \\<mu>\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)}\n\ngoal (1 subgoal):\n 1. \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "unfolding Non_Strict.optimal_for_men_def Non_Strict.weakly_preferred_by_men_def\n                Non_Strict.m_weakly_prefers_def Non_Strict.optimal_for_women_def\n                Non_Strict.weakly_preferred_by_women_def Non_Strict.w_weakly_prefers_def\n                Non_Strict_stable_matches"], ["proof (prove)\nusing this:\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)}\n\ngoal (1 subgoal):\n 1. \\<not> ((\\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n             \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}) \\<and>\n            (\\<forall>\\<mu>'.\n                \\<mu>' = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                \\<mu>' = {(M1, W3), (M2, W2), (M3, W1)} \\<longrightarrow>\n                (\\<forall>m.\n                    \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>'}.\n                       \\<exists>w'\\<in>{w. (m, w) \\<in> \\<mu>}.\n                          w' \\<in> {w' \\<in> Field (Pm m).\n                                    \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>'}.\n (w, w') \\<in> Pm m}))) \\<and>\n    \\<not> ((\\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n             \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}) \\<and>\n            (\\<forall>\\<mu>'.\n                \\<mu>' = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                \\<mu>' = {(M1, W3), (M2, W2), (M3, W1)} \\<longrightarrow>\n                (\\<forall>w.\n                    \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n                       \\<exists>m'\\<in>{m. (m, w) \\<in> \\<mu>'}.\n                          m' \\<in> {m' \\<in> Field (Pw w).\n                                    \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n (m, m') \\<in> Pw w})))", "by clarsimp (rule conjI; rule exI[where x=\"{(M1, W3), (M2, W2), (M3, W1)}\"]; blast)"], ["proof (state)\nthis:\n  \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n  \\<not> Non_Strict.optimal_for_women \\<mu>\n\ngoal (1 subgoal):\n 1. \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "assume \"\\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\""], ["proof (state)\nthis:\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n\ngoal (1 subgoal):\n 1. \\<mu> = {(M1, W3), (M2, W2), (M3, W1)} \\<Longrightarrow>\n    \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "with assms"], ["proof (chain)\npicking this:\n  Non_Strict.stable \\<mu>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}", "show ?thesis"], ["proof (prove)\nusing this:\n  Non_Strict.stable \\<mu>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n\ngoal (1 subgoal):\n 1. \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n    \\<not> Non_Strict.optimal_for_women \\<mu>", "unfolding Non_Strict.optimal_for_men_def Non_Strict.weakly_preferred_by_men_def\n                Non_Strict.m_weakly_prefers_def Non_Strict.optimal_for_women_def\n                Non_Strict.weakly_preferred_by_women_def Non_Strict.w_weakly_prefers_def\n                Non_Strict_stable_matches"], ["proof (prove)\nusing this:\n  \\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n  \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}\n\ngoal (1 subgoal):\n 1. \\<not> ((\\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n             \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}) \\<and>\n            (\\<forall>\\<mu>'.\n                \\<mu>' = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                \\<mu>' = {(M1, W3), (M2, W2), (M3, W1)} \\<longrightarrow>\n                (\\<forall>m.\n                    \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>'}.\n                       \\<exists>w'\\<in>{w. (m, w) \\<in> \\<mu>}.\n                          w' \\<in> {w' \\<in> Field (Pm m).\n                                    \\<forall>w\\<in>{w. (m, w) \\<in> \\<mu>'}.\n (w, w') \\<in> Pm m}))) \\<and>\n    \\<not> ((\\<mu> = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n             \\<mu> = {(M1, W3), (M2, W2), (M3, W1)}) \\<and>\n            (\\<forall>\\<mu>'.\n                \\<mu>' = {(M1, W2), (M2, W1), (M3, W3)} \\<or>\n                \\<mu>' = {(M1, W3), (M2, W2), (M3, W1)} \\<longrightarrow>\n                (\\<forall>w.\n                    \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n                       \\<exists>m'\\<in>{m. (m, w) \\<in> \\<mu>'}.\n                          m' \\<in> {m' \\<in> Field (Pw w).\n                                    \\<forall>m\\<in>{m. (m, w) \\<in> \\<mu>}.\n (m, m') \\<in> Pw w})))", "by clarsimp (rule conjI; rule exI[where x=\"{(M1, W2), (M2, W1), (M3, W3)}\"]; blast)"], ["proof (state)\nthis:\n  \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n  \\<not> Non_Strict.optimal_for_women \\<mu>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<not> Non_Strict.optimal_for_men \\<mu> \\<and>\n  \\<not> Non_Strict.optimal_for_women \\<mu>\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>\n\n\\citet{Sotomayor:1996} remarks that, if the preferences are strict,\nthere is only one weakly Pareto optimal match for men, and that it is\nman-optimal. (This is the match found by the classic man-proposing\ndeferred acceptance algorithm due to \\citet{GaleShapley:1962}.)\nHowever she omits a proof that the man-optimal match actually exists\nunder strict preferences.\n\nThe easiest way to show this and further results is to exhibit the\nlattice structure of the stable matches discovered by Conway (see\n\\citet[Theorem~2.16]{RothSotomayor:1990}), where the men- and\nwomen-optimal matches are the extremal points. This suggests looking\nfor a monotonic function whose fixed points are this lattice, which is\nthe essence of the analysis of matching with contracts in\n\\S\\ref{sec:contracts}.\n\n\\<close>"], ["", "(*<*)"], ["", "end"], ["", "(*>*)"]]}