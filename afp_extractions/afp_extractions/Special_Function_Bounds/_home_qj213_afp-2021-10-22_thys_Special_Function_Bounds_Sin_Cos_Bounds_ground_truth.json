{"file_name": "/home/qj213/afp-2021-10-22/thys/Special_Function_Bounds/Sin_Cos_Bounds.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Special_Function_Bounds", "problem_names": ["lemma sin_le_arg:\n  fixes x :: real\n    shows \"0 \\<le> x \\<Longrightarrow> sin x \\<le> x\"", "lemma cos_ge_1_arg:\n  fixes x :: real\n  assumes \"0 \\<le> x\"\n    shows \"1 - x \\<le> cos x\"", "lemmas sin_Taylor_0_upper_bound_pos = sin_le_arg \\<comment> \\<open>MetiTarski bound\\<close>", "lemma cos_Taylor_1_lower_bound:\n  fixes x :: real\n  assumes \"0 \\<le> x\"\n    shows \"(1 - x^2 / 2) \\<le> cos x\"", "lemma sin_Taylor_1_lower_bound:\n  fixes x :: real\n  assumes \"0 \\<le> x\"\n    shows \"(x - x ^ 3 / 6) \\<le> sin x\"", "lemma sinpoly_Suc: \"sinpoly (Suc n) = (\\<lambda>x. sinpoly n x + sin_coeff n * x ^ n)\"", "lemma cospoly_Suc: \"cospoly (Suc n) = (\\<lambda>x. cospoly n x + cos_coeff n * x ^ n)\"", "lemma sinpoly_minus [simp]: \"sinpoly n (-x) = - sinpoly n x\"", "lemma cospoly_minus [simp]: \"cospoly n (-x) = cospoly n x\"", "lemma d_sinpoly_cospoly:\n    \"(sinpoly (Suc n) has_field_derivative cospoly n x) (at x)\"", "lemma d_cospoly_sinpoly:\n    \"(cospoly (Suc n) has_field_derivative -sinpoly n x) (at x)\"", "lemma sinpoly_lb_imp_cospoly_ub:\n  assumes x0: \"0 \\<le> x\" and k0: \"k>0\" and \"\\<And>x. 0 \\<le> x \\<Longrightarrow> sinpoly (k - 1) x \\<le> sin x\"\n    shows \"cos x \\<le> cospoly k x\"", "lemma cospoly_ub_imp_sinpoly_ub:\n  assumes x0: \"0 \\<le> x\" and k0: \"k>0\" and \"\\<And>x. 0 \\<le> x \\<Longrightarrow> cos x \\<le> cospoly (k - 1) x\"\n    shows \"sin x \\<le> sinpoly k x\"", "lemma sinpoly_ub_imp_cospoly_lb:\n  assumes x0: \"0 \\<le> x\" and k0: \"k>0\" and \"\\<And>x. 0 \\<le> x \\<Longrightarrow> sin x \\<le> sinpoly (k - 1) x\"\n    shows \"cospoly k x \\<le> cos x\"", "lemma cospoly_lb_imp_sinpoly_lb:\n  assumes x0: \"0 \\<le> x\" and k0: \"k>0\" and \"\\<And>x. 0 \\<le> x \\<Longrightarrow> cospoly (k - 1) x \\<le> cos x\"\n    shows \"sinpoly k x \\<le> sin x\"", "lemma\n  assumes \"0 \\<le> x\"\n    shows sinpoly_lower_nonneg: \"sinpoly (4 * Suc n) x \\<le> sin x\"        (is ?th1)\n      and sinpoly_upper_nonneg: \"sin x \\<le> sinpoly (Suc (Suc (4*n))) x\"  (is ?th2)", "lemma cospoly_lower:\n     \"cospoly (Suc (Suc (Suc (4*n)))) x \\<le> cos x\"", "lemma cospoly_upper_nonneg:\n  assumes \"0 \\<le> x\"\n    shows \"cos x \\<le> cospoly (Suc (4*n)) x\"", "lemma cospoly_upper:\n  \"cos x \\<le> cospoly (Suc (4*n)) x\""], "translations": [["", "lemma sin_le_arg:\n  fixes x :: real\n    shows \"0 \\<le> x \\<Longrightarrow> sin x \\<le> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> x \\<Longrightarrow> sin x \\<le> x", "by (fact sin_x_le_x)"], ["", "lemma cos_ge_1_arg:\n  fixes x :: real\n  assumes \"0 \\<le> x\"\n    shows \"1 - x \\<le> cos x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 - x \\<le> cos x", "apply (rule gen_lower_bound_increasing [OF assms])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>x. 1 - x - cos x) has_real_derivative\n                          ?g y)\n                          (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 3. 1 - 0 = cos 0", "apply (intro derivative_eq_intros, auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemmas sin_Taylor_0_upper_bound_pos = sin_le_arg \\<comment> \\<open>MetiTarski bound\\<close>"], ["", "lemma cos_Taylor_1_lower_bound:\n  fixes x :: real\n  assumes \"0 \\<le> x\"\n    shows \"(1 - x^2 / 2) \\<le> cos x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 - x\\<^sup>2 / 2 \\<le> cos x", "apply (rule gen_lower_bound_increasing [OF assms])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>x.\n                              1 - x\\<^sup>2 / 2 - cos x) has_real_derivative\n                          ?g y)\n                          (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 3. 1 - 0\\<^sup>2 / 2 = cos 0", "apply (intro derivative_eq_intros)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 0 = ?f'11 y\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?D18 y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> real 2 * (?D18 y * y ^ (2 - Suc 0)) = ?D13 y\n 4. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 0 = ?E13 y\n 5. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 2 \\<noteq> 0\n 6. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (?D13 y * 2 - y\\<^sup>2 * ?E13 y) / (2 * 2) =\n                         ?g'11 y\n 7. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ?f'11 y - ?g'11 y = ?f'5 y\n 8. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?Db7 y\n 9. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> - sin y * ?Db7 y = ?g'5 y\n 10. \\<And>y.\n        \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n        \\<Longrightarrow> ?f'5 y - ?g'5 y = ?g y\nA total of 12 subgoals...", "apply (rule refl | simp add: sin_le_arg)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma sin_Taylor_1_lower_bound:\n  fixes x :: real\n  assumes \"0 \\<le> x\"\n    shows \"(x - x ^ 3 / 6) \\<le> sin x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x - x ^ 3 / 6 \\<le> sin x", "apply (rule gen_lower_bound_increasing [OF assms])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>x.\n                              x - x ^ 3 / 6 - sin x) has_real_derivative\n                          ?g y)\n                          (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 3. 0 - 0 ^ 3 / 6 = sin 0", "apply (intro derivative_eq_intros)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?f'11 y\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?D18 y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> real 3 * (?D18 y * y ^ (3 - Suc 0)) = ?D13 y\n 4. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 0 = ?E13 y\n 5. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 6 \\<noteq> 0\n 6. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (?D13 y * 6 - y ^ 3 * ?E13 y) / (6 * 6) = ?g'11 y\n 7. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ?f'11 y - ?g'11 y = ?f'5 y\n 8. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?Db7 y\n 9. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> cos y * ?Db7 y = ?g'5 y\n 10. \\<And>y.\n        \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n        \\<Longrightarrow> ?f'5 y - ?g'5 y = ?g y\nA total of 12 subgoals...", "apply (rule refl | simp add: cos_Taylor_1_lower_bound)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section\\<open>Taylor series approximants\\<close>"], ["", "definition sinpoly :: \"[nat,real] \\<Rightarrow> real\"\n  where \"sinpoly n = (\\<lambda>x. \\<Sum>k<n. sin_coeff k * x ^ k)\""], ["", "definition cospoly :: \"[nat,real] \\<Rightarrow> real\"\n  where \"cospoly n = (\\<lambda>x. \\<Sum>k<n. cos_coeff k * x ^ k)\""], ["", "(*sin upper bounds have the form 4*n+2; lower bounds, 4*n\nsinpoly 2 x = x                                      (upper)\nsinpoly 4 x = x - (x^3)/6                            (lower)\nsinpoly 6 x = x - (x^3)/6 + (x^5)/120                (upper)\nsinpoly 8 x = x - (x^3)/6 + (x^5)/120 - (x^7)/5040   (lower)\n\ncos upper bounds have the form 4*n+1; lower bounds, 4*n+3\ncospoly 1 x = 1                                                             (upper)\ncospoly 3 x = 1 - (x^2)/2                                                   (lower)\ncospoly 5 x = 1 - (x^2)/2 + (x^4)/24 - x^6/720 + x^8/40320                  (upper)\ncospoly 7 x = 1 - (x^2)/2 + (x^4)/24 - x^6/720 + x^8/40320 - x^10/3628800   (lower)\n*)"], ["", "lemma sinpoly_Suc: \"sinpoly (Suc n) = (\\<lambda>x. sinpoly n x + sin_coeff n * x ^ n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sinpoly (Suc n) = (\\<lambda>x. sinpoly n x + sin_coeff n * x ^ n)", "by (simp add: sinpoly_def)"], ["", "lemma cospoly_Suc: \"cospoly (Suc n) = (\\<lambda>x. cospoly n x + cos_coeff n * x ^ n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cospoly (Suc n) = (\\<lambda>x. cospoly n x + cos_coeff n * x ^ n)", "by (simp add: cospoly_def)"], ["", "lemma sinpoly_minus [simp]: \"sinpoly n (-x) = - sinpoly n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sinpoly n (- x) = - sinpoly n x", "by (induct n) (auto simp: sinpoly_def sin_coeff_def)"], ["", "lemma cospoly_minus [simp]: \"cospoly n (-x) = cospoly n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cospoly n (- x) = cospoly n x", "by (induct n) (auto simp: cospoly_def cos_coeff_def)"], ["", "lemma d_sinpoly_cospoly:\n    \"(sinpoly (Suc n) has_field_derivative cospoly n x) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (sinpoly (Suc n) has_real_derivative cospoly n x) (at x)", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. (sinpoly (Suc 0) has_real_derivative cospoly 0 x) (at x)\n 2. \\<And>n.\n       (sinpoly (Suc n) has_real_derivative cospoly n x)\n        (at x) \\<Longrightarrow>\n       (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "case 0"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. (sinpoly (Suc 0) has_real_derivative cospoly 0 x) (at x)\n 2. \\<And>n.\n       (sinpoly (Suc n) has_real_derivative cospoly n x)\n        (at x) \\<Longrightarrow>\n       (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (sinpoly (Suc 0) has_real_derivative cospoly 0 x) (at x)", "by (simp add: sinpoly_def cospoly_def)"], ["proof (state)\nthis:\n  (sinpoly (Suc 0) has_real_derivative cospoly 0 x) (at x)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (sinpoly (Suc n) has_real_derivative cospoly n x)\n        (at x) \\<Longrightarrow>\n       (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (sinpoly (Suc n) has_real_derivative cospoly n x)\n        (at x) \\<Longrightarrow>\n       (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "case (Suc n)"], ["proof (state)\nthis:\n  (sinpoly (Suc n) has_real_derivative cospoly n x) (at x)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (sinpoly (Suc n) has_real_derivative cospoly n x)\n        (at x) \\<Longrightarrow>\n       (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "proof (cases \"n=0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "case True"], ["proof (state)\nthis:\n  n = 0\n\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "then"], ["proof (chain)\npicking this:\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "by (simp add: sinpoly_def sin_coeff_def cospoly_def)"], ["proof (state)\nthis:\n  (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "case False"], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "then"], ["proof (chain)\npicking this:\n  n \\<noteq> 0", "have xn: \"x ^ (n - Suc 0) * x = x ^ n\""], ["proof (prove)\nusing this:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. x ^ (n - Suc 0) * x = x ^ n", "by (metis Suc_pred mult.commute not_gr0 power_Suc)"], ["proof (state)\nthis:\n  x ^ (n - Suc 0) * x = x ^ n\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "using Suc False"], ["proof (prove)\nusing this:\n  (sinpoly (Suc n) has_real_derivative cospoly n x) (at x)\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)", "apply (simp add: sinpoly_Suc [of \"Suc n\"] cospoly_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(sinpoly (Suc n) has_real_derivative\n              (\\<Sum>k<n. cos_coeff k * x ^ k))\n              (at x);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> ((\\<lambda>a.\n                           sinpoly (Suc n) a +\n                           sin_coeff (Suc n) *\n                           (a * a ^ n)) has_real_derivative\n                       (\\<Sum>k<n. cos_coeff k * x ^ k) +\n                       cos_coeff n * x ^ n)\n                       (at x)", "apply (intro derivative_eq_intros | simp)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(sinpoly (Suc n) has_real_derivative\n              (\\<Sum>k<n. cos_coeff k * x ^ k))\n              (at x);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> (x ^ n + real n * x ^ (n - Suc 0) * x) *\n                      sin_coeff (Suc n) =\n                      cos_coeff n * x ^ n", "apply (simp add: xn mult.assoc sin_coeff_def cos_coeff_def divide_simps del: fact_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(sinpoly (Suc n) has_real_derivative\n              (\\<Sum>k<n.\n                  (if even k then (- 1) ^ (k div 2) / fact k else 0) *\n                  x ^ k))\n              (at x);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> even n \\<longrightarrow>\n                      (x ^ n + real n * x ^ n) * fact n =\n                      x ^ n * fact (Suc n)", "apply (simp add: algebra_simps)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (sinpoly (Suc (Suc n)) has_real_derivative cospoly (Suc n) x) (at x)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma d_cospoly_sinpoly:\n    \"(cospoly (Suc n) has_field_derivative -sinpoly n x) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cospoly (Suc n) has_real_derivative - sinpoly n x) (at x)", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. (cospoly (Suc 0) has_real_derivative - sinpoly 0 x) (at x)\n 2. \\<And>n.\n       (cospoly (Suc n) has_real_derivative - sinpoly n x)\n        (at x) \\<Longrightarrow>\n       (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x)\n        (at x)", "case 0"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. (cospoly (Suc 0) has_real_derivative - sinpoly 0 x) (at x)\n 2. \\<And>n.\n       (cospoly (Suc n) has_real_derivative - sinpoly n x)\n        (at x) \\<Longrightarrow>\n       (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x)\n        (at x)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (cospoly (Suc 0) has_real_derivative - sinpoly 0 x) (at x)", "by (simp add: sinpoly_def cospoly_def)"], ["proof (state)\nthis:\n  (cospoly (Suc 0) has_real_derivative - sinpoly 0 x) (at x)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (cospoly (Suc n) has_real_derivative - sinpoly n x)\n        (at x) \\<Longrightarrow>\n       (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x)\n        (at x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (cospoly (Suc n) has_real_derivative - sinpoly n x)\n        (at x) \\<Longrightarrow>\n       (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x)\n        (at x)", "case (Suc n)"], ["proof (state)\nthis:\n  (cospoly (Suc n) has_real_derivative - sinpoly n x) (at x)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (cospoly (Suc n) has_real_derivative - sinpoly n x)\n        (at x) \\<Longrightarrow>\n       (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x)\n        (at x)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "proof (cases \"n=0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "case True"], ["proof (state)\nthis:\n  n = 0\n\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "then"], ["proof (chain)\npicking this:\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "by (simp add: sinpoly_def cospoly_def cos_coeff_def)"], ["proof (state)\nthis:\n  (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "case False"], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "then"], ["proof (chain)\npicking this:\n  n \\<noteq> 0", "have xn: \"x ^ (n - Suc 0) * x = x ^ n\""], ["proof (prove)\nusing this:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. x ^ (n - Suc 0) * x = x ^ n", "by (metis Suc_pred mult.commute not_gr0 power_Suc)"], ["proof (state)\nthis:\n  x ^ (n - Suc 0) * x = x ^ n\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "have m1: \"odd n \\<Longrightarrow> (-1 :: real) ^ ((n - Suc 0) div 2) = - ((-1) ^ (Suc n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    (- 1) ^ ((n - Suc 0) div 2) = - ((- 1) ^ (Suc n div 2))", "by (cases n) simp_all"], ["proof (state)\nthis:\n  odd n \\<Longrightarrow>\n  (- 1) ^ ((n - Suc 0) div 2) = - ((- 1) ^ (Suc n div 2))\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "using Suc False"], ["proof (prove)\nusing this:\n  (cospoly (Suc n) has_real_derivative - sinpoly n x) (at x)\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)", "apply (simp add: cospoly_Suc [of \"Suc n\"] sinpoly_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(cospoly (Suc n) has_real_derivative\n              - (\\<Sum>k<n. sin_coeff k * x ^ k))\n              (at x);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> ((\\<lambda>a.\n                           cospoly (Suc n) a +\n                           cos_coeff (Suc n) *\n                           (a * a ^ n)) has_real_derivative\n                       - (\\<Sum>k<n. sin_coeff k * x ^ k) -\n                       sin_coeff n * x ^ n)\n                       (at x)", "apply (intro derivative_eq_intros | simp)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(cospoly (Suc n) has_real_derivative\n              - (\\<Sum>k<n. sin_coeff k * x ^ k))\n              (at x);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> (x ^ n + real n * x ^ (n - Suc 0) * x) *\n                      cos_coeff (Suc n) =\n                      - (sin_coeff n * x ^ n)", "apply (simp add: xn mult.assoc sin_coeff_def cos_coeff_def m1 divide_simps del: fact_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(cospoly (Suc n) has_real_derivative\n              - (\\<Sum>k<n.\n                    (if even k then 0\n                     else (- 1) ^ ((k - Suc 0) div 2) / fact k) *\n                    x ^ k))\n              (at x);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> odd n \\<longrightarrow>\n                      (x ^ n + real n * x ^ n) * fact n =\n                      x ^ n * fact (Suc n)", "apply (simp add: algebra_simps)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cospoly (Suc (Suc n)) has_real_derivative - sinpoly (Suc n) x) (at x)\n\ngoal:\nNo subgoals!", "qed"], ["", "section\\<open>Inductive proof of sine inequalities\\<close>"], ["", "lemma sinpoly_lb_imp_cospoly_ub:\n  assumes x0: \"0 \\<le> x\" and k0: \"k>0\" and \"\\<And>x. 0 \\<le> x \\<Longrightarrow> sinpoly (k - 1) x \\<le> sin x\"\n    shows \"cos x \\<le> cospoly k x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly k x", "apply (rule gen_lower_bound_increasing [OF x0])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>x.\n                              cos x - cospoly k x) has_real_derivative\n                          ?g y)\n                          (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 3. cos 0 = cospoly k 0", "apply (intro derivative_eq_intros | simp)+"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (cospoly k has_real_derivative ?g'5 y) (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> - sin y - ?g'5 y = ?g y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 4. cos 0 = cospoly k 0", "using d_cospoly_sinpoly [of \"k - 1\"] assms"], ["proof (prove)\nusing this:\n  (cospoly (Suc (k - 1)) has_real_derivative - sinpoly (k - 1) ?x) (at ?x)\n  0 \\<le> x\n  0 < k\n  0 \\<le> ?x \\<Longrightarrow> sinpoly (k - 1) ?x \\<le> sin ?x\n\ngoal (4 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (cospoly k has_real_derivative ?g'5 y) (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> - sin y - ?g'5 y = ?g y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 4. cos 0 = cospoly k 0", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x.\n                (cospoly k has_real_derivative - sinpoly (k - Suc 0) x)\n                 (at x);\n     0 \\<le> x; 0 < k;\n     \\<And>x.\n        0 \\<le> x \\<Longrightarrow>\n        sinpoly (k - Suc 0) x \\<le> sin x\\<rbrakk>\n    \\<Longrightarrow> cospoly k 0 = 1", "apply (simp add: cospoly_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma cospoly_ub_imp_sinpoly_ub:\n  assumes x0: \"0 \\<le> x\" and k0: \"k>0\" and \"\\<And>x. 0 \\<le> x \\<Longrightarrow> cos x \\<le> cospoly (k - 1) x\"\n    shows \"sin x \\<le> sinpoly k x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sin x \\<le> sinpoly k x", "apply (rule gen_lower_bound_increasing [OF x0])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>x.\n                              sin x - sinpoly k x) has_real_derivative\n                          ?g y)\n                          (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 3. sin 0 = sinpoly k 0", "apply (intro derivative_eq_intros | simp)+"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (sinpoly k has_real_derivative ?g'5 y) (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> cos y - ?g'5 y = ?g y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 4. sin 0 = sinpoly k 0", "using d_sinpoly_cospoly [of \"k - 1\"] assms"], ["proof (prove)\nusing this:\n  (sinpoly (Suc (k - 1)) has_real_derivative cospoly (k - 1) ?x) (at ?x)\n  0 \\<le> x\n  0 < k\n  0 \\<le> ?x \\<Longrightarrow> cos ?x \\<le> cospoly (k - 1) ?x\n\ngoal (4 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (sinpoly k has_real_derivative ?g'5 y) (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> cos y - ?g'5 y = ?g y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 4. sin 0 = sinpoly k 0", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x.\n                (sinpoly k has_real_derivative cospoly (k - Suc 0) x)\n                 (at x);\n     0 \\<le> x; 0 < k;\n     \\<And>x.\n        0 \\<le> x \\<Longrightarrow>\n        cos x \\<le> cospoly (k - Suc 0) x\\<rbrakk>\n    \\<Longrightarrow> sinpoly k 0 = 0", "apply (simp add: sinpoly_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma sinpoly_ub_imp_cospoly_lb:\n  assumes x0: \"0 \\<le> x\" and k0: \"k>0\" and \"\\<And>x. 0 \\<le> x \\<Longrightarrow> sin x \\<le> sinpoly (k - 1) x\"\n    shows \"cospoly k x \\<le> cos x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cospoly k x \\<le> cos x", "apply (rule gen_lower_bound_increasing [OF x0])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>x.\n                              cospoly k x - cos x) has_real_derivative\n                          ?g y)\n                          (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 3. cospoly k 0 = cos 0", "apply (intro derivative_eq_intros | simp)+"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (cospoly k has_real_derivative ?f'5 y) (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?Db7 y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> - sin y * ?Db7 y = ?g'5 y\n 4. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ?f'5 y - ?g'5 y = ?g y\n 5. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 6. cospoly k 0 = cos 0", "using d_cospoly_sinpoly [of \"k - 1\"] assms"], ["proof (prove)\nusing this:\n  (cospoly (Suc (k - 1)) has_real_derivative - sinpoly (k - 1) ?x) (at ?x)\n  0 \\<le> x\n  0 < k\n  0 \\<le> ?x \\<Longrightarrow> sin ?x \\<le> sinpoly (k - 1) ?x\n\ngoal (6 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (cospoly k has_real_derivative ?f'5 y) (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?Db7 y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> - sin y * ?Db7 y = ?g'5 y\n 4. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ?f'5 y - ?g'5 y = ?g y\n 5. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 6. cospoly k 0 = cos 0", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x.\n                (cospoly k has_real_derivative - sinpoly (k - Suc 0) x)\n                 (at x);\n     0 \\<le> x; 0 < k;\n     \\<And>x.\n        0 \\<le> x \\<Longrightarrow>\n        sin x \\<le> sinpoly (k - Suc 0) x\\<rbrakk>\n    \\<Longrightarrow> cospoly k 0 = 1", "apply (simp add: cospoly_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma cospoly_lb_imp_sinpoly_lb:\n  assumes x0: \"0 \\<le> x\" and k0: \"k>0\" and \"\\<And>x. 0 \\<le> x \\<Longrightarrow> cospoly (k - 1) x \\<le> cos x\"\n    shows \"sinpoly k x \\<le> sin x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sinpoly k x \\<le> sin x", "apply (rule gen_lower_bound_increasing [OF x0])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>x.\n                              sinpoly k x - sin x) has_real_derivative\n                          ?g y)\n                          (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 3. sinpoly k 0 = sin 0", "apply (intro derivative_eq_intros | simp)+"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (sinpoly k has_real_derivative ?f'5 y) (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?Db7 y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> cos y * ?Db7 y = ?g'5 y\n 4. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ?f'5 y - ?g'5 y = ?g y\n 5. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 6. sinpoly k 0 = sin 0", "using d_sinpoly_cospoly [of \"k - 1\"] assms"], ["proof (prove)\nusing this:\n  (sinpoly (Suc (k - 1)) has_real_derivative cospoly (k - 1) ?x) (at ?x)\n  0 \\<le> x\n  0 < k\n  0 \\<le> ?x \\<Longrightarrow> cospoly (k - 1) ?x \\<le> cos ?x\n\ngoal (6 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> (sinpoly k has_real_derivative ?f'5 y) (at y)\n 2. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> 1 = ?Db7 y\n 3. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> cos y * ?Db7 y = ?g'5 y\n 4. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ?f'5 y - ?g'5 y = ?g y\n 5. \\<And>y.\n       \\<lbrakk>0 \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> ?g y \\<le> 0\n 6. sinpoly k 0 = sin 0", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x.\n                (sinpoly k has_real_derivative cospoly (k - Suc 0) x)\n                 (at x);\n     0 \\<le> x; 0 < k;\n     \\<And>x.\n        0 \\<le> x \\<Longrightarrow>\n        cospoly (k - Suc 0) x \\<le> cos x\\<rbrakk>\n    \\<Longrightarrow> sinpoly k 0 = 0", "apply (simp add: sinpoly_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma\n  assumes \"0 \\<le> x\"\n    shows sinpoly_lower_nonneg: \"sinpoly (4 * Suc n) x \\<le> sin x\"        (is ?th1)\n      and sinpoly_upper_nonneg: \"sin x \\<le> sinpoly (Suc (Suc (4*n))) x\"  (is ?th2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. sinpoly (4 * Suc n) x \\<le> sin x &&&\n    sin x \\<le> sinpoly (Suc (Suc (4 * n))) x", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. sinpoly (4 * Suc n) x \\<le> sin x\n 2. sin x \\<le> sinpoly (Suc (Suc (4 * n))) x", "have \"sinpoly (4 * Suc n) x \\<le> sin x  \\<and>  sin x \\<le> sinpoly (Suc (Suc (4*n))) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sinpoly (4 * Suc n) x \\<le> sin x \\<and>\n    sin x \\<le> sinpoly (Suc (Suc (4 * n))) x", "using assms"], ["proof (prove)\nusing this:\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. sinpoly (4 * Suc n) x \\<le> sin x \\<and>\n    sin x \\<le> sinpoly (Suc (Suc (4 * n))) x", "apply (induction n arbitrary: x)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       0 \\<le> x \\<Longrightarrow>\n       sinpoly (4 * Suc 0) x \\<le> sin x \\<and>\n       sin x \\<le> sinpoly (Suc (Suc (4 * 0))) x\n 2. \\<And>n x.\n       \\<lbrakk>\\<And>x.\n                   0 \\<le> x \\<Longrightarrow>\n                   sinpoly (4 * Suc n) x \\<le> sin x \\<and>\n                   sin x \\<le> sinpoly (Suc (Suc (4 * n))) x;\n        0 \\<le> x\\<rbrakk>\n       \\<Longrightarrow> sinpoly (4 * Suc (Suc n)) x \\<le> sin x \\<and>\n                         sin x \\<le> sinpoly (Suc (Suc (4 * Suc n))) x", "apply (simp add: sinpoly_def sin_coeff_def sin_Taylor_1_lower_bound sin_Taylor_0_upper_bound_pos lessThan_nat_numeral fact_numeral)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x.\n       \\<lbrakk>\\<And>x.\n                   0 \\<le> x \\<Longrightarrow>\n                   sinpoly (4 * Suc n) x \\<le> sin x \\<and>\n                   sin x \\<le> sinpoly (Suc (Suc (4 * n))) x;\n        0 \\<le> x\\<rbrakk>\n       \\<Longrightarrow> sinpoly (4 * Suc (Suc n)) x \\<le> sin x \\<and>\n                         sin x \\<le> sinpoly (Suc (Suc (4 * Suc n))) x", "apply (auto simp: cospoly_lb_imp_sinpoly_lb sinpoly_ub_imp_cospoly_lb cospoly_ub_imp_sinpoly_ub sinpoly_lb_imp_cospoly_ub)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  sinpoly (4 * Suc n) x \\<le> sin x \\<and>\n  sin x \\<le> sinpoly (Suc (Suc (4 * n))) x\n\ngoal (2 subgoals):\n 1. sinpoly (4 * Suc n) x \\<le> sin x\n 2. sin x \\<le> sinpoly (Suc (Suc (4 * n))) x", "then"], ["proof (chain)\npicking this:\n  sinpoly (4 * Suc n) x \\<le> sin x \\<and>\n  sin x \\<le> sinpoly (Suc (Suc (4 * n))) x", "show ?th1 ?th2"], ["proof (prove)\nusing this:\n  sinpoly (4 * Suc n) x \\<le> sin x \\<and>\n  sin x \\<le> sinpoly (Suc (Suc (4 * n))) x\n\ngoal (1 subgoal):\n 1. sinpoly (4 * Suc n) x \\<le> sin x &&&\n    sin x \\<le> sinpoly (Suc (Suc (4 * n))) x", "using assms"], ["proof (prove)\nusing this:\n  sinpoly (4 * Suc n) x \\<le> sin x \\<and>\n  sin x \\<le> sinpoly (Suc (Suc (4 * n))) x\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. sinpoly (4 * Suc n) x \\<le> sin x &&&\n    sin x \\<le> sinpoly (Suc (Suc (4 * n))) x", "by auto"], ["proof (state)\nthis:\n  sinpoly (4 * Suc n) x \\<le> sin x\n  sin x \\<le> sinpoly (Suc (Suc (4 * n))) x\n\ngoal:\nNo subgoals!", "qed"], ["", "section\\<open>Collecting the results\\<close>"], ["", "corollary sinpoly_upper_nonpos:\n     \"x \\<le> 0 \\<Longrightarrow> sin x \\<le> sinpoly (4 * Suc n) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow> sin x \\<le> sinpoly (4 * Suc n) x", "using sinpoly_lower_nonneg [of \"-x\" n]"], ["proof (prove)\nusing this:\n  0 \\<le> - x \\<Longrightarrow> sinpoly (4 * Suc n) (- x) \\<le> sin (- x)\n\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow> sin x \\<le> sinpoly (4 * Suc n) x", "by simp"], ["", "corollary sinpoly_lower_nonpos:\n     \"x \\<le> 0 \\<Longrightarrow> sinpoly (Suc (Suc (4*n))) x \\<le> sin x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow> sinpoly (Suc (Suc (4 * n))) x \\<le> sin x", "using sinpoly_upper_nonneg [of \"-x\" n]"], ["proof (prove)\nusing this:\n  0 \\<le> - x \\<Longrightarrow>\n  sin (- x) \\<le> sinpoly (Suc (Suc (4 * n))) (- x)\n\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow> sinpoly (Suc (Suc (4 * n))) x \\<le> sin x", "by simp"], ["", "corollary cospoly_lower_nonneg:\n     \"0 \\<le> x \\<Longrightarrow> cospoly (Suc (Suc (Suc (4*n)))) x \\<le> cos x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> x \\<Longrightarrow>\n    cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "by (auto simp: sinpoly_upper_nonneg sinpoly_ub_imp_cospoly_lb)"], ["", "lemma cospoly_lower:\n     \"cospoly (Suc (Suc (Suc (4*n)))) x \\<le> cos x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "proof (cases rule: le_cases [of 0 x])"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 \\<le> x \\<Longrightarrow>\n    cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x\n 2. x \\<le> 0 \\<Longrightarrow>\n    cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "case le"], ["proof (state)\nthis:\n  0 \\<le> x\n\ngoal (2 subgoals):\n 1. 0 \\<le> x \\<Longrightarrow>\n    cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x\n 2. x \\<le> 0 \\<Longrightarrow>\n    cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "then"], ["proof (chain)\npicking this:\n  0 \\<le> x", "show ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "by (simp add: cospoly_lower_nonneg)"], ["proof (state)\nthis:\n  cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x\n\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow>\n    cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow>\n    cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "case ge"], ["proof (state)\nthis:\n  x \\<le> 0\n\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow>\n    cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "then"], ["proof (chain)\npicking this:\n  x \\<le> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<le> 0\n\ngoal (1 subgoal):\n 1. cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "using cospoly_lower_nonneg [of \"-x\"]"], ["proof (prove)\nusing this:\n  x \\<le> 0\n  0 \\<le> - x \\<Longrightarrow>\n  cospoly (Suc (Suc (Suc (4 * ?n)))) (- x) \\<le> cos (- x)\n\ngoal (1 subgoal):\n 1. cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x", "by simp"], ["proof (state)\nthis:\n  cospoly (Suc (Suc (Suc (4 * n)))) x \\<le> cos x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cospoly_upper_nonneg:\n  assumes \"0 \\<le> x\"\n    shows \"cos x \\<le> cospoly (Suc (4*n)) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly (Suc (4 * n)) x", "proof (cases n)"], ["proof (state)\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x\n 2. \\<And>nat.\n       n = Suc nat \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "case 0"], ["proof (state)\nthis:\n  n = 0\n\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x\n 2. \\<And>nat.\n       n = Suc nat \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "then"], ["proof (chain)\npicking this:\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly (Suc (4 * n)) x", "by (simp add: cospoly_def)"], ["proof (state)\nthis:\n  cos x \\<le> cospoly (Suc (4 * n)) x\n\ngoal (1 subgoal):\n 1. \\<And>nat.\n       n = Suc nat \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>nat.\n       n = Suc nat \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "case (Suc m)"], ["proof (state)\nthis:\n  n = Suc m\n\ngoal (1 subgoal):\n 1. \\<And>nat.\n       n = Suc nat \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "then"], ["proof (chain)\npicking this:\n  n = Suc m", "show ?thesis"], ["proof (prove)\nusing this:\n  n = Suc m\n\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly (Suc (4 * n)) x", "using sinpoly_lower_nonneg [of _ m] assms"], ["proof (prove)\nusing this:\n  n = Suc m\n  0 \\<le> ?x \\<Longrightarrow> sinpoly (4 * Suc m) ?x \\<le> sin ?x\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly (Suc (4 * n)) x", "by (auto simp: sinpoly_lb_imp_cospoly_ub)"], ["proof (state)\nthis:\n  cos x \\<le> cospoly (Suc (4 * n)) x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cospoly_upper:\n  \"cos x \\<le> cospoly (Suc (4*n)) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly (Suc (4 * n)) x", "proof (cases rule: le_cases [of 0 x])"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 \\<le> x \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x\n 2. x \\<le> 0 \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "case le"], ["proof (state)\nthis:\n  0 \\<le> x\n\ngoal (2 subgoals):\n 1. 0 \\<le> x \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x\n 2. x \\<le> 0 \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "then"], ["proof (chain)\npicking this:\n  0 \\<le> x", "show ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly (Suc (4 * n)) x", "by (simp add: cospoly_upper_nonneg)"], ["proof (state)\nthis:\n  cos x \\<le> cospoly (Suc (4 * n)) x\n\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "case ge"], ["proof (state)\nthis:\n  x \\<le> 0\n\ngoal (1 subgoal):\n 1. x \\<le> 0 \\<Longrightarrow> cos x \\<le> cospoly (Suc (4 * n)) x", "then"], ["proof (chain)\npicking this:\n  x \\<le> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<le> 0\n\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly (Suc (4 * n)) x", "using cospoly_upper_nonneg [of \"-x\"]"], ["proof (prove)\nusing this:\n  x \\<le> 0\n  0 \\<le> - x \\<Longrightarrow> cos (- x) \\<le> cospoly (Suc (4 * ?n)) (- x)\n\ngoal (1 subgoal):\n 1. cos x \\<le> cospoly (Suc (4 * n)) x", "by simp"], ["proof (state)\nthis:\n  cos x \\<le> cospoly (Suc (4 * n)) x\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}