{"file_name": "/home/qj213/afp-2021-10-22/thys/Padic_Ints/Padic_Int_Polynomials.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Padic_Ints", "problem_names": ["lemma monom_term_car:\n  assumes \"c \\<in> carrier Zp\"\n  assumes \"x \\<in> carrier Zp\"\n  shows \"c \\<otimes> x[^](n::nat) \\<in> carrier Zp\"", "lemma Zp_x_is_UP_cring:\n\"UP_cring Zp\"", "lemma Zp_x_is_UP_domain:\n\"UP_domain Zp\"", "lemma Zp_x_domain:\n\"domain Zp_x \"", "lemma pow_closed:\n  assumes \"a \\<in> carrier Zp\"\n  shows \"a[^](n::nat) \\<in> carrier Zp\"", "lemma(in ring) pow_zero:\n  assumes \"(n::nat)>0\"\n  shows \"\\<zero>[^] n = \\<zero>\"", "lemma sum_closed:\n  assumes \"f \\<in> carrier Zp\"\n  assumes \"g \\<in> carrier Zp\"\n  shows \"f \\<oplus> g \\<in>  carrier Zp\"", "lemma mult_zero:\n  assumes \"f \\<in> carrier Zp\"\n  shows \"f \\<otimes> \\<zero> = \\<zero>\"\n        \"\\<zero> \\<otimes> f = \\<zero>\"", "lemma monom_poly_is_Zp_continuous:\n  assumes \"c \\<in> carrier Zp\"\n  assumes \"f = monom Zp_x c n\"\n  shows \"is_Zp_continuous (to_fun f)\"", "lemma degree_0_is_Zp_continuous:\n  assumes \"f \\<in> carrier Zp_x\"\n  assumes \"degree f = 0\"\n  shows \"is_Zp_continuous (to_fun f)\"", "lemma UP_sum_is_Zp_continuous:\n  assumes \"a \\<in> carrier Zp_x\"\n  assumes \"b \\<in> carrier Zp_x\"\n  assumes \"is_Zp_continuous (to_fun a)\"\n  assumes \"is_Zp_continuous (to_fun b)\"\n  shows \"is_Zp_continuous (to_fun (a \\<oplus>\\<^bsub>Zp_x\\<^esub> b))\"", "lemma polynomial_is_Zp_continuous:\n  assumes \"f \\<in> carrier Zp_x\"\n  shows \"is_Zp_continuous (to_fun f)\"", "lemma res_to_fun_monic_monom:\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"a k = b k\"\n  shows \"(monom Zp_x \\<one> n \\<bullet> a) k = (monom Zp_x \\<one> n \\<bullet> b) k\"", "lemma res_to_fun_monom:\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"c \\<in> carrier Zp\"\n  assumes \"a k = b k\"\n  shows \"(monom Zp_x c n \\<bullet> a) k = (monom Zp_x c n \\<bullet> b) k\"", "lemma to_fun_res_ltrm: \n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"f \\<in> carrier Zp_x\"\n  assumes \"a k = b k\"\n  shows \"((ltrm f)\\<bullet>a) k = ((ltrm f)\\<bullet>b) k\"", "lemma to_fun_res:\n  assumes \"f \\<in> carrier Zp_x\"\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"a k = b k\"\n  shows \"(f\\<bullet>a) k = (f\\<bullet>b) k\"", "lemma deriv_res:\n  assumes \"f \\<in> carrier Zp_x\"\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"a k = b k\"\n  shows \"(deriv f a) k = (deriv f b) k\"", "lemma to_fun_monom_plus:\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"g \\<in> carrier Zp_x\"\n  assumes \"c \\<in> carrier Zp\"\n  shows \"(monom Zp_x a n \\<oplus>\\<^bsub>Zp_x\\<^esub> g)\\<bullet>c = a \\<otimes> c[^]n \\<oplus> (g \\<bullet> c)\"", "lemma to_fun_monom_minus:\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"g \\<in> carrier Zp_x\"\n  assumes \"c \\<in> carrier Zp\"\n  shows \"(monom Zp_x a n \\<ominus>\\<^bsub>Zp_x\\<^esub> g)\\<bullet>c = a \\<otimes> c[^]n \\<ominus> (g \\<bullet> c)\""], "translations": [["", "lemma monom_term_car:\n  assumes \"c \\<in> carrier Zp\"\n  assumes \"x \\<in> carrier Zp\"\n  shows \"c \\<otimes> x[^](n::nat) \\<in> carrier Zp\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c \\<otimes> x [^] n \\<in> carrier Zp", "using assms  R.nat_pow_closed"], ["proof (prove)\nusing this:\n  c \\<in> carrier Zp\n  x \\<in> carrier Zp\n  ?x \\<in> carrier Zp \\<Longrightarrow> ?x [^] ?n \\<in> carrier Zp\n\ngoal (1 subgoal):\n 1. c \\<otimes> x [^] n \\<in> carrier Zp", "by (simp add: monoid.nat_pow_closed cring.cring_simprules(5) cring_def ring_def)"], ["", "text\\<open>Univariate polynomial ring over Zp\\<close>"], ["", "abbreviation(input) Zp_x where\n\"Zp_x \\<equiv> UP Zp\""], ["", "lemma Zp_x_is_UP_cring:\n\"UP_cring Zp\""], ["proof (prove)\ngoal (1 subgoal):\n 1. UP_cring Zp", "using UP_cring.intro domain_axioms domain_def"], ["proof (prove)\nusing this:\n  cring ?R \\<Longrightarrow> UP_cring ?R\n  domain Zp\n  domain ?R \\<equiv> cring ?R \\<and> domain_axioms ?R\n\ngoal (1 subgoal):\n 1. UP_cring Zp", "by auto"], ["", "lemma Zp_x_is_UP_domain:\n\"UP_domain Zp\""], ["proof (prove)\ngoal (1 subgoal):\n 1. UP_domain Zp", "by (simp add: UP_domain_def domain_axioms)"], ["", "lemma Zp_x_domain:\n\"domain Zp_x \""], ["proof (prove)\ngoal (1 subgoal):\n 1. domain (UP Zp)", "by (simp add: UP_domain.UP_domain Zp_x_is_UP_domain)"], ["", "lemma pow_closed:\n  assumes \"a \\<in> carrier Zp\"\n  shows \"a[^](n::nat) \\<in> carrier Zp\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a [^] n \\<in> carrier Zp", "by (meson domain_axioms domain_def cring_def assms monoid.nat_pow_closed ring_def)"], ["", "lemma(in ring) pow_zero:\n  assumes \"(n::nat)>0\"\n  shows \"\\<zero>[^] n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero> [^] n = \\<zero>", "by (simp add: assms nat_pow_zero)"], ["", "lemma sum_closed:\n  assumes \"f \\<in> carrier Zp\"\n  assumes \"g \\<in> carrier Zp\"\n  shows \"f \\<oplus> g \\<in>  carrier Zp\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<oplus> g \\<in> carrier Zp", "by (simp add: assms(1) assms(2) cring.cring_simprules(1))"], ["", "lemma mult_zero:\n  assumes \"f \\<in> carrier Zp\"\n  shows \"f \\<otimes> \\<zero> = \\<zero>\"\n        \"\\<zero> \\<otimes> f = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<otimes> \\<zero> = \\<zero> &&& \\<zero> \\<otimes> f = \\<zero>", "apply (simp add: assms cring.cring_simprules(27))"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero> \\<otimes> f = \\<zero>", "by (simp add: assms cring.cring_simprules(26))"], ["", "lemma monom_poly_is_Zp_continuous:\n  assumes \"c \\<in> carrier Zp\"\n  assumes \"f = monom Zp_x c n\"\n  shows \"is_Zp_continuous (to_fun f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_Zp_continuous (to_fun f)", "using monomial_is_Zp_continuous assms monom_to_monomial"], ["proof (prove)\nusing this:\n  ?c \\<in> carrier Zp \\<Longrightarrow> is_Zp_continuous (monomial ?c ?n)\n  c \\<in> carrier Zp\n  f = monom (UP Zp) c n\n  ?a \\<in> carrier Zp \\<Longrightarrow>\n  to_fun (monom (UP Zp) ?a ?n) = monomial ?a ?n\n\ngoal (1 subgoal):\n 1. is_Zp_continuous (to_fun f)", "by auto"], ["", "lemma degree_0_is_Zp_continuous:\n  assumes \"f \\<in> carrier Zp_x\"\n  assumes \"degree f = 0\"\n  shows \"is_Zp_continuous (to_fun f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_Zp_continuous (to_fun f)", "using const_to_constant[of \"lcf f\"] assms constant_is_Zp_continuous ltrm_deg_0"], ["proof (prove)\nusing this:\n  f (deg Zp f) \\<in> carrier Zp \\<Longrightarrow>\n  to_fun (monom (UP Zp) (f (deg Zp f)) 0) =\n  \\<cc>\\<^bsub>Zp\\<^esub> (f (deg Zp f))\n  f \\<in> carrier (UP Zp)\n  deg Zp f = 0\n  ?a \\<in> carrier Zp \\<Longrightarrow>\n  is_Zp_continuous (\\<cc>\\<^bsub>Zp\\<^esub> ?a)\n  \\<lbrakk>?p \\<in> carrier (UP Zp); deg Zp ?p = 0\\<rbrakk>\n  \\<Longrightarrow> monom (UP Zp) (?p (deg Zp ?p)) (deg Zp ?p) = ?p\n\ngoal (1 subgoal):\n 1. is_Zp_continuous (to_fun f)", "by (simp add: cfs_closed)"], ["", "lemma UP_sum_is_Zp_continuous:\n  assumes \"a \\<in> carrier Zp_x\"\n  assumes \"b \\<in> carrier Zp_x\"\n  assumes \"is_Zp_continuous (to_fun a)\"\n  assumes \"is_Zp_continuous (to_fun b)\"\n  shows \"is_Zp_continuous (to_fun (a \\<oplus>\\<^bsub>Zp_x\\<^esub> b))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_Zp_continuous (to_fun (a \\<oplus>\\<^bsub>UP Zp\\<^esub> b))", "using sum_of_cont_is_cont assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>is_Zp_continuous ?f; is_Zp_continuous ?g\\<rbrakk>\n  \\<Longrightarrow> is_Zp_continuous\n                     (?f \\<oplus>\\<^bsub>function_ring (carrier Zp) Zp\\<^esub>\n                      ?g)\n  a \\<in> carrier (UP Zp)\n  b \\<in> carrier (UP Zp)\n  is_Zp_continuous (to_fun a)\n  is_Zp_continuous (to_fun b)\n\ngoal (1 subgoal):\n 1. is_Zp_continuous (to_fun (a \\<oplus>\\<^bsub>UP Zp\\<^esub> b))", "by (simp add: to_fun_Fun_add)"], ["", "lemma polynomial_is_Zp_continuous:\n  assumes \"f \\<in> carrier Zp_x\"\n  shows \"is_Zp_continuous (to_fun f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_Zp_continuous (to_fun f)", "apply(rule poly_induct3)"], ["proof (prove)\ngoal (3 subgoals):\n 1. f \\<in> carrier (UP Zp)\n 2. \\<And>p q.\n       \\<lbrakk>q \\<in> carrier (UP Zp); p \\<in> carrier (UP Zp);\n        is_Zp_continuous (to_fun p); is_Zp_continuous (to_fun q)\\<rbrakk>\n       \\<Longrightarrow> is_Zp_continuous\n                          (to_fun (p \\<oplus>\\<^bsub>UP Zp\\<^esub> q))\n 3. \\<And>a n.\n       a \\<in> carrier Zp \\<Longrightarrow>\n       is_Zp_continuous (to_fun (monom (UP Zp) a n))", "apply (simp add: assms)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>p q.\n       \\<lbrakk>q \\<in> carrier (UP Zp); p \\<in> carrier (UP Zp);\n        is_Zp_continuous (to_fun p); is_Zp_continuous (to_fun q)\\<rbrakk>\n       \\<Longrightarrow> is_Zp_continuous\n                          (to_fun (p \\<oplus>\\<^bsub>UP Zp\\<^esub> q))\n 2. \\<And>a n.\n       a \\<in> carrier Zp \\<Longrightarrow>\n       is_Zp_continuous (to_fun (monom (UP Zp) a n))", "using UP_sum_is_Zp_continuous"], ["proof (prove)\nusing this:\n  \\<lbrakk>?a \\<in> carrier (UP Zp); ?b \\<in> carrier (UP Zp);\n   is_Zp_continuous (to_fun ?a); is_Zp_continuous (to_fun ?b)\\<rbrakk>\n  \\<Longrightarrow> is_Zp_continuous\n                     (to_fun (?a \\<oplus>\\<^bsub>UP Zp\\<^esub> ?b))\n\ngoal (2 subgoals):\n 1. \\<And>p q.\n       \\<lbrakk>q \\<in> carrier (UP Zp); p \\<in> carrier (UP Zp);\n        is_Zp_continuous (to_fun p); is_Zp_continuous (to_fun q)\\<rbrakk>\n       \\<Longrightarrow> is_Zp_continuous\n                          (to_fun (p \\<oplus>\\<^bsub>UP Zp\\<^esub> q))\n 2. \\<And>a n.\n       a \\<in> carrier Zp \\<Longrightarrow>\n       is_Zp_continuous (to_fun (monom (UP Zp) a n))", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a n.\n       a \\<in> carrier Zp \\<Longrightarrow>\n       is_Zp_continuous (to_fun (monom (UP Zp) a n))", "using monom_poly_is_Zp_continuous"], ["proof (prove)\nusing this:\n  \\<lbrakk>?c \\<in> carrier Zp; ?f = monom (UP Zp) ?c ?n\\<rbrakk>\n  \\<Longrightarrow> is_Zp_continuous (to_fun ?f)\n\ngoal (1 subgoal):\n 1. \\<And>a n.\n       a \\<in> carrier Zp \\<Longrightarrow>\n       is_Zp_continuous (to_fun (monom (UP Zp) a n))", "by blast"], ["", "end"], ["", "text\\<open>Notation for polynomial function application\\<close>"], ["", "context padic_integers\nbegin"], ["", "notation to_fun (infixl\\<open>\\<bullet>\\<close> 70)"], ["", "text\\<open>Evaluating polynomials in the residue rings\\<close>"], ["", "lemma res_to_fun_monic_monom:\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"a k = b k\"\n  shows \"(monom Zp_x \\<one> n \\<bullet> a) k = (monom Zp_x \\<one> n \\<bullet> b) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> n \\<bullet> a) k =\n    (monom (UP Zp) \\<one> n \\<bullet> b) k", "proof(induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. (monom (UP Zp) \\<one> 0 \\<bullet> a) k =\n    (monom (UP Zp) \\<one> 0 \\<bullet> b) k\n 2. \\<And>n.\n       (monom (UP Zp) \\<one> n \\<bullet> a) k =\n       (monom (UP Zp) \\<one> n \\<bullet> b) k \\<Longrightarrow>\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "case 0"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. (monom (UP Zp) \\<one> 0 \\<bullet> a) k =\n    (monom (UP Zp) \\<one> 0 \\<bullet> b) k\n 2. \\<And>n.\n       (monom (UP Zp) \\<one> n \\<bullet> a) k =\n       (monom (UP Zp) \\<one> n \\<bullet> b) k \\<Longrightarrow>\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> 0 \\<bullet> a) k =\n    (monom (UP Zp) \\<one> 0 \\<bullet> b) k", "using UP_cring.to_fun_X_pow Zp_x_is_UP_domain assms(1) assms(2) nat_pow_0 to_fun_one monom_one"], ["proof (prove)\nusing this:\n  \\<lbrakk>UP_cring ?R; ?x \\<in> carrier ?R\\<rbrakk>\n  \\<Longrightarrow> UP_cring.to_fun ?R\n                     (X_poly ?R [^]\\<^bsub>UP ?R\\<^esub> ?n) ?x =\n                    ?x [^]\\<^bsub>?R\\<^esub> ?n\n  UP_domain Zp\n  a \\<in> carrier Zp\n  b \\<in> carrier Zp\n  ?x [^]\\<^bsub>function_ring (carrier Zp) Zp\\<^esub> 0 =\n  \\<one>\\<^bsub>function_ring (carrier Zp) Zp\\<^esub>\n  ?a \\<in> carrier Zp \\<Longrightarrow>\n  \\<one>\\<^bsub>UP Zp\\<^esub> \\<bullet> ?a = \\<one>\n  monom (UP Zp) \\<one> 0 = \\<one>\\<^bsub>UP Zp\\<^esub>\n\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> 0 \\<bullet> a) k =\n    (monom (UP Zp) \\<one> 0 \\<bullet> b) k", "by presburger"], ["proof (state)\nthis:\n  (monom (UP Zp) \\<one> 0 \\<bullet> a) k =\n  (monom (UP Zp) \\<one> 0 \\<bullet> b) k\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (monom (UP Zp) \\<one> n \\<bullet> a) k =\n       (monom (UP Zp) \\<one> n \\<bullet> b) k \\<Longrightarrow>\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (monom (UP Zp) \\<one> n \\<bullet> a) k =\n       (monom (UP Zp) \\<one> n \\<bullet> b) k \\<Longrightarrow>\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "case (Suc n)"], ["proof (state)\nthis:\n  (monom (UP Zp) \\<one> n \\<bullet> a) k =\n  (monom (UP Zp) \\<one> n \\<bullet> b) k\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (monom (UP Zp) \\<one> n \\<bullet> a) k =\n       (monom (UP Zp) \\<one> n \\<bullet> b) k \\<Longrightarrow>\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "fix n::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (monom (UP Zp) \\<one> n \\<bullet> a) k =\n       (monom (UP Zp) \\<one> n \\<bullet> b) k \\<Longrightarrow>\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "assume IH: \"to_fun (monom Zp_x \\<one> n) a k = to_fun (monom Zp_x \\<one> n) b k\""], ["proof (state)\nthis:\n  (monom (UP Zp) \\<one> n \\<bullet> a) k =\n  (monom (UP Zp) \\<one> n \\<bullet> b) k\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (monom (UP Zp) \\<one> n \\<bullet> a) k =\n       (monom (UP Zp) \\<one> n \\<bullet> b) k \\<Longrightarrow>\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n       (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "show \"to_fun (monom Zp_x \\<one> (Suc n)) a k = to_fun (monom Zp_x \\<one> (Suc n)) b k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n    (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n    (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "have LHS0: \"(monom Zp_x \\<one> (Suc n) \\<bullet> a) k = ((monom Zp_x \\<one> n \\<bullet> a) \\<otimes> (X \\<bullet> a)) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n    (monom (UP Zp) \\<one> n \\<bullet> a \\<otimes> (X_poly Zp \\<bullet> a)) k", "by (simp add: UP_cring.to_fun_monic_monom Zp_x_is_UP_cring assms(1))"], ["proof (state)\nthis:\n  (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n  (monom (UP Zp) \\<one> n \\<bullet> a \\<otimes> (X_poly Zp \\<bullet> a)) k\n\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n    (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "then"], ["proof (chain)\npicking this:\n  (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n  (monom (UP Zp) \\<one> n \\<bullet> a \\<otimes> (X_poly Zp \\<bullet> a)) k", "show ?thesis"], ["proof (prove)\nusing this:\n  (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n  (monom (UP Zp) \\<one> n \\<bullet> a \\<otimes> (X_poly Zp \\<bullet> a)) k\n\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n    (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "using assms IH  Zp_x_is_UP_domain\n          Zp_continuous_is_Zp_closed"], ["proof (prove)\nusing this:\n  (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n  (monom (UP Zp) \\<one> n \\<bullet> a \\<otimes> (X_poly Zp \\<bullet> a)) k\n  a \\<in> carrier Zp\n  b \\<in> carrier Zp\n  a k = b k\n  (monom (UP Zp) \\<one> n \\<bullet> a) k =\n  (monom (UP Zp) \\<one> n \\<bullet> b) k\n  UP_domain Zp\n  is_Zp_continuous ?f \\<Longrightarrow>\n  ?f \\<in> carrier (function_ring (carrier Zp) Zp)\n\ngoal (1 subgoal):\n 1. (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n    (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k", "by (metis (mono_tags, lifting) R.one_closed X_poly_def monom_closed monom_one_Suc \n          residue_of_prod to_fun_X to_fun_mult)"], ["proof (state)\nthis:\n  (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n  (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (monom (UP Zp) \\<one> (Suc n) \\<bullet> a) k =\n  (monom (UP Zp) \\<one> (Suc n) \\<bullet> b) k\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma res_to_fun_monom:\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"c \\<in> carrier Zp\"\n  assumes \"a k = b k\"\n  shows \"(monom Zp_x c n \\<bullet> a) k = (monom Zp_x c n \\<bullet> b) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (monom (UP Zp) c n \\<bullet> a) k = (monom (UP Zp) c n \\<bullet> b) k", "using res_to_fun_monic_monom assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>?a \\<in> carrier Zp; ?b \\<in> carrier Zp; ?a ?k = ?b ?k\\<rbrakk>\n  \\<Longrightarrow> (monom (UP Zp) \\<one> ?n \\<bullet> ?a) ?k =\n                    (monom (UP Zp) \\<one> ?n \\<bullet> ?b) ?k\n  a \\<in> carrier Zp\n  b \\<in> carrier Zp\n  c \\<in> carrier Zp\n  a k = b k\n\ngoal (1 subgoal):\n 1. (monom (UP Zp) c n \\<bullet> a) k = (monom (UP Zp) c n \\<bullet> b) k", "by (smt to_fun_monic_monom to_fun_monom residue_of_prod)"], ["", "lemma to_fun_res_ltrm: \n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"f \\<in> carrier Zp_x\"\n  assumes \"a k = b k\"\n  shows \"((ltrm f)\\<bullet>a) k = ((ltrm f)\\<bullet>b) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (monom (UP Zp) (f (deg Zp f)) (deg Zp f) \\<bullet> a) k =\n    (monom (UP Zp) (f (deg Zp f)) (deg Zp f) \\<bullet> b) k", "by (simp add: lcf_closed assms(1) assms(2) assms(3) assms(4) res_to_fun_monom)"], ["", "text\\<open>Polynomial application commutes with taking residues\\<close>"], ["", "lemma to_fun_res:\n  assumes \"f \\<in> carrier Zp_x\"\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"a k = b k\"\n  shows \"(f\\<bullet>a) k = (f\\<bullet>b) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<bullet> a) k = (f \\<bullet> b) k", "apply(rule poly_induct3[of f])"], ["proof (prove)\ngoal (3 subgoals):\n 1. f \\<in> carrier (UP Zp)\n 2. \\<And>p q.\n       \\<lbrakk>q \\<in> carrier (UP Zp); p \\<in> carrier (UP Zp);\n        (p \\<bullet> a) k = (p \\<bullet> b) k;\n        (q \\<bullet> a) k = (q \\<bullet> b) k\\<rbrakk>\n       \\<Longrightarrow> ((p \\<oplus>\\<^bsub>UP Zp\\<^esub> q) \\<bullet> a)\n                          k =\n                         ((p \\<oplus>\\<^bsub>UP Zp\\<^esub> q) \\<bullet> b) k\n 3. \\<And>aa n.\n       aa \\<in> carrier Zp \\<Longrightarrow>\n       (monom (UP Zp) aa n \\<bullet> a) k =\n       (monom (UP Zp) aa n \\<bullet> b) k", "apply (simp add: assms(1))"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>p q.\n       \\<lbrakk>q \\<in> carrier (UP Zp); p \\<in> carrier (UP Zp);\n        (p \\<bullet> a) k = (p \\<bullet> b) k;\n        (q \\<bullet> a) k = (q \\<bullet> b) k\\<rbrakk>\n       \\<Longrightarrow> ((p \\<oplus>\\<^bsub>UP Zp\\<^esub> q) \\<bullet> a)\n                          k =\n                         ((p \\<oplus>\\<^bsub>UP Zp\\<^esub> q) \\<bullet> b) k\n 2. \\<And>aa n.\n       aa \\<in> carrier Zp \\<Longrightarrow>\n       (monom (UP Zp) aa n \\<bullet> a) k =\n       (monom (UP Zp) aa n \\<bullet> b) k", "using assms(2) assms(3) to_fun_plus residue_of_sum"], ["proof (prove)\nusing this:\n  a \\<in> carrier Zp\n  b \\<in> carrier Zp\n  \\<lbrakk>?g \\<in> carrier (UP Zp); ?f \\<in> carrier (UP Zp);\n   ?x \\<in> carrier Zp\\<rbrakk>\n  \\<Longrightarrow> (?f \\<oplus>\\<^bsub>UP Zp\\<^esub> ?g) \\<bullet> ?x =\n                    ?f \\<bullet> ?x \\<oplus> ?g \\<bullet> ?x\n  (?a \\<oplus> ?b) ?k =\n  ?a ?k \\<oplus>\\<^bsub>residue_ring (p ^ ?k)\\<^esub> ?b ?k\n\ngoal (2 subgoals):\n 1. \\<And>p q.\n       \\<lbrakk>q \\<in> carrier (UP Zp); p \\<in> carrier (UP Zp);\n        (p \\<bullet> a) k = (p \\<bullet> b) k;\n        (q \\<bullet> a) k = (q \\<bullet> b) k\\<rbrakk>\n       \\<Longrightarrow> ((p \\<oplus>\\<^bsub>UP Zp\\<^esub> q) \\<bullet> a)\n                          k =\n                         ((p \\<oplus>\\<^bsub>UP Zp\\<^esub> q) \\<bullet> b) k\n 2. \\<And>aa n.\n       aa \\<in> carrier Zp \\<Longrightarrow>\n       (monom (UP Zp) aa n \\<bullet> a) k =\n       (monom (UP Zp) aa n \\<bullet> b) k", "apply presburger"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa n.\n       aa \\<in> carrier Zp \\<Longrightarrow>\n       (monom (UP Zp) aa n \\<bullet> a) k =\n       (monom (UP Zp) aa n \\<bullet> b) k", "using assms(2) assms(3) assms(4) res_to_fun_monom"], ["proof (prove)\nusing this:\n  a \\<in> carrier Zp\n  b \\<in> carrier Zp\n  a k = b k\n  \\<lbrakk>?a \\<in> carrier Zp; ?b \\<in> carrier Zp; ?c \\<in> carrier Zp;\n   ?a ?k = ?b ?k\\<rbrakk>\n  \\<Longrightarrow> (monom (UP Zp) ?c ?n \\<bullet> ?a) ?k =\n                    (monom (UP Zp) ?c ?n \\<bullet> ?b) ?k\n\ngoal (1 subgoal):\n 1. \\<And>aa n.\n       aa \\<in> carrier Zp \\<Longrightarrow>\n       (monom (UP Zp) aa n \\<bullet> a) k =\n       (monom (UP Zp) aa n \\<bullet> b) k", "by blast"], ["", "text\\<open>If a and b have equal kth residues, then so do f'(a) and f'(b)\\<close>"], ["", "lemma deriv_res:\n  assumes \"f \\<in> carrier Zp_x\"\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"b \\<in> carrier Zp\"\n  assumes \"a k = b k\"\n  shows \"(deriv f a) k = (deriv f b) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv f a k = deriv f b k", "using assms to_fun_res[of \"pderiv f\" a b k]"], ["proof (prove)\nusing this:\n  f \\<in> carrier (UP Zp)\n  a \\<in> carrier Zp\n  b \\<in> carrier Zp\n  a k = b k\n  \\<lbrakk>pderiv f \\<in> carrier (UP Zp); a \\<in> carrier Zp;\n   b \\<in> carrier Zp; a k = b k\\<rbrakk>\n  \\<Longrightarrow> (pderiv f \\<bullet> a) k = (pderiv f \\<bullet> b) k\n\ngoal (1 subgoal):\n 1. deriv f a k = deriv f b k", "by (simp add: pderiv_closed pderiv_eval_deriv)"], ["", "text\\<open>Propositions about evaluation:\\<close>"], ["", "lemma to_fun_monom_plus:\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"g \\<in> carrier Zp_x\"\n  assumes \"c \\<in> carrier Zp\"\n  shows \"(monom Zp_x a n \\<oplus>\\<^bsub>Zp_x\\<^esub> g)\\<bullet>c = a \\<otimes> c[^]n \\<oplus> (g \\<bullet> c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (monom (UP Zp) a n \\<oplus>\\<^bsub>UP Zp\\<^esub> g) \\<bullet> c =\n    a \\<otimes> c [^] n \\<oplus> g \\<bullet> c", "by (simp add: assms(1) assms(2) assms(3) to_fun_monom to_fun_plus)"], ["", "lemma to_fun_monom_minus:\n  assumes \"a \\<in> carrier Zp\"\n  assumes \"g \\<in> carrier Zp_x\"\n  assumes \"c \\<in> carrier Zp\"\n  shows \"(monom Zp_x a n \\<ominus>\\<^bsub>Zp_x\\<^esub> g)\\<bullet>c = a \\<otimes> c[^]n \\<ominus> (g \\<bullet> c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (monom (UP Zp) a n \\<ominus>\\<^bsub>UP Zp\\<^esub> g) \\<bullet> c =\n    a \\<otimes> c [^] n \\<ominus> g \\<bullet> c", "by (simp add: UP_cring.to_fun_diff Zp_x_is_UP_cring assms(1) assms(2) assms(3) to_fun_monom)"], ["", "end"], ["", "end"]]}