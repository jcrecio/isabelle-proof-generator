{"file_name": "/home/qj213/afp-2021-10-22/thys/Timed_Automata/Timed_Automata.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Timed_Automata", "problem_names": ["lemma non_trivial_neg: \"\\<exists> x. x < 0\"", "lemma step_t_determinacy1:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle> \\<Longrightarrow>  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l'',u''\\<rangle> \\<Longrightarrow> l' = l''\"", "lemma step_t_determinacy2:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle> \\<Longrightarrow>  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l'',u''\\<rangle> \\<Longrightarrow> u' = u''\"", "lemma step_t_cont1:\n  \"d \\<ge> 0 \\<Longrightarrow> e \\<ge> 0 \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle> \\<Longrightarrow> A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'',u''\\<rangle>\n  \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d+e\\<^esup> \\<langle>l'',u''\\<rangle>\"", "lemma step_z_sound:\n  \"A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l',Z'\\<rangle> \\<Longrightarrow> (\\<forall> u' \\<in> Z'. \\<exists> u \\<in> Z.  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>)\"", "lemma step_z_complete:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l', u'\\<rangle> \\<Longrightarrow> u \\<in> Z \\<Longrightarrow> \\<exists> Z'. A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and> u' \\<in> Z'\"", "lemma step_z_complete1:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l', u'\\<rangle> \\<Longrightarrow> \\<exists> Z. A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and> u' \\<in> Z\"", "lemma step_z_complete2:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l', u'\\<rangle> \\<Longrightarrow> \\<exists> Z. A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and> u' \\<in> Z\"", "lemma steps_z_sound:\n  \"A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l', Z'\\<rangle> \\<Longrightarrow> u' \\<in> Z' \\<Longrightarrow> \\<exists> u \\<in> Z. A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l', u'\\<rangle>\"", "lemma steps_z_complete:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l', u'\\<rangle> \\<Longrightarrow> u \\<in> Z \\<Longrightarrow> \\<exists> Z'. A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l', Z'\\<rangle> \\<and> u' \\<in> Z'\""], "translations": [["", "lemma non_trivial_neg: \"\\<exists> x. x < 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x. x < (0::'a)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>x. x < (0::'a)", "from non_trivial"], ["proof (chain)\npicking this:\n  \\<exists>x. x \\<noteq> (0::'a)", "obtain x where \"x \\<noteq> 0\""], ["proof (prove)\nusing this:\n  \\<exists>x. x \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. (\\<And>x. x \\<noteq> (0::'a) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. \\<exists>x. x < (0::'a)", "then"], ["proof (chain)\npicking this:\n  x \\<noteq> (0::'a)", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. \\<exists>x. x < (0::'a)", "proof (cases \"x < 0\", auto, goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> x < (0::'a); x \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x < (0::'a)", "case 1"], ["proof (state)\nthis:\n  \\<not> x < (0::'a)\n  x \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> x < (0::'a); x \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x < (0::'a)", "then"], ["proof (chain)\npicking this:\n  \\<not> x < (0::'a)\n  x \\<noteq> (0::'a)", "have \"x > 0\""], ["proof (prove)\nusing this:\n  \\<not> x < (0::'a)\n  x \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. (0::'a) < x", "by auto"], ["proof (state)\nthis:\n  (0::'a) < x\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> x < (0::'a); x \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x < (0::'a)", "then"], ["proof (chain)\npicking this:\n  (0::'a) < x", "have \"(-x) < 0\""], ["proof (prove)\nusing this:\n  (0::'a) < x\n\ngoal (1 subgoal):\n 1. - x < (0::'a)", "by auto"], ["proof (state)\nthis:\n  - x < (0::'a)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> x < (0::'a); x \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x < (0::'a)", "then"], ["proof (chain)\npicking this:\n  - x < (0::'a)", "show ?case"], ["proof (prove)\nusing this:\n  - x < (0::'a)\n\ngoal (1 subgoal):\n 1. \\<exists>x. x < (0::'a)", "by blast"], ["proof (state)\nthis:\n  \\<exists>x. x < (0::'a)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>x. x < (0::'a)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "datatype ('c, 't :: time) cconstraint =\n  AND \"('c, 't) cconstraint\" \"('c, 't) cconstraint\" |\n  LT 'c 't |\n  LE 'c 't |\n  EQ 'c 't |\n  GT 'c 't |\n  GE 'c 't"], ["", "section \\<open>Syntactic Definition\\<close>"], ["", "text \\<open>\n  For an informal description of timed automata we refer to Bengtsson and Yi \\cite{BengtssonY03}.\n  We define a timed automaton \\<open>A\\<close>\n\\<close>"], ["", "type_synonym\n  ('c, 'time, 's) invassn = \"'s \\<Rightarrow> ('c, 'time) cconstraint\""], ["", "type_synonym\n  ('a, 'c, 'time, 's) transition = \"'s * ('c, 'time) cconstraint * 'a * 'c list * 's\""], ["", "type_synonym\n  ('a, 'c, 'time, 's) ta = \"('a, 'c, 'time, 's) transition set * ('c, 'time, 's) invassn\""], ["", "definition trans_of :: \"('a, 'c, 'time, 's) ta \\<Rightarrow> ('a, 'c, 'time, 's) transition set\" where\n  \"trans_of \\<equiv> fst\""], ["", "definition inv_of  :: \"('a, 'c, 'time, 's) ta \\<Rightarrow> ('c, 'time, 's) invassn\" where\n  \"inv_of \\<equiv> snd\""], ["", "abbreviation transition ::\n  \"('a, 'c, 'time, 's) ta \\<Rightarrow> 's \\<Rightarrow> ('c, 'time) cconstraint \\<Rightarrow> 'a \\<Rightarrow> 'c list \\<Rightarrow> 's \\<Rightarrow> bool\"\n(\"_ \\<turnstile> _ \\<longrightarrow>\\<^bsup>_,_,_\\<^esup> _\" [61,61,61,61,61,61] 61) where\n  \"(A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l') \\<equiv> (l,g,a,r,l') \\<in> trans_of A\""], ["", "subsection \\<open>Collecting Information About Clocks\\<close>"], ["", "fun collect_clks :: \"('c, 't :: time) cconstraint \\<Rightarrow> 'c set\"\nwhere\n  \"collect_clks (AND cc1 cc2) = collect_clks cc1 \\<union> collect_clks cc2\" |\n  \"collect_clks (LT c _) = {c}\" |\n  \"collect_clks (LE c _) = {c}\" |\n  \"collect_clks (EQ c _) = {c}\" |\n  \"collect_clks (GE c _) = {c}\" |\n  \"collect_clks (GT c _) = {c}\""], ["", "fun collect_clock_pairs :: \"('c, 't :: time) cconstraint \\<Rightarrow> ('c * 't) set\"\nwhere\n  \"collect_clock_pairs (LT x m) = {(x, m)}\" |\n  \"collect_clock_pairs (LE x m) = {(x, m)}\" |\n  \"collect_clock_pairs (EQ x m) = {(x, m)}\" |\n  \"collect_clock_pairs (GE x m) = {(x, m)}\" |\n  \"collect_clock_pairs (GT x m) = {(x, m)}\" |\n  \"collect_clock_pairs (AND cc1 cc2) = (collect_clock_pairs cc1 \\<union> collect_clock_pairs cc2)\""], ["", "definition collect_clkt :: \"('a, 'c, 't::time, 's) transition set \\<Rightarrow> ('c *'t) set\"\nwhere\n  \"collect_clkt S = \\<Union> {collect_clock_pairs (fst (snd t)) | t . t \\<in> S}\""], ["", "definition collect_clki :: \"('c, 't :: time, 's) invassn \\<Rightarrow> ('c *'t) set\"\nwhere\n  \"collect_clki I = \\<Union> {collect_clock_pairs (I x) | x. True}\""], ["", "definition clkp_set :: \"('a, 'c, 't :: time, 's) ta \\<Rightarrow> ('c *'t) set\"\nwhere\n  \"clkp_set A = collect_clki (inv_of A) \\<union> collect_clkt (trans_of A)\""], ["", "definition collect_clkvt :: \"('a, 'c, 't::time, 's) transition set \\<Rightarrow> 'c set\"\nwhere\n  \"collect_clkvt S = \\<Union> {set ((fst o snd o snd o snd) t) | t . t \\<in> S}\""], ["", "abbreviation clk_set where \"clk_set A \\<equiv> fst ` clkp_set A \\<union> collect_clkvt (trans_of A)\""], ["", "(* We don not need this here but most other theories will make use of this predicate *)"], ["", "inductive valid_abstraction\nwhere\n  \"\\<lbrakk>\\<forall>(x,m) \\<in> clkp_set A. m \\<le> k x \\<and> x \\<in> X \\<and> m \\<in> \\<nat>; collect_clkvt (trans_of A) \\<subseteq> X; finite X\\<rbrakk>\n  \\<Longrightarrow> valid_abstraction A X k\""], ["", "section \\<open>Operational Semantics\\<close>"], ["", "type_synonym ('c, 't) cval = \"'c \\<Rightarrow> 't\""], ["", "definition cval_add :: \"('c,'t) cval \\<Rightarrow> 't::time \\<Rightarrow> ('c,'t) cval\" (infixr \"\\<oplus>\" 64)\nwhere\n  \"u \\<oplus> d = (\\<lambda> x. u x + d)\""], ["", "inductive clock_val :: \"('c, 't) cval \\<Rightarrow> ('c, 't::time) cconstraint \\<Rightarrow> bool\" (\"_ \\<turnstile> _\" [62, 62] 62)\nwhere\n  \"\\<lbrakk>u \\<turnstile> cc1; u \\<turnstile> cc2\\<rbrakk> \\<Longrightarrow> u \\<turnstile> AND cc1 cc2\" |\n  \"\\<lbrakk>u c < d\\<rbrakk> \\<Longrightarrow> u \\<turnstile> LT c d\" |\n  \"\\<lbrakk>u c \\<le> d\\<rbrakk> \\<Longrightarrow> u \\<turnstile> LE c d\" |\n  \"\\<lbrakk>u c = d\\<rbrakk> \\<Longrightarrow> u \\<turnstile> EQ c d\" |\n  \"\\<lbrakk>u c \\<ge> d\\<rbrakk> \\<Longrightarrow> u \\<turnstile> GE c d\" |\n  \"\\<lbrakk>u c > d\\<rbrakk> \\<Longrightarrow> u \\<turnstile> GT c d\""], ["", "declare clock_val.intros[intro]"], ["", "inductive_cases[elim!]: \"u \\<turnstile> AND cc1 cc2\""], ["", "inductive_cases[elim!]: \"u \\<turnstile> LT c d\""], ["", "inductive_cases[elim!]: \"u \\<turnstile> LE c d\""], ["", "inductive_cases[elim!]: \"u \\<turnstile> EQ c d\""], ["", "inductive_cases[elim!]: \"u \\<turnstile> GE c d\""], ["", "inductive_cases[elim!]: \"u \\<turnstile> GT c d\""], ["", "fun clock_set :: \"'c list \\<Rightarrow> 't::time \\<Rightarrow> ('c,'t) cval \\<Rightarrow> ('c,'t) cval\"\nwhere\n  \"clock_set [] _ u = u\" |\n  \"clock_set (c#cs) t u = (clock_set cs t u)(c:=t)\""], ["", "abbreviation clock_set_abbrv :: \"'c list \\<Rightarrow> 't::time \\<Rightarrow> ('c,'t) cval \\<Rightarrow> ('c,'t) cval\"\n(\"[_\\<rightarrow>_]_\" [65,65,65] 65)\nwhere\n  \"[r \\<rightarrow> t]u \\<equiv> clock_set r t u\""], ["", "inductive step_t ::\n  \"('a, 'c, 't, 's) ta \\<Rightarrow> 's \\<Rightarrow> ('c, 't) cval \\<Rightarrow> ('t::time) \\<Rightarrow> 's \\<Rightarrow> ('c, 't) cval \\<Rightarrow> bool\"\n(\"_ \\<turnstile> \\<langle>_, _\\<rangle> \\<rightarrow>\\<^bsup>_\\<^esup> \\<langle>_, _\\<rangle>\" [61,61,61] 61)                      \nwhere\n  \"\\<lbrakk>u \\<turnstile> inv_of A l; u \\<oplus> d \\<turnstile> inv_of A l; d \\<ge> 0\\<rbrakk> \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l, u \\<oplus> d\\<rangle>\""], ["", "declare step_t.intros[intro!]"], ["", "inductive_cases[elim!]: \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle>\""], ["", "lemma step_t_determinacy1:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle> \\<Longrightarrow>  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l'',u''\\<rangle> \\<Longrightarrow> l' = l''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l'', u''\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> l' = l''", "by auto"], ["", "lemma step_t_determinacy2:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle> \\<Longrightarrow>  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l'',u''\\<rangle> \\<Longrightarrow> u' = u''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l'', u''\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> u' = u''", "by auto"], ["", "lemma step_t_cont1:\n  \"d \\<ge> 0 \\<Longrightarrow> e \\<ge> 0 \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle> \\<Longrightarrow> A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'',u''\\<rangle>\n  \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d+e\\<^esup> \\<langle>l'',u''\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(0::'a) \\<le> d; (0::'a) \\<le> e;\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n     A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d +\n     e\\<^esup> \\<langle>l'', u''\\<rangle>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>(0::'a) \\<le> d; (0::'a) \\<le> e;\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n     A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d +\n     e\\<^esup> \\<langle>l'', u''\\<rangle>", "assume A: \"d \\<ge> 0\" \"e \\<ge> 0\" \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle>\" \"A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'',u''\\<rangle>\""], ["proof (state)\nthis:\n  (0::'a) \\<le> d\n  (0::'a) \\<le> e\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>\n  A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(0::'a) \\<le> d; (0::'a) \\<le> e;\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n     A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d +\n     e\\<^esup> \\<langle>l'', u''\\<rangle>", "hence \"u' = (u \\<oplus> d)\" \"u'' = (u' \\<oplus> e)\""], ["proof (prove)\nusing this:\n  (0::'a) \\<le> d\n  (0::'a) \\<le> e\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>\n  A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\n\ngoal (1 subgoal):\n 1. u' = u \\<oplus> d &&& u'' = u' \\<oplus> e", "by auto"], ["proof (state)\nthis:\n  u' = u \\<oplus> d\n  u'' = u' \\<oplus> e\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(0::'a) \\<le> d; (0::'a) \\<le> e;\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n     A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d +\n     e\\<^esup> \\<langle>l'', u''\\<rangle>", "hence \"u'' = (u \\<oplus> (d + e))\""], ["proof (prove)\nusing this:\n  u' = u \\<oplus> d\n  u'' = u' \\<oplus> e\n\ngoal (1 subgoal):\n 1. u'' = u \\<oplus> d + e", "unfolding cval_add_def"], ["proof (prove)\nusing this:\n  u' = (\\<lambda>x. u x + d)\n  u'' = (\\<lambda>x. u' x + e)\n\ngoal (1 subgoal):\n 1. u'' = (\\<lambda>x. u x + (d + e))", "by auto"], ["proof (state)\nthis:\n  u'' = u \\<oplus> d + e\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(0::'a) \\<le> d; (0::'a) \\<le> e;\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n     A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d +\n     e\\<^esup> \\<langle>l'', u''\\<rangle>", "with A"], ["proof (chain)\npicking this:\n  (0::'a) \\<le> d\n  (0::'a) \\<le> e\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>\n  A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\n  u'' = u \\<oplus> d + e", "show ?thesis"], ["proof (prove)\nusing this:\n  (0::'a) \\<le> d\n  (0::'a) \\<le> e\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>\n  A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>\\<^bsup>e\\<^esup> \\<langle>l'', u''\\<rangle>\n  u'' = u \\<oplus> d + e\n\ngoal (1 subgoal):\n 1. A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d +\n                         e\\<^esup> \\<langle>l'', u''\\<rangle>", "by auto"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d +\n                       e\\<^esup> \\<langle>l'', u''\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["", "inductive step_a ::\n  \"('a, 'c, 't, 's) ta \\<Rightarrow> 's \\<Rightarrow> ('c, ('t::time)) cval \\<Rightarrow> 'a \\<Rightarrow> 's \\<Rightarrow> ('c, 't) cval \\<Rightarrow> bool\"\n(\"_ \\<turnstile> \\<langle>_, _\\<rangle> \\<rightarrow>\\<^bsub>_\\<^esub> \\<langle>_, _\\<rangle>\" [61,61,61] 61)\nwhere\n  \"\\<lbrakk>A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'; u \\<turnstile> g; u' \\<turnstile> inv_of A l'; u' = [r \\<rightarrow> 0]u\\<rbrakk> \\<Longrightarrow> (A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>)\""], ["", "inductive step ::\n  \"('a, 'c, 't, 's) ta \\<Rightarrow> 's \\<Rightarrow> ('c, ('t::time)) cval \\<Rightarrow> 's \\<Rightarrow> ('c, 't) cval \\<Rightarrow> bool\"\n(\"_ \\<turnstile> \\<langle>_, _\\<rangle> \\<rightarrow> \\<langle>_,_\\<rangle>\" [61,61,61] 61)\nwhere\n  step_a: \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l',u'\\<rangle> \\<Longrightarrow> (A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>)\" |\n  step_t: \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l',u'\\<rangle> \\<Longrightarrow> (A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>)\""], ["", "inductive_cases[elim!]: \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>\""], ["", "declare step.intros[intro]"], ["", "inductive\n  steps :: \"('a, 'c, 't, 's) ta \\<Rightarrow> 's \\<Rightarrow> ('c, ('t::time)) cval \\<Rightarrow> 's \\<Rightarrow> ('c, 't) cval \\<Rightarrow> bool\"\n(\"_ \\<turnstile> \\<langle>_, _\\<rangle> \\<rightarrow>* \\<langle>_, _\\<rangle>\" [61,61,61] 61)\nwhere\n  refl: \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l, u\\<rangle>\" |\n  step: \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l', u'\\<rangle> \\<Longrightarrow> A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle> \\<Longrightarrow> A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>\""], ["", "declare steps.intros[intro]"], ["", "section \\<open>Zone Semantics\\<close>"], ["", "type_synonym ('c, 't) zone = \"('c, 't) cval set\""], ["", "definition zone_delay :: \"('c, ('t::time)) zone \\<Rightarrow> ('c, 't) zone\"\n(\"_\\<^sup>\\<up>\" [71] 71)\nwhere\n  \"Z\\<^sup>\\<up> = {u \\<oplus> d|u d. u \\<in> Z \\<and> d \\<ge> (0::'t)}\""], ["", "definition zone_set :: \"('c, 't::time) zone \\<Rightarrow> 'c list \\<Rightarrow> ('c, 't) zone\"\n(\"_\\<^bsub>_ \\<rightarrow> 0\\<^esub>\" [71] 71)\nwhere\n  \"zone_set Z r = {[r \\<rightarrow> (0::'t)]u | u . u \\<in> Z}\""], ["", "inductive step_z ::\n  \"('a, 'c, 't, 's) ta \\<Rightarrow> 's \\<Rightarrow> ('c, ('t::time)) zone \\<Rightarrow> 's \\<Rightarrow> ('c, 't) zone \\<Rightarrow> bool\"\n(\"_ \\<turnstile> \\<langle>_, _\\<rangle> \\<leadsto> \\<langle>_, _\\<rangle>\" [61,61,61] 61)\nwhere\n  step_t_z: \"A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l, (Z \\<inter> {u. u \\<turnstile> inv_of A l})\\<^sup>\\<up> \\<inter> {u. u \\<turnstile> inv_of A l}\\<rangle>\" |\n  step_a_z: \"\\<lbrakk>A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\\<rbrakk>\n              \\<Longrightarrow> (A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', zone_set (Z \\<inter> {u. u \\<turnstile> g}) r \\<inter> {u. u \\<turnstile> inv_of A l'}\\<rangle> )\""], ["", "inductive_cases[elim!]: \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<leadsto> \\<langle>l', u'\\<rangle>\""], ["", "declare step_z.intros[intro]"], ["", "lemma step_z_sound:\n  \"A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l',Z'\\<rangle> \\<Longrightarrow> (\\<forall> u' \\<in> Z'. \\<exists> u \\<in> Z.  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<Longrightarrow>\n    \\<forall>u'\\<in>Z'.\n       \\<exists>u\\<in>Z.\n          A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "proof (induction rule: step_z.induct, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>A l Z.\n       \\<forall>u'\\<in>(Z \\<inter>\n                        {u. u \\<turnstile> inv_of A l})\\<^sup>\\<up> \\<inter>\n                       {u. u \\<turnstile> inv_of A l}.\n          \\<exists>u\\<in>Z.\n             A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l,u'\\<rangle>\n 2. \\<And>A l g a r l' Z.\n       A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l' \\<Longrightarrow>\n       \\<forall>u'\\<in>(Z \\<inter>\n                        {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                       {u. u \\<turnstile> inv_of A l'}.\n          \\<exists>u\\<in>Z.\n             A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<And>A l Z.\n       \\<forall>u'\\<in>(Z \\<inter>\n                        {u. u \\<turnstile> inv_of A l})\\<^sup>\\<up> \\<inter>\n                       {u. u \\<turnstile> inv_of A l}.\n          \\<exists>u\\<in>Z.\n             A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l,u'\\<rangle>\n 2. \\<And>A l g a r l' Z.\n       A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l' \\<Longrightarrow>\n       \\<forall>u'\\<in>(Z \\<inter>\n                        {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                       {u. u \\<turnstile> inv_of A l'}.\n          \\<exists>u\\<in>Z.\n             A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "thus ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u'\\<in>(Z_ \\<inter>\n                     {u. u \\<turnstile> inv_of A_ l_})\\<^sup>\\<up> \\<inter>\n                    {u. u \\<turnstile> inv_of A_ l_}.\n       \\<exists>u\\<in>Z_.\n          A_ \\<turnstile> \\<langle>l_, u\\<rangle> \\<rightarrow> \\<langle>l_,u'\\<rangle>", "unfolding zone_delay_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u'\\<in>{u \\<oplus> d |u d.\n                     u \\<in> Z_ \\<inter>\n                             {u. u \\<turnstile> inv_of A_ l_} \\<and>\n                     (0::'c) \\<le> d} \\<inter>\n                    {u. u \\<turnstile> inv_of A_ l_}.\n       \\<exists>u\\<in>Z_.\n          A_ \\<turnstile> \\<langle>l_, u\\<rangle> \\<rightarrow> \\<langle>l_,u'\\<rangle>", "by blast"], ["proof (state)\nthis:\n  \\<forall>u'\\<in>(Z_ \\<inter>\n                   {u. u \\<turnstile> inv_of A_ l_})\\<^sup>\\<up> \\<inter>\n                  {u. u \\<turnstile> inv_of A_ l_}.\n     \\<exists>u\\<in>Z_.\n        A_ \\<turnstile> \\<langle>l_, u\\<rangle> \\<rightarrow> \\<langle>l_,u'\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>A l g a r l' Z.\n       A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l' \\<Longrightarrow>\n       \\<forall>u'\\<in>(Z \\<inter>\n                        {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                       {u. u \\<turnstile> inv_of A l'}.\n          \\<exists>u\\<in>Z.\n             A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A l g a r l' Z.\n       A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l' \\<Longrightarrow>\n       \\<forall>u'\\<in>(Z \\<inter>\n                        {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                       {u. u \\<turnstile> inv_of A l'}.\n          \\<exists>u\\<in>Z.\n             A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "case (2 A l g a r l' Z)"], ["proof (state)\nthis:\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n\ngoal (1 subgoal):\n 1. \\<And>A l g a r l' Z.\n       A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l' \\<Longrightarrow>\n       \\<forall>u'\\<in>(Z \\<inter>\n                        {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                       {u. u \\<turnstile> inv_of A l'}.\n          \\<exists>u\\<in>Z.\n             A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u'\\<in>(Z \\<inter>\n                     {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                    {u. u \\<turnstile> inv_of A l'}.\n       \\<exists>u\\<in>Z.\n          A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u'.\n       u' \\<in> (Z \\<inter>\n                 {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                {u. u \\<turnstile> inv_of A l'} \\<Longrightarrow>\n       \\<exists>u\\<in>Z.\n          A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "fix u'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u'.\n       u' \\<in> (Z \\<inter>\n                 {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                {u. u \\<turnstile> inv_of A l'} \\<Longrightarrow>\n       \\<exists>u\\<in>Z.\n          A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "assume \"u' \\<in> zone_set (Z \\<inter> {u. u \\<turnstile> g}) r \\<inter> {u. u \\<turnstile> inv_of A l'}\""], ["proof (state)\nthis:\n  u' \\<in> (Z \\<inter>\n            {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n           {u. u \\<turnstile> inv_of A l'}\n\ngoal (1 subgoal):\n 1. \\<And>u'.\n       u' \\<in> (Z \\<inter>\n                 {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                {u. u \\<turnstile> inv_of A l'} \\<Longrightarrow>\n       \\<exists>u\\<in>Z.\n          A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "then"], ["proof (chain)\npicking this:\n  u' \\<in> (Z \\<inter>\n            {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n           {u. u \\<turnstile> inv_of A l'}", "obtain u where\n      \"u \\<turnstile> g\" \"u' \\<turnstile> inv_of A l'\" \"u' = [r\\<rightarrow>0]u\" \"u \\<in> Z\""], ["proof (prove)\nusing this:\n  u' \\<in> (Z \\<inter>\n            {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n           {u. u \\<turnstile> inv_of A l'}\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>u \\<turnstile> g; u' \\<turnstile> inv_of A l';\n         u' = [r\\<rightarrow>(0::'c)]u; u \\<in> Z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding zone_set_def"], ["proof (prove)\nusing this:\n  u' \\<in> {[r\\<rightarrow>(0::'c)]u |u.\n            u \\<in> Z \\<inter> {u. u \\<turnstile> g}} \\<inter>\n           {u. u \\<turnstile> inv_of A l'}\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>u \\<turnstile> g; u' \\<turnstile> inv_of A l';\n         u' = [r\\<rightarrow>(0::'c)]u; u \\<in> Z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  u \\<turnstile> g\n  u' \\<turnstile> inv_of A l'\n  u' = [r\\<rightarrow>(0::'c)]u\n  u \\<in> Z\n\ngoal (1 subgoal):\n 1. \\<And>u'.\n       u' \\<in> (Z \\<inter>\n                 {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                {u. u \\<turnstile> inv_of A l'} \\<Longrightarrow>\n       \\<exists>u\\<in>Z.\n          A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "with step_a.intros[OF 2 this(1-3)]"], ["proof (chain)\npicking this:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>\n  u \\<turnstile> g\n  u' \\<turnstile> inv_of A l'\n  u' = [r\\<rightarrow>(0::'c)]u\n  u \\<in> Z", "show \"\\<exists>u\\<in>Z. A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>\""], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>\n  u \\<turnstile> g\n  u' \\<turnstile> inv_of A l'\n  u' = [r\\<rightarrow>(0::'c)]u\n  u \\<in> Z\n\ngoal (1 subgoal):\n 1. \\<exists>u\\<in>Z.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>", "by fast"], ["proof (state)\nthis:\n  \\<exists>u\\<in>Z.\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>u'\\<in>(Z \\<inter>\n                   {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n                  {u. u \\<turnstile> inv_of A l'}.\n     \\<exists>u\\<in>Z.\n        A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma step_z_complete:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l', u'\\<rangle> \\<Longrightarrow> u \\<in> Z \\<Longrightarrow> \\<exists> Z'. A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and> u' \\<in> Z'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>;\n     u \\<in> Z\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Z'.\n                         A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                         u' \\<in> Z'", "proof (induction rule: step.induct, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>A l u a l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'\n 2. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "case (1 A l u a l' u')"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>\n  u \\<in> Z\n\ngoal (2 subgoals):\n 1. \\<And>A l u a l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'\n 2. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "then"], ["proof (chain)\npicking this:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>\n  u \\<in> Z", "obtain g r\n  where u': \"u' = [r\\<rightarrow>0]u\" \"A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\" \"u \\<turnstile> g\" \"[r\\<rightarrow>0]u \\<turnstile> inv_of A l'\""], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>\n  u \\<in> Z\n\ngoal (1 subgoal):\n 1. (\\<And>r g.\n        \\<lbrakk>u' = [r\\<rightarrow>(0::'c)]u;\n         A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l';\n         u \\<turnstile> g;\n         [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases rule: step_a.cases) auto"], ["proof (state)\nthis:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u \\<turnstile> g\n  [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\n\ngoal (2 subgoals):\n 1. \\<And>A l u a l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'\n 2. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "hence \"u' \\<in> zone_set (Z \\<inter> {u. u \\<turnstile> g}) r \\<inter> {u. u \\<turnstile> inv_of A l'}\""], ["proof (prove)\nusing this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u \\<turnstile> g\n  [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\n\ngoal (1 subgoal):\n 1. u' \\<in> (Z \\<inter>\n              {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n             {u. u \\<turnstile> inv_of A l'}", "unfolding zone_set_def"], ["proof (prove)\nusing this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u \\<turnstile> g\n  [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\n\ngoal (1 subgoal):\n 1. u' \\<in> {[r\\<rightarrow>(0::'c)]u |u.\n              u \\<in> Z \\<inter> {u. u \\<turnstile> g}} \\<inter>\n             {u. u \\<turnstile> inv_of A l'}", "using \\<open>u \\<in> Z\\<close>"], ["proof (prove)\nusing this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u \\<turnstile> g\n  [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\n  u \\<in> Z\n\ngoal (1 subgoal):\n 1. u' \\<in> {[r\\<rightarrow>(0::'c)]u |u.\n              u \\<in> Z \\<inter> {u. u \\<turnstile> g}} \\<inter>\n             {u. u \\<turnstile> inv_of A l'}", "by blast"], ["proof (state)\nthis:\n  u' \\<in> (Z \\<inter>\n            {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n           {u. u \\<turnstile> inv_of A l'}\n\ngoal (2 subgoals):\n 1. \\<And>A l u a l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'\n 2. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "with u'(1,2)"], ["proof (chain)\npicking this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u' \\<in> (Z \\<inter>\n            {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n           {u. u \\<turnstile> inv_of A l'}", "show ?case"], ["proof (prove)\nusing this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u' \\<in> (Z \\<inter>\n            {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n           {u. u \\<turnstile> inv_of A l'}\n\ngoal (1 subgoal):\n 1. \\<exists>Z'.\n       A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n       u' \\<in> Z'", "by blast"], ["proof (state)\nthis:\n  \\<exists>Z'.\n     A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n     u' \\<in> Z'\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "case (2 A l u d l' u')"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>\n  u \\<in> Z\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "hence u': \"u' = (u \\<oplus> d)\" \"u \\<turnstile> inv_of A l\" \"u \\<oplus> d \\<turnstile> inv_of A l\" \"0 \\<le> d\" and \"l = l'\""], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>\n  u \\<in> Z\n\ngoal (1 subgoal):\n 1. ((u' = u \\<oplus> d &&& u \\<turnstile> inv_of A l) &&&\n     u \\<oplus> d \\<turnstile> inv_of A l &&& (0::'c) \\<le> d) &&&\n    l = l'", "by auto"], ["proof (state)\nthis:\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  l = l'\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "with u' \\<open>u \\<in> Z\\<close>"], ["proof (chain)\npicking this:\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  u \\<in> Z\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  l = l'", "have\n    \"u' \\<in> {u'' \\<oplus> d |u'' d. u'' \\<in> Z \\<inter> {u. u \\<turnstile> inv_of A l} \\<and> 0 \\<le> d} \\<inter> {u. u \\<turnstile> inv_of A l}\""], ["proof (prove)\nusing this:\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  u \\<in> Z\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  l = l'\n\ngoal (1 subgoal):\n 1. u' \\<in> {u'' \\<oplus> d |u'' d.\n              u'' \\<in> Z \\<inter> {u. u \\<turnstile> inv_of A l} \\<and>\n              (0::'c) \\<le> d} \\<inter>\n             {u. u \\<turnstile> inv_of A l}", "by fastforce"], ["proof (state)\nthis:\n  u' \\<in> {u'' \\<oplus> d |u'' d.\n            u'' \\<in> Z \\<inter> {u. u \\<turnstile> inv_of A l} \\<and>\n            (0::'c) \\<le> d} \\<inter>\n           {u. u \\<turnstile> inv_of A l}\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>;\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n                            u' \\<in> Z'", "thus ?case"], ["proof (prove)\nusing this:\n  u' \\<in> {u'' \\<oplus> d |u'' d.\n            u'' \\<in> Z \\<inter> {u. u \\<turnstile> inv_of A l} \\<and>\n            (0::'c) \\<le> d} \\<inter>\n           {u. u \\<turnstile> inv_of A l}\n\ngoal (1 subgoal):\n 1. \\<exists>Z'.\n       A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n       u' \\<in> Z'", "using \\<open>l = l'\\<close>  step_t_z[unfolded zone_delay_def, of A l]"], ["proof (prove)\nusing this:\n  u' \\<in> {u'' \\<oplus> d |u'' d.\n            u'' \\<in> Z \\<inter> {u. u \\<turnstile> inv_of A l} \\<and>\n            (0::'c) \\<le> d} \\<inter>\n           {u. u \\<turnstile> inv_of A l}\n  l = l'\n  A \\<turnstile> \\<langle>l, ?Z\\<rangle> \\<leadsto> \\<langle>l, {u \\<oplus>\n                           d |\n                           u d.\n                           u \\<in> ?Z \\<inter>\n                                   {u. u \\<turnstile> inv_of A l} \\<and>\n                           (0::'c) \\<le> d} \\<inter>\n                          {u. u \\<turnstile> inv_of A l}\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<exists>Z'.\n       A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n       u' \\<in> Z'", "by blast"], ["proof (state)\nthis:\n  \\<exists>Z'.\n     A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n     u' \\<in> Z'\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  Corresponds to version in old papers --\n  not strong enough for inductive proof over transitive closure relation.\n\\<close>"], ["", "lemma step_z_complete1:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l', u'\\<rangle> \\<Longrightarrow> \\<exists> Z. A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and> u' \\<in> Z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle> \\<Longrightarrow>\n    \\<exists>Z.\n       A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n       u' \\<in> Z", "proof (induction rule: step.induct, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>A l u a l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z\n 2. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "case (1 A l u a l' u')"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>\n\ngoal (2 subgoals):\n 1. \\<And>A l u a l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z\n 2. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "then"], ["proof (chain)\npicking this:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>", "obtain g r\n  where u': \"u' = [r\\<rightarrow>0]u\" \"A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\" \"u \\<turnstile> g\" \"[r\\<rightarrow>0]u \\<turnstile> inv_of A l'\""], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle>\n\ngoal (1 subgoal):\n 1. (\\<And>r g.\n        \\<lbrakk>u' = [r\\<rightarrow>(0::'c)]u;\n         A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l';\n         u \\<turnstile> g;\n         [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases rule: step_a.cases) auto"], ["proof (state)\nthis:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u \\<turnstile> g\n  [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\n\ngoal (2 subgoals):\n 1. \\<And>A l u a l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z\n 2. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "hence \"{[r\\<rightarrow>0]u} = zone_set ({u} \\<inter> {u. u \\<turnstile> g}) r \\<inter> {u. u \\<turnstile> inv_of A l'}\""], ["proof (prove)\nusing this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u \\<turnstile> g\n  [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\n\ngoal (1 subgoal):\n 1. {[r\\<rightarrow>(0::'c)]u} =\n    ({u} \\<inter>\n     {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n    {u. u \\<turnstile> inv_of A l'}", "unfolding zone_set_def"], ["proof (prove)\nusing this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  u \\<turnstile> g\n  [r\\<rightarrow>(0::'c)]u \\<turnstile> inv_of A l'\n\ngoal (1 subgoal):\n 1. {[r\\<rightarrow>(0::'c)]u} =\n    {[r\\<rightarrow>(0::'c)]u |u.\n     u \\<in> {u} \\<inter> {u. u \\<turnstile> g}} \\<inter>\n    {u. u \\<turnstile> inv_of A l'}", "by blast"], ["proof (state)\nthis:\n  {[r\\<rightarrow>(0::'c)]u} =\n  ({u} \\<inter>\n   {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n  {u. u \\<turnstile> inv_of A l'}\n\ngoal (2 subgoals):\n 1. \\<And>A l u a l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsub>a\\<^esub> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z\n 2. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "with u'(1,2)"], ["proof (chain)\npicking this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  {[r\\<rightarrow>(0::'c)]u} =\n  ({u} \\<inter>\n   {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n  {u. u \\<turnstile> inv_of A l'}", "show ?case"], ["proof (prove)\nusing this:\n  u' = [r\\<rightarrow>(0::'c)]u\n  A \\<turnstile> l \\<longrightarrow>\\<^bsup>g,a,r\\<^esup> l'\n  {[r\\<rightarrow>(0::'c)]u} =\n  ({u} \\<inter>\n   {u. u \\<turnstile> g})\\<^bsub>r \\<rightarrow> 0\\<^esub> \\<inter>\n  {u. u \\<turnstile> inv_of A l'}\n\ngoal (1 subgoal):\n 1. \\<exists>Z.\n       A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n       u' \\<in> Z", "by auto"], ["proof (state)\nthis:\n  \\<exists>Z.\n     A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n     u' \\<in> Z\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "case (2 A l u d l' u')"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "hence u': \"u' = (u \\<oplus> d)\" \"u \\<turnstile> inv_of A l\" \"u \\<oplus> d \\<turnstile> inv_of A l\" \"0 \\<le> d\" and \"l = l'\""], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle>\n\ngoal (1 subgoal):\n 1. ((u' = u \\<oplus> d &&& u \\<turnstile> inv_of A l) &&&\n     u \\<oplus> d \\<turnstile> inv_of A l &&& (0::'c) \\<le> d) &&&\n    l = l'", "by auto"], ["proof (state)\nthis:\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  l = l'\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "hence \"{u} = {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}\""], ["proof (prove)\nusing this:\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  l = l'\n\ngoal (1 subgoal):\n 1. {u} = {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}", "by fastforce"], ["proof (state)\nthis:\n  {u} = {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "with u'(1)"], ["proof (chain)\npicking this:\n  u' = u \\<oplus> d\n  {u} = {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}", "have \"{u'} = {u'' \\<oplus> d |u''. u'' \\<in> {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}}\""], ["proof (prove)\nusing this:\n  u' = u \\<oplus> d\n  {u} = {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}\n\ngoal (1 subgoal):\n 1. {u'} =\n    {u'' \\<oplus> d |u''.\n     u'' \\<in> {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}}", "by fastforce"], ["proof (state)\nthis:\n  {u'} =\n  {u'' \\<oplus> d |u''.\n   u'' \\<in> {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}}\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "with u'"], ["proof (chain)\npicking this:\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  {u'} =\n  {u'' \\<oplus> d |u''.\n   u'' \\<in> {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}}", "have\n    \"u' \\<in> {u'' \\<oplus> d |u'' d. u'' \\<in> {u} \\<inter> {u. u \\<turnstile> inv_of A l} \\<and> 0 \\<le> d} \\<inter> {u. u \\<turnstile> inv_of A l}\""], ["proof (prove)\nusing this:\n  u' = u \\<oplus> d\n  u \\<turnstile> inv_of A l\n  u \\<oplus> d \\<turnstile> inv_of A l\n  (0::'c) \\<le> d\n  {u'} =\n  {u'' \\<oplus> d |u''.\n   u'' \\<in> {u} \\<inter> {u''. u'' \\<turnstile> inv_of A l}}\n\ngoal (1 subgoal):\n 1. u' \\<in> {u'' \\<oplus> d |u'' d.\n              u'' \\<in> {u} \\<inter> {u. u \\<turnstile> inv_of A l} \\<and>\n              (0::'c) \\<le> d} \\<inter>\n             {u. u \\<turnstile> inv_of A l}", "by fastforce"], ["proof (state)\nthis:\n  u' \\<in> {u'' \\<oplus> d |u'' d.\n            u'' \\<in> {u} \\<inter> {u. u \\<turnstile> inv_of A l} \\<and>\n            (0::'c) \\<le> d} \\<inter>\n           {u. u \\<turnstile> inv_of A l}\n\ngoal (1 subgoal):\n 1. \\<And>A l u d l' u'.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>\\<^bsup>d\\<^esup> \\<langle>l', u'\\<rangle> \\<Longrightarrow>\n       \\<exists>Z.\n          A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n          u' \\<in> Z", "thus ?case"], ["proof (prove)\nusing this:\n  u' \\<in> {u'' \\<oplus> d |u'' d.\n            u'' \\<in> {u} \\<inter> {u. u \\<turnstile> inv_of A l} \\<and>\n            (0::'c) \\<le> d} \\<inter>\n           {u. u \\<turnstile> inv_of A l}\n\ngoal (1 subgoal):\n 1. \\<exists>Z.\n       A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n       u' \\<in> Z", "using \\<open>l = l'\\<close> step_t_z[unfolded zone_delay_def, of A l \"{u}\"]"], ["proof (prove)\nusing this:\n  u' \\<in> {u'' \\<oplus> d |u'' d.\n            u'' \\<in> {u} \\<inter> {u. u \\<turnstile> inv_of A l} \\<and>\n            (0::'c) \\<le> d} \\<inter>\n           {u. u \\<turnstile> inv_of A l}\n  l = l'\n  A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l, {u \\<oplus>\n                            d |\n                            u d.\n                            u \\<in> {u} \\<inter>\n                                    {u. u \\<turnstile> inv_of A l} \\<and>\n                            (0::'c) \\<le> d} \\<inter>\n                           {u. u \\<turnstile> inv_of A l}\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<exists>Z.\n       A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n       u' \\<in> Z", "by blast"], ["proof (state)\nthis:\n  \\<exists>Z.\n     A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n     u' \\<in> Z\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  Easier proof.\n\\<close>"], ["", "lemma step_z_complete2:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l', u'\\<rangle> \\<Longrightarrow> \\<exists> Z. A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and> u' \\<in> Z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle> \\<Longrightarrow>\n    \\<exists>Z.\n       A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n       u' \\<in> Z", "using step_z_complete"], ["proof (prove)\nusing this:\n  \\<lbrakk>?A \\<turnstile> \\<langle>?l, ?u\\<rangle> \\<rightarrow> \\<langle>?l',?u'\\<rangle>;\n   ?u \\<in> ?Z\\<rbrakk>\n  \\<Longrightarrow> \\<exists>Z'.\n                       ?A \\<turnstile> \\<langle>?l, ?Z\\<rangle> \\<leadsto> \\<langle>?l', Z'\\<rangle> \\<and>\n                       ?u' \\<in> Z'\n\ngoal (1 subgoal):\n 1. A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle> \\<Longrightarrow>\n    \\<exists>Z.\n       A \\<turnstile> \\<langle>l, {u}\\<rangle> \\<leadsto> \\<langle>l', Z\\<rangle> \\<and>\n       u' \\<in> Z", "by fast"], ["", "inductive\n  steps_z :: \"('a, 'c, 't, 's) ta \\<Rightarrow> 's \\<Rightarrow> ('c, ('t::time)) zone \\<Rightarrow> 's \\<Rightarrow> ('c, 't) zone \\<Rightarrow> bool\"\n(\"_ \\<turnstile> \\<langle>_, _\\<rangle> \\<leadsto>* \\<langle>_, _\\<rangle>\" [61,61,61] 61)\nwhere\n  refl: \"A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l, Z\\<rangle>\" |\n  step: \"A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<Longrightarrow> A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle> \\<Longrightarrow> A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>\""], ["", "declare steps_z.intros[intro]"], ["", "lemma steps_z_sound:\n  \"A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l', Z'\\<rangle> \\<Longrightarrow> u' \\<in> Z' \\<Longrightarrow> \\<exists> u \\<in> Z. A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l', u'\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l', Z'\\<rangle>;\n     u' \\<in> Z'\\<rbrakk>\n    \\<Longrightarrow> \\<exists>u\\<in>Z.\n                         A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l', u'\\<rangle>", "proof (induction A l _ l' _ arbitrary: rule: steps_z.induct, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>A l Z.\n       u' \\<in> Z \\<Longrightarrow>\n       \\<exists>u\\<in>Z.\n          A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l, u'\\<rangle>\n 2. \\<And>A l Z l' Z' l'' Z''.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>;\n        A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n        u' \\<in> Z'' \\<Longrightarrow>\n        \\<exists>u\\<in>Z'.\n           A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>;\n        u' \\<in> Z''\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>Z.\n                            A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>", "case refl"], ["proof (state)\nthis:\n  u' \\<in> Z_\n\ngoal (2 subgoals):\n 1. \\<And>A l Z.\n       u' \\<in> Z \\<Longrightarrow>\n       \\<exists>u\\<in>Z.\n          A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l, u'\\<rangle>\n 2. \\<And>A l Z l' Z' l'' Z''.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>;\n        A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n        u' \\<in> Z'' \\<Longrightarrow>\n        \\<exists>u\\<in>Z'.\n           A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>;\n        u' \\<in> Z''\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>Z.\n                            A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>", "thus ?case"], ["proof (prove)\nusing this:\n  u' \\<in> Z_\n\ngoal (1 subgoal):\n 1. \\<exists>u\\<in>Z_.\n       A_ \\<turnstile> \\<langle>l_, u\\<rangle> \\<rightarrow>* \\<langle>l_, u'\\<rangle>", "by fast"], ["proof (state)\nthis:\n  \\<exists>u\\<in>Z_.\n     A_ \\<turnstile> \\<langle>l_, u\\<rangle> \\<rightarrow>* \\<langle>l_, u'\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>A l Z l' Z' l'' Z''.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>;\n        A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n        u' \\<in> Z'' \\<Longrightarrow>\n        \\<exists>u\\<in>Z'.\n           A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>;\n        u' \\<in> Z''\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>Z.\n                            A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A l Z l' Z' l'' Z''.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>;\n        A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n        u' \\<in> Z'' \\<Longrightarrow>\n        \\<exists>u\\<in>Z'.\n           A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>;\n        u' \\<in> Z''\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>Z.\n                            A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>", "case (step A l Z l' Z' l'' Z'')"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>\n  u' \\<in> Z'' \\<Longrightarrow>\n  \\<exists>u\\<in>Z'.\n     A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u' \\<in> Z''\n\ngoal (1 subgoal):\n 1. \\<And>A l Z l' Z' l'' Z''.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>;\n        A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n        u' \\<in> Z'' \\<Longrightarrow>\n        \\<exists>u\\<in>Z'.\n           A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>;\n        u' \\<in> Z''\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>Z.\n                            A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>", "then"], ["proof (chain)\npicking this:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>\n  u' \\<in> Z'' \\<Longrightarrow>\n  \\<exists>u\\<in>Z'.\n     A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u' \\<in> Z''", "obtain u'' where u'': \"A \\<turnstile> \\<langle>l', u''\\<rangle> \\<rightarrow>* \\<langle>l'',u'\\<rangle>\" \"u'' \\<in> Z'\""], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>\n  u' \\<in> Z'' \\<Longrightarrow>\n  \\<exists>u\\<in>Z'.\n     A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u' \\<in> Z''\n\ngoal (1 subgoal):\n 1. (\\<And>u''.\n        \\<lbrakk>A \\<turnstile> \\<langle>l', u''\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>;\n         u'' \\<in> Z'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l', u''\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u'' \\<in> Z'\n\ngoal (1 subgoal):\n 1. \\<And>A l Z l' Z' l'' Z''.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>;\n        A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n        u' \\<in> Z'' \\<Longrightarrow>\n        \\<exists>u\\<in>Z'.\n           A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>;\n        u' \\<in> Z''\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>Z.\n                            A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>", "then"], ["proof (chain)\npicking this:\n  A \\<turnstile> \\<langle>l', u''\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u'' \\<in> Z'", "obtain u where \"u \\<in> Z\" \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u''\\<rangle>\""], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l', u''\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u'' \\<in> Z'\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>u \\<in> Z;\n         A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u''\\<rangle>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using step_z_sound[OF step(1)]"], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l', u''\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u'' \\<in> Z'\n  \\<forall>u'\\<in>Z'.\n     \\<exists>u\\<in>Z.\n        A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>u \\<in> Z;\n         A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u''\\<rangle>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  u \\<in> Z\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u''\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>A l Z l' Z' l'' Z''.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>;\n        A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n        u' \\<in> Z'' \\<Longrightarrow>\n        \\<exists>u\\<in>Z'.\n           A \\<turnstile> \\<langle>l', u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>;\n        u' \\<in> Z''\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>Z.\n                            A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>", "with u''"], ["proof (chain)\npicking this:\n  A \\<turnstile> \\<langle>l', u''\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u'' \\<in> Z'\n  u \\<in> Z\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u''\\<rangle>", "show ?case"], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l', u''\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n  u'' \\<in> Z'\n  u \\<in> Z\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u''\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<exists>u\\<in>Z.\n       A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>", "by blast"], ["proof (state)\nthis:\n  \\<exists>u\\<in>Z.\n     A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l'', u'\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma steps_z_complete:\n  \"A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l', u'\\<rangle> \\<Longrightarrow> u \\<in> Z \\<Longrightarrow> \\<exists> Z'. A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l', Z'\\<rangle> \\<and> u' \\<in> Z'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow>* \\<langle>l', u'\\<rangle>;\n     u \\<in> Z\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Z'.\n                         A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l', Z'\\<rangle> \\<and>\n                         u' \\<in> Z'", "proof (induction arbitrary: Z rule: steps.induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>A l u Z.\n       u \\<in> Z \\<Longrightarrow>\n       \\<exists>Z'.\n          A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l, Z'\\<rangle> \\<and>\n          u \\<in> Z'\n 2. \\<And>A l u l' u' l'' u'' Z.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>;\n        A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>;\n        \\<And>Z.\n           u' \\<in> Z \\<Longrightarrow>\n           \\<exists>Z'.\n              A \\<turnstile> \\<langle>l', Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n              u'' \\<in> Z';\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n                            u'' \\<in> Z'", "case refl"], ["proof (state)\nthis:\n  u_ \\<in> Z\n\ngoal (2 subgoals):\n 1. \\<And>A l u Z.\n       u \\<in> Z \\<Longrightarrow>\n       \\<exists>Z'.\n          A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l, Z'\\<rangle> \\<and>\n          u \\<in> Z'\n 2. \\<And>A l u l' u' l'' u'' Z.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>;\n        A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>;\n        \\<And>Z.\n           u' \\<in> Z \\<Longrightarrow>\n           \\<exists>Z'.\n              A \\<turnstile> \\<langle>l', Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n              u'' \\<in> Z';\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n                            u'' \\<in> Z'", "thus ?case"], ["proof (prove)\nusing this:\n  u_ \\<in> Z\n\ngoal (1 subgoal):\n 1. \\<exists>Z'.\n       A_ \\<turnstile> \\<langle>l_, Z\\<rangle> \\<leadsto>* \\<langle>l_, Z'\\<rangle> \\<and>\n       u_ \\<in> Z'", "by auto"], ["proof (state)\nthis:\n  \\<exists>Z'.\n     A_ \\<turnstile> \\<langle>l_, Z\\<rangle> \\<leadsto>* \\<langle>l_, Z'\\<rangle> \\<and>\n     u_ \\<in> Z'\n\ngoal (1 subgoal):\n 1. \\<And>A l u l' u' l'' u'' Z.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>;\n        A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>;\n        \\<And>Z.\n           u' \\<in> Z \\<Longrightarrow>\n           \\<exists>Z'.\n              A \\<turnstile> \\<langle>l', Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n              u'' \\<in> Z';\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n                            u'' \\<in> Z'", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A l u l' u' l'' u'' Z.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>;\n        A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>;\n        \\<And>Z.\n           u' \\<in> Z \\<Longrightarrow>\n           \\<exists>Z'.\n              A \\<turnstile> \\<langle>l', Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n              u'' \\<in> Z';\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n                            u'' \\<in> Z'", "case (step A l u l' u' l'' u'' Z)"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>\n  A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>\n  u' \\<in> ?Z \\<Longrightarrow>\n  \\<exists>Z'.\n     A \\<turnstile> \\<langle>l', ?Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n     u'' \\<in> Z'\n  u \\<in> Z\n\ngoal (1 subgoal):\n 1. \\<And>A l u l' u' l'' u'' Z.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>;\n        A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>;\n        \\<And>Z.\n           u' \\<in> Z \\<Longrightarrow>\n           \\<exists>Z'.\n              A \\<turnstile> \\<langle>l', Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n              u'' \\<in> Z';\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n                            u'' \\<in> Z'", "from step_z_complete[OF this(1,4)]"], ["proof (chain)\npicking this:\n  \\<exists>Z'.\n     A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n     u' \\<in> Z'", "obtain Z' where Z': \"A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l',Z'\\<rangle>\" \"u' \\<in> Z'\""], ["proof (prove)\nusing this:\n  \\<exists>Z'.\n     A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle> \\<and>\n     u' \\<in> Z'\n\ngoal (1 subgoal):\n 1. (\\<And>Z'.\n        \\<lbrakk>A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>;\n         u' \\<in> Z'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  u' \\<in> Z'\n\ngoal (1 subgoal):\n 1. \\<And>A l u l' u' l'' u'' Z.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>;\n        A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>;\n        \\<And>Z.\n           u' \\<in> Z \\<Longrightarrow>\n           \\<exists>Z'.\n              A \\<turnstile> \\<langle>l', Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n              u'' \\<in> Z';\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n                            u'' \\<in> Z'", "then"], ["proof (chain)\npicking this:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  u' \\<in> Z'", "obtain Z'' where \"A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'',Z''\\<rangle>\" \"u'' \\<in> Z''\""], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  u' \\<in> Z'\n\ngoal (1 subgoal):\n 1. (\\<And>Z''.\n        \\<lbrakk>A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n         u'' \\<in> Z''\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using step"], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  u' \\<in> Z'\n  A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>\n  A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>\n  u' \\<in> ?Z \\<Longrightarrow>\n  \\<exists>Z'.\n     A \\<turnstile> \\<langle>l', ?Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n     u'' \\<in> Z'\n  u \\<in> Z\n\ngoal (1 subgoal):\n 1. (\\<And>Z''.\n        \\<lbrakk>A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>;\n         u'' \\<in> Z''\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>\n  u'' \\<in> Z''\n\ngoal (1 subgoal):\n 1. \\<And>A l u l' u' l'' u'' Z.\n       \\<lbrakk>A \\<turnstile> \\<langle>l, u\\<rangle> \\<rightarrow> \\<langle>l',u'\\<rangle>;\n        A \\<turnstile> \\<langle>l', u'\\<rangle> \\<rightarrow>* \\<langle>l'', u''\\<rangle>;\n        \\<And>Z.\n           u' \\<in> Z \\<Longrightarrow>\n           \\<exists>Z'.\n              A \\<turnstile> \\<langle>l', Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n              u'' \\<in> Z';\n        u \\<in> Z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Z'.\n                            A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n                            u'' \\<in> Z'", "with Z'"], ["proof (chain)\npicking this:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  u' \\<in> Z'\n  A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>\n  u'' \\<in> Z''", "show ?case"], ["proof (prove)\nusing this:\n  A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto> \\<langle>l', Z'\\<rangle>\n  u' \\<in> Z'\n  A \\<turnstile> \\<langle>l', Z'\\<rangle> \\<leadsto>* \\<langle>l'', Z''\\<rangle>\n  u'' \\<in> Z''\n\ngoal (1 subgoal):\n 1. \\<exists>Z'.\n       A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n       u'' \\<in> Z'", "by blast"], ["proof (state)\nthis:\n  \\<exists>Z'.\n     A \\<turnstile> \\<langle>l, Z\\<rangle> \\<leadsto>* \\<langle>l'', Z'\\<rangle> \\<and>\n     u'' \\<in> Z'\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}