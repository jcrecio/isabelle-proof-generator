{"file_name": "/home/qj213/afp-2021-10-22/thys/Weighted_Path_Order/RPO.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Weighted_Path_Order", "problem_names": ["lemma rpo_eq_wpo: \"rpo_pr s t = wpo s t\"", "theorem RPO_SN_order_pair: \"SN_order_pair RPO_S RPO_NS\"", "theorem RPO_S_subst: \"(s,t) \\<in> RPO_S \\<Longrightarrow> (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> RPO_S\" for \\<sigma> :: \"('f,'a)subst\"", "theorem RPO_NS_subst: \"(s,t) \\<in> RPO_NS \\<Longrightarrow> (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> RPO_NS\" for \\<sigma> :: \"('f,'a)subst\"", "theorem RPO_NS_ctxt: \"(s,t) \\<in> RPO_NS \\<Longrightarrow> (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> RPO_NS\"", "theorem RPO_S_ctxt: \"(s,t) \\<in> RPO_S \\<Longrightarrow> (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> RPO_S\"", "theorem RPO_S_subset_RPO_NS: \"RPO_S \\<subseteq> RPO_NS\"", "theorem supt_subset_RPO_S: \"{\\<rhd>} \\<subseteq> RPO_S\"", "theorem supteq_subset_RPO_NS: \"{\\<unrhd>} \\<subseteq> RPO_NS\""], "translations": [["", "lemma rpo_eq_wpo: \"rpo_pr s t = wpo s t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rpo_pr s t = wpo s t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. rpo_pr s t = wpo s t", "note simps = wpo.simps"], ["proof (state)\nthis:\n  wpo ?s ?t =\n  (case ?s of\n   Var x \\<Rightarrow>\n     (False,\n      case ?t of Var xa \\<Rightarrow> x = xa\n      | Fun g ts \\<Rightarrow>\n          (?s, ?t) \\<in> UNIV \\<and>\n          \\<sigma> (g, length ts) = [] \\<and> prl (g, length ts))\n   | Fun f ss \\<Rightarrow>\n       if (?s, ?t) \\<in> {} then (True, True)\n       else if (?s, ?t) \\<in> UNIV\n            then if \\<exists>i\\<in>set (\\<sigma> (f, length ss)).\n                       wpo_ns (ss ! i) ?t\n                 then (True, True)\n                 else case ?t of\n                      Var x \\<Rightarrow> (False, False \\<and> False)\n                      | Fun g ts \\<Rightarrow>\n                          case prc (f, length ss) (g, length ts) of\n                          (prs, prns) \\<Rightarrow>\n                            if prns \\<and>\n                               (\\<forall>j\n   \\<in>set (\\<sigma> (g, length ts)).\n                                   wpo_s ?s (ts ! j))\n                            then if prs then (True, True)\n                                 else let ss' =\n      map ((!) ss) (\\<sigma> (f, length ss));\n    ts' = map ((!) ts) (\\<sigma> (g, length ts)); cf = c (f, length ss);\n    cg = c (g, length ts)\nin if cf = Lex \\<and> cg = Lex then lex_ext wpo n ss' ts'\n   else if cf = Mul \\<and> cg = Mul then mul_ext wpo ss' ts'\n        else (length ss' \\<noteq> 0 \\<and> length ts' = 0, length ts' = 0)\n                            else (False, False)\n            else (False, False))\n\ngoal (1 subgoal):\n 1. rpo_pr s t = wpo s t", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. rpo_pr s t = wpo s t", "proof (induct s t rule: rpo.induct[of _ prc prl c n])"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x y. rpo_pr (Var x) (Var y) = wpo (Var x) (Var y)\n 2. \\<And>x g ts. rpo_pr (Var x) (Fun g ts) = wpo (Var x) (Fun g ts)\n 3. \\<And>f ss y.\n       (\\<And>x.\n           x \\<in> set ss \\<Longrightarrow>\n           rpo_pr x (Var y) = wpo x (Var y)) \\<Longrightarrow>\n       rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n 4. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "case (1 x y)"], ["proof (state)\nthis:\n  \n\ngoal (4 subgoals):\n 1. \\<And>x y. rpo_pr (Var x) (Var y) = wpo (Var x) (Var y)\n 2. \\<And>x g ts. rpo_pr (Var x) (Fun g ts) = wpo (Var x) (Fun g ts)\n 3. \\<And>f ss y.\n       (\\<And>x.\n           x \\<in> set ss \\<Longrightarrow>\n           rpo_pr x (Var y) = wpo x (Var y)) \\<Longrightarrow>\n       rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n 4. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. rpo_pr (Var x) (Var y) = wpo (Var x) (Var y)", "by (simp add: simps)"], ["proof (state)\nthis:\n  rpo_pr (Var x) (Var y) = wpo (Var x) (Var y)\n\ngoal (3 subgoals):\n 1. \\<And>x g ts. rpo_pr (Var x) (Fun g ts) = wpo (Var x) (Fun g ts)\n 2. \\<And>f ss y.\n       (\\<And>x.\n           x \\<in> set ss \\<Longrightarrow>\n           rpo_pr x (Var y) = wpo x (Var y)) \\<Longrightarrow>\n       rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n 3. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x g ts. rpo_pr (Var x) (Fun g ts) = wpo (Var x) (Fun g ts)\n 2. \\<And>f ss y.\n       (\\<And>x.\n           x \\<in> set ss \\<Longrightarrow>\n           rpo_pr x (Var y) = wpo x (Var y)) \\<Longrightarrow>\n       rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n 3. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "case (2 x g ts)"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. \\<And>x g ts. rpo_pr (Var x) (Fun g ts) = wpo (Var x) (Fun g ts)\n 2. \\<And>f ss y.\n       (\\<And>x.\n           x \\<in> set ss \\<Longrightarrow>\n           rpo_pr x (Var y) = wpo x (Var y)) \\<Longrightarrow>\n       rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n 3. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. rpo_pr (Var x) (Fun g ts) = wpo (Var x) (Fun g ts)", "by (auto simp: simps)"], ["proof (state)\nthis:\n  rpo_pr (Var x) (Fun g ts) = wpo (Var x) (Fun g ts)\n\ngoal (2 subgoals):\n 1. \\<And>f ss y.\n       (\\<And>x.\n           x \\<in> set ss \\<Longrightarrow>\n           rpo_pr x (Var y) = wpo x (Var y)) \\<Longrightarrow>\n       rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n 2. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f ss y.\n       (\\<And>x.\n           x \\<in> set ss \\<Longrightarrow>\n           rpo_pr x (Var y) = wpo x (Var y)) \\<Longrightarrow>\n       rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n 2. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "case (3 f ss y)"], ["proof (state)\nthis:\n  ?x4 \\<in> set ss \\<Longrightarrow> rpo_pr ?x4 (Var y) = wpo ?x4 (Var y)\n\ngoal (2 subgoals):\n 1. \\<And>f ss y.\n       (\\<And>x.\n           x \\<in> set ss \\<Longrightarrow>\n           rpo_pr x (Var y) = wpo x (Var y)) \\<Longrightarrow>\n       rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n 2. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "then"], ["proof (chain)\npicking this:\n  ?x4 \\<in> set ss \\<Longrightarrow> rpo_pr ?x4 (Var y) = wpo ?x4 (Var y)", "show ?case"], ["proof (prove)\nusing this:\n  ?x4 \\<in> set ss \\<Longrightarrow> rpo_pr ?x4 (Var y) = wpo ?x4 (Var y)\n\ngoal (1 subgoal):\n 1. rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)", "by (auto simp: simps[of \"Fun f ss\" \"Var y\"] Let_def set_conv_nth)"], ["proof (state)\nthis:\n  rpo_pr (Fun f ss) (Var y) = wpo (Fun f ss) (Var y)\n\ngoal (1 subgoal):\n 1. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "case IH: (4 f ss g ts)"], ["proof (state)\nthis:\n  ?x4 \\<in> set ss \\<Longrightarrow>\n  rpo_pr ?x4 (Fun g ts) = wpo ?x4 (Fun g ts)\n  \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n   ?x4 = prc (f, length ss) (g, length ts); (?xa4, ?y4) = ?x4;\n   ?xb4 \\<in> set ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr (Fun f ss) ?xb4 = wpo (Fun f ss) ?xb4\n  \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n   ?x4 = prc (f, length ss) (g, length ts); (?xa4, ?y4) = ?x4;\n   ?y4 \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> ?xa4;\n   c (f, length ss) = Lex \\<and> c (g, length ts) = Lex; ?i4 < length ss;\n   ?i4 < length ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr (ss ! ?i4) (ts ! ?i4) = wpo (ss ! ?i4) (ts ! ?i4)\n  \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n   ?x4 = prc (f, length ss) (g, length ts); (?xa4, ?y4) = ?x4;\n   ?y4 \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> ?xa4;\n   \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n   c (f, length ss) = Mul \\<and> c (g, length ts) = Mul; ?xb4 \\<in> set ss;\n   ?x'4 \\<in> set ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr ?xb4 ?x'4 = wpo ?xb4 ?x'4\n\ngoal (1 subgoal):\n 1. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "have id: \"\\<And> s. (s \\<in> {}) = False\" \"\\<And> s. (s \\<in> UNIV) = True\" \n      and \"(\\<exists>i\\<in>{0..<length ss}. wpo_ns (ss ! i) t) = (\\<exists>si\\<in>set ss. wpo_ns si t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<And>s. (s \\<in> {}) = False) &&&\n     (\\<And>s. (s \\<in> UNIV) = True)) &&&\n    (\\<exists>i\\<in>{0..<length ss}. wpo_ns (ss ! i) t) =\n    (\\<exists>si\\<in>set ss. wpo_ns si t)", "by (auto, force simp: set_conv_nth)"], ["proof (state)\nthis:\n  (?s4 \\<in> {}) = False\n  (?s4 \\<in> UNIV) = True\n  (\\<exists>i\\<in>{0..<length ss}. wpo_ns (ss ! i) t) =\n  (\\<exists>si\\<in>set ss. wpo_ns si t)\n\ngoal (1 subgoal):\n 1. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "have id': \"map ((!) ss) (\\<sigma> (f, length ss)) = ss\" for f ss"], ["proof (prove)\ngoal (1 subgoal):\n 1. map ((!) ss) (\\<sigma> (f, length ss)) = ss", "by (intro nth_equalityI, auto)"], ["proof (state)\nthis:\n  map ((!) ?ss6) (\\<sigma> (?f6, length ?ss6)) = ?ss6\n\ngoal (1 subgoal):\n 1. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "have ex: \"(\\<exists>i\\<in>set (\\<sigma> (f, length ss)). wpo_ns (ss ! i) (Fun g ts)) = (\\<exists> si \\<in> set ss. rpo_ns si (Fun g ts))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>i\\<in>set (\\<sigma> (f, length ss)).\n        wpo_ns (ss ! i) (Fun g ts)) =\n    (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts))", "using IH(1)"], ["proof (prove)\nusing this:\n  ?x4 \\<in> set ss \\<Longrightarrow>\n  rpo_pr ?x4 (Fun g ts) = wpo ?x4 (Fun g ts)\n\ngoal (1 subgoal):\n 1. (\\<exists>i\\<in>set (\\<sigma> (f, length ss)).\n        wpo_ns (ss ! i) (Fun g ts)) =\n    (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts))", "unfolding set_conv_nth"], ["proof (prove)\nusing this:\n  ?x4 \\<in> {ss ! i |i. i < length ss} \\<Longrightarrow>\n  rpo_pr ?x4 (Fun g ts) = wpo ?x4 (Fun g ts)\n\ngoal (1 subgoal):\n 1. (\\<exists>i\\<in>{\\<sigma> (f, length ss) ! i |i.\n                     i < length (\\<sigma> (f, length ss))}.\n        wpo_ns (ss ! i) (Fun g ts)) =\n    (\\<exists>si\\<in>{ss ! i |i. i < length ss}. rpo_ns si (Fun g ts))", "by auto"], ["proof (state)\nthis:\n  (\\<exists>i\\<in>set (\\<sigma> (f, length ss)).\n      wpo_ns (ss ! i) (Fun g ts)) =\n  (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts))\n\ngoal (1 subgoal):\n 1. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "obtain prs prns where prc: \"prc (f, length ss) (g, length ts) = (prs, prns)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>prs prns.\n        prc (f, length ss) (g, length ts) = (prs, prns) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  prc (f, length ss) (g, length ts) = (prs, prns)\n\ngoal (1 subgoal):\n 1. \\<And>f ss g ts.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> set ss \\<Longrightarrow>\n                   rpo_pr x (Fun g ts) = wpo x (Fun g ts);\n        \\<And>x xa y xb.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            xb \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (Fun f ss) xb = wpo (Fun f ss) xb;\n        \\<And>x xa y i.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n            i < length ss; i < length ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr (ss ! i) (ts ! i) =\n                             wpo (ss ! i) (ts ! i);\n        \\<And>x xa y xb x'.\n           \\<lbrakk>\\<not> (\\<exists>s\\<in>set ss. rpo_ns s (Fun g ts));\n            x = prc (f, length ss) (g, length ts); (xa, y) = x;\n            y \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> xa;\n            \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n            c (f, length ss) = Mul \\<and> c (g, length ts) = Mul;\n            xb \\<in> set ss; x' \\<in> set ts\\<rbrakk>\n           \\<Longrightarrow> rpo_pr xb x' = wpo xb x'\\<rbrakk>\n       \\<Longrightarrow> rpo_pr (Fun f ss) (Fun g ts) =\n                         wpo (Fun f ss) (Fun g ts)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. rpo_pr (Fun f ss) (Fun g ts) = wpo (Fun f ss) (Fun g ts)", "unfolding rpo.simps simps[of \"Fun f ss\" \"Fun g ts\"] term.simps id id' if_False if_True\n        Let_def ex prc split"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if \\<exists>s\\<in>set ss. rpo_ns s (Fun g ts) then (True, True)\n     else if prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)\n          then if prs then (True, True)\n               else if c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\n                    then lex_ext rpo_pr n ss ts\n                    else if c (f, length ss) = Mul \\<and>\n                            c (g, length ts) = Mul\n                         then mul_ext rpo_pr ss ts\n                         else (length ss \\<noteq> 0 \\<and> length ts = 0,\n                               length ts = 0)\n          else (False, False)) =\n    (if \\<exists>si\\<in>set ss. rpo_ns si (Fun g ts) then (True, True)\n     else if prns \\<and>\n             (\\<forall>j\\<in>set (\\<sigma> (g, length ts)).\n                 wpo_s (Fun f ss) (ts ! j))\n          then if prs then (True, True)\n               else if c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\n                    then lex_ext wpo n ss ts\n                    else if c (f, length ss) = Mul \\<and>\n                            c (g, length ts) = Mul\n                         then mul_ext wpo ss ts\n                         else (length ss \\<noteq> 0 \\<and> length ts = 0,\n                               length ts = 0)\n          else (False, False))", "proof (rule sym, rule if_cong[OF refl refl], rule if_cong[OF conj_cong[OF refl] if_cong[OF refl refl if_cong[OF refl _ if_cong]] refl])"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<in>set (\\<sigma> (g, length ts)).\n                          wpo_s (Fun f ss) (ts ! j)) =\n                      (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\\<rbrakk>\n    \\<Longrightarrow> lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 4. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 5. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "assume \"\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts))\""], ["proof (state)\nthis:\n  \\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts))\n\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<in>set (\\<sigma> (g, length ts)).\n                          wpo_s (Fun f ss) (ts ! j)) =\n                      (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\\<rbrakk>\n    \\<Longrightarrow> lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 4. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 5. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "note IH = IH(2-)[OF this prc[symmetric] refl]"], ["proof (state)\nthis:\n  ?xb4 \\<in> set ts \\<Longrightarrow>\n  rpo_pr (Fun f ss) ?xb4 = wpo (Fun f ss) ?xb4\n  \\<lbrakk>prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t);\n   \\<not> prs; c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n   ?i4 < length ss; ?i4 < length ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr (ss ! ?i4) (ts ! ?i4) = wpo (ss ! ?i4) (ts ! ?i4)\n  \\<lbrakk>prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t);\n   \\<not> prs;\n   \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n   c (f, length ss) = Mul \\<and> c (g, length ts) = Mul; ?xb4 \\<in> set ss;\n   ?x'4 \\<in> set ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr ?xb4 ?x'4 = wpo ?xb4 ?x'4\n\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<in>set (\\<sigma> (g, length ts)).\n                          wpo_s (Fun f ss) (ts ! j)) =\n                      (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\\<rbrakk>\n    \\<Longrightarrow> lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 4. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 5. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "from IH(1)"], ["proof (chain)\npicking this:\n  ?xb4 \\<in> set ts \\<Longrightarrow>\n  rpo_pr (Fun f ss) ?xb4 = wpo (Fun f ss) ?xb4", "show \"(\\<forall>j\\<in>set (\\<sigma> (g, length ts)). wpo_s (Fun f ss) (ts ! j)) = (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)\""], ["proof (prove)\nusing this:\n  ?xb4 \\<in> set ts \\<Longrightarrow>\n  rpo_pr (Fun f ss) ?xb4 = wpo (Fun f ss) ?xb4\n\ngoal (1 subgoal):\n 1. (\\<forall>j\\<in>set (\\<sigma> (g, length ts)).\n        wpo_s (Fun f ss) (ts ! j)) =\n    (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)", "unfolding set_conv_nth"], ["proof (prove)\nusing this:\n  ?xb4 \\<in> {ts ! i |i. i < length ts} \\<Longrightarrow>\n  rpo_pr (Fun f ss) ?xb4 = wpo (Fun f ss) ?xb4\n\ngoal (1 subgoal):\n 1. (\\<forall>j\\<in>{\\<sigma> (g, length ts) ! i |i.\n                     i < length (\\<sigma> (g, length ts))}.\n        wpo_s (Fun f ss) (ts ! j)) =\n    (\\<forall>t\\<in>{ts ! i |i. i < length ts}. rpo_s (Fun f ss) t)", "by auto"], ["proof (state)\nthis:\n  (\\<forall>j\\<in>set (\\<sigma> (g, length ts)).\n      wpo_s (Fun f ss) (ts ! j)) =\n  (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)\n\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\\<rbrakk>\n    \\<Longrightarrow> lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 4. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "assume \"prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)\" \"\\<not> prs\""], ["proof (state)\nthis:\n  prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t)\n  \\<not> prs\n\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\\<rbrakk>\n    \\<Longrightarrow> lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 4. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "note IH = IH(2-)[OF this]"], ["proof (state)\nthis:\n  \\<lbrakk>c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n   ?i4 < length ss; ?i4 < length ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr (ss ! ?i4) (ts ! ?i4) = wpo (ss ! ?i4) (ts ! ?i4)\n  \\<lbrakk>\\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n   c (f, length ss) = Mul \\<and> c (g, length ts) = Mul; ?xb4 \\<in> set ss;\n   ?x'4 \\<in> set ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr ?xb4 ?x'4 = wpo ?xb4 ?x'4\n\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\\<rbrakk>\n    \\<Longrightarrow> lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 4. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "{"], ["proof (state)\nthis:\n  \\<lbrakk>c (f, length ss) = Lex \\<and> c (g, length ts) = Lex;\n   ?i4 < length ss; ?i4 < length ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr (ss ! ?i4) (ts ! ?i4) = wpo (ss ! ?i4) (ts ! ?i4)\n  \\<lbrakk>\\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n   c (f, length ss) = Mul \\<and> c (g, length ts) = Mul; ?xb4 \\<in> set ss;\n   ?x'4 \\<in> set ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr ?xb4 ?x'4 = wpo ?xb4 ?x'4\n\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\\<rbrakk>\n    \\<Longrightarrow> lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 4. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "assume \"c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\""], ["proof (state)\nthis:\n  c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\n\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     c (f, length ss) = Lex \\<and> c (g, length ts) = Lex\\<rbrakk>\n    \\<Longrightarrow> lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 4. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "from IH(1)[OF this]"], ["proof (chain)\npicking this:\n  \\<lbrakk>?i4 < length ss; ?i4 < length ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr (ss ! ?i4) (ts ! ?i4) = wpo (ss ! ?i4) (ts ! ?i4)", "show \"lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?i4 < length ss; ?i4 < length ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr (ss ! ?i4) (ts ! ?i4) = wpo (ss ! ?i4) (ts ! ?i4)\n\ngoal (1 subgoal):\n 1. lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts", "by (intro lex_ext_cong, auto)"], ["proof (state)\nthis:\n  lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "}"], ["proof (state)\nthis:\n  c (f, length ss) = Lex \\<and> c (g, length ts) = Lex \\<Longrightarrow>\n  lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "{"], ["proof (state)\nthis:\n  c (f, length ss) = Lex \\<and> c (g, length ts) = Lex \\<Longrightarrow>\n  lex_ext wpo n ss ts = lex_ext rpo_pr n ss ts\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "assume \"\\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\" \"c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\""], ["proof (state)\nthis:\n  \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\n  c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n    \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n 3. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "from IH(2)[OF this]"], ["proof (chain)\npicking this:\n  \\<lbrakk>?xb4 \\<in> set ss; ?x'4 \\<in> set ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr ?xb4 ?x'4 = wpo ?xb4 ?x'4", "show \"mul_ext wpo ss ts = mul_ext rpo_pr ss ts\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?xb4 \\<in> set ss; ?x'4 \\<in> set ts\\<rbrakk>\n  \\<Longrightarrow> rpo_pr ?xb4 ?x'4 = wpo ?xb4 ?x'4\n\ngoal (1 subgoal):\n 1. mul_ext wpo ss ts = mul_ext rpo_pr ss ts", "by (intro mul_ext_cong, auto)"], ["proof (state)\nthis:\n  mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "}"], ["proof (state)\nthis:\n  \\<lbrakk>\\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n   c (f, length ss) = Mul \\<and> c (g, length ts) = Mul\\<rbrakk>\n  \\<Longrightarrow> mul_ext wpo ss ts = mul_ext rpo_pr ss ts\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex)\\<rbrakk>\n    \\<Longrightarrow> (c (f, length ss) = Mul \\<and>\n                       c (g, length ts) = Mul) =\n                      (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\n 2. \\<lbrakk>\\<not> (\\<exists>si\\<in>set ss. rpo_ns si (Fun g ts));\n     prns \\<and> (\\<forall>t\\<in>set ts. rpo_s (Fun f ss) t); \\<not> prs;\n     \\<not> (c (f, length ss) = Lex \\<and> c (g, length ts) = Lex);\n     \\<not> (c (f, length ss) = Mul \\<and> c (g, length ts) = Mul)\\<rbrakk>\n    \\<Longrightarrow> (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0) =\n                      (length ss \\<noteq> 0 \\<and> length ts = 0,\n                       length ts = 0)", "qed auto"], ["proof (state)\nthis:\n  rpo_pr (Fun f ss) (Fun g ts) = wpo (Fun f ss) (Fun g ts)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  rpo_pr s t = wpo s t\n\ngoal:\nNo subgoals!", "qed"], ["", "abbreviation \"RPO_S \\<equiv> {(s,t). rpo_s s t}\""], ["", "abbreviation \"RPO_NS \\<equiv> {(s,t). rpo_ns s t}\""], ["", "theorem RPO_SN_order_pair: \"SN_order_pair RPO_S RPO_NS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SN_order_pair RPO_S RPO_NS", "unfolding rpo_eq_wpo"], ["proof (prove)\ngoal (1 subgoal):\n 1. SN_order_pair WPO_S WPO_NS", "by (rule WPO_SN_order_pair)"], ["", "theorem RPO_S_subst: \"(s,t) \\<in> RPO_S \\<Longrightarrow> (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> RPO_S\" for \\<sigma> :: \"('f,'a)subst\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (s, t) \\<in> RPO_S \\<Longrightarrow>\n    (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> RPO_S", "using WPO_S_subst"], ["proof (prove)\nusing this:\n  (?s, ?t) \\<in> WPO_S \\<Longrightarrow>\n  (?s \\<cdot> ?\\<sigma>, ?t \\<cdot> ?\\<sigma>) \\<in> WPO_S\n\ngoal (1 subgoal):\n 1. (s, t) \\<in> RPO_S \\<Longrightarrow>\n    (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> RPO_S", "unfolding rpo_eq_wpo"], ["proof (prove)\nusing this:\n  (?s, ?t) \\<in> WPO_S \\<Longrightarrow>\n  (?s \\<cdot> ?\\<sigma>, ?t \\<cdot> ?\\<sigma>) \\<in> WPO_S\n\ngoal (1 subgoal):\n 1. (s, t) \\<in> WPO_S \\<Longrightarrow>\n    (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> WPO_S", "."], ["", "theorem RPO_NS_subst: \"(s,t) \\<in> RPO_NS \\<Longrightarrow> (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> RPO_NS\" for \\<sigma> :: \"('f,'a)subst\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (s, t) \\<in> RPO_NS \\<Longrightarrow>\n    (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> RPO_NS", "using WPO_NS_subst"], ["proof (prove)\nusing this:\n  (?s, ?t) \\<in> WPO_NS \\<Longrightarrow>\n  (?s \\<cdot> ?\\<sigma>, ?t \\<cdot> ?\\<sigma>) \\<in> WPO_NS\n\ngoal (1 subgoal):\n 1. (s, t) \\<in> RPO_NS \\<Longrightarrow>\n    (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> RPO_NS", "unfolding rpo_eq_wpo"], ["proof (prove)\nusing this:\n  (?s, ?t) \\<in> WPO_NS \\<Longrightarrow>\n  (?s \\<cdot> ?\\<sigma>, ?t \\<cdot> ?\\<sigma>) \\<in> WPO_NS\n\ngoal (1 subgoal):\n 1. (s, t) \\<in> WPO_NS \\<Longrightarrow>\n    (s \\<cdot> \\<sigma>, t \\<cdot> \\<sigma>) \\<in> WPO_NS", "."], ["", "theorem RPO_NS_ctxt: \"(s,t) \\<in> RPO_NS \\<Longrightarrow> (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> RPO_NS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (s, t) \\<in> RPO_NS \\<Longrightarrow>\n    (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> RPO_NS", "using WPO_NS_ctxt"], ["proof (prove)\nusing this:\n  (?s, ?t) \\<in> WPO_NS \\<Longrightarrow>\n  (Fun ?f (?bef @ ?s # ?aft), Fun ?f (?bef @ ?t # ?aft)) \\<in> WPO_NS\n\ngoal (1 subgoal):\n 1. (s, t) \\<in> RPO_NS \\<Longrightarrow>\n    (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> RPO_NS", "unfolding rpo_eq_wpo"], ["proof (prove)\nusing this:\n  (?s, ?t) \\<in> WPO_NS \\<Longrightarrow>\n  (Fun ?f (?bef @ ?s # ?aft), Fun ?f (?bef @ ?t # ?aft)) \\<in> WPO_NS\n\ngoal (1 subgoal):\n 1. (s, t) \\<in> WPO_NS \\<Longrightarrow>\n    (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> WPO_NS", "."], ["", "theorem RPO_S_ctxt: \"(s,t) \\<in> RPO_S \\<Longrightarrow> (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> RPO_S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (s, t) \\<in> RPO_S \\<Longrightarrow>\n    (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> RPO_S", "using WPO_S_ctxt"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>f k. set (\\<sigma> (f, k)) = {0..<k};\n   (?s, ?t) \\<in> WPO_S\\<rbrakk>\n  \\<Longrightarrow> (Fun ?f (?bef @ ?s # ?aft), Fun ?f (?bef @ ?t # ?aft))\n                    \\<in> WPO_S\n\ngoal (1 subgoal):\n 1. (s, t) \\<in> RPO_S \\<Longrightarrow>\n    (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> RPO_S", "unfolding rpo_eq_wpo"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>f k. set (\\<sigma> (f, k)) = {0..<k};\n   (?s, ?t) \\<in> WPO_S\\<rbrakk>\n  \\<Longrightarrow> (Fun ?f (?bef @ ?s # ?aft), Fun ?f (?bef @ ?t # ?aft))\n                    \\<in> WPO_S\n\ngoal (1 subgoal):\n 1. (s, t) \\<in> WPO_S \\<Longrightarrow>\n    (Fun f (bef @ s # aft), Fun f (bef @ t # aft)) \\<in> WPO_S", "by auto"], ["", "theorem RPO_S_subset_RPO_NS: \"RPO_S \\<subseteq> RPO_NS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. RPO_S \\<subseteq> RPO_NS", "using WPO_S_subset_WPO_NS"], ["proof (prove)\nusing this:\n  WPO_S \\<subseteq> WPO_NS\n\ngoal (1 subgoal):\n 1. RPO_S \\<subseteq> RPO_NS", "unfolding rpo_eq_wpo"], ["proof (prove)\nusing this:\n  WPO_S \\<subseteq> WPO_NS\n\ngoal (1 subgoal):\n 1. WPO_S \\<subseteq> WPO_NS", "."], ["", "theorem supt_subset_RPO_S: \"{\\<rhd>} \\<subseteq> RPO_S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {\\<rhd>} \\<subseteq> RPO_S", "using supt_subset_WPO_S"], ["proof (prove)\nusing this:\n  (\\<And>f k. set (\\<sigma> (f, k)) = {0..<k}) \\<Longrightarrow>\n  {\\<rhd>} \\<subseteq> WPO_S\n\ngoal (1 subgoal):\n 1. {\\<rhd>} \\<subseteq> RPO_S", "unfolding rpo_eq_wpo"], ["proof (prove)\nusing this:\n  (\\<And>f k. set (\\<sigma> (f, k)) = {0..<k}) \\<Longrightarrow>\n  {\\<rhd>} \\<subseteq> WPO_S\n\ngoal (1 subgoal):\n 1. {\\<rhd>} \\<subseteq> WPO_S", "by auto"], ["", "theorem supteq_subset_RPO_NS: \"{\\<unrhd>} \\<subseteq> RPO_NS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {\\<unrhd>} \\<subseteq> RPO_NS", "using supteq_subset_WPO_NS"], ["proof (prove)\nusing this:\n  (\\<And>f k. set (\\<sigma> (f, k)) = {0..<k}) \\<Longrightarrow>\n  {\\<unrhd>} \\<subseteq> WPO_NS\n\ngoal (1 subgoal):\n 1. {\\<unrhd>} \\<subseteq> RPO_NS", "unfolding rpo_eq_wpo"], ["proof (prove)\nusing this:\n  (\\<And>f k. set (\\<sigma> (f, k)) = {0..<k}) \\<Longrightarrow>\n  {\\<unrhd>} \\<subseteq> WPO_NS\n\ngoal (1 subgoal):\n 1. {\\<unrhd>} \\<subseteq> WPO_NS", "by auto"], ["", "end"], ["", "end"]]}