{"file_name": "/home/qj213/afp-2021-10-22/thys/Transition_Systems_and_Automata/Automata/NBTA/NBTA_Combine.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Transition_Systems_and_Automata", "problem_names": ["lemmas degeneralize_language[simp] = degeneralization.degeneralize_language[folded NBTA.language_def]", "lemmas degeneralize_nodes_finite[iff] = degeneralization.degeneralize_nodes_finite[folded NBTA.nodes_def]", "lemmas intersect'_language[simp] = intersection.product_language[folded NGBTA.language_def]", "lemmas intersect'_nodes_finite[intro] = intersection.product_nodes_finite[folded NGBTA.nodes_def]", "lemmas union_language = union.sum_language", "lemmas union_nodes_finite = union.sum_nodes_finite", "lemma intersect_language[simp]: \"NBTA.language (intersect A B) = NBTA.language A \\<inter> NBTA.language B\"", "lemma intersect_nodes_finite[intro]:\n    assumes \"finite (NBTA.nodes A)\" \"finite (NBTA.nodes B)\"\n    shows \"finite (NBTA.nodes (intersect A B))\""], "translations": [["", "lemmas degeneralize_language[simp] = degeneralization.degeneralize_language[folded NBTA.language_def]"], ["", "lemmas degeneralize_nodes_finite[iff] = degeneralization.degeneralize_nodes_finite[folded NBTA.nodes_def]"], ["", "global_interpretation intersection: automaton_intersection_run\n    nbta nbta.alphabet nbta.initial nbta.transition nbta.accepting \"\\<lambda> P w r p. infs P (p ## r ||| w ||| r)\"\n    nbta nbta.alphabet nbta.initial nbta.transition nbta.accepting \"\\<lambda> P w r p. infs P (p ## r ||| w ||| r)\"\n    ngbta ngbta.alphabet ngbta.initial ngbta.transition ngbta.accepting \"\\<lambda> P w r p. gen infs P (p ## r ||| w ||| r)\"\n    \"\\<lambda> c\\<^sub>1 c\\<^sub>2. [c\\<^sub>1 \\<circ> (\\<lambda> ((p\\<^sub>1, p\\<^sub>2), a, (q\\<^sub>1, q\\<^sub>2)). (p\\<^sub>1, a, q\\<^sub>1)), c\\<^sub>2 \\<circ> (\\<lambda> ((p\\<^sub>1, p\\<^sub>2), a, (q\\<^sub>1, q\\<^sub>2)). (p\\<^sub>2, a, q\\<^sub>2))]\"\n    defines intersect' = intersection.product"], ["proof (prove)\ngoal (1 subgoal):\n 1. automaton_intersection_run nbta nbta.alphabet nbta.initial\n     nbta.transition nbta.accepting\n     (\\<lambda>P w r p. infs P (p ## r ||| w ||| r)) nbta nbta.alphabet\n     nbta.initial nbta.transition nbta.accepting\n     (\\<lambda>P w r p. infs P (p ## r ||| w ||| r)) ngbta ngbta.alphabet\n     ngbta.initial ngbta.transition ngbta.accepting\n     (\\<lambda>P w r p. gen infs P (p ## r ||| w ||| r))\n     (\\<lambda>c\\<^sub>1 c\\<^sub>2.\n         [c\\<^sub>1 \\<circ>\n          (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n              (p\\<^sub>1, a, q\\<^sub>1)),\n          c\\<^sub>2 \\<circ>\n          (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n              (p\\<^sub>2, a, q\\<^sub>2))])", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "fix w :: \"'a stream\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "fix u :: \"'b stream\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "fix v :: \"'c stream\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "fix c\\<^sub>1 c\\<^sub>2 p q"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "let ?tfst = \"\\<lambda> ((p\\<^sub>1, p\\<^sub>2), a, (q\\<^sub>1, q\\<^sub>2)). (p\\<^sub>1, a, q\\<^sub>1)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "let ?tsnd = \"\\<lambda> ((p\\<^sub>1, p\\<^sub>2), a, (q\\<^sub>1, q\\<^sub>2)). (p\\<^sub>2, a, q\\<^sub>2)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "have \"gen infs [c\\<^sub>1 \\<circ> ?tfst, c\\<^sub>2 \\<circ> ?tsnd] ((p, q) ## (u ||| v) ||| w ||| u ||| v) \\<longleftrightarrow>\n      infs c\\<^sub>1 (smap ?tfst ((p, q) ## (u ||| v) ||| w ||| u ||| v)) \\<and>\n      infs c\\<^sub>2 (smap ?tsnd ((p, q) ## (u ||| v) ||| w ||| u ||| v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gen infs\n     [c\\<^sub>1 \\<circ>\n      (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n          (p\\<^sub>1, a, q\\<^sub>1)),\n      c\\<^sub>2 \\<circ>\n      (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n          (p\\<^sub>2, a, q\\<^sub>2))]\n     ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n    (infs c\\<^sub>1\n      (smap\n        (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n            (p\\<^sub>1, a, q\\<^sub>1))\n        ((p, q) ## (u ||| v) ||| w ||| u ||| v)) \\<and>\n     infs c\\<^sub>2\n      (smap\n        (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n            (p\\<^sub>2, a, q\\<^sub>2))\n        ((p, q) ## (u ||| v) ||| w ||| u ||| v)))", "unfolding gen_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>c\\<in>set [c\\<^sub>1 \\<circ>\n                         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1,\n                             q\\<^sub>2). (p\\<^sub>1, a, q\\<^sub>1)),\n                         c\\<^sub>2 \\<circ>\n                         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1,\n                             q\\<^sub>2). (p\\<^sub>2, a, q\\<^sub>2))].\n        infs c ((p, q) ## (u ||| v) ||| w ||| u ||| v)) =\n    (infs c\\<^sub>1\n      (smap\n        (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n            (p\\<^sub>1, a, q\\<^sub>1))\n        ((p, q) ## (u ||| v) ||| w ||| u ||| v)) \\<and>\n     infs c\\<^sub>2\n      (smap\n        (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n            (p\\<^sub>2, a, q\\<^sub>2))\n        ((p, q) ## (u ||| v) ||| w ||| u ||| v)))", "by (simp add: comp_def)"], ["proof (state)\nthis:\n  gen infs\n   [c\\<^sub>1 \\<circ>\n    (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n        (p\\<^sub>1, a, q\\<^sub>1)),\n    c\\<^sub>2 \\<circ>\n    (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n        (p\\<^sub>2, a, q\\<^sub>2))]\n   ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n  (infs c\\<^sub>1\n    (smap\n      (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n          (p\\<^sub>1, a, q\\<^sub>1))\n      ((p, q) ## (u ||| v) ||| w ||| u ||| v)) \\<and>\n   infs c\\<^sub>2\n    (smap\n      (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n          (p\\<^sub>2, a, q\\<^sub>2))\n      ((p, q) ## (u ||| v) ||| w ||| u ||| v)))\n\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "also"], ["proof (state)\nthis:\n  gen infs\n   [c\\<^sub>1 \\<circ>\n    (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n        (p\\<^sub>1, a, q\\<^sub>1)),\n    c\\<^sub>2 \\<circ>\n    (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n        (p\\<^sub>2, a, q\\<^sub>2))]\n   ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n  (infs c\\<^sub>1\n    (smap\n      (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n          (p\\<^sub>1, a, q\\<^sub>1))\n      ((p, q) ## (u ||| v) ||| w ||| u ||| v)) \\<and>\n   infs c\\<^sub>2\n    (smap\n      (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n          (p\\<^sub>2, a, q\\<^sub>2))\n      ((p, q) ## (u ||| v) ||| w ||| u ||| v)))\n\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "have \"smap ?tfst ((p, q) ## (u ||| v) ||| w ||| u ||| v) = p ## u ||| w ||| u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. smap\n     (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n         (p\\<^sub>1, a, q\\<^sub>1))\n     ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n    p ## u ||| w ||| u", "by (coinduction arbitrary: p q u v w) (auto simp flip: szip_unfold, metis stream.collapse)"], ["proof (state)\nthis:\n  smap\n   (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n       (p\\<^sub>1, a, q\\<^sub>1))\n   ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n  p ## u ||| w ||| u\n\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "also"], ["proof (state)\nthis:\n  smap\n   (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n       (p\\<^sub>1, a, q\\<^sub>1))\n   ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n  p ## u ||| w ||| u\n\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "have \"smap ?tsnd ((p, q) ## (u ||| v) ||| w ||| u ||| v) = q ## v ||| w ||| v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. smap\n     (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n         (p\\<^sub>2, a, q\\<^sub>2))\n     ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n    q ## v ||| w ||| v", "by (coinduction arbitrary: p q u v w) (auto simp flip: szip_unfold, metis stream.collapse)"], ["proof (state)\nthis:\n  smap\n   (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n       (p\\<^sub>2, a, q\\<^sub>2))\n   ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n  q ## v ||| w ||| v\n\ngoal (1 subgoal):\n 1. \\<And>c\\<^sub>1 c\\<^sub>2 w r s p q.\n       gen infs\n        [c\\<^sub>1 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>1, a, q\\<^sub>1)),\n         c\\<^sub>2 \\<circ>\n         (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n             (p\\<^sub>2, a, q\\<^sub>2))]\n        ((p, q) ## (r ||| s) ||| w ||| r ||| s) =\n       (infs c\\<^sub>1 (p ## r ||| w ||| r) \\<and>\n        infs c\\<^sub>2 (q ## s ||| w ||| s))", "finally"], ["proof (chain)\npicking this:\n  gen infs\n   [c\\<^sub>1 \\<circ>\n    (\\<lambda>a.\n        case a of\n        (a, b) \\<Rightarrow>\n          (case a of\n           (p\\<^sub>1, p\\<^sub>2) \\<Rightarrow>\n             \\<lambda>a.\n                case a of\n                (a, q\\<^sub>1, q\\<^sub>2) \\<Rightarrow>\n                  (p\\<^sub>1, a, q\\<^sub>1))\n           b),\n    c\\<^sub>2 \\<circ>\n    (\\<lambda>a.\n        case a of\n        (a, b) \\<Rightarrow>\n          (case a of\n           (p\\<^sub>1, p\\<^sub>2) \\<Rightarrow>\n             \\<lambda>a.\n                case a of\n                (a, q\\<^sub>1, q\\<^sub>2) \\<Rightarrow>\n                  (p\\<^sub>2, a, q\\<^sub>2))\n           b)]\n   ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n  (infs c\\<^sub>1 (p ## u ||| w ||| u) \\<and>\n   infs c\\<^sub>2 (q ## v ||| w ||| v))", "show \"gen infs [c\\<^sub>1 \\<circ> ?tfst, c\\<^sub>2 \\<circ> ?tsnd] ((p, q) ## (u ||| v) ||| w ||| u ||| v) \\<longleftrightarrow>\n      infs c\\<^sub>1 (p ## u ||| w ||| u) \\<and> infs c\\<^sub>2 (q ## v ||| w ||| v)\""], ["proof (prove)\nusing this:\n  gen infs\n   [c\\<^sub>1 \\<circ>\n    (\\<lambda>a.\n        case a of\n        (a, b) \\<Rightarrow>\n          (case a of\n           (p\\<^sub>1, p\\<^sub>2) \\<Rightarrow>\n             \\<lambda>a.\n                case a of\n                (a, q\\<^sub>1, q\\<^sub>2) \\<Rightarrow>\n                  (p\\<^sub>1, a, q\\<^sub>1))\n           b),\n    c\\<^sub>2 \\<circ>\n    (\\<lambda>a.\n        case a of\n        (a, b) \\<Rightarrow>\n          (case a of\n           (p\\<^sub>1, p\\<^sub>2) \\<Rightarrow>\n             \\<lambda>a.\n                case a of\n                (a, q\\<^sub>1, q\\<^sub>2) \\<Rightarrow>\n                  (p\\<^sub>2, a, q\\<^sub>2))\n           b)]\n   ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n  (infs c\\<^sub>1 (p ## u ||| w ||| u) \\<and>\n   infs c\\<^sub>2 (q ## v ||| w ||| v))\n\ngoal (1 subgoal):\n 1. gen infs\n     [c\\<^sub>1 \\<circ>\n      (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n          (p\\<^sub>1, a, q\\<^sub>1)),\n      c\\<^sub>2 \\<circ>\n      (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n          (p\\<^sub>2, a, q\\<^sub>2))]\n     ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n    (infs c\\<^sub>1 (p ## u ||| w ||| u) \\<and>\n     infs c\\<^sub>2 (q ## v ||| w ||| v))", "by this"], ["proof (state)\nthis:\n  gen infs\n   [c\\<^sub>1 \\<circ>\n    (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n        (p\\<^sub>1, a, q\\<^sub>1)),\n    c\\<^sub>2 \\<circ>\n    (\\<lambda>((p\\<^sub>1, p\\<^sub>2), a, q\\<^sub>1, q\\<^sub>2).\n        (p\\<^sub>2, a, q\\<^sub>2))]\n   ((p, q) ## (u ||| v) ||| w ||| u ||| v) =\n  (infs c\\<^sub>1 (p ## u ||| w ||| u) \\<and>\n   infs c\\<^sub>2 (q ## v ||| w ||| v))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas intersect'_language[simp] = intersection.product_language[folded NGBTA.language_def]"], ["", "lemmas intersect'_nodes_finite[intro] = intersection.product_nodes_finite[folded NGBTA.nodes_def]"], ["", "global_interpretation union: automaton_union_run\n    nbta nbta.alphabet nbta.initial nbta.transition nbta.accepting \"\\<lambda> P w r p. infs P (p ## r ||| w ||| r)\"\n    nbta nbta.alphabet nbta.initial nbta.transition nbta.accepting \"\\<lambda> P w r p. infs P (p ## r ||| w ||| r)\"\n    nbta nbta.alphabet nbta.initial nbta.transition nbta.accepting \"\\<lambda> P w r p. infs P (p ## r ||| w ||| r)\"\n    \"\\<lambda> c\\<^sub>1 c\\<^sub>2 m. case m of (Inl p, a, Inl q) \\<Rightarrow> c\\<^sub>1 (p, a, q) | (Inr p, a, Inr q) \\<Rightarrow> c\\<^sub>2 (p, a, q)\"\n    defines union = union.sum"], ["proof (prove)\ngoal (1 subgoal):\n 1. automaton_union_run nbta nbta.alphabet nbta.initial nbta.transition\n     nbta.accepting (\\<lambda>P w r p. infs P (p ## r ||| w ||| r)) nbta\n     nbta.alphabet nbta.initial nbta.transition nbta.accepting\n     (\\<lambda>P w r p. infs P (p ## r ||| w ||| r)) nbta nbta.alphabet\n     nbta.initial nbta.transition nbta.accepting\n     (\\<lambda>P w r p. infs P (p ## r ||| w ||| r))\n     (\\<lambda>c\\<^sub>1 c\\<^sub>2 m.\n         case m of (Inl p, a, Inl q) \\<Rightarrow> c\\<^sub>1 (p, a, q)\n         | (Inr p, a, Inr q) \\<Rightarrow> c\\<^sub>2 (p, a, q))", "by (unfold_locales) (auto simp add: szip_smap_fold comp_def case_prod_unfold simp flip: stream.map)"], ["", "lemmas union_language = union.sum_language"], ["", "lemmas union_nodes_finite = union.sum_nodes_finite"], ["", "abbreviation intersect where \"intersect A B \\<equiv> degeneralize (intersect' A B)\""], ["", "lemma intersect_language[simp]: \"NBTA.language (intersect A B) = NBTA.language A \\<inter> NBTA.language B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. NBTA.language (intersect A B) = NBTA.language A \\<inter> NBTA.language B", "by simp"], ["", "lemma intersect_nodes_finite[intro]:\n    assumes \"finite (NBTA.nodes A)\" \"finite (NBTA.nodes B)\"\n    shows \"finite (NBTA.nodes (intersect A B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (NBTA.nodes (intersect A B))", "using intersect'_nodes_finite assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>finite (NBTA.nodes ?A); finite (NBTA.nodes ?B)\\<rbrakk>\n  \\<Longrightarrow> finite (NGBTA.nodes (intersect' ?A ?B))\n  finite (NBTA.nodes A)\n  finite (NBTA.nodes B)\n\ngoal (1 subgoal):\n 1. finite (NBTA.nodes (intersect A B))", "by simp"], ["", "end"]]}