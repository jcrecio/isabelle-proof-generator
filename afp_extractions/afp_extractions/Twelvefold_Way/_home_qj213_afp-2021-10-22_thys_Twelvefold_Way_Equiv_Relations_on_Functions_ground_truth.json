{"file_name": "/home/qj213/afp-2021-10-22/thys/Twelvefold_Way/Equiv_Relations_on_Functions.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Twelvefold_Way", "problem_names": ["lemma equiv_domain_permutation:\n  \"equiv (A \\<rightarrow>\\<^sub>E B) (domain_permutation A B)\"", "lemma inj_on_respects_domain_permutation:\n  \"(\\<lambda>f. inj_on f A) respects domain_permutation A B\"", "lemma image_respects_domain_permutation:\n  \"(\\<lambda>f. f ` A) respects (domain_permutation A B)\"", "lemma surjective_respects_domain_permutation:\n  \"(\\<lambda>f. f ` A = B) respects domain_permutation A B\"", "lemma bij_betw_respects_domain_permutation:\n  \"(\\<lambda>f. bij_betw f A B) respects domain_permutation A B\"", "lemma image_mset_respects_domain_permutation:\n  shows \"(\\<lambda>f. image_mset f (mset_set A)) respects (domain_permutation A B)\"", "lemma equiv_range_permutation:\n  \"equiv (A \\<rightarrow>\\<^sub>E B) (range_permutation A B)\"", "lemma inj_on_respects_range_permutation:\n  \"(\\<lambda>f. inj_on f A) respects range_permutation A B\"", "lemma surj_on_respects_range_permutation:\n  \"(\\<lambda>f. f ` A = B) respects range_permutation A B\"", "lemma bij_betw_respects_range_permutation:\n  \"(\\<lambda>f. bij_betw f A B) respects range_permutation A B\"", "lemma domain_partitions_respects_range_permutation:\n  \"(\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) respects range_permutation A B\"", "lemma equiv_domain_and_range_permutation:\n  \"equiv (A \\<rightarrow>\\<^sub>E B) (domain_and_range_permutation A B)\"", "lemma inj_on_respects_domain_and_range_permutation:\n  \"(\\<lambda>f. inj_on f A) respects domain_and_range_permutation A B\"", "lemma surjective_respects_domain_and_range_permutation:\n  \"(\\<lambda>f. f ` A = B) respects domain_and_range_permutation A B\"", "lemma bij_betw_respects_domain_and_range_permutation:\n  \"(\\<lambda>f. bij_betw f A B) respects domain_and_range_permutation A B\"", "lemma count_image_mset':\n  \"count (image_mset f A) x = sum (count A) {x' \\<in> set_mset A. f x' = x}\"", "lemma multiset_of_partition_cards_respects_domain_and_range_permutation:\n  assumes \"finite B\"\n  shows \"(\\<lambda>f. image_mset (\\<lambda>X. card X) (mset_set (((\\<lambda>b. {x \\<in> A. f x = b})) ` B - {{}}))) respects domain_and_range_permutation A B\""], "translations": [["", "lemma equiv_domain_permutation:\n  \"equiv (A \\<rightarrow>\\<^sub>E B) (domain_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. equiv (A \\<rightarrow>\\<^sub>E B) (domain_permutation A B)", "proof (rule equivI)"], ["proof (state)\ngoal (3 subgoals):\n 1. refl_on (A \\<rightarrow>\\<^sub>E B) (domain_permutation A B)\n 2. sym (domain_permutation A B)\n 3. trans (domain_permutation A B)", "show \"refl_on (A \\<rightarrow>\\<^sub>E B) (domain_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. refl_on (A \\<rightarrow>\\<^sub>E B) (domain_permutation A B)", "proof (rule refl_onI)"], ["proof (state)\ngoal (2 subgoals):\n 1. domain_permutation A B\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)\n 2. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_permutation A B", "show \"domain_permutation A B \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times> (A \\<rightarrow>\\<^sub>E B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. domain_permutation A B\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)", "unfolding domain_permutation_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(f, f').\n     (f, f')\n     \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n           (A \\<rightarrow>\\<^sub>E B) \\<and>\n     (\\<exists>p. p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)", "by auto"], ["proof (state)\nthis:\n  domain_permutation A B\n  \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n              (A \\<rightarrow>\\<^sub>E B)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_permutation A B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_permutation A B", "fix f"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_permutation A B", "assume \"f \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_permutation A B", "from this"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B", "show \"(f, f) \\<in> domain_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. (f, f) \\<in> domain_permutation A B", "using permutes_id"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  id permutes ?S\n\ngoal (1 subgoal):\n 1. (f, f) \\<in> domain_permutation A B", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  id permutes ?S\n\ngoal (1 subgoal):\n 1. (f, f)\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p.\n               p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}", "by fastforce"], ["proof (state)\nthis:\n  (f, f) \\<in> domain_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  refl_on (A \\<rightarrow>\\<^sub>E B) (domain_permutation A B)\n\ngoal (2 subgoals):\n 1. sym (domain_permutation A B)\n 2. trans (domain_permutation A B)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. sym (domain_permutation A B)\n 2. trans (domain_permutation A B)", "show \"sym (domain_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sym (domain_permutation A B)", "proof (rule symI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "assume \"(f, f') \\<in> domain_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_permutation A B", "obtain p where \"p permutes A\" and \"\\<forall>x\\<in>A. f x = f' (p x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "from \\<open>(f, f') \\<in> domain_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_permutation A B", "have \"f \\<in> A \\<rightarrow>\\<^sub>E B\" \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B &&& f' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B &&& f' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "moreover"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "from \\<open>p permutes A\\<close>"], ["proof (chain)\npicking this:\n  p permutes A", "have \"inv p permutes A\""], ["proof (prove)\nusing this:\n  p permutes A\n\ngoal (1 subgoal):\n 1. inv p permutes A", "by (simp add: permutes_inv)"], ["proof (state)\nthis:\n  inv p permutes A\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "moreover"], ["proof (state)\nthis:\n  inv p permutes A\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "from \\<open>p permutes A\\<close> \\<open>\\<forall>x\\<in>A. f x = f' (p x)\\<close>"], ["proof (chain)\npicking this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)", "have \"\\<forall>x\\<in>A. f' x = f (inv p x)\""], ["proof (prove)\nusing this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = f (inv p x)", "using permutes_in_image permutes_inverses(1)"], ["proof (prove)\nusing this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n  ?p permutes ?S \\<Longrightarrow> (?p ?x \\<in> ?S) = (?x \\<in> ?S)\n  ?p permutes ?S \\<Longrightarrow> ?p (inv ?p ?x) = ?x\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = f (inv p x)", "by (metis (mono_tags, hide_lams))"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. f' x = f (inv p x)\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_permutation A B", "ultimately"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p permutes A\n  \\<forall>x\\<in>A. f' x = f (inv p x)", "show \"(f', f) \\<in> domain_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p permutes A\n  \\<forall>x\\<in>A. f' x = f (inv p x)\n\ngoal (1 subgoal):\n 1. (f', f) \\<in> domain_permutation A B", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p permutes A\n  \\<forall>x\\<in>A. f' x = f (inv p x)\n\ngoal (1 subgoal):\n 1. (f', f)\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p.\n               p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}", "by auto"], ["proof (state)\nthis:\n  (f', f) \\<in> domain_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  sym (domain_permutation A B)\n\ngoal (1 subgoal):\n 1. trans (domain_permutation A B)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. trans (domain_permutation A B)", "show \"trans (domain_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. trans (domain_permutation A B)", "proof (rule transI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "fix f f' f''"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "assume \"(f, f') \\<in> domain_permutation A B\" \"(f', f'') \\<in> domain_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_permutation A B\n  (f', f'') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "from \\<open>(f, f') \\<in> _\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_permutation A B", "obtain p where \"p permutes A\" and \"\\<forall>x\\<in>A. f x = f' (p x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "from \\<open>(f', f'') \\<in> _\\<close>"], ["proof (chain)\npicking this:\n  (f', f'') \\<in> domain_permutation A B", "obtain p' where \"p' permutes A\" and \"\\<forall>x\\<in>A. f' x = f'' (p' x)\""], ["proof (prove)\nusing this:\n  (f', f'') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p'.\n        \\<lbrakk>p' permutes A; \\<forall>x\\<in>A. f' x = f'' (p' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f', f'')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p'.\n        \\<lbrakk>p' permutes A; \\<forall>x\\<in>A. f' x = f'' (p' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p' permutes A\n  \\<forall>x\\<in>A. f' x = f'' (p' x)\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "from \\<open>(f, f') \\<in> domain_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_permutation A B", "have \"f \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "moreover"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "from \\<open>(f', f'') \\<in> domain_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f', f'') \\<in> domain_permutation A B", "have \"f'' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f', f'') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. f'' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f', f'')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. f'' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "moreover"], ["proof (state)\nthis:\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "from \\<open>p permutes A\\<close> \\<open>p' permutes A\\<close>"], ["proof (chain)\npicking this:\n  p permutes A\n  p' permutes A", "have \"(p' \\<circ> p) permutes A\""], ["proof (prove)\nusing this:\n  p permutes A\n  p' permutes A\n\ngoal (1 subgoal):\n 1. p' \\<circ> p permutes A", "by (simp add: permutes_compose)"], ["proof (state)\nthis:\n  p' \\<circ> p permutes A\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "moreover"], ["proof (state)\nthis:\n  p' \\<circ> p permutes A\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "have \"\\<forall>x\\<in>A. f x = f'' ((p' \\<circ> p) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f x = f'' ((p' \\<circ> p) x)", "using \\<open>\\<forall>x\\<in>A. f x = f' (p x)\\<close> \\<open>\\<forall>x\\<in>A. f' x = f'' (p' x)\\<close> \\<open>p permutes A\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = f' (p x)\n  \\<forall>x\\<in>A. f' x = f'' (p' x)\n  p permutes A\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f x = f'' ((p' \\<circ> p) x)", "by (simp add: permutes_in_image)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. f x = f'' ((p' \\<circ> p) x)\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_permutation A B;\n        (y, z) \\<in> domain_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_permutation A B", "ultimately"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p' \\<circ> p permutes A\n  \\<forall>x\\<in>A. f x = f'' ((p' \\<circ> p) x)", "show \"(f, f'') \\<in> domain_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p' \\<circ> p permutes A\n  \\<forall>x\\<in>A. f x = f'' ((p' \\<circ> p) x)\n\ngoal (1 subgoal):\n 1. (f, f'') \\<in> domain_permutation A B", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p' \\<circ> p permutes A\n  \\<forall>x\\<in>A. f x = f'' ((p' \\<circ> p) x)\n\ngoal (1 subgoal):\n 1. (f, f'')\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p.\n               p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}", "by auto"], ["proof (state)\nthis:\n  (f, f'') \\<in> domain_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  trans (domain_permutation A B)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Respecting Functions\\<close>"], ["", "lemma inj_on_respects_domain_permutation:\n  \"(\\<lambda>f. inj_on f A) respects domain_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. inj_on f A) respects domain_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "assume \"(f, f') \\<in> domain_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_permutation A B", "obtain p where p: \"p permutes A\" \"\\<forall>x\\<in>A. f x = f' (p x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "have inv_p: \"\\<forall>x\\<in>A. f' x = f (inv p x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = f (inv p x)", "using p"], ["proof (prove)\nusing this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = f (inv p x)", "by (metis permutes_inverses(1) permutes_not_in)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. f' x = f (inv p x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "show \"inj_on f A \\<longleftrightarrow> inj_on f' A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. inj_on f A \\<Longrightarrow> inj_on f' A\n 2. inj_on f' A \\<Longrightarrow> inj_on f A", "assume \"inj_on f A\""], ["proof (state)\nthis:\n  inj_on f A\n\ngoal (2 subgoals):\n 1. inj_on f A \\<Longrightarrow> inj_on f' A\n 2. inj_on f' A \\<Longrightarrow> inj_on f A", "show \"inj_on f' A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f' A", "proof (rule inj_onI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> A; y \\<in> A; f' x = f' y\\<rbrakk>\n       \\<Longrightarrow> x = y", "fix a a'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> A; y \\<in> A; f' x = f' y\\<rbrakk>\n       \\<Longrightarrow> x = y", "assume \"a \\<in> A\" \"a' \\<in> A\" \"f' a = f' a'\""], ["proof (state)\nthis:\n  a \\<in> A\n  a' \\<in> A\n  f' a = f' a'\n\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> A; y \\<in> A; f' x = f' y\\<rbrakk>\n       \\<Longrightarrow> x = y", "from this \\<open>p permutes A\\<close>"], ["proof (chain)\npicking this:\n  a \\<in> A\n  a' \\<in> A\n  f' a = f' a'\n  p permutes A", "have \"inv p a \\<in> A\" \"inv p a' \\<in> A\""], ["proof (prove)\nusing this:\n  a \\<in> A\n  a' \\<in> A\n  f' a = f' a'\n  p permutes A\n\ngoal (1 subgoal):\n 1. inv p a \\<in> A &&& inv p a' \\<in> A", "by (simp add:  permutes_in_image permutes_inv)+"], ["proof (state)\nthis:\n  inv p a \\<in> A\n  inv p a' \\<in> A\n\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> A; y \\<in> A; f' x = f' y\\<rbrakk>\n       \\<Longrightarrow> x = y", "have \"f (inv p a) = f (inv p a')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (inv p a) = f (inv p a')", "using \\<open>f' a = f' a'\\<close> \\<open>a \\<in> A\\<close> \\<open>a' \\<in> A\\<close> inv_p"], ["proof (prove)\nusing this:\n  f' a = f' a'\n  a \\<in> A\n  a' \\<in> A\n  \\<forall>x\\<in>A. f' x = f (inv p x)\n\ngoal (1 subgoal):\n 1. f (inv p a) = f (inv p a')", "by auto"], ["proof (state)\nthis:\n  f (inv p a) = f (inv p a')\n\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> A; y \\<in> A; f' x = f' y\\<rbrakk>\n       \\<Longrightarrow> x = y", "from \\<open>inj_on f A\\<close> this \\<open>inv p a \\<in> A\\<close> \\<open>inv p a' \\<in> A\\<close>"], ["proof (chain)\npicking this:\n  inj_on f A\n  f (inv p a) = f (inv p a')\n  inv p a \\<in> A\n  inv p a' \\<in> A", "have \"inv p a = inv p a'\""], ["proof (prove)\nusing this:\n  inj_on f A\n  f (inv p a) = f (inv p a')\n  inv p a \\<in> A\n  inv p a' \\<in> A\n\ngoal (1 subgoal):\n 1. inv p a = inv p a'", "using inj_on_contraD"], ["proof (prove)\nusing this:\n  inj_on f A\n  f (inv p a) = f (inv p a')\n  inv p a \\<in> A\n  inv p a' \\<in> A\n  \\<lbrakk>inj_on ?f ?A; ?x \\<noteq> ?y; ?x \\<in> ?A; ?y \\<in> ?A\\<rbrakk>\n  \\<Longrightarrow> ?f ?x \\<noteq> ?f ?y\n\ngoal (1 subgoal):\n 1. inv p a = inv p a'", "by fastforce"], ["proof (state)\nthis:\n  inv p a = inv p a'\n\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> A; y \\<in> A; f' x = f' y\\<rbrakk>\n       \\<Longrightarrow> x = y", "from this"], ["proof (chain)\npicking this:\n  inv p a = inv p a'", "show \"a = a'\""], ["proof (prove)\nusing this:\n  inv p a = inv p a'\n\ngoal (1 subgoal):\n 1. a = a'", "by (metis \\<open>p permutes A\\<close> permutes_inverses(1))"], ["proof (state)\nthis:\n  a = a'\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj_on f' A\n\ngoal (1 subgoal):\n 1. inj_on f' A \\<Longrightarrow> inj_on f A", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. inj_on f' A \\<Longrightarrow> inj_on f A", "assume \"inj_on f' A\""], ["proof (state)\nthis:\n  inj_on f' A\n\ngoal (1 subgoal):\n 1. inj_on f' A \\<Longrightarrow> inj_on f A", "from this p"], ["proof (chain)\npicking this:\n  inj_on f' A\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)", "show \"inj_on f A\""], ["proof (prove)\nusing this:\n  inj_on f' A\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. inj_on f A", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. \\<forall>y\\<in>A. f' x = f' y \\<longrightarrow> x = y\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. \\<forall>y\\<in>A. f x = f y \\<longrightarrow> x = y", "by (metis inj_on_contraD permutes_in_image permutes_inj_on)"], ["proof (state)\nthis:\n  inj_on f A\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj_on f A = inj_on f' A\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma image_respects_domain_permutation:\n  \"(\\<lambda>f. f ` A) respects (domain_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. f ` A) respects domain_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow> y ` A = z ` A", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow> y ` A = z ` A", "assume \"(f, f') \\<in> domain_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow> y ` A = z ` A", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_permutation A B", "obtain p where p: \"p permutes A\" and f_eq: \"\\<forall>x\\<in>A. f x = f' (p x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow> y ` A = z ` A", "show \"f ` A = f' ` A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ` A = f' ` A", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. f ` A \\<subseteq> f' ` A\n 2. f' ` A \\<subseteq> f ` A", "from p f_eq"], ["proof (chain)\npicking this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)", "show \"f ` A \\<subseteq> f' ` A\""], ["proof (prove)\nusing this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. f ` A \\<subseteq> f' ` A", "by (auto simp add: permutes_in_image)"], ["proof (state)\nthis:\n  f ` A \\<subseteq> f' ` A\n\ngoal (1 subgoal):\n 1. f' ` A \\<subseteq> f ` A", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f' ` A \\<subseteq> f ` A", "from \\<open>p permutes A\\<close> \\<open>\\<forall>x\\<in>A. f x = f' (p x)\\<close>"], ["proof (chain)\npicking this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)", "have \"\\<forall>x\\<in>A. f' x = f (inv p x)\""], ["proof (prove)\nusing this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = f (inv p x)", "using permutes_in_image permutes_inverses(1)"], ["proof (prove)\nusing this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n  ?p permutes ?S \\<Longrightarrow> (?p ?x \\<in> ?S) = (?x \\<in> ?S)\n  ?p permutes ?S \\<Longrightarrow> ?p (inv ?p ?x) = ?x\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = f (inv p x)", "by (metis (mono_tags, hide_lams))"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. f' x = f (inv p x)\n\ngoal (1 subgoal):\n 1. f' ` A \\<subseteq> f ` A", "from this"], ["proof (chain)\npicking this:\n  \\<forall>x\\<in>A. f' x = f (inv p x)", "show \"f' ` A \\<subseteq> f ` A\""], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f' x = f (inv p x)\n\ngoal (1 subgoal):\n 1. f' ` A \\<subseteq> f ` A", "using \\<open>p permutes A\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f' x = f (inv p x)\n  p permutes A\n\ngoal (1 subgoal):\n 1. f' ` A \\<subseteq> f ` A", "by (auto simp add: permutes_inv permutes_in_image)"], ["proof (state)\nthis:\n  f' ` A \\<subseteq> f ` A\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f ` A = f' ` A\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma surjective_respects_domain_permutation:\n  \"(\\<lambda>f. f ` A = B) respects domain_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. f ` A = B) respects domain_permutation A B", "by (metis image_respects_domain_permutation congruentD congruentI)"], ["", "lemma bij_betw_respects_domain_permutation:\n  \"(\\<lambda>f. bij_betw f A B) respects domain_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. bij_betw f A B) respects domain_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "assume \"(f, f') \\<in> domain_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_permutation A B", "obtain p where \"p permutes A\" and \"\\<forall>x\\<in>A. f x = f' (p x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "have \"bij_betw f A B \\<longleftrightarrow> bij_betw (f' o p) A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw (f' \\<circ> p) A B", "using \\<open>\\<forall>x\\<in>A. f x = f' (p x)\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw (f' \\<circ> p) A B", "by (metis (mono_tags, hide_lams) bij_betw_cong comp_apply)"], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw (f' \\<circ> p) A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "also"], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw (f' \\<circ> p) A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "have \"... \\<longleftrightarrow> bij_betw f' A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (f' \\<circ> p) A B = bij_betw f' A B", "using \\<open>p permutes A\\<close>"], ["proof (prove)\nusing this:\n  p permutes A\n\ngoal (1 subgoal):\n 1. bij_betw (f' \\<circ> p) A B = bij_betw f' A B", "by (auto intro!: bij_betw_comp_iff[symmetric] permutes_imp_bij)"], ["proof (state)\nthis:\n  bij_betw (f' \\<circ> p) A B = bij_betw f' A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "finally"], ["proof (chain)\npicking this:\n  bij_betw f A B = bij_betw f' A B", "show \"bij_betw f A B \\<longleftrightarrow> bij_betw f' A B\""], ["proof (prove)\nusing this:\n  bij_betw f A B = bij_betw f' A B\n\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw f' A B", "."], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw f' A B\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma image_mset_respects_domain_permutation:\n  shows \"(\\<lambda>f. image_mset f (mset_set A)) respects (domain_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. image_mset f (mset_set A)) respects domain_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       image_mset y (mset_set A) = image_mset z (mset_set A)", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       image_mset y (mset_set A) = image_mset z (mset_set A)", "assume \"(f, f') \\<in> domain_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       image_mset y (mset_set A) = image_mset z (mset_set A)", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_permutation A B", "obtain p where \"p permutes A\" and \"\\<forall>x\\<in>A. f x = f' (p x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes A \\<and> (\\<forall>x\\<in>A. f x = f' (p x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes A; \\<forall>x\\<in>A. f x = f' (p x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_permutation A B \\<Longrightarrow>\n       image_mset y (mset_set A) = image_mset z (mset_set A)", "from this"], ["proof (chain)\npicking this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)", "show \"image_mset f (mset_set A) = image_mset f' (mset_set A)\""], ["proof (prove)\nusing this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n\ngoal (1 subgoal):\n 1. image_mset f (mset_set A) = image_mset f' (mset_set A)", "using permutes_implies_image_mset_eq"], ["proof (prove)\nusing this:\n  p permutes A\n  \\<forall>x\\<in>A. f x = f' (p x)\n  \\<lbrakk>?p permutes ?A;\n   \\<And>x. x \\<in> ?A \\<Longrightarrow> ?f x = ?f' (?p x)\\<rbrakk>\n  \\<Longrightarrow> image_mset ?f' (mset_set ?A) =\n                    image_mset ?f (mset_set ?A)\n\ngoal (1 subgoal):\n 1. image_mset f (mset_set A) = image_mset f' (mset_set A)", "by fastforce"], ["proof (state)\nthis:\n  image_mset f (mset_set A) = image_mset f' (mset_set A)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Permutation on the Range\\<close>"], ["", "definition range_permutation\nwhere\n  \"range_permutation A B = {(f, f') \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times> (A \\<rightarrow>\\<^sub>E B). \\<exists>p. p permutes B \\<and> (\\<forall>x \\<in> A. f x = p (f' x))}\""], ["", "lemma equiv_range_permutation:\n  \"equiv (A \\<rightarrow>\\<^sub>E B) (range_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. equiv (A \\<rightarrow>\\<^sub>E B) (range_permutation A B)", "proof (rule equivI)"], ["proof (state)\ngoal (3 subgoals):\n 1. refl_on (A \\<rightarrow>\\<^sub>E B) (range_permutation A B)\n 2. sym (range_permutation A B)\n 3. trans (range_permutation A B)", "show \"refl_on (A \\<rightarrow>\\<^sub>E B) (range_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. refl_on (A \\<rightarrow>\\<^sub>E B) (range_permutation A B)", "proof (rule refl_onI)"], ["proof (state)\ngoal (2 subgoals):\n 1. range_permutation A B\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)\n 2. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> range_permutation A B", "show \"range_permutation A B \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times> (A \\<rightarrow>\\<^sub>E B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range_permutation A B\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)", "unfolding range_permutation_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(f, f').\n     (f, f')\n     \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n           (A \\<rightarrow>\\<^sub>E B) \\<and>\n     (\\<exists>p. p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)", "by auto"], ["proof (state)\nthis:\n  range_permutation A B\n  \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n              (A \\<rightarrow>\\<^sub>E B)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> range_permutation A B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> range_permutation A B", "fix f"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> range_permutation A B", "assume \"f \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> range_permutation A B", "from this"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B", "show \"(f, f) \\<in> range_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. (f, f) \\<in> range_permutation A B", "using permutes_id"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  id permutes ?S\n\ngoal (1 subgoal):\n 1. (f, f) \\<in> range_permutation A B", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  id permutes ?S\n\ngoal (1 subgoal):\n 1. (f, f)\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p.\n               p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}", "by fastforce"], ["proof (state)\nthis:\n  (f, f) \\<in> range_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  refl_on (A \\<rightarrow>\\<^sub>E B) (range_permutation A B)\n\ngoal (2 subgoals):\n 1. sym (range_permutation A B)\n 2. trans (range_permutation A B)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. sym (range_permutation A B)\n 2. trans (range_permutation A B)", "show \"sym (range_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sym (range_permutation A B)", "proof (rule symI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "assume \"(f, f') \\<in> range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "obtain p where \"p permutes B\" and \"\\<forall>x\\<in>A. f x = p (f' x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "from \\<open>(f, f') \\<in> range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "have \"f \\<in> A \\<rightarrow>\\<^sub>E B\" \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B &&& f' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B &&& f' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "moreover"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "from \\<open>p permutes B\\<close>"], ["proof (chain)\npicking this:\n  p permutes B", "have \"inv p permutes B\""], ["proof (prove)\nusing this:\n  p permutes B\n\ngoal (1 subgoal):\n 1. inv p permutes B", "by (simp add: permutes_inv)"], ["proof (state)\nthis:\n  inv p permutes B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "moreover"], ["proof (state)\nthis:\n  inv p permutes B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "from \\<open>p permutes B\\<close> \\<open>\\<forall>x\\<in>A. f x = p (f' x)\\<close>"], ["proof (chain)\npicking this:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)", "have \"\\<forall>x\\<in>A. f' x = inv p (f x)\""], ["proof (prove)\nusing this:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = inv p (f x)", "by (simp add: permutes_inverses(2))"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. f' x = inv p (f x)\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> range_permutation A B", "ultimately"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p permutes B\n  \\<forall>x\\<in>A. f' x = inv p (f x)", "show \"(f', f) \\<in> range_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p permutes B\n  \\<forall>x\\<in>A. f' x = inv p (f x)\n\ngoal (1 subgoal):\n 1. (f', f) \\<in> range_permutation A B", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p permutes B\n  \\<forall>x\\<in>A. f' x = inv p (f x)\n\ngoal (1 subgoal):\n 1. (f', f)\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p.\n               p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}", "by auto"], ["proof (state)\nthis:\n  (f', f) \\<in> range_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  sym (range_permutation A B)\n\ngoal (1 subgoal):\n 1. trans (range_permutation A B)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. trans (range_permutation A B)", "show \"trans (range_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. trans (range_permutation A B)", "proof (rule transI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "fix f f' f''"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "assume \"(f, f') \\<in> range_permutation A B\" \"(f', f'') \\<in> range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> range_permutation A B\n  (f', f'') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "from \\<open>(f, f') \\<in> _\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "obtain p where \"p permutes B\" and \"\\<forall>x\\<in>A. f x = p (f' x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "from \\<open>(f', f'') \\<in> _\\<close>"], ["proof (chain)\npicking this:\n  (f', f'') \\<in> range_permutation A B", "obtain p' where \"p' permutes B\" and \"\\<forall>x\\<in>A. f' x = p' (f'' x)\""], ["proof (prove)\nusing this:\n  (f', f'') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p'.\n        \\<lbrakk>p' permutes B; \\<forall>x\\<in>A. f' x = p' (f'' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f', f'')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p'.\n        \\<lbrakk>p' permutes B; \\<forall>x\\<in>A. f' x = p' (f'' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p' permutes B\n  \\<forall>x\\<in>A. f' x = p' (f'' x)\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "from \\<open>(f, f') \\<in> range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "have \"f \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "moreover"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "from \\<open>(f', f'') \\<in> range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f', f'') \\<in> range_permutation A B", "have \"f'' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f', f'') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. f'' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f', f'')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. f'' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "moreover"], ["proof (state)\nthis:\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "from \\<open>p permutes B\\<close> \\<open>p' permutes B\\<close>"], ["proof (chain)\npicking this:\n  p permutes B\n  p' permutes B", "have \"(p \\<circ> p') permutes B\""], ["proof (prove)\nusing this:\n  p permutes B\n  p' permutes B\n\ngoal (1 subgoal):\n 1. p \\<circ> p' permutes B", "by (simp add: permutes_compose)"], ["proof (state)\nthis:\n  p \\<circ> p' permutes B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "moreover"], ["proof (state)\nthis:\n  p \\<circ> p' permutes B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "have \"\\<forall>x\\<in>A. f x = (p \\<circ> p') (f'' x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f x = (p \\<circ> p') (f'' x)", "using \\<open>\\<forall>x\\<in>A. f x = p (f' x)\\<close> \\<open>\\<forall>x\\<in>A. f' x = p' (f'' x)\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p (f' x)\n  \\<forall>x\\<in>A. f' x = p' (f'' x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f x = (p \\<circ> p') (f'' x)", "by auto"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. f x = (p \\<circ> p') (f'' x)\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> range_permutation A B;\n        (y, z) \\<in> range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> range_permutation A B", "ultimately"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p \\<circ> p' permutes B\n  \\<forall>x\\<in>A. f x = (p \\<circ> p') (f'' x)", "show \"(f, f'') \\<in> range_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p \\<circ> p' permutes B\n  \\<forall>x\\<in>A. f x = (p \\<circ> p') (f'' x)\n\ngoal (1 subgoal):\n 1. (f, f'') \\<in> range_permutation A B", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p \\<circ> p' permutes B\n  \\<forall>x\\<in>A. f x = (p \\<circ> p') (f'' x)\n\ngoal (1 subgoal):\n 1. (f, f'')\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p.\n               p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}", "by auto"], ["proof (state)\nthis:\n  (f, f'') \\<in> range_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  trans (range_permutation A B)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Respecting Functions\\<close>"], ["", "lemma inj_on_respects_range_permutation:\n  \"(\\<lambda>f. inj_on f A) respects range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. inj_on f A) respects range_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "assume \"(f, f') \\<in> range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "obtain p where p: \"p permutes B\" \"\\<forall>x\\<in>A. f x = p (f' x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "have inv_p: \"\\<forall>x\\<in>A. f' x = inv p (f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = inv p (f x)", "using p"], ["proof (prove)\nusing this:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = inv p (f x)", "by (simp add: permutes_inverses(2))"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. f' x = inv p (f x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "show \"inj_on f A \\<longleftrightarrow> inj_on f' A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. inj_on f A \\<Longrightarrow> inj_on f' A\n 2. inj_on f' A \\<Longrightarrow> inj_on f A", "assume \"inj_on f A\""], ["proof (state)\nthis:\n  inj_on f A\n\ngoal (2 subgoals):\n 1. inj_on f A \\<Longrightarrow> inj_on f' A\n 2. inj_on f' A \\<Longrightarrow> inj_on f A", "from this p"], ["proof (chain)\npicking this:\n  inj_on f A\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)", "show \"inj_on f' A\""], ["proof (prove)\nusing this:\n  inj_on f A\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. inj_on f' A", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. \\<forall>y\\<in>A. f x = f y \\<longrightarrow> x = y\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. \\<forall>y\\<in>A. f' x = f' y \\<longrightarrow> x = y", "by auto"], ["proof (state)\nthis:\n  inj_on f' A\n\ngoal (1 subgoal):\n 1. inj_on f' A \\<Longrightarrow> inj_on f A", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. inj_on f' A \\<Longrightarrow> inj_on f A", "assume \"inj_on f' A\""], ["proof (state)\nthis:\n  inj_on f' A\n\ngoal (1 subgoal):\n 1. inj_on f' A \\<Longrightarrow> inj_on f A", "from this inv_p"], ["proof (chain)\npicking this:\n  inj_on f' A\n  \\<forall>x\\<in>A. f' x = inv p (f x)", "show \"inj_on f A\""], ["proof (prove)\nusing this:\n  inj_on f' A\n  \\<forall>x\\<in>A. f' x = inv p (f x)\n\ngoal (1 subgoal):\n 1. inj_on f A", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. \\<forall>y\\<in>A. f' x = f' y \\<longrightarrow> x = y\n  \\<forall>x\\<in>A. f' x = inv p (f x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. \\<forall>y\\<in>A. f x = f y \\<longrightarrow> x = y", "by auto"], ["proof (state)\nthis:\n  inj_on f A\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj_on f A = inj_on f' A\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma surj_on_respects_range_permutation:\n  \"(\\<lambda>f. f ` A = B) respects range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. f ` A = B) respects range_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "assume a: \"(f, f') \\<in> range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "have \"f \\<in> A \\<rightarrow>\\<^sub>E B\" \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B &&& f' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B &&& f' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "from a"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "obtain p where p: \"p permutes B\" \"\\<forall>x\\<in>A. f x = p (f' x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "have 1: \"f ` A = (\\<lambda>x. p (f' x)) ` A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ` A = (\\<lambda>x. p (f' x)) ` A", "using p"], ["proof (prove)\nusing this:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. f ` A = (\\<lambda>x. p (f' x)) ` A", "by (meson image_cong)"], ["proof (state)\nthis:\n  f ` A = (\\<lambda>x. p (f' x)) ` A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "have 2: \"inv p ` ((\\<lambda>x. p (f' x)) ` A) = f' ` A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A", "using p"], ["proof (prove)\nusing this:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A", "by (simp add: image_image image_inv_f_f permutes_inj)"], ["proof (state)\nthis:\n  inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "show \"(f ` A = B) = (f' ` A = B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. f ` A = B \\<Longrightarrow> f' ` A = B\n 2. f' ` A = B \\<Longrightarrow> f ` A = B", "assume \"f ` A = B\""], ["proof (state)\nthis:\n  f ` A = B\n\ngoal (2 subgoals):\n 1. f ` A = B \\<Longrightarrow> f' ` A = B\n 2. f' ` A = B \\<Longrightarrow> f ` A = B", "from this 1 2"], ["proof (chain)\npicking this:\n  f ` A = B\n  f ` A = (\\<lambda>x. p (f' x)) ` A\n  inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A", "show \"f' ` A = B\""], ["proof (prove)\nusing this:\n  f ` A = B\n  f ` A = (\\<lambda>x. p (f' x)) ` A\n  inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A\n\ngoal (1 subgoal):\n 1. f' ` A = B", "using p"], ["proof (prove)\nusing this:\n  f ` A = B\n  f ` A = (\\<lambda>x. p (f' x)) ` A\n  inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. f' ` A = B", "by (simp add: permutes_image permutes_inv)"], ["proof (state)\nthis:\n  f' ` A = B\n\ngoal (1 subgoal):\n 1. f' ` A = B \\<Longrightarrow> f ` A = B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f' ` A = B \\<Longrightarrow> f ` A = B", "assume \"f' ` A = B\""], ["proof (state)\nthis:\n  f' ` A = B\n\ngoal (1 subgoal):\n 1. f' ` A = B \\<Longrightarrow> f ` A = B", "from this 1 2"], ["proof (chain)\npicking this:\n  f' ` A = B\n  f ` A = (\\<lambda>x. p (f' x)) ` A\n  inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A", "show \"f ` A = B\""], ["proof (prove)\nusing this:\n  f' ` A = B\n  f ` A = (\\<lambda>x. p (f' x)) ` A\n  inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A\n\ngoal (1 subgoal):\n 1. f ` A = B", "using p"], ["proof (prove)\nusing this:\n  f' ` A = B\n  f ` A = (\\<lambda>x. p (f' x)) ` A\n  inv p ` (\\<lambda>x. p (f' x)) ` A = f' ` A\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. f ` A = B", "by (metis image_image permutes_image)"], ["proof (state)\nthis:\n  f ` A = B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (f ` A = B) = (f' ` A = B)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bij_betw_respects_range_permutation:\n  \"(\\<lambda>f. bij_betw f A B) respects range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. bij_betw f A B) respects range_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "assume \"(f, f') \\<in> range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "obtain p where \"p permutes B\" and \"\\<forall>x\\<in>A. f x = p (f' x)\"\n    and \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x);\n         f' \\<in> A \\<rightarrow>\\<^sub>E B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x);\n         f' \\<in> A \\<rightarrow>\\<^sub>E B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "have \"bij_betw f A B \\<longleftrightarrow> bij_betw (p o f') A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw (p \\<circ> f') A B", "using \\<open>\\<forall>x\\<in>A. f x = p (f' x)\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw (p \\<circ> f') A B", "by (metis (mono_tags, hide_lams) bij_betw_cong comp_apply)"], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw (p \\<circ> f') A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "also"], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw (p \\<circ> f') A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "have \"... \\<longleftrightarrow> bij_betw f' A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (p \\<circ> f') A B = bij_betw f' A B", "using \\<open>f' \\<in> A \\<rightarrow>\\<^sub>E B\\<close> \\<open>p permutes B\\<close>"], ["proof (prove)\nusing this:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  p permutes B\n\ngoal (1 subgoal):\n 1. bij_betw (p \\<circ> f') A B = bij_betw f' A B", "by (auto intro!: bij_betw_comp_iff2[symmetric] permutes_imp_bij)"], ["proof (state)\nthis:\n  bij_betw (p \\<circ> f') A B = bij_betw f' A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "finally"], ["proof (chain)\npicking this:\n  bij_betw f A B = bij_betw f' A B", "show \"bij_betw f A B \\<longleftrightarrow> bij_betw f' A B\""], ["proof (prove)\nusing this:\n  bij_betw f A B = bij_betw f' A B\n\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw f' A B", "."], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw f' A B\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma domain_partitions_respects_range_permutation:\n  \"(\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) respects range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) respects\n    range_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "assume \"(f, f') \\<in> range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "obtain p where p: \"p permutes B\" \"\\<forall>x \\<in> A. f x = p (f' x)\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "have \"{} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B \\<longleftrightarrow> \\<not> (\\<forall>b \\<in> B. \\<exists>x \\<in> A. f' x = b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n    (\\<not> (\\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b))", "by auto"], ["proof (state)\nthis:\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n  (\\<not> (\\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "also"], ["proof (state)\nthis:\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n  (\\<not> (\\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "have \"(\\<forall>b \\<in> B. \\<exists>x \\<in> A. f' x = b) \\<longleftrightarrow> (\\<forall>b \\<in> B. \\<exists>x \\<in> A. p (f' x) = b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b) =\n    (\\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b \\<Longrightarrow>\n    \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b\n 2. \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b \\<Longrightarrow>\n    \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b", "assume \"\\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b\""], ["proof (state)\nthis:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b\n\ngoal (2 subgoals):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b \\<Longrightarrow>\n    \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b\n 2. \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b \\<Longrightarrow>\n    \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b", "from this"], ["proof (chain)\npicking this:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b", "show \"\\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b\""], ["proof (prove)\nusing this:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b\n\ngoal (1 subgoal):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b", "using \\<open>p permutes B\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b\n  p permutes B\n\ngoal (1 subgoal):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b", "unfolding permutes_def"], ["proof (prove)\nusing this:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b\n  (\\<forall>x. x \\<notin> B \\<longrightarrow> p x = x) \\<and>\n  (\\<forall>y. \\<exists>!x. p x = y)\n\ngoal (1 subgoal):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b", "by metis"], ["proof (state)\nthis:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b\n\ngoal (1 subgoal):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b \\<Longrightarrow>\n    \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b \\<Longrightarrow>\n    \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b", "assume \"\\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b\""], ["proof (state)\nthis:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b\n\ngoal (1 subgoal):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b \\<Longrightarrow>\n    \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b", "from this"], ["proof (chain)\npicking this:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b", "show \"\\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b\""], ["proof (prove)\nusing this:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b\n\ngoal (1 subgoal):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b", "using \\<open>p permutes B\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b\n  p permutes B\n\ngoal (1 subgoal):\n 1. \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b", "by (metis bij_betwE permutes_imp_bij permutes_inverses(2))"], ["proof (state)\nthis:\n  \\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b) =\n  (\\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "also"], ["proof (state)\nthis:\n  (\\<forall>b\\<in>B. \\<exists>x\\<in>A. f' x = b) =\n  (\\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "have \"\\<not> (\\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b) \\<longleftrightarrow> {} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<not> (\\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b)) =\n    ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)", "by auto"], ["proof (state)\nthis:\n  (\\<not> (\\<forall>b\\<in>B. \\<exists>x\\<in>A. p (f' x) = b)) =\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "finally"], ["proof (chain)\npicking this:\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)", "have \"{} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B \\<longleftrightarrow> {} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B\""], ["proof (prove)\nusing this:\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)\n\ngoal (1 subgoal):\n 1. ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n    ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)", "."], ["proof (state)\nthis:\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "moreover"], ["proof (state)\nthis:\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "have \"(\\<lambda>b. {x \\<in> A. f' x = b}) ` B = (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B =\n    (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B", "using \\<open>p permutes B\\<close> permutes_implies_inv_image_on_eq"], ["proof (prove)\nusing this:\n  p permutes B\n  ?p permutes ?B \\<Longrightarrow>\n  (\\<lambda>b. {x \\<in> ?A. ?p (?f x) = b}) ` ?B =\n  (\\<lambda>b. {x \\<in> ?A. ?f x = b}) ` ?B\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B =\n    (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B", "by blast"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B =\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "ultimately"], ["proof (chain)\npicking this:\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B =\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B", "have \"(\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}\""], ["proof (prove)\nusing this:\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B) =\n  ({} \\<in> (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B)\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B =\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "also"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "have \"\\<dots> = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "using \\<open>\\<forall>x \\<in> A. f x = p (f' x)\\<close> Collect_cong image_cong"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p (f' x)\n  (\\<And>x. ?P x = ?Q x) \\<Longrightarrow> {x. ?P x} = {x. ?Q x}\n  \\<lbrakk>?M = ?N;\n   \\<And>x. x \\<in> ?N \\<Longrightarrow> ?f x = ?g x\\<rbrakk>\n  \\<Longrightarrow> ?f ` ?M = ?g ` ?N\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> range_permutation A B \\<Longrightarrow>\n       (\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}} =\n       (\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "show \"(\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\""], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}", ".."], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Permutation on the Domain and the Range\\<close>"], ["", "definition domain_and_range_permutation\nwhere\n  \"domain_and_range_permutation A B = {(f, f') \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times> (A \\<rightarrow>\\<^sub>E B).\n    \\<exists>p\\<^sub>A p\\<^sub>B. p\\<^sub>A permutes A \\<and> p\\<^sub>B permutes B \\<and> (\\<forall>x \\<in> A. f x = p\\<^sub>B (f' (p\\<^sub>A x)))}\""], ["", "lemma equiv_domain_and_range_permutation:\n  \"equiv (A \\<rightarrow>\\<^sub>E B) (domain_and_range_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. equiv (A \\<rightarrow>\\<^sub>E B) (domain_and_range_permutation A B)", "proof (rule equivI)"], ["proof (state)\ngoal (3 subgoals):\n 1. refl_on (A \\<rightarrow>\\<^sub>E B) (domain_and_range_permutation A B)\n 2. sym (domain_and_range_permutation A B)\n 3. trans (domain_and_range_permutation A B)", "show \"refl_on (A \\<rightarrow>\\<^sub>E B) (domain_and_range_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. refl_on (A \\<rightarrow>\\<^sub>E B) (domain_and_range_permutation A B)", "proof (rule refl_onI)"], ["proof (state)\ngoal (2 subgoals):\n 1. domain_and_range_permutation A B\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)\n 2. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_and_range_permutation A B", "show \"domain_and_range_permutation A B \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times> (A \\<rightarrow>\\<^sub>E B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. domain_and_range_permutation A B\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)", "unfolding domain_and_range_permutation_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(f, f').\n     (f, f')\n     \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n           (A \\<rightarrow>\\<^sub>E B) \\<and>\n     (\\<exists>p\\<^sub>A p\\<^sub>B.\n         p\\<^sub>A permutes A \\<and>\n         p\\<^sub>B permutes B \\<and>\n         (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                (A \\<rightarrow>\\<^sub>E B)", "by auto"], ["proof (state)\nthis:\n  domain_and_range_permutation A B\n  \\<subseteq> (A \\<rightarrow>\\<^sub>E B) \\<times>\n              (A \\<rightarrow>\\<^sub>E B)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_and_range_permutation A B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_and_range_permutation A B", "fix f"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_and_range_permutation A B", "assume \"f \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<rightarrow>\\<^sub>E B \\<Longrightarrow>\n       (x, x) \\<in> domain_and_range_permutation A B", "from this"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B", "show \"(f, f) \\<in> domain_and_range_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. (f, f) \\<in> domain_and_range_permutation A B", "using permutes_id[of A] permutes_id[of B]"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  id permutes A\n  id permutes B\n\ngoal (1 subgoal):\n 1. (f, f) \\<in> domain_and_range_permutation A B", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  id permutes A\n  id permutes B\n\ngoal (1 subgoal):\n 1. (f, f)\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p\\<^sub>A p\\<^sub>B.\n               p\\<^sub>A permutes A \\<and>\n               p\\<^sub>B permutes B \\<and>\n               (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}", "by fastforce"], ["proof (state)\nthis:\n  (f, f) \\<in> domain_and_range_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  refl_on (A \\<rightarrow>\\<^sub>E B) (domain_and_range_permutation A B)\n\ngoal (2 subgoals):\n 1. sym (domain_and_range_permutation A B)\n 2. trans (domain_and_range_permutation A B)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. sym (domain_and_range_permutation A B)\n 2. trans (domain_and_range_permutation A B)", "show \"sym (domain_and_range_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sym (domain_and_range_permutation A B)", "proof (rule symI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "assume \"(f, f') \\<in> domain_and_range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "obtain p\\<^sub>A p\\<^sub>B where \"p\\<^sub>A permutes A\" \"p\\<^sub>B permutes B\" and \"\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "from \\<open>(f, f') \\<in> domain_and_range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "have f: \"f \\<in> A \\<rightarrow>\\<^sub>E B\" \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B &&& f' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B &&& f' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "moreover"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "from \\<open>p\\<^sub>A permutes A\\<close> \\<open>p\\<^sub>B permutes B\\<close>"], ["proof (chain)\npicking this:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B", "have \"inv p\\<^sub>A permutes A\" \"inv p\\<^sub>B permutes B\""], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. inv p\\<^sub>A permutes A &&& inv p\\<^sub>B permutes B", "by (auto simp add: permutes_inv)"], ["proof (state)\nthis:\n  inv p\\<^sub>A permutes A\n  inv p\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "moreover"], ["proof (state)\nthis:\n  inv p\\<^sub>A permutes A\n  inv p\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "from \\<open>\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<close>"], ["proof (chain)\npicking this:\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))", "have \"\\<forall>x\\<in>A. f' x = inv p\\<^sub>B (f (inv p\\<^sub>A x))\""], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = inv p\\<^sub>B (f (inv p\\<^sub>A x))", "using \\<open>p\\<^sub>A permutes A\\<close> \\<open>p\\<^sub>B permutes B\\<close> \\<open>inv p\\<^sub>A permutes A\\<close> \\<open>inv p\\<^sub>B permutes B\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n  inv p\\<^sub>A permutes A\n  inv p\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A. f' x = inv p\\<^sub>B (f (inv p\\<^sub>A x))", "by (metis (no_types, lifting) bij_betwE bij_inv_eq_iff permutes_bij permutes_imp_bij)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A. f' x = inv p\\<^sub>B (f (inv p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (b, a) \\<in> domain_and_range_permutation A B", "ultimately"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p\\<^sub>A permutes A\n  inv p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f' x = inv p\\<^sub>B (f (inv p\\<^sub>A x))", "show \"(f', f) \\<in> domain_and_range_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p\\<^sub>A permutes A\n  inv p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f' x = inv p\\<^sub>B (f (inv p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. (f', f) \\<in> domain_and_range_permutation A B", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  inv p\\<^sub>A permutes A\n  inv p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f' x = inv p\\<^sub>B (f (inv p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. (f', f)\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p\\<^sub>A p\\<^sub>B.\n               p\\<^sub>A permutes A \\<and>\n               p\\<^sub>B permutes B \\<and>\n               (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}", "by auto"], ["proof (state)\nthis:\n  (f', f) \\<in> domain_and_range_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  sym (domain_and_range_permutation A B)\n\ngoal (1 subgoal):\n 1. trans (domain_and_range_permutation A B)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. trans (domain_and_range_permutation A B)", "show \"trans (domain_and_range_permutation A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. trans (domain_and_range_permutation A B)", "proof (rule transI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "fix f f' f''"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "assume \"(f, f') \\<in> domain_and_range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "assume \"(f', f'') \\<in> domain_and_range_permutation A B\""], ["proof (state)\nthis:\n  (f', f'') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "from \\<open>(f, f') \\<in> _\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "obtain p\\<^sub>A p\\<^sub>B where\n      \"p\\<^sub>A permutes A\" \"p\\<^sub>B permutes B\" and \"\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "from \\<open>(f', f'') \\<in> _\\<close>"], ["proof (chain)\npicking this:\n  (f', f'') \\<in> domain_and_range_permutation A B", "obtain p'\\<^sub>A p'\\<^sub>B where\n      \"p'\\<^sub>A permutes A\" \"p'\\<^sub>B permutes B\" and \"\\<forall>x\\<in>A. f' x = p'\\<^sub>B (f'' (p'\\<^sub>A x))\""], ["proof (prove)\nusing this:\n  (f', f'') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p'\\<^sub>A p'\\<^sub>B.\n        \\<lbrakk>p'\\<^sub>A permutes A; p'\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f' x = p'\\<^sub>B (f'' (p'\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f', f'')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. (\\<And>p'\\<^sub>A p'\\<^sub>B.\n        \\<lbrakk>p'\\<^sub>A permutes A; p'\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f' x = p'\\<^sub>B (f'' (p'\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p'\\<^sub>A permutes A\n  p'\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f' x = p'\\<^sub>B (f'' (p'\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "from \\<open>(f, f') \\<in> domain_and_range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "have \"f \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. f \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "moreover"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "from \\<open>(f', f'') \\<in> domain_and_range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f', f'') \\<in> domain_and_range_permutation A B", "have \"f'' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f', f'') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. f'' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f', f'')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. f'' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "moreover"], ["proof (state)\nthis:\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "from \\<open>p\\<^sub>A permutes A\\<close> \\<open>p'\\<^sub>A permutes A\\<close>"], ["proof (chain)\npicking this:\n  p\\<^sub>A permutes A\n  p'\\<^sub>A permutes A", "have \"(p'\\<^sub>A \\<circ> p\\<^sub>A) permutes A\""], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n  p'\\<^sub>A permutes A\n\ngoal (1 subgoal):\n 1. p'\\<^sub>A \\<circ> p\\<^sub>A permutes A", "by (simp add: permutes_compose)"], ["proof (state)\nthis:\n  p'\\<^sub>A \\<circ> p\\<^sub>A permutes A\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "moreover"], ["proof (state)\nthis:\n  p'\\<^sub>A \\<circ> p\\<^sub>A permutes A\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "from \\<open>p\\<^sub>B permutes B\\<close> \\<open>p'\\<^sub>B permutes B\\<close>"], ["proof (chain)\npicking this:\n  p\\<^sub>B permutes B\n  p'\\<^sub>B permutes B", "have \"(p\\<^sub>B \\<circ> p'\\<^sub>B) permutes B\""], ["proof (prove)\nusing this:\n  p\\<^sub>B permutes B\n  p'\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. p\\<^sub>B \\<circ> p'\\<^sub>B permutes B", "by (simp add: permutes_compose)"], ["proof (state)\nthis:\n  p\\<^sub>B \\<circ> p'\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "moreover"], ["proof (state)\nthis:\n  p\\<^sub>B \\<circ> p'\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "have \"\\<forall>x\\<in>A. f x = (p\\<^sub>B \\<circ> p'\\<^sub>B) (f'' ((p'\\<^sub>A \\<circ> p\\<^sub>A) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A.\n       f x =\n       (p\\<^sub>B \\<circ> p'\\<^sub>B)\n        (f'' ((p'\\<^sub>A \\<circ> p\\<^sub>A) x))", "using \\<open>\\<forall>x\\<in>A. f' x = p'\\<^sub>B (f'' (p'\\<^sub>A x))\\<close> \\<open>\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<close> \\<open>p\\<^sub>A permutes A\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f' x = p'\\<^sub>B (f'' (p'\\<^sub>A x))\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n  p\\<^sub>A permutes A\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A.\n       f x =\n       (p\\<^sub>B \\<circ> p'\\<^sub>B)\n        (f'' ((p'\\<^sub>A \\<circ> p\\<^sub>A) x))", "by (simp add: permutes_in_image)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A.\n     f x =\n     (p\\<^sub>B \\<circ> p'\\<^sub>B) (f'' ((p'\\<^sub>A \\<circ> p\\<^sub>A) x))\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>(x, y) \\<in> domain_and_range_permutation A B;\n        (y, z) \\<in> domain_and_range_permutation A B\\<rbrakk>\n       \\<Longrightarrow> (x, z) \\<in> domain_and_range_permutation A B", "ultimately"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p'\\<^sub>A \\<circ> p\\<^sub>A permutes A\n  p\\<^sub>B \\<circ> p'\\<^sub>B permutes B\n  \\<forall>x\\<in>A.\n     f x =\n     (p\\<^sub>B \\<circ> p'\\<^sub>B) (f'' ((p'\\<^sub>A \\<circ> p\\<^sub>A) x))", "show \"(f, f'') \\<in> domain_and_range_permutation A B\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p'\\<^sub>A \\<circ> p\\<^sub>A permutes A\n  p\\<^sub>B \\<circ> p'\\<^sub>B permutes B\n  \\<forall>x\\<in>A.\n     f x =\n     (p\\<^sub>B \\<circ> p'\\<^sub>B) (f'' ((p'\\<^sub>A \\<circ> p\\<^sub>A) x))\n\ngoal (1 subgoal):\n 1. (f, f'') \\<in> domain_and_range_permutation A B", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f'' \\<in> A \\<rightarrow>\\<^sub>E B\n  p'\\<^sub>A \\<circ> p\\<^sub>A permutes A\n  p\\<^sub>B \\<circ> p'\\<^sub>B permutes B\n  \\<forall>x\\<in>A.\n     f x =\n     (p\\<^sub>B \\<circ> p'\\<^sub>B) (f'' ((p'\\<^sub>A \\<circ> p\\<^sub>A) x))\n\ngoal (1 subgoal):\n 1. (f, f'')\n    \\<in> {(f, f').\n           (f, f')\n           \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                 (A \\<rightarrow>\\<^sub>E B) \\<and>\n           (\\<exists>p\\<^sub>A p\\<^sub>B.\n               p\\<^sub>A permutes A \\<and>\n               p\\<^sub>B permutes B \\<and>\n               (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}", "by fastforce"], ["proof (state)\nthis:\n  (f, f'') \\<in> domain_and_range_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  trans (domain_and_range_permutation A B)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Respecting Functions\\<close>"], ["", "lemma inj_on_respects_domain_and_range_permutation:\n  \"(\\<lambda>f. inj_on f A) respects domain_and_range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. inj_on f A) respects domain_and_range_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "assume \"(f, f') \\<in> domain_and_range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "obtain p\\<^sub>A p\\<^sub>B where \"p\\<^sub>A permutes A\" \"p\\<^sub>B permutes B\" and \"\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "from \\<open>(f, f') \\<in> domain_and_range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "have \"f' ` A \\<subseteq> B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. f' ` A \\<subseteq> B", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. f' ` A \\<subseteq> B", "by auto"], ["proof (state)\nthis:\n  f' ` A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "from \\<open>p\\<^sub>A permutes A\\<close>"], ["proof (chain)\npicking this:\n  p\\<^sub>A permutes A", "have \"p\\<^sub>A ` A = A\""], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n\ngoal (1 subgoal):\n 1. p\\<^sub>A ` A = A", "by (auto simp add: permutes_image)"], ["proof (state)\nthis:\n  p\\<^sub>A ` A = A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "from \\<open>p\\<^sub>A permutes A\\<close>"], ["proof (chain)\npicking this:\n  p\\<^sub>A permutes A", "have \"inj_on p\\<^sub>A A\""], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n\ngoal (1 subgoal):\n 1. inj_on p\\<^sub>A A", "using bij_betw_imp_inj_on permutes_imp_bij"], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n  bij_betw ?f ?A ?B \\<Longrightarrow> inj_on ?f ?A\n  ?p permutes ?S \\<Longrightarrow> bij_betw ?p ?S ?S\n\ngoal (1 subgoal):\n 1. inj_on p\\<^sub>A A", "by blast"], ["proof (state)\nthis:\n  inj_on p\\<^sub>A A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "from \\<open>p\\<^sub>B permutes B\\<close>"], ["proof (chain)\npicking this:\n  p\\<^sub>B permutes B", "have \"inj_on p\\<^sub>B B\""], ["proof (prove)\nusing this:\n  p\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. inj_on p\\<^sub>B B", "using bij_betw_imp_inj_on permutes_imp_bij"], ["proof (prove)\nusing this:\n  p\\<^sub>B permutes B\n  bij_betw ?f ?A ?B \\<Longrightarrow> inj_on ?f ?A\n  ?p permutes ?S \\<Longrightarrow> bij_betw ?p ?S ?S\n\ngoal (1 subgoal):\n 1. inj_on p\\<^sub>B B", "by blast"], ["proof (state)\nthis:\n  inj_on p\\<^sub>B B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       inj_on y A = inj_on z A", "show \"inj_on f A \\<longleftrightarrow> inj_on f' A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "have \"inj_on f A \\<longleftrightarrow> inj_on (\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f A = inj_on (\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) A", "using \\<open>\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<close> inj_on_cong comp_apply"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n  (\\<And>a. a \\<in> ?A \\<Longrightarrow> ?f a = ?g a) \\<Longrightarrow>\n  inj_on ?f ?A = inj_on ?g ?A\n  (?f \\<circ> ?g) ?x = ?f (?g ?x)\n\ngoal (1 subgoal):\n 1. inj_on f A = inj_on (\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) A", "by fastforce"], ["proof (state)\nthis:\n  inj_on f A = inj_on (\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) A\n\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "have \"inj_on f A \\<longleftrightarrow> inj_on (p\\<^sub>B o f' o p\\<^sub>A) A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f A = inj_on (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A", "by (simp add: \\<open>\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<close> inj_on_def)"], ["proof (state)\nthis:\n  inj_on f A = inj_on (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A\n\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "also"], ["proof (state)\nthis:\n  inj_on f A = inj_on (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A\n\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "have \"inj_on (p\\<^sub>B o f' o p\\<^sub>A) A \\<longleftrightarrow> inj_on (p\\<^sub>B o f') A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A =\n    inj_on (p\\<^sub>B \\<circ> f') A", "using \\<open>inj_on p\\<^sub>A A\\<close> \\<open>p\\<^sub>A ` A = A\\<close>"], ["proof (prove)\nusing this:\n  inj_on p\\<^sub>A A\n  p\\<^sub>A ` A = A\n\ngoal (1 subgoal):\n 1. inj_on (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A =\n    inj_on (p\\<^sub>B \\<circ> f') A", "by (auto dest: inj_on_imageI intro: comp_inj_on)"], ["proof (state)\nthis:\n  inj_on (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A =\n  inj_on (p\\<^sub>B \\<circ> f') A\n\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "also"], ["proof (state)\nthis:\n  inj_on (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A =\n  inj_on (p\\<^sub>B \\<circ> f') A\n\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "have \"inj_on (p\\<^sub>B o f') A \\<longleftrightarrow> inj_on f' A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on (p\\<^sub>B \\<circ> f') A = inj_on f' A", "using \\<open>inj_on p\\<^sub>B B\\<close> \\<open>f' ` A \\<subseteq> B\\<close>"], ["proof (prove)\nusing this:\n  inj_on p\\<^sub>B B\n  f' ` A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. inj_on (p\\<^sub>B \\<circ> f') A = inj_on f' A", "by (auto dest: inj_on_imageI2 intro: comp_inj_on subset_inj_on)"], ["proof (state)\nthis:\n  inj_on (p\\<^sub>B \\<circ> f') A = inj_on f' A\n\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "finally"], ["proof (chain)\npicking this:\n  inj_on f A = inj_on f' A", "show ?thesis"], ["proof (prove)\nusing this:\n  inj_on f A = inj_on f' A\n\ngoal (1 subgoal):\n 1. inj_on f A = inj_on f' A", "."], ["proof (state)\nthis:\n  inj_on f A = inj_on f' A\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj_on f A = inj_on f' A\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma surjective_respects_domain_and_range_permutation:\n  \"(\\<lambda>f. f ` A = B) respects domain_and_range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. f ` A = B) respects domain_and_range_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "assume \"(f, f') \\<in> domain_and_range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "obtain p\\<^sub>A p\\<^sub>B where\n    permutes: \"p\\<^sub>A permutes A\" \"p\\<^sub>B permutes B\" and \"\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "from permutes"], ["proof (chain)\npicking this:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B", "have \"p\\<^sub>A ` A = A\" \"p\\<^sub>B ` B = B\""], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. p\\<^sub>A ` A = A &&& p\\<^sub>B ` B = B", "by (auto simp add: permutes_image)"], ["proof (state)\nthis:\n  p\\<^sub>A ` A = A\n  p\\<^sub>B ` B = B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "from \\<open>p\\<^sub>B permutes B\\<close>"], ["proof (chain)\npicking this:\n  p\\<^sub>B permutes B", "have \"inj p\\<^sub>B\""], ["proof (prove)\nusing this:\n  p\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. inj p\\<^sub>B", "by (simp add: permutes_inj)"], ["proof (state)\nthis:\n  inj p\\<^sub>B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       (y ` A = B) = (z ` A = B)", "show \"(f ` A = B) \\<longleftrightarrow> (f' ` A = B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "have \"f ` A = B \\<longleftrightarrow> (\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f ` A = B) = ((\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B)", "using \\<open>\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. (f ` A = B) = ((\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B)", "by (metis (mono_tags, lifting) image_cong)"], ["proof (state)\nthis:\n  (f ` A = B) = ((\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B)\n\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "also"], ["proof (state)\nthis:\n  (f ` A = B) = ((\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B)\n\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "have \"(\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B \\<longleftrightarrow> (\\<lambda>x. p\\<^sub>B (f' x)) ` A = B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B) =\n    ((\\<lambda>x. p\\<^sub>B (f' x)) ` A = B)", "using \\<open>p\\<^sub>A ` A = A\\<close>"], ["proof (prove)\nusing this:\n  p\\<^sub>A ` A = A\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B) =\n    ((\\<lambda>x. p\\<^sub>B (f' x)) ` A = B)", "by (metis image_image)"], ["proof (state)\nthis:\n  ((\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B) =\n  ((\\<lambda>x. p\\<^sub>B (f' x)) ` A = B)\n\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "also"], ["proof (state)\nthis:\n  ((\\<lambda>x. p\\<^sub>B (f' (p\\<^sub>A x))) ` A = B) =\n  ((\\<lambda>x. p\\<^sub>B (f' x)) ` A = B)\n\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "have \"(\\<lambda>x. p\\<^sub>B (f' x)) ` A = B \\<longleftrightarrow> (f' ` A = B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. p\\<^sub>B (f' x)) ` A = B) = (f' ` A = B)", "using \\<open>p\\<^sub>B ` B = B\\<close> \\<open>inj p\\<^sub>B\\<close>"], ["proof (prove)\nusing this:\n  p\\<^sub>B ` B = B\n  inj p\\<^sub>B\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. p\\<^sub>B (f' x)) ` A = B) = (f' ` A = B)", "by (metis image_image image_inv_f_f)"], ["proof (state)\nthis:\n  ((\\<lambda>x. p\\<^sub>B (f' x)) ` A = B) = (f' ` A = B)\n\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "finally"], ["proof (chain)\npicking this:\n  (f ` A = B) = (f' ` A = B)", "show ?thesis"], ["proof (prove)\nusing this:\n  (f ` A = B) = (f' ` A = B)\n\ngoal (1 subgoal):\n 1. (f ` A = B) = (f' ` A = B)", "."], ["proof (state)\nthis:\n  (f ` A = B) = (f' ` A = B)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (f ` A = B) = (f' ` A = B)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bij_betw_respects_domain_and_range_permutation:\n  \"(\\<lambda>f. bij_betw f A B) respects domain_and_range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f. bij_betw f A B) respects domain_and_range_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "assume \"(f, f') \\<in> domain_and_range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "obtain p\\<^sub>A p\\<^sub>B where \"p\\<^sub>A permutes A\" \"p\\<^sub>B permutes B\"\n    and \"\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\" and \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x));\n         f' \\<in> A \\<rightarrow>\\<^sub>E B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x));\n         f' \\<in> A \\<rightarrow>\\<^sub>E B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "have \"bij_betw f A B \\<longleftrightarrow> bij_betw (p\\<^sub>B o f' o p\\<^sub>A) A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A B", "using \\<open>\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<close> bij_betw_congI"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n  \\<lbrakk>bij_betw ?f ?A ?A'; \\<forall>a\\<in>?A. ?f a = ?g a\\<rbrakk>\n  \\<Longrightarrow> bij_betw ?g ?A ?A'\n\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A B", "by fastforce"], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "also"], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "have \"... \\<longleftrightarrow> bij_betw (p\\<^sub>B o f')  A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A B =\n    bij_betw (p\\<^sub>B \\<circ> f') A B", "using \\<open>p\\<^sub>A permutes A\\<close>"], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n\ngoal (1 subgoal):\n 1. bij_betw (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A B =\n    bij_betw (p\\<^sub>B \\<circ> f') A B", "by (auto intro!: bij_betw_comp_iff[symmetric] permutes_imp_bij)"], ["proof (state)\nthis:\n  bij_betw (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A B =\n  bij_betw (p\\<^sub>B \\<circ> f') A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "also"], ["proof (state)\nthis:\n  bij_betw (p\\<^sub>B \\<circ> f' \\<circ> p\\<^sub>A) A B =\n  bij_betw (p\\<^sub>B \\<circ> f') A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "have \"... \\<longleftrightarrow> bij_betw f' A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (p\\<^sub>B \\<circ> f') A B = bij_betw f' A B", "using \\<open>f' \\<in> A \\<rightarrow>\\<^sub>E B\\<close> \\<open>p\\<^sub>B permutes B\\<close>"], ["proof (prove)\nusing this:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  p\\<^sub>B permutes B\n\ngoal (1 subgoal):\n 1. bij_betw (p\\<^sub>B \\<circ> f') A B = bij_betw f' A B", "by (auto intro!: bij_betw_comp_iff2[symmetric] permutes_imp_bij)"], ["proof (state)\nthis:\n  bij_betw (p\\<^sub>B \\<circ> f') A B = bij_betw f' A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       bij_betw y A B = bij_betw z A B", "finally"], ["proof (chain)\npicking this:\n  bij_betw f A B = bij_betw f' A B", "show \"bij_betw f A B \\<longleftrightarrow> bij_betw f' A B\""], ["proof (prove)\nusing this:\n  bij_betw f A B = bij_betw f' A B\n\ngoal (1 subgoal):\n 1. bij_betw f A B = bij_betw f' A B", "."], ["proof (state)\nthis:\n  bij_betw f A B = bij_betw f' A B\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma count_image_mset':\n  \"count (image_mset f A) x = sum (count A) {x' \\<in> set_mset A. f x' = x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. count (image_mset f A) x =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. count (image_mset f A) x =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "have \"count (image_mset f A) x = sum (count A) (f -` {x} \\<inter> set_mset A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. count (image_mset f A) x = sum (count A) (f -` {x} \\<inter> set_mset A)", "unfolding count_image_mset"], ["proof (prove)\ngoal (1 subgoal):\n 1. sum (count A) (f -` {x} \\<inter> set_mset A) =\n    sum (count A) (f -` {x} \\<inter> set_mset A)", ".."], ["proof (state)\nthis:\n  count (image_mset f A) x = sum (count A) (f -` {x} \\<inter> set_mset A)\n\ngoal (1 subgoal):\n 1. count (image_mset f A) x =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "also"], ["proof (state)\nthis:\n  count (image_mset f A) x = sum (count A) (f -` {x} \\<inter> set_mset A)\n\ngoal (1 subgoal):\n 1. count (image_mset f A) x =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "have \"\\<dots> = sum (count A) {x' \\<in> set_mset A. f x' = x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum (count A) (f -` {x} \\<inter> set_mset A) =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. sum (count A) (f -` {x} \\<inter> set_mset A) =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "have \"(f -` {x} \\<inter> set_mset A) = {x' \\<in> set_mset A. f x' = x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f -` {x} \\<inter> set_mset A = {x'. x' \\<in># A \\<and> f x' = x}", "by blast"], ["proof (state)\nthis:\n  f -` {x} \\<inter> set_mset A = {x'. x' \\<in># A \\<and> f x' = x}\n\ngoal (1 subgoal):\n 1. sum (count A) (f -` {x} \\<inter> set_mset A) =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "from this"], ["proof (chain)\npicking this:\n  f -` {x} \\<inter> set_mset A = {x'. x' \\<in># A \\<and> f x' = x}", "show ?thesis"], ["proof (prove)\nusing this:\n  f -` {x} \\<inter> set_mset A = {x'. x' \\<in># A \\<and> f x' = x}\n\ngoal (1 subgoal):\n 1. sum (count A) (f -` {x} \\<inter> set_mset A) =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "by simp"], ["proof (state)\nthis:\n  sum (count A) (f -` {x} \\<inter> set_mset A) =\n  sum (count A) {x'. x' \\<in># A \\<and> f x' = x}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  sum (count A) (f -` {x} \\<inter> set_mset A) =\n  sum (count A) {x'. x' \\<in># A \\<and> f x' = x}\n\ngoal (1 subgoal):\n 1. count (image_mset f A) x =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "finally"], ["proof (chain)\npicking this:\n  count (image_mset f A) x = sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "show ?thesis"], ["proof (prove)\nusing this:\n  count (image_mset f A) x = sum (count A) {x'. x' \\<in># A \\<and> f x' = x}\n\ngoal (1 subgoal):\n 1. count (image_mset f A) x =\n    sum (count A) {x'. x' \\<in># A \\<and> f x' = x}", "."], ["proof (state)\nthis:\n  count (image_mset f A) x = sum (count A) {x'. x' \\<in># A \\<and> f x' = x}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma multiset_of_partition_cards_respects_domain_and_range_permutation:\n  assumes \"finite B\"\n  shows \"(\\<lambda>f. image_mset (\\<lambda>X. card X) (mset_set (((\\<lambda>b. {x \\<in> A. f x = b})) ` B - {{}}))) respects domain_and_range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>f.\n        image_mset card\n         (mset_set\n           ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}))) respects\n    domain_and_range_permutation A B", "proof (rule congruentI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "fix f f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "assume \"(f, f') \\<in> domain_and_range_permutation A B\""], ["proof (state)\nthis:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> domain_and_range_permutation A B", "obtain p\\<^sub>A p\\<^sub>B where \"p\\<^sub>A permutes A\" \"p\\<^sub>B permutes B\" \"\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> domain_and_range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding domain_and_range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p\\<^sub>A p\\<^sub>B.\n             p\\<^sub>A permutes A \\<and>\n             p\\<^sub>B permutes B \\<and>\n             (\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))))}\n\ngoal (1 subgoal):\n 1. (\\<And>p\\<^sub>A p\\<^sub>B.\n        \\<lbrakk>p\\<^sub>A permutes A; p\\<^sub>B permutes B;\n         \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p\\<^sub>A permutes A\n  p\\<^sub>B permutes B\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "have \"(\\<lambda>b. {x \\<in> A. f x = b}) ` B = (\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B =\n    (\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B", "using \\<open>\\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p\\<^sub>B (f' (p\\<^sub>A x))\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B =\n    (\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B =\n  (\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "from this"], ["proof (chain)\npicking this:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B =\n  (\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B", "have \"image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n    image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B - {{}}))\""], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B =\n  (\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B\n\ngoal (1 subgoal):\n 1. image_mset card\n     (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n    image_mset card\n     (mset_set\n       ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B -\n        {{}}))", "by simp"], ["proof (state)\nthis:\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n  image_mset card\n   (mset_set\n     ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B -\n      {{}}))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "also"], ["proof (state)\nthis:\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n  image_mset card\n   (mset_set\n     ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B -\n      {{}}))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "have \"image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B - {{}})) =\n    image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. image_mset card\n     (mset_set\n       ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B -\n        {{}})) =\n    image_mset card\n     (mset_set ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}))", "using permutes_implies_inv_image_on_eq[OF \\<open>p\\<^sub>B permutes B\\<close>, of A]"], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. p\\<^sub>B (?f x) = b}) ` B =\n  (\\<lambda>b. {x \\<in> A. ?f x = b}) ` B\n\ngoal (1 subgoal):\n 1. image_mset card\n     (mset_set\n       ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B -\n        {{}})) =\n    image_mset card\n     (mset_set ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}))", "by metis"], ["proof (state)\nthis:\n  image_mset card\n   (mset_set\n     ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B -\n      {{}})) =\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "also"], ["proof (state)\nthis:\n  image_mset card\n   (mset_set\n     ((\\<lambda>b. {x \\<in> A. p\\<^sub>B (f' (p\\<^sub>A x)) = b}) ` B -\n      {{}})) =\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "have \"image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})) =\n    image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. image_mset card\n     (mset_set\n       ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})) =\n    image_mset card\n     (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))", "proof (rule multiset_eqI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       count\n        (image_mset card\n          (mset_set\n            ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})))\n        x =\n       count\n        (image_mset card\n          (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}})))\n        x", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       count\n        (image_mset card\n          (mset_set\n            ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})))\n        x =\n       count\n        (image_mset card\n          (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}})))\n        x", "have \"bij_betw (\\<lambda>X. p\\<^sub>A ` X) {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}. card X = n} {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw ((`) p\\<^sub>A)\n     {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n      card X = n}\n     {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}", "proof (rule bij_betw_byWitness)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<forall>a\\<in>{X \\<in> (\\<lambda>b.\n                                {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                            B -\n                            {{}}.\n                    card X = n}.\n       ?f' (p\\<^sub>A ` a) = a\n 2. \\<forall>a'\\<in>{X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                     card X = n}.\n       p\\<^sub>A ` ?f' a' = a'\n 3. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}\n 4. ?f' `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "show \"\\<forall>X\\<in>{X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}. card X = n}. inv p\\<^sub>A ` p\\<^sub>A ` X = X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>X\\<in>{X \\<in> (\\<lambda>b.\n                                {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                            B -\n                            {{}}.\n                    card X = n}.\n       inv p\\<^sub>A ` p\\<^sub>A ` X = X", "by (meson \\<open>p\\<^sub>A permutes A\\<close> image_inv_f_f permutes_inj)"], ["proof (state)\nthis:\n  \\<forall>X\\<in>{X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                          B -\n                          {{}}.\n                  card X = n}.\n     inv p\\<^sub>A ` p\\<^sub>A ` X = X\n\ngoal (3 subgoals):\n 1. \\<forall>a'\\<in>{X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                     card X = n}.\n       p\\<^sub>A ` inv p\\<^sub>A ` a' = a'\n 2. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}\n 3. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "show \"\\<forall>X\\<in>{X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}. p\\<^sub>A ` inv p\\<^sub>A ` X = X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>X\\<in>{X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                    card X = n}.\n       p\\<^sub>A ` inv p\\<^sub>A ` X = X", "by (meson \\<open>p\\<^sub>A permutes A\\<close> image_f_inv_f permutes_surj)"], ["proof (state)\nthis:\n  \\<forall>X\\<in>{X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                  card X = n}.\n     p\\<^sub>A ` inv p\\<^sub>A ` X = X\n\ngoal (2 subgoals):\n 1. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}\n 2. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "show \"(\\<lambda>X. p\\<^sub>A ` X) ` {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}. card X = n} \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}", "have \"card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}) = card {x \\<in> A. f' (p\\<^sub>A x) = b}\" for b"], ["proof (prove)\ngoal (1 subgoal):\n 1. card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}) =\n    card {x \\<in> A. f' (p\\<^sub>A x) = b}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}) =\n    card {x \\<in> A. f' (p\\<^sub>A x) = b}", "have \"inj_on p\\<^sub>A {x \\<in> A. f' (p\\<^sub>A x) = b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on p\\<^sub>A {x \\<in> A. f' (p\\<^sub>A x) = b}", "by (metis (no_types, lifting) \\<open>p\\<^sub>A permutes A\\<close> injD inj_onI permutes_inj)"], ["proof (state)\nthis:\n  inj_on p\\<^sub>A {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal (1 subgoal):\n 1. card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}) =\n    card {x \\<in> A. f' (p\\<^sub>A x) = b}", "from this"], ["proof (chain)\npicking this:\n  inj_on p\\<^sub>A {x \\<in> A. f' (p\\<^sub>A x) = b}", "show ?thesis"], ["proof (prove)\nusing this:\n  inj_on p\\<^sub>A {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal (1 subgoal):\n 1. card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}) =\n    card {x \\<in> A. f' (p\\<^sub>A x) = b}", "by (simp add: card_image)"], ["proof (state)\nthis:\n  card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}) =\n  card {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = ?b}) =\n  card {x \\<in> A. f' (p\\<^sub>A x) = ?b}\n\ngoal (1 subgoal):\n 1. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}", "moreover"], ["proof (state)\nthis:\n  card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = ?b}) =\n  card {x \\<in> A. f' (p\\<^sub>A x) = ?b}\n\ngoal (1 subgoal):\n 1. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}", "have \"p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b} = {x \\<in> A. f' x = b}\" for b"], ["proof (prove)\ngoal (1 subgoal):\n 1. p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b} = {x \\<in> A. f' x = b}", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}\n    \\<subseteq> {x \\<in> A. f' x = b}\n 2. {x \\<in> A. f' x = b}\n    \\<subseteq> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "show \"p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b} \\<subseteq> {x \\<in> A. f' x = b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}\n    \\<subseteq> {x \\<in> A. f' x = b}", "by (auto simp add: \\<open>p\\<^sub>A permutes A\\<close> permutes_in_image)"], ["proof (state)\nthis:\n  p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}\n  \\<subseteq> {x \\<in> A. f' x = b}\n\ngoal (1 subgoal):\n 1. {x \\<in> A. f' x = b}\n    \\<subseteq> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "show \"{x \\<in> A. f' x = b} \\<subseteq> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> A. f' x = b}\n    \\<subseteq> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' x = b} \\<Longrightarrow>\n       x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' x = b} \\<Longrightarrow>\n       x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "assume \"x \\<in> {x \\<in> A. f' x = b}\""], ["proof (state)\nthis:\n  x \\<in> {x \\<in> A. f' x = b}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' x = b} \\<Longrightarrow>\n       x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "moreover"], ["proof (state)\nthis:\n  x \\<in> {x \\<in> A. f' x = b}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' x = b} \\<Longrightarrow>\n       x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "have \"p\\<^sub>A (inv p\\<^sub>A x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p\\<^sub>A (inv p\\<^sub>A x) = x", "using \\<open>p\\<^sub>A permutes A\\<close> permutes_inverses(1)"], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n  ?p permutes ?S \\<Longrightarrow> ?p (inv ?p ?x) = ?x\n\ngoal (1 subgoal):\n 1. p\\<^sub>A (inv p\\<^sub>A x) = x", "by fastforce"], ["proof (state)\nthis:\n  p\\<^sub>A (inv p\\<^sub>A x) = x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' x = b} \\<Longrightarrow>\n       x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "moreover"], ["proof (state)\nthis:\n  p\\<^sub>A (inv p\\<^sub>A x) = x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' x = b} \\<Longrightarrow>\n       x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "from \\<open>x \\<in> {x \\<in> A. f' x = b}\\<close>"], ["proof (chain)\npicking this:\n  x \\<in> {x \\<in> A. f' x = b}", "have \"inv p\\<^sub>A x \\<in> A\""], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> A. f' x = b}\n\ngoal (1 subgoal):\n 1. inv p\\<^sub>A x \\<in> A", "by (simp add: \\<open>p\\<^sub>A permutes A\\<close> permutes_in_image permutes_inv)"], ["proof (state)\nthis:\n  inv p\\<^sub>A x \\<in> A\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' x = b} \\<Longrightarrow>\n       x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "ultimately"], ["proof (chain)\npicking this:\n  x \\<in> {x \\<in> A. f' x = b}\n  p\\<^sub>A (inv p\\<^sub>A x) = x\n  inv p\\<^sub>A x \\<in> A", "show \"x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}\""], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> A. f' x = b}\n  p\\<^sub>A (inv p\\<^sub>A x) = x\n  inv p\\<^sub>A x \\<in> A\n\ngoal (1 subgoal):\n 1. x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}", "by (auto intro: image_eqI[where x=\"inv p\\<^sub>A x\"])"], ["proof (state)\nthis:\n  x \\<in> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  {x \\<in> A. f' x = b}\n  \\<subseteq> p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = ?b} = {x \\<in> A. f' x = ?b}\n\ngoal (1 subgoal):\n 1. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}", "ultimately"], ["proof (chain)\npicking this:\n  card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = ?b}) =\n  card {x \\<in> A. f' (p\\<^sub>A x) = ?b}\n  p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = ?b} = {x \\<in> A. f' x = ?b}", "show ?thesis"], ["proof (prove)\nusing this:\n  card (p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = ?b}) =\n  card {x \\<in> A. f' (p\\<^sub>A x) = ?b}\n  p\\<^sub>A ` {x \\<in> A. f' (p\\<^sub>A x) = ?b} = {x \\<in> A. f' x = ?b}\n\ngoal (1 subgoal):\n 1. (`) p\\<^sub>A `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n     card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n                 card X = n}", "by auto"], ["proof (state)\nthis:\n  (`) p\\<^sub>A `\n  {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n   card X = n}\n  \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n               card X = n}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (`) p\\<^sub>A `\n  {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n   card X = n}\n  \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}.\n               card X = n}\n\ngoal (1 subgoal):\n 1. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "show \"(\\<lambda>X. inv p\\<^sub>A ` X) ` {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n} \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}. card X = n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "have \"card (inv p\\<^sub>A ` {x \\<in> A. f' x = b}) = card {x \\<in> A. f' x = b}\" for b"], ["proof (prove)\ngoal (1 subgoal):\n 1. card (inv p\\<^sub>A ` {x \\<in> A. f' x = b}) =\n    card {x \\<in> A. f' x = b}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card (inv p\\<^sub>A ` {x \\<in> A. f' x = b}) =\n    card {x \\<in> A. f' x = b}", "have \"inj_on (inv p\\<^sub>A) {x \\<in> A. f' x = b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on (inv p\\<^sub>A) {x \\<in> A. f' x = b}", "by (metis (no_types, lifting) \\<open>p\\<^sub>A permutes A\\<close> injD inj_onI permutes_surj surj_imp_inj_inv)"], ["proof (state)\nthis:\n  inj_on (inv p\\<^sub>A) {x \\<in> A. f' x = b}\n\ngoal (1 subgoal):\n 1. card (inv p\\<^sub>A ` {x \\<in> A. f' x = b}) =\n    card {x \\<in> A. f' x = b}", "from this"], ["proof (chain)\npicking this:\n  inj_on (inv p\\<^sub>A) {x \\<in> A. f' x = b}", "show ?thesis"], ["proof (prove)\nusing this:\n  inj_on (inv p\\<^sub>A) {x \\<in> A. f' x = b}\n\ngoal (1 subgoal):\n 1. card (inv p\\<^sub>A ` {x \\<in> A. f' x = b}) =\n    card {x \\<in> A. f' x = b}", "by (simp add: card_image)"], ["proof (state)\nthis:\n  card (inv p\\<^sub>A ` {x \\<in> A. f' x = b}) = card {x \\<in> A. f' x = b}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  card (inv p\\<^sub>A ` {x \\<in> A. f' x = ?b}) =\n  card {x \\<in> A. f' x = ?b}\n\ngoal (1 subgoal):\n 1. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "moreover"], ["proof (state)\nthis:\n  card (inv p\\<^sub>A ` {x \\<in> A. f' x = ?b}) =\n  card {x \\<in> A. f' x = ?b}\n\ngoal (1 subgoal):\n 1. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "have \"inv p\\<^sub>A ` {x \\<in> A. f' x = b} = {x \\<in> A. f' (p\\<^sub>A x) = b}\" for b"], ["proof (prove)\ngoal (1 subgoal):\n 1. inv p\\<^sub>A ` {x \\<in> A. f' x = b} =\n    {x \\<in> A. f' (p\\<^sub>A x) = b}", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. inv p\\<^sub>A ` {x \\<in> A. f' x = b}\n    \\<subseteq> {x \\<in> A. f' (p\\<^sub>A x) = b}\n 2. {x \\<in> A. f' (p\\<^sub>A x) = b}\n    \\<subseteq> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "show \"inv p\\<^sub>A ` {x \\<in> A. f' x = b} \\<subseteq> {x \\<in> A. f' (p\\<^sub>A x) = b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv p\\<^sub>A ` {x \\<in> A. f' x = b}\n    \\<subseteq> {x \\<in> A. f' (p\\<^sub>A x) = b}", "using \\<open>p\\<^sub>A permutes A\\<close>"], ["proof (prove)\nusing this:\n  p\\<^sub>A permutes A\n\ngoal (1 subgoal):\n 1. inv p\\<^sub>A ` {x \\<in> A. f' x = b}\n    \\<subseteq> {x \\<in> A. f' (p\\<^sub>A x) = b}", "by (auto simp add: permutes_in_image permutes_inv permutes_inverses(1))"], ["proof (state)\nthis:\n  inv p\\<^sub>A ` {x \\<in> A. f' x = b}\n  \\<subseteq> {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal (1 subgoal):\n 1. {x \\<in> A. f' (p\\<^sub>A x) = b}\n    \\<subseteq> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "show \"{x \\<in> A. f' (p\\<^sub>A x) = b} \\<subseteq> inv p\\<^sub>A ` {x \\<in> A. f' x = b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> A. f' (p\\<^sub>A x) = b}\n    \\<subseteq> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b} \\<Longrightarrow>\n       x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b} \\<Longrightarrow>\n       x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "assume \"x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b}\""], ["proof (state)\nthis:\n  x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b} \\<Longrightarrow>\n       x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "moreover"], ["proof (state)\nthis:\n  x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b} \\<Longrightarrow>\n       x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "have \"inv p\\<^sub>A (p\\<^sub>A x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv p\\<^sub>A (p\\<^sub>A x) = x", "by (meson \\<open>p\\<^sub>A permutes A\\<close> permutes_inverses(2))"], ["proof (state)\nthis:\n  inv p\\<^sub>A (p\\<^sub>A x) = x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b} \\<Longrightarrow>\n       x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "moreover"], ["proof (state)\nthis:\n  inv p\\<^sub>A (p\\<^sub>A x) = x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b} \\<Longrightarrow>\n       x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "from \\<open>x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b}\\<close>"], ["proof (chain)\npicking this:\n  x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b}", "have \"p\\<^sub>A x \\<in> A\""], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b}\n\ngoal (1 subgoal):\n 1. p\\<^sub>A x \\<in> A", "by (simp add: \\<open>p\\<^sub>A permutes A\\<close> permutes_in_image)"], ["proof (state)\nthis:\n  p\\<^sub>A x \\<in> A\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b} \\<Longrightarrow>\n       x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "ultimately"], ["proof (chain)\npicking this:\n  x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b}\n  inv p\\<^sub>A (p\\<^sub>A x) = x\n  p\\<^sub>A x \\<in> A", "show \"x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}\""], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> A. f' (p\\<^sub>A x) = b}\n  inv p\\<^sub>A (p\\<^sub>A x) = x\n  p\\<^sub>A x \\<in> A\n\ngoal (1 subgoal):\n 1. x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}", "by (auto intro: image_eqI[where x=\"p\\<^sub>A x\"])"], ["proof (state)\nthis:\n  x \\<in> inv p\\<^sub>A ` {x \\<in> A. f' x = b}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  {x \\<in> A. f' (p\\<^sub>A x) = b}\n  \\<subseteq> inv p\\<^sub>A ` {x \\<in> A. f' x = b}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inv p\\<^sub>A ` {x \\<in> A. f' x = ?b} =\n  {x \\<in> A. f' (p\\<^sub>A x) = ?b}\n\ngoal (1 subgoal):\n 1. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "ultimately"], ["proof (chain)\npicking this:\n  card (inv p\\<^sub>A ` {x \\<in> A. f' x = ?b}) =\n  card {x \\<in> A. f' x = ?b}\n  inv p\\<^sub>A ` {x \\<in> A. f' x = ?b} =\n  {x \\<in> A. f' (p\\<^sub>A x) = ?b}", "show ?thesis"], ["proof (prove)\nusing this:\n  card (inv p\\<^sub>A ` {x \\<in> A. f' x = ?b}) =\n  card {x \\<in> A. f' x = ?b}\n  inv p\\<^sub>A ` {x \\<in> A. f' x = ?b} =\n  {x \\<in> A. f' (p\\<^sub>A x) = ?b}\n\ngoal (1 subgoal):\n 1. (`) (inv p\\<^sub>A) `\n    {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n    \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) `\n                         B -\n                         {{}}.\n                 card X = n}", "by auto"], ["proof (state)\nthis:\n  (`) (inv p\\<^sub>A) `\n  {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n  \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B -\n                       {{}}.\n               card X = n}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (`) (inv p\\<^sub>A) `\n  {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n  \\<subseteq> {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B -\n                       {{}}.\n               card X = n}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  bij_betw ((`) p\\<^sub>A)\n   {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n    card X = n}\n   {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       count\n        (image_mset card\n          (mset_set\n            ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})))\n        x =\n       count\n        (image_mset card\n          (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}})))\n        x", "from this"], ["proof (chain)\npicking this:\n  bij_betw ((`) p\\<^sub>A)\n   {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n    card X = n}\n   {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}", "have \"card {x' \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}. card x' = n} = card {x' \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card x' = n}\""], ["proof (prove)\nusing this:\n  bij_betw ((`) p\\<^sub>A)\n   {X \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n    card X = n}\n   {X \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card X = n}\n\ngoal (1 subgoal):\n 1. card\n     {x' \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n      card x' = n} =\n    card\n     {x' \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card x' = n}", "by (rule bij_betw_same_card)"], ["proof (state)\nthis:\n  card\n   {x' \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n    card x' = n} =\n  card\n   {x' \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card x' = n}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       count\n        (image_mset card\n          (mset_set\n            ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})))\n        x =\n       count\n        (image_mset card\n          (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}})))\n        x", "from this"], ["proof (chain)\npicking this:\n  card\n   {x' \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n    card x' = n} =\n  card\n   {x' \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card x' = n}", "show \"count (image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}))) n =\n      count (image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))) n\""], ["proof (prove)\nusing this:\n  card\n   {x' \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n    card x' = n} =\n  card\n   {x' \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card x' = n}\n\ngoal (1 subgoal):\n 1. count\n     (image_mset card\n       (mset_set\n         ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})))\n     n =\n    count\n     (image_mset card\n       (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}})))\n     n", "using \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  card\n   {x' \\<in> (\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}}.\n    card x' = n} =\n  card\n   {x' \\<in> (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}. card x' = n}\n  finite B\n\ngoal (1 subgoal):\n 1. count\n     (image_mset card\n       (mset_set\n         ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})))\n     n =\n    count\n     (image_mset card\n       (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}})))\n     n", "by (simp add: count_image_mset')"], ["proof (state)\nthis:\n  count\n   (image_mset card\n     (mset_set\n       ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})))\n   n =\n  count\n   (image_mset card\n     (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}})))\n   n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f' (p\\<^sub>A x) = b}) ` B - {{}})) =\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       (y, z) \\<in> domain_and_range_permutation A B \\<Longrightarrow>\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. y x = b}) ` B - {{}})) =\n       image_mset card\n        (mset_set ((\\<lambda>b. {x \\<in> A. z x = b}) ` B - {{}}))", "finally"], ["proof (chain)\npicking this:\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))", "show \"image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n    image_mset card (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))\""], ["proof (prove)\nusing this:\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))\n\ngoal (1 subgoal):\n 1. image_mset card\n     (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n    image_mset card\n     (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))", "."], ["proof (state)\nthis:\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})) =\n  image_mset card\n   (mset_set ((\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}))\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}