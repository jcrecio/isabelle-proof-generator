{"file_name": "/home/qj213/afp-2021-10-22/thys/Twelvefold_Way/Twelvefold_Way_Entry7.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Twelvefold_Way", "problem_names": ["lemma partitions_of:\n  assumes \"finite B\"\n  assumes \"F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\"\n  shows \"card (partitions_of A B F) \\<le> card B\"\n  and \"partition_on A (partitions_of A B F)\"", "lemma functions_of:\n  assumes \"finite A\" \"finite B\"\n  assumes \"partition_on A P\"\n  assumes \"card P \\<le> card B\"\n  shows \"functions_of P A B \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\"", "lemma functions_of_partitions_of:\n  assumes \"finite B\"\n  assumes \"F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\"\n  shows \"functions_of (partitions_of A B F) A B = F\"", "lemma partitions_of_functions_of:\n  assumes \"finite A\" \"finite B\"\n  assumes \"partition_on A P\"\n  assumes \"card P \\<le> card B\"\n  shows \"partitions_of A B (functions_of P A B) = P\"", "lemma bij_betw_partitions_of:\n  assumes \"finite A\" \"finite B\"\n  shows \"bij_betw (partitions_of A B) ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) {P. partition_on A P \\<and> card P \\<le> card B}\"", "lemma\n  assumes \"finite A\" \"finite B\"\n  shows \"card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) = (\\<Sum>j\\<le>card B. Stirling (card A) j)\""], "translations": [["", "lemma partitions_of:\n  assumes \"finite B\"\n  assumes \"F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\"\n  shows \"card (partitions_of A B F) \\<le> card B\"\n  and \"partition_on A (partitions_of A B F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B &&&\n    partition_on A (partitions_of A B F)", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. card (partitions_of A B F) \\<le> card B\n 2. partition_on A (partitions_of A B F)", "from \\<open>F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "obtain f where \"f \\<in> A \\<rightarrow>\\<^sub>E B\"\n    and F_eq: \"F = range_permutation A B `` {f}\""], ["proof (prove)\nusing this:\n  F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>f \\<in> A \\<rightarrow>\\<^sub>E B;\n         F = range_permutation A B `` {f}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using quotientE"], ["proof (prove)\nusing this:\n  F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n  \\<lbrakk>?X \\<in> ?A // ?r;\n   \\<And>x.\n      \\<lbrakk>?X = ?r `` {x}; x \\<in> ?A\\<rbrakk>\n      \\<Longrightarrow> ?P\\<rbrakk>\n  \\<Longrightarrow> ?P\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>f \\<in> A \\<rightarrow>\\<^sub>E B;\n         F = range_permutation A B `` {f}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  F = range_permutation A B `` {f}\n\ngoal (2 subgoals):\n 1. card (partitions_of A B F) \\<le> card B\n 2. partition_on A (partitions_of A B F)", "have \"partitions_of A B F = univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. partitions_of A B F =\n    univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F", "unfolding partitions_of_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F =\n    univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F", ".."], ["proof (state)\nthis:\n  partitions_of A B F =\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F\n\ngoal (2 subgoals):\n 1. card (partitions_of A B F) \\<le> card B\n 2. partition_on A (partitions_of A B F)", "also"], ["proof (state)\nthis:\n  partitions_of A B F =\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F\n\ngoal (2 subgoals):\n 1. card (partitions_of A B F) \\<le> card B\n 2. partition_on A (partitions_of A B F)", "have \"\\<dots> = univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) (range_permutation A B `` {f})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F =\n    univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f})", "unfolding F_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f}) =\n    univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f})", ".."], ["proof (state)\nthis:\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F =\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (range_permutation A B `` {f})\n\ngoal (2 subgoals):\n 1. card (partitions_of A B F) \\<le> card B\n 2. partition_on A (partitions_of A B F)", "also"], ["proof (state)\nthis:\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) F =\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (range_permutation A B `` {f})\n\ngoal (2 subgoals):\n 1. card (partitions_of A B F) \\<le> card B\n 2. partition_on A (partitions_of A B F)", "have \"\\<dots> = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f}) =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "using equiv_range_permutation domain_partitions_respects_range_permutation \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (prove)\nusing this:\n  equiv (?A \\<rightarrow>\\<^sub>E ?B) (range_permutation ?A ?B)\n  (\\<lambda>f. (\\<lambda>b. {x \\<in> ?A. f x = b}) ` ?B - {{}}) respects\n  range_permutation ?A ?B\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f}) =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "by (subst univ_commute') auto"], ["proof (state)\nthis:\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (range_permutation A B `` {f}) =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (2 subgoals):\n 1. card (partitions_of A B F) \\<le> card B\n 2. partition_on A (partitions_of A B F)", "finally"], ["proof (chain)\npicking this:\n  partitions_of A B F = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "have partitions_of_eq: \"partitions_of A B F = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\""], ["proof (prove)\nusing this:\n  partitions_of A B F = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. partitions_of A B F = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "."], ["proof (state)\nthis:\n  partitions_of A B F = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (2 subgoals):\n 1. card (partitions_of A B F) \\<le> card B\n 2. partition_on A (partitions_of A B F)", "show \"card (partitions_of A B F) \\<le> card B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B", "have \"card (partitions_of A B F) = card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (partitions_of A B F) =\n    card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})", "unfolding partitions_of_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) =\n    card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})", ".."], ["proof (state)\nthis:\n  card (partitions_of A B F) =\n  card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B", "also"], ["proof (state)\nthis:\n  card (partitions_of A B F) =\n  card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B", "have \"\\<dots> \\<le> card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n    \\<le> card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B)", "using \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  finite B\n\ngoal (1 subgoal):\n 1. card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n    \\<le> card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B)", "by (auto intro: card_mono)"], ["proof (state)\nthis:\n  card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n  \\<le> card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B)\n\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B", "also"], ["proof (state)\nthis:\n  card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n  \\<le> card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B)\n\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B", "have \"\\<dots> \\<le> card B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B) \\<le> card B", "using \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  finite B\n\ngoal (1 subgoal):\n 1. card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B) \\<le> card B", "by (rule card_image_le)"], ["proof (state)\nthis:\n  card ((\\<lambda>b. {x \\<in> A. f x = b}) ` B) \\<le> card B\n\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B", "finally"], ["proof (chain)\npicking this:\n  card (partitions_of A B F) \\<le> card B", "show ?thesis"], ["proof (prove)\nusing this:\n  card (partitions_of A B F) \\<le> card B\n\ngoal (1 subgoal):\n 1. card (partitions_of A B F) \\<le> card B", "."], ["proof (state)\nthis:\n  card (partitions_of A B F) \\<le> card B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  card (partitions_of A B F) \\<le> card B\n\ngoal (1 subgoal):\n 1. partition_on A (partitions_of A B F)", "show \"partition_on A (partitions_of A B F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. partition_on A (partitions_of A B F)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. partition_on A (partitions_of A B F)", "have \"partition_on A ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. partition_on A ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})", "using \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. partition_on A ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})", "by (auto intro!: partition_onI)"], ["proof (state)\nthis:\n  partition_on A ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n\ngoal (1 subgoal):\n 1. partition_on A (partitions_of A B F)", "from this"], ["proof (chain)\npicking this:\n  partition_on A ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})", "show ?thesis"], ["proof (prove)\nusing this:\n  partition_on A ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n\ngoal (1 subgoal):\n 1. partition_on A (partitions_of A B F)", "unfolding partitions_of_eq"], ["proof (prove)\nusing this:\n  partition_on A ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n\ngoal (1 subgoal):\n 1. partition_on A ((\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})", "."], ["proof (state)\nthis:\n  partition_on A (partitions_of A B F)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  partition_on A (partitions_of A B F)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma functions_of:\n  assumes \"finite A\" \"finite B\"\n  assumes \"partition_on A P\"\n  assumes \"card P \\<le> card B\"\n  shows \"functions_of P A B \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. functions_of P A B\n    \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. functions_of P A B\n    \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "obtain f where \"f \\<in> A \\<rightarrow>\\<^sub>E B\" and r1: \"(\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>f \\<in> A \\<rightarrow>\\<^sub>E B;\n         (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using obtain_function_with_partition[OF \\<open>finite A\\<close> \\<open>finite B\\<close> \\<open>partition_on A P\\<close> \\<open>card P \\<le> card B\\<close>]"], ["proof (prove)\nusing this:\n  \\<exists>f\\<in>A \\<rightarrow>\\<^sub>E B.\n     (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>f \\<in> A \\<rightarrow>\\<^sub>E B;\n         (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\n\ngoal (1 subgoal):\n 1. functions_of P A B\n    \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "have \"functions_of P A B = range_permutation A B `` {f}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. functions_of P A B = range_permutation A B `` {f}", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. functions_of P A B \\<subseteq> range_permutation A B `` {f}\n 2. range_permutation A B `` {f} \\<subseteq> functions_of P A B", "show \"functions_of P A B \\<subseteq> range_permutation A B `` {f}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. functions_of P A B \\<subseteq> range_permutation A B `` {f}", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of P A B \\<Longrightarrow>\n       x \\<in> range_permutation A B `` {f}", "fix f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of P A B \\<Longrightarrow>\n       x \\<in> range_permutation A B `` {f}", "assume \"f' \\<in> functions_of P A B\""], ["proof (state)\nthis:\n  f' \\<in> functions_of P A B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of P A B \\<Longrightarrow>\n       x \\<in> range_permutation A B `` {f}", "from this"], ["proof (chain)\npicking this:\n  f' \\<in> functions_of P A B", "have \"f' \\<in> A \\<rightarrow>\\<^sub>E B\" and r2: \"(\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = P\""], ["proof (prove)\nusing this:\n  f' \\<in> functions_of P A B\n\ngoal (1 subgoal):\n 1. f' \\<in> A \\<rightarrow>\\<^sub>E B &&&\n    (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = P", "unfolding functions_of_def"], ["proof (prove)\nusing this:\n  f' \\<in> {f \\<in> A \\<rightarrow>\\<^sub>E B.\n            (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P}\n\ngoal (1 subgoal):\n 1. f' \\<in> A \\<rightarrow>\\<^sub>E B &&&\n    (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = P", "by auto"], ["proof (state)\nthis:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = P\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of P A B \\<Longrightarrow>\n       x \\<in> range_permutation A B `` {f}", "from r1 r2"], ["proof (chain)\npicking this:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = P", "obtain p where \"p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\""], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = P\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        p permutes B \\<and>\n        (\\<forall>x\\<in>A. f x = p (f' x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using partitions_eq_implies_permutes[OF \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close> \\<open>f' \\<in> A \\<rightarrow>\\<^sub>E B\\<close>] \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = P\n  \\<lbrakk>finite B;\n   (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n   (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\\<rbrakk>\n  \\<Longrightarrow> \\<exists>p.\n                       p permutes B \\<and>\n                       (\\<forall>x\\<in>A. f x = p (f' x))\n  finite B\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        p permutes B \\<and>\n        (\\<forall>x\\<in>A. f x = p (f' x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of P A B \\<Longrightarrow>\n       x \\<in> range_permutation A B `` {f}", "from this"], ["proof (chain)\npicking this:\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))", "show \"f' \\<in> range_permutation A B `` {f}\""], ["proof (prove)\nusing this:\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\n\ngoal (1 subgoal):\n 1. f' \\<in> range_permutation A B `` {f}", "using \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close> \\<open>f' \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (prove)\nusing this:\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. f' \\<in> range_permutation A B `` {f}", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. f' \\<in> {(f, f').\n              (f, f')\n              \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                    (A \\<rightarrow>\\<^sub>E B) \\<and>\n              (\\<exists>p.\n                  p permutes B \\<and>\n                  (\\<forall>x\\<in>A. f x = p (f' x)))} ``\n             {f}", "by auto"], ["proof (state)\nthis:\n  f' \\<in> range_permutation A B `` {f}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  functions_of P A B \\<subseteq> range_permutation A B `` {f}\n\ngoal (1 subgoal):\n 1. range_permutation A B `` {f} \\<subseteq> functions_of P A B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. range_permutation A B `` {f} \\<subseteq> functions_of P A B", "show \"range_permutation A B `` {f} \\<subseteq> functions_of P A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range_permutation A B `` {f} \\<subseteq> functions_of P A B", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> range_permutation A B `` {f} \\<Longrightarrow>\n       x \\<in> functions_of P A B", "fix f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> range_permutation A B `` {f} \\<Longrightarrow>\n       x \\<in> functions_of P A B", "assume \"f' \\<in> range_permutation A B `` {f}\""], ["proof (state)\nthis:\n  f' \\<in> range_permutation A B `` {f}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> range_permutation A B `` {f} \\<Longrightarrow>\n       x \\<in> functions_of P A B", "from this"], ["proof (chain)\npicking this:\n  f' \\<in> range_permutation A B `` {f}", "have \"(f, f') \\<in> range_permutation A B\""], ["proof (prove)\nusing this:\n  f' \\<in> range_permutation A B `` {f}\n\ngoal (1 subgoal):\n 1. (f, f') \\<in> range_permutation A B", "by auto"], ["proof (state)\nthis:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> range_permutation A B `` {f} \\<Longrightarrow>\n       x \\<in> functions_of P A B", "from this"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "have \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. f' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding range_permutation_def"], ["proof (prove)\nusing this:\n  (f, f')\n  \\<in> {(f, f').\n         (f, f')\n         \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n               (A \\<rightarrow>\\<^sub>E B) \\<and>\n         (\\<exists>p.\n             p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))}\n\ngoal (1 subgoal):\n 1. f' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> range_permutation A B `` {f} \\<Longrightarrow>\n       x \\<in> functions_of P A B", "from \\<open>(f, f') \\<in> range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  (f, f') \\<in> range_permutation A B", "have\n        \"(\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\""], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}", "using congruentD[OF domain_partitions_respects_range_permutation]"], ["proof (prove)\nusing this:\n  (f, f') \\<in> range_permutation A B\n  (?y, ?z) \\<in> range_permutation ?A1 ?B1 \\<Longrightarrow>\n  (\\<lambda>b. {x \\<in> ?A1. ?y x = b}) ` ?B1 - {{}} =\n  (\\<lambda>b. {x \\<in> ?A1. ?z x = b}) ` ?B1 - {{}}\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}", "by blast"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> range_permutation A B `` {f} \\<Longrightarrow>\n       x \\<in> functions_of P A B", "from \\<open>f' \\<in> A \\<rightarrow>\\<^sub>E B\\<close> this r1"], ["proof (chain)\npicking this:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P", "show \"f' \\<in> functions_of P A B\""], ["proof (prove)\nusing this:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\n\ngoal (1 subgoal):\n 1. f' \\<in> functions_of P A B", "unfolding functions_of_def"], ["proof (prove)\nusing this:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\n\ngoal (1 subgoal):\n 1. f' \\<in> {f \\<in> A \\<rightarrow>\\<^sub>E B.\n              (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P}", "by auto"], ["proof (state)\nthis:\n  f' \\<in> functions_of P A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  range_permutation A B `` {f} \\<subseteq> functions_of P A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  functions_of P A B = range_permutation A B `` {f}\n\ngoal (1 subgoal):\n 1. functions_of P A B\n    \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "from this \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (chain)\npicking this:\n  functions_of P A B = range_permutation A B `` {f}\n  f \\<in> A \\<rightarrow>\\<^sub>E B", "show ?thesis"], ["proof (prove)\nusing this:\n  functions_of P A B = range_permutation A B `` {f}\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. functions_of P A B\n    \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "by (auto intro: quotientI)"], ["proof (state)\nthis:\n  functions_of P A B\n  \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma functions_of_partitions_of:\n  assumes \"finite B\"\n  assumes \"F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\"\n  shows \"functions_of (partitions_of A B F) A B = F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. functions_of (partitions_of A B F) A B = F", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. functions_of (partitions_of A B F) A B = F", "from \\<open>F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\\<close>"], ["proof (chain)\npicking this:\n  F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "obtain f where \"f \\<in> A \\<rightarrow>\\<^sub>E B\"\n    and F_eq: \"F = range_permutation A B `` {f}\""], ["proof (prove)\nusing this:\n  F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>f \\<in> A \\<rightarrow>\\<^sub>E B;\n         F = range_permutation A B `` {f}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using quotientE"], ["proof (prove)\nusing this:\n  F \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n  \\<lbrakk>?X \\<in> ?A // ?r;\n   \\<And>x.\n      \\<lbrakk>?X = ?r `` {x}; x \\<in> ?A\\<rbrakk>\n      \\<Longrightarrow> ?P\\<rbrakk>\n  \\<Longrightarrow> ?P\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>f \\<in> A \\<rightarrow>\\<^sub>E B;\n         F = range_permutation A B `` {f}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  F = range_permutation A B `` {f}\n\ngoal (1 subgoal):\n 1. functions_of (partitions_of A B F) A B = F", "have partitions_of_eq: \"partitions_of A B F = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. partitions_of A B F = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "unfolding partitions_of_def F_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f}) =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "using equiv_range_permutation domain_partitions_respects_range_permutation \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (prove)\nusing this:\n  equiv (?A \\<rightarrow>\\<^sub>E ?B) (range_permutation ?A ?B)\n  (\\<lambda>f. (\\<lambda>b. {x \\<in> ?A. f x = b}) ` ?B - {{}}) respects\n  range_permutation ?A ?B\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f}) =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "by (subst univ_commute') auto"], ["proof (state)\nthis:\n  partitions_of A B F = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. functions_of (partitions_of A B F) A B = F", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. functions_of (partitions_of A B F) A B = F", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. functions_of (partitions_of A B F) A B \\<subseteq> F\n 2. F \\<subseteq> functions_of (partitions_of A B F) A B", "show \"functions_of (partitions_of A B F) A B \\<subseteq> F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. functions_of (partitions_of A B F) A B \\<subseteq> F", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "fix f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "assume f': \"f' \\<in> functions_of (partitions_of A B F) A B\""], ["proof (state)\nthis:\n  f' \\<in> functions_of (partitions_of A B F) A B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "from this"], ["proof (chain)\npicking this:\n  f' \\<in> functions_of (partitions_of A B F) A B", "have \"(\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\""], ["proof (prove)\nusing this:\n  f' \\<in> functions_of (partitions_of A B F) A B\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}", "unfolding functions_of_def"], ["proof (prove)\nusing this:\n  f' \\<in> {f \\<in> A \\<rightarrow>\\<^sub>E B.\n            (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n            partitions_of A B F}\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}", "by (auto simp add: partitions_of_eq)"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "note \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "moreover"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "from f'"], ["proof (chain)\npicking this:\n  f' \\<in> functions_of (partitions_of A B F) A B", "have \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  f' \\<in> functions_of (partitions_of A B F) A B\n\ngoal (1 subgoal):\n 1. f' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding functions_of_def"], ["proof (prove)\nusing this:\n  f' \\<in> {f \\<in> A \\<rightarrow>\\<^sub>E B.\n            (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} =\n            partitions_of A B F}\n\ngoal (1 subgoal):\n 1. f' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "moreover"], ["proof (state)\nthis:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "obtain p where \"p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>p.\n        p permutes B \\<and>\n        (\\<forall>x\\<in>A. f x = p (f' x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using partitions_eq_implies_permutes[OF \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close> \\<open>f' \\<in> A \\<rightarrow>\\<^sub>E B\\<close> \\<open>finite B\\<close>\n          \\<open>(\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}}\\<close>]"], ["proof (prove)\nusing this:\n  \\<exists>p. p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        p permutes B \\<and>\n        (\\<forall>x\\<in>A. f x = p (f' x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> functions_of (partitions_of A B F) A B \\<Longrightarrow>\n       x \\<in> F", "ultimately"], ["proof (chain)\npicking this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))", "show \"f' \\<in> F\""], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\n\ngoal (1 subgoal):\n 1. f' \\<in> F", "unfolding F_eq range_permutation_def"], ["proof (prove)\nusing this:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n  p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x))\n\ngoal (1 subgoal):\n 1. f' \\<in> {(f, f').\n              (f, f')\n              \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                    (A \\<rightarrow>\\<^sub>E B) \\<and>\n              (\\<exists>p.\n                  p permutes B \\<and>\n                  (\\<forall>x\\<in>A. f x = p (f' x)))} ``\n             {f}", "by auto"], ["proof (state)\nthis:\n  f' \\<in> F\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  functions_of (partitions_of A B F) A B \\<subseteq> F\n\ngoal (1 subgoal):\n 1. F \\<subseteq> functions_of (partitions_of A B F) A B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<subseteq> functions_of (partitions_of A B F) A B", "show \"F \\<subseteq> functions_of (partitions_of A B F) A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<subseteq> functions_of (partitions_of A B F) A B", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> F \\<Longrightarrow>\n       x \\<in> functions_of (partitions_of A B F) A B", "fix f'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> F \\<Longrightarrow>\n       x \\<in> functions_of (partitions_of A B F) A B", "assume \"f' \\<in> F\""], ["proof (state)\nthis:\n  f' \\<in> F\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> F \\<Longrightarrow>\n       x \\<in> functions_of (partitions_of A B F) A B", "from this"], ["proof (chain)\npicking this:\n  f' \\<in> F", "have \"f' \\<in> A \\<rightarrow>\\<^sub>E B\""], ["proof (prove)\nusing this:\n  f' \\<in> F\n\ngoal (1 subgoal):\n 1. f' \\<in> A \\<rightarrow>\\<^sub>E B", "unfolding F_eq range_permutation_def"], ["proof (prove)\nusing this:\n  f' \\<in> {(f, f').\n            (f, f')\n            \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                  (A \\<rightarrow>\\<^sub>E B) \\<and>\n            (\\<exists>p.\n                p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))} ``\n           {f}\n\ngoal (1 subgoal):\n 1. f' \\<in> A \\<rightarrow>\\<^sub>E B", "by auto"], ["proof (state)\nthis:\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> F \\<Longrightarrow>\n       x \\<in> functions_of (partitions_of A B F) A B", "from \\<open>f' \\<in> F\\<close>"], ["proof (chain)\npicking this:\n  f' \\<in> F", "obtain p where \"p permutes B\" \"\\<forall>x\\<in>A. f x = p (f' x)\""], ["proof (prove)\nusing this:\n  f' \\<in> F\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding F_eq range_permutation_def"], ["proof (prove)\nusing this:\n  f' \\<in> {(f, f').\n            (f, f')\n            \\<in> (A \\<rightarrow>\\<^sub>E B) \\<times>\n                  (A \\<rightarrow>\\<^sub>E B) \\<and>\n            (\\<exists>p.\n                p permutes B \\<and> (\\<forall>x\\<in>A. f x = p (f' x)))} ``\n           {f}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p permutes B; \\<forall>x\\<in>A. f x = p (f' x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p permutes B\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> F \\<Longrightarrow>\n       x \\<in> functions_of (partitions_of A B F) A B", "have eq: \"(\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "have \"(\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} = (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}", "using permutes_implies_inv_image_on_eq[OF \\<open>p permutes B\\<close>, of A f']"], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B =\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "also"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "have \"\\<dots> =  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "using \\<open>\\<forall>x\\<in>A. f x = p (f' x)\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = p (f' x)\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. p (f' x) = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "."], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> F \\<Longrightarrow>\n       x \\<in> functions_of (partitions_of A B F) A B", "from this \\<open>f' \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (chain)\npicking this:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n  f' \\<in> A \\<rightarrow>\\<^sub>E B", "show \"f' \\<in> functions_of (partitions_of A B F) A B\""], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. f' \\<in> functions_of (partitions_of A B F) A B", "unfolding functions_of_def partitions_of_eq"], ["proof (prove)\nusing this:\n  (\\<lambda>b. {x \\<in> A. f' x = b}) ` B - {{}} =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n  f' \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. f' \\<in> {fa \\<in> A \\<rightarrow>\\<^sub>E B.\n              (\\<lambda>b. {x \\<in> A. fa x = b}) ` B - {{}} =\n              (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}}", "by auto"], ["proof (state)\nthis:\n  f' \\<in> functions_of (partitions_of A B F) A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F \\<subseteq> functions_of (partitions_of A B F) A B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  functions_of (partitions_of A B F) A B = F\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma partitions_of_functions_of:\n  assumes \"finite A\" \"finite B\"\n  assumes \"partition_on A P\"\n  assumes \"card P \\<le> card B\"\n  shows \"partitions_of A B (functions_of P A B) = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "have \"functions_of P A B \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. functions_of P A B\n    \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "using \\<open>finite A\\<close> \\<open>finite B\\<close> \\<open>partition_on A P\\<close> \\<open>card P \\<le> card B\\<close>"], ["proof (prove)\nusing this:\n  finite A\n  finite B\n  partition_on A P\n  card P \\<le> card B\n\ngoal (1 subgoal):\n 1. functions_of P A B\n    \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "by (rule functions_of)"], ["proof (state)\nthis:\n  functions_of P A B\n  \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "from this"], ["proof (chain)\npicking this:\n  functions_of P A B\n  \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "obtain f where \"f \\<in> A \\<rightarrow>\\<^sub>E B\" and functions_of_eq: \"functions_of P A B = range_permutation A B `` {f}\""], ["proof (prove)\nusing this:\n  functions_of P A B\n  \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>f \\<in> A \\<rightarrow>\\<^sub>E B;\n         functions_of P A B = range_permutation A B `` {f}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using quotientE"], ["proof (prove)\nusing this:\n  functions_of P A B\n  \\<in> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n  \\<lbrakk>?X \\<in> ?A // ?r;\n   \\<And>x.\n      \\<lbrakk>?X = ?r `` {x}; x \\<in> ?A\\<rbrakk>\n      \\<Longrightarrow> ?P\\<rbrakk>\n  \\<Longrightarrow> ?P\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>f \\<in> A \\<rightarrow>\\<^sub>E B;\n         functions_of P A B = range_permutation A B `` {f}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  functions_of P A B = range_permutation A B `` {f}\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "from functions_of_eq \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (chain)\npicking this:\n  functions_of P A B = range_permutation A B `` {f}\n  f \\<in> A \\<rightarrow>\\<^sub>E B", "have \"f \\<in> functions_of P A B\""], ["proof (prove)\nusing this:\n  functions_of P A B = range_permutation A B `` {f}\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. f \\<in> functions_of P A B", "using equiv_range_permutation equiv_class_self"], ["proof (prove)\nusing this:\n  functions_of P A B = range_permutation A B `` {f}\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n  equiv (?A \\<rightarrow>\\<^sub>E ?B) (range_permutation ?A ?B)\n  \\<lbrakk>equiv ?A ?r; ?a \\<in> ?A\\<rbrakk>\n  \\<Longrightarrow> ?a \\<in> ?r `` {?a}\n\ngoal (1 subgoal):\n 1. f \\<in> functions_of P A B", "by fastforce"], ["proof (state)\nthis:\n  f \\<in> functions_of P A B\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "have \"partitions_of A B (functions_of P A B) = univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) (functions_of P A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) =\n    univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (functions_of P A B)", "unfolding partitions_of_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (functions_of P A B) =\n    univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (functions_of P A B)", ".."], ["proof (state)\nthis:\n  partitions_of A B (functions_of P A B) =\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (functions_of P A B)\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "also"], ["proof (state)\nthis:\n  partitions_of A B (functions_of P A B) =\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (functions_of P A B)\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "have \"\\<dots> = univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}) (range_permutation A B `` {f})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (functions_of P A B) =\n    univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f})", "unfolding \\<open>functions_of P A B = range_permutation A B `` {f}\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f}) =\n    univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f})", ".."], ["proof (state)\nthis:\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (functions_of P A B) =\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (range_permutation A B `` {f})\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "also"], ["proof (state)\nthis:\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (functions_of P A B) =\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (range_permutation A B `` {f})\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "have \"\\<dots> = (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f}) =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "using equiv_range_permutation domain_partitions_respects_range_permutation \\<open>f \\<in> A \\<rightarrow>\\<^sub>E B\\<close>"], ["proof (prove)\nusing this:\n  equiv (?A \\<rightarrow>\\<^sub>E ?B) (range_permutation ?A ?B)\n  (\\<lambda>f. (\\<lambda>b. {x \\<in> ?A. f x = b}) ` ?B - {{}}) respects\n  range_permutation ?A ?B\n  f \\<in> A \\<rightarrow>\\<^sub>E B\n\ngoal (1 subgoal):\n 1. univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n     (range_permutation A B `` {f}) =\n    (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}", "by (subst univ_commute') auto"], ["proof (state)\nthis:\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (range_permutation A B `` {f}) =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "also"], ["proof (state)\nthis:\n  univ (\\<lambda>f. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}})\n   (range_permutation A B `` {f}) =\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}}\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "have \"(\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P", "using \\<open>f \\<in> functions_of P A B\\<close>"], ["proof (prove)\nusing this:\n  f \\<in> functions_of P A B\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P", "unfolding functions_of_def"], ["proof (prove)\nusing this:\n  f \\<in> {f \\<in> A \\<rightarrow>\\<^sub>E B.\n           (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P}\n\ngoal (1 subgoal):\n 1. (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>b. {x \\<in> A. f x = b}) ` B - {{}} = P\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "finally"], ["proof (chain)\npicking this:\n  partitions_of A B (functions_of P A B) = P", "show ?thesis"], ["proof (prove)\nusing this:\n  partitions_of A B (functions_of P A B) = P\n\ngoal (1 subgoal):\n 1. partitions_of A B (functions_of P A B) = P", "."], ["proof (state)\nthis:\n  partitions_of A B (functions_of P A B) = P\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Bijections\\<close>"], ["", "lemma bij_betw_partitions_of:\n  assumes \"finite A\" \"finite B\"\n  shows \"bij_betw (partitions_of A B) ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) {P. partition_on A P \\<and> card P \\<le> card B}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (partitions_of A B)\n     ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B)\n     {P. partition_on A P \\<and> card P \\<le> card B}", "proof (rule bij_betw_byWitness[where f'=\"\\<lambda>P. functions_of P A B\"])"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<forall>a\\<in>(A \\<rightarrow>\\<^sub>E B) // range_permutation A B.\n       functions_of (partitions_of A B a) A B = a\n 2. \\<forall>a'\\<in>{P. partition_on A P \\<and> card P \\<le> card B}.\n       partitions_of A B (functions_of a' A B) = a'\n 3. partitions_of A B ` (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n    \\<subseteq> {P. partition_on A P \\<and> card P \\<le> card B}\n 4. (\\<lambda>P. functions_of P A B) `\n    {P. partition_on A P \\<and> card P \\<le> card B}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "show \"\\<forall>F\\<in>(A \\<rightarrow>\\<^sub>E B) // range_permutation A B. functions_of (partitions_of A B F) A B = F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>F\\<in>(A \\<rightarrow>\\<^sub>E B) // range_permutation A B.\n       functions_of (partitions_of A B F) A B = F", "using \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  finite B\n\ngoal (1 subgoal):\n 1. \\<forall>F\\<in>(A \\<rightarrow>\\<^sub>E B) // range_permutation A B.\n       functions_of (partitions_of A B F) A B = F", "by (simp add: functions_of_partitions_of)"], ["proof (state)\nthis:\n  \\<forall>F\\<in>(A \\<rightarrow>\\<^sub>E B) // range_permutation A B.\n     functions_of (partitions_of A B F) A B = F\n\ngoal (3 subgoals):\n 1. \\<forall>a'\\<in>{P. partition_on A P \\<and> card P \\<le> card B}.\n       partitions_of A B (functions_of a' A B) = a'\n 2. partitions_of A B ` (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n    \\<subseteq> {P. partition_on A P \\<and> card P \\<le> card B}\n 3. (\\<lambda>P. functions_of P A B) `\n    {P. partition_on A P \\<and> card P \\<le> card B}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "show \"\\<forall>P\\<in>{P. partition_on A P \\<and> card P \\<le> card B}. partitions_of A B (functions_of P A B) = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>P\\<in>{P. partition_on A P \\<and> card P \\<le> card B}.\n       partitions_of A B (functions_of P A B) = P", "using \\<open>finite A\\<close> \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  finite A\n  finite B\n\ngoal (1 subgoal):\n 1. \\<forall>P\\<in>{P. partition_on A P \\<and> card P \\<le> card B}.\n       partitions_of A B (functions_of P A B) = P", "by (auto simp add: partitions_of_functions_of)"], ["proof (state)\nthis:\n  \\<forall>P\\<in>{P. partition_on A P \\<and> card P \\<le> card B}.\n     partitions_of A B (functions_of P A B) = P\n\ngoal (2 subgoals):\n 1. partitions_of A B ` (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n    \\<subseteq> {P. partition_on A P \\<and> card P \\<le> card B}\n 2. (\\<lambda>P. functions_of P A B) `\n    {P. partition_on A P \\<and> card P \\<le> card B}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "show \"partitions_of A B ` ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) \\<subseteq> {P. partition_on A P \\<and> card P \\<le> card B}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. partitions_of A B ` (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n    \\<subseteq> {P. partition_on A P \\<and> card P \\<le> card B}", "using \\<open>finite B\\<close> partitions_of"], ["proof (prove)\nusing this:\n  finite B\n  \\<lbrakk>finite ?B;\n   ?F \\<in> (?A \\<rightarrow>\\<^sub>E ?B) //\n            range_permutation ?A ?B\\<rbrakk>\n  \\<Longrightarrow> card (partitions_of ?A ?B ?F) \\<le> card ?B\n  \\<lbrakk>finite ?B;\n   ?F \\<in> (?A \\<rightarrow>\\<^sub>E ?B) //\n            range_permutation ?A ?B\\<rbrakk>\n  \\<Longrightarrow> partition_on ?A (partitions_of ?A ?B ?F)\n\ngoal (1 subgoal):\n 1. partitions_of A B ` (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n    \\<subseteq> {P. partition_on A P \\<and> card P \\<le> card B}", "by auto"], ["proof (state)\nthis:\n  partitions_of A B ` (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n  \\<subseteq> {P. partition_on A P \\<and> card P \\<le> card B}\n\ngoal (1 subgoal):\n 1. (\\<lambda>P. functions_of P A B) `\n    {P. partition_on A P \\<and> card P \\<le> card B}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "show \"(\\<lambda>P. functions_of P A B) ` {P. partition_on A P \\<and> card P \\<le> card B} \\<subseteq> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>P. functions_of P A B) `\n    {P. partition_on A P \\<and> card P \\<le> card B}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "using functions_of \\<open>finite A\\<close> \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>finite ?A; finite ?B; partition_on ?A ?P;\n   card ?P \\<le> card ?B\\<rbrakk>\n  \\<Longrightarrow> functions_of ?P ?A ?B\n                    \\<in> (?A \\<rightarrow>\\<^sub>E ?B) //\n                          range_permutation ?A ?B\n  finite A\n  finite B\n\ngoal (1 subgoal):\n 1. (\\<lambda>P. functions_of P A B) `\n    {P. partition_on A P \\<and> card P \\<le> card B}\n    \\<subseteq> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>P. functions_of P A B) `\n  {P. partition_on A P \\<and> card P \\<le> card B}\n  \\<subseteq> (A \\<rightarrow>\\<^sub>E B) // range_permutation A B\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Cardinality\\<close>"], ["", "lemma\n  assumes \"finite A\" \"finite B\"\n  shows \"card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) = (\\<Sum>j\\<le>card B. Stirling (card A) j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n    sum (Stirling (card A)) {..card B}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n    sum (Stirling (card A)) {..card B}", "have \"bij_betw (partitions_of A B) ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) {P. partition_on A P \\<and> card P \\<le> card B}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_betw (partitions_of A B)\n     ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B)\n     {P. partition_on A P \\<and> card P \\<le> card B}", "using \\<open>finite A\\<close> \\<open>finite B\\<close>"], ["proof (prove)\nusing this:\n  finite A\n  finite B\n\ngoal (1 subgoal):\n 1. bij_betw (partitions_of A B)\n     ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B)\n     {P. partition_on A P \\<and> card P \\<le> card B}", "by (rule bij_betw_partitions_of)"], ["proof (state)\nthis:\n  bij_betw (partitions_of A B)\n   ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B)\n   {P. partition_on A P \\<and> card P \\<le> card B}\n\ngoal (1 subgoal):\n 1. card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n    sum (Stirling (card A)) {..card B}", "from this"], ["proof (chain)\npicking this:\n  bij_betw (partitions_of A B)\n   ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B)\n   {P. partition_on A P \\<and> card P \\<le> card B}", "have \"card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) = card {P. partition_on A P \\<and> card P \\<le> card B}\""], ["proof (prove)\nusing this:\n  bij_betw (partitions_of A B)\n   ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B)\n   {P. partition_on A P \\<and> card P \\<le> card B}\n\ngoal (1 subgoal):\n 1. card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n    card {P. partition_on A P \\<and> card P \\<le> card B}", "by (rule bij_betw_same_card)"], ["proof (state)\nthis:\n  card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n  card {P. partition_on A P \\<and> card P \\<le> card B}\n\ngoal (1 subgoal):\n 1. card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n    sum (Stirling (card A)) {..card B}", "also"], ["proof (state)\nthis:\n  card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n  card {P. partition_on A P \\<and> card P \\<le> card B}\n\ngoal (1 subgoal):\n 1. card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n    sum (Stirling (card A)) {..card B}", "have \"card  {P. partition_on A P \\<and> card P \\<le> card B} = (\\<Sum>j\\<le>card B. Stirling (card A) j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card {P. partition_on A P \\<and> card P \\<le> card B} =\n    sum (Stirling (card A)) {..card B}", "using \\<open>finite A\\<close>"], ["proof (prove)\nusing this:\n  finite A\n\ngoal (1 subgoal):\n 1. card {P. partition_on A P \\<and> card P \\<le> card B} =\n    sum (Stirling (card A)) {..card B}", "by (rule card_partition_on_at_most_size)"], ["proof (state)\nthis:\n  card {P. partition_on A P \\<and> card P \\<le> card B} =\n  sum (Stirling (card A)) {..card B}\n\ngoal (1 subgoal):\n 1. card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n    sum (Stirling (card A)) {..card B}", "finally"], ["proof (chain)\npicking this:\n  card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n  sum (Stirling (card A)) {..card B}", "show ?thesis"], ["proof (prove)\nusing this:\n  card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n  sum (Stirling (card A)) {..card B}\n\ngoal (1 subgoal):\n 1. card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n    sum (Stirling (card A)) {..card B}", "."], ["proof (state)\nthis:\n  card ((A \\<rightarrow>\\<^sub>E B) // range_permutation A B) =\n  sum (Stirling (card A)) {..card B}\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}