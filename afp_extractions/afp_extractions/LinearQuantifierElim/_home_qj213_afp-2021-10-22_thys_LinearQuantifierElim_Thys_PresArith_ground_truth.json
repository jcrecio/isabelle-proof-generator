{"file_name": "/home/qj213/afp-2021-10-22/thys/LinearQuantifierElim/Thys/PresArith.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/LinearQuantifierElim", "problem_names": ["lemma IZ_asubst: \"I\\<^sub>Z (asubst i ks a) xs = I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\"", "lemma I_subst:\n  \"qfree \\<phi> \\<Longrightarrow> Z.I \\<phi> ((i + \\<langle>ks,xs\\<rangle>) # xs) = Z.I (subst i ks \\<phi>) xs\"", "lemma divisor_asubst[simp]: \"divisor (asubst i ks a) = divisor a\"", "lemma set_lbounds:\n  \"set(lbounds as) = {(i,ks)|i k ks. Le i (k#ks) \\<in> set as \\<and> k>0}\"", "lemma set_ubounds:\n  \"set(ubounds as) = {(i,ks)|i k ks. Le i (k#ks) \\<in> set as \\<and> k<0}\"", "lemma lbounds_append[simp]: \"lbounds(as @ bs) = lbounds as @ lbounds bs\"", "lemma dvd_zlcms: \"i \\<in> set is \\<Longrightarrow> i dvd zlcms is\"", "lemma zlcms_pos: \"\\<forall>i \\<in> set is. i\\<noteq>0 \\<Longrightarrow> zlcms is > 0\"", "lemma zlcms0_iff[simp]: \"(zlcms is = 0) = (0 \\<in> set is)\"", "lemma elem_le_zlcms: \"\\<forall>i \\<in> set is. i \\<noteq> 0 \\<Longrightarrow> i \\<in> set is \\<Longrightarrow> i \\<le> zlcms is\"", "lemma \"\\<lbrakk> k \\<noteq> 0; k dvd m \\<rbrakk> \\<Longrightarrow>\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i (k#ks))) (x#e) = (let m' = m div (abs k) in\n  I\\<^sub>Z (Dvd (m'*d) (m'*i) (sgn k # (m' *\\<^sub>s ks))) (x#e))\"", "lemma I_hd_coeff1_mult_a: assumes \"m>0\"\nshows \"hd_coeff a dvd m | hd_coeff a = 0 \\<Longrightarrow> I\\<^sub>Z (hd_coeff1 m a) (m*x#xs) = I\\<^sub>Z a (x#xs)\"", "lemma I_hd_coeff1_mult: assumes \"m>0\"\nshows \"qfree \\<phi> \\<Longrightarrow> \\<forall> a \\<in> set(Z.atoms\\<^sub>0 \\<phi>). hd_coeff a dvd m \\<Longrightarrow>\n Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>) (m*x#xs) = Z.I \\<phi> (x#xs)\""], "translations": [["", "lemma IZ_asubst: \"I\\<^sub>Z (asubst i ks a) xs = I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (asubst i ks a) xs =\n    I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)", "apply (cases a)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x11 x12.\n       a = Le x11 x12 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks a) xs =\n       I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\n 2. \\<And>x21 x22 x23.\n       a = Dvd x21 x22 x23 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks a) xs =\n       I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\n 3. \\<And>x31 x32 x33.\n       a = NDvd x31 x32 x33 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks a) xs =\n       I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)", "apply (rename_tac list)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x11 list.\n       a = Le x11 list \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks a) xs =\n       I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\n 2. \\<And>x21 x22 x23.\n       a = Dvd x21 x22 x23 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks a) xs =\n       I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\n 3. \\<And>x31 x32 x33.\n       a = NDvd x31 x32 x33 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks a) xs =\n       I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)", "apply (case_tac list)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x11 list.\n       \\<lbrakk>a = Le x11 list; list = []\\<rbrakk>\n       \\<Longrightarrow> I\\<^sub>Z (asubst i ks a) xs =\n                         I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\n 2. \\<And>x11 list aa lista.\n       \\<lbrakk>a = Le x11 list; list = aa # lista\\<rbrakk>\n       \\<Longrightarrow> I\\<^sub>Z (asubst i ks a) xs =\n                         I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\n 3. \\<And>x21 x22 x23.\n       a = Dvd x21 x22 x23 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks a) xs =\n       I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)\n 4. \\<And>x31 x32 x33.\n       a = NDvd x31 x32 x33 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks a) xs =\n       I\\<^sub>Z a ((i + \\<langle>ks,xs\\<rangle>) # xs)", "apply (simp_all add:algebra_simps iprod_left_add_distrib)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x21 x22 x23.\n       a = Dvd x21 x22 x23 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks (Dvd x21 x22 x23)) xs =\n       (x21 dvd\n        x22 + \\<langle>x23,(i + \\<langle>ks,xs\\<rangle>) # xs\\<rangle>)\n 2. \\<And>x31 x32 x33.\n       a = NDvd x31 x32 x33 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks (NDvd x31 x32 x33)) xs =\n       (\\<not> x31 dvd\n               x32 +\n               \\<langle>x33,(i + \\<langle>ks,xs\\<rangle>) # xs\\<rangle>)", "apply (rename_tac list)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x21 x22 list.\n       a = Dvd x21 x22 list \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks (Dvd x21 x22 list)) xs =\n       (x21 dvd\n        x22 + \\<langle>list,(i + \\<langle>ks,xs\\<rangle>) # xs\\<rangle>)\n 2. \\<And>x31 x32 x33.\n       a = NDvd x31 x32 x33 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks (NDvd x31 x32 x33)) xs =\n       (\\<not> x31 dvd\n               x32 +\n               \\<langle>x33,(i + \\<langle>ks,xs\\<rangle>) # xs\\<rangle>)", "apply (case_tac list)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x21 x22 list.\n       \\<lbrakk>a = Dvd x21 x22 list; list = []\\<rbrakk>\n       \\<Longrightarrow> I\\<^sub>Z (asubst i ks (Dvd x21 x22 list)) xs =\n                         (x21 dvd\n                          x22 +\n                          \\<langle>list,(i + \\<langle>ks,xs\\<rangle>) #\n  xs\\<rangle>)\n 2. \\<And>x21 x22 list aa lista.\n       \\<lbrakk>a = Dvd x21 x22 list; list = aa # lista\\<rbrakk>\n       \\<Longrightarrow> I\\<^sub>Z (asubst i ks (Dvd x21 x22 list)) xs =\n                         (x21 dvd\n                          x22 +\n                          \\<langle>list,(i + \\<langle>ks,xs\\<rangle>) #\n  xs\\<rangle>)\n 3. \\<And>x31 x32 x33.\n       a = NDvd x31 x32 x33 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks (NDvd x31 x32 x33)) xs =\n       (\\<not> x31 dvd\n               x32 +\n               \\<langle>x33,(i + \\<langle>ks,xs\\<rangle>) # xs\\<rangle>)", "apply (simp_all add:algebra_simps iprod_left_add_distrib)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x31 x32 x33.\n       a = NDvd x31 x32 x33 \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks (NDvd x31 x32 x33)) xs =\n       (\\<not> x31 dvd\n               x32 +\n               \\<langle>x33,(i + \\<langle>ks,xs\\<rangle>) # xs\\<rangle>)", "apply (rename_tac list)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x31 x32 list.\n       a = NDvd x31 x32 list \\<Longrightarrow>\n       I\\<^sub>Z (asubst i ks (NDvd x31 x32 list)) xs =\n       (\\<not> x31 dvd\n               x32 +\n               \\<langle>list,(i + \\<langle>ks,xs\\<rangle>) # xs\\<rangle>)", "apply (case_tac list)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x31 x32 list.\n       \\<lbrakk>a = NDvd x31 x32 list; list = []\\<rbrakk>\n       \\<Longrightarrow> I\\<^sub>Z (asubst i ks (NDvd x31 x32 list)) xs =\n                         (\\<not> x31 dvd\n                                 x32 +\n                                 \\<langle>list,(i +\n          \\<langle>ks,xs\\<rangle>) #\n         xs\\<rangle>)\n 2. \\<And>x31 x32 list aa lista.\n       \\<lbrakk>a = NDvd x31 x32 list; list = aa # lista\\<rbrakk>\n       \\<Longrightarrow> I\\<^sub>Z (asubst i ks (NDvd x31 x32 list)) xs =\n                         (\\<not> x31 dvd\n                                 x32 +\n                                 \\<langle>list,(i +\n          \\<langle>ks,xs\\<rangle>) #\n         xs\\<rangle>)", "apply (simp_all add:algebra_simps iprod_left_add_distrib)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma I_subst:\n  \"qfree \\<phi> \\<Longrightarrow> Z.I \\<phi> ((i + \\<langle>ks,xs\\<rangle>) # xs) = Z.I (subst i ks \\<phi>) xs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. qfree \\<phi> \\<Longrightarrow>\n    Z.I \\<phi> ((i + \\<langle>ks,xs\\<rangle>) # xs) =\n    Z.I (subst i ks \\<phi>) xs", "by (induct \\<phi>) (simp_all add:IZ_asubst)"], ["", "lemma divisor_asubst[simp]: \"divisor (asubst i ks a) = divisor a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. divisor (asubst i ks a) = divisor a", "by(induct i ks a rule:asubst.induct) auto"], ["", "definition \"lbounds as = [(i,ks). Le i (k#ks) \\<leftarrow> as, k>0]\""], ["", "definition \"ubounds as = [(i,ks). Le i (k#ks) \\<leftarrow> as, k<0]\""], ["", "lemma set_lbounds:\n  \"set(lbounds as) = {(i,ks)|i k ks. Le i (k#ks) \\<in> set as \\<and> k>0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set (lbounds as) =\n    {uu_.\n     \\<exists>i k ks.\n        uu_ = (i, ks) \\<and> Le i (k # ks) \\<in> set as \\<and> 0 < k}", "by(auto simp: lbounds_def split:list.splits atom.splits if_splits)"], ["", "lemma set_ubounds:\n  \"set(ubounds as) = {(i,ks)|i k ks. Le i (k#ks) \\<in> set as \\<and> k<0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set (ubounds as) =\n    {uu_.\n     \\<exists>i k ks.\n        uu_ = (i, ks) \\<and> Le i (k # ks) \\<in> set as \\<and> k < 0}", "by(auto simp: ubounds_def split:list.splits atom.splits if_splits)"], ["", "lemma lbounds_append[simp]: \"lbounds(as @ bs) = lbounds as @ lbounds bs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lbounds (as @ bs) = lbounds as @ lbounds bs", "by(simp add:lbounds_def)"], ["", "subsection\\<open>LCM and lemmas\\<close>"], ["", "fun zlcms :: \"int list \\<Rightarrow> int\" where\n\"zlcms [] = 1\" |\n\"zlcms (i#is) = lcm i (zlcms is)\""], ["", "lemma dvd_zlcms: \"i \\<in> set is \\<Longrightarrow> i dvd zlcms is\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i \\<in> set is \\<Longrightarrow> i dvd zlcms is", "by(induct \"is\") auto"], ["", "lemma zlcms_pos: \"\\<forall>i \\<in> set is. i\\<noteq>0 \\<Longrightarrow> zlcms is > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>set is. i \\<noteq> 0 \\<Longrightarrow> 0 < zlcms is", "by(induct \"is\")(auto simp:lcm_pos_int)"], ["", "lemma zlcms0_iff[simp]: \"(zlcms is = 0) = (0 \\<in> set is)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (zlcms is = 0) = (0 \\<in> set is)", "by (metis mod_by_0 dvd_eq_mod_eq_0 dvd_zlcms zlcms_pos less_le)"], ["", "lemma elem_le_zlcms: \"\\<forall>i \\<in> set is. i \\<noteq> 0 \\<Longrightarrow> i \\<in> set is \\<Longrightarrow> i \\<le> zlcms is\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<in>set is. i \\<noteq> 0; i \\<in> set is\\<rbrakk>\n    \\<Longrightarrow> i \\<le> zlcms is", "by (metis dvd_zlcms zdvd_imp_le zlcms_pos)"], ["", "subsection\\<open>Setting coeffiencients to 1 or -1\\<close>"], ["", "fun hd_coeff1 :: \"int \\<Rightarrow> atom \\<Rightarrow> atom\" where\n\"hd_coeff1 m (Le i (k#ks)) =\n   (if k=0 then Le i (k#ks)\n    else let m' = m div (abs k) in Le (m'*i) (sgn k # (m' *\\<^sub>s ks)))\" |\n\"hd_coeff1 m (Dvd d i (k#ks)) =\n   (if k=0 then Dvd d i (k#ks)\n    else let m' = m div k in Dvd (m'*d) (m'*i) (1 # (m' *\\<^sub>s ks)))\" |\n\"hd_coeff1 m (NDvd d i (k#ks)) =\n   (if k=0 then NDvd d i (k#ks)\n    else let m' = m div k in NDvd (m'*d) (m'*i) (1 # (m' *\\<^sub>s ks)))\" |\n\"hd_coeff1 _ a = a\""], ["", "text\\<open>The def of @{const hd_coeff1} on @{const Dvd} and @{const NDvd} is\ndifferent from the @{const Le} because it allows the resulting head\ncoefficient to be 1 rather than 1 or -1. We show that the other version has\nthe same semantics:\\<close>"], ["", "lemma \"\\<lbrakk> k \\<noteq> 0; k dvd m \\<rbrakk> \\<Longrightarrow>\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i (k#ks))) (x#e) = (let m' = m div (abs k) in\n  I\\<^sub>Z (Dvd (m'*d) (m'*i) (sgn k # (m' *\\<^sub>s ks))) (x#e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<noteq> 0; k dvd m\\<rbrakk>\n    \\<Longrightarrow> I\\<^sub>Z (hd_coeff1 m (Dvd d i (k # ks))) (x # e) =\n                      (let m' = m div \\<bar>k\\<bar>\n                       in I\\<^sub>Z\n                           (Dvd (m' * d) (m' * i) (sgn k # m' *\\<^sub>s ks))\n                           (x # e))", "apply(auto simp:algebra_simps abs_if sgn_if)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>k \\<noteq> 0; k dvd m; \\<not> 0 < k;\n     d * (m div k) dvd\n     x + (i * (m div k) + \\<langle>ks,e\\<rangle> * (m div k))\\<rbrakk>\n    \\<Longrightarrow> d * (m div - k) dvd\n                      i * (m div - k) +\n                      \\<langle>ks,e\\<rangle> * (m div - k) -\n                      x\n 2. \\<lbrakk>k \\<noteq> 0; k dvd m; \\<not> 0 < k;\n     d * (m div - k) dvd\n     i * (m div - k) + \\<langle>ks,e\\<rangle> * (m div - k) - x\\<rbrakk>\n    \\<Longrightarrow> d * (m div k) dvd\n                      x +\n                      (i * (m div k) + \\<langle>ks,e\\<rangle> * (m div k))", "apply(simp add: zdiv_zminus2_eq_if dvd_eq_mod_eq_0[THEN iffD1] algebra_simps)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>k \\<noteq> 0; k dvd m; \\<not> 0 < k;\n     d * (m div k) dvd\n     x + (i * (m div k) + \\<langle>ks,e\\<rangle> * (m div k))\\<rbrakk>\n    \\<Longrightarrow> d * (m div k) dvd\n                      - (i * (m div k)) -\n                      (x + \\<langle>ks,e\\<rangle> * (m div k))\n 2. \\<lbrakk>k \\<noteq> 0; k dvd m; \\<not> 0 < k;\n     d * (m div - k) dvd\n     i * (m div - k) + \\<langle>ks,e\\<rangle> * (m div - k) - x\\<rbrakk>\n    \\<Longrightarrow> d * (m div k) dvd\n                      x +\n                      (i * (m div k) + \\<langle>ks,e\\<rangle> * (m div k))", "apply (metis diff_conv_add_uminus add.left_commute dvd_minus_iff minus_add_distrib)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<noteq> 0; k dvd m; \\<not> 0 < k;\n     d * (m div - k) dvd\n     i * (m div - k) + \\<langle>ks,e\\<rangle> * (m div - k) - x\\<rbrakk>\n    \\<Longrightarrow> d * (m div k) dvd\n                      x +\n                      (i * (m div k) + \\<langle>ks,e\\<rangle> * (m div k))", "apply(simp add: zdiv_zminus2_eq_if dvd_eq_mod_eq_0[THEN iffD1] algebra_simps)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<noteq> 0; k dvd m; \\<not> 0 < k;\n     d * (m div k) dvd\n     - (i * (m div k)) - (x + \\<langle>ks,e\\<rangle> * (m div k))\\<rbrakk>\n    \\<Longrightarrow> d * (m div k) dvd\n                      x +\n                      (i * (m div k) + \\<langle>ks,e\\<rangle> * (m div k))", "apply (metis diff_conv_add_uminus add.left_commute dvd_minus_iff minus_add_distrib)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma I_hd_coeff1_mult_a: assumes \"m>0\"\nshows \"hd_coeff a dvd m | hd_coeff a = 0 \\<Longrightarrow> I\\<^sub>Z (hd_coeff1 m a) (m*x#xs) = I\\<^sub>Z a (x#xs)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hd_coeff a dvd m \\<or> hd_coeff a = 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m a) (m * x # xs) = I\\<^sub>Z a (x # xs)", "proof(induct a)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1 x2.\n       hd_coeff (Le x1 x2) dvd m \\<or>\n       hd_coeff (Le x1 x2) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Le x1 x2)) (m * x # xs) =\n       I\\<^sub>Z (Le x1 x2) (x # xs)\n 2. \\<And>x1 x2 x3.\n       hd_coeff (Dvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (Dvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (Dvd x1 x2 x3) (x # xs)\n 3. \\<And>x1 x2 x3.\n       hd_coeff (NDvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (NDvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (NDvd x1 x2 x3) (x # xs)", "case [simp]: (Le i ks)"], ["proof (state)\nthis:\n  hd_coeff (Le i ks) dvd m \\<or> hd_coeff (Le i ks) = 0\n\ngoal (3 subgoals):\n 1. \\<And>x1 x2.\n       hd_coeff (Le x1 x2) dvd m \\<or>\n       hd_coeff (Le x1 x2) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Le x1 x2)) (m * x # xs) =\n       I\\<^sub>Z (Le x1 x2) (x # xs)\n 2. \\<And>x1 x2 x3.\n       hd_coeff (Dvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (Dvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (Dvd x1 x2 x3) (x # xs)\n 3. \\<And>x1 x2 x3.\n       hd_coeff (NDvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (NDvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (NDvd x1 x2 x3) (x # xs)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "proof(cases ks)"], ["proof (state)\ngoal (2 subgoals):\n 1. ks = [] \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)\n 2. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n       I\\<^sub>Z (Le i ks) (x # xs)", "case Nil"], ["proof (state)\nthis:\n  ks = []\n\ngoal (2 subgoals):\n 1. ks = [] \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)\n 2. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n       I\\<^sub>Z (Le i ks) (x # xs)", "thus ?thesis"], ["proof (prove)\nusing this:\n  ks = []\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "by simp"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  I\\<^sub>Z (Le i ks) (x # xs)\n\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n       I\\<^sub>Z (Le i ks) (x # xs)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n       I\\<^sub>Z (Le i ks) (x # xs)", "case [simp]: (Cons k ks')"], ["proof (state)\nthis:\n  ks = k # ks'\n\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n       I\\<^sub>Z (Le i ks) (x # xs)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)\n 2. \\<not> ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "assume \"k=0\""], ["proof (state)\nthis:\n  k = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)\n 2. \\<not> ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "thus ?thesis"], ["proof (prove)\nusing this:\n  k = 0\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "by simp"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  I\\<^sub>Z (Le i ks) (x # xs)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "assume \"k\\<noteq>0\""], ["proof (state)\nthis:\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "with Le"], ["proof (chain)\npicking this:\n  hd_coeff (Le i ks) dvd m \\<or> hd_coeff (Le i ks) = 0\n  k \\<noteq> 0", "have \"\\<bar>k\\<bar> dvd m\""], ["proof (prove)\nusing this:\n  hd_coeff (Le i ks) dvd m \\<or> hd_coeff (Le i ks) = 0\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<bar>k\\<bar> dvd m", "by simp"], ["proof (state)\nthis:\n  \\<bar>k\\<bar> dvd m\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "let ?m' = \"m div \\<bar>k\\<bar>\""], ["proof (state)\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "have \"?m' > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < m div \\<bar>k\\<bar>", "using \\<open>\\<bar>k\\<bar> dvd m\\<close> pos_imp_zdiv_pos_iff \\<open>m>0\\<close> \\<open>k\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  \\<bar>k\\<bar> dvd m\n  0 < ?k \\<Longrightarrow> (0 < ?i div ?k) = (?k \\<le> ?i)\n  0 < m\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < m div \\<bar>k\\<bar>", "by(simp add:zdvd_imp_le)"], ["proof (state)\nthis:\n  0 < m div \\<bar>k\\<bar>\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "have 1: \"k*(x*?m') = sgn k * x * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "have \"k*(x*?m') = (sgn k * abs k) * (x * ?m')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) =\n    sgn k * \\<bar>k\\<bar> * (x * (m div \\<bar>k\\<bar>))", "by(simp only: mult_sgn_abs)"], ["proof (state)\nthis:\n  k * (x * (m div \\<bar>k\\<bar>)) =\n  sgn k * \\<bar>k\\<bar> * (x * (m div \\<bar>k\\<bar>))\n\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "also"], ["proof (state)\nthis:\n  k * (x * (m div \\<bar>k\\<bar>)) =\n  sgn k * \\<bar>k\\<bar> * (x * (m div \\<bar>k\\<bar>))\n\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "have \"\\<dots> = sgn k * x * (abs k * ?m')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sgn k * \\<bar>k\\<bar> * (x * (m div \\<bar>k\\<bar>)) =\n    sgn k * x * (\\<bar>k\\<bar> * (m div \\<bar>k\\<bar>))", "by simp"], ["proof (state)\nthis:\n  sgn k * \\<bar>k\\<bar> * (x * (m div \\<bar>k\\<bar>)) =\n  sgn k * x * (\\<bar>k\\<bar> * (m div \\<bar>k\\<bar>))\n\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "also"], ["proof (state)\nthis:\n  sgn k * \\<bar>k\\<bar> * (x * (m div \\<bar>k\\<bar>)) =\n  sgn k * x * (\\<bar>k\\<bar> * (m div \\<bar>k\\<bar>))\n\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "have \"\\<dots> = sgn k * x * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sgn k * x * (\\<bar>k\\<bar> * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "using dvd_mult_div_cancel[OF \\<open>\\<bar>k\\<bar> dvd m\\<close>]"], ["proof (prove)\nusing this:\n  \\<bar>k\\<bar> * (m div \\<bar>k\\<bar>) = m\n\ngoal (1 subgoal):\n 1. sgn k * x * (\\<bar>k\\<bar> * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  sgn k * x * (\\<bar>k\\<bar> * (m div \\<bar>k\\<bar>)) = sgn k * x * m\n\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "finally"], ["proof (chain)\npicking this:\n  k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "show ?thesis"], ["proof (prove)\nusing this:\n  k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m\n\ngoal (1 subgoal):\n 1. k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m", "."], ["proof (state)\nthis:\n  k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "have \"I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m*x#xs) \\<longleftrightarrow>\n            (i*?m' \\<le> sgn k * m*x + ?m' * \\<langle>ks',xs\\<rangle>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    (i * (m div \\<bar>k\\<bar>)\n     \\<le> sgn k * m * x + m div \\<bar>k\\<bar> * \\<langle>ks',xs\\<rangle>)", "using \\<open>k\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    (i * (m div \\<bar>k\\<bar>)\n     \\<le> sgn k * m * x + m div \\<bar>k\\<bar> * \\<langle>ks',xs\\<rangle>)", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  (i * (m div \\<bar>k\\<bar>)\n   \\<le> sgn k * m * x + m div \\<bar>k\\<bar> * \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "also"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  (i * (m div \\<bar>k\\<bar>)\n   \\<le> sgn k * m * x + m div \\<bar>k\\<bar> * \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "have \"\\<dots> \\<longleftrightarrow> ?m'*i \\<le> ?m' * (k*x + \\<langle>ks',xs\\<rangle>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (i * (m div \\<bar>k\\<bar>)\n     \\<le> sgn k * m * x + m div \\<bar>k\\<bar> * \\<langle>ks',xs\\<rangle>) =\n    (m div \\<bar>k\\<bar> * i\n     \\<le> m div \\<bar>k\\<bar> * (k * x + \\<langle>ks',xs\\<rangle>))", "using 1"], ["proof (prove)\nusing this:\n  k * (x * (m div \\<bar>k\\<bar>)) = sgn k * x * m\n\ngoal (1 subgoal):\n 1. (i * (m div \\<bar>k\\<bar>)\n     \\<le> sgn k * m * x + m div \\<bar>k\\<bar> * \\<langle>ks',xs\\<rangle>) =\n    (m div \\<bar>k\\<bar> * i\n     \\<le> m div \\<bar>k\\<bar> * (k * x + \\<langle>ks',xs\\<rangle>))", "by(simp (no_asm_simp) add:algebra_simps)"], ["proof (state)\nthis:\n  (i * (m div \\<bar>k\\<bar>)\n   \\<le> sgn k * m * x + m div \\<bar>k\\<bar> * \\<langle>ks',xs\\<rangle>) =\n  (m div \\<bar>k\\<bar> * i\n   \\<le> m div \\<bar>k\\<bar> * (k * x + \\<langle>ks',xs\\<rangle>))\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "also"], ["proof (state)\nthis:\n  (i * (m div \\<bar>k\\<bar>)\n   \\<le> sgn k * m * x + m div \\<bar>k\\<bar> * \\<langle>ks',xs\\<rangle>) =\n  (m div \\<bar>k\\<bar> * i\n   \\<le> m div \\<bar>k\\<bar> * (k * x + \\<langle>ks',xs\\<rangle>))\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "have \"\\<dots> \\<longleftrightarrow> i \\<le> k*x + \\<langle>ks',xs\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (m div \\<bar>k\\<bar> * i\n     \\<le> m div \\<bar>k\\<bar> * (k * x + \\<langle>ks',xs\\<rangle>)) =\n    (i \\<le> k * x + \\<langle>ks',xs\\<rangle>)", "using \\<open>?m'>0\\<close>"], ["proof (prove)\nusing this:\n  0 < m div \\<bar>k\\<bar>\n\ngoal (1 subgoal):\n 1. (m div \\<bar>k\\<bar> * i\n     \\<le> m div \\<bar>k\\<bar> * (k * x + \\<langle>ks',xs\\<rangle>)) =\n    (i \\<le> k * x + \\<langle>ks',xs\\<rangle>)", "by simp"], ["proof (state)\nthis:\n  (m div \\<bar>k\\<bar> * i\n   \\<le> m div \\<bar>k\\<bar> * (k * x + \\<langle>ks',xs\\<rangle>)) =\n  (i \\<le> k * x + \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "finally"], ["proof (chain)\npicking this:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  (i \\<le> k * x + \\<langle>ks',xs\\<rangle>)", "show ?thesis"], ["proof (prove)\nusing this:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  (i \\<le> k * x + \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n    I\\<^sub>Z (Le i ks) (x # xs)", "by(simp)"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  I\\<^sub>Z (Le i ks) (x # xs)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  I\\<^sub>Z (Le i ks) (x # xs)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Le i ks)) (m * x # xs) =\n  I\\<^sub>Z (Le i ks) (x # xs)\n\ngoal (2 subgoals):\n 1. \\<And>x1 x2 x3.\n       hd_coeff (Dvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (Dvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (Dvd x1 x2 x3) (x # xs)\n 2. \\<And>x1 x2 x3.\n       hd_coeff (NDvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (NDvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (NDvd x1 x2 x3) (x # xs)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1 x2 x3.\n       hd_coeff (Dvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (Dvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (Dvd x1 x2 x3) (x # xs)\n 2. \\<And>x1 x2 x3.\n       hd_coeff (NDvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (NDvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (NDvd x1 x2 x3) (x # xs)", "case [simp]: (Dvd d i ks)"], ["proof (state)\nthis:\n  hd_coeff (Dvd d i ks) dvd m \\<or> hd_coeff (Dvd d i ks) = 0\n\ngoal (2 subgoals):\n 1. \\<And>x1 x2 x3.\n       hd_coeff (Dvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (Dvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (Dvd x1 x2 x3) (x # xs)\n 2. \\<And>x1 x2 x3.\n       hd_coeff (NDvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (NDvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (NDvd x1 x2 x3) (x # xs)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "proof(cases ks)"], ["proof (state)\ngoal (2 subgoals):\n 1. ks = [] \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)\n 2. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (Dvd d i ks) (x # xs)", "case Nil"], ["proof (state)\nthis:\n  ks = []\n\ngoal (2 subgoals):\n 1. ks = [] \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)\n 2. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (Dvd d i ks) (x # xs)", "thus ?thesis"], ["proof (prove)\nusing this:\n  ks = []\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "by simp"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (Dvd d i ks) (x # xs)\n\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (Dvd d i ks) (x # xs)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (Dvd d i ks) (x # xs)", "case [simp]: (Cons k ks')"], ["proof (state)\nthis:\n  ks = k # ks'\n\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (Dvd d i ks) (x # xs)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)\n 2. \\<not> ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "assume \"k=0\""], ["proof (state)\nthis:\n  k = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)\n 2. \\<not> ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "thus ?thesis"], ["proof (prove)\nusing this:\n  k = 0\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "by simp"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (Dvd d i ks) (x # xs)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "assume \"k\\<noteq>0\""], ["proof (state)\nthis:\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "with Dvd"], ["proof (chain)\npicking this:\n  hd_coeff (Dvd d i ks) dvd m \\<or> hd_coeff (Dvd d i ks) = 0\n  k \\<noteq> 0", "have \"k dvd m\""], ["proof (prove)\nusing this:\n  hd_coeff (Dvd d i ks) dvd m \\<or> hd_coeff (Dvd d i ks) = 0\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k dvd m", "by simp"], ["proof (state)\nthis:\n  k dvd m\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "let ?m' = \"m div k\""], ["proof (state)\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "have \"?m' \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m div k \\<noteq> 0", "using \\<open>k dvd m\\<close> zdiv_eq_0_iff \\<open>m>0\\<close> \\<open>k\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  k dvd m\n  (?i div ?k = 0) =\n  (?k = 0 \\<or> 0 \\<le> ?i \\<and> ?i < ?k \\<or> ?i \\<le> 0 \\<and> ?k < ?i)\n  0 < m\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. m div k \\<noteq> 0", "by(simp add:linorder_not_less zdvd_imp_le)"], ["proof (state)\nthis:\n  m div k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "have 1: \"k*(x*?m') = x * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "have \"k*(x*?m') = x*(k*?m')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * (k * (m div k))", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  k * (x * (m div k)) = x * (k * (m div k))\n\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "also"], ["proof (state)\nthis:\n  k * (x * (m div k)) = x * (k * (m div k))\n\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "have \"\\<dots> = x*m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x * (k * (m div k)) = x * m", "using dvd_mult_div_cancel[OF \\<open>k dvd m\\<close>]"], ["proof (prove)\nusing this:\n  k * (m div k) = m\n\ngoal (1 subgoal):\n 1. x * (k * (m div k)) = x * m", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  x * (k * (m div k)) = x * m\n\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "finally"], ["proof (chain)\npicking this:\n  k * (x * (m div k)) = x * m", "show ?thesis"], ["proof (prove)\nusing this:\n  k * (x * (m div k)) = x * m\n\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "."], ["proof (state)\nthis:\n  k * (x * (m div k)) = x * m\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  k * (x * (m div k)) = x * m\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "have \"I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m*x#xs) \\<longleftrightarrow>\n            (?m'*d dvd ?m'*i + m*x + ?m' * \\<langle>ks',xs\\<rangle>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    (m div k * d dvd\n     m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>)", "using \\<open>k\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    (m div k * d dvd\n     m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>)", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  (m div k * d dvd m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "also"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  (m div k * d dvd m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "have \"\\<dots> \\<longleftrightarrow> ?m'*d dvd ?m' * (i + k*x + \\<langle>ks',xs\\<rangle>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (m div k * d dvd\n     m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>) =\n    (m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>))", "using 1"], ["proof (prove)\nusing this:\n  k * (x * (m div k)) = x * m\n\ngoal (1 subgoal):\n 1. (m div k * d dvd\n     m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>) =\n    (m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>))", "by(simp (no_asm_simp) add:algebra_simps)"], ["proof (state)\nthis:\n  (m div k * d dvd\n   m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>) =\n  (m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>))\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "also"], ["proof (state)\nthis:\n  (m div k * d dvd\n   m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>) =\n  (m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>))\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "have \"\\<dots> \\<longleftrightarrow> d dvd i + k*x + \\<langle>ks',xs\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>)) =\n    (d dvd i + k * x + \\<langle>ks',xs\\<rangle>)", "using \\<open>?m'\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  m div k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>)) =\n    (d dvd i + k * x + \\<langle>ks',xs\\<rangle>)", "by(simp)"], ["proof (state)\nthis:\n  (m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>)) =\n  (d dvd i + k * x + \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "finally"], ["proof (chain)\npicking this:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  (d dvd i + k * x + \\<langle>ks',xs\\<rangle>)", "show ?thesis"], ["proof (prove)\nusing this:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  (d dvd i + k * x + \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (Dvd d i ks) (x # xs)", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (Dvd d i ks) (x # xs)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (Dvd d i ks) (x # xs)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (Dvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (Dvd d i ks) (x # xs)\n\ngoal (1 subgoal):\n 1. \\<And>x1 x2 x3.\n       hd_coeff (NDvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (NDvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (NDvd x1 x2 x3) (x # xs)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1 x2 x3.\n       hd_coeff (NDvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (NDvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (NDvd x1 x2 x3) (x # xs)", "case [simp]: (NDvd d i ks)"], ["proof (state)\nthis:\n  hd_coeff (NDvd d i ks) dvd m \\<or> hd_coeff (NDvd d i ks) = 0\n\ngoal (1 subgoal):\n 1. \\<And>x1 x2 x3.\n       hd_coeff (NDvd x1 x2 x3) dvd m \\<or>\n       hd_coeff (NDvd x1 x2 x3) = 0 \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd x1 x2 x3)) (m * x # xs) =\n       I\\<^sub>Z (NDvd x1 x2 x3) (x # xs)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "proof(cases ks)"], ["proof (state)\ngoal (2 subgoals):\n 1. ks = [] \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)\n 2. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (NDvd d i ks) (x # xs)", "case Nil"], ["proof (state)\nthis:\n  ks = []\n\ngoal (2 subgoals):\n 1. ks = [] \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)\n 2. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (NDvd d i ks) (x # xs)", "thus ?thesis"], ["proof (prove)\nusing this:\n  ks = []\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "by simp"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (NDvd d i ks) (x # xs)\n\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (NDvd d i ks) (x # xs)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (NDvd d i ks) (x # xs)", "case [simp]: (Cons k ks')"], ["proof (state)\nthis:\n  ks = k # ks'\n\ngoal (1 subgoal):\n 1. \\<And>a list.\n       ks = a # list \\<Longrightarrow>\n       I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n       I\\<^sub>Z (NDvd d i ks) (x # xs)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)\n 2. \\<not> ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "assume \"k=0\""], ["proof (state)\nthis:\n  k = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)\n 2. \\<not> ?P \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "thus ?thesis"], ["proof (prove)\nusing this:\n  k = 0\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "by simp"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (NDvd d i ks) (x # xs)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "assume \"k\\<noteq>0\""], ["proof (state)\nthis:\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "with NDvd"], ["proof (chain)\npicking this:\n  hd_coeff (NDvd d i ks) dvd m \\<or> hd_coeff (NDvd d i ks) = 0\n  k \\<noteq> 0", "have \"k dvd m\""], ["proof (prove)\nusing this:\n  hd_coeff (NDvd d i ks) dvd m \\<or> hd_coeff (NDvd d i ks) = 0\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k dvd m", "by simp"], ["proof (state)\nthis:\n  k dvd m\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "let ?m' = \"m div k\""], ["proof (state)\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "have \"?m' \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m div k \\<noteq> 0", "using \\<open>k dvd m\\<close> zdiv_eq_0_iff \\<open>m>0\\<close> \\<open>k\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  k dvd m\n  (?i div ?k = 0) =\n  (?k = 0 \\<or> 0 \\<le> ?i \\<and> ?i < ?k \\<or> ?i \\<le> 0 \\<and> ?k < ?i)\n  0 < m\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. m div k \\<noteq> 0", "by(simp add:linorder_not_less zdvd_imp_le)"], ["proof (state)\nthis:\n  m div k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "have 1: \"k*(x*?m') = x * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "have \"k*(x*?m') = x*(k*?m')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * (k * (m div k))", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  k * (x * (m div k)) = x * (k * (m div k))\n\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "also"], ["proof (state)\nthis:\n  k * (x * (m div k)) = x * (k * (m div k))\n\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "have \"\\<dots> = x*m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x * (k * (m div k)) = x * m", "using dvd_mult_div_cancel[OF \\<open>k dvd m\\<close>]"], ["proof (prove)\nusing this:\n  k * (m div k) = m\n\ngoal (1 subgoal):\n 1. x * (k * (m div k)) = x * m", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  x * (k * (m div k)) = x * m\n\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "finally"], ["proof (chain)\npicking this:\n  k * (x * (m div k)) = x * m", "show ?thesis"], ["proof (prove)\nusing this:\n  k * (x * (m div k)) = x * m\n\ngoal (1 subgoal):\n 1. k * (x * (m div k)) = x * m", "."], ["proof (state)\nthis:\n  k * (x * (m div k)) = x * m\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  k * (x * (m div k)) = x * m\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "have \"I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m*x#xs) \\<longleftrightarrow>\n            \\<not>(?m'*d dvd ?m'*i + m*x + ?m' * \\<langle>ks',xs\\<rangle>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    (\\<not> m div k * d dvd\n            m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>)", "using \\<open>k\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    (\\<not> m div k * d dvd\n            m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>)", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  (\\<not> m div k * d dvd\n          m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "also"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  (\\<not> m div k * d dvd\n          m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "have \"\\<dots> \\<longleftrightarrow> \\<not> ?m'*d dvd ?m' * (i + k*x + \\<langle>ks',xs\\<rangle>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<not> m div k * d dvd\n            m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>) =\n    (\\<not> m div k * d dvd\n            m div k * (i + k * x + \\<langle>ks',xs\\<rangle>))", "using 1"], ["proof (prove)\nusing this:\n  k * (x * (m div k)) = x * m\n\ngoal (1 subgoal):\n 1. (\\<not> m div k * d dvd\n            m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>) =\n    (\\<not> m div k * d dvd\n            m div k * (i + k * x + \\<langle>ks',xs\\<rangle>))", "by(simp (no_asm_simp) add:algebra_simps)"], ["proof (state)\nthis:\n  (\\<not> m div k * d dvd\n          m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>) =\n  (\\<not> m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>))\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "also"], ["proof (state)\nthis:\n  (\\<not> m div k * d dvd\n          m div k * i + m * x + m div k * \\<langle>ks',xs\\<rangle>) =\n  (\\<not> m div k * d dvd m div k * (i + k * x + \\<langle>ks',xs\\<rangle>))\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "have \"\\<dots> \\<longleftrightarrow> \\<not> d dvd i + k*x + \\<langle>ks',xs\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<not> m div k * d dvd\n            m div k * (i + k * x + \\<langle>ks',xs\\<rangle>)) =\n    (\\<not> d dvd i + k * x + \\<langle>ks',xs\\<rangle>)", "using \\<open>?m'\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  m div k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<not> m div k * d dvd\n            m div k * (i + k * x + \\<langle>ks',xs\\<rangle>)) =\n    (\\<not> d dvd i + k * x + \\<langle>ks',xs\\<rangle>)", "by(simp)"], ["proof (state)\nthis:\n  (\\<not> m div k * d dvd\n          m div k * (i + k * x + \\<langle>ks',xs\\<rangle>)) =\n  (\\<not> d dvd i + k * x + \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "finally"], ["proof (chain)\npicking this:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  (\\<not> d dvd i + k * x + \\<langle>ks',xs\\<rangle>)", "show ?thesis"], ["proof (prove)\nusing this:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  (\\<not> d dvd i + k * x + \\<langle>ks',xs\\<rangle>)\n\ngoal (1 subgoal):\n 1. I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n    I\\<^sub>Z (NDvd d i ks) (x # xs)", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (NDvd d i ks) (x # xs)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (NDvd d i ks) (x # xs)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  I\\<^sub>Z (hd_coeff1 m (NDvd d i ks)) (m * x # xs) =\n  I\\<^sub>Z (NDvd d i ks) (x # xs)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma I_hd_coeff1_mult: assumes \"m>0\"\nshows \"qfree \\<phi> \\<Longrightarrow> \\<forall> a \\<in> set(Z.atoms\\<^sub>0 \\<phi>). hd_coeff a dvd m \\<Longrightarrow>\n Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>) (m*x#xs) = Z.I \\<phi> (x#xs)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>qfree \\<phi>;\n     \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>). hd_coeff a dvd m\\<rbrakk>\n    \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>)\n                       (m * x # xs) =\n                      Z.I \\<phi> (x # xs)", "proof(induct \\<phi>)"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<lbrakk>qfree TrueF;\n     \\<forall>a\\<in>set (atoms\\<^sub>0 TrueF). hd_coeff a dvd m\\<rbrakk>\n    \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) TrueF)\n                       (m * x # xs) =\n                      Z.I TrueF (x # xs)\n 2. \\<lbrakk>qfree FalseF;\n     \\<forall>a\\<in>set (atoms\\<^sub>0 FalseF). hd_coeff a dvd m\\<rbrakk>\n    \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) FalseF)\n                       (m * x # xs) =\n                      Z.I FalseF (x # xs)\n 3. \\<And>xa.\n       \\<lbrakk>qfree (Atom xa);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (Atom xa)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) (Atom xa))\n                          (m * x # xs) =\n                         Z.I (Atom xa) (x # xs)\n 4. \\<And>\\<phi>1 \\<phi>2.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>1;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>1).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>1)\n                                   (m * x # xs) =\n                                  Z.I \\<phi>1 (x # xs);\n        \\<lbrakk>qfree \\<phi>2;\n         \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>2).\n            hd_coeff a dvd m\\<rbrakk>\n        \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>2)\n                           (m * x # xs) =\n                          Z.I \\<phi>2 (x # xs);\n        qfree (And \\<phi>1 \\<phi>2);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (And \\<phi>1 \\<phi>2)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (And \\<phi>1 \\<phi>2))\n                          (m * x # xs) =\n                         Z.I (And \\<phi>1 \\<phi>2) (x # xs)\n 5. \\<And>\\<phi>1 \\<phi>2.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>1;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>1).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>1)\n                                   (m * x # xs) =\n                                  Z.I \\<phi>1 (x # xs);\n        \\<lbrakk>qfree \\<phi>2;\n         \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>2).\n            hd_coeff a dvd m\\<rbrakk>\n        \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>2)\n                           (m * x # xs) =\n                          Z.I \\<phi>2 (x # xs);\n        qfree (Or \\<phi>1 \\<phi>2);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (Or \\<phi>1 \\<phi>2)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (Or \\<phi>1 \\<phi>2))\n                          (m * x # xs) =\n                         Z.I (Or \\<phi>1 \\<phi>2) (x # xs)\n 6. \\<And>\\<phi>.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>)\n                                   (m * x # xs) =\n                                  Z.I \\<phi> (x # xs);\n        qfree (Neg \\<phi>);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (Neg \\<phi>)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (Neg \\<phi>))\n                          (m * x # xs) =\n                         Z.I (Neg \\<phi>) (x # xs)\n 7. \\<And>\\<phi>.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>)\n                                   (m * x # xs) =\n                                  Z.I \\<phi> (x # xs);\n        qfree (ExQ \\<phi>);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (ExQ \\<phi>)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (ExQ \\<phi>))\n                          (m * x # xs) =\n                         Z.I (ExQ \\<phi>) (x # xs)", "case (Atom a)"], ["proof (state)\nthis:\n  qfree (Atom a)\n  \\<forall>a\\<in>set (atoms\\<^sub>0 (Atom a)). hd_coeff a dvd m\n\ngoal (7 subgoals):\n 1. \\<lbrakk>qfree TrueF;\n     \\<forall>a\\<in>set (atoms\\<^sub>0 TrueF). hd_coeff a dvd m\\<rbrakk>\n    \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) TrueF)\n                       (m * x # xs) =\n                      Z.I TrueF (x # xs)\n 2. \\<lbrakk>qfree FalseF;\n     \\<forall>a\\<in>set (atoms\\<^sub>0 FalseF). hd_coeff a dvd m\\<rbrakk>\n    \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) FalseF)\n                       (m * x # xs) =\n                      Z.I FalseF (x # xs)\n 3. \\<And>xa.\n       \\<lbrakk>qfree (Atom xa);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (Atom xa)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) (Atom xa))\n                          (m * x # xs) =\n                         Z.I (Atom xa) (x # xs)\n 4. \\<And>\\<phi>1 \\<phi>2.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>1;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>1).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>1)\n                                   (m * x # xs) =\n                                  Z.I \\<phi>1 (x # xs);\n        \\<lbrakk>qfree \\<phi>2;\n         \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>2).\n            hd_coeff a dvd m\\<rbrakk>\n        \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>2)\n                           (m * x # xs) =\n                          Z.I \\<phi>2 (x # xs);\n        qfree (And \\<phi>1 \\<phi>2);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (And \\<phi>1 \\<phi>2)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (And \\<phi>1 \\<phi>2))\n                          (m * x # xs) =\n                         Z.I (And \\<phi>1 \\<phi>2) (x # xs)\n 5. \\<And>\\<phi>1 \\<phi>2.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>1;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>1).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>1)\n                                   (m * x # xs) =\n                                  Z.I \\<phi>1 (x # xs);\n        \\<lbrakk>qfree \\<phi>2;\n         \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>2).\n            hd_coeff a dvd m\\<rbrakk>\n        \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>2)\n                           (m * x # xs) =\n                          Z.I \\<phi>2 (x # xs);\n        qfree (Or \\<phi>1 \\<phi>2);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (Or \\<phi>1 \\<phi>2)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (Or \\<phi>1 \\<phi>2))\n                          (m * x # xs) =\n                         Z.I (Or \\<phi>1 \\<phi>2) (x # xs)\n 6. \\<And>\\<phi>.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>)\n                                   (m * x # xs) =\n                                  Z.I \\<phi> (x # xs);\n        qfree (Neg \\<phi>);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (Neg \\<phi>)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (Neg \\<phi>))\n                          (m * x # xs) =\n                         Z.I (Neg \\<phi>) (x # xs)\n 7. \\<And>\\<phi>.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>)\n                                   (m * x # xs) =\n                                  Z.I \\<phi> (x # xs);\n        qfree (ExQ \\<phi>);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (ExQ \\<phi>)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (ExQ \\<phi>))\n                          (m * x # xs) =\n                         Z.I (ExQ \\<phi>) (x # xs)", "thus ?case"], ["proof (prove)\nusing this:\n  qfree (Atom a)\n  \\<forall>a\\<in>set (atoms\\<^sub>0 (Atom a)). hd_coeff a dvd m\n\ngoal (1 subgoal):\n 1. Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) (Atom a)) (m * x # xs) =\n    Z.I (Atom a) (x # xs)", "using I_hd_coeff1_mult_a[OF \\<open>m>0\\<close>]"], ["proof (prove)\nusing this:\n  qfree (Atom a)\n  \\<forall>a\\<in>set (atoms\\<^sub>0 (Atom a)). hd_coeff a dvd m\n  hd_coeff ?a dvd m \\<or> hd_coeff ?a = 0 \\<Longrightarrow>\n  I\\<^sub>Z (hd_coeff1 m ?a) (m * ?x # ?xs) = I\\<^sub>Z ?a (?x # ?xs)\n\ngoal (1 subgoal):\n 1. Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) (Atom a)) (m * x # xs) =\n    Z.I (Atom a) (x # xs)", "by auto"], ["proof (state)\nthis:\n  Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) (Atom a)) (m * x # xs) =\n  Z.I (Atom a) (x # xs)\n\ngoal (6 subgoals):\n 1. \\<lbrakk>qfree TrueF;\n     \\<forall>a\\<in>set (atoms\\<^sub>0 TrueF). hd_coeff a dvd m\\<rbrakk>\n    \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) TrueF)\n                       (m * x # xs) =\n                      Z.I TrueF (x # xs)\n 2. \\<lbrakk>qfree FalseF;\n     \\<forall>a\\<in>set (atoms\\<^sub>0 FalseF). hd_coeff a dvd m\\<rbrakk>\n    \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) FalseF)\n                       (m * x # xs) =\n                      Z.I FalseF (x # xs)\n 3. \\<And>\\<phi>1 \\<phi>2.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>1;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>1).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>1)\n                                   (m * x # xs) =\n                                  Z.I \\<phi>1 (x # xs);\n        \\<lbrakk>qfree \\<phi>2;\n         \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>2).\n            hd_coeff a dvd m\\<rbrakk>\n        \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>2)\n                           (m * x # xs) =\n                          Z.I \\<phi>2 (x # xs);\n        qfree (And \\<phi>1 \\<phi>2);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (And \\<phi>1 \\<phi>2)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (And \\<phi>1 \\<phi>2))\n                          (m * x # xs) =\n                         Z.I (And \\<phi>1 \\<phi>2) (x # xs)\n 4. \\<And>\\<phi>1 \\<phi>2.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>1;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>1).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>1)\n                                   (m * x # xs) =\n                                  Z.I \\<phi>1 (x # xs);\n        \\<lbrakk>qfree \\<phi>2;\n         \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>2).\n            hd_coeff a dvd m\\<rbrakk>\n        \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m) \\<phi>2)\n                           (m * x # xs) =\n                          Z.I \\<phi>2 (x # xs);\n        qfree (Or \\<phi>1 \\<phi>2);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (Or \\<phi>1 \\<phi>2)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (Or \\<phi>1 \\<phi>2))\n                          (m * x # xs) =\n                         Z.I (Or \\<phi>1 \\<phi>2) (x # xs)\n 5. \\<And>\\<phi>.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>)\n                                   (m * x # xs) =\n                                  Z.I \\<phi> (x # xs);\n        qfree (Neg \\<phi>);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (Neg \\<phi>)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (Neg \\<phi>))\n                          (m * x # xs) =\n                         Z.I (Neg \\<phi>) (x # xs)\n 6. \\<And>\\<phi>.\n       \\<lbrakk>\\<lbrakk>qfree \\<phi>;\n                 \\<forall>a\\<in>set (atoms\\<^sub>0 \\<phi>).\n                    hd_coeff a dvd m\\<rbrakk>\n                \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n  \\<phi>)\n                                   (m * x # xs) =\n                                  Z.I \\<phi> (x # xs);\n        qfree (ExQ \\<phi>);\n        \\<forall>a\\<in>set (atoms\\<^sub>0 (ExQ \\<phi>)).\n           hd_coeff a dvd m\\<rbrakk>\n       \\<Longrightarrow> Z.I (map\\<^sub>f\\<^sub>m (hd_coeff1 m)\n                               (ExQ \\<phi>))\n                          (m * x # xs) =\n                         Z.I (ExQ \\<phi>) (x # xs)", "qed simp_all"], ["", "end"]]}