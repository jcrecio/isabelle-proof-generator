{"file_name": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations/Library/Multivariate_Taylor.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations", "problem_names": ["lemma\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n    and Df::\"'a \\<Rightarrow> nat \\<Rightarrow> 'a \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  assumes \"n > 0\"\n  assumes Df_Nil: \"\\<And>a x. Df a 0 H H = f a\"\n  assumes Df_Cons: \"\\<And>a i d. a \\<in> closed_segment X (X + H) \\<Longrightarrow> i < n \\<Longrightarrow>\n      ((\\<lambda>a. Df a i H H) has_derivative (Df a (Suc i) H)) (at a within G)\"\n  assumes cs: \"closed_segment X (X + H) \\<subseteq> G\"\n  defines \"i \\<equiv> \\<lambda>x.\n      ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R Df (X + x *\\<^sub>R H) n H H\"\n  shows multivariate_Taylor_has_integral:\n    \"(i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H)) {0..1}\"\n  and multivariate_Taylor:\n    \"f (X + H) = (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\"\n  and multivariate_Taylor_integrable:\n    \"i integrable_on {0..1}\"", "lemma symmetric_second_derivative_aux:\n  assumes first_fderiv[derivative_intros]:\n    \"\\<And>a. a \\<in> G \\<Longrightarrow> (f has_derivative (f' a)) (at a within G)\"\n  assumes second_fderiv[derivative_intros]:\n    \"\\<And>i. ((\\<lambda>x. f' x i) has_derivative (\\<lambda>j. f'' j i)) (at a within G)\"\n  assumes \"i \\<noteq> j\" \"i \\<noteq> 0\" \"j \\<noteq> 0\"\n  assumes \"a \\<in> G\"\n  assumes \"\\<And>s t. s \\<in> {0..1} \\<Longrightarrow> t \\<in> {0..1} \\<Longrightarrow> a + s *\\<^sub>R i + t *\\<^sub>R j \\<in> G\"\n  shows \"f'' j i = f'' i j\"", "lemma symmetric_second_derivative_within:\n  assumes \"a \\<in> G\"\n  assumes \"\\<And>s t. s \\<in> {0..1} \\<Longrightarrow> t \\<in> {0..1} \\<Longrightarrow> a + s *\\<^sub>R i + t *\\<^sub>R j \\<in> G\"\n  shows \"f'' i j = f'' j i\"", "lemma symmetric_second_derivative:\n  assumes \"a \\<in> interior G\"\n  shows \"f'' i j = f'' j i\"", "lemma\n  uniform_explicit_remainder_Taylor_1:\n  fixes f::\"'a::{banach,heine_borel,perfect_space} \\<Rightarrow> 'b::banach\"\n  assumes f'[derivative_intros]: \"\\<And>x. x \\<in> G \\<Longrightarrow> (f has_derivative blinfun_apply (f' x)) (at x)\"\n  assumes f'_cont: \"\\<And>x. x \\<in> G \\<Longrightarrow> isCont f' x\"\n  assumes \"open G\"\n  assumes \"J \\<noteq> {}\" \"compact J\" \"J \\<subseteq> G\"\n  assumes \"e > 0\"\n  obtains d R\n  where \"d > 0\"\n    \"\\<And>x z. f z = f x + f' x (z - x) + R x z\"\n    \"\\<And>x y. x \\<in> J \\<Longrightarrow> y \\<in> J \\<Longrightarrow> dist x y < d \\<Longrightarrow> norm (R x y) \\<le> e * dist x y\"\n    \"continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\"", "lemma symmetric_second_derivative_within:\n  assumes \"a \\<in> G\"  \"open G\"\n  assumes \"\\<And>s t. s \\<in> {0..1} \\<Longrightarrow> t \\<in> {0..1} \\<Longrightarrow> a + s *\\<^sub>R i + t *\\<^sub>R j \\<in> G\"\n  shows \"f'' i j = f'' j i\"", "lemma symmetric_second_derivative:\n  assumes \"a \\<in> G\"\n  shows \"f'' i j = f'' j i\""], "translations": [["", "lemma\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n    and Df::\"'a \\<Rightarrow> nat \\<Rightarrow> 'a \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  assumes \"n > 0\"\n  assumes Df_Nil: \"\\<And>a x. Df a 0 H H = f a\"\n  assumes Df_Cons: \"\\<And>a i d. a \\<in> closed_segment X (X + H) \\<Longrightarrow> i < n \\<Longrightarrow>\n      ((\\<lambda>a. Df a i H H) has_derivative (Df a (Suc i) H)) (at a within G)\"\n  assumes cs: \"closed_segment X (X + H) \\<subseteq> G\"\n  defines \"i \\<equiv> \\<lambda>x.\n      ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R Df (X + x *\\<^sub>R H) n H H\"\n  shows multivariate_Taylor_has_integral:\n    \"(i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H)) {0..1}\"\n  and multivariate_Taylor:\n    \"f (X + H) = (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\"\n  and multivariate_Taylor_integrable:\n    \"i integrable_on {0..1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1} &&&\n    f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i &&&\n    i integrable_on {0..1}", "proof goal_cases"], ["proof (state)\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "let ?G = \"closed_segment X (X + H)\""], ["proof (state)\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "define line where \"line t = X + t *\\<^sub>R H\" for t"], ["proof (state)\nthis:\n  line ?t = X + ?t *\\<^sub>R H\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "have segment_eq: \"closed_segment X (X + H) = line ` {0 .. 1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {X--X + H} = line ` {0..1}", "by (auto simp: line_def closed_segment_def algebra_simps)"], ["proof (state)\nthis:\n  {X--X + H} = line ` {0..1}\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "have line_deriv: \"\\<And>x. (line has_derivative (\\<lambda>t. t *\\<^sub>R H)) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. (line has_derivative (\\<lambda>t. t *\\<^sub>R H)) (at x)", "by (auto intro!: derivative_eq_intros simp: line_def [abs_def])"], ["proof (state)\nthis:\n  (line has_derivative (\\<lambda>t. t *\\<^sub>R H)) (at ?x)\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "define g where \"g = f o line\""], ["proof (state)\nthis:\n  g = f \\<circ> line\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "define Dg where \"Dg n t = Df (line t) n H H\" for n :: nat and t :: real"], ["proof (state)\nthis:\n  Dg ?n ?t = Df (line ?t) ?n H H\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "note \\<open>n > 0\\<close>"], ["proof (state)\nthis:\n  0 < n\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "moreover"], ["proof (state)\nthis:\n  0 < n\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "have Dg0: \"Dg 0 = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Dg 0 = g", "by (auto simp add: Dg_def Df_Nil g_def)"], ["proof (state)\nthis:\n  Dg 0 = g\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "moreover"], ["proof (state)\nthis:\n  Dg 0 = g\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "have DgSuc: \"(Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})\"\n    if \"m < n\" \"0 \\<le> t\" \"t \\<le> 1\" for m::nat and t::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "from that"], ["proof (chain)\npicking this:\n  m < n\n  0 \\<le> t\n  t \\<le> 1", "have [intro]: \"line t \\<in> ?G\""], ["proof (prove)\nusing this:\n  m < n\n  0 \\<le> t\n  t \\<le> 1\n\ngoal (1 subgoal):\n 1. line t \\<in> {X--X + H}", "using assms"], ["proof (prove)\nusing this:\n  m < n\n  0 \\<le> t\n  t \\<le> 1\n  0 < n\n  Df ?a 0 H H = f ?a\n  \\<lbrakk>?a \\<in> {X--X + H}; ?i < n\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>a. Df a ?i H H) has_derivative\n                     Df ?a (Suc ?i) H)\n                     (at ?a within G)\n  {X--X + H} \\<subseteq> G\n  i \\<equiv>\n  \\<lambda>x.\n     ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n     Df (X + x *\\<^sub>R H) n H H\n\ngoal (1 subgoal):\n 1. line t \\<in> {X--X + H}", "by (auto simp: segment_eq)"], ["proof (state)\nthis:\n  line t \\<in> {X--X + H}\n\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "note [derivative_intros] = has_derivative_in_compose[OF _ has_derivative_subset[OF Df_Cons]]"], ["proof (state)\nthis:\n  \\<lbrakk>(?f has_derivative ?f') (at ?x within ?s);\n   ?f ?x \\<in> {X--X + H}; ?i2 < n; ?f ` ?s \\<subseteq> G\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. Df (?f x) ?i2 H H) has_derivative\n                     (\\<lambda>x. Df (?f ?x) (Suc ?i2) H (?f' x)))\n                     (at ?x within ?s)\n\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "interpret Df: linear \"(\\<lambda>d. Df (line t) (Suc m) H d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (Df (line t) (Suc m) H)", "by (auto intro!: has_derivative_linear derivative_intros \\<open>m < n\\<close>)"], ["proof (state)\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "note [derivative_intros] =\n      has_derivative_compose[OF _ line_deriv]"], ["proof (state)\nthis:\n  (?f has_derivative ?f') (at ?x within ?s) \\<Longrightarrow>\n  ((\\<lambda>x. line (?f x)) has_derivative (\\<lambda>x. ?f' x *\\<^sub>R H))\n   (at ?x within ?s)\n\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "using Df.scaleR \\<open>m < n\\<close>"], ["proof (prove)\nusing this:\n  Df (line t) (Suc m) H (?r *\\<^sub>R ?b) =\n  ?r *\\<^sub>R Df (line t) (Suc m) H ?b\n  m < n\n\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "by (auto simp: Dg_def [abs_def] has_vector_derivative_def g_def segment_eq\n         intro!: derivative_eq_intros subsetD[OF cs])"], ["proof (state)\nthis:\n  (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?m < n; 0 \\<le> ?t; ?t \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> (Dg ?m has_vector_derivative Dg (Suc ?m) ?t)\n                     (at ?t within {0..1})\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "ultimately"], ["proof (chain)\npicking this:\n  0 < n\n  Dg 0 = g\n  \\<lbrakk>?m < n; 0 \\<le> ?t; ?t \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> (Dg ?m has_vector_derivative Dg (Suc ?m) ?t)\n                     (at ?t within {0..1})", "have g_Taylor: \"(i has_integral g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0)) {0 .. 1}\""], ["proof (prove)\nusing this:\n  0 < n\n  Dg 0 = g\n  \\<lbrakk>?m < n; 0 \\<le> ?t; ?t \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> (Dg ?m has_vector_derivative Dg (Suc ?m) ?t)\n                     (at ?t within {0..1})\n\ngoal (1 subgoal):\n 1. (i has_integral\n     g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n     {0..1}", "unfolding i_def Dg_def [abs_def] line_def"], ["proof (prove)\nusing this:\n  0 < n\n  (\\<lambda>t. Df (X + t *\\<^sub>R H) 0 H H) = g\n  \\<lbrakk>?m < n; 0 \\<le> ?t; ?t \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>t.\n                         Df (X + t *\\<^sub>R H) ?m H\n                          H) has_vector_derivative\n                     Df (X + ?t *\\<^sub>R H) (Suc ?m) H H)\n                     (at ?t within {0..1})\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x.\n         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n         Df (X + x *\\<^sub>R H) n H H) has_integral\n     g 1 -\n     (\\<Sum>i<n.\n         ((1 - 0) ^ i / fact i) *\\<^sub>R Df (X + 0 *\\<^sub>R H) i H H))\n     {0..1}", "by (rule Taylor_has_integral) auto"], ["proof (state)\nthis:\n  (i has_integral\n   g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n   {0..1}\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 3. i integrable_on {0..1}", "then"], ["proof (chain)\npicking this:\n  (i has_integral\n   g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n   {0..1}", "show c: ?case"], ["proof (prove)\nusing this:\n  (i has_integral\n   g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n   {0..1}\n\ngoal (1 subgoal):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}", "using \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  (i has_integral\n   g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n   {0..1}\n  0 < n\n\ngoal (1 subgoal):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n     {0..1}", "by (auto simp: g_def line_def Dg_def)"], ["proof (state)\nthis:\n  (i has_integral\n   f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n   {0..1}\n\ngoal (2 subgoals):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 2. i integrable_on {0..1}", "case 2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n 2. i integrable_on {0..1}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i", "using c"], ["proof (prove)\nusing this:\n  (i has_integral\n   f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n   {0..1}\n\ngoal (1 subgoal):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i", "by (simp add: integral_unique add.commute)"], ["proof (state)\nthis:\n  f (X + H) =\n  (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H) + integral {0..1} i\n\ngoal (1 subgoal):\n 1. i integrable_on {0..1}", "case 3"], ["proof (state)\nthis:\n  \n\ngoal (1 subgoal):\n 1. i integrable_on {0..1}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. i integrable_on {0..1}", "using c"], ["proof (prove)\nusing this:\n  (i has_integral\n   f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H H))\n   {0..1}\n\ngoal (1 subgoal):\n 1. i integrable_on {0..1}", "by force"], ["proof (state)\nthis:\n  i integrable_on {0..1}\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Symmetric second derivative\\<close>"], ["", "lemma symmetric_second_derivative_aux:\n  assumes first_fderiv[derivative_intros]:\n    \"\\<And>a. a \\<in> G \\<Longrightarrow> (f has_derivative (f' a)) (at a within G)\"\n  assumes second_fderiv[derivative_intros]:\n    \"\\<And>i. ((\\<lambda>x. f' x i) has_derivative (\\<lambda>j. f'' j i)) (at a within G)\"\n  assumes \"i \\<noteq> j\" \"i \\<noteq> 0\" \"j \\<noteq> 0\"\n  assumes \"a \\<in> G\"\n  assumes \"\\<And>s t. s \\<in> {0..1} \\<Longrightarrow> t \\<in> {0..1} \\<Longrightarrow> a + s *\\<^sub>R i + t *\\<^sub>R j \\<in> G\"\n  shows \"f'' j i = f'' i j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "let ?F = \"at_right (0::real)\""], ["proof (state)\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "define B where \"B i j = {a + s *\\<^sub>R i + t *\\<^sub>R j |s t. s \\<in> {0..1} \\<and> t \\<in> {0..1}}\" for i j"], ["proof (state)\nthis:\n  B ?i ?j =\n  {a + s *\\<^sub>R ?i + t *\\<^sub>R ?j |s t.\n   s \\<in> {0..1} \\<and> t \\<in> {0..1}}\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "have \"B i j \\<subseteq> G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B i j \\<subseteq> G", "using assms"], ["proof (prove)\nusing this:\n  ?a \\<in> G \\<Longrightarrow> (f has_derivative f' ?a) (at ?a within G)\n  ((\\<lambda>x. f' x ?i) has_derivative (\\<lambda>j. f'' j ?i))\n   (at a within G)\n  i \\<noteq> j\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n  a \\<in> G\n  \\<lbrakk>?s \\<in> {0..1}; ?t \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> a + ?s *\\<^sub>R i + ?t *\\<^sub>R j \\<in> G\n\ngoal (1 subgoal):\n 1. B i j \\<subseteq> G", "by (auto simp: B_def)"], ["proof (state)\nthis:\n  B i j \\<subseteq> G\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "{"], ["proof (state)\nthis:\n  B i j \\<subseteq> G\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "fix e::real and i j::'a"], ["proof (state)\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "assume \"e > 0\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "assume \"i \\<noteq> j\" \"i \\<noteq> 0\" \"j \\<noteq> 0\""], ["proof (state)\nthis:\n  i \\<noteq> j\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "assume \"B i j \\<subseteq> G\""], ["proof (state)\nthis:\n  B i j \\<subseteq> G\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "let ?ij' = \"\\<lambda>s t. \\<lambda>u. a + (s * u) *\\<^sub>R i + (t * u) *\\<^sub>R j\""], ["proof (state)\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "let ?ij = \"\\<lambda>t. \\<lambda>u. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j\""], ["proof (state)\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "let ?i = \"\\<lambda>t. \\<lambda>u. a + (t * u) *\\<^sub>R i\""], ["proof (state)\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "let ?g = \"\\<lambda>u t. f (?ij t u) - f (?i t u)\""], ["proof (state)\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "have filter_ij'I: \"\\<And>P. P a \\<Longrightarrow> eventually P (at a within G) \\<Longrightarrow>\n      eventually (\\<lambda>x. \\<forall>s\\<in>{0..1}. \\<forall>t\\<in>{0..1}. P (?ij' s t x)) ?F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "fix P"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "assume \"P a\""], ["proof (state)\nthis:\n  P a\n\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "assume \"eventually P (at a within G)\""], ["proof (state)\nthis:\n  eventually P (at a within G)\n\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "hence \"eventually P (at a within B i j)\""], ["proof (prove)\nusing this:\n  eventually P (at a within G)\n\ngoal (1 subgoal):\n 1. eventually P (at a within B i j)", "by (rule filter_leD[OF at_le[OF \\<open>B i j \\<subseteq> G\\<close>]])"], ["proof (state)\nthis:\n  eventually P (at a within B i j)\n\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "then"], ["proof (chain)\npicking this:\n  eventually P (at a within B i j)", "obtain d where d: \"d > 0\" and \"\\<And>x d2. x \\<in> B i j \\<Longrightarrow> x \\<noteq> a \\<Longrightarrow> dist x a < d \\<Longrightarrow> P x\""], ["proof (prove)\nusing this:\n  eventually P (at a within B i j)\n\ngoal (1 subgoal):\n 1. (\\<And>d.\n        \\<lbrakk>0 < d;\n         \\<And>x d2.\n            \\<lbrakk>x \\<in> B i j; x \\<noteq> a; dist x a < d\\<rbrakk>\n            \\<Longrightarrow> P x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: eventually_at)"], ["proof (state)\nthis:\n  0 < d\n  \\<lbrakk>?x2 \\<in> B i j; ?x2 \\<noteq> a; dist ?x2 a < d\\<rbrakk>\n  \\<Longrightarrow> P ?x2\n\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "with \\<open>P a\\<close>"], ["proof (chain)\npicking this:\n  P a\n  0 < d\n  \\<lbrakk>?x2 \\<in> B i j; ?x2 \\<noteq> a; dist ?x2 a < d\\<rbrakk>\n  \\<Longrightarrow> P ?x2", "have P: \"\\<And>x d2. x \\<in> B i j \\<Longrightarrow> dist x a < d \\<Longrightarrow> P x\""], ["proof (prove)\nusing this:\n  P a\n  0 < d\n  \\<lbrakk>?x2 \\<in> B i j; ?x2 \\<noteq> a; dist ?x2 a < d\\<rbrakk>\n  \\<Longrightarrow> P ?x2\n\ngoal (1 subgoal):\n 1. \\<And>x d2.\n       \\<lbrakk>x \\<in> B i j; dist x a < d\\<rbrakk> \\<Longrightarrow> P x", "by (case_tac \"x = a\") auto"], ["proof (state)\nthis:\n  \\<lbrakk>?x2 \\<in> B i j; dist ?x2 a < d\\<rbrakk> \\<Longrightarrow> P ?x2\n\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "let ?d = \"min (min (d/norm i) (d/norm j) / 2) 1\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>P a; eventually P (at a within G)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                            \\<forall>s\\<in>{0..1}.\n                               \\<forall>t\\<in>{0..1}.\n                                  P (a + (s * x) *\\<^sub>R i +\n                                     (t * x) *\\<^sub>R j)", "show \"eventually (\\<lambda>x. \\<forall>s\\<in>{0..1}. \\<forall>t\\<in>{0..1}. P (?ij' s t x)) (at_right 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>s\\<in>{0..1}.\n          \\<forall>t\\<in>{0..1}.\n             P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)", "unfolding eventually_at"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>d>0.\n       \\<forall>x\\<in>{0<..}.\n          x \\<noteq> 0 \\<and> dist x 0 < d \\<longrightarrow>\n          (\\<forall>s\\<in>{0..1}.\n              \\<forall>t\\<in>{0..1}.\n                 P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j))", "proof (rule exI[where x=\"?d\"], safe)"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < min (min (d / norm i) (d / norm j) / 2) 1\n 2. \\<And>x s t.\n       \\<lbrakk>0 < x; s \\<in> {0..1}; t \\<in> {0..1}; x \\<noteq> 0;\n        dist x 0 < min (min (d / norm i) (d / norm j) / 2) 1\\<rbrakk>\n       \\<Longrightarrow> P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)", "show \"0 < ?d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < min (min (d / norm i) (d / norm j) / 2) 1", "using \\<open>0 < d\\<close> \\<open>i \\<noteq> 0\\<close> \\<open>j \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  0 < d\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. 0 < min (min (d / norm i) (d / norm j) / 2) 1", "by simp"], ["proof (state)\nthis:\n  0 < min (min (d / norm i) (d / norm j) / 2) 1\n\ngoal (1 subgoal):\n 1. \\<And>x s t.\n       \\<lbrakk>0 < x; s \\<in> {0..1}; t \\<in> {0..1}; x \\<noteq> 0;\n        dist x 0 < min (min (d / norm i) (d / norm j) / 2) 1\\<rbrakk>\n       \\<Longrightarrow> P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)", "fix x s t :: real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x s t.\n       \\<lbrakk>0 < x; s \\<in> {0..1}; t \\<in> {0..1}; x \\<noteq> 0;\n        dist x 0 < min (min (d / norm i) (d / norm j) / 2) 1\\<rbrakk>\n       \\<Longrightarrow> P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)", "assume *: \"s \\<in> {0..1}\" \"t \\<in> {0..1}\" \"0 < x\" \"dist x 0 < ?d\""], ["proof (state)\nthis:\n  s \\<in> {0..1}\n  t \\<in> {0..1}\n  0 < x\n  dist x 0 < min (min (d / norm i) (d / norm j) / 2) 1\n\ngoal (1 subgoal):\n 1. \\<And>x s t.\n       \\<lbrakk>0 < x; s \\<in> {0..1}; t \\<in> {0..1}; x \\<noteq> 0;\n        dist x 0 < min (min (d / norm i) (d / norm j) / 2) 1\\<rbrakk>\n       \\<Longrightarrow> P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)", "show \"P (?ij' s t x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)", "proof (rule P)"], ["proof (state)\ngoal (2 subgoals):\n 1. a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j \\<in> B i j\n 2. dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d", "have \"\\<And>x y::real. x \\<in> {0..1} \\<Longrightarrow> y \\<in> {0..1} \\<Longrightarrow> x * y \\<in> {0..1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> {0..1}; y \\<in> {0..1}\\<rbrakk>\n       \\<Longrightarrow> x * y \\<in> {0..1}", "by (auto intro!: order_trans[OF mult_left_le_one_le])"], ["proof (state)\nthis:\n  \\<lbrakk>?x3 \\<in> {0..1}; ?y3 \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> ?x3 * ?y3 \\<in> {0..1}\n\ngoal (2 subgoals):\n 1. a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j \\<in> B i j\n 2. dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d", "hence \"s * x \\<in> {0..1}\" \"t * x \\<in> {0..1}\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x3 \\<in> {0..1}; ?y3 \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> ?x3 * ?y3 \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. s * x \\<in> {0..1} &&& t * x \\<in> {0..1}", "using *"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x3 \\<in> {0..1}; ?y3 \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> ?x3 * ?y3 \\<in> {0..1}\n  s \\<in> {0..1}\n  t \\<in> {0..1}\n  0 < x\n  dist x 0 < min (min (d / norm i) (d / norm j) / 2) 1\n\ngoal (1 subgoal):\n 1. s * x \\<in> {0..1} &&& t * x \\<in> {0..1}", "by (auto simp: dist_norm)"], ["proof (state)\nthis:\n  s * x \\<in> {0..1}\n  t * x \\<in> {0..1}\n\ngoal (2 subgoals):\n 1. a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j \\<in> B i j\n 2. dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d", "thus \"?ij' s t x \\<in> B i j\""], ["proof (prove)\nusing this:\n  s * x \\<in> {0..1}\n  t * x \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j \\<in> B i j", "by (auto simp: B_def)"], ["proof (state)\nthis:\n  a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j \\<in> B i j\n\ngoal (1 subgoal):\n 1. dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d", "have \"norm (s *\\<^sub>R x *\\<^sub>R i + t *\\<^sub>R x *\\<^sub>R j) \\<le> norm (s *\\<^sub>R x *\\<^sub>R i) + norm (t *\\<^sub>R x *\\<^sub>R j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (s *\\<^sub>R x *\\<^sub>R i + t *\\<^sub>R x *\\<^sub>R j)\n    \\<le> norm (s *\\<^sub>R x *\\<^sub>R i) +\n          norm (t *\\<^sub>R x *\\<^sub>R j)", "by (rule norm_triangle_ineq)"], ["proof (state)\nthis:\n  norm (s *\\<^sub>R x *\\<^sub>R i + t *\\<^sub>R x *\\<^sub>R j)\n  \\<le> norm (s *\\<^sub>R x *\\<^sub>R i) + norm (t *\\<^sub>R x *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d", "also"], ["proof (state)\nthis:\n  norm (s *\\<^sub>R x *\\<^sub>R i + t *\\<^sub>R x *\\<^sub>R j)\n  \\<le> norm (s *\\<^sub>R x *\\<^sub>R i) + norm (t *\\<^sub>R x *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d", "have \"\\<dots> < d / 2 + d / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (s *\\<^sub>R x *\\<^sub>R i) + norm (t *\\<^sub>R x *\\<^sub>R j)\n    < d / 2 + d / 2", "using * \\<open>i \\<noteq> 0\\<close> \\<open>j \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  s \\<in> {0..1}\n  t \\<in> {0..1}\n  0 < x\n  dist x 0 < min (min (d / norm i) (d / norm j) / 2) 1\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. norm (s *\\<^sub>R x *\\<^sub>R i) + norm (t *\\<^sub>R x *\\<^sub>R j)\n    < d / 2 + d / 2", "by (intro add_strict_mono) (auto simp: ac_simps dist_norm\n              pos_less_divide_eq le_less_trans[OF mult_left_le_one_le])"], ["proof (state)\nthis:\n  norm (s *\\<^sub>R x *\\<^sub>R i) + norm (t *\\<^sub>R x *\\<^sub>R j)\n  < d / 2 + d / 2\n\ngoal (1 subgoal):\n 1. dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d", "finally"], ["proof (chain)\npicking this:\n  norm (s *\\<^sub>R x *\\<^sub>R i + t *\\<^sub>R x *\\<^sub>R j)\n  < d / 2 + d / 2", "show \"dist (?ij' s t x) a < d\""], ["proof (prove)\nusing this:\n  norm (s *\\<^sub>R x *\\<^sub>R i + t *\\<^sub>R x *\\<^sub>R j)\n  < d / 2 + d / 2\n\ngoal (1 subgoal):\n 1. dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d", "by (simp add: dist_norm)"], ["proof (state)\nthis:\n  dist (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j) a < d\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>s\\<in>{0..1}.\n        \\<forall>t\\<in>{0..1}.\n           P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?P a; eventually ?P (at a within G)\\<rbrakk>\n  \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                       \\<forall>s\\<in>{0..1}.\n                          \\<forall>t\\<in>{0..1}.\n                             ?P (a + (s * x) *\\<^sub>R i +\n                                 (t * x) *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "have filter_ijI: \"eventually (\\<lambda>x. \\<forall>t\\<in>{0..1}. P (?ij t x)) ?F\"\n      if \"P a\" \"eventually P (at a within G)\" for P"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>t\\<in>{0..1}. P (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j)", "using filter_ij'I[OF that]"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>s\\<in>{0..1}.\n        \\<forall>t\\<in>{0..1}.\n           P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>t\\<in>{0..1}. P (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j)", "by eventually_elim (force dest: bspec[where x=1])"], ["proof (state)\nthis:\n  \\<lbrakk>?P a; eventually ?P (at a within G)\\<rbrakk>\n  \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                       \\<forall>t\\<in>{0..1}.\n                          ?P (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "have filter_iI: \"eventually (\\<lambda>x. \\<forall>t\\<in>{0..1}. P (?i t x)) ?F\"\n      if \"P a\" \"eventually P (at a within G)\" for P"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>t\\<in>{0..1}. P (a + (t * x) *\\<^sub>R i)", "using filter_ij'I[OF that]"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>s\\<in>{0..1}.\n        \\<forall>t\\<in>{0..1}.\n           P (a + (s * x) *\\<^sub>R i + (t * x) *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>t\\<in>{0..1}. P (a + (t * x) *\\<^sub>R i)", "by eventually_elim force"], ["proof (state)\nthis:\n  \\<lbrakk>?P a; eventually ?P (at a within G)\\<rbrakk>\n  \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                       \\<forall>t\\<in>{0..1}. ?P (a + (t * x) *\\<^sub>R i)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "{"], ["proof (state)\nthis:\n  \\<lbrakk>?P a; eventually ?P (at a within G)\\<rbrakk>\n  \\<Longrightarrow> \\<forall>\\<^sub>F x in at_right 0.\n                       \\<forall>t\\<in>{0..1}. ?P (a + (t * x) *\\<^sub>R i)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "from second_fderiv[of i, simplified has_derivative_iff_norm, THEN conjunct2,\n        THEN tendstoD, OF \\<open>0 < e\\<close>]"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at a within G.\n     dist (norm (f' x i - f' a i - f'' (x - a) i) / norm (x - a)) 0 < e", "have \"eventually (\\<lambda>x. norm (f' x i - f' a i - f'' (x - a) i) / norm (x - a) \\<le> e)\n          (at a within G)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at a within G.\n     dist (norm (f' x i - f' a i - f'' (x - a) i) / norm (x - a)) 0 < e\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at a within G.\n       norm (f' x i - f' a i - f'' (x - a) i) / norm (x - a) \\<le> e", "by eventually_elim (simp add: dist_norm)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at a within G.\n     norm (f' x i - f' a i - f'' (x - a) i) / norm (x - a) \\<le> e\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "from filter_ijI[OF _ this] filter_iI[OF _ this] \\<open>0 < e\\<close>"], ["proof (chain)\npicking this:\n  norm (f' a i - f' a i - f'' (a - a) i) / norm (a - a)\n  \\<le> e \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j) i - f' a i -\n          f'' (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j - a) i) /\n        norm (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j - a)\n        \\<le> e\n  norm (f' a i - f' a i - f'' (a - a) i) / norm (a - a)\n  \\<le> e \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * x) *\\<^sub>R i) i - f' a i -\n          f'' (a + (t * x) *\\<^sub>R i - a) i) /\n        norm (a + (t * x) *\\<^sub>R i - a)\n        \\<le> e\n  0 < e", "have\n        \"eventually (\\<lambda>ij. \\<forall>t\\<in>{0..1}. norm (f' (?ij t ij) i - f' a i - f'' (?ij t ij - a) i) /\n          norm (?ij t ij - a) \\<le> e) ?F\"\n        \"eventually (\\<lambda>ij. \\<forall>t\\<in>{0..1}. norm (f' (?i t ij) i - f' a i - f'' (?i t ij - a) i) /\n          norm (?i t ij - a) \\<le> e) ?F\""], ["proof (prove)\nusing this:\n  norm (f' a i - f' a i - f'' (a - a) i) / norm (a - a)\n  \\<le> e \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j) i - f' a i -\n          f'' (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j - a) i) /\n        norm (a + (t * x) *\\<^sub>R i + x *\\<^sub>R j - a)\n        \\<le> e\n  norm (f' a i - f' a i - f'' (a - a) i) / norm (a - a)\n  \\<le> e \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * x) *\\<^sub>R i) i - f' a i -\n          f'' (a + (t * x) *\\<^sub>R i - a) i) /\n        norm (a + (t * x) *\\<^sub>R i - a)\n        \\<le> e\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F ij in at_right 0.\n       \\<forall>t\\<in>{0..1}.\n          norm\n           (f' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j) i - f' a i -\n            f'' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a) i) /\n          norm (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a)\n          \\<le> e &&&\n    \\<forall>\\<^sub>F ij in at_right 0.\n       \\<forall>t\\<in>{0..1}.\n          norm\n           (f' (a + (t * ij) *\\<^sub>R i) i - f' a i -\n            f'' (a + (t * ij) *\\<^sub>R i - a) i) /\n          norm (a + (t * ij) *\\<^sub>R i - a)\n          \\<le> e", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F ij in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j) i - f' a i -\n          f'' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a) i) /\n        norm (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a)\n        \\<le> e\n  \\<forall>\\<^sub>F ij in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * ij) *\\<^sub>R i) i - f' a i -\n          f'' (a + (t * ij) *\\<^sub>R i - a) i) /\n        norm (a + (t * ij) *\\<^sub>R i - a)\n        \\<le> e\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F ij in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j) i - f' a i -\n          f'' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a) i) /\n        norm (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a)\n        \\<le> e\n  \\<forall>\\<^sub>F ij in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * ij) *\\<^sub>R i) i - f' a i -\n          f'' (a + (t * ij) *\\<^sub>R i - a) i) /\n        norm (a + (t * ij) *\\<^sub>R i - a)\n        \\<le> e\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "have \"eventually (\\<lambda>x. x \\<in> G) (at a within G)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at a within G. x \\<in> G", "unfolding eventually_at_filter"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in nhds a.\n       x \\<noteq> a \\<longrightarrow> x \\<in> G \\<longrightarrow> x \\<in> G", "by simp"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at a within G. x \\<in> G\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "hence eventually_in_ij: \"eventually (\\<lambda>x. \\<forall>t\\<in>{0..1}. ?ij t x \\<in> G) ?F\" and\n        eventually_in_i: \"eventually (\\<lambda>x. \\<forall>t\\<in>{0..1}. ?i t x \\<in> G) ?F\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at a within G. x \\<in> G\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>t\\<in>{0..1}.\n          a + (t * x) *\\<^sub>R i + x *\\<^sub>R j \\<in> G &&&\n    \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>t\\<in>{0..1}. a + (t * x) *\\<^sub>R i \\<in> G", "using \\<open>a \\<in> G\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at a within G. x \\<in> G\n  a \\<in> G\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>t\\<in>{0..1}.\n          a + (t * x) *\\<^sub>R i + x *\\<^sub>R j \\<in> G &&&\n    \\<forall>\\<^sub>F x in at_right 0.\n       \\<forall>t\\<in>{0..1}. a + (t * x) *\\<^sub>R i \\<in> G", "by (auto dest: filter_ijI filter_iI)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}. a + (t * x) *\\<^sub>R i + x *\\<^sub>R j \\<in> G\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}. a + (t * x) *\\<^sub>R i \\<in> G\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F ij in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j) i - f' a i -\n          f'' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a) i) /\n        norm (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a)\n        \\<le> e\n  \\<forall>\\<^sub>F ij in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * ij) *\\<^sub>R i) i - f' a i -\n          f'' (a + (t * ij) *\\<^sub>R i - a) i) /\n        norm (a + (t * ij) *\\<^sub>R i - a)\n        \\<le> e\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}. a + (t * x) *\\<^sub>R i + x *\\<^sub>R j \\<in> G\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}. a + (t * x) *\\<^sub>R i \\<in> G", "have \"eventually (\\<lambda>u. norm (?g u 1 - ?g u 0 - (u * u) *\\<^sub>R f'' j i) \\<le>\n          u * u * e * (2 * norm i + 3 * norm j)) ?F\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F ij in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j) i - f' a i -\n          f'' (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a) i) /\n        norm (a + (t * ij) *\\<^sub>R i + ij *\\<^sub>R j - a)\n        \\<le> e\n  \\<forall>\\<^sub>F ij in at_right 0.\n     \\<forall>t\\<in>{0..1}.\n        norm\n         (f' (a + (t * ij) *\\<^sub>R i) i - f' a i -\n          f'' (a + (t * ij) *\\<^sub>R i - a) i) /\n        norm (a + (t * ij) *\\<^sub>R i - a)\n        \\<le> e\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}. a + (t * x) *\\<^sub>R i + x *\\<^sub>R j \\<in> G\n  \\<forall>\\<^sub>F x in at_right 0.\n     \\<forall>t\\<in>{0..1}. a + (t * x) *\\<^sub>R i \\<in> G\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F u in at_right 0.\n       norm\n        (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n         f (a + (1 * u) *\\<^sub>R i) -\n         (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n          f (a + (0 * u) *\\<^sub>R i)) -\n         (u * u) *\\<^sub>R f'' j i)\n       \\<le> u * u * e * (2 * norm i + 3 * norm j)", "proof eventually_elim"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "case (elim u)"], ["proof (state)\nthis:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "hence ijsub: \"(\\<lambda>t. ?ij t u) ` {0..1} \\<subseteq> G\" and isub: \"(\\<lambda>t. ?i t u) ` {0..1} \\<subseteq> G\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\n\ngoal (1 subgoal):\n 1. (\\<lambda>t. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) ` {0..1}\n    \\<subseteq> G &&&\n    (\\<lambda>t. a + (t * u) *\\<^sub>R i) ` {0..1} \\<subseteq> G", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>t. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) ` {0..1}\n  \\<subseteq> G\n  (\\<lambda>t. a + (t * u) *\\<^sub>R i) ` {0..1} \\<subseteq> G\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "note has_derivative_subset[OF _ ijsub, derivative_intros]"], ["proof (state)\nthis:\n  (?f has_derivative ?f') (at ?x within G) \\<Longrightarrow>\n  (?f has_derivative ?f')\n   (at ?x\n    within (\\<lambda>t. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) ` {0..1})\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "note has_derivative_subset[OF _ isub, derivative_intros]"], ["proof (state)\nthis:\n  (?f has_derivative ?f') (at ?x within G) \\<Longrightarrow>\n  (?f has_derivative ?f')\n   (at ?x within (\\<lambda>t. a + (t * u) *\\<^sub>R i) ` {0..1})\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "let ?g' = \"\\<lambda>t. (\\<lambda>ua. u *\\<^sub>R ua *\\<^sub>R (f' (?ij t u) i - (f' (?i t u) i)))\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "have g': \"((?g u) has_derivative ?g' t) (at t within {0..1})\" if \"t \\<in> {0..1}\" for t::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         f (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) -\n         f (a + (t * u) *\\<^sub>R i)) has_derivative\n     (\\<lambda>ua.\n         u *\\<^sub>R\n         ua *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)))\n     (at t within {0..1})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         f (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) -\n         f (a + (t * u) *\\<^sub>R i)) has_derivative\n     (\\<lambda>ua.\n         u *\\<^sub>R\n         ua *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)))\n     (at t within {0..1})", "from elim that"], ["proof (chain)\npicking this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\n  t \\<in> {0..1}", "have linear_f': \"\\<And>c x. f' (?ij t u) (c *\\<^sub>R x) = c *\\<^sub>R f' (?ij t u) x\"\n              \"\\<And>c x. f' (?i t u) (c *\\<^sub>R x) = c *\\<^sub>R f' (?i t u) x\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\n  t \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. (\\<And>c x.\n        f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) (c *\\<^sub>R x) =\n        c *\\<^sub>R f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) x) &&&\n    (\\<And>c x.\n        f' (a + (t * u) *\\<^sub>R i) (c *\\<^sub>R x) =\n        c *\\<^sub>R f' (a + (t * u) *\\<^sub>R i) x)", "using linear_cmul[OF has_derivative_linear, OF first_fderiv]"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\n  t \\<in> {0..1}\n  ?a2 \\<in> G \\<Longrightarrow>\n  f' ?a2 (?r *\\<^sub>R ?b) = ?r *\\<^sub>R f' ?a2 ?b\n\ngoal (1 subgoal):\n 1. (\\<And>c x.\n        f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) (c *\\<^sub>R x) =\n        c *\\<^sub>R f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) x) &&&\n    (\\<And>c x.\n        f' (a + (t * u) *\\<^sub>R i) (c *\\<^sub>R x) =\n        c *\\<^sub>R f' (a + (t * u) *\\<^sub>R i) x)", "by auto"], ["proof (state)\nthis:\n  f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) (?c *\\<^sub>R ?x) =\n  ?c *\\<^sub>R f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) ?x\n  f' (a + (t * u) *\\<^sub>R i) (?c *\\<^sub>R ?x) =\n  ?c *\\<^sub>R f' (a + (t * u) *\\<^sub>R i) ?x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         f (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) -\n         f (a + (t * u) *\\<^sub>R i)) has_derivative\n     (\\<lambda>ua.\n         u *\\<^sub>R\n         ua *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)))\n     (at t within {0..1})", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         f (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) -\n         f (a + (t * u) *\\<^sub>R i)) has_derivative\n     (\\<lambda>ua.\n         u *\\<^sub>R\n         ua *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)))\n     (at t within {0..1})", "using elim \\<open>t \\<in> {0..1}\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G\n  \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\n  t \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         f (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) -\n         f (a + (t * u) *\\<^sub>R i)) has_derivative\n     (\\<lambda>ua.\n         u *\\<^sub>R\n         ua *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)))\n     (at t within {0..1})", "by (auto intro!: derivative_eq_intros has_derivative_in_compose[of  \"\\<lambda>t. ?ij t u\" _ _ _ f]\n                has_derivative_in_compose[of  \"\\<lambda>t. ?i t u\" _ _ _ f]\n              simp: linear_f' scaleR_diff_right mult.commute)"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       f (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (t * u) *\\<^sub>R i)) has_derivative\n   (\\<lambda>ua.\n       u *\\<^sub>R\n       ua *\\<^sub>R\n       (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n        f' (a + (t * u) *\\<^sub>R i) i)))\n   (at t within {0..1})\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?t \\<in> {0..1} \\<Longrightarrow>\n  ((\\<lambda>t.\n       f (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (t * u) *\\<^sub>R i)) has_derivative\n   (\\<lambda>ua.\n       u *\\<^sub>R\n       ua *\\<^sub>R\n       (f' (a + (?t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n        f' (a + (?t * u) *\\<^sub>R i) i)))\n   (at ?t within {0..1})\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "from elim(1) \\<open>i \\<noteq> 0\\<close> \\<open>j \\<noteq> 0\\<close> \\<open>0 < e\\<close>"], ["proof (chain)\npicking this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n  0 < e", "have f'ij: \"\\<And>t. t \\<in> {0..1} \\<Longrightarrow>\n            norm (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i - f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i) \\<le>\n            e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j)\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {0..1} \\<Longrightarrow>\n       norm\n        (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n         f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i)\n       \\<le> e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j)", "using  linear_0[OF has_derivative_linear, OF second_fderiv]"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n     norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n     \\<le> e\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n  0 < e\n  f'' (0::'a) ?i2 = (0::'b)\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {0..1} \\<Longrightarrow>\n       norm\n        (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n         f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i)\n       \\<le> e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j)", "by (case_tac \"u *\\<^sub>R j + (t * u) *\\<^sub>R i = 0\") (auto simp: field_simps\n            simp del: pos_divide_le_eq simp add: pos_divide_le_eq[symmetric])"], ["proof (state)\nthis:\n  ?t \\<in> {0..1} \\<Longrightarrow>\n  norm\n   (f' (a + (?t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n    f'' ((?t * u) *\\<^sub>R i + u *\\<^sub>R j) i)\n  \\<le> e * norm ((?t * u) *\\<^sub>R i + u *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "from elim(2)"], ["proof (chain)\npicking this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e", "have f'i: \"\\<And>t. t \\<in> {0..1} \\<Longrightarrow> norm (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n          f'' ((t * u) *\\<^sub>R i) i) \\<le> e * abs (t * u) * norm i\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {0..1} \\<Longrightarrow>\n       norm\n        (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n         f'' ((t * u) *\\<^sub>R i) i)\n       \\<le> e * \\<bar>t * u\\<bar> * norm i", "using \\<open>i \\<noteq> 0\\<close> \\<open>j \\<noteq> 0\\<close> linear_0[OF has_derivative_linear, OF second_fderiv]"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>{0..1}.\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' (a + (t * u) *\\<^sub>R i - a) i) /\n     norm (a + (t * u) *\\<^sub>R i - a)\n     \\<le> e\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n  f'' (0::'a) ?i2 = (0::'b)\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {0..1} \\<Longrightarrow>\n       norm\n        (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n         f'' ((t * u) *\\<^sub>R i) i)\n       \\<le> e * \\<bar>t * u\\<bar> * norm i", "by (case_tac \"t * u = 0\") (auto simp: field_simps simp del: pos_divide_le_eq\n            simp add: pos_divide_le_eq[symmetric])"], ["proof (state)\nthis:\n  ?t \\<in> {0..1} \\<Longrightarrow>\n  norm\n   (f' (a + (?t * u) *\\<^sub>R i) i - f' a i - f'' ((?t * u) *\\<^sub>R i) i)\n  \\<le> e * \\<bar>?t * u\\<bar> * norm i\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "have \"norm (?g u 1 - ?g u 0 - (u * u) *\\<^sub>R f'' j i) =\n          norm ((?g u 1 - ?g u 0 - u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - (f' a i)))\n            + u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\"\n            (is \"_ = norm (?g10 + ?f'i)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n      f (a + (1 * u) *\\<^sub>R i) -\n      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (0 * u) *\\<^sub>R i)) -\n      (u * u) *\\<^sub>R f'' j i) =\n    norm\n     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n      f (a + (1 * u) *\\<^sub>R i) -\n      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (0 * u) *\\<^sub>R i)) -\n      u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i) +\n      u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))", "by (simp add: algebra_simps linear_cmul[OF has_derivative_linear, OF second_fderiv]\n            linear_add[OF has_derivative_linear, OF second_fderiv])"], ["proof (state)\nthis:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    (u * u) *\\<^sub>R f'' j i) =\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i) +\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "also"], ["proof (state)\nthis:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    (u * u) *\\<^sub>R f'' j i) =\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i) +\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "have \"\\<dots> \\<le> norm ?g10 + norm ?f'i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n      f (a + (1 * u) *\\<^sub>R i) -\n      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (0 * u) *\\<^sub>R i)) -\n      u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i) +\n      u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n    \\<le> norm\n           (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n            f (a + (1 * u) *\\<^sub>R i) -\n            (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n             f (a + (0 * u) *\\<^sub>R i)) -\n            u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)) +\n          norm\n           (u *\\<^sub>R\n            (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))", "by (blast intro: order_trans add_mono norm_triangle_le)"], ["proof (state)\nthis:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i) +\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n  \\<le> norm\n         (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n          f (a + (1 * u) *\\<^sub>R i) -\n          (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n           f (a + (0 * u) *\\<^sub>R i)) -\n          u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)) +\n        norm\n         (u *\\<^sub>R\n          (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "also"], ["proof (state)\nthis:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i) +\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n  \\<le> norm\n         (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n          f (a + (1 * u) *\\<^sub>R i) -\n          (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n           f (a + (0 * u) *\\<^sub>R i)) -\n          u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)) +\n        norm\n         (u *\\<^sub>R\n          (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "have \"0 \\<in> {0..1::real}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<in> {0..1}", "by simp"], ["proof (state)\nthis:\n  0 \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "have \"\\<forall>t \\<in> {0..1}. onorm ((\\<lambda>ua. (u * ua) *\\<^sub>R (f' (?ij t u) i - f' (?i t u) i)) -\n              (\\<lambda>ua. (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n            \\<le> 2 * u * u * e * (norm i + norm j)\" (is \"\\<forall>t \\<in> _. onorm (?d t) \\<le> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>{0..1}.\n       onorm\n        ((\\<lambda>ua.\n             (u * ua) *\\<^sub>R\n             (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n              f' (a + (t * u) *\\<^sub>R i) i)) -\n         (\\<lambda>ua.\n             (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n       \\<le> 2 * u * u * e * (norm i + norm j)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {0..1} \\<Longrightarrow>\n       onorm\n        ((\\<lambda>ua.\n             (u * ua) *\\<^sub>R\n             (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n              f' (a + (t * u) *\\<^sub>R i) i)) -\n         (\\<lambda>ua.\n             (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n       \\<le> 2 * u * u * e * (norm i + norm j)", "fix t::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {0..1} \\<Longrightarrow>\n       onorm\n        ((\\<lambda>ua.\n             (u * ua) *\\<^sub>R\n             (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n              f' (a + (t * u) *\\<^sub>R i) i)) -\n         (\\<lambda>ua.\n             (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n       \\<le> 2 * u * u * e * (norm i + norm j)", "assume \"t \\<in> {0..1}\""], ["proof (state)\nthis:\n  t \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {0..1} \\<Longrightarrow>\n       onorm\n        ((\\<lambda>ua.\n             (u * ua) *\\<^sub>R\n             (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n              f' (a + (t * u) *\\<^sub>R i) i)) -\n         (\\<lambda>ua.\n             (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n       \\<le> 2 * u * u * e * (norm i + norm j)", "show \"onorm (?d t) \\<le> 2 * u * u * e * (norm i + norm j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. onorm\n     ((\\<lambda>ua.\n          (u * ua) *\\<^sub>R\n          (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n           f' (a + (t * u) *\\<^sub>R i) i)) -\n      (\\<lambda>ua. (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n    \\<le> 2 * u * u * e * (norm i + norm j)", "proof (rule onorm_le)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"norm (?d t x) =\n                norm ((u * x) *\\<^sub>R (f' (?ij t u) i - f' (?i t u) i - f' (a + u *\\<^sub>R j) i + f' a i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (((\\<lambda>ua.\n           (u * ua) *\\<^sub>R\n           (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n            f' (a + (t * u) *\\<^sub>R i) i)) -\n       (\\<lambda>ua.\n           (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n       x) =\n    norm\n     ((u * x) *\\<^sub>R\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n       f' (a + (t * u) *\\<^sub>R i) i -\n       f' (a + u *\\<^sub>R j) i +\n       f' a i))", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  norm\n   (((\\<lambda>ua.\n         (u * ua) *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)) -\n     (\\<lambda>ua. (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n     x) =\n  norm\n   ((u * x) *\\<^sub>R\n    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n     f' (a + (t * u) *\\<^sub>R i) i -\n     f' (a + u *\\<^sub>R j) i +\n     f' a i))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "also"], ["proof (state)\nthis:\n  norm\n   (((\\<lambda>ua.\n         (u * ua) *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)) -\n     (\\<lambda>ua. (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n     x) =\n  norm\n   ((u * x) *\\<^sub>R\n    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n     f' (a + (t * u) *\\<^sub>R i) i -\n     f' (a + u *\\<^sub>R j) i +\n     f' a i))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"\\<dots> =\n                abs (u * x) * norm (f' (?ij t u) i - f' (?i t u) i - f' (a + u *\\<^sub>R j) i + f' a i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     ((u * x) *\\<^sub>R\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n       f' (a + (t * u) *\\<^sub>R i) i -\n       f' (a + u *\\<^sub>R j) i +\n       f' a i)) =\n    \\<bar>u * x\\<bar> *\n    norm\n     (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n      f' (a + (t * u) *\\<^sub>R i) i -\n      f' (a + u *\\<^sub>R j) i +\n      f' a i)", "by simp"], ["proof (state)\nthis:\n  norm\n   ((u * x) *\\<^sub>R\n    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n     f' (a + (t * u) *\\<^sub>R i) i -\n     f' (a + u *\\<^sub>R j) i +\n     f' a i)) =\n  \\<bar>u * x\\<bar> *\n  norm\n   (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n    f' (a + (t * u) *\\<^sub>R i) i -\n    f' (a + u *\\<^sub>R j) i +\n    f' a i)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "also"], ["proof (state)\nthis:\n  norm\n   ((u * x) *\\<^sub>R\n    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n     f' (a + (t * u) *\\<^sub>R i) i -\n     f' (a + u *\\<^sub>R j) i +\n     f' a i)) =\n  \\<bar>u * x\\<bar> *\n  norm\n   (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n    f' (a + (t * u) *\\<^sub>R i) i -\n    f' (a + u *\\<^sub>R j) i +\n    f' a i)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"\\<dots> = abs (u * x) * norm (\n                 f' (?ij t u) i - f' a i - f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i\n               - (f' (?i t u) i - f' a i - f'' ((t * u) *\\<^sub>R i) i)\n               - (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\"\n               (is \"_ = _ * norm (?dij - ?di - ?dj)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u * x\\<bar> *\n    norm\n     (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n      f' (a + (t * u) *\\<^sub>R i) i -\n      f' (a + u *\\<^sub>R j) i +\n      f' a i) =\n    \\<bar>u * x\\<bar> *\n    norm\n     (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n      f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' ((t * u) *\\<^sub>R i) i) -\n      (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))", "using \\<open>a \\<in> G\\<close>"], ["proof (prove)\nusing this:\n  a \\<in> G\n\ngoal (1 subgoal):\n 1. \\<bar>u * x\\<bar> *\n    norm\n     (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n      f' (a + (t * u) *\\<^sub>R i) i -\n      f' (a + u *\\<^sub>R j) i +\n      f' a i) =\n    \\<bar>u * x\\<bar> *\n    norm\n     (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n      f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' ((t * u) *\\<^sub>R i) i) -\n      (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))", "by (simp add: algebra_simps\n                linear_add[OF has_derivative_linear[OF second_fderiv]])"], ["proof (state)\nthis:\n  \\<bar>u * x\\<bar> *\n  norm\n   (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n    f' (a + (t * u) *\\<^sub>R i) i -\n    f' (a + u *\\<^sub>R j) i +\n    f' a i) =\n  \\<bar>u * x\\<bar> *\n  norm\n   (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n    f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n    (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n     f'' ((t * u) *\\<^sub>R i) i) -\n    (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "also"], ["proof (state)\nthis:\n  \\<bar>u * x\\<bar> *\n  norm\n   (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n    f' (a + (t * u) *\\<^sub>R i) i -\n    f' (a + u *\\<^sub>R j) i +\n    f' a i) =\n  \\<bar>u * x\\<bar> *\n  norm\n   (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n    f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n    (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n     f'' ((t * u) *\\<^sub>R i) i) -\n    (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"\\<dots> \\<le> abs (u * x) * (norm ?dij + norm ?di + norm ?dj)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u * x\\<bar> *\n    norm\n     (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n      f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' ((t * u) *\\<^sub>R i) i) -\n      (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n    \\<le> \\<bar>u * x\\<bar> *\n          (norm\n            (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n             f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i) +\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' ((t * u) *\\<^sub>R i) i) +\n           norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))", "by (rule mult_left_mono[OF _ abs_ge_zero]) norm"], ["proof (state)\nthis:\n  \\<bar>u * x\\<bar> *\n  norm\n   (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n    f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n    (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n     f'' ((t * u) *\\<^sub>R i) i) -\n    (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n  \\<le> \\<bar>u * x\\<bar> *\n        (norm\n          (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n           f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i) +\n         norm\n          (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n           f'' ((t * u) *\\<^sub>R i) i) +\n         norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "also"], ["proof (state)\nthis:\n  \\<bar>u * x\\<bar> *\n  norm\n   (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n    f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n    (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n     f'' ((t * u) *\\<^sub>R i) i) -\n    (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n  \\<le> \\<bar>u * x\\<bar> *\n        (norm\n          (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n           f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i) +\n         norm\n          (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n           f'' ((t * u) *\\<^sub>R i) i) +\n         norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"\\<dots> \\<le> abs (u * x) *\n              (e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j) + e * abs (t * u) * norm i + e * (\\<bar>u\\<bar> * norm j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u * x\\<bar> *\n    (norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i) +\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' ((t * u) *\\<^sub>R i) i) +\n     norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n    \\<le> \\<bar>u * x\\<bar> *\n          (e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j) +\n           e * \\<bar>t * u\\<bar> * norm i +\n           e * (\\<bar>u\\<bar> * norm j))", "using f'ij f'i f'ij[OF \\<open>0 \\<in> {0..1}\\<close>] \\<open>t \\<in> {0..1}\\<close>"], ["proof (prove)\nusing this:\n  ?t \\<in> {0..1} \\<Longrightarrow>\n  norm\n   (f' (a + (?t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n    f'' ((?t * u) *\\<^sub>R i + u *\\<^sub>R j) i)\n  \\<le> e * norm ((?t * u) *\\<^sub>R i + u *\\<^sub>R j)\n  ?t \\<in> {0..1} \\<Longrightarrow>\n  norm\n   (f' (a + (?t * u) *\\<^sub>R i) i - f' a i - f'' ((?t * u) *\\<^sub>R i) i)\n  \\<le> e * \\<bar>?t * u\\<bar> * norm i\n  norm\n   (f' (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n    f'' ((0 * u) *\\<^sub>R i + u *\\<^sub>R j) i)\n  \\<le> e * norm ((0 * u) *\\<^sub>R i + u *\\<^sub>R j)\n  t \\<in> {0..1}\n\ngoal (1 subgoal):\n 1. \\<bar>u * x\\<bar> *\n    (norm\n      (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n       f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i) +\n     norm\n      (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n       f'' ((t * u) *\\<^sub>R i) i) +\n     norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n    \\<le> \\<bar>u * x\\<bar> *\n          (e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j) +\n           e * \\<bar>t * u\\<bar> * norm i +\n           e * (\\<bar>u\\<bar> * norm j))", "by (auto intro!: add_mono mult_left_mono)"], ["proof (state)\nthis:\n  \\<bar>u * x\\<bar> *\n  (norm\n    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n     f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i) +\n   norm\n    (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n     f'' ((t * u) *\\<^sub>R i) i) +\n   norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n  \\<le> \\<bar>u * x\\<bar> *\n        (e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j) +\n         e * \\<bar>t * u\\<bar> * norm i +\n         e * (\\<bar>u\\<bar> * norm j))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "also"], ["proof (state)\nthis:\n  \\<bar>u * x\\<bar> *\n  (norm\n    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n     f'' ((t * u) *\\<^sub>R i + u *\\<^sub>R j) i) +\n   norm\n    (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n     f'' ((t * u) *\\<^sub>R i) i) +\n   norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\n  \\<le> \\<bar>u * x\\<bar> *\n        (e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j) +\n         e * \\<bar>t * u\\<bar> * norm i +\n         e * (\\<bar>u\\<bar> * norm j))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"\\<dots> = abs u * abs x * abs u *\n              (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * (norm j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u * x\\<bar> *\n    (e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j) +\n     e * \\<bar>t * u\\<bar> * norm i +\n     e * (\\<bar>u\\<bar> * norm j)) =\n    \\<bar>u\\<bar> * \\<bar>x\\<bar> * \\<bar>u\\<bar> *\n    (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j)", "by (simp add: algebra_simps norm_scaleR[symmetric] abs_mult del: norm_scaleR)"], ["proof (state)\nthis:\n  \\<bar>u * x\\<bar> *\n  (e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j) +\n   e * \\<bar>t * u\\<bar> * norm i +\n   e * (\\<bar>u\\<bar> * norm j)) =\n  \\<bar>u\\<bar> * \\<bar>x\\<bar> * \\<bar>u\\<bar> *\n  (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "also"], ["proof (state)\nthis:\n  \\<bar>u * x\\<bar> *\n  (e * norm ((t * u) *\\<^sub>R i + u *\\<^sub>R j) +\n   e * \\<bar>t * u\\<bar> * norm i +\n   e * (\\<bar>u\\<bar> * norm j)) =\n  \\<bar>u\\<bar> * \\<bar>x\\<bar> * \\<bar>u\\<bar> *\n  (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"\\<dots> =\n                u * u * abs x * (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * (norm j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u\\<bar> * \\<bar>x\\<bar> * \\<bar>u\\<bar> *\n    (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j) =\n    u * u * \\<bar>x\\<bar> *\n    (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j)", "by (simp add: ac_simps)"], ["proof (state)\nthis:\n  \\<bar>u\\<bar> * \\<bar>x\\<bar> * \\<bar>u\\<bar> *\n  (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j) =\n  u * u * \\<bar>x\\<bar> *\n  (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "also"], ["proof (state)\nthis:\n  \\<bar>u\\<bar> * \\<bar>x\\<bar> * \\<bar>u\\<bar> *\n  (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j) =\n  u * u * \\<bar>x\\<bar> *\n  (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"\\<dots> = u * u * e * abs x * (norm (t *\\<^sub>R i + j) + norm (t *\\<^sub>R i) + norm j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u * u * \\<bar>x\\<bar> *\n    (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j) =\n    u * u * e * \\<bar>x\\<bar> *\n    (norm (t *\\<^sub>R i + j) + norm (t *\\<^sub>R i) + norm j)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  u * u * \\<bar>x\\<bar> *\n  (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j) =\n  u * u * e * \\<bar>x\\<bar> *\n  (norm (t *\\<^sub>R i + j) + norm (t *\\<^sub>R i) + norm j)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "also"], ["proof (state)\nthis:\n  u * u * \\<bar>x\\<bar> *\n  (e * norm (t *\\<^sub>R i + j) + e * norm (t *\\<^sub>R i) + e * norm j) =\n  u * u * e * \\<bar>x\\<bar> *\n  (norm (t *\\<^sub>R i + j) + norm (t *\\<^sub>R i) + norm j)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "have \"\\<dots> \\<le> u * u * e * abs x * ((norm (1 *\\<^sub>R i) + norm j) + norm (1 *\\<^sub>R i) + norm j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u * u * e * \\<bar>x\\<bar> *\n    (norm (t *\\<^sub>R i + j) + norm (t *\\<^sub>R i) + norm j)\n    \\<le> u * u * e * \\<bar>x\\<bar> *\n          (norm (1 *\\<^sub>R i) + norm j + norm (1 *\\<^sub>R i) + norm j)", "using \\<open>t \\<in> {0..1}\\<close> \\<open>0 < e\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {0..1}\n  0 < e\n\ngoal (1 subgoal):\n 1. u * u * e * \\<bar>x\\<bar> *\n    (norm (t *\\<^sub>R i + j) + norm (t *\\<^sub>R i) + norm j)\n    \\<le> u * u * e * \\<bar>x\\<bar> *\n          (norm (1 *\\<^sub>R i) + norm j + norm (1 *\\<^sub>R i) + norm j)", "by (intro mult_left_mono add_mono) (auto intro!: norm_triangle_le add_right_mono\n                mult_left_le_one_le zero_le_square)"], ["proof (state)\nthis:\n  u * u * e * \\<bar>x\\<bar> *\n  (norm (t *\\<^sub>R i + j) + norm (t *\\<^sub>R i) + norm j)\n  \\<le> u * u * e * \\<bar>x\\<bar> *\n        (norm (1 *\\<^sub>R i) + norm j + norm (1 *\\<^sub>R i) + norm j)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       norm\n        (((\\<lambda>ua.\n              (u * ua) *\\<^sub>R\n              (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n               f' (a + (t * u) *\\<^sub>R i) i)) -\n          (\\<lambda>ua.\n              (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n          x)\n       \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "finally"], ["proof (chain)\npicking this:\n  norm\n   (((\\<lambda>ua.\n         (u * ua) *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)) -\n     (\\<lambda>ua. (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n     x)\n  \\<le> u * u * e * \\<bar>x\\<bar> *\n        (norm (1 *\\<^sub>R i) + norm j + norm (1 *\\<^sub>R i) + norm j)", "show \"norm (?d t x) \\<le> 2 * u * u * e * (norm i + norm j) * norm x\""], ["proof (prove)\nusing this:\n  norm\n   (((\\<lambda>ua.\n         (u * ua) *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)) -\n     (\\<lambda>ua. (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n     x)\n  \\<le> u * u * e * \\<bar>x\\<bar> *\n        (norm (1 *\\<^sub>R i) + norm j + norm (1 *\\<^sub>R i) + norm j)\n\ngoal (1 subgoal):\n 1. norm\n     (((\\<lambda>ua.\n           (u * ua) *\\<^sub>R\n           (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n            f' (a + (t * u) *\\<^sub>R i) i)) -\n       (\\<lambda>ua.\n           (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n       x)\n    \\<le> 2 * u * u * e * (norm i + norm j) * norm x", "by (simp add: ac_simps)"], ["proof (state)\nthis:\n  norm\n   (((\\<lambda>ua.\n         (u * ua) *\\<^sub>R\n         (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n          f' (a + (t * u) *\\<^sub>R i) i)) -\n     (\\<lambda>ua. (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n     x)\n  \\<le> 2 * u * u * e * (norm i + norm j) * norm x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  onorm\n   ((\\<lambda>ua.\n        (u * ua) *\\<^sub>R\n        (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n         f' (a + (t * u) *\\<^sub>R i) i)) -\n    (\\<lambda>ua. (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n  \\<le> 2 * u * u * e * (norm i + norm j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>t\\<in>{0..1}.\n     onorm\n      ((\\<lambda>ua.\n           (u * ua) *\\<^sub>R\n           (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n            f' (a + (t * u) *\\<^sub>R i) i)) -\n       (\\<lambda>ua.\n           (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n     \\<le> 2 * u * u * e * (norm i + norm j)\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "with differentiable_bound_linearization[where f=\"?g u\" and f'=\"?g'\", of 0 1 _ 0, OF _ g']"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>t.\n              t \\<in> {0..1} \\<Longrightarrow>\n              0 + t *\\<^sub>R (1 - 0) \\<in> {0..1};\n   \\<And>x. x \\<in> {0..1} \\<Longrightarrow> x \\<in> {0..1};\n   \\<And>x.\n      x \\<in> {0..1} \\<Longrightarrow>\n      onorm\n       ((\\<lambda>ua.\n            u *\\<^sub>R\n            ua *\\<^sub>R\n            (f' (a + (x * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n             f' (a + (x * u) *\\<^sub>R i) i)) -\n        (\\<lambda>ua.\n            u *\\<^sub>R\n            ua *\\<^sub>R\n            (f' (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n             f' (a + (0 * u) *\\<^sub>R i) i)))\n      \\<le> ?B;\n   0 \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> norm\n                     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                      f (a + (1 * u) *\\<^sub>R i) -\n                      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                       f (a + (0 * u) *\\<^sub>R i)) -\n                      u *\\<^sub>R\n                      (1 - 0) *\\<^sub>R\n                      (f' (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                       f' (a + (0 * u) *\\<^sub>R i) i))\n                    \\<le> norm (1 - 0) * ?B\n  \\<forall>t\\<in>{0..1}.\n     onorm\n      ((\\<lambda>ua.\n           (u * ua) *\\<^sub>R\n           (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n            f' (a + (t * u) *\\<^sub>R i) i)) -\n       (\\<lambda>ua.\n           (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n     \\<le> 2 * u * u * e * (norm i + norm j)", "have \"norm ?g10 \\<le> 2 * u * u * e * (norm i + norm j)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>t.\n              t \\<in> {0..1} \\<Longrightarrow>\n              0 + t *\\<^sub>R (1 - 0) \\<in> {0..1};\n   \\<And>x. x \\<in> {0..1} \\<Longrightarrow> x \\<in> {0..1};\n   \\<And>x.\n      x \\<in> {0..1} \\<Longrightarrow>\n      onorm\n       ((\\<lambda>ua.\n            u *\\<^sub>R\n            ua *\\<^sub>R\n            (f' (a + (x * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n             f' (a + (x * u) *\\<^sub>R i) i)) -\n        (\\<lambda>ua.\n            u *\\<^sub>R\n            ua *\\<^sub>R\n            (f' (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n             f' (a + (0 * u) *\\<^sub>R i) i)))\n      \\<le> ?B;\n   0 \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> norm\n                     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                      f (a + (1 * u) *\\<^sub>R i) -\n                      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                       f (a + (0 * u) *\\<^sub>R i)) -\n                      u *\\<^sub>R\n                      (1 - 0) *\\<^sub>R\n                      (f' (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                       f' (a + (0 * u) *\\<^sub>R i) i))\n                    \\<le> norm (1 - 0) * ?B\n  \\<forall>t\\<in>{0..1}.\n     onorm\n      ((\\<lambda>ua.\n           (u * ua) *\\<^sub>R\n           (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n            f' (a + (t * u) *\\<^sub>R i) i)) -\n       (\\<lambda>ua.\n           (u * ua) *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i)))\n     \\<le> 2 * u * u * e * (norm i + norm j)\n\ngoal (1 subgoal):\n 1. norm\n     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n      f (a + (1 * u) *\\<^sub>R i) -\n      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (0 * u) *\\<^sub>R i)) -\n      u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i))\n    \\<le> 2 * u * u * e * (norm i + norm j)", "by simp"], ["proof (state)\nthis:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i))\n  \\<le> 2 * u * u * e * (norm i + norm j)\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "also"], ["proof (state)\nthis:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i))\n  \\<le> 2 * u * u * e * (norm i + norm j)\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "have \"norm ?f'i \\<le> abs u *\n          norm ((f' (a + (u) *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n    \\<le> \\<bar>u\\<bar> *\n          norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i)", "using linear_cmul[OF has_derivative_linear, OF second_fderiv]"], ["proof (prove)\nusing this:\n  f'' (?r *\\<^sub>R ?b) ?i2 = ?r *\\<^sub>R f'' ?b ?i2\n\ngoal (1 subgoal):\n 1. norm\n     (u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n    \\<le> \\<bar>u\\<bar> *\n          norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i)", "by simp"], ["proof (state)\nthis:\n  norm\n   (u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n  \\<le> \\<bar>u\\<bar> *\n        norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i)\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "also"], ["proof (state)\nthis:\n  norm\n   (u *\\<^sub>R (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n  \\<le> \\<bar>u\\<bar> *\n        norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i)\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "have \"\\<dots> \\<le> abs u * (e * norm ((u) *\\<^sub>R j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u\\<bar> *\n    norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i)\n    \\<le> \\<bar>u\\<bar> * (e * norm (u *\\<^sub>R j))", "using f'ij[OF \\<open>0 \\<in> {0..1}\\<close>]"], ["proof (prove)\nusing this:\n  norm\n   (f' (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) i - f' a i -\n    f'' ((0 * u) *\\<^sub>R i + u *\\<^sub>R j) i)\n  \\<le> e * norm ((0 * u) *\\<^sub>R i + u *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. \\<bar>u\\<bar> *\n    norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i)\n    \\<le> \\<bar>u\\<bar> * (e * norm (u *\\<^sub>R j))", "by (auto intro: mult_left_mono)"], ["proof (state)\nthis:\n  \\<bar>u\\<bar> *\n  norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i)\n  \\<le> \\<bar>u\\<bar> * (e * norm (u *\\<^sub>R j))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "also"], ["proof (state)\nthis:\n  \\<bar>u\\<bar> *\n  norm (f' (a + u *\\<^sub>R j) i - f' a i - f'' (u *\\<^sub>R j) i)\n  \\<le> \\<bar>u\\<bar> * (e * norm (u *\\<^sub>R j))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "have \"\\<dots> = u * u * e * norm j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u\\<bar> * (e * norm (u *\\<^sub>R j)) = u * u * e * norm j", "by (simp add: algebra_simps abs_mult)"], ["proof (state)\nthis:\n  \\<bar>u\\<bar> * (e * norm (u *\\<^sub>R j)) = u * u * e * norm j\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>\\<forall>t\\<in>{0..1}.\n                   norm\n                    (f' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j) i -\n                     f' a i -\n                     f'' (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a) i) /\n                   norm (a + (t * u) *\\<^sub>R i + u *\\<^sub>R j - a)\n                   \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           norm\n            (f' (a + (t * u) *\\<^sub>R i) i - f' a i -\n             f'' (a + (t * u) *\\<^sub>R i - a) i) /\n           norm (a + (t * u) *\\<^sub>R i - a)\n           \\<le> e;\n        \\<forall>t\\<in>{0..1}.\n           a + (t * u) *\\<^sub>R i + u *\\<^sub>R j \\<in> G;\n        \\<forall>t\\<in>{0..1}. a + (t * u) *\\<^sub>R i \\<in> G\\<rbrakk>\n       \\<Longrightarrow> norm\n                          (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                           f (a + (1 * u) *\\<^sub>R i) -\n                           (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                            f (a + (0 * u) *\\<^sub>R i)) -\n                           (u * u) *\\<^sub>R f'' j i)\n                         \\<le> u * u * e * (2 * norm i + 3 * norm j)", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              x +\n              norm\n               (u *\\<^sub>R\n                (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n              \\<le> y +\n                    norm\n                     (u *\\<^sub>R\n                      (f' (a + u *\\<^sub>R j) i - f' a i -\n                       u *\\<^sub>R f'' j i));\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      2 * u * u * e * (norm i + norm j) + x\n      \\<le> 2 * u * u * e * (norm i + norm j) + y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      2 * u * u * e * (norm i + norm j) + x\n      \\<le> 2 * u * u * e * (norm i + norm j) + y\\<rbrakk>\n  \\<Longrightarrow> norm\n                     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                      f (a + (1 * u) *\\<^sub>R i) -\n                      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                       f (a + (0 * u) *\\<^sub>R i)) -\n                      (u * u) *\\<^sub>R f'' j i)\n                    \\<le> 2 * u * u * e * (norm i + norm j) +\n                          u * u * e * norm j", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              x +\n              norm\n               (u *\\<^sub>R\n                (f' (a + u *\\<^sub>R j) i - f' a i - u *\\<^sub>R f'' j i))\n              \\<le> y +\n                    norm\n                     (u *\\<^sub>R\n                      (f' (a + u *\\<^sub>R j) i - f' a i -\n                       u *\\<^sub>R f'' j i));\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      2 * u * u * e * (norm i + norm j) + x\n      \\<le> 2 * u * u * e * (norm i + norm j) + y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      2 * u * u * e * (norm i + norm j) + x\n      \\<le> 2 * u * u * e * (norm i + norm j) + y\\<rbrakk>\n  \\<Longrightarrow> norm\n                     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                      f (a + (1 * u) *\\<^sub>R i) -\n                      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                       f (a + (0 * u) *\\<^sub>R i)) -\n                      (u * u) *\\<^sub>R f'' j i)\n                    \\<le> 2 * u * u * e * (norm i + norm j) +\n                          u * u * e * norm j\n\ngoal (1 subgoal):\n 1. norm\n     (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n      f (a + (1 * u) *\\<^sub>R i) -\n      (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (0 * u) *\\<^sub>R i)) -\n      (u * u) *\\<^sub>R f'' j i)\n    \\<le> u * u * e * (2 * norm i + 3 * norm j)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    (u * u) *\\<^sub>R f'' j i)\n  \\<le> u * u * e * (2 * norm i + 3 * norm j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm\n      (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (1 * u) *\\<^sub>R i) -\n       (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n        f (a + (0 * u) *\\<^sub>R i)) -\n       (u * u) *\\<^sub>R f'' j i)\n     \\<le> u * u * e * (2 * norm i + 3 * norm j)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "}"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm\n      (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (1 * u) *\\<^sub>R i) -\n       (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n        f (a + (0 * u) *\\<^sub>R i)) -\n       (u * u) *\\<^sub>R f'' j i)\n     \\<le> u * u * e * (2 * norm i + 3 * norm j)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "}"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?e2; ?ia2 \\<noteq> ?ja2; ?ia2 \\<noteq> (0::'a);\n   ?ja2 \\<noteq> (0::'a); B ?ia2 ?ja2 \\<subseteq> G\\<rbrakk>\n  \\<Longrightarrow> \\<forall>\\<^sub>F u in at_right 0.\n                       norm\n                        (f (a + (1 * u) *\\<^sub>R ?ia2 + u *\\<^sub>R ?ja2) -\n                         f (a + (1 * u) *\\<^sub>R ?ia2) -\n                         (f (a + (0 * u) *\\<^sub>R ?ia2 +\n                             u *\\<^sub>R ?ja2) -\n                          f (a + (0 * u) *\\<^sub>R ?ia2)) -\n                         (u * u) *\\<^sub>R f'' ?ja2 ?ia2)\n                       \\<le> u * u * ?e2 * (2 * norm ?ia2 + 3 * norm ?ja2)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "note wlog = this"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?e2; ?ia2 \\<noteq> ?ja2; ?ia2 \\<noteq> (0::'a);\n   ?ja2 \\<noteq> (0::'a); B ?ia2 ?ja2 \\<subseteq> G\\<rbrakk>\n  \\<Longrightarrow> \\<forall>\\<^sub>F u in at_right 0.\n                       norm\n                        (f (a + (1 * u) *\\<^sub>R ?ia2 + u *\\<^sub>R ?ja2) -\n                         f (a + (1 * u) *\\<^sub>R ?ia2) -\n                         (f (a + (0 * u) *\\<^sub>R ?ia2 +\n                             u *\\<^sub>R ?ja2) -\n                          f (a + (0 * u) *\\<^sub>R ?ia2)) -\n                         (u * u) *\\<^sub>R f'' ?ja2 ?ia2)\n                       \\<le> u * u * ?e2 * (2 * norm ?ia2 + 3 * norm ?ja2)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "have e': \"norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)\" if \"0 < e\" for e t::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "have \"B i j = B j i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B i j = B j i", "using \\<open>i \\<noteq> j\\<close>"], ["proof (prove)\nusing this:\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. B i j = B j i", "by (force simp: B_def)+"], ["proof (state)\nthis:\n  B i j = B j i\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "with assms \\<open>B i j \\<subseteq> G\\<close>"], ["proof (chain)\npicking this:\n  ?a \\<in> G \\<Longrightarrow> (f has_derivative f' ?a) (at ?a within G)\n  ((\\<lambda>x. f' x ?i) has_derivative (\\<lambda>j. f'' j ?i))\n   (at a within G)\n  i \\<noteq> j\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n  a \\<in> G\n  \\<lbrakk>?s \\<in> {0..1}; ?t \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> a + ?s *\\<^sub>R i + ?t *\\<^sub>R j \\<in> G\n  B i j \\<subseteq> G\n  B i j = B j i", "have \"j \\<noteq> i\" \"B j i \\<subseteq> G\""], ["proof (prove)\nusing this:\n  ?a \\<in> G \\<Longrightarrow> (f has_derivative f' ?a) (at ?a within G)\n  ((\\<lambda>x. f' x ?i) has_derivative (\\<lambda>j. f'' j ?i))\n   (at a within G)\n  i \\<noteq> j\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n  a \\<in> G\n  \\<lbrakk>?s \\<in> {0..1}; ?t \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> a + ?s *\\<^sub>R i + ?t *\\<^sub>R j \\<in> G\n  B i j \\<subseteq> G\n  B i j = B j i\n\ngoal (1 subgoal):\n 1. j \\<noteq> i &&& B j i \\<subseteq> G", "by (auto simp:)"], ["proof (state)\nthis:\n  j \\<noteq> i\n  B j i \\<subseteq> G\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "from wlog[OF \\<open>0 < e\\<close> \\<open>i \\<noteq> j\\<close> \\<open>i \\<noteq> 0\\<close> \\<open>j \\<noteq> 0\\<close> \\<open>B i j \\<subseteq> G\\<close>]\n         wlog[OF \\<open>0 < e\\<close> \\<open>j \\<noteq> i\\<close> \\<open>j \\<noteq> 0\\<close> \\<open>i \\<noteq> 0\\<close> \\<open>B j i \\<subseteq> G\\<close>]"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm\n      (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (1 * u) *\\<^sub>R i) -\n       (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n        f (a + (0 * u) *\\<^sub>R i)) -\n       (u * u) *\\<^sub>R f'' j i)\n     \\<le> u * u * e * (2 * norm i + 3 * norm j)\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm\n      (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n       f (a + (1 * u) *\\<^sub>R j) -\n       (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n        f (a + (0 * u) *\\<^sub>R j)) -\n       (u * u) *\\<^sub>R f'' i j)\n     \\<le> u * u * e * (2 * norm j + 3 * norm i)", "have \"eventually (\\<lambda>u. norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j)\n         \\<le> u * u * e * (5 * norm j + 5 * norm i)) ?F\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm\n      (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n       f (a + (1 * u) *\\<^sub>R i) -\n       (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n        f (a + (0 * u) *\\<^sub>R i)) -\n       (u * u) *\\<^sub>R f'' j i)\n     \\<le> u * u * e * (2 * norm i + 3 * norm j)\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm\n      (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n       f (a + (1 * u) *\\<^sub>R j) -\n       (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n        f (a + (0 * u) *\\<^sub>R j)) -\n       (u * u) *\\<^sub>R f'' i j)\n     \\<le> u * u * e * (2 * norm j + 3 * norm i)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F u in at_right 0.\n       norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j)\n       \\<le> u * u * e * (5 * norm j + 5 * norm i)", "proof eventually_elim"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>norm\n                 (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                  f (a + (1 * u) *\\<^sub>R i) -\n                  (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                   f (a + (0 * u) *\\<^sub>R i)) -\n                  (u * u) *\\<^sub>R f'' j i)\n                \\<le> u * u * e * (2 * norm i + 3 * norm j);\n        norm\n         (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n          f (a + (1 * u) *\\<^sub>R j) -\n          (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n           f (a + (0 * u) *\\<^sub>R j)) -\n          (u * u) *\\<^sub>R f'' i j)\n        \\<le> u * u * e * (2 * norm j + 3 * norm i)\\<rbrakk>\n       \\<Longrightarrow> norm\n                          ((u * u) *\\<^sub>R f'' j i -\n                           (u * u) *\\<^sub>R f'' i j)\n                         \\<le> u * u * e * (5 * norm j + 5 * norm i)", "case (elim u)"], ["proof (state)\nthis:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    (u * u) *\\<^sub>R f'' j i)\n  \\<le> u * u * e * (2 * norm i + 3 * norm j)\n  norm\n   (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n    f (a + (1 * u) *\\<^sub>R j) -\n    (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n     f (a + (0 * u) *\\<^sub>R j)) -\n    (u * u) *\\<^sub>R f'' i j)\n  \\<le> u * u * e * (2 * norm j + 3 * norm i)\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>norm\n                 (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                  f (a + (1 * u) *\\<^sub>R i) -\n                  (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                   f (a + (0 * u) *\\<^sub>R i)) -\n                  (u * u) *\\<^sub>R f'' j i)\n                \\<le> u * u * e * (2 * norm i + 3 * norm j);\n        norm\n         (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n          f (a + (1 * u) *\\<^sub>R j) -\n          (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n           f (a + (0 * u) *\\<^sub>R j)) -\n          (u * u) *\\<^sub>R f'' i j)\n        \\<le> u * u * e * (2 * norm j + 3 * norm i)\\<rbrakk>\n       \\<Longrightarrow> norm\n                          ((u * u) *\\<^sub>R f'' j i -\n                           (u * u) *\\<^sub>R f'' i j)\n                         \\<le> u * u * e * (5 * norm j + 5 * norm i)", "have \"norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j) =\n        norm (f (a + u *\\<^sub>R j + u *\\<^sub>R i) - f (a + u *\\<^sub>R j) -\n         (f (a + u *\\<^sub>R i) - f a) - (u * u) *\\<^sub>R f'' i j\n         - (f (a + u *\\<^sub>R i + u *\\<^sub>R j) - f (a + u *\\<^sub>R i) -\n         (f (a + u *\\<^sub>R j) - f a) -\n         (u * u) *\\<^sub>R f'' j i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j) =\n    norm\n     (f (a + u *\\<^sub>R j + u *\\<^sub>R i) - f (a + u *\\<^sub>R j) -\n      (f (a + u *\\<^sub>R i) - f a) -\n      (u * u) *\\<^sub>R f'' i j -\n      (f (a + u *\\<^sub>R i + u *\\<^sub>R j) - f (a + u *\\<^sub>R i) -\n       (f (a + u *\\<^sub>R j) - f a) -\n       (u * u) *\\<^sub>R f'' j i))", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j) =\n  norm\n   (f (a + u *\\<^sub>R j + u *\\<^sub>R i) - f (a + u *\\<^sub>R j) -\n    (f (a + u *\\<^sub>R i) - f a) -\n    (u * u) *\\<^sub>R f'' i j -\n    (f (a + u *\\<^sub>R i + u *\\<^sub>R j) - f (a + u *\\<^sub>R i) -\n     (f (a + u *\\<^sub>R j) - f a) -\n     (u * u) *\\<^sub>R f'' j i))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>norm\n                 (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                  f (a + (1 * u) *\\<^sub>R i) -\n                  (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                   f (a + (0 * u) *\\<^sub>R i)) -\n                  (u * u) *\\<^sub>R f'' j i)\n                \\<le> u * u * e * (2 * norm i + 3 * norm j);\n        norm\n         (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n          f (a + (1 * u) *\\<^sub>R j) -\n          (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n           f (a + (0 * u) *\\<^sub>R j)) -\n          (u * u) *\\<^sub>R f'' i j)\n        \\<le> u * u * e * (2 * norm j + 3 * norm i)\\<rbrakk>\n       \\<Longrightarrow> norm\n                          ((u * u) *\\<^sub>R f'' j i -\n                           (u * u) *\\<^sub>R f'' i j)\n                         \\<le> u * u * e * (5 * norm j + 5 * norm i)", "also"], ["proof (state)\nthis:\n  norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j) =\n  norm\n   (f (a + u *\\<^sub>R j + u *\\<^sub>R i) - f (a + u *\\<^sub>R j) -\n    (f (a + u *\\<^sub>R i) - f a) -\n    (u * u) *\\<^sub>R f'' i j -\n    (f (a + u *\\<^sub>R i + u *\\<^sub>R j) - f (a + u *\\<^sub>R i) -\n     (f (a + u *\\<^sub>R j) - f a) -\n     (u * u) *\\<^sub>R f'' j i))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>norm\n                 (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                  f (a + (1 * u) *\\<^sub>R i) -\n                  (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                   f (a + (0 * u) *\\<^sub>R i)) -\n                  (u * u) *\\<^sub>R f'' j i)\n                \\<le> u * u * e * (2 * norm i + 3 * norm j);\n        norm\n         (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n          f (a + (1 * u) *\\<^sub>R j) -\n          (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n           f (a + (0 * u) *\\<^sub>R j)) -\n          (u * u) *\\<^sub>R f'' i j)\n        \\<le> u * u * e * (2 * norm j + 3 * norm i)\\<rbrakk>\n       \\<Longrightarrow> norm\n                          ((u * u) *\\<^sub>R f'' j i -\n                           (u * u) *\\<^sub>R f'' i j)\n                         \\<le> u * u * e * (5 * norm j + 5 * norm i)", "have \"\\<dots> \\<le> u * u * e * (2 * norm j + 3 * norm i) + u * u * e * (3 * norm j + 2 * norm i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (f (a + u *\\<^sub>R j + u *\\<^sub>R i) - f (a + u *\\<^sub>R j) -\n      (f (a + u *\\<^sub>R i) - f a) -\n      (u * u) *\\<^sub>R f'' i j -\n      (f (a + u *\\<^sub>R i + u *\\<^sub>R j) - f (a + u *\\<^sub>R i) -\n       (f (a + u *\\<^sub>R j) - f a) -\n       (u * u) *\\<^sub>R f'' j i))\n    \\<le> u * u * e * (2 * norm j + 3 * norm i) +\n          u * u * e * (3 * norm j + 2 * norm i)", "using elim"], ["proof (prove)\nusing this:\n  norm\n   (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n    f (a + (1 * u) *\\<^sub>R i) -\n    (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n     f (a + (0 * u) *\\<^sub>R i)) -\n    (u * u) *\\<^sub>R f'' j i)\n  \\<le> u * u * e * (2 * norm i + 3 * norm j)\n  norm\n   (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n    f (a + (1 * u) *\\<^sub>R j) -\n    (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n     f (a + (0 * u) *\\<^sub>R j)) -\n    (u * u) *\\<^sub>R f'' i j)\n  \\<le> u * u * e * (2 * norm j + 3 * norm i)\n\ngoal (1 subgoal):\n 1. norm\n     (f (a + u *\\<^sub>R j + u *\\<^sub>R i) - f (a + u *\\<^sub>R j) -\n      (f (a + u *\\<^sub>R i) - f a) -\n      (u * u) *\\<^sub>R f'' i j -\n      (f (a + u *\\<^sub>R i + u *\\<^sub>R j) - f (a + u *\\<^sub>R i) -\n       (f (a + u *\\<^sub>R j) - f a) -\n       (u * u) *\\<^sub>R f'' j i))\n    \\<le> u * u * e * (2 * norm j + 3 * norm i) +\n          u * u * e * (3 * norm j + 2 * norm i)", "by (intro order_trans[OF norm_triangle_ineq4]) (auto simp: ac_simps intro: add_mono)"], ["proof (state)\nthis:\n  norm\n   (f (a + u *\\<^sub>R j + u *\\<^sub>R i) - f (a + u *\\<^sub>R j) -\n    (f (a + u *\\<^sub>R i) - f a) -\n    (u * u) *\\<^sub>R f'' i j -\n    (f (a + u *\\<^sub>R i + u *\\<^sub>R j) - f (a + u *\\<^sub>R i) -\n     (f (a + u *\\<^sub>R j) - f a) -\n     (u * u) *\\<^sub>R f'' j i))\n  \\<le> u * u * e * (2 * norm j + 3 * norm i) +\n        u * u * e * (3 * norm j + 2 * norm i)\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>norm\n                 (f (a + (1 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                  f (a + (1 * u) *\\<^sub>R i) -\n                  (f (a + (0 * u) *\\<^sub>R i + u *\\<^sub>R j) -\n                   f (a + (0 * u) *\\<^sub>R i)) -\n                  (u * u) *\\<^sub>R f'' j i)\n                \\<le> u * u * e * (2 * norm i + 3 * norm j);\n        norm\n         (f (a + (1 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n          f (a + (1 * u) *\\<^sub>R j) -\n          (f (a + (0 * u) *\\<^sub>R j + u *\\<^sub>R i) -\n           f (a + (0 * u) *\\<^sub>R j)) -\n          (u * u) *\\<^sub>R f'' i j)\n        \\<le> u * u * e * (2 * norm j + 3 * norm i)\\<rbrakk>\n       \\<Longrightarrow> norm\n                          ((u * u) *\\<^sub>R f'' j i -\n                           (u * u) *\\<^sub>R f'' i j)\n                         \\<le> u * u * e * (5 * norm j + 5 * norm i)", "finally"], ["proof (chain)\npicking this:\n  norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j)\n  \\<le> u * u * e * (2 * norm j + 3 * norm i) +\n        u * u * e * (3 * norm j + 2 * norm i)", "show ?case"], ["proof (prove)\nusing this:\n  norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j)\n  \\<le> u * u * e * (2 * norm j + 3 * norm i) +\n        u * u * e * (3 * norm j + 2 * norm i)\n\ngoal (1 subgoal):\n 1. norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j)\n    \\<le> u * u * e * (5 * norm j + 5 * norm i)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j)\n  \\<le> u * u * e * (5 * norm j + 5 * norm i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j)\n     \\<le> u * u * e * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "hence \"eventually (\\<lambda>u. norm ((u * u) *\\<^sub>R (f'' j i - f'' i j)) \\<le>\n        u * u * e * (5 * norm j + 5 * norm i)) ?F\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm ((u * u) *\\<^sub>R f'' j i - (u * u) *\\<^sub>R f'' i j)\n     \\<le> u * u * e * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F u in at_right 0.\n       norm ((u * u) *\\<^sub>R (f'' j i - f'' i j))\n       \\<le> u * u * e * (5 * norm j + 5 * norm i)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm ((u * u) *\\<^sub>R (f'' j i - f'' i j))\n     \\<le> u * u * e * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "hence \"eventually (\\<lambda>u. (u * u) * norm ((f'' j i - f'' i j)) \\<le>\n        (u * u) * (e * (5 * norm j + 5 * norm i))) ?F\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm ((u * u) *\\<^sub>R (f'' j i - f'' i j))\n     \\<le> u * u * e * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F u in at_right 0.\n       u * u * norm (f'' j i - f'' i j)\n       \\<le> u * u * (e * (5 * norm j + 5 * norm i))", "by (simp add: ac_simps)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F u in at_right 0.\n     u * u * norm (f'' j i - f'' i j)\n     \\<le> u * u * (e * (5 * norm j + 5 * norm i))\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "hence \"eventually (\\<lambda>u. norm ((f'' j i - f'' i j)) \\<le> e * (5 * norm j + 5 * norm i)) ?F\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F u in at_right 0.\n     u * u * norm (f'' j i - f'' i j)\n     \\<le> u * u * (e * (5 * norm j + 5 * norm i))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F u in at_right 0.\n       norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "unfolding mult_le_cancel_left eventually_at_filter"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in nhds 0.\n     x \\<noteq> 0 \\<longrightarrow>\n     x \\<in> {0<..} \\<longrightarrow>\n     (0 < x * x \\<longrightarrow>\n      norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)) \\<and>\n     (x * x < 0 \\<longrightarrow>\n      e * (5 * norm j + 5 * norm i) \\<le> norm (f'' j i - f'' i j))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in nhds 0.\n       x \\<noteq> 0 \\<longrightarrow>\n       x \\<in> {0<..} \\<longrightarrow>\n       norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "by eventually_elim auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F u in at_right 0.\n     norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)", "by (auto simp add:eventually_at dist_norm dest!: bspec[where x=\"d/2\" for d])"], ["proof (state)\nthis:\n  norm (f'' j i - f'' i j) \\<le> e * (5 * norm j + 5 * norm i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  0 < ?e \\<Longrightarrow>\n  norm (f'' j i - f'' i j) \\<le> ?e * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "have e: \"norm (f'' j i - f'' i j) < e\" if \"0 < e\" for e::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "let ?e = \"e/2/(5 * norm j + 5 * norm i)\""], ["proof (state)\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "have \"?e > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < e / 2 / (5 * norm j + 5 * norm i)", "using \\<open>0 < e\\<close> \\<open>i \\<noteq> 0\\<close> \\<open>j \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  0 < e\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. 0 < e / 2 / (5 * norm j + 5 * norm i)", "by (auto intro!: divide_pos_pos add_pos_pos)"], ["proof (state)\nthis:\n  0 < e / 2 / (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "from e'[OF this]"], ["proof (chain)\npicking this:\n  norm (f'' j i - f'' i j)\n  \\<le> e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i)", "have \"norm (f'' j i - f'' i j) \\<le> ?e * (5 * norm j + 5 * norm i)\""], ["proof (prove)\nusing this:\n  norm (f'' j i - f'' i j)\n  \\<le> e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j)\n    \\<le> e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i)", "."], ["proof (state)\nthis:\n  norm (f'' j i - f'' i j)\n  \\<le> e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "also"], ["proof (state)\nthis:\n  norm (f'' j i - f'' i j)\n  \\<le> e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "have \"\\<dots> = e / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i) = e / 2", "using \\<open>i \\<noteq> 0\\<close> \\<open>j \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  i \\<noteq> (0::'a)\n  j \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i) = e / 2", "by (auto simp: ac_simps add_nonneg_eq_0_iff)"], ["proof (state)\nthis:\n  e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i) = e / 2\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "also"], ["proof (state)\nthis:\n  e / 2 / (5 * norm j + 5 * norm i) * (5 * norm j + 5 * norm i) = e / 2\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "have \"\\<dots> < e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e / 2 < e", "using \\<open>0 < e\\<close>"], ["proof (prove)\nusing this:\n  0 < e\n\ngoal (1 subgoal):\n 1. e / 2 < e", "by simp"], ["proof (state)\nthis:\n  e / 2 < e\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "finally"], ["proof (chain)\npicking this:\n  norm (f'' j i - f'' i j) < e", "show ?thesis"], ["proof (prove)\nusing this:\n  norm (f'' j i - f'' i j) < e\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) < e", "."], ["proof (state)\nthis:\n  norm (f'' j i - f'' i j) < e\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  0 < ?e \\<Longrightarrow> norm (f'' j i - f'' i j) < ?e\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "have \"norm (f'' j i - f'' i j) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) = 0", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<noteq> 0 \\<Longrightarrow> False", "assume \"norm (f'' j i - f'' i j) \\<noteq> 0\""], ["proof (state)\nthis:\n  norm (f'' j i - f'' i j) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<noteq> 0 \\<Longrightarrow> False", "hence \"norm (f'' j i - f'' i j) > 0\""], ["proof (prove)\nusing this:\n  norm (f'' j i - f'' i j) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < norm (f'' j i - f'' i j)", "by simp"], ["proof (state)\nthis:\n  0 < norm (f'' j i - f'' i j)\n\ngoal (1 subgoal):\n 1. norm (f'' j i - f'' i j) \\<noteq> 0 \\<Longrightarrow> False", "from e[OF this]"], ["proof (chain)\npicking this:\n  norm (f'' j i - f'' i j) < norm (f'' j i - f'' i j)", "show False"], ["proof (prove)\nusing this:\n  norm (f'' j i - f'' i j) < norm (f'' j i - f'' i j)\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  norm (f'' j i - f'' i j) = 0\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "thus ?thesis"], ["proof (prove)\nusing this:\n  norm (f'' j i - f'' i j) = 0\n\ngoal (1 subgoal):\n 1. f'' j i = f'' i j", "by simp"], ["proof (state)\nthis:\n  f'' j i = f'' i j\n\ngoal:\nNo subgoals!", "qed"], ["", "locale second_derivative_within =\n  fixes f f' f'' a G\n  assumes first_fderiv[derivative_intros]:\n    \"\\<And>a. a \\<in> G \\<Longrightarrow> (f has_derivative blinfun_apply (f' a)) (at a within G)\"\n  assumes in_G: \"a \\<in> G\"\n  assumes second_fderiv[derivative_intros]:\n    \"(f' has_derivative blinfun_apply f'') (at a within G)\"\nbegin"], ["", "lemma symmetric_second_derivative_within:\n  assumes \"a \\<in> G\"\n  assumes \"\\<And>s t. s \\<in> {0..1} \\<Longrightarrow> t \\<in> {0..1} \\<Longrightarrow> a + s *\\<^sub>R i + t *\\<^sub>R j \\<in> G\"\n  shows \"f'' i j = f'' j i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "apply (cases \"i = j \\<or> i = 0 \\<or> j = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' $ i $ j = f'' $ j $ i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' $ i $ j = f'' $ j $ i", "apply (force simp add: blinfun.zero_right blinfun.zero_left)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' $ i $ j = f'' $ j $ i", "using first_fderiv _ _ _ _ assms"], ["proof (prove)\nusing this:\n  ?a \\<in> G \\<Longrightarrow>\n  (f has_derivative ($) (f' ?a)) (at ?a within G)\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  a \\<in> G\n  \\<lbrakk>?s \\<in> {0..1}; ?t \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> a + ?s *\\<^sub>R i + ?t *\\<^sub>R j \\<in> G\n\ngoal (1 subgoal):\n 1. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' $ i $ j = f'' $ j $ i", "by (rule symmetric_second_derivative_aux[symmetric])\n    (auto intro!: derivative_eq_intros simp: blinfun.bilinear_simps assms)"], ["", "end"], ["", "locale second_derivative =\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n    and f' :: \"'a \\<Rightarrow> 'a \\<Rightarrow>\\<^sub>L 'b\"\n    and f'' :: \"'a \\<Rightarrow>\\<^sub>L 'a \\<Rightarrow>\\<^sub>L 'b\"\n    and a :: 'a\n    and G :: \"'a set\"\n  assumes first_fderiv[derivative_intros]:\n    \"\\<And>a. a \\<in> G \\<Longrightarrow> (f has_derivative f' a) (at a)\"\n  assumes in_G: \"a \\<in> interior G\"\n  assumes second_fderiv[derivative_intros]:\n    \"(f' has_derivative f'') (at a)\"\nbegin"], ["", "lemma symmetric_second_derivative:\n  assumes \"a \\<in> interior G\"\n  shows \"f'' i j = f'' j i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "from assms"], ["proof (chain)\npicking this:\n  a \\<in> interior G", "have \"a \\<in> G\""], ["proof (prove)\nusing this:\n  a \\<in> interior G\n\ngoal (1 subgoal):\n 1. a \\<in> G", "using interior_subset"], ["proof (prove)\nusing this:\n  a \\<in> interior G\n  interior ?S \\<subseteq> ?S\n\ngoal (1 subgoal):\n 1. a \\<in> G", "by blast"], ["proof (state)\nthis:\n  a \\<in> G\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "interpret second_derivative_within"], ["proof (prove)\ngoal (1 subgoal):\n 1. second_derivative_within f f' f'' a G", "by unfold_locales\n      (auto intro!: derivative_intros intro: has_derivative_at_withinI \\<open>a \\<in> G\\<close>)"], ["proof (state)\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "from assms open_interior[of G] interior_subset[of G]"], ["proof (chain)\npicking this:\n  a \\<in> interior G\n  open (interior G)\n  interior G \\<subseteq> G", "obtain e where e: \"e > 0\" \"\\<And>y. dist y a < e \\<Longrightarrow> y \\<in> G\""], ["proof (prove)\nusing this:\n  a \\<in> interior G\n  open (interior G)\n  interior G \\<subseteq> G\n\ngoal (1 subgoal):\n 1. (\\<And>e.\n        \\<lbrakk>0 < e;\n         \\<And>y. dist y a < e \\<Longrightarrow> y \\<in> G\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (force simp: open_dist)"], ["proof (state)\nthis:\n  0 < e\n  dist ?y a < e \\<Longrightarrow> ?y \\<in> G\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "define e' where \"e' = e / 3\""], ["proof (state)\nthis:\n  e' = e / 3\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "define i' j' where \"i' = e' *\\<^sub>R i /\\<^sub>R norm i\" and \"j' = e' *\\<^sub>R j /\\<^sub>R norm j\""], ["proof (state)\nthis:\n  i' = e' *\\<^sub>R i /\\<^sub>R norm i\n  j' = e' *\\<^sub>R j /\\<^sub>R norm j\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "hence \"norm i' \\<le> e'\" \"norm j' \\<le> e'\""], ["proof (prove)\nusing this:\n  i' = e' *\\<^sub>R i /\\<^sub>R norm i\n  j' = e' *\\<^sub>R j /\\<^sub>R norm j\n\ngoal (1 subgoal):\n 1. norm i' \\<le> e' &&& norm j' \\<le> e'", "by (auto simp: field_simps e'_def \\<open>0 < e\\<close> less_imp_le)"], ["proof (state)\nthis:\n  norm i' \\<le> e'\n  norm j' \\<le> e'\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "hence \"\\<bar>s\\<bar> \\<le> 1 \\<Longrightarrow> \\<bar>t\\<bar> \\<le> 1 \\<Longrightarrow> norm (s *\\<^sub>R i' + t *\\<^sub>R j') \\<le> e' + e'\" for s t"], ["proof (prove)\nusing this:\n  norm i' \\<le> e'\n  norm j' \\<le> e'\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>s\\<bar> \\<le> 1; \\<bar>t\\<bar> \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> norm (s *\\<^sub>R i' + t *\\<^sub>R j') \\<le> e' + e'", "by (intro norm_triangle_le[OF add_mono])\n      (auto intro!: order_trans[OF mult_left_le_one_le])"], ["proof (state)\nthis:\n  \\<lbrakk>\\<bar>?s\\<bar> \\<le> 1; \\<bar>?t\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> norm (?s *\\<^sub>R i' + ?t *\\<^sub>R j') \\<le> e' + e'\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "also"], ["proof (state)\nthis:\n  \\<lbrakk>\\<bar>?s\\<bar> \\<le> 1; \\<bar>?t\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> norm (?s *\\<^sub>R i' + ?t *\\<^sub>R j') \\<le> e' + e'\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "have \"\\<dots> < e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e' + e' < e", "by (simp add: e'_def \\<open>0 < e\\<close>)"], ["proof (state)\nthis:\n  e' + e' < e\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<bar>?s1\\<bar> \\<le> 1; \\<bar>?t1\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> norm (?s1 *\\<^sub>R i' + ?t1 *\\<^sub>R j') < e", "have \"f'' $ i' $ j' = f'' $ j' $ i'\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<bar>?s1\\<bar> \\<le> 1; \\<bar>?t1\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> norm (?s1 *\\<^sub>R i' + ?t1 *\\<^sub>R j') < e\n\ngoal (1 subgoal):\n 1. f'' $ i' $ j' = f'' $ j' $ i'", "by (intro symmetric_second_derivative_within \\<open>a \\<in> G\\<close> e)\n      (auto simp add: dist_norm)"], ["proof (state)\nthis:\n  f'' $ i' $ j' = f'' $ j' $ i'\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "thus ?thesis"], ["proof (prove)\nusing this:\n  f'' $ i' $ j' = f'' $ j' $ i'\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "using e(1)"], ["proof (prove)\nusing this:\n  f'' $ i' $ j' = f'' $ j' $ i'\n  0 < e\n\ngoal (1 subgoal):\n 1. f'' $ i $ j = f'' $ j $ i", "by (auto simp: i'_def j'_def e'_def\n      blinfun.zero_right blinfun.zero_left\n      blinfun.scaleR_left blinfun.scaleR_right algebra_simps)"], ["proof (state)\nthis:\n  f'' $ i $ j = f'' $ j $ i\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "lemma\n  uniform_explicit_remainder_Taylor_1:\n  fixes f::\"'a::{banach,heine_borel,perfect_space} \\<Rightarrow> 'b::banach\"\n  assumes f'[derivative_intros]: \"\\<And>x. x \\<in> G \\<Longrightarrow> (f has_derivative blinfun_apply (f' x)) (at x)\"\n  assumes f'_cont: \"\\<And>x. x \\<in> G \\<Longrightarrow> isCont f' x\"\n  assumes \"open G\"\n  assumes \"J \\<noteq> {}\" \"compact J\" \"J \\<subseteq> G\"\n  assumes \"e > 0\"\n  obtains d R\n  where \"d > 0\"\n    \"\\<And>x z. f z = f x + f' x (z - x) + R x z\"\n    \"\\<And>x y. x \\<in> J \\<Longrightarrow> y \\<in> J \\<Longrightarrow> dist x y < d \\<Longrightarrow> norm (R x y) \\<le> e * dist x y\"\n    \"continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from assms"], ["proof (chain)\npicking this:\n  ?x \\<in> G \\<Longrightarrow> (f has_derivative ($) (f' ?x)) (at ?x)\n  ?x \\<in> G \\<Longrightarrow> isCont f' ?x\n  open G\n  J \\<noteq> {}\n  compact J\n  J \\<subseteq> G\n  0 < e", "have \"continuous_on G f'\""], ["proof (prove)\nusing this:\n  ?x \\<in> G \\<Longrightarrow> (f has_derivative ($) (f' ?x)) (at ?x)\n  ?x \\<in> G \\<Longrightarrow> isCont f' ?x\n  open G\n  J \\<noteq> {}\n  compact J\n  J \\<subseteq> G\n  0 < e\n\ngoal (1 subgoal):\n 1. continuous_on G f'", "by (auto intro!: continuous_at_imp_continuous_on)"], ["proof (state)\nthis:\n  continuous_on G f'\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "note [continuous_intros] = continuous_on_compose2[OF this]"], ["proof (state)\nthis:\n  \\<lbrakk>continuous_on ?s ?f; ?f ` ?s \\<subseteq> G\\<rbrakk>\n  \\<Longrightarrow> continuous_on ?s (\\<lambda>x. f' (?f x))\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define R where \"R x z = f z - f x - f' x (z - x)\" for x z"], ["proof (state)\nthis:\n  R ?x ?z = f ?z - f ?x - f' ?x $ (?z - ?x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from compact_in_open_separated[OF \\<open>J \\<noteq> {}\\<close> \\<open>compact J\\<close> \\<open>open G\\<close> \\<open>J \\<subseteq> G\\<close>]"], ["proof (chain)\npicking this:\n  (\\<And>e.\n      \\<lbrakk>0 < e; {x. infdist x J \\<le> e} \\<subseteq> G\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain \\<eta> where \\<eta>: \"0 < \\<eta>\" \"{x. infdist x J \\<le> \\<eta>} \\<subseteq> G\" (is \"?J' \\<subseteq> _\")"], ["proof (prove)\nusing this:\n  (\\<And>e.\n      \\<lbrakk>0 < e; {x. infdist x J \\<le> e} \\<subseteq> G\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<eta>.\n        \\<lbrakk>0 < \\<eta>;\n         {x. infdist x J \\<le> \\<eta>} \\<subseteq> G\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < \\<eta>\n  {x. infdist x J \\<le> \\<eta>} \\<subseteq> G\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence infdist_in_G: \"infdist x J \\<le> \\<eta> \\<Longrightarrow> x \\<in> G\" for x"], ["proof (prove)\nusing this:\n  0 < \\<eta>\n  {x. infdist x J \\<le> \\<eta>} \\<subseteq> G\n\ngoal (1 subgoal):\n 1. infdist x J \\<le> \\<eta> \\<Longrightarrow> x \\<in> G", "by auto"], ["proof (state)\nthis:\n  infdist ?x J \\<le> \\<eta> \\<Longrightarrow> ?x \\<in> G\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have dist_in_G: \"\\<And>y. dist x y < \\<eta> \\<Longrightarrow> y \\<in> G\" if \"x \\<in> J\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y. dist x y < \\<eta> \\<Longrightarrow> y \\<in> G", "by (auto intro!: infdist_in_G infdist_le2 that simp: dist_commute)"], ["proof (state)\nthis:\n  \\<lbrakk>?x1 \\<in> J; dist ?x1 ?y < \\<eta>\\<rbrakk>\n  \\<Longrightarrow> ?y \\<in> G\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"compact ?J'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. compact {x. infdist x J \\<le> \\<eta>}", "by (rule compact_infdist_le; fact)"], ["proof (state)\nthis:\n  compact {x. infdist x J \\<le> \\<eta>}\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?seg = ?J'"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from \\<open>continuous_on G f'\\<close>"], ["proof (chain)\npicking this:\n  continuous_on G f'", "have ucont: \"uniformly_continuous_on ?seg f'\""], ["proof (prove)\nusing this:\n  continuous_on G f'\n\ngoal (1 subgoal):\n 1. uniformly_continuous_on {x. infdist x J \\<le> \\<eta>} f'", "using \\<open>?seg \\<subseteq> G\\<close>"], ["proof (prove)\nusing this:\n  continuous_on G f'\n  {x. infdist x J \\<le> \\<eta>} \\<subseteq> G\n\ngoal (1 subgoal):\n 1. uniformly_continuous_on {x. infdist x J \\<le> \\<eta>} f'", "by (auto intro!: compact_uniformly_continuous \\<open>compact ?seg\\<close> intro: continuous_on_subset)"], ["proof (state)\nthis:\n  uniformly_continuous_on {x. infdist x J \\<le> \\<eta>} f'\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define e' where \"e' = e / 2\""], ["proof (state)\nthis:\n  e' = e / 2\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"e' > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < e'", "using \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < e\n\ngoal (1 subgoal):\n 1. 0 < e'", "by (simp add: e'_def)"], ["proof (state)\nthis:\n  0 < e'\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from ucont[unfolded uniformly_continuous_on_def, rule_format, OF \\<open>0 < e'\\<close>]"], ["proof (chain)\npicking this:\n  \\<exists>d>0.\n     \\<forall>x\\<in>{x. infdist x J \\<le> \\<eta>}.\n        \\<forall>x'\\<in>{x. infdist x J \\<le> \\<eta>}.\n           dist x' x < d \\<longrightarrow> dist (f' x') (f' x) < e'", "obtain du where du:\n    \"du > 0\"\n    \"\\<And>x y. x \\<in> ?seg \\<Longrightarrow> y \\<in> ?seg \\<Longrightarrow> dist x y < du \\<Longrightarrow> norm (f' x - f' y) < e'\""], ["proof (prove)\nusing this:\n  \\<exists>d>0.\n     \\<forall>x\\<in>{x. infdist x J \\<le> \\<eta>}.\n        \\<forall>x'\\<in>{x. infdist x J \\<le> \\<eta>}.\n           dist x' x < d \\<longrightarrow> dist (f' x') (f' x) < e'\n\ngoal (1 subgoal):\n 1. (\\<And>du.\n        \\<lbrakk>0 < du;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> {x. infdist x J \\<le> \\<eta>};\n             y \\<in> {x. infdist x J \\<le> \\<eta>}; dist x y < du\\<rbrakk>\n            \\<Longrightarrow> norm (f' x - f' y) < e'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: dist_norm)"], ["proof (state)\nthis:\n  0 < du\n  \\<lbrakk>?x \\<in> {x. infdist x J \\<le> \\<eta>};\n   ?y \\<in> {x. infdist x J \\<le> \\<eta>}; dist ?x ?y < du\\<rbrakk>\n  \\<Longrightarrow> norm (f' ?x - f' ?y) < e'\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"min \\<eta> du > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < min \\<eta> du", "using \\<open>du > 0\\<close> \\<open>\\<eta> > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < du\n  0 < \\<eta>\n\ngoal (1 subgoal):\n 1. 0 < min \\<eta> du", "by simp"], ["proof (state)\nthis:\n  0 < min \\<eta> du\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  0 < min \\<eta> du\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"f z = f x + f' x (z - x) + R x z\" for x z"], ["proof (prove)\ngoal (1 subgoal):\n 1. f z = f x + f' x $ (z - x) + R x z", "by (auto simp: R_def)"], ["proof (state)\nthis:\n  f ?z = f ?x + f' ?x $ (?z - ?x) + R ?x ?z\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  f ?z = f ?x + f' ?x $ (?z - ?x) + R ?x ?z\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "{"], ["proof (state)\nthis:\n  f ?z = f ?x + f' ?x $ (?z - ?x) + R ?x ?z\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "fix x z::'a"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "assume \"x \\<in> J\" \"z \\<in> J\""], ["proof (state)\nthis:\n  x \\<in> J\n  z \\<in> J\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"x \\<in> G\" \"z \\<in> G\""], ["proof (prove)\nusing this:\n  x \\<in> J\n  z \\<in> J\n\ngoal (1 subgoal):\n 1. x \\<in> G &&& z \\<in> G", "using assms"], ["proof (prove)\nusing this:\n  x \\<in> J\n  z \\<in> J\n  ?x \\<in> G \\<Longrightarrow> (f has_derivative ($) (f' ?x)) (at ?x)\n  ?x \\<in> G \\<Longrightarrow> isCont f' ?x\n  open G\n  J \\<noteq> {}\n  compact J\n  J \\<subseteq> G\n  0 < e\n\ngoal (1 subgoal):\n 1. x \\<in> G &&& z \\<in> G", "by auto"], ["proof (state)\nthis:\n  x \\<in> G\n  z \\<in> G\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "assume \"dist x z < min \\<eta> du\""], ["proof (state)\nthis:\n  dist x z < min \\<eta> du\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence d_eta: \"dist x z < \\<eta>\" and d_du: \"dist x z < du\""], ["proof (prove)\nusing this:\n  dist x z < min \\<eta> du\n\ngoal (1 subgoal):\n 1. dist x z < \\<eta> &&& dist x z < du", "by (auto simp add: min_def split: if_split_asm)"], ["proof (state)\nthis:\n  dist x z < \\<eta>\n  dist x z < du\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from \\<open>dist x z < \\<eta>\\<close>"], ["proof (chain)\npicking this:\n  dist x z < \\<eta>", "have line_in:\n      \"\\<And>xa. 0 \\<le> xa \\<Longrightarrow> xa \\<le> 1 \\<Longrightarrow> x + xa *\\<^sub>R (z - x) \\<in> G\"\n      \"(\\<lambda>xa. x + xa *\\<^sub>R (z - x)) ` {0..1} \\<subseteq> G\""], ["proof (prove)\nusing this:\n  dist x z < \\<eta>\n\ngoal (1 subgoal):\n 1. (\\<And>xa.\n        \\<lbrakk>0 \\<le> xa; xa \\<le> 1\\<rbrakk>\n        \\<Longrightarrow> x + xa *\\<^sub>R (z - x) \\<in> G) &&&\n    (\\<lambda>xa. x + xa *\\<^sub>R (z - x)) ` {0..1} \\<subseteq> G", "by (auto intro!: dist_in_G \\<open>x \\<in> J\\<close> le_less_trans[OF mult_left_le_one_le]\n        simp: dist_norm norm_minus_commute)"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?xa; ?xa \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> x + ?xa *\\<^sub>R (z - x) \\<in> G\n  (\\<lambda>xa. x + xa *\\<^sub>R (z - x)) ` {0..1} \\<subseteq> G\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"R x z = f z - f x - f' x (z - x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R x z = f z - f x - f' x $ (z - x)", "by (simp add: R_def)"], ["proof (state)\nthis:\n  R x z = f z - f x - f' x $ (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  R x z = f z - f x - f' x $ (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"f z - f x = f (x + (z - x)) - f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f z - f x = f (x + (z - x)) - f x", "by simp"], ["proof (state)\nthis:\n  f z - f x = f (x + (z - x)) - f x\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  f z - f x = f (x + (z - x)) - f x\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"f (x + (z - x)) - f x = integral {0..1} (\\<lambda>t. (f' (x + t *\\<^sub>R (z - x))) (z - x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (x + (z - x)) - f x =\n    integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) $ (z - x))", "using \\<open>dist x z < \\<eta>\\<close>"], ["proof (prove)\nusing this:\n  dist x z < \\<eta>\n\ngoal (1 subgoal):\n 1. f (x + (z - x)) - f x =\n    integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) $ (z - x))", "by (intro mvt_integral[of \"ball x \\<eta>\" f f' x \"z - x\"])\n        (auto simp: dist_norm norm_minus_commute at_within_ball \\<open>0 < \\<eta>\\<close> mem_ball\n          intro!: le_less_trans[OF mult_left_le_one_le] derivative_eq_intros dist_in_G \\<open>x \\<in> J\\<close>)"], ["proof (state)\nthis:\n  f (x + (z - x)) - f x =\n  integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) $ (z - x))\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  f (x + (z - x)) - f x =\n  integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) $ (z - x))\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have\n      \"(integral {0..1} (\\<lambda>t. (f' (x + t *\\<^sub>R (z - x))) (z - x)) - (f' x) (z - x)) =\n        integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) (z - x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) $ (z - x)) -\n    f' x $ (z - x) =\n    integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n    (z - x)", "by (simp add: Henstock_Kurzweil_Integration.integral_diff integral_linear[where h=\"\\<lambda>y. blinfun_apply y (z - x)\", simplified o_def]\n        integrable_continuous_real continuous_intros line_in\n        blinfun.bilinear_simps[symmetric])"], ["proof (state)\nthis:\n  integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) $ (z - x)) -\n  f' x $ (z - x) =\n  integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n  (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "finally"], ["proof (chain)\npicking this:\n  R x z =\n  integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n  (z - x)", "have \"R x z = integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) (z - x)\""], ["proof (prove)\nusing this:\n  R x z =\n  integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n  (z - x)\n\ngoal (1 subgoal):\n 1. R x z =\n    integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n    (z - x)", "."], ["proof (state)\nthis:\n  R x z =\n  integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n  (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  R x z =\n  integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n  (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"norm \\<dots> \\<le> norm (integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x)) * norm (z - x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n      (z - x))\n    \\<le> norm\n           (integral {0..1}\n             (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x)) *\n          norm (z - x)", "by (auto intro!: order_trans[OF norm_blinfun])"], ["proof (state)\nthis:\n  norm\n   (integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n    (z - x))\n  \\<le> norm\n         (integral {0..1}\n           (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x)) *\n        norm (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  norm\n   (integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x) $\n    (z - x))\n  \\<le> norm\n         (integral {0..1}\n           (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x)) *\n        norm (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<dots> \\<le> e' * (1 - 0) * norm (z - x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x)) *\n    norm (z - x)\n    \\<le> e' * (1 - 0) * norm (z - x)", "using d_eta d_du \\<open>0 < \\<eta>\\<close>"], ["proof (prove)\nusing this:\n  dist x z < \\<eta>\n  dist x z < du\n  0 < \\<eta>\n\ngoal (1 subgoal):\n 1. norm\n     (integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x)) *\n    norm (z - x)\n    \\<le> e' * (1 - 0) * norm (z - x)", "by (intro mult_right_mono integral_bound)\n        (auto simp: dist_norm norm_minus_commute\n          intro!: line_in du[THEN less_imp_le] infdist_le2[OF \\<open>x \\<in> J\\<close>] line_in continuous_intros\n            order_trans[OF mult_left_le_one_le] le_less_trans[OF mult_left_le_one_le])"], ["proof (state)\nthis:\n  norm (integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x)) *\n  norm (z - x)\n  \\<le> e' * (1 - 0) * norm (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  norm (integral {0..1} (\\<lambda>t. f' (x + t *\\<^sub>R (z - x)) - f' x)) *\n  norm (z - x)\n  \\<le> e' * (1 - 0) * norm (z - x)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<dots> \\<le> e * dist x z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e' * (1 - 0) * norm (z - x) \\<le> e * dist x z", "using \\<open>0 < e\\<close>"], ["proof (prove)\nusing this:\n  0 < e\n\ngoal (1 subgoal):\n 1. e' * (1 - 0) * norm (z - x) \\<le> e * dist x z", "by (simp add: e'_def norm_minus_commute dist_norm)"], ["proof (state)\nthis:\n  e' * (1 - 0) * norm (z - x) \\<le> e * dist x z\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "finally"], ["proof (chain)\npicking this:\n  norm (R x z) \\<le> e * dist x z", "have \"norm (R x z) \\<le> e * dist x z\""], ["proof (prove)\nusing this:\n  norm (R x z) \\<le> e * dist x z\n\ngoal (1 subgoal):\n 1. norm (R x z) \\<le> e * dist x z", "."], ["proof (state)\nthis:\n  norm (R x z) \\<le> e * dist x z\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?x2 \\<in> J; ?z2 \\<in> J; dist ?x2 ?z2 < min \\<eta> du\\<rbrakk>\n  \\<Longrightarrow> norm (R ?x2 ?z2) \\<le> e * dist ?x2 ?z2\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>?x2 \\<in> J; ?z2 \\<in> J; dist ?x2 ?z2 < min \\<eta> du\\<rbrakk>\n  \\<Longrightarrow> norm (R ?x2 ?z2) \\<le> e * dist ?x2 ?z2\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "{"], ["proof (state)\nthis:\n  \\<lbrakk>?x2 \\<in> J; ?z2 \\<in> J; dist ?x2 ?z2 < min \\<eta> du\\<rbrakk>\n  \\<Longrightarrow> norm (R ?x2 ?z2) \\<le> e * dist ?x2 ?z2\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from f'"], ["proof (chain)\npicking this:\n  ?x \\<in> G \\<Longrightarrow> (f has_derivative ($) (f' ?x)) (at ?x)", "have f_cont: \"continuous_on G f\""], ["proof (prove)\nusing this:\n  ?x \\<in> G \\<Longrightarrow> (f has_derivative ($) (f' ?x)) (at ?x)\n\ngoal (1 subgoal):\n 1. continuous_on G f", "by (rule has_derivative_continuous_on[OF has_derivative_at_withinI])"], ["proof (state)\nthis:\n  continuous_on G f\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "note [continuous_intros] = continuous_on_compose2[OF this]"], ["proof (state)\nthis:\n  \\<lbrakk>continuous_on ?s ?f; ?f ` ?s \\<subseteq> G\\<rbrakk>\n  \\<Longrightarrow> continuous_on ?s (\\<lambda>x. f (?f x))\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from f'_cont"], ["proof (chain)\npicking this:\n  ?x \\<in> G \\<Longrightarrow> isCont f' ?x", "have f'_cont: \"continuous_on G f'\""], ["proof (prove)\nusing this:\n  ?x \\<in> G \\<Longrightarrow> isCont f' ?x\n\ngoal (1 subgoal):\n 1. continuous_on G f'", "by (auto intro!: continuous_at_imp_continuous_on)"], ["proof (state)\nthis:\n  continuous_on G f'\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "note continuous_on_diff2=continuous_on_diff[OF continuous_on_compose[OF continuous_on_snd] continuous_on_compose[OF continuous_on_fst], where s=\"G \\<times> G\", simplified]"], ["proof (state)\nthis:\n  \\<lbrakk>continuous_on (G \\<times> G) ?f4;\n   continuous_on ((\\<lambda>x. snd (?f4 x)) ` (G \\<times> G)) ?g3;\n   continuous_on (G \\<times> G) ?f2;\n   continuous_on ((\\<lambda>x. fst (?f2 x)) ` (G \\<times> G)) ?g1\\<rbrakk>\n  \\<Longrightarrow> continuous_on (G \\<times> G)\n                     (\\<lambda>x. ?g3 (snd (?f4 x)) - ?g1 (fst (?f2 x)))\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"continuous_on (G \\<times> G) (\\<lambda>(a, b). f b - f a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (G \\<times> G) (\\<lambda>(a, b). f b - f a)", "by (auto intro!: continuous_intros simp: split_beta)"], ["proof (state)\nthis:\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). f b - f a)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). f b - f a)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"continuous_on (G \\<times> G) (\\<lambda>(a, b). f' a (b - a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (G \\<times> G) (\\<lambda>(a, b). f' a $ (b - a))", "by (auto intro!: continuous_intros simp: split_beta')"], ["proof (state)\nthis:\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). f' a $ (b - a))\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). f b - f a)\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). f' a $ (b - a))", "have \"continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\""], ["proof (prove)\nusing this:\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). f b - f a)\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). f' a $ (b - a))\n\ngoal (1 subgoal):\n 1. continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)", "by (rule iffD1[OF continuous_on_cong[OF refl] continuous_on_diff, rotated], auto simp: R_def)"], ["proof (state)\nthis:\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "}"], ["proof (state)\nthis:\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\n\ngoal (1 subgoal):\n 1. (\\<And>d R.\n        \\<lbrakk>0 < d; \\<And>x z. f z = f x + f' x $ (z - x) + R x z;\n         \\<And>x y.\n            \\<lbrakk>x \\<in> J; y \\<in> J; dist x y < d\\<rbrakk>\n            \\<Longrightarrow> norm (R x y) \\<le> e * dist x y;\n         continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  0 < min \\<eta> du\n  f ?z = f ?x + f' ?x $ (?z - ?x) + R ?x ?z\n  \\<lbrakk>?x2 \\<in> J; ?z2 \\<in> J; dist ?x2 ?z2 < min \\<eta> du\\<rbrakk>\n  \\<Longrightarrow> norm (R ?x2 ?z2) \\<le> e * dist ?x2 ?z2\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)", "show thesis"], ["proof (prove)\nusing this:\n  0 < min \\<eta> du\n  f ?z = f ?x + f' ?x $ (?z - ?x) + R ?x ?z\n  \\<lbrakk>?x2 \\<in> J; ?z2 \\<in> J; dist ?x2 ?z2 < min \\<eta> du\\<rbrakk>\n  \\<Longrightarrow> norm (R ?x2 ?z2) \\<le> e * dist ?x2 ?z2\n  continuous_on (G \\<times> G) (\\<lambda>(a, b). R a b)\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>TODO: rename, duplication?\\<close>"], ["", "locale second_derivative_within' =\n  fixes f f' f'' a G\n  assumes first_fderiv[derivative_intros]:\n    \"\\<And>a. a \\<in> G \\<Longrightarrow> (f has_derivative f' a) (at a within G)\"\n  assumes in_G: \"a \\<in> G\"\n  assumes second_fderiv[derivative_intros]:\n    \"\\<And>i. ((\\<lambda>x. f' x i) has_derivative f'' i) (at a within G)\"\nbegin"], ["", "lemma symmetric_second_derivative_within:\n  assumes \"a \\<in> G\"  \"open G\"\n  assumes \"\\<And>s t. s \\<in> {0..1} \\<Longrightarrow> t \\<in> {0..1} \\<Longrightarrow> a + s *\\<^sub>R i + t *\\<^sub>R j \\<in> G\"\n  shows \"f'' i j = f'' j i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "proof (cases \"i = j \\<or> i = 0 \\<or> j = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' i j = f'' j i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "case True"], ["proof (state)\nthis:\n  i = j \\<or> i = (0::'a) \\<or> j = (0::'a)\n\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' i j = f'' j i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "interpret bounded_linear \"f'' k\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. bounded_linear (f'' k)", "by (rule has_derivative_bounded_linear) (rule second_fderiv)"], ["proof (state)\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' i j = f'' j i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "have z1: \"f'' j 0 = 0\" \"f'' i 0 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f'' j (0::'a) = (0::'b) &&& f'' i (0::'a) = (0::'b)", "by (simp_all add: zero)"], ["proof (state)\nthis:\n  f'' j (0::'a) = (0::'b)\n  f'' i (0::'a) = (0::'b)\n\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' i j = f'' j i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "have f'z: \"f' x 0 = 0\" if \"x \\<in> G\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. f' x (0::'a) = (0::'b)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f' x (0::'a) = (0::'b)", "interpret bounded_linear \"f' x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bounded_linear (f' x)", "by (rule has_derivative_bounded_linear) (rule first_fderiv that)+"], ["proof (state)\ngoal (1 subgoal):\n 1. f' x (0::'a) = (0::'b)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. f' x (0::'a) = (0::'b)", "by (simp add: zero)"], ["proof (state)\nthis:\n  f' x (0::'a) = (0::'b)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x \\<in> G \\<Longrightarrow> f' ?x (0::'a) = (0::'b)\n\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' i j = f'' j i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "note aw = at_within_open[OF \\<open>a \\<in> G\\<close> \\<open>open G\\<close>]"], ["proof (state)\nthis:\n  at a within G = at a\n\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' i j = f'' j i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "have \"((\\<lambda>x. f' x 0) has_derivative (\\<lambda>_. 0)) (at a within G)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f' x (0::'a)) has_derivative (\\<lambda>_. 0::'b))\n     (at a within G)", "apply (rule has_derivative_transform_within)"], ["proof (prove)\ngoal (4 subgoals):\n 1. (?f has_derivative (\\<lambda>_. 0::'b)) (at a within G)\n 2. 0 < ?d\n 3. a \\<in> G\n 4. \\<And>x'.\n       \\<lbrakk>x' \\<in> G; dist x' a < ?d\\<rbrakk>\n       \\<Longrightarrow> ?f x' = f' x' (0::'a)", "apply (rule has_derivative_const[where c=0])"], ["proof (prove)\ngoal (3 subgoals):\n 1. 0 < ?d\n 2. a \\<in> G\n 3. \\<And>x'.\n       \\<lbrakk>x' \\<in> G; dist x' a < ?d\\<rbrakk>\n       \\<Longrightarrow> (0::'b) = f' x' (0::'a)", "apply (rule zero_less_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. a \\<in> G\n 2. \\<And>x'.\n       \\<lbrakk>x' \\<in> G; dist x' a < 1\\<rbrakk>\n       \\<Longrightarrow> (0::'b) = f' x' (0::'a)", "apply fact"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x'.\n       \\<lbrakk>x' \\<in> G; dist x' a < 1\\<rbrakk>\n       \\<Longrightarrow> (0::'b) = f' x' (0::'a)", "by (simp add: f'z)"], ["proof (state)\nthis:\n  ((\\<lambda>x. f' x (0::'a)) has_derivative (\\<lambda>_. 0::'b))\n   (at a within G)\n\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' i j = f'' j i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "from has_derivative_unique[OF second_fderiv[unfolded aw] this[unfolded aw]]"], ["proof (chain)\npicking this:\n  f'' (0::'a) = (\\<lambda>_. 0::'b)", "have \"f'' 0 = (\\<lambda>_. 0)\""], ["proof (prove)\nusing this:\n  f'' (0::'a) = (\\<lambda>_. 0::'b)\n\ngoal (1 subgoal):\n 1. f'' (0::'a) = (\\<lambda>_. 0::'b)", "."], ["proof (state)\nthis:\n  f'' (0::'a) = (\\<lambda>_. 0::'b)\n\ngoal (2 subgoals):\n 1. i = j \\<or> i = (0::'a) \\<or> j = (0::'a) \\<Longrightarrow>\n    f'' i j = f'' j i\n 2. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "with True z1"], ["proof (chain)\npicking this:\n  i = j \\<or> i = (0::'a) \\<or> j = (0::'a)\n  f'' j (0::'a) = (0::'b)\n  f'' i (0::'a) = (0::'b)\n  f'' (0::'a) = (\\<lambda>_. 0::'b)", "show ?thesis"], ["proof (prove)\nusing this:\n  i = j \\<or> i = (0::'a) \\<or> j = (0::'a)\n  f'' j (0::'a) = (0::'b)\n  f'' i (0::'a) = (0::'b)\n  f'' (0::'a) = (\\<lambda>_. 0::'b)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "by (auto)"], ["proof (state)\nthis:\n  f'' i j = f'' j i\n\ngoal (1 subgoal):\n 1. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "case False"], ["proof (state)\nthis:\n  \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a))\n\ngoal (1 subgoal):\n 1. \\<not> (i = j \\<or> i = (0::'a) \\<or> j = (0::'a)) \\<Longrightarrow>\n    f'' i j = f'' j i", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "using first_fderiv _ _ _ _ assms(1,3-)"], ["proof (prove)\nusing this:\n  ?a \\<in> G \\<Longrightarrow> (f has_derivative f' ?a) (at ?a within G)\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  a \\<in> G\n  \\<lbrakk>?s \\<in> {0..1}; ?t \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> a + ?s *\\<^sub>R i + ?t *\\<^sub>R j \\<in> G\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "by (rule symmetric_second_derivative_aux[])\n       (use False in \\<open>auto intro!: derivative_eq_intros simp: blinfun.bilinear_simps assms\\<close>)"], ["proof (state)\nthis:\n  f'' i j = f'' j i\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "locale second_derivative_on_open =\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n    and f' :: \"'a \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n    and f'' :: \"'a \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n    and a :: 'a\n    and G :: \"'a set\"\n  assumes first_fderiv[derivative_intros]:\n    \"\\<And>a. a \\<in> G \\<Longrightarrow> (f has_derivative f' a) (at a)\"\n  assumes in_G: \"a \\<in> G\" and open_G: \"open G\"\n  assumes second_fderiv[derivative_intros]:\n    \"((\\<lambda>x. f' x i) has_derivative f'' i) (at a)\"\nbegin"], ["", "lemma symmetric_second_derivative:\n  assumes \"a \\<in> G\"\n  shows \"f'' i j = f'' j i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "interpret second_derivative_within'"], ["proof (prove)\ngoal (1 subgoal):\n 1. second_derivative_within' f f' f'' a G", "by unfold_locales\n      (auto intro!: derivative_intros intro: has_derivative_at_withinI \\<open>a \\<in> G\\<close>)"], ["proof (state)\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "from \\<open>a \\<in> G\\<close> open_G"], ["proof (chain)\npicking this:\n  a \\<in> G\n  open G", "obtain e where e: \"e > 0\" \"\\<And>y. dist y a < e \\<Longrightarrow> y \\<in> G\""], ["proof (prove)\nusing this:\n  a \\<in> G\n  open G\n\ngoal (1 subgoal):\n 1. (\\<And>e.\n        \\<lbrakk>0 < e;\n         \\<And>y. dist y a < e \\<Longrightarrow> y \\<in> G\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (force simp: open_dist)"], ["proof (state)\nthis:\n  0 < e\n  dist ?y a < e \\<Longrightarrow> ?y \\<in> G\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "define e' where \"e' = e / 3\""], ["proof (state)\nthis:\n  e' = e / 3\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "define i' j' where \"i' = e' *\\<^sub>R i /\\<^sub>R norm i\" and \"j' = e' *\\<^sub>R j /\\<^sub>R norm j\""], ["proof (state)\nthis:\n  i' = e' *\\<^sub>R i /\\<^sub>R norm i\n  j' = e' *\\<^sub>R j /\\<^sub>R norm j\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "hence \"norm i' \\<le> e'\" \"norm j' \\<le> e'\""], ["proof (prove)\nusing this:\n  i' = e' *\\<^sub>R i /\\<^sub>R norm i\n  j' = e' *\\<^sub>R j /\\<^sub>R norm j\n\ngoal (1 subgoal):\n 1. norm i' \\<le> e' &&& norm j' \\<le> e'", "by (auto simp: field_simps e'_def \\<open>0 < e\\<close> less_imp_le)"], ["proof (state)\nthis:\n  norm i' \\<le> e'\n  norm j' \\<le> e'\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "hence \"\\<bar>s\\<bar> \\<le> 1 \\<Longrightarrow> \\<bar>t\\<bar> \\<le> 1 \\<Longrightarrow> norm (s *\\<^sub>R i' + t *\\<^sub>R j') \\<le> e' + e'\" for s t"], ["proof (prove)\nusing this:\n  norm i' \\<le> e'\n  norm j' \\<le> e'\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>s\\<bar> \\<le> 1; \\<bar>t\\<bar> \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> norm (s *\\<^sub>R i' + t *\\<^sub>R j') \\<le> e' + e'", "by (intro norm_triangle_le[OF add_mono])\n      (auto intro!: order_trans[OF mult_left_le_one_le])"], ["proof (state)\nthis:\n  \\<lbrakk>\\<bar>?s\\<bar> \\<le> 1; \\<bar>?t\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> norm (?s *\\<^sub>R i' + ?t *\\<^sub>R j') \\<le> e' + e'\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "also"], ["proof (state)\nthis:\n  \\<lbrakk>\\<bar>?s\\<bar> \\<le> 1; \\<bar>?t\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> norm (?s *\\<^sub>R i' + ?t *\\<^sub>R j') \\<le> e' + e'\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "have \"\\<dots> < e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e' + e' < e", "by (simp add: e'_def \\<open>0 < e\\<close>)"], ["proof (state)\nthis:\n  e' + e' < e\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<bar>?s1\\<bar> \\<le> 1; \\<bar>?t1\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> norm (?s1 *\\<^sub>R i' + ?t1 *\\<^sub>R j') < e", "have \"f'' i' j' = f'' j' i'\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<bar>?s1\\<bar> \\<le> 1; \\<bar>?t1\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> norm (?s1 *\\<^sub>R i' + ?t1 *\\<^sub>R j') < e\n\ngoal (1 subgoal):\n 1. f'' i' j' = f'' j' i'", "by (intro symmetric_second_derivative_within \\<open>a \\<in> G\\<close> e)\n      (auto simp add: dist_norm open_G)"], ["proof (state)\nthis:\n  f'' i' j' = f'' j' i'\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "moreover"], ["proof (state)\nthis:\n  f'' i' j' = f'' j' i'\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "interpret f'': bounded_linear \"f'' k\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. bounded_linear (f'' k)", "by (rule has_derivative_bounded_linear) (rule second_fderiv)"], ["proof (state)\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "note aw = at_within_open[OF \\<open>a \\<in> G\\<close> \\<open>open G\\<close>]"], ["proof (state)\nthis:\n  at a within G = at a\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "have z1: \"f'' j 0 = 0\" \"f'' i 0 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f'' j (0::'a) = (0::'b) &&& f'' i (0::'a) = (0::'b)", "by (simp_all add: f''.zero)"], ["proof (state)\nthis:\n  f'' j (0::'a) = (0::'b)\n  f'' i (0::'a) = (0::'b)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "have f'z: \"f' x 0 = 0\" if \"x \\<in> G\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. f' x (0::'a) = (0::'b)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f' x (0::'a) = (0::'b)", "interpret bounded_linear \"f' x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bounded_linear (f' x)", "by (rule has_derivative_bounded_linear) (rule first_fderiv that)+"], ["proof (state)\ngoal (1 subgoal):\n 1. f' x (0::'a) = (0::'b)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. f' x (0::'a) = (0::'b)", "by (simp add: zero)"], ["proof (state)\nthis:\n  f' x (0::'a) = (0::'b)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x \\<in> G \\<Longrightarrow> f' ?x (0::'a) = (0::'b)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "have \"((\\<lambda>x. f' x 0) has_derivative (\\<lambda>_. 0)) (at a within G)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f' x (0::'a)) has_derivative (\\<lambda>_. 0::'b))\n     (at a within G)", "apply (rule has_derivative_transform_within)"], ["proof (prove)\ngoal (4 subgoals):\n 1. (?f has_derivative (\\<lambda>_. 0::'b)) (at a within G)\n 2. 0 < ?d\n 3. a \\<in> G\n 4. \\<And>x'.\n       \\<lbrakk>x' \\<in> G; dist x' a < ?d\\<rbrakk>\n       \\<Longrightarrow> ?f x' = f' x' (0::'a)", "apply (rule has_derivative_const[where c=0])"], ["proof (prove)\ngoal (3 subgoals):\n 1. 0 < ?d\n 2. a \\<in> G\n 3. \\<And>x'.\n       \\<lbrakk>x' \\<in> G; dist x' a < ?d\\<rbrakk>\n       \\<Longrightarrow> (0::'b) = f' x' (0::'a)", "apply (rule zero_less_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. a \\<in> G\n 2. \\<And>x'.\n       \\<lbrakk>x' \\<in> G; dist x' a < 1\\<rbrakk>\n       \\<Longrightarrow> (0::'b) = f' x' (0::'a)", "apply fact"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x'.\n       \\<lbrakk>x' \\<in> G; dist x' a < 1\\<rbrakk>\n       \\<Longrightarrow> (0::'b) = f' x' (0::'a)", "by (simp add: f'z)"], ["proof (state)\nthis:\n  ((\\<lambda>x. f' x (0::'a)) has_derivative (\\<lambda>_. 0::'b))\n   (at a within G)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "from has_derivative_unique[OF second_fderiv[unfolded aw] this[unfolded aw]]"], ["proof (chain)\npicking this:\n  f'' (0::'a) = (\\<lambda>_. 0::'b)", "have z2: \"f'' 0 = (\\<lambda>_. 0)\""], ["proof (prove)\nusing this:\n  f'' (0::'a) = (\\<lambda>_. 0::'b)\n\ngoal (1 subgoal):\n 1. f'' (0::'a) = (\\<lambda>_. 0::'b)", "."], ["proof (state)\nthis:\n  f'' (0::'a) = (\\<lambda>_. 0::'b)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "have \"((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative f'' (r *\\<^sub>R x)) (at a within G)\"\n    \"((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative (\\<lambda>y. r *\\<^sub>R f'' x y)) (at a within G)\"\n    for r x"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative f'' (r *\\<^sub>R x))\n     (at a within G) &&&\n    ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a within G)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative f'' (r *\\<^sub>R x))\n     (at a within G)", "by (rule second_fderiv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a within G)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a within G)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a within G)", "have \"((\\<lambda>a. r *\\<^sub>R f' a (x)) has_derivative (\\<lambda>y. r *\\<^sub>R f'' x y)) (at a within G)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>a. r *\\<^sub>R f' a x) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a within G)", "by (auto intro!: derivative_intros)"], ["proof (state)\nthis:\n  ((\\<lambda>a. r *\\<^sub>R f' a x) has_derivative\n   (\\<lambda>y. r *\\<^sub>R f'' x y))\n   (at a within G)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a within G)", "then"], ["proof (chain)\npicking this:\n  ((\\<lambda>a. r *\\<^sub>R f' a x) has_derivative\n   (\\<lambda>y. r *\\<^sub>R f'' x y))\n   (at a within G)", "show ?thesis"], ["proof (prove)\nusing this:\n  ((\\<lambda>a. r *\\<^sub>R f' a x) has_derivative\n   (\\<lambda>y. r *\\<^sub>R f'' x y))\n   (at a within G)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a within G)", "apply (rule has_derivative_transform[rotated 2])"], ["proof (prove)\ngoal (2 subgoals):\n 1. a \\<in> G\n 2. \\<And>xa.\n       xa \\<in> G \\<Longrightarrow>\n       f' xa (r *\\<^sub>R x) = r *\\<^sub>R f' xa x", "apply (rule in_G)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> G \\<Longrightarrow>\n       f' xa (r *\\<^sub>R x) = r *\\<^sub>R f' xa x", "subgoal premises prems for a'"], ["proof (prove)\ngoal (1 subgoal):\n 1. f' a' (r *\\<^sub>R x) = r *\\<^sub>R f' a' x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f' a' (r *\\<^sub>R x) = r *\\<^sub>R f' a' x", "interpret bounded_linear \"f' a'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bounded_linear (f' a')", "apply (rule has_derivative_bounded_linear)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (?f1 has_derivative f' a') ?F1", "by (rule first_fderiv[OF prems])"], ["proof (state)\ngoal (1 subgoal):\n 1. f' a' (r *\\<^sub>R x) = r *\\<^sub>R f' a' x", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. f' a' (r *\\<^sub>R x) = r *\\<^sub>R f' a' x", "by (simp add: scaleR)"], ["proof (state)\nthis:\n  f' a' (r *\\<^sub>R x) = r *\\<^sub>R f' a' x\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n   (\\<lambda>y. r *\\<^sub>R f'' x y))\n   (at a within G)\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   f'' (?r *\\<^sub>R ?x))\n   (at a within G)\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   (\\<lambda>y. ?r *\\<^sub>R f'' ?x y))\n   (at a within G)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "then"], ["proof (chain)\npicking this:\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   f'' (?r *\\<^sub>R ?x))\n   (at a within G)\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   (\\<lambda>y. ?r *\\<^sub>R f'' ?x y))\n   (at a within G)", "have \"((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative f'' (r *\\<^sub>R x)) (at a)\"\n    \"((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative (\\<lambda>y. r *\\<^sub>R f'' x y)) (at a)\" for r x"], ["proof (prove)\nusing this:\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   f'' (?r *\\<^sub>R ?x))\n   (at a within G)\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   (\\<lambda>y. ?r *\\<^sub>R f'' ?x y))\n   (at a within G)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative f'' (r *\\<^sub>R x))\n     (at a) &&&\n    ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a)", "unfolding aw"], ["proof (prove)\nusing this:\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   f'' (?r *\\<^sub>R ?x))\n   (at a)\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   (\\<lambda>y. ?r *\\<^sub>R f'' ?x y))\n   (at a)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative f'' (r *\\<^sub>R x))\n     (at a) &&&\n    ((\\<lambda>a. f' a (r *\\<^sub>R x)) has_derivative\n     (\\<lambda>y. r *\\<^sub>R f'' x y))\n     (at a)", "by auto"], ["proof (state)\nthis:\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   f'' (?r *\\<^sub>R ?x))\n   (at a)\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   (\\<lambda>y. ?r *\\<^sub>R f'' ?x y))\n   (at a)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "then"], ["proof (chain)\npicking this:\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   f'' (?r *\\<^sub>R ?x))\n   (at a)\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   (\\<lambda>y. ?r *\\<^sub>R f'' ?x y))\n   (at a)", "have f'z: \"f'' (r *\\<^sub>R x) = (\\<lambda>y. r *\\<^sub>R f'' x y)\" for r x"], ["proof (prove)\nusing this:\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   f'' (?r *\\<^sub>R ?x))\n   (at a)\n  ((\\<lambda>a. f' a (?r *\\<^sub>R ?x)) has_derivative\n   (\\<lambda>y. ?r *\\<^sub>R f'' ?x y))\n   (at a)\n\ngoal (1 subgoal):\n 1. f'' (r *\\<^sub>R x) = (\\<lambda>y. r *\\<^sub>R f'' x y)", "by (rule has_derivative_unique[where f=\"(\\<lambda>a. f' a (r *\\<^sub>R x))\"])"], ["proof (state)\nthis:\n  f'' (?r *\\<^sub>R ?x) = (\\<lambda>y. ?r *\\<^sub>R f'' ?x y)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "ultimately"], ["proof (chain)\npicking this:\n  f'' i' j' = f'' j' i'\n  f'' (?r *\\<^sub>R ?x) = (\\<lambda>y. ?r *\\<^sub>R f'' ?x y)", "show ?thesis"], ["proof (prove)\nusing this:\n  f'' i' j' = f'' j' i'\n  f'' (?r *\\<^sub>R ?x) = (\\<lambda>y. ?r *\\<^sub>R f'' ?x y)\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "using e(1)"], ["proof (prove)\nusing this:\n  f'' i' j' = f'' j' i'\n  f'' (?r *\\<^sub>R ?x) = (\\<lambda>y. ?r *\\<^sub>R f'' ?x y)\n  0 < e\n\ngoal (1 subgoal):\n 1. f'' i j = f'' j i", "by (auto simp: i'_def j'_def e'_def f''.scaleR z1 z2\n      blinfun.zero_right blinfun.zero_left\n      blinfun.scaleR_left blinfun.scaleR_right algebra_simps)"], ["proof (state)\nthis:\n  f'' i j = f'' j i\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "no_notation\n  blinfun_apply (infixl \"$\" 999)"], ["", "notation vec_nth (infixl \"$\" 90)"], ["", "end"]]}