{"file_name": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations/Library/MVT_Ex.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations", "problem_names": ["lemma MVT_wrong: assumes\n  \"\\<And>J a u (f::real*real\\<Rightarrow>real*real).\n      (\\<And>x. FDERIV f x :> J x) \\<Longrightarrow>\n      (\\<exists>t\\<in>{0<..<1}. f (a + u) - f a = J (a + t *\\<^sub>R u) u)\"\n  shows \"False\"", "lemma MVT_corrected:\n  fixes f::\"'a::ordered_euclidean_space\\<Rightarrow>'b::euclidean_space\"\n  assumes fderiv: \"\\<And>x. x \\<in> D \\<Longrightarrow> (f has_derivative J x) (at x within D)\"\n  assumes line_in: \"\\<And>x. \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk> \\<Longrightarrow> a + x *\\<^sub>R u \\<in> D\"\n  shows \"(\\<exists>t\\<in>Basis\\<rightarrow>{0<..<1}. (f (a + u) - f a) = (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i))\"", "lemma MVT_ivl:\n  fixes f::\"'a::ordered_euclidean_space\\<Rightarrow>'b::ordered_euclidean_space\"\n  assumes fderiv: \"\\<And>x. x \\<in> D \\<Longrightarrow> (f has_derivative J x) (at x within D)\"\n  assumes J_ivl: \"\\<And>x. x \\<in> D \\<Longrightarrow> J x u \\<in> {J0 .. J1}\"\n  assumes line_in: \"\\<And>x. x \\<in> {0..1} \\<Longrightarrow> a + x *\\<^sub>R u \\<in> D\"\n  shows \"f (a + u) - f a \\<in> {J0..J1}\"", "lemma MVT:\n  shows\n  \"\\<And>J J0 J1 a u (f::real*real\\<Rightarrow>real*real).\n    (\\<And>x. FDERIV f x :> J x) \\<Longrightarrow>\n    (\\<And>x. J x u \\<in> {J0 .. J1}) \\<Longrightarrow>\n    f (a + u) - f a \\<in> {J0 .. J1}\"", "lemma MVT_ivl':\n  fixes f::\"'a::ordered_euclidean_space\\<Rightarrow>'b::ordered_euclidean_space\"\n  assumes fderiv: \"(\\<And>x. x \\<in> D \\<Longrightarrow> (f has_derivative J x) (at x within D))\"\n  assumes J_ivl: \"\\<And>x. x \\<in> D \\<Longrightarrow> J x (a - b) \\<in> {J0..J1}\"\n  assumes line_in: \"\\<And>x. x \\<in> {0..1} \\<Longrightarrow> b + x *\\<^sub>R (a - b) \\<in> D\"\n  shows \"f a \\<in> {f b + J0..f b + J1}\""], "translations": [["", "lemma MVT_wrong: assumes\n  \"\\<And>J a u (f::real*real\\<Rightarrow>real*real).\n      (\\<And>x. FDERIV f x :> J x) \\<Longrightarrow>\n      (\\<exists>t\\<in>{0<..<1}. f (a + u) - f a = J (a + t *\\<^sub>R u) u)\"\n  shows \"False\""], ["proof (prove)\ngoal (1 subgoal):\n 1. False", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. False", "have \"\\<And>t::real*real. FDERIV (\\<lambda>t. (cos (fst t), sin (fst t))) t :> (\\<lambda>h. (- ((fst h) * sin (fst t)), (fst h) * cos (fst t)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       ((\\<lambda>t. (cos (fst t), sin (fst t))) has_derivative\n        (\\<lambda>h. (- (fst h * sin (fst t)), fst h * cos (fst t))))\n        (at t)", "by (auto intro!: derivative_eq_intros)"], ["proof (state)\nthis:\n  ((\\<lambda>t. (cos (fst t), sin (fst t))) has_derivative\n   (\\<lambda>h. (- (fst h * sin (fst ?t)), fst h * cos (fst ?t))))\n   (at ?t)\n\ngoal (1 subgoal):\n 1. False", "from assms[OF this, of \"(pi, pi)\" \"(pi, pi)\"]"], ["proof (chain)\npicking this:\n  \\<exists>t\\<in>{0<..<1}.\n     (cos (fst ((pi, pi) + (pi, pi))), sin (fst ((pi, pi) + (pi, pi)))) -\n     (cos (fst (pi, pi)), sin (fst (pi, pi))) =\n     (- (fst (pi, pi) * sin (fst ((pi, pi) + t *\\<^sub>R (pi, pi)))),\n      fst (pi, pi) * cos (fst ((pi, pi) + t *\\<^sub>R (pi, pi))))", "obtain t::real where t: \"0 < t\" \"t < 1\" and\n    \"pi * sin (t * pi) = 2\" \"cos (t * pi) = 0\""], ["proof (prove)\nusing this:\n  \\<exists>t\\<in>{0<..<1}.\n     (cos (fst ((pi, pi) + (pi, pi))), sin (fst ((pi, pi) + (pi, pi)))) -\n     (cos (fst (pi, pi)), sin (fst (pi, pi))) =\n     (- (fst (pi, pi) * sin (fst ((pi, pi) + t *\\<^sub>R (pi, pi)))),\n      fst (pi, pi) * cos (fst ((pi, pi) + t *\\<^sub>R (pi, pi))))\n\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<lbrakk>0 < t; t < 1; pi * sin (t * pi) = 2;\n         cos (t * pi) = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < t\n  t < 1\n  pi * sin (t * pi) = 2\n  cos (t * pi) = 0\n\ngoal (1 subgoal):\n 1. False", "then"], ["proof (chain)\npicking this:\n  0 < t\n  t < 1\n  pi * sin (t * pi) = 2\n  cos (t * pi) = 0", "obtain n where tpi: \"t * pi = real_of_int n * (pi / 2)\" and \"odd n\""], ["proof (prove)\nusing this:\n  0 < t\n  t < 1\n  pi * sin (t * pi) = 2\n  cos (t * pi) = 0\n\ngoal (1 subgoal):\n 1. (\\<And>n.\n        \\<lbrakk>t * pi = real_of_int n * (pi / 2); odd n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: cos_zero_iff_int)"], ["proof (state)\nthis:\n  t * pi = real_of_int n * (pi / 2)\n  odd n\n\ngoal (1 subgoal):\n 1. False", "then"], ["proof (chain)\npicking this:\n  t * pi = real_of_int n * (pi / 2)\n  odd n", "have teq: \"t = real_of_int n / 2\""], ["proof (prove)\nusing this:\n  t * pi = real_of_int n * (pi / 2)\n  odd n\n\ngoal (1 subgoal):\n 1. t = real_of_int n / 2", "by auto"], ["proof (state)\nthis:\n  t = real_of_int n / 2\n\ngoal (1 subgoal):\n 1. False", "then"], ["proof (chain)\npicking this:\n  t = real_of_int n / 2", "have \"n = 1\""], ["proof (prove)\nusing this:\n  t = real_of_int n / 2\n\ngoal (1 subgoal):\n 1. n = 1", "using t \\<open>odd n\\<close>"], ["proof (prove)\nusing this:\n  t = real_of_int n / 2\n  0 < t\n  t < 1\n  odd n\n\ngoal (1 subgoal):\n 1. n = 1", "by arith"], ["proof (state)\nthis:\n  n = 1\n\ngoal (1 subgoal):\n 1. False", "then"], ["proof (chain)\npicking this:\n  n = 1", "have \"t = 1/2\""], ["proof (prove)\nusing this:\n  n = 1\n\ngoal (1 subgoal):\n 1. t = 1 / 2", "using teq"], ["proof (prove)\nusing this:\n  n = 1\n  t = real_of_int n / 2\n\ngoal (1 subgoal):\n 1. t = 1 / 2", "by simp"], ["proof (state)\nthis:\n  t = 1 / 2\n\ngoal (1 subgoal):\n 1. False", "have \"sin (t * pi) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sin (t * pi) = 1", "by (simp add: \\<open>t = 1/2\\<close> sin_eq_1)"], ["proof (state)\nthis:\n  sin (t * pi) = 1\n\ngoal (1 subgoal):\n 1. False", "with \\<open>pi * sin (t * pi) = 2\\<close>"], ["proof (chain)\npicking this:\n  pi * sin (t * pi) = 2\n  sin (t * pi) = 1", "have \"pi = 2\""], ["proof (prove)\nusing this:\n  pi * sin (t * pi) = 2\n  sin (t * pi) = 1\n\ngoal (1 subgoal):\n 1. pi = 2", "by simp"], ["proof (state)\nthis:\n  pi = 2\n\ngoal (1 subgoal):\n 1. False", "moreover"], ["proof (state)\nthis:\n  pi = 2\n\ngoal (1 subgoal):\n 1. False", "have \"pi > 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 < pi", "using pi_approx"], ["proof (prove)\nusing this:\n  3141592653588 / 10 ^ 12 \\<le> pi\n  pi \\<le> 31415926535899 / 10 ^ 13\n\ngoal (1 subgoal):\n 1. 2 < pi", "by simp"], ["proof (state)\nthis:\n  2 < pi\n\ngoal (1 subgoal):\n 1. False", "ultimately"], ["proof (chain)\npicking this:\n  pi = 2\n  2 < pi", "show False"], ["proof (prove)\nusing this:\n  pi = 2\n  2 < pi\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma MVT_corrected:\n  fixes f::\"'a::ordered_euclidean_space\\<Rightarrow>'b::euclidean_space\"\n  assumes fderiv: \"\\<And>x. x \\<in> D \\<Longrightarrow> (f has_derivative J x) (at x within D)\"\n  assumes line_in: \"\\<And>x. \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk> \\<Longrightarrow> a + x *\\<^sub>R u \\<in> D\"\n  shows \"(\\<exists>t\\<in>Basis\\<rightarrow>{0<..<1}. (f (a + u) - f a) = (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "fix i::'b"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "assume \"i \\<in> Basis\""], ["proof (state)\nthis:\n  i \\<in> Basis\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "have subset: \"((\\<lambda>x. a + x *\\<^sub>R u) ` {0..1}) \\<subseteq> D\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. a + x *\\<^sub>R u) ` {0..1} \\<subseteq> D", "using line_in"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?x; ?x \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> a + ?x *\\<^sub>R u \\<in> D\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. a + x *\\<^sub>R u) ` {0..1} \\<subseteq> D", "by force"], ["proof (state)\nthis:\n  (\\<lambda>x. a + x *\\<^sub>R u) ` {0..1} \\<subseteq> D\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "have \"\\<And>x. \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk> \\<Longrightarrow> ((\\<lambda>b. f (a + b *\\<^sub>R u) \\<bullet> i) has_derivative (\\<lambda>b. b *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet> i)) (at x within {0..1})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>b.\n                              f (a + b *\\<^sub>R u) \\<bullet>\n                              i) has_derivative\n                          (\\<lambda>b.\n                              b *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet>\n                              i))\n                          (at x within {0..1})", "using line_in"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?x; ?x \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> a + ?x *\\<^sub>R u \\<in> D\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> ((\\<lambda>b.\n                              f (a + b *\\<^sub>R u) \\<bullet>\n                              i) has_derivative\n                          (\\<lambda>b.\n                              b *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet>\n                              i))\n                          (at x within {0..1})", "by (auto intro!: derivative_eq_intros\n        has_derivative_subset[OF _ subset]\n        has_derivative_in_compose[where f=\"\\<lambda>x. a + x *\\<^sub>R u\"]\n        fderiv line_in\n        simp add: linear.scaleR[OF has_derivative_linear[OF fderiv]])"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?x; ?x \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>b.\n                         f (a + b *\\<^sub>R u) \\<bullet> i) has_derivative\n                     (\\<lambda>b.\n                         b *\\<^sub>R J (a + ?x *\\<^sub>R u) u \\<bullet> i))\n                     (at ?x within {0..1})\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "with zero_less_one"], ["proof (chain)\npicking this:\n  (0::?'a) < (1::?'a)\n  \\<lbrakk>0 \\<le> ?x; ?x \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>b.\n                         f (a + b *\\<^sub>R u) \\<bullet> i) has_derivative\n                     (\\<lambda>b.\n                         b *\\<^sub>R J (a + ?x *\\<^sub>R u) u \\<bullet> i))\n                     (at ?x within {0..1})", "have \"\\<exists>x\\<in>{0<..<1}. f (a + 1 *\\<^sub>R u) \\<bullet> i - f (a + 0 *\\<^sub>R u) \\<bullet> i = (1 - 0) *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet> i\""], ["proof (prove)\nusing this:\n  (0::?'a) < (1::?'a)\n  \\<lbrakk>0 \\<le> ?x; ?x \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>b.\n                         f (a + b *\\<^sub>R u) \\<bullet> i) has_derivative\n                     (\\<lambda>b.\n                         b *\\<^sub>R J (a + ?x *\\<^sub>R u) u \\<bullet> i))\n                     (at ?x within {0..1})\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>{0<..<1}.\n       f (a + 1 *\\<^sub>R u) \\<bullet> i -\n       f (a + 0 *\\<^sub>R u) \\<bullet> i =\n       (1 - 0) *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet> i", "by (rule mvt_simple)"], ["proof (state)\nthis:\n  \\<exists>x\\<in>{0<..<1}.\n     f (a + 1 *\\<^sub>R u) \\<bullet> i - f (a + 0 *\\<^sub>R u) \\<bullet> i =\n     (1 - 0) *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet> i\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "}"], ["proof (state)\nthis:\n  ?i2 \\<in> Basis \\<Longrightarrow>\n  \\<exists>x\\<in>{0<..<1}.\n     f (a + 1 *\\<^sub>R u) \\<bullet> ?i2 -\n     f (a + 0 *\\<^sub>R u) \\<bullet> ?i2 =\n     (1 - 0) *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet> ?i2\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "then"], ["proof (chain)\npicking this:\n  ?i2 \\<in> Basis \\<Longrightarrow>\n  \\<exists>x\\<in>{0<..<1}.\n     f (a + 1 *\\<^sub>R u) \\<bullet> ?i2 -\n     f (a + 0 *\\<^sub>R u) \\<bullet> ?i2 =\n     (1 - 0) *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet> ?i2", "obtain t where \"\\<forall>i\\<in>Basis. t i \\<in> {0<..<1} \\<and> f (a + u) \\<bullet> i - f a \\<bullet> i = J (a + t i *\\<^sub>R u) u \\<bullet> i\""], ["proof (prove)\nusing this:\n  ?i2 \\<in> Basis \\<Longrightarrow>\n  \\<exists>x\\<in>{0<..<1}.\n     f (a + 1 *\\<^sub>R u) \\<bullet> ?i2 -\n     f (a + 0 *\\<^sub>R u) \\<bullet> ?i2 =\n     (1 - 0) *\\<^sub>R J (a + x *\\<^sub>R u) u \\<bullet> ?i2\n\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<forall>i\\<in>Basis.\n           t i \\<in> {0<..<1} \\<and>\n           f (a + u) \\<bullet> i - f a \\<bullet> i =\n           J (a + t i *\\<^sub>R u) u \\<bullet> i \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by atomize_elim (force intro!: bchoice)"], ["proof (state)\nthis:\n  \\<forall>i\\<in>Basis.\n     t i \\<in> {0<..<1} \\<and>\n     f (a + u) \\<bullet> i - f a \\<bullet> i =\n     J (a + t i *\\<^sub>R u) u \\<bullet> i\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "hence \"t \\<in> Basis \\<rightarrow> {0<..<1}\" \"\\<And>i. i \\<in> Basis \\<Longrightarrow> (f (a + u) - f a) \\<bullet> i = J (a + t i *\\<^sub>R u) u \\<bullet> i\""], ["proof (prove)\nusing this:\n  \\<forall>i\\<in>Basis.\n     t i \\<in> {0<..<1} \\<and>\n     f (a + u) \\<bullet> i - f a \\<bullet> i =\n     J (a + t i *\\<^sub>R u) u \\<bullet> i\n\ngoal (1 subgoal):\n 1. t \\<in> Basis \\<rightarrow> {0<..<1} &&&\n    (\\<And>i.\n        i \\<in> Basis \\<Longrightarrow>\n        (f (a + u) - f a) \\<bullet> i =\n        J (a + t i *\\<^sub>R u) u \\<bullet> i)", "by (auto simp: inner_diff_left)"], ["proof (state)\nthis:\n  t \\<in> Basis \\<rightarrow> {0<..<1}\n  ?i \\<in> Basis \\<Longrightarrow>\n  (f (a + u) - f a) \\<bullet> ?i = J (a + t ?i *\\<^sub>R u) u \\<bullet> ?i\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "moreover"], ["proof (state)\nthis:\n  t \\<in> Basis \\<rightarrow> {0<..<1}\n  ?i \\<in> Basis \\<Longrightarrow>\n  (f (a + u) - f a) \\<bullet> ?i = J (a + t ?i *\\<^sub>R u) u \\<bullet> ?i\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "hence \"(f (a + u) - f a) = (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\""], ["proof (prove)\nusing this:\n  t \\<in> Basis \\<rightarrow> {0<..<1}\n  ?i \\<in> Basis \\<Longrightarrow>\n  (f (a + u) - f a) \\<bullet> ?i = J (a + t ?i *\\<^sub>R u) u \\<bullet> ?i\n\ngoal (1 subgoal):\n 1. f (a + u) - f a =\n    (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "by (intro euclidean_eqI[where 'a='b]) simp"], ["proof (state)\nthis:\n  f (a + u) - f a =\n  (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "ultimately"], ["proof (chain)\npicking this:\n  t \\<in> Basis \\<rightarrow> {0<..<1}\n  ?i \\<in> Basis \\<Longrightarrow>\n  (f (a + u) - f a) \\<bullet> ?i = J (a + t ?i *\\<^sub>R u) u \\<bullet> ?i\n  f (a + u) - f a =\n  (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "show ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> Basis \\<rightarrow> {0<..<1}\n  ?i \\<in> Basis \\<Longrightarrow>\n  (f (a + u) - f a) \\<bullet> ?i = J (a + t ?i *\\<^sub>R u) u \\<bullet> ?i\n  f (a + u) - f a =\n  (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n\ngoal (1 subgoal):\n 1. \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n       f (a + u) - f a =\n       (\\<Sum>i\\<in>Basis.\n          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)", "by blast"], ["proof (state)\nthis:\n  \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n     f (a + u) - f a =\n     (\\<Sum>i\\<in>Basis.\n        (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma MVT_ivl:\n  fixes f::\"'a::ordered_euclidean_space\\<Rightarrow>'b::ordered_euclidean_space\"\n  assumes fderiv: \"\\<And>x. x \\<in> D \\<Longrightarrow> (f has_derivative J x) (at x within D)\"\n  assumes J_ivl: \"\\<And>x. x \\<in> D \\<Longrightarrow> J x u \\<in> {J0 .. J1}\"\n  assumes line_in: \"\\<And>x. x \\<in> {0..1} \\<Longrightarrow> a + x *\\<^sub>R u \\<in> D\"\n  shows \"f (a + u) - f a \\<in> {J0..J1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (a + u) - f a \\<in> {J0..J1}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f (a + u) - f a \\<in> {J0..J1}", "from MVT_corrected[OF fderiv line_in]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x. x \\<in> D \\<Longrightarrow> x \\<in> D;\n   \\<And>x.\n      \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk>\n      \\<Longrightarrow> x \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n                       f (a + u) - f a =\n                       (\\<Sum>i\\<in>Basis.\n                          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R\n                          i)", "obtain t where\n    t: \"t\\<in>Basis \\<rightarrow> {0<..<1}\" and\n    mvt: \"f (a + u) - f a = (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x. x \\<in> D \\<Longrightarrow> x \\<in> D;\n   \\<And>x.\n      \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk>\n      \\<Longrightarrow> x \\<in> {0..1}\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t\\<in>Basis \\<rightarrow> {0<..<1}.\n                       f (a + u) - f a =\n                       (\\<Sum>i\\<in>Basis.\n                          (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R\n                          i)\n\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<lbrakk>t \\<in> Basis \\<rightarrow> {0<..<1};\n         f (a + u) - f a =\n         (\\<Sum>i\\<in>Basis.\n            (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  t \\<in> Basis \\<rightarrow> {0<..<1}\n  f (a + u) - f a =\n  (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n\ngoal (1 subgoal):\n 1. f (a + u) - f a \\<in> {J0..J1}", "note mvt"], ["proof (state)\nthis:\n  f (a + u) - f a =\n  (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n\ngoal (1 subgoal):\n 1. f (a + u) - f a \\<in> {J0..J1}", "also"], ["proof (state)\nthis:\n  f (a + u) - f a =\n  (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n\ngoal (1 subgoal):\n 1. f (a + u) - f a \\<in> {J0..J1}", "have \"\\<dots> \\<in> {J0 .. J1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n    \\<in> {J0..J1}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n    \\<in> {J0..J1}", "have J: \"\\<And>i. i \\<in> Basis \\<Longrightarrow> J0 \\<le> J (a + t i *\\<^sub>R u) u\"\n            \"\\<And>i. i \\<in> Basis \\<Longrightarrow> J (a + t i *\\<^sub>R u) u \\<le> J1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>i.\n        i \\<in> Basis \\<Longrightarrow>\n        J0 \\<le> J (a + t i *\\<^sub>R u) u) &&&\n    (\\<And>i.\n        i \\<in> Basis \\<Longrightarrow> J (a + t i *\\<^sub>R u) u \\<le> J1)", "using J_ivl t line_in"], ["proof (prove)\nusing this:\n  ?x \\<in> D \\<Longrightarrow> J ?x u \\<in> {J0..J1}\n  t \\<in> Basis \\<rightarrow> {0<..<1}\n  ?x \\<in> {0..1} \\<Longrightarrow> a + ?x *\\<^sub>R u \\<in> D\n\ngoal (1 subgoal):\n 1. (\\<And>i.\n        i \\<in> Basis \\<Longrightarrow>\n        J0 \\<le> J (a + t i *\\<^sub>R u) u) &&&\n    (\\<And>i.\n        i \\<in> Basis \\<Longrightarrow> J (a + t i *\\<^sub>R u) u \\<le> J1)", "by (auto simp: Pi_iff)"], ["proof (state)\nthis:\n  ?i \\<in> Basis \\<Longrightarrow> J0 \\<le> J (a + t ?i *\\<^sub>R u) u\n  ?i \\<in> Basis \\<Longrightarrow> J (a + t ?i *\\<^sub>R u) u \\<le> J1\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n    \\<in> {J0..J1}", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n    \\<in> {J0..J1}", "using J"], ["proof (prove)\nusing this:\n  ?i \\<in> Basis \\<Longrightarrow> J0 \\<le> J (a + t ?i *\\<^sub>R u) u\n  ?i \\<in> Basis \\<Longrightarrow> J (a + t ?i *\\<^sub>R u) u \\<le> J1\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n    \\<in> {J0..J1}", "unfolding atLeastAtMost_iff eucl_le[where 'a='b]"], ["proof (prove)\nusing this:\n  ?i \\<in> Basis \\<Longrightarrow>\n  \\<forall>i\\<in>Basis.\n     J0 \\<bullet> i \\<le> J (a + t ?i *\\<^sub>R u) u \\<bullet> i\n  ?i \\<in> Basis \\<Longrightarrow>\n  \\<forall>i\\<in>Basis.\n     J (a + t ?i *\\<^sub>R u) u \\<bullet> i \\<le> J1 \\<bullet> i\n\ngoal (1 subgoal):\n 1. (\\<forall>i\\<in>Basis.\n        J0 \\<bullet> i\n        \\<le> (\\<Sum>i\\<in>Basis.\n                 (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R\n                 i) \\<bullet>\n              i) \\<and>\n    (\\<forall>i\\<in>Basis.\n        (\\<Sum>i\\<in>Basis.\n           (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i) \\<bullet>\n        i\n        \\<le> J1 \\<bullet> i)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n  \\<in> {J0..J1}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>Basis. (J (a + t i *\\<^sub>R u) u \\<bullet> i) *\\<^sub>R i)\n  \\<in> {J0..J1}\n\ngoal (1 subgoal):\n 1. f (a + u) - f a \\<in> {J0..J1}", "finally"], ["proof (chain)\npicking this:\n  f (a + u) - f a \\<in> {J0..J1}", "show ?thesis"], ["proof (prove)\nusing this:\n  f (a + u) - f a \\<in> {J0..J1}\n\ngoal (1 subgoal):\n 1. f (a + u) - f a \\<in> {J0..J1}", "."], ["proof (state)\nthis:\n  f (a + u) - f a \\<in> {J0..J1}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma MVT:\n  shows\n  \"\\<And>J J0 J1 a u (f::real*real\\<Rightarrow>real*real).\n    (\\<And>x. FDERIV f x :> J x) \\<Longrightarrow>\n    (\\<And>x. J x u \\<in> {J0 .. J1}) \\<Longrightarrow>\n    f (a + u) - f a \\<in> {J0 .. J1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>J J0 J1 a u f.\n       \\<lbrakk>\\<And>x. (f has_derivative J x) (at x);\n        \\<And>x. J x u \\<in> {J0..J1}\\<rbrakk>\n       \\<Longrightarrow> f (a + u) - f a \\<in> {J0..J1}", "by (rule_tac J = J in MVT_ivl[where D=UNIV]) auto"], ["", "lemma MVT_ivl':\n  fixes f::\"'a::ordered_euclidean_space\\<Rightarrow>'b::ordered_euclidean_space\"\n  assumes fderiv: \"(\\<And>x. x \\<in> D \\<Longrightarrow> (f has_derivative J x) (at x within D))\"\n  assumes J_ivl: \"\\<And>x. x \\<in> D \\<Longrightarrow> J x (a - b) \\<in> {J0..J1}\"\n  assumes line_in: \"\\<And>x. x \\<in> {0..1} \\<Longrightarrow> b + x *\\<^sub>R (a - b) \\<in> D\"\n  shows \"f a \\<in> {f b + J0..f b + J1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f a \\<in> {f b + J0..f b + J1}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f a \\<in> {f b + J0..f b + J1}", "have \"f (b + (a - b)) - f b \\<in> {J0 .. J1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (b + (a - b)) - f b \\<in> {J0..J1}", "using J_ivl MVT_ivl fderiv line_in"], ["proof (prove)\nusing this:\n  ?x \\<in> D \\<Longrightarrow> J ?x (a - b) \\<in> {J0..J1}\n  \\<lbrakk>\\<And>x.\n              x \\<in> ?D \\<Longrightarrow>\n              (?f has_derivative ?J x) (at x within ?D);\n   \\<And>x. x \\<in> ?D \\<Longrightarrow> ?J x ?u \\<in> {?J0.0..?J1.0};\n   \\<And>x.\n      x \\<in> {0..1} \\<Longrightarrow> ?a + x *\\<^sub>R ?u \\<in> ?D\\<rbrakk>\n  \\<Longrightarrow> ?f (?a + ?u) - ?f ?a \\<in> {?J0.0..?J1.0}\n  ?x \\<in> D \\<Longrightarrow> (f has_derivative J ?x) (at ?x within D)\n  ?x \\<in> {0..1} \\<Longrightarrow> b + ?x *\\<^sub>R (a - b) \\<in> D\n\ngoal (1 subgoal):\n 1. f (b + (a - b)) - f b \\<in> {J0..J1}", "by blast"], ["proof (state)\nthis:\n  f (b + (a - b)) - f b \\<in> {J0..J1}\n\ngoal (1 subgoal):\n 1. f a \\<in> {f b + J0..f b + J1}", "thus ?thesis"], ["proof (prove)\nusing this:\n  f (b + (a - b)) - f b \\<in> {J0..J1}\n\ngoal (1 subgoal):\n 1. f a \\<in> {f b + J0..f b + J1}", "by (auto simp: diff_le_eq le_diff_eq ac_simps)"], ["proof (state)\nthis:\n  f a \\<in> {f b + J0..f b + J1}\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}