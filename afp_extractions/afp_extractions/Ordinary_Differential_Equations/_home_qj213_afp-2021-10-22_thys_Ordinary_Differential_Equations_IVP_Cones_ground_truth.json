{"file_name": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations/IVP/Cones.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations", "problem_names": ["lemma arcsin_eq_zero_iff[simp]: \"-1 \\<le> x \\<Longrightarrow> x \\<le> 1 \\<Longrightarrow> arcsin x = 0 \\<longleftrightarrow> x = 0\"", "lemma\n  bounded_linear_image_conemem:\n  assumes \"bounded_linear F\"\n  shows \"F (conemem u v t) = conemem (F u) (F v) t\"", "lemma\n  bounded_linear_image_conesegment:\n  assumes \"bounded_linear F\"\n  shows \"F ` conesegment u v = conesegment (F u) (F v)\"", "lemma discriminant: \"a * x\\<^sup>2 + b * x + c = (0::real) \\<Longrightarrow> 0 \\<le> b\\<^sup>2 - 4 * a * c\"", "lemma quadratic_eq_factoring:\n  assumes D: \"D = b\\<^sup>2 - 4 * a * c\"\n  assumes nn: \"0 \\<le> D\"\n  assumes x1: \"x\\<^sub>1 = (-b + sqrt D) / (2 * a)\"\n  assumes x2: \"x\\<^sub>2 = (-b - sqrt D) / (2 * a)\"\n  assumes a: \"a \\<noteq> 0\"\n  shows \"a * x\\<^sup>2 + b * x + c = a * (x - x\\<^sub>1) * (x - x\\<^sub>2)\"", "lemma quadratic_eq_zeroes_iff:\n  assumes D: \"D = b\\<^sup>2 - 4 * a * c\"\n  assumes x1: \"x\\<^sub>1 = (-b + sqrt D) / (2 * a)\"\n  assumes x2: \"x\\<^sub>2 = (-b - sqrt D) / (2 * a)\"\n  assumes a: \"a \\<noteq> 0\"\n  shows \"a * x\\<^sup>2 + b * x + c = 0 \\<longleftrightarrow> (D \\<ge> 0 \\<and> (x = x\\<^sub>1 \\<or> x = x\\<^sub>2))\" (is \"?z \\<longleftrightarrow> _\")", "lemma quadratic_ex_zero_iff:\n  \"(\\<exists>x. a * x\\<^sup>2 + b * x + c = 0) \\<longleftrightarrow> (a \\<noteq> 0 \\<and> b\\<^sup>2 - 4 * a * c \\<ge> 0 \\<or> a = 0 \\<and> (b = 0 \\<longrightarrow> c = 0))\"\n  for a b c::real", "lemma Cauchy_Schwarz_eq_iff:\n  shows \"(inner x y)\\<^sup>2 = inner x x * inner y y \\<longleftrightarrow> ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = 0)\"", "lemma Cauchy_Schwarz_strict_ineq:\n  \"(inner x y)\\<^sup>2 < inner x x * inner y y\" if \"y \\<noteq> 0\" \"\\<And>k. x \\<noteq> k *\\<^sub>R y\"", "lemma Cauchy_Schwarz_eq2_iff:\n  \"\\<bar>inner x y\\<bar> = norm x * norm y \\<longleftrightarrow> ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = 0)\"", "lemma Cauchy_Schwarz_strict_ineq2:\n  \"\\<bar>inner x y\\<bar> < norm x * norm y\" if \"y \\<noteq> 0\" \"\\<And>k. x \\<noteq> k *\\<^sub>R y\"", "lemma gt_minus_one_absI: \"abs k < 1 \\<Longrightarrow> - 1 < k\" for k::real", "lemma gt_one_absI: \"abs k < 1 \\<Longrightarrow> k < 1\" for k::real", "lemma abs_impossible:\n  \"\\<bar>y1\\<bar> < x1 \\<Longrightarrow> \\<bar>y2\\<bar> < x2 \\<Longrightarrow> x1 * x2 + y1 * y2 \\<noteq> 0\" for x1 x2::real", "lemma vangle_eq_arctan_minus:\\<comment> \\<open>TODO: generalize?!\\<close>\n  assumes ij: \"i \\<in> Basis\" \"j \\<in> Basis\" and ij_neq: \"i \\<noteq> j\"\n  assumes xy1: \"\\<bar>y1\\<bar> < x1\"\n  assumes xy2: \"\\<bar>y2\\<bar> < x2\"\n  assumes less: \"y2 / x2 > y1 / x1\"\n  shows \"vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j) (x2 *\\<^sub>R i + y2 *\\<^sub>R j) = arctan (y2 / x2) - arctan (y1 / x1)\"\n    (is \"vangle ?u ?v = _\")", "lemma vangle_le_pi2: \"0 \\<le> u \\<bullet> v \\<Longrightarrow> vangle u v \\<le> pi/2\"", "lemma inner_eq_vangle: \"u \\<bullet> v = cos (vangle u v) * (norm u * norm v)\"", "lemma vangle_scaleR_self:\n  \"vangle (k *\\<^sub>R v) v = (if k = 0 \\<or> v = 0 then pi / 2 else if k > 0 then 0 else pi)\"\n  \"vangle v (k *\\<^sub>R v) = (if k = 0 \\<or> v = 0 then pi / 2 else if k > 0 then 0 else pi)\"", "lemma vangle_scaleR:\n  \"vangle (k *\\<^sub>R v) w = vangle v w\" \"vangle w (k *\\<^sub>R v) = vangle w v\" if \"k > 0\"", "lemma cos_vangle_eq_zero_iff_vangle:\n  \"cos (vangle u v) = 0 \\<longleftrightarrow> (u = 0 \\<or> v = 0 \\<or> u \\<bullet> v = 0)\"", "lemma ortho_imp_angle_pi_half: \"u \\<bullet> v = 0 \\<Longrightarrow> vangle u v = pi / 2\"", "lemma arccos_eq_zero_iff: \"arccos x = 0 \\<longleftrightarrow> x = 1\" if \"-1 \\<le> x\" \"x \\<le> 1\"", "lemma vangle_eq_zeroD: \"vangle u v = 0 \\<Longrightarrow> (\\<exists>k. v = k *\\<^sub>R u)\"", "lemma less_one_multI:\\<comment> \\<open>TODO: also in AA!\\<close>\n  fixes e x::real\n  shows \"e \\<le> 1 \\<Longrightarrow> 0 < x \\<Longrightarrow> x < 1 \\<Longrightarrow> e * x < 1\"", "lemma conemem_expansion_estimate:\n  fixes u v u' v'::\"'a::euclidean_space\"\n  assumes \"t \\<in> {0 .. pi / 2}\"\n  assumes angle_pos: \"0 < vangle u v\" \"vangle u v < pi / 2\"\n  assumes angle_le: \"(vangle u' v') \\<le> (vangle u v)\"\n  assumes \"norm u = 1\" \"norm v = 1\"\n  shows \"norm (conemem u' v' t) \\<ge> min (norm u') (norm v') * norm (conemem u v t)\"", "lemma conemem_commute: \"conemem a b t = conemem b a (pi / 2 - t)\" if \"0 \\<le> t\" \"t \\<le> pi / 2\"", "lemma conesegment_commute: \"conesegment a b = conesegment b a\"", "lemma conefield_alt_def: \"conefield u v = cone hull {u--v}\"", "lemma\n  bounded_linear_image_cone_hull:\n  assumes \"bounded_linear F\"\n  shows \"F ` (cone hull T) = cone hull (F ` T)\"", "lemma\n  bounded_linear_image_conefield:\n  assumes \"bounded_linear F\"\n  shows \"F ` conefield u v = conefield (F u) (F v)\"", "lemma conefield_commute: \"conefield x y = conefield y x\"", "lemma convex_conefield: \"convex (conefield x y)\"", "lemma conefield_scaleRI: \"v \\<in> conefield (r *\\<^sub>R x) y\" if \"v \\<in> conefield x y\" \"r > 0\"", "lemma conefield_scaleRD: \"v \\<in> conefield x y\" if \"v \\<in> conefield (r *\\<^sub>R x) y\" \"r > 0\"", "lemma conefield_scaleR: \"conefield (r *\\<^sub>R x) y = conefield x y\" if \"r > 0\"", "lemma conefield_expansion_estimate:\n  fixes u v::\"'a::euclidean_space\" and F::\"'a \\<Rightarrow> 'a\"\n  assumes \"t \\<in> {0 .. pi / 2}\"\n  assumes angle_pos: \"0 < vangle u v\" \"vangle u v < pi / 2\"\n  assumes angle_le: \"vangle (F u) (F v) \\<le> vangle u v\"\n  assumes \"bounded_linear F\"\n  assumes \"x \\<in> conefield u v\"\n  shows \"norm (F x) \\<ge> min (norm (F u)/norm u) (norm (F v)/norm v) * norm x\"", "lemma conefield_rightI:\n  assumes ij: \"i \\<in> Basis\" \"j \\<in> Basis\" and ij_neq: \"i \\<noteq> j\"\n  assumes \"y \\<in> {y1 .. y2}\"\n  shows \"(i + y *\\<^sub>R j) \\<in> conefield (i + y1 *\\<^sub>R j) (i + y2 *\\<^sub>R j)\"", "lemma conefield_right_vangleI:\n  assumes ij: \"i \\<in> Basis\" \"j \\<in> Basis\" and ij_neq: \"i \\<noteq> j\"\n  assumes \"y \\<in> {y1 .. y2}\" \"y1 < y2\"\n  shows \"(i + y *\\<^sub>R j) \\<in> conefield (i + y1 *\\<^sub>R j) (i + y2 *\\<^sub>R j)\"", "lemma cone_conefield[intro, simp]: \"cone (conefield x y)\"", "lemma conefield_mk_rightI:\n  assumes ij: \"i \\<in> Basis\" \"j \\<in> Basis\" and ij_neq: \"i \\<noteq> j\"\n  assumes \"(i + (y / x) *\\<^sub>R j) \\<in> conefield (i + (y1 / x1) *\\<^sub>R j) (i + (y2 / x2) *\\<^sub>R j)\"\n  assumes \"x > 0\" \"x1 > 0\" \"x2 > 0\"\n  shows \"(x *\\<^sub>R i + y *\\<^sub>R j) \\<in> conefield (x1 *\\<^sub>R i + y1 *\\<^sub>R j) (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\"", "lemma conefield_prod3I:\n  assumes \"x > 0\" \"x1 > 0\" \"x2 > 0\"\n  assumes \"y1 / x1 \\<le> y / x\" \"y / x \\<le> y2 / x2\"\n  shows \"(x, y, 0) \\<in> (conefield (x1, y1, 0) (x2, y2, 0)::(real*real*real) set)\""], "translations": [["", "lemma arcsin_eq_zero_iff[simp]: \"-1 \\<le> x \\<Longrightarrow> x \\<le> 1 \\<Longrightarrow> arcsin x = 0 \\<longleftrightarrow> x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>- 1 \\<le> x; x \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> (arcsin x = 0) = (x = 0)", "using sin_arcsin"], ["proof (prove)\nusing this:\n  \\<lbrakk>- 1 \\<le> ?y; ?y \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> sin (arcsin ?y) = ?y\n\ngoal (1 subgoal):\n 1. \\<lbrakk>- 1 \\<le> x; x \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> (arcsin x = 0) = (x = 0)", "by fastforce"], ["", "definition conemem :: \"'a::real_vector \\<Rightarrow> 'a \\<Rightarrow> real \\<Rightarrow> 'a\" where \"conemem u v t = cos t *\\<^sub>R u + sin t *\\<^sub>R v\""], ["", "definition \"conesegment u v = conemem u v ` {0.. pi / 2}\""], ["", "lemma\n  bounded_linear_image_conemem:\n  assumes \"bounded_linear F\"\n  shows \"F (conemem u v t) = conemem (F u) (F v) t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (conemem u v t) = conemem (F u) (F v) t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F (conemem u v t) = conemem (F u) (F v) t", "from assms"], ["proof (chain)\npicking this:\n  bounded_linear F", "interpret bounded_linear F"], ["proof (prove)\nusing this:\n  bounded_linear F\n\ngoal (1 subgoal):\n 1. bounded_linear F", "."], ["proof (state)\ngoal (1 subgoal):\n 1. F (conemem u v t) = conemem (F u) (F v) t", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. F (conemem u v t) = conemem (F u) (F v) t", "by (auto simp: conemem_def[abs_def] cone_hull_expl closed_segment_def add scaleR)"], ["proof (state)\nthis:\n  F (conemem u v t) = conemem (F u) (F v) t\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma\n  bounded_linear_image_conesegment:\n  assumes \"bounded_linear F\"\n  shows \"F ` conesegment u v = conesegment (F u) (F v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F ` conesegment u v = conesegment (F u) (F v)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F ` conesegment u v = conesegment (F u) (F v)", "from assms"], ["proof (chain)\npicking this:\n  bounded_linear F", "interpret bounded_linear F"], ["proof (prove)\nusing this:\n  bounded_linear F\n\ngoal (1 subgoal):\n 1. bounded_linear F", "."], ["proof (state)\ngoal (1 subgoal):\n 1. F ` conesegment u v = conesegment (F u) (F v)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. F ` conesegment u v = conesegment (F u) (F v)", "apply (auto simp: conesegment_def conemem_def[abs_def] cone_hull_expl closed_segment_def add scaleR)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> cos xa *\\<^sub>R F u + sin xa *\\<^sub>R F v\n                         \\<in> F `\n                               (\\<lambda>x.\n                                   cos x *\\<^sub>R u + sin x *\\<^sub>R v) `\n                               {0..pi / 2}", "apply (auto simp: add[symmetric] scaleR[symmetric])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  F ` conesegment u v = conesegment (F u) (F v)\n\ngoal:\nNo subgoals!", "qed"], ["", "(* This is vangle in $AFP/Triangles/Angles *)"], ["", "lemma discriminant: \"a * x\\<^sup>2 + b * x + c = (0::real) \\<Longrightarrow> 0 \\<le> b\\<^sup>2 - 4 * a * c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a * x\\<^sup>2 + b * x + c = 0 \\<Longrightarrow>\n    0 \\<le> b\\<^sup>2 - 4 * a * c", "by (sos \"(((A<0 * R<1) + (R<1 * (R<1 * [2*a*x + b]^2))))\")"], ["", "lemma quadratic_eq_factoring:\n  assumes D: \"D = b\\<^sup>2 - 4 * a * c\"\n  assumes nn: \"0 \\<le> D\"\n  assumes x1: \"x\\<^sub>1 = (-b + sqrt D) / (2 * a)\"\n  assumes x2: \"x\\<^sub>2 = (-b - sqrt D) / (2 * a)\"\n  assumes a: \"a \\<noteq> 0\"\n  shows \"a * x\\<^sup>2 + b * x + c = a * (x - x\\<^sub>1) * (x - x\\<^sub>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a * x\\<^sup>2 + b * x + c = a * (x - x\\<^sub>1) * (x - x\\<^sub>2)", "using nn"], ["proof (prove)\nusing this:\n  0 \\<le> D\n\ngoal (1 subgoal):\n 1. a * x\\<^sup>2 + b * x + c = a * (x - x\\<^sub>1) * (x - x\\<^sub>2)", "by (simp add: D x1 x2)\n    (simp add: assms algebra_simps power2_eq_square power3_eq_cube divide_simps)"], ["", "lemma quadratic_eq_zeroes_iff:\n  assumes D: \"D = b\\<^sup>2 - 4 * a * c\"\n  assumes x1: \"x\\<^sub>1 = (-b + sqrt D) / (2 * a)\"\n  assumes x2: \"x\\<^sub>2 = (-b - sqrt D) / (2 * a)\"\n  assumes a: \"a \\<noteq> 0\"\n  shows \"a * x\\<^sup>2 + b * x + c = 0 \\<longleftrightarrow> (D \\<ge> 0 \\<and> (x = x\\<^sub>1 \\<or> x = x\\<^sub>2))\" (is \"?z \\<longleftrightarrow> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (a * x\\<^sup>2 + b * x + c = 0) =\n    (0 \\<le> D \\<and> (x = x\\<^sub>1 \\<or> x = x\\<^sub>2))", "using quadratic_eq_factoring[OF D _ x1 x2 a, of x] discriminant[of a x b c] a"], ["proof (prove)\nusing this:\n  0 \\<le> D \\<Longrightarrow>\n  a * x\\<^sup>2 + b * x + c = a * (x - x\\<^sub>1) * (x - x\\<^sub>2)\n  a * x\\<^sup>2 + b * x + c = 0 \\<Longrightarrow>\n  0 \\<le> b\\<^sup>2 - 4 * a * c\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (a * x\\<^sup>2 + b * x + c = 0) =\n    (0 \\<le> D \\<and> (x = x\\<^sub>1 \\<or> x = x\\<^sub>2))", "by (auto simp: D)"], ["", "lemma quadratic_ex_zero_iff:\n  \"(\\<exists>x. a * x\\<^sup>2 + b * x + c = 0) \\<longleftrightarrow> (a \\<noteq> 0 \\<and> b\\<^sup>2 - 4 * a * c \\<ge> 0 \\<or> a = 0 \\<and> (b = 0 \\<longrightarrow> c = 0))\"\n  for a b c::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>x. a * x\\<^sup>2 + b * x + c = 0) =\n    (a \\<noteq> 0 \\<and> 0 \\<le> b\\<^sup>2 - 4 * a * c \\<or>\n     a = 0 \\<and> (b = 0 \\<longrightarrow> c = 0))", "apply (cases \"a = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. a = 0 \\<Longrightarrow>\n    (\\<exists>x. a * x\\<^sup>2 + b * x + c = 0) =\n    (a \\<noteq> 0 \\<and> 0 \\<le> b\\<^sup>2 - 4 * a * c \\<or>\n     a = 0 \\<and> (b = 0 \\<longrightarrow> c = 0))\n 2. a \\<noteq> 0 \\<Longrightarrow>\n    (\\<exists>x. a * x\\<^sup>2 + b * x + c = 0) =\n    (a \\<noteq> 0 \\<and> 0 \\<le> b\\<^sup>2 - 4 * a * c \\<or>\n     a = 0 \\<and> (b = 0 \\<longrightarrow> c = 0))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. a = 0 \\<Longrightarrow>\n    (\\<exists>x. a * x\\<^sup>2 + b * x + c = 0) =\n    (a \\<noteq> 0 \\<and> 0 \\<le> b\\<^sup>2 - 4 * a * c \\<or>\n     a = 0 \\<and> (b = 0 \\<longrightarrow> c = 0))", "by (auto simp: intro: exI[where x=\"- c / b\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (\\<exists>x. a * x\\<^sup>2 + b * x + c = 0) =\n    (a \\<noteq> 0 \\<and> 0 \\<le> b\\<^sup>2 - 4 * a * c \\<or>\n     a = 0 \\<and> (b = 0 \\<longrightarrow> c = 0))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (\\<exists>x. a * x\\<^sup>2 + b * x + c = 0) =\n    (a \\<noteq> 0 \\<and> 0 \\<le> b\\<^sup>2 - 4 * a * c \\<or>\n     a = 0 \\<and> (b = 0 \\<longrightarrow> c = 0))", "by (subst quadratic_eq_zeroes_iff[OF refl refl refl]) auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Cauchy_Schwarz_eq_iff:\n  shows \"(inner x y)\\<^sup>2 = inner x x * inner y y \\<longleftrightarrow> ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y)) =\n    ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = (0::'a))", "proof safe"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>(x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y);\n     y \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. x = k *\\<^sub>R y\n 2. \\<And>k.\n       x = k *\\<^sub>R y \\<Longrightarrow>\n       (k *\\<^sub>R y \\<bullet> y)\\<^sup>2 =\n       k *\\<^sub>R y \\<bullet> k *\\<^sub>R y * (y \\<bullet> y)\n 3. y = (0::'a) \\<Longrightarrow>\n    (x \\<bullet> (0::'a))\\<^sup>2 =\n    x \\<bullet> x * ((0::'a) \\<bullet> (0::'a))", "assume eq: \"(x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y)\" and \"y \\<noteq> 0\""], ["proof (state)\nthis:\n  (x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y)\n  y \\<noteq> (0::'a)\n\ngoal (3 subgoals):\n 1. \\<lbrakk>(x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y);\n     y \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. x = k *\\<^sub>R y\n 2. \\<And>k.\n       x = k *\\<^sub>R y \\<Longrightarrow>\n       (k *\\<^sub>R y \\<bullet> y)\\<^sup>2 =\n       k *\\<^sub>R y \\<bullet> k *\\<^sub>R y * (y \\<bullet> y)\n 3. y = (0::'a) \\<Longrightarrow>\n    (x \\<bullet> (0::'a))\\<^sup>2 =\n    x \\<bullet> x * ((0::'a) \\<bullet> (0::'a))", "define f where \"f \\<equiv> \\<lambda>l. inner (x - l *\\<^sub>R y) (x - l *\\<^sub>R y)\""], ["proof (state)\nthis:\n  f \\<equiv> \\<lambda>l. (x - l *\\<^sub>R y) \\<bullet> (x - l *\\<^sub>R y)\n\ngoal (3 subgoals):\n 1. \\<lbrakk>(x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y);\n     y \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. x = k *\\<^sub>R y\n 2. \\<And>k.\n       x = k *\\<^sub>R y \\<Longrightarrow>\n       (k *\\<^sub>R y \\<bullet> y)\\<^sup>2 =\n       k *\\<^sub>R y \\<bullet> k *\\<^sub>R y * (y \\<bullet> y)\n 3. y = (0::'a) \\<Longrightarrow>\n    (x \\<bullet> (0::'a))\\<^sup>2 =\n    x \\<bullet> x * ((0::'a) \\<bullet> (0::'a))", "have f_quadratic: \"f l = inner y y * l\\<^sup>2 + - 2 * inner x y * l + inner x x\" for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. f l =\n    y \\<bullet> y * l\\<^sup>2 + - 2 * (x \\<bullet> y) * l + x \\<bullet> x", "by (auto simp: f_def algebra_simps power2_eq_square inner_commute)"], ["proof (state)\nthis:\n  f ?l =\n  y \\<bullet> y * ?l\\<^sup>2 + - 2 * (x \\<bullet> y) * ?l + x \\<bullet> x\n\ngoal (3 subgoals):\n 1. \\<lbrakk>(x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y);\n     y \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. x = k *\\<^sub>R y\n 2. \\<And>k.\n       x = k *\\<^sub>R y \\<Longrightarrow>\n       (k *\\<^sub>R y \\<bullet> y)\\<^sup>2 =\n       k *\\<^sub>R y \\<bullet> k *\\<^sub>R y * (y \\<bullet> y)\n 3. y = (0::'a) \\<Longrightarrow>\n    (x \\<bullet> (0::'a))\\<^sup>2 =\n    x \\<bullet> x * ((0::'a) \\<bullet> (0::'a))", "have \"\\<exists>l. f l = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>l. f l = 0", "unfolding f_quadratic quadratic_ex_zero_iff"], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<bullet> y \\<noteq> 0 \\<and>\n    0 \\<le> (- 2 * (x \\<bullet> y))\\<^sup>2 -\n            4 * (y \\<bullet> y) * (x \\<bullet> x) \\<or>\n    y \\<bullet> y = 0 \\<and>\n    (- 2 * (x \\<bullet> y) = 0 \\<longrightarrow> x \\<bullet> x = 0)", "using \\<open>y \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  y \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. y \\<bullet> y \\<noteq> 0 \\<and>\n    0 \\<le> (- 2 * (x \\<bullet> y))\\<^sup>2 -\n            4 * (y \\<bullet> y) * (x \\<bullet> x) \\<or>\n    y \\<bullet> y = 0 \\<and>\n    (- 2 * (x \\<bullet> y) = 0 \\<longrightarrow> x \\<bullet> x = 0)", "by (auto simp: eq)"], ["proof (state)\nthis:\n  \\<exists>l. f l = 0\n\ngoal (3 subgoals):\n 1. \\<lbrakk>(x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y);\n     y \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. x = k *\\<^sub>R y\n 2. \\<And>k.\n       x = k *\\<^sub>R y \\<Longrightarrow>\n       (k *\\<^sub>R y \\<bullet> y)\\<^sup>2 =\n       k *\\<^sub>R y \\<bullet> k *\\<^sub>R y * (y \\<bullet> y)\n 3. y = (0::'a) \\<Longrightarrow>\n    (x \\<bullet> (0::'a))\\<^sup>2 =\n    x \\<bullet> x * ((0::'a) \\<bullet> (0::'a))", "then"], ["proof (chain)\npicking this:\n  \\<exists>l. f l = 0", "show \"(\\<exists>k. x = k *\\<^sub>R y)\""], ["proof (prove)\nusing this:\n  \\<exists>l. f l = 0\n\ngoal (1 subgoal):\n 1. \\<exists>k. x = k *\\<^sub>R y", "by (auto simp: f_def)"], ["proof (state)\nthis:\n  \\<exists>k. x = k *\\<^sub>R y\n\ngoal (2 subgoals):\n 1. \\<And>k.\n       x = k *\\<^sub>R y \\<Longrightarrow>\n       (k *\\<^sub>R y \\<bullet> y)\\<^sup>2 =\n       k *\\<^sub>R y \\<bullet> k *\\<^sub>R y * (y \\<bullet> y)\n 2. y = (0::'a) \\<Longrightarrow>\n    (x \\<bullet> (0::'a))\\<^sup>2 =\n    x \\<bullet> x * ((0::'a) \\<bullet> (0::'a))", "qed (auto simp: power2_eq_square)"], ["", "lemma Cauchy_Schwarz_strict_ineq:\n  \"(inner x y)\\<^sup>2 < inner x x * inner y y\" if \"y \\<noteq> 0\" \"\\<And>k. x \\<noteq> k *\\<^sub>R y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<bullet> y)\\<^sup>2 < x \\<bullet> x * (y \\<bullet> y)", "apply (rule neq_le_trans)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (x \\<bullet> y)\\<^sup>2 \\<noteq> x \\<bullet> x * (y \\<bullet> y)\n 2. (x \\<bullet> y)\\<^sup>2 \\<le> x \\<bullet> x * (y \\<bullet> y)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<bullet> y)\\<^sup>2 \\<noteq> x \\<bullet> x * (y \\<bullet> y)", "using that"], ["proof (prove)\nusing this:\n  y \\<noteq> (0::'a)\n  x \\<noteq> ?k *\\<^sub>R y\n\ngoal (1 subgoal):\n 1. (x \\<bullet> y)\\<^sup>2 \\<noteq> x \\<bullet> x * (y \\<bullet> y)", "unfolding Cauchy_Schwarz_eq_iff"], ["proof (prove)\nusing this:\n  y \\<noteq> (0::'a)\n  x \\<noteq> ?k *\\<^sub>R y\n\ngoal (1 subgoal):\n 1. \\<not> ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = (0::'a))", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<bullet> y)\\<^sup>2 \\<le> x \\<bullet> x * (y \\<bullet> y)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<bullet> y)\\<^sup>2 \\<le> x \\<bullet> x * (y \\<bullet> y)", "by (rule Cauchy_Schwarz_ineq)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Cauchy_Schwarz_eq2_iff:\n  \"\\<bar>inner x y\\<bar> = norm x * norm y \\<longleftrightarrow> ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<bar>x \\<bullet> y\\<bar> = norm x * norm y) =\n    ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = (0::'a))", "using Cauchy_Schwarz_eq_iff[of x y]"], ["proof (prove)\nusing this:\n  ((x \\<bullet> y)\\<^sup>2 = x \\<bullet> x * (y \\<bullet> y)) =\n  ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = (0::'a))\n\ngoal (1 subgoal):\n 1. (\\<bar>x \\<bullet> y\\<bar> = norm x * norm y) =\n    ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = (0::'a))", "by (subst power_eq_iff_eq_base[symmetric, where n = 2])\n     (simp_all add: dot_square_norm power_mult_distrib)"], ["", "lemma Cauchy_Schwarz_strict_ineq2:\n  \"\\<bar>inner x y\\<bar> < norm x * norm y\" if \"y \\<noteq> 0\" \"\\<And>k. x \\<noteq> k *\\<^sub>R y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>x \\<bullet> y\\<bar> < norm x * norm y", "apply (rule neq_le_trans)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<bar>x \\<bullet> y\\<bar> \\<noteq> norm x * norm y\n 2. \\<bar>x \\<bullet> y\\<bar> \\<le> norm x * norm y", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>x \\<bullet> y\\<bar> \\<noteq> norm x * norm y", "using that"], ["proof (prove)\nusing this:\n  y \\<noteq> (0::'a)\n  x \\<noteq> ?k *\\<^sub>R y\n\ngoal (1 subgoal):\n 1. \\<bar>x \\<bullet> y\\<bar> \\<noteq> norm x * norm y", "unfolding Cauchy_Schwarz_eq2_iff"], ["proof (prove)\nusing this:\n  y \\<noteq> (0::'a)\n  x \\<noteq> ?k *\\<^sub>R y\n\ngoal (1 subgoal):\n 1. \\<not> ((\\<exists>k. x = k *\\<^sub>R y) \\<or> y = (0::'a))", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>x \\<bullet> y\\<bar> \\<le> norm x * norm y", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>x \\<bullet> y\\<bar> \\<le> norm x * norm y", "by (rule Cauchy_Schwarz_ineq2)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma gt_minus_one_absI: \"abs k < 1 \\<Longrightarrow> - 1 < k\" for k::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>k\\<bar> < 1 \\<Longrightarrow> - 1 < k", "by auto"], ["", "lemma gt_one_absI: \"abs k < 1 \\<Longrightarrow> k < 1\" for k::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>k\\<bar> < 1 \\<Longrightarrow> k < 1", "by auto"], ["", "lemma abs_impossible:\n  \"\\<bar>y1\\<bar> < x1 \\<Longrightarrow> \\<bar>y2\\<bar> < x2 \\<Longrightarrow> x1 * x2 + y1 * y2 \\<noteq> 0\" for x1 x2::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x1 * x2 + y1 * y2 \\<noteq> 0", "proof goal_cases"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x1 * x2 + y1 * y2 \\<noteq> 0", "case 1"], ["proof (state)\nthis:\n  \\<bar>y1\\<bar> < x1\n  \\<bar>y2\\<bar> < x2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x1 * x2 + y1 * y2 \\<noteq> 0", "have \"- y1 * y2 \\<le> abs y1 * abs y2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - y1 * y2 \\<le> \\<bar>y1\\<bar> * \\<bar>y2\\<bar>", "by (metis abs_ge_minus_self abs_mult mult.commute mult_minus_right)"], ["proof (state)\nthis:\n  - y1 * y2 \\<le> \\<bar>y1\\<bar> * \\<bar>y2\\<bar>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x1 * x2 + y1 * y2 \\<noteq> 0", "also"], ["proof (state)\nthis:\n  - y1 * y2 \\<le> \\<bar>y1\\<bar> * \\<bar>y2\\<bar>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x1 * x2 + y1 * y2 \\<noteq> 0", "have \"\\<dots> < x1 * x2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>y1\\<bar> * \\<bar>y2\\<bar> < x1 * x2", "apply (rule mult_strict_mono)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<bar>y1\\<bar> < x1\n 2. \\<bar>y2\\<bar> < x2\n 3. 0 < x1\n 4. 0 \\<le> \\<bar>y2\\<bar>", "using 1"], ["proof (prove)\nusing this:\n  \\<bar>y1\\<bar> < x1\n  \\<bar>y2\\<bar> < x2\n\ngoal (4 subgoals):\n 1. \\<bar>y1\\<bar> < x1\n 2. \\<bar>y2\\<bar> < x2\n 3. 0 < x1\n 4. 0 \\<le> \\<bar>y2\\<bar>", "by auto"], ["proof (state)\nthis:\n  \\<bar>y1\\<bar> * \\<bar>y2\\<bar> < x1 * x2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x1 * x2 + y1 * y2 \\<noteq> 0", "finally"], ["proof (chain)\npicking this:\n  - y1 * y2 < x1 * x2", "show ?case"], ["proof (prove)\nusing this:\n  - y1 * y2 < x1 * x2\n\ngoal (1 subgoal):\n 1. x1 * x2 + y1 * y2 \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  x1 * x2 + y1 * y2 \\<noteq> 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma vangle_eq_arctan_minus:\\<comment> \\<open>TODO: generalize?!\\<close>\n  assumes ij: \"i \\<in> Basis\" \"j \\<in> Basis\" and ij_neq: \"i \\<noteq> j\"\n  assumes xy1: \"\\<bar>y1\\<bar> < x1\"\n  assumes xy2: \"\\<bar>y2\\<bar> < x2\"\n  assumes less: \"y2 / x2 > y1 / x1\"\n  shows \"vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j) (x2 *\\<^sub>R i + y2 *\\<^sub>R j) = arctan (y2 / x2) - arctan (y1 / x1)\"\n    (is \"vangle ?u ?v = _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "from assms"], ["proof (chain)\npicking this:\n  i \\<in> Basis\n  j \\<in> Basis\n  i \\<noteq> j\n  \\<bar>y1\\<bar> < x1\n  \\<bar>y2\\<bar> < x2\n  y1 / x1 < y2 / x2", "have less2: \"x2 * y1 - x1 * y2 < 0\""], ["proof (prove)\nusing this:\n  i \\<in> Basis\n  j \\<in> Basis\n  i \\<noteq> j\n  \\<bar>y1\\<bar> < x1\n  \\<bar>y2\\<bar> < x2\n  y1 / x1 < y2 / x2\n\ngoal (1 subgoal):\n 1. x2 * y1 - x1 * y2 < 0", "by (auto simp: divide_simps abs_real_def algebra_simps split: if_splits)"], ["proof (state)\nthis:\n  x2 * y1 - x1 * y2 < 0\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "have norm_eucl: \"norm (x *\\<^sub>R i + y *\\<^sub>R j) = sqrt ((norm x)\\<^sup>2 + (norm y)\\<^sup>2)\" for x y"], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (x *\\<^sub>R i + y *\\<^sub>R j) =\n    sqrt ((norm x)\\<^sup>2 + (norm y)\\<^sup>2)", "apply (subst norm_eq_sqrt_inner)"], ["proof (prove)\ngoal (1 subgoal):\n 1. sqrt\n     ((x *\\<^sub>R i + y *\\<^sub>R j) \\<bullet>\n      (x *\\<^sub>R i + y *\\<^sub>R j)) =\n    sqrt ((norm x)\\<^sup>2 + (norm y)\\<^sup>2)", "using ij ij_neq"], ["proof (prove)\nusing this:\n  i \\<in> Basis\n  j \\<in> Basis\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. sqrt\n     ((x *\\<^sub>R i + y *\\<^sub>R j) \\<bullet>\n      (x *\\<^sub>R i + y *\\<^sub>R j)) =\n    sqrt ((norm x)\\<^sup>2 + (norm y)\\<^sup>2)", "by (auto simp: inner_simps inner_Basis power2_eq_square)"], ["proof (state)\nthis:\n  norm (?x *\\<^sub>R i + ?y *\\<^sub>R j) =\n  sqrt ((norm ?x)\\<^sup>2 + (norm ?y)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "have nonzeroes: \"x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> 0\" \"x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a) &&&\n    x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)", "apply (auto simp: euclidean_eq_iff[where 'a='a] inner_simps intro!: bexI[where x=i])"], ["proof (prove)\ngoal (4 subgoals):\n 1. x1 * (i \\<bullet> i) + y1 * (j \\<bullet> i) = 0 \\<Longrightarrow> False\n 2. i \\<in> Basis\n 3. x2 * (i \\<bullet> i) + y2 * (j \\<bullet> i) = 0 \\<Longrightarrow> False\n 4. i \\<in> Basis", "using assms"], ["proof (prove)\nusing this:\n  i \\<in> Basis\n  j \\<in> Basis\n  i \\<noteq> j\n  \\<bar>y1\\<bar> < x1\n  \\<bar>y2\\<bar> < x2\n  y1 / x1 < y2 / x2\n\ngoal (4 subgoals):\n 1. x1 * (i \\<bullet> i) + y1 * (j \\<bullet> i) = 0 \\<Longrightarrow> False\n 2. i \\<in> Basis\n 3. x2 * (i \\<bullet> i) + y2 * (j \\<bullet> i) = 0 \\<Longrightarrow> False\n 4. i \\<in> Basis", "by (auto simp: inner_Basis)"], ["proof (state)\nthis:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a)\n  x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "have indep: \"x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n    k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. x1 *\\<^sub>R i + y1 *\\<^sub>R j =\n    k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j) \\<Longrightarrow>\n    False", "assume \"x1 *\\<^sub>R i + y1 *\\<^sub>R j = k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\""], ["proof (state)\nthis:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j =\n  k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. x1 *\\<^sub>R i + y1 *\\<^sub>R j =\n    k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j) \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j =\n  k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "have \"x1 / x2 = k\" \"y1 = k * y2\""], ["proof (prove)\nusing this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j =\n  k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. x1 / x2 = k &&& y1 = k * y2", "using ij ij_neq xy1 xy2"], ["proof (prove)\nusing this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j =\n  k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n  i \\<in> Basis\n  j \\<in> Basis\n  i \\<noteq> j\n  \\<bar>y1\\<bar> < x1\n  \\<bar>y2\\<bar> < x2\n\ngoal (1 subgoal):\n 1. x1 / x2 = k &&& y1 = k * y2", "apply (auto simp: abs_real_def divide_simps algebra_simps euclidean_eq_iff[where 'a='a] inner_simps\n          split: if_splits)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>\\<forall>b\\<in>Basis.\n                   x1 * (i \\<bullet> b) + y1 * (j \\<bullet> b) =\n                   k * (x2 * (i \\<bullet> b)) + k * (y2 * (j \\<bullet> b));\n        i \\<in> Basis; j \\<in> Basis; y1 < 0; - y1 < x1; y2 < 0; - y2 < x2;\n        b \\<in> Basis; i \\<bullet> b \\<noteq> j \\<bullet> b\\<rbrakk>\n       \\<Longrightarrow> x1 = k * x2\n 2. \\<And>b.\n       \\<lbrakk>\\<forall>b\\<in>Basis.\n                   x1 * (i \\<bullet> b) + y1 * (j \\<bullet> b) =\n                   k * (x2 * (i \\<bullet> b)) + k * (y2 * (j \\<bullet> b));\n        i \\<in> Basis; j \\<in> Basis; y1 < 0; - y1 < x1; \\<not> y2 < 0;\n        y2 < x2; b \\<in> Basis;\n        i \\<bullet> b \\<noteq> j \\<bullet> b\\<rbrakk>\n       \\<Longrightarrow> x1 = k * x2\n 3. \\<And>b.\n       \\<lbrakk>\\<forall>b\\<in>Basis.\n                   x1 * (i \\<bullet> b) + y1 * (j \\<bullet> b) =\n                   k * (x2 * (i \\<bullet> b)) + k * (y2 * (j \\<bullet> b));\n        i \\<in> Basis; j \\<in> Basis; \\<not> y1 < 0; y1 < x1; y2 < 0;\n        - y2 < x2; b \\<in> Basis;\n        i \\<bullet> b \\<noteq> j \\<bullet> b\\<rbrakk>\n       \\<Longrightarrow> x1 = k * x2\n 4. \\<And>b.\n       \\<lbrakk>\\<forall>b\\<in>Basis.\n                   x1 * (i \\<bullet> b) + y1 * (j \\<bullet> b) =\n                   k * (x2 * (i \\<bullet> b)) + k * (y2 * (j \\<bullet> b));\n        i \\<in> Basis; j \\<in> Basis; \\<not> y1 < 0; y1 < x1; \\<not> y2 < 0;\n        y2 < x2; b \\<in> Basis;\n        i \\<bullet> b \\<noteq> j \\<bullet> b\\<rbrakk>\n       \\<Longrightarrow> x1 = k * x2\n 5. \\<And>b.\n       \\<lbrakk>\\<forall>b\\<in>Basis.\n                   x1 * (i \\<bullet> b) + y1 * (j \\<bullet> b) =\n                   k * (x2 * (i \\<bullet> b)) + k * (y2 * (j \\<bullet> b));\n        i \\<in> Basis; j \\<in> Basis; y1 < 0; - y1 < x1; y2 < 0; - y2 < x2;\n        b \\<in> Basis; i \\<bullet> b \\<noteq> j \\<bullet> b\\<rbrakk>\n       \\<Longrightarrow> y1 = k * y2\n 6. \\<And>b.\n       \\<lbrakk>\\<forall>b\\<in>Basis.\n                   x1 * (i \\<bullet> b) + y1 * (j \\<bullet> b) =\n                   k * (x2 * (i \\<bullet> b)) + k * (y2 * (j \\<bullet> b));\n        i \\<in> Basis; j \\<in> Basis; y1 < 0; - y1 < x1; \\<not> y2 < 0;\n        y2 < x2; b \\<in> Basis;\n        i \\<bullet> b \\<noteq> j \\<bullet> b\\<rbrakk>\n       \\<Longrightarrow> y1 = k * y2\n 7. \\<And>b.\n       \\<lbrakk>\\<forall>b\\<in>Basis.\n                   x1 * (i \\<bullet> b) + y1 * (j \\<bullet> b) =\n                   k * (x2 * (i \\<bullet> b)) + k * (y2 * (j \\<bullet> b));\n        i \\<in> Basis; j \\<in> Basis; \\<not> y1 < 0; y1 < x1; y2 < 0;\n        - y2 < x2; b \\<in> Basis;\n        i \\<bullet> b \\<noteq> j \\<bullet> b\\<rbrakk>\n       \\<Longrightarrow> y1 = k * y2\n 8. \\<And>b.\n       \\<lbrakk>\\<forall>b\\<in>Basis.\n                   x1 * (i \\<bullet> b) + y1 * (j \\<bullet> b) =\n                   k * (x2 * (i \\<bullet> b)) + k * (y2 * (j \\<bullet> b));\n        i \\<in> Basis; j \\<in> Basis; \\<not> y1 < 0; y1 < x1; \\<not> y2 < 0;\n        y2 < x2; b \\<in> Basis;\n        i \\<bullet> b \\<noteq> j \\<bullet> b\\<rbrakk>\n       \\<Longrightarrow> y1 = k * y2", "by (auto simp: inner_Basis split: if_splits)"], ["proof (state)\nthis:\n  x1 / x2 = k\n  y1 = k * y2\n\ngoal (1 subgoal):\n 1. x1 *\\<^sub>R i + y1 *\\<^sub>R j =\n    k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j) \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  x1 / x2 = k\n  y1 = k * y2", "have \"y1 = x1 / x2 * y2\""], ["proof (prove)\nusing this:\n  x1 / x2 = k\n  y1 = k * y2\n\ngoal (1 subgoal):\n 1. y1 = x1 / x2 * y2", "by simp"], ["proof (state)\nthis:\n  y1 = x1 / x2 * y2\n\ngoal (1 subgoal):\n 1. x1 *\\<^sub>R i + y1 *\\<^sub>R j =\n    k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j) \\<Longrightarrow>\n    False", "with less"], ["proof (chain)\npicking this:\n  y1 / x1 < y2 / x2\n  y1 = x1 / x2 * y2", "show False"], ["proof (prove)\nusing this:\n  y1 / x1 < y2 / x2\n  y1 = x1 / x2 * y2\n\ngoal (1 subgoal):\n 1. False", "using xy1"], ["proof (prove)\nusing this:\n  y1 / x1 < y2 / x2\n  y1 = x1 / x2 * y2\n  \\<bar>y1\\<bar> < x1\n\ngoal (1 subgoal):\n 1. False", "by (auto split: if_splits)"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n  ?k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "have \"((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n          (1 - ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet> (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 / ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))) =\n    ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n          (1 - (x1 * x2 + y1 * y2)\\<^sup>2 / ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    (1 -\n     ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n      (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))) =\n    (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    (1 -\n     (x1 * x2 + y1 * y2)\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))", "using ij_neq ij"], ["proof (prove)\nusing this:\n  i \\<noteq> j\n  i \\<in> Basis\n  j \\<in> Basis\n\ngoal (1 subgoal):\n 1. (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    (1 -\n     ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n      (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))) =\n    (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    (1 -\n     (x1 * x2 + y1 * y2)\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))", "by (auto simp: algebra_simps divide_simps inner_simps inner_Basis)"], ["proof (state)\nthis:\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n  (1 -\n   ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n    (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))) =\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n  (1 -\n   (x1 * x2 + y1 * y2)\\<^sup>2 /\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "also"], ["proof (state)\nthis:\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n  (1 -\n   ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n    (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))) =\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n  (1 -\n   (x1 * x2 + y1 * y2)\\<^sup>2 /\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "have \"\\<dots> = (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) - (x1 * x2 + y1 * y2)\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    (1 -\n     (x1 * x2 + y1 * y2)\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))) =\n    (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) -\n    (x1 * x2 + y1 * y2)\\<^sup>2", "unfolding right_diff_distrib"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) * 1 -\n    (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    ((x1 * x2 + y1 * y2)\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))) =\n    (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) -\n    (x1 * x2 + y1 * y2)\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n  (1 -\n   (x1 * x2 + y1 * y2)\\<^sup>2 /\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))) =\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) -\n  (x1 * x2 + y1 * y2)\\<^sup>2\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "also"], ["proof (state)\nthis:\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n  (1 -\n   (x1 * x2 + y1 * y2)\\<^sup>2 /\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2))) =\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) -\n  (x1 * x2 + y1 * y2)\\<^sup>2\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "have \"\\<dots> = (x2 * y1 - x1 * y2)^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) -\n    (x1 * x2 + y1 * y2)\\<^sup>2 =\n    (x2 * y1 - x1 * y2)\\<^sup>2", "by (auto simp: algebra_simps power2_eq_square)"], ["proof (state)\nthis:\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) -\n  (x1 * x2 + y1 * y2)\\<^sup>2 =\n  (x2 * y1 - x1 * y2)\\<^sup>2\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "also"], ["proof (state)\nthis:\n  (x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) -\n  (x1 * x2 + y1 * y2)\\<^sup>2 =\n  (x2 * y1 - x1 * y2)\\<^sup>2\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "have \"sqrt \\<dots> = \\<bar>x2 * y1 - x1 * y2\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sqrt ((x2 * y1 - x1 * y2)\\<^sup>2) = \\<bar>x2 * y1 - x1 * y2\\<bar>", "by simp"], ["proof (state)\nthis:\n  sqrt ((x2 * y1 - x1 * y2)\\<^sup>2) = \\<bar>x2 * y1 - x1 * y2\\<bar>\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "also"], ["proof (state)\nthis:\n  sqrt ((x2 * y1 - x1 * y2)\\<^sup>2) = \\<bar>x2 * y1 - x1 * y2\\<bar>\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "have \"\\<dots> = x1 * y2 - x2 * y1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>x2 * y1 - x1 * y2\\<bar> = x1 * y2 - x2 * y1", "using less2"], ["proof (prove)\nusing this:\n  x2 * y1 - x1 * y2 < 0\n\ngoal (1 subgoal):\n 1. \\<bar>x2 * y1 - x1 * y2\\<bar> = x1 * y2 - x2 * y1", "by (simp add: abs_real_def)"], ["proof (state)\nthis:\n  \\<bar>x2 * y1 - x1 * y2\\<bar> = x1 * y2 - x2 * y1\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "finally"], ["proof (chain)\npicking this:\n  sqrt\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    (1 -\n     ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n      (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))) =\n  x1 * y2 - x2 * y1", "have sqrt_eq: \"sqrt ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n        (1 - ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet> (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 / ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))) =\n    x1 * y2 - x2 * y1\""], ["proof (prove)\nusing this:\n  sqrt\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    (1 -\n     ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n      (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))) =\n  x1 * y2 - x2 * y1\n\ngoal (1 subgoal):\n 1. sqrt\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n      (1 -\n       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n        (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n       ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))) =\n    x1 * y2 - x2 * y1", "."], ["proof (state)\nthis:\n  sqrt\n   ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2) *\n    (1 -\n     ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n      (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n     ((x1\\<^sup>2 + y1\\<^sup>2) * (x2\\<^sup>2 + y2\\<^sup>2)))) =\n  x1 * y2 - x2 * y1\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "using ij xy1 xy2"], ["proof (prove)\nusing this:\n  i \\<in> Basis\n  j \\<in> Basis\n  \\<bar>y1\\<bar> < x1\n  \\<bar>y2\\<bar> < x2\n\ngoal (1 subgoal):\n 1. vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n     (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "unfolding vangle_def"], ["proof (prove)\nusing this:\n  i \\<in> Basis\n  j \\<in> Basis\n  \\<bar>y1\\<bar> < x1\n  \\<bar>y2\\<bar> < x2\n\ngoal (1 subgoal):\n 1. (if x1 *\\<^sub>R i + y1 *\\<^sub>R j = (0::'a) \\<or>\n        x2 *\\<^sub>R i + y2 *\\<^sub>R j = (0::'a)\n     then pi / 2\n     else arccos\n           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n             norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)))) =\n    arctan (y2 / x2) - arctan (y1 / x1)", "apply (subst arccos_arctan)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> - 1\n                      < (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                      (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                      (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                       norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\n                      < 1\n 3. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> (if x1 *\\<^sub>R i + y1 *\\<^sub>R j = (0::'a) \\<or>\n                          x2 *\\<^sub>R i + y2 *\\<^sub>R j = (0::'a)\n                       then pi / 2\n                       else pi / 2 -\n                            arctan\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) /\n                              sqrt\n                               (1 -\n                                ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                                 (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                                 (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                                  norm\n                                   (x2 *\\<^sub>R i +\n                                    y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan (y2 / x2) - arctan (y1 / x1)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> - 1\n                      < (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "apply (rule gt_minus_one_absI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<bar>\n                      < 1", "apply (simp add: )"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar> /\n                      (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                       norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\n                      < 1", "apply (subst pos_divide_less_eq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                          norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar>\n                      < 1 *\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                          norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "apply (rule mult_pos_pos)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "using nonzeroes"], ["proof (prove)\nusing this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a)\n  x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar>\n                      < 1 *\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar>\n                      < 1 *\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar>\n                      < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                        norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "apply (rule Cauchy_Schwarz_strict_ineq2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n 2. \\<And>k.\n       \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n        \\<bar>y2\\<bar> < x2\\<rbrakk>\n       \\<Longrightarrow> x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n                         k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "using nonzeroes indep"], ["proof (prove)\nusing this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a)\n  x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n  ?k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n 2. \\<And>k.\n       \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n        \\<bar>y2\\<bar> < x2\\<rbrakk>\n       \\<Longrightarrow> x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n                         k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                      (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                      (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                       norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\n                      < 1\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> (if x1 *\\<^sub>R i + y1 *\\<^sub>R j = (0::'a) \\<or>\n                          x2 *\\<^sub>R i + y2 *\\<^sub>R j = (0::'a)\n                       then pi / 2\n                       else pi / 2 -\n                            arctan\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) /\n                              sqrt\n                               (1 -\n                                ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                                 (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                                 (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                                  norm\n                                   (x2 *\\<^sub>R i +\n                                    y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan (y2 / x2) - arctan (y1 / x1)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                      (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                      (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                       norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\n                      < 1", "apply (rule gt_one_absI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<bar>\n                      < 1", "apply (simp add: )"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar> /\n                      (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                       norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\n                      < 1", "apply (subst pos_divide_less_eq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                          norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar>\n                      < 1 *\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                          norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "apply (rule mult_pos_pos)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "using nonzeroes"], ["proof (prove)\nusing this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a)\n  x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar>\n                      < 1 *\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar>\n                      < 1 *\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>(x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<bar>\n                      < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                        norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "apply (rule Cauchy_Schwarz_strict_ineq2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n 2. \\<And>k.\n       \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n        \\<bar>y2\\<bar> < x2\\<rbrakk>\n       \\<Longrightarrow> x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n                         k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "using nonzeroes indep"], ["proof (prove)\nusing this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a)\n  x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n  ?k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n 2. \\<And>k.\n       \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n        \\<bar>y2\\<bar> < x2\\<rbrakk>\n       \\<Longrightarrow> x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n                         k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> (if x1 *\\<^sub>R i + y1 *\\<^sub>R j = (0::'a) \\<or>\n                          x2 *\\<^sub>R i + y2 *\\<^sub>R j = (0::'a)\n                       then pi / 2\n                       else pi / 2 -\n                            arctan\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) /\n                              sqrt\n                               (1 -\n                                ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                                 (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                                 (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                                  norm\n                                   (x2 *\\<^sub>R i +\n                                    y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan (y2 / x2) - arctan (y1 / x1)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> (if x1 *\\<^sub>R i + y1 *\\<^sub>R j = (0::'a) \\<or>\n                          x2 *\\<^sub>R i + y2 *\\<^sub>R j = (0::'a)\n                       then pi / 2\n                       else pi / 2 -\n                            arctan\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) /\n                              sqrt\n                               (1 -\n                                ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                                 (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                                 (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                                  norm\n                                   (x2 *\\<^sub>R i +\n                                    y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan (y2 / x2) - arctan (y1 / x1)", "apply (auto simp: nonzeroes)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> pi / 2 -\n                      arctan\n                       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                         sqrt\n                          (1 -\n                           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm\n                              (x2 *\\<^sub>R i +\n                               y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan (y2 / x2) - arctan (y1 / x1)", "apply (subst (3) diff_conv_add_uminus)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> pi / 2 -\n                      arctan\n                       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                         sqrt\n                          (1 -\n                           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm\n                              (x2 *\\<^sub>R i +\n                               y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan (y2 / x2) + - arctan (y1 / x1)", "apply (subst arctan_minus[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> pi / 2 -\n                      arctan\n                       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                         sqrt\n                          (1 -\n                           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm\n                              (x2 *\\<^sub>R i +\n                               y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan (y2 / x2) + arctan (- (y1 / x1))", "apply (subst arctan_add)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>y2 / x2\\<bar> \\<le> 1\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>- (y1 / x1)\\<bar> < 1\n 3. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> pi / 2 -\n                      arctan\n                       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                         sqrt\n                          (1 -\n                           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm\n                              (x2 *\\<^sub>R i +\n                               y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan\n                       ((y2 / x2 + - (y1 / x1)) /\n                        (1 - y2 / x2 * - (y1 / x1)))", "apply force"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> \\<bar>- (y1 / x1)\\<bar> < 1\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> pi / 2 -\n                      arctan\n                       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                         sqrt\n                          (1 -\n                           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm\n                              (x2 *\\<^sub>R i +\n                               y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan\n                       ((y2 / x2 + - (y1 / x1)) /\n                        (1 - y2 / x2 * - (y1 / x1)))", "apply force"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> pi / 2 -\n                      arctan\n                       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                         sqrt\n                          (1 -\n                           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm\n                              (x2 *\\<^sub>R i +\n                               y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      arctan\n                       ((y2 / x2 + - (y1 / x1)) /\n                        (1 - y2 / x2 * - (y1 / x1)))", "apply (subst arctan_inverse[symmetric])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                          (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                           norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                           sqrt\n                            (1 -\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm\n                                (x2 *\\<^sub>R i +\n                                 y2 *\\<^sub>R j)))\\<^sup>2))\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> arctan\n                       (inverse\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                          (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                           norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                           sqrt\n                            (1 -\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm\n                                (x2 *\\<^sub>R i +\n                                 y2 *\\<^sub>R j)))\\<^sup>2)))) =\n                      arctan\n                       ((y2 / x2 + - (y1 / x1)) /\n                        (1 - y2 / x2 * - (y1 / x1)))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                          (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                           norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                           sqrt\n                            (1 -\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm\n                                (x2 *\\<^sub>R i +\n                                 y2 *\\<^sub>R j)))\\<^sup>2))", "apply (rule divide_pos_pos)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                          norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                          sqrt\n                           (1 -\n                            ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                             (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                             (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                              norm\n                               (x2 *\\<^sub>R i + y2 *\\<^sub>R j)))\\<^sup>2)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "apply (auto simp add: inner_simps inner_Basis algebra_simps )"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; \\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2;\n     j = i\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + (x1 * y2 + (x2 * y1 + y1 * y2))\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; j \\<noteq> i\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + y1 * y2", "apply (thin_tac \"_ \\<in> Basis\")+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2; j = i\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + (x1 * y2 + (x2 * y1 + y1 * y2))\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; j \\<noteq> i\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + y1 * y2", "apply (thin_tac \"j = i\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + (x1 * y2 + (x2 * y1 + y1 * y2))\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; j \\<noteq> i\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + y1 * y2", "apply (sos \"((((A<0 * (A<1 * (A<2 * A<3))) * R<1) + ((A<=0 * (A<0 * (A<2 * R<1))) * (R<1 * [1]^2))))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; j \\<noteq> i\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + y1 * y2", "apply (thin_tac \"_ \\<in> Basis\")+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2; j \\<noteq> i\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + y1 * y2", "apply (thin_tac \"j \\<noteq> i\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>y1\\<bar> < x1; \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < x1 * x2 + y1 * y2", "by (sos \"((((A<0 * (A<1 * (A<2 * A<3))) * R<1) + (((A<2 * (A<3 * R<1)) * (R<1/3 * [y1]^2)) + (((A<1 * (A<3 * R<1)) * ((R<1/12 * [x2 + y1]^2) + (R<1/12 * [x1 + y2]^2))) + (((A<1 * (A<2 * R<1)) * (R<1/12 * [~1*x1 + x2 + y1 + y2]^2)) + (((A<0 * (A<3 * R<1)) * (R<1/12 * [~1*x1 + x2 + ~1*y1 + ~1*y2]^2)) + (((A<0 * (A<2 * R<1)) * ((R<1/12 * [x2 + ~1*y1]^2) + (R<1/12 * [~1*x1 + y2]^2))) + (((A<0 * (A<1 * R<1)) * (R<1/3 * [y2]^2)) + ((A<=0 * R<1) * (R<1/3 * [x1 + x2]^2))))))))))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                          norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                          sqrt\n                           (1 -\n                            ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                             (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                             (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                              norm\n                               (x2 *\\<^sub>R i + y2 *\\<^sub>R j)))\\<^sup>2)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                          norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                          sqrt\n                           (1 -\n                            ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                             (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                             (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                              norm\n                               (x2 *\\<^sub>R i + y2 *\\<^sub>R j)))\\<^sup>2)", "apply (intro mult_pos_pos)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n 3. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < sqrt\n                           (1 -\n                            ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                             (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                             (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                              norm\n                               (x2 *\\<^sub>R i + y2 *\\<^sub>R j)))\\<^sup>2)", "using nonzeroes indep"], ["proof (prove)\nusing this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a)\n  x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n  ?k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n\ngoal (3 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n 3. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> 0 < sqrt\n                           (1 -\n                            ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                             (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                             (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                              norm\n                               (x2 *\\<^sub>R i + y2 *\\<^sub>R j)))\\<^sup>2)", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a);\n     \\<And>k.\n        x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n        k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<rbrakk>\n    \\<Longrightarrow> ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                       (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                        norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j)))\\<^sup>2\n                      < 1", "apply (rule gt_one_absI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a);\n     \\<And>k.\n        x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n        k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<rbrakk>\n    \\<Longrightarrow> \\<bar>((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                             (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                             (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                              norm\n                               (x2 *\\<^sub>R i +\n                                y2 *\\<^sub>R j)))\\<^sup>2\\<bar>\n                      < 1", "apply (simp add: power_divide power_mult_distrib power2_norm_eq_inner)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a);\n     \\<And>k.\n        x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n        k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<rbrakk>\n    \\<Longrightarrow> ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2\n                      < (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                        ((x2 *\\<^sub>R i + y2 *\\<^sub>R j) \\<bullet>\n                         (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "apply (rule Cauchy_Schwarz_strict_ineq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a);\n     \\<And>k.\n        x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n        k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<rbrakk>\n    \\<Longrightarrow> x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n 2. \\<And>k.\n       \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n        \\<bar>y2\\<bar> < x2;\n        x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n        x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a);\n        \\<And>k.\n           x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n           k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\\<rbrakk>\n       \\<Longrightarrow> x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq>\n                         k *\\<^sub>R (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> arctan\n                       (inverse\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                          (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                           norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                           sqrt\n                            (1 -\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm\n                                (x2 *\\<^sub>R i +\n                                 y2 *\\<^sub>R j)))\\<^sup>2)))) =\n                      arctan\n                       ((y2 / x2 + - (y1 / x1)) /\n                        (1 - y2 / x2 * - (y1 / x1)))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> arctan\n                       (inverse\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                          (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                           norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                           sqrt\n                            (1 -\n                             ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                              (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                              (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                               norm\n                                (x2 *\\<^sub>R i +\n                                 y2 *\\<^sub>R j)))\\<^sup>2)))) =\n                      arctan\n                       ((y2 / x2 + - (y1 / x1)) /\n                        (1 - y2 / x2 * - (y1 / x1)))", "apply (rule arg_cong[where f=arctan])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> inverse\n                       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                         sqrt\n                          (1 -\n                           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm\n                              (x2 *\\<^sub>R i +\n                               y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      (y2 / x2 + - (y1 / x1)) / (1 - y2 / x2 * - (y1 / x1))", "using nonzeroes ij_neq"], ["proof (prove)\nusing this:\n  x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a)\n  x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a)\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2\\<rbrakk>\n    \\<Longrightarrow> inverse\n                       ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                        (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                        (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                         norm (x2 *\\<^sub>R i + y2 *\\<^sub>R j) *\n                         sqrt\n                          (1 -\n                           ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                            (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                            (norm (x1 *\\<^sub>R i + y1 *\\<^sub>R j) *\n                             norm\n                              (x2 *\\<^sub>R i +\n                               y2 *\\<^sub>R j)))\\<^sup>2))) =\n                      (y2 / x2 + - (y1 / x1)) / (1 - y2 / x2 * - (y1 / x1))", "apply (auto simp: norm_eucl)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt (x1\\<^sup>2 + y1\\<^sup>2) *\n                      sqrt (x2\\<^sup>2 + y2\\<^sup>2) *\n                      sqrt\n                       (1 -\n                        ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                         (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                         (sqrt (x1\\<^sup>2 + y1\\<^sup>2) *\n                          sqrt (x2\\<^sup>2 + y2\\<^sup>2)))\\<^sup>2) /\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1))", "apply (subst real_sqrt_mult[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt\n                       ((x1\\<^sup>2 + y1\\<^sup>2) *\n                        (x2\\<^sup>2 + y2\\<^sup>2)) *\n                      sqrt\n                       (1 -\n                        ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                         (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                         (sqrt (x1\\<^sup>2 + y1\\<^sup>2) *\n                          sqrt (x2\\<^sup>2 + y2\\<^sup>2)))\\<^sup>2) /\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1))", "apply (subst real_sqrt_mult[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt\n                       ((x1\\<^sup>2 + y1\\<^sup>2) *\n                        (x2\\<^sup>2 + y2\\<^sup>2) *\n                        (1 -\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                          (sqrt (x1\\<^sup>2 + y1\\<^sup>2) *\n                           sqrt (x2\\<^sup>2 + y2\\<^sup>2)))\\<^sup>2)) /\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1))", "apply (subst real_sqrt_mult[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt\n                       ((x1\\<^sup>2 + y1\\<^sup>2) *\n                        (x2\\<^sup>2 + y2\\<^sup>2) *\n                        (1 -\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j) /\n                          sqrt\n                           ((x1\\<^sup>2 + y1\\<^sup>2) *\n                            (x2\\<^sup>2 + y2\\<^sup>2)))\\<^sup>2)) /\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1))", "apply (subst power_divide)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt\n                       ((x1\\<^sup>2 + y1\\<^sup>2) *\n                        (x2\\<^sup>2 + y2\\<^sup>2) *\n                        (1 -\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n                         (sqrt\n                           ((x1\\<^sup>2 + y1\\<^sup>2) *\n                            (x2\\<^sup>2 + y2\\<^sup>2)))\\<^sup>2)) /\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1))", "apply (subst real_sqrt_pow2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> (x1\\<^sup>2 + y1\\<^sup>2) *\n                              (x2\\<^sup>2 + y2\\<^sup>2)\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt\n                       ((x1\\<^sup>2 + y1\\<^sup>2) *\n                        (x2\\<^sup>2 + y2\\<^sup>2) *\n                        (1 -\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n                         ((x1\\<^sup>2 + y1\\<^sup>2) *\n                          (x2\\<^sup>2 + y2\\<^sup>2)))) /\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt\n                       ((x1\\<^sup>2 + y1\\<^sup>2) *\n                        (x2\\<^sup>2 + y2\\<^sup>2) *\n                        (1 -\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n                         ((x1\\<^sup>2 + y1\\<^sup>2) *\n                          (x2\\<^sup>2 + y2\\<^sup>2)))) /\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j)) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1))", "apply (subst nonzero_divide_eq_eq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                      (x2 *\\<^sub>R i + y2 *\\<^sub>R j) \\<noteq>\n                      0\n 2. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt\n                       ((x1\\<^sup>2 + y1\\<^sup>2) *\n                        (x2\\<^sup>2 + y2\\<^sup>2) *\n                        (1 -\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n                         ((x1\\<^sup>2 + y1\\<^sup>2) *\n                          (x2\\<^sup>2 + y2\\<^sup>2)))) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1)) *\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> (x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                      (x2 *\\<^sub>R i + y2 *\\<^sub>R j) \\<noteq>\n                      0", "apply (auto simp: algebra_simps inner_simps inner_Basis)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j;\n     x1 * x2 + y1 * y2 = 0\\<rbrakk>\n    \\<Longrightarrow> False", "by (auto simp: algebra_simps divide_simps abs_real_def abs_impossible)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> sqrt\n                       ((x1\\<^sup>2 + y1\\<^sup>2) *\n                        (x2\\<^sup>2 + y2\\<^sup>2) *\n                        (1 -\n                         ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                          (x2 *\\<^sub>R i + y2 *\\<^sub>R j))\\<^sup>2 /\n                         ((x1\\<^sup>2 + y1\\<^sup>2) *\n                          (x2\\<^sup>2 + y2\\<^sup>2)))) =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1)) *\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "apply (subst sqrt_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> x1 * y2 - x2 * y1 =\n                      (y2 / x2 - y1 / x1) / (1 + y2 * y1 / (x2 * x1)) *\n                      ((x1 *\\<^sub>R i + y1 *\\<^sub>R j) \\<bullet>\n                       (x2 *\\<^sub>R i + y2 *\\<^sub>R j))", "apply (auto simp: algebra_simps inner_simps inner_Basis)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis; \\<bar>y1\\<bar> < x1;\n     \\<bar>y2\\<bar> < x2; x1 *\\<^sub>R i + y1 *\\<^sub>R j \\<noteq> (0::'a);\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j;\n     x2 \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> x1 * y2 =\n                      x2 * y1 +\n                      (x1 * y2 + y1 * (y2 * y2) / x2 -\n                       (x2 * y1 + y1 * (y1 * y2) / x1)) /\n                      (1 + y1 * y2 / (x1 * x2))", "apply (auto simp: algebra_simps divide_simps abs_real_def abs_impossible)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> Basis; j \\<in> Basis;\n     (if y1 < 0 then - y1 else y1) < 0; (if y2 < 0 then - y2 else y2) < x2;\n     x2 *\\<^sub>R i + y2 *\\<^sub>R j \\<noteq> (0::'a); i \\<noteq> j;\n     x2 \\<noteq> 0; x1 = 0; y2 \\<noteq> 0; y1 \\<noteq> 0;\n     j \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> False", "by (auto split: if_splits)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  vangle (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n   (x2 *\\<^sub>R i + y2 *\\<^sub>R j) =\n  arctan (y2 / x2) - arctan (y1 / x1)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma vangle_le_pi2: \"0 \\<le> u \\<bullet> v \\<Longrightarrow> vangle u v \\<le> pi/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> u \\<bullet> v \\<Longrightarrow> vangle u v \\<le> pi / 2", "unfolding vangle_def atLeastAtMost_iff"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> u \\<bullet> v \\<Longrightarrow>\n    (if u = (0::'a) \\<or> v = (0::'a) then pi / 2\n     else arccos (u \\<bullet> v / (norm u * norm v)))\n    \\<le> pi / 2", "apply (simp del: le_divide_eq_numeral1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> u \\<bullet> v \\<Longrightarrow>\n    u \\<noteq> (0::'a) \\<and> v \\<noteq> (0::'a) \\<longrightarrow>\n    arccos (u \\<bullet> v / (norm u * norm v)) \\<le> pi / 2", "apply (intro impI arccos_le_pi2 arccos_lbound)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> u \\<bullet> v;\n     u \\<noteq> (0::'a) \\<and> v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> u \\<bullet> v / (norm u * norm v)\n 2. \\<lbrakk>0 \\<le> u \\<bullet> v;\n     u \\<noteq> (0::'a) \\<and> v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> u \\<bullet> v / (norm u * norm v) \\<le> 1", "using Cauchy_Schwarz_ineq2[of u v]"], ["proof (prove)\nusing this:\n  \\<bar>u \\<bullet> v\\<bar> \\<le> norm u * norm v\n\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> u \\<bullet> v;\n     u \\<noteq> (0::'a) \\<and> v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> u \\<bullet> v / (norm u * norm v)\n 2. \\<lbrakk>0 \\<le> u \\<bullet> v;\n     u \\<noteq> (0::'a) \\<and> v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> u \\<bullet> v / (norm u * norm v) \\<le> 1", "by (auto simp: algebra_simps)"], ["", "lemma inner_eq_vangle: \"u \\<bullet> v = cos (vangle u v) * (norm u * norm v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<bullet> v = cos (vangle u v) * (norm u * norm v)", "by (simp add: cos_vangle)"], ["", "lemma vangle_scaleR_self:\n  \"vangle (k *\\<^sub>R v) v = (if k = 0 \\<or> v = 0 then pi / 2 else if k > 0 then 0 else pi)\"\n  \"vangle v (k *\\<^sub>R v) = (if k = 0 \\<or> v = 0 then pi / 2 else if k > 0 then 0 else pi)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vangle (k *\\<^sub>R v) v =\n    (if k = 0 \\<or> v = (0::'a) then pi / 2\n     else if 0 < k then 0 else pi) &&&\n    vangle v (k *\\<^sub>R v) =\n    (if k = 0 \\<or> v = (0::'a) then pi / 2 else if 0 < k then 0 else pi)", "by (auto simp: vangle_def dot_square_norm power2_eq_square)"], ["", "lemma vangle_scaleR:\n  \"vangle (k *\\<^sub>R v) w = vangle v w\" \"vangle w (k *\\<^sub>R v) = vangle w v\" if \"k > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vangle (k *\\<^sub>R v) w = vangle v w &&&\n    vangle w (k *\\<^sub>R v) = vangle w v", "using that"], ["proof (prove)\nusing this:\n  0 < k\n\ngoal (1 subgoal):\n 1. vangle (k *\\<^sub>R v) w = vangle v w &&&\n    vangle w (k *\\<^sub>R v) = vangle w v", "by (auto simp: vangle_def)"], ["", "lemma cos_vangle_eq_zero_iff_vangle:\n  \"cos (vangle u v) = 0 \\<longleftrightarrow> (u = 0 \\<or> v = 0 \\<or> u \\<bullet> v = 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cos (vangle u v) = 0) =\n    (u = (0::'a) \\<or> v = (0::'a) \\<or> u \\<bullet> v = 0)", "using Cauchy_Schwarz_ineq2[of u v]"], ["proof (prove)\nusing this:\n  \\<bar>u \\<bullet> v\\<bar> \\<le> norm u * norm v\n\ngoal (1 subgoal):\n 1. (cos (vangle u v) = 0) =\n    (u = (0::'a) \\<or> v = (0::'a) \\<or> u \\<bullet> v = 0)", "by (auto simp: vangle_def divide_simps algebra_split_simps split: if_splits)"], ["", "lemma ortho_imp_angle_pi_half: \"u \\<bullet> v = 0 \\<Longrightarrow> vangle u v = pi / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<bullet> v = 0 \\<Longrightarrow> vangle u v = pi / 2", "using orthogonal_iff_vangle[of u v]"], ["proof (prove)\nusing this:\n  orthogonal u v = (vangle u v = pi / 2)\n\ngoal (1 subgoal):\n 1. u \\<bullet> v = 0 \\<Longrightarrow> vangle u v = pi / 2", "by (auto simp: orthogonal_def)"], ["", "lemma arccos_eq_zero_iff: \"arccos x = 0 \\<longleftrightarrow> x = 1\" if \"-1 \\<le> x\" \"x \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (arccos x = 0) = (x = 1)", "using that"], ["proof (prove)\nusing this:\n  - 1 \\<le> x\n  x \\<le> 1\n\ngoal (1 subgoal):\n 1. (arccos x = 0) = (x = 1)", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>- 1 \\<le> x; x \\<le> 1; arccos x = 0\\<rbrakk>\n    \\<Longrightarrow> x = 1", "using cos_arccos"], ["proof (prove)\nusing this:\n  \\<lbrakk>- 1 \\<le> ?y; ?y \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> cos (arccos ?y) = ?y\n\ngoal (1 subgoal):\n 1. \\<lbrakk>- 1 \\<le> x; x \\<le> 1; arccos x = 0\\<rbrakk>\n    \\<Longrightarrow> x = 1", "by fastforce"], ["", "lemma vangle_eq_zeroD: \"vangle u v = 0 \\<Longrightarrow> (\\<exists>k. v = k *\\<^sub>R u)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vangle u v = 0 \\<Longrightarrow> \\<exists>k. v = k *\\<^sub>R u", "apply (auto simp: vangle_def split: if_splits)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>arccos (u \\<bullet> v / (norm u * norm v)) = 0;\n     u \\<noteq> (0::'a); v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. v = k *\\<^sub>R u", "apply (subst (asm) arccos_eq_zero_iff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>u \\<noteq> (0::'a); v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> - 1 \\<le> u \\<bullet> v / (norm u * norm v)\n 2. \\<lbrakk>u \\<noteq> (0::'a); v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> u \\<bullet> v / (norm u * norm v) \\<le> 1\n 3. \\<lbrakk>u \\<bullet> v / (norm u * norm v) = 1; u \\<noteq> (0::'a);\n     v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. v = k *\\<^sub>R u", "apply (auto simp: divide_simps mult_less_0_iff split: if_splits)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>u \\<noteq> (0::'a); v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> - (norm u * norm v) \\<le> u \\<bullet> v\n 2. \\<lbrakk>u \\<noteq> (0::'a); v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> u \\<bullet> v \\<le> norm u * norm v\n 3. \\<lbrakk>u \\<bullet> v = norm u * norm v; u \\<noteq> (0::'a);\n     v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. v = k *\\<^sub>R u", "apply (metis Real_Vector_Spaces.norm_minus_cancel inner_minus_left minus_le_iff norm_cauchy_schwarz)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> (0::'a); v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> u \\<bullet> v \\<le> norm u * norm v\n 2. \\<lbrakk>u \\<bullet> v = norm u * norm v; u \\<noteq> (0::'a);\n     v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. v = k *\\<^sub>R u", "apply (metis norm_cauchy_schwarz)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<bullet> v = norm u * norm v; u \\<noteq> (0::'a);\n     v \\<noteq> (0::'a)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k. v = k *\\<^sub>R u", "by (metis Cauchy_Schwarz_eq2_iff abs_of_pos inner_commute mult.commute mult_sign_intros(5) zero_less_norm_iff)"], ["", "lemma less_one_multI:\\<comment> \\<open>TODO: also in AA!\\<close>\n  fixes e x::real\n  shows \"e \\<le> 1 \\<Longrightarrow> 0 < x \\<Longrightarrow> x < 1 \\<Longrightarrow> e * x < 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>e \\<le> 1; 0 < x; x < 1\\<rbrakk> \\<Longrightarrow> e * x < 1", "by (metis (erased, hide_lams) less_eq_real_def monoid_mult_class.mult.left_neutral\n    mult_strict_mono zero_less_one)"], ["", "lemma conemem_expansion_estimate:\n  fixes u v u' v'::\"'a::euclidean_space\"\n  assumes \"t \\<in> {0 .. pi / 2}\"\n  assumes angle_pos: \"0 < vangle u v\" \"vangle u v < pi / 2\"\n  assumes angle_le: \"(vangle u' v') \\<le> (vangle u v)\"\n  assumes \"norm u = 1\" \"norm v = 1\"\n  shows \"norm (conemem u' v' t) \\<ge> min (norm u') (norm v') * norm (conemem u v t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "define e_pre where \"e_pre = min (norm u') (norm v')\""], ["proof (state)\nthis:\n  e_pre = min (norm u') (norm v')\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "let ?w = \"conemem u v\""], ["proof (state)\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "let ?w' = \"conemem u' v'\""], ["proof (state)\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have cos_angle_le: \"cos (vangle u' v') \\<ge> cos (vangle u v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cos (vangle u v) \\<le> cos (vangle u' v')", "using angle_pos vangle_bounds"], ["proof (prove)\nusing this:\n  0 < vangle u v\n  vangle u v < pi / 2\n  0 \\<le> vangle ?u ?v\n  vangle ?u ?v \\<le> pi\n\ngoal (1 subgoal):\n 1. cos (vangle u v) \\<le> cos (vangle u' v')", "by (auto intro!: cos_monotone_0_pi_le angle_le)"], ["proof (state)\nthis:\n  cos (vangle u v) \\<le> cos (vangle u' v')\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have e_pre_le: \"e_pre\\<^sup>2 \\<le> norm u' * norm v'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e_pre\\<^sup>2 \\<le> norm u' * norm v'", "by (auto simp: e_pre_def min_def power2_eq_square intro: mult_left_mono mult_right_mono)"], ["proof (state)\nthis:\n  e_pre\\<^sup>2 \\<le> norm u' * norm v'\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have lt: \"0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t", "have \"\\<bar>u \\<bullet> v\\<bar> < norm u * norm v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u \\<bullet> v\\<bar> < norm u * norm v", "apply (rule Cauchy_Schwarz_strict_ineq2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. v \\<noteq> (0::'a)\n 2. \\<And>k. u \\<noteq> k *\\<^sub>R v", "using assms"], ["proof (prove)\nusing this:\n  t \\<in> {0..pi / 2}\n  0 < vangle u v\n  vangle u v < pi / 2\n  vangle u' v' \\<le> vangle u v\n  norm u = 1\n  norm v = 1\n\ngoal (2 subgoals):\n 1. v \\<noteq> (0::'a)\n 2. \\<And>k. u \\<noteq> k *\\<^sub>R v", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>0 < vangle (k *\\<^sub>R v) v;\n        vangle (k *\\<^sub>R v) v * 2 < pi;\n        vangle u' v' \\<le> vangle (k *\\<^sub>R v) v; \\<bar>k\\<bar> = 1;\n        norm v = 1; 0 \\<le> t; t * 2 \\<le> pi; u = k *\\<^sub>R v\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subst (asm) vangle_scaleR_self)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>0 < (if k = 0 \\<or> v = (0::'a) then pi / 2\n                     else if 0 < k then 0 else pi);\n        (if k = 0 \\<or> v = (0::'a) then pi / 2\n         else if 0 < k then 0 else pi) *\n        2\n        < pi;\n        vangle u' v'\n        \\<le> (if k = 0 \\<or> v = (0::'a) then pi / 2\n               else if 0 < k then 0 else pi);\n        \\<bar>k\\<bar> = 1; norm v = 1; 0 \\<le> t; t * 2 \\<le> pi;\n        u = k *\\<^sub>R v\\<rbrakk>\n       \\<Longrightarrow> False", "by (auto simp: split: if_splits)"], ["proof (state)\nthis:\n  \\<bar>u \\<bullet> v\\<bar> < norm u * norm v\n\ngoal (1 subgoal):\n 1. 0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t", "then"], ["proof (chain)\npicking this:\n  \\<bar>u \\<bullet> v\\<bar> < norm u * norm v", "have \"abs (u \\<bullet> v * sin (2 * t)) < 1\""], ["proof (prove)\nusing this:\n  \\<bar>u \\<bullet> v\\<bar> < norm u * norm v\n\ngoal (1 subgoal):\n 1. \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> < 1", "using assms"], ["proof (prove)\nusing this:\n  \\<bar>u \\<bullet> v\\<bar> < norm u * norm v\n  t \\<in> {0..pi / 2}\n  0 < vangle u v\n  vangle u v < pi / 2\n  vangle u' v' \\<le> vangle u v\n  norm u = 1\n  norm v = 1\n\ngoal (1 subgoal):\n 1. \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> < 1", "apply (auto simp add: abs_mult)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>u \\<bullet> v\\<bar> < 1; 0 < vangle u v;\n     vangle u v * 2 < pi; vangle u' v' \\<le> vangle u v; norm u = 1;\n     norm v = 1; 0 \\<le> t; t * 2 \\<le> pi\\<rbrakk>\n    \\<Longrightarrow> \\<bar>u \\<bullet> v\\<bar> * \\<bar>sin (2 * t)\\<bar>\n                      < 1", "apply (subst mult.commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>u \\<bullet> v\\<bar> < 1; 0 < vangle u v;\n     vangle u v * 2 < pi; vangle u' v' \\<le> vangle u v; norm u = 1;\n     norm v = 1; 0 \\<le> t; t * 2 \\<le> pi\\<rbrakk>\n    \\<Longrightarrow> \\<bar>sin (2 * t)\\<bar> * \\<bar>u \\<bullet> v\\<bar>\n                      < 1", "apply (rule less_one_multI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<bar>u \\<bullet> v\\<bar> < 1; 0 < vangle u v;\n     vangle u v * 2 < pi; vangle u' v' \\<le> vangle u v; norm u = 1;\n     norm v = 1; 0 \\<le> t; t * 2 \\<le> pi\\<rbrakk>\n    \\<Longrightarrow> \\<bar>sin (2 * t)\\<bar> \\<le> 1\n 2. \\<lbrakk>\\<bar>u \\<bullet> v\\<bar> < 1; 0 < vangle u v;\n     vangle u v * 2 < pi; vangle u' v' \\<le> vangle u v; norm u = 1;\n     norm v = 1; 0 \\<le> t; t * 2 \\<le> pi\\<rbrakk>\n    \\<Longrightarrow> 0 < \\<bar>u \\<bullet> v\\<bar>\n 3. \\<lbrakk>\\<bar>u \\<bullet> v\\<bar> < 1; 0 < vangle u v;\n     vangle u v * 2 < pi; vangle u' v' \\<le> vangle u v; norm u = 1;\n     norm v = 1; 0 \\<le> t; t * 2 \\<le> pi\\<rbrakk>\n    \\<Longrightarrow> \\<bar>u \\<bullet> v\\<bar> < 1", "apply (auto simp add: abs_mult inner_eq_vangle )"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < vangle u v; vangle u v * 2 < pi;\n     vangle u' v' \\<le> vangle u v; norm u = 1; norm v = 1; 0 \\<le> t;\n     t * 2 \\<le> pi; cos (vangle u v) = 0\\<rbrakk>\n    \\<Longrightarrow> False", "by (auto simp: cos_vangle_eq_zero_iff_vangle dest!: ortho_imp_angle_pi_half)"], ["proof (state)\nthis:\n  \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> < 1\n\ngoal (1 subgoal):\n 1. 0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t", "then"], ["proof (chain)\npicking this:\n  \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> < 1", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> < 1\n\ngoal (1 subgoal):\n 1. 0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t", "by (subst mult.assoc sin_times_cos)+ auto"], ["proof (state)\nthis:\n  0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have le: \"0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "have \"\\<bar>u \\<bullet> v\\<bar> \\<le> norm u * norm v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u \\<bullet> v\\<bar> \\<le> norm u * norm v", "by (rule Cauchy_Schwarz_ineq2)"], ["proof (state)\nthis:\n  \\<bar>u \\<bullet> v\\<bar> \\<le> norm u * norm v\n\ngoal (1 subgoal):\n 1. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "then"], ["proof (chain)\npicking this:\n  \\<bar>u \\<bullet> v\\<bar> \\<le> norm u * norm v", "have \"abs (u \\<bullet> v * sin (2 * t)) \\<le> 1\""], ["proof (prove)\nusing this:\n  \\<bar>u \\<bullet> v\\<bar> \\<le> norm u * norm v\n\ngoal (1 subgoal):\n 1. \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> \\<le> 1", "by (auto simp add: abs_mult assms intro!: mult_le_one)"], ["proof (state)\nthis:\n  \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> \\<le> 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "then"], ["proof (chain)\npicking this:\n  \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> \\<le> 1", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>u \\<bullet> v * sin (2 * t)\\<bar> \\<le> 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "by (subst mult.assoc sin_times_cos)+ auto"], ["proof (state)\nthis:\n  0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have \"(norm (?w t))\\<^sup>2 = (cos t)\\<^sup>2 *\\<^sub>R (norm u)\\<^sup>2 + (sin t)\\<^sup>2 *\\<^sub>R (norm v)\\<^sup>2 + 2 * (u \\<bullet> v) * sin t * cos t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (norm (conemem u v t))\\<^sup>2 =\n    (cos t)\\<^sup>2 *\\<^sub>R (norm u)\\<^sup>2 +\n    (sin t)\\<^sup>2 *\\<^sub>R (norm v)\\<^sup>2 +\n    2 * (u \\<bullet> v) * sin t * cos t", "by (auto simp: conemem_def algebra_simps power2_norm_eq_inner)\n      (auto simp: power2_eq_square inner_commute)"], ["proof (state)\nthis:\n  (norm (conemem u v t))\\<^sup>2 =\n  (cos t)\\<^sup>2 *\\<^sub>R (norm u)\\<^sup>2 +\n  (sin t)\\<^sup>2 *\\<^sub>R (norm v)\\<^sup>2 +\n  2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "also"], ["proof (state)\nthis:\n  (norm (conemem u v t))\\<^sup>2 =\n  (cos t)\\<^sup>2 *\\<^sub>R (norm u)\\<^sup>2 +\n  (sin t)\\<^sup>2 *\\<^sub>R (norm v)\\<^sup>2 +\n  2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have \"\\<dots> = 1 + 2 * (u \\<bullet> v) * sin t * cos t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cos t)\\<^sup>2 *\\<^sub>R (norm u)\\<^sup>2 +\n    (sin t)\\<^sup>2 *\\<^sub>R (norm v)\\<^sup>2 +\n    2 * (u \\<bullet> v) * sin t * cos t =\n    1 + 2 * (u \\<bullet> v) * sin t * cos t", "by (auto simp: sin_squared_eq algebra_simps assms)"], ["proof (state)\nthis:\n  (cos t)\\<^sup>2 *\\<^sub>R (norm u)\\<^sup>2 +\n  (sin t)\\<^sup>2 *\\<^sub>R (norm v)\\<^sup>2 +\n  2 * (u \\<bullet> v) * sin t * cos t =\n  1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "finally"], ["proof (chain)\npicking this:\n  (norm (conemem u v t))\\<^sup>2 = 1 + 2 * (u \\<bullet> v) * sin t * cos t", "have \"(norm (conemem u v t))\\<^sup>2 = 1 + 2 * (u \\<bullet> v) * sin t * cos t\""], ["proof (prove)\nusing this:\n  (norm (conemem u v t))\\<^sup>2 = 1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (1 subgoal):\n 1. (norm (conemem u v t))\\<^sup>2 = 1 + 2 * (u \\<bullet> v) * sin t * cos t", "by simp"], ["proof (state)\nthis:\n  (norm (conemem u v t))\\<^sup>2 = 1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "moreover"], ["proof (state)\nthis:\n  (norm (conemem u v t))\\<^sup>2 = 1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have \"(norm (?w' t))\\<^sup>2 = (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 + (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (norm (conemem u' v' t))\\<^sup>2 =\n    (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n    (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n    2 * (u' \\<bullet> v') * sin t * cos t", "by (auto simp: conemem_def algebra_simps power2_norm_eq_inner)\n      (auto simp: power2_eq_square inner_commute)"], ["proof (state)\nthis:\n  (norm (conemem u' v' t))\\<^sup>2 =\n  (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n  (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n  2 * (u' \\<bullet> v') * sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "ultimately"], ["proof (chain)\npicking this:\n  (norm (conemem u v t))\\<^sup>2 = 1 + 2 * (u \\<bullet> v) * sin t * cos t\n  (norm (conemem u' v' t))\\<^sup>2 =\n  (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n  (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n  2 * (u' \\<bullet> v') * sin t * cos t", "have \"(norm (?w' t) / norm (?w t))\\<^sup>2 =\n    ((cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 + (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t) /\n    (1 + 2 * (u \\<bullet> v) * sin t * cos t)\"\n    (is \"_ = (?a + ?b) / ?c\")"], ["proof (prove)\nusing this:\n  (norm (conemem u v t))\\<^sup>2 = 1 + 2 * (u \\<bullet> v) * sin t * cos t\n  (norm (conemem u' v' t))\\<^sup>2 =\n  (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n  (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n  2 * (u' \\<bullet> v') * sin t * cos t\n\ngoal (1 subgoal):\n 1. (norm (conemem u' v' t) / norm (conemem u v t))\\<^sup>2 =\n    ((cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n     (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n     2 * (u' \\<bullet> v') * sin t * cos t) /\n    (1 + 2 * (u \\<bullet> v) * sin t * cos t)", "by (auto simp: divide_inverse power_mult_distrib) (auto simp: inverse_eq_divide power2_eq_square)"], ["proof (state)\nthis:\n  (norm (conemem u' v' t) / norm (conemem u v t))\\<^sup>2 =\n  ((cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n   (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n   2 * (u' \\<bullet> v') * sin t * cos t) /\n  (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "also"], ["proof (state)\nthis:\n  (norm (conemem u' v' t) / norm (conemem u v t))\\<^sup>2 =\n  ((cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n   (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n   2 * (u' \\<bullet> v') * sin t * cos t) /\n  (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have \"\\<dots> \\<ge> (e_pre\\<^sup>2 + ?b) / ?c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (e_pre\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t) /\n    (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n    \\<le> ((cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n           (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n           2 * (u' \\<bullet> v') * sin t * cos t) /\n          (1 + 2 * (u \\<bullet> v) * sin t * cos t)", "apply (rule divide_right_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. e_pre\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t\n    \\<le> (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n          (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n          2 * (u' \\<bullet> v') * sin t * cos t\n 2. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "apply (rule add_right_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. e_pre\\<^sup>2\n    \\<le> (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n          (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2\n 2. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. e_pre\\<^sup>2\n    \\<le> (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n          (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2", "using assms e_pre_def"], ["proof (prove)\nusing this:\n  t \\<in> {0..pi / 2}\n  0 < vangle u v\n  vangle u v < pi / 2\n  vangle u' v' \\<le> vangle u v\n  norm u = 1\n  norm v = 1\n  e_pre = min (norm u') (norm v')\n\ngoal (1 subgoal):\n 1. e_pre\\<^sup>2\n    \\<le> (cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n          (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2", "apply (auto simp: min_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < vangle u v; vangle u v * 2 < pi;\n     vangle u' v' \\<le> vangle u v; norm u = 1; norm v = 1; e_pre = norm u';\n     0 \\<le> t; t * 2 \\<le> pi; norm u' \\<le> norm v'\\<rbrakk>\n    \\<Longrightarrow> (norm u')\\<^sup>2\n                      \\<le> (cos t)\\<^sup>2 * (norm u')\\<^sup>2 +\n                            (sin t)\\<^sup>2 * (norm v')\\<^sup>2\n 2. \\<lbrakk>0 < vangle u v; vangle u v * 2 < pi;\n     vangle u' v' \\<le> vangle u v; norm u = 1; norm v = 1; e_pre = norm v';\n     0 \\<le> t; t * 2 \\<le> pi; \\<not> norm u' \\<le> norm v'\\<rbrakk>\n    \\<Longrightarrow> (norm v')\\<^sup>2\n                      \\<le> (cos t)\\<^sup>2 * (norm u')\\<^sup>2 +\n                            (sin t)\\<^sup>2 * (norm v')\\<^sup>2", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < vangle u v; vangle u v * 2 < pi;\n     vangle u' v' \\<le> vangle u v; norm u = 1; norm v = 1; e_pre = norm u';\n     0 \\<le> t; t * 2 \\<le> pi; norm u' \\<le> norm v'\\<rbrakk>\n    \\<Longrightarrow> (norm u')\\<^sup>2\n                      \\<le> (cos t)\\<^sup>2 * (norm u')\\<^sup>2 +\n                            (sin t)\\<^sup>2 * (norm v')\\<^sup>2", "by (auto simp: algebra_simps cos_squared_eq intro!: mult_right_mono power_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < vangle u v; vangle u v * 2 < pi;\n     vangle u' v' \\<le> vangle u v; norm u = 1; norm v = 1; e_pre = norm v';\n     0 \\<le> t; t * 2 \\<le> pi; \\<not> norm u' \\<le> norm v'\\<rbrakk>\n    \\<Longrightarrow> (norm v')\\<^sup>2\n                      \\<le> (cos t)\\<^sup>2 * (norm u')\\<^sup>2 +\n                            (sin t)\\<^sup>2 * (norm v')\\<^sup>2", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < vangle u v; vangle u v * 2 < pi;\n     vangle u' v' \\<le> vangle u v; norm u = 1; norm v = 1; e_pre = norm v';\n     0 \\<le> t; t * 2 \\<le> pi; \\<not> norm u' \\<le> norm v'\\<rbrakk>\n    \\<Longrightarrow> (norm v')\\<^sup>2\n                      \\<le> (cos t)\\<^sup>2 * (norm u')\\<^sup>2 +\n                            (sin t)\\<^sup>2 * (norm v')\\<^sup>2", "by (auto simp: algebra_simps sin_squared_eq intro!: mult_right_mono power_mono)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "by (rule le)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (e_pre\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t) /\n  (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n  \\<le> ((cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n         (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n         2 * (u' \\<bullet> v') * sin t * cos t) /\n        (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "also (xtrans)"], ["proof (state)\nthis:\n  (e_pre\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t) /\n  (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n  \\<le> ((cos t)\\<^sup>2 *\\<^sub>R (norm u')\\<^sup>2 +\n         (sin t)\\<^sup>2 *\\<^sub>R (norm v')\\<^sup>2 +\n         2 * (u' \\<bullet> v') * sin t * cos t) /\n        (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have inner_nonneg: \"u' \\<bullet> v' \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> u' \\<bullet> v'", "using angle_le(1) angle_pos vangle_bounds[of u' v']"], ["proof (prove)\nusing this:\n  vangle u' v' \\<le> vangle u v\n  0 < vangle u v\n  vangle u v < pi / 2\n  0 \\<le> vangle u' v'\n  vangle u' v' \\<le> pi\n\ngoal (1 subgoal):\n 1. 0 \\<le> u' \\<bullet> v'", "by (auto simp: inner_eq_vangle intro!: mult_nonneg_nonneg cos_ge_zero)"], ["proof (state)\nthis:\n  0 \\<le> u' \\<bullet> v'\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "from vangle_bounds[of u' v'] vangle_le_pi2[OF this]"], ["proof (chain)\npicking this:\n  0 \\<le> vangle u' v'\n  vangle u' v' \\<le> pi\n  vangle u' v' \\<le> pi / 2", "have u'v'e_pre: \"u' \\<bullet> v' \\<ge> cos (vangle u' v') * e_pre\\<^sup>2\""], ["proof (prove)\nusing this:\n  0 \\<le> vangle u' v'\n  vangle u' v' \\<le> pi\n  vangle u' v' \\<le> pi / 2\n\ngoal (1 subgoal):\n 1. cos (vangle u' v') * e_pre\\<^sup>2 \\<le> u' \\<bullet> v'", "apply (subst inner_eq_vangle)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> vangle u' v'; vangle u' v' \\<le> pi;\n     vangle u' v' \\<le> pi / 2\\<rbrakk>\n    \\<Longrightarrow> cos (vangle u' v') * e_pre\\<^sup>2\n                      \\<le> cos (vangle u' v') * (norm u' * norm v')", "apply (rule mult_left_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> vangle u' v'; vangle u' v' \\<le> pi;\n     vangle u' v' \\<le> pi / 2\\<rbrakk>\n    \\<Longrightarrow> e_pre\\<^sup>2 \\<le> norm u' * norm v'\n 2. \\<lbrakk>0 \\<le> vangle u' v'; vangle u' v' \\<le> pi;\n     vangle u' v' \\<le> pi / 2\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> cos (vangle u' v')", "apply (rule e_pre_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> vangle u' v'; vangle u' v' \\<le> pi;\n     vangle u' v' \\<le> pi / 2\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> cos (vangle u' v')", "apply (rule cos_ge_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> vangle u' v'; vangle u' v' \\<le> pi;\n     vangle u' v' \\<le> pi / 2\\<rbrakk>\n    \\<Longrightarrow> - (pi / 2) \\<le> vangle u' v'\n 2. \\<lbrakk>0 \\<le> vangle u' v'; vangle u' v' \\<le> pi;\n     vangle u' v' \\<le> pi / 2\\<rbrakk>\n    \\<Longrightarrow> vangle u' v' \\<le> pi / 2", "by auto"], ["proof (state)\nthis:\n  cos (vangle u' v') * e_pre\\<^sup>2 \\<le> u' \\<bullet> v'\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have \"(e_pre\\<^sup>2 + ?b) / ?c \\<ge> (e_pre\\<^sup>2 + 2 * (cos (vangle u' v') * e_pre\\<^sup>2) * sin t * cos t) / ?c\"\n    (is \"_ \\<ge> ?ddd\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (e_pre\\<^sup>2 +\n     2 * (cos (vangle u' v') * e_pre\\<^sup>2) * sin t * cos t) /\n    (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n    \\<le> (e_pre\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t) /\n          (1 + 2 * (u \\<bullet> v) * sin t * cos t)", "apply (intro divide_right_mono add_left_mono mult_right_mono mult_left_mono u'v'e_pre)"], ["proof (prove)\ngoal (4 subgoals):\n 1. 0 \\<le> 2\n 2. 0 \\<le> sin t\n 3. 0 \\<le> cos t\n 4. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "using \\<open>t \\<in> _\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {0..pi / 2}\n\ngoal (4 subgoals):\n 1. 0 \\<le> 2\n 2. 0 \\<le> sin t\n 3. 0 \\<le> cos t\n 4. 0 \\<le> 1 + 2 * (u \\<bullet> v) * sin t * cos t", "by (auto intro!: mult_right_mono sin_ge_zero divide_right_mono le cos_ge_zero\n        simp: sin_times_cos u'v'e_pre)"], ["proof (state)\nthis:\n  (e_pre\\<^sup>2 +\n   2 * (cos (vangle u' v') * e_pre\\<^sup>2) * sin t * cos t) /\n  (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n  \\<le> (e_pre\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t) /\n        (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "also (xtrans)"], ["proof (state)\nthis:\n  (e_pre\\<^sup>2 +\n   2 * (cos (vangle u' v') * e_pre\\<^sup>2) * sin t * cos t) /\n  (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n  \\<le> (e_pre\\<^sup>2 + 2 * (u' \\<bullet> v') * sin t * cos t) /\n        (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have \"?ddd = e_pre\\<^sup>2 * ((1 + 2 * cos (vangle u' v') * sin t * cos t) / ?c)\" (is \"_ = ?ddd\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (e_pre\\<^sup>2 +\n     2 * (cos (vangle u' v') * e_pre\\<^sup>2) * sin t * cos t) /\n    (1 + 2 * (u \\<bullet> v) * sin t * cos t) =\n    e_pre\\<^sup>2 *\n    ((1 + 2 * cos (vangle u' v') * sin t * cos t) /\n     (1 + 2 * (u \\<bullet> v) * sin t * cos t))", "by (auto simp add: divide_simps algebra_simps)"], ["proof (state)\nthis:\n  (e_pre\\<^sup>2 +\n   2 * (cos (vangle u' v') * e_pre\\<^sup>2) * sin t * cos t) /\n  (1 + 2 * (u \\<bullet> v) * sin t * cos t) =\n  e_pre\\<^sup>2 *\n  ((1 + 2 * cos (vangle u' v') * sin t * cos t) /\n   (1 + 2 * (u \\<bullet> v) * sin t * cos t))\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "also (xtrans)"], ["proof (state)\nthis:\n  (e_pre\\<^sup>2 +\n   2 * (cos (vangle u' v') * e_pre\\<^sup>2) * sin t * cos t) /\n  (1 + 2 * (u \\<bullet> v) * sin t * cos t) =\n  e_pre\\<^sup>2 *\n  ((1 + 2 * cos (vangle u' v') * sin t * cos t) /\n   (1 + 2 * (u \\<bullet> v) * sin t * cos t))\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have sc_ge_0: \"0 \\<le> sin t * cos t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> sin t * cos t", "using \\<open>t \\<in> _\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {0..pi / 2}\n\ngoal (1 subgoal):\n 1. 0 \\<le> sin t * cos t", "by (auto simp: assms cos_angle_le intro!: mult_nonneg_nonneg sin_ge_zero cos_ge_zero)"], ["proof (state)\nthis:\n  0 \\<le> sin t * cos t\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "have \"?ddd \\<ge> e_pre\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e_pre\\<^sup>2\n    \\<le> e_pre\\<^sup>2 *\n          ((1 + 2 * cos (vangle u' v') * sin t * cos t) /\n           (1 + 2 * (u \\<bullet> v) * sin t * cos t))", "apply (subst mult_le_cancel_left1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (0 < e_pre\\<^sup>2 \\<longrightarrow>\n     1 \\<le> (1 + 2 * cos (vangle u' v') * sin t * cos t) /\n             (1 + 2 * (u \\<bullet> v) * sin t * cos t)) \\<and>\n    (e_pre\\<^sup>2 < 0 \\<longrightarrow>\n     (1 + 2 * cos (vangle u' v') * sin t * cos t) /\n     (1 + 2 * (u \\<bullet> v) * sin t * cos t)\n     \\<le> 1)", "apply (auto simp add: divide_simps split: if_splits)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>1 + 2 * (u \\<bullet> v) * sin t * cos t < 0;\n     e_pre \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> cos (vangle u' v') * (sin t * cos t)\n                      \\<le> u \\<bullet> v * (sin t * cos t)\n 2. \\<lbrakk>0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t;\n     e_pre \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> u \\<bullet> v * (sin t * cos t)\n                      \\<le> cos (vangle u' v') * (sin t * cos t)\n 3. 1 + 2 * (u \\<bullet> v) * sin t * cos t = 0 \\<Longrightarrow> e_pre = 0", "apply (rule mult_right_mono)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>1 + 2 * (u \\<bullet> v) * sin t * cos t < 0;\n     e_pre \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> cos (vangle u' v') \\<le> u \\<bullet> v\n 2. \\<lbrakk>1 + 2 * (u \\<bullet> v) * sin t * cos t < 0;\n     e_pre \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> sin t * cos t\n 3. \\<lbrakk>0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t;\n     e_pre \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> u \\<bullet> v * (sin t * cos t)\n                      \\<le> cos (vangle u' v') * (sin t * cos t)\n 4. 1 + 2 * (u \\<bullet> v) * sin t * cos t = 0 \\<Longrightarrow> e_pre = 0", "using lt"], ["proof (prove)\nusing this:\n  0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t\n\ngoal (4 subgoals):\n 1. \\<lbrakk>1 + 2 * (u \\<bullet> v) * sin t * cos t < 0;\n     e_pre \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> cos (vangle u' v') \\<le> u \\<bullet> v\n 2. \\<lbrakk>1 + 2 * (u \\<bullet> v) * sin t * cos t < 0;\n     e_pre \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> sin t * cos t\n 3. \\<lbrakk>0 < 1 + 2 * (u \\<bullet> v) * sin t * cos t;\n     e_pre \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> u \\<bullet> v * (sin t * cos t)\n                      \\<le> cos (vangle u' v') * (sin t * cos t)\n 4. 1 + 2 * (u \\<bullet> v) * sin t * cos t = 0 \\<Longrightarrow> e_pre = 0", "by (auto simp: assms inner_eq_vangle intro!: mult_right_mono sc_ge_0 cos_angle_le)"], ["proof (state)\nthis:\n  e_pre\\<^sup>2\n  \\<le> e_pre\\<^sup>2 *\n        ((1 + 2 * cos (vangle u' v') * sin t * cos t) /\n         (1 + 2 * (u \\<bullet> v) * sin t * cos t))\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "finally (xtrans)"], ["proof (chain)\npicking this:\n  e_pre\\<^sup>2\n  \\<le> (norm (conemem u' v' t) / norm (conemem u v t))\\<^sup>2", "have \"(norm (conemem u' v' t))\\<^sup>2 \\<ge> (e_pre * norm (conemem u v t))\\<^sup>2\""], ["proof (prove)\nusing this:\n  e_pre\\<^sup>2\n  \\<le> (norm (conemem u' v' t) / norm (conemem u v t))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (e_pre * norm (conemem u v t))\\<^sup>2\n    \\<le> (norm (conemem u' v' t))\\<^sup>2", "by (simp add: divide_simps power_mult_distrib split: if_splits)"], ["proof (state)\nthis:\n  (e_pre * norm (conemem u v t))\\<^sup>2\n  \\<le> (norm (conemem u' v' t))\\<^sup>2\n\ngoal (1 subgoal):\n 1. min (norm u') (norm v') * norm (conemem u v t)\n    \\<le> norm (conemem u' v' t)", "then"], ["proof (chain)\npicking this:\n  (e_pre * norm (conemem u v t))\\<^sup>2\n  \\<le> (norm (conemem u' v' t))\\<^sup>2", "show \"norm (conemem u' v' t) \\<ge> e_pre * norm (conemem u v t)\""], ["proof (prove)\nusing this:\n  (e_pre * norm (conemem u v t))\\<^sup>2\n  \\<le> (norm (conemem u' v' t))\\<^sup>2\n\ngoal (1 subgoal):\n 1. e_pre * norm (conemem u v t) \\<le> norm (conemem u' v' t)", "using norm_imp_pos_and_ge power2_le_imp_le"], ["proof (prove)\nusing this:\n  (e_pre * norm (conemem u v t))\\<^sup>2\n  \\<le> (norm (conemem u' v' t))\\<^sup>2\n  norm ?x \\<equiv> ?n \\<Longrightarrow>\n  0 \\<le> norm ?x \\<and> norm ?x \\<le> ?n\n  \\<lbrakk>?x\\<^sup>2 \\<le> ?y\\<^sup>2; (0::?'a) \\<le> ?y\\<rbrakk>\n  \\<Longrightarrow> ?x \\<le> ?y\n\ngoal (1 subgoal):\n 1. e_pre * norm (conemem u v t) \\<le> norm (conemem u' v' t)", "by blast"], ["proof (state)\nthis:\n  e_pre * norm (conemem u v t) \\<le> norm (conemem u' v' t)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma conemem_commute: \"conemem a b t = conemem b a (pi / 2 - t)\" if \"0 \\<le> t\" \"t \\<le> pi / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. conemem a b t = conemem b a (pi / 2 - t)", "using that"], ["proof (prove)\nusing this:\n  0 \\<le> t\n  t \\<le> pi / 2\n\ngoal (1 subgoal):\n 1. conemem a b t = conemem b a (pi / 2 - t)", "by (auto simp: conemem_def cos_sin_eq algebra_simps)"], ["", "lemma conesegment_commute: \"conesegment a b = conesegment b a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. conesegment a b = conesegment b a", "apply (auto simp: conesegment_def )"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> conemem a b xa \\<in> conemem b a ` {0..pi / 2}\n 2. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> conemem b a xa \\<in> conemem a b ` {0..pi / 2}", "apply (subst conemem_commute)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> xa\n 2. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> xa \\<le> pi / 2\n 3. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> conemem b a (pi / 2 - xa)\n                         \\<in> conemem b a ` {0..pi / 2}\n 4. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> conemem b a xa \\<in> conemem a b ` {0..pi / 2}", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> conemem b a xa \\<in> conemem a b ` {0..pi / 2}", "apply (subst conemem_commute)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> xa\n 2. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> xa \\<le> pi / 2\n 3. \\<And>xa.\n       \\<lbrakk>0 \\<le> xa; xa * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> conemem a b (pi / 2 - xa)\n                         \\<in> conemem a b ` {0..pi / 2}", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition \"conefield u v = cone hull (conesegment u v)\""], ["", "lemma conefield_alt_def: \"conefield u v = cone hull {u--v}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. conefield u v = cone hull {u--v}", "apply (auto simp: conesegment_def conefield_def cone_hull_expl in_segment)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c xb.\n       \\<lbrakk>0 \\<le> c; 0 \\<le> xb; xb * 2 \\<le> pi\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca x.\n                            c *\\<^sub>R conemem u v xb =\n                            ca *\\<^sub>R x \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>ua\\<ge>0.\n                                ua \\<le> 1 \\<and>\n                                x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)\n 2. \\<And>c ua.\n       \\<lbrakk>0 \\<le> c; 0 \\<le> ua; ua \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca x.\n                            c *\\<^sub>R\n                            ((1 - ua) *\\<^sub>R u + ua *\\<^sub>R v) =\n                            ca *\\<^sub>R x \\<and>\n                            0 \\<le> ca \\<and>\n                            x \\<in> conemem u v ` {0..pi / 2}", "subgoal premises prems for c t"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R conemem u v t = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R conemem u v t = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "from prems"], ["proof (chain)\npicking this:\n  0 \\<le> c\n  0 \\<le> t\n  t * 2 \\<le> pi", "have sc_pos: \"sin t + cos t > 0\""], ["proof (prove)\nusing this:\n  0 \\<le> c\n  0 \\<le> t\n  t * 2 \\<le> pi\n\ngoal (1 subgoal):\n 1. 0 < sin t + cos t", "apply (cases \"t = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> c; 0 \\<le> t; t * 2 \\<le> pi; t = 0\\<rbrakk>\n    \\<Longrightarrow> 0 < sin t + cos t\n 2. \\<lbrakk>0 \\<le> c; 0 \\<le> t; t * 2 \\<le> pi; t \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < sin t + cos t", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> c; 0 \\<le> t; t * 2 \\<le> pi; t = 0\\<rbrakk>\n    \\<Longrightarrow> 0 < sin t + cos t", "by (rule add_nonneg_pos) auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> c; 0 \\<le> t; t * 2 \\<le> pi; t \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < sin t + cos t", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> c; 0 \\<le> t; t * 2 \\<le> pi; t \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < sin t + cos t", "by (auto intro!: add_pos_nonneg sin_gt_zero cos_ge_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  0 < sin t + cos t\n\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R conemem u v t = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "then"], ["proof (chain)\npicking this:\n  0 < sin t + cos t", "have 1: \"(sin t / (sin t + cos t) + cos t / (sin t + cos t)) = 1\""], ["proof (prove)\nusing this:\n  0 < sin t + cos t\n\ngoal (1 subgoal):\n 1. sin t / (sin t + cos t) + cos t / (sin t + cos t) = 1", "by (auto simp: divide_simps)"], ["proof (state)\nthis:\n  sin t / (sin t + cos t) + cos t / (sin t + cos t) = 1\n\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R conemem u v t = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "have \"\\<exists>c x. c > 0 \\<and> 0 \\<le> x \\<and> x \\<le> 1 \\<and> c *\\<^sub>R conemem u v t = (1 - x) *\\<^sub>R u + x *\\<^sub>R v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c x.\n       0 < c \\<and>\n       0 \\<le> x \\<and>\n       x \\<le> 1 \\<and>\n       c *\\<^sub>R conemem u v t = (1 - x) *\\<^sub>R u + x *\\<^sub>R v", "apply (auto simp: algebra_simps conemem_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       \\<exists>x\\<ge>0.\n          x \\<le> 1 \\<and>\n          x *\\<^sub>R u +\n          ((c * cos t) *\\<^sub>R u + (c * sin t) *\\<^sub>R v) =\n          u + x *\\<^sub>R v", "apply (rule exI[where x=\"1 / (sin t + cos t)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 / (sin t + cos t) \\<and>\n    (\\<exists>x\\<ge>0.\n        x \\<le> 1 \\<and>\n        x *\\<^sub>R u +\n        ((1 / (sin t + cos t) * cos t) *\\<^sub>R u +\n         (1 / (sin t + cos t) * sin t) *\\<^sub>R v) =\n        u + x *\\<^sub>R v)", "using prems"], ["proof (prove)\nusing this:\n  0 \\<le> c\n  0 \\<le> t\n  t * 2 \\<le> pi\n\ngoal (1 subgoal):\n 1. 0 < 1 / (sin t + cos t) \\<and>\n    (\\<exists>x\\<ge>0.\n        x \\<le> 1 \\<and>\n        x *\\<^sub>R u +\n        ((1 / (sin t + cos t) * cos t) *\\<^sub>R u +\n         (1 / (sin t + cos t) * sin t) *\\<^sub>R v) =\n        u + x *\\<^sub>R v)", "by (auto intro!: exI[where x=\"(1 / (sin t + cos t) * sin t)\"] sc_pos\n          divide_nonneg_nonneg sin_ge_zero add_nonneg_nonneg cos_ge_zero\n          simp: scaleR_add_left[symmetric] 1 divide_le_eq_1)"], ["proof (state)\nthis:\n  \\<exists>c x.\n     0 < c \\<and>\n     0 \\<le> x \\<and>\n     x \\<le> 1 \\<and>\n     c *\\<^sub>R conemem u v t = (1 - x) *\\<^sub>R u + x *\\<^sub>R v\n\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R conemem u v t = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "then"], ["proof (chain)\npicking this:\n  \\<exists>c x.\n     0 < c \\<and>\n     0 \\<le> x \\<and>\n     x \\<le> 1 \\<and>\n     c *\\<^sub>R conemem u v t = (1 - x) *\\<^sub>R u + x *\\<^sub>R v", "obtain d x where dx: \"d > 0\" \"conemem u v t = (1 / d) *\\<^sub>R ((1 - x) *\\<^sub>R u + x *\\<^sub>R v)\"\n        \"0 \\<le> x\" \"x \\<le> 1\""], ["proof (prove)\nusing this:\n  \\<exists>c x.\n     0 < c \\<and>\n     0 \\<le> x \\<and>\n     x \\<le> 1 \\<and>\n     c *\\<^sub>R conemem u v t = (1 - x) *\\<^sub>R u + x *\\<^sub>R v\n\ngoal (1 subgoal):\n 1. (\\<And>d x.\n        \\<lbrakk>0 < d;\n         conemem u v t =\n         (1 / d) *\\<^sub>R ((1 - x) *\\<^sub>R u + x *\\<^sub>R v);\n         0 \\<le> x; x \\<le> 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: eq_vector_fraction_iff)"], ["proof (state)\nthis:\n  0 < d\n  conemem u v t = (1 / d) *\\<^sub>R ((1 - x) *\\<^sub>R u + x *\\<^sub>R v)\n  0 \\<le> x\n  x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R conemem u v t = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R conemem u v t = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "apply (rule exI[where x=\"c / d\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x.\n       c *\\<^sub>R conemem u v t = (c / d) *\\<^sub>R x \\<and>\n       0 \\<le> c / d \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "using dx"], ["proof (prove)\nusing this:\n  0 < d\n  conemem u v t = (1 / d) *\\<^sub>R ((1 - x) *\\<^sub>R u + x *\\<^sub>R v)\n  0 \\<le> x\n  x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>x.\n       c *\\<^sub>R conemem u v t = (c / d) *\\<^sub>R x \\<and>\n       0 \\<le> c / d \\<and>\n       (\\<exists>ua\\<ge>0.\n           ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)", "by (auto simp: intro!: divide_nonneg_nonneg prems )"], ["proof (state)\nthis:\n  \\<exists>ca x.\n     c *\\<^sub>R conemem u v t = ca *\\<^sub>R x \\<and>\n     0 \\<le> ca \\<and>\n     (\\<exists>ua\\<ge>0.\n         ua \\<le> 1 \\<and> x = (1 - ua) *\\<^sub>R u + ua *\\<^sub>R v)\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c ua.\n       \\<lbrakk>0 \\<le> c; 0 \\<le> ua; ua \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca x.\n                            c *\\<^sub>R\n                            ((1 - ua) *\\<^sub>R u + ua *\\<^sub>R v) =\n                            ca *\\<^sub>R x \\<and>\n                            0 \\<le> ca \\<and>\n                            x \\<in> conemem u v ` {0..pi / 2}", "subgoal premises prems for c t"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "let ?x = \"arctan (t / (1 - t))\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "let ?s = \"t / sin ?x\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "have *: \"c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) = (c * ?s) *\\<^sub>R (cos ?x *\\<^sub>R u + sin ?x *\\<^sub>R v)\"\n      if \"0 < t\" \"t < 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n    (c * (t / sin (arctan (t / (1 - t))))) *\\<^sub>R\n    (cos (arctan (t / (1 - t))) *\\<^sub>R u +\n     sin (arctan (t / (1 - t))) *\\<^sub>R v)", "using that"], ["proof (prove)\nusing this:\n  0 < t\n  t < 1\n\ngoal (1 subgoal):\n 1. c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n    (c * (t / sin (arctan (t / (1 - t))))) *\\<^sub>R\n    (cos (arctan (t / (1 - t))) *\\<^sub>R u +\n     sin (arctan (t / (1 - t))) *\\<^sub>R v)", "by (auto simp: scaleR_add_right sin_arctan cos_arctan divide_simps)"], ["proof (state)\nthis:\n  \\<lbrakk>0 < t; t < 1\\<rbrakk>\n  \\<Longrightarrow> c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                    (c * (t / sin (arctan (t / (1 - t))))) *\\<^sub>R\n                    (cos (arctan (t / (1 - t))) *\\<^sub>R u +\n                     sin (arctan (t / (1 - t))) *\\<^sub>R v)\n\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply (cases \"t = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. t = 0 \\<Longrightarrow>\n    \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}\n 2. t \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. t = 0 \\<Longrightarrow>\n    \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. t = 0 \\<Longrightarrow>\n    \\<exists>ca x.\n       c *\\<^sub>R u = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply (rule exI[where x=c])"], ["proof (prove)\ngoal (1 subgoal):\n 1. t = 0 \\<Longrightarrow>\n    \\<exists>x.\n       c *\\<^sub>R u = c *\\<^sub>R x \\<and>\n       0 \\<le> c \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply (rule exI[where x=u])"], ["proof (prove)\ngoal (1 subgoal):\n 1. t = 0 \\<Longrightarrow>\n    c *\\<^sub>R u = c *\\<^sub>R u \\<and>\n    0 \\<le> c \\<and> u \\<in> conemem u v ` {0..pi / 2}", "using prems"], ["proof (prove)\nusing this:\n  0 \\<le> c\n  0 \\<le> t\n  t \\<le> 1\n\ngoal (1 subgoal):\n 1. t = 0 \\<Longrightarrow>\n    c *\\<^sub>R u = c *\\<^sub>R u \\<and>\n    0 \\<le> c \\<and> u \\<in> conemem u v ` {0..pi / 2}", "by (auto simp: conemem_def[abs_def] intro!: image_eqI[where x=0])"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>ca x.\n       c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n       ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply (cases \"t = 1\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<noteq> 0; t = 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca x.\n                         c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                         ca *\\<^sub>R x \\<and>\n                         0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}\n 2. \\<lbrakk>t \\<noteq> 0; t \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca x.\n                         c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                         ca *\\<^sub>R x \\<and>\n                         0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<noteq> 0; t = 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca x.\n                         c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                         ca *\\<^sub>R x \\<and>\n                         0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. t = 1 \\<Longrightarrow>\n    \\<exists>ca x.\n       c *\\<^sub>R v = ca *\\<^sub>R x \\<and>\n       0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply (rule exI[where x=c])"], ["proof (prove)\ngoal (1 subgoal):\n 1. t = 1 \\<Longrightarrow>\n    \\<exists>x.\n       c *\\<^sub>R v = c *\\<^sub>R x \\<and>\n       0 \\<le> c \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply (rule exI[where x=v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. t = 1 \\<Longrightarrow>\n    c *\\<^sub>R v = c *\\<^sub>R v \\<and>\n    0 \\<le> c \\<and> v \\<in> conemem u v ` {0..pi / 2}", "using prems"], ["proof (prove)\nusing this:\n  0 \\<le> c\n  0 \\<le> t\n  t \\<le> 1\n\ngoal (1 subgoal):\n 1. t = 1 \\<Longrightarrow>\n    c *\\<^sub>R v = c *\\<^sub>R v \\<and>\n    0 \\<le> c \\<and> v \\<in> conemem u v ` {0..pi / 2}", "by (auto simp: conemem_def[abs_def] intro!: image_eqI[where x=\"pi/2\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<noteq> 0; t \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca x.\n                         c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                         ca *\\<^sub>R x \\<and>\n                         0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<noteq> 0; t \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca x.\n                         c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                         ca *\\<^sub>R x \\<and>\n                         0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}", "apply (rule exI[where x=\"(c * ?s)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<noteq> 0; t \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                         (c * (t / sin (arctan (t / (1 - t))))) *\\<^sub>R\n                         x \\<and>\n                         0 \\<le> c * (t / sin (arctan (t / (1 - t)))) \\<and>\n                         x \\<in> conemem u v ` {0..pi / 2}", "apply (rule exI[where x=\"(cos ?x *\\<^sub>R u + sin ?x *\\<^sub>R v)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<noteq> 0; t \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                      (c * (t / sin (arctan (t / (1 - t))))) *\\<^sub>R\n                      (cos (arctan (t / (1 - t))) *\\<^sub>R u +\n                       sin (arctan (t / (1 - t))) *\\<^sub>R v) \\<and>\n                      0 \\<le> c * (t / sin (arctan (t / (1 - t)))) \\<and>\n                      cos (arctan (t / (1 - t))) *\\<^sub>R u +\n                      sin (arctan (t / (1 - t))) *\\<^sub>R v\n                      \\<in> conemem u v ` {0..pi / 2}", "using prems * arctan_ubound[of \"t / (1 - t)\"]"], ["proof (prove)\nusing this:\n  0 \\<le> c\n  0 \\<le> t\n  t \\<le> 1\n  \\<lbrakk>0 < t; t < 1\\<rbrakk>\n  \\<Longrightarrow> c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                    (c * (t / sin (arctan (t / (1 - t))))) *\\<^sub>R\n                    (cos (arctan (t / (1 - t))) *\\<^sub>R u +\n                     sin (arctan (t / (1 - t))) *\\<^sub>R v)\n  arctan (t / (1 - t)) < pi / 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<noteq> 0; t \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n                      (c * (t / sin (arctan (t / (1 - t))))) *\\<^sub>R\n                      (cos (arctan (t / (1 - t))) *\\<^sub>R u +\n                       sin (arctan (t / (1 - t))) *\\<^sub>R v) \\<and>\n                      0 \\<le> c * (t / sin (arctan (t / (1 - t)))) \\<and>\n                      cos (arctan (t / (1 - t))) *\\<^sub>R u +\n                      sin (arctan (t / (1 - t))) *\\<^sub>R v\n                      \\<in> conemem u v ` {0..pi / 2}", "apply (auto simp: conemem_def[abs_def]  intro!: imageI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<noteq> 0; t \\<noteq> 1; 0 \\<le> c; 0 \\<le> t; t \\<le> 1;\n     c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n     (c * t / sin (arctan (t / (1 - t)))) *\\<^sub>R\n     (cos (arctan (t / (1 - t))) *\\<^sub>R u +\n      sin (arctan (t / (1 - t))) *\\<^sub>R v);\n     arctan (t / (1 - t)) * 2 < pi\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> c * t / sin (arctan (t / (1 - t)))", "by (auto simp: scaleR_add_right sin_arctan)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<exists>ca x.\n     c *\\<^sub>R ((1 - t) *\\<^sub>R u + t *\\<^sub>R v) =\n     ca *\\<^sub>R x \\<and>\n     0 \\<le> ca \\<and> x \\<in> conemem u v ` {0..pi / 2}\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma\n  bounded_linear_image_cone_hull:\n  assumes \"bounded_linear F\"\n  shows \"F ` (cone hull T) = cone hull (F ` T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F ` (cone hull T) = cone hull F ` T", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F ` (cone hull T) = cone hull F ` T", "from assms"], ["proof (chain)\npicking this:\n  bounded_linear F", "interpret bounded_linear F"], ["proof (prove)\nusing this:\n  bounded_linear F\n\ngoal (1 subgoal):\n 1. bounded_linear F", "."], ["proof (state)\ngoal (1 subgoal):\n 1. F ` (cone hull T) = cone hull F ` T", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. F ` (cone hull T) = cone hull F ` T", "apply (auto simp: conefield_def cone_hull_expl closed_segment_def add scaleR)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c xb.\n       \\<lbrakk>0 \\<le> c; xb \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca x.\n                            c *\\<^sub>R F xb = ca *\\<^sub>R x \\<and>\n                            0 \\<le> ca \\<and> x \\<in> F ` T\n 2. \\<And>c xb.\n       \\<lbrakk>0 \\<le> c; xb \\<in> T\\<rbrakk>\n       \\<Longrightarrow> c *\\<^sub>R F xb\n                         \\<in> F `\n                               {c *\\<^sub>R x |c x.\n                                0 \\<le> c \\<and> x \\<in> T}", "apply (auto simp: )"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c xb.\n       \\<lbrakk>0 \\<le> c; xb \\<in> T\\<rbrakk>\n       \\<Longrightarrow> c *\\<^sub>R F xb\n                         \\<in> F `\n                               {c *\\<^sub>R x |c x.\n                                0 \\<le> c \\<and> x \\<in> T}", "apply (auto simp: add[symmetric] scaleR[symmetric])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  F ` (cone hull T) = cone hull F ` T\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma\n  bounded_linear_image_conefield:\n  assumes \"bounded_linear F\"\n  shows \"F ` conefield u v = conefield (F u) (F v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F ` conefield u v = conefield (F u) (F v)", "unfolding conefield_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. F ` (cone hull conesegment u v) = cone hull conesegment (F u) (F v)", "using assms"], ["proof (prove)\nusing this:\n  bounded_linear F\n\ngoal (1 subgoal):\n 1. F ` (cone hull conesegment u v) = cone hull conesegment (F u) (F v)", "by (auto simp: bounded_linear_image_conesegment bounded_linear_image_cone_hull)"], ["", "lemma conefield_commute: \"conefield x y = conefield y x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. conefield x y = conefield y x", "by (auto simp: conefield_def conesegment_commute)"], ["", "lemma convex_conefield: \"convex (conefield x y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. convex (conefield x y)", "by (auto simp: conefield_alt_def convex_cone_hull)"], ["", "lemma conefield_scaleRI: \"v \\<in> conefield (r *\\<^sub>R x) y\" if \"v \\<in> conefield x y\" \"r > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v \\<in> conefield (r *\\<^sub>R x) y", "using that"], ["proof (prove)\nusing this:\n  v \\<in> conefield x y\n  0 < r\n\ngoal (1 subgoal):\n 1. v \\<in> conefield (r *\\<^sub>R x) y", "using \\<open>r > 0\\<close>"], ["proof (prove)\nusing this:\n  v \\<in> conefield x y\n  0 < r\n  0 < r\n\ngoal (1 subgoal):\n 1. v \\<in> conefield (r *\\<^sub>R x) y", "unfolding conefield_alt_def cone_hull_expl"], ["proof (prove)\nusing this:\n  v \\<in> {c *\\<^sub>R xa |c xa. 0 \\<le> c \\<and> xa \\<in> {x--y}}\n  0 < r\n  0 < r\n\ngoal (1 subgoal):\n 1. v \\<in> {c *\\<^sub>R xa |c xa.\n             0 \\<le> c \\<and> xa \\<in> {r *\\<^sub>R x--y}}", "apply (auto simp: in_segment)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "proof goal_cases"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "case (1 c u)"], ["proof (state)\nthis:\n  0 < r\n  v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y)\n  0 \\<le> c\n  0 \\<le> u\n  u \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "let ?d = \"c * (1 - u) / r + c * u\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "let ?t = \"c * u / ?d\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "have \"c * (1 - u) = ?d * (1 - ?t) * r\" if \"0 < u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c * (1 - u) =\n    (c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) * r", "using \\<open>0 < r\\<close> that(1) 1(3,5) mult_pos_pos"], ["proof (prove)\nusing this:\n  0 < r\n  0 < u\n  0 \\<le> c\n  u \\<le> 1\n  \\<lbrakk>(0::?'a) < ?a; (0::?'a) < ?b\\<rbrakk>\n  \\<Longrightarrow> (0::?'a) < ?a * ?b\n\ngoal (1 subgoal):\n 1. c * (1 - u) =\n    (c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) * r", "by (force simp: divide_simps ac_simps ring_distribs[symmetric])"], ["proof (state)\nthis:\n  0 < u \\<Longrightarrow>\n  c * (1 - u) =\n  (c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) * r\n\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "then"], ["proof (chain)\npicking this:\n  0 < u \\<Longrightarrow>\n  c * (1 - u) =\n  (c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) * r", "have eq1: \"(c * (1 - u)) *\\<^sub>R x = (?d * (1 - ?t) * r) *\\<^sub>R x\" if \"0 < u\""], ["proof (prove)\nusing this:\n  0 < u \\<Longrightarrow>\n  c * (1 - u) =\n  (c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) * r\n\ngoal (1 subgoal):\n 1. (c * (1 - u)) *\\<^sub>R x =\n    ((c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) *\n     r) *\\<^sub>R\n    x", "using that"], ["proof (prove)\nusing this:\n  0 < u \\<Longrightarrow>\n  c * (1 - u) =\n  (c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) * r\n  0 < u\n\ngoal (1 subgoal):\n 1. (c * (1 - u)) *\\<^sub>R x =\n    ((c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) *\n     r) *\\<^sub>R\n    x", "by simp"], ["proof (state)\nthis:\n  0 < u \\<Longrightarrow>\n  (c * (1 - u)) *\\<^sub>R x =\n  ((c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) *\n   r) *\\<^sub>R\n  x\n\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "have \"c * u = ?d * ?t\" if \"u < 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c * u = (c * (1 - u) / r + c * u) * (c * u / (c * (1 - u) / r + c * u))", "using \\<open>0 < r\\<close> that(1) 1(3,4,5) mult_pos_pos"], ["proof (prove)\nusing this:\n  0 < r\n  u < 1\n  0 \\<le> c\n  0 \\<le> u\n  u \\<le> 1\n  \\<lbrakk>(0::?'a) < ?a; (0::?'a) < ?b\\<rbrakk>\n  \\<Longrightarrow> (0::?'a) < ?a * ?b\n\ngoal (1 subgoal):\n 1. c * u = (c * (1 - u) / r + c * u) * (c * u / (c * (1 - u) / r + c * u))", "apply (auto simp: divide_simps ac_simps ring_distribs[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < r; u < 1; 0 \\<le> c; 0 \\<le> u;\n     \\<And>a b.\n        \\<lbrakk>(0::?'a5) < a; (0::?'a5) < b\\<rbrakk>\n        \\<Longrightarrow> (0::?'a5) < a * b;\n     1 - u + r * u = 0; c \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> u = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < r; u < 1; 0 \\<le> c; 0 \\<le> u;\n     \\<And>a b.\n        \\<lbrakk>(0::?'a5) < a; (0::?'a5) < b\\<rbrakk>\n        \\<Longrightarrow> (0::?'a5) < a * b;\n     1 - u + r * u = 0; c \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> u = 0", "assume \"0 \\<le> u\"\n      \"0 < r\"\n      \"1 - u + r * u = 0\"\n      \"u < 1\""], ["proof (state)\nthis:\n  0 \\<le> u\n  0 < r\n  1 - u + r * u = 0\n  u < 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < r; u < 1; 0 \\<le> c; 0 \\<le> u;\n     \\<And>a b.\n        \\<lbrakk>(0::?'a5) < a; (0::?'a5) < b\\<rbrakk>\n        \\<Longrightarrow> (0::?'a5) < a * b;\n     1 - u + r * u = 0; c \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> u = 0", "then"], ["proof (chain)\npicking this:\n  0 \\<le> u\n  0 < r\n  1 - u + r * u = 0\n  u < 1", "have False"], ["proof (prove)\nusing this:\n  0 \\<le> u\n  0 < r\n  1 - u + r * u = 0\n  u < 1\n\ngoal (1 subgoal):\n 1. False", "by (sos \"((((A<0 * A<1) * R<1) + (([~1*r] * A=0) + ((A<=0 * R<1) * (R<1 * [r]^2)))))\")"], ["proof (state)\nthis:\n  False\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < r; u < 1; 0 \\<le> c; 0 \\<le> u;\n     \\<And>a b.\n        \\<lbrakk>(0::?'a5) < a; (0::?'a5) < b\\<rbrakk>\n        \\<Longrightarrow> (0::?'a5) < a * b;\n     1 - u + r * u = 0; c \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> u = 0", "then"], ["proof (chain)\npicking this:\n  False", "show \"u = 0\""], ["proof (prove)\nusing this:\n  False\n\ngoal (1 subgoal):\n 1. u = 0", "by metis"], ["proof (state)\nthis:\n  u = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u < 1 \\<Longrightarrow>\n  c * u = (c * (1 - u) / r + c * u) * (c * u / (c * (1 - u) / r + c * u))\n\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "then"], ["proof (chain)\npicking this:\n  u < 1 \\<Longrightarrow>\n  c * u = (c * (1 - u) / r + c * u) * (c * u / (c * (1 - u) / r + c * u))", "have eq2: \"(c * u) *\\<^sub>R y = (?d * ?t) *\\<^sub>R y\" if \"u < 1\""], ["proof (prove)\nusing this:\n  u < 1 \\<Longrightarrow>\n  c * u = (c * (1 - u) / r + c * u) * (c * u / (c * (1 - u) / r + c * u))\n\ngoal (1 subgoal):\n 1. (c * u) *\\<^sub>R y =\n    ((c * (1 - u) / r + c * u) *\n     (c * u / (c * (1 - u) / r + c * u))) *\\<^sub>R\n    y", "using that"], ["proof (prove)\nusing this:\n  u < 1 \\<Longrightarrow>\n  c * u = (c * (1 - u) / r + c * u) * (c * u / (c * (1 - u) / r + c * u))\n  u < 1\n\ngoal (1 subgoal):\n 1. (c * u) *\\<^sub>R y =\n    ((c * (1 - u) / r + c * u) *\n     (c * u / (c * (1 - u) / r + c * u))) *\\<^sub>R\n    y", "by simp"], ["proof (state)\nthis:\n  u < 1 \\<Longrightarrow>\n  (c * u) *\\<^sub>R y =\n  ((c * (1 - u) / r + c * u) *\n   (c * u / (c * (1 - u) / r + c * u))) *\\<^sub>R\n  y\n\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "have *: \"c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) = ?d *\\<^sub>R ((1 - ?t) *\\<^sub>R r *\\<^sub>R x + ?t *\\<^sub>R y)\"\n    if \"0 < u\" \"u < 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n    (c * (1 - u) / r + c * u) *\\<^sub>R\n    ((1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R r *\\<^sub>R x +\n     (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R y)", "using that eq1 eq2"], ["proof (prove)\nusing this:\n  0 < u\n  u < 1\n  0 < u \\<Longrightarrow>\n  (c * (1 - u)) *\\<^sub>R x =\n  ((c * (1 - u) / r + c * u) * (1 - c * u / (c * (1 - u) / r + c * u)) *\n   r) *\\<^sub>R\n  x\n  u < 1 \\<Longrightarrow>\n  (c * u) *\\<^sub>R y =\n  ((c * (1 - u) / r + c * u) *\n   (c * u / (c * (1 - u) / r + c * u))) *\\<^sub>R\n  y\n\ngoal (1 subgoal):\n 1. c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n    (c * (1 - u) / r + c * u) *\\<^sub>R\n    ((1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R r *\\<^sub>R x +\n     (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R y)", "by (auto simp: algebra_simps)"], ["proof (state)\nthis:\n  \\<lbrakk>0 < u; u < 1\\<rbrakk>\n  \\<Longrightarrow> c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                    (c * (1 - u) / r + c * u) *\\<^sub>R\n                    ((1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                     r *\\<^sub>R x +\n                     (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R y)\n\ngoal (1 subgoal):\n 1. \\<And>c u.\n       \\<lbrakk>0 < r;\n        v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n        0 \\<le> u; u \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ca xa.\n                            c *\\<^sub>R\n                            ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                            ca *\\<^sub>R xa \\<and>\n                            0 \\<le> ca \\<and>\n                            (\\<exists>u\\<ge>0.\n                                u \\<le> 1 \\<and>\n                                xa =\n                                ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>ca xa.\n       c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n       ca *\\<^sub>R xa \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>u\\<ge>0.\n           u \\<le> 1 \\<and> xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "apply (cases \"u = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. u = 0 \\<Longrightarrow>\n    \\<exists>ca xa.\n       c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n       ca *\\<^sub>R xa \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>u\\<ge>0.\n           u \\<le> 1 \\<and> xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)\n 2. u \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>ca xa.\n       c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n       ca *\\<^sub>R xa \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>u\\<ge>0.\n           u \\<le> 1 \\<and> xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. u = 0 \\<Longrightarrow>\n    \\<exists>ca xa.\n       c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n       ca *\\<^sub>R xa \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>u\\<ge>0.\n           u \\<le> 1 \\<and> xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "using 1"], ["proof (prove)\nusing this:\n  0 < r\n  v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y)\n  0 \\<le> c\n  0 \\<le> u\n  u \\<le> 1\n\ngoal (1 subgoal):\n 1. u = 0 \\<Longrightarrow>\n    \\<exists>ca xa.\n       c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n       ca *\\<^sub>R xa \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>u\\<ge>0.\n           u \\<le> 1 \\<and> xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "by (intro exI[where x=\"c / r\"] exI[where x=\"r *\\<^sub>R x\"]) auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>ca xa.\n       c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n       ca *\\<^sub>R xa \\<and>\n       0 \\<le> ca \\<and>\n       (\\<exists>u\\<ge>0.\n           u \\<le> 1 \\<and> xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "apply (cases \"u = 1\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u = 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca xa.\n                         c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                         ca *\\<^sub>R xa \\<and>\n                         0 \\<le> ca \\<and>\n                         (\\<exists>u\\<ge>0.\n                             u \\<le> 1 \\<and>\n                             xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca xa.\n                         c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                         ca *\\<^sub>R xa \\<and>\n                         0 \\<le> ca \\<and>\n                         (\\<exists>u\\<ge>0.\n                             u \\<le> 1 \\<and>\n                             xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u = 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca xa.\n                         c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                         ca *\\<^sub>R xa \\<and>\n                         0 \\<le> ca \\<and>\n                         (\\<exists>u\\<ge>0.\n                             u \\<le> 1 \\<and>\n                             xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "using 1"], ["proof (prove)\nusing this:\n  0 < r\n  v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y)\n  0 \\<le> c\n  0 \\<le> u\n  u \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u = 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca xa.\n                         c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                         ca *\\<^sub>R xa \\<and>\n                         0 \\<le> ca \\<and>\n                         (\\<exists>u\\<ge>0.\n                             u \\<le> 1 \\<and>\n                             xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "by (intro exI[where x=\"c\"] exI[where x=\"y\"]) (auto intro!: exI[where x=1])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca xa.\n                         c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                         ca *\\<^sub>R xa \\<and>\n                         0 \\<le> ca \\<and>\n                         (\\<exists>u\\<ge>0.\n                             u \\<le> 1 \\<and>\n                             xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ca xa.\n                         c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                         ca *\\<^sub>R xa \\<and>\n                         0 \\<le> ca \\<and>\n                         (\\<exists>u\\<ge>0.\n                             u \\<le> 1 \\<and>\n                             xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "apply (rule exI[where x=\"?d\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                         (c * (1 - u) / r + c * u) *\\<^sub>R xa \\<and>\n                         0 \\<le> c * (1 - u) / r + c * u \\<and>\n                         (\\<exists>u\\<ge>0.\n                             u \\<le> 1 \\<and>\n                             xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)", "apply (rule exI[where x=\"((1 - ?t) *\\<^sub>R r *\\<^sub>R x + ?t *\\<^sub>R y)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n                      (c * (1 - u) / r + c * u) *\\<^sub>R\n                      ((1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                       r *\\<^sub>R x +\n                       (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                       y) \\<and>\n                      0 \\<le> c * (1 - u) / r + c * u \\<and>\n                      (\\<exists>ua\\<ge>0.\n                          ua \\<le> 1 \\<and>\n                          (1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                          r *\\<^sub>R x +\n                          (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R y =\n                          ((1 - ua) * r) *\\<^sub>R x + ua *\\<^sub>R y)", "apply (subst *)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk> \\<Longrightarrow> 0 < u\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk> \\<Longrightarrow> u < 1\n 3. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> (c * (1 - u) / r + c * u) *\\<^sub>R\n                      ((1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                       r *\\<^sub>R x +\n                       (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R y) =\n                      (c * (1 - u) / r + c * u) *\\<^sub>R\n                      ((1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                       r *\\<^sub>R x +\n                       (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                       y) \\<and>\n                      0 \\<le> c * (1 - u) / r + c * u \\<and>\n                      (\\<exists>ua\\<ge>0.\n                          ua \\<le> 1 \\<and>\n                          (1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                          r *\\<^sub>R x +\n                          (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R y =\n                          ((1 - ua) * r) *\\<^sub>R x + ua *\\<^sub>R y)", "using 1"], ["proof (prove)\nusing this:\n  0 < r\n  v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y)\n  0 \\<le> c\n  0 \\<le> u\n  u \\<le> 1\n\ngoal (3 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk> \\<Longrightarrow> 0 < u\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk> \\<Longrightarrow> u < 1\n 3. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> (c * (1 - u) / r + c * u) *\\<^sub>R\n                      ((1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                       r *\\<^sub>R x +\n                       (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R y) =\n                      (c * (1 - u) / r + c * u) *\\<^sub>R\n                      ((1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                       r *\\<^sub>R x +\n                       (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                       y) \\<and>\n                      0 \\<le> c * (1 - u) / r + c * u \\<and>\n                      (\\<exists>ua\\<ge>0.\n                          ua \\<le> 1 \\<and>\n                          (1 - c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R\n                          r *\\<^sub>R x +\n                          (c * u / (c * (1 - u) / r + c * u)) *\\<^sub>R y =\n                          ((1 - ua) * r) *\\<^sub>R x + ua *\\<^sub>R y)", "apply (auto intro!: exI[where x = ?t])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v = c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y); 0 \\<le> c;\n     0 \\<le> u; u \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> c * u / (c * (1 - u) / r + c * u) \\<le> 1", "apply (auto simp: algebra_simps divide_simps)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "defer"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u", "assume a1: \"c + c * (r * u) < c * u\""], ["proof (state)\nthis:\n  c + c * (r * u) < c * u\n\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u", "assume a2: \"0 \\<le> c\""], ["proof (state)\nthis:\n  0 \\<le> c\n\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u", "assume a3: \"0 \\<le> u\""], ["proof (state)\nthis:\n  0 \\<le> u\n\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u", "assume a4: \"u \\<noteq> 0\""], ["proof (state)\nthis:\n  u \\<noteq> 0\n\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u", "assume a5: \"0 < r\""], ["proof (state)\nthis:\n  0 < r\n\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u", "have \"c + c * (r * u) \\<le> c * u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c + c * (r * u) \\<le> c * u", "using a1 less_eq_real_def"], ["proof (prove)\nusing this:\n  c + c * (r * u) < c * u\n  (?x \\<le> ?y) = (?x < ?y \\<or> ?x = ?y)\n\ngoal (1 subgoal):\n 1. c + c * (r * u) \\<le> c * u", "by blast"], ["proof (state)\nthis:\n  c + c * (r * u) \\<le> c * u\n\ngoal (2 subgoals):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c\n 2. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c + c * (r * u) < c * u\\<rbrakk>\n    \\<Longrightarrow> c \\<le> c * u", "then"], ["proof (chain)\npicking this:\n  c + c * (r * u) \\<le> c * u", "show \"c \\<le> c * u\""], ["proof (prove)\nusing this:\n  c + c * (r * u) \\<le> c * u\n\ngoal (1 subgoal):\n 1. c \\<le> c * u", "using a5 a4 a3 a2"], ["proof (prove)\nusing this:\n  c + c * (r * u) \\<le> c * u\n  0 < r\n  u \\<noteq> 0\n  0 \\<le> u\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> c * u", "by (metis (no_types) less_add_same_cancel1 less_eq_real_def\n            mult_pos_pos order_trans real_scaleR_def real_vector.scale_zero_left)"], ["proof (state)\nthis:\n  c \\<le> c * u\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "assume a1: \"0 \\<le> c\""], ["proof (state)\nthis:\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "assume a2: \"u \\<le> 1\""], ["proof (state)\nthis:\n  u \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "have f3: \"\\<forall>x0. ((x0::real) < 1) = (\\<not> 1 \\<le> x0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x0. (x0 < 1) = (\\<not> 1 \\<le> x0)", "by auto"], ["proof (state)\nthis:\n  \\<forall>x0. (x0 < 1) = (\\<not> 1 \\<le> x0)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "have f4: \"\\<forall>x0. ((1::real) < x0) = (\\<not> x0 \\<le> 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x0. (1 < x0) = (\\<not> x0 \\<le> 1)", "by fastforce"], ["proof (state)\nthis:\n  \\<forall>x0. (1 < x0) = (\\<not> x0 \\<le> 1)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "have \"\\<forall>x0 x1. ((x1::real) < x1 * x0) = (\\<not> 0 \\<le> x1 + - 1 * (x1 * x0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x0 x1. (x1 < x1 * x0) = (\\<not> 0 \\<le> x1 + - 1 * (x1 * x0))", "by auto"], ["proof (state)\nthis:\n  \\<forall>x0 x1. (x1 < x1 * x0) = (\\<not> 0 \\<le> x1 + - 1 * (x1 * x0))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "then"], ["proof (chain)\npicking this:\n  \\<forall>x0 x1. (x1 < x1 * x0) = (\\<not> 0 \\<le> x1 + - 1 * (x1 * x0))", "have \"(\\<forall>r ra. ((r::real) < r * ra) = ((0 \\<le> r \\<longrightarrow> 1 < ra) \\<and> (r \\<le> 0 \\<longrightarrow> ra < 1))) = (\\<forall>r ra. (\\<not> (0::real) \\<le> r + - 1 * (r * ra)) = ((\\<not> 0 \\<le> r \\<or> \\<not> ra \\<le> 1) \\<and> (\\<not> r \\<le> 0 \\<or> \\<not> 1 \\<le> ra)))\""], ["proof (prove)\nusing this:\n  \\<forall>x0 x1. (x1 < x1 * x0) = (\\<not> 0 \\<le> x1 + - 1 * (x1 * x0))\n\ngoal (1 subgoal):\n 1. (\\<forall>r ra.\n        (r < r * ra) =\n        ((0 \\<le> r \\<longrightarrow> 1 < ra) \\<and>\n         (r \\<le> 0 \\<longrightarrow> ra < 1))) =\n    (\\<forall>r ra.\n        (\\<not> 0 \\<le> r + - 1 * (r * ra)) =\n        ((\\<not> 0 \\<le> r \\<or> \\<not> ra \\<le> 1) \\<and>\n         (\\<not> r \\<le> 0 \\<or> \\<not> 1 \\<le> ra)))", "using f4 f3"], ["proof (prove)\nusing this:\n  \\<forall>x0 x1. (x1 < x1 * x0) = (\\<not> 0 \\<le> x1 + - 1 * (x1 * x0))\n  \\<forall>x0. (1 < x0) = (\\<not> x0 \\<le> 1)\n  \\<forall>x0. (x0 < 1) = (\\<not> 1 \\<le> x0)\n\ngoal (1 subgoal):\n 1. (\\<forall>r ra.\n        (r < r * ra) =\n        ((0 \\<le> r \\<longrightarrow> 1 < ra) \\<and>\n         (r \\<le> 0 \\<longrightarrow> ra < 1))) =\n    (\\<forall>r ra.\n        (\\<not> 0 \\<le> r + - 1 * (r * ra)) =\n        ((\\<not> 0 \\<le> r \\<or> \\<not> ra \\<le> 1) \\<and>\n         (\\<not> r \\<le> 0 \\<or> \\<not> 1 \\<le> ra)))", "by presburger"], ["proof (state)\nthis:\n  (\\<forall>r ra.\n      (r < r * ra) =\n      ((0 \\<le> r \\<longrightarrow> 1 < ra) \\<and>\n       (r \\<le> 0 \\<longrightarrow> ra < 1))) =\n  (\\<forall>r ra.\n      (\\<not> 0 \\<le> r + - 1 * (r * ra)) =\n      ((\\<not> 0 \\<le> r \\<or> \\<not> ra \\<le> 1) \\<and>\n       (\\<not> r \\<le> 0 \\<or> \\<not> 1 \\<le> ra)))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "then"], ["proof (chain)\npicking this:\n  (\\<forall>r ra.\n      (r < r * ra) =\n      ((0 \\<le> r \\<longrightarrow> 1 < ra) \\<and>\n       (r \\<le> 0 \\<longrightarrow> ra < 1))) =\n  (\\<forall>r ra.\n      (\\<not> 0 \\<le> r + - 1 * (r * ra)) =\n      ((\\<not> 0 \\<le> r \\<or> \\<not> ra \\<le> 1) \\<and>\n       (\\<not> r \\<le> 0 \\<or> \\<not> 1 \\<le> ra)))", "have \"0 \\<le> c + - 1 * (c * u)\""], ["proof (prove)\nusing this:\n  (\\<forall>r ra.\n      (r < r * ra) =\n      ((0 \\<le> r \\<longrightarrow> 1 < ra) \\<and>\n       (r \\<le> 0 \\<longrightarrow> ra < 1))) =\n  (\\<forall>r ra.\n      (\\<not> 0 \\<le> r + - 1 * (r * ra)) =\n      ((\\<not> 0 \\<le> r \\<or> \\<not> ra \\<le> 1) \\<and>\n       (\\<not> r \\<le> 0 \\<or> \\<not> 1 \\<le> ra)))\n\ngoal (1 subgoal):\n 1. 0 \\<le> c + - 1 * (c * u)", "using a2 a1 mult_less_cancel_left1"], ["proof (prove)\nusing this:\n  (\\<forall>r ra.\n      (r < r * ra) =\n      ((0 \\<le> r \\<longrightarrow> 1 < ra) \\<and>\n       (r \\<le> 0 \\<longrightarrow> ra < 1))) =\n  (\\<forall>r ra.\n      (\\<not> 0 \\<le> r + - 1 * (r * ra)) =\n      ((\\<not> 0 \\<le> r \\<or> \\<not> ra \\<le> 1) \\<and>\n       (\\<not> r \\<le> 0 \\<or> \\<not> 1 \\<le> ra)))\n  u \\<le> 1\n  0 \\<le> c\n  (?c < ?c * ?b) =\n  (((0::?'a) \\<le> ?c \\<longrightarrow> (1::?'a) < ?b) \\<and>\n   (?c \\<le> (0::?'a) \\<longrightarrow> ?b < (1::?'a)))\n\ngoal (1 subgoal):\n 1. 0 \\<le> c + - 1 * (c * u)", "by blast"], ["proof (state)\nthis:\n  0 \\<le> c + - 1 * (c * u)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> 0; u \\<noteq> 1; 0 < r;\n     v + (c * u) *\\<^sub>R x = c *\\<^sub>R x + (c * u) *\\<^sub>R y;\n     0 \\<le> c; 0 \\<le> u; u \\<le> 1; c * u < c + c * (r * u)\\<rbrakk>\n    \\<Longrightarrow> c * u \\<le> c", "then"], ["proof (chain)\npicking this:\n  0 \\<le> c + - 1 * (c * u)", "show \"c * u \\<le> c\""], ["proof (prove)\nusing this:\n  0 \\<le> c + - 1 * (c * u)\n\ngoal (1 subgoal):\n 1. c * u \\<le> c", "by auto"], ["proof (state)\nthis:\n  c * u \\<le> c\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<exists>ca xa.\n     c *\\<^sub>R ((1 - u) *\\<^sub>R x + u *\\<^sub>R y) =\n     ca *\\<^sub>R xa \\<and>\n     0 \\<le> ca \\<and>\n     (\\<exists>u\\<ge>0.\n         u \\<le> 1 \\<and> xa = ((1 - u) * r) *\\<^sub>R x + u *\\<^sub>R y)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma conefield_scaleRD: \"v \\<in> conefield x y\" if \"v \\<in> conefield (r *\\<^sub>R x) y\" \"r > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v \\<in> conefield x y", "using conefield_scaleRI[OF that(1) positive_imp_inverse_positive[OF that(2)]] that(2)"], ["proof (prove)\nusing this:\n  v \\<in> conefield (r *\\<^sub>R x /\\<^sub>R r) y\n  0 < r\n\ngoal (1 subgoal):\n 1. v \\<in> conefield x y", "by auto"], ["", "lemma conefield_scaleR: \"conefield (r *\\<^sub>R x) y = conefield x y\" if \"r > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. conefield (r *\\<^sub>R x) y = conefield x y", "using conefield_scaleRD conefield_scaleRI that"], ["proof (prove)\nusing this:\n  \\<lbrakk>?v \\<in> conefield (?r *\\<^sub>R ?x) ?y; 0 < ?r\\<rbrakk>\n  \\<Longrightarrow> ?v \\<in> conefield ?x ?y\n  \\<lbrakk>?v \\<in> conefield ?x ?y; 0 < ?r\\<rbrakk>\n  \\<Longrightarrow> ?v \\<in> conefield (?r *\\<^sub>R ?x) ?y\n  0 < r\n\ngoal (1 subgoal):\n 1. conefield (r *\\<^sub>R x) y = conefield x y", "by blast"], ["", "lemma conefield_expansion_estimate:\n  fixes u v::\"'a::euclidean_space\" and F::\"'a \\<Rightarrow> 'a\"\n  assumes \"t \\<in> {0 .. pi / 2}\"\n  assumes angle_pos: \"0 < vangle u v\" \"vangle u v < pi / 2\"\n  assumes angle_le: \"vangle (F u) (F v) \\<le> vangle u v\"\n  assumes \"bounded_linear F\"\n  assumes \"x \\<in> conefield u v\"\n  shows \"norm (F x) \\<ge> min (norm (F u)/norm u) (norm (F v)/norm v) * norm x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "assume [simp]: \"x \\<noteq> 0\""], ["proof (state)\nthis:\n  x \\<noteq> (0::'a)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "from assms"], ["proof (chain)\npicking this:\n  t \\<in> {0..pi / 2}\n  0 < vangle u v\n  vangle u v < pi / 2\n  vangle (F u) (F v) \\<le> vangle u v\n  bounded_linear F\n  x \\<in> conefield u v", "have [simp]: \"u \\<noteq> 0\" \"v \\<noteq> 0\""], ["proof (prove)\nusing this:\n  t \\<in> {0..pi / 2}\n  0 < vangle u v\n  vangle u v < pi / 2\n  vangle (F u) (F v) \\<le> vangle u v\n  bounded_linear F\n  x \\<in> conefield u v\n\ngoal (1 subgoal):\n 1. u \\<noteq> (0::'a) &&& v \\<noteq> (0::'a)", "by auto"], ["proof (state)\nthis:\n  u \\<noteq> (0::'a)\n  v \\<noteq> (0::'a)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "interpret bounded_linear F"], ["proof (prove)\ngoal (1 subgoal):\n 1. bounded_linear F", "by fact"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "define u1 where \"u1 = u /\\<^sub>R norm u\""], ["proof (state)\nthis:\n  u1 = u /\\<^sub>R norm u\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "define v1 where \"v1 = v /\\<^sub>R norm v\""], ["proof (state)\nthis:\n  v1 = v /\\<^sub>R norm v\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "note \\<open>x \\<in> conefield u v\\<close>"], ["proof (state)\nthis:\n  x \\<in> conefield u v\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "also"], ["proof (state)\nthis:\n  x \\<in> conefield u v\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "have \\<open>conefield u v = conefield u1 v1\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. conefield u v = conefield u1 v1", "by (auto simp: u1_def v1_def conefield_scaleR conefield_commute[of u])"], ["proof (state)\nthis:\n  conefield u v = conefield u1 v1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "finally"], ["proof (chain)\npicking this:\n  x \\<in> conefield u1 v1", "obtain c t where x: \"x = c *\\<^sub>R conemem u1 v1 t\" \"t \\<in> {0 .. pi / 2}\" \"c \\<ge> 0\""], ["proof (prove)\nusing this:\n  x \\<in> conefield u1 v1\n\ngoal (1 subgoal):\n 1. (\\<And>c t.\n        \\<lbrakk>x = c *\\<^sub>R conemem u1 v1 t; t \\<in> {0..pi / 2};\n         0 \\<le> c\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: conefield_def cone_hull_expl conesegment_def)"], ["proof (state)\nthis:\n  x = c *\\<^sub>R conemem u1 v1 t\n  t \\<in> {0..pi / 2}\n  0 \\<le> c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "then"], ["proof (chain)\npicking this:\n  x = c *\\<^sub>R conemem u1 v1 t\n  t \\<in> {0..pi / 2}\n  0 \\<le> c", "have xc: \"x /\\<^sub>R c = conemem u1 v1 t\""], ["proof (prove)\nusing this:\n  x = c *\\<^sub>R conemem u1 v1 t\n  t \\<in> {0..pi / 2}\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. x /\\<^sub>R c = conemem u1 v1 t", "by (auto simp: divide_simps)"], ["proof (state)\nthis:\n  x /\\<^sub>R c = conemem u1 v1 t\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "also"], ["proof (state)\nthis:\n  x /\\<^sub>R c = conemem u1 v1 t\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "have \"F \\<dots> = conemem (F u1) (F v1) t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (conemem u1 v1 t) = conemem (F u1) (F v1) t", "by (simp add: bounded_linear_image_conemem assms)"], ["proof (state)\nthis:\n  F (conemem u1 v1 t) = conemem (F u1) (F v1) t\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "also"], ["proof (state)\nthis:\n  F (conemem u1 v1 t) = conemem (F u1) (F v1) t\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "have \"norm \\<dots> \\<ge> min (norm (F u1)) (norm (F v1)) * norm (conemem u1 v1 t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. min (norm (F u1)) (norm (F v1)) * norm (conemem u1 v1 t)\n    \\<le> norm (conemem (F u1) (F v1) t)", "apply (rule conemem_expansion_estimate)"], ["proof (prove)\ngoal (6 subgoals):\n 1. t \\<in> {0..pi / 2}\n 2. 0 < vangle u1 v1\n 3. vangle u1 v1 < pi / 2\n 4. vangle (F u1) (F v1) \\<le> vangle u1 v1\n 5. norm u1 = 1\n 6. norm v1 = 1", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> {0..pi / 2}", "by fact"], ["proof (prove)\ngoal (5 subgoals):\n 1. 0 < vangle u1 v1\n 2. vangle u1 v1 < pi / 2\n 3. vangle (F u1) (F v1) \\<le> vangle u1 v1\n 4. norm u1 = 1\n 5. norm v1 = 1", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < vangle u1 v1", "using angle_pos"], ["proof (prove)\nusing this:\n  0 < vangle u v\n  vangle u v < pi / 2\n\ngoal (1 subgoal):\n 1. 0 < vangle u1 v1", "by (simp add: u1_def v1_def vangle_scaleR)"], ["proof (prove)\ngoal (4 subgoals):\n 1. vangle u1 v1 < pi / 2\n 2. vangle (F u1) (F v1) \\<le> vangle u1 v1\n 3. norm u1 = 1\n 4. norm v1 = 1", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. vangle u1 v1 < pi / 2", "using angle_pos"], ["proof (prove)\nusing this:\n  0 < vangle u v\n  vangle u v < pi / 2\n\ngoal (1 subgoal):\n 1. vangle u1 v1 < pi / 2", "by (simp add: u1_def v1_def vangle_scaleR)"], ["proof (prove)\ngoal (3 subgoals):\n 1. vangle (F u1) (F v1) \\<le> vangle u1 v1\n 2. norm u1 = 1\n 3. norm v1 = 1", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. vangle (F u1) (F v1) \\<le> vangle u1 v1", "using angle_le"], ["proof (prove)\nusing this:\n  vangle (F u) (F v) \\<le> vangle u v\n\ngoal (1 subgoal):\n 1. vangle (F u1) (F v1) \\<le> vangle u1 v1", "by (simp add: u1_def v1_def scaleR vangle_scaleR)"], ["proof (prove)\ngoal (2 subgoals):\n 1. norm u1 = 1\n 2. norm v1 = 1", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. norm u1 = 1", "using angle_le"], ["proof (prove)\nusing this:\n  vangle (F u) (F v) \\<le> vangle u v\n\ngoal (1 subgoal):\n 1. norm u1 = 1", "by (simp add: u1_def v1_def scaleR vangle_scaleR)"], ["proof (prove)\ngoal (1 subgoal):\n 1. norm v1 = 1", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. norm v1 = 1", "using angle_le"], ["proof (prove)\nusing this:\n  vangle (F u) (F v) \\<le> vangle u v\n\ngoal (1 subgoal):\n 1. norm v1 = 1", "by (simp add: u1_def v1_def scaleR vangle_scaleR)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  min (norm (F u1)) (norm (F v1)) * norm (conemem u1 v1 t)\n  \\<le> norm (conemem (F u1) (F v1) t)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)\n 2. \\<not> ?P \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "finally"], ["proof (chain)\npicking this:\n  min (norm (F u1)) (norm (F v1)) * norm (conemem u1 v1 t)\n  \\<le> norm (F (x /\\<^sub>R c))", "show \"norm (F x) \\<ge> min (norm (F u)/norm u) (norm (F v)/norm v) * norm x\""], ["proof (prove)\nusing this:\n  min (norm (F u1)) (norm (F v1)) * norm (conemem u1 v1 t)\n  \\<le> norm (F (x /\\<^sub>R c))\n\ngoal (1 subgoal):\n 1. min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "unfolding xc[symmetric] scaleR u1_def v1_def norm_scaleR x"], ["proof (prove)\nusing this:\n  min (\\<bar>inverse (norm u)\\<bar> * norm (F u))\n   (\\<bar>inverse (norm v)\\<bar> * norm (F v)) *\n  norm (conemem (u /\\<^sub>R norm u) (v /\\<^sub>R norm v) t)\n  \\<le> \\<bar>inverse c\\<bar> *\n        (\\<bar>c\\<bar> *\n         norm (F (conemem (u /\\<^sub>R norm u) (v /\\<^sub>R norm v) t)))\n\ngoal (1 subgoal):\n 1. min (norm (F u) / norm u) (norm (F v) / norm v) *\n    (\\<bar>c\\<bar> *\n     norm (conemem (u /\\<^sub>R norm u) (v /\\<^sub>R norm v) t))\n    \\<le> \\<bar>c\\<bar> *\n          norm (F (conemem (u /\\<^sub>R norm u) (v /\\<^sub>R norm v) t))", "using \\<open>c \\<ge> 0\\<close>"], ["proof (prove)\nusing this:\n  min (\\<bar>inverse (norm u)\\<bar> * norm (F u))\n   (\\<bar>inverse (norm v)\\<bar> * norm (F v)) *\n  norm (conemem (u /\\<^sub>R norm u) (v /\\<^sub>R norm v) t)\n  \\<le> \\<bar>inverse c\\<bar> *\n        (\\<bar>c\\<bar> *\n         norm (F (conemem (u /\\<^sub>R norm u) (v /\\<^sub>R norm v) t)))\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. min (norm (F u) / norm u) (norm (F v) / norm v) *\n    (\\<bar>c\\<bar> *\n     norm (conemem (u /\\<^sub>R norm u) (v /\\<^sub>R norm v) t))\n    \\<le> \\<bar>c\\<bar> *\n          norm (F (conemem (u /\\<^sub>R norm u) (v /\\<^sub>R norm v) t))", "by (simp add: divide_simps split: if_splits)"], ["proof (state)\nthis:\n  min (norm (F u) / norm u) (norm (F v) / norm v) * norm x \\<le> norm (F x)\n\ngoal (1 subgoal):\n 1. \\<not> x \\<noteq> (0::'a) \\<Longrightarrow>\n    min (norm (F u) / norm u) (norm (F v) / norm v) * norm x\n    \\<le> norm (F x)", "qed simp"], ["", "lemma conefield_rightI:\n  assumes ij: \"i \\<in> Basis\" \"j \\<in> Basis\" and ij_neq: \"i \\<noteq> j\"\n  assumes \"y \\<in> {y1 .. y2}\"\n  shows \"(i + y *\\<^sub>R j) \\<in> conefield (i + y1 *\\<^sub>R j) (i + y2 *\\<^sub>R j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i + y *\\<^sub>R j\n    \\<in> conefield (i + y1 *\\<^sub>R j) (i + y2 *\\<^sub>R j)", "unfolding conefield_alt_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. i + y *\\<^sub>R j\n    \\<in> cone hull {i + y1 *\\<^sub>R j--i + y2 *\\<^sub>R j}", "apply (rule hull_inc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. i + y *\\<^sub>R j \\<in> {i + y1 *\\<^sub>R j--i + y2 *\\<^sub>R j}", "using assms"], ["proof (prove)\nusing this:\n  i \\<in> Basis\n  j \\<in> Basis\n  i \\<noteq> j\n  y \\<in> {y1..y2}\n\ngoal (1 subgoal):\n 1. i + y *\\<^sub>R j \\<in> {i + y1 *\\<^sub>R j--i + y2 *\\<^sub>R j}", "by (auto simp: in_segment divide_simps inner_Basis algebra_simps\n      intro!: exI[where x=\"(y - y1) / (y2 - y1)\"] euclidean_eqI[where 'a='a] )"], ["", "lemma conefield_right_vangleI:\n  assumes ij: \"i \\<in> Basis\" \"j \\<in> Basis\" and ij_neq: \"i \\<noteq> j\"\n  assumes \"y \\<in> {y1 .. y2}\" \"y1 < y2\"\n  shows \"(i + y *\\<^sub>R j) \\<in> conefield (i + y1 *\\<^sub>R j) (i + y2 *\\<^sub>R j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i + y *\\<^sub>R j\n    \\<in> conefield (i + y1 *\\<^sub>R j) (i + y2 *\\<^sub>R j)", "unfolding conefield_alt_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. i + y *\\<^sub>R j\n    \\<in> cone hull {i + y1 *\\<^sub>R j--i + y2 *\\<^sub>R j}", "apply (rule hull_inc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. i + y *\\<^sub>R j \\<in> {i + y1 *\\<^sub>R j--i + y2 *\\<^sub>R j}", "using assms"], ["proof (prove)\nusing this:\n  i \\<in> Basis\n  j \\<in> Basis\n  i \\<noteq> j\n  y \\<in> {y1..y2}\n  y1 < y2\n\ngoal (1 subgoal):\n 1. i + y *\\<^sub>R j \\<in> {i + y1 *\\<^sub>R j--i + y2 *\\<^sub>R j}", "by (auto simp: in_segment divide_simps inner_Basis algebra_simps\n      intro!: exI[where x=\"(y - y1) / (y2 - y1)\"] euclidean_eqI[where 'a='a] )"], ["", "lemma cone_conefield[intro, simp]: \"cone (conefield x y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cone (conefield x y)", "unfolding conefield_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. cone (cone hull conesegment x y)", "by (rule cone_cone_hull)"], ["", "lemma conefield_mk_rightI:\n  assumes ij: \"i \\<in> Basis\" \"j \\<in> Basis\" and ij_neq: \"i \\<noteq> j\"\n  assumes \"(i + (y / x) *\\<^sub>R j) \\<in> conefield (i + (y1 / x1) *\\<^sub>R j) (i + (y2 / x2) *\\<^sub>R j)\"\n  assumes \"x > 0\" \"x1 > 0\" \"x2 > 0\"\n  shows \"(x *\\<^sub>R i + y *\\<^sub>R j) \\<in> conefield (x1 *\\<^sub>R i + y1 *\\<^sub>R j) (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x *\\<^sub>R i + y *\\<^sub>R j\n    \\<in> conefield (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n           (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. x *\\<^sub>R i + y *\\<^sub>R j\n    \\<in> conefield (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n           (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "have rescale: \"(x *\\<^sub>R i + y *\\<^sub>R j) = x *\\<^sub>R (i + (y / x) *\\<^sub>R j)\" if \"x > 0\" for x y"], ["proof (prove)\ngoal (1 subgoal):\n 1. x *\\<^sub>R i + y *\\<^sub>R j = x *\\<^sub>R (i + (y / x) *\\<^sub>R j)", "using that"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. x *\\<^sub>R i + y *\\<^sub>R j = x *\\<^sub>R (i + (y / x) *\\<^sub>R j)", "by (auto simp: algebra_simps)"], ["proof (state)\nthis:\n  0 < ?x \\<Longrightarrow>\n  ?x *\\<^sub>R i + ?y *\\<^sub>R j = ?x *\\<^sub>R (i + (?y / ?x) *\\<^sub>R j)\n\ngoal (1 subgoal):\n 1. x *\\<^sub>R i + y *\\<^sub>R j\n    \\<in> conefield (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n           (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. x *\\<^sub>R i + y *\\<^sub>R j\n    \\<in> conefield (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n           (x2 *\\<^sub>R i + y2 *\\<^sub>R j)", "unfolding rescale[OF \\<open>x > 0\\<close>] rescale[OF \\<open>x1 > 0\\<close>] rescale[OF \\<open>x2 > 0\\<close>]\n      conefield_scaleR[OF \\<open>x1 > 0\\<close>]"], ["proof (prove)\ngoal (1 subgoal):\n 1. x *\\<^sub>R (i + (y / x) *\\<^sub>R j)\n    \\<in> conefield (i + (y1 / x1) *\\<^sub>R j)\n           (x2 *\\<^sub>R (i + (y2 / x2) *\\<^sub>R j))", "apply (subst conefield_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x *\\<^sub>R (i + (y / x) *\\<^sub>R j)\n    \\<in> conefield (x2 *\\<^sub>R (i + (y2 / x2) *\\<^sub>R j))\n           (i + (y1 / x1) *\\<^sub>R j)", "unfolding conefield_scaleR[OF \\<open>x2 > 0\\<close>]"], ["proof (prove)\ngoal (1 subgoal):\n 1. x *\\<^sub>R (i + (y / x) *\\<^sub>R j)\n    \\<in> conefield (i + (y2 / x2) *\\<^sub>R j) (i + (y1 / x1) *\\<^sub>R j)", "apply (rule mem_cone)"], ["proof (prove)\ngoal (3 subgoals):\n 1. cone (conefield (i + (y2 / x2) *\\<^sub>R j) (i + (y1 / x1) *\\<^sub>R j))\n 2. i + (y / x) *\\<^sub>R j\n    \\<in> conefield (i + (y2 / x2) *\\<^sub>R j) (i + (y1 / x1) *\\<^sub>R j)\n 3. 0 \\<le> x", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. i + (y / x) *\\<^sub>R j\n    \\<in> conefield (i + (y2 / x2) *\\<^sub>R j) (i + (y1 / x1) *\\<^sub>R j)\n 2. 0 \\<le> x", "apply (subst conefield_commute)"], ["proof (prove)\ngoal (2 subgoals):\n 1. i + (y / x) *\\<^sub>R j\n    \\<in> conefield (i + (y1 / x1) *\\<^sub>R j) (i + (y2 / x2) *\\<^sub>R j)\n 2. 0 \\<le> x", "by (auto intro!: assms less_imp_le)"], ["proof (state)\nthis:\n  x *\\<^sub>R i + y *\\<^sub>R j\n  \\<in> conefield (x1 *\\<^sub>R i + y1 *\\<^sub>R j)\n         (x2 *\\<^sub>R i + y2 *\\<^sub>R j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma conefield_prod3I:\n  assumes \"x > 0\" \"x1 > 0\" \"x2 > 0\"\n  assumes \"y1 / x1 \\<le> y / x\" \"y / x \\<le> y2 / x2\"\n  shows \"(x, y, 0) \\<in> (conefield (x1, y1, 0) (x2, y2, 0)::(real*real*real) set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x, y, 0) \\<in> conefield (x1, y1, 0) (x2, y2, 0)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (x, y, 0) \\<in> conefield (x1, y1, 0) (x2, y2, 0)", "have \"(x *\\<^sub>R (1, 0, 0) + y *\\<^sub>R (0, 1, 0)) \\<in>\n    (conefield (x1 *\\<^sub>R (1, 0, 0) + y1 *\\<^sub>R (0, 1, 0)) (x2 *\\<^sub>R (1, 0, 0) + y2 *\\<^sub>R (0, 1, 0))::(real*real*real) set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x *\\<^sub>R (1, 0, 0) + y *\\<^sub>R (0, 1, 0)\n    \\<in> conefield (x1 *\\<^sub>R (1, 0, 0) + y1 *\\<^sub>R (0, 1, 0))\n           (x2 *\\<^sub>R (1, 0, 0) + y2 *\\<^sub>R (0, 1, 0))", "apply (rule conefield_mk_rightI)"], ["proof (prove)\ngoal (7 subgoals):\n 1. (1, 0, 0) \\<in> Basis\n 2. (0, 1, 0) \\<in> Basis\n 3. (1, 0, 0) \\<noteq> (0, 1, 0)\n 4. (1, 0, 0) + (y / x) *\\<^sub>R (0, 1, 0)\n    \\<in> conefield ((1, 0, 0) + (y1 / x1) *\\<^sub>R (0, 1, 0))\n           ((1, 0, 0) + (y2 / x2) *\\<^sub>R (0, 1, 0))\n 5. 0 < x\n 6. 0 < x1\n 7. 0 < x2", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (1, 0, 0) \\<in> Basis", "by (auto simp: Basis_prod_def zero_prod_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. (0, 1, 0) \\<in> Basis\n 2. (1, 0, 0) \\<noteq> (0, 1, 0)\n 3. (1, 0, 0) + (y / x) *\\<^sub>R (0, 1, 0)\n    \\<in> conefield ((1, 0, 0) + (y1 / x1) *\\<^sub>R (0, 1, 0))\n           ((1, 0, 0) + (y2 / x2) *\\<^sub>R (0, 1, 0))\n 4. 0 < x\n 5. 0 < x1\n 6. 0 < x2", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (0, 1, 0) \\<in> Basis", "by (auto simp: Basis_prod_def zero_prod_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. (1, 0, 0) \\<noteq> (0, 1, 0)\n 2. (1, 0, 0) + (y / x) *\\<^sub>R (0, 1, 0)\n    \\<in> conefield ((1, 0, 0) + (y1 / x1) *\\<^sub>R (0, 1, 0))\n           ((1, 0, 0) + (y2 / x2) *\\<^sub>R (0, 1, 0))\n 3. 0 < x\n 4. 0 < x1\n 5. 0 < x2", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (1, 0, 0) \\<noteq> (0, 1, 0)", "by (auto simp: Basis_prod_def zero_prod_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. (1, 0, 0) + (y / x) *\\<^sub>R (0, 1, 0)\n    \\<in> conefield ((1, 0, 0) + (y1 / x1) *\\<^sub>R (0, 1, 0))\n           ((1, 0, 0) + (y2 / x2) *\\<^sub>R (0, 1, 0))\n 2. 0 < x\n 3. 0 < x1\n 4. 0 < x2", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (1, 0, 0) + (y / x) *\\<^sub>R (0, 1, 0)\n    \\<in> conefield ((1, 0, 0) + (y1 / x1) *\\<^sub>R (0, 1, 0))\n           ((1, 0, 0) + (y2 / x2) *\\<^sub>R (0, 1, 0))", "using assms"], ["proof (prove)\nusing this:\n  0 < x\n  0 < x1\n  0 < x2\n  y1 / x1 \\<le> y / x\n  y / x \\<le> y2 / x2\n\ngoal (1 subgoal):\n 1. (1, 0, 0) + (y / x) *\\<^sub>R (0, 1, 0)\n    \\<in> conefield ((1, 0, 0) + (y1 / x1) *\\<^sub>R (0, 1, 0))\n           ((1, 0, 0) + (y2 / x2) *\\<^sub>R (0, 1, 0))", "by (intro conefield_rightI) (auto simp: Basis_prod_def zero_prod_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. 0 < x\n 2. 0 < x1\n 3. 0 < x2", "by (auto intro: assms)"], ["proof (state)\nthis:\n  x *\\<^sub>R (1, 0, 0) + y *\\<^sub>R (0, 1, 0)\n  \\<in> conefield (x1 *\\<^sub>R (1, 0, 0) + y1 *\\<^sub>R (0, 1, 0))\n         (x2 *\\<^sub>R (1, 0, 0) + y2 *\\<^sub>R (0, 1, 0))\n\ngoal (1 subgoal):\n 1. (x, y, 0) \\<in> conefield (x1, y1, 0) (x2, y2, 0)", "then"], ["proof (chain)\npicking this:\n  x *\\<^sub>R (1, 0, 0) + y *\\<^sub>R (0, 1, 0)\n  \\<in> conefield (x1 *\\<^sub>R (1, 0, 0) + y1 *\\<^sub>R (0, 1, 0))\n         (x2 *\\<^sub>R (1, 0, 0) + y2 *\\<^sub>R (0, 1, 0))", "show ?thesis"], ["proof (prove)\nusing this:\n  x *\\<^sub>R (1, 0, 0) + y *\\<^sub>R (0, 1, 0)\n  \\<in> conefield (x1 *\\<^sub>R (1, 0, 0) + y1 *\\<^sub>R (0, 1, 0))\n         (x2 *\\<^sub>R (1, 0, 0) + y2 *\\<^sub>R (0, 1, 0))\n\ngoal (1 subgoal):\n 1. (x, y, 0) \\<in> conefield (x1, y1, 0) (x2, y2, 0)", "by simp"], ["proof (state)\nthis:\n  (x, y, 0) \\<in> conefield (x1, y1, 0) (x2, y2, 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}