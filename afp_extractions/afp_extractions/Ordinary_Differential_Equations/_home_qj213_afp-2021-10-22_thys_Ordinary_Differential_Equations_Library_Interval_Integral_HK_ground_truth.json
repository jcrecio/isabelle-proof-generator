{"file_name": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations/Library/Interval_Integral_HK.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations", "problem_names": ["lemma integral_emptyI[simp]:\n  fixes a b::real\n  shows  \"a \\<ge> b \\<Longrightarrow> integral {a..b} f = 0\" \"a > b \\<Longrightarrow> integral {a..b} f = 0\"", "lemma ivl_integral_unique: \"(f has_ivl_integral y) a b \\<Longrightarrow> ivl_integral a b f = y\"", "lemma fundamental_theorem_of_calculus_ivl_integral:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  shows \"(f has_vderiv_on f') (closed_segment a b) \\<Longrightarrow> (f' has_ivl_integral f b - f a) a b\"", "lemma\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n  shows indefinite_ivl_integral_continuous:\n    \"continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral a x f)\"\n    \"continuous_on (closed_segment b a) (\\<lambda>x. ivl_integral a x f)\"", "lemma\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n  assumes \"c \\<in> closed_segment a b\"\n  shows indefinite_ivl_integral_continuous_subset:\n    \"continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)\"", "lemma real_Icc_closed_segment: fixes a b::real shows \"a \\<le> b \\<Longrightarrow> {a .. b} = closed_segment a b\"", "lemma ivl_integral_zero[simp]: \"ivl_integral a a f = 0\"", "lemma ivl_integral_cong:\n  assumes \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> g x = f x\"\n  assumes \"a = c\" \"b = d\"\n  shows \"ivl_integral a b f = ivl_integral c d g\"", "lemma ivl_integral_diff:\n  \"f integrable_on (closed_segment s t) \\<Longrightarrow> g integrable_on (closed_segment s t) \\<Longrightarrow>\n    ivl_integral s t (\\<lambda>x. f x - g x) = ivl_integral s t f - ivl_integral s t g\"", "lemma ivl_integral_norm_bound_ivl_integral:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n    and \"g integrable_on (closed_segment a b)\"\n    and \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> norm (f x) \\<le> g x\"\n  shows \"norm (ivl_integral a b f) \\<le> abs (ivl_integral a b g)\"", "lemma ivl_integral_norm_bound_integral:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n    and \"g integrable_on (closed_segment a b)\"\n    and \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> norm (f x) \\<le> g x\"\n  shows \"norm (ivl_integral a b f) \\<le> integral (closed_segment a b) g\"", "lemma norm_ivl_integral_le:\n  fixes f :: \"real \\<Rightarrow> real\"\n  assumes \"f integrable_on (closed_segment a b)\"\n    and \"g integrable_on (closed_segment a b)\"\n    and \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> f x \\<le> g x\"\n    and \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> f x\"\n  shows \"abs (ivl_integral a b f) \\<le> abs (ivl_integral a b g)\"", "lemma ivl_integral_const [simp]:\n  shows \"ivl_integral a b (\\<lambda>x. c) = (b - a) *\\<^sub>R c\"", "lemma ivl_integral_has_vector_derivative:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n    and \"x \\<in> closed_segment a b\"\n  shows \"((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x) (at x within closed_segment a b)\"", "lemma ivl_integral_has_vderiv_on:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n  shows \"((\\<lambda>u. ivl_integral a u f) has_vderiv_on f) (closed_segment a b)\"", "lemma ivl_integral_has_vderiv_on_subset_segment:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n    and \"c \\<in> closed_segment a b\"\n  shows \"((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)\"", "lemma ivl_integral_has_vector_derivative_subset:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n    and \"x \\<in> closed_segment a b\"\n    and \"c \\<in> closed_segment a b\"\n  shows \"((\\<lambda>u. ivl_integral c u f) has_vector_derivative f x) (at x within closed_segment a b)\"", "lemma\n  compact_interval_eq_Inf_Sup:\n  fixes A::\"real set\"\n  assumes \"is_interval A\" \"compact A\" \"A \\<noteq> {}\"\n  shows \"A = {Inf A .. Sup A}\"", "lemma ivl_integral_has_vderiv_on_compact_interval:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on A f\"\n    and \"c \\<in> A\" \"is_interval A\" \"compact A\"\n  shows \"((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A\"", "lemma ivl_integral_has_vector_derivative_compact_interval:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on A f\"\n    and \"is_interval A\" \"compact A\" \"x \\<in> A\" \"c \\<in> A\"\n  shows \"((\\<lambda>u. ivl_integral c u f) has_vector_derivative f x) (at x within A)\"", "lemma ivl_integral_combine:\n  fixes f::\"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n  assumes \"f integrable_on (closed_segment b c)\"\n  assumes \"f integrable_on (closed_segment a c)\"\n  shows \"ivl_integral a b f + ivl_integral b c f = ivl_integral a c f\"", "lemma integral_equation_swap_initial_value:\n  fixes x::\"real\\<Rightarrow>'a::banach\"\n  assumes \"\\<And>t. t \\<in> closed_segment t0 t1 \\<Longrightarrow> x t = x t0 + ivl_integral t0 t (\\<lambda>t. f t (x t))\"\n  assumes t: \"t \\<in> closed_segment t0 t1\"\n  assumes int: \"(\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t1\"\n  shows \"x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))\"", "lemma has_integral_nonpos:\n  fixes f :: \"'n::euclidean_space \\<Rightarrow> real\"\n  assumes \"(f has_integral i) s\"\n    and \"\\<forall>x\\<in>s. f x \\<le> 0\"\n  shows \"i \\<le> 0\"", "lemma has_ivl_integral_nonneg:\n  fixes f :: \"real \\<Rightarrow> real\"\n  assumes \"(f has_ivl_integral i) a b\"\n    and \"\\<And>x. a \\<le> x \\<Longrightarrow> x \\<le> b \\<Longrightarrow> 0 \\<le> f x\"\n    and \"\\<And>x. b \\<le> x \\<Longrightarrow> x \\<le> a \\<Longrightarrow> f x \\<le> 0\"\n  shows \"0 \\<le> i\"", "lemma has_ivl_integral_ivl_integral:\n  \"f integrable_on (closed_segment a b) \\<longleftrightarrow> (f has_ivl_integral (ivl_integral a b f)) a b\"", "lemma ivl_integral_nonneg:\n  fixes f :: \"real \\<Rightarrow> real\"\n  assumes \"f integrable_on (closed_segment a b)\"\n    and \"\\<And>x. a \\<le> x \\<Longrightarrow> x \\<le> b \\<Longrightarrow> 0 \\<le> f x\"\n    and \"\\<And>x. b \\<le> x \\<Longrightarrow> x \\<le> a \\<Longrightarrow> f x \\<le> 0\"\n  shows \"0 \\<le> ivl_integral a b f\"", "lemma ivl_integral_bound:\n  fixes f::\"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n  assumes \"\\<And>t. t \\<in> (closed_segment a b) \\<Longrightarrow> norm (f t) \\<le> B\"\n  shows \"norm (ivl_integral a b f) \\<le> B * abs (b - a)\"", "lemma ivl_integral_minus_sets:\n  fixes f::\"real \\<Rightarrow> 'a::banach\"\n  shows \"f integrable_on (closed_segment c a) \\<Longrightarrow> f integrable_on (closed_segment c b) \\<Longrightarrow> f integrable_on (closed_segment a b) \\<Longrightarrow>\n    ivl_integral c a f - ivl_integral c b f = ivl_integral b a f\"", "lemma ivl_integral_minus_sets':\n  fixes f::\"real \\<Rightarrow> 'a::banach\"\n  shows \"f integrable_on (closed_segment a c) \\<Longrightarrow> f integrable_on (closed_segment b c) \\<Longrightarrow> f integrable_on (closed_segment a b) \\<Longrightarrow>\n    ivl_integral a c f - ivl_integral b c f = ivl_integral a b f\""], "translations": [["", "lemma integral_emptyI[simp]:\n  fixes a b::real\n  shows  \"a \\<ge> b \\<Longrightarrow> integral {a..b} f = 0\" \"a > b \\<Longrightarrow> integral {a..b} f = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (b \\<le> a \\<Longrightarrow> integral {a..b} f = (0::'a)) &&&\n    (b < a \\<Longrightarrow> integral {a..b} f = (0::'a))", "by (cases \"a = b\") auto"], ["", "lemma ivl_integral_unique: \"(f has_ivl_integral y) a b \\<Longrightarrow> ivl_integral a b f = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_ivl_integral y) a b \\<Longrightarrow> ivl_integral a b f = y", "using integral_unique[of f y \"{a .. b}\"] integral_unique[of f \"- y\" \"{b .. a}\"]"], ["proof (prove)\nusing this:\n  (f has_integral y) {a..b} \\<Longrightarrow> integral {a..b} f = y\n  (f has_integral - y) {b..a} \\<Longrightarrow> integral {b..a} f = - y\n\ngoal (1 subgoal):\n 1. (f has_ivl_integral y) a b \\<Longrightarrow> ivl_integral a b f = y", "unfolding ivl_integral_def has_ivl_integral_def"], ["proof (prove)\nusing this:\n  (f has_integral y) {a..b} \\<Longrightarrow> integral {a..b} f = y\n  (f has_integral - y) {b..a} \\<Longrightarrow> integral {b..a} f = - y\n\ngoal (1 subgoal):\n 1. if a \\<le> b then (f has_integral y) {a..b}\n    else (f has_integral - y) {b..a} \\<Longrightarrow>\n    integral {a..b} f - integral {b..a} f = y", "by (auto split: if_split_asm)"], ["", "lemma fundamental_theorem_of_calculus_ivl_integral:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  shows \"(f has_vderiv_on f') (closed_segment a b) \\<Longrightarrow> (f' has_ivl_integral f b - f a) a b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_vderiv_on f') (closed_segment a b) \\<Longrightarrow>\n    (f' has_ivl_integral f b - f a) a b", "by (auto simp: has_ivl_integral_def closed_segment_eq_real_ivl intro!: fundamental_theorem_of_calculus')"], ["", "lemma\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n  shows indefinite_ivl_integral_continuous:\n    \"continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral a x f)\"\n    \"continuous_on (closed_segment b a) (\\<lambda>x. ivl_integral a x f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral a x f) &&&\n    continuous_on (closed_segment b a) (\\<lambda>x. ivl_integral a x f)", "using assms"], ["proof (prove)\nusing this:\n  f integrable_on closed_segment a b\n\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral a x f) &&&\n    continuous_on (closed_segment b a) (\\<lambda>x. ivl_integral a x f)", "by (auto simp: ivl_integral_def closed_segment_eq_real_ivl split: if_split_asm\n    intro!: indefinite_integral_continuous_1 indefinite_integral_continuous_1'\n      continuous_intros intro: continuous_on_eq)"], ["", "lemma\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n  assumes \"c \\<in> closed_segment a b\"\n  shows indefinite_ivl_integral_continuous_subset:\n    \"continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)", "from assms"], ["proof (chain)\npicking this:\n  f integrable_on closed_segment a b\n  c \\<in> closed_segment a b", "have \"f integrable_on (closed_segment c a)\" \"f integrable_on (closed_segment c b)\""], ["proof (prove)\nusing this:\n  f integrable_on closed_segment a b\n  c \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. f integrable_on closed_segment c a &&&\n    f integrable_on closed_segment c b", "by (auto simp: closed_segment_eq_real_ivl integrable_on_subinterval\n      integrable_on_insert_iff split: if_splits)"], ["proof (state)\nthis:\n  f integrable_on closed_segment c a\n  f integrable_on closed_segment c b\n\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)", "then"], ["proof (chain)\npicking this:\n  f integrable_on closed_segment c a\n  f integrable_on closed_segment c b", "have \"continuous_on (closed_segment a c \\<union> closed_segment c b) (\\<lambda>x. ivl_integral c x f)\""], ["proof (prove)\nusing this:\n  f integrable_on closed_segment c a\n  f integrable_on closed_segment c b\n\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a c \\<union> closed_segment c b)\n     (\\<lambda>x. ivl_integral c x f)", "by (auto intro!: indefinite_ivl_integral_continuous continuous_on_closed_Un)"], ["proof (state)\nthis:\n  continuous_on (closed_segment a c \\<union> closed_segment c b)\n   (\\<lambda>x. ivl_integral c x f)\n\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)", "also"], ["proof (state)\nthis:\n  continuous_on (closed_segment a c \\<union> closed_segment c b)\n   (\\<lambda>x. ivl_integral c x f)\n\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)", "have \"closed_segment a c \\<union> closed_segment c b = closed_segment a b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed_segment a c \\<union> closed_segment c b = closed_segment a b", "using assms"], ["proof (prove)\nusing this:\n  f integrable_on closed_segment a b\n  c \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. closed_segment a c \\<union> closed_segment c b = closed_segment a b", "by (auto simp: closed_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  closed_segment a c \\<union> closed_segment c b = closed_segment a b\n\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)", "finally"], ["proof (chain)\npicking this:\n  continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)", "show ?thesis"], ["proof (prove)\nusing this:\n  continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)\n\ngoal (1 subgoal):\n 1. continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)", "."], ["proof (state)\nthis:\n  continuous_on (closed_segment a b) (\\<lambda>x. ivl_integral c x f)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma real_Icc_closed_segment: fixes a b::real shows \"a \\<le> b \\<Longrightarrow> {a .. b} = closed_segment a b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<le> b \\<Longrightarrow> {a..b} = closed_segment a b", "by (auto simp: closed_segment_eq_real_ivl)"], ["", "lemma ivl_integral_zero[simp]: \"ivl_integral a a f = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ivl_integral a a f = (0::'a)", "by (auto simp: ivl_integral_def)"], ["", "lemma ivl_integral_cong:\n  assumes \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> g x = f x\"\n  assumes \"a = c\" \"b = d\"\n  shows \"ivl_integral a b f = ivl_integral c d g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ivl_integral a b f = ivl_integral c d g", "using assms integral_spike[of \"{}\" \"closed_segment a b\" f g]"], ["proof (prove)\nusing this:\n  ?x \\<in> closed_segment a b \\<Longrightarrow> g ?x = f ?x\n  a = c\n  b = d\n  \\<lbrakk>negligible {};\n   \\<And>x.\n      x \\<in> closed_segment a b - {} \\<Longrightarrow> f x = g x\\<rbrakk>\n  \\<Longrightarrow> integral (closed_segment a b) g =\n                    integral (closed_segment a b) f\n\ngoal (1 subgoal):\n 1. ivl_integral a b f = ivl_integral c d g", "by (auto simp: ivl_integral_def closed_segment_eq_real_ivl split: if_split_asm)"], ["", "lemma ivl_integral_diff:\n  \"f integrable_on (closed_segment s t) \\<Longrightarrow> g integrable_on (closed_segment s t) \\<Longrightarrow>\n    ivl_integral s t (\\<lambda>x. f x - g x) = ivl_integral s t f - ivl_integral s t g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f integrable_on closed_segment s t;\n     g integrable_on closed_segment s t\\<rbrakk>\n    \\<Longrightarrow> ivl_integral s t (\\<lambda>x. f x - g x) =\n                      ivl_integral s t f - ivl_integral s t g", "using Henstock_Kurzweil_Integration.integral_diff[of f \"closed_segment s t\" g]"], ["proof (prove)\nusing this:\n  \\<lbrakk>f integrable_on closed_segment s t;\n   g integrable_on closed_segment s t\\<rbrakk>\n  \\<Longrightarrow> integral (closed_segment s t) (\\<lambda>x. f x - g x) =\n                    integral (closed_segment s t) f -\n                    integral (closed_segment s t) g\n\ngoal (1 subgoal):\n 1. \\<lbrakk>f integrable_on closed_segment s t;\n     g integrable_on closed_segment s t\\<rbrakk>\n    \\<Longrightarrow> ivl_integral s t (\\<lambda>x. f x - g x) =\n                      ivl_integral s t f - ivl_integral s t g", "by (auto simp: ivl_integral_def closed_segment_eq_real_ivl split: if_split_asm)"], ["", "lemma ivl_integral_norm_bound_ivl_integral:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n    and \"g integrable_on (closed_segment a b)\"\n    and \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> norm (f x) \\<le> g x\"\n  shows \"norm (ivl_integral a b f) \\<le> abs (ivl_integral a b g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (ivl_integral a b f) \\<le> \\<bar>ivl_integral a b g\\<bar>", "using integral_norm_bound_integral[OF assms]"], ["proof (prove)\nusing this:\n  (\\<And>x.\n      x \\<in> closed_segment a b \\<Longrightarrow>\n      x \\<in> closed_segment a b) \\<Longrightarrow>\n  norm (integral (closed_segment a b) f)\n  \\<le> integral (closed_segment a b) g\n\ngoal (1 subgoal):\n 1. norm (ivl_integral a b f) \\<le> \\<bar>ivl_integral a b g\\<bar>", "by (auto simp: ivl_integral_def closed_segment_eq_real_ivl split: if_split_asm)"], ["", "lemma ivl_integral_norm_bound_integral:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n    and \"g integrable_on (closed_segment a b)\"\n    and \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> norm (f x) \\<le> g x\"\n  shows \"norm (ivl_integral a b f) \\<le> integral (closed_segment a b) g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (ivl_integral a b f) \\<le> integral (closed_segment a b) g", "using integral_norm_bound_integral[OF assms]"], ["proof (prove)\nusing this:\n  (\\<And>x.\n      x \\<in> closed_segment a b \\<Longrightarrow>\n      x \\<in> closed_segment a b) \\<Longrightarrow>\n  norm (integral (closed_segment a b) f)\n  \\<le> integral (closed_segment a b) g\n\ngoal (1 subgoal):\n 1. norm (ivl_integral a b f) \\<le> integral (closed_segment a b) g", "by (auto simp: ivl_integral_def closed_segment_eq_real_ivl split: if_split_asm)"], ["", "lemma norm_ivl_integral_le:\n  fixes f :: \"real \\<Rightarrow> real\"\n  assumes \"f integrable_on (closed_segment a b)\"\n    and \"g integrable_on (closed_segment a b)\"\n    and \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> f x \\<le> g x\"\n    and \"\\<And>x. x \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> f x\"\n  shows \"abs (ivl_integral a b f) \\<le> abs (ivl_integral a b g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "proof (cases \"a = b\")"], ["proof (state)\ngoal (2 subgoals):\n 1. a = b \\<Longrightarrow>\n    \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>\n 2. a \\<noteq> b \\<Longrightarrow>\n    \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "case True"], ["proof (state)\nthis:\n  a = b\n\ngoal (2 subgoals):\n 1. a = b \\<Longrightarrow>\n    \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>\n 2. a \\<noteq> b \\<Longrightarrow>\n    \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "then"], ["proof (chain)\npicking this:\n  a = b", "show ?thesis"], ["proof (prove)\nusing this:\n  a = b\n\ngoal (1 subgoal):\n 1. \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow>\n    \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow>\n    \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "case False"], ["proof (state)\nthis:\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow>\n    \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "have \"0 \\<le> integral {a..b} f\" \"0 \\<le> integral {b..a} f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> integral {a..b} f &&& 0 \\<le> integral {b..a} f", "by (metis le_cases Henstock_Kurzweil_Integration.integral_nonneg assms(1) assms(4) closed_segment_eq_real_ivl integral_emptyI(1))+"], ["proof (state)\nthis:\n  0 \\<le> integral {a..b} f\n  0 \\<le> integral {b..a} f\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow>\n    \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "then"], ["proof (chain)\npicking this:\n  0 \\<le> integral {a..b} f\n  0 \\<le> integral {b..a} f", "show ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> integral {a..b} f\n  0 \\<le> integral {b..a} f\n\ngoal (1 subgoal):\n 1. \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "using integral_le[OF assms(1-3)]"], ["proof (prove)\nusing this:\n  0 \\<le> integral {a..b} f\n  0 \\<le> integral {b..a} f\n  (\\<And>x.\n      x \\<in> closed_segment a b \\<Longrightarrow>\n      x \\<in> closed_segment a b) \\<Longrightarrow>\n  integral (closed_segment a b) f \\<le> integral (closed_segment a b) g\n\ngoal (1 subgoal):\n 1. \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>", "unfolding ivl_integral_def closed_segment_eq_real_ivl"], ["proof (prove)\nusing this:\n  0 \\<le> integral {a..b} f\n  0 \\<le> integral {b..a} f\n  (\\<And>x.\n      x \\<in> (if a \\<le> b then {a..b} else {b..a}) \\<Longrightarrow>\n      x \\<in> (if a \\<le> b then {a..b} else {b..a})) \\<Longrightarrow>\n  integral (if a \\<le> b then {a..b} else {b..a}) f\n  \\<le> integral (if a \\<le> b then {a..b} else {b..a}) g\n\ngoal (1 subgoal):\n 1. \\<bar>integral {a..b} f - integral {b..a} f\\<bar>\n    \\<le> \\<bar>integral {a..b} g - integral {b..a} g\\<bar>", "by (simp split: if_split_asm)"], ["proof (state)\nthis:\n  \\<bar>ivl_integral a b f\\<bar> \\<le> \\<bar>ivl_integral a b g\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ivl_integral_const [simp]:\n  shows \"ivl_integral a b (\\<lambda>x. c) = (b - a) *\\<^sub>R c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ivl_integral a b (\\<lambda>x. c) = (b - a) *\\<^sub>R c", "by (auto simp: ivl_integral_def algebra_simps)"], ["", "lemma ivl_integral_has_vector_derivative:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n    and \"x \\<in> closed_segment a b\"\n  shows \"((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x) (at x within closed_segment a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "have \"((\\<lambda>x. integral {x..a} f) has_vector_derivative 0) (at x within {a..b})\" if \"a \\<le> x\" \"x \\<le> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. integral {x..a} f) has_vector_derivative (0::'a))\n     (at x within {a..b})", "by (rule has_vector_derivative_transform) (auto simp: that)"], ["proof (state)\nthis:\n  \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {x..a} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {a..b})\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {x..a} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {a..b})\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "have \"((\\<lambda>x. integral {a..x} f) has_vector_derivative 0) (at x within {b..a})\" if \"b \\<le> x\" \"x \\<le> a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. integral {a..x} f) has_vector_derivative (0::'a))\n     (at x within {b..a})", "by (rule has_vector_derivative_transform) (auto simp: that)"], ["proof (state)\nthis:\n  \\<lbrakk>b \\<le> x; x \\<le> a\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {a..x} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {b..a})\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "ultimately"], ["proof (chain)\npicking this:\n  \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {x..a} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {a..b})\n  \\<lbrakk>b \\<le> x; x \\<le> a\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {a..x} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {b..a})", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {x..a} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {a..b})\n  \\<lbrakk>b \\<le> x; x \\<le> a\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {a..x} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {b..a})\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "using assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {x..a} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {a..b})\n  \\<lbrakk>b \\<le> x; x \\<le> a\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral {a..x} f) has_vector_derivative\n                     (0::'a))\n                     (at x within {b..a})\n  continuous_on (closed_segment a b) f\n  x \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "by (auto simp: ivl_integral_def closed_segment_eq_real_ivl\n        intro!: derivative_eq_intros\n        integral_has_vector_derivative[of a b f] integral_has_vector_derivative[of b a \"-f\"]\n        integral_has_vector_derivative'[of b a f])"], ["proof (state)\nthis:\n  ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f x)\n   (at x within closed_segment a b)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ivl_integral_has_vderiv_on:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n  shows \"((\\<lambda>u. ivl_integral a u f) has_vderiv_on f) (closed_segment a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vderiv_on f) (closed_segment a b)", "using ivl_integral_has_vector_derivative[OF assms]"], ["proof (prove)\nusing this:\n  ?x \\<in> closed_segment a b \\<Longrightarrow>\n  ((\\<lambda>u. ivl_integral a u f) has_vector_derivative f ?x)\n   (at ?x within closed_segment a b)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral a u f) has_vderiv_on f) (closed_segment a b)", "by (auto simp: has_vderiv_on_def)"], ["", "lemma ivl_integral_has_vderiv_on_subset_segment:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n    and \"c \\<in> closed_segment a b\"\n  shows \"((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)", "have \"(closed_segment c a) \\<subseteq> (closed_segment a b)\" \"(closed_segment c b) \\<subseteq> (closed_segment a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed_segment c a \\<subseteq> closed_segment a b &&&\n    closed_segment c b \\<subseteq> closed_segment a b", "using assms"], ["proof (prove)\nusing this:\n  continuous_on (closed_segment a b) f\n  c \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. closed_segment c a \\<subseteq> closed_segment a b &&&\n    closed_segment c b \\<subseteq> closed_segment a b", "by (auto simp: closed_segment_eq_real_ivl split: if_splits)"], ["proof (state)\nthis:\n  closed_segment c a \\<subseteq> closed_segment a b\n  closed_segment c b \\<subseteq> closed_segment a b\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)", "then"], ["proof (chain)\npicking this:\n  closed_segment c a \\<subseteq> closed_segment a b\n  closed_segment c b \\<subseteq> closed_segment a b", "have \"((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) ((closed_segment c a) \\<union> (closed_segment c b))\""], ["proof (prove)\nusing this:\n  closed_segment c a \\<subseteq> closed_segment a b\n  closed_segment c b \\<subseteq> closed_segment a b\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f)\n     (closed_segment c a \\<union> closed_segment c b)", "by (auto intro!: has_vderiv_on_union_closed ivl_integral_has_vderiv_on assms\n      intro: continuous_on_subset)"], ["proof (state)\nthis:\n  ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f)\n   (closed_segment c a \\<union> closed_segment c b)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)", "also"], ["proof (state)\nthis:\n  ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f)\n   (closed_segment c a \\<union> closed_segment c b)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)", "have \"(closed_segment c a) \\<union> (closed_segment c b) = (closed_segment a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed_segment c a \\<union> closed_segment c b = closed_segment a b", "using assms"], ["proof (prove)\nusing this:\n  continuous_on (closed_segment a b) f\n  c \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. closed_segment c a \\<union> closed_segment c b = closed_segment a b", "by (auto simp: closed_segment_eq_real_ivl split: if_splits)"], ["proof (state)\nthis:\n  closed_segment c a \\<union> closed_segment c b = closed_segment a b\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)", "finally"], ["proof (chain)\npicking this:\n  ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)", "show ?thesis"], ["proof (prove)\nusing this:\n  ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)", "."], ["proof (state)\nthis:\n  ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) (closed_segment a b)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ivl_integral_has_vector_derivative_subset:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n    and \"x \\<in> closed_segment a b\"\n    and \"c \\<in> closed_segment a b\"\n  shows \"((\\<lambda>u. ivl_integral c u f) has_vector_derivative f x) (at x within closed_segment a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "using ivl_integral_has_vderiv_on_subset_segment[OF assms(1)] assms(2-)"], ["proof (prove)\nusing this:\n  ?c \\<in> closed_segment a b \\<Longrightarrow>\n  ((\\<lambda>u. ivl_integral ?c u f) has_vderiv_on f) (closed_segment a b)\n  x \\<in> closed_segment a b\n  c \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vector_derivative f x)\n     (at x within closed_segment a b)", "by (auto simp: has_vderiv_on_def)"], ["", "lemma\n  compact_interval_eq_Inf_Sup:\n  fixes A::\"real set\"\n  assumes \"is_interval A\" \"compact A\" \"A \\<noteq> {}\"\n  shows \"A = {Inf A .. Sup A}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A = {Inf A..Sup A}", "apply (auto simp: closed_segment_eq_real_ivl\n      intro!: cInf_lower cSup_upper bounded_imp_bdd_below bounded_imp_bdd_above\n      compact_imp_bounded assms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Inf A \\<le> x; x \\<le> Sup A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A", "by (metis assms(1) assms(2) assms(3) cInf_eq_minimum cSup_eq_maximum compact_attains_inf\n      compact_attains_sup mem_is_interval_1_I)"], ["", "lemma ivl_integral_has_vderiv_on_compact_interval:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on A f\"\n    and \"c \\<in> A\" \"is_interval A\" \"compact A\"\n  shows \"((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A", "have \"A = {Inf A .. Sup A}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A = {Inf A..Sup A}", "by (rule compact_interval_eq_Inf_Sup) (use assms in auto)"], ["proof (state)\nthis:\n  A = {Inf A..Sup A}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A", "also"], ["proof (state)\nthis:\n  A = {Inf A..Sup A}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A", "have \"\\<dots> = closed_segment (Inf A) (Sup A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {Inf A..Sup A} = closed_segment (Inf A) (Sup A)", "using assms"], ["proof (prove)\nusing this:\n  continuous_on A f\n  c \\<in> A\n  is_interval A\n  compact A\n\ngoal (1 subgoal):\n 1. {Inf A..Sup A} = closed_segment (Inf A) (Sup A)", "by (auto simp add: closed_segment_eq_real_ivl\n        intro!: cInf_le_cSup bounded_imp_bdd_below bounded_imp_bdd_above compact_imp_bounded)"], ["proof (state)\nthis:\n  {Inf A..Sup A} = closed_segment (Inf A) (Sup A)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A", "finally"], ["proof (chain)\npicking this:\n  A = closed_segment (Inf A) (Sup A)", "have *: \"A = closed_segment (Inf A) (Sup A)\""], ["proof (prove)\nusing this:\n  A = closed_segment (Inf A) (Sup A)\n\ngoal (1 subgoal):\n 1. A = closed_segment (Inf A) (Sup A)", "."], ["proof (state)\nthis:\n  A = closed_segment (Inf A) (Sup A)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A", "apply (subst *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f)\n     (closed_segment (Inf A) (Sup A))", "apply (rule ivl_integral_has_vderiv_on_subset_segment)"], ["proof (prove)\ngoal (2 subgoals):\n 1. continuous_on (closed_segment (Inf A) (Sup A)) f\n 2. c \\<in> closed_segment (Inf A) (Sup A)", "unfolding *[symmetric]"], ["proof (prove)\ngoal (2 subgoals):\n 1. continuous_on A f\n 2. c \\<in> A", "by fact+"], ["proof (state)\nthis:\n  ((\\<lambda>u. ivl_integral c u f) has_vderiv_on f) A\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ivl_integral_has_vector_derivative_compact_interval:\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on A f\"\n    and \"is_interval A\" \"compact A\" \"x \\<in> A\" \"c \\<in> A\"\n  shows \"((\\<lambda>u. ivl_integral c u f) has_vector_derivative f x) (at x within A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vector_derivative f x)\n     (at x within A)", "using ivl_integral_has_vderiv_on_compact_interval[OF assms(1)] assms(2-)"], ["proof (prove)\nusing this:\n  \\<lbrakk>?c \\<in> A; is_interval A; compact A\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>u. ivl_integral ?c u f) has_vderiv_on f) A\n  is_interval A\n  compact A\n  x \\<in> A\n  c \\<in> A\n\ngoal (1 subgoal):\n 1. ((\\<lambda>u. ivl_integral c u f) has_vector_derivative f x)\n     (at x within A)", "by (auto simp: has_vderiv_on_def)"], ["", "lemma ivl_integral_combine:\n  fixes f::\"real \\<Rightarrow> 'a::banach\"\n  assumes \"f integrable_on (closed_segment a b)\"\n  assumes \"f integrable_on (closed_segment b c)\"\n  assumes \"f integrable_on (closed_segment a c)\"\n  shows \"ivl_integral a b f + ivl_integral b c f = ivl_integral a c f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ivl_integral a b f + ivl_integral b c f = ivl_integral a c f", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ivl_integral a b f + ivl_integral b c f = ivl_integral a c f", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. ivl_integral a b f + ivl_integral b c f = ivl_integral a c f", "using assms\n      Henstock_Kurzweil_Integration.integral_combine[of a b c f]\n      Henstock_Kurzweil_Integration.integral_combine[of a c b f]\n      Henstock_Kurzweil_Integration.integral_combine[of b a c f]\n      Henstock_Kurzweil_Integration.integral_combine[of b c a f]\n      Henstock_Kurzweil_Integration.integral_combine[of c a b f]\n      Henstock_Kurzweil_Integration.integral_combine[of c b a f]"], ["proof (prove)\nusing this:\n  f integrable_on closed_segment a b\n  f integrable_on closed_segment b c\n  f integrable_on closed_segment a c\n  \\<lbrakk>a \\<le> b; b \\<le> c; f integrable_on {a..c}\\<rbrakk>\n  \\<Longrightarrow> integral {a..b} f + integral {b..c} f =\n                    integral {a..c} f\n  \\<lbrakk>a \\<le> c; c \\<le> b; f integrable_on {a..b}\\<rbrakk>\n  \\<Longrightarrow> integral {a..c} f + integral {c..b} f =\n                    integral {a..b} f\n  \\<lbrakk>b \\<le> a; a \\<le> c; f integrable_on {b..c}\\<rbrakk>\n  \\<Longrightarrow> integral {b..a} f + integral {a..c} f =\n                    integral {b..c} f\n  \\<lbrakk>b \\<le> c; c \\<le> a; f integrable_on {b..a}\\<rbrakk>\n  \\<Longrightarrow> integral {b..c} f + integral {c..a} f =\n                    integral {b..a} f\n  \\<lbrakk>c \\<le> a; a \\<le> b; f integrable_on {c..b}\\<rbrakk>\n  \\<Longrightarrow> integral {c..a} f + integral {a..b} f =\n                    integral {c..b} f\n  \\<lbrakk>c \\<le> b; b \\<le> a; f integrable_on {c..a}\\<rbrakk>\n  \\<Longrightarrow> integral {c..b} f + integral {b..a} f =\n                    integral {c..a} f\n\ngoal (1 subgoal):\n 1. ivl_integral a b f + ivl_integral b c f = ivl_integral a c f", "by (cases \"a \\<le> b\"; cases \"b \\<le> c\"; cases \"a \\<le> c\")\n       (auto simp: algebra_simps ivl_integral_def closed_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  ivl_integral a b f + ivl_integral b c f = ivl_integral a c f\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma integral_equation_swap_initial_value:\n  fixes x::\"real\\<Rightarrow>'a::banach\"\n  assumes \"\\<And>t. t \\<in> closed_segment t0 t1 \\<Longrightarrow> x t = x t0 + ivl_integral t0 t (\\<lambda>t. f t (x t))\"\n  assumes t: \"t \\<in> closed_segment t0 t1\"\n  assumes int: \"(\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t1\"\n  shows \"x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "from t int"], ["proof (chain)\npicking this:\n  t \\<in> closed_segment t0 t1\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t1", "have \"(\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t\"\n    \"(\\<lambda>t. f t (x t)) integrable_on closed_segment t t1\""], ["proof (prove)\nusing this:\n  t \\<in> closed_segment t0 t1\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t1\n\ngoal (1 subgoal):\n 1. (\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t &&&\n    (\\<lambda>t. f t (x t)) integrable_on closed_segment t t1", "by (auto intro: integrable_on_subinterval simp: closed_segment_eq_real_ivl split: if_split_asm)"], ["proof (state)\nthis:\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t t1\n\ngoal (1 subgoal):\n 1. x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "with assms(1)[of t] assms(2-)"], ["proof (chain)\npicking this:\n  t \\<in> closed_segment t0 t1 \\<Longrightarrow>\n  x t = x t0 + ivl_integral t0 t (\\<lambda>t. f t (x t))\n  t \\<in> closed_segment t0 t1\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t1\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t t1", "have \"x t - x t0 = ivl_integral t0 t1 (\\<lambda>t. f t (x t)) + ivl_integral t1 t (\\<lambda>t. f t (x t))\""], ["proof (prove)\nusing this:\n  t \\<in> closed_segment t0 t1 \\<Longrightarrow>\n  x t = x t0 + ivl_integral t0 t (\\<lambda>t. f t (x t))\n  t \\<in> closed_segment t0 t1\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t1\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t0 t\n  (\\<lambda>t. f t (x t)) integrable_on closed_segment t t1\n\ngoal (1 subgoal):\n 1. x t - x t0 =\n    ivl_integral t0 t1 (\\<lambda>t. f t (x t)) +\n    ivl_integral t1 t (\\<lambda>t. f t (x t))", "by (subst ivl_integral_combine) (auto simp: closed_segment_commute)"], ["proof (state)\nthis:\n  x t - x t0 =\n  ivl_integral t0 t1 (\\<lambda>t. f t (x t)) +\n  ivl_integral t1 t (\\<lambda>t. f t (x t))\n\ngoal (1 subgoal):\n 1. x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "then"], ["proof (chain)\npicking this:\n  x t - x t0 =\n  ivl_integral t0 t1 (\\<lambda>t. f t (x t)) +\n  ivl_integral t1 t (\\<lambda>t. f t (x t))", "have \"x t + x t1 - (x t0 + ivl_integral t0 t1 (\\<lambda>t. f t (x t))) =\n    x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))\""], ["proof (prove)\nusing this:\n  x t - x t0 =\n  ivl_integral t0 t1 (\\<lambda>t. f t (x t)) +\n  ivl_integral t1 t (\\<lambda>t. f t (x t))\n\ngoal (1 subgoal):\n 1. x t + x t1 - (x t0 + ivl_integral t0 t1 (\\<lambda>t. f t (x t))) =\n    x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  x t + x t1 - (x t0 + ivl_integral t0 t1 (\\<lambda>t. f t (x t))) =\n  x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))\n\ngoal (1 subgoal):\n 1. x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "also"], ["proof (state)\nthis:\n  x t + x t1 - (x t0 + ivl_integral t0 t1 (\\<lambda>t. f t (x t))) =\n  x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))\n\ngoal (1 subgoal):\n 1. x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "have \"x t0 + ivl_integral t0 t1 (\\<lambda>t. f t (x t)) = x t1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x t0 + ivl_integral t0 t1 (\\<lambda>t. f t (x t)) = x t1", "by (auto simp: assms(1)[symmetric])"], ["proof (state)\nthis:\n  x t0 + ivl_integral t0 t1 (\\<lambda>t. f t (x t)) = x t1\n\ngoal (1 subgoal):\n 1. x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "finally"], ["proof (chain)\npicking this:\n  x t + x t1 - x t1 = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "show ?thesis"], ["proof (prove)\nusing this:\n  x t + x t1 - x t1 = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))\n\ngoal (1 subgoal):\n 1. x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))", "by simp"], ["proof (state)\nthis:\n  x t = x t1 + ivl_integral t1 t (\\<lambda>t. f t (x t))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma has_integral_nonpos:\n  fixes f :: \"'n::euclidean_space \\<Rightarrow> real\"\n  assumes \"(f has_integral i) s\"\n    and \"\\<forall>x\\<in>s. f x \\<le> 0\"\n  shows \"i \\<le> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i \\<le> 0", "by (rule has_integral_nonneg[of \"-f\" \"-i\" s, simplified])\n    (auto intro!: has_integral_neg simp: fun_Compl_def assms)"], ["", "lemma has_ivl_integral_nonneg:\n  fixes f :: \"real \\<Rightarrow> real\"\n  assumes \"(f has_ivl_integral i) a b\"\n    and \"\\<And>x. a \\<le> x \\<Longrightarrow> x \\<le> b \\<Longrightarrow> 0 \\<le> f x\"\n    and \"\\<And>x. b \\<le> x \\<Longrightarrow> x \\<le> a \\<Longrightarrow> f x \\<le> 0\"\n  shows \"0 \\<le> i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> i", "using assms has_integral_nonneg[of f i \"{a .. b}\"] has_integral_nonpos[of f \"-i\" \"{b .. a}\"]"], ["proof (prove)\nusing this:\n  (f has_ivl_integral i) a b\n  \\<lbrakk>a \\<le> ?x; ?x \\<le> b\\<rbrakk> \\<Longrightarrow> 0 \\<le> f ?x\n  \\<lbrakk>b \\<le> ?x; ?x \\<le> a\\<rbrakk> \\<Longrightarrow> f ?x \\<le> 0\n  \\<lbrakk>(f has_integral i) {a..b};\n   \\<And>x. x \\<in> {a..b} \\<Longrightarrow> 0 \\<le> f x\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> i\n  \\<lbrakk>(f has_integral - i) {b..a};\n   \\<forall>x\\<in>{b..a}. f x \\<le> 0\\<rbrakk>\n  \\<Longrightarrow> - i \\<le> 0\n\ngoal (1 subgoal):\n 1. 0 \\<le> i", "by (auto simp: has_ivl_integral_def Ball_def not_le split: if_split_asm)"], ["", "lemma has_ivl_integral_ivl_integral:\n  \"f integrable_on (closed_segment a b) \\<longleftrightarrow> (f has_ivl_integral (ivl_integral a b f)) a b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f integrable_on closed_segment a b) =\n    (f has_ivl_integral ivl_integral a b f) a b", "by (auto simp: closed_segment_eq_real_ivl has_ivl_integral_def ivl_integral_def)"], ["", "lemma ivl_integral_nonneg:\n  fixes f :: \"real \\<Rightarrow> real\"\n  assumes \"f integrable_on (closed_segment a b)\"\n    and \"\\<And>x. a \\<le> x \\<Longrightarrow> x \\<le> b \\<Longrightarrow> 0 \\<le> f x\"\n    and \"\\<And>x. b \\<le> x \\<Longrightarrow> x \\<le> a \\<Longrightarrow> f x \\<le> 0\"\n  shows \"0 \\<le> ivl_integral a b f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> ivl_integral a b f", "by (rule has_ivl_integral_nonneg[OF assms(1)[unfolded has_ivl_integral_ivl_integral] assms(2-3)])"], ["", "lemma ivl_integral_bound:\n  fixes f::\"real \\<Rightarrow> 'a::banach\"\n  assumes \"continuous_on (closed_segment a b) f\"\n  assumes \"\\<And>t. t \\<in> (closed_segment a b) \\<Longrightarrow> norm (f t) \\<le> B\"\n  shows \"norm (ivl_integral a b f) \\<le> B * abs (b - a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (ivl_integral a b f) \\<le> B * \\<bar>b - a\\<bar>", "using integral_bound[of a b f B]\n    integral_bound[of b a f B]\n    assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>a \\<le> b; continuous_on {a..b} f;\n   \\<And>t. t \\<in> {a..b} \\<Longrightarrow> norm (f t) \\<le> B\\<rbrakk>\n  \\<Longrightarrow> norm (integral {a..b} f) \\<le> B * (b - a)\n  \\<lbrakk>b \\<le> a; continuous_on {b..a} f;\n   \\<And>t. t \\<in> {b..a} \\<Longrightarrow> norm (f t) \\<le> B\\<rbrakk>\n  \\<Longrightarrow> norm (integral {b..a} f) \\<le> B * (a - b)\n  continuous_on (closed_segment a b) f\n  ?t \\<in> closed_segment a b \\<Longrightarrow> norm (f ?t) \\<le> B\n\ngoal (1 subgoal):\n 1. norm (ivl_integral a b f) \\<le> B * \\<bar>b - a\\<bar>", "by (auto simp: closed_segment_eq_real_ivl has_ivl_integral_def ivl_integral_def split: if_splits)"], ["", "lemma ivl_integral_minus_sets:\n  fixes f::\"real \\<Rightarrow> 'a::banach\"\n  shows \"f integrable_on (closed_segment c a) \\<Longrightarrow> f integrable_on (closed_segment c b) \\<Longrightarrow> f integrable_on (closed_segment a b) \\<Longrightarrow>\n    ivl_integral c a f - ivl_integral c b f = ivl_integral b a f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f integrable_on closed_segment c a;\n     f integrable_on closed_segment c b;\n     f integrable_on closed_segment a b\\<rbrakk>\n    \\<Longrightarrow> ivl_integral c a f - ivl_integral c b f =\n                      ivl_integral b a f", "using ivl_integral_combine[of f c b a]"], ["proof (prove)\nusing this:\n  \\<lbrakk>f integrable_on closed_segment c b;\n   f integrable_on closed_segment b a;\n   f integrable_on closed_segment c a\\<rbrakk>\n  \\<Longrightarrow> ivl_integral c b f + ivl_integral b a f =\n                    ivl_integral c a f\n\ngoal (1 subgoal):\n 1. \\<lbrakk>f integrable_on closed_segment c a;\n     f integrable_on closed_segment c b;\n     f integrable_on closed_segment a b\\<rbrakk>\n    \\<Longrightarrow> ivl_integral c a f - ivl_integral c b f =\n                      ivl_integral b a f", "by (auto simp: algebra_simps closed_segment_commute)"], ["", "lemma ivl_integral_minus_sets':\n  fixes f::\"real \\<Rightarrow> 'a::banach\"\n  shows \"f integrable_on (closed_segment a c) \\<Longrightarrow> f integrable_on (closed_segment b c) \\<Longrightarrow> f integrable_on (closed_segment a b) \\<Longrightarrow>\n    ivl_integral a c f - ivl_integral b c f = ivl_integral a b f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f integrable_on closed_segment a c;\n     f integrable_on closed_segment b c;\n     f integrable_on closed_segment a b\\<rbrakk>\n    \\<Longrightarrow> ivl_integral a c f - ivl_integral b c f =\n                      ivl_integral a b f", "using ivl_integral_combine[of f a b c]"], ["proof (prove)\nusing this:\n  \\<lbrakk>f integrable_on closed_segment a b;\n   f integrable_on closed_segment b c;\n   f integrable_on closed_segment a c\\<rbrakk>\n  \\<Longrightarrow> ivl_integral a b f + ivl_integral b c f =\n                    ivl_integral a c f\n\ngoal (1 subgoal):\n 1. \\<lbrakk>f integrable_on closed_segment a c;\n     f integrable_on closed_segment b c;\n     f integrable_on closed_segment a b\\<rbrakk>\n    \\<Longrightarrow> ivl_integral a c f - ivl_integral b c f =\n                      ivl_integral a b f", "by (auto simp: algebra_simps closed_segment_commute)"], ["", "end"]]}