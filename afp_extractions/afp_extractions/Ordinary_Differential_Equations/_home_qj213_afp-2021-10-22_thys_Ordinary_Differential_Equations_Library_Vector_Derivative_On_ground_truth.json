{"file_name": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations/Library/Vector_Derivative_On.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations", "problem_names": ["lemma has_vderiv_on_empty[intro, simp]: \"(f has_vderiv_on f') {}\"", "lemma has_vderiv_on_subset:\n  assumes \"(f has_vderiv_on f') S\"\n  assumes \"T \\<subseteq> S\"\n  shows \"(f has_vderiv_on f') T\"", "lemma has_vderiv_on_compose:\n  assumes \"(f has_vderiv_on f') (g ` T)\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows \"(f o g has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T\"", "lemma has_vderiv_on_open:\n  assumes \"open T\"\n  shows \"(f has_vderiv_on f') T \\<longleftrightarrow> (\\<forall>t \\<in> T. (f has_vector_derivative f' t) (at t))\"", "lemma has_vderiv_on_eq_rhs:\\<comment> \\<open>TODO: integrate intro \\<open>derivative_eq_intros\\<close>\\<close>\n  \"(f has_vderiv_on g') T \\<Longrightarrow> (\\<And>x. x \\<in> T \\<Longrightarrow> g' x = f' x) \\<Longrightarrow> (f has_vderiv_on f') T\"", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  shows has_vderiv_on_id: \"((\\<lambda>x. x) has_vderiv_on (\\<lambda>x. 1)) T\"\n    and has_vderiv_on_const: \"((\\<lambda>x. c) has_vderiv_on (\\<lambda>x. 0)) T\"", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes f::\"real \\<Rightarrow> 'a::real_normed_vector\"\n  assumes \"(f has_vderiv_on f') T\"\n  shows has_vderiv_on_uminus: \"((\\<lambda>x. - f x) has_vderiv_on (\\<lambda>x. - f' x)) T\"", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes f g::\"real \\<Rightarrow> 'a::real_normed_vector\"\n  assumes \"(f has_vderiv_on f') T\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows has_vderiv_on_add: \"((\\<lambda>x. f x + g x) has_vderiv_on (\\<lambda>x. f' x + g' x)) T\"\n   and has_vderiv_on_diff: \"((\\<lambda>x. f x - g x) has_vderiv_on (\\<lambda>x. f' x - g' x)) T\"", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes f::\"real \\<Rightarrow> real\" and g::\"real \\<Rightarrow> 'a::real_normed_vector\"\n  assumes \"(f has_vderiv_on f') T\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows has_vderiv_on_scaleR: \"((\\<lambda>x. f x *\\<^sub>R g x) has_vderiv_on (\\<lambda>x. f x *\\<^sub>R g' x + f' x *\\<^sub>R g x)) T\"", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes f g::\"real \\<Rightarrow> 'a::real_normed_algebra\"\n  assumes \"(f has_vderiv_on f') T\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows has_vderiv_on_mult: \"((\\<lambda>x. f x * g x) has_vderiv_on (\\<lambda>x. f x * g' x + f' x * g x)) T\"", "lemma has_vderiv_on_ln[THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes g::\"real \\<Rightarrow> real\"\n  assumes \"\\<And>x. x \\<in> s \\<Longrightarrow> 0 < g x\"\n  assumes \"(g has_vderiv_on g') s\"\n  shows \"((\\<lambda>x. ln (g x)) has_vderiv_on (\\<lambda>x. g' x / g x)) s\"", "lemma fundamental_theorem_of_calculus':\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  shows \"a \\<le> b \\<Longrightarrow> (f has_vderiv_on f') {a .. b} \\<Longrightarrow> (f' has_integral (f b - f a)) {a .. b}\"", "lemma has_vderiv_on_If:\n  assumes \"U = S \\<union> T\"\n  assumes \"(f has_vderiv_on f') (S \\<union> (closure T \\<inter> closure S))\"\n  assumes \"(g has_vderiv_on g') (T \\<union> (closure T \\<inter> closure S))\"\n  assumes \"\\<And>x. x \\<in> closure T \\<Longrightarrow> x \\<in> closure S \\<Longrightarrow> f x = g x\"\n  assumes \"\\<And>x. x \\<in> closure T \\<Longrightarrow> x \\<in> closure S \\<Longrightarrow> f' x = g' x\"\n  shows \"((\\<lambda>t. if t \\<in> S then f t else g t) has_vderiv_on (\\<lambda>t. if t \\<in> S then f' t else g' t)) U\"", "lemma mvt_very_simple_closed_segmentE:\n  fixes f::\"real\\<Rightarrow>real\"\n  assumes \"(f has_vderiv_on f') (closed_segment a b)\"\n  obtains y where \"y \\<in> closed_segment a b\"  \"f b - f a = (b - a) * f' y\"", "lemma mvt_simple_closed_segmentE:\n  fixes f::\"real\\<Rightarrow>real\"\n  assumes \"(f has_vderiv_on f') (closed_segment a b)\"\n  assumes \"a \\<noteq> b\"\n  obtains y where \"y \\<in> open_segment a b\"  \"f b - f a = (b - a) * f' y\"", "lemma differentiable_bound_general_open_segment:\n  fixes a :: \"real\"\n    and b :: \"real\"\n    and f :: \"real \\<Rightarrow> 'a::real_normed_vector\"\n    and f' :: \"real \\<Rightarrow> 'a\"\n  assumes \"continuous_on (closed_segment a b) f\"\n  assumes \"continuous_on (closed_segment a b) g\"\n    and \"(f has_vderiv_on f') (open_segment a b)\"\n    and \"(g has_vderiv_on g') (open_segment a b)\"\n    and \"\\<And>x. x \\<in> open_segment a b \\<Longrightarrow> norm (f' x) \\<le> g' x\"\n  shows \"norm (f b - f a) \\<le> abs (g b - g a)\"", "lemma has_vderiv_on_union:\n  assumes \"(f has_vderiv_on g) (s \\<union> closure s \\<inter> closure t)\"\n  assumes \"(f has_vderiv_on g) (t \\<union> closure s \\<inter> closure t)\"\n  shows \"(f has_vderiv_on g) (s \\<union> t)\"", "lemma has_vderiv_on_union_closed:\n  assumes \"(f has_vderiv_on g) s\"\n  assumes \"(f has_vderiv_on g) t\"\n  assumes \"closed s\" \"closed t\"\n  shows \"(f has_vderiv_on g) (s \\<union> t)\"", "lemma vderiv_on_continuous_on: \"(f has_vderiv_on f') S \\<Longrightarrow> continuous_on S f\"", "lemma has_vderiv_on_cong[cong]:\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\"\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> f' x = g' x\"\n  assumes \"S = T\"\n  shows \"(f has_vderiv_on f') S = (g has_vderiv_on g') T\"", "lemma has_vderiv_eq:\n  assumes \"(f has_vderiv_on f') S\"\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\"\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> f' x = g' x\"\n  assumes \"S = T\"\n  shows \"(g has_vderiv_on g') T\"", "lemma has_vderiv_on_compose':\n  assumes \"(f has_vderiv_on f') (g ` T)\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows \"((\\<lambda>x. f (g x)) has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T\"", "lemma has_vderiv_on_compose2:\n  assumes \"(f has_vderiv_on f') S\"\n  assumes \"(g has_vderiv_on g') T\"\n  assumes \"\\<And>t. t \\<in> T \\<Longrightarrow> g t \\<in> S\"\n  shows \"((\\<lambda>x. f (g x)) has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T\"", "lemma has_vderiv_on_singleton: \"(y has_vderiv_on y') {t0}\"", "lemma\n  has_vderiv_on_zero_constant:\n  assumes \"convex s\"\n  assumes \"(f has_vderiv_on (\\<lambda>h. 0)) s\"\n  obtains c where \"\\<And>x. x \\<in> s \\<Longrightarrow> f x = c\"", "lemma bounded_vderiv_on_imp_lipschitz:\n  assumes \"(f has_vderiv_on f') X\"\n  assumes convex: \"convex X\"\n  assumes \"\\<And>x. x \\<in> X \\<Longrightarrow> norm (f' x) \\<le> C\" \"0 \\<le> C\"\n  shows \"C-lipschitz_on X f\""], "translations": [["", "lemma has_vderiv_on_empty[intro, simp]: \"(f has_vderiv_on f') {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_vderiv_on f') {}", "by (auto simp: has_vderiv_on_def)"], ["", "lemma has_vderiv_on_subset:\n  assumes \"(f has_vderiv_on f') S\"\n  assumes \"T \\<subseteq> S\"\n  shows \"(f has_vderiv_on f') T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_vderiv_on f') T", "by (meson assms(1) assms(2) contra_subsetD has_vderiv_on_def has_vector_derivative_within_subset)"], ["", "lemma has_vderiv_on_compose:\n  assumes \"(f has_vderiv_on f') (g ` T)\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows \"(f o g has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<circ> g has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T", "using assms"], ["proof (prove)\nusing this:\n  (f has_vderiv_on f') (g ` T)\n  (g has_vderiv_on g') T\n\ngoal (1 subgoal):\n 1. (f \\<circ> g has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T", "unfolding has_vderiv_on_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>g ` T. (f has_vector_derivative f' x) (at x within g ` T)\n  \\<forall>x\\<in>T. (g has_vector_derivative g' x) (at x within T)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>T.\n       (f \\<circ> g has_vector_derivative g' x *\\<^sub>R f' (g x))\n        (at x within T)", "by (auto intro!: vector_diff_chain_within)"], ["", "lemma has_vderiv_on_open:\n  assumes \"open T\"\n  shows \"(f has_vderiv_on f') T \\<longleftrightarrow> (\\<forall>t \\<in> T. (f has_vector_derivative f' t) (at t))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_vderiv_on f') T =\n    (\\<forall>t\\<in>T. (f has_vector_derivative f' t) (at t))", "by (auto simp: has_vderiv_on_def at_within_open[OF _ \\<open>open T\\<close>])"], ["", "lemma has_vderiv_on_eq_rhs:\\<comment> \\<open>TODO: integrate intro \\<open>derivative_eq_intros\\<close>\\<close>\n  \"(f has_vderiv_on g') T \\<Longrightarrow> (\\<And>x. x \\<in> T \\<Longrightarrow> g' x = f' x) \\<Longrightarrow> (f has_vderiv_on f') T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(f has_vderiv_on g') T;\n     \\<And>x. x \\<in> T \\<Longrightarrow> g' x = f' x\\<rbrakk>\n    \\<Longrightarrow> (f has_vderiv_on f') T", "by (auto simp: has_vderiv_on_def)"], ["", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  shows has_vderiv_on_id: \"((\\<lambda>x. x) has_vderiv_on (\\<lambda>x. 1)) T\"\n    and has_vderiv_on_const: \"((\\<lambda>x. c) has_vderiv_on (\\<lambda>x. 0)) T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. x) has_vderiv_on (\\<lambda>x. 1)) T &&&\n    ((\\<lambda>x. c) has_vderiv_on (\\<lambda>x. 0::'a)) T", "by (auto simp: has_vderiv_on_def intro!: derivative_eq_intros)"], ["", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes f::\"real \\<Rightarrow> 'a::real_normed_vector\"\n  assumes \"(f has_vderiv_on f') T\"\n  shows has_vderiv_on_uminus: \"((\\<lambda>x. - f x) has_vderiv_on (\\<lambda>x. - f' x)) T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. - f x) has_vderiv_on (\\<lambda>x. - f' x)) T", "using assms"], ["proof (prove)\nusing this:\n  (f has_vderiv_on f') T\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. - f x) has_vderiv_on (\\<lambda>x. - f' x)) T", "by (auto simp: has_vderiv_on_def intro!: derivative_eq_intros)"], ["", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes f g::\"real \\<Rightarrow> 'a::real_normed_vector\"\n  assumes \"(f has_vderiv_on f') T\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows has_vderiv_on_add: \"((\\<lambda>x. f x + g x) has_vderiv_on (\\<lambda>x. f' x + g' x)) T\"\n   and has_vderiv_on_diff: \"((\\<lambda>x. f x - g x) has_vderiv_on (\\<lambda>x. f' x - g' x)) T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f x + g x) has_vderiv_on (\\<lambda>x. f' x + g' x)) T &&&\n    ((\\<lambda>x. f x - g x) has_vderiv_on (\\<lambda>x. f' x - g' x)) T", "using assms"], ["proof (prove)\nusing this:\n  (f has_vderiv_on f') T\n  (g has_vderiv_on g') T\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f x + g x) has_vderiv_on (\\<lambda>x. f' x + g' x)) T &&&\n    ((\\<lambda>x. f x - g x) has_vderiv_on (\\<lambda>x. f' x - g' x)) T", "by (auto simp: has_vderiv_on_def intro!: derivative_eq_intros)"], ["", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes f::\"real \\<Rightarrow> real\" and g::\"real \\<Rightarrow> 'a::real_normed_vector\"\n  assumes \"(f has_vderiv_on f') T\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows has_vderiv_on_scaleR: \"((\\<lambda>x. f x *\\<^sub>R g x) has_vderiv_on (\\<lambda>x. f x *\\<^sub>R g' x + f' x *\\<^sub>R g x)) T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f x *\\<^sub>R g x) has_vderiv_on\n     (\\<lambda>x. f x *\\<^sub>R g' x + f' x *\\<^sub>R g x))\n     T", "using assms"], ["proof (prove)\nusing this:\n  (f has_vderiv_on f') T\n  (g has_vderiv_on g') T\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f x *\\<^sub>R g x) has_vderiv_on\n     (\\<lambda>x. f x *\\<^sub>R g' x + f' x *\\<^sub>R g x))\n     T", "by (auto simp: has_vderiv_on_def has_field_derivative_iff_has_vector_derivative\n    intro!: derivative_eq_intros)"], ["", "lemma [THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes f g::\"real \\<Rightarrow> 'a::real_normed_algebra\"\n  assumes \"(f has_vderiv_on f') T\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows has_vderiv_on_mult: \"((\\<lambda>x. f x * g x) has_vderiv_on (\\<lambda>x. f x * g' x + f' x * g x)) T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f x * g x) has_vderiv_on\n     (\\<lambda>x. f x * g' x + f' x * g x))\n     T", "using assms"], ["proof (prove)\nusing this:\n  (f has_vderiv_on f') T\n  (g has_vderiv_on g') T\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f x * g x) has_vderiv_on\n     (\\<lambda>x. f x * g' x + f' x * g x))\n     T", "by (auto simp: has_vderiv_on_def intro!: derivative_eq_intros)"], ["", "lemma has_vderiv_on_ln[THEN has_vderiv_on_eq_rhs, derivative_intros]:\n  fixes g::\"real \\<Rightarrow> real\"\n  assumes \"\\<And>x. x \\<in> s \\<Longrightarrow> 0 < g x\"\n  assumes \"(g has_vderiv_on g') s\"\n  shows \"((\\<lambda>x. ln (g x)) has_vderiv_on (\\<lambda>x. g' x / g x)) s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. ln (g x)) has_vderiv_on (\\<lambda>x. g' x / g x)) s", "using assms"], ["proof (prove)\nusing this:\n  ?x \\<in> s \\<Longrightarrow> 0 < g ?x\n  (g has_vderiv_on g') s\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. ln (g x)) has_vderiv_on (\\<lambda>x. g' x / g x)) s", "unfolding has_vderiv_on_def"], ["proof (prove)\nusing this:\n  ?x \\<in> s \\<Longrightarrow> 0 < g ?x\n  \\<forall>x\\<in>s. (g has_vector_derivative g' x) (at x within s)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>s.\n       ((\\<lambda>x. ln (g x)) has_vector_derivative g' x / g x)\n        (at x within s)", "by (auto simp: has_vderiv_on_def has_field_derivative_iff_has_vector_derivative[symmetric]\n    intro!: derivative_eq_intros)"], ["", "lemma fundamental_theorem_of_calculus':\n  fixes f :: \"real \\<Rightarrow> 'a::banach\"\n  shows \"a \\<le> b \\<Longrightarrow> (f has_vderiv_on f') {a .. b} \\<Longrightarrow> (f' has_integral (f b - f a)) {a .. b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<le> b; (f has_vderiv_on f') {a..b}\\<rbrakk>\n    \\<Longrightarrow> (f' has_integral f b - f a) {a..b}", "by (auto intro!: fundamental_theorem_of_calculus simp: has_vderiv_on_def)"], ["", "lemma has_vderiv_on_If:\n  assumes \"U = S \\<union> T\"\n  assumes \"(f has_vderiv_on f') (S \\<union> (closure T \\<inter> closure S))\"\n  assumes \"(g has_vderiv_on g') (T \\<union> (closure T \\<inter> closure S))\"\n  assumes \"\\<And>x. x \\<in> closure T \\<Longrightarrow> x \\<in> closure S \\<Longrightarrow> f x = g x\"\n  assumes \"\\<And>x. x \\<in> closure T \\<Longrightarrow> x \\<in> closure S \\<Longrightarrow> f' x = g' x\"\n  shows \"((\\<lambda>t. if t \\<in> S then f t else g t) has_vderiv_on (\\<lambda>t. if t \\<in> S then f' t else g' t)) U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t. if t \\<in> S then f t else g t) has_vderiv_on\n     (\\<lambda>t. if t \\<in> S then f' t else g' t))\n     U", "using assms"], ["proof (prove)\nusing this:\n  U = S \\<union> T\n  (f has_vderiv_on f') (S \\<union> closure T \\<inter> closure S)\n  (g has_vderiv_on g') (T \\<union> closure T \\<inter> closure S)\n  \\<lbrakk>?x \\<in> closure T; ?x \\<in> closure S\\<rbrakk>\n  \\<Longrightarrow> f ?x = g ?x\n  \\<lbrakk>?x \\<in> closure T; ?x \\<in> closure S\\<rbrakk>\n  \\<Longrightarrow> f' ?x = g' ?x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. if t \\<in> S then f t else g t) has_vderiv_on\n     (\\<lambda>t. if t \\<in> S then f' t else g' t))\n     U", "by (auto simp: has_vderiv_on_def ac_simps\n      intro!: has_vector_derivative_If_within_closures\n      split del: if_split)"], ["", "lemma mvt_very_simple_closed_segmentE:\n  fixes f::\"real\\<Rightarrow>real\"\n  assumes \"(f has_vderiv_on f') (closed_segment a b)\"\n  obtains y where \"y \\<in> closed_segment a b\"  \"f b - f a = (b - a) * f' y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> closed_segment a b;\n         f b - f a = (b - a) * f' y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis", "assume \"a \\<le> b\""], ["proof (state)\nthis:\n  a \\<le> b\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis", "with mvt_very_simple[of a b f \"\\<lambda>x i. i *\\<^sub>R f' x\"] assms"], ["proof (chain)\npicking this:\n  \\<lbrakk>a \\<le> b;\n   \\<And>x.\n      \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n      \\<Longrightarrow> (f has_derivative (\\<lambda>i. i *\\<^sub>R f' x))\n                         (at x within {a..b})\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{a..b}.\n                       f b - f a = (b - a) *\\<^sub>R f' x\n  (f has_vderiv_on f') (closed_segment a b)\n  a \\<le> b", "obtain y where \"y \\<in> closed_segment a b\"  \"f b - f a = (b - a) * f' y\""], ["proof (prove)\nusing this:\n  \\<lbrakk>a \\<le> b;\n   \\<And>x.\n      \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n      \\<Longrightarrow> (f has_derivative (\\<lambda>i. i *\\<^sub>R f' x))\n                         (at x within {a..b})\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{a..b}.\n                       f b - f a = (b - a) *\\<^sub>R f' x\n  (f has_vderiv_on f') (closed_segment a b)\n  a \\<le> b\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> closed_segment a b;\n         f b - f a = (b - a) * f' y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: has_vector_derivative_def closed_segment_eq_real_ivl has_vderiv_on_def)"], ["proof (state)\nthis:\n  y \\<in> closed_segment a b\n  f b - f a = (b - a) * f' y\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  y \\<in> closed_segment a b\n  f b - f a = (b - a) * f' y\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "assume \"\\<not> a \\<le> b\""], ["proof (state)\nthis:\n  \\<not> a \\<le> b\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "with mvt_very_simple[of b a f \"\\<lambda>x i. i *\\<^sub>R f' x\"] assms"], ["proof (chain)\npicking this:\n  \\<lbrakk>b \\<le> a;\n   \\<And>x.\n      \\<lbrakk>b \\<le> x; x \\<le> a\\<rbrakk>\n      \\<Longrightarrow> (f has_derivative (\\<lambda>i. i *\\<^sub>R f' x))\n                         (at x within {b..a})\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{b..a}.\n                       f a - f b = (a - b) *\\<^sub>R f' x\n  (f has_vderiv_on f') (closed_segment a b)\n  \\<not> a \\<le> b", "obtain y where \"y \\<in> closed_segment a b\"  \"f b - f a = (b - a) * f' y\""], ["proof (prove)\nusing this:\n  \\<lbrakk>b \\<le> a;\n   \\<And>x.\n      \\<lbrakk>b \\<le> x; x \\<le> a\\<rbrakk>\n      \\<Longrightarrow> (f has_derivative (\\<lambda>i. i *\\<^sub>R f' x))\n                         (at x within {b..a})\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{b..a}.\n                       f a - f b = (a - b) *\\<^sub>R f' x\n  (f has_vderiv_on f') (closed_segment a b)\n  \\<not> a \\<le> b\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> closed_segment a b;\n         f b - f a = (b - a) * f' y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (force simp: has_vector_derivative_def has_vderiv_on_def closed_segment_eq_real_ivl algebra_simps)"], ["proof (state)\nthis:\n  y \\<in> closed_segment a b\n  f b - f a = (b - a) * f' y\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> closed_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  y \\<in> closed_segment a b\n  f b - f a = (b - a) * f' y\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma mvt_simple_closed_segmentE:\n  fixes f::\"real\\<Rightarrow>real\"\n  assumes \"(f has_vderiv_on f') (closed_segment a b)\"\n  assumes \"a \\<noteq> b\"\n  obtains y where \"y \\<in> open_segment a b\"  \"f b - f a = (b - a) * f' y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> open_segment a b;\n         f b - f a = (b - a) * f' y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis", "assume \"a \\<le> b\""], ["proof (state)\nthis:\n  a \\<le> b\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis", "with assms"], ["proof (chain)\npicking this:\n  (f has_vderiv_on f') (closed_segment a b)\n  a \\<noteq> b\n  a \\<le> b", "have \"a < b\""], ["proof (prove)\nusing this:\n  (f has_vderiv_on f') (closed_segment a b)\n  a \\<noteq> b\n  a \\<le> b\n\ngoal (1 subgoal):\n 1. a < b", "by simp"], ["proof (state)\nthis:\n  a < b\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis", "with mvt_simple[of a b f \"\\<lambda>x i. i *\\<^sub>R f' x\"] assms"], ["proof (chain)\npicking this:\n  \\<lbrakk>a < b;\n   \\<And>x.\n      \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n      \\<Longrightarrow> (f has_derivative (\\<lambda>i. i *\\<^sub>R f' x))\n                         (at x within {a..b})\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{a<..<b}.\n                       f b - f a = (b - a) *\\<^sub>R f' x\n  (f has_vderiv_on f') (closed_segment a b)\n  a \\<noteq> b\n  a < b", "obtain y where \"y \\<in> open_segment a b\"  \"f b - f a = (b - a) * f' y\""], ["proof (prove)\nusing this:\n  \\<lbrakk>a < b;\n   \\<And>x.\n      \\<lbrakk>a \\<le> x; x \\<le> b\\<rbrakk>\n      \\<Longrightarrow> (f has_derivative (\\<lambda>i. i *\\<^sub>R f' x))\n                         (at x within {a..b})\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{a<..<b}.\n                       f b - f a = (b - a) *\\<^sub>R f' x\n  (f has_vderiv_on f') (closed_segment a b)\n  a \\<noteq> b\n  a < b\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> open_segment a b;\n         f b - f a = (b - a) * f' y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: has_vector_derivative_def closed_segment_eq_real_ivl has_vderiv_on_def\n        open_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  y \\<in> open_segment a b\n  f b - f a = (b - a) * f' y\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> ?P2\\<rbrakk>\n    \\<Longrightarrow> thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  y \\<in> open_segment a b\n  f b - f a = (b - a) * f' y\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "assume \"\\<not> a \\<le> b\""], ["proof (state)\nthis:\n  \\<not> a \\<le> b\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "then"], ["proof (chain)\npicking this:\n  \\<not> a \\<le> b", "have \"b < a\""], ["proof (prove)\nusing this:\n  \\<not> a \\<le> b\n\ngoal (1 subgoal):\n 1. b < a", "by simp"], ["proof (state)\nthis:\n  b < a\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "with mvt_simple[of b a f \"\\<lambda>x i. i *\\<^sub>R f' x\"] assms"], ["proof (chain)\npicking this:\n  \\<lbrakk>b < a;\n   \\<And>x.\n      \\<lbrakk>b \\<le> x; x \\<le> a\\<rbrakk>\n      \\<Longrightarrow> (f has_derivative (\\<lambda>i. i *\\<^sub>R f' x))\n                         (at x within {b..a})\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{b<..<a}.\n                       f a - f b = (a - b) *\\<^sub>R f' x\n  (f has_vderiv_on f') (closed_segment a b)\n  a \\<noteq> b\n  b < a", "obtain y where \"y \\<in> open_segment a b\"  \"f b - f a = (b - a) * f' y\""], ["proof (prove)\nusing this:\n  \\<lbrakk>b < a;\n   \\<And>x.\n      \\<lbrakk>b \\<le> x; x \\<le> a\\<rbrakk>\n      \\<Longrightarrow> (f has_derivative (\\<lambda>i. i *\\<^sub>R f' x))\n                         (at x within {b..a})\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{b<..<a}.\n                       f a - f b = (a - b) *\\<^sub>R f' x\n  (f has_vderiv_on f') (closed_segment a b)\n  a \\<noteq> b\n  b < a\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> open_segment a b;\n         f b - f a = (b - a) * f' y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (force simp: has_vector_derivative_def has_vderiv_on_def closed_segment_eq_real_ivl algebra_simps\n      open_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  y \\<in> open_segment a b\n  f b - f a = (b - a) * f' y\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>y.\n                \\<lbrakk>y \\<in> open_segment a b;\n                 f b - f a = (b - a) * f' y\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     \\<not> a \\<le> b\\<rbrakk>\n    \\<Longrightarrow> thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  y \\<in> open_segment a b\n  f b - f a = (b - a) * f' y\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma differentiable_bound_general_open_segment:\n  fixes a :: \"real\"\n    and b :: \"real\"\n    and f :: \"real \\<Rightarrow> 'a::real_normed_vector\"\n    and f' :: \"real \\<Rightarrow> 'a\"\n  assumes \"continuous_on (closed_segment a b) f\"\n  assumes \"continuous_on (closed_segment a b) g\"\n    and \"(f has_vderiv_on f') (open_segment a b)\"\n    and \"(g has_vderiv_on g') (open_segment a b)\"\n    and \"\\<And>x. x \\<in> open_segment a b \\<Longrightarrow> norm (f' x) \\<le> g' x\"\n  shows \"norm (f b - f a) \\<le> abs (g b - g a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "assume \"a = b\""], ["proof (state)\nthis:\n  a = b\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "hence ?thesis"], ["proof (prove)\nusing this:\n  a = b\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "by simp"], ["proof (state)\nthis:\n  norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "}"], ["proof (state)\nthis:\n  a = b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "moreover"], ["proof (state)\nthis:\n  a = b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "{"], ["proof (state)\nthis:\n  a = b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "assume \"a < b\""], ["proof (state)\nthis:\n  a < b\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "with assms"], ["proof (chain)\npicking this:\n  continuous_on (closed_segment a b) f\n  continuous_on (closed_segment a b) g\n  (f has_vderiv_on f') (open_segment a b)\n  (g has_vderiv_on g') (open_segment a b)\n  ?x \\<in> open_segment a b \\<Longrightarrow> norm (f' ?x) \\<le> g' ?x\n  a < b", "have \"continuous_on {a .. b} f\"\n      and \"continuous_on {a .. b} g\"\n      and \"\\<And>x. x\\<in>{a<..<b} \\<Longrightarrow> (f has_vector_derivative f' x) (at x)\"\n      and \"\\<And>x. x\\<in>{a<..<b} \\<Longrightarrow> (g has_vector_derivative g' x) (at x)\"\n      and \"\\<And>x. x\\<in>{a<..<b} \\<Longrightarrow> norm (f' x) \\<le> g' x\""], ["proof (prove)\nusing this:\n  continuous_on (closed_segment a b) f\n  continuous_on (closed_segment a b) g\n  (f has_vderiv_on f') (open_segment a b)\n  (g has_vderiv_on g') (open_segment a b)\n  ?x \\<in> open_segment a b \\<Longrightarrow> norm (f' ?x) \\<le> g' ?x\n  a < b\n\ngoal (1 subgoal):\n 1. (continuous_on {a..b} f &&& continuous_on {a..b} g) &&&\n    (\\<And>x.\n        x \\<in> {a<..<b} \\<Longrightarrow>\n        (f has_vector_derivative f' x) (at x)) &&&\n    (\\<And>x.\n        x \\<in> {a<..<b} \\<Longrightarrow>\n        (g has_vector_derivative g' x) (at x)) &&&\n    (\\<And>x. x \\<in> {a<..<b} \\<Longrightarrow> norm (f' x) \\<le> g' x)", "by (auto simp: open_segment_eq_real_ivl closed_segment_eq_real_ivl has_vderiv_on_def\n        at_within_open[where S=\"{a<..<b}\"])"], ["proof (state)\nthis:\n  continuous_on {a..b} f\n  continuous_on {a..b} g\n  ?x \\<in> {a<..<b} \\<Longrightarrow>\n  (f has_vector_derivative f' ?x) (at ?x)\n  ?x \\<in> {a<..<b} \\<Longrightarrow>\n  (g has_vector_derivative g' ?x) (at ?x)\n  ?x \\<in> {a<..<b} \\<Longrightarrow> norm (f' ?x) \\<le> g' ?x\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "from differentiable_bound_general[OF \\<open>a < b\\<close> this]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x.\n              \\<lbrakk>a < x; x < b\\<rbrakk>\n              \\<Longrightarrow> x \\<in> {a<..<b};\n   \\<And>x.\n      \\<lbrakk>a < x; x < b\\<rbrakk> \\<Longrightarrow> x \\<in> {a<..<b};\n   \\<And>x.\n      \\<lbrakk>a < x; x < b\\<rbrakk>\n      \\<Longrightarrow> x \\<in> {a<..<b}\\<rbrakk>\n  \\<Longrightarrow> norm (f b - f a) \\<le> g b - g a", "have ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x.\n              \\<lbrakk>a < x; x < b\\<rbrakk>\n              \\<Longrightarrow> x \\<in> {a<..<b};\n   \\<And>x.\n      \\<lbrakk>a < x; x < b\\<rbrakk> \\<Longrightarrow> x \\<in> {a<..<b};\n   \\<And>x.\n      \\<lbrakk>a < x; x < b\\<rbrakk>\n      \\<Longrightarrow> x \\<in> {a<..<b}\\<rbrakk>\n  \\<Longrightarrow> norm (f b - f a) \\<le> g b - g a\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "by auto"], ["proof (state)\nthis:\n  norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "}"], ["proof (state)\nthis:\n  a < b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "moreover"], ["proof (state)\nthis:\n  a < b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "{"], ["proof (state)\nthis:\n  a < b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "assume \"b < a\""], ["proof (state)\nthis:\n  b < a\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "with assms"], ["proof (chain)\npicking this:\n  continuous_on (closed_segment a b) f\n  continuous_on (closed_segment a b) g\n  (f has_vderiv_on f') (open_segment a b)\n  (g has_vderiv_on g') (open_segment a b)\n  ?x \\<in> open_segment a b \\<Longrightarrow> norm (f' ?x) \\<le> g' ?x\n  b < a", "have \"continuous_on {b .. a} f\"\n      and \"continuous_on {b .. a} g\"\n      and \"\\<And>x. x\\<in>{b<..<a} \\<Longrightarrow> (f has_vector_derivative f' x) (at x)\"\n      and \"\\<And>x. x\\<in>{b<..<a} \\<Longrightarrow> (g has_vector_derivative g' x) (at x)\"\n      and \"\\<And>x. x\\<in>{b<..<a} \\<Longrightarrow> norm (f' x) \\<le> g' x\""], ["proof (prove)\nusing this:\n  continuous_on (closed_segment a b) f\n  continuous_on (closed_segment a b) g\n  (f has_vderiv_on f') (open_segment a b)\n  (g has_vderiv_on g') (open_segment a b)\n  ?x \\<in> open_segment a b \\<Longrightarrow> norm (f' ?x) \\<le> g' ?x\n  b < a\n\ngoal (1 subgoal):\n 1. (continuous_on {b..a} f &&& continuous_on {b..a} g) &&&\n    (\\<And>x.\n        x \\<in> {b<..<a} \\<Longrightarrow>\n        (f has_vector_derivative f' x) (at x)) &&&\n    (\\<And>x.\n        x \\<in> {b<..<a} \\<Longrightarrow>\n        (g has_vector_derivative g' x) (at x)) &&&\n    (\\<And>x. x \\<in> {b<..<a} \\<Longrightarrow> norm (f' x) \\<le> g' x)", "by (auto simp: open_segment_eq_real_ivl closed_segment_eq_real_ivl has_vderiv_on_def\n        at_within_open[where S=\"{b<..<a}\"])"], ["proof (state)\nthis:\n  continuous_on {b..a} f\n  continuous_on {b..a} g\n  ?x \\<in> {b<..<a} \\<Longrightarrow>\n  (f has_vector_derivative f' ?x) (at ?x)\n  ?x \\<in> {b<..<a} \\<Longrightarrow>\n  (g has_vector_derivative g' ?x) (at ?x)\n  ?x \\<in> {b<..<a} \\<Longrightarrow> norm (f' ?x) \\<le> g' ?x\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "from differentiable_bound_general[OF \\<open>b < a\\<close> this]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x.\n              \\<lbrakk>b < x; x < a\\<rbrakk>\n              \\<Longrightarrow> x \\<in> {b<..<a};\n   \\<And>x.\n      \\<lbrakk>b < x; x < a\\<rbrakk> \\<Longrightarrow> x \\<in> {b<..<a};\n   \\<And>x.\n      \\<lbrakk>b < x; x < a\\<rbrakk>\n      \\<Longrightarrow> x \\<in> {b<..<a}\\<rbrakk>\n  \\<Longrightarrow> norm (f a - f b) \\<le> g a - g b", "have \"norm (f a - f b) \\<le> g a - g b\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x.\n              \\<lbrakk>b < x; x < a\\<rbrakk>\n              \\<Longrightarrow> x \\<in> {b<..<a};\n   \\<And>x.\n      \\<lbrakk>b < x; x < a\\<rbrakk> \\<Longrightarrow> x \\<in> {b<..<a};\n   \\<And>x.\n      \\<lbrakk>b < x; x < a\\<rbrakk>\n      \\<Longrightarrow> x \\<in> {b<..<a}\\<rbrakk>\n  \\<Longrightarrow> norm (f a - f b) \\<le> g a - g b\n\ngoal (1 subgoal):\n 1. norm (f a - f b) \\<le> g a - g b", "by simp"], ["proof (state)\nthis:\n  norm (f a - f b) \\<le> g a - g b\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "also"], ["proof (state)\nthis:\n  norm (f a - f b) \\<le> g a - g b\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "have \"\\<dots> \\<le> abs (g b - g a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g a - g b \\<le> \\<bar>g b - g a\\<bar>", "by simp"], ["proof (state)\nthis:\n  g a - g b \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "finally"], ["proof (chain)\npicking this:\n  norm (f a - f b) \\<le> \\<bar>g b - g a\\<bar>", "have ?thesis"], ["proof (prove)\nusing this:\n  norm (f a - f b) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "by (simp add: norm_minus_commute)"], ["proof (state)\nthis:\n  norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "}"], ["proof (state)\nthis:\n  b < a \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "ultimately"], ["proof (chain)\npicking this:\n  a = b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n  a < b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n  b < a \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "show ?thesis"], ["proof (prove)\nusing this:\n  a = b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n  a < b \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n  b < a \\<Longrightarrow> norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal (1 subgoal):\n 1. norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>", "by arith"], ["proof (state)\nthis:\n  norm (f b - f a) \\<le> \\<bar>g b - g a\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma has_vderiv_on_union:\n  assumes \"(f has_vderiv_on g) (s \\<union> closure s \\<inter> closure t)\"\n  assumes \"(f has_vderiv_on g) (t \\<union> closure s \\<inter> closure t)\"\n  shows \"(f has_vderiv_on g) (s \\<union> t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_vderiv_on g) (s \\<union> t)", "unfolding has_vderiv_on_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>s \\<union> t.\n       (f has_vector_derivative g x) (at x within s \\<union> t)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> s \\<union> t \\<Longrightarrow>\n       (f has_vector_derivative g x) (at x within s \\<union> t)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> s \\<union> t \\<Longrightarrow>\n       (f has_vector_derivative g x) (at x within s \\<union> t)", "assume \"x \\<in> s \\<union> t\""], ["proof (state)\nthis:\n  x \\<in> s \\<union> t\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> s \\<union> t \\<Longrightarrow>\n       (f has_vector_derivative g x) (at x within s \\<union> t)", "with has_vector_derivative_If_within_closures[of x s t \"s \\<union> t\" f g f g] assms"], ["proof (chain)\npicking this:\n  \\<lbrakk>x \\<in> s \\<union> t; s \\<union> t = s \\<union> t;\n   x \\<in> s \\<union> closure s \\<inter> closure t \\<Longrightarrow>\n   (f has_vector_derivative g x)\n    (at x within s \\<union> closure s \\<inter> closure t);\n   x \\<in> t \\<union> closure s \\<inter> closure t \\<Longrightarrow>\n   (f has_vector_derivative g x)\n    (at x within t \\<union> closure s \\<inter> closure t);\n   \\<lbrakk>x \\<in> closure s; x \\<in> closure t\\<rbrakk>\n   \\<Longrightarrow> f x = f x;\n   \\<lbrakk>x \\<in> closure s; x \\<in> closure t\\<rbrakk>\n   \\<Longrightarrow> g x = g x\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x.\n                         if x \\<in> s then f x\n                         else f x) has_vector_derivative\n                     (if x \\<in> s then g x else g x))\n                     (at x within s \\<union> t)\n  (f has_vderiv_on g) (s \\<union> closure s \\<inter> closure t)\n  (f has_vderiv_on g) (t \\<union> closure s \\<inter> closure t)\n  x \\<in> s \\<union> t", "show \"(f has_vector_derivative g x) (at x within s \\<union> t)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>x \\<in> s \\<union> t; s \\<union> t = s \\<union> t;\n   x \\<in> s \\<union> closure s \\<inter> closure t \\<Longrightarrow>\n   (f has_vector_derivative g x)\n    (at x within s \\<union> closure s \\<inter> closure t);\n   x \\<in> t \\<union> closure s \\<inter> closure t \\<Longrightarrow>\n   (f has_vector_derivative g x)\n    (at x within t \\<union> closure s \\<inter> closure t);\n   \\<lbrakk>x \\<in> closure s; x \\<in> closure t\\<rbrakk>\n   \\<Longrightarrow> f x = f x;\n   \\<lbrakk>x \\<in> closure s; x \\<in> closure t\\<rbrakk>\n   \\<Longrightarrow> g x = g x\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x.\n                         if x \\<in> s then f x\n                         else f x) has_vector_derivative\n                     (if x \\<in> s then g x else g x))\n                     (at x within s \\<union> t)\n  (f has_vderiv_on g) (s \\<union> closure s \\<inter> closure t)\n  (f has_vderiv_on g) (t \\<union> closure s \\<inter> closure t)\n  x \\<in> s \\<union> t\n\ngoal (1 subgoal):\n 1. (f has_vector_derivative g x) (at x within s \\<union> t)", "by (auto simp: has_vderiv_on_def)"], ["proof (state)\nthis:\n  (f has_vector_derivative g x) (at x within s \\<union> t)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma has_vderiv_on_union_closed:\n  assumes \"(f has_vderiv_on g) s\"\n  assumes \"(f has_vderiv_on g) t\"\n  assumes \"closed s\" \"closed t\"\n  shows \"(f has_vderiv_on g) (s \\<union> t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_vderiv_on g) (s \\<union> t)", "using has_vderiv_on_If[OF refl, of f g s t f g] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>(f has_vderiv_on g) (s \\<union> closure t \\<inter> closure s);\n   (f has_vderiv_on g) (t \\<union> closure t \\<inter> closure s);\n   \\<And>x.\n      \\<lbrakk>x \\<in> closure t; x \\<in> closure s\\<rbrakk>\n      \\<Longrightarrow> f x = f x;\n   \\<And>x.\n      \\<lbrakk>x \\<in> closure t; x \\<in> closure s\\<rbrakk>\n      \\<Longrightarrow> g x = g x\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>t.\n                         if t \\<in> s then f t else f t) has_vderiv_on\n                     (\\<lambda>t. if t \\<in> s then g t else g t))\n                     (s \\<union> t)\n  (f has_vderiv_on g) s\n  (f has_vderiv_on g) t\n  closed s\n  closed t\n\ngoal (1 subgoal):\n 1. (f has_vderiv_on g) (s \\<union> t)", "by (auto simp: has_vderiv_on_subset)"], ["", "lemma vderiv_on_continuous_on: \"(f has_vderiv_on f') S \\<Longrightarrow> continuous_on S f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_vderiv_on f') S \\<Longrightarrow> continuous_on S f", "by (auto intro!: continuous_on_vector_derivative simp: has_vderiv_on_def)"], ["", "lemma has_vderiv_on_cong[cong]:\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\"\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> f' x = g' x\"\n  assumes \"S = T\"\n  shows \"(f has_vderiv_on f') S = (g has_vderiv_on g') T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f has_vderiv_on f') S = (g has_vderiv_on g') T", "using assms"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n  ?x \\<in> S \\<Longrightarrow> f' ?x = g' ?x\n  S = T\n\ngoal (1 subgoal):\n 1. (f has_vderiv_on f') S = (g has_vderiv_on g') T", "by (metis has_vector_derivative_transform has_vderiv_on_def)"], ["", "lemma has_vderiv_eq:\n  assumes \"(f has_vderiv_on f') S\"\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\"\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> f' x = g' x\"\n  assumes \"S = T\"\n  shows \"(g has_vderiv_on g') T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (g has_vderiv_on g') T", "using assms"], ["proof (prove)\nusing this:\n  (f has_vderiv_on f') S\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n  ?x \\<in> S \\<Longrightarrow> f' ?x = g' ?x\n  S = T\n\ngoal (1 subgoal):\n 1. (g has_vderiv_on g') T", "by simp"], ["", "lemma has_vderiv_on_compose':\n  assumes \"(f has_vderiv_on f') (g ` T)\"\n  assumes \"(g has_vderiv_on g') T\"\n  shows \"((\\<lambda>x. f (g x)) has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f (g x)) has_vderiv_on\n     (\\<lambda>x. g' x *\\<^sub>R f' (g x)))\n     T", "using has_vderiv_on_compose[OF assms]"], ["proof (prove)\nusing this:\n  (f \\<circ> g has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f (g x)) has_vderiv_on\n     (\\<lambda>x. g' x *\\<^sub>R f' (g x)))\n     T", "by simp"], ["", "lemma has_vderiv_on_compose2:\n  assumes \"(f has_vderiv_on f') S\"\n  assumes \"(g has_vderiv_on g') T\"\n  assumes \"\\<And>t. t \\<in> T \\<Longrightarrow> g t \\<in> S\"\n  shows \"((\\<lambda>x. f (g x)) has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f (g x)) has_vderiv_on\n     (\\<lambda>x. g' x *\\<^sub>R f' (g x)))\n     T", "using has_vderiv_on_compose[OF has_vderiv_on_subset[OF assms(1)] assms(2)] assms(3)"], ["proof (prove)\nusing this:\n  g ` T \\<subseteq> S \\<Longrightarrow>\n  (f \\<circ> g has_vderiv_on (\\<lambda>x. g' x *\\<^sub>R f' (g x))) T\n  ?t \\<in> T \\<Longrightarrow> g ?t \\<in> S\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. f (g x)) has_vderiv_on\n     (\\<lambda>x. g' x *\\<^sub>R f' (g x)))\n     T", "by force"], ["", "lemma has_vderiv_on_singleton: \"(y has_vderiv_on y') {t0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (y has_vderiv_on y') {t0}", "by (auto simp: has_vderiv_on_def has_vector_derivative_def has_derivative_within_singleton_iff\n      bounded_linear_scaleR_left)"], ["", "lemma\n  has_vderiv_on_zero_constant:\n  assumes \"convex s\"\n  assumes \"(f has_vderiv_on (\\<lambda>h. 0)) s\"\n  obtains c where \"\\<And>x. x \\<in> s \\<Longrightarrow> f x = c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c.\n        (\\<And>x. x \\<in> s \\<Longrightarrow> f x = c) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using has_vector_derivative_zero_constant[of s f] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>convex s;\n   \\<And>x.\n      x \\<in> s \\<Longrightarrow>\n      (f has_vector_derivative (0::'a)) (at x within s);\n   \\<And>c.\n      (\\<And>x. x \\<in> s \\<Longrightarrow> f x = c) \\<Longrightarrow>\n      ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n  convex s\n  (f has_vderiv_on (\\<lambda>h. 0::'a)) s\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        (\\<And>x. x \\<in> s \\<Longrightarrow> f x = c) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: has_vderiv_on_def)"], ["", "lemma bounded_vderiv_on_imp_lipschitz:\n  assumes \"(f has_vderiv_on f') X\"\n  assumes convex: \"convex X\"\n  assumes \"\\<And>x. x \\<in> X \\<Longrightarrow> norm (f' x) \\<le> C\" \"0 \\<le> C\"\n  shows \"C-lipschitz_on X f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C-lipschitz_on X f", "using assms"], ["proof (prove)\nusing this:\n  (f has_vderiv_on f') X\n  convex X\n  ?x \\<in> X \\<Longrightarrow> norm (f' ?x) \\<le> C\n  0 \\<le> C\n\ngoal (1 subgoal):\n 1. C-lipschitz_on X f", "by (auto simp: has_vderiv_on_def has_vector_derivative_def onorm_scaleR_left onorm_id\n    intro!: bounded_derivative_imp_lipschitz[where f' = \"\\<lambda>x d. d *\\<^sub>R f' x\"])"], ["", "end"]]}