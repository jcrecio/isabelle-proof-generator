{"file_name": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations/Library/Gronwall.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations", "problem_names": ["lemma derivative_quotient_bound:\n  assumes g_deriv_on: \"(g has_vderiv_on g') {a .. b}\"\n  assumes frac_le: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> g' t / g t \\<le> K\"\n  assumes g'_cont: \"continuous_on {a .. b} g'\"\n  assumes g_pos: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> g t > 0\"\n  assumes t_in: \"t \\<in> {a .. b}\"\n  shows \"g t \\<le> g a * exp (K * (t - a))\"", "lemma derivative_quotient_bound_left:\n  assumes g_deriv_on: \"(g has_vderiv_on g') {a .. b}\"\n  assumes frac_ge: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> K \\<le> g' t / g t\"\n  assumes g'_cont: \"continuous_on {a .. b} g'\"\n  assumes g_pos: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> g t > 0\"\n  assumes t_in: \"t \\<in> {a..b}\"\n  shows \"g t \\<le> g b * exp (K * (t - b))\"", "lemma gronwall_general:\n  fixes g K C a b and t::real\n  defines \"G \\<equiv> \\<lambda>t. C + K * integral {a..t} (\\<lambda>s. g s)\"\n  assumes g_le_G: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> g t \\<le> G t\"\n  assumes g_cont: \"continuous_on {a..b} g\"\n  assumes g_nonneg: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 \\<le> g t\"\n  assumes pos: \"0 < C\" \"K > 0\"\n  assumes \"t \\<in> {a..b}\"\n  shows \"g t \\<le> C * exp (K * (t - a))\"", "lemma gronwall_general_left:\n  fixes g K C a b and t::real\n  defines \"G \\<equiv> \\<lambda>t. C + K * integral {t..b} (\\<lambda>s. g s)\"\n  assumes g_le_G: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> g t \\<le> G t\"\n  assumes g_cont: \"continuous_on {a..b} g\"\n  assumes g_nonneg: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 \\<le> g t\"\n  assumes pos: \"0 < C\" \"K > 0\"\n  assumes \"t \\<in> {a..b}\"\n  shows \"g t \\<le> C * exp (-K * (t - b))\"", "lemma gronwall_general_segment:\n  fixes a b::real\n  assumes \"\\<And>t. t \\<in> closed_segment a b \\<Longrightarrow> g t \\<le> C + K * integral (closed_segment a t) g\"\n    and \"continuous_on (closed_segment a b) g\"\n    and \"\\<And>t. t \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> g t\"\n    and \"0 < C\"\n    and \"0 < K\"\n    and \"t \\<in> closed_segment a b\"\n  shows \"g t \\<le> C * exp (K * abs (t - a))\"", "lemma gronwall_more_general_segment:\n  fixes a b c::real\n  assumes \"\\<And>t. t \\<in> closed_segment a b \\<Longrightarrow> g t \\<le> C + K * integral (closed_segment c t) g\"\n    and cont: \"continuous_on (closed_segment a b) g\"\n    and \"\\<And>t. t \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> g t\"\n    and \"0 < C\"\n    and \"0 < K\"\n    and t: \"t \\<in> closed_segment a b\"\n    and c: \"c \\<in> closed_segment a b\"\n  shows \"g t \\<le> C * exp (K * abs (t - c))\"", "lemma gronwall:\n  fixes g K C and t::real\n  defines \"G \\<equiv> \\<lambda>t. C + K * integral {0..t} (\\<lambda>s. g s)\"\n  assumes g_le_G: \"\\<And>t. 0 \\<le> t \\<Longrightarrow> t \\<le> a \\<Longrightarrow> g t \\<le> G t\"\n  assumes g_cont: \"continuous_on {0..a} g\"\n  assumes g_nonneg: \"\\<And>t. 0 \\<le> t \\<Longrightarrow> t \\<le> a \\<Longrightarrow> 0 \\<le> g t\"\n  assumes pos: \"0 < C\" \"0 < K\"\n  assumes \"0 \\<le> t\" \"t \\<le> a\"\n  shows \"g t \\<le> C * exp (K * t)\"", "lemma gronwall_left:\n  fixes g K C and t::real\n  defines \"G \\<equiv> \\<lambda>t. C + K * integral {t..0} (\\<lambda>s. g s)\"\n  assumes g_le_G: \"\\<And>t. a \\<le> t \\<Longrightarrow> t \\<le> 0 \\<Longrightarrow> g t \\<le> G t\"\n  assumes g_cont: \"continuous_on {a..0} g\"\n  assumes g_nonneg: \"\\<And>t. a \\<le> t \\<Longrightarrow> t \\<le> 0 \\<Longrightarrow> 0 \\<le> g t\"\n  assumes pos: \"0 < C\" \"0 < K\"\n  assumes \"a \\<le> t\" \"t \\<le> 0\"\n  shows \"g t \\<le> C * exp (-K * t)\""], "translations": [["", "lemma derivative_quotient_bound:\n  assumes g_deriv_on: \"(g has_vderiv_on g') {a .. b}\"\n  assumes frac_le: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> g' t / g t \\<le> K\"\n  assumes g'_cont: \"continuous_on {a .. b} g'\"\n  assumes g_pos: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> g t > 0\"\n  assumes t_in: \"t \\<in> {a .. b}\"\n  shows \"g t \\<le> g a * exp (K * (t - a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "have g_deriv: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> (g has_real_derivative g' t) (at t within {a .. b})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       (g has_real_derivative g' t) (at t within {a..b})", "using g_deriv_on"], ["proof (prove)\nusing this:\n  (g has_vderiv_on g') {a..b}\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       (g has_real_derivative g' t) (at t within {a..b})", "by (auto simp: has_vderiv_on_def has_field_derivative_iff_has_vector_derivative[symmetric])"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  (g has_real_derivative g' ?t) (at ?t within {a..b})\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "from assms"], ["proof (chain)\npicking this:\n  (g has_vderiv_on g') {a..b}\n  ?t \\<in> {a..b} \\<Longrightarrow> g' ?t / g ?t \\<le> K\n  continuous_on {a..b} g'\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < g ?t\n  t \\<in> {a..b}", "have g_nonzero: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> g t \\<noteq> 0\""], ["proof (prove)\nusing this:\n  (g has_vderiv_on g') {a..b}\n  ?t \\<in> {a..b} \\<Longrightarrow> g' ?t / g ?t \\<le> K\n  continuous_on {a..b} g'\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < g ?t\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> g t \\<noteq> 0", "by fastforce"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow> g ?t \\<noteq> 0\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "have frac_integrable: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> (\\<lambda>t. g' t / g t) integrable_on {a..t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       (\\<lambda>t. g' t / g t) integrable_on {a..t}", "by (force simp: g_nonzero intro: assms has_field_derivative_subset[OF g_deriv]\n      continuous_on_subset[OF g'_cont] continuous_intros integrable_continuous_real\n      continuous_on_subset[OF vderiv_on_continuous_on[OF g_deriv_on]])"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  (\\<lambda>t. g' t / g t) integrable_on {a..?t}\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "have \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> ((\\<lambda>t. g' t / g t) has_integral ln (g t) - ln (g a)) {a .. t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       ((\\<lambda>t. g' t / g t) has_integral ln (g t) - ln (g a)) {a..t}", "by (rule fundamental_theorem_of_calculus)\n      (auto intro!: derivative_eq_intros assms has_field_derivative_subset[OF g_deriv]\n        simp: has_field_derivative_iff_has_vector_derivative[symmetric])"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ((\\<lambda>t. g' t / g t) has_integral ln (g ?t) - ln (g a)) {a..?t}\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "hence *: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> ln (g t) - ln (g a) = integral {a .. t} (\\<lambda>t. g' t / g t)\""], ["proof (prove)\nusing this:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ((\\<lambda>t. g' t / g t) has_integral ln (g ?t) - ln (g a)) {a..?t}\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       ln (g t) - ln (g a) = integral {a..t} (\\<lambda>t. g' t / g t)", "using integrable_integral[OF frac_integrable]"], ["proof (prove)\nusing this:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ((\\<lambda>t. g' t / g t) has_integral ln (g ?t) - ln (g a)) {a..?t}\n  ?t1 \\<in> {a..b} \\<Longrightarrow>\n  ((\\<lambda>t. g' t / g t) has_integral\n   integral {a..?t1} (\\<lambda>t. g' t / g t))\n   {a..?t1}\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       ln (g t) - ln (g a) = integral {a..t} (\\<lambda>t. g' t / g t)", "by (rule has_integral_unique[where f = \"\\<lambda>t. g' t / g t\"])"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ln (g ?t) - ln (g a) = integral {a..?t} (\\<lambda>t. g' t / g t)\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "from * t_in"], ["proof (chain)\npicking this:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ln (g ?t) - ln (g a) = integral {a..?t} (\\<lambda>t. g' t / g t)\n  t \\<in> {a..b}", "have \"ln (g t) - ln (g a) = integral {a .. t} (\\<lambda>t. g' t / g t)\""], ["proof (prove)\nusing this:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ln (g ?t) - ln (g a) = integral {a..?t} (\\<lambda>t. g' t / g t)\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. ln (g t) - ln (g a) = integral {a..t} (\\<lambda>t. g' t / g t)", "."], ["proof (state)\nthis:\n  ln (g t) - ln (g a) = integral {a..t} (\\<lambda>t. g' t / g t)\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "also"], ["proof (state)\nthis:\n  ln (g t) - ln (g a) = integral {a..t} (\\<lambda>t. g' t / g t)\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "have \"\\<dots> \\<le> integral {a .. t} (\\<lambda>_. K)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {a..t} (\\<lambda>t. g' t / g t)\n    \\<le> integral {a..t} (\\<lambda>_. K)", "using \\<open>t \\<in> {a .. b}\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. integral {a..t} (\\<lambda>t. g' t / g t)\n    \\<le> integral {a..t} (\\<lambda>_. K)", "by (intro integral_le) (auto intro!: frac_integrable frac_le integral_le)"], ["proof (state)\nthis:\n  integral {a..t} (\\<lambda>t. g' t / g t)\n  \\<le> integral {a..t} (\\<lambda>_. K)\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "also"], ["proof (state)\nthis:\n  integral {a..t} (\\<lambda>t. g' t / g t)\n  \\<le> integral {a..t} (\\<lambda>_. K)\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "have \"\\<dots> = K * (t - a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {a..t} (\\<lambda>_. K) = K * (t - a)", "using \\<open>t \\<in> {a .. b}\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. integral {a..t} (\\<lambda>_. K) = K * (t - a)", "by simp"], ["proof (state)\nthis:\n  integral {a..t} (\\<lambda>_. K) = K * (t - a)\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "finally"], ["proof (chain)\npicking this:\n  ln (g t) - ln (g a) \\<le> K * (t - a)", "have \"ln (g t) \\<le> K * (t - a) + ln (g a)\" (is \"?lhs \\<le> ?rhs\")"], ["proof (prove)\nusing this:\n  ln (g t) - ln (g a) \\<le> K * (t - a)\n\ngoal (1 subgoal):\n 1. ln (g t) \\<le> K * (t - a) + ln (g a)", "by simp"], ["proof (state)\nthis:\n  ln (g t) \\<le> K * (t - a) + ln (g a)\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "hence \"exp ?lhs \\<le> exp ?rhs\""], ["proof (prove)\nusing this:\n  ln (g t) \\<le> K * (t - a) + ln (g a)\n\ngoal (1 subgoal):\n 1. exp (ln (g t)) \\<le> exp (K * (t - a) + ln (g a))", "by simp"], ["proof (state)\nthis:\n  exp (ln (g t)) \\<le> exp (K * (t - a) + ln (g a))\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "thus ?thesis"], ["proof (prove)\nusing this:\n  exp (ln (g t)) \\<le> exp (K * (t - a) + ln (g a))\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "using \\<open>t \\<in> {a .. b}\\<close> g_pos"], ["proof (prove)\nusing this:\n  exp (ln (g t)) \\<le> exp (K * (t - a) + ln (g a))\n  t \\<in> {a..b}\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < g ?t\n\ngoal (1 subgoal):\n 1. g t \\<le> g a * exp (K * (t - a))", "by (simp add: ac_simps exp_add del: exp_le_cancel_iff)"], ["proof (state)\nthis:\n  g t \\<le> g a * exp (K * (t - a))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma derivative_quotient_bound_left:\n  assumes g_deriv_on: \"(g has_vderiv_on g') {a .. b}\"\n  assumes frac_ge: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> K \\<le> g' t / g t\"\n  assumes g'_cont: \"continuous_on {a .. b} g'\"\n  assumes g_pos: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> g t > 0\"\n  assumes t_in: \"t \\<in> {a..b}\"\n  shows \"g t \\<le> g b * exp (K * (t - b))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "have g_deriv: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> (g has_real_derivative g' t) (at t within {a .. b})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       (g has_real_derivative g' t) (at t within {a..b})", "using g_deriv_on"], ["proof (prove)\nusing this:\n  (g has_vderiv_on g') {a..b}\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       (g has_real_derivative g' t) (at t within {a..b})", "by (auto simp: has_vderiv_on_def has_field_derivative_iff_has_vector_derivative[symmetric])"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  (g has_real_derivative g' ?t) (at ?t within {a..b})\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "from assms"], ["proof (chain)\npicking this:\n  (g has_vderiv_on g') {a..b}\n  ?t \\<in> {a..b} \\<Longrightarrow> K \\<le> g' ?t / g ?t\n  continuous_on {a..b} g'\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < g ?t\n  t \\<in> {a..b}", "have g_nonzero: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> g t \\<noteq> 0\""], ["proof (prove)\nusing this:\n  (g has_vderiv_on g') {a..b}\n  ?t \\<in> {a..b} \\<Longrightarrow> K \\<le> g' ?t / g ?t\n  continuous_on {a..b} g'\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < g ?t\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> g t \\<noteq> 0", "by fastforce"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow> g ?t \\<noteq> 0\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "have frac_integrable: \"\\<And>t. t \\<in> {a .. b} \\<Longrightarrow> (\\<lambda>t. g' t / g t) integrable_on {t..b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       (\\<lambda>t. g' t / g t) integrable_on {t..b}", "by (force simp: g_nonzero intro: assms has_field_derivative_subset[OF g_deriv]\n      continuous_on_subset[OF g'_cont] continuous_intros integrable_continuous_real\n      continuous_on_subset[OF vderiv_on_continuous_on[OF g_deriv_on]])"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  (\\<lambda>t. g' t / g t) integrable_on {?t..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "have \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> ((\\<lambda>t. g' t / g t) has_integral ln (g b) - ln (g t)) {t..b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       ((\\<lambda>t. g' t / g t) has_integral ln (g b) - ln (g t)) {t..b}", "by (rule fundamental_theorem_of_calculus)\n      (auto intro!: derivative_eq_intros assms has_field_derivative_subset[OF g_deriv]\n        simp: has_field_derivative_iff_has_vector_derivative[symmetric])"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ((\\<lambda>t. g' t / g t) has_integral ln (g b) - ln (g ?t)) {?t..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "hence *: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> ln (g b) - ln (g t) = integral {t..b} (\\<lambda>t. g' t / g t)\""], ["proof (prove)\nusing this:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ((\\<lambda>t. g' t / g t) has_integral ln (g b) - ln (g ?t)) {?t..b}\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       ln (g b) - ln (g t) = integral {t..b} (\\<lambda>t. g' t / g t)", "using integrable_integral[OF frac_integrable]"], ["proof (prove)\nusing this:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ((\\<lambda>t. g' t / g t) has_integral ln (g b) - ln (g ?t)) {?t..b}\n  ?t1 \\<in> {a..b} \\<Longrightarrow>\n  ((\\<lambda>t. g' t / g t) has_integral\n   integral {?t1..b} (\\<lambda>t. g' t / g t))\n   {?t1..b}\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {a..b} \\<Longrightarrow>\n       ln (g b) - ln (g t) = integral {t..b} (\\<lambda>t. g' t / g t)", "by (rule has_integral_unique[where f = \"\\<lambda>t. g' t / g t\"])"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ln (g b) - ln (g ?t) = integral {?t..b} (\\<lambda>t. g' t / g t)\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "have \"K * (b - t) = integral {t..b} (\\<lambda>_. K)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K * (b - t) = integral {t..b} (\\<lambda>_. K)", "using \\<open>t \\<in> {a..b}\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. K * (b - t) = integral {t..b} (\\<lambda>_. K)", "by simp"], ["proof (state)\nthis:\n  K * (b - t) = integral {t..b} (\\<lambda>_. K)\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "also"], ["proof (state)\nthis:\n  K * (b - t) = integral {t..b} (\\<lambda>_. K)\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "have \"... \\<le> integral {t..b} (\\<lambda>t. g' t / g t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {t..b} (\\<lambda>_. K)\n    \\<le> integral {t..b} (\\<lambda>t. g' t / g t)", "using \\<open>t \\<in> {a..b}\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. integral {t..b} (\\<lambda>_. K)\n    \\<le> integral {t..b} (\\<lambda>t. g' t / g t)", "by (intro integral_le) (auto intro!: frac_integrable frac_ge integral_le)"], ["proof (state)\nthis:\n  integral {t..b} (\\<lambda>_. K)\n  \\<le> integral {t..b} (\\<lambda>t. g' t / g t)\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "also"], ["proof (state)\nthis:\n  integral {t..b} (\\<lambda>_. K)\n  \\<le> integral {t..b} (\\<lambda>t. g' t / g t)\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "have \"... = ln (g b) - ln (g t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {t..b} (\\<lambda>t. g' t / g t) = ln (g b) - ln (g t)", "using * t_in"], ["proof (prove)\nusing this:\n  ?t \\<in> {a..b} \\<Longrightarrow>\n  ln (g b) - ln (g ?t) = integral {?t..b} (\\<lambda>t. g' t / g t)\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. integral {t..b} (\\<lambda>t. g' t / g t) = ln (g b) - ln (g t)", "by simp"], ["proof (state)\nthis:\n  integral {t..b} (\\<lambda>t. g' t / g t) = ln (g b) - ln (g t)\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "finally"], ["proof (chain)\npicking this:\n  K * (b - t) \\<le> ln (g b) - ln (g t)", "have \"K * (b - t) + ln (g t) \\<le> ln (g b)\" (is \"?lhs \\<le> ?rhs\")"], ["proof (prove)\nusing this:\n  K * (b - t) \\<le> ln (g b) - ln (g t)\n\ngoal (1 subgoal):\n 1. K * (b - t) + ln (g t) \\<le> ln (g b)", "by simp"], ["proof (state)\nthis:\n  K * (b - t) + ln (g t) \\<le> ln (g b)\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "hence \"exp ?lhs \\<le> exp ?rhs\""], ["proof (prove)\nusing this:\n  K * (b - t) + ln (g t) \\<le> ln (g b)\n\ngoal (1 subgoal):\n 1. exp (K * (b - t) + ln (g t)) \\<le> exp (ln (g b))", "by simp"], ["proof (state)\nthis:\n  exp (K * (b - t) + ln (g t)) \\<le> exp (ln (g b))\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "hence \"g t * exp (K * (b - t)) \\<le> g b\""], ["proof (prove)\nusing this:\n  exp (K * (b - t) + ln (g t)) \\<le> exp (ln (g b))\n\ngoal (1 subgoal):\n 1. g t * exp (K * (b - t)) \\<le> g b", "using \\<open>t \\<in> {a..b}\\<close> g_pos"], ["proof (prove)\nusing this:\n  exp (K * (b - t) + ln (g t)) \\<le> exp (ln (g b))\n  t \\<in> {a..b}\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < g ?t\n\ngoal (1 subgoal):\n 1. g t * exp (K * (b - t)) \\<le> g b", "by (simp add: ac_simps exp_add del: exp_le_cancel_iff)"], ["proof (state)\nthis:\n  g t * exp (K * (b - t)) \\<le> g b\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "hence \"g t / exp (K * (t - b)) \\<le> g b\""], ["proof (prove)\nusing this:\n  g t * exp (K * (b - t)) \\<le> g b\n\ngoal (1 subgoal):\n 1. g t / exp (K * (t - b)) \\<le> g b", "by (simp add: algebra_simps exp_diff)"], ["proof (state)\nthis:\n  g t / exp (K * (t - b)) \\<le> g b\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "thus ?thesis"], ["proof (prove)\nusing this:\n  g t / exp (K * (t - b)) \\<le> g b\n\ngoal (1 subgoal):\n 1. g t \\<le> g b * exp (K * (t - b))", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  g t \\<le> g b * exp (K * (t - b))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma gronwall_general:\n  fixes g K C a b and t::real\n  defines \"G \\<equiv> \\<lambda>t. C + K * integral {a..t} (\\<lambda>s. g s)\"\n  assumes g_le_G: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> g t \\<le> G t\"\n  assumes g_cont: \"continuous_on {a..b} g\"\n  assumes g_nonneg: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 \\<le> g t\"\n  assumes pos: \"0 < C\" \"K > 0\"\n  assumes \"t \\<in> {a..b}\"\n  shows \"g t \\<le> C * exp (K * (t - a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "have G_pos: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 < G t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 < G t", "by (auto simp: G_def intro!: add_pos_nonneg mult_nonneg_nonneg Henstock_Kurzweil_Integration.integral_nonneg\n      integrable_continuous_real assms intro: less_imp_le continuous_on_subset)"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < G ?t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "have \"g t \\<le> G t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> G t", "using assms"], ["proof (prove)\nusing this:\n  G \\<equiv> \\<lambda>t. C + K * integral {a..t} g\n  ?t \\<in> {a..b} \\<Longrightarrow> g ?t \\<le> G ?t\n  continuous_on {a..b} g\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 \\<le> g ?t\n  0 < C\n  0 < K\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> G t", "by auto"], ["proof (state)\nthis:\n  g t \\<le> G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "also"], ["proof (state)\nthis:\n  g t \\<le> G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "{"], ["proof (state)\nthis:\n  g t \\<le> G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "have \"(G has_vderiv_on (\\<lambda>t. K * g t)) {a..b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (G has_vderiv_on (\\<lambda>t. K * g t)) {a..b}", "by (auto intro!: derivative_eq_intros integral_has_vector_derivative g_cont\n        simp add: G_def has_vderiv_on_def)"], ["proof (state)\nthis:\n  (G has_vderiv_on (\\<lambda>t. K * g t)) {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "moreover"], ["proof (state)\nthis:\n  (G has_vderiv_on (\\<lambda>t. K * g t)) {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "{"], ["proof (state)\nthis:\n  (G has_vderiv_on (\\<lambda>t. K * g t)) {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "assume \"t \\<in> {a..b}\""], ["proof (state)\nthis:\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "hence \"K * g t / G t \\<le> K * G t / G t\""], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. K * g t / G t \\<le> K * G t / G t", "using pos g_le_G G_pos"], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n  0 < C\n  0 < K\n  ?t \\<in> {a..b} \\<Longrightarrow> g ?t \\<le> G ?t\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < G ?t\n\ngoal (1 subgoal):\n 1. K * g t / G t \\<le> K * G t / G t", "by (intro divide_right_mono mult_left_mono) (auto intro!: less_imp_le)"], ["proof (state)\nthis:\n  K * g t / G t \\<le> K * G t / G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "also"], ["proof (state)\nthis:\n  K * g t / G t \\<le> K * G t / G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "have \"\\<dots> = K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K * G t / G t = K", "using G_pos[of t] \\<open>t \\<in> {a .. b}\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {a..b} \\<Longrightarrow> 0 < G t\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. K * G t / G t = K", "by simp"], ["proof (state)\nthis:\n  K * G t / G t = K\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "finally"], ["proof (chain)\npicking this:\n  K * g t / G t \\<le> K", "have \"K * g t / G t \\<le> K\""], ["proof (prove)\nusing this:\n  K * g t / G t \\<le> K\n\ngoal (1 subgoal):\n 1. K * g t / G t \\<le> K", "."], ["proof (state)\nthis:\n  K * g t / G t \\<le> K\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "}"], ["proof (state)\nthis:\n  ?ta2 \\<in> {a..b} \\<Longrightarrow> K * g ?ta2 / G ?ta2 \\<le> K\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "ultimately"], ["proof (chain)\npicking this:\n  (G has_vderiv_on (\\<lambda>t. K * g t)) {a..b}\n  ?ta2 \\<in> {a..b} \\<Longrightarrow> K * g ?ta2 / G ?ta2 \\<le> K", "have \"G t \\<le> G a * exp (K * (t - a))\""], ["proof (prove)\nusing this:\n  (G has_vderiv_on (\\<lambda>t. K * g t)) {a..b}\n  ?ta2 \\<in> {a..b} \\<Longrightarrow> K * g ?ta2 / G ?ta2 \\<le> K\n\ngoal (1 subgoal):\n 1. G t \\<le> G a * exp (K * (t - a))", "apply (rule derivative_quotient_bound)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> t \\<in> {a..b}\n 2. continuous_on {a..b} (\\<lambda>t. K * g t)\n 3. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 < G t\n 4. t \\<in> {a..b}", "using \\<open>t \\<in> {a..b}\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n\ngoal (4 subgoals):\n 1. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> t \\<in> {a..b}\n 2. continuous_on {a..b} (\\<lambda>t. K * g t)\n 3. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 < G t\n 4. t \\<in> {a..b}", "by (auto intro!: continuous_intros g_cont G_pos simp: field_simps pos)"], ["proof (state)\nthis:\n  G t \\<le> G a * exp (K * (t - a))\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "}"], ["proof (state)\nthis:\n  G t \\<le> G a * exp (K * (t - a))\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "also"], ["proof (state)\nthis:\n  G t \\<le> G a * exp (K * (t - a))\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "have \"G a = C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G a = C", "by (simp add: G_def)"], ["proof (state)\nthis:\n  G a = C\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "finally"], ["proof (chain)\npicking this:\n  g t \\<le> C * exp (K * (t - a))", "show ?thesis"], ["proof (prove)\nusing this:\n  g t \\<le> C * exp (K * (t - a))\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "by simp"], ["proof (state)\nthis:\n  g t \\<le> C * exp (K * (t - a))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma gronwall_general_left:\n  fixes g K C a b and t::real\n  defines \"G \\<equiv> \\<lambda>t. C + K * integral {t..b} (\\<lambda>s. g s)\"\n  assumes g_le_G: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> g t \\<le> G t\"\n  assumes g_cont: \"continuous_on {a..b} g\"\n  assumes g_nonneg: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 \\<le> g t\"\n  assumes pos: \"0 < C\" \"K > 0\"\n  assumes \"t \\<in> {a..b}\"\n  shows \"g t \\<le> C * exp (-K * (t - b))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "have G_pos: \"\\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 < G t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 < G t", "by (auto simp: G_def intro!: add_pos_nonneg mult_nonneg_nonneg Henstock_Kurzweil_Integration.integral_nonneg\n      integrable_continuous_real assms intro: less_imp_le continuous_on_subset)"], ["proof (state)\nthis:\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < G ?t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "have \"g t \\<le> G t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> G t", "using assms"], ["proof (prove)\nusing this:\n  G \\<equiv> \\<lambda>t. C + K * integral {t..b} g\n  ?t \\<in> {a..b} \\<Longrightarrow> g ?t \\<le> G ?t\n  continuous_on {a..b} g\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 \\<le> g ?t\n  0 < C\n  0 < K\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> G t", "by auto"], ["proof (state)\nthis:\n  g t \\<le> G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "also"], ["proof (state)\nthis:\n  g t \\<le> G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "{"], ["proof (state)\nthis:\n  g t \\<le> G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "have \"(G has_vderiv_on (\\<lambda>t. -K * g t)) {a..b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (G has_vderiv_on (\\<lambda>t. - K * g t)) {a..b}", "by (auto intro!: derivative_eq_intros g_cont integral_has_vector_derivative'\n          simp add: G_def has_vderiv_on_def)"], ["proof (state)\nthis:\n  (G has_vderiv_on (\\<lambda>t. - K * g t)) {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "moreover"], ["proof (state)\nthis:\n  (G has_vderiv_on (\\<lambda>t. - K * g t)) {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "{"], ["proof (state)\nthis:\n  (G has_vderiv_on (\\<lambda>t. - K * g t)) {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "assume \"t \\<in> {a..b}\""], ["proof (state)\nthis:\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "hence \"K * g t / G t \\<le> K * G t / G t\""], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. K * g t / G t \\<le> K * G t / G t", "using pos g_le_G G_pos"], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n  0 < C\n  0 < K\n  ?t \\<in> {a..b} \\<Longrightarrow> g ?t \\<le> G ?t\n  ?t \\<in> {a..b} \\<Longrightarrow> 0 < G ?t\n\ngoal (1 subgoal):\n 1. K * g t / G t \\<le> K * G t / G t", "by (intro divide_right_mono mult_left_mono) (auto intro!: less_imp_le)"], ["proof (state)\nthis:\n  K * g t / G t \\<le> K * G t / G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "also"], ["proof (state)\nthis:\n  K * g t / G t \\<le> K * G t / G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "have \"\\<dots> = K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. K * G t / G t = K", "using G_pos[of t] \\<open>t \\<in> {a .. b}\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {a..b} \\<Longrightarrow> 0 < G t\n  t \\<in> {a..b}\n\ngoal (1 subgoal):\n 1. K * G t / G t = K", "by simp"], ["proof (state)\nthis:\n  K * G t / G t = K\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "finally"], ["proof (chain)\npicking this:\n  K * g t / G t \\<le> K", "have \"K * g t / G t \\<le> K\""], ["proof (prove)\nusing this:\n  K * g t / G t \\<le> K\n\ngoal (1 subgoal):\n 1. K * g t / G t \\<le> K", "."], ["proof (state)\nthis:\n  K * g t / G t \\<le> K\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "hence \"-K \\<le> -K * g t / G t\""], ["proof (prove)\nusing this:\n  K * g t / G t \\<le> K\n\ngoal (1 subgoal):\n 1. - K \\<le> - K * g t / G t", "by simp"], ["proof (state)\nthis:\n  - K \\<le> - K * g t / G t\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "}"], ["proof (state)\nthis:\n  ?ta2 \\<in> {a..b} \\<Longrightarrow> - K \\<le> - K * g ?ta2 / G ?ta2\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "ultimately"], ["proof (chain)\npicking this:\n  (G has_vderiv_on (\\<lambda>t. - K * g t)) {a..b}\n  ?ta2 \\<in> {a..b} \\<Longrightarrow> - K \\<le> - K * g ?ta2 / G ?ta2", "have \"G t \\<le> G b * exp (-K * (t - b))\""], ["proof (prove)\nusing this:\n  (G has_vderiv_on (\\<lambda>t. - K * g t)) {a..b}\n  ?ta2 \\<in> {a..b} \\<Longrightarrow> - K \\<le> - K * g ?ta2 / G ?ta2\n\ngoal (1 subgoal):\n 1. G t \\<le> G b * exp (- K * (t - b))", "apply (rule derivative_quotient_bound_left)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> t \\<in> {a..b}\n 2. continuous_on {a..b} (\\<lambda>t. - K * g t)\n 3. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 < G t\n 4. t \\<in> {a..b}", "using \\<open>t \\<in> {a..b}\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> {a..b}\n\ngoal (4 subgoals):\n 1. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> t \\<in> {a..b}\n 2. continuous_on {a..b} (\\<lambda>t. - K * g t)\n 3. \\<And>t. t \\<in> {a..b} \\<Longrightarrow> 0 < G t\n 4. t \\<in> {a..b}", "by (auto intro!: continuous_intros g_cont G_pos simp: field_simps pos)"], ["proof (state)\nthis:\n  G t \\<le> G b * exp (- K * (t - b))\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "}"], ["proof (state)\nthis:\n  G t \\<le> G b * exp (- K * (t - b))\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "also"], ["proof (state)\nthis:\n  G t \\<le> G b * exp (- K * (t - b))\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "have \"G b = C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G b = C", "by (simp add: G_def)"], ["proof (state)\nthis:\n  G b = C\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "finally"], ["proof (chain)\npicking this:\n  g t \\<le> C * exp (- K * (t - b))", "show ?thesis"], ["proof (prove)\nusing this:\n  g t \\<le> C * exp (- K * (t - b))\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - b))", "by simp"], ["proof (state)\nthis:\n  g t \\<le> C * exp (- K * (t - b))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma gronwall_general_segment:\n  fixes a b::real\n  assumes \"\\<And>t. t \\<in> closed_segment a b \\<Longrightarrow> g t \\<le> C + K * integral (closed_segment a t) g\"\n    and \"continuous_on (closed_segment a b) g\"\n    and \"\\<And>t. t \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> g t\"\n    and \"0 < C\"\n    and \"0 < K\"\n    and \"t \\<in> closed_segment a b\"\n  shows \"g t \\<le> C * exp (K * abs (t - a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)\n 2. \\<not> ?P \\<Longrightarrow> g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "assume \"a \\<le> b\""], ["proof (state)\nthis:\n  a \\<le> b\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)\n 2. \\<not> ?P \\<Longrightarrow> g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "then"], ["proof (chain)\npicking this:\n  a \\<le> b", "have *: \"abs (t - a) = t -a\""], ["proof (prove)\nusing this:\n  a \\<le> b\n\ngoal (1 subgoal):\n 1. \\<bar>t - a\\<bar> = t - a", "using assms"], ["proof (prove)\nusing this:\n  a \\<le> b\n  ?t \\<in> closed_segment a b \\<Longrightarrow>\n  g ?t \\<le> C + K * integral (closed_segment a ?t) g\n  continuous_on (closed_segment a b) g\n  ?t \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> g ?t\n  0 < C\n  0 < K\n  t \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. \\<bar>t - a\\<bar> = t - a", "by (auto simp: closed_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  \\<bar>t - a\\<bar> = t - a\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)\n 2. \\<not> ?P \\<Longrightarrow> g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "unfolding *"], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "using assms"], ["proof (prove)\nusing this:\n  ?t \\<in> closed_segment a b \\<Longrightarrow>\n  g ?t \\<le> C + K * integral (closed_segment a ?t) g\n  continuous_on (closed_segment a b) g\n  ?t \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> g ?t\n  0 < C\n  0 < K\n  t \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * (t - a))", "by (intro gronwall_general[where b=b]) (auto intro!: simp: closed_segment_eq_real_ivl \\<open>a \\<le> b\\<close>)"], ["proof (state)\nthis:\n  g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "assume \"\\<not>a \\<le> b\""], ["proof (state)\nthis:\n  \\<not> a \\<le> b\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "then"], ["proof (chain)\npicking this:\n  \\<not> a \\<le> b", "have *: \"K * abs (t - a) = - K * (t - a)\""], ["proof (prove)\nusing this:\n  \\<not> a \\<le> b\n\ngoal (1 subgoal):\n 1. K * \\<bar>t - a\\<bar> = - K * (t - a)", "using assms"], ["proof (prove)\nusing this:\n  \\<not> a \\<le> b\n  ?t \\<in> closed_segment a b \\<Longrightarrow>\n  g ?t \\<le> C + K * integral (closed_segment a ?t) g\n  continuous_on (closed_segment a b) g\n  ?t \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> g ?t\n  0 < C\n  0 < K\n  t \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. K * \\<bar>t - a\\<bar> = - K * (t - a)", "by (auto simp: closed_segment_eq_real_ivl algebra_simps)"], ["proof (state)\nthis:\n  K * \\<bar>t - a\\<bar> = - K * (t - a)\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "{"], ["proof (state)\nthis:\n  K * \\<bar>t - a\\<bar> = - K * (t - a)\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "fix s :: real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "assume a1: \"b \\<le> s\""], ["proof (state)\nthis:\n  b \\<le> s\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "assume a2: \"s \\<le> a\""], ["proof (state)\nthis:\n  s \\<le> a\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "assume a3: \"\\<And>t. b \\<le> t \\<and> t \\<le> a \\<Longrightarrow> g t \\<le> C + K * integral (if a \\<le> t then {a..t} else {t..a}) g\""], ["proof (state)\nthis:\n  b \\<le> ?t \\<and> ?t \\<le> a \\<Longrightarrow>\n  g ?t \\<le> C + K * integral (if a \\<le> ?t then {a..?t} else {?t..a}) g\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "have \"s = a \\<or> s < a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. s = a \\<or> s < a", "using a2"], ["proof (prove)\nusing this:\n  s \\<le> a\n\ngoal (1 subgoal):\n 1. s = a \\<or> s < a", "by (meson less_eq_real_def)"], ["proof (state)\nthis:\n  s = a \\<or> s < a\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "then"], ["proof (chain)\npicking this:\n  s = a \\<or> s < a", "have \"g s \\<le> C + K * integral {s..a} g\""], ["proof (prove)\nusing this:\n  s = a \\<or> s < a\n\ngoal (1 subgoal):\n 1. g s \\<le> C + K * integral {s..a} g", "using a3 a1"], ["proof (prove)\nusing this:\n  s = a \\<or> s < a\n  b \\<le> ?t \\<and> ?t \\<le> a \\<Longrightarrow>\n  g ?t \\<le> C + K * integral (if a \\<le> ?t then {a..?t} else {?t..a}) g\n  b \\<le> s\n\ngoal (1 subgoal):\n 1. g s \\<le> C + K * integral {s..a} g", "by fastforce"], ["proof (state)\nthis:\n  g s \\<le> C + K * integral {s..a} g\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "}"], ["proof (state)\nthis:\n  \\<lbrakk>b \\<le> ?s2; ?s2 \\<le> a;\n   \\<And>t.\n      b \\<le> t \\<and> t \\<le> a \\<Longrightarrow>\n      g t\n      \\<le> C +\n            K * integral (if a \\<le> t then {a..t} else {t..a}) g\\<rbrakk>\n  \\<Longrightarrow> g ?s2 \\<le> C + K * integral {?s2..a} g\n\ngoal (1 subgoal):\n 1. \\<not> a \\<le> b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>b \\<le> ?s2; ?s2 \\<le> a;\n   \\<And>t.\n      b \\<le> t \\<and> t \\<le> a \\<Longrightarrow>\n      g t\n      \\<le> C +\n            K * integral (if a \\<le> t then {a..t} else {t..a}) g\\<rbrakk>\n  \\<Longrightarrow> g ?s2 \\<le> C + K * integral {?s2..a} g", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>b \\<le> ?s2; ?s2 \\<le> a;\n   \\<And>t.\n      b \\<le> t \\<and> t \\<le> a \\<Longrightarrow>\n      g t\n      \\<le> C +\n            K * integral (if a \\<le> t then {a..t} else {t..a}) g\\<rbrakk>\n  \\<Longrightarrow> g ?s2 \\<le> C + K * integral {?s2..a} g\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)", "unfolding *"], ["proof (prove)\nusing this:\n  \\<lbrakk>b \\<le> ?s2; ?s2 \\<le> a;\n   \\<And>t.\n      b \\<le> t \\<and> t \\<le> a \\<Longrightarrow>\n      g t\n      \\<le> C +\n            K * integral (if a \\<le> t then {a..t} else {t..a}) g\\<rbrakk>\n  \\<Longrightarrow> g ?s2 \\<le> C + K * integral {?s2..a} g\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - a))", "using assms  \\<open>\\<not>a \\<le> b\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>b \\<le> ?s2; ?s2 \\<le> a;\n   \\<And>t.\n      b \\<le> t \\<and> t \\<le> a \\<Longrightarrow>\n      g t\n      \\<le> C +\n            K * integral (if a \\<le> t then {a..t} else {t..a}) g\\<rbrakk>\n  \\<Longrightarrow> g ?s2 \\<le> C + K * integral {?s2..a} g\n  ?t \\<in> closed_segment a b \\<Longrightarrow>\n  g ?t \\<le> C + K * integral (closed_segment a ?t) g\n  continuous_on (closed_segment a b) g\n  ?t \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> g ?t\n  0 < C\n  0 < K\n  t \\<in> closed_segment a b\n  \\<not> a \\<le> b\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * (t - a))", "by (intro gronwall_general_left)\n      (auto intro!: simp: closed_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  g t \\<le> C * exp (K * \\<bar>t - a\\<bar>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma gronwall_more_general_segment:\n  fixes a b c::real\n  assumes \"\\<And>t. t \\<in> closed_segment a b \\<Longrightarrow> g t \\<le> C + K * integral (closed_segment c t) g\"\n    and cont: \"continuous_on (closed_segment a b) g\"\n    and \"\\<And>t. t \\<in> closed_segment a b \\<Longrightarrow> 0 \\<le> g t\"\n    and \"0 < C\"\n    and \"0 < K\"\n    and t: \"t \\<in> closed_segment a b\"\n    and c: \"c \\<in> closed_segment a b\"\n  shows \"g t \\<le> C * exp (K * abs (t - c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "from t c"], ["proof (chain)\npicking this:\n  t \\<in> closed_segment a b\n  c \\<in> closed_segment a b", "have \"t \\<in> closed_segment c a \\<or> t \\<in> closed_segment c b\""], ["proof (prove)\nusing this:\n  t \\<in> closed_segment a b\n  c \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. t \\<in> closed_segment c a \\<or> t \\<in> closed_segment c b", "by (auto simp: closed_segment_eq_real_ivl split_ifs)"], ["proof (state)\nthis:\n  t \\<in> closed_segment c a \\<or> t \\<in> closed_segment c b\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "then"], ["proof (chain)\npicking this:\n  t \\<in> closed_segment c a \\<or> t \\<in> closed_segment c b", "show ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> closed_segment c a \\<or> t \\<in> closed_segment c b\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. t \\<in> closed_segment c a \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)\n 2. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "assume \"t \\<in> closed_segment c a\""], ["proof (state)\nthis:\n  t \\<in> closed_segment c a\n\ngoal (2 subgoals):\n 1. t \\<in> closed_segment c a \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)\n 2. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "moreover"], ["proof (state)\nthis:\n  t \\<in> closed_segment c a\n\ngoal (2 subgoals):\n 1. t \\<in> closed_segment c a \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)\n 2. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "have subs: \"closed_segment c a \\<subseteq> closed_segment a b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed_segment c a \\<subseteq> closed_segment a b", "using t c"], ["proof (prove)\nusing this:\n  t \\<in> closed_segment a b\n  c \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. closed_segment c a \\<subseteq> closed_segment a b", "by (auto simp: closed_segment_eq_real_ivl split_ifs)"], ["proof (state)\nthis:\n  closed_segment c a \\<subseteq> closed_segment a b\n\ngoal (2 subgoals):\n 1. t \\<in> closed_segment c a \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)\n 2. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "ultimately"], ["proof (chain)\npicking this:\n  t \\<in> closed_segment c a\n  closed_segment c a \\<subseteq> closed_segment a b", "show ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> closed_segment c a\n  closed_segment c a \\<subseteq> closed_segment a b\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "by (intro gronwall_general_segment[where b=a])\n        (auto intro!: assms intro: continuous_on_subset)"], ["proof (state)\nthis:\n  g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)\n\ngoal (1 subgoal):\n 1. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "assume \"t \\<in> closed_segment c b\""], ["proof (state)\nthis:\n  t \\<in> closed_segment c b\n\ngoal (1 subgoal):\n 1. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "moreover"], ["proof (state)\nthis:\n  t \\<in> closed_segment c b\n\ngoal (1 subgoal):\n 1. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "have subs: \"closed_segment c b \\<subseteq> closed_segment a b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed_segment c b \\<subseteq> closed_segment a b", "using t c"], ["proof (prove)\nusing this:\n  t \\<in> closed_segment a b\n  c \\<in> closed_segment a b\n\ngoal (1 subgoal):\n 1. closed_segment c b \\<subseteq> closed_segment a b", "by (auto simp: closed_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  closed_segment c b \\<subseteq> closed_segment a b\n\ngoal (1 subgoal):\n 1. t \\<in> closed_segment c b \\<Longrightarrow>\n    g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "ultimately"], ["proof (chain)\npicking this:\n  t \\<in> closed_segment c b\n  closed_segment c b \\<subseteq> closed_segment a b", "show ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> closed_segment c b\n  closed_segment c b \\<subseteq> closed_segment a b\n\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)", "by (intro gronwall_general_segment[where b=b])\n        (auto intro!: assms intro: continuous_on_subset)"], ["proof (state)\nthis:\n  g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  g t \\<le> C * exp (K * \\<bar>t - c\\<bar>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma gronwall:\n  fixes g K C and t::real\n  defines \"G \\<equiv> \\<lambda>t. C + K * integral {0..t} (\\<lambda>s. g s)\"\n  assumes g_le_G: \"\\<And>t. 0 \\<le> t \\<Longrightarrow> t \\<le> a \\<Longrightarrow> g t \\<le> G t\"\n  assumes g_cont: \"continuous_on {0..a} g\"\n  assumes g_nonneg: \"\\<And>t. 0 \\<le> t \\<Longrightarrow> t \\<le> a \\<Longrightarrow> 0 \\<le> g t\"\n  assumes pos: \"0 < C\" \"0 < K\"\n  assumes \"0 \\<le> t\" \"t \\<le> a\"\n  shows \"g t \\<le> C * exp (K * t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (K * t)", "apply(rule gronwall_general[where a=0, simplified, OF assms(2-6)[unfolded G_def]])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>t. 0 \\<le> t \\<and> t \\<le> a \\<Longrightarrow> 0 \\<le> t\n 2. \\<And>t. 0 \\<le> t \\<and> t \\<le> a \\<Longrightarrow> t \\<le> a\n 3. \\<And>t. 0 \\<le> t \\<and> t \\<le> a \\<Longrightarrow> 0 \\<le> t\n 4. \\<And>t. 0 \\<le> t \\<and> t \\<le> a \\<Longrightarrow> t \\<le> a\n 5. 0 \\<le> t \\<and> t \\<le> a", "using assms(7,8)"], ["proof (prove)\nusing this:\n  0 \\<le> t\n  t \\<le> a\n\ngoal (5 subgoals):\n 1. \\<And>t. 0 \\<le> t \\<and> t \\<le> a \\<Longrightarrow> 0 \\<le> t\n 2. \\<And>t. 0 \\<le> t \\<and> t \\<le> a \\<Longrightarrow> t \\<le> a\n 3. \\<And>t. 0 \\<le> t \\<and> t \\<le> a \\<Longrightarrow> 0 \\<le> t\n 4. \\<And>t. 0 \\<le> t \\<and> t \\<le> a \\<Longrightarrow> t \\<le> a\n 5. 0 \\<le> t \\<and> t \\<le> a", "by simp_all"], ["", "lemma gronwall_left:\n  fixes g K C and t::real\n  defines \"G \\<equiv> \\<lambda>t. C + K * integral {t..0} (\\<lambda>s. g s)\"\n  assumes g_le_G: \"\\<And>t. a \\<le> t \\<Longrightarrow> t \\<le> 0 \\<Longrightarrow> g t \\<le> G t\"\n  assumes g_cont: \"continuous_on {a..0} g\"\n  assumes g_nonneg: \"\\<And>t. a \\<le> t \\<Longrightarrow> t \\<le> 0 \\<Longrightarrow> 0 \\<le> g t\"\n  assumes pos: \"0 < C\" \"0 < K\"\n  assumes \"a \\<le> t\" \"t \\<le> 0\"\n  shows \"g t \\<le> C * exp (-K * t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g t \\<le> C * exp (- K * t)", "apply(simp, rule gronwall_general_left[where b=0, simplified, OF assms(2-6)[unfolded G_def]])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>t. a \\<le> t \\<and> t \\<le> 0 \\<Longrightarrow> a \\<le> t\n 2. \\<And>t. a \\<le> t \\<and> t \\<le> 0 \\<Longrightarrow> t \\<le> 0\n 3. \\<And>t. a \\<le> t \\<and> t \\<le> 0 \\<Longrightarrow> a \\<le> t\n 4. \\<And>t. a \\<le> t \\<and> t \\<le> 0 \\<Longrightarrow> t \\<le> 0\n 5. a \\<le> t \\<and> t \\<le> 0", "using assms(7,8)"], ["proof (prove)\nusing this:\n  a \\<le> t\n  t \\<le> 0\n\ngoal (5 subgoals):\n 1. \\<And>t. a \\<le> t \\<and> t \\<le> 0 \\<Longrightarrow> a \\<le> t\n 2. \\<And>t. a \\<le> t \\<and> t \\<le> 0 \\<Longrightarrow> t \\<le> 0\n 3. \\<And>t. a \\<le> t \\<and> t \\<le> 0 \\<Longrightarrow> a \\<le> t\n 4. \\<And>t. a \\<le> t \\<and> t \\<le> 0 \\<Longrightarrow> t \\<le> 0\n 5. a \\<le> t \\<and> t \\<le> 0", "by simp_all"], ["", "end"]]}