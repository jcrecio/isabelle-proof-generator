{"file_name": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations/IVP/Reachability_Analysis.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ordinary_Differential_Equations", "problem_names": ["lemma not_mem_eq_mem_not: \"a \\<notin> A \\<longleftrightarrow> a \\<in> - A\"", "lemma continuous_orderD:\n  fixes g::\"'b::t2_space \\<Rightarrow> 'c::order_topology\"\n  assumes \"continuous (at x within S) g\"\n  shows \"g x > c \\<Longrightarrow> \\<forall>\\<^sub>F y in at x within S. g y > c\"\n    \"g x < c \\<Longrightarrow> \\<forall>\\<^sub>F y in at x within S. g y < c\"", "lemma frontier_halfspace_component_ge: \"n \\<noteq> 0 \\<Longrightarrow> frontier {x. c \\<le> x \\<bullet> n} = plane n c\"", "lemma closed_Collect_le_within:\n  fixes f g :: \"'a :: topological_space \\<Rightarrow> 'b::linorder_topology\"\n  assumes f: \"continuous_on UNIV f\"\n    and g: \"continuous_on UNIV g\"\n    and \"closed R\"\n  shows \"closed {x \\<in> R. f x \\<le> g x}\"", "lemmas halfspace_simps =\n  above_halfspace_def\n  sabove_halfspace_def\n  below_halfspace_def\n  sbelow_halfspace_def\n  below_halfspaces_def\n  sbelow_halfspaces_def\n  above_halfspaces_def\n  sabove_halfspaces_def\n  ge_halfspace_def[abs_def]\n  gt_halfspace_def[abs_def]\n  le_halfspace_def[abs_def]\n  lt_halfspace_def[abs_def]", "lemma flowpipeD:\n  assumes \"flowpipe X0 hl hu CX X1\"\n  shows flowpipe_safeD: \"fst ` X0 \\<union> fst ` CX \\<union> fst ` X1 \\<subseteq> X\"\n    and flowpipe_nonneg: \"0 \\<le> hl\" \"hl \\<le> hu\"\n    and flowpipe_exivl: \"hl \\<le> h \\<Longrightarrow> h \\<le> hu \\<Longrightarrow> (x0, d0) \\<in> X0 \\<Longrightarrow> h \\<in> existence_ivl0 x0\"\n    and flowpipe_discrete: \"hl \\<le> h \\<Longrightarrow> h \\<le> hu \\<Longrightarrow> (x0, d0) \\<in> X0 \\<Longrightarrow> (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1\"\n    and flowpipe_cont: \"hl \\<le> h \\<Longrightarrow> h \\<le> hu \\<Longrightarrow> (x0, d0) \\<in> X0 \\<Longrightarrow> 0 \\<le> h' \\<Longrightarrow> h' \\<le> h \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\"", "lemma flowpipe_source_subset: \"flowpipe X0 hl hu CX X1 \\<Longrightarrow> X0 \\<subseteq> CX\"", "lemma flowsto_to_empty_iff[simp]: \"flowsto a t b {} \\<longleftrightarrow> a = {}\"", "lemma flowsto_from_empty_iff[simp]: \"flowsto {} t b c\"", "lemma flowsto_empty_time_iff[simp]: \"flowsto a {} b c \\<longleftrightarrow> a = {}\"", "lemma flowstoE:\n  assumes \"flowsto X0 T CX X1\" \"(x0, d0) \\<in> X0\"\n  obtains h where \"h \\<in> T\" \"h \\<in> existence_ivl0 x0\" \"(flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1\"\n    \"\\<And>h'. h' \\<in> open_segment 0 h \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\"", "lemma flowsto_safeD: \"flowsto X0 T CX X1 \\<Longrightarrow> fst ` X0 \\<subseteq> X\"", "lemma flowsto_union:\n  assumes 1: \"flowsto X0 T CX Y\" and 2: \"flowsto Z S CZ W\"\n  shows \"flowsto (X0 \\<union> Z) (T \\<union> S) (CX \\<union> CZ) (Y \\<union> W)\"", "lemma flowsto_subset:\n  assumes \"flowsto X0 T CX Y\"\n  assumes \"Z \\<subseteq> X0\" \"T \\<subseteq> S\" \"CX \\<subseteq> CZ\" \"Y \\<subseteq> W\"\n  shows \"flowsto Z S CZ W\"", "lemmas flowsto_unionI = flowsto_subset[OF flowsto_union]", "lemma flowsto_unionE:\n  assumes \"flowsto X0 T CX (Y \\<union> Z)\"\n  obtains X1 X2 where \"X0 = X1 \\<union> X2\" \"flowsto X1 T CX Y\" \"flowsto X2 T CX Z\"", "lemma flowsto_trans:\n  assumes A: \"flowsto A S B C\" and C: \"flowsto C T D E\"\n  shows \"flowsto A {s + t |s t. s \\<in> S \\<and> t \\<in> T} (B \\<union> D \\<union> C) E\"", "lemma flowsto_step:\n  assumes A: \"flowsto A S B C\"\n  assumes D: \"flowsto D T E F\"\n  shows \"flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T}) (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)\"", "lemma\n  flowsto_stepI:\n    \"flowsto X0 U B C \\<Longrightarrow>\n    flowsto D T E F \\<Longrightarrow>\n    Z \\<subseteq> X0 \\<Longrightarrow>\n    (\\<And>s. s \\<in> U \\<Longrightarrow> s \\<in> S) \\<Longrightarrow>\n    (\\<And>s t. s \\<in> U \\<Longrightarrow> t \\<in> T \\<Longrightarrow> s + t \\<in> S) \\<Longrightarrow>\n    B \\<union> E \\<union> D \\<inter> C \\<subseteq> CZ \\<Longrightarrow> C - D \\<union> F \\<subseteq> W \\<Longrightarrow> flowsto Z S CZ W\"", "lemma flowsto_imp_flowsto:\n  \"flowpipe Y h h CY Z \\<Longrightarrow> flowsto Y {h} (CY) Z\"", "lemma connected_below_halfspace:\n  assumes \"x \\<in> below_halfspace sctn\"\n  assumes \"x \\<in> S\" \"connected S\"\n  assumes \"S \\<inter> plane_of sctn = {}\"\n  shows \"S \\<subseteq> below_halfspace sctn\"", "lemma\n  inter_Collect_eq_empty:\n  assumes \"\\<And>x. x \\<in> X0 \\<Longrightarrow> \\<not> g x\" shows \"X0 \\<inter> Collect g = {}\"", "lemma closed_plane_of[simp]: \"closed (plane_of sctn)\"", "lemma poincare_mapsto_empty[simp]:\n  \"poincare_mapsto P {} S CX Y\"", "lemma flowsto_eventually_mem_cont:\n  assumes \"flowsto X0 T CX Y\" \"(x, d) \\<in> X0\" \"T \\<subseteq> {0<..}\"\n  shows \"\\<forall>\\<^sub>F t in at_right 0. (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\"", "lemma frontier_aux_lemma:\n  fixes R :: \"'n::euclidean_space set\"\n  assumes \"closed R\" \"R \\<subseteq> {x. x \\<bullet> n = c}\" and [simp]: \"n \\<noteq> 0\"\n  shows \"frontier {x \\<in> R. c \\<le> x \\<bullet> n} = {x \\<in> R. c = x \\<bullet> n}\"", "lemma blinfun_minus_comp_distrib: \"(a - b) o\\<^sub>L c = (a o\\<^sub>L c) - (b o\\<^sub>L c)\"", "lemma flowpipe_split_at_above_halfspace:\n  assumes \"flowpipe X0 hl t CX Y\" \"fst ` X0 \\<inter> {x. x \\<bullet> n \\<ge> c} = {}\" and [simp]: \"n \\<noteq> 0\"\n  assumes cR: \"closed R\" and Rs: \"R \\<subseteq> plane n c\"\n  assumes PDP: \"\\<And>x d. (x, d) \\<in> CX \\<Longrightarrow> x \\<bullet> n = c \\<Longrightarrow> (x,\n     d - (blinfun_scaleR_left (f (x)) o\\<^sub>L (blinfun_scaleR_left (inverse (f x \\<bullet> n)) o\\<^sub>L (blinfun_inner_left n o\\<^sub>L d)))) \\<in> PDP\"\n  assumes PDP_nz: \"\\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0\"\n  assumes PDP_inR: \"\\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R\"\n  assumes PDP_in: \"\\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> \\<forall>\\<^sub>F x in at x within plane n c. x \\<in> R\"\n  obtains X1 X2 where \"X0 = X1 \\<union> X2\"\n    \"flowsto X1 {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV) (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)\"\n    \"flowsto X2 {hl .. t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV) (Y \\<inter> ({x. x \\<bullet> n < c} \\<times> UNIV))\"\n    \"poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\"", "lemma poincare_map_has_derivative_step:\n  assumes Deriv: \"(poincare_map P has_derivative blinfun_apply D) (at (flow0 x0 h))\"\n  assumes ret: \"returns_to P x0\"\n  assumes cont: \"continuous (at x0 within S) (return_time P)\"\n  assumes less: \"0 \\<le> h\" \"h < return_time P x0\"\n  assumes cP: \"closed P\" and x0: \"x0 \\<in> S\"\n  shows \"((\\<lambda>x. poincare_map P x) has_derivative (D o\\<^sub>L Dflow x0 h)) (at x0 within S)\"", "lemma poincare_mapsto_trans:\n  assumes \"poincare_mapsto p1 X0 S    CX P1\"\n  assumes \"poincare_mapsto p2 P1 UNIV CY P2\"\n  assumes \"CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\"\n  assumes \"p2 \\<inter> (CX \\<union> fst ` P1) = {}\"\n  assumes [intro, simp]: \"closed p1\"\n  assumes [intro, simp]: \"closed p2\"\n  assumes cont: \"\\<And>x d. (x, d) \\<in> X0 \\<Longrightarrow> continuous (at x within S) (return_time p2)\"\n  shows \"poincare_mapsto p2 X0 S CZ P2\"", "lemma flowsto_poincare_trans:\\<comment> \\<open>TODO: the proof is close to @{thm poincare_mapsto_trans}\\<close>\n  assumes f: \"flowsto            X0 T     CX P1\"\n  assumes \"poincare_mapsto p2 P1 UNIV CY P2\"\n  assumes nn: \"\\<And>t. t \\<in> T \\<Longrightarrow> t \\<ge> 0\"\n  assumes \"fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\"\n  assumes \"p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\"\n  assumes [intro, simp]: \"closed p2\"\n  assumes cont: \"\\<And>x d. (x, d) \\<in> X0 \\<Longrightarrow> continuous (at x within S) (return_time p2)\"\n  assumes subset: \"fst ` X0 \\<subseteq> S\"\n  shows \"poincare_mapsto p2 X0 S CZ P2\"", "lemma sectionD:\n  assumes \"section s Ds S\"\n  shows \"(s has_derivative blinfun_apply (Ds x)) (at x)\"\n    \"isCont Ds x\"\n    \"x \\<in> S \\<Longrightarrow> s x = 0 \\<Longrightarrow> Ds x (f x) \\<noteq> 0\"\n    \"closed S\" \"S \\<subseteq> X\"", "lemma transversalD: \"transversal p \\<Longrightarrow> x \\<in> p \\<Longrightarrow> \\<forall>\\<^sub>F t in at_right 0. flow0 x t \\<notin> p\"", "lemma transversal_section:\n  fixes c::real\n  assumes \"section s Ds S\"\n  shows \"transversal {x \\<in> S. s x = 0}\"", "lemma section_closed[intro, simp]: \"section s Ds S \\<Longrightarrow> closed {x \\<in> S. s x = 0}\"", "lemma return_time_continuous_belowI:\n  assumes ft: \"flowsto X0 T CX X1\"\n  assumes pos: \"\\<And>t. t \\<in> T \\<Longrightarrow> t > 0\"\n  assumes X0: \"fst ` X0 \\<subseteq> {x \\<in> S. s x = 0}\"\n  assumes CX: \"fst ` CX \\<inter> {x \\<in> S. s x = 0} = {}\"\n  assumes X1: \"fst ` X1 \\<subseteq> {x \\<in> S. s x = 0}\"\n  assumes sec: \"section s Ds S\"\n  assumes nz: \"\\<And>x. x \\<in> S \\<Longrightarrow> s x = 0 \\<Longrightarrow> Ds x (f x) \\<noteq> 0\"\n  assumes Dneg: \"(\\<lambda>x. (Ds x) (f x)) ` fst ` X0 \\<subseteq> {..<0}\"\n  assumes rel_int: \"\\<And>x. x \\<in> fst ` X1 \\<Longrightarrow> \\<forall>\\<^sub>F x in at x. s x = 0 \\<longrightarrow> x \\<in> S\"\n  assumes \"(x, d) \\<in> X0\"\n  shows \"continuous (at x within {x. s x \\<le> 0}) (return_time {x \\<in> S. s x = 0})\""], "translations": [["", "lemma not_mem_eq_mem_not: \"a \\<notin> A \\<longleftrightarrow> a \\<in> - A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (a \\<notin> A) = (a \\<in> - A)", "by auto"], ["", "lemma continuous_orderD:\n  fixes g::\"'b::t2_space \\<Rightarrow> 'c::order_topology\"\n  assumes \"continuous (at x within S) g\"\n  shows \"g x > c \\<Longrightarrow> \\<forall>\\<^sub>F y in at x within S. g y > c\"\n    \"g x < c \\<Longrightarrow> \\<forall>\\<^sub>F y in at x within S. g y < c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (c < g x \\<Longrightarrow>\n     \\<forall>\\<^sub>F y in at x within S. c < g y) &&&\n    (g x < c \\<Longrightarrow>\n     \\<forall>\\<^sub>F y in at x within S. g y < c)", "using order_tendstoD[OF assms[unfolded continuous_within]]"], ["proof (prove)\nusing this:\n  ?a < g x \\<Longrightarrow> \\<forall>\\<^sub>F x in at x within S. ?a < g x\n  g x < ?a \\<Longrightarrow> \\<forall>\\<^sub>F x in at x within S. g x < ?a\n\ngoal (1 subgoal):\n 1. (c < g x \\<Longrightarrow>\n     \\<forall>\\<^sub>F y in at x within S. c < g y) &&&\n    (g x < c \\<Longrightarrow>\n     \\<forall>\\<^sub>F y in at x within S. g y < c)", "by auto"], ["", "lemma frontier_halfspace_component_ge: \"n \\<noteq> 0 \\<Longrightarrow> frontier {x. c \\<le> x \\<bullet> n} = plane n c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<noteq> (0::'a) \\<Longrightarrow>\n    frontier {x. c \\<le> x \\<bullet> n} = plane n c", "apply (subst (1) inner_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<noteq> (0::'a) \\<Longrightarrow>\n    frontier {x. c \\<le> n \\<bullet> x} = plane n c", "apply (subst (2) inner_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<noteq> (0::'a) \\<Longrightarrow>\n    frontier {x. c \\<le> n \\<bullet> x} = {x. n \\<bullet> x = c}", "apply (subst frontier_halfspace_ge[of n c])"], ["proof (prove)\ngoal (2 subgoals):\n 1. n \\<noteq> (0::'a) \\<Longrightarrow>\n    n \\<noteq> (0::'a) \\<or> c \\<noteq> 0\n 2. n \\<noteq> (0::'a) \\<Longrightarrow>\n    {x. n \\<bullet> x = c} = {x. n \\<bullet> x = c}", "by auto"], ["", "lemma closed_Collect_le_within:\n  fixes f g :: \"'a :: topological_space \\<Rightarrow> 'b::linorder_topology\"\n  assumes f: \"continuous_on UNIV f\"\n    and g: \"continuous_on UNIV g\"\n    and \"closed R\"\n  shows \"closed {x \\<in> R. f x \\<le> g x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed {x \\<in> R. f x \\<le> g x}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. closed {x \\<in> R. f x \\<le> g x}", "have *: \"- R \\<union> {x. g x < f x} = - {x \\<in> R. f x \\<le> g x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - R \\<union> {x. g x < f x} = - {x \\<in> R. f x \\<le> g x}", "by auto"], ["proof (state)\nthis:\n  - R \\<union> {x. g x < f x} = - {x \\<in> R. f x \\<le> g x}\n\ngoal (1 subgoal):\n 1. closed {x \\<in> R. f x \\<le> g x}", "have \"open (-R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (- R)", "using assms"], ["proof (prove)\nusing this:\n  continuous_on UNIV f\n  continuous_on UNIV g\n  closed R\n\ngoal (1 subgoal):\n 1. open (- R)", "by auto"], ["proof (state)\nthis:\n  open (- R)\n\ngoal (1 subgoal):\n 1. closed {x \\<in> R. f x \\<le> g x}", "from open_Un[OF this open_Collect_less [OF g f], unfolded *]"], ["proof (chain)\npicking this:\n  open (- {x \\<in> R. f x \\<le> g x})", "show ?thesis"], ["proof (prove)\nusing this:\n  open (- {x \\<in> R. f x \\<le> g x})\n\ngoal (1 subgoal):\n 1. closed {x \\<in> R. f x \\<le> g x}", "by (simp add: closed_open)"], ["proof (state)\nthis:\n  closed {x \\<in> R. f x \\<le> g x}\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>explicit representation of hyperplanes / halfspaces\\<close>"], ["", "datatype 'a sctn = Sctn (normal: 'a) (pstn: real)"], ["", "definition \"le_halfspace sctn x \\<longleftrightarrow> x \\<bullet> normal sctn \\<le> pstn sctn\""], ["", "definition \"lt_halfspace sctn x \\<longleftrightarrow> x \\<bullet> normal sctn < pstn sctn\""], ["", "definition \"ge_halfspace sctn x \\<longleftrightarrow> x \\<bullet> normal sctn \\<ge> pstn sctn\""], ["", "definition \"gt_halfspace sctn x \\<longleftrightarrow> x \\<bullet> normal sctn > pstn sctn\""], ["", "definition \"plane_of sctn = {x. x \\<bullet> normal sctn = pstn sctn}\""], ["", "definition \"above_halfspace sctn = Collect (ge_halfspace sctn)\""], ["", "definition \"below_halfspace sctn = Collect (le_halfspace sctn)\""], ["", "definition \"sbelow_halfspace sctn = Collect (lt_halfspace sctn)\""], ["", "definition \"sabove_halfspace sctn = Collect (gt_halfspace sctn)\""], ["", "subsection \\<open>explicit H representation of polytopes (mind \\<open>Polytopes.thy\\<close>)\\<close>"], ["", "definition below_halfspaces\nwhere \"below_halfspaces sctns = \\<Inter>(below_halfspace ` sctns)\""], ["", "definition sbelow_halfspaces\nwhere \"sbelow_halfspaces sctns = \\<Inter>(sbelow_halfspace ` sctns)\""], ["", "definition above_halfspaces\nwhere \"above_halfspaces sctns = \\<Inter>(above_halfspace ` sctns)\""], ["", "definition sabove_halfspaces\nwhere \"sabove_halfspaces sctns = \\<Inter>(sabove_halfspace ` sctns)\""], ["", "lemmas halfspace_simps =\n  above_halfspace_def\n  sabove_halfspace_def\n  below_halfspace_def\n  sbelow_halfspace_def\n  below_halfspaces_def\n  sbelow_halfspaces_def\n  above_halfspaces_def\n  sabove_halfspaces_def\n  ge_halfspace_def[abs_def]\n  gt_halfspace_def[abs_def]\n  le_halfspace_def[abs_def]\n  lt_halfspace_def[abs_def]"], ["", "subsection \\<open>predicates for reachability analysis\\<close>"], ["", "context c1_on_open_euclidean\nbegin"], ["", "definition flowpipe ::\n  \"(('a::euclidean_space) \\<times> ('a \\<Rightarrow>\\<^sub>L 'a)) set \\<Rightarrow> real \\<Rightarrow> real \\<Rightarrow>\n   ('a \\<times> ('a \\<Rightarrow>\\<^sub>L 'a)) set \\<Rightarrow> ('a \\<times> ('a \\<Rightarrow>\\<^sub>L 'a)) set \\<Rightarrow> bool\"\nwhere \"flowpipe X0 hl hu CX X1 \\<longleftrightarrow> 0 \\<le> hl \\<and> hl \\<le> hu \\<and> fst ` X0 \\<subseteq> X \\<and> fst ` CX \\<subseteq> X \\<and> fst ` X1 \\<subseteq> X \\<and>\n  (\\<forall>(x0, d0) \\<in> X0. \\<forall>h \\<in> {hl .. hu}.\n    h \\<in> existence_ivl0 x0 \\<and> (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1 \\<and> (\\<forall>h' \\<in> {0 .. h}. (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX))\""], ["", "lemma flowpipeD:\n  assumes \"flowpipe X0 hl hu CX X1\"\n  shows flowpipe_safeD: \"fst ` X0 \\<union> fst ` CX \\<union> fst ` X1 \\<subseteq> X\"\n    and flowpipe_nonneg: \"0 \\<le> hl\" \"hl \\<le> hu\"\n    and flowpipe_exivl: \"hl \\<le> h \\<Longrightarrow> h \\<le> hu \\<Longrightarrow> (x0, d0) \\<in> X0 \\<Longrightarrow> h \\<in> existence_ivl0 x0\"\n    and flowpipe_discrete: \"hl \\<le> h \\<Longrightarrow> h \\<le> hu \\<Longrightarrow> (x0, d0) \\<in> X0 \\<Longrightarrow> (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1\"\n    and flowpipe_cont: \"hl \\<le> h \\<Longrightarrow> h \\<le> hu \\<Longrightarrow> (x0, d0) \\<in> X0 \\<Longrightarrow> 0 \\<le> h' \\<Longrightarrow> h' \\<le> h \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (fst ` X0 \\<union> fst ` CX \\<union> fst ` X1 \\<subseteq> X &&&\n     0 \\<le> hl &&& hl \\<le> hu) &&&\n    (\\<lbrakk>hl \\<le> h; h \\<le> hu; (x0, d0) \\<in> X0\\<rbrakk>\n     \\<Longrightarrow> h \\<in> existence_ivl0 x0) &&&\n    (\\<lbrakk>hl \\<le> h; h \\<le> hu; (x0, d0) \\<in> X0\\<rbrakk>\n     \\<Longrightarrow> (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1) &&&\n    (\\<lbrakk>hl \\<le> h; h \\<le> hu; (x0, d0) \\<in> X0; 0 \\<le> h';\n      h' \\<le> h\\<rbrakk>\n     \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX)", "using assms"], ["proof (prove)\nusing this:\n  flowpipe X0 hl hu CX X1\n\ngoal (1 subgoal):\n 1. (fst ` X0 \\<union> fst ` CX \\<union> fst ` X1 \\<subseteq> X &&&\n     0 \\<le> hl &&& hl \\<le> hu) &&&\n    (\\<lbrakk>hl \\<le> h; h \\<le> hu; (x0, d0) \\<in> X0\\<rbrakk>\n     \\<Longrightarrow> h \\<in> existence_ivl0 x0) &&&\n    (\\<lbrakk>hl \\<le> h; h \\<le> hu; (x0, d0) \\<in> X0\\<rbrakk>\n     \\<Longrightarrow> (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1) &&&\n    (\\<lbrakk>hl \\<le> h; h \\<le> hu; (x0, d0) \\<in> X0; 0 \\<le> h';\n      h' \\<le> h\\<rbrakk>\n     \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX)", "by (auto simp: flowpipe_def)"], ["", "lemma flowpipe_source_subset: \"flowpipe X0 hl hu CX X1 \\<Longrightarrow> X0 \\<subseteq> CX\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowpipe X0 hl hu CX X1 \\<Longrightarrow> X0 \\<subseteq> CX", "apply (auto dest: bspec[where x=hl] bspec[where x=0] simp: flowpipe_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X;\n        \\<forall>x\\<in>X0.\n           case x of\n           (x0, d0) \\<Rightarrow>\n             \\<forall>h\\<in>{hl..hu}.\n                h \\<in> existence_ivl0 x0 \\<and>\n                (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1 \\<and>\n                (\\<forall>h'\\<in>{0..h}.\n                    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                    \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (a, b) \\<in> CX", "apply (drule bspec)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> ?x10 a b \\<in> X0\n 2. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X;\n        case ?x10 a b of\n        (x0, d0) \\<Rightarrow>\n          \\<forall>h\\<in>{hl..hu}.\n             h \\<in> existence_ivl0 x0 \\<and>\n             (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1 \\<and>\n             (\\<forall>h'\\<in>{0..h}.\n                 (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (a, b) \\<in> CX", "apply (assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X;\n        case (a, b) of\n        (x0, d0) \\<Rightarrow>\n          \\<forall>h\\<in>{hl..hu}.\n             h \\<in> existence_ivl0 x0 \\<and>\n             (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1 \\<and>\n             (\\<forall>h'\\<in>{0..h}.\n                 (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (a, b) \\<in> CX", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X;\n        \\<forall>h\\<in>{hl..hu}.\n           h \\<in> existence_ivl0 a \\<and>\n           (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> X1 \\<and>\n           (\\<forall>h'\\<in>{0..h}.\n               (flow0 a h', Dflow a h' o\\<^sub>L b) \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (a, b) \\<in> CX", "apply (drule bspec[where x=hl])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> hl \\<in> {hl..hu}\n 2. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X;\n        hl \\<in> existence_ivl0 a \\<and>\n        (flow0 a hl, Dflow a hl o\\<^sub>L b) \\<in> X1 \\<and>\n        (\\<forall>h'\\<in>{0..hl}.\n            (flow0 a h', Dflow a h' o\\<^sub>L b) \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (a, b) \\<in> CX", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X; hl \\<in> existence_ivl0 a;\n        (flow0 a hl, Dflow a hl o\\<^sub>L b) \\<in> X1;\n        \\<forall>h'\\<in>{0..hl}.\n           (flow0 a h', Dflow a h' o\\<^sub>L b) \\<in> CX\\<rbrakk>\n       \\<Longrightarrow> (a, b) \\<in> CX", "apply (drule bspec[where x=0])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X; hl \\<in> existence_ivl0 a;\n        (flow0 a hl, Dflow a hl o\\<^sub>L b) \\<in> X1\\<rbrakk>\n       \\<Longrightarrow> 0 \\<in> {0..hl}\n 2. \\<And>a b.\n       \\<lbrakk>(a, b) \\<in> X0; 0 \\<le> hl; hl \\<le> hu;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` X1 \\<subseteq> X; hl \\<in> existence_ivl0 a;\n        (flow0 a hl, Dflow a hl o\\<^sub>L b) \\<in> X1;\n        (flow0 a 0, Dflow a 0 o\\<^sub>L b) \\<in> CX\\<rbrakk>\n       \\<Longrightarrow> (a, b) \\<in> CX", "by (auto simp: flow_initial_time_if)"], ["", "definition \"flowsto X0 T CX X1 \\<longleftrightarrow>\n  (\\<forall>(x0, d0) \\<in> X0. \\<exists>h \\<in> T. h \\<in> existence_ivl0 x0 \\<and> (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1 \\<and> (\\<forall>h' \\<in> open_segment 0 h. (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX))\""], ["", "lemma flowsto_to_empty_iff[simp]: \"flowsto a t b {} \\<longleftrightarrow> a = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto a t b {} = (a = {})", "by (auto simp: simp: flowsto_def)"], ["", "lemma flowsto_from_empty_iff[simp]: \"flowsto {} t b c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto {} t b c", "by (auto simp: simp: flowsto_def)"], ["", "lemma flowsto_empty_time_iff[simp]: \"flowsto a {} b c \\<longleftrightarrow> a = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto a {} b c = (a = {})", "by (auto simp: simp: flowsto_def)"], ["", "lemma flowstoE:\n  assumes \"flowsto X0 T CX X1\" \"(x0, d0) \\<in> X0\"\n  obtains h where \"h \\<in> T\" \"h \\<in> existence_ivl0 x0\" \"(flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1\"\n    \"\\<And>h'. h' \\<in> open_segment 0 h \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>h.\n        \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x0;\n         (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1;\n         \\<And>h'.\n            h' \\<in> {0<--<h} \\<Longrightarrow>\n            (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms"], ["proof (prove)\nusing this:\n  flowsto X0 T CX X1\n  (x0, d0) \\<in> X0\n\ngoal (1 subgoal):\n 1. (\\<And>h.\n        \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x0;\n         (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> X1;\n         \\<And>h'.\n            h' \\<in> {0<--<h} \\<Longrightarrow>\n            (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: flowsto_def)"], ["", "lemma flowsto_safeD: \"flowsto X0 T CX X1 \\<Longrightarrow> fst ` X0 \\<subseteq> X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto X0 T CX X1 \\<Longrightarrow> fst ` X0 \\<subseteq> X", "by (auto simp: flowsto_def split_beta' mem_existence_ivl_iv_defined)"], ["", "lemma flowsto_union:\n  assumes 1: \"flowsto X0 T CX Y\" and 2: \"flowsto Z S CZ W\"\n  shows \"flowsto (X0 \\<union> Z) (T \\<union> S) (CX \\<union> CZ) (Y \\<union> W)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto (X0 \\<union> Z) (T \\<union> S) (CX \\<union> CZ) (Y \\<union> W)", "using assms"], ["proof (prove)\nusing this:\n  flowsto X0 T CX Y\n  flowsto Z S CZ W\n\ngoal (1 subgoal):\n 1. flowsto (X0 \\<union> Z) (T \\<union> S) (CX \\<union> CZ) (Y \\<union> W)", "unfolding flowsto_def"], ["proof (prove)\nusing this:\n  \\<forall>(x0, d0)\\<in>X0.\n     \\<exists>h\\<in>T.\n        h \\<in> existence_ivl0 x0 \\<and>\n        (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> Y \\<and>\n        (\\<forall>h'\\<in>{0<--<h}.\n            (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX)\n  \\<forall>(x0, d0)\\<in>Z.\n     \\<exists>h\\<in>S.\n        h \\<in> existence_ivl0 x0 \\<and>\n        (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> W \\<and>\n        (\\<forall>h'\\<in>{0<--<h}.\n            (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CZ)\n\ngoal (1 subgoal):\n 1. \\<forall>(x0, d0)\\<in>X0 \\<union> Z.\n       \\<exists>h\\<in>T \\<union> S.\n          h \\<in> existence_ivl0 x0 \\<and>\n          (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> Y \\<union> W \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX \\<union> CZ)", "by force"], ["", "lemma flowsto_subset:\n  assumes \"flowsto X0 T CX Y\"\n  assumes \"Z \\<subseteq> X0\" \"T \\<subseteq> S\" \"CX \\<subseteq> CZ\" \"Y \\<subseteq> W\"\n  shows \"flowsto Z S CZ W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto Z S CZ W", "unfolding flowsto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(x0, d0)\\<in>Z.\n       \\<exists>h\\<in>S.\n          h \\<in> existence_ivl0 x0 \\<and>\n          (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> W \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CZ)", "using assms"], ["proof (prove)\nusing this:\n  flowsto X0 T CX Y\n  Z \\<subseteq> X0\n  T \\<subseteq> S\n  CX \\<subseteq> CZ\n  Y \\<subseteq> W\n\ngoal (1 subgoal):\n 1. \\<forall>(x0, d0)\\<in>Z.\n       \\<exists>h\\<in>S.\n          h \\<in> existence_ivl0 x0 \\<and>\n          (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> W \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CZ)", "by (auto elim!: flowstoE) blast"], ["", "lemmas flowsto_unionI = flowsto_subset[OF flowsto_union]"], ["", "lemma flowsto_unionE:\n  assumes \"flowsto X0 T CX (Y \\<union> Z)\"\n  obtains X1 X2 where \"X0 = X1 \\<union> X2\" \"flowsto X1 T CX Y\" \"flowsto X2 T CX Z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2; flowsto X1 T CX Y;\n         flowsto X2 T CX Z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2; flowsto X1 T CX Y;\n         flowsto X2 T CX Z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?X1 = \"{x\\<in>X0. flowsto {x} T CX Y}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2; flowsto X1 T CX Y;\n         flowsto X2 T CX Z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?X2 = \"{x\\<in>X0. flowsto {x} T CX Z}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2; flowsto X1 T CX Y;\n         flowsto X2 T CX Z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from assms"], ["proof (chain)\npicking this:\n  flowsto X0 T CX (Y \\<union> Z)", "have \"X0 = ?X1 \\<union> ?X2\" \"flowsto ?X1 T CX Y\" \"flowsto ?X2 T CX Z\""], ["proof (prove)\nusing this:\n  flowsto X0 T CX (Y \\<union> Z)\n\ngoal (1 subgoal):\n 1. X0 =\n    {x \\<in> X0. flowsto {x} T CX Y} \\<union>\n    {x \\<in> X0. flowsto {x} T CX Z} &&&\n    flowsto {x \\<in> X0. flowsto {x} T CX Y} T CX Y &&&\n    flowsto {x \\<in> X0. flowsto {x} T CX Z} T CX Z", "by (auto simp: flowsto_def)"], ["proof (state)\nthis:\n  X0 =\n  {x \\<in> X0. flowsto {x} T CX Y} \\<union> {x \\<in> X0. flowsto {x} T CX Z}\n  flowsto {x \\<in> X0. flowsto {x} T CX Y} T CX Y\n  flowsto {x \\<in> X0. flowsto {x} T CX Z} T CX Z\n\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2; flowsto X1 T CX Y;\n         flowsto X2 T CX Z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  X0 =\n  {x \\<in> X0. flowsto {x} T CX Y} \\<union> {x \\<in> X0. flowsto {x} T CX Z}\n  flowsto {x \\<in> X0. flowsto {x} T CX Y} T CX Y\n  flowsto {x \\<in> X0. flowsto {x} T CX Z} T CX Z\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma flowsto_trans:\n  assumes A: \"flowsto A S B C\" and C: \"flowsto C T D E\"\n  shows \"flowsto A {s + t |s t. s \\<in> S \\<and> t \\<in> T} (B \\<union> D \\<union> C) E\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto A {s + t |s t. s \\<in> S \\<and> t \\<in> T}\n     (B \\<union> D \\<union> C) E", "unfolding flowsto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(x0, d0)\\<in>A.\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 x0 \\<and>\n          (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n              \\<in> B \\<union> D \\<union> C)", "proof safe"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "fix x0 d0"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "assume x0: \"(x0, d0) \\<in> A\""], ["proof (state)\nthis:\n  (x0, d0) \\<in> A\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "from flowstoE[OF A x0]"], ["proof (chain)\npicking this:\n  (\\<And>h.\n      \\<lbrakk>h \\<in> S; h \\<in> existence_ivl0 x0;\n       (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> C;\n       \\<And>h'.\n          h' \\<in> {0<--<h} \\<Longrightarrow>\n          (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain h where h: \"h \\<in> S\" \"h \\<in> existence_ivl0 x0\" \"(flow0 x0 h, (Dflow x0 h) o\\<^sub>L d0) \\<in> C\"\n    \"\\<And>h'. h' \\<in> {0<--<h} \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B\""], ["proof (prove)\nusing this:\n  (\\<And>h.\n      \\<lbrakk>h \\<in> S; h \\<in> existence_ivl0 x0;\n       (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> C;\n       \\<And>h'.\n          h' \\<in> {0<--<h} \\<Longrightarrow>\n          (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>h.\n        \\<lbrakk>h \\<in> S; h \\<in> existence_ivl0 x0;\n         (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> C;\n         \\<And>h'.\n            h' \\<in> {0<--<h} \\<Longrightarrow>\n            (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  h \\<in> S\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> C\n  ?h'1 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'1, Dflow x0 ?h'1 o\\<^sub>L d0) \\<in> B\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "from h(2)"], ["proof (chain)\npicking this:\n  h \\<in> existence_ivl0 x0", "have x0[simp]: \"x0 \\<in> X\""], ["proof (prove)\nusing this:\n  h \\<in> existence_ivl0 x0\n\ngoal (1 subgoal):\n 1. x0 \\<in> X", "by auto"], ["proof (state)\nthis:\n  x0 \\<in> X\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "from flowstoE[OF C \\<open>_ \\<in> C\\<close>]"], ["proof (chain)\npicking this:\n  (\\<And>ha.\n      \\<lbrakk>ha \\<in> T; ha \\<in> existence_ivl0 (flow0 x0 h);\n       (flow0 (flow0 x0 h) ha,\n        Dflow (flow0 x0 h) ha o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n       \\<in> E;\n       \\<And>h'.\n          h' \\<in> {0<--<ha} \\<Longrightarrow>\n          (flow0 (flow0 x0 h) h',\n           Dflow (flow0 x0 h) h' o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n          \\<in> D\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain i where i: \"i \\<in> T\" \"i \\<in> existence_ivl0 (flow0 x0 h)\"\n    \"(flow0 (flow0 x0 h) i, Dflow (flow0 x0 h) i o\\<^sub>L Dflow x0 h o\\<^sub>L d0) \\<in> E\"\n    \"\\<And>h'. h' \\<in> {0<--<i} \\<Longrightarrow> (flow0 (flow0 x0 h) h', Dflow (flow0 x0 h) h' o\\<^sub>L (Dflow x0 h o\\<^sub>L d0)) \\<in> D\""], ["proof (prove)\nusing this:\n  (\\<And>ha.\n      \\<lbrakk>ha \\<in> T; ha \\<in> existence_ivl0 (flow0 x0 h);\n       (flow0 (flow0 x0 h) ha,\n        Dflow (flow0 x0 h) ha o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n       \\<in> E;\n       \\<And>h'.\n          h' \\<in> {0<--<ha} \\<Longrightarrow>\n          (flow0 (flow0 x0 h) h',\n           Dflow (flow0 x0 h) h' o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n          \\<in> D\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>i.\n        \\<lbrakk>i \\<in> T; i \\<in> existence_ivl0 (flow0 x0 h);\n         (flow0 (flow0 x0 h) i,\n          Dflow (flow0 x0 h) i o\\<^sub>L Dflow x0 h o\\<^sub>L d0)\n         \\<in> E;\n         \\<And>h'.\n            h' \\<in> {0<--<i} \\<Longrightarrow>\n            (flow0 (flow0 x0 h) h',\n             Dflow (flow0 x0 h) h' o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n            \\<in> D\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: ac_simps)"], ["proof (state)\nthis:\n  i \\<in> T\n  i \\<in> existence_ivl0 (flow0 x0 h)\n  (flow0 (flow0 x0 h) i,\n   Dflow (flow0 x0 h) i o\\<^sub>L Dflow x0 h o\\<^sub>L d0)\n  \\<in> E\n  ?h'1 \\<in> {0<--<i} \\<Longrightarrow>\n  (flow0 (flow0 x0 h) ?h'1,\n   Dflow (flow0 x0 h) ?h'1 o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n  \\<in> D\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "have hi: \"h + i \\<in> existence_ivl0 x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. h + i \\<in> existence_ivl0 x0", "using \\<open>h \\<in> existence_ivl0 x0\\<close> \\<open>i \\<in> existence_ivl0 (flow0 x0 h)\\<close> existence_ivl_trans"], ["proof (prove)\nusing this:\n  h \\<in> existence_ivl0 x0\n  i \\<in> existence_ivl0 (flow0 x0 h)\n  \\<lbrakk>?s \\<in> existence_ivl0 ?x0.0;\n   ?t \\<in> existence_ivl0 (flow0 ?x0.0 ?s)\\<rbrakk>\n  \\<Longrightarrow> ?s + ?t \\<in> existence_ivl0 ?x0.0\n\ngoal (1 subgoal):\n 1. h + i \\<in> existence_ivl0 x0", "by blast"], ["proof (state)\nthis:\n  h + i \\<in> existence_ivl0 x0\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "moreover"], ["proof (state)\nthis:\n  h + i \\<in> existence_ivl0 x0\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "have \"(flow0 x0 (h + i), Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (flow0 x0 (h + i), Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E", "apply (subst flow_trans)"], ["proof (prove)\ngoal (3 subgoals):\n 1. h \\<in> existence_ivl0 x0\n 2. i \\<in> existence_ivl0 (flow0 x0 h)\n 3. (flow0 (flow0 x0 h) i, Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E", "apply fact"], ["proof (prove)\ngoal (2 subgoals):\n 1. i \\<in> existence_ivl0 (flow0 x0 h)\n 2. (flow0 (flow0 x0 h) i, Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E", "apply fact"], ["proof (prove)\ngoal (1 subgoal):\n 1. (flow0 (flow0 x0 h) i, Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E", "apply (subst Dflow_trans)"], ["proof (prove)\ngoal (3 subgoals):\n 1. h \\<in> existence_ivl0 x0\n 2. i \\<in> existence_ivl0 (flow0 x0 h)\n 3. (flow0 (flow0 x0 h) i,\n     Dflow (flow0 x0 h) i o\\<^sub>L Dflow x0 h o\\<^sub>L d0)\n    \\<in> E", "apply fact"], ["proof (prove)\ngoal (2 subgoals):\n 1. i \\<in> existence_ivl0 (flow0 x0 h)\n 2. (flow0 (flow0 x0 h) i,\n     Dflow (flow0 x0 h) i o\\<^sub>L Dflow x0 h o\\<^sub>L d0)\n    \\<in> E", "apply fact"], ["proof (prove)\ngoal (1 subgoal):\n 1. (flow0 (flow0 x0 h) i,\n     Dflow (flow0 x0 h) i o\\<^sub>L Dflow x0 h o\\<^sub>L d0)\n    \\<in> E", "apply fact"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (flow0 x0 (h + i), Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "moreover"], ["proof (state)\nthis:\n  (flow0 x0 (h + i), Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "have \"(flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C\" if \"h'\\<in>{0<--<h + i}\" for h'"], ["proof (prove)\ngoal (1 subgoal):\n 1. (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C\n 2. \\<not> ?P \\<Longrightarrow>\n    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "assume \"h' \\<in> {0 <--< h}\""], ["proof (state)\nthis:\n  h' \\<in> {0<--<h}\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C\n 2. \\<not> ?P \\<Longrightarrow>\n    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "then"], ["proof (chain)\npicking this:\n  h' \\<in> {0<--<h}", "show ?thesis"], ["proof (prove)\nusing this:\n  h' \\<in> {0<--<h}\n\ngoal (1 subgoal):\n 1. (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "using h"], ["proof (prove)\nusing this:\n  h' \\<in> {0<--<h}\n  h \\<in> S\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> C\n  ?h'1 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'1, Dflow x0 ?h'1 o\\<^sub>L d0) \\<in> B\n\ngoal (1 subgoal):\n 1. (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "by simp"], ["proof (state)\nthis:\n  (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C\n\ngoal (1 subgoal):\n 1. h' \\<notin> {0<--<h} \\<Longrightarrow>\n    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. h' \\<notin> {0<--<h} \\<Longrightarrow>\n    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "assume \"h' \\<notin> {0 <--< h}\""], ["proof (state)\nthis:\n  h' \\<notin> {0<--<h}\n\ngoal (1 subgoal):\n 1. h' \\<notin> {0<--<h} \\<Longrightarrow>\n    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "with that"], ["proof (chain)\npicking this:\n  h' \\<in> {0<--<h + i}\n  h' \\<notin> {0<--<h}", "have h': \"h' - h \\<in> {0 <--< i}\" if \"h' \\<noteq> h\""], ["proof (prove)\nusing this:\n  h' \\<in> {0<--<h + i}\n  h' \\<notin> {0<--<h}\n\ngoal (1 subgoal):\n 1. h' - h \\<in> {0<--<i}", "using that"], ["proof (prove)\nusing this:\n  h' \\<in> {0<--<h + i}\n  h' \\<notin> {0<--<h}\n  h' \\<noteq> h\n\ngoal (1 subgoal):\n 1. h' - h \\<in> {0<--<i}", "by (auto simp: open_segment_eq_real_ivl closed_segment_eq_real_ivl split: if_splits)"], ["proof (state)\nthis:\n  h' \\<noteq> h \\<Longrightarrow> h' - h \\<in> {0<--<i}\n\ngoal (1 subgoal):\n 1. h' \\<notin> {0<--<h} \\<Longrightarrow>\n    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "from i(4)[OF this]"], ["proof (chain)\npicking this:\n  h' \\<noteq> h \\<Longrightarrow>\n  (flow0 (flow0 x0 h) (h' - h),\n   Dflow (flow0 x0 h) (h' - h) o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n  \\<in> D", "show ?thesis"], ["proof (prove)\nusing this:\n  h' \\<noteq> h \\<Longrightarrow>\n  (flow0 (flow0 x0 h) (h' - h),\n   Dflow (flow0 x0 h) (h' - h) o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n  \\<in> D\n\ngoal (1 subgoal):\n 1. (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "apply (cases \"h' = h\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>h' \\<noteq> h \\<Longrightarrow>\n             (flow0 (flow0 x0 h) (h' - h),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' = h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                      \\<in> B \\<union> D \\<union> C\n 2. \\<lbrakk>h' \\<noteq> h \\<Longrightarrow>\n             (flow0 (flow0 x0 h) (h' - h),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                      \\<in> B \\<union> D \\<union> C", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h' \\<noteq> h \\<Longrightarrow>\n             (flow0 (flow0 x0 h) (h' - h),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' = h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                      \\<in> B \\<union> D \\<union> C", "using h"], ["proof (prove)\nusing this:\n  h \\<in> S\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> C\n  ?h'1 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'1, Dflow x0 ?h'1 o\\<^sub>L d0) \\<in> B\n\ngoal (1 subgoal):\n 1. \\<lbrakk>h' \\<noteq> h \\<Longrightarrow>\n             (flow0 (flow0 x0 h) (h' - h),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' = h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                      \\<in> B \\<union> D \\<union> C", "by force"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h' \\<noteq> h \\<Longrightarrow>\n             (flow0 (flow0 x0 h) (h' - h),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                      \\<in> B \\<union> D \\<union> C", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h' \\<noteq> h \\<Longrightarrow>\n             (flow0 (flow0 x0 h) (h' - h),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                      \\<in> B \\<union> D \\<union> C", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(flow0 (flow0 x0 h) (h' - h),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> D \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> C", "apply (subst (asm) flow_trans[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. h' \\<noteq> h \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 2. h' \\<noteq> h \\<Longrightarrow> h' - h \\<in> existence_ivl0 (flow0 x0 h)\n 3. \\<lbrakk>(flow0 x0 (h + (h' - h)),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> D \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> C", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. h' \\<noteq> h \\<Longrightarrow> h \\<in> existence_ivl0 x0", "by (rule h)"], ["proof (prove)\ngoal (2 subgoals):\n 1. h' \\<noteq> h \\<Longrightarrow> h' - h \\<in> existence_ivl0 (flow0 x0 h)\n 2. \\<lbrakk>(flow0 x0 (h + (h' - h)),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> D \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> C", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. h' \\<noteq> h \\<Longrightarrow> h' - h \\<in> existence_ivl0 (flow0 x0 h)", "using \\<open>_ \\<Longrightarrow> h' - h \\<in> {0<--<i}\\<close> i(2) local.in_existence_between_zeroI"], ["proof (prove)\nusing this:\n  h' \\<noteq> h \\<Longrightarrow> h' - h \\<in> {0<--<i}\n  i \\<in> existence_ivl0 (flow0 x0 h)\n  \\<lbrakk>?t \\<in> existence_ivl0 ?x0.0; ?s \\<in> {0--?t}\\<rbrakk>\n  \\<Longrightarrow> ?s \\<in> existence_ivl0 ?x0.0\n\ngoal (1 subgoal):\n 1. h' \\<noteq> h \\<Longrightarrow> h' - h \\<in> existence_ivl0 (flow0 x0 h)", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h' \\<noteq> h; h' - h \\<in> {0<--<i};\n     i \\<in> existence_ivl0 (flow0 x0 h);\n     \\<And>t x0 s.\n        \\<lbrakk>t \\<in> existence_ivl0 x0; s \\<in> {0--t}\\<rbrakk>\n        \\<Longrightarrow> s \\<in> existence_ivl0 x0\\<rbrakk>\n    \\<Longrightarrow> h' - h \\<in> existence_ivl0 (flow0 x0 h)", "using open_closed_segment"], ["proof (prove)\nusing this:\n  ?u \\<in> {?w<--<?z} \\<Longrightarrow> ?u \\<in> {?w--?z}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>h' \\<noteq> h; h' - h \\<in> {0<--<i};\n     i \\<in> existence_ivl0 (flow0 x0 h);\n     \\<And>t x0 s.\n        \\<lbrakk>t \\<in> existence_ivl0 x0; s \\<in> {0--t}\\<rbrakk>\n        \\<Longrightarrow> s \\<in> existence_ivl0 x0\\<rbrakk>\n    \\<Longrightarrow> h' - h \\<in> existence_ivl0 (flow0 x0 h)", "by blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(flow0 x0 (h + (h' - h)),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> D \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> C", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(flow0 x0 (h + (h' - h)),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L\n              (Dflow x0 h o\\<^sub>L d0))\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> D \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> C", "unfolding blinfun_compose_assoc[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(flow0 x0 (h + (h' - h)),\n              Dflow (flow0 x0 h) (h' - h) o\\<^sub>L Dflow x0 h o\\<^sub>L d0)\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> D \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> C", "apply (subst (asm) Dflow_trans[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. h' \\<noteq> h \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 2. h' \\<noteq> h \\<Longrightarrow> h' - h \\<in> existence_ivl0 (flow0 x0 h)\n 3. \\<lbrakk>(flow0 x0 (h + (h' - h)), Dflow x0 (h + (h' - h)) o\\<^sub>L d0)\n             \\<in> D;\n     h' \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> D \\<or>\n                      (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> C", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. h' \\<noteq> h \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 2. h' \\<noteq> h \\<Longrightarrow> h' - h \\<in> existence_ivl0 (flow0 x0 h)", "apply fact+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?h'1 \\<in> {0<--<h + i} \\<Longrightarrow>\n  (flow0 x0 ?h'1, Dflow x0 ?h'1 o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> A \\<Longrightarrow>\n       \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n          h \\<in> existence_ivl0 a \\<and>\n          (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> E \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 a h', Dflow a h' o\\<^sub>L b)\n              \\<in> B \\<union> D \\<union> C)", "ultimately"], ["proof (chain)\npicking this:\n  h + i \\<in> existence_ivl0 x0\n  (flow0 x0 (h + i), Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E\n  ?h'1 \\<in> {0<--<h + i} \\<Longrightarrow>\n  (flow0 x0 ?h'1, Dflow x0 ?h'1 o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C", "show \"\\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n      h \\<in> existence_ivl0 x0 \\<and> (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> E \\<and> (\\<forall>h'\\<in>{0<--<h}. (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C)\""], ["proof (prove)\nusing this:\n  h + i \\<in> existence_ivl0 x0\n  (flow0 x0 (h + i), Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E\n  ?h'1 \\<in> {0<--<h + i} \\<Longrightarrow>\n  (flow0 x0 ?h'1, Dflow x0 ?h'1 o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C\n\ngoal (1 subgoal):\n 1. \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n       h \\<in> existence_ivl0 x0 \\<and>\n       (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> E \\<and>\n       (\\<forall>h'\\<in>{0<--<h}.\n           (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n           \\<in> B \\<union> D \\<union> C)", "using \\<open>h \\<in> S\\<close> \\<open>i \\<in> T\\<close>"], ["proof (prove)\nusing this:\n  h + i \\<in> existence_ivl0 x0\n  (flow0 x0 (h + i), Dflow x0 (h + i) o\\<^sub>L d0) \\<in> E\n  ?h'1 \\<in> {0<--<h + i} \\<Longrightarrow>\n  (flow0 x0 ?h'1, Dflow x0 ?h'1 o\\<^sub>L d0) \\<in> B \\<union> D \\<union> C\n  h \\<in> S\n  i \\<in> T\n\ngoal (1 subgoal):\n 1. \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n       h \\<in> existence_ivl0 x0 \\<and>\n       (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> E \\<and>\n       (\\<forall>h'\\<in>{0<--<h}.\n           (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n           \\<in> B \\<union> D \\<union> C)", "by (auto intro!: bexI[where x=\"h + i\"])"], ["proof (state)\nthis:\n  \\<exists>h\\<in>{s + t |s t. s \\<in> S \\<and> t \\<in> T}.\n     h \\<in> existence_ivl0 x0 \\<and>\n     (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> E \\<and>\n     (\\<forall>h'\\<in>{0<--<h}.\n         (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n         \\<in> B \\<union> D \\<union> C)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma flowsto_step:\n  assumes A: \"flowsto A S B C\"\n  assumes D: \"flowsto D T E F\"\n  shows \"flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T}) (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T})\n     (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T})\n     (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)", "have \"C = (C \\<inter> D) \\<union> (C - D)\" (is \"_ = ?C1 \\<union> ?C2\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. C = C \\<inter> D \\<union> (C - D)", "by auto"], ["proof (state)\nthis:\n  C = C \\<inter> D \\<union> (C - D)\n\ngoal (1 subgoal):\n 1. flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T})\n     (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)", "then"], ["proof (chain)\npicking this:\n  C = C \\<inter> D \\<union> (C - D)", "have \"flowsto A S B (?C1 \\<union> ?C2)\""], ["proof (prove)\nusing this:\n  C = C \\<inter> D \\<union> (C - D)\n\ngoal (1 subgoal):\n 1. flowsto A S B (C \\<inter> D \\<union> (C - D))", "using A"], ["proof (prove)\nusing this:\n  C = C \\<inter> D \\<union> (C - D)\n  flowsto A S B C\n\ngoal (1 subgoal):\n 1. flowsto A S B (C \\<inter> D \\<union> (C - D))", "by simp"], ["proof (state)\nthis:\n  flowsto A S B (C \\<inter> D \\<union> (C - D))\n\ngoal (1 subgoal):\n 1. flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T})\n     (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)", "from flowsto_unionE[OF this]"], ["proof (chain)\npicking this:\n  (\\<And>X1 X2.\n      \\<lbrakk>A = X1 \\<union> X2; flowsto X1 S B (C \\<inter> D);\n       flowsto X2 S B (C - D)\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain A1 A2 where \"A = A1 \\<union> A2\" and A1: \"flowsto A1 S B ?C1\" and A2: \"flowsto A2 S B ?C2\""], ["proof (prove)\nusing this:\n  (\\<And>X1 X2.\n      \\<lbrakk>A = X1 \\<union> X2; flowsto X1 S B (C \\<inter> D);\n       flowsto X2 S B (C - D)\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>A1 A2.\n        \\<lbrakk>A = A1 \\<union> A2; flowsto A1 S B (C \\<inter> D);\n         flowsto A2 S B (C - D)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  A = A1 \\<union> A2\n  flowsto A1 S B (C \\<inter> D)\n  flowsto A2 S B (C - D)\n\ngoal (1 subgoal):\n 1. flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T})\n     (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)", "have \"flowsto ?C1 T E F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto (C \\<inter> D) T E F", "using D"], ["proof (prove)\nusing this:\n  flowsto D T E F\n\ngoal (1 subgoal):\n 1. flowsto (C \\<inter> D) T E F", "by (rule flowsto_subset) auto"], ["proof (state)\nthis:\n  flowsto (C \\<inter> D) T E F\n\ngoal (1 subgoal):\n 1. flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T})\n     (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)", "from flowsto_union[OF flowsto_trans[OF A1 this] A2]"], ["proof (chain)\npicking this:\n  flowsto (A1 \\<union> A2)\n   ({s + t |s t. s \\<in> S \\<and> t \\<in> T} \\<union> S)\n   (B \\<union> E \\<union> C \\<inter> D \\<union> B) (F \\<union> (C - D))", "show ?thesis"], ["proof (prove)\nusing this:\n  flowsto (A1 \\<union> A2)\n   ({s + t |s t. s \\<in> S \\<and> t \\<in> T} \\<union> S)\n   (B \\<union> E \\<union> C \\<inter> D \\<union> B) (F \\<union> (C - D))\n\ngoal (1 subgoal):\n 1. flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T})\n     (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)", "by (auto simp add: \\<open>A = _\\<close> ac_simps)"], ["proof (state)\nthis:\n  flowsto A (S \\<union> {s + t |s t. s \\<in> S \\<and> t \\<in> T})\n   (B \\<union> E \\<union> C \\<inter> D) (C - D \\<union> F)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma\n  flowsto_stepI:\n    \"flowsto X0 U B C \\<Longrightarrow>\n    flowsto D T E F \\<Longrightarrow>\n    Z \\<subseteq> X0 \\<Longrightarrow>\n    (\\<And>s. s \\<in> U \\<Longrightarrow> s \\<in> S) \\<Longrightarrow>\n    (\\<And>s t. s \\<in> U \\<Longrightarrow> t \\<in> T \\<Longrightarrow> s + t \\<in> S) \\<Longrightarrow>\n    B \\<union> E \\<union> D \\<inter> C \\<subseteq> CZ \\<Longrightarrow> C - D \\<union> F \\<subseteq> W \\<Longrightarrow> flowsto Z S CZ W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>flowsto X0 U B C; flowsto D T E F; Z \\<subseteq> X0;\n     \\<And>s. s \\<in> U \\<Longrightarrow> s \\<in> S;\n     \\<And>s t.\n        \\<lbrakk>s \\<in> U; t \\<in> T\\<rbrakk>\n        \\<Longrightarrow> s + t \\<in> S;\n     B \\<union> E \\<union> D \\<inter> C \\<subseteq> CZ;\n     C - D \\<union> F \\<subseteq> W\\<rbrakk>\n    \\<Longrightarrow> flowsto Z S CZ W", "by (rule flowsto_subset[OF flowsto_step]) auto"], ["", "lemma flowsto_imp_flowsto:\n  \"flowpipe Y h h CY Z \\<Longrightarrow> flowsto Y {h} (CY) Z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowpipe Y h h CY Z \\<Longrightarrow> flowsto Y {h} CY Z", "unfolding flowpipe_def flowsto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> h \\<and>\n    h \\<le> h \\<and>\n    fst ` Y \\<subseteq> X \\<and>\n    fst ` CY \\<subseteq> X \\<and>\n    fst ` Z \\<subseteq> X \\<and>\n    (\\<forall>(x0, d0)\\<in>Y.\n        \\<forall>h\\<in>{h..h}.\n           h \\<in> existence_ivl0 x0 \\<and>\n           (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> Z \\<and>\n           (\\<forall>h'\\<in>{0..h}.\n               (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n               \\<in> CY)) \\<Longrightarrow>\n    \\<forall>(x0, d0)\\<in>Y.\n       \\<exists>h\\<in>{h}.\n          h \\<in> existence_ivl0 x0 \\<and>\n          (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> Z \\<and>\n          (\\<forall>h'\\<in>{0<--<h}.\n              (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CY)", "by (auto simp: open_segment_eq_real_ivl split_beta')"], ["", "lemma connected_below_halfspace:\n  assumes \"x \\<in> below_halfspace sctn\"\n  assumes \"x \\<in> S\" \"connected S\"\n  assumes \"S \\<inter> plane_of sctn = {}\"\n  shows \"S \\<subseteq> below_halfspace sctn\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "note \\<open>connected S\\<close>"], ["proof (state)\nthis:\n  connected S\n\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "moreover"], ["proof (state)\nthis:\n  connected S\n\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "have \"open {x. x \\<bullet> normal sctn < pstn sctn}\" (is \"open ?X\")\n    and \"open {x. x \\<bullet> normal sctn > pstn sctn}\" (is \"open ?Y\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. open {x. x \\<bullet> normal sctn < pstn sctn} &&&\n    open {x. pstn sctn < x \\<bullet> normal sctn}", "by (auto intro!: open_Collect_less continuous_intros)"], ["proof (state)\nthis:\n  open {x. x \\<bullet> normal sctn < pstn sctn}\n  open {x. pstn sctn < x \\<bullet> normal sctn}\n\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "moreover"], ["proof (state)\nthis:\n  open {x. x \\<bullet> normal sctn < pstn sctn}\n  open {x. pstn sctn < x \\<bullet> normal sctn}\n\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "have \"?X \\<inter> ?Y \\<inter> S = {}\" \"S \\<subseteq> ?X \\<union> ?Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. x \\<bullet> normal sctn < pstn sctn} \\<inter>\n    {x. pstn sctn < x \\<bullet> normal sctn} \\<inter>\n    S =\n    {} &&&\n    S \\<subseteq> {x. x \\<bullet> normal sctn < pstn sctn} \\<union>\n                  {x. pstn sctn < x \\<bullet> normal sctn}", "using assms"], ["proof (prove)\nusing this:\n  x \\<in> below_halfspace sctn\n  x \\<in> S\n  connected S\n  S \\<inter> plane_of sctn = {}\n\ngoal (1 subgoal):\n 1. {x. x \\<bullet> normal sctn < pstn sctn} \\<inter>\n    {x. pstn sctn < x \\<bullet> normal sctn} \\<inter>\n    S =\n    {} &&&\n    S \\<subseteq> {x. x \\<bullet> normal sctn < pstn sctn} \\<union>\n                  {x. pstn sctn < x \\<bullet> normal sctn}", "by (auto simp: plane_of_def)"], ["proof (state)\nthis:\n  {x. x \\<bullet> normal sctn < pstn sctn} \\<inter>\n  {x. pstn sctn < x \\<bullet> normal sctn} \\<inter>\n  S =\n  {}\n  S \\<subseteq> {x. x \\<bullet> normal sctn < pstn sctn} \\<union>\n                {x. pstn sctn < x \\<bullet> normal sctn}\n\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "ultimately"], ["proof (chain)\npicking this:\n  connected S\n  open {x. x \\<bullet> normal sctn < pstn sctn}\n  open {x. pstn sctn < x \\<bullet> normal sctn}\n  {x. x \\<bullet> normal sctn < pstn sctn} \\<inter>\n  {x. pstn sctn < x \\<bullet> normal sctn} \\<inter>\n  S =\n  {}\n  S \\<subseteq> {x. x \\<bullet> normal sctn < pstn sctn} \\<union>\n                {x. pstn sctn < x \\<bullet> normal sctn}", "have \"?X \\<inter> S = {} \\<or> ?Y \\<inter> S = {}\""], ["proof (prove)\nusing this:\n  connected S\n  open {x. x \\<bullet> normal sctn < pstn sctn}\n  open {x. pstn sctn < x \\<bullet> normal sctn}\n  {x. x \\<bullet> normal sctn < pstn sctn} \\<inter>\n  {x. pstn sctn < x \\<bullet> normal sctn} \\<inter>\n  S =\n  {}\n  S \\<subseteq> {x. x \\<bullet> normal sctn < pstn sctn} \\<union>\n                {x. pstn sctn < x \\<bullet> normal sctn}\n\ngoal (1 subgoal):\n 1. {x. x \\<bullet> normal sctn < pstn sctn} \\<inter> S = {} \\<or>\n    {x. pstn sctn < x \\<bullet> normal sctn} \\<inter> S = {}", "by (rule connectedD)"], ["proof (state)\nthis:\n  {x. x \\<bullet> normal sctn < pstn sctn} \\<inter> S = {} \\<or>\n  {x. pstn sctn < x \\<bullet> normal sctn} \\<inter> S = {}\n\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "then"], ["proof (chain)\npicking this:\n  {x. x \\<bullet> normal sctn < pstn sctn} \\<inter> S = {} \\<or>\n  {x. pstn sctn < x \\<bullet> normal sctn} \\<inter> S = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  {x. x \\<bullet> normal sctn < pstn sctn} \\<inter> S = {} \\<or>\n  {x. pstn sctn < x \\<bullet> normal sctn} \\<inter> S = {}\n\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "using assms"], ["proof (prove)\nusing this:\n  {x. x \\<bullet> normal sctn < pstn sctn} \\<inter> S = {} \\<or>\n  {x. pstn sctn < x \\<bullet> normal sctn} \\<inter> S = {}\n  x \\<in> below_halfspace sctn\n  x \\<in> S\n  connected S\n  S \\<inter> plane_of sctn = {}\n\ngoal (1 subgoal):\n 1. S \\<subseteq> below_halfspace sctn", "by (force simp: below_halfspace_def le_halfspace_def plane_of_def)"], ["proof (state)\nthis:\n  S \\<subseteq> below_halfspace sctn\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma\n  inter_Collect_eq_empty:\n  assumes \"\\<And>x. x \\<in> X0 \\<Longrightarrow> \\<not> g x\" shows \"X0 \\<inter> Collect g = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X0 \\<inter> Collect g = {}", "using assms"], ["proof (prove)\nusing this:\n  ?x1 \\<in> X0 \\<Longrightarrow> \\<not> g ?x1\n\ngoal (1 subgoal):\n 1. X0 \\<inter> Collect g = {}", "by auto"], ["", "subsection \\<open>Poincare Map\\<close>"], ["", "lemma closed_plane_of[simp]: \"closed (plane_of sctn)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed (plane_of sctn)", "by (auto simp: plane_of_def intro!: closed_Collect_eq continuous_intros)"], ["", "definition \"poincare_mapsto P X0 S CX Y \\<longleftrightarrow> (\\<forall>(x, d) \\<in> X0.\n  returns_to P x \\<and> fst ` X0 \\<subseteq> S \\<and>\n  (return_time P differentiable at x within S) \\<and>\n  (\\<exists>D. (poincare_map P has_derivative blinfun_apply D) (at x within S) \\<and>\n       (poincare_map P x, D o\\<^sub>L d) \\<in> Y) \\<and>\n  (\\<forall>t\\<in>{0<..<return_time P x}. flow0 x t \\<in> CX))\""], ["", "lemma poincare_mapsto_empty[simp]:\n  \"poincare_mapsto P {} S CX Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. poincare_mapsto P {} S CX Y", "by (auto simp: poincare_mapsto_def)"], ["", "lemma flowsto_eventually_mem_cont:\n  assumes \"flowsto X0 T CX Y\" \"(x, d) \\<in> X0\" \"T \\<subseteq> {0<..}\"\n  shows \"\\<forall>\\<^sub>F t in at_right 0. (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX", "from flowstoE[OF assms(1,2)] assms(3)"], ["proof (chain)\npicking this:\n  (\\<And>h.\n      \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x;\n       (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y;\n       \\<And>h'.\n          h' \\<in> {0<--<h} \\<Longrightarrow>\n          (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n  T \\<subseteq> {0<..}", "obtain h where h: \"0 < h\" \"h \\<in> T\" \"h \\<in> existence_ivl0 x\" \"(flow0 x h, (Dflow x h) o\\<^sub>L d) \\<in> Y\" \"\\<And>h'. h' \\<in> {0<--<h} \\<Longrightarrow> (flow0 x h', (Dflow x h') o\\<^sub>L d) \\<in> CX\""], ["proof (prove)\nusing this:\n  (\\<And>h.\n      \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x;\n       (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y;\n       \\<And>h'.\n          h' \\<in> {0<--<h} \\<Longrightarrow>\n          (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n  T \\<subseteq> {0<..}\n\ngoal (1 subgoal):\n 1. (\\<And>h.\n        \\<lbrakk>0 < h; h \\<in> T; h \\<in> existence_ivl0 x;\n         (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y;\n         \\<And>h'.\n            h' \\<in> {0<--<h} \\<Longrightarrow>\n            (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: subset_iff)"], ["proof (state)\nthis:\n  0 < h\n  h \\<in> T\n  h \\<in> existence_ivl0 x\n  (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x ?h'2, Dflow x ?h'2 o\\<^sub>L d) \\<in> CX\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX", "have \"\\<forall>\\<^sub>F x in at_right 0. 0 < x \\<and> x < h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0. 0 < x \\<and> x < h", "apply (rule eventually_conj[OF eventually_at_right_less])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0. x < h", "using eventually_at_right h(1)"], ["proof (prove)\nusing this:\n  ?x < ?y \\<Longrightarrow>\n  eventually ?P (at_right ?x) =\n  (\\<exists>b>?x. \\<forall>y>?x. y < b \\<longrightarrow> ?P y)\n  0 < h\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_right 0. x < h", "by blast"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at_right 0. 0 < x \\<and> x < h\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at_right 0. 0 < x \\<and> x < h", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at_right 0. 0 < x \\<and> x < h\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX", "by eventually_elim (auto intro!: h simp: open_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0.\n     (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma frontier_aux_lemma:\n  fixes R :: \"'n::euclidean_space set\"\n  assumes \"closed R\" \"R \\<subseteq> {x. x \\<bullet> n = c}\" and [simp]: \"n \\<noteq> 0\"\n  shows \"frontier {x \\<in> R. c \\<le> x \\<bullet> n} = {x \\<in> R. c = x \\<bullet> n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. frontier {x \\<in> R. c \\<le> x \\<bullet> n} =\n    {x \\<in> R. c = x \\<bullet> n}", "apply (auto simp: frontier_closures)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> closure {x \\<in> R. c \\<le> x \\<bullet> n};\n        x \\<in> closure (- {x \\<in> R. c \\<le> x \\<bullet> n})\\<rbrakk>\n       \\<Longrightarrow> x \\<in> R\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> closure {x \\<in> R. c \\<le> x \\<bullet> n};\n        x \\<in> closure (- {x \\<in> R. c \\<le> x \\<bullet> n})\\<rbrakk>\n       \\<Longrightarrow> c = x \\<bullet> n\n 3. \\<And>x.\n       \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> closure\n                                  {xa \\<in> R.\n                                   x \\<bullet> n \\<le> xa \\<bullet> n}\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> closure\n                                  (- {xa \\<in> R.\nx \\<bullet> n \\<le> xa \\<bullet> n})", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x_ \\<in> closure {x \\<in> R. c \\<le> x \\<bullet> n};\n     x_ \\<in> closure (- {x \\<in> R. c \\<le> x \\<bullet> n})\\<rbrakk>\n    \\<Longrightarrow> x_ \\<in> R", "by (metis (full_types) Collect_subset assms(1) closure_minimal subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> closure {x \\<in> R. c \\<le> x \\<bullet> n};\n        x \\<in> closure (- {x \\<in> R. c \\<le> x \\<bullet> n})\\<rbrakk>\n       \\<Longrightarrow> c = x \\<bullet> n\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> closure\n                                  {xa \\<in> R.\n                                   x \\<bullet> n \\<le> xa \\<bullet> n}\n 3. \\<And>x.\n       \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> closure\n                                  (- {xa \\<in> R.\nx \\<bullet> n \\<le> xa \\<bullet> n})", "subgoal premises prems for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. c = x \\<bullet> n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. c = x \\<bullet> n", "note prems"], ["proof (state)\nthis:\n  x \\<in> closure {x \\<in> R. c \\<le> x \\<bullet> n}\n  x \\<in> closure (- {x \\<in> R. c \\<le> x \\<bullet> n})\n\ngoal (1 subgoal):\n 1. c = x \\<bullet> n", "have \"closed {x \\<in> R. c \\<le> x \\<bullet> n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed {x \\<in> R. c \\<le> x \\<bullet> n}", "by (auto intro!: closed_Collect_le_within continuous_intros assms)"], ["proof (state)\nthis:\n  closed {x \\<in> R. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. c = x \\<bullet> n", "from closure_closed[OF this] prems(1)"], ["proof (chain)\npicking this:\n  closure {x \\<in> R. c \\<le> x \\<bullet> n} =\n  {x \\<in> R. c \\<le> x \\<bullet> n}\n  x \\<in> closure {x \\<in> R. c \\<le> x \\<bullet> n}", "have \"x \\<in> R\" \"c \\<le> x \\<bullet> n\""], ["proof (prove)\nusing this:\n  closure {x \\<in> R. c \\<le> x \\<bullet> n} =\n  {x \\<in> R. c \\<le> x \\<bullet> n}\n  x \\<in> closure {x \\<in> R. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. x \\<in> R &&& c \\<le> x \\<bullet> n", "by auto"], ["proof (state)\nthis:\n  x \\<in> R\n  c \\<le> x \\<bullet> n\n\ngoal (1 subgoal):\n 1. c = x \\<bullet> n", "with assms"], ["proof (chain)\npicking this:\n  closed R\n  R \\<subseteq> plane n c\n  n \\<noteq> (0::'n)\n  x \\<in> R\n  c \\<le> x \\<bullet> n", "show ?thesis"], ["proof (prove)\nusing this:\n  closed R\n  R \\<subseteq> plane n c\n  n \\<noteq> (0::'n)\n  x \\<in> R\n  c \\<le> x \\<bullet> n\n\ngoal (1 subgoal):\n 1. c = x \\<bullet> n", "by auto"], ["proof (state)\nthis:\n  c = x \\<bullet> n\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> closure\n                                  {xa \\<in> R.\n                                   x \\<bullet> n \\<le> xa \\<bullet> n}\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> closure\n                                  (- {xa \\<in> R.\nx \\<bullet> n \\<le> xa \\<bullet> n})", "subgoal for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n    \\<Longrightarrow> x \\<in> closure\n                               {xa \\<in> R.\n                                x \\<bullet> n \\<le> xa \\<bullet> n}", "using closure_subset"], ["proof (prove)\nusing this:\n  ?S \\<subseteq> closure ?S\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n    \\<Longrightarrow> x \\<in> closure\n                               {xa \\<in> R.\n                                x \\<bullet> n \\<le> xa \\<bullet> n}", "by fastforce"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> R; c = x \\<bullet> n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> closure\n                                  (- {xa \\<in> R.\nx \\<bullet> n \\<le> xa \\<bullet> n})", "subgoal premises prems for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "note prems"], ["proof (state)\nthis:\n  x \\<in> R\n  c = x \\<bullet> n\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "have *: \"{xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n} = R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n} = R", "using assms prems"], ["proof (prove)\nusing this:\n  closed R\n  R \\<subseteq> plane n c\n  n \\<noteq> (0::'n)\n  x \\<in> R\n  c = x \\<bullet> n\n\ngoal (1 subgoal):\n 1. {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n} = R", "by auto"], ["proof (state)\nthis:\n  {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n} = R\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "have \"interior R \\<subseteq> interior (plane n c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. interior R \\<subseteq> interior (plane n c)", "by (rule interior_mono) (use assms in auto)"], ["proof (state)\nthis:\n  interior R \\<subseteq> interior (plane n c)\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "also"], ["proof (state)\nthis:\n  interior R \\<subseteq> interior (plane n c)\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "have \"\\<dots> = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. interior (plane n c) = {}", "by (subst inner_commute) simp"], ["proof (state)\nthis:\n  interior (plane n c) = {}\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "finally"], ["proof (chain)\npicking this:\n  interior R \\<subseteq> {}", "have R: \"interior R = {}\""], ["proof (prove)\nusing this:\n  interior R \\<subseteq> {}\n\ngoal (1 subgoal):\n 1. interior R = {}", "by simp"], ["proof (state)\nthis:\n  interior R = {}\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "have \"x \\<in> closure (- R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> closure (- R)", "unfolding closure_complement"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> - interior R", "by (auto simp: R)"], ["proof (state)\nthis:\n  x \\<in> closure (- R)\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "then"], ["proof (chain)\npicking this:\n  x \\<in> closure (- R)", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<in> closure (- R)\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})", "unfolding *"], ["proof (prove)\nusing this:\n  x \\<in> closure (- R)\n\ngoal (1 subgoal):\n 1. x \\<in> closure (- R)", "by simp"], ["proof (state)\nthis:\n  x \\<in> closure (- {xa \\<in> R. x \\<bullet> n \\<le> xa \\<bullet> n})\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma blinfun_minus_comp_distrib: \"(a - b) o\\<^sub>L c = (a o\\<^sub>L c) - (b o\\<^sub>L c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a - b o\\<^sub>L c = (a o\\<^sub>L c) - (b o\\<^sub>L c)", "by (auto intro!: blinfun_eqI simp: blinfun.bilinear_simps)"], ["", "lemma flowpipe_split_at_above_halfspace:\n  assumes \"flowpipe X0 hl t CX Y\" \"fst ` X0 \\<inter> {x. x \\<bullet> n \\<ge> c} = {}\" and [simp]: \"n \\<noteq> 0\"\n  assumes cR: \"closed R\" and Rs: \"R \\<subseteq> plane n c\"\n  assumes PDP: \"\\<And>x d. (x, d) \\<in> CX \\<Longrightarrow> x \\<bullet> n = c \\<Longrightarrow> (x,\n     d - (blinfun_scaleR_left (f (x)) o\\<^sub>L (blinfun_scaleR_left (inverse (f x \\<bullet> n)) o\\<^sub>L (blinfun_inner_left n o\\<^sub>L d)))) \\<in> PDP\"\n  assumes PDP_nz: \"\\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0\"\n  assumes PDP_inR: \"\\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R\"\n  assumes PDP_in: \"\\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> \\<forall>\\<^sub>F x in at x within plane n c. x \\<in> R\"\n  obtains X1 X2 where \"X0 = X1 \\<union> X2\"\n    \"flowsto X1 {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV) (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)\"\n    \"flowsto X2 {hl .. t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV) (Y \\<inter> ({x. x \\<bullet> n < c} \\<times> UNIV))\"\n    \"poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?sB = \"{x. x \\<bullet> n < c}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?A = \"{x. x \\<bullet> n \\<ge> c}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?P = \"{x \\<in> R. x \\<bullet> n = c}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have [intro]: \"closed ?A\" \"closed ?P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed {x. c \\<le> x \\<bullet> n} &&&\n    closed {x \\<in> R. x \\<bullet> n = c}", "by (auto intro!: closed_Collect_le_within closed_levelset_within continuous_intros cR\n        closed_halfspace_component_ge)"], ["proof (state)\nthis:\n  closed {x. c \\<le> x \\<bullet> n}\n  closed {x \\<in> R. x \\<bullet> n = c}\n\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?CX = \"CX \\<inter> ?sB \\<times> UNIV\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?X1 = \"{x\\<in>X0. flowsto {x} {0 <.. t} ?CX (CX \\<inter> (?P \\<times> UNIV))}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "let ?X2 = \"{x\\<in>X0. flowsto {x} {hl .. t} ?CX (Y \\<inter> (?sB \\<times> UNIV))}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"(x, d) \\<in> ?X1 \\<or> (x, d) \\<in> ?X2\" if \"(x, d) \\<in> X0\" for x d"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "from that assms"], ["proof (chain)\npicking this:\n  (x, d) \\<in> X0\n  flowpipe X0 hl t CX Y\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  n \\<noteq> (0::'a)\n  closed R\n  R \\<subseteq> plane n c\n  \\<lbrakk>(?x2, ?d2) \\<in> CX; ?x2 \\<bullet> n = c\\<rbrakk>\n  \\<Longrightarrow> (?x2,\n                     ?d2 -\n                     (blinfun_scaleR_left (f ?x2) o\\<^sub>L\n                      (blinfun_scaleR_left\n                        (inverse (f ?x2 \\<bullet> n)) o\\<^sub>L\n                       (blinfun_inner_left n o\\<^sub>L ?d2))))\n                    \\<in> PDP\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> f ?x2 \\<bullet> n \\<noteq> 0\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> ?x2 \\<in> R\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2 within plane n c. x \\<in> R", "have\n      t: \"t \\<in> existence_ivl0 x\" \"\\<And>s. 0 \\<le> s \\<Longrightarrow> s \\<le> t \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX\" \"(flow0 x t, Dflow x t o\\<^sub>L d) \\<in> Y\""], ["proof (prove)\nusing this:\n  (x, d) \\<in> X0\n  flowpipe X0 hl t CX Y\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  n \\<noteq> (0::'a)\n  closed R\n  R \\<subseteq> plane n c\n  \\<lbrakk>(?x2, ?d2) \\<in> CX; ?x2 \\<bullet> n = c\\<rbrakk>\n  \\<Longrightarrow> (?x2,\n                     ?d2 -\n                     (blinfun_scaleR_left (f ?x2) o\\<^sub>L\n                      (blinfun_scaleR_left\n                        (inverse (f ?x2 \\<bullet> n)) o\\<^sub>L\n                       (blinfun_inner_left n o\\<^sub>L ?d2))))\n                    \\<in> PDP\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> f ?x2 \\<bullet> n \\<noteq> 0\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> ?x2 \\<in> R\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2 within plane n c. x \\<in> R\n\ngoal (1 subgoal):\n 1. t \\<in> existence_ivl0 x &&&\n    (\\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX) &&&\n    (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> Y", "apply (auto simp: flowpipe_def dest!: bspec[where x=t])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       \\<lbrakk>0 \\<le> s; s \\<le> t; (x, d) \\<in> X0;\n        fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}; closed R;\n        R \\<subseteq> plane n c;\n        \\<And>x d.\n           \\<lbrakk>(x, d) \\<in> CX; x \\<bullet> n = c\\<rbrakk>\n           \\<Longrightarrow> (x, d -\n                                 (blinfun_scaleR_left (f x) o\\<^sub>L\n                                  (blinfun_scaleR_left\n                                    (inverse (f x \\<bullet> n)) o\\<^sub>L\n                                   (blinfun_inner_left n o\\<^sub>L d))))\n                             \\<in> PDP;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n        \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow>\n           \\<forall>\\<^sub>F x in at x within plane n c. x \\<in> R;\n        0 \\<le> hl; hl \\<le> t; fst ` X0 \\<subseteq> X;\n        fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n        \\<forall>x\\<in>X0.\n           case x of\n           (x0, d0) \\<Rightarrow>\n             \\<forall>h\\<in>{hl..t}.\n                h \\<in> existence_ivl0 x0 \\<and>\n                (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> Y \\<and>\n                (\\<forall>h'\\<in>{0..h}.\n                    (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                    \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX", "apply (drule bspec[where x=\"(x, d)\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       \\<lbrakk>0 \\<le> s; s \\<le> t; (x, d) \\<in> X0;\n        fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}; closed R;\n        R \\<subseteq> plane n c;\n        \\<And>x d.\n           \\<lbrakk>(x, d) \\<in> CX; x \\<bullet> n = c\\<rbrakk>\n           \\<Longrightarrow> (x, d -\n                                 (blinfun_scaleR_left (f x) o\\<^sub>L\n                                  (blinfun_scaleR_left\n                                    (inverse (f x \\<bullet> n)) o\\<^sub>L\n                                   (blinfun_inner_left n o\\<^sub>L d))))\n                             \\<in> PDP;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n        \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow>\n           \\<forall>\\<^sub>F x in at x within plane n c. x \\<in> R;\n        0 \\<le> hl; hl \\<le> t; fst ` X0 \\<subseteq> X;\n        fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n        case (x, d) of\n        (x0, d0) \\<Rightarrow>\n          \\<forall>h\\<in>{hl..t}.\n             h \\<in> existence_ivl0 x0 \\<and>\n             (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> Y \\<and>\n             (\\<forall>h'\\<in>{0..h}.\n                 (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       \\<lbrakk>0 \\<le> s; s \\<le> t; (x, d) \\<in> X0;\n        fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}; closed R;\n        R \\<subseteq> plane n c;\n        \\<And>x d.\n           \\<lbrakk>(x, d) \\<in> CX; x \\<bullet> n = c\\<rbrakk>\n           \\<Longrightarrow> (x, d -\n                                 (blinfun_scaleR_left (f x) o\\<^sub>L\n                                  (blinfun_scaleR_left\n                                    (inverse (f x \\<bullet> n)) o\\<^sub>L\n                                   (blinfun_inner_left n o\\<^sub>L d))))\n                             \\<in> PDP;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n        \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow>\n           \\<forall>\\<^sub>F x in at x within plane n c. x \\<in> R;\n        0 \\<le> hl; hl \\<le> t; fst ` X0 \\<subseteq> X;\n        fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n        \\<forall>h\\<in>{hl..t}.\n           h \\<in> existence_ivl0 x \\<and>\n           (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y \\<and>\n           (\\<forall>h'\\<in>{0..h}.\n               (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX", "apply (drule bspec[where x=t], force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       \\<lbrakk>0 \\<le> s; s \\<le> t; (x, d) \\<in> X0;\n        fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}; closed R;\n        R \\<subseteq> plane n c;\n        \\<And>x d.\n           \\<lbrakk>(x, d) \\<in> CX; x \\<bullet> n = c\\<rbrakk>\n           \\<Longrightarrow> (x, d -\n                                 (blinfun_scaleR_left (f x) o\\<^sub>L\n                                  (blinfun_scaleR_left\n                                    (inverse (f x \\<bullet> n)) o\\<^sub>L\n                                   (blinfun_inner_left n o\\<^sub>L d))))\n                             \\<in> PDP;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n        \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow>\n           \\<forall>\\<^sub>F x in at x within plane n c. x \\<in> R;\n        0 \\<le> hl; hl \\<le> t; fst ` X0 \\<subseteq> X;\n        fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n        t \\<in> existence_ivl0 x \\<and>\n        (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> Y \\<and>\n        (\\<forall>h'\\<in>{0..t}.\n            (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX)\\<rbrakk>\n       \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  t \\<in> existence_ivl0 x\n  \\<lbrakk>0 \\<le> ?s2; ?s2 \\<le> t\\<rbrakk>\n  \\<Longrightarrow> (flow0 x ?s2, Dflow x ?s2 o\\<^sub>L d) \\<in> CX\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> Y\n\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "proof (cases \"\\<forall>s\\<in>{0..t}. flow0 x s \\<in> ?sB\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>s\\<in>{0..t}.\n       flow0 x s \\<in> {x. x \\<bullet> n < c} \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n 2. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "case True"], ["proof (state)\nthis:\n  \\<forall>s\\<in>{0..t}. flow0 x s \\<in> {x. x \\<bullet> n < c}\n\ngoal (2 subgoals):\n 1. \\<forall>s\\<in>{0..t}.\n       flow0 x s \\<in> {x. x \\<bullet> n < c} \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n 2. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "then"], ["proof (chain)\npicking this:\n  \\<forall>s\\<in>{0..t}. flow0 x s \\<in> {x. x \\<bullet> n < c}", "have \"(x, d) \\<in> ?X2\""], ["proof (prove)\nusing this:\n  \\<forall>s\\<in>{0..t}. flow0 x s \\<in> {x. x \\<bullet> n < c}\n\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "using assms t \\<open>(x, d) \\<in> X0\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>s\\<in>{0..t}. flow0 x s \\<in> {x. x \\<bullet> n < c}\n  flowpipe X0 hl t CX Y\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  n \\<noteq> (0::'a)\n  closed R\n  R \\<subseteq> plane n c\n  \\<lbrakk>(?x2, ?d2) \\<in> CX; ?x2 \\<bullet> n = c\\<rbrakk>\n  \\<Longrightarrow> (?x2,\n                     ?d2 -\n                     (blinfun_scaleR_left (f ?x2) o\\<^sub>L\n                      (blinfun_scaleR_left\n                        (inverse (f ?x2 \\<bullet> n)) o\\<^sub>L\n                       (blinfun_inner_left n o\\<^sub>L ?d2))))\n                    \\<in> PDP\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> f ?x2 \\<bullet> n \\<noteq> 0\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> ?x2 \\<in> R\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2 within plane n c. x \\<in> R\n  t \\<in> existence_ivl0 x\n  \\<lbrakk>0 \\<le> ?s2; ?s2 \\<le> t\\<rbrakk>\n  \\<Longrightarrow> (flow0 x ?s2, Dflow x ?s2 o\\<^sub>L d) \\<in> CX\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> Y\n  (x, d) \\<in> X0\n\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "by (auto simp: flowpipe_def flowsto_def open_segment_eq_real_ivl dest!: bspec[where x=\"(x, d)\"])"], ["proof (state)\nthis:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal (2 subgoals):\n 1. \\<forall>s\\<in>{0..t}.\n       flow0 x s \\<in> {x. x \\<bullet> n < c} \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n 2. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "then"], ["proof (chain)\npicking this:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "show ?thesis"], ["proof (prove)\nusing this:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", ".."], ["proof (state)\nthis:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "case False"], ["proof (state)\nthis:\n  \\<not> (\\<forall>s\\<in>{0..t}. flow0 x s \\<in> {x. x \\<bullet> n < c})\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "then"], ["proof (chain)\npicking this:\n  \\<not> (\\<forall>s\\<in>{0..t}. flow0 x s \\<in> {x. x \\<bullet> n < c})", "obtain s where s: \"0 \\<le> s\" \"s \\<le> t\" \"flow0 x s \\<in> ?A\""], ["proof (prove)\nusing this:\n  \\<not> (\\<forall>s\\<in>{0..t}. flow0 x s \\<in> {x. x \\<bullet> n < c})\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t;\n         flow0 x s \\<in> {x. c \\<le> x \\<bullet> n}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: not_less)"], ["proof (state)\nthis:\n  0 \\<le> s\n  s \\<le> t\n  flow0 x s \\<in> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "let ?I = \"flow0 x -` ?A \\<inter> {0 .. s}\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "from s"], ["proof (chain)\npicking this:\n  0 \\<le> s\n  s \\<le> t\n  flow0 x s \\<in> {x. c \\<le> x \\<bullet> n}", "have exivlI: \"0 \\<le> s' \\<Longrightarrow> s' \\<le> s \\<Longrightarrow> s' \\<in> existence_ivl0 x\" for s'"], ["proof (prove)\nusing this:\n  0 \\<le> s\n  s \\<le> t\n  flow0 x s \\<in> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> s'; s' \\<le> s\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> existence_ivl0 x", "using ivl_subset_existence_ivl[OF \\<open>t \\<in> existence_ivl0 x\\<close>]"], ["proof (prove)\nusing this:\n  0 \\<le> s\n  s \\<le> t\n  flow0 x s \\<in> {x. c \\<le> x \\<bullet> n}\n  {0..t} \\<subseteq> existence_ivl0 x\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> s'; s' \\<le> s\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> existence_ivl0 x", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?s'2; ?s'2 \\<le> s\\<rbrakk>\n  \\<Longrightarrow> ?s'2 \\<in> existence_ivl0 x\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>0 \\<le> ?s'2; ?s'2 \\<le> s\\<rbrakk>\n  \\<Longrightarrow> ?s'2 \\<in> existence_ivl0 x", "have \"compact ?I\""], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?s'2; ?s'2 \\<le> s\\<rbrakk>\n  \\<Longrightarrow> ?s'2 \\<in> existence_ivl0 x\n\ngoal (1 subgoal):\n 1. compact (flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s})", "unfolding compact_eq_bounded_closed"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?s'2; ?s'2 \\<le> s\\<rbrakk>\n  \\<Longrightarrow> ?s'2 \\<in> existence_ivl0 x\n\ngoal (1 subgoal):\n 1. bounded (flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}) \\<and>\n    closed (flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s})", "by (intro conjI bounded_Int bounded_closed_interval disjI2 closed_vimage_Int)\n          (auto intro!: continuous_intros closed_Collect_le_within cR)"], ["proof (state)\nthis:\n  compact (flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s})\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "moreover"], ["proof (state)\nthis:\n  compact (flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s})\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "from s"], ["proof (chain)\npicking this:\n  0 \\<le> s\n  s \\<le> t\n  flow0 x s \\<in> {x. c \\<le> x \\<bullet> n}", "have \"?I \\<noteq> {}\""], ["proof (prove)\nusing this:\n  0 \\<le> s\n  s \\<le> t\n  flow0 x s \\<in> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s} \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "ultimately"], ["proof (chain)\npicking this:\n  compact (flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s})\n  flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s} \\<noteq> {}", "have \"\\<exists>s\\<in>?I. \\<forall>t\\<in>?I. s \\<le> t\""], ["proof (prove)\nusing this:\n  compact (flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s})\n  flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<exists>sa\\<in>flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}.\n       \\<forall>t\\<in>flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}.\n          sa \\<le> t", "by (rule compact_attains_inf)"], ["proof (state)\nthis:\n  \\<exists>sa\\<in>flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}.\n     \\<forall>t\\<in>flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}.\n        sa \\<le> t\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "then"], ["proof (chain)\npicking this:\n  \\<exists>sa\\<in>flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}.\n     \\<forall>t\\<in>flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}.\n        sa \\<le> t", "obtain s' where s': \"\\<And>s''. 0 \\<le> s'' \\<Longrightarrow> s'' < s' \\<Longrightarrow> flow0 x s'' \\<notin> ?A\"\n          \"flow0 x s' \\<in> ?A\" \"0 \\<le> s'\" \"s' \\<le> s\""], ["proof (prove)\nusing this:\n  \\<exists>sa\\<in>flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}.\n     \\<forall>t\\<in>flow0 x -` {x. c \\<le> x \\<bullet> n} \\<inter> {0..s}.\n        sa \\<le> t\n\ngoal (1 subgoal):\n 1. (\\<And>s'.\n        \\<lbrakk>\\<And>s''.\n                    \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                    \\<Longrightarrow> flow0 x s''\n\\<notin> {x. c \\<le> x \\<bullet> n};\n         flow0 x s' \\<in> {x. c \\<le> x \\<bullet> n}; 0 \\<le> s';\n         s' \\<le> s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (force simp: Ball_def)"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?s''2; ?s''2 < s'\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?s''2 \\<notin> {x. c \\<le> x \\<bullet> n}\n  flow0 x s' \\<in> {x. c \\<le> x \\<bullet> n}\n  0 \\<le> s'\n  s' \\<le> s\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "have \"flow0 x 0 = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x 0 = x", "using local.mem_existence_ivl_iv_defined(2) t(1)"], ["proof (prove)\nusing this:\n  ?t \\<in> existence_ivl0 ?x0.0 \\<Longrightarrow> ?x0.0 \\<in> X\n  t \\<in> existence_ivl0 x\n\ngoal (1 subgoal):\n 1. flow0 x 0 = x", "by auto"], ["proof (state)\nthis:\n  flow0 x 0 = x\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "also"], ["proof (state)\nthis:\n  flow0 x 0 = x\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "have \"\\<dots> \\<notin> ?A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<notin> {x. c \\<le> x \\<bullet> n}", "using assms \\<open>(x, d) \\<in> X0\\<close>"], ["proof (prove)\nusing this:\n  flowpipe X0 hl t CX Y\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  n \\<noteq> (0::'a)\n  closed R\n  R \\<subseteq> plane n c\n  \\<lbrakk>(?x2, ?d2) \\<in> CX; ?x2 \\<bullet> n = c\\<rbrakk>\n  \\<Longrightarrow> (?x2,\n                     ?d2 -\n                     (blinfun_scaleR_left (f ?x2) o\\<^sub>L\n                      (blinfun_scaleR_left\n                        (inverse (f ?x2 \\<bullet> n)) o\\<^sub>L\n                       (blinfun_inner_left n o\\<^sub>L ?d2))))\n                    \\<in> PDP\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> f ?x2 \\<bullet> n \\<noteq> 0\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> ?x2 \\<in> R\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2 within plane n c. x \\<in> R\n  (x, d) \\<in> X0\n\ngoal (1 subgoal):\n 1. x \\<notin> {x. c \\<le> x \\<bullet> n}", "by auto"], ["proof (state)\nthis:\n  x \\<notin> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "finally"], ["proof (chain)\npicking this:\n  flow0 x 0 \\<notin> {x. c \\<le> x \\<bullet> n}", "have \"s' \\<noteq> 0\""], ["proof (prove)\nusing this:\n  flow0 x 0 \\<notin> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. s' \\<noteq> 0", "using s'"], ["proof (prove)\nusing this:\n  flow0 x 0 \\<notin> {x. c \\<le> x \\<bullet> n}\n  \\<lbrakk>0 \\<le> ?s''2; ?s''2 < s'\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?s''2 \\<notin> {x. c \\<le> x \\<bullet> n}\n  flow0 x s' \\<in> {x. c \\<le> x \\<bullet> n}\n  0 \\<le> s'\n  s' \\<le> s\n\ngoal (1 subgoal):\n 1. s' \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  s' \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "then"], ["proof (chain)\npicking this:\n  s' \\<noteq> 0", "have \"0 < s'\""], ["proof (prove)\nusing this:\n  s' \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < s'", "using \\<open>s' \\<ge> 0\\<close>"], ["proof (prove)\nusing this:\n  s' \\<noteq> 0\n  0 \\<le> s'\n\ngoal (1 subgoal):\n 1. 0 < s'", "by simp"], ["proof (state)\nthis:\n  0 < s'\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "have False if \"flow0 x s' \\<in> interior ?A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. False", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. False", "from that"], ["proof (chain)\npicking this:\n  flow0 x s' \\<in> interior {x. c \\<le> x \\<bullet> n}", "obtain e where \"e > 0\" and subset: \"ball (flow0 x s') e \\<subseteq> ?A\""], ["proof (prove)\nusing this:\n  flow0 x s' \\<in> interior {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. (\\<And>e.\n        \\<lbrakk>0 < e;\n         ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: mem_interior)"], ["proof (state)\nthis:\n  0 < e\n  ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. False", "from subset"], ["proof (chain)\npicking this:\n  ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}", "have \"\\<forall>\\<^sub>F s'' in at_left s'. ball (flow0 x s') e \\<subseteq> ?A\""], ["proof (prove)\nusing this:\n  ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F s'' in at_left s'.\n       ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}", "by simp"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F s'' in at_left s'.\n     ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. False", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F s'' in at_left s'.\n     ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. False", "from flow_continuous[OF exivlI[OF \\<open>0 \\<le> s'\\<close> \\<open>s' \\<le> s\\<close>]]"], ["proof (chain)\npicking this:\n  isCont (flow0 x) s'", "have \"flow0 x \\<midarrow>s'\\<rightarrow> flow0 x s'\""], ["proof (prove)\nusing this:\n  isCont (flow0 x) s'\n\ngoal (1 subgoal):\n 1. flow0 x \\<midarrow>s'\\<rightarrow> flow0 x s'", "unfolding isCont_def"], ["proof (prove)\nusing this:\n  flow0 x \\<midarrow>s'\\<rightarrow> flow0 x s'\n\ngoal (1 subgoal):\n 1. flow0 x \\<midarrow>s'\\<rightarrow> flow0 x s'", "."], ["proof (state)\nthis:\n  flow0 x \\<midarrow>s'\\<rightarrow> flow0 x s'\n\ngoal (1 subgoal):\n 1. False", "from tendstoD[OF this \\<open>0 < e\\<close>]"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F xa in at s'. dist (flow0 x xa) (flow0 x s') < e", "have \"\\<forall>\\<^sub>F xa in at_left s'. dist (flow0 x xa) (flow0 x s') < e\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F xa in at s'. dist (flow0 x xa) (flow0 x s') < e\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F xa in at_left s'. dist (flow0 x xa) (flow0 x s') < e", "using eventually_at_split"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F xa in at s'. dist (flow0 x xa) (flow0 x s') < e\n  eventually ?P (at ?x) =\n  (eventually ?P (at_left ?x) \\<and> eventually ?P (at_right ?x))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F xa in at_left s'. dist (flow0 x xa) (flow0 x s') < e", "by blast"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F xa in at_left s'. dist (flow0 x xa) (flow0 x s') < e\n\ngoal (1 subgoal):\n 1. False", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F xa in at_left s'. dist (flow0 x xa) (flow0 x s') < e", "have \"\\<forall>\\<^sub>F s'' in at_left s'. flow0 x s'' \\<in> ball (flow0 x s') e\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F xa in at_left s'. dist (flow0 x xa) (flow0 x s') < e\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F s'' in at_left s'.\n       flow0 x s'' \\<in> ball (flow0 x s') e", "by (simp add: dist_commute)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F s'' in at_left s'. flow0 x s'' \\<in> ball (flow0 x s') e\n\ngoal (1 subgoal):\n 1. False", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F s'' in at_left s'. flow0 x s'' \\<in> ball (flow0 x s') e\n\ngoal (1 subgoal):\n 1. False", "have \"\\<forall>\\<^sub>F s'' in at_left s'. 0 < s''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eventually ((<) 0) (at_left s')", "using \\<open>0 < s'\\<close>"], ["proof (prove)\nusing this:\n  0 < s'\n\ngoal (1 subgoal):\n 1. eventually ((<) 0) (at_left s')", "using eventually_at_left"], ["proof (prove)\nusing this:\n  0 < s'\n  ?y < ?x \\<Longrightarrow>\n  eventually ?P (at_left ?x) =\n  (\\<exists>b<?x. \\<forall>y>b. y < ?x \\<longrightarrow> ?P y)\n\ngoal (1 subgoal):\n 1. eventually ((<) 0) (at_left s')", "by blast"], ["proof (state)\nthis:\n  eventually ((<) 0) (at_left s')\n\ngoal (1 subgoal):\n 1. False", "moreover"], ["proof (state)\nthis:\n  eventually ((<) 0) (at_left s')\n\ngoal (1 subgoal):\n 1. False", "have \"\\<forall>\\<^sub>F s'' in at_left s'. s'' < s'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F s'' in at_left s'. s'' < s'", "by (auto simp: eventually_at_filter)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F s'' in at_left s'. s'' < s'\n\ngoal (1 subgoal):\n 1. False", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F s'' in at_left s'.\n     ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}\n  \\<forall>\\<^sub>F s'' in at_left s'. flow0 x s'' \\<in> ball (flow0 x s') e\n  eventually ((<) 0) (at_left s')\n  \\<forall>\\<^sub>F s'' in at_left s'. s'' < s'", "have \"\\<forall>\\<^sub>F s'' in at_left s'. False\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F s'' in at_left s'.\n     ball (flow0 x s') e \\<subseteq> {x. c \\<le> x \\<bullet> n}\n  \\<forall>\\<^sub>F s'' in at_left s'. flow0 x s'' \\<in> ball (flow0 x s') e\n  eventually ((<) 0) (at_left s')\n  \\<forall>\\<^sub>F s'' in at_left s'. s'' < s'\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F s'' in at_left s'. False", "by eventually_elim (use s' in auto)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F s'' in at_left s'. False\n\ngoal (1 subgoal):\n 1. False", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F s'' in at_left s'. False", "show False"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F s'' in at_left s'. False\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  flow0 x s' \\<in> interior {x. c \\<le> x \\<bullet> n} \\<Longrightarrow>\n  False\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "then"], ["proof (chain)\npicking this:\n  flow0 x s' \\<in> interior {x. c \\<le> x \\<bullet> n} \\<Longrightarrow>\n  False", "have \"flow0 x s' \\<in> frontier ?A\""], ["proof (prove)\nusing this:\n  flow0 x s' \\<in> interior {x. c \\<le> x \\<bullet> n} \\<Longrightarrow>\n  False\n\ngoal (1 subgoal):\n 1. flow0 x s' \\<in> frontier {x. c \\<le> x \\<bullet> n}", "unfolding frontier_def"], ["proof (prove)\nusing this:\n  flow0 x s' \\<in> interior {x. c \\<le> x \\<bullet> n} \\<Longrightarrow>\n  False\n\ngoal (1 subgoal):\n 1. flow0 x s'\n    \\<in> closure {x. c \\<le> x \\<bullet> n} -\n          interior {x. c \\<le> x \\<bullet> n}", "using \\<open>closed ?A\\<close> s'"], ["proof (prove)\nusing this:\n  flow0 x s' \\<in> interior {x. c \\<le> x \\<bullet> n} \\<Longrightarrow>\n  False\n  closed {x. c \\<le> x \\<bullet> n}\n  \\<lbrakk>0 \\<le> ?s''2; ?s''2 < s'\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?s''2 \\<notin> {x. c \\<le> x \\<bullet> n}\n  flow0 x s' \\<in> {x. c \\<le> x \\<bullet> n}\n  0 \\<le> s'\n  s' \\<le> s\n\ngoal (1 subgoal):\n 1. flow0 x s'\n    \\<in> closure {x. c \\<le> x \\<bullet> n} -\n          interior {x. c \\<le> x \\<bullet> n}", "by auto"], ["proof (state)\nthis:\n  flow0 x s' \\<in> frontier {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "with s'"], ["proof (chain)\npicking this:\n  \\<lbrakk>0 \\<le> ?s''2; ?s''2 < s'\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?s''2 \\<notin> {x. c \\<le> x \\<bullet> n}\n  flow0 x s' \\<in> {x. c \\<le> x \\<bullet> n}\n  0 \\<le> s'\n  s' \\<le> s\n  flow0 x s' \\<in> frontier {x. c \\<le> x \\<bullet> n}", "have \"(x, d) \\<in> ?X1\""], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?s''2; ?s''2 < s'\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?s''2 \\<notin> {x. c \\<le> x \\<bullet> n}\n  flow0 x s' \\<in> {x. c \\<le> x \\<bullet> n}\n  0 \\<le> s'\n  s' \\<le> s\n  flow0 x s' \\<in> frontier {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}", "using assms that s t \\<open>0 < s'\\<close>\n        ivl_subset_existence_ivl[OF \\<open>t \\<in> existence_ivl0 x\\<close>]\n        frontier_subset_closed[OF \\<open>closed ?A\\<close>]"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?s''2; ?s''2 < s'\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?s''2 \\<notin> {x. c \\<le> x \\<bullet> n}\n  flow0 x s' \\<in> {x. c \\<le> x \\<bullet> n}\n  0 \\<le> s'\n  s' \\<le> s\n  flow0 x s' \\<in> frontier {x. c \\<le> x \\<bullet> n}\n  flowpipe X0 hl t CX Y\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  n \\<noteq> (0::'a)\n  closed R\n  R \\<subseteq> plane n c\n  \\<lbrakk>(?x2, ?d2) \\<in> CX; ?x2 \\<bullet> n = c\\<rbrakk>\n  \\<Longrightarrow> (?x2,\n                     ?d2 -\n                     (blinfun_scaleR_left (f ?x2) o\\<^sub>L\n                      (blinfun_scaleR_left\n                        (inverse (f ?x2 \\<bullet> n)) o\\<^sub>L\n                       (blinfun_inner_left n o\\<^sub>L ?d2))))\n                    \\<in> PDP\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> f ?x2 \\<bullet> n \\<noteq> 0\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> ?x2 \\<in> R\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2 within plane n c. x \\<in> R\n  (x, d) \\<in> X0\n  0 \\<le> s\n  s \\<le> t\n  flow0 x s \\<in> {x. c \\<le> x \\<bullet> n}\n  t \\<in> existence_ivl0 x\n  \\<lbrakk>0 \\<le> ?s2; ?s2 \\<le> t\\<rbrakk>\n  \\<Longrightarrow> (flow0 x ?s2, Dflow x ?s2 o\\<^sub>L d) \\<in> CX\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> Y\n  0 < s'\n  {0..t} \\<subseteq> existence_ivl0 x\n  frontier {x. c \\<le> x \\<bullet> n} \\<subseteq> {x. c \\<le> x \\<bullet> n}\n\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}", "apply (auto simp: flowsto_def flowpipe_def open_segment_eq_real_ivl frontier_halfspace_component_ge\n            intro!:\n            dest!: bspec[where x=\"(x, d)\"]\n            intro: exivlI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>{0<..t}.\n                         h \\<in> existence_ivl0 x \\<and>\n                         flow0 x h \\<in> R \\<and>\n                         flow0 x h \\<bullet> n =\n                         flow0 x s' \\<bullet> n \\<and>\n                         (\\<forall>h'\\<in>{0<..<h}.\n                             flow0 x h' \\<bullet> n\n                             < flow0 x s' \\<bullet> n)", "apply (safe intro!: bexI[where x=s'])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> existence_ivl0 x\n 2. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> flow0 x s' \\<in> R\n 3. \\<And>h'.\n       \\<lbrakk>\\<And>s''.\n                   \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                   \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n      \\<le> flow0 x s'' \\<bullet> n;\n        s' \\<le> s;\n        fst ` X0 \\<inter>\n        {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n        {};\n        closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n        \\<And>xa d.\n           \\<lbrakk>(xa, d) \\<in> CX;\n            xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n           \\<Longrightarrow> (xa,\n                              d -\n                              (blinfun_scaleR_left (f xa) o\\<^sub>L\n                               (blinfun_scaleR_left\n                                 (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                                (blinfun_inner_left n o\\<^sub>L d))))\n                             \\<in> PDP;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n        \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n        \\<And>xa d.\n           (xa, d) \\<in> PDP \\<Longrightarrow>\n           \\<forall>\\<^sub>F x in at xa\n              within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n        (x, d) \\<in> X0; s \\<le> t;\n        flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n        \\<And>s.\n           \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n           \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n        0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n        plane n (flow0 x s' \\<bullet> n)\n        \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n        c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` Y \\<subseteq> X;\n        \\<forall>h\\<in>{hl..t}.\n           h \\<in> existence_ivl0 x \\<and>\n           (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y;\n        h' \\<in> {0<..<s'}\\<rbrakk>\n       \\<Longrightarrow> flow0 x h' \\<bullet> n < flow0 x s' \\<bullet> n\n 4. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> {0<..t}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> existence_ivl0 x", "by force"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> flow0 x s' \\<in> R\n 2. \\<And>h'.\n       \\<lbrakk>\\<And>s''.\n                   \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                   \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n      \\<le> flow0 x s'' \\<bullet> n;\n        s' \\<le> s;\n        fst ` X0 \\<inter>\n        {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n        {};\n        closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n        \\<And>xa d.\n           \\<lbrakk>(xa, d) \\<in> CX;\n            xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n           \\<Longrightarrow> (xa,\n                              d -\n                              (blinfun_scaleR_left (f xa) o\\<^sub>L\n                               (blinfun_scaleR_left\n                                 (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                                (blinfun_inner_left n o\\<^sub>L d))))\n                             \\<in> PDP;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n        \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n        \\<And>xa d.\n           (xa, d) \\<in> PDP \\<Longrightarrow>\n           \\<forall>\\<^sub>F x in at xa\n              within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n        (x, d) \\<in> X0; s \\<le> t;\n        flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n        \\<And>s.\n           \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n           \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n        0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n        plane n (flow0 x s' \\<bullet> n)\n        \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n        c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` Y \\<subseteq> X;\n        \\<forall>h\\<in>{hl..t}.\n           h \\<in> existence_ivl0 x \\<and>\n           (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y;\n        h' \\<in> {0<..<s'}\\<rbrakk>\n       \\<Longrightarrow> flow0 x h' \\<bullet> n < flow0 x s' \\<bullet> n\n 3. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> {0<..t}", "subgoal premises prems"], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x s' \\<in> R", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. flow0 x s' \\<in> R", "have CX: \"(flow0 x s', Dflow x s' o\\<^sub>L d) \\<in> CX\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (flow0 x s', Dflow x s' o\\<^sub>L d) \\<in> CX", "using prems"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?s''2; ?s''2 < s'\\<rbrakk>\n  \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n                           \\<le> flow0 x ?s''2 \\<bullet> n\n  s' \\<le> s\n  fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  closed R\n  R \\<subseteq> plane n (flow0 x s' \\<bullet> n)\n  \\<lbrakk>(?x2, ?d2) \\<in> CX;\n   ?x2 \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n  \\<Longrightarrow> (?x2,\n                     ?d2 -\n                     (blinfun_scaleR_left (f ?x2) o\\<^sub>L\n                      (blinfun_scaleR_left\n                        (inverse (f ?x2 \\<bullet> n)) o\\<^sub>L\n                       (blinfun_inner_left n o\\<^sub>L ?d2))))\n                    \\<in> PDP\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> f ?x2 \\<bullet> n \\<noteq> 0\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> ?x2 \\<in> R\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2 within plane n (flow0 x s' \\<bullet> n).\n     x \\<in> R\n  (x, d) \\<in> X0\n  s \\<le> t\n  flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n\n  \\<lbrakk>0 \\<le> ?s2; ?s2 \\<le> t\\<rbrakk>\n  \\<Longrightarrow> (flow0 x ?s2, Dflow x ?s2 o\\<^sub>L d) \\<in> CX\n  0 < s'\n  {0..t} \\<subseteq> existence_ivl0 x\n  plane n (flow0 x s' \\<bullet> n)\n  \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n}\n  c = flow0 x s' \\<bullet> n\n  0 \\<le> hl\n  hl \\<le> t\n  fst ` X0 \\<subseteq> X\n  fst ` CX \\<subseteq> X\n  fst ` Y \\<subseteq> X\n  \\<forall>h\\<in>{hl..t}.\n     h \\<in> existence_ivl0 x \\<and>\n     (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\n\ngoal (1 subgoal):\n 1. (flow0 x s', Dflow x s' o\\<^sub>L d) \\<in> CX", "by (auto intro!: prems)"], ["proof (state)\nthis:\n  (flow0 x s', Dflow x s' o\\<^sub>L d) \\<in> CX\n\ngoal (1 subgoal):\n 1. flow0 x s' \\<in> R", "have \"flow0 x s' \\<bullet> n = c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x s' \\<bullet> n = c", "using prems"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?s''2; ?s''2 < s'\\<rbrakk>\n  \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n                           \\<le> flow0 x ?s''2 \\<bullet> n\n  s' \\<le> s\n  fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  closed R\n  R \\<subseteq> plane n (flow0 x s' \\<bullet> n)\n  \\<lbrakk>(?x2, ?d2) \\<in> CX;\n   ?x2 \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n  \\<Longrightarrow> (?x2,\n                     ?d2 -\n                     (blinfun_scaleR_left (f ?x2) o\\<^sub>L\n                      (blinfun_scaleR_left\n                        (inverse (f ?x2 \\<bullet> n)) o\\<^sub>L\n                       (blinfun_inner_left n o\\<^sub>L ?d2))))\n                    \\<in> PDP\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> f ?x2 \\<bullet> n \\<noteq> 0\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow> ?x2 \\<in> R\n  (?x2, ?d2) \\<in> PDP \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2 within plane n (flow0 x s' \\<bullet> n).\n     x \\<in> R\n  (x, d) \\<in> X0\n  s \\<le> t\n  flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n\n  \\<lbrakk>0 \\<le> ?s2; ?s2 \\<le> t\\<rbrakk>\n  \\<Longrightarrow> (flow0 x ?s2, Dflow x ?s2 o\\<^sub>L d) \\<in> CX\n  0 < s'\n  {0..t} \\<subseteq> existence_ivl0 x\n  plane n (flow0 x s' \\<bullet> n)\n  \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n}\n  c = flow0 x s' \\<bullet> n\n  0 \\<le> hl\n  hl \\<le> t\n  fst ` X0 \\<subseteq> X\n  fst ` CX \\<subseteq> X\n  fst ` Y \\<subseteq> X\n  \\<forall>h\\<in>{hl..t}.\n     h \\<in> existence_ivl0 x \\<and>\n     (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\n\ngoal (1 subgoal):\n 1. flow0 x s' \\<bullet> n = c", "by auto"], ["proof (state)\nthis:\n  flow0 x s' \\<bullet> n = c\n\ngoal (1 subgoal):\n 1. flow0 x s' \\<in> R", "from PDP_inR[OF PDP[OF CX this]]"], ["proof (chain)\npicking this:\n  flow0 x s' \\<in> R", "show \"flow0 x s' \\<in> R\""], ["proof (prove)\nusing this:\n  flow0 x s' \\<in> R\n\ngoal (1 subgoal):\n 1. flow0 x s' \\<in> R", "."], ["proof (state)\nthis:\n  flow0 x s' \\<in> R\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h'.\n       \\<lbrakk>\\<And>s''.\n                   \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                   \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n      \\<le> flow0 x s'' \\<bullet> n;\n        s' \\<le> s;\n        fst ` X0 \\<inter>\n        {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n        {};\n        closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n        \\<And>xa d.\n           \\<lbrakk>(xa, d) \\<in> CX;\n            xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n           \\<Longrightarrow> (xa,\n                              d -\n                              (blinfun_scaleR_left (f xa) o\\<^sub>L\n                               (blinfun_scaleR_left\n                                 (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                                (blinfun_inner_left n o\\<^sub>L d))))\n                             \\<in> PDP;\n        \\<And>x d.\n           (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n        \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n        \\<And>xa d.\n           (xa, d) \\<in> PDP \\<Longrightarrow>\n           \\<forall>\\<^sub>F x in at xa\n              within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n        (x, d) \\<in> X0; s \\<le> t;\n        flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n        \\<And>s.\n           \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n           \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n        0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n        plane n (flow0 x s' \\<bullet> n)\n        \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n        c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n        fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X;\n        fst ` Y \\<subseteq> X;\n        \\<forall>h\\<in>{hl..t}.\n           h \\<in> existence_ivl0 x \\<and>\n           (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y;\n        h' \\<in> {0<..<s'}\\<rbrakk>\n       \\<Longrightarrow> flow0 x h' \\<bullet> n < flow0 x s' \\<bullet> n\n 2. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> {0<..t}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y;\n     h'_ \\<in> {0<..<s'}\\<rbrakk>\n    \\<Longrightarrow> flow0 x h'_ \\<bullet> n < flow0 x s' \\<bullet> n", "by (auto simp: not_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> {0<..t}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>s''.\n                \\<lbrakk>0 \\<le> s''; s'' < s'\\<rbrakk>\n                \\<Longrightarrow> \\<not> flow0 x s' \\<bullet> n\n   \\<le> flow0 x s'' \\<bullet> n;\n     s' \\<le> s;\n     fst ` X0 \\<inter> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n} =\n     {};\n     closed R; R \\<subseteq> plane n (flow0 x s' \\<bullet> n);\n     \\<And>xa d.\n        \\<lbrakk>(xa, d) \\<in> CX;\n         xa \\<bullet> n = flow0 x s' \\<bullet> n\\<rbrakk>\n        \\<Longrightarrow> (xa,\n                           d -\n                           (blinfun_scaleR_left (f xa) o\\<^sub>L\n                            (blinfun_scaleR_left\n                              (inverse (f xa \\<bullet> n)) o\\<^sub>L\n                             (blinfun_inner_left n o\\<^sub>L d))))\n                          \\<in> PDP;\n     \\<And>x d.\n        (x, d) \\<in> PDP \\<Longrightarrow> f x \\<bullet> n \\<noteq> 0;\n     \\<And>x d. (x, d) \\<in> PDP \\<Longrightarrow> x \\<in> R;\n     \\<And>xa d.\n        (xa, d) \\<in> PDP \\<Longrightarrow>\n        \\<forall>\\<^sub>F x in at xa\n           within plane n (flow0 x s' \\<bullet> n). x \\<in> R;\n     (x, d) \\<in> X0; s \\<le> t;\n     flow0 x s' \\<bullet> n \\<le> flow0 x s \\<bullet> n;\n     \\<And>s.\n        \\<lbrakk>0 \\<le> s; s \\<le> t\\<rbrakk>\n        \\<Longrightarrow> (flow0 x s, Dflow x s o\\<^sub>L d) \\<in> CX;\n     0 < s'; {0..t} \\<subseteq> existence_ivl0 x;\n     plane n (flow0 x s' \\<bullet> n)\n     \\<subseteq> {xa. flow0 x s' \\<bullet> n \\<le> xa \\<bullet> n};\n     c = flow0 x s' \\<bullet> n; 0 \\<le> hl; hl \\<le> t;\n     fst ` X0 \\<subseteq> X; fst ` CX \\<subseteq> X; fst ` Y \\<subseteq> X;\n     \\<forall>h\\<in>{hl..t}.\n        h \\<in> existence_ivl0 x \\<and>\n        (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> Y\\<rbrakk>\n    \\<Longrightarrow> s' \\<in> {0<..t}", "by force"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>s\\<in>{0..t}.\n               flow0 x s \\<in> {x. x \\<bullet> n < c}) \\<Longrightarrow>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "then"], ["proof (chain)\npicking this:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}", "show ?thesis"], ["proof (prove)\nusing this:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n\ngoal (1 subgoal):\n 1. (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {0<..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (CX \\<inter>\n             {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n    (x, d)\n    \\<in> {x \\<in> X0.\n           flowsto {x} {hl..t}\n            (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n            (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", ".."], ["proof (state)\nthis:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n  (x, d)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  (?x2, ?d2)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n  (?x2, ?d2)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  (?x2, ?d2)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n  (?x2, ?d2)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "have \"X0 = ?X1 \\<union> ?X2\""], ["proof (prove)\nusing this:\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  (?x2, ?d2)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<or>\n  (?x2, ?d2)\n  \\<in> {x \\<in> X0.\n         flowsto {x} {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal (1 subgoal):\n 1. X0 =\n    {x \\<in> X0.\n     flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n      (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<union>\n    {x \\<in> X0.\n     flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n      (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}", "by auto"], ["proof (state)\nthis:\n  X0 =\n  {x \\<in> X0.\n   flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n    (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<union>\n  {x \\<in> X0.\n   flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n    (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  X0 =\n  {x \\<in> X0.\n   flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n    (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<union>\n  {x \\<in> X0.\n   flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n    (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have X1: \"flowsto ?X1 {0 <.. t} ?CX (CX \\<inter> (?P \\<times> UNIV))\"\n    and X2: \"flowsto ?X2 {hl .. t} ?CX (Y \\<inter> (?sB \\<times> UNIV))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flowsto\n     {x \\<in> X0.\n      flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n       (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n     {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV) &&&\n    flowsto\n     {x \\<in> X0.\n      flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n       (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n     {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)", "by (auto simp: flowsto_def flowpipe_def)"], ["proof (state)\nthis:\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n   {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n   {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from assms(2) X1"], ["proof (chain)\npicking this:\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)", "have \"poincare_mapsto ?P ?X1 UNIV (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\""], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)\n\ngoal (1 subgoal):\n 1. poincare_mapsto {x \\<in> R. x \\<bullet> n = c}\n     {x \\<in> X0.\n      flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n       (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n     UNIV (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP", "unfolding poincare_mapsto_def flowsto_def"], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  \\<forall>(x0, d0)\n           \\<in>{x \\<in> X0.\n                 \\<forall>(x0, d0)\\<in>{x}.\n                    \\<exists>h\\<in>{0<..t}.\n                       h \\<in> existence_ivl0 x0 \\<and>\n                       (flow0 x0 h, Dflow x0 h o\\<^sub>L d0)\n                       \\<in> CX \\<inter>\n                             {x \\<in> R. x \\<bullet> n = c} \\<times>\n                             UNIV \\<and>\n                       (\\<forall>h'\\<in>{0<--<h}.\n                           (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                           \\<in> CX \\<inter>\n                                 {x. x \\<bullet> n < c} \\<times> UNIV)}.\n     \\<exists>h\\<in>{0<..t}.\n        h \\<in> existence_ivl0 x0 \\<and>\n        (flow0 x0 h, Dflow x0 h o\\<^sub>L d0)\n        \\<in> CX \\<inter>\n              {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV \\<and>\n        (\\<forall>h'\\<in>{0<--<h}.\n            (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n            \\<in> CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n\ngoal (1 subgoal):\n 1. \\<forall>(x, d)\n             \\<in>{x \\<in> X0.\n                   \\<forall>(x0, d0)\\<in>{x}.\n                      \\<exists>h\\<in>{0<..t}.\n                         h \\<in> existence_ivl0 x0 \\<and>\n                         (flow0 x0 h, Dflow x0 h o\\<^sub>L d0)\n                         \\<in> CX \\<inter>\n                               {x \\<in> R. x \\<bullet> n = c} \\<times>\n                               UNIV \\<and>\n                         (\\<forall>h'\\<in>{0<--<h}.\n                             (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                             \\<in> CX \\<inter>\n                                   {x. x \\<bullet> n < c} \\<times> UNIV)}.\n       returns_to {x \\<in> R. x \\<bullet> n = c} x \\<and>\n       fst `\n       {x \\<in> X0.\n        \\<forall>(x0, d0)\\<in>{x}.\n           \\<exists>h\\<in>{0<..t}.\n              h \\<in> existence_ivl0 x0 \\<and>\n              (flow0 x0 h, Dflow x0 h o\\<^sub>L d0)\n              \\<in> CX \\<inter>\n                    {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV \\<and>\n              (\\<forall>h'\\<in>{0<--<h}.\n                  (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0)\n                  \\<in> CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n       \\<subseteq> UNIV \\<and>\n       return_time {x \\<in> R. x \\<bullet> n = c} differentiable at x \\<and>\n       (\\<exists>D.\n           (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n            blinfun_apply D)\n            (at x) \\<and>\n           (poincare_map {x \\<in> R. x \\<bullet> n = c} x, D o\\<^sub>L d)\n           \\<in> PDP) \\<and>\n       (\\<forall>t\\<in>{0<..<return_time {x \\<in> R. x \\<bullet> n = c} x}.\n           flow0 x t \\<in> fst ` CX \\<inter> {x. x \\<bullet> n < c})", "apply clarsimp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b h.\n       \\<lbrakk>fst ` X0 \\<inter>\n                {x. flow0 a h \\<bullet> n \\<le> x \\<bullet> n} =\n                {};\n        (a, b) \\<in> X0; h \\<in> existence_ivl0 a;\n        (flow0 a h, Dflow a h o\\<^sub>L b) \\<in> CX; flow0 a h \\<in> R;\n        \\<forall>h'\\<in>{0<--<h}.\n           (flow0 a h', Dflow a h' o\\<^sub>L b) \\<in> CX \\<and>\n           flow0 a h' \\<bullet> n < flow0 a h \\<bullet> n;\n        c = flow0 a h \\<bullet> n; 0 < h; h \\<le> t\\<rbrakk>\n       \\<Longrightarrow> returns_to\n                          {x \\<in> R. x \\<bullet> n = flow0 a h \\<bullet> n}\n                          a \\<and>\n                         return_time\n                          {x \\<in> R.\n                           x \\<bullet> n =\n                           flow0 a h \\<bullet> n} differentiable\n                         at a \\<and>\n                         (\\<exists>D.\n                             (poincare_map\n                               {x \\<in> R.\n                                x \\<bullet> n =\n                                flow0 a h \\<bullet> n} has_derivative\n                              blinfun_apply D)\n                              (at a) \\<and>\n                             (poincare_map\n                               {x \\<in> R.\n                                x \\<bullet> n = flow0 a h \\<bullet> n}\n                               a,\n                              D o\\<^sub>L b)\n                             \\<in> PDP) \\<and>\n                         (\\<forall>t\\<in>{0<..<return_time\n          {x \\<in> R. x \\<bullet> n = flow0 a h \\<bullet> n} a}.\n                             flow0 a t \\<in> fst ` CX \\<and>\n                             flow0 a t \\<bullet> n < flow0 a h \\<bullet> n)", "subgoal premises prems for x d t"], ["proof (prove)\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "note prems"], ["proof (state)\nthis:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "have ret: \"returns_to ?P x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. returns_to {x \\<in> R. x \\<bullet> n = c} x", "apply (rule returns_to_outsideI[where t=t])"], ["proof (prove)\ngoal (5 subgoals):\n 1. 0 \\<le> t\n 2. t \\<in> existence_ivl0 x\n 3. flow0 x t \\<in> {x \\<in> R. x \\<bullet> n = c}\n 4. x \\<notin> {x \\<in> R. x \\<bullet> n = c}\n 5. closed {x \\<in> R. x \\<bullet> n = c}", "using prems \\<open>closed ?P\\<close>"], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t\n  closed {x \\<in> R. x \\<bullet> n = c}\n\ngoal (5 subgoals):\n 1. 0 \\<le> t\n 2. t \\<in> existence_ivl0 x\n 3. flow0 x t \\<in> {x \\<in> R. x \\<bullet> n = c}\n 4. x \\<notin> {x \\<in> R. x \\<bullet> n = c}\n 5. closed {x \\<in> R. x \\<bullet> n = c}", "by auto"], ["proof (state)\nthis:\n  returns_to {x \\<in> R. x \\<bullet> n = c} x\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "moreover"], ["proof (state)\nthis:\n  returns_to {x \\<in> R. x \\<bullet> n = c} x\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "have ret_le: \"return_time ?P x \\<le> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. return_time {x \\<in> R. x \\<bullet> n = c} x \\<le> t", "apply (rule return_time_le[OF ret _ _ \\<open>0 < t\\<close>])"], ["proof (prove)\ngoal (2 subgoals):\n 1. closed {x \\<in> R. x \\<bullet> n = c}\n 2. flow0 x t \\<in> {x \\<in> R. x \\<bullet> n = c}", "using prems \\<open>closed ?P\\<close>"], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t\n  closed {x \\<in> R. x \\<bullet> n = c}\n\ngoal (2 subgoals):\n 1. closed {x \\<in> R. x \\<bullet> n = c}\n 2. flow0 x t \\<in> {x \\<in> R. x \\<bullet> n = c}", "by auto"], ["proof (state)\nthis:\n  return_time {x \\<in> R. x \\<bullet> n = c} x \\<le> t\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "from prems"], ["proof (chain)\npicking this:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t", "have CX: \"(flow0 x h', (Dflow x h') o\\<^sub>L d) \\<in> CX\" if \"0 < h'\" \"h' \\<le> t\" for h'"], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t\n\ngoal (1 subgoal):\n 1. (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX", "using that"], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t\n  0 < h'\n  h' \\<le> t\n\ngoal (1 subgoal):\n 1. (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX", "by (auto simp: open_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?h'2; ?h'2 \\<le> t\\<rbrakk>\n  \\<Longrightarrow> (flow0 x ?h'2, Dflow x ?h'2 o\\<^sub>L d) \\<in> CX\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "have PDP: \"(poincare_map ?P x, Dpoincare_map' n c R x o\\<^sub>L d) \\<in> PDP\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (poincare_map {x \\<in> R. x \\<bullet> n = c} x,\n     Dpoincare_map' n c R x o\\<^sub>L d)\n    \\<in> PDP", "unfolding poincare_map_def Dpoincare_map'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (flow0 x (return_time {x \\<in> R. x \\<bullet> n = c} x),\n     Dflow x (return_time {x \\<in> R. x \\<bullet> n - c = 0} x) -\n     (blinfun_scaleR_left\n       (f (flow0 x\n            (return_time {x \\<in> R. x \\<bullet> n = c} x))) o\\<^sub>L\n      (blinfun_scaleR_left\n        (inverse\n          (f (flow0 x\n               (return_time {x \\<in> R. x \\<bullet> n = c} x)) \\<bullet>\n           n)) o\\<^sub>L\n       (blinfun_inner_left n o\\<^sub>L\n        Dflow x\n         (return_time {x \\<in> R. x \\<bullet> n - c = 0} x)))) o\\<^sub>L\n     d)\n    \\<in> PDP", "unfolding blinfun_compose_assoc blinfun_minus_comp_distrib"], ["proof (prove)\ngoal (1 subgoal):\n 1. (flow0 x (return_time {x \\<in> R. x \\<bullet> n = c} x),\n     (Dflow x (return_time {x \\<in> R. x \\<bullet> n - c = 0} x) o\\<^sub>L\n      d) -\n     (blinfun_scaleR_left\n       (f (flow0 x\n            (return_time {x \\<in> R. x \\<bullet> n = c} x))) o\\<^sub>L\n      (blinfun_scaleR_left\n        (inverse\n          (f (flow0 x\n               (return_time {x \\<in> R. x \\<bullet> n = c} x)) \\<bullet>\n           n)) o\\<^sub>L\n       (blinfun_inner_left n o\\<^sub>L\n        (Dflow x\n          (return_time {x \\<in> R. x \\<bullet> n - c = 0} x) o\\<^sub>L\n         d)))))\n    \\<in> PDP", "apply (rule PDP)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (flow0 x (return_time {x \\<in> R. x \\<bullet> n = c} x),\n     Dflow x (return_time {x \\<in> R. x \\<bullet> n - c = 0} x) o\\<^sub>L d)\n    \\<in> CX\n 2. flow0 x (return_time {x \\<in> R. x \\<bullet> n = c} x) \\<bullet> n = c", "using poincare_map_returns[OF ret \\<open>closed ?P\\<close>] ret_le"], ["proof (prove)\nusing this:\n  poincare_map {x \\<in> R. x \\<bullet> n = c} x\n  \\<in> {x \\<in> R. x \\<bullet> n = c}\n  return_time {x \\<in> R. x \\<bullet> n = c} x \\<le> t\n\ngoal (2 subgoals):\n 1. (flow0 x (return_time {x \\<in> R. x \\<bullet> n = c} x),\n     Dflow x (return_time {x \\<in> R. x \\<bullet> n - c = 0} x) o\\<^sub>L d)\n    \\<in> CX\n 2. flow0 x (return_time {x \\<in> R. x \\<bullet> n = c} x) \\<bullet> n = c", "by (auto simp: poincare_map_def intro!: CX return_time_pos ret)"], ["proof (state)\nthis:\n  (poincare_map {x \\<in> R. x \\<bullet> n = c} x,\n   Dpoincare_map' n c R x o\\<^sub>L d)\n  \\<in> PDP\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "have \"eventually (returns_to ({x \\<in> R. x \\<bullet> n - c = 0})) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eventually (returns_to {x \\<in> R. x \\<bullet> n - c = 0}) (at x)", "apply (rule eventually_returns_to)"], ["proof (prove)\ngoal (7 subgoals):\n 1. returns_to {x \\<in> R. x \\<bullet> n - c = 0} x\n 2. closed R\n 3. \\<And>x.\n       ((\\<lambda>x. x \\<bullet> n - c) has_derivative\n        blinfun_apply (?Ds x))\n        (at x)\n 4. \\<And>x. isCont ?Ds x\n 5. \\<forall>\\<^sub>F x in at (poincare_map\n                                {x \\<in> R. x \\<bullet> n - c = 0} x).\n       x \\<bullet> n - c = 0 \\<longrightarrow> x \\<in> R\n 6. blinfun_apply (?Ds (poincare_map {x \\<in> R. x \\<bullet> n - c = 0} x))\n     (f (poincare_map {x \\<in> R. x \\<bullet> n - c = 0} x)) \\<noteq>\n    0\n 7. x \\<notin> R \\<or>\n    x \\<bullet> n - c \\<noteq> 0 \\<or>\n    blinfun_apply (?Ds x) (f x) \\<noteq> 0", "using PDP_nz[OF PDP] assms(2) \\<open>(x, d) \\<in> X0\\<close> cR PDP_in[OF PDP]"], ["proof (prove)\nusing this:\n  f (poincare_map {x \\<in> R. x \\<bullet> n = c} x) \\<bullet> n \\<noteq> 0\n  fst ` X0 \\<inter> {x. c \\<le> x \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  closed R\n  \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> R. x \\<bullet> n = c} x)\n     within plane n c. x \\<in> R\n\ngoal (7 subgoals):\n 1. returns_to {x \\<in> R. x \\<bullet> n - c = 0} x\n 2. closed R\n 3. \\<And>x.\n       ((\\<lambda>x. x \\<bullet> n - c) has_derivative\n        blinfun_apply (?Ds x))\n        (at x)\n 4. \\<And>x. isCont ?Ds x\n 5. \\<forall>\\<^sub>F x in at (poincare_map\n                                {x \\<in> R. x \\<bullet> n - c = 0} x).\n       x \\<bullet> n - c = 0 \\<longrightarrow> x \\<in> R\n 6. blinfun_apply (?Ds (poincare_map {x \\<in> R. x \\<bullet> n - c = 0} x))\n     (f (poincare_map {x \\<in> R. x \\<bullet> n - c = 0} x)) \\<noteq>\n    0\n 7. x \\<notin> R \\<or>\n    x \\<bullet> n - c \\<noteq> 0 \\<or>\n    blinfun_apply (?Ds x) (f x) \\<noteq> 0", "by (auto intro!: ret derivative_eq_intros blinfun_inner_left.rep_eq[symmetric]\n            simp: eventually_at_filter)"], ["proof (state)\nthis:\n  eventually (returns_to {x \\<in> R. x \\<bullet> n - c = 0}) (at x)\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "moreover"], ["proof (state)\nthis:\n  eventually (returns_to {x \\<in> R. x \\<bullet> n - c = 0}) (at x)\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "have \"return_time ?P differentiable at x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. return_time {x \\<in> R. x \\<bullet> n = c} differentiable at x", "apply (rule differentiableI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (return_time {x \\<in> R. x \\<bullet> n = c} has_derivative ?f') (at x)", "apply (rule return_time_plane_has_derivative)"], ["proof (prove)\ngoal (5 subgoals):\n 1. returns_to {x \\<in> R. x \\<bullet> n = c} x\n 2. closed R\n 3. f (poincare_map {x \\<in> R. x \\<bullet> n = c} x) \\<bullet> n \\<noteq> 0\n 4. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> R. x \\<bullet> n = c}\n                                x).\n       x \\<bullet> n = c \\<longrightarrow> x \\<in> R\n 5. x \\<notin> R \\<or> x \\<bullet> n \\<noteq> c", "using prems ret PDP_nz[OF PDP] PDP cR PDP_in[OF PDP]"], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t\n  returns_to {x \\<in> R. x \\<bullet> n = c} x\n  f (poincare_map {x \\<in> R. x \\<bullet> n = c} x) \\<bullet> n \\<noteq> 0\n  (poincare_map {x \\<in> R. x \\<bullet> n = c} x,\n   Dpoincare_map' n c R x o\\<^sub>L d)\n  \\<in> PDP\n  closed R\n  \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> R. x \\<bullet> n = c} x)\n     within plane n c. x \\<in> R\n\ngoal (5 subgoals):\n 1. returns_to {x \\<in> R. x \\<bullet> n = c} x\n 2. closed R\n 3. f (poincare_map {x \\<in> R. x \\<bullet> n = c} x) \\<bullet> n \\<noteq> 0\n 4. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> R. x \\<bullet> n = c}\n                                x).\n       x \\<bullet> n = c \\<longrightarrow> x \\<in> R\n 5. x \\<notin> R \\<or> x \\<bullet> n \\<noteq> c", "by (auto simp: eventually_at_filter)"], ["proof (state)\nthis:\n  return_time {x \\<in> R. x \\<bullet> n = c} differentiable at x\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "moreover"], ["proof (state)\nthis:\n  return_time {x \\<in> R. x \\<bullet> n = c} differentiable at x\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "have \"(\\<exists>D. (poincare_map ?P has_derivative blinfun_apply D) (at x) \\<and> (poincare_map ?P x, D o\\<^sub>L d) \\<in> PDP)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>D.\n       (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n        blinfun_apply D)\n        (at x) \\<and>\n       (poincare_map {x \\<in> R. x \\<bullet> n = c} x, D o\\<^sub>L d)\n       \\<in> PDP", "apply (intro exI[where x=\"Dpoincare_map' n c R x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n     blinfun_apply (Dpoincare_map' n c R x))\n     (at x) \\<and>\n    (poincare_map {x \\<in> R. x \\<bullet> n = c} x,\n     Dpoincare_map' n c R x o\\<^sub>L d)\n    \\<in> PDP", "using prems ret PDP_nz[OF PDP] PDP cR PDP_in[OF PDP]"], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t\n  returns_to {x \\<in> R. x \\<bullet> n = c} x\n  f (poincare_map {x \\<in> R. x \\<bullet> n = c} x) \\<bullet> n \\<noteq> 0\n  (poincare_map {x \\<in> R. x \\<bullet> n = c} x,\n   Dpoincare_map' n c R x o\\<^sub>L d)\n  \\<in> PDP\n  closed R\n  \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> R. x \\<bullet> n = c} x)\n     within plane n c. x \\<in> R\n\ngoal (1 subgoal):\n 1. (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n     blinfun_apply (Dpoincare_map' n c R x))\n     (at x) \\<and>\n    (poincare_map {x \\<in> R. x \\<bullet> n = c} x,\n     Dpoincare_map' n c R x o\\<^sub>L d)\n    \\<in> PDP", "by (auto simp: eventually_at_filter intro!: poincare_map_plane_has_derivative)"], ["proof (state)\nthis:\n  \\<exists>D.\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n      blinfun_apply D)\n      (at x) \\<and>\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} x, D o\\<^sub>L d)\n     \\<in> PDP\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "moreover"], ["proof (state)\nthis:\n  \\<exists>D.\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n      blinfun_apply D)\n      (at x) \\<and>\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} x, D o\\<^sub>L d)\n     \\<in> PDP\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "have\n        \"flow0 x h \\<in> fst ` CX \\<and> (c > flow0 x h \\<bullet> n)\"\n        if \"0 < h\" \"h < return_time ?P x\" for h"], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x h \\<in> fst ` CX \\<and> flow0 x h \\<bullet> n < c", "using CX[of h] ret that ret_le \\<open>0 < h\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < h; h \\<le> t\\<rbrakk>\n  \\<Longrightarrow> (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> CX\n  returns_to {x \\<in> R. x \\<bullet> n = c} x\n  0 < h\n  h < return_time {x \\<in> R. x \\<bullet> n = c} x\n  return_time {x \\<in> R. x \\<bullet> n = c} x \\<le> t\n  0 < h\n\ngoal (1 subgoal):\n 1. flow0 x h \\<in> fst ` CX \\<and> flow0 x h \\<bullet> n < c", "apply (auto simp: open_segment_eq_real_ivl intro!: image_eqI[where x=\"(flow0 x h, (Dflow x h) o\\<^sub>L d)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(flow0 x h, Dflow x h o\\<^sub>L d) \\<in> CX;\n     returns_to {x \\<in> R. x \\<bullet> n = c} x;\n     h < return_time {x \\<in> R. x \\<bullet> n = c} x;\n     return_time {x \\<in> R. x \\<bullet> n = c} x \\<le> t; 0 < h\\<rbrakk>\n    \\<Longrightarrow> flow0 x h \\<bullet> n < c", "using prems"], ["proof (prove)\nusing this:\n  fst ` X0 \\<inter> {xa. flow0 x t \\<bullet> n \\<le> xa \\<bullet> n} = {}\n  (x, d) \\<in> X0\n  t \\<in> existence_ivl0 x\n  (flow0 x t, Dflow x t o\\<^sub>L d) \\<in> CX\n  flow0 x t \\<in> R\n  \\<forall>h'\\<in>{0<--<t}.\n     (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX \\<and>\n     flow0 x h' \\<bullet> n < flow0 x t \\<bullet> n\n  c = flow0 x t \\<bullet> n\n  0 < t\n  t \\<le> t\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(flow0 x h, Dflow x h o\\<^sub>L d) \\<in> CX;\n     returns_to {x \\<in> R. x \\<bullet> n = c} x;\n     h < return_time {x \\<in> R. x \\<bullet> n = c} x;\n     return_time {x \\<in> R. x \\<bullet> n = c} x \\<le> t; 0 < h\\<rbrakk>\n    \\<Longrightarrow> flow0 x h \\<bullet> n < c", "by (auto simp add: open_segment_eq_real_ivl dest!: bspec[where x=t])"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?h2;\n   ?h2 < return_time {x \\<in> R. x \\<bullet> n = c} x\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?h2 \\<in> fst ` CX \\<and>\n                    flow0 x ?h2 \\<bullet> n < c\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "ultimately"], ["proof (chain)\npicking this:\n  returns_to {x \\<in> R. x \\<bullet> n = c} x\n  eventually (returns_to {x \\<in> R. x \\<bullet> n - c = 0}) (at x)\n  return_time {x \\<in> R. x \\<bullet> n = c} differentiable at x\n  \\<exists>D.\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n      blinfun_apply D)\n      (at x) \\<and>\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} x, D o\\<^sub>L d)\n     \\<in> PDP\n  \\<lbrakk>0 < ?h2;\n   ?h2 < return_time {x \\<in> R. x \\<bullet> n = c} x\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?h2 \\<in> fst ` CX \\<and>\n                    flow0 x ?h2 \\<bullet> n < c", "show ?thesis"], ["proof (prove)\nusing this:\n  returns_to {x \\<in> R. x \\<bullet> n = c} x\n  eventually (returns_to {x \\<in> R. x \\<bullet> n - c = 0}) (at x)\n  return_time {x \\<in> R. x \\<bullet> n = c} differentiable at x\n  \\<exists>D.\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n      blinfun_apply D)\n      (at x) \\<and>\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} x, D o\\<^sub>L d)\n     \\<in> PDP\n  \\<lbrakk>0 < ?h2;\n   ?h2 < return_time {x \\<in> R. x \\<bullet> n = c} x\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?h2 \\<in> fst ` CX \\<and>\n                    flow0 x ?h2 \\<bullet> n < c\n\ngoal (1 subgoal):\n 1. returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n    return_time\n     {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n    at x \\<and>\n    (\\<exists>D.\n        (poincare_map\n          {xa \\<in> R.\n           xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n}\n          x,\n         D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time\n                           {xa \\<in> R.\n                            xa \\<bullet> n = flow0 x t \\<bullet> n}\n                           x}.\n        flow0 x t \\<in> fst ` CX \\<and>\n        flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)", "unfolding prems(7)[symmetric]"], ["proof (prove)\nusing this:\n  returns_to {x \\<in> R. x \\<bullet> n = c} x\n  eventually (returns_to {x \\<in> R. x \\<bullet> n - c = 0}) (at x)\n  return_time {x \\<in> R. x \\<bullet> n = c} differentiable at x\n  \\<exists>D.\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n      blinfun_apply D)\n      (at x) \\<and>\n     (poincare_map {x \\<in> R. x \\<bullet> n = c} x, D o\\<^sub>L d)\n     \\<in> PDP\n  \\<lbrakk>0 < ?h2;\n   ?h2 < return_time {x \\<in> R. x \\<bullet> n = c} x\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?h2 \\<in> fst ` CX \\<and>\n                    flow0 x ?h2 \\<bullet> n < c\n\ngoal (1 subgoal):\n 1. returns_to {x \\<in> R. x \\<bullet> n = c} x \\<and>\n    return_time {x \\<in> R. x \\<bullet> n = c} differentiable at x \\<and>\n    (\\<exists>D.\n        (poincare_map {x \\<in> R. x \\<bullet> n = c} has_derivative\n         blinfun_apply D)\n         (at x) \\<and>\n        (poincare_map {x \\<in> R. x \\<bullet> n = c} x, D o\\<^sub>L d)\n        \\<in> PDP) \\<and>\n    (\\<forall>t\\<in>{0<..<return_time {x \\<in> R. x \\<bullet> n = c} x}.\n        flow0 x t \\<in> fst ` CX \\<and> flow0 x t \\<bullet> n < c)", "by force"], ["proof (state)\nthis:\n  returns_to {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x \\<and>\n  return_time\n   {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} differentiable\n  at x \\<and>\n  (\\<exists>D.\n      (poincare_map\n        {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} has_derivative\n       blinfun_apply D)\n       (at x) \\<and>\n      (poincare_map {xa \\<in> R. xa \\<bullet> n = flow0 x t \\<bullet> n} x,\n       D o\\<^sub>L d)\n      \\<in> PDP) \\<and>\n  (\\<forall>t\\<in>{0<..<return_time\n                         {xa \\<in> R.\n                          xa \\<bullet> n = flow0 x t \\<bullet> n}\n                         x}.\n      flow0 x t \\<in> fst ` CX \\<and>\n      flow0 x t \\<bullet> n < flow0 x t \\<bullet> n)\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  poincare_mapsto {x \\<in> R. x \\<bullet> n = c}\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   UNIV (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\n\ngoal (1 subgoal):\n 1. (\\<And>X1 X2.\n        \\<lbrakk>X0 = X1 \\<union> X2;\n         flowsto X1 {0<..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV);\n         flowsto X2 {hl..t}\n          (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n          (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV);\n         poincare_mapsto {x \\<in> R. x \\<bullet> n = c} X1 UNIV\n          (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  X0 =\n  {x \\<in> X0.\n   flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n    (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<union>\n  {x \\<in> X0.\n   flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n    (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n   {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n  poincare_mapsto {x \\<in> R. x \\<bullet> n = c}\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   UNIV (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP", "show ?thesis"], ["proof (prove)\nusing this:\n  X0 =\n  {x \\<in> X0.\n   flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n    (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)} \\<union>\n  {x \\<in> X0.\n   flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n    (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)\n  flowsto\n   {x \\<in> X0.\n    flowsto {x} {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)}\n   {hl..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n   (Y \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n  poincare_mapsto {x \\<in> R. x \\<bullet> n = c}\n   {x \\<in> X0.\n    flowsto {x} {0<..t} (CX \\<inter> {x. x \\<bullet> n < c} \\<times> UNIV)\n     (CX \\<inter> {x \\<in> R. x \\<bullet> n = c} \\<times> UNIV)}\n   UNIV (fst ` CX \\<inter> {x. x \\<bullet> n < c}) PDP\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma poincare_map_has_derivative_step:\n  assumes Deriv: \"(poincare_map P has_derivative blinfun_apply D) (at (flow0 x0 h))\"\n  assumes ret: \"returns_to P x0\"\n  assumes cont: \"continuous (at x0 within S) (return_time P)\"\n  assumes less: \"0 \\<le> h\" \"h < return_time P x0\"\n  assumes cP: \"closed P\" and x0: \"x0 \\<in> S\"\n  shows \"((\\<lambda>x. poincare_map P x) has_derivative (D o\\<^sub>L Dflow x0 h)) (at x0 within S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (poincare_map P has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)", "proof (rule has_derivative_transform_eventually)"], ["proof (state)\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "note return_time_tendsto = cont[unfolded continuous_within, rule_format]"], ["proof (state)\nthis:\n  (return_time P \\<longlongrightarrow> return_time P x0) (at x0 within S)\n\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "have \"return_time P x0 \\<in> existence_ivl0 x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. return_time P x0 \\<in> existence_ivl0 x0", "by (auto intro!: return_time_exivl cP ret)"], ["proof (state)\nthis:\n  return_time P x0 \\<in> existence_ivl0 x0\n\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "from ivl_subset_existence_ivl[OF this] less"], ["proof (chain)\npicking this:\n  {0..return_time P x0} \\<subseteq> existence_ivl0 x0\n  0 \\<le> h\n  h < return_time P x0", "have hex: \"h \\<in> existence_ivl0 x0\""], ["proof (prove)\nusing this:\n  {0..return_time P x0} \\<subseteq> existence_ivl0 x0\n  0 \\<le> h\n  h < return_time P x0\n\ngoal (1 subgoal):\n 1. h \\<in> existence_ivl0 x0", "by auto"], ["proof (state)\nthis:\n  h \\<in> existence_ivl0 x0\n\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "from eventually_mem_existence_ivl[OF this]"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at x0. h \\<in> existence_ivl0 x", "have \"\\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0. h \\<in> existence_ivl0 x\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x", "by (auto simp: eventually_at)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "have \"\\<forall>\\<^sub>F x in at x0 within S. h < return_time P x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. h < return_time P x", "apply (rule order_tendstoD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (return_time P \\<longlongrightarrow> ?y) (at x0 within S)\n 2. h < ?y", "apply (rule return_time_tendsto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. h < return_time P x0", "by (auto intro!: x0 less)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. h < return_time P x\n\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. h < return_time P x\n\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "have evret: \"eventually (returns_to P) (at x0 within S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eventually (returns_to P) (at x0 within S)", "by (rule eventually_returns_to_continuousI; fact)"], ["proof (state)\nthis:\n  eventually (returns_to P) (at x0 within S)\n\ngoal (4 subgoals):\n 1. (?f has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. \\<forall>\\<^sub>F x' in at x0 within S. ?f x' = poincare_map P x'\n 3. ?f x0 = poincare_map P x0\n 4. x0 \\<in> S", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n  \\<forall>\\<^sub>F x in at x0 within S. h < return_time P x\n  eventually (returns_to P) (at x0 within S)", "show \"\\<forall>\\<^sub>F x in at x0 within S. poincare_map P (flow0 x h) = poincare_map P x\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n  \\<forall>\\<^sub>F x in at x0 within S. h < return_time P x\n  eventually (returns_to P) (at x0 within S)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       poincare_map P (flow0 x h) = poincare_map P x", "apply eventually_elim"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x;\n        returns_to P x\\<rbrakk>\n       \\<Longrightarrow> poincare_map P (flow0 x h) = poincare_map P x", "apply (cases \"h = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x;\n        returns_to P x; h = 0\\<rbrakk>\n       \\<Longrightarrow> poincare_map P (flow0 x h) = poincare_map P x\n 2. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x;\n        returns_to P x; h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> poincare_map P (flow0 x h) = poincare_map P x", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> existence_ivl0 x_; h < return_time P x_;\n     returns_to P x_; h = 0\\<rbrakk>\n    \\<Longrightarrow> poincare_map P (flow0 x_ h) = poincare_map P x_", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x;\n        returns_to P x; h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> poincare_map P (flow0 x h) = poincare_map P x", "subgoal for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> poincare_map P (flow0 x h) = poincare_map P x", "apply (rule poincare_map_step_flow)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to P x\n 2. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> closed P\n 3. \\<And>s.\n       \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x;\n        returns_to P x; h \\<noteq> 0; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x s \\<notin> P\n 4. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 5. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x", "using \\<open>0 \\<le> h\\<close> return_time_least[of P x ]"], ["proof (prove)\nusing this:\n  0 \\<le> h\n  \\<lbrakk>returns_to P x; closed P; 0 < ?s; ?s < return_time P x\\<rbrakk>\n  \\<Longrightarrow> flow0 x ?s \\<notin> P\n\ngoal (5 subgoals):\n 1. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to P x\n 2. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> closed P\n 3. \\<And>s.\n       \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x;\n        returns_to P x; h \\<noteq> 0; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x s \\<notin> P\n 4. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 5. \\<lbrakk>h \\<in> existence_ivl0 x; h < return_time P x; returns_to P x;\n     h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x", "by (auto simp: \\<open>closed P\\<close>)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     poincare_map P (flow0 x h) = poincare_map P x\n\ngoal (3 subgoals):\n 1. ((\\<lambda>x. poincare_map P (flow0 x h)) has_derivative\n     blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. poincare_map P (flow0 x0 h) = poincare_map P x0\n 3. x0 \\<in> S", "show \"poincare_map P (flow0 x0 h) = poincare_map P x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. poincare_map P (flow0 x0 h) = poincare_map P x0", "using less ret x0 cP hex"], ["proof (prove)\nusing this:\n  0 \\<le> h\n  h < return_time P x0\n  returns_to P x0\n  x0 \\<in> S\n  closed P\n  h \\<in> existence_ivl0 x0\n\ngoal (1 subgoal):\n 1. poincare_map P (flow0 x0 h) = poincare_map P x0", "apply (cases \"h = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h = 0\\<rbrakk>\n    \\<Longrightarrow> poincare_map P (flow0 x0 h) = poincare_map P x0\n 2. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> poincare_map P (flow0 x0 h) = poincare_map P x0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h = 0\\<rbrakk>\n    \\<Longrightarrow> poincare_map P (flow0 x0 h) = poincare_map P x0", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> poincare_map P (flow0 x0 h) = poincare_map P x0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> poincare_map P (flow0 x0 h) = poincare_map P x0", "apply (rule poincare_map_step_flow)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to P x0\n 2. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> closed P\n 3. \\<And>s.\n       \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0;\n        x0 \\<in> S; closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0;\n        0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> P\n 4. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 5. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0", "using \\<open>0 \\<le> h\\<close> return_time_least[of P x0] ret"], ["proof (prove)\nusing this:\n  0 \\<le> h\n  \\<lbrakk>returns_to P x0; closed P; 0 < ?s; ?s < return_time P x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?s \\<notin> P\n  returns_to P x0\n\ngoal (5 subgoals):\n 1. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to P x0\n 2. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> closed P\n 3. \\<And>s.\n       \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0;\n        x0 \\<in> S; closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0;\n        0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> P\n 4. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 5. \\<lbrakk>0 \\<le> h; h < return_time P x0; returns_to P x0; x0 \\<in> S;\n     closed P; h \\<in> existence_ivl0 x0; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0", "by (auto simp: \\<open>closed P\\<close>)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  poincare_map P (flow0 x0 h) = poincare_map P x0\n\ngoal (2 subgoals):\n 1. ((\\<lambda>x. poincare_map P (flow0 x h)) has_derivative\n     blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. x0 \\<in> S", "show \"x0 \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x0 \\<in> S", "by fact"], ["proof (state)\nthis:\n  x0 \\<in> S\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. poincare_map P (flow0 x h)) has_derivative\n     blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)", "show \"((\\<lambda>x. poincare_map P (flow0 x h)) has_derivative blinfun_apply (D o\\<^sub>L Dflow x0 h)) (at x0 within S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. poincare_map P (flow0 x h)) has_derivative\n     blinfun_apply (D o\\<^sub>L Dflow x0 h))\n     (at x0 within S)", "apply (rule has_derivative_compose[where g=\"poincare_map P\" and f=\"\\<lambda>x. flow0 x h\", OF _ Deriv,\n        THEN has_derivative_eq_rhs])"], ["proof (prove)\ngoal (2 subgoals):\n 1. ((\\<lambda>x. flow0 x h) has_derivative ?f'1) (at x0 within S)\n 2. (\\<lambda>x. blinfun_apply D (?f'1 x)) =\n    blinfun_apply (D o\\<^sub>L Dflow x0 h)", "by (auto intro!: derivative_eq_intros simp: hex flowderiv_def)"], ["proof (state)\nthis:\n  ((\\<lambda>x. poincare_map P (flow0 x h)) has_derivative\n   blinfun_apply (D o\\<^sub>L Dflow x0 h))\n   (at x0 within S)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma poincare_mapsto_trans:\n  assumes \"poincare_mapsto p1 X0 S    CX P1\"\n  assumes \"poincare_mapsto p2 P1 UNIV CY P2\"\n  assumes \"CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\"\n  assumes \"p2 \\<inter> (CX \\<union> fst ` P1) = {}\"\n  assumes [intro, simp]: \"closed p1\"\n  assumes [intro, simp]: \"closed p2\"\n  assumes cont: \"\\<And>x d. (x, d) \\<in> X0 \\<Longrightarrow> continuous (at x within S) (return_time p2)\"\n  shows \"poincare_mapsto p2 X0 S CZ P2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. poincare_mapsto p2 X0 S CZ P2", "unfolding poincare_mapsto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(x, d)\\<in>X0.\n       returns_to p2 x \\<and>\n       fst ` X0 \\<subseteq> S \\<and>\n       return_time p2 differentiable at x within S \\<and>\n       (\\<exists>D.\n           (poincare_map p2 has_derivative blinfun_apply D)\n            (at x within S) \\<and>\n           (poincare_map p2 x, D o\\<^sub>L d) \\<in> P2) \\<and>\n       (\\<forall>t\\<in>{0<..<return_time p2 x}. flow0 x t \\<in> CZ)", "proof (auto, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "fix x0 d0"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "assume x0: \"(x0, d0) \\<in> X0\""], ["proof (state)\nthis:\n  (x0, d0) \\<in> X0\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from assms(1) x0"], ["proof (chain)\npicking this:\n  poincare_mapsto p1 X0 S CX P1\n  (x0, d0) \\<in> X0", "obtain D1 dR1 where 1:\n    \"returns_to p1 x0\"\n    \"fst ` X0 \\<subseteq> S\"\n    \"(return_time p1 has_derivative dR1) (at x0 within S)\"\n    \"(poincare_map p1 has_derivative blinfun_apply D1) (at x0 within S)\"\n    \"(poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1\"\n    \"\\<And>t. 0 < t \\<Longrightarrow> t < return_time p1 x0 \\<Longrightarrow> flow0 x0 t \\<in> CX\""], ["proof (prove)\nusing this:\n  poincare_mapsto p1 X0 S CX P1\n  (x0, d0) \\<in> X0\n\ngoal (1 subgoal):\n 1. (\\<And>dR1 D1.\n        \\<lbrakk>returns_to p1 x0; fst ` X0 \\<subseteq> S;\n         (return_time p1 has_derivative dR1) (at x0 within S);\n         (poincare_map p1 has_derivative blinfun_apply D1) (at x0 within S);\n         (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1;\n         \\<And>t.\n            \\<lbrakk>0 < t; t < return_time p1 x0\\<rbrakk>\n            \\<Longrightarrow> flow0 x0 t \\<in> CX\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: poincare_mapsto_def differentiable_def)"], ["proof (state)\nthis:\n  returns_to p1 x0\n  fst ` X0 \\<subseteq> S\n  (return_time p1 has_derivative dR1) (at x0 within S)\n  (poincare_map p1 has_derivative blinfun_apply D1) (at x0 within S)\n  (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1\n  \\<lbrakk>0 < ?t2; ?t2 < return_time p1 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t2 \\<in> CX\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  returns_to p1 x0\n  fst ` X0 \\<subseteq> S\n  (return_time p1 has_derivative dR1) (at x0 within S)\n  (poincare_map p1 has_derivative blinfun_apply D1) (at x0 within S)\n  (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1\n  \\<lbrakk>0 < ?t2; ?t2 < return_time p1 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t2 \\<in> CX", "have crt1: \"continuous (at x0 within S) (return_time p1)\""], ["proof (prove)\nusing this:\n  returns_to p1 x0\n  fst ` X0 \\<subseteq> S\n  (return_time p1 has_derivative dR1) (at x0 within S)\n  (poincare_map p1 has_derivative blinfun_apply D1) (at x0 within S)\n  (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1\n  \\<lbrakk>0 < ?t2; ?t2 < return_time p1 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t2 \\<in> CX\n\ngoal (1 subgoal):\n 1. continuous (at x0 within S) (return_time p1)", "by (auto intro!: has_derivative_continuous)"], ["proof (state)\nthis:\n  continuous (at x0 within S) (return_time p1)\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "show \"x0 \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x0 \\<in> S", "using 1 x0"], ["proof (prove)\nusing this:\n  returns_to p1 x0\n  fst ` X0 \\<subseteq> S\n  (return_time p1 has_derivative dR1) (at x0 within S)\n  (poincare_map p1 has_derivative blinfun_apply D1) (at x0 within S)\n  (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1\n  \\<lbrakk>0 < ?t2; ?t2 < return_time p1 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t2 \\<in> CX\n  (x0, d0) \\<in> X0\n\ngoal (1 subgoal):\n 1. x0 \\<in> S", "by auto"], ["proof (state)\nthis:\n  x0 \\<in> S\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "let ?x0 = \"poincare_map p1 x0\""], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from assms(2) x0 \\<open>_ \\<in> P1\\<close>"], ["proof (chain)\npicking this:\n  poincare_mapsto p2 P1 UNIV CY P2\n  (x0, d0) \\<in> X0\n  (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1", "obtain D2 dR2 where 2:\n    \"returns_to p2 ?x0\"\n    \"(return_time p2 has_derivative dR2) (at ?x0)\"\n    \"(poincare_map p2 has_derivative blinfun_apply D2) (at ?x0)\"\n    \"(poincare_map p2 ?x0, D2 o\\<^sub>L (D1 o\\<^sub>L d0)) \\<in> P2\"\n    \"\\<And>t. t\\<in>{0<..<return_time p2 ?x0} \\<Longrightarrow> flow0 ?x0 t \\<in> CY\""], ["proof (prove)\nusing this:\n  poincare_mapsto p2 P1 UNIV CY P2\n  (x0, d0) \\<in> X0\n  (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1\n\ngoal (1 subgoal):\n 1. (\\<And>dR2 D2.\n        \\<lbrakk>returns_to p2 (poincare_map p1 x0);\n         (return_time p2 has_derivative dR2) (at (poincare_map p1 x0));\n         (poincare_map p2 has_derivative blinfun_apply D2)\n          (at (poincare_map p1 x0));\n         (poincare_map p2 (poincare_map p1 x0),\n          D2 o\\<^sub>L (D1 o\\<^sub>L d0))\n         \\<in> P2;\n         \\<And>t.\n            t \\<in> {0<..<return_time p2\n                           (poincare_map p1 x0)} \\<Longrightarrow>\n            flow0 (poincare_map p1 x0) t \\<in> CY\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: poincare_mapsto_def differentiable_def)"], ["proof (state)\nthis:\n  returns_to p2 (poincare_map p1 x0)\n  (return_time p2 has_derivative dR2) (at (poincare_map p1 x0))\n  (poincare_map p2 has_derivative blinfun_apply D2)\n   (at (poincare_map p1 x0))\n  (poincare_map p2 (poincare_map p1 x0), D2 o\\<^sub>L (D1 o\\<^sub>L d0))\n  \\<in> P2\n  ?t2 \\<in> {0<..<return_time p2 (poincare_map p1 x0)} \\<Longrightarrow>\n  flow0 (poincare_map p1 x0) ?t2 \\<in> CY\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"\\<forall>\\<^sub>F t in at_right 0. t < return_time p1 x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0. t < return_time p1 x0", "by (rule order_tendstoD) (auto intro!: return_time_pos 1)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0. t < return_time p1 x0\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0. t < return_time p1 x0\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"\\<forall>\\<^sub>F t in at_right 0. 0 < t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eventually ((<) (0::'c)) (at_right (0::'c))", "by (auto simp: eventually_at_filter)"], ["proof (state)\nthis:\n  eventually ((<) (0::?'c3)) (at_right (0::?'c3))\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F t in at_right 0. t < return_time p1 x0\n  eventually ((<) (0::?'c3)) (at_right (0::?'c3))", "have evnotp2: \"\\<forall>\\<^sub>F t in at_right 0. flow0 x0 t \\<notin> p2\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F t in at_right 0. t < return_time p1 x0\n  eventually ((<) (0::?'c3)) (at_right (0::?'c3))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0. flow0 x0 t \\<notin> p2", "by eventually_elim (use assms 1 in auto)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0. flow0 x0 t \\<notin> p2\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from 2(1)"], ["proof (chain)\npicking this:\n  returns_to p2 (poincare_map p1 x0)", "show ret2: \"returns_to p2 x0\""], ["proof (prove)\nusing this:\n  returns_to p2 (poincare_map p1 x0)\n\ngoal (1 subgoal):\n 1. returns_to p2 x0", "unfolding poincare_map_def"], ["proof (prove)\nusing this:\n  returns_to p2 (flow0 x0 (return_time p1 x0))\n\ngoal (1 subgoal):\n 1. returns_to p2 x0", "by (rule returns_to_earlierI)\n       (use evnotp2 in \\<open>auto intro!: less_imp_le return_time_pos 1 return_time_exivl\\<close>)"], ["proof (state)\nthis:\n  returns_to p2 x0\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have not_p2: \"0 < t \\<Longrightarrow> t \\<le> return_time p1 x0 \\<Longrightarrow> flow0 x0 t \\<notin> p2\" for t"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<notin> p2", "using 1(5) 1(6)[of t] assms(4)"], ["proof (prove)\nusing this:\n  (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1\n  \\<lbrakk>0 < t; t < return_time p1 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 t \\<in> CX\n  p2 \\<inter> (CX \\<union> fst ` P1) = {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<notin> p2", "by (force simp: poincare_map_def set_eq_iff)"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?t3; ?t3 \\<le> return_time p1 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t3 \\<notin> p2\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have pm_eq: \"poincare_map p2 x0 = poincare_map p2 (poincare_map p1 x0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. poincare_map p2 x0 = poincare_map p2 (poincare_map p1 x0)", "using not_p2"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < ?t3; ?t3 \\<le> return_time p1 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t3 \\<notin> p2\n\ngoal (1 subgoal):\n 1. poincare_map p2 x0 = poincare_map p2 (poincare_map p1 x0)", "apply (auto simp: poincare_map_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    flow0 x0 (return_time p2 x0) =\n    flow0 (flow0 x0 (return_time p1 x0))\n     (return_time p2 (flow0 x0 (return_time p1 x0)))", "apply (subst flow_trans[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    return_time p1 x0 \\<in> existence_ivl0 x0\n 2. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    return_time p2 (flow0 x0 (return_time p1 x0))\n    \\<in> existence_ivl0 (flow0 x0 (return_time p1 x0))\n 3. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    flow0 x0 (return_time p2 x0) =\n    flow0 x0\n     (return_time p1 x0 + return_time p2 (flow0 x0 (return_time p1 x0)))", "apply (auto intro!: return_time_exivl 1 2[unfolded poincare_map_def])"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    flow0 x0 (return_time p2 x0) =\n    flow0 x0\n     (return_time p1 x0 + return_time p2 (flow0 x0 (return_time p1 x0)))", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    returns_to p2 (flow0 x0 (return_time p1 x0))\n 2. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    closed p2\n 3. \\<And>s.\n       \\<lbrakk>\\<And>t.\n                   \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n                   \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n        0 < s; s \\<le> return_time p1 x0\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 4. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    0 < return_time p1 x0\n 5. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    return_time p1 x0 \\<in> existence_ivl0 x0\n 6. (\\<And>t.\n        \\<lbrakk>0 < t; t \\<le> return_time p1 x0\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2) \\<Longrightarrow>\n    flow0 x0 (return_time p2 x0) =\n    flow0 x0 (return_time p1 x0 + (return_time p2 x0 - return_time p1 x0))", "by (auto simp: return_time_step\n        intro!: return_time_exivl 1 2[unfolded poincare_map_def] return_time_pos)"], ["proof (state)\nthis:\n  poincare_map p2 x0 = poincare_map p2 (poincare_map p1 x0)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have evret2: \"\\<forall>\\<^sub>F x in at ?x0. returns_to p2 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eventually (returns_to p2) (at (poincare_map p1 x0))", "by (auto intro!: eventually_returns_to_continuousI 2 has_derivative_continuous)"], ["proof (state)\nthis:\n  eventually (returns_to p2) (at (poincare_map p1 x0))\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have evret1: \"\\<forall>\\<^sub>F x in at x0 within S. returns_to p1 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eventually (returns_to p1) (at x0 within S)", "by (auto intro!: eventually_returns_to_continuousI 1 has_derivative_continuous)"], ["proof (state)\nthis:\n  eventually (returns_to p1) (at x0 within S)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "moreover"], ["proof (state)\nthis:\n  eventually (returns_to p1) (at x0 within S)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from evret2[unfolded eventually_at_topological] 2(1)"], ["proof (chain)\npicking this:\n  \\<exists>S.\n     open S \\<and>\n     poincare_map p1 x0 \\<in> S \\<and>\n     (\\<forall>x\\<in>S.\n         x \\<noteq> poincare_map p1 x0 \\<longrightarrow>\n         x \\<in> UNIV \\<longrightarrow> returns_to p2 x)\n  returns_to p2 (poincare_map p1 x0)", "obtain U where U: \"open U\" \"poincare_map p1 x0 \\<in> U\" \"\\<And>x. x \\<in> U \\<Longrightarrow> returns_to p2 x\""], ["proof (prove)\nusing this:\n  \\<exists>S.\n     open S \\<and>\n     poincare_map p1 x0 \\<in> S \\<and>\n     (\\<forall>x\\<in>S.\n         x \\<noteq> poincare_map p1 x0 \\<longrightarrow>\n         x \\<in> UNIV \\<longrightarrow> returns_to p2 x)\n  returns_to p2 (poincare_map p1 x0)\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>open U; poincare_map p1 x0 \\<in> U;\n         \\<And>x. x \\<in> U \\<Longrightarrow> returns_to p2 x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  open U\n  poincare_map p1 x0 \\<in> U\n  ?x3 \\<in> U \\<Longrightarrow> returns_to p2 ?x3\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"continuous (at x0 within S) (poincare_map p1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous (at x0 within S) (poincare_map p1)", "by (rule has_derivative_continuous) (rule 1)"], ["proof (state)\nthis:\n  continuous (at x0 within S) (poincare_map p1)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "note [tendsto_intros] = this[unfolded continuous_within]"], ["proof (state)\nthis:\n  (poincare_map p1 \\<longlongrightarrow> poincare_map p1 x0)\n   (at x0 within S)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"eventually (\\<lambda>x. poincare_map p1 x \\<in> U) (at x0 within S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. poincare_map p1 x \\<in> U", "by (rule topological_tendstoD) (auto intro!: tendsto_eq_intros U)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. poincare_map p1 x \\<in> U\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at x0 within S. poincare_map p1 x \\<in> U", "have evret_flow: \"\\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x (return_time p1 x))\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S. poincare_map p1 x \\<in> U\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       returns_to p2 (flow0 x (return_time p1 x))", "unfolding poincare_map_def[symmetric]"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S. poincare_map p1 x \\<in> U\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (poincare_map p1 x)", "apply eventually_elim"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       poincare_map p1 x \\<in> U \\<Longrightarrow>\n       returns_to p2 (poincare_map p1 x)", "apply (rule U)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       poincare_map p1 x \\<in> U \\<Longrightarrow> poincare_map p1 x \\<in> U", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     returns_to p2 (flow0 x (return_time p1 x))\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     returns_to p2 (flow0 x (return_time p1 x))\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have h_less_rt: \"return_time p1 x0 < return_time p2 x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. return_time p1 x0 < return_time p2 x0", "by (rule return_time_gt; fact)"], ["proof (state)\nthis:\n  return_time p1 x0 < return_time p2 x0\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  return_time p1 x0 < return_time p2 x0", "have \"0 < return_time p2 x0 - return_time p1 x0\""], ["proof (prove)\nusing this:\n  return_time p1 x0 < return_time p2 x0\n\ngoal (1 subgoal):\n 1. 0 < return_time p2 x0 - return_time p1 x0", "by (simp )"], ["proof (state)\nthis:\n  0 < return_time p2 x0 - return_time p1 x0\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from _ this"], ["proof (chain)\npicking this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  0 < return_time p2 x0 - return_time p1 x0", "have \"\\<forall>\\<^sub>F x in at x0 within S. 0 < return_time p2 x - return_time p1 x\""], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  0 < return_time p2 x0 - return_time p1 x0\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       0 < return_time p2 x - return_time p1 x", "apply (rule order_tendstoD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. return_time p2 x - return_time p1 x) \\<longlongrightarrow>\n     return_time p2 x0 - return_time p1 x0)\n     (at x0 within S)", "using cont \\<open>(x0, _) \\<in> _\\<close>"], ["proof (prove)\nusing this:\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  (x0, d0) \\<in> X0\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. return_time p2 x - return_time p1 x) \\<longlongrightarrow>\n     return_time p2 x0 - return_time p1 x0)\n     (at x0 within S)", "by (auto intro!: tendsto_eq_intros crt1 simp: continuous_within[symmetric] continuous_on_def)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     0 < return_time p2 x - return_time p1 x\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     0 < return_time p2 x - return_time p1 x", "have evpm2: \"\\<forall>\\<^sub>F x in at x0 within S. \\<forall>s. 0 < s \\<longrightarrow> s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     0 < return_time p2 x - return_time p1 x\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       \\<forall>s>0.\n          s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2", "apply eventually_elim"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < return_time p2 x - return_time p1 x \\<Longrightarrow>\n       \\<forall>s>0.\n          s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2", "apply safe"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>0 < return_time p2 x - return_time p1 x; 0 < s;\n        s \\<le> return_time p1 x; flow0 x s \\<in> p2\\<rbrakk>\n       \\<Longrightarrow> False", "subgoal for x s"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < return_time p2 x - return_time p1 x; 0 < s;\n     s \\<le> return_time p1 x; flow0 x s \\<in> p2\\<rbrakk>\n    \\<Longrightarrow> False", "using return_time_least[of p2 x s]"], ["proof (prove)\nusing this:\n  \\<lbrakk>returns_to p2 x; closed p2; 0 < s; s < return_time p2 x\\<rbrakk>\n  \\<Longrightarrow> flow0 x s \\<notin> p2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < return_time p2 x - return_time p1 x; 0 < s;\n     s \\<le> return_time p1 x; flow0 x s \\<in> p2\\<rbrakk>\n    \\<Longrightarrow> False", "by (auto simp add: return_time_pos_returns_to)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     \\<forall>s>0.\n        s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "ultimately"], ["proof (chain)\npicking this:\n  eventually (returns_to p1) (at x0 within S)\n  \\<forall>\\<^sub>F x in at x0 within S.\n     returns_to p2 (flow0 x (return_time p1 x))\n  \\<forall>\\<^sub>F x in at x0 within S.\n     \\<forall>s>0.\n        s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2", "have pm_eq_at: \"\\<forall>\\<^sub>F x in at x0 within S.\n    poincare_map p2 (poincare_map p1 x) = poincare_map p2 x\""], ["proof (prove)\nusing this:\n  eventually (returns_to p1) (at x0 within S)\n  \\<forall>\\<^sub>F x in at x0 within S.\n     returns_to p2 (flow0 x (return_time p1 x))\n  \\<forall>\\<^sub>F x in at x0 within S.\n     \\<forall>s>0.\n        s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       poincare_map p2 (poincare_map p1 x) = poincare_map p2 x", "apply (eventually_elim)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> poincare_map p2 (poincare_map p1 x) =\n                         poincare_map p2 x", "apply (auto simp: poincare_map_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> flow0 (flow0 x (return_time p1 x))\n                          (return_time p2 (flow0 x (return_time p1 x))) =\n                         flow0 x (return_time p2 x)", "apply (subst flow_trans[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> return_time p1 x \\<in> existence_ivl0 x\n 2. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> return_time p2 (flow0 x (return_time p1 x))\n                         \\<in> existence_ivl0 (flow0 x (return_time p1 x))\n 3. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> flow0 x\n                          (return_time p1 x +\n                           return_time p2 (flow0 x (return_time p1 x))) =\n                         flow0 x (return_time p2 x)", "apply (auto intro!: return_time_exivl)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> flow0 x\n                          (return_time p1 x +\n                           return_time p2 (flow0 x (return_time p1 x))) =\n                         flow0 x (return_time p2 x)", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> returns_to p2 (flow0 x (return_time p1 x))\n 2. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> closed p2\n 3. \\<And>x s.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2;\n        0 < s; s \\<le> return_time p1 x\\<rbrakk>\n       \\<Longrightarrow> flow0 x s \\<notin> p2\n 4. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> 0 < return_time p1 x\n 5. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> return_time p1 x \\<in> existence_ivl0 x\n 6. \\<And>x.\n       \\<lbrakk>returns_to p1 x; returns_to p2 (flow0 x (return_time p1 x));\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> flow0 x\n                          (return_time p1 x +\n                           (return_time p2 x - return_time p1 x)) =\n                         flow0 x (return_time p2 x)", "by (auto simp: return_time_step\n        intro!: return_time_exivl return_time_pos)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     poincare_map p2 (poincare_map p1 x) = poincare_map p2 x\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from _ this"], ["proof (chain)\npicking this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  \\<forall>\\<^sub>F x in at x0 within S.\n     poincare_map p2 (poincare_map p1 x) = poincare_map p2 x", "have \"(poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L D1)) (at x0 within S)\""], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  \\<forall>\\<^sub>F x in at x0 within S.\n     poincare_map p2 (poincare_map p1 x) = poincare_map p2 x\n\ngoal (1 subgoal):\n 1. (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L D1))\n     (at x0 within S)", "apply (rule has_derivative_transform_eventually)"], ["proof (prove)\ngoal (3 subgoals):\n 1. ((\\<lambda>x. poincare_map p2 (poincare_map p1 x)) has_derivative\n     blinfun_apply (D2 o\\<^sub>L D1))\n     (at x0 within S)\n 2. poincare_map p2 (poincare_map p1 x0) = poincare_map p2 x0\n 3. x0 \\<in> S", "apply (rule has_derivative_compose[OF 1(4) 2(3), THEN has_derivative_eq_rhs])"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<lambda>x. blinfun_apply D2 (blinfun_apply D1 x)) =\n    blinfun_apply (D2 o\\<^sub>L D1)\n 2. poincare_map p2 (poincare_map p1 x0) = poincare_map p2 x0\n 3. x0 \\<in> S", "by (auto simp: \\<open>x0 \\<in> S\\<close> pm_eq)"], ["proof (state)\nthis:\n  (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L D1))\n   (at x0 within S)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "moreover"], ["proof (state)\nthis:\n  (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L D1))\n   (at x0 within S)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"(poincare_map p2 x0, (D2 o\\<^sub>L D1) o\\<^sub>L d0) \\<in> P2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (poincare_map p2 x0, D2 o\\<^sub>L D1 o\\<^sub>L d0) \\<in> P2", "using 2(4)"], ["proof (prove)\nusing this:\n  (poincare_map p2 (poincare_map p1 x0), D2 o\\<^sub>L (D1 o\\<^sub>L d0))\n  \\<in> P2\n\ngoal (1 subgoal):\n 1. (poincare_map p2 x0, D2 o\\<^sub>L D1 o\\<^sub>L d0) \\<in> P2", "unfolding pm_eq blinfun_compose_assoc"], ["proof (prove)\nusing this:\n  (poincare_map p2 (poincare_map p1 x0), D2 o\\<^sub>L (D1 o\\<^sub>L d0))\n  \\<in> P2\n\ngoal (1 subgoal):\n 1. (poincare_map p2 (poincare_map p1 x0), D2 o\\<^sub>L (D1 o\\<^sub>L d0))\n    \\<in> P2", "."], ["proof (state)\nthis:\n  (poincare_map p2 x0, D2 o\\<^sub>L D1 o\\<^sub>L d0) \\<in> P2\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "ultimately"], ["proof (chain)\npicking this:\n  (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L D1))\n   (at x0 within S)\n  (poincare_map p2 x0, D2 o\\<^sub>L D1 o\\<^sub>L d0) \\<in> P2", "show \"\\<exists>D. (poincare_map p2 has_derivative blinfun_apply D) (at x0 within S) \\<and>\n               (poincare_map p2 x0, D o\\<^sub>L d0) \\<in> P2\""], ["proof (prove)\nusing this:\n  (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L D1))\n   (at x0 within S)\n  (poincare_map p2 x0, D2 o\\<^sub>L D1 o\\<^sub>L d0) \\<in> P2\n\ngoal (1 subgoal):\n 1. \\<exists>D.\n       (poincare_map p2 has_derivative blinfun_apply D)\n        (at x0 within S) \\<and>\n       (poincare_map p2 x0, D o\\<^sub>L d0) \\<in> P2", "by auto"], ["proof (state)\nthis:\n  \\<exists>D.\n     (poincare_map p2 has_derivative blinfun_apply D)\n      (at x0 within S) \\<and>\n     (poincare_map p2 x0, D o\\<^sub>L d0) \\<in> P2\n\ngoal (2 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "show \"0 < t \\<Longrightarrow> t < return_time p2 x0 \\<Longrightarrow> flow0 x0 t \\<in> CZ\" for t"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "apply (cases \"t < return_time p1 x0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; t < return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ\n 2. \\<lbrakk>0 < t; t < return_time p2 x0;\n     \\<not> t < return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; t < return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "apply (drule 1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t < return_time p2 x0; t < return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> t < return_time p1 x0\n 2. \\<lbrakk>t < return_time p2 x0; t < return_time p1 x0;\n     flow0 x0 t \\<in> CX\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "using assms"], ["proof (prove)\nusing this:\n  poincare_mapsto p1 X0 S CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (CX \\<union> fst ` P1) = {}\n  closed p1\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>t < return_time p2 x0; t < return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> t < return_time p1 x0\n 2. \\<lbrakk>t < return_time p2 x0; t < return_time p1 x0;\n     flow0 x0 t \\<in> CX\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0;\n     \\<not> t < return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0;\n     \\<not> t < return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "apply (cases \"t = return_time p1 x0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < return_time p1 x0;\n     t = return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ\n 2. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < return_time p1 x0;\n     t \\<noteq> return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < return_time p1 x0;\n     t = return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "using 1(5) assms"], ["proof (prove)\nusing this:\n  (poincare_map p1 x0, D1 o\\<^sub>L d0) \\<in> P1\n  poincare_mapsto p1 X0 S CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (CX \\<union> fst ` P1) = {}\n  closed p1\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < return_time p1 x0;\n     t = return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "by (auto simp: poincare_map_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < return_time p1 x0;\n     t \\<noteq> return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "subgoal premises prems"], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "have \"flow0 x0 t = flow0 ?x0 (t - return_time p1 x0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x0 t = flow0 (poincare_map p1 x0) (t - return_time p1 x0)", "unfolding poincare_map_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x0 t =\n    flow0 (flow0 x0 (return_time p1 x0)) (t - return_time p1 x0)", "apply (subst flow_trans[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. return_time p1 x0 \\<in> existence_ivl0 x0\n 2. t - return_time p1 x0\n    \\<in> existence_ivl0 (flow0 x0 (return_time p1 x0))\n 3. flow0 x0 t = flow0 x0 (return_time p1 x0 + (t - return_time p1 x0))", "using prems"], ["proof (prove)\nusing this:\n  0 < t\n  t < return_time p2 x0\n  \\<not> t < return_time p1 x0\n  t \\<noteq> return_time p1 x0\n\ngoal (3 subgoals):\n 1. return_time p1 x0 \\<in> existence_ivl0 x0\n 2. t - return_time p1 x0\n    \\<in> existence_ivl0 (flow0 x0 (return_time p1 x0))\n 3. flow0 x0 t = flow0 x0 (return_time p1 x0 + (t - return_time p1 x0))", "by (auto simp:\n              intro!: return_time_exivl 1 diff_existence_ivl_trans\n              less_return_time_imp_exivl[OF _ ret2])"], ["proof (state)\nthis:\n  flow0 x0 t = flow0 (poincare_map p1 x0) (t - return_time p1 x0)\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "also"], ["proof (state)\nthis:\n  flow0 x0 t = flow0 (poincare_map p1 x0) (t - return_time p1 x0)\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "have \"\\<dots> \\<in> CY\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 (poincare_map p1 x0) (t - return_time p1 x0) \\<in> CY", "apply (rule 2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. t - return_time p1 x0 \\<in> {0<..<return_time p2 (poincare_map p1 x0)}", "using prems"], ["proof (prove)\nusing this:\n  0 < t\n  t < return_time p2 x0\n  \\<not> t < return_time p1 x0\n  t \\<noteq> return_time p1 x0\n\ngoal (1 subgoal):\n 1. t - return_time p1 x0 \\<in> {0<..<return_time p2 (poincare_map p1 x0)}", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < return_time p1 x0;\n     t \\<noteq> return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> t - return_time p1 x0\n                      < return_time p2 (poincare_map p1 x0)", "using \"1\"(1) \"2\"(1) assms poincare_map_def ret2 return_time_exivl\n            return_time_least return_time_pos return_time_step"], ["proof (prove)\nusing this:\n  returns_to p1 x0\n  returns_to p2 (poincare_map p1 x0)\n  poincare_mapsto p1 X0 S CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (CX \\<union> fst ` P1) = {}\n  closed p1\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  poincare_map ?P ?x = flow0 ?x (return_time ?P ?x)\n  returns_to p2 x0\n  \\<lbrakk>returns_to ?P ?x; closed ?P\\<rbrakk>\n  \\<Longrightarrow> return_time ?P ?x \\<in> existence_ivl0 ?x\n  \\<lbrakk>returns_to ?P ?x; closed ?P; 0 < ?s;\n   ?s < return_time ?P ?x\\<rbrakk>\n  \\<Longrightarrow> flow0 ?x ?s \\<notin> ?P\n  \\<lbrakk>returns_to ?P ?x; closed ?P\\<rbrakk>\n  \\<Longrightarrow> 0 < return_time ?P ?x\n  \\<lbrakk>returns_to ?P (flow0 ?x ?t); closed ?P;\n   \\<And>s.\n      \\<lbrakk>0 < s; s \\<le> ?t\\<rbrakk>\n      \\<Longrightarrow> flow0 ?x s \\<notin> ?P;\n   0 < ?t; ?t \\<in> existence_ivl0 ?x\\<rbrakk>\n  \\<Longrightarrow> return_time ?P (flow0 ?x ?t) = return_time ?P ?x - ?t\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < return_time p1 x0;\n     t \\<noteq> return_time p1 x0\\<rbrakk>\n    \\<Longrightarrow> t - return_time p1 x0\n                      < return_time p2 (poincare_map p1 x0)", "by auto"], ["proof (state)\nthis:\n  flow0 (poincare_map p1 x0) (t - return_time p1 x0) \\<in> CY\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "also"], ["proof (state)\nthis:\n  flow0 (poincare_map p1 x0) (t - return_time p1 x0) \\<in> CY\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "have \"\\<dots> \\<subseteq> CZ\""], ["proof (prove)\ngoal (1 subgoal):\n 1. CY \\<subseteq> CZ", "using assms"], ["proof (prove)\nusing this:\n  poincare_mapsto p1 X0 S CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (CX \\<union> fst ` P1) = {}\n  closed p1\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n\ngoal (1 subgoal):\n 1. CY \\<subseteq> CZ", "by auto"], ["proof (state)\nthis:\n  CY \\<subseteq> CZ\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "finally"], ["proof (chain)\npicking this:\n  flow0 x0 t \\<in> CZ", "show \"flow0 x0 t \\<in> CZ\""], ["proof (prove)\nusing this:\n  flow0 x0 t \\<in> CZ\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "by simp"], ["proof (state)\nthis:\n  flow0 x0 t \\<in> CZ\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?t3; ?t3 < return_time p2 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t3 \\<in> CZ\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S", "have rt_eq: \"return_time p2 (poincare_map p1 x0) + return_time p1 x0 = return_time p2 x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. return_time p2 (poincare_map p1 x0) + return_time p1 x0 =\n    return_time p2 x0", "apply (auto simp: poincare_map_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. return_time p2 (flow0 x0 (return_time p1 x0)) + return_time p1 x0 =\n    return_time p2 x0", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. returns_to p2 (flow0 x0 (return_time p1 x0))\n 2. closed p2\n 3. \\<And>s.\n       \\<lbrakk>0 < s; s \\<le> return_time p1 x0\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 4. 0 < return_time p1 x0\n 5. return_time p1 x0 \\<in> existence_ivl0 x0\n 6. return_time p2 x0 - return_time p1 x0 + return_time p1 x0 =\n    return_time p2 x0", "by (auto simp: return_time_step poincare_map_def[symmetric] not_p2\n        intro!: return_time_exivl return_time_pos 1 2)"], ["proof (state)\nthis:\n  return_time p2 (poincare_map p1 x0) + return_time p1 x0 =\n  return_time p2 x0\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S", "have evrt_eq: \"\\<forall>\\<^sub>F x in at x0 within S.\n    return_time p2 (poincare_map p1 x) + return_time p1 x = return_time p2 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       return_time p2 (poincare_map p1 x) + return_time p1 x =\n       return_time p2 x", "using evret_flow evret1 evpm2"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     returns_to p2 (flow0 x (return_time p1 x))\n  eventually (returns_to p1) (at x0 within S)\n  \\<forall>\\<^sub>F x in at x0 within S.\n     \\<forall>s>0.\n        s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       return_time p2 (poincare_map p1 x) + return_time p1 x =\n       return_time p2 x", "apply (eventually_elim)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x (return_time p1 x)); returns_to p1 x;\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> return_time p2 (poincare_map p1 x) +\n                         return_time p1 x =\n                         return_time p2 x", "apply (auto simp: poincare_map_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x (return_time p1 x)); returns_to p1 x;\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> return_time p2 (flow0 x (return_time p1 x)) +\n                         return_time p1 x =\n                         return_time p2 x", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x (return_time p1 x)); returns_to p1 x;\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> returns_to p2 (flow0 x (return_time p1 x))\n 2. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x (return_time p1 x)); returns_to p1 x;\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> closed p2\n 3. \\<And>x s.\n       \\<lbrakk>returns_to p2 (flow0 x (return_time p1 x)); returns_to p1 x;\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow> flow0 x s \\<notin> p2;\n        0 < s; s \\<le> return_time p1 x\\<rbrakk>\n       \\<Longrightarrow> flow0 x s \\<notin> p2\n 4. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x (return_time p1 x)); returns_to p1 x;\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> 0 < return_time p1 x\n 5. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x (return_time p1 x)); returns_to p1 x;\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> return_time p1 x \\<in> existence_ivl0 x\n 6. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x (return_time p1 x)); returns_to p1 x;\n        \\<forall>s>0.\n           s \\<le> return_time p1 x \\<longrightarrow>\n           flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> return_time p2 x - return_time p1 x +\n                         return_time p1 x =\n                         return_time p2 x", "by (auto simp: return_time_step\n        intro!: return_time_exivl return_time_pos)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     return_time p2 (poincare_map p1 x) + return_time p1 x =\n     return_time p2 x\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S", "from _ evrt_eq"], ["proof (chain)\npicking this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  \\<forall>\\<^sub>F x in at x0 within S.\n     return_time p2 (poincare_map p1 x) + return_time p1 x =\n     return_time p2 x", "have \"(return_time p2 has_derivative (\\<lambda>x. dR2 (blinfun_apply D1 x) + dR1 x)) (at x0 within S)\""], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  \\<forall>\\<^sub>F x in at x0 within S.\n     return_time p2 (poincare_map p1 x) + return_time p1 x =\n     return_time p2 x\n\ngoal (1 subgoal):\n 1. (return_time p2 has_derivative\n     (\\<lambda>x. dR2 (blinfun_apply D1 x) + dR1 x))\n     (at x0 within S)", "by (rule has_derivative_transform_eventually)\n      (auto intro!: derivative_eq_intros has_derivative_compose[OF 1(4) 2(2)] 1(3) \\<open>x0 \\<in> S\\<close>\n        simp: rt_eq)"], ["proof (state)\nthis:\n  (return_time p2 has_derivative\n   (\\<lambda>x. dR2 (blinfun_apply D1 x) + dR1 x))\n   (at x0 within S)\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S", "then"], ["proof (chain)\npicking this:\n  (return_time p2 has_derivative\n   (\\<lambda>x. dR2 (blinfun_apply D1 x) + dR1 x))\n   (at x0 within S)", "show \"return_time p2 differentiable at x0 within S\""], ["proof (prove)\nusing this:\n  (return_time p2 has_derivative\n   (\\<lambda>x. dR2 (blinfun_apply D1 x) + dR1 x))\n   (at x0 within S)\n\ngoal (1 subgoal):\n 1. return_time p2 differentiable at x0 within S", "by (auto intro!: differentiableI)"], ["proof (state)\nthis:\n  return_time p2 differentiable at x0 within S\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma flowsto_poincare_trans:\\<comment> \\<open>TODO: the proof is close to @{thm poincare_mapsto_trans}\\<close>\n  assumes f: \"flowsto            X0 T     CX P1\"\n  assumes \"poincare_mapsto p2 P1 UNIV CY P2\"\n  assumes nn: \"\\<And>t. t \\<in> T \\<Longrightarrow> t \\<ge> 0\"\n  assumes \"fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\"\n  assumes \"p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\"\n  assumes [intro, simp]: \"closed p2\"\n  assumes cont: \"\\<And>x d. (x, d) \\<in> X0 \\<Longrightarrow> continuous (at x within S) (return_time p2)\"\n  assumes subset: \"fst ` X0 \\<subseteq> S\"\n  shows \"poincare_mapsto p2 X0 S CZ P2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. poincare_mapsto p2 X0 S CZ P2", "unfolding poincare_mapsto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(x, d)\\<in>X0.\n       returns_to p2 x \\<and>\n       fst ` X0 \\<subseteq> S \\<and>\n       return_time p2 differentiable at x within S \\<and>\n       (\\<exists>D.\n           (poincare_map p2 has_derivative blinfun_apply D)\n            (at x within S) \\<and>\n           (poincare_map p2 x, D o\\<^sub>L d) \\<in> P2) \\<and>\n       (\\<forall>t\\<in>{0<..<return_time p2 x}. flow0 x t \\<in> CZ)", "proof (auto, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "fix x0 d0"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "assume x0: \"(x0, d0) \\<in> X0\""], ["proof (state)\nthis:\n  (x0, d0) \\<in> X0\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from flowstoE[OF f x0]"], ["proof (chain)\npicking this:\n  (\\<And>h.\n      \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x0;\n       (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1;\n       \\<And>h'.\n          h' \\<in> {0<--<h} \\<Longrightarrow>\n          (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain h where 1:\n    \"h \\<in> T\" \"h \\<in> existence_ivl0 x0\"\n    \"(flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\" (is \"(?x0, _) \\<in> _\")\n    \"(\\<And>h'. h' \\<in> {0<--<h} \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX)\""], ["proof (prove)\nusing this:\n  (\\<And>h.\n      \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x0;\n       (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1;\n       \\<And>h'.\n          h' \\<in> {0<--<h} \\<Longrightarrow>\n          (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>h.\n        \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x0;\n         (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1;\n         \\<And>h'.\n            h' \\<in> {0<--<h} \\<Longrightarrow>\n            (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX", "have CX: \"(\\<And>h'. 0 < h' \\<Longrightarrow> h' < h \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX)\""], ["proof (prove)\nusing this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n\ngoal (1 subgoal):\n 1. \\<And>h'.\n       \\<lbrakk>0 < h'; h' < h\\<rbrakk>\n       \\<Longrightarrow> (flow0 x0 h', Dflow x0 h' o\\<^sub>L d0) \\<in> CX", "by (auto simp: nn open_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?h'2; ?h'2 < h\\<rbrakk>\n  \\<Longrightarrow> (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from 1"], ["proof (chain)\npicking this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX", "have \"0 \\<le> h\""], ["proof (prove)\nusing this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n\ngoal (1 subgoal):\n 1. 0 \\<le> h", "by (auto simp: nn)"], ["proof (state)\nthis:\n  0 \\<le> h\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from assms"], ["proof (chain)\npicking this:\n  flowsto X0 T CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  ?t2 \\<in> T \\<Longrightarrow> 0 \\<le> ?t2\n  fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  fst ` X0 \\<subseteq> S", "have CX_p2D: \"x \\<in> CX \\<Longrightarrow> fst x \\<notin> p2\" for x"], ["proof (prove)\nusing this:\n  flowsto X0 T CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  ?t2 \\<in> T \\<Longrightarrow> 0 \\<le> ?t2\n  fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  fst ` X0 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. x \\<in> CX \\<Longrightarrow> fst x \\<notin> p2", "by auto"], ["proof (state)\nthis:\n  ?x2 \\<in> CX \\<Longrightarrow> fst ?x2 \\<notin> p2\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from assms"], ["proof (chain)\npicking this:\n  flowsto X0 T CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  ?t2 \\<in> T \\<Longrightarrow> 0 \\<le> ?t2\n  fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  fst ` X0 \\<subseteq> S", "have P1_p2D: \"x \\<in> P1 \\<Longrightarrow> fst x \\<notin> p2\" for x"], ["proof (prove)\nusing this:\n  flowsto X0 T CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  ?t2 \\<in> T \\<Longrightarrow> 0 \\<le> ?t2\n  fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  fst ` X0 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. x \\<in> P1 \\<Longrightarrow> fst x \\<notin> p2", "by auto"], ["proof (state)\nthis:\n  ?x2 \\<in> P1 \\<Longrightarrow> fst ?x2 \\<notin> p2\n\ngoal (5 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b aa ba.\n       \\<lbrakk>(a, b) \\<in> X0; (aa, ba) \\<in> X0\\<rbrakk>\n       \\<Longrightarrow> aa \\<in> S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 4. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 5. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "show \"x0 \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x0 \\<in> S", "using x0 1 subset"], ["proof (prove)\nusing this:\n  (x0, d0) \\<in> X0\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n  fst ` X0 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. x0 \\<in> S", "by auto"], ["proof (state)\nthis:\n  x0 \\<in> S\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "let ?D1 = \"Dflow x0 h\""], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from assms(2) x0 \\<open>_ \\<in> P1\\<close>"], ["proof (chain)\npicking this:\n  poincare_mapsto p2 P1 UNIV CY P2\n  (x0, d0) \\<in> X0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1", "obtain D2 dR2 where 2:\n    \"returns_to p2 ?x0\"\n    \"(return_time p2 has_derivative dR2) (at ?x0)\"\n    \"(poincare_map p2 has_derivative blinfun_apply D2) (at ?x0)\"\n    \"(poincare_map p2 ?x0, D2 o\\<^sub>L (?D1 o\\<^sub>L d0)) \\<in> P2\"\n    \"\\<And>t. t\\<in>{0<..<return_time p2 ?x0} \\<Longrightarrow> flow0 ?x0 t \\<in> CY\""], ["proof (prove)\nusing this:\n  poincare_mapsto p2 P1 UNIV CY P2\n  (x0, d0) \\<in> X0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n\ngoal (1 subgoal):\n 1. (\\<And>dR2 D2.\n        \\<lbrakk>returns_to p2 (flow0 x0 h);\n         (return_time p2 has_derivative dR2) (at (flow0 x0 h));\n         (poincare_map p2 has_derivative blinfun_apply D2)\n          (at (flow0 x0 h));\n         (poincare_map p2 (flow0 x0 h),\n          D2 o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n         \\<in> P2;\n         \\<And>t.\n            t \\<in> {0<..<return_time p2 (flow0 x0 h)} \\<Longrightarrow>\n            flow0 (flow0 x0 h) t \\<in> CY\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: poincare_mapsto_def differentiable_def)"], ["proof (state)\nthis:\n  returns_to p2 (flow0 x0 h)\n  (return_time p2 has_derivative dR2) (at (flow0 x0 h))\n  (poincare_map p2 has_derivative blinfun_apply D2) (at (flow0 x0 h))\n  (poincare_map p2 (flow0 x0 h), D2 o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n  \\<in> P2\n  ?t2 \\<in> {0<..<return_time p2 (flow0 x0 h)} \\<Longrightarrow>\n  flow0 (flow0 x0 h) ?t2 \\<in> CY\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "{"], ["proof (state)\nthis:\n  returns_to p2 (flow0 x0 h)\n  (return_time p2 has_derivative dR2) (at (flow0 x0 h))\n  (poincare_map p2 has_derivative blinfun_apply D2) (at (flow0 x0 h))\n  (poincare_map p2 (flow0 x0 h), D2 o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n  \\<in> P2\n  ?t2 \\<in> {0<..<return_time p2 (flow0 x0 h)} \\<Longrightarrow>\n  flow0 (flow0 x0 h) ?t2 \\<in> CY\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "assume pos: \"h > 0\""], ["proof (state)\nthis:\n  0 < h\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"\\<forall>\\<^sub>F t in at_right 0. t < h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0. t < h", "by (rule order_tendstoD) (auto intro!: return_time_pos 1 pos)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0. t < h\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0. t < h\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"\\<forall>\\<^sub>F t in at_right 0. 0 < t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eventually ((<) (0::'c)) (at_right (0::'c))", "by (auto simp: eventually_at_filter)"], ["proof (state)\nthis:\n  eventually ((<) (0::?'c3)) (at_right (0::?'c3))\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F t in at_right 0. t < h\n  eventually ((<) (0::?'c3)) (at_right (0::?'c3))", "have \"\\<forall>\\<^sub>F t in at_right 0. flow0 x0 t \\<notin> p2\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F t in at_right 0. t < h\n  eventually ((<) (0::?'c3)) (at_right (0::?'c3))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0. flow0 x0 t \\<notin> p2", "by eventually_elim (use assms in \\<open>force dest: CX CX_p2D\\<close>)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0. flow0 x0 t \\<notin> p2\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "}"], ["proof (state)\nthis:\n  0 < h \\<Longrightarrow>\n  \\<forall>\\<^sub>F t in at_right 0. flow0 x0 t \\<notin> p2\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "note evnotp2 = this"], ["proof (state)\nthis:\n  0 < h \\<Longrightarrow>\n  \\<forall>\\<^sub>F t in at_right 0. flow0 x0 t \\<notin> p2\n\ngoal (4 subgoals):\n 1. \\<And>a b. (a, b) \\<in> X0 \\<Longrightarrow> returns_to p2 a\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 3. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 4. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from 2(1)"], ["proof (chain)\npicking this:\n  returns_to p2 (flow0 x0 h)", "show ret2: \"returns_to p2 x0\""], ["proof (prove)\nusing this:\n  returns_to p2 (flow0 x0 h)\n\ngoal (1 subgoal):\n 1. returns_to p2 x0", "apply (cases \"h = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>returns_to p2 (flow0 x0 h); h = 0\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 x0\n 2. \\<lbrakk>returns_to p2 (flow0 x0 h); h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 x0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>returns_to p2 (flow0 x0 h); h = 0\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 x0", "using 1"], ["proof (prove)\nusing this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n\ngoal (1 subgoal):\n 1. \\<lbrakk>returns_to p2 (flow0 x0 h); h = 0\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 x0", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>returns_to p2 (flow0 x0 h); h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 x0", "unfolding poincare_map_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>returns_to p2 (flow0 x0 h); h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 x0", "by (rule returns_to_earlierI)\n       (use evnotp2 \\<open>0 \\<le> h\\<close> in \\<open>auto intro!: less_imp_le return_time_pos 1 return_time_exivl \\<close>)"], ["proof (state)\nthis:\n  returns_to p2 x0\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have not_p2: \"0 < t \\<Longrightarrow> t \\<le> h \\<Longrightarrow> flow0 x0 t \\<notin> p2\" for t"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<notin> p2", "using 1(1-3) CX[of t] assms(4) CX_p2D P1_p2D"], ["proof (prove)\nusing this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  \\<lbrakk>0 < t; t < h\\<rbrakk>\n  \\<Longrightarrow> (flow0 x0 t, Dflow x0 t o\\<^sub>L d0) \\<in> CX\n  fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  ?x2 \\<in> CX \\<Longrightarrow> fst ?x2 \\<notin> p2\n  ?x2 \\<in> P1 \\<Longrightarrow> fst ?x2 \\<notin> p2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<notin> p2", "by (cases \"h = t\") (auto simp: poincare_map_def set_eq_iff subset_iff)"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?t2; ?t2 \\<le> h\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t2 \\<notin> p2\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have pm_eq: \"poincare_map p2 x0 = poincare_map p2 ?x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. poincare_map p2 x0 = poincare_map p2 (flow0 x0 h)", "apply (cases \"h = 0\", use 1 in force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. h \\<noteq> 0 \\<Longrightarrow>\n    poincare_map p2 x0 = poincare_map p2 (flow0 x0 h)", "using not_p2 \\<open>0 \\<le> h\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < ?t2; ?t2 \\<le> h\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t2 \\<notin> p2\n  0 \\<le> h\n\ngoal (1 subgoal):\n 1. h \\<noteq> 0 \\<Longrightarrow>\n    poincare_map p2 x0 = poincare_map p2 (flow0 x0 h)", "apply (auto simp: poincare_map_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 (return_time p2 x0) =\n                      flow0 (flow0 x0 h) (return_time p2 (flow0 x0 h))", "apply (subst flow_trans[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 2. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> return_time p2 (flow0 x0 h)\n                      \\<in> existence_ivl0 (flow0 x0 h)\n 3. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 (return_time p2 x0) =\n                      flow0 x0 (h + return_time p2 (flow0 x0 h))", "apply (auto intro!: return_time_exivl 1 2[unfolded poincare_map_def])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 (return_time p2 x0) =\n                      flow0 x0 (h + return_time p2 (flow0 x0 h))", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 (flow0 x0 h)\n 2. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> closed p2\n 3. \\<And>s.\n       \\<lbrakk>h \\<noteq> 0;\n        \\<And>t.\n           \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n           \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n        0 \\<le> h; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 4. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 5. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 6. \\<lbrakk>h \\<noteq> 0;\n     \\<And>t.\n        \\<lbrakk>0 < t; t \\<le> h\\<rbrakk>\n        \\<Longrightarrow> flow0 x0 t \\<notin> p2;\n     0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 (return_time p2 x0) =\n                      flow0 x0 (h + (return_time p2 x0 - h))", "by (auto simp: return_time_step \n        intro!: return_time_exivl 1 2[unfolded poincare_map_def] return_time_pos)"], ["proof (state)\nthis:\n  poincare_map p2 x0 = poincare_map p2 (flow0 x0 h)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have evret2: \"\\<forall>\\<^sub>F x in at ?x0. returns_to p2 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eventually (returns_to p2) (at (flow0 x0 h))", "by (auto intro!: eventually_returns_to_continuousI 2 has_derivative_continuous)"], ["proof (state)\nthis:\n  eventually (returns_to p2) (at (flow0 x0 h))\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"\\<forall>\\<^sub>F x in at x0. h \\<in> existence_ivl0 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0. h \\<in> existence_ivl0 x", "by (simp add: 1 eventually_mem_existence_ivl)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0. h \\<in> existence_ivl0 x\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at x0. h \\<in> existence_ivl0 x", "have evex: \"\\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0. h \\<in> existence_ivl0 x\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x", "by (auto simp: eventually_at)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from evret2[unfolded eventually_at_topological] 2(1)"], ["proof (chain)\npicking this:\n  \\<exists>S.\n     open S \\<and>\n     flow0 x0 h \\<in> S \\<and>\n     (\\<forall>x\\<in>S.\n         x \\<noteq> flow0 x0 h \\<longrightarrow>\n         x \\<in> UNIV \\<longrightarrow> returns_to p2 x)\n  returns_to p2 (flow0 x0 h)", "obtain U where U: \"open U\" \"flow0 x0 h \\<in> U\" \"\\<And>x. x \\<in> U \\<Longrightarrow> returns_to p2 x\""], ["proof (prove)\nusing this:\n  \\<exists>S.\n     open S \\<and>\n     flow0 x0 h \\<in> S \\<and>\n     (\\<forall>x\\<in>S.\n         x \\<noteq> flow0 x0 h \\<longrightarrow>\n         x \\<in> UNIV \\<longrightarrow> returns_to p2 x)\n  returns_to p2 (flow0 x0 h)\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>open U; flow0 x0 h \\<in> U;\n         \\<And>x. x \\<in> U \\<Longrightarrow> returns_to p2 x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  open U\n  flow0 x0 h \\<in> U\n  ?x2 \\<in> U \\<Longrightarrow> returns_to p2 ?x2\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "note [tendsto_intros] = this[unfolded continuous_within]"], ["proof (state)\nthis:\n  open U\n  flow0 x0 h \\<in> U\n  ?x2 \\<in> U \\<Longrightarrow> returns_to p2 ?x2\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"eventually (\\<lambda>x. flow0 x h \\<in> U) (at x0 within S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. flow0 x h \\<in> U", "by (rule topological_tendstoD) (auto intro!: tendsto_eq_intros U 1)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. flow0 x h \\<in> U\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at x0 within S. flow0 x h \\<in> U", "have evret_flow: \"\\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x h)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S. flow0 x h \\<in> U\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x h)", "unfolding poincare_map_def[symmetric]"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S. flow0 x h \\<in> U\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x h)", "apply eventually_elim"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. flow0 x h \\<in> U \\<Longrightarrow> returns_to p2 (flow0 x h)", "apply (rule U)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. flow0 x h \\<in> U \\<Longrightarrow> flow0 x h \\<in> U", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x h)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x h)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have h_less_rt: \"h < return_time p2 x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. h < return_time p2 x0", "by (rule return_time_gt; fact)"], ["proof (state)\nthis:\n  h < return_time p2 x0\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  h < return_time p2 x0", "have \"0 < return_time p2 x0 - h\""], ["proof (prove)\nusing this:\n  h < return_time p2 x0\n\ngoal (1 subgoal):\n 1. 0 < return_time p2 x0 - h", "by (simp )"], ["proof (state)\nthis:\n  0 < return_time p2 x0 - h\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from _ this"], ["proof (chain)\npicking this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  0 < return_time p2 x0 - h", "have \"\\<forall>\\<^sub>F x in at x0 within S. 0 < return_time p2 x - h\""], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  0 < return_time p2 x0 - h\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S. 0 < return_time p2 x - h", "apply (rule order_tendstoD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. return_time p2 x - h) \\<longlongrightarrow>\n     return_time p2 x0 - h)\n     (at x0 within S)", "using cont \\<open>(x0, _) \\<in> _\\<close>"], ["proof (prove)\nusing this:\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  (x0, d0) \\<in> X0\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. return_time p2 x - h) \\<longlongrightarrow>\n     return_time p2 x0 - h)\n     (at x0 within S)", "by (auto intro!: tendsto_eq_intros simp: continuous_within[symmetric] continuous_on_def)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S. 0 < return_time p2 x - h\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at x0 within S. 0 < return_time p2 x - h", "have evpm2: \"\\<forall>\\<^sub>F x in at x0 within S. \\<forall>s. 0 < s \\<longrightarrow> s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S. 0 < return_time p2 x - h\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2", "apply eventually_elim"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < return_time p2 x - h \\<Longrightarrow>\n       \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2", "apply safe"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>0 < return_time p2 x - h; 0 < s; s \\<le> h;\n        flow0 x s \\<in> p2\\<rbrakk>\n       \\<Longrightarrow> False", "subgoal for x s"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < return_time p2 x - h; 0 < s; s \\<le> h;\n     flow0 x s \\<in> p2\\<rbrakk>\n    \\<Longrightarrow> False", "using return_time_least[of p2 x s]"], ["proof (prove)\nusing this:\n  \\<lbrakk>returns_to p2 x; closed p2; 0 < s; s < return_time p2 x\\<rbrakk>\n  \\<Longrightarrow> flow0 x s \\<notin> p2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < return_time p2 x - h; 0 < s; s \\<le> h;\n     flow0 x s \\<in> p2\\<rbrakk>\n    \\<Longrightarrow> False", "by (auto simp add: return_time_pos_returns_to)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n  \\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x h)\n  \\<forall>\\<^sub>F x in at x0 within S.\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2", "have pm_eq_at: \"\\<forall>\\<^sub>F x in at x0 within S.\n    poincare_map p2 (flow0 x h) = poincare_map p2 x\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n  \\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x h)\n  \\<forall>\\<^sub>F x in at x0 within S.\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       poincare_map p2 (flow0 x h) = poincare_map p2 x", "apply (eventually_elim)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0.\n           s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2\\<rbrakk>\n       \\<Longrightarrow> poincare_map p2 (flow0 x h) = poincare_map p2 x", "apply (cases \"h = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h = 0\\<rbrakk>\n       \\<Longrightarrow> poincare_map p2 (flow0 x h) = poincare_map p2 x\n 2. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> poincare_map p2 (flow0 x h) = poincare_map p2 x", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<in> existence_ivl0 x_; returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h = 0\\<rbrakk>\n    \\<Longrightarrow> poincare_map p2 (flow0 x_ h) = poincare_map p2 x_", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> poincare_map p2 (flow0 x h) = poincare_map p2 x", "apply (auto simp: poincare_map_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> flow0 (flow0 x h) (return_time p2 (flow0 x h)) =\n                         flow0 x (return_time p2 x)", "apply (subst flow_trans[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> h \\<in> existence_ivl0 x\n 2. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> return_time p2 (flow0 x h)\n                         \\<in> existence_ivl0 (flow0 x h)\n 3. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> flow0 x (h + return_time p2 (flow0 x h)) =\n                         flow0 x (return_time p2 x)", "apply (auto intro!: return_time_exivl)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> flow0 x (h + return_time p2 (flow0 x h)) =\n                         flow0 x (return_time p2 x)", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> returns_to p2 (flow0 x h)\n 2. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> closed p2\n 3. \\<And>x s.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x s \\<notin> p2\n 4. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> 0 < h\n 5. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> h \\<in> existence_ivl0 x\n 6. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> flow0 x (h + (return_time p2 x - h)) =\n                         flow0 x (return_time p2 x)", "using \\<open>0 \\<le> h\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> h\n\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> returns_to p2 (flow0 x h)\n 2. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> closed p2\n 3. \\<And>x s.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x s \\<notin> p2\n 4. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> 0 < h\n 5. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> h \\<in> existence_ivl0 x\n 6. \\<And>x.\n       \\<lbrakk>h \\<in> existence_ivl0 x; returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> flow0 x (h + (return_time p2 x - h)) =\n                         flow0 x (return_time p2 x)", "by (auto simp: return_time_step intro!: return_time_exivl return_time_pos)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     poincare_map p2 (flow0 x h) = poincare_map p2 x\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "from _ this"], ["proof (chain)\npicking this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  \\<forall>\\<^sub>F x in at x0 within S.\n     poincare_map p2 (flow0 x h) = poincare_map p2 x", "have \"(poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L ?D1)) (at x0 within S)\""], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  \\<forall>\\<^sub>F x in at x0 within S.\n     poincare_map p2 (flow0 x h) = poincare_map p2 x\n\ngoal (1 subgoal):\n 1. (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L Dflow x0 h))\n     (at x0 within S)", "apply (rule has_derivative_transform_eventually)"], ["proof (prove)\ngoal (3 subgoals):\n 1. ((\\<lambda>x. poincare_map p2 (flow0 x h)) has_derivative\n     blinfun_apply (D2 o\\<^sub>L Dflow x0 h))\n     (at x0 within S)\n 2. poincare_map p2 (flow0 x0 h) = poincare_map p2 x0\n 3. x0 \\<in> S", "apply (rule has_derivative_at_withinI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. ((\\<lambda>x. poincare_map p2 (flow0 x h)) has_derivative\n     blinfun_apply (D2 o\\<^sub>L Dflow x0 h))\n     (at x0)\n 2. poincare_map p2 (flow0 x0 h) = poincare_map p2 x0\n 3. x0 \\<in> S", "apply (rule has_derivative_compose[OF flow_has_space_derivative 2(3), THEN has_derivative_eq_rhs])"], ["proof (prove)\ngoal (4 subgoals):\n 1. h \\<in> existence_ivl0 x0\n 2. (\\<lambda>x. blinfun_apply D2 (blinfun_apply (Dflow x0 h) x)) =\n    blinfun_apply (D2 o\\<^sub>L Dflow x0 h)\n 3. poincare_map p2 (flow0 x0 h) = poincare_map p2 x0\n 4. x0 \\<in> S", "by (auto simp: \\<open>x0 \\<in> S\\<close> pm_eq 1)"], ["proof (state)\nthis:\n  (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L Dflow x0 h))\n   (at x0 within S)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "moreover"], ["proof (state)\nthis:\n  (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L Dflow x0 h))\n   (at x0 within S)\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "have \"(poincare_map p2 x0, (D2 o\\<^sub>L ?D1) o\\<^sub>L d0) \\<in> P2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (poincare_map p2 x0, D2 o\\<^sub>L Dflow x0 h o\\<^sub>L d0) \\<in> P2", "using 2(4)"], ["proof (prove)\nusing this:\n  (poincare_map p2 (flow0 x0 h), D2 o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n  \\<in> P2\n\ngoal (1 subgoal):\n 1. (poincare_map p2 x0, D2 o\\<^sub>L Dflow x0 h o\\<^sub>L d0) \\<in> P2", "unfolding pm_eq blinfun_compose_assoc"], ["proof (prove)\nusing this:\n  (poincare_map p2 (flow0 x0 h), D2 o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n  \\<in> P2\n\ngoal (1 subgoal):\n 1. (poincare_map p2 (flow0 x0 h), D2 o\\<^sub>L (Dflow x0 h o\\<^sub>L d0))\n    \\<in> P2", "."], ["proof (state)\nthis:\n  (poincare_map p2 x0, D2 o\\<^sub>L Dflow x0 h o\\<^sub>L d0) \\<in> P2\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       \\<exists>D.\n          (poincare_map p2 has_derivative blinfun_apply D)\n           (at a within S) \\<and>\n          (poincare_map p2 a, D o\\<^sub>L b) \\<in> P2\n 3. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "ultimately"], ["proof (chain)\npicking this:\n  (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L Dflow x0 h))\n   (at x0 within S)\n  (poincare_map p2 x0, D2 o\\<^sub>L Dflow x0 h o\\<^sub>L d0) \\<in> P2", "show \"\\<exists>D. (poincare_map p2 has_derivative blinfun_apply D) (at x0 within S) \\<and>\n               (poincare_map p2 x0, D o\\<^sub>L d0) \\<in> P2\""], ["proof (prove)\nusing this:\n  (poincare_map p2 has_derivative blinfun_apply (D2 o\\<^sub>L Dflow x0 h))\n   (at x0 within S)\n  (poincare_map p2 x0, D2 o\\<^sub>L Dflow x0 h o\\<^sub>L d0) \\<in> P2\n\ngoal (1 subgoal):\n 1. \\<exists>D.\n       (poincare_map p2 has_derivative blinfun_apply D)\n        (at x0 within S) \\<and>\n       (poincare_map p2 x0, D o\\<^sub>L d0) \\<in> P2", "by auto"], ["proof (state)\nthis:\n  \\<exists>D.\n     (poincare_map p2 has_derivative blinfun_apply D)\n      (at x0 within S) \\<and>\n     (poincare_map p2 x0, D o\\<^sub>L d0) \\<in> P2\n\ngoal (2 subgoals):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S\n 2. \\<And>a b t.\n       \\<lbrakk>(a, b) \\<in> X0; 0 < t; t < return_time p2 a\\<rbrakk>\n       \\<Longrightarrow> flow0 a t \\<in> CZ", "show \"0 < t \\<Longrightarrow> t < return_time p2 x0 \\<Longrightarrow> flow0 x0 t \\<in> CZ\" for t"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "apply (cases \"t < h\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; t < h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ\n 2. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; t < h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "apply (drule CX)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t < return_time p2 x0; t < h\\<rbrakk> \\<Longrightarrow> t < h\n 2. \\<lbrakk>t < return_time p2 x0; t < h;\n     (flow0 x0 t, Dflow x0 t o\\<^sub>L d0) \\<in> CX\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "using assms"], ["proof (prove)\nusing this:\n  flowsto X0 T CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  ?t2 \\<in> T \\<Longrightarrow> 0 \\<le> ?t2\n  fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  fst ` X0 \\<subseteq> S\n\ngoal (2 subgoals):\n 1. \\<lbrakk>t < return_time p2 x0; t < h\\<rbrakk> \\<Longrightarrow> t < h\n 2. \\<lbrakk>t < return_time p2 x0; t < h;\n     (flow0 x0 t, Dflow x0 t o\\<^sub>L d0) \\<in> CX\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "apply (cases \"t = h\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < h; t = h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ\n 2. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < h; t = h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "using 1 assms"], ["proof (prove)\nusing this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n  flowsto X0 T CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  ?t2 \\<in> T \\<Longrightarrow> 0 \\<le> ?t2\n  fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  fst ` X0 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < h; t = h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "by (auto simp: poincare_map_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> flow0 x0 t \\<in> CZ", "subgoal premises prems"], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "have \"flow0 x0 t = flow0 ?x0 (t - h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x0 t = flow0 (flow0 x0 h) (t - h)", "unfolding poincare_map_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x0 t = flow0 (flow0 x0 h) (t - h)", "apply (subst flow_trans[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. h \\<in> existence_ivl0 x0\n 2. t - h \\<in> existence_ivl0 (flow0 x0 h)\n 3. flow0 x0 t = flow0 x0 (h + (t - h))", "using prems"], ["proof (prove)\nusing this:\n  0 < t\n  t < return_time p2 x0\n  \\<not> t < h\n  t \\<noteq> h\n\ngoal (3 subgoals):\n 1. h \\<in> existence_ivl0 x0\n 2. t - h \\<in> existence_ivl0 (flow0 x0 h)\n 3. flow0 x0 t = flow0 x0 (h + (t - h))", "by (auto simp:\n              intro!: return_time_exivl 1 diff_existence_ivl_trans\n              less_return_time_imp_exivl[OF _ ret2])"], ["proof (state)\nthis:\n  flow0 x0 t = flow0 (flow0 x0 h) (t - h)\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "also"], ["proof (state)\nthis:\n  flow0 x0 t = flow0 (flow0 x0 h) (t - h)\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "have \"\\<dots> \\<in> CY\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 (flow0 x0 h) (t - h) \\<in> CY", "apply (cases \"h = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. h = 0 \\<Longrightarrow> flow0 (flow0 x0 h) (t - h) \\<in> CY\n 2. h \\<noteq> 0 \\<Longrightarrow> flow0 (flow0 x0 h) (t - h) \\<in> CY", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. h = 0 \\<Longrightarrow> flow0 (flow0 x0 h) (t - h) \\<in> CY", "using \"1\"(2) \"2\"(5) prems(1) prems(2)"], ["proof (prove)\nusing this:\n  h \\<in> existence_ivl0 x0\n  ?t2 \\<in> {0<..<return_time p2 (flow0 x0 h)} \\<Longrightarrow>\n  flow0 (flow0 x0 h) ?t2 \\<in> CY\n  0 < t\n  t < return_time p2 x0\n\ngoal (1 subgoal):\n 1. h = 0 \\<Longrightarrow> flow0 (flow0 x0 h) (t - h) \\<in> CY", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. h \\<noteq> 0 \\<Longrightarrow> flow0 (flow0 x0 h) (t - h) \\<in> CY", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. h \\<noteq> 0 \\<Longrightarrow> flow0 (flow0 x0 h) (t - h) \\<in> CY", "apply (rule 2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. h \\<noteq> 0 \\<Longrightarrow>\n    t - h \\<in> {0<..<return_time p2 (flow0 x0 h)}", "using prems"], ["proof (prove)\nusing this:\n  0 < t\n  t < return_time p2 x0\n  \\<not> t < h\n  t \\<noteq> h\n\ngoal (1 subgoal):\n 1. h \\<noteq> 0 \\<Longrightarrow>\n    t - h \\<in> {0<..<return_time p2 (flow0 x0 h)}", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> t - h < return_time p2 (flow0 x0 h)", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 (flow0 x0 h)\n 2. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> closed p2\n 3. \\<And>s.\n       \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n        t \\<noteq> h; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 4. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 5. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 6. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> t - h < return_time p2 x0 - h", "apply (rule returns_to_laterI)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 x0\n 2. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> closed p2\n 3. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 4. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 5. \\<And>s.\n       \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n        t \\<noteq> h; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 6. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> closed p2\n 7. \\<And>s.\n       \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n        t \\<noteq> h; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 8. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 9. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 10. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n      t \\<noteq> h\\<rbrakk>\n     \\<Longrightarrow> t - h < return_time p2 x0 - h", "using ret2 \\<open>0 \\<le> h\\<close> \\<open>h \\<in> existence_ivl0 x0\\<close> not_p2"], ["proof (prove)\nusing this:\n  returns_to p2 x0\n  0 \\<le> h\n  h \\<in> existence_ivl0 x0\n  \\<lbrakk>0 < ?t2; ?t2 \\<le> h\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t2 \\<notin> p2\n\ngoal (10 subgoals):\n 1. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 x0\n 2. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> closed p2\n 3. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 4. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 5. \\<And>s.\n       \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n        t \\<noteq> h; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 6. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> closed p2\n 7. \\<And>s.\n       \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n        t \\<noteq> h; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 8. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 9. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n     t \\<noteq> h\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 10. \\<lbrakk>h \\<noteq> 0; 0 < t; t < return_time p2 x0; \\<not> t < h;\n      t \\<noteq> h\\<rbrakk>\n     \\<Longrightarrow> t - h < return_time p2 x0 - h", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  flow0 (flow0 x0 h) (t - h) \\<in> CY\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "also"], ["proof (state)\nthis:\n  flow0 (flow0 x0 h) (t - h) \\<in> CY\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "have \"\\<dots> \\<subseteq> CZ\""], ["proof (prove)\ngoal (1 subgoal):\n 1. CY \\<subseteq> CZ", "using assms"], ["proof (prove)\nusing this:\n  flowsto X0 T CX P1\n  poincare_mapsto p2 P1 UNIV CY P2\n  ?t2 \\<in> T \\<Longrightarrow> 0 \\<le> ?t2\n  fst ` CX \\<union> CY \\<union> fst ` P1 \\<subseteq> CZ\n  p2 \\<inter> (fst ` CX \\<union> fst ` P1) = {}\n  closed p2\n  (?x2, ?d2) \\<in> X0 \\<Longrightarrow>\n  continuous (at ?x2 within S) (return_time p2)\n  fst ` X0 \\<subseteq> S\n\ngoal (1 subgoal):\n 1. CY \\<subseteq> CZ", "by auto"], ["proof (state)\nthis:\n  CY \\<subseteq> CZ\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "finally"], ["proof (chain)\npicking this:\n  flow0 x0 t \\<in> CZ", "show \"flow0 x0 t \\<in> CZ\""], ["proof (prove)\nusing this:\n  flow0 x0 t \\<in> CZ\n\ngoal (1 subgoal):\n 1. flow0 x0 t \\<in> CZ", "by simp"], ["proof (state)\nthis:\n  flow0 x0 t \\<in> CZ\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?t2; ?t2 < return_time p2 x0\\<rbrakk>\n  \\<Longrightarrow> flow0 x0 ?t2 \\<in> CZ\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S", "have rt_eq: \"return_time p2 ?x0 + h = return_time p2 x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. return_time p2 (flow0 x0 h) + h = return_time p2 x0", "apply (cases \"h = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. h = 0 \\<Longrightarrow>\n    return_time p2 (flow0 x0 h) + h = return_time p2 x0\n 2. h \\<noteq> 0 \\<Longrightarrow>\n    return_time p2 (flow0 x0 h) + h = return_time p2 x0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. h = 0 \\<Longrightarrow>\n    return_time p2 (flow0 x0 h) + h = return_time p2 x0", "using 1"], ["proof (prove)\nusing this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n\ngoal (1 subgoal):\n 1. h = 0 \\<Longrightarrow>\n    return_time p2 (flow0 x0 h) + h = return_time p2 x0", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. h \\<noteq> 0 \\<Longrightarrow>\n    return_time p2 (flow0 x0 h) + h = return_time p2 x0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. h \\<noteq> 0 \\<Longrightarrow>\n    return_time p2 (flow0 x0 h) + h = return_time p2 x0", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. h \\<noteq> 0 \\<Longrightarrow> returns_to p2 (flow0 x0 h)\n 2. h \\<noteq> 0 \\<Longrightarrow> closed p2\n 3. \\<And>s.\n       \\<lbrakk>h \\<noteq> 0; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 4. h \\<noteq> 0 \\<Longrightarrow> 0 < h\n 5. h \\<noteq> 0 \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 6. h \\<noteq> 0 \\<Longrightarrow>\n    return_time p2 x0 - h + h = return_time p2 x0", "using \\<open>0 \\<le> h\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> h\n\ngoal (6 subgoals):\n 1. h \\<noteq> 0 \\<Longrightarrow> returns_to p2 (flow0 x0 h)\n 2. h \\<noteq> 0 \\<Longrightarrow> closed p2\n 3. \\<And>s.\n       \\<lbrakk>h \\<noteq> 0; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x0 s \\<notin> p2\n 4. h \\<noteq> 0 \\<Longrightarrow> 0 < h\n 5. h \\<noteq> 0 \\<Longrightarrow> h \\<in> existence_ivl0 x0\n 6. h \\<noteq> 0 \\<Longrightarrow>\n    return_time p2 x0 - h + h = return_time p2 x0", "by (auto simp: return_time_step poincare_map_def[symmetric] not_p2\n          intro!: return_time_exivl return_time_pos 1 2)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  return_time p2 (flow0 x0 h) + h = return_time p2 x0\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S", "have evrt_eq: \"\\<forall>\\<^sub>F x in at x0 within S.\n    return_time p2 (flow0 x h) + h = return_time p2 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       return_time p2 (flow0 x h) + h = return_time p2 x", "using evret_flow evpm2 evex"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at x0 within S. returns_to p2 (flow0 x h)\n  \\<forall>\\<^sub>F x in at x0 within S.\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2\n  \\<forall>\\<^sub>F x in at x0 within S. h \\<in> existence_ivl0 x\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at x0 within S.\n       return_time p2 (flow0 x h) + h = return_time p2 x", "apply (eventually_elim)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<in> existence_ivl0 x\\<rbrakk>\n       \\<Longrightarrow> return_time p2 (flow0 x h) + h = return_time p2 x", "apply (cases \"h = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<in> existence_ivl0 x; h = 0\\<rbrakk>\n       \\<Longrightarrow> return_time p2 (flow0 x h) + h = return_time p2 x\n 2. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<in> existence_ivl0 x; h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> return_time p2 (flow0 x h) + h = return_time p2 x", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h = 0\\<rbrakk>\n    \\<Longrightarrow> return_time p2 (flow0 x_ h) + h = return_time p2 x_", "using 1"], ["proof (prove)\nusing this:\n  h \\<in> T\n  h \\<in> existence_ivl0 x0\n  (flow0 x0 h, Dflow x0 h o\\<^sub>L d0) \\<in> P1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x0 ?h'2, Dflow x0 ?h'2 o\\<^sub>L d0) \\<in> CX\n\ngoal (1 subgoal):\n 1. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h = 0\\<rbrakk>\n    \\<Longrightarrow> return_time p2 (flow0 x_ h) + h = return_time p2 x_", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>returns_to p2 (flow0 x h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x s \\<notin> p2;\n        h \\<in> existence_ivl0 x; h \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> return_time p2 (flow0 x h) + h = return_time p2 x", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> return_time p2 (flow0 x_ h) + h = return_time p2 x_", "apply (subst return_time_step)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 (flow0 x_ h)\n 2. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> closed p2\n 3. \\<And>s.\n       \\<lbrakk>returns_to p2 (flow0 x_ h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n        h \\<in> existence_ivl0 x_; h \\<noteq> 0; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x_ s \\<notin> p2\n 4. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 5. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x_\n 6. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> return_time p2 x_ - h + h = return_time p2 x_", "using \\<open>0 \\<le> h\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> h\n\ngoal (6 subgoals):\n 1. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> returns_to p2 (flow0 x_ h)\n 2. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> closed p2\n 3. \\<And>s.\n       \\<lbrakk>returns_to p2 (flow0 x_ h);\n        \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n        h \\<in> existence_ivl0 x_; h \\<noteq> 0; 0 < s; s \\<le> h\\<rbrakk>\n       \\<Longrightarrow> flow0 x_ s \\<notin> p2\n 4. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < h\n 5. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> h \\<in> existence_ivl0 x_\n 6. \\<lbrakk>returns_to p2 (flow0 x_ h);\n     \\<forall>s>0. s \\<le> h \\<longrightarrow> flow0 x_ s \\<notin> p2;\n     h \\<in> existence_ivl0 x_; h \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> return_time p2 x_ - h + h = return_time p2 x_", "by (auto simp: return_time_step\n          intro!: return_time_exivl return_time_pos)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at x0 within S.\n     return_time p2 (flow0 x h) + h = return_time p2 x\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S", "from _ evrt_eq"], ["proof (chain)\npicking this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  \\<forall>\\<^sub>F x in at x0 within S.\n     return_time p2 (flow0 x h) + h = return_time p2 x", "have \"(return_time p2 has_derivative (\\<lambda>x. dR2 (blinfun_apply ?D1 x))) (at x0 within S)\""], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  \\<forall>\\<^sub>F x in at x0 within S.\n     return_time p2 (flow0 x h) + h = return_time p2 x\n\ngoal (1 subgoal):\n 1. (return_time p2 has_derivative\n     (\\<lambda>x. dR2 (blinfun_apply (Dflow x0 h) x)))\n     (at x0 within S)", "apply (rule has_derivative_transform_eventually)"], ["proof (prove)\ngoal (3 subgoals):\n 1. ((\\<lambda>x. return_time p2 (flow0 x h) + h) has_derivative\n     (\\<lambda>x. dR2 (blinfun_apply (Dflow x0 h) x)))\n     (at x0 within S)\n 2. return_time p2 (flow0 x0 h) + h = return_time p2 x0\n 3. x0 \\<in> S", "apply (rule has_derivative_at_withinI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. ((\\<lambda>x. return_time p2 (flow0 x h) + h) has_derivative\n     (\\<lambda>x. dR2 (blinfun_apply (Dflow x0 h) x)))\n     (at x0)\n 2. return_time p2 (flow0 x0 h) + h = return_time p2 x0\n 3. x0 \\<in> S", "by (auto intro!: derivative_eq_intros has_derivative_compose[OF flow_has_space_derivative 2(2)] 1 \\<open>x0 \\<in> S\\<close>\n        simp: rt_eq)"], ["proof (state)\nthis:\n  (return_time p2 has_derivative\n   (\\<lambda>x. dR2 (blinfun_apply (Dflow x0 h) x)))\n   (at x0 within S)\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b) \\<in> X0 \\<Longrightarrow>\n       return_time p2 differentiable at a within S", "then"], ["proof (chain)\npicking this:\n  (return_time p2 has_derivative\n   (\\<lambda>x. dR2 (blinfun_apply (Dflow x0 h) x)))\n   (at x0 within S)", "show \"return_time p2 differentiable at x0 within S\""], ["proof (prove)\nusing this:\n  (return_time p2 has_derivative\n   (\\<lambda>x. dR2 (blinfun_apply (Dflow x0 h) x)))\n   (at x0 within S)\n\ngoal (1 subgoal):\n 1. return_time p2 differentiable at x0 within S", "by (auto intro!: differentiableI)"], ["proof (state)\nthis:\n  return_time p2 differentiable at x0 within S\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>conditions for continuous return time\\<close>"], ["", "definition \"section s Ds S \\<longleftrightarrow>\n  (\\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x)) \\<and>\n  (\\<forall>x. isCont Ds x) \\<and>\n  (\\<forall>x \\<in> S. s x = (0::real) \\<longrightarrow> Ds x (f x) \\<noteq> 0) \\<and>\n  closed S \\<and> S \\<subseteq> X\""], ["", "lemma sectionD:\n  assumes \"section s Ds S\"\n  shows \"(s has_derivative blinfun_apply (Ds x)) (at x)\"\n    \"isCont Ds x\"\n    \"x \\<in> S \\<Longrightarrow> s x = 0 \\<Longrightarrow> Ds x (f x) \\<noteq> 0\"\n    \"closed S\" \"S \\<subseteq> X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((s has_derivative blinfun_apply (Ds x)) (at x) &&& isCont Ds x) &&&\n    (\\<lbrakk>x \\<in> S; s x = 0\\<rbrakk>\n     \\<Longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0) &&&\n    closed S &&& S \\<subseteq> X", "using assms"], ["proof (prove)\nusing this:\n  section s Ds S\n\ngoal (1 subgoal):\n 1. ((s has_derivative blinfun_apply (Ds x)) (at x) &&& isCont Ds x) &&&\n    (\\<lbrakk>x \\<in> S; s x = 0\\<rbrakk>\n     \\<Longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0) &&&\n    closed S &&& S \\<subseteq> X", "by (auto simp: section_def)"], ["", "definition \"transversal p \\<longleftrightarrow> (\\<forall>x \\<in> p. \\<forall>\\<^sub>F t in at_right 0. flow0 x t \\<notin> p)\""], ["", "lemma transversalD: \"transversal p \\<Longrightarrow> x \\<in> p \\<Longrightarrow> \\<forall>\\<^sub>F t in at_right 0. flow0 x t \\<notin> p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>transversal p; x \\<in> p\\<rbrakk>\n    \\<Longrightarrow> \\<forall>\\<^sub>F t in at_right 0.\n                         flow0 x t \\<notin> p", "by (auto simp: transversal_def)"], ["", "lemma transversal_section:\n  fixes c::real\n  assumes \"section s Ds S\"\n  shows \"transversal {x \\<in> S. s x = 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. transversal {x \\<in> S. s x = 0}", "using assms"], ["proof (prove)\nusing this:\n  section s Ds S\n\ngoal (1 subgoal):\n 1. transversal {x \\<in> S. s x = 0}", "unfolding section_def transversal_def"], ["proof (prove)\nusing this:\n  (\\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x)) \\<and>\n  (\\<forall>x. isCont Ds x) \\<and>\n  (\\<forall>x\\<in>S.\n      s x = 0 \\<longrightarrow>\n      blinfun_apply (Ds x) (f x) \\<noteq> 0) \\<and>\n  closed S \\<and> S \\<subseteq> X\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{x \\<in> S. s x = 0}.\n       \\<forall>\\<^sub>F t in at_right 0.\n          flow0 x t \\<notin> {x \\<in> S. s x = 0}", "proof (safe, goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x);\n        x \\<in> S; s x = 0; \\<forall>x. isCont Ds x;\n        \\<forall>x\\<in>S.\n           s x = 0 \\<longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0;\n        closed S; S \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F t in at_right 0.\n                            flow0 x t \\<notin> {x \\<in> S. s x = 0}", "case (1 x)"], ["proof (state)\nthis:\n  \\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x)\n  x \\<in> S\n  s x = 0\n  \\<forall>x. isCont Ds x\n  \\<forall>x\\<in>S.\n     s x = 0 \\<longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0\n  closed S\n  S \\<subseteq> X\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x);\n        x \\<in> S; s x = 0; \\<forall>x. isCont Ds x;\n        \\<forall>x\\<in>S.\n           s x = 0 \\<longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0;\n        closed S; S \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F t in at_right 0.\n                            flow0 x t \\<notin> {x \\<in> S. s x = 0}", "then"], ["proof (chain)\npicking this:\n  \\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x)\n  x \\<in> S\n  s x = 0\n  \\<forall>x. isCont Ds x\n  \\<forall>x\\<in>S.\n     s x = 0 \\<longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0\n  closed S\n  S \\<subseteq> X", "have \"x \\<in> X\""], ["proof (prove)\nusing this:\n  \\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x)\n  x \\<in> S\n  s x = 0\n  \\<forall>x. isCont Ds x\n  \\<forall>x\\<in>S.\n     s x = 0 \\<longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0\n  closed S\n  S \\<subseteq> X\n\ngoal (1 subgoal):\n 1. x \\<in> X", "by auto"], ["proof (state)\nthis:\n  x \\<in> X\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x);\n        x \\<in> S; s x = 0; \\<forall>x. isCont Ds x;\n        \\<forall>x\\<in>S.\n           s x = 0 \\<longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0;\n        closed S; S \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F t in at_right 0.\n                            flow0 x t \\<notin> {x \\<in> S. s x = 0}", "have \"\\<forall>\\<^sub>F t in at_right 0. flow0 x t \\<notin> {xa \\<in> S. s xa = 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       flow0 x t \\<notin> {xa \\<in> S. s xa = 0}", "by (rule flow_avoids_surface_eventually_at_right)\n      (rule disjI2 assms 1[rule_format] refl \\<open>x \\<in> X\\<close>)+"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0.\n     flow0 x t \\<notin> {xa \\<in> S. s xa = 0}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x. (s has_derivative blinfun_apply (Ds x)) (at x);\n        x \\<in> S; s x = 0; \\<forall>x. isCont Ds x;\n        \\<forall>x\\<in>S.\n           s x = 0 \\<longrightarrow> blinfun_apply (Ds x) (f x) \\<noteq> 0;\n        closed S; S \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<^sub>F t in at_right 0.\n                            flow0 x t \\<notin> {x \\<in> S. s x = 0}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F t in at_right 0.\n     flow0 x t \\<notin> {xa \\<in> S. s xa = 0}", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F t in at_right 0.\n     flow0 x t \\<notin> {xa \\<in> S. s xa = 0}\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       flow0 x t \\<notin> {x \\<in> S. s x = 0}", "by simp"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F t in at_right 0. flow0 x t \\<notin> {x \\<in> S. s x = 0}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma section_closed[intro, simp]: \"section s Ds S \\<Longrightarrow> closed {x \\<in> S. s x = 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. section s Ds S \\<Longrightarrow> closed {x \\<in> S. s x = 0}", "by (auto intro!: closed_levelset_within simp: section_def\n      intro!: has_derivative_continuous_on has_derivative_at_withinI[where s=S])"], ["", "lemma return_time_continuous_belowI:\n  assumes ft: \"flowsto X0 T CX X1\"\n  assumes pos: \"\\<And>t. t \\<in> T \\<Longrightarrow> t > 0\"\n  assumes X0: \"fst ` X0 \\<subseteq> {x \\<in> S. s x = 0}\"\n  assumes CX: \"fst ` CX \\<inter> {x \\<in> S. s x = 0} = {}\"\n  assumes X1: \"fst ` X1 \\<subseteq> {x \\<in> S. s x = 0}\"\n  assumes sec: \"section s Ds S\"\n  assumes nz: \"\\<And>x. x \\<in> S \\<Longrightarrow> s x = 0 \\<Longrightarrow> Ds x (f x) \\<noteq> 0\"\n  assumes Dneg: \"(\\<lambda>x. (Ds x) (f x)) ` fst ` X0 \\<subseteq> {..<0}\"\n  assumes rel_int: \"\\<And>x. x \\<in> fst ` X1 \\<Longrightarrow> \\<forall>\\<^sub>F x in at x. s x = 0 \\<longrightarrow> x \\<in> S\"\n  assumes \"(x, d) \\<in> X0\"\n  shows \"continuous (at x within {x. s x \\<le> 0}) (return_time {x \\<in> S. s x = 0})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous (at x within {x. s x \\<le> 0})\n     (return_time {x \\<in> S. s x = 0})", "proof (rule return_time_continuous_below)"], ["proof (state)\ngoal (9 subgoals):\n 1. returns_to {x \\<in> S. s x = 0} x\n 2. \\<And>x. (s has_derivative blinfun_apply (?Ds x)) (at x)\n 3. closed S\n 4. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 5. \\<And>x. isCont ?Ds x\n 6. blinfun_apply (?Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 7. x \\<in> S\n 8. s x = 0\n 9. blinfun_apply (?Ds x) (f x) < 0", "from assms"], ["proof (chain)\npicking this:\n  flowsto X0 T CX X1\n  ?t2 \\<in> T \\<Longrightarrow> 0 < ?t2\n  fst ` X0 \\<subseteq> {x \\<in> S. s x = 0}\n  fst ` CX \\<inter> {x \\<in> S. s x = 0} = {}\n  fst ` X1 \\<subseteq> {x \\<in> S. s x = 0}\n  section s Ds S\n  \\<lbrakk>?x2 \\<in> S; s ?x2 = 0\\<rbrakk>\n  \\<Longrightarrow> blinfun_apply (Ds ?x2) (f ?x2) \\<noteq> 0\n  (\\<lambda>x. blinfun_apply (Ds x) (f x)) ` fst ` X0 \\<subseteq> {..<0}\n  ?x2 \\<in> fst ` X1 \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2. s x = 0 \\<longrightarrow> x \\<in> S\n  (x, d) \\<in> X0", "have \"x \\<in> S\" \"s x = 0\" \"x \\<in> {x \\<in> S. s x = 0}\""], ["proof (prove)\nusing this:\n  flowsto X0 T CX X1\n  ?t2 \\<in> T \\<Longrightarrow> 0 < ?t2\n  fst ` X0 \\<subseteq> {x \\<in> S. s x = 0}\n  fst ` CX \\<inter> {x \\<in> S. s x = 0} = {}\n  fst ` X1 \\<subseteq> {x \\<in> S. s x = 0}\n  section s Ds S\n  \\<lbrakk>?x2 \\<in> S; s ?x2 = 0\\<rbrakk>\n  \\<Longrightarrow> blinfun_apply (Ds ?x2) (f ?x2) \\<noteq> 0\n  (\\<lambda>x. blinfun_apply (Ds x) (f x)) ` fst ` X0 \\<subseteq> {..<0}\n  ?x2 \\<in> fst ` X1 \\<Longrightarrow>\n  \\<forall>\\<^sub>F x in at ?x2. s x = 0 \\<longrightarrow> x \\<in> S\n  (x, d) \\<in> X0\n\ngoal (1 subgoal):\n 1. x \\<in> S &&& s x = 0 &&& x \\<in> {x \\<in> S. s x = 0}", "by auto"], ["proof (state)\nthis:\n  x \\<in> S\n  s x = 0\n  x \\<in> {x \\<in> S. s x = 0}\n\ngoal (9 subgoals):\n 1. returns_to {x \\<in> S. s x = 0} x\n 2. \\<And>x. (s has_derivative blinfun_apply (?Ds x)) (at x)\n 3. closed S\n 4. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 5. \\<And>x. isCont ?Ds x\n 6. blinfun_apply (?Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 7. x \\<in> S\n 8. s x = 0\n 9. blinfun_apply (?Ds x) (f x) < 0", "note cs = section_closed[OF sec]"], ["proof (state)\nthis:\n  closed {x \\<in> S. s x = 0}\n\ngoal (9 subgoals):\n 1. returns_to {x \\<in> S. s x = 0} x\n 2. \\<And>x. (s has_derivative blinfun_apply (?Ds x)) (at x)\n 3. closed S\n 4. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 5. \\<And>x. isCont ?Ds x\n 6. blinfun_apply (?Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 7. x \\<in> S\n 8. s x = 0\n 9. blinfun_apply (?Ds x) (f x) < 0", "note sectionD[OF sec]"], ["proof (state)\nthis:\n  (s has_derivative blinfun_apply (Ds ?x)) (at ?x)\n  isCont Ds ?x\n  \\<lbrakk>?x \\<in> S; s ?x = 0\\<rbrakk>\n  \\<Longrightarrow> blinfun_apply (Ds ?x) (f ?x) \\<noteq> 0\n  closed S\n  S \\<subseteq> X\n\ngoal (9 subgoals):\n 1. returns_to {x \\<in> S. s x = 0} x\n 2. \\<And>x. (s has_derivative blinfun_apply (?Ds x)) (at x)\n 3. closed S\n 4. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 5. \\<And>x. isCont ?Ds x\n 6. blinfun_apply (?Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 7. x \\<in> S\n 8. s x = 0\n 9. blinfun_apply (?Ds x) (f x) < 0", "from flowstoE[OF ft \\<open>(x, d) \\<in> X0\\<close>]"], ["proof (chain)\npicking this:\n  (\\<And>h.\n      \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x;\n       (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1;\n       \\<And>h'.\n          h' \\<in> {0<--<h} \\<Longrightarrow>\n          (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain h\n    where h: \"h \\<in> T\"\n      \"h \\<in> existence_ivl0 x\"\n      \"(flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1\"\n      \"(\\<And>h'. h' \\<in> {0<--<h} \\<Longrightarrow> (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX)\""], ["proof (prove)\nusing this:\n  (\\<And>h.\n      \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x;\n       (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1;\n       \\<And>h'.\n          h' \\<in> {0<--<h} \\<Longrightarrow>\n          (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>h.\n        \\<lbrakk>h \\<in> T; h \\<in> existence_ivl0 x;\n         (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1;\n         \\<And>h'.\n            h' \\<in> {0<--<h} \\<Longrightarrow>\n            (flow0 x h', Dflow x h' o\\<^sub>L d) \\<in> CX\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  h \\<in> T\n  h \\<in> existence_ivl0 x\n  (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x ?h'2, Dflow x ?h'2 o\\<^sub>L d) \\<in> CX\n\ngoal (9 subgoals):\n 1. returns_to {x \\<in> S. s x = 0} x\n 2. \\<And>x. (s has_derivative blinfun_apply (?Ds x)) (at x)\n 3. closed S\n 4. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 5. \\<And>x. isCont ?Ds x\n 6. blinfun_apply (?Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 7. x \\<in> S\n 8. s x = 0\n 9. blinfun_apply (?Ds x) (f x) < 0", "show ret: \"returns_to {x \\<in> S. s x = 0} x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. returns_to {x \\<in> S. s x = 0} x", "apply (rule returns_toI)"], ["proof (prove)\ngoal (5 subgoals):\n 1. 0 < ?t\n 2. ?t \\<in> existence_ivl0 x\n 3. flow0 x ?t \\<in> {x \\<in> S. s x = 0}\n 4. \\<forall>\\<^sub>F t in at_right 0.\n       flow0 x t \\<notin> {x \\<in> S. s x = 0}\n 5. closed {x \\<in> S. s x = 0}", "apply (rule pos)"], ["proof (prove)\ngoal (5 subgoals):\n 1. ?t \\<in> T\n 2. ?t \\<in> existence_ivl0 x\n 3. flow0 x ?t \\<in> {x \\<in> S. s x = 0}\n 4. \\<forall>\\<^sub>F t in at_right 0.\n       flow0 x t \\<notin> {x \\<in> S. s x = 0}\n 5. closed {x \\<in> S. s x = 0}", "apply (rule h)"], ["proof (prove)\ngoal (4 subgoals):\n 1. h \\<in> existence_ivl0 x\n 2. flow0 x h \\<in> {x \\<in> S. s x = 0}\n 3. \\<forall>\\<^sub>F t in at_right 0.\n       flow0 x t \\<notin> {x \\<in> S. s x = 0}\n 4. closed {x \\<in> S. s x = 0}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. h \\<in> existence_ivl0 x", "by (rule h)"], ["proof (prove)\ngoal (3 subgoals):\n 1. flow0 x h \\<in> {x \\<in> S. s x = 0}\n 2. \\<forall>\\<^sub>F t in at_right 0.\n       flow0 x t \\<notin> {x \\<in> S. s x = 0}\n 3. closed {x \\<in> S. s x = 0}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. flow0 x h \\<in> {x \\<in> S. s x = 0}", "using h(3) X1"], ["proof (prove)\nusing this:\n  (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1\n  fst ` X1 \\<subseteq> {x \\<in> S. s x = 0}\n\ngoal (1 subgoal):\n 1. flow0 x h \\<in> {x \\<in> S. s x = 0}", "by auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       flow0 x t \\<notin> {x \\<in> S. s x = 0}\n 2. closed {x \\<in> S. s x = 0}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F t in at_right 0.\n       flow0 x t \\<notin> {x \\<in> S. s x = 0}", "apply (intro transversalD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. transversal {x \\<in> S. s x = 0}\n 2. x \\<in> {x \\<in> S. s x = 0}", "apply (rule transversal_section)"], ["proof (prove)\ngoal (2 subgoals):\n 1. section s ?Ds1 S\n 2. x \\<in> {x \\<in> S. s x = 0}", "apply (rule sec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> S. s x = 0}", "apply fact"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal (1 subgoal):\n 1. closed {x \\<in> S. s x = 0}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. closed {x \\<in> S. s x = 0}", "by fact"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  returns_to {x \\<in> S. s x = 0} x\n\ngoal (8 subgoals):\n 1. \\<And>x. (s has_derivative blinfun_apply (?Ds x)) (at x)\n 2. closed S\n 3. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 4. \\<And>x. isCont ?Ds x\n 5. blinfun_apply (?Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 6. x \\<in> S\n 7. s x = 0\n 8. blinfun_apply (?Ds x) (f x) < 0", "show \"(s has_derivative blinfun_apply (Ds x)) (at x)\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. (s has_derivative blinfun_apply (Ds x)) (at x)", "by fact"], ["proof (state)\nthis:\n  (s has_derivative blinfun_apply (Ds ?x2)) (at ?x2)\n\ngoal (7 subgoals):\n 1. closed S\n 2. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 3. \\<And>x. isCont Ds x\n 4. blinfun_apply (Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 5. x \\<in> S\n 6. s x = 0\n 7. blinfun_apply (Ds x) (f x) < 0", "show \"closed S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed S", "by fact"], ["proof (state)\nthis:\n  closed S\n\ngoal (6 subgoals):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 2. \\<And>x. isCont Ds x\n 3. blinfun_apply (Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 4. x \\<in> S\n 5. s x = 0\n 6. blinfun_apply (Ds x) (f x) < 0", "show \"isCont Ds x\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. isCont Ds x", "by fact"], ["proof (state)\nthis:\n  isCont Ds ?x2\n\ngoal (5 subgoals):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 2. blinfun_apply (Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 3. x \\<in> S\n 4. s x = 0\n 5. blinfun_apply (Ds x) (f x) < 0", "show \"x \\<in> S\" \"s x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> S &&& s x = 0", "by fact+"], ["proof (state)\nthis:\n  x \\<in> S\n  s x = 0\n\ngoal (3 subgoals):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 2. blinfun_apply (Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 3. blinfun_apply (Ds x) (f x) < 0", "let ?p = \"poincare_map {x \\<in> S. s x = 0} x\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 2. blinfun_apply (Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 3. blinfun_apply (Ds x) (f x) < 0", "have \"?p \\<in> {x \\<in> S. s x = 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. poincare_map {x \\<in> S. s x = 0} x \\<in> {x \\<in> S. s x = 0}", "using poincare_map_returns[OF ret cs]"], ["proof (prove)\nusing this:\n  poincare_map {x \\<in> S. s x = 0} x \\<in> {x \\<in> S. s x = 0}\n\ngoal (1 subgoal):\n 1. poincare_map {x \\<in> S. s x = 0} x \\<in> {x \\<in> S. s x = 0}", "."], ["proof (state)\nthis:\n  poincare_map {x \\<in> S. s x = 0} x \\<in> {x \\<in> S. s x = 0}\n\ngoal (3 subgoals):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 2. blinfun_apply (Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0\n 3. blinfun_apply (Ds x) (f x) < 0", "with nz"], ["proof (chain)\npicking this:\n  \\<lbrakk>?x2 \\<in> S; s ?x2 = 0\\<rbrakk>\n  \\<Longrightarrow> blinfun_apply (Ds ?x2) (f ?x2) \\<noteq> 0\n  poincare_map {x \\<in> S. s x = 0} x \\<in> {x \\<in> S. s x = 0}", "show \"Ds ?p (f ?p) \\<noteq> 0\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2 \\<in> S; s ?x2 = 0\\<rbrakk>\n  \\<Longrightarrow> blinfun_apply (Ds ?x2) (f ?x2) \\<noteq> 0\n  poincare_map {x \\<in> S. s x = 0} x \\<in> {x \\<in> S. s x = 0}\n\ngoal (1 subgoal):\n 1. blinfun_apply (Ds (poincare_map {x \\<in> S. s x = 0} x))\n     (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n    0", "by auto"], ["proof (state)\nthis:\n  blinfun_apply (Ds (poincare_map {x \\<in> S. s x = 0} x))\n   (f (poincare_map {x \\<in> S. s x = 0} x)) \\<noteq>\n  0\n\ngoal (2 subgoals):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S\n 2. blinfun_apply (Ds x) (f x) < 0", "from Dneg \\<open>(x, _) \\<in> X0\\<close>"], ["proof (chain)\npicking this:\n  (\\<lambda>x. blinfun_apply (Ds x) (f x)) ` fst ` X0 \\<subseteq> {..<0}\n  (x, d) \\<in> X0", "show \"Ds x (f x) < 0\""], ["proof (prove)\nusing this:\n  (\\<lambda>x. blinfun_apply (Ds x) (f x)) ` fst ` X0 \\<subseteq> {..<0}\n  (x, d) \\<in> X0\n\ngoal (1 subgoal):\n 1. blinfun_apply (Ds x) (f x) < 0", "by force"], ["proof (state)\nthis:\n  blinfun_apply (Ds x) (f x) < 0\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S", "from \\<open>_ \\<in> X1\\<close> X1 CX h"], ["proof (chain)\npicking this:\n  (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1\n  fst ` X1 \\<subseteq> {x \\<in> S. s x = 0}\n  fst ` CX \\<inter> {x \\<in> S. s x = 0} = {}\n  h \\<in> T\n  h \\<in> existence_ivl0 x\n  (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x ?h'2, Dflow x ?h'2 o\\<^sub>L d) \\<in> CX", "have \"return_time {x \\<in> S. s x = 0} x = h\""], ["proof (prove)\nusing this:\n  (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1\n  fst ` X1 \\<subseteq> {x \\<in> S. s x = 0}\n  fst ` CX \\<inter> {x \\<in> S. s x = 0} = {}\n  h \\<in> T\n  h \\<in> existence_ivl0 x\n  (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1\n  ?h'2 \\<in> {0<--<h} \\<Longrightarrow>\n  (flow0 x ?h'2, Dflow x ?h'2 o\\<^sub>L d) \\<in> CX\n\ngoal (1 subgoal):\n 1. return_time {x \\<in> S. s x = 0} x = h", "by (fastforce intro!: return_time_eqI cs pos h simp: open_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  return_time {x \\<in> S. s x = 0} x = h\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S", "then"], ["proof (chain)\npicking this:\n  return_time {x \\<in> S. s x = 0} x = h", "have \"?p \\<in> fst ` X1\""], ["proof (prove)\nusing this:\n  return_time {x \\<in> S. s x = 0} x = h\n\ngoal (1 subgoal):\n 1. poincare_map {x \\<in> S. s x = 0} x \\<in> fst ` X1", "using \\<open>_ \\<in> X1\\<close>"], ["proof (prove)\nusing this:\n  return_time {x \\<in> S. s x = 0} x = h\n  (flow0 x h, Dflow x h o\\<^sub>L d) \\<in> X1\n\ngoal (1 subgoal):\n 1. poincare_map {x \\<in> S. s x = 0} x \\<in> fst ` X1", "by (force simp: poincare_map_def)"], ["proof (state)\nthis:\n  poincare_map {x \\<in> S. s x = 0} x \\<in> fst ` X1\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S", "from rel_int[OF this]"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n     s x = 0 \\<longrightarrow> x \\<in> S", "show \" \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x). s x = 0 \\<longrightarrow> x \\<in> S\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n     s x = 0 \\<longrightarrow> x \\<in> S\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n       s x = 0 \\<longrightarrow> x \\<in> S", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at (poincare_map {x \\<in> S. s x = 0} x).\n     s x = 0 \\<longrightarrow> x \\<in> S\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"]]}