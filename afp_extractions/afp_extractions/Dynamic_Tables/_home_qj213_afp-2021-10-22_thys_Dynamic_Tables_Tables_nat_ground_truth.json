{"file_name": "/home/qj213/afp-2021-10-22/thys/Dynamic_Tables/Tables_nat.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Dynamic_Tables", "problem_names": ["lemma l0_gr0[arith]: \"l0 > 0\"", "lemma f1_l0: assumes \"l0 \\<le> l/c\" shows \"f1*(l/c) \\<le> f1*l - 1\"", "lemma invar_init: \"invar (0,l0)\"", "lemma invar_pres: assumes \"invar s\" shows \"invar(nxt f s)\"", "lemma aigr0[arith]: \"ai > 1\"", "lemma adgr0[arith]: \"ad > 0\"", "lemma f1'ad[arith]: \"f1'*ad > 0\"", "lemma f2'ai[arith]: \"f2'*ai > 0\"", "lemma Phi_Psi: \"\\<Phi> (n,l) = \\<Psi> (l0 \\<le> \\<lfloor>l/c\\<rfloor>) ai ad (f1'*l) (f2'*l) n\"", "lemma f1''_gr0[arith]: \"f1'' > 0\"", "lemma f2''_gr0[arith]: \"f2'' > 0\"", "lemma aigr0[arith]: \"ai > 0\"", "lemma adgr0[arith]: \"ad > 0\"", "lemma Phi_Psi: \"\\<Phi> (n,l) = \\<Psi> (l0 \\<le> \\<lfloor>l/c\\<rfloor>) ai ad (f1''*l) (f2''*l) n\"", "lemma l0_gr1: \"l0 > 1\"", "lemma f1''_less_f1': \"f1'' < f1'\"", "lemma f1_less_f1'': \"f1 < f1''\"", "lemma f2'_less_f2'': \"f2' < f2''\"", "lemma f2''_less_f2: \"f2'' < f2\"", "lemma f2f2'': \"(f2 - f2'')*l0 \\<ge> 1\"", "lemma f1''f1: \"(f1'' - f1)*c*l0 \\<ge> 1\"", "lemma f1''_f1': assumes \"l \\<ge> real l0\" shows \"f1''*(l+1) \\<le> f1' * l\"", "lemma f2'_f2'': assumes \"l \\<ge> real l0\" shows \"f2' * l \\<le> f2'' * (l-1)\""], "translations": [["", "lemma l0_gr0[arith]: \"l0 > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < l0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 0 < l0", "have \"0 < 1/(f2*(e-1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 / (f2 * (e - 1))", "by(simp)"], ["proof (state)\nthis:\n  0 < 1 / (f2 * (e - 1))\n\ngoal (1 subgoal):\n 1. 0 < l0", "also"], ["proof (state)\nthis:\n  0 < 1 / (f2 * (e - 1))\n\ngoal (1 subgoal):\n 1. 0 < l0", "note l0f2e"], ["proof (state)\nthis:\n  1 / (f2 * (e - 1)) \\<le> real l0\n\ngoal (1 subgoal):\n 1. 0 < l0", "finally"], ["proof (chain)\npicking this:\n  0 < real l0", "show ?thesis"], ["proof (prove)\nusing this:\n  0 < real l0\n\ngoal (1 subgoal):\n 1. 0 < l0", "by simp"], ["proof (state)\nthis:\n  0 < l0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma f1_l0: assumes \"l0 \\<le> l/c\" shows \"f1*(l/c) \\<le> f1*l - 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 * (l / c) \\<le> f1 * l - 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f1 * (l / c) \\<le> f1 * l - 1", "have \"1 = f1*((c-1)/c)*(c*(1/(f1*(c-1))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 = f1 * ((c - 1) / c) * (c * (1 / (f1 * (c - 1))))", "using f1'_le_f2' f2'_less_f2"], ["proof (prove)\nusing this:\n  f1' \\<le> f2'\n  f2' < f2\n\ngoal (1 subgoal):\n 1. 1 = f1 * ((c - 1) / c) * (c * (1 / (f1 * (c - 1))))", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  1 = f1 * ((c - 1) / c) * (c * (1 / (f1 * (c - 1))))\n\ngoal (1 subgoal):\n 1. f1 * (l / c) \\<le> f1 * l - 1", "also"], ["proof (state)\nthis:\n  1 = f1 * ((c - 1) / c) * (c * (1 / (f1 * (c - 1))))\n\ngoal (1 subgoal):\n 1. f1 * (l / c) \\<le> f1 * l - 1", "note l0f1c"], ["proof (state)\nthis:\n  1 / (f1 * (c - 1)) \\<le> real l0\n\ngoal (1 subgoal):\n 1. f1 * (l / c) \\<le> f1 * l - 1", "also"], ["proof (state)\nthis:\n  1 / (f1 * (c - 1)) \\<le> real l0\n\ngoal (1 subgoal):\n 1. f1 * (l / c) \\<le> f1 * l - 1", "have l': \"c*l0 \\<le> l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c * real l0 \\<le> l", "using assms(1)"], ["proof (prove)\nusing this:\n  real l0 \\<le> l / c\n\ngoal (1 subgoal):\n 1. c * real l0 \\<le> l", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  c * real l0 \\<le> l\n\ngoal (1 subgoal):\n 1. f1 * (l / c) \\<le> f1 * l - 1", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              f1 * ((c - 1) / c) * (c * x)\n              \\<le> f1 * ((c - 1) / c) * (c * y);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f1 * ((c - 1) / c) * x \\<le> f1 * ((c - 1) / c) * y\\<rbrakk>\n  \\<Longrightarrow> 1 \\<le> f1 * ((c - 1) / c) * l", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              f1 * ((c - 1) / c) * (c * x)\n              \\<le> f1 * ((c - 1) / c) * (c * y);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f1 * ((c - 1) / c) * x \\<le> f1 * ((c - 1) / c) * y\\<rbrakk>\n  \\<Longrightarrow> 1 \\<le> f1 * ((c - 1) / c) * l\n\ngoal (1 subgoal):\n 1. f1 * (l / c) \\<le> f1 * l - 1", "by(simp add: divide_le_cancel) (simp add: field_simps)"], ["proof (state)\nthis:\n  f1 * (l / c) \\<le> f1 * l - 1\n\ngoal:\nNo subgoals!", "qed"], ["", "fun nxt :: \"op\\<^sub>t\\<^sub>b \\<Rightarrow> nat*nat \\<Rightarrow> nat*nat\" where\n\"nxt Ins (n,l) =\n (n+1, if n+1 \\<le> f2*l then l else nat\\<lceil>e*l\\<rceil>)\" |\n\"nxt Del (n,l) =\n (n-1, if f1*l \\<le> real(n-1) then l else if l0 \\<le> \\<lfloor>l/c\\<rfloor> then nat\\<lfloor>l/c\\<rfloor> else l)\""], ["", "fun T :: \"op\\<^sub>t\\<^sub>b \\<Rightarrow> nat*nat \\<Rightarrow> real\" where\n\"T Ins (n,l) = (if n+1 \\<le> f2*l then 1 else n+1)\" |\n\"T Del (n,l) = (if f1*l \\<le> real(n-1) then 1 else if l0 \\<le> \\<lfloor>l/c\\<rfloor> then n else 1)\""], ["", "fun invar :: \"nat * nat \\<Rightarrow> bool\" where\n\"invar(n,l) = (l \\<ge> l0 \\<and> (\\<lfloor>l/c\\<rfloor> \\<ge> l0 \\<longrightarrow> f1*l \\<le> n) \\<and> n \\<le> f2*l)\""], ["", "lemma invar_init: \"invar (0,l0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (0, l0)", "by (auto simp: le_floor_iff field_simps)"], ["", "lemma invar_pres: assumes \"invar s\" shows \"invar(nxt f s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (nxt f s)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. invar (nxt f s)", "obtain n l where [simp]: \"s = (n,l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n l. s = (n, l) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  s = (n, l)\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "from assms"], ["proof (chain)\npicking this:\n  invar s", "have \"l0 \\<le> l\" and \"n \\<le> f2*l\""], ["proof (prove)\nusing this:\n  invar s\n\ngoal (1 subgoal):\n 1. l0 \\<le> l &&& real n \\<le> f2 * real l", "by auto"], ["proof (state)\nthis:\n  l0 \\<le> l\n  real n \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (nxt f s)", "proof (cases f)"], ["proof (state)\ngoal (2 subgoals):\n 1. f = Ins \\<Longrightarrow> invar (nxt f s)\n 2. f = Del \\<Longrightarrow> invar (nxt f s)", "case [simp]: Ins"], ["proof (state)\nthis:\n  f = Ins\n\ngoal (2 subgoals):\n 1. f = Ins \\<Longrightarrow> invar (nxt f s)\n 2. f = Del \\<Longrightarrow> invar (nxt f s)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (nxt f s)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "assume \"n+1 \\<le> f2*l\""], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * real l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "thus ?thesis"], ["proof (prove)\nusing this:\n  real (n + 1) \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "using assms"], ["proof (prove)\nusing this:\n  real (n + 1) \\<le> f2 * real l\n  invar s\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "by (auto)"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "assume 0: \"\\<not> n+1 \\<le> f2*l\""], ["proof (state)\nthis:\n  \\<not> real (n + 1) \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "have f1: \"f1 * \\<lceil>e*l\\<rceil> \\<le> n+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "have \"\\<lceil>e*l\\<rceil> \\<le> e*l + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_int \\<lceil>e * real l\\<rceil> \\<le> e * real l + 1", "by linarith"], ["proof (state)\nthis:\n  real_of_int \\<lceil>e * real l\\<rceil> \\<le> e * real l + 1\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "hence \"f1 * \\<lceil>e*l\\<rceil> \\<le> f1 * (e*l + 1)\""], ["proof (prove)\nusing this:\n  real_of_int \\<lceil>e * real l\\<rceil> \\<le> e * real l + 1\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f1 * (e * real l + 1)", "by simp"], ["proof (state)\nthis:\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f1 * (e * real l + 1)\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "also"], ["proof (state)\nthis:\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f1 * (e * real l + 1)\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "have \"\\<dots> \\<le> f2*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 * (e * real l + 1) \\<le> f2 * real l", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f1 * (e * real l + 1) \\<le> f2 * real l", "have \"f1 \\<le> (f2 - f1*e)*l0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 \\<le> (f2 - f1 * e) * real l0", "using l0f2f1e f1f2e"], ["proof (prove)\nusing this:\n  f1 / (f2 - f1 * e) \\<le> real l0\n  f1 < f2 / e\n\ngoal (1 subgoal):\n 1. f1 \\<le> (f2 - f1 * e) * real l0", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  f1 \\<le> (f2 - f1 * e) * real l0\n\ngoal (1 subgoal):\n 1. f1 * (e * real l + 1) \\<le> f2 * real l", "also"], ["proof (state)\nthis:\n  f1 \\<le> (f2 - f1 * e) * real l0\n\ngoal (1 subgoal):\n 1. f1 * (e * real l + 1) \\<le> f2 * real l", "note \\<open>l0 \\<le> l\\<close>"], ["proof (state)\nthis:\n  l0 \\<le> l\n\ngoal (1 subgoal):\n 1. f1 * (e * real l + 1) \\<le> f2 * real l", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (f2 - f1 * e) * real x \\<le> (f2 - f1 * e) * real y) \\<Longrightarrow>\n  f1 \\<le> (f2 - f1 * e) * real l", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (f2 - f1 * e) * real x \\<le> (f2 - f1 * e) * real y) \\<Longrightarrow>\n  f1 \\<le> (f2 - f1 * e) * real l\n\ngoal (1 subgoal):\n 1. f1 * (e * real l + 1) \\<le> f2 * real l", "using f1f2e[simplified field_simps]"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (f2 - f1 * e) * real x \\<le> (f2 - f1 * e) * real y) \\<Longrightarrow>\n  f1 \\<le> (f2 - f1 * e) * real l\n  e * f1 < f2\n\ngoal (1 subgoal):\n 1. f1 * (e * real l + 1) \\<le> f2 * real l", "by (simp add:ac_simps mult_left_mono) (simp add:algebra_simps)"], ["proof (state)\nthis:\n  f1 * (e * real l + 1) \\<le> f2 * real l\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f1 * (e * real l + 1) \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "finally"], ["proof (chain)\npicking this:\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f2 * real l", "show ?thesis"], ["proof (prove)\nusing this:\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "using 0"], ["proof (prove)\nusing this:\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f2 * real l\n  \\<not> real (n + 1) \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "by linarith"], ["proof (state)\nthis:\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "have \"n+1 \\<le> f2*e*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "have \"n+1 \\<le> f2*l+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * real l + 1", "using \\<open>n \\<le> f2*l\\<close>"], ["proof (prove)\nusing this:\n  real n \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * real l + 1", "by linarith"], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * real l + 1\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "also"], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * real l + 1\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "have \"1 = f2*(e-1)*(1/(f2*(e-1)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 = f2 * (e - 1) * (1 / (f2 * (e - 1)))", "by(simp)"], ["proof (state)\nthis:\n  1 = f2 * (e - 1) * (1 / (f2 * (e - 1)))\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "also"], ["proof (state)\nthis:\n  1 = f2 * (e - 1) * (1 / (f2 * (e - 1)))\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "note l0f2e"], ["proof (state)\nthis:\n  1 / (f2 * (e - 1)) \\<le> real l0\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "also"], ["proof (state)\nthis:\n  1 / (f2 * (e - 1)) \\<le> real l0\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "note \\<open>l0 \\<le> l\\<close>"], ["proof (state)\nthis:\n  l0 \\<le> l\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              f2 * real l + f2 * (e - 1) * x\n              \\<le> f2 * real l + f2 * (e - 1) * y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f2 * real l + f2 * (e - 1) * real x\n      \\<le> f2 * real l + f2 * (e - 1) * real y\\<rbrakk>\n  \\<Longrightarrow> real (n + 1) \\<le> f2 * real l + f2 * (e - 1) * real l", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              f2 * real l + f2 * (e - 1) * x\n              \\<le> f2 * real l + f2 * (e - 1) * y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f2 * real l + f2 * (e - 1) * real x\n      \\<le> f2 * real l + f2 * (e - 1) * real y\\<rbrakk>\n  \\<Longrightarrow> real (n + 1) \\<le> f2 * real l + f2 * (e - 1) * real l\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * e * real l", "by simp (simp add: algebra_simps)"], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * e * real l\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "also"], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "have \"f2*e*l \\<le> f2*\\<lceil>e*l\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2 * e * real l \\<le> f2 * real_of_int \\<lceil>e * real l\\<rceil>", "by simp"], ["proof (state)\nthis:\n  f2 * e * real l \\<le> f2 * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "finally"], ["proof (chain)\npicking this:\n  real (n + 1) \\<le> f2 * real_of_int \\<lceil>e * real l\\<rceil>", "have f2: \"n+1 \\<le> f2*\\<lceil>e*l\\<rceil>\""], ["proof (prove)\nusing this:\n  real (n + 1) \\<le> f2 * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. real (n + 1) \\<le> f2 * real_of_int \\<lceil>e * real l\\<rceil>", "."], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "have \"l < e*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l < e * real l", "using \\<open>l0 \\<le> l\\<close>"], ["proof (prove)\nusing this:\n  l0 \\<le> l\n\ngoal (1 subgoal):\n 1. real l < e * real l", "by simp"], ["proof (state)\nthis:\n  real l < e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "hence \"l0 \\<le> e*l\""], ["proof (prove)\nusing this:\n  real l < e * real l\n\ngoal (1 subgoal):\n 1. real l0 \\<le> e * real l", "using \\<open>l0\\<le>l\\<close>"], ["proof (prove)\nusing this:\n  real l < e * real l\n  l0 \\<le> l\n\ngoal (1 subgoal):\n 1. real l0 \\<le> e * real l", "by linarith"], ["proof (state)\nthis:\n  real l0 \\<le> e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow> invar (nxt f s)", "with 0 f1 f2"], ["proof (chain)\npicking this:\n  \\<not> real (n + 1) \\<le> f2 * real l\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)\n  real (n + 1) \\<le> f2 * real_of_int \\<lceil>e * real l\\<rceil>\n  real l0 \\<le> e * real l", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<not> real (n + 1) \\<le> f2 * real l\n  f1 * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)\n  real (n + 1) \\<le> f2 * real_of_int \\<lceil>e * real l\\<rceil>\n  real l0 \\<le> e * real l\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "by (auto simp add: field_simps) linarith"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow> invar (nxt f s)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow> invar (nxt f s)", "case [simp]: Del"], ["proof (state)\nthis:\n  f = Del\n\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow> invar (nxt f s)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (nxt f s)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "assume \"f1*l \\<le> real n - 1\""], ["proof (state)\nthis:\n  f1 * real l \\<le> real n - 1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "thus ?thesis"], ["proof (prove)\nusing this:\n  f1 * real l \\<le> real n - 1\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "using assms"], ["proof (prove)\nusing this:\n  f1 * real l \\<le> real n - 1\n  invar s\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "by(auto)"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal (1 subgoal):\n 1. \\<not> f1 * real l \\<le> real n - 1 \\<Longrightarrow> invar (nxt f s)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> f1 * real l \\<le> real n - 1 \\<Longrightarrow> invar (nxt f s)", "assume 0: \"\\<not> f1*l \\<le> real n - 1\""], ["proof (state)\nthis:\n  \\<not> f1 * real l \\<le> real n - 1\n\ngoal (1 subgoal):\n 1. \\<not> f1 * real l \\<le> real n - 1 \\<Longrightarrow> invar (nxt f s)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (nxt f s)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "assume \"n=0\""], ["proof (state)\nthis:\n  n = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "thus ?thesis"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "using 0 assms"], ["proof (prove)\nusing this:\n  n = 0\n  \\<not> f1 * real l \\<le> real n - 1\n  invar s\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow> invar (nxt f s)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow> invar (nxt f s)", "assume \"n \\<noteq> 0\""], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow> invar (nxt f s)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (nxt f s)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "assume l: \"l0 \\<le> \\<lfloor>l/c\\<rfloor>\""], ["proof (state)\nthis:\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "hence l': \"l0 \\<le> l/c\""], ["proof (prove)\nusing this:\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. real l0 \\<le> real l / c", "by linarith"], ["proof (state)\nthis:\n  real l0 \\<le> real l / c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "have \"f1 * \\<lfloor>l/c\\<rfloor> \\<le> f1*(l/c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f1 * (real l / c)", "by(simp del: times_divide_eq_right)"], ["proof (state)\nthis:\n  f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f1 * (real l / c)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "hence f1: \"f1*\\<lfloor>l/c\\<rfloor> \\<le> n-1\""], ["proof (prove)\nusing this:\n  f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f1 * (real l / c)\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real (n - 1)", "using l' f1_l0[OF l'] assms \\<open>n \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f1 * (real l / c)\n  real l0 \\<le> real l / c\n  f1 * (real l / c) \\<le> f1 * real l - 1\n  invar s\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real (n - 1)", "by(simp add: le_floor_iff)"], ["proof (state)\nthis:\n  f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real (n - 1)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "have \"n-1 \\<le> f2 * \\<lfloor>l/c\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "have \"n-1 < f1*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n - 1) < f1 * real l", "using 0 \\<open>n \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  \\<not> f1 * real l \\<le> real n - 1\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. real (n - 1) < f1 * real l", "by linarith"], ["proof (state)\nthis:\n  real (n - 1) < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "also"], ["proof (state)\nthis:\n  real (n - 1) < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "have \"f1*l \\<le> f2*(l/c) - f2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2 * (real l / c) - f2", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2 * (real l / c) - f2", "have \"(f2 - f1*c)*l0 \\<ge> f2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2 \\<le> (f2 - f1 * c) * real l0", "using l0f2f1c f1cf2"], ["proof (prove)\nusing this:\n  f2 / (f2 - f1 * c) \\<le> real l0\n  f1 * c < f2\n\ngoal (1 subgoal):\n 1. f2 \\<le> (f2 - f1 * c) * real l0", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  f2 \\<le> (f2 - f1 * c) * real l0\n\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2 * (real l / c) - f2", "with mult_left_mono[OF \\<open>l0 \\<le> l/c\\<close>, of \"f2-f1*c\"] f1cf2"], ["proof (chain)\npicking this:\n  0 \\<le> f2 - f1 * c \\<Longrightarrow>\n  (f2 - f1 * c) * real l0 \\<le> (f2 - f1 * c) * (real l / c)\n  f1 * c < f2\n  f2 \\<le> (f2 - f1 * c) * real l0", "have \"(f2 - f1*c)*(l/c) \\<ge> f2\""], ["proof (prove)\nusing this:\n  0 \\<le> f2 - f1 * c \\<Longrightarrow>\n  (f2 - f1 * c) * real l0 \\<le> (f2 - f1 * c) * (real l / c)\n  f1 * c < f2\n  f2 \\<le> (f2 - f1 * c) * real l0\n\ngoal (1 subgoal):\n 1. f2 \\<le> (f2 - f1 * c) * (real l / c)", "by linarith"], ["proof (state)\nthis:\n  f2 \\<le> (f2 - f1 * c) * (real l / c)\n\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2 * (real l / c) - f2", "thus ?thesis"], ["proof (prove)\nusing this:\n  f2 \\<le> (f2 - f1 * c) * (real l / c)\n\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2 * (real l / c) - f2", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  f1 * real l \\<le> f2 * (real l / c) - f2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f1 * real l \\<le> f2 * (real l / c) - f2\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "also"], ["proof (state)\nthis:\n  f1 * real l \\<le> f2 * (real l / c) - f2\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "have \"\\<dots> \\<le> f2*\\<lfloor>l/c\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2 * (real l / c) - f2\n    \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f2 * (real l / c) - f2\n    \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "have \"l/c - 1 \\<le> \\<lfloor>l/c\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l / c - 1 \\<le> real_of_int \\<lfloor>real l / c\\<rfloor>", "by linarith"], ["proof (state)\nthis:\n  real l / c - 1 \\<le> real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. f2 * (real l / c) - f2\n    \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "from mult_left_mono[OF this, of f2]"], ["proof (chain)\npicking this:\n  0 \\<le> f2 \\<Longrightarrow>\n  f2 * (real l / c - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "show ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> f2 \\<Longrightarrow>\n  f2 * (real l / c - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. f2 * (real l / c) - f2\n    \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  f2 * (real l / c) - f2 \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f2 * (real l / c) - f2 \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "finally"], ["proof (chain)\npicking this:\n  real (n - 1) < f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "show ?thesis"], ["proof (prove)\nusing this:\n  real (n - 1) < f2 * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "using 0 \\<open>n \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  real (n - 1) < f2 * real_of_int \\<lfloor>real l / c\\<rfloor>\n  \\<not> f1 * real l \\<le> real n - 1\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "by linarith"], ["proof (state)\nthis:\n  real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> invar (nxt f s)\n 2. \\<not> ?P \\<Longrightarrow> invar (nxt f s)", "with l 0 f1 \\<open>n \\<noteq> 0\\<close>"], ["proof (chain)\npicking this:\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n  \\<not> f1 * real l \\<le> real n - 1\n  f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real (n - 1)\n  n \\<noteq> 0\n  real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>", "show ?thesis"], ["proof (prove)\nusing this:\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n  \\<not> f1 * real l \\<le> real n - 1\n  f1 * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real (n - 1)\n  n \\<noteq> 0\n  real (n - 1) \\<le> f2 * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "by (auto)"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal (1 subgoal):\n 1. \\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    invar (nxt f s)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    invar (nxt f s)", "assume \"\\<not> l0 \\<le> \\<lfloor>l/c\\<rfloor>\""], ["proof (state)\nthis:\n  \\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    invar (nxt f s)", "with 0 assms"], ["proof (chain)\npicking this:\n  \\<not> f1 * real l \\<le> real n - 1\n  invar s\n  \\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor>", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<not> f1 * real l \\<le> real n - 1\n  invar s\n  \\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. invar (nxt f s)", "by (auto simp add: field_simps)"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  invar (nxt f s)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "locale Table1 = TableInv +\nassumes f2f2': \"l0 \\<ge> 1/(f2 - f2')\"\nassumes f1'f1: \"l0 \\<ge> 1/((f1' - f1)*c)\"\nbegin"], ["", "definition \"ai = f2/(f2-f2')\""], ["", "definition \"ad = f1/(f1'-f1)\""], ["", "lemma aigr0[arith]: \"ai > 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < ai", "using f2'_less_f2"], ["proof (prove)\nusing this:\n  f2' < f2\n\ngoal (1 subgoal):\n 1. 1 < ai", "by(simp add: ai_def field_simps)"], ["", "lemma adgr0[arith]: \"ad > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < ad", "using f1_less_f1'"], ["proof (prove)\nusing this:\n  f1 < f1'\n\ngoal (1 subgoal):\n 1. 0 < ad", "by(simp add: ad_def field_simps)"], ["", "lemma f1'ad[arith]: \"f1'*ad > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < f1' * ad", "by simp"], ["", "lemma f2'ai[arith]: \"f2'*ai > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < f2' * ai", "by simp"], ["", "fun \\<Phi> :: \"nat * nat \\<Rightarrow> real\" where\n\"\\<Phi> (n,l) = (if n \\<ge> f2'*l then ai*(n - f2'*l) else\n  if n \\<le> f1'*l \\<and> l0 \\<le> \\<lfloor>l/c\\<rfloor> then ad*(f1'*l - n) else 0)\""], ["", "lemma Phi_Psi: \"\\<Phi> (n,l) = \\<Psi> (l0 \\<le> \\<lfloor>l/c\\<rfloor>) ai ad (f1'*l) (f2'*l) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Phi> (n, l) =\n    \\<Psi> (int l0 \\<le> \\<lfloor>real l / c\\<rfloor>) ai ad (f1' * real l)\n     (f2' * real l) n", "by(simp)"], ["", "abbreviation \"U \\<equiv> \\<lambda>f _. case f of Ins \\<Rightarrow> ai+1 + f1'*ad | Del \\<Rightarrow> ad+1 + f2'*ai\""], ["", "interpretation tb: Amortized\n  where init = \"(0,l0)\" and nxt = nxt\n  and inv = invar\n  and T = T and \\<Phi> = \\<Phi>\n  and U = U"], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized (0, l0) nxt invar T \\<Phi> U", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. invar (0, l0)\n 2. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 3. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 4. \\<Phi> (0, l0) = 0\n 5. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. invar (0, l0)\n 2. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 3. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 4. \\<Phi> (0, l0) = 0\n 5. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (0, l0)", "by (fact invar_init)"], ["proof (state)\nthis:\n  invar (0, l0)\n\ngoal (4 subgoals):\n 1. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 2. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> (0, l0) = 0\n 4. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 2. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> (0, l0) = 0\n 4. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "case 2"], ["proof (state)\nthis:\n  invar s_\n\ngoal (4 subgoals):\n 1. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 2. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> (0, l0) = 0\n 4. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "thus ?case"], ["proof (prove)\nusing this:\n  invar s_\n\ngoal (1 subgoal):\n 1. invar (nxt f_ s_)", "by(fact invar_pres)"], ["proof (state)\nthis:\n  invar (nxt f_ s_)\n\ngoal (3 subgoals):\n 1. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> (0, l0) = 0\n 3. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> (0, l0) = 0\n 3. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "case (3 s)"], ["proof (state)\nthis:\n  invar s\n\ngoal (3 subgoals):\n 1. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> (0, l0) = 0\n 3. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "thus ?case"], ["proof (prove)\nusing this:\n  invar s\n\ngoal (1 subgoal):\n 1. 0 \\<le> \\<Phi> s", "by(cases s)(simp split: if_splits)"], ["proof (state)\nthis:\n  0 \\<le> \\<Phi> s\n\ngoal (2 subgoals):\n 1. \\<Phi> (0, l0) = 0\n 2. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<Phi> (0, l0) = 0\n 2. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<Phi> (0, l0) = 0\n 2. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Phi> (0, l0) = 0", "by(auto simp: field_simps mult_le_0_iff le_floor_iff)"], ["proof (state)\nthis:\n  \\<Phi> (0, l0) = 0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "case (5 s f)"], ["proof (state)\nthis:\n  invar s\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "obtain n l where [simp]: \"s = (n,l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n l. s = (n, l) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  s = (n, l)\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n              | Del \\<Rightarrow> ad + 1 + f2' * ai)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "proof (cases f)"], ["proof (state)\ngoal (2 subgoals):\n 1. f = Ins \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "case [simp]: Ins"], ["proof (state)\nthis:\n  f = Ins\n\ngoal (2 subgoals):\n 1. f = Ins \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "show ?thesis (is \"?A \\<le> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "assume \"n+1 \\<le> f2*l\""], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * real l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "hence \"?A \\<le> ai+1\""], ["proof (prove)\nusing this:\n  real (n + 1) \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> ai + 1", "by(simp del: \\<Phi>.simps \\<Psi>.simps add: Phi_Psi Psi_diff_Ins)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> ai + 1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "thus ?thesis"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> ai + 1\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "by simp"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "assume [arith]: \"\\<not> n+1 \\<le> f2*l\""], ["proof (state)\nthis:\n  \\<not> real (n + 1) \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have [arith]: \"l \\<ge> l0\"  \"n \\<le> f2*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l0 \\<le> l &&& real n \\<le> f2 * real l", "using 5"], ["proof (prove)\nusing this:\n  invar s\n\ngoal (1 subgoal):\n 1. l0 \\<le> l &&& real n \\<le> f2 * real l", "by auto"], ["proof (state)\nthis:\n  l0 \\<le> l\n  real n \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have \"(f2 - f2')*l \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2') * real l", "using mult_mono[OF order_refl, of l0 l \"f2-f2'\"] f2'_less_f2 f2f2'"], ["proof (prove)\nusing this:\n  \\<lbrakk>real l0 \\<le> real l; 0 \\<le> f2 - f2'; 0 \\<le> real l0\\<rbrakk>\n  \\<Longrightarrow> (f2 - f2') * real l0 \\<le> (f2 - f2') * real l\n  f2' < f2\n  1 / (f2 - f2') \\<le> real l0\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2') * real l", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  1 \\<le> (f2 - f2') * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "hence \"n \\<ge> f2'*l\""], ["proof (prove)\nusing this:\n  1 \\<le> (f2 - f2') * real l\n\ngoal (1 subgoal):\n 1. f2' * real l \\<le> real n", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  f2' * real l \\<le> real n\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "hence Phi: \"\\<Phi> s = ai * (n - f2'*l)\""], ["proof (prove)\nusing this:\n  f2' * real l \\<le> real n\n\ngoal (1 subgoal):\n 1. \\<Phi> s = ai * (real n - f2' * real l)", "by simp"], ["proof (state)\nthis:\n  \\<Phi> s = ai * (real n - f2' * real l)\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have [simp]: \"real (nat \\<lceil>e*l\\<rceil>) = real_of_int \\<lceil>e*l\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (nat \\<lceil>e * real l\\<rceil>) =\n    real_of_int \\<lceil>e * real l\\<rceil>", "by (simp add: order.order_iff_strict)"], ["proof (state)\nthis:\n  real (nat \\<lceil>e * real l\\<rceil>) =\n  real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have \"?A \\<le> n - ai*(f2 - f2')*l + ai + 1 + f1'*ad\" (is \"_ \\<le> ?R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "assume f2': \"n+1 < f2'*\\<lceil>e*l\\<rceil>\""], ["proof (state)\nthis:\n  real (n + 1) < f2' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "assume \"n+1 \\<le> f1'*\\<lceil>e*l\\<rceil>\""], ["proof (state)\nthis:\n  real (n + 1) \\<le> f1' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "hence \"?A \\<le> n+1 + ad*(f1'*\\<lceil>e*l\\<rceil>-(n+1)) - ai*(n - f2'*l)\""], ["proof (prove)\nusing this:\n  real (n + 1) \\<le> f1' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real (n + 1) +\n          ad *\n          (f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1)) -\n          ai * (real n - f2' * real l)", "using Phi f2'"], ["proof (prove)\nusing this:\n  real (n + 1) \\<le> f1' * real_of_int \\<lceil>e * real l\\<rceil>\n  \\<Phi> s = ai * (real n - f2' * real l)\n  real (n + 1) < f2' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real (n + 1) +\n          ad *\n          (f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1)) -\n          ai * (real n - f2' * real l)", "by (simp add: )"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real (n + 1) +\n        ad * (f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1)) -\n        ai * (real n - f2' * real l)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real (n + 1) +\n        ad * (f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1)) -\n        ai * (real n - f2' * real l)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"f1'*\\<lceil>e*l\\<rceil> - (n+1) \\<le> f1'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'", "have \"f1'*\\<lceil>e*l\\<rceil> \\<le> f1'*(e*l + 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil>\n    \\<le> f1' * (e * real l + 1)", "by(simp)"], ["proof (state)\nthis:\n  f1' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f1' * (e * real l + 1)\n\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'", "also"], ["proof (state)\nthis:\n  f1' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f1' * (e * real l + 1)\n\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'", "have \"\\<dots> = f1'*e*l + f1'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1' * (e * real l + 1) = f1' * e * real l + f1'", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  f1' * (e * real l + 1) = f1' * e * real l + f1'\n\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'", "also"], ["proof (state)\nthis:\n  f1' * (e * real l + 1) = f1' * e * real l + f1'\n\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'", "have \"f1'*e*l \\<le> f2*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1' * e * real l \\<le> f2 * real l", "using f1'ef2"], ["proof (prove)\nusing this:\n  f1' * e \\<le> f2\n\ngoal (1 subgoal):\n 1. f1' * e * real l \\<le> f2 * real l", "by(simp)"], ["proof (state)\nthis:\n  f1' * e * real l \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> x + f1' \\<le> y + f1') \\<Longrightarrow>\n  f1' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f2 * real l + f1'", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> x + f1' \\<le> y + f1') \\<Longrightarrow>\n  f1' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> f2 * real l + f1'\n\ngoal (1 subgoal):\n 1. f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'", "by linarith"], ["proof (state)\nthis:\n  f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  f1' * real_of_int \\<lceil>e * real l\\<rceil> - real (n + 1) \\<le> f1'\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"n+1+ad*f1'-ai*(n-f2'*l) = n+ai*(-real(n+1)+f2'*l)+ai+f1'*ad+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n + 1) + ad * f1' - ai * (real n - f2' * real l) =\n    real n + ai * (- real (n + 1) + f2' * real l) + ai + f1' * ad + 1", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real (n + 1) + ad * f1' - ai * (real n - f2' * real l) =\n  real n + ai * (- real (n + 1) + f2' * real l) + ai + f1' * ad + 1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  real (n + 1) + ad * f1' - ai * (real n - f2' * real l) =\n  real n + ai * (- real (n + 1) + f2' * real l) + ai + f1' * ad + 1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"-real(n+1) \\<le> -f2*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - real (n + 1) \\<le> - f2 * real l", "by linarith"], ["proof (state)\nthis:\n  - real (n + 1) \\<le> - f2 * real l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real (n + 1) + ad * x - ai * (real n - f2' * real l)\n              \\<le> real (n + 1) + ad * y - ai * (real n - f2' * real l);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x + f2' * real l) + ai + f1' * ad + 1\n      \\<le> real n + ai * (y + f2' * real l) + ai + f1' * ad + 1\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n + ai * (- f2 * real l + f2' * real l) +\n                          ai +\n                          f1' * ad +\n                          1", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real (n + 1) + ad * x - ai * (real n - f2' * real l)\n              \\<le> real (n + 1) + ad * y - ai * (real n - f2' * real l);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x + f2' * real l) + ai + f1' * ad + 1\n      \\<le> real n + ai * (y + f2' * real l) + ai + f1' * ad + 1\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n + ai * (- f2 * real l + f2' * real l) +\n                          ai +\n                          f1' * ad +\n                          1\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "(* f1'*ad *)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "assume \"\\<not> n+1 \\<le> f1'*\\<lceil>e*l\\<rceil>\""], ["proof (state)\nthis:\n  \\<not> real (n + 1) \\<le> f1' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "hence \"?A = n+1 - ai*(n - f2'*l)\""], ["proof (prove)\nusing this:\n  \\<not> real (n + 1) \\<le> f1' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real (n + 1) - ai * (real n - f2' * real l)", "using Phi f2'"], ["proof (prove)\nusing this:\n  \\<not> real (n + 1) \\<le> f1' * real_of_int \\<lceil>e * real l\\<rceil>\n  \\<Phi> s = ai * (real n - f2' * real l)\n  real (n + 1) < f2' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real (n + 1) - ai * (real n - f2' * real l)", "by (simp)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real (n + 1) - ai * (real n - f2' * real l)\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real (n + 1) - ai * (real n - f2' * real l)\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"n+1-ai*(n-f2'*l) = n+ai*(-real(n+1)+f2'*l)+ai+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n + 1) - ai * (real n - f2' * real l) =\n    real n + ai * (- real (n + 1) + f2' * real l) + ai + 1", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real (n + 1) - ai * (real n - f2' * real l) =\n  real n + ai * (- real (n + 1) + f2' * real l) + ai + 1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  real (n + 1) - ai * (real n - f2' * real l) =\n  real n + ai * (- real (n + 1) + f2' * real l) + ai + 1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"-real(n+1) \\<le> -f2*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - real (n + 1) \\<le> - f2 * real l", "by linarith"], ["proof (state)\nthis:\n  - real (n + 1) \\<le> - f2 * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  - real (n + 1) \\<le> - f2 * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"n+ai*(-f2*l+f2'*l)+ai+1 \\<le> ?R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n + ai * (- f2 * real l + f2' * real l) + ai + 1\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n + ai * (- f2 * real l + f2' * real l) + ai + 1\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           \\<le> f1' *\n                 real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x + f2' * real l) + ai + 1\n      \\<le> real n + ai * (y + f2' * real l) + ai + 1) \\<Longrightarrow>\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x + f2' * real l) + ai + 1\n      \\<le> real n + ai * (y + f2' * real l) + ai + 1) \\<Longrightarrow>\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "by(simp)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "assume \"\\<not> n+1 < f2'*\\<lceil>e*l\\<rceil>\""], ["proof (state)\nthis:\n  \\<not> real (n + 1) < f2' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "hence \"?A = n + ai*(-f2'*\\<lceil>e*l\\<rceil> + f2'*l) + ai+1\""], ["proof (prove)\nusing this:\n  \\<not> real (n + 1) < f2' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ai * (- f2' * real_of_int \\<lceil>e * real l\\<rceil> + f2' * real l) +\n    ai +\n    1", "using Phi"], ["proof (prove)\nusing this:\n  \\<not> real (n + 1) < f2' * real_of_int \\<lceil>e * real l\\<rceil>\n  \\<Phi> s = ai * (real n - f2' * real l)\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ai * (- f2' * real_of_int \\<lceil>e * real l\\<rceil> + f2' * real l) +\n    ai +\n    1", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ai * (- f2' * real_of_int \\<lceil>e * real l\\<rceil> + f2' * real l) +\n  ai +\n  1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ai * (- f2' * real_of_int \\<lceil>e * real l\\<rceil> + f2' * real l) +\n  ai +\n  1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"-f2'*\\<lceil>e*l\\<rceil> \\<le> -f2'*e*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> - f2' * e * real l", "by(simp)"], ["proof (state)\nthis:\n  - f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> - f2' * e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  - f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> - f2' * e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"-f2'*e \\<le> -f2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - f2' * e \\<le> - f2", "using f2_le_f2'e"], ["proof (prove)\nusing this:\n  f2 \\<le> f2' * e\n\ngoal (1 subgoal):\n 1. - f2' * e \\<le> - f2", "by linarith"], ["proof (state)\nthis:\n  - f2' * e \\<le> - f2\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "also"], ["proof (state)\nthis:\n  - f2' * e \\<le> - f2\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "have \"n+ai*(-f2*l+f2'*l)+ai+1 \\<le> ?R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n + ai * (- f2 * real l + f2' * real l) + ai + 1\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n + ai * (- f2 * real l + f2' * real l) + ai + 1\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ai * (x + f2' * real l) + ai + 1\n              \\<le> real n + ai * (y + f2' * real l) + ai + 1;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x * real l + f2' * real l) + ai + 1\n      \\<le> real n + ai * (y * real l + f2' * real l) + ai + 1\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 +\n                          f1' * ad", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ai * (x + f2' * real l) + ai + 1\n              \\<le> real n + ai * (y + f2' * real l) + ai + 1;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x * real l + f2' * real l) + ai + 1\n      \\<le> real n + ai * (y * real l + f2' * real l) + ai + 1\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 +\n                          f1' * ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad", "by(simp)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have \"\\<dots> = n - f2*l + ai+f1'*ad+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad =\n    real n - f2 * real l + ai + f1' * ad + 1", "using f2'_less_f2"], ["proof (prove)\nusing this:\n  f2' < f2\n\ngoal (1 subgoal):\n 1. real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad =\n    real n - f2 * real l + ai + f1' * ad + 1", "by(simp add: ai_def)"], ["proof (state)\nthis:\n  real n - ai * (f2 - f2') * real l + ai + 1 + f1' * ad =\n  real n - f2 * real l + ai + f1' * ad + 1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "finally"], ["proof (chain)\npicking this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - f2 * real l + ai + f1' * ad + 1", "show ?thesis"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - f2 * real l + ai + f1' * ad + 1\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "by simp"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "case [simp]: Del"], ["proof (state)\nthis:\n  f = Del\n\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have [arith]: \"l \\<ge> l0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l0 \\<le> l", "using 5"], ["proof (prove)\nusing this:\n  invar s\n\ngoal (1 subgoal):\n 1. l0 \\<le> l", "by simp"], ["proof (state)\nthis:\n  l0 \\<le> l\n\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "assume \"n=0\""], ["proof (state)\nthis:\n  n = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "with 5"], ["proof (chain)\npicking this:\n  invar s\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  invar s\n  n = 0\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "by(simp add: mult_le_0_iff field_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "assume [arith]: \"n\\<noteq>0\""], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "show ?thesis (is \"?A \\<le> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "assume \"real n - 1 \\<ge> f1*l \\<or> \\<lfloor>l/c\\<rfloor> < l0\""], ["proof (state)\nthis:\n  f1 * real l \\<le> real n - 1 \\<or> \\<lfloor>real l / c\\<rfloor> < int l0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "hence \"?A \\<le> ad+1\""], ["proof (prove)\nusing this:\n  f1 * real l \\<le> real n - 1 \\<or> \\<lfloor>real l / c\\<rfloor> < int l0\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> ad + 1", "using f1'_le_f2'"], ["proof (prove)\nusing this:\n  f1 * real l \\<le> real n - 1 \\<or> \\<lfloor>real l / c\\<rfloor> < int l0\n  f1' \\<le> f2'\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> ad + 1", "by(auto simp del: \\<Phi>.simps \\<Psi>.simps simp add: Phi_Psi Psi_diff_Del)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> ad + 1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "thus ?thesis"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> ad + 1\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "by simp"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "assume \"\\<not> (real n - 1 \\<ge> f1*l \\<or> \\<lfloor>l/c\\<rfloor> < l0)\""], ["proof (state)\nthis:\n  \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n          \\<lfloor>real l / c\\<rfloor> < int l0)\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "hence n: \"real n - 1 < f1*l\" and lc': \"\\<lfloor>l/c\\<rfloor> \\<ge> l0\" and lc: \"l/c \\<ge> l0\""], ["proof (prove)\nusing this:\n  \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n          \\<lfloor>real l / c\\<rfloor> < int l0)\n\ngoal (1 subgoal):\n 1. real n - 1 < f1 * real l &&&\n    int l0 \\<le> \\<lfloor>real l / c\\<rfloor> &&& real l0 \\<le> real l / c", "by linarith+"], ["proof (state)\nthis:\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n  real l0 \\<le> real l / c\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have \"f1'*l \\<le> f2'*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1' * real l \\<le> f2' * real l", "using f1'_le_f2'"], ["proof (prove)\nusing this:\n  f1' \\<le> f2'\n\ngoal (1 subgoal):\n 1. f1' * real l \\<le> f2' * real l", "by simp"], ["proof (state)\nthis:\n  f1' * real l \\<le> f2' * real l\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have \"(f1' - f1)*l \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (f1' - f1) * real l", "using mult_mono[OF order_refl, of l0 \"l/c\" \"f1'-f1\"]\n          lc f1_less_f1' f1'f1"], ["proof (prove)\nusing this:\n  \\<lbrakk>real l0 \\<le> real l / c; 0 \\<le> f1' - f1;\n   0 \\<le> real l0\\<rbrakk>\n  \\<Longrightarrow> (f1' - f1) * real l0 \\<le> (f1' - f1) * (real l / c)\n  real l0 \\<le> real l / c\n  f1 < f1'\n  1 / ((f1' - f1) * c) \\<le> real l0\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1' - f1) * real l", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  1 \\<le> (f1' - f1) * real l\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "hence \"n < f1'*l\""], ["proof (prove)\nusing this:\n  1 \\<le> (f1' - f1) * real l\n\ngoal (1 subgoal):\n 1. real n < f1' * real l", "using n"], ["proof (prove)\nusing this:\n  1 \\<le> (f1' - f1) * real l\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. real n < f1' * real l", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n < f1' * real l\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "hence Phi: \"\\<Phi> s = ad*(f1'*l - n)\""], ["proof (prove)\nusing this:\n  real n < f1' * real l\n\ngoal (1 subgoal):\n 1. \\<Phi> s = ad * (f1' * real l - real n)", "apply(simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. real n < f1' * real l \\<Longrightarrow>\n    (int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<longrightarrow>\n     f2' * real l \\<le> real n \\<longrightarrow>\n     ai * (real n - f2' * real l) = ad * (f1' * real l - real n)) \\<and>\n    (\\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<longrightarrow>\n     (f2' * real l \\<le> real n \\<longrightarrow>\n      ai * (real n - f2' * real l) = ad * (f1' * real l - real n)) \\<and>\n     f2' * real l \\<le> real n)", "using \\<open>f1'*l \\<le> f2'*l\\<close> lc"], ["proof (prove)\nusing this:\n  f1' * real l \\<le> f2' * real l\n  real l0 \\<le> real l / c\n\ngoal (1 subgoal):\n 1. real n < f1' * real l \\<Longrightarrow>\n    (int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<longrightarrow>\n     f2' * real l \\<le> real n \\<longrightarrow>\n     ai * (real n - f2' * real l) = ad * (f1' * real l - real n)) \\<and>\n    (\\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<longrightarrow>\n     (f2' * real l \\<le> real n \\<longrightarrow>\n      ai * (real n - f2' * real l) = ad * (f1' * real l - real n)) \\<and>\n     f2' * real l \\<le> real n)", "by linarith"], ["proof (state)\nthis:\n  \\<Phi> s = ad * (f1' * real l - real n)\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have \"?A \\<le> n - ad*(f1' - f1)*l + ad + f2'*ai\" (is \"_ \\<le> ?R + _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "assume f2': \"n-1 < f2'*\\<lfloor>l/c\\<rfloor>\""], ["proof (state)\nthis:\n  real (n - 1) < f2' * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "assume \"n-1 < f1'*\\<lfloor>l/c\\<rfloor> \\<and> \\<lfloor>\\<lfloor>l/c\\<rfloor>/c\\<rfloor> \\<ge> l0\""], ["proof (state)\nthis:\n  real (n - 1) < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n  int l0\n  \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> / c\\<rfloor>\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "hence \"\\<Phi> (nxt f s) = ad*(f1'*\\<lfloor>l/c\\<rfloor> - (n-1))\""], ["proof (prove)\nusing this:\n  real (n - 1) < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n  int l0\n  \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<Phi> (nxt f s) =\n    ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))", "using f2' n lc'"], ["proof (prove)\nusing this:\n  real (n - 1) < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n  int l0\n  \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> / c\\<rfloor>\n  real (n - 1) < f2' * real_of_int \\<lfloor>real l / c\\<rfloor>\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<Phi> (nxt f s) =\n    ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))", "by(auto)"], ["proof (state)\nthis:\n  \\<Phi> (nxt f s) =\n  ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "hence \"?A = n + ad*(f1'*\\<lfloor>l/c\\<rfloor> - (n-1)) - (ad*(f1'*l - n))\""], ["proof (prove)\nusing this:\n  \\<Phi> (nxt f s) =\n  ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1)) -\n    ad * (f1' * real l - real n)", "using Phi n lc'"], ["proof (prove)\nusing this:\n  \\<Phi> (nxt f s) =\n  ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))\n  \\<Phi> s = ad * (f1' * real l - real n)\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1)) -\n    ad * (f1' * real l - real n)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1)) -\n  ad * (f1' * real l - real n)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ad * (f1' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1)) -\n  ad * (f1' * real l - real n)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "have \"\\<lfloor>l/c\\<rfloor> \\<le> l/c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real l / c", "by(simp)"], ["proof (state)\nthis:\n  real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real l / c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "also"], ["proof (state)\nthis:\n  real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real l / c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "have \"n+ad*(f1'*(l/c)-(n-1))-(ad*(f1'*l-n)) = n+ad*(f1'/c-f1')*l+ad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n + ad * (f1' * (real l / c) - real (n - 1)) -\n    ad * (f1' * real l - real n) =\n    real n + ad * (f1' / c - f1') * real l + ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n + ad * (f1' * (real l / c) - real (n - 1)) -\n  ad * (f1' * real l - real n) =\n  real n + ad * (f1' / c - f1') * real l + ad\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "also"], ["proof (state)\nthis:\n  real n + ad * (f1' * (real l / c) - real (n - 1)) -\n  ad * (f1' * real l - real n) =\n  real n + ad * (f1' / c - f1') * real l + ad\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "note f1'c_le_f1"], ["proof (state)\nthis:\n  f1' / c \\<le> f1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ad * (f1' * x - real (n - 1)) -\n              ad * (f1' * real l - real n)\n              \\<le> real n + ad * (f1' * y - real (n - 1)) -\n                    ad * (f1' * real l - real n);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1') * real l + ad\n      \\<le> real n + ad * (y - f1') * real l + ad\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n + ad * (f1 - f1') * real l + ad", "have \"?A \\<le> ?R\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ad * (f1' * x - real (n - 1)) -\n              ad * (f1' * real l - real n)\n              \\<le> real n + ad * (f1' * y - real (n - 1)) -\n                    ad * (f1' * real l - real n);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1') * real l + ad\n      \\<le> real n + ad * (y - f1') * real l + ad\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n + ad * (f1 - f1') * real l + ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "thus ?thesis"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "by linarith"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "assume \"\\<not>(n-1 < f1'*\\<lfloor>l/c\\<rfloor> \\<and> \\<lfloor>\\<lfloor>l/c\\<rfloor>/c\\<rfloor> \\<ge> l0)\""], ["proof (state)\nthis:\n  \\<not> (real (n - 1)\n          < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n          int l0\n          \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                         c\\<rfloor>)\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "hence \"\\<Phi> (nxt f s) = 0\""], ["proof (prove)\nusing this:\n  \\<not> (real (n - 1)\n          < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n          int l0\n          \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                         c\\<rfloor>)\n\ngoal (1 subgoal):\n 1. \\<Phi> (nxt f s) = 0", "using f2' n lc'"], ["proof (prove)\nusing this:\n  \\<not> (real (n - 1)\n          < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n          int l0\n          \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                         c\\<rfloor>)\n  real (n - 1) < f2' * real_of_int \\<lfloor>real l / c\\<rfloor>\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<Phi> (nxt f s) = 0", "by(auto)"], ["proof (state)\nthis:\n  \\<Phi> (nxt f s) = 0\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "hence \"?A = n + ad*(n - f1'*l)\""], ["proof (prove)\nusing this:\n  \\<Phi> (nxt f s) = 0\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n + ad * (real n - f1' * real l)", "using Phi n lc'"], ["proof (prove)\nusing this:\n  \\<Phi> (nxt f s) = 0\n  \\<Phi> s = ad * (f1' * real l - real n)\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n + ad * (real n - f1' * real l)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n + ad * (real n - f1' * real l)\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n + ad * (real n - f1' * real l)\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "have \"\\<dots> = n + ad*(n-1 - f1'*l) + ad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n + ad * (real n - f1' * real l) =\n    real n + ad * (real (n - 1) - f1' * real l) + ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n + ad * (real n - f1' * real l) =\n  real n + ad * (real (n - 1) - f1' * real l) + ad\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "also"], ["proof (state)\nthis:\n  real n + ad * (real n - f1' * real l) =\n  real n + ad * (real (n - 1) - f1' * real l) + ad\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "have \"n-1 \\<le> f1*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f1 * real l", "using n"], ["proof (prove)\nusing this:\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f1 * real l", "by linarith"], ["proof (state)\nthis:\n  real (n - 1) \\<le> f1 * real l\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1' * real l) + ad\n      \\<le> real n + ad * (y - f1' * real l) + ad) \\<Longrightarrow>\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n + ad * (f1 * real l - f1' * real l) + ad", "have \"?A \\<le> ?R\""], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1' * real l) + ad\n      \\<le> real n + ad * (y - f1' * real l) + ad) \\<Longrightarrow>\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n + ad * (f1 * real l - f1' * real l) + ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "thus ?thesis"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "by linarith"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "assume f2': \"\\<not> n-1 < f2'*\\<lfloor>l/c\\<rfloor>\""], ["proof (state)\nthis:\n  \\<not> real (n - 1) < f2' * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "hence \"?A = n + ai*(n-1-f2'*\\<lfloor>l/c\\<rfloor>) - ad*(f1'*l - n)\""], ["proof (prove)\nusing this:\n  \\<not> real (n - 1) < f2' * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ai * (real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor>) -\n    ad * (f1' * real l - real n)", "using Phi n lc'"], ["proof (prove)\nusing this:\n  \\<not> real (n - 1) < f2' * real_of_int \\<lfloor>real l / c\\<rfloor>\n  \\<Phi> s = ad * (f1' * real l - real n)\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ai * (real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor>) -\n    ad * (f1' * real l - real n)", "by (simp)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ai * (real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor>) -\n  ad * (f1' * real l - real n)\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ai * (real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor>) -\n  ad * (f1' * real l - real n)\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "have \"n-1-f2'*\\<lfloor>l/c\\<rfloor> \\<le> f2'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'", "have \"f1*l \\<le> f2'*(l/c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2' * (real l / c)", "using f1f2'c"], ["proof (prove)\nusing this:\n  f1 \\<le> f2' / c\n\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2' * (real l / c)", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  f1 * real l \\<le> f2' * (real l / c)\n\ngoal (1 subgoal):\n 1. real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'", "hence \"n-1 < f2'*(l/c)\""], ["proof (prove)\nusing this:\n  f1 * real l \\<le> f2' * (real l / c)\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2' * (real l / c)", "using n"], ["proof (prove)\nusing this:\n  f1 * real l \\<le> f2' * (real l / c)\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2' * (real l / c)", "by linarith"], ["proof (state)\nthis:\n  real (n - 1) < f2' * (real l / c)\n\ngoal (1 subgoal):\n 1. real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'", "also"], ["proof (state)\nthis:\n  real (n - 1) < f2' * (real l / c)\n\ngoal (1 subgoal):\n 1. real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'", "have \"l/c \\<le> \\<lfloor>l/c\\<rfloor> + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l / c \\<le> real_of_int (\\<lfloor>real l / c\\<rfloor> + 1)", "by linarith"], ["proof (state)\nthis:\n  real l / c \\<le> real_of_int (\\<lfloor>real l / c\\<rfloor> + 1)\n\ngoal (1 subgoal):\n 1. real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> f2' * x \\<le> f2' * y) \\<Longrightarrow>\n  real (n - 1) < f2' * real_of_int (\\<lfloor>real l / c\\<rfloor> + 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> f2' * x \\<le> f2' * y) \\<Longrightarrow>\n  real (n - 1) < f2' * real_of_int (\\<lfloor>real l / c\\<rfloor> + 1)\n\ngoal (1 subgoal):\n 1. real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'", "by(fastforce simp: algebra_simps)"], ["proof (state)\nthis:\n  real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "also"], ["proof (state)\nthis:\n  real (n - 1) - f2' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> f2'\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "have \"n+ai*f2'-ad*(f1'*l-n) = n + ad*(n-1 - f1'*l) + ad + f2'*ai\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n + ai * f2' - ad * (f1' * real l - real n) =\n    real n + ad * (real (n - 1) - f1' * real l) + ad + f2' * ai", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n + ai * f2' - ad * (f1' * real l - real n) =\n  real n + ad * (real (n - 1) - f1' * real l) + ad + f2' * ai\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "also"], ["proof (state)\nthis:\n  real n + ai * f2' - ad * (f1' * real l - real n) =\n  real n + ad * (real (n - 1) - f1' * real l) + ad + f2' * ai\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "have \"n-1 \\<le> f1*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f1 * real l", "using n"], ["proof (prove)\nusing this:\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f1 * real l", "by linarith"], ["proof (state)\nthis:\n  real (n - 1) \\<le> f1 * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n - 1)\n           < f2' *\n             real_of_int \\<lfloor>real l / c\\<rfloor> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ai * x - ad * (f1' * real l - real n)\n              \\<le> real n + ai * y - ad * (f1' * real l - real n);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1' * real l) + ad + f2' * ai\n      \\<le> real n + ad * (y - f1' * real l) + ad + f2' * ai\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n + ad * (f1 * real l - f1' * real l) + ad +\n                          f2' * ai", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ai * x - ad * (f1' * real l - real n)\n              \\<le> real n + ai * y - ad * (f1' * real l - real n);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1' * real l) + ad + f2' * ai\n      \\<le> real n + ad * (y - f1' * real l) + ad + f2' * ai\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n + ad * (f1 * real l - f1' * real l) + ad +\n                          f2' * ai\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1' - f1) * real l + ad + f2' * ai\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "have \"\\<dots> = n - f1*l + ad + f2'*ai\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n - ad * (f1' - f1) * real l + ad + f2' * ai =\n    real n - f1 * real l + ad + f2' * ai", "using f1_less_f1'"], ["proof (prove)\nusing this:\n  f1 < f1'\n\ngoal (1 subgoal):\n 1. real n - ad * (f1' - f1) * real l + ad + f2' * ai =\n    real n - f1 * real l + ad + f2' * ai", "by(simp add: ad_def)"], ["proof (state)\nthis:\n  real n - ad * (f1' - f1) * real l + ad + f2' * ai =\n  real n - f1 * real l + ad + f2' * ai\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "finally"], ["proof (chain)\npicking this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - f1 * real l + ad + f2' * ai", "show ?thesis"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - f1 * real l + ad + f2' * ai\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "using n"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - f1 * real l + ad + f2' * ai\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n           | Del \\<Rightarrow> ad + 1 + f2' * ai)", "by simp"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 + f1' * ad\n         | Del \\<Rightarrow> ad + 1 + f2' * ai)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "locale Table2_f1f2'' = TableInv +\nfixes f1'' f2'' :: real"], ["", "locale Table2 = Table2_f1f2'' +\nassumes f2f2'': \"(f2 - f2'')*l0 \\<ge> 1\"\nassumes f1''f1: \"(f1'' - f1)*c*l0 \\<ge> 1\"\n\nassumes f1_less_f1'': \"f1 < f1''\"\nassumes f1''_less_f1': \"f1'' < f1'\"\nassumes f2'_less_f2'': \"f2' < f2''\"\nassumes f2''_less_f2: \"f2'' < f2\"\nassumes f1''_f1': \"l \\<ge> real l0 \\<Longrightarrow> f1'' * (l+1) \\<le> f1'*l\"\nassumes f2'_f2'': \"l \\<ge> real l0 \\<Longrightarrow> f2' * l \\<le> f2'' * (l-1)\"\nbegin"], ["", "definition \"ai = f2 / (f2 - f2'')\""], ["", "definition \"ad = f1 / (f1'' - f1)\""], ["", "lemma f1''_gr0[arith]: \"f1'' > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < f1''", "using f1_less_f1'' f1"], ["proof (prove)\nusing this:\n  f1 < f1''\n  0 < f1\n\ngoal (1 subgoal):\n 1. 0 < f1''", "by linarith"], ["", "lemma f2''_gr0[arith]: \"f2'' > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < f2''", "using f2' f2'_less_f2''"], ["proof (prove)\nusing this:\n  0 < f2'\n  f2' < f2''\n\ngoal (1 subgoal):\n 1. 0 < f2''", "by linarith"], ["", "lemma aigr0[arith]: \"ai > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < ai", "using f2''_less_f2"], ["proof (prove)\nusing this:\n  f2'' < f2\n\ngoal (1 subgoal):\n 1. 0 < ai", "by(simp add: ai_def field_simps)"], ["", "lemma adgr0[arith]: \"ad > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < ad", "using f1_less_f1''"], ["proof (prove)\nusing this:\n  f1 < f1''\n\ngoal (1 subgoal):\n 1. 0 < ad", "by(simp add: ad_def field_simps)"], ["", "fun \\<Phi> :: \"nat * nat \\<Rightarrow> real\" where\n\"\\<Phi>(n,l) = (if n \\<ge> f2''*l then ai*(n - f2''*l) else\n  if n \\<le> f1''*l \\<and> l0 \\<le> \\<lfloor>l/c\\<rfloor> then ad*(f1''*l - n) else 0)\""], ["", "lemma Phi_Psi: \"\\<Phi> (n,l) = \\<Psi> (l0 \\<le> \\<lfloor>l/c\\<rfloor>) ai ad (f1''*l) (f2''*l) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Phi> (n, l) =\n    \\<Psi> (int l0 \\<le> \\<lfloor>real l / c\\<rfloor>) ai ad (f1'' * real l)\n     (f2'' * real l) n", "by(simp)"], ["", "abbreviation \"U \\<equiv> \\<lambda>f _. case f of Ins \\<Rightarrow> ai+1 | Del \\<Rightarrow> ad+1\""], ["", "interpretation tb: Amortized\n  where init = \"(0,l0)\" and nxt = nxt\n  and inv = invar\n  and T = T and \\<Phi> = \\<Phi>\n  and U = U"], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized (0, l0) nxt invar T \\<Phi> U", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. invar (0, l0)\n 2. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 3. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 4. \\<Phi> (0, l0) = 0\n 5. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. invar (0, l0)\n 2. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 3. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 4. \\<Phi> (0, l0) = 0\n 5. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. invar (0, l0)", "by (fact invar_init)"], ["proof (state)\nthis:\n  invar (0, l0)\n\ngoal (4 subgoals):\n 1. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 2. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> (0, l0) = 0\n 4. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 2. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> (0, l0) = 0\n 4. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "case 2"], ["proof (state)\nthis:\n  invar s_\n\ngoal (4 subgoals):\n 1. \\<And>s f. invar s \\<Longrightarrow> invar (nxt f s)\n 2. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> (0, l0) = 0\n 4. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "thus ?case"], ["proof (prove)\nusing this:\n  invar s_\n\ngoal (1 subgoal):\n 1. invar (nxt f_ s_)", "by(fact invar_pres)"], ["proof (state)\nthis:\n  invar (nxt f_ s_)\n\ngoal (3 subgoals):\n 1. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> (0, l0) = 0\n 3. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> (0, l0) = 0\n 3. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "case (3 s)"], ["proof (state)\nthis:\n  invar s\n\ngoal (3 subgoals):\n 1. \\<And>s. invar s \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> (0, l0) = 0\n 3. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "thus ?case"], ["proof (prove)\nusing this:\n  invar s\n\ngoal (1 subgoal):\n 1. 0 \\<le> \\<Phi> s", "by(cases s)(simp split: if_splits)"], ["proof (state)\nthis:\n  0 \\<le> \\<Phi> s\n\ngoal (2 subgoals):\n 1. \\<Phi> (0, l0) = 0\n 2. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<Phi> (0, l0) = 0\n 2. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<Phi> (0, l0) = 0\n 2. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Phi> (0, l0) = 0", "by(auto simp: field_simps mult_le_0_iff le_floor_iff)"], ["proof (state)\nthis:\n  \\<Phi> (0, l0) = 0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "case (5 s f)"], ["proof (state)\nthis:\n  invar s\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "obtain n l where [simp]: \"s = (n,l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n l. s = (n, l) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  s = (n, l)\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       invar s \\<Longrightarrow>\n       T f s + \\<Phi> (nxt f s) - \\<Phi> s\n       \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "proof (cases f)"], ["proof (state)\ngoal (2 subgoals):\n 1. f = Ins \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n 2. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "case [simp]: Ins"], ["proof (state)\nthis:\n  f = Ins\n\ngoal (2 subgoals):\n 1. f = Ins \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n 2. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "show ?thesis (is \"?L \\<le> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "assume \"n+1 \\<le> f2*l\""], ["proof (state)\nthis:\n  real (n + 1) \\<le> f2 * real l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "thus ?thesis"], ["proof (prove)\nusing this:\n  real (n + 1) \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "by(simp del: \\<Phi>.simps \\<Psi>.simps add: Phi_Psi Psi_diff_Ins)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "assume [arith]: \"\\<not> n+1 \\<le> f2*l\""], ["proof (state)\nthis:\n  \\<not> real (n + 1) \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have [arith]: \"l \\<ge> l0\"  \"n \\<le> f2*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l0 \\<le> l &&& real n \\<le> f2 * real l", "using 5"], ["proof (prove)\nusing this:\n  invar s\n\ngoal (1 subgoal):\n 1. l0 \\<le> l &&& real n \\<le> f2 * real l", "by auto"], ["proof (state)\nthis:\n  l0 \\<le> l\n  real n \\<le> f2 * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have \"l0 \\<le> e*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l0 \\<le> e * real l", "using \\<open>l0 \\<le> l\\<close> e1 mult_mono[of 1 e l0 l]"], ["proof (prove)\nusing this:\n  l0 \\<le> l\n  1 < e\n  \\<lbrakk>1 \\<le> e; real l0 \\<le> real l; 0 \\<le> e;\n   0 \\<le> real l0\\<rbrakk>\n  \\<Longrightarrow> 1 * real l0 \\<le> e * real l\n\ngoal (1 subgoal):\n 1. real l0 \\<le> e * real l", "by simp"], ["proof (state)\nthis:\n  real l0 \\<le> e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have \"(f2 - f2'')*l \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real l", "using mult_mono[OF order_refl, of l0 l \"f2-f2''\"] f2''_less_f2 f2f2''"], ["proof (prove)\nusing this:\n  \\<lbrakk>real l0 \\<le> real l; 0 \\<le> f2 - f2''; 0 \\<le> real l0\\<rbrakk>\n  \\<Longrightarrow> (f2 - f2'') * real l0 \\<le> (f2 - f2'') * real l\n  f2'' < f2\n  1 \\<le> (f2 - f2'') * real l0\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real l", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  1 \\<le> (f2 - f2'') * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "hence \"n \\<ge> f2''*l\""], ["proof (prove)\nusing this:\n  1 \\<le> (f2 - f2'') * real l\n\ngoal (1 subgoal):\n 1. f2'' * real l \\<le> real n", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  f2'' * real l \\<le> real n\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "hence Phi: \"\\<Phi> s = ai * (n - f2''*l)\""], ["proof (prove)\nusing this:\n  f2'' * real l \\<le> real n\n\ngoal (1 subgoal):\n 1. \\<Phi> s = ai * (real n - f2'' * real l)", "by simp"], ["proof (state)\nthis:\n  \\<Phi> s = ai * (real n - f2'' * real l)\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have [simp]: \"real (nat \\<lceil>e*l\\<rceil>) = real_of_int \\<lceil>e*l\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (nat \\<lceil>e * real l\\<rceil>) =\n    real_of_int \\<lceil>e * real l\\<rceil>", "by (simp add: order.order_iff_strict)"], ["proof (state)\nthis:\n  real (nat \\<lceil>e * real l\\<rceil>) =\n  real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have \"?L \\<le> n - ai*(f2 - f2'')*l + ai + 1\" (is \"_ \\<le> ?R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "assume f2'': \"n+1 < f2''*\\<lceil>e*l\\<rceil>\""], ["proof (state)\nthis:\n  real (n + 1) < f2'' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"f1''*\\<lceil>e*l\\<rceil> \\<le> f1''*(e*l + 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1'' * real_of_int \\<lceil>e * real l\\<rceil>\n    \\<le> f1'' * (e * real l + 1)", "by(simp)"], ["proof (state)\nthis:\n  f1'' * real_of_int \\<lceil>e * real l\\<rceil>\n  \\<le> f1'' * (e * real l + 1)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  f1'' * real_of_int \\<lceil>e * real l\\<rceil>\n  \\<le> f1'' * (e * real l + 1)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "note f1''_f1'[OF \\<open>l0 \\<le> e*l\\<close>]"], ["proof (state)\nthis:\n  f1'' * (e * real l + 1) \\<le> f1' * (e * real l)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  f1'' * (e * real l + 1) \\<le> f1' * (e * real l)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"f1'*(e*l) \\<le> f2*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1' * (e * real l) \\<le> f2 * real l", "using f1'ef2"], ["proof (prove)\nusing this:\n  f1' * e \\<le> f2\n\ngoal (1 subgoal):\n 1. f1' * (e * real l) \\<le> f2 * real l", "by(simp)"], ["proof (state)\nthis:\n  f1' * (e * real l) \\<le> f2 * real l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  f1' * (e * real l) \\<le> f2 * real l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"f2*l \\<le> n+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2 * real l \\<le> real (n + 1)", "by linarith"], ["proof (state)\nthis:\n  f2 * real l \\<le> real (n + 1)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "finally"], ["proof (chain)\npicking this:\n  f1'' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)", "have \"?L \\<le> n+1 - ai*(n - f2''*l)\""], ["proof (prove)\nusing this:\n  f1'' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real (n + 1) - ai * (real n - f2'' * real l)", "using Phi f2''"], ["proof (prove)\nusing this:\n  f1'' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> real (n + 1)\n  \\<Phi> s = ai * (real n - f2'' * real l)\n  real (n + 1) < f2'' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real (n + 1) - ai * (real n - f2'' * real l)", "by (simp)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real (n + 1) - ai * (real n - f2'' * real l)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real (n + 1) - ai * (real n - f2'' * real l)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"n+1-ai*(n-f2''*l) = n+ai*(-real(n+1)+f2''*l)+ai+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n + 1) - ai * (real n - f2'' * real l) =\n    real n + ai * (- real (n + 1) + f2'' * real l) + ai + 1", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real (n + 1) - ai * (real n - f2'' * real l) =\n  real n + ai * (- real (n + 1) + f2'' * real l) + ai + 1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  real (n + 1) - ai * (real n - f2'' * real l) =\n  real n + ai * (- real (n + 1) + f2'' * real l) + ai + 1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"-real(n+1) \\<le> -f2*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - real (n + 1) \\<le> - f2 * real l", "by linarith"], ["proof (state)\nthis:\n  - real (n + 1) \\<le> - f2 * real l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x + f2'' * real l) + ai + 1\n      \\<le> real n + ai * (y + f2'' * real l) + ai + 1) \\<Longrightarrow>\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n + ai * (- f2 * real l + f2'' * real l) + ai + 1", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x + f2'' * real l) + ai + 1\n      \\<le> real n + ai * (y + f2'' * real l) + ai + 1) \\<Longrightarrow>\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n + ai * (- f2 * real l + f2'' * real l) + ai + 1\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "assume \"\\<not> n+1 < f2''*\\<lceil>e*l\\<rceil>\""], ["proof (state)\nthis:\n  \\<not> real (n + 1) < f2'' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "hence \"?L = n + ai*(-f2''*\\<lceil>e*l\\<rceil> + f2''*l) + ai+1\""], ["proof (prove)\nusing this:\n  \\<not> real (n + 1) < f2'' * real_of_int \\<lceil>e * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ai * (- f2'' * real_of_int \\<lceil>e * real l\\<rceil> + f2'' * real l) +\n    ai +\n    1", "using Phi"], ["proof (prove)\nusing this:\n  \\<not> real (n + 1) < f2'' * real_of_int \\<lceil>e * real l\\<rceil>\n  \\<Phi> s = ai * (real n - f2'' * real l)\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ai * (- f2'' * real_of_int \\<lceil>e * real l\\<rceil> + f2'' * real l) +\n    ai +\n    1", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ai * (- f2'' * real_of_int \\<lceil>e * real l\\<rceil> + f2'' * real l) +\n  ai +\n  1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ai * (- f2'' * real_of_int \\<lceil>e * real l\\<rceil> + f2'' * real l) +\n  ai +\n  1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"-f2''*\\<lceil>e*l\\<rceil> \\<le> -f2''*e*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - f2'' * real_of_int \\<lceil>e * real l\\<rceil>\n    \\<le> - f2'' * e * real l", "by(simp)"], ["proof (state)\nthis:\n  - f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> - f2'' * e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  - f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<le> - f2'' * e * real l\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"-f2''*e \\<le> -f2'*e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - f2'' * e \\<le> - f2' * e", "using f2'_less_f2''"], ["proof (prove)\nusing this:\n  f2' < f2''\n\ngoal (1 subgoal):\n 1. - f2'' * e \\<le> - f2' * e", "by(simp)"], ["proof (state)\nthis:\n  - f2'' * e \\<le> - f2' * e\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  - f2'' * e \\<le> - f2' * e\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"-f2'*e \\<le> -f2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - f2' * e \\<le> - f2", "using f2_le_f2'e"], ["proof (prove)\nusing this:\n  f2 \\<le> f2' * e\n\ngoal (1 subgoal):\n 1. - f2' * e \\<le> - f2", "by(simp)"], ["proof (state)\nthis:\n  - f2' * e \\<le> - f2\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "also"], ["proof (state)\nthis:\n  - f2' * e \\<le> - f2\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "have \"n+ai*(-f2*l+f2''*l)+ai+1 \\<le> ?R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n + ai * (- f2 * real l + f2'' * real l) + ai + 1\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n + ai * (- f2 * real l + f2'' * real l) + ai + 1\n  \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1)\n           < f2'' * real_of_int \\<lceil>e * real l\\<rceil> \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ai * (x + f2'' * real l) + ai + 1\n              \\<le> real n + ai * (y + f2'' * real l) + ai + 1;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x * real l + f2'' * real l) + ai + 1\n      \\<le> real n + ai * (y * real l + f2'' * real l) + ai + 1;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x * real l + f2'' * real l) + ai + 1\n      \\<le> real n + ai * (y * real l + f2'' * real l) + ai + 1\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ai * (x + f2'' * real l) + ai + 1\n              \\<le> real n + ai * (y + f2'' * real l) + ai + 1;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x * real l + f2'' * real l) + ai + 1\n      \\<le> real n + ai * (y * real l + f2'' * real l) + ai + 1;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ai * (x * real l + f2'' * real l) + ai + 1\n      \\<le> real n + ai * (y * real l + f2'' * real l) + ai + 1\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ai * (f2 - f2'') * real l + ai + 1", "by(simp)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ai * (f2 - f2'') * real l + ai + 1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have \"\\<dots> = n - f2*l + ai+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n - ai * (f2 - f2'') * real l + ai + 1 =\n    real n - f2 * real l + ai + 1", "using f2''_less_f2"], ["proof (prove)\nusing this:\n  f2'' < f2\n\ngoal (1 subgoal):\n 1. real n - ai * (f2 - f2'') * real l + ai + 1 =\n    real n - f2 * real l + ai + 1", "by(simp add: ai_def)"], ["proof (state)\nthis:\n  real n - ai * (f2 - f2'') * real l + ai + 1 =\n  real n - f2 * real l + ai + 1\n\ngoal (1 subgoal):\n 1. \\<not> real (n + 1) \\<le> f2 * real l \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "finally"], ["proof (chain)\npicking this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> real n - f2 * real l + ai + 1", "show ?thesis"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> real n - f2 * real l + ai + 1\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "by simp"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "case [simp]: Del"], ["proof (state)\nthis:\n  f = Del\n\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have [arith]: \"l \\<ge> l0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l0 \\<le> l", "using 5"], ["proof (prove)\nusing this:\n  invar s\n\ngoal (1 subgoal):\n 1. l0 \\<le> l", "by simp"], ["proof (state)\nthis:\n  l0 \\<le> l\n\ngoal (1 subgoal):\n 1. f = Del \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "assume \"n=0\""], ["proof (state)\nthis:\n  n = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "with 5"], ["proof (chain)\npicking this:\n  invar s\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  invar s\n  n = 0\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "by(simp add: mult_le_0_iff field_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "assume [arith]: \"n\\<noteq>0\""], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "show ?thesis (is \"?A \\<le> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "assume \"real n - 1 \\<ge> f1*l \\<or> \\<lfloor>l/c\\<rfloor> < l0\""], ["proof (state)\nthis:\n  f1 * real l \\<le> real n - 1 \\<or> \\<lfloor>real l / c\\<rfloor> < int l0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "thus ?thesis"], ["proof (prove)\nusing this:\n  f1 * real l \\<le> real n - 1 \\<or> \\<lfloor>real l / c\\<rfloor> < int l0\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "using f1''_less_f1' f1'_le_f2' f2'_less_f2''"], ["proof (prove)\nusing this:\n  f1 * real l \\<le> real n - 1 \\<or> \\<lfloor>real l / c\\<rfloor> < int l0\n  f1'' < f1'\n  f1' \\<le> f2'\n  f2' < f2''\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "by(auto simp del: \\<Phi>.simps \\<Psi>.simps simp add: Phi_Psi Psi_diff_Del)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "assume \"\\<not> (real n - 1 \\<ge> f1*l \\<or> \\<lfloor>l/c\\<rfloor> < l0)\""], ["proof (state)\nthis:\n  \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n          \\<lfloor>real l / c\\<rfloor> < int l0)\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "hence n: \"real n - 1 < f1*l\" and lc': \"\\<lfloor>l/c\\<rfloor> \\<ge> l0\" and lc: \"l/c \\<ge> l0\""], ["proof (prove)\nusing this:\n  \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n          \\<lfloor>real l / c\\<rfloor> < int l0)\n\ngoal (1 subgoal):\n 1. real n - 1 < f1 * real l &&&\n    int l0 \\<le> \\<lfloor>real l / c\\<rfloor> &&& real l0 \\<le> real l / c", "by linarith+"], ["proof (state)\nthis:\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n  real l0 \\<le> real l / c\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have \"f1''*l \\<le> f2''*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1'' * real l \\<le> f2'' * real l", "using f1''_less_f1' f1'_le_f2' f2'_less_f2''"], ["proof (prove)\nusing this:\n  f1'' < f1'\n  f1' \\<le> f2'\n  f2' < f2''\n\ngoal (1 subgoal):\n 1. f1'' * real l \\<le> f2'' * real l", "by simp"], ["proof (state)\nthis:\n  f1'' * real l \\<le> f2'' * real l\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have \"(f1'' - f1)*l \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * real l", "using mult_mono[OF order_refl, of l0 \"l/c\" \"f1''-f1\"] lc f1_less_f1'' f1''f1"], ["proof (prove)\nusing this:\n  \\<lbrakk>real l0 \\<le> real l / c; 0 \\<le> f1'' - f1;\n   0 \\<le> real l0\\<rbrakk>\n  \\<Longrightarrow> (f1'' - f1) * real l0 \\<le> (f1'' - f1) * (real l / c)\n  real l0 \\<le> real l / c\n  f1 < f1''\n  1 \\<le> (f1'' - f1) * c * real l0\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * real l", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  1 \\<le> (f1'' - f1) * real l\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "hence \"n < f1''*l\""], ["proof (prove)\nusing this:\n  1 \\<le> (f1'' - f1) * real l\n\ngoal (1 subgoal):\n 1. real n < f1'' * real l", "using n"], ["proof (prove)\nusing this:\n  1 \\<le> (f1'' - f1) * real l\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. real n < f1'' * real l", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n < f1'' * real l\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "hence Phi: \"\\<Phi> s = ad*(f1''*l - n)\""], ["proof (prove)\nusing this:\n  real n < f1'' * real l\n\ngoal (1 subgoal):\n 1. \\<Phi> s = ad * (f1'' * real l - real n)", "apply(simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. real n < f1'' * real l \\<Longrightarrow>\n    (int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<longrightarrow>\n     f2'' * real l \\<le> real n \\<longrightarrow>\n     ai * (real n - f2'' * real l) = ad * (f1'' * real l - real n)) \\<and>\n    (\\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<longrightarrow>\n     (f2'' * real l \\<le> real n \\<longrightarrow>\n      ai * (real n - f2'' * real l) = ad * (f1'' * real l - real n)) \\<and>\n     f2'' * real l \\<le> real n)", "using \\<open>f1''*l \\<le> f2''*l\\<close> lc"], ["proof (prove)\nusing this:\n  f1'' * real l \\<le> f2'' * real l\n  real l0 \\<le> real l / c\n\ngoal (1 subgoal):\n 1. real n < f1'' * real l \\<Longrightarrow>\n    (int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<longrightarrow>\n     f2'' * real l \\<le> real n \\<longrightarrow>\n     ai * (real n - f2'' * real l) = ad * (f1'' * real l - real n)) \\<and>\n    (\\<not> int l0 \\<le> \\<lfloor>real l / c\\<rfloor> \\<longrightarrow>\n     (f2'' * real l \\<le> real n \\<longrightarrow>\n      ai * (real n - f2'' * real l) = ad * (f1'' * real l - real n)) \\<and>\n     f2'' * real l \\<le> real n)", "by linarith"], ["proof (state)\nthis:\n  \\<Phi> s = ad * (f1'' * real l - real n)\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have f2': \"n-1 < f2''*\\<lfloor>l/c\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "have \"n-1 < f1*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n - 1) < f1 * real l", "using n"], ["proof (prove)\nusing this:\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) < f1 * real l", "by linarith"], ["proof (state)\nthis:\n  real (n - 1) < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "also"], ["proof (state)\nthis:\n  real (n - 1) < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "have \"f1*l \\<le> f2'*(l/c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2' * (real l / c)", "using f1f2'c"], ["proof (prove)\nusing this:\n  f1 \\<le> f2' / c\n\ngoal (1 subgoal):\n 1. f1 * real l \\<le> f2' * (real l / c)", "by(auto simp: field_simps)"], ["proof (state)\nthis:\n  f1 * real l \\<le> f2' * (real l / c)\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "also"], ["proof (state)\nthis:\n  f1 * real l \\<le> f2' * (real l / c)\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "note f2'_f2''[OF \\<open>l/c\\<ge>l0\\<close>]"], ["proof (state)\nthis:\n  f2' * (real l / c) \\<le> f2'' * (real l / c - 1)\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "also"], ["proof (state)\nthis:\n  f2' * (real l / c) \\<le> f2'' * (real l / c - 1)\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "have \"f2''*(l/c - 1) \\<le> f2''*\\<lfloor>l/c\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2'' * (real l / c - 1)\n    \\<le> f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "by simp"], ["proof (state)\nthis:\n  f2'' * (real l / c - 1)\n  \\<le> f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "finally"], ["proof (chain)\npicking this:\n  real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "show ?thesis"], ["proof (prove)\nusing this:\n  real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>", "by(simp)"], ["proof (state)\nthis:\n  real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have \"?A \\<le> n - ad*(f1'' - f1)*l + ad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "assume \"n-1 < f1''*\\<lfloor>l/c\\<rfloor> \\<and> \\<lfloor>\\<lfloor>l/c\\<rfloor>/c\\<rfloor> \\<ge> l0\""], ["proof (state)\nthis:\n  real (n - 1) < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n  int l0\n  \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> / c\\<rfloor>\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "hence \"\\<Phi> (nxt f s) = ad*(f1''*\\<lfloor>l/c\\<rfloor> - (n-1))\""], ["proof (prove)\nusing this:\n  real (n - 1) < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n  int l0\n  \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<Phi> (nxt f s) =\n    ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))", "using f2' n lc'"], ["proof (prove)\nusing this:\n  real (n - 1) < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n  int l0\n  \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> / c\\<rfloor>\n  real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<Phi> (nxt f s) =\n    ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))", "by(auto)"], ["proof (state)\nthis:\n  \\<Phi> (nxt f s) =\n  ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "hence \"?A = n + ad*(f1''*\\<lfloor>l/c\\<rfloor> - (n-1)) - (ad*(f1''*l - n))\""], ["proof (prove)\nusing this:\n  \\<Phi> (nxt f s) =\n  ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1)) -\n    ad * (f1'' * real l - real n)", "using Phi n lc'"], ["proof (prove)\nusing this:\n  \\<Phi> (nxt f s) =\n  ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1))\n  \\<Phi> s = ad * (f1'' * real l - real n)\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n +\n    ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1)) -\n    ad * (f1'' * real l - real n)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1)) -\n  ad * (f1'' * real l - real n)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n +\n  ad * (f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> - real (n - 1)) -\n  ad * (f1'' * real l - real n)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "have \"\\<lfloor>l/c\\<rfloor> \\<le> l/c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real l / c", "by(simp)"], ["proof (state)\nthis:\n  real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real l / c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "also"], ["proof (state)\nthis:\n  real_of_int \\<lfloor>real l / c\\<rfloor> \\<le> real l / c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "have \"n+ad*(f1''*(l/c)-(n-1))-(ad*(f1''*l-n)) = n+ad*(f1''/c-f1'')*l+ad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n + ad * (f1'' * (real l / c) - real (n - 1)) -\n    ad * (f1'' * real l - real n) =\n    real n + ad * (f1'' / c - f1'') * real l + ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n + ad * (f1'' * (real l / c) - real (n - 1)) -\n  ad * (f1'' * real l - real n) =\n  real n + ad * (f1'' / c - f1'') * real l + ad\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "also"], ["proof (state)\nthis:\n  real n + ad * (f1'' * (real l / c) - real (n - 1)) -\n  ad * (f1'' * real l - real n) =\n  real n + ad * (f1'' / c - f1'') * real l + ad\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "have \"f1''/c \\<le> f1'/c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1'' / c \\<le> f1' / c", "using f1''_less_f1'"], ["proof (prove)\nusing this:\n  f1'' < f1'\n\ngoal (1 subgoal):\n 1. f1'' / c \\<le> f1' / c", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  f1'' / c \\<le> f1' / c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "also"], ["proof (state)\nthis:\n  f1'' / c \\<le> f1' / c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "note f1'c_le_f1"], ["proof (state)\nthis:\n  f1' / c \\<le> f1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad\n 2. \\<not> ?P \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ad * (f1'' * x - real (n - 1)) -\n              ad * (f1'' * real l - real n)\n              \\<le> real n + ad * (f1'' * y - real (n - 1)) -\n                    ad * (f1'' * real l - real n);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1'') * real l + ad\n      \\<le> real n + ad * (y - f1'') * real l + ad;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1'') * real l + ad\n      \\<le> real n + ad * (y - f1'') * real l + ad\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n + ad * (f1 - f1'') * real l + ad", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n + ad * (f1'' * x - real (n - 1)) -\n              ad * (f1'' * real l - real n)\n              \\<le> real n + ad * (f1'' * y - real (n - 1)) -\n                    ad * (f1'' * real l - real n);\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1'') * real l + ad\n      \\<le> real n + ad * (y - f1'') * real l + ad;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1'') * real l + ad\n      \\<le> real n + ad * (y - f1'') * real l + ad\\<rbrakk>\n  \\<Longrightarrow> T f s + \\<Phi> (nxt f s) - \\<Phi> s\n                    \\<le> real n + ad * (f1 - f1'') * real l + ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1'' - f1) * real l + ad\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "assume \"\\<not>(n-1 < f1''*\\<lfloor>l/c\\<rfloor> \\<and> \\<lfloor>\\<lfloor>l/c\\<rfloor>/c\\<rfloor> \\<ge> l0)\""], ["proof (state)\nthis:\n  \\<not> (real (n - 1)\n          < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n          int l0\n          \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                         c\\<rfloor>)\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "hence \"\\<Phi> (nxt f s) = 0\""], ["proof (prove)\nusing this:\n  \\<not> (real (n - 1)\n          < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n          int l0\n          \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                         c\\<rfloor>)\n\ngoal (1 subgoal):\n 1. \\<Phi> (nxt f s) = 0", "using f2' n lc'"], ["proof (prove)\nusing this:\n  \\<not> (real (n - 1)\n          < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n          int l0\n          \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                         c\\<rfloor>)\n  real (n - 1) < f2'' * real_of_int \\<lfloor>real l / c\\<rfloor>\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<Phi> (nxt f s) = 0", "by(auto)"], ["proof (state)\nthis:\n  \\<Phi> (nxt f s) = 0\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "hence \"?A = n + ad*(n - f1''*l)\""], ["proof (prove)\nusing this:\n  \\<Phi> (nxt f s) = 0\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n + ad * (real n - f1'' * real l)", "using Phi n lc'"], ["proof (prove)\nusing this:\n  \\<Phi> (nxt f s) = 0\n  \\<Phi> s = ad * (f1'' * real l - real n)\n  real n - 1 < f1 * real l\n  int l0 \\<le> \\<lfloor>real l / c\\<rfloor>\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n    real n + ad * (real n - f1'' * real l)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n + ad * (real n - f1'' * real l)\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s =\n  real n + ad * (real n - f1'' * real l)\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "have \"\\<dots> = n + ad*(n-1 - f1''*l) + ad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n + ad * (real n - f1'' * real l) =\n    real n + ad * (real (n - 1) - f1'' * real l) + ad", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n + ad * (real n - f1'' * real l) =\n  real n + ad * (real (n - 1) - f1'' * real l) + ad\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "also"], ["proof (state)\nthis:\n  real n + ad * (real n - f1'' * real l) =\n  real n + ad * (real (n - 1) - f1'' * real l) + ad\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "have \"n-1 \\<le> f1*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f1 * real l", "using n"], ["proof (prove)\nusing this:\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. real (n - 1) \\<le> f1 * real l", "by linarith"], ["proof (state)\nthis:\n  real (n - 1) \\<le> f1 * real l\n\ngoal (1 subgoal):\n 1. \\<not> (real (n - 1)\n            < f1'' * real_of_int \\<lfloor>real l / c\\<rfloor> \\<and>\n            int l0\n            \\<le> \\<lfloor>real_of_int \\<lfloor>real l / c\\<rfloor> /\n                           c\\<rfloor>) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1'' * real l) + ad\n      \\<le> real n + ad * (y - f1'' * real l) + ad) \\<Longrightarrow>\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n + ad * (f1 * real l - f1'' * real l) + ad", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n + ad * (x - f1'' * real l) + ad\n      \\<le> real n + ad * (y - f1'' * real l) + ad) \\<Longrightarrow>\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n + ad * (f1 * real l - f1'' * real l) + ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> real n - ad * (f1'' - f1) * real l + ad", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1'' - f1) * real l + ad\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1'' - f1) * real l + ad\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "also"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> real n - ad * (f1'' - f1) * real l + ad\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "have \"\\<dots> = n - f1*l + ad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n - ad * (f1'' - f1) * real l + ad = real n - f1 * real l + ad", "using f1_less_f1''"], ["proof (prove)\nusing this:\n  f1 < f1''\n\ngoal (1 subgoal):\n 1. real n - ad * (f1'' - f1) * real l + ad = real n - f1 * real l + ad", "by(simp add: ad_def)"], ["proof (state)\nthis:\n  real n - ad * (f1'' - f1) * real l + ad = real n - f1 * real l + ad\n\ngoal (1 subgoal):\n 1. \\<not> (f1 * real l \\<le> real n - 1 \\<or>\n            \\<lfloor>real l / c\\<rfloor> < int l0) \\<Longrightarrow>\n    T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "finally"], ["proof (chain)\npicking this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> real n - f1 * real l + ad", "show ?thesis"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> real n - f1 * real l + ad\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "using n"], ["proof (prove)\nusing this:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s \\<le> real n - f1 * real l + ad\n  real n - 1 < f1 * real l\n\ngoal (1 subgoal):\n 1. T f s + \\<Phi> (nxt f s) - \\<Phi> s\n    \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)", "by simp"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T f s + \\<Phi> (nxt f s) - \\<Phi> s\n  \\<le> (case f of Ins \\<Rightarrow> ai + 1 | Del \\<Rightarrow> ad + 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "locale Table3 = Table2_f1f2'' +\nassumes f1''_def: \"f1'' = (f1'::real)*l0/(l0+1)\"\nassumes f2''_def: \"f2'' = (f2'::real)*l0/(l0-1)\"\n\n(* they imply (f2 - f2'')*l0 \\<ge> 1 and (f1 - f1'')*l0*c \\<ge> 1 *)\nassumes l0_f2f2': \"l0 \\<ge> (f2+1)/(f2-f2')\"\nassumes l0_f1f1': \"l0 \\<ge> (f1'*c+1)/((f1'-f1)*c)\"\n\n(* they imply f1<f1'' and f2'<f2'' and l0 > 1 *)\nassumes l0_f1_f1': \"l0 > f1/((f1'-f1))\"\nassumes l0_f2_f2': \"l0 > f2/(f2-f2')\"\nbegin"], ["", "lemma l0_gr1: \"l0 > 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < l0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 1 < l0", "have \"f2/(f2-f2') \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> f2 / (f2 - f2')", "using f2'_less_f2"], ["proof (prove)\nusing this:\n  f2' < f2\n\ngoal (1 subgoal):\n 1. 1 \\<le> f2 / (f2 - f2')", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  1 \\<le> f2 / (f2 - f2')\n\ngoal (1 subgoal):\n 1. 1 < l0", "thus ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> f2 / (f2 - f2')\n\ngoal (1 subgoal):\n 1. 1 < l0", "using l0_f2_f2' f2'_less_f2"], ["proof (prove)\nusing this:\n  1 \\<le> f2 / (f2 - f2')\n  f2 / (f2 - f2') < real l0\n  f2' < f2\n\ngoal (1 subgoal):\n 1. 1 < l0", "by linarith"], ["proof (state)\nthis:\n  1 < l0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma f1''_less_f1': \"f1'' < f1'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1'' < f1'", "by(simp add: f1''_def field_simps)"], ["", "lemma f1_less_f1'': \"f1 < f1''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1 < f1''", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f1 < f1''", "have \"1 + l0 > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 + l0", "by (simp add: add_pos_pos)"], ["proof (state)\nthis:\n  0 < 1 + l0\n\ngoal (1 subgoal):\n 1. f1 < f1''", "hence \"f1''> f1 \\<longleftrightarrow> l0 > f1/((f1'-f1))\""], ["proof (prove)\nusing this:\n  0 < 1 + l0\n\ngoal (1 subgoal):\n 1. (f1 < f1'') = (f1 / (f1' - f1) < real l0)", "using f1_less_f1'"], ["proof (prove)\nusing this:\n  0 < 1 + l0\n  f1 < f1'\n\ngoal (1 subgoal):\n 1. (f1 < f1'') = (f1 / (f1' - f1) < real l0)", "by(simp add: f1''_def field_simps)"], ["proof (state)\nthis:\n  (f1 < f1'') = (f1 / (f1' - f1) < real l0)\n\ngoal (1 subgoal):\n 1. f1 < f1''", "also"], ["proof (state)\nthis:\n  (f1 < f1'') = (f1 / (f1' - f1) < real l0)\n\ngoal (1 subgoal):\n 1. f1 < f1''", "have \"\\<dots> \\<longleftrightarrow> True\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f1 / (f1' - f1) < real l0) = True", "using l0_f1_f1'"], ["proof (prove)\nusing this:\n  f1 / (f1' - f1) < real l0\n\ngoal (1 subgoal):\n 1. (f1 / (f1' - f1) < real l0) = True", "by blast"], ["proof (state)\nthis:\n  (f1 / (f1' - f1) < real l0) = True\n\ngoal (1 subgoal):\n 1. f1 < f1''", "finally"], ["proof (chain)\npicking this:\n  (f1 < f1'') = True", "show ?thesis"], ["proof (prove)\nusing this:\n  (f1 < f1'') = True\n\ngoal (1 subgoal):\n 1. f1 < f1''", "by blast"], ["proof (state)\nthis:\n  f1 < f1''\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma f2'_less_f2'': \"f2' < f2''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2' < f2''", "using l0_gr1"], ["proof (prove)\nusing this:\n  1 < l0\n\ngoal (1 subgoal):\n 1. f2' < f2''", "by(simp add: f2''_def field_simps)"], ["", "lemma f2''_less_f2: \"f2'' < f2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2'' < f2", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f2'' < f2", "have \"f2''< f2 \\<longleftrightarrow> l0 > f2/(f2-f2')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f2'' < f2) = (f2 / (f2 - f2') < real l0)", "using f2'_less_f2 l0_gr1"], ["proof (prove)\nusing this:\n  f2' < f2\n  1 < l0\n\ngoal (1 subgoal):\n 1. (f2'' < f2) = (f2 / (f2 - f2') < real l0)", "by(simp add: f2''_def field_simps)"], ["proof (state)\nthis:\n  (f2'' < f2) = (f2 / (f2 - f2') < real l0)\n\ngoal (1 subgoal):\n 1. f2'' < f2", "also"], ["proof (state)\nthis:\n  (f2'' < f2) = (f2 / (f2 - f2') < real l0)\n\ngoal (1 subgoal):\n 1. f2'' < f2", "have \"\\<dots> \\<longleftrightarrow> True\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f2 / (f2 - f2') < real l0) = True", "using l0_f2_f2'"], ["proof (prove)\nusing this:\n  f2 / (f2 - f2') < real l0\n\ngoal (1 subgoal):\n 1. (f2 / (f2 - f2') < real l0) = True", "by blast"], ["proof (state)\nthis:\n  (f2 / (f2 - f2') < real l0) = True\n\ngoal (1 subgoal):\n 1. f2'' < f2", "finally"], ["proof (chain)\npicking this:\n  (f2'' < f2) = True", "show ?thesis"], ["proof (prove)\nusing this:\n  (f2'' < f2) = True\n\ngoal (1 subgoal):\n 1. f2'' < f2", "by blast"], ["proof (state)\nthis:\n  f2'' < f2\n\ngoal:\nNo subgoals!", "qed"], ["", "(* This is the real constraint we want, not l0_f2f2',\n   but it involves f2'', which depends on l0 *)"], ["", "lemma f2f2'': \"(f2 - f2'')*l0 \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real l0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real l0", "have \"(f2 - f2'')*(l0-1) \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real (l0 - 1)", "using l0_gr1 l0_f2f2' f2'_less_f2"], ["proof (prove)\nusing this:\n  1 < l0\n  (f2 + 1) / (f2 - f2') \\<le> real l0\n  f2' < f2\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real (l0 - 1)", "by(simp add: f2''_def algebra_simps del: of_nat_diff) (simp add: field_simps)"], ["proof (state)\nthis:\n  1 \\<le> (f2 - f2'') * real (l0 - 1)\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real l0", "thus ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> (f2 - f2'') * real (l0 - 1)\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real l0", "using f2''_less_f2"], ["proof (prove)\nusing this:\n  1 \\<le> (f2 - f2'') * real (l0 - 1)\n  f2'' < f2\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f2 - f2'') * real l0", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  1 \\<le> (f2 - f2'') * real l0\n\ngoal:\nNo subgoals!", "qed"], ["", "(* This is the real constraint we want, not l0_f1f1',\n   but it involves f1'', which depends on l0 *)"], ["", "lemma f1''f1: \"(f1'' - f1)*c*l0 \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "have \"1 \\<le> (f1' - f1)*c*l0 - f1'*c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (f1' - f1) * c * real l0 - f1' * c", "using l0_f1f1' f1_less_f1'"], ["proof (prove)\nusing this:\n  (f1' * c + 1) / ((f1' - f1) * c) \\<le> real l0\n  f1 < f1'\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1' - f1) * c * real l0 - f1' * c", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  1 \\<le> (f1' - f1) * c * real l0 - f1' * c\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "also"], ["proof (state)\nthis:\n  1 \\<le> (f1' - f1) * c * real l0 - f1' * c\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "have \"\\<dots> = (f1'*((l0-1)/l0) - f1)*c*l0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f1' - f1) * c * real l0 - f1' * c =\n    (f1' * (real (l0 - 1) / real l0) - f1) * c * real l0", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  (f1' - f1) * c * real l0 - f1' * c =\n  (f1' * (real (l0 - 1) / real l0) - f1) * c * real l0\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "also"], ["proof (state)\nthis:\n  (f1' - f1) * c * real l0 - f1' * c =\n  (f1' * (real (l0 - 1) / real l0) - f1) * c * real l0\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "have \"(l0-1)/l0 \\<le> l0/(l0+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (l0 - 1) / real l0 \\<le> real l0 / real (l0 + 1)", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  real (l0 - 1) / real l0 \\<le> real l0 / real (l0 + 1)\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "also"], ["proof (state)\nthis:\n  real (l0 - 1) / real l0 \\<le> real l0 / real (l0 + 1)\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "have \"f1'*(l0/(l0+1)) = f1'*l0/(l0+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1' * (real l0 / real (l0 + 1)) = f1' * real l0 / real (l0 + 1)", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  f1' * (real l0 / real (l0 + 1)) = f1' * real l0 / real (l0 + 1)\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "also"], ["proof (state)\nthis:\n  f1' * (real l0 / real (l0 + 1)) = f1' * real l0 / real (l0 + 1)\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "note f1''_def[symmetric]"], ["proof (state)\nthis:\n  f1' * real l0 / real (l0 + 1) = f1''\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (f1' * x - f1) * c * real l0\n      \\<le> (f1' * y - f1) * c * real l0) \\<Longrightarrow>\n  1 \\<le> (f1'' - f1) * c * real l0", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (f1' * x - f1) * c * real l0\n      \\<le> (f1' * y - f1) * c * real l0) \\<Longrightarrow>\n  1 \\<le> (f1'' - f1) * c * real l0\n\ngoal (1 subgoal):\n 1. 1 \\<le> (f1'' - f1) * c * real l0", "by(simp)"], ["proof (state)\nthis:\n  1 \\<le> (f1'' - f1) * c * real l0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma f1''_f1': assumes \"l \\<ge> real l0\" shows \"f1''*(l+1) \\<le> f1' * l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1'' * (l + 1) \\<le> f1' * l", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f1'' * (l + 1) \\<le> f1' * l", "have \"f1''*(l+1) = f1'*(l0/(l0+1))*(l+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f1'' * (l + 1) = f1' * (real l0 / real (l0 + 1)) * (l + 1)", "by(simp add: f1''_def field_simps)"], ["proof (state)\nthis:\n  f1'' * (l + 1) = f1' * (real l0 / real (l0 + 1)) * (l + 1)\n\ngoal (1 subgoal):\n 1. f1'' * (l + 1) \\<le> f1' * l", "also"], ["proof (state)\nthis:\n  f1'' * (l + 1) = f1' * (real l0 / real (l0 + 1)) * (l + 1)\n\ngoal (1 subgoal):\n 1. f1'' * (l + 1) \\<le> f1' * l", "have \"l0/(l0+1) \\<le> l/(l+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l0 / real (l0 + 1) \\<le> l / (l + 1)", "using assms"], ["proof (prove)\nusing this:\n  real l0 \\<le> l\n\ngoal (1 subgoal):\n 1. real l0 / real (l0 + 1) \\<le> l / (l + 1)", "by(simp add: field_simps)"], ["proof (state)\nthis:\n  real l0 / real (l0 + 1) \\<le> l / (l + 1)\n\ngoal (1 subgoal):\n 1. f1'' * (l + 1) \\<le> f1' * l", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f1' * x * (l + 1) \\<le> f1' * y * (l + 1)) \\<Longrightarrow>\n  f1'' * (l + 1) \\<le> f1' * (l / (l + 1)) * (l + 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f1' * x * (l + 1) \\<le> f1' * y * (l + 1)) \\<Longrightarrow>\n  f1'' * (l + 1) \\<le> f1' * (l / (l + 1)) * (l + 1)\n\ngoal (1 subgoal):\n 1. f1'' * (l + 1) \\<le> f1' * l", "using \\<open>l0 \\<le> l\\<close>"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f1' * x * (l + 1) \\<le> f1' * y * (l + 1)) \\<Longrightarrow>\n  f1'' * (l + 1) \\<le> f1' * (l / (l + 1)) * (l + 1)\n  real l0 \\<le> l\n\ngoal (1 subgoal):\n 1. f1'' * (l + 1) \\<le> f1' * l", "by(simp)"], ["proof (state)\nthis:\n  f1'' * (l + 1) \\<le> f1' * l\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma f2'_f2'': assumes \"l \\<ge> real l0\" shows \"f2' * l \\<le> f2'' * (l-1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2' * l \\<le> f2'' * (l - 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f2' * l \\<le> f2'' * (l - 1)", "have \"f2' * l = f2' * l + f2'*((l0-1)/(l0-1) - 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2' * l = f2' * l + f2' * (real (l0 - 1) / real (l0 - 1) - 1)", "using l0_gr1"], ["proof (prove)\nusing this:\n  1 < l0\n\ngoal (1 subgoal):\n 1. f2' * l = f2' * l + f2' * (real (l0 - 1) / real (l0 - 1) - 1)", "by simp"], ["proof (state)\nthis:\n  f2' * l = f2' * l + f2' * (real (l0 - 1) / real (l0 - 1) - 1)\n\ngoal (1 subgoal):\n 1. f2' * l \\<le> f2'' * (l - 1)", "also"], ["proof (state)\nthis:\n  f2' * l = f2' * l + f2' * (real (l0 - 1) / real (l0 - 1) - 1)\n\ngoal (1 subgoal):\n 1. f2' * l \\<le> f2'' * (l - 1)", "have \"(l0-1)/(l0-1) \\<le> (l-1)/(l0-1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (l0 - 1) / real (l0 - 1) \\<le> (l - 1) / real (l0 - 1)", "using \\<open>l\\<ge>l0\\<close>"], ["proof (prove)\nusing this:\n  real l0 \\<le> l\n\ngoal (1 subgoal):\n 1. real (l0 - 1) / real (l0 - 1) \\<le> (l - 1) / real (l0 - 1)", "by(simp)"], ["proof (state)\nthis:\n  real (l0 - 1) / real (l0 - 1) \\<le> (l - 1) / real (l0 - 1)\n\ngoal (1 subgoal):\n 1. f2' * l \\<le> f2'' * (l - 1)", "also"], ["proof (state)\nthis:\n  real (l0 - 1) / real (l0 - 1) \\<le> (l - 1) / real (l0 - 1)\n\ngoal (1 subgoal):\n 1. f2' * l \\<le> f2'' * (l - 1)", "have \"f2'*l + f2'*((l-1)/(l0-1) - 1) = f2''*(l-1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f2' * l + f2' * ((l - 1) / real (l0 - 1) - 1) = f2'' * (l - 1)", "using l0_gr1"], ["proof (prove)\nusing this:\n  1 < l0\n\ngoal (1 subgoal):\n 1. f2' * l + f2' * ((l - 1) / real (l0 - 1) - 1) = f2'' * (l - 1)", "by(simp add: f2''_def field_simps)"], ["proof (state)\nthis:\n  f2' * l + f2' * ((l - 1) / real (l0 - 1) - 1) = f2'' * (l - 1)\n\ngoal (1 subgoal):\n 1. f2' * l \\<le> f2'' * (l - 1)", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f2' * l + f2' * (x - 1)\n      \\<le> f2' * l + f2' * (y - 1)) \\<Longrightarrow>\n  f2' * l \\<le> f2'' * (l - 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      f2' * l + f2' * (x - 1)\n      \\<le> f2' * l + f2' * (y - 1)) \\<Longrightarrow>\n  f2' * l \\<le> f2'' * (l - 1)\n\ngoal (1 subgoal):\n 1. f2' * l \\<le> f2'' * (l - 1)", "by simp"], ["proof (state)\nthis:\n  f2' * l \\<le> f2'' * (l - 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "sublocale Table2"], ["proof (prove)\ngoal (1 subgoal):\n 1. Table2 f1 f2 f1' f2' e c l0 f1'' f2''", "proof"], ["proof (state)\ngoal (8 subgoals):\n 1. 1 \\<le> (f2 - f2'') * real l0\n 2. 1 \\<le> (f1'' - f1) * c * real l0\n 3. f1 < f1''\n 4. f1'' < f1'\n 5. f2' < f2''\n 6. f2'' < f2\n 7. \\<And>l. real l0 \\<le> l \\<Longrightarrow> f1'' * (l + 1) \\<le> f1' * l\n 8. \\<And>l. real l0 \\<le> l \\<Longrightarrow> f2' * l \\<le> f2'' * (l - 1)", "qed (fact f1_less_f1'' f1''_less_f1' f2'_less_f2'' f2''_less_f2 f1''f1 f2f2'' f1''_f1' f2'_f2'')+"], ["", "end"], ["", "end"]]}