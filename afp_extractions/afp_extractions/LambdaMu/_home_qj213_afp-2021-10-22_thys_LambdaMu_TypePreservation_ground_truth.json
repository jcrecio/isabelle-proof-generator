{"file_name": "/home/qj213/afp-2021-10-22/thys/LambdaMu/TypePreservation.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/LambdaMu", "problem_names": ["lemma liftL_type: \n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> \\<forall>k. \\<Gamma>\\<langle>k:U\\<rangle>, \\<Delta> \\<turnstile>\\<^sub>T (liftL_trm t k) : T\"\n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<forall>k. \\<Gamma>\\<langle>k:U\\<rangle>, \\<Delta> \\<turnstile>\\<^sub>C (liftL_cmd c k)\"", "lemma liftM_type: \n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> \\<forall>k. \\<Gamma>, \\<Delta>\\<langle>k:U\\<rangle> \\<turnstile>\\<^sub>T (liftM_trm t k) : T\"\n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<forall>k. \\<Gamma>, \\<Delta>\\<langle>k:U\\<rangle> \\<turnstile>\\<^sub>C (liftM_cmd c k)\"", "lemma dropM_type:\n  \"\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> k \\<notin> fmv_trm t 0 \\<Longrightarrow> (\\<forall>x. x<k \\<longrightarrow> \\<Delta>1 x = \\<Delta> x) \n    \\<Longrightarrow> (\\<forall>x. x>k \\<longrightarrow> \\<Delta>1 x = \\<Delta> (x-1)) \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm t k : T\"\n  \"\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>C c \\<Longrightarrow> k \\<notin> fmv_cmd c 0 \\<Longrightarrow> (\\<forall>x. x<k \\<longrightarrow> \\<Delta>1 x = \\<Delta> x) \n    \\<Longrightarrow> (\\<forall>x. x>k \\<longrightarrow> \\<Delta>1 x = \\<Delta> (x-1)) \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd c k\"", "lemma liftL_ctxt_type:\n  assumes \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : T \\<Leftarrow> U\"\n  shows   \"\\<forall>k. \\<Gamma>\\<langle>k:T1\\<rangle>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t (liftL_ctxt E k) : T \\<Leftarrow> U\"", "lemma liftM_ctxt_type:\n  assumes \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : T \\<Leftarrow> U\"\n  shows   \"\\<Gamma>, \\<Delta>\\<langle>k:T1\\<rangle> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t (liftM_ctxt E k) : T \\<Leftarrow> U\"", "theorem subst_type:\n  \"\\<Gamma>1, \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T r : T1 \\<Longrightarrow> \\<Gamma>1 = \\<Gamma>\\<langle>k:T1\\<rangle> \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T\"\n  \"\\<Gamma>1, \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T r : T1 \\<Longrightarrow> \\<Gamma>1 = \\<Gamma>\\<langle>k:T1\\<rangle> \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C c[r/k]\\<^sup>C \"", "lemma struct_subst_command:\n  assumes \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t : T\" \"\\<Delta> x = T\" \"\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\" \"\\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\"\n          \"(\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1 \\<Longrightarrow> \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle> \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>T : T)\"\n  shows   \"\\<Gamma>,( \\<Delta>'\\<langle>\\<beta>:U\\<rangle>) \\<turnstile>\\<^sub>C (<x> t)[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>C\"", "theorem struct_subst_type:\n  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1 \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle> \\<Longrightarrow> \\<Gamma>, \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>T : T\"\n  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1  \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle> \\<Longrightarrow> \\<Gamma>, \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>C\"", "lemma struct_subst_type_command:  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1 \n    \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n    \\<Longrightarrow> \\<Gamma>, \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>C\"", "lemma dropM_env:\n  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>T t[k=x \\<diamond>]\\<^sup>T : T \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>x:(\\<Delta> x)\\<rangle> \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm (t[k=x \\<diamond>]\\<^sup>T) x : T\" \n  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>C c[k=x \\<diamond>]\\<^sup>C \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>x:(\\<Delta> x)\\<rangle> \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd (c[k=x \\<diamond>]\\<^sup>C) x\"", "theorem type_preservation:\n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> t \\<longlonglongrightarrow> s \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T s : T\"\n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow> c \\<^sub>C\\<longlonglongrightarrow> d \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C d\""], "translations": [["", "lemma liftL_type: \n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> \\<forall>k. \\<Gamma>\\<langle>k:U\\<rangle>, \\<Delta> \\<turnstile>\\<^sub>T (liftL_trm t k) : T\"\n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<forall>k. \\<Gamma>\\<langle>k:U\\<rangle>, \\<Delta> \\<turnstile>\\<^sub>C (liftL_cmd c k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow>\n     \\<forall>k.\n        \\<Gamma>\\<langle>k:U\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T liftL_trm\n                                 t k : T) &&&\n    (\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow>\n     \\<forall>k.\n        \\<Gamma>\\<langle>k:U\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>C liftL_cmd\n                                 c k)", "by (induct rule: typing_trm_typing_cmd.inducts) auto"], ["", "text\\<open>Shifting mu variables preserves well-typedness.\\<close>"], ["", "lemma liftM_type: \n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> \\<forall>k. \\<Gamma>, \\<Delta>\\<langle>k:U\\<rangle> \\<turnstile>\\<^sub>T (liftM_trm t k) : T\"\n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<forall>k. \\<Gamma>, \\<Delta>\\<langle>k:U\\<rangle> \\<turnstile>\\<^sub>C (liftM_cmd c k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow>\n     \\<forall>k.\n        \\<Gamma> , \\<Delta>\\<langle>k:U\\<rangle> \\<turnstile>\\<^sub>T liftM_trm\n                                 t k : T) &&&\n    (\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow>\n     \\<forall>k.\n        \\<Gamma> , \\<Delta>\\<langle>k:U\\<rangle> \\<turnstile>\\<^sub>C liftM_cmd\n                                 c k)", "by(induct rule: typing_trm_typing_cmd.inducts) auto"], ["", "lemma dropM_type:\n  \"\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> k \\<notin> fmv_trm t 0 \\<Longrightarrow> (\\<forall>x. x<k \\<longrightarrow> \\<Delta>1 x = \\<Delta> x) \n    \\<Longrightarrow> (\\<forall>x. x>k \\<longrightarrow> \\<Delta>1 x = \\<Delta> (x-1)) \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm t k : T\"\n  \"\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>C c \\<Longrightarrow> k \\<notin> fmv_cmd c 0 \\<Longrightarrow> (\\<forall>x. x<k \\<longrightarrow> \\<Delta>1 x = \\<Delta> x) \n    \\<Longrightarrow> (\\<forall>x. x>k \\<longrightarrow> \\<Delta>1 x = \\<Delta> (x-1)) \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd c k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrakk>\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>T t : T;\n      k \\<notin> fmv_trm t 0; \\<forall>x<k. \\<Delta>1 x = \\<Delta> x;\n      \\<forall>x>k. \\<Delta>1 x = \\<Delta> (x - 1)\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm t\n                           k : T) &&&\n    (\\<lbrakk>\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>C c;\n      k \\<notin> fmv_cmd c 0; \\<forall>x<k. \\<Delta>1 x = \\<Delta> x;\n      \\<forall>x>k. \\<Delta>1 x = \\<Delta> (x - 1)\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd c\n                           k)", "proof (induct arbitrary: k \\<Delta> and k \\<Delta> rule: typing_trm_typing_cmd.inducts)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> x = T; k \\<notin> fmv_trm (`x) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (`x) k : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  t k : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm s 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  s k : T1;\n        k \\<notin> fmv_trm (t \\<degree> s) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (t \\<degree> s) k : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 k \\<Delta>'.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                  t k : T2;\n        k \\<notin> fmv_trm (\\<lambda>T1:t) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (\\<lambda>T1:t) k : T1 \\<rightarrow> T2\n 4. \\<And>\\<Gamma> \\<Delta> T c k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_cmd c 0;\n            \\<forall>x<k. (\\<Delta>\\<langle>0:T\\<rangle>) x = \\<Delta>' x;\n            \\<forall>x>k.\n               (\\<Delta>\\<langle>0:T\\<rangle>) x =\n               \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>C dropM_cmd\n                                  c k;\n        k \\<notin> fmv_trm (\\<mu>T:c) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (\\<mu>T:c) k : T\n 5. \\<And>\\<Gamma> \\<Delta> t T x k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  t k : T;\n        \\<Delta> x = T; k \\<notin> fmv_cmd (<x>t) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>C dropM_cmd\n                              (<x>t) k", "case (activate \\<Gamma> \\<Delta> T c)"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta>'__\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>?k \\<notin> fmv_cmd c 0;\n   \\<forall>x<?k. (\\<Delta>'__\\<langle>0:T\\<rangle>) x = ?\\<Delta> x;\n   \\<forall>x>?k.\n      (\\<Delta>'__\\<langle>0:T\\<rangle>) x = ?\\<Delta> (x - 1)\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>C dropM_cmd c ?k\n  k \\<notin> fmv_trm (\\<mu>T:c) 0\n  \\<forall>x<k. \\<Delta>'__ x = \\<Delta> x\n  \\<forall>x>k. \\<Delta>'__ x = \\<Delta> (x - 1)\n\ngoal (5 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> x = T; k \\<notin> fmv_trm (`x) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (`x) k : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  t k : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm s 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  s k : T1;\n        k \\<notin> fmv_trm (t \\<degree> s) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (t \\<degree> s) k : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 k \\<Delta>'.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                  t k : T2;\n        k \\<notin> fmv_trm (\\<lambda>T1:t) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (\\<lambda>T1:t) k : T1 \\<rightarrow> T2\n 4. \\<And>\\<Gamma> \\<Delta> T c k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_cmd c 0;\n            \\<forall>x<k. (\\<Delta>\\<langle>0:T\\<rangle>) x = \\<Delta>' x;\n            \\<forall>x>k.\n               (\\<Delta>\\<langle>0:T\\<rangle>) x =\n               \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>C dropM_cmd\n                                  c k;\n        k \\<notin> fmv_trm (\\<mu>T:c) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (\\<mu>T:c) k : T\n 5. \\<And>\\<Gamma> \\<Delta> t T x k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  t k : T;\n        \\<Delta> x = T; k \\<notin> fmv_cmd (<x>t) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>C dropM_cmd\n                              (<x>t) k", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> , \\<Delta>'__\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>?k \\<notin> fmv_cmd c 0;\n   \\<forall>x<?k. (\\<Delta>'__\\<langle>0:T\\<rangle>) x = ?\\<Delta> x;\n   \\<forall>x>?k.\n      (\\<Delta>'__\\<langle>0:T\\<rangle>) x = ?\\<Delta> (x - 1)\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>C dropM_cmd c ?k\n  k \\<notin> fmv_trm (\\<mu>T:c) 0\n  \\<forall>x<k. \\<Delta>'__ x = \\<Delta> x\n  \\<forall>x>k. \\<Delta>'__ x = \\<Delta> (x - 1)", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta>'__\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>?k \\<notin> fmv_cmd c 0;\n   \\<forall>x<?k. (\\<Delta>'__\\<langle>0:T\\<rangle>) x = ?\\<Delta> x;\n   \\<forall>x>?k.\n      (\\<Delta>'__\\<langle>0:T\\<rangle>) x = ?\\<Delta> (x - 1)\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>C dropM_cmd c ?k\n  k \\<notin> fmv_trm (\\<mu>T:c) 0\n  \\<forall>x<k. \\<Delta>'__ x = \\<Delta> x\n  \\<forall>x>k. \\<Delta>'__ x = \\<Delta> (x - 1)\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm (\\<mu>T:c) k : T", "apply(erule_tac x = \"Suc k\" in meta_allE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta>'__\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n     k \\<notin> fmv_trm (\\<mu>T:c) 0;\n     \\<forall>x<k. \\<Delta>'__ x = \\<Delta> x;\n     \\<forall>x>k. \\<Delta>'__ x = \\<Delta> (x - 1);\n     \\<And>\\<Delta>.\n        \\<lbrakk>Suc k \\<notin> fmv_cmd c 0;\n         \\<forall>x<Suc k.\n            (\\<Delta>'__\\<langle>0:T\\<rangle>) x = \\<Delta> x;\n         \\<forall>x>Suc k.\n            (\\<Delta>'__\\<langle>0:T\\<rangle>) x = \\<Delta> (x - 1)\\<rbrakk>\n        \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd\n                              c (Suc k)\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm\n                          (\\<mu>T:c) k : T", "apply(insert fmv_suc(1))"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta>'__\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n     k \\<notin> fmv_trm (\\<mu>T:c) 0;\n     \\<forall>x<k. \\<Delta>'__ x = \\<Delta> x;\n     \\<forall>x>k. \\<Delta>'__ x = \\<Delta> (x - 1);\n     \\<And>\\<Delta>.\n        \\<lbrakk>Suc k \\<notin> fmv_cmd c 0;\n         \\<forall>x<Suc k.\n            (\\<Delta>'__\\<langle>0:T\\<rangle>) x = \\<Delta> x;\n         \\<forall>x>Suc k.\n            (\\<Delta>'__\\<langle>0:T\\<rangle>) x = \\<Delta> (x - 1)\\<rbrakk>\n        \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd\n                              c (Suc k);\n     \\<And>\\<beta> c n.\n        \\<beta> \\<notin> fmv_cmd c (Suc n) \\<Longrightarrow>\n        Suc \\<beta> \\<notin> fmv_cmd c n\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm\n                          (\\<mu>T:c) k : T", "apply(clarsimp simp add: shift_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm (\\<mu>T:c) k : T\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> x = T; k \\<notin> fmv_trm (`x) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (`x) k : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  t k : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm s 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  s k : T1;\n        k \\<notin> fmv_trm (t \\<degree> s) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (t \\<degree> s) k : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 k \\<Delta>'.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                  t k : T2;\n        k \\<notin> fmv_trm (\\<lambda>T1:t) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                              (\\<lambda>T1:t) k : T1 \\<rightarrow> T2\n 4. \\<And>\\<Gamma> \\<Delta> t T x k \\<Delta>'.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>k \\<Delta>'.\n           \\<lbrakk>k \\<notin> fmv_trm t 0;\n            \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n            \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>T dropM_trm\n                                  t k : T;\n        \\<Delta> x = T; k \\<notin> fmv_cmd (<x>t) 0;\n        \\<forall>x<k. \\<Delta> x = \\<Delta>' x;\n        \\<forall>x>k. \\<Delta> x = \\<Delta>' (x - 1)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>C dropM_cmd\n                              (<x>t) k", "qed fastforce+"], ["", "text\\<open>Lifting $\\lambda$ and $\\mu$-variables in contexts preserves contextual typing judgements.\\<close>"], ["", "lemma liftL_ctxt_type:\n  assumes \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : T \\<Leftarrow> U\"\n  shows   \"\\<forall>k. \\<Gamma>\\<langle>k:T1\\<rangle>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t (liftL_ctxt E k) : T \\<Leftarrow> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k.\n       \\<Gamma>\\<langle>k:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t liftL_ctxt\n                   E k : T \\<Leftarrow> U", "using assms"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : T \\<Leftarrow> U\n\ngoal (1 subgoal):\n 1. \\<forall>k.\n       \\<Gamma>\\<langle>k:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t liftL_ctxt\n                   E k : T \\<Leftarrow> U", "by (induct rule: typing_ctxt.induct) (auto simp add: liftL_type)"], ["", "lemma liftM_ctxt_type:\n  assumes \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : T \\<Leftarrow> U\"\n  shows   \"\\<Gamma>, \\<Delta>\\<langle>k:T1\\<rangle> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t (liftM_ctxt E k) : T \\<Leftarrow> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta>\\<langle>k:T1\\<rangle> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t liftM_ctxt\n                E k : T \\<Leftarrow> U", "using assms"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : T \\<Leftarrow> U\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta>\\<langle>k:T1\\<rangle> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t liftM_ctxt\n                E k : T \\<Leftarrow> U", "by(induct rule: typing_ctxt.induct) (auto simp add: liftM_type)"], ["", "text\\<open>Substitution lemma for logical substitution.\\<close>"], ["", "theorem subst_type:\n  \"\\<Gamma>1, \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T r : T1 \\<Longrightarrow> \\<Gamma>1 = \\<Gamma>\\<langle>k:T1\\<rangle> \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T\"\n  \"\\<Gamma>1, \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T r : T1 \\<Longrightarrow> \\<Gamma>1 = \\<Gamma>\\<langle>k:T1\\<rangle> \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C c[r/k]\\<^sup>C \""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrakk>\\<Gamma>1 , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n      \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n      \\<Gamma>1 = \\<Gamma>\\<langle>k:T1\\<rangle>\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T) &&&\n    (\\<lbrakk>\\<Gamma>1 , \\<Delta> \\<turnstile>\\<^sub>C c;\n      \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n      \\<Gamma>1 = \\<Gamma>\\<langle>k:T1\\<rangle>\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C c[r/k]\\<^sup>C)", "proof(induct arbitrary: \\<Gamma> k T1 r and \\<Gamma> k r T1 rule: typing_trm_typing_cmd.inducts)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (`x)[r/k]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Gamma>' k T1a r.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T1 \\<rightarrow>\n            T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T s[r/k]\\<^sup>T : T1;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (t \\<degree>\n                              s)[r/k]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 \\<Gamma>' k T1a r.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma>\\<langle>0:T1\\<rangle> =\n            \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T2;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (\\<lambda>T1:t)[r/k]\\<^sup>T : T1 \\<rightarrow>\n                      T2\n 4. \\<And>\\<Gamma> \\<Delta> T c \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Gamma>' k r T1.\n           \\<lbrakk>\\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c[r/k]\\<^sup>C;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (\\<mu>T:c)[r/k]\\<^sup>T : T\n 5. \\<And>\\<Gamma> \\<Delta> t T x \\<Gamma>' k r T1.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Gamma>' k T1 r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T;\n        \\<Delta> x = T; \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>C (<x>t)[r/k]\\<^sup>C", "case (lambda \\<Gamma> T1 \\<Delta> t T2)"], ["proof (state)\nthis:\n  \\<Gamma>'__\\<langle>0:T1a__\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2\n  \\<lbrakk>?\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?r : ?T1.0;\n   \\<Gamma>'__\\<langle>0:T1a__\\<rangle> =\n   ?\\<Gamma>\\<langle>?k:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t[?r/?k]\\<^sup>T : T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T r : T1\n  \\<Gamma>'__ = \\<Gamma>\\<langle>k:T1\\<rangle>\n\ngoal (5 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (`x)[r/k]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Gamma>' k T1a r.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T1 \\<rightarrow>\n            T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T s[r/k]\\<^sup>T : T1;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (t \\<degree>\n                              s)[r/k]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 \\<Gamma>' k T1a r.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma>\\<langle>0:T1\\<rangle> =\n            \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T2;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (\\<lambda>T1:t)[r/k]\\<^sup>T : T1 \\<rightarrow>\n                      T2\n 4. \\<And>\\<Gamma> \\<Delta> T c \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Gamma>' k r T1.\n           \\<lbrakk>\\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c[r/k]\\<^sup>C;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (\\<mu>T:c)[r/k]\\<^sup>T : T\n 5. \\<And>\\<Gamma> \\<Delta> t T x \\<Gamma>' k r T1.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Gamma>' k T1 r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T;\n        \\<Delta> x = T; \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>C (<x>t)[r/k]\\<^sup>C", "then"], ["proof (chain)\npicking this:\n  \\<Gamma>'__\\<langle>0:T1a__\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2\n  \\<lbrakk>?\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?r : ?T1.0;\n   \\<Gamma>'__\\<langle>0:T1a__\\<rangle> =\n   ?\\<Gamma>\\<langle>?k:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t[?r/?k]\\<^sup>T : T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T r : T1\n  \\<Gamma>'__ = \\<Gamma>\\<langle>k:T1\\<rangle>", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma>'__\\<langle>0:T1a__\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2\n  \\<lbrakk>?\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?r : ?T1.0;\n   \\<Gamma>'__\\<langle>0:T1a__\\<rangle> =\n   ?\\<Gamma>\\<langle>?k:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t[?r/?k]\\<^sup>T : T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T r : T1\n  \\<Gamma>'__ = \\<Gamma>\\<langle>k:T1\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T (\\<lambda>T1a__:t)[r/k]\\<^sup>T : T1a__ \\<rightarrow>\n   T2", "by -(rotate_tac 2, drule liftL_type(1), fastforce)"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T (\\<lambda>T1a__:t)[r/k]\\<^sup>T : T1a__ \\<rightarrow>\n T2\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (`x)[r/k]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Gamma>' k T1a r.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T1 \\<rightarrow>\n            T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T s[r/k]\\<^sup>T : T1;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (t \\<degree>\n                              s)[r/k]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> T c \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Gamma>' k r T1.\n           \\<lbrakk>\\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c[r/k]\\<^sup>C;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (\\<mu>T:c)[r/k]\\<^sup>T : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x \\<Gamma>' k r T1.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Gamma>' k T1 r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T;\n        \\<Delta> x = T; \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>C (<x>t)[r/k]\\<^sup>C", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (`x)[r/k]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Gamma>' k T1a r.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T1 \\<rightarrow>\n            T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T s[r/k]\\<^sup>T : T1;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (t \\<degree>\n                              s)[r/k]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> T c \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Gamma>' k r T1.\n           \\<lbrakk>\\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c[r/k]\\<^sup>C;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (\\<mu>T:c)[r/k]\\<^sup>T : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x \\<Gamma>' k r T1.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Gamma>' k T1 r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T;\n        \\<Delta> x = T; \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>C (<x>t)[r/k]\\<^sup>C", "case (activate \\<Gamma> \\<Delta> T c)"], ["proof (state)\nthis:\n  \\<Gamma>'__ , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>?\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>T ?r : ?T1.0;\n   \\<Gamma>'__ = ?\\<Gamma>\\<langle>?k:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c[?r/?k]\\<^sup>C\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T r : T1\n  \\<Gamma>'__ = \\<Gamma>\\<langle>k:T1\\<rangle>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (`x)[r/k]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Gamma>' k T1a r.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T1 \\<rightarrow>\n            T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T s[r/k]\\<^sup>T : T1;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (t \\<degree>\n                              s)[r/k]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> T c \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Gamma>' k r T1.\n           \\<lbrakk>\\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c[r/k]\\<^sup>C;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (\\<mu>T:c)[r/k]\\<^sup>T : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x \\<Gamma>' k r T1.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Gamma>' k T1 r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T;\n        \\<Delta> x = T; \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>C (<x>t)[r/k]\\<^sup>C", "then"], ["proof (chain)\npicking this:\n  \\<Gamma>'__ , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>?\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>T ?r : ?T1.0;\n   \\<Gamma>'__ = ?\\<Gamma>\\<langle>?k:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c[?r/?k]\\<^sup>C\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T r : T1\n  \\<Gamma>'__ = \\<Gamma>\\<langle>k:T1\\<rangle>", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma>'__ , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>?\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>T ?r : ?T1.0;\n   \\<Gamma>'__ = ?\\<Gamma>\\<langle>?k:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c[?r/?k]\\<^sup>C\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T r : T1\n  \\<Gamma>'__ = \\<Gamma>\\<langle>k:T1\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T (\\<mu>T:c)[r/k]\\<^sup>T : T", "by -(rotate_tac 2, drule liftM_type(1), fastforce)"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T (\\<mu>T:c)[r/k]\\<^sup>T : T\n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Gamma>' k T1 r.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (`x)[r/k]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Gamma>' k T1a r.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T1 \\<rightarrow>\n            T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Gamma>' k T1a r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T s[r/k]\\<^sup>T : T1;\n        \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1a;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T (t \\<degree>\n                              s)[r/k]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> t T x \\<Gamma>' k r T1.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Gamma>' k T1 r.\n           \\<lbrakk>\\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n            \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T t[r/k]\\<^sup>T : T;\n        \\<Delta> x = T; \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>T r : T1;\n        \\<Gamma> = \\<Gamma>'\\<langle>k:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma>' , \\<Delta> \\<turnstile>\\<^sub>C (<x>t)[r/k]\\<^sup>C", "qed force+"], ["", "text\\<open>Substitution lemma for structural substitution. The proof is by induction on the first typing judgement.\\<close>"], ["", "lemma struct_subst_command:\n  assumes \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t : T\" \"\\<Delta> x = T\" \"\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\" \"\\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\"\n          \"(\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1 \\<Longrightarrow> \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle> \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>T : T)\"\n  shows   \"\\<Gamma>,( \\<Delta>'\\<langle>\\<beta>:U\\<rangle>) \\<turnstile>\\<^sub>C (<x> t)[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n                      E \\<beta>]\\<^sup>C", "using assms"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T\n  \\<Delta> x = T\n  \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\n  \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n   \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                                 E \\<beta>]\\<^sup>T : T\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n                      E \\<beta>]\\<^sup>C", "apply clarsimp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle> \\<turnstile>\\<^sub>T t : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n             x;\n     \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n     \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>;\n     \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                  E \\<beta>]\\<^sup>T : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n  x;\n     T = (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>) x\\<rbrakk>\n    \\<Longrightarrow> (\\<beta> \\<le> x \\<and> x < \\<alpha> \\<longrightarrow>\n                       \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <Suc\n                  x>t[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T) \\<and>\n                      ((\\<beta> \\<le> x \\<longrightarrow>\n                        \\<not> x < \\<alpha>) \\<longrightarrow>\n                       (\\<alpha> < x \\<and>\n                        x \\<le> \\<beta> \\<longrightarrow>\n                        \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <x -\n                  Suc 0>t[\\<alpha>=\\<beta> liftM_ctxt E\n      \\<beta>]\\<^sup>T) \\<and>\n                       ((\\<alpha> < x \\<longrightarrow>\n                         \\<not> x \\<le> \\<beta>) \\<longrightarrow>\n                        (x = \\<alpha> \\<longrightarrow>\n                         \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <\\<beta>>ctxt_subst\n                            (liftM_ctxt E \\<beta>)\n                            (t[\\<alpha>=\\<beta> liftM_ctxt E\n           \\<beta>]\\<^sup>T)) \\<and>\n                        (x \\<noteq> \\<alpha> \\<longrightarrow>\n                         \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <x>t[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T)))", "apply (rule conjI, force, clarsimp)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle> \\<turnstile>\\<^sub>T t : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n             x;\n     \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n     \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>;\n     \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                  E \\<beta>]\\<^sup>T : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n  x;\n     T = (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>) x;\n     \\<beta> \\<le> x \\<longrightarrow> \\<not> x < \\<alpha>;\n     \\<alpha> < x \\<longrightarrow> \\<not> x \\<le> \\<beta>\\<rbrakk>\n    \\<Longrightarrow> (x = \\<alpha> \\<longrightarrow>\n                       \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <\\<beta>>ctxt_subst\n                          (liftM_ctxt E \\<beta>)\n                          (t[\\<alpha>=\\<beta> liftM_ctxt E\n         \\<beta>]\\<^sup>T)) \\<and>\n                      (x \\<noteq> \\<alpha> \\<longrightarrow>\n                       \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <x>t[\\<alpha>=\\<beta> liftM_ctxt\n E \\<beta>]\\<^sup>T)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle> \\<turnstile>\\<^sub>T t : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n             x;\n     \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n     \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>;\n     \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                  E \\<beta>]\\<^sup>T : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n  x;\n     T = (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>) x;\n     \\<beta> \\<le> x \\<longrightarrow> \\<not> x < \\<alpha>;\n     \\<alpha> < x \\<longrightarrow> \\<not> x \\<le> \\<beta>\\<rbrakk>\n    \\<Longrightarrow> x = \\<alpha> \\<longrightarrow>\n                      \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <\\<beta>>ctxt_subst\n                         (liftM_ctxt E \\<beta>)\n                         (t[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T)\n 2. \\<lbrakk>\\<Gamma> , \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle> \\<turnstile>\\<^sub>T t : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n             x;\n     \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n     \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>;\n     \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                  E \\<beta>]\\<^sup>T : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n  x;\n     T = (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>) x;\n     \\<beta> \\<le> x \\<longrightarrow> \\<not> x < \\<alpha>;\n     \\<alpha> < x \\<longrightarrow> \\<not> x \\<le> \\<beta>\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<alpha> \\<longrightarrow>\n                      \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <x>t[\\<alpha>=\\<beta> liftM_ctxt\nE \\<beta>]\\<^sup>T", "apply (metis liftM_ctxt_type passivate shift_eq typing_ctxt_correct2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle> \\<turnstile>\\<^sub>T t : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n             x;\n     \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n     \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>;\n     \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                  E \\<beta>]\\<^sup>T : (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>)\n  x;\n     T = (\\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>) x;\n     \\<beta> \\<le> x \\<longrightarrow> \\<not> x < \\<alpha>;\n     \\<alpha> < x \\<longrightarrow> \\<not> x \\<le> \\<beta>\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<alpha> \\<longrightarrow>\n                      \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C <x>t[\\<alpha>=\\<beta> liftM_ctxt\nE \\<beta>]\\<^sup>T", "apply force"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "theorem struct_subst_type:\n  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1 \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle> \\<Longrightarrow> \\<Gamma>, \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>T : T\"\n  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1  \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle> \\<Longrightarrow> \\<Gamma>, \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrakk>\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>T t : T;\n      \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n      \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                                   E \\<beta>]\\<^sup>T : T) &&&\n    (\\<lbrakk>\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>C c;\n      \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n      \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> liftM_ctxt\n                                   E \\<beta>]\\<^sup>C)", "proof (induct arbitrary: \\<Delta> T1 E U \\<beta> \\<alpha> and \\<Delta> T1 E U \\<beta> \\<alpha> rule: typing_trm_typing_cmd.inducts)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                          E \\<beta>]\\<^sup>T : T2;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<lambda>T1:t)[\\<alpha>=\\<beta> liftM_ctxt\n              E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2\n 4. \\<And>\\<Gamma> \\<Delta> T c \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta>\\<langle>0:T\\<rangle> =\n            \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>C;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<mu>T:c)[\\<alpha>=\\<beta> liftM_ctxt\n         E \\<beta>]\\<^sup>T : T\n 5. \\<And>\\<Gamma> \\<Delta> t T x \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T;\n        \\<Delta> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n     E \\<beta>]\\<^sup>C", "case (lambda \\<Gamma> T1 \\<Delta> t T2)"], ["proof (state)\nthis:\n  \\<Gamma>\\<langle>0:T1a__\\<rangle> , \\<Delta>'__ \\<turnstile>\\<^sub>T t : T2\n  \\<lbrakk>\\<Gamma>\\<langle>0:T1a__\\<rangle> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__ = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma>\\<langle>0:T1a__\\<rangle> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T t[?\\<alpha>=?\\<beta> liftM_ctxt\n                        ?E ?\\<beta>]\\<^sup>T : T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n\ngoal (5 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n                          E \\<beta>]\\<^sup>T : T2;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<lambda>T1:t)[\\<alpha>=\\<beta> liftM_ctxt\n              E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2\n 4. \\<And>\\<Gamma> \\<Delta> T c \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta>\\<langle>0:T\\<rangle> =\n            \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>C;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<mu>T:c)[\\<alpha>=\\<beta> liftM_ctxt\n         E \\<beta>]\\<^sup>T : T\n 5. \\<And>\\<Gamma> \\<Delta> t T x \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T;\n        \\<Delta> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n     E \\<beta>]\\<^sup>C", "then"], ["proof (chain)\npicking this:\n  \\<Gamma>\\<langle>0:T1a__\\<rangle> , \\<Delta>'__ \\<turnstile>\\<^sub>T t : T2\n  \\<lbrakk>\\<Gamma>\\<langle>0:T1a__\\<rangle> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__ = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma>\\<langle>0:T1a__\\<rangle> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T t[?\\<alpha>=?\\<beta> liftM_ctxt\n                        ?E ?\\<beta>]\\<^sup>T : T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma>\\<langle>0:T1a__\\<rangle> , \\<Delta>'__ \\<turnstile>\\<^sub>T t : T2\n  \\<lbrakk>\\<Gamma>\\<langle>0:T1a__\\<rangle> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__ = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma>\\<langle>0:T1a__\\<rangle> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T t[?\\<alpha>=?\\<beta> liftM_ctxt\n                        ?E ?\\<beta>]\\<^sup>T : T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<lambda>T1a__:t)[\\<alpha>=\\<beta> liftM_ctxt\n                                 E \\<beta>]\\<^sup>T : T1a__ \\<rightarrow> T2", "by -(drule liftL_ctxt_type, fastforce simp: liftLM_comm_ctxt)"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<lambda>T1a__:t)[\\<alpha>=\\<beta> liftM_ctxt\n                               E \\<beta>]\\<^sup>T : T1a__ \\<rightarrow> T2\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> T c \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta>\\<langle>0:T\\<rangle> =\n            \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>C;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<mu>T:c)[\\<alpha>=\\<beta> liftM_ctxt\n         E \\<beta>]\\<^sup>T : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T;\n        \\<Delta> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n     E \\<beta>]\\<^sup>C", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> T c \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta>\\<langle>0:T\\<rangle> =\n            \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>C;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<mu>T:c)[\\<alpha>=\\<beta> liftM_ctxt\n         E \\<beta>]\\<^sup>T : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T;\n        \\<Delta> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n     E \\<beta>]\\<^sup>C", "case (activate \\<Gamma> \\<Delta> T c)"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta>'__\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__\\<langle>0:T\\<rangle> =\n   ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>C c[?\\<alpha>=?\\<beta> liftM_ctxt\n                                     ?E ?\\<beta>]\\<^sup>C\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> T c \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta>\\<langle>0:T\\<rangle> =\n            \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>C;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<mu>T:c)[\\<alpha>=\\<beta> liftM_ctxt\n         E \\<beta>]\\<^sup>T : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T;\n        \\<Delta> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n     E \\<beta>]\\<^sup>C", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> , \\<Delta>'__\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__\\<langle>0:T\\<rangle> =\n   ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>C c[?\\<alpha>=?\\<beta> liftM_ctxt\n                                     ?E ?\\<beta>]\\<^sup>C\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta>'__\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c\n  \\<lbrakk>\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__\\<langle>0:T\\<rangle> =\n   ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>C c[?\\<alpha>=?\\<beta> liftM_ctxt\n                                     ?E ?\\<beta>]\\<^sup>C\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<mu>T:c)[\\<alpha>=\\<beta> liftM_ctxt\n                         E \\<beta>]\\<^sup>T : T", "by -(drule liftM_ctxt_type, fastforce simp: liftMM_comm_ctxt)"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (\\<mu>T:c)[\\<alpha>=\\<beta> liftM_ctxt\n                       E \\<beta>]\\<^sup>T : T\n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> t T x \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T;\n        \\<Delta> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n     E \\<beta>]\\<^sup>C", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> t T x \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T;\n        \\<Delta> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n     E \\<beta>]\\<^sup>C", "case (passivate \\<Gamma> \\<Delta> t T x)"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta>'__ \\<turnstile>\\<^sub>T t : T\n  \\<lbrakk>\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__ = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T t[?\\<alpha>=?\\<beta> liftM_ctxt\n                                     ?E ?\\<beta>]\\<^sup>T : T\n  \\<Delta>'__ x = T\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2\n 3. \\<And>\\<Gamma> \\<Delta> t T x \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>\\<Delta>' T1 E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T;\n        \\<Delta> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n     E \\<beta>]\\<^sup>C", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> , \\<Delta>'__ \\<turnstile>\\<^sub>T t : T\n  \\<lbrakk>\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__ = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T t[?\\<alpha>=?\\<beta> liftM_ctxt\n                                     ?E ?\\<beta>]\\<^sup>T : T\n  \\<Delta>'__ x = T\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta>'__ \\<turnstile>\\<^sub>T t : T\n  \\<lbrakk>\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__ = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T t[?\\<alpha>=?\\<beta> liftM_ctxt\n                                     ?E ?\\<beta>]\\<^sup>T : T\n  \\<Delta>'__ x = T\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n                     E \\<beta>]\\<^sup>C", "using struct_subst_command"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta>'__ \\<turnstile>\\<^sub>T t : T\n  \\<lbrakk>\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   \\<Delta>'__ = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T t[?\\<alpha>=?\\<beta> liftM_ctxt\n                                     ?E ?\\<beta>]\\<^sup>T : T\n  \\<Delta>'__ x = T\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1\n  \\<Delta>'__ = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n  \\<lbrakk>?\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>T ?t : ?T;\n   ?\\<Delta> ?x = ?T;\n   ?\\<Gamma> , ?\\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   ?\\<Delta> = ?\\<Delta>'\\<langle>?\\<alpha>:?T1.0\\<rangle>;\n   \\<lbrakk>?\\<Gamma> , ?\\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n    ?\\<Delta> = ?\\<Delta>'\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n   \\<Longrightarrow> ?\\<Gamma> , ?\\<Delta>'\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T ?t[?\\<alpha>=?\\<beta> liftM_ctxt\n   ?E ?\\<beta>]\\<^sup>T : ?T\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , ?\\<Delta>'\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>C (<?x>?t)[?\\<alpha>=?\\<beta> liftM_ctxt\n        ?E ?\\<beta>]\\<^sup>C\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n                     E \\<beta>]\\<^sup>C", "by force"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C (<x>t)[\\<alpha>=\\<beta> liftM_ctxt\n                   E \\<beta>]\\<^sup>C\n\ngoal (2 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> \\<Delta>' T1 E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> x = T;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (`x)[\\<alpha>=\\<beta> liftM_ctxt\n   E \\<beta>]\\<^sup>T : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s \\<Delta>' T1a E U \\<beta> \\<alpha>.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T t[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>\\<Delta>' T1a E U \\<beta> \\<alpha>.\n           \\<lbrakk>\\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n            \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n           \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T s[\\<alpha>=\\<beta> liftM_ctxt\n    E \\<beta>]\\<^sup>T : T1;\n        \\<Gamma> , \\<Delta>' \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1a;\n        \\<Delta> = \\<Delta>'\\<langle>\\<alpha>:T1a\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>'\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>T (t \\<degree>\n                   s)[\\<alpha>=\\<beta> liftM_ctxt E \\<beta>]\\<^sup>T : T2", "qed fastforce+"], ["", "lemma struct_subst_type_command:  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>C c \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1 \n    \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\n    \\<Longrightarrow> \\<Gamma>, \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> (liftM_ctxt E \\<beta>)]\\<^sup>C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>C c;\n     \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n     \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> liftM_ctxt\n                                  E \\<beta>]\\<^sup>C", "using struct_subst_type"], ["proof (prove)\nusing this:\n  \\<lbrakk>?\\<Gamma> , ?\\<Delta>1.0 \\<turnstile>\\<^sub>T ?t : ?T;\n   ?\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   ?\\<Delta>1.0 = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>T ?t[?\\<alpha>=?\\<beta> liftM_ctxt\n ?E ?\\<beta>]\\<^sup>T : ?T\n  \\<lbrakk>?\\<Gamma> , ?\\<Delta>1.0 \\<turnstile>\\<^sub>C ?c;\n   ?\\<Gamma> , ?\\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E : ?U \\<Leftarrow> ?T1.0;\n   ?\\<Delta>1.0 = ?\\<Delta>\\<langle>?\\<alpha>:?T1.0\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?\\<Gamma> , ?\\<Delta>\\<langle>?\\<beta>:?U\\<rangle> \\<turnstile>\\<^sub>C ?c[?\\<alpha>=?\\<beta> liftM_ctxt\n ?E ?\\<beta>]\\<^sup>C\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>C c;\n     \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t E : U \\<Leftarrow> T1;\n     \\<Delta>1 = \\<Delta>\\<langle>\\<alpha>:T1\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>\\<beta>:U\\<rangle> \\<turnstile>\\<^sub>C c[\\<alpha>=\\<beta> liftM_ctxt\n                                  E \\<beta>]\\<^sup>C", "by force"], ["", "lemma dropM_env:\n  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>T t[k=x \\<diamond>]\\<^sup>T : T \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>x:(\\<Delta> x)\\<rangle> \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm (t[k=x \\<diamond>]\\<^sup>T) x : T\" \n  \"\\<Gamma>, \\<Delta>1 \\<turnstile>\\<^sub>C c[k=x \\<diamond>]\\<^sup>C \\<Longrightarrow> \\<Delta>1 = \\<Delta>\\<langle>x:(\\<Delta> x)\\<rangle> \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd (c[k=x \\<diamond>]\\<^sup>C) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrakk>\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>T t[k=x \\<diamond>]\\<^sup>T : T;\n      \\<Delta>1 = \\<Delta>\\<langle>x:\\<Delta> x\\<rangle>\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T dropM_trm\n                           (t[k=x \\<diamond>]\\<^sup>T) x : T) &&&\n    (\\<lbrakk>\\<Gamma> , \\<Delta>1 \\<turnstile>\\<^sub>C c[k=x \\<diamond>]\\<^sup>C;\n      \\<Delta>1 = \\<Delta>\\<langle>x:\\<Delta> x\\<rangle>\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd\n                           (c[k=x \\<diamond>]\\<^sup>C) x)", "by (induct t and c arbitrary: \\<Gamma> T \\<Delta>1 x k \\<Delta> and \\<Gamma> T \\<Delta>1 x k \\<Delta>) fastforce+"], ["", "theorem type_preservation:\n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T t : T \\<Longrightarrow> t \\<longlonglongrightarrow> s \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>T s : T\"\n  \"\\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C c \\<Longrightarrow> c \\<^sub>C\\<longlonglongrightarrow> d \\<Longrightarrow> \\<Gamma>, \\<Delta> \\<turnstile>\\<^sub>C d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n      t \\<longlonglongrightarrow> s\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T) &&&\n    (\\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C c;\n      c \\<^sub>C\\<longlonglongrightarrow> d\\<rbrakk>\n     \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d)", "proof(induct arbitrary: s and d rule: typing_trm_typing_cmd.inducts)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> s.\n       \\<lbrakk>\\<Gamma> x = T; `x \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s sa.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>sa.\n           s \\<longlonglongrightarrow> sa \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T sa : T1;\n        t \\<degree> s \\<longlonglongrightarrow> sa\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T sa : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 s.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T s : T2;\n        \\<lambda>T1:t \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                                T2\n 4. \\<And>\\<Gamma> \\<Delta> T c s.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>d.\n           c \\<^sub>C\\<longlonglongrightarrow> d \\<Longrightarrow>\n           \\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C d;\n        \\<mu>T:c \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 5. \\<And>\\<Gamma> \\<Delta> t T x d.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T;\n        \\<Delta> x = T; <x>t \\<^sub>C\\<longlonglongrightarrow> d\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "case (app \\<Gamma> \\<Delta> t T1 T2 s s')"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow> T2\n  t \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T1 \\<rightarrow> T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1\n  s \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T1\n  t \\<degree> s \\<longlonglongrightarrow> s'\n\ngoal (5 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> s.\n       \\<lbrakk>\\<Gamma> x = T; `x \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 2. \\<And>\\<Gamma> \\<Delta> t T1 T2 s sa.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>sa.\n           s \\<longlonglongrightarrow> sa \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T sa : T1;\n        t \\<degree> s \\<longlonglongrightarrow> sa\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T sa : T2\n 3. \\<And>\\<Gamma> T1 \\<Delta> t T2 s.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T s : T2;\n        \\<lambda>T1:t \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                                T2\n 4. \\<And>\\<Gamma> \\<Delta> T c s.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>d.\n           c \\<^sub>C\\<longlonglongrightarrow> d \\<Longrightarrow>\n           \\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C d;\n        \\<mu>T:c \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 5. \\<And>\\<Gamma> \\<Delta> t T x d.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T;\n        \\<Delta> x = T; <x>t \\<^sub>C\\<longlonglongrightarrow> d\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow> T2\n  t \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T1 \\<rightarrow> T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1\n  s \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T1\n  t \\<degree> s \\<longlonglongrightarrow> s'", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow> T2\n  t \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T1 \\<rightarrow> T2\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1\n  s \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T1\n  t \\<degree> s \\<longlonglongrightarrow> s'\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s' : T2", "apply -"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                    T2;\n     \\<And>s.\n        t \\<longlonglongrightarrow> s \\<Longrightarrow>\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n     \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n     \\<And>s.\n        s \\<longlonglongrightarrow> s \\<Longrightarrow>\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n     t \\<degree> s \\<longlonglongrightarrow> s'\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s' : T2", "apply (erule redE; clarsimp simp: subst_type(1))"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>0:T2\\<rangle> \\<turnstile>\\<^sub>C c[0=0 \\<diamond> \\<^sup>\\<bullet>\n                  liftM_trm s 0]\\<^sup>C\n 2. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = u \\<degree> s; t \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T u \\<degree>\n                            s : T2\n 3. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = t \\<degree> u; s \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t \\<degree>\n                            u : T2", "apply (subgoal_tac \"\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ctxt_subst (\\<diamond> \\<^sup>\\<bullet> s) (\\<mu>(T1\\<rightarrow>T2) : c) : T2\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ctxt_subst\n            (\\<diamond> \\<^sup>\\<bullet> s)\n            (\\<mu>T1 \\<rightarrow> T2:c) : T2\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>0:T2\\<rangle> \\<turnstile>\\<^sub>C c[0=0 \\<diamond> \\<^sup>\\<bullet>\n                  liftM_trm s 0]\\<^sup>C\n 2. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ctxt_subst\n                             (\\<diamond> \\<^sup>\\<bullet> s)\n                             (\\<mu>T1 \\<rightarrow> T2:c) : T2\n 3. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = u \\<degree> s; t \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T u \\<degree>\n                            s : T2\n 4. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = t \\<degree> u; s \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t \\<degree>\n                            u : T2", "apply (drule typing_ctxt_correct1, clarsimp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>c T1a.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t \\<diamond> : T1a \\<rightarrow>\n          T2 \\<Leftarrow> T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1a;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>0:T2\\<rangle> \\<turnstile>\\<^sub>C c[0=0 \\<diamond> \\<^sup>\\<bullet>\n                  liftM_trm s 0]\\<^sup>C\n 2. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ctxt_subst\n                             (\\<diamond> \\<^sup>\\<bullet> s)\n                             (\\<mu>T1 \\<rightarrow> T2:c) : T2\n 3. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = u \\<degree> s; t \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T u \\<degree>\n                            s : T2\n 4. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = t \\<degree> u; s \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t \\<degree>\n                            u : T2", "apply (subgoal_tac \"\\<Gamma> , \\<Delta>\\<langle>0:T2\\<rangle> \\<turnstile>\\<^sub>C c[0=0 (liftM_ctxt (\\<diamond> \\<^sup>\\<bullet> s) 0)]\\<^sup>C\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>c T1a.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t \\<diamond> : T1a \\<rightarrow>\n          T2 \\<Leftarrow> T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1a;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<Gamma> , \\<Delta>\\<langle>0:T2\\<rangle> \\<turnstile>\\<^sub>C c[0=0 liftM_ctxt\n  (\\<diamond> \\<^sup>\\<bullet> s) 0]\\<^sup>C\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>0:T2\\<rangle> \\<turnstile>\\<^sub>C c[0=0 \\<diamond> \\<^sup>\\<bullet>\n                  liftM_trm s 0]\\<^sup>C\n 2. \\<And>c T1a.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t \\<diamond> : T1a \\<rightarrow>\n          T2 \\<Leftarrow> T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1a;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta>\\<langle>0:T2\\<rangle> \\<turnstile>\\<^sub>C c[0=0 liftM_ctxt\n                   (\\<diamond> \\<^sup>\\<bullet> s) 0]\\<^sup>C\n 3. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ctxt_subst\n                             (\\<diamond> \\<^sup>\\<bullet> s)\n                             (\\<mu>T1 \\<rightarrow> T2:c) : T2\n 4. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = u \\<degree> s; t \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T u \\<degree>\n                            s : T2\n 5. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = t \\<degree> u; s \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t \\<degree>\n                            u : T2", "apply (clarsimp, rule struct_subst_type_command)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>c T1a.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t \\<diamond> : T1a \\<rightarrow>\n          T2 \\<Leftarrow> T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1a;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , ?\\<Delta>1.44 c\n                                     T1a \\<turnstile>\\<^sub>C c\n 2. \\<And>c T1a.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t \\<diamond> : T1a \\<rightarrow>\n          T2 \\<Leftarrow> T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1a;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t \\<diamond> \\<^sup>\\<bullet>\n              s : T2 \\<Leftarrow> ?T1.44 c T1a\n 3. \\<And>c T1a.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t \\<diamond> : T1a \\<rightarrow>\n          T2 \\<Leftarrow> T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1a;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> ?\\<Delta>1.44 c T1a =\n                         \\<Delta>\\<langle>0:?T1.44 c T1a\\<rangle>\n 4. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>T1 \\<rightarrow> T2:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                          T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        t = \\<mu>T1 \\<rightarrow> T2:c;\n        s' =\n        \\<mu>T2:c[0=0 \\<diamond> \\<^sup>\\<bullet> liftM_trm s 0]\\<^sup>C;\n        \\<Gamma> , \\<Delta>\\<langle>0:T1 \\<rightarrow>\nT2\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ctxt_subst\n                             (\\<diamond> \\<^sup>\\<bullet> s)\n                             (\\<mu>T1 \\<rightarrow> T2:c) : T2\n 5. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = u \\<degree> s; t \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T u \\<degree>\n                            s : T2\n 6. \\<And>u.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T1 \\<rightarrow>\n                       T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow> T2;\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        \\<And>s.\n           s \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1;\n        s' = t \\<degree> u; s \\<longlonglongrightarrow> u\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t \\<degree>\n                            u : T2", "apply force+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s' : T2\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> s.\n       \\<lbrakk>\\<Gamma> x = T; `x \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 2. \\<And>\\<Gamma> T1 \\<Delta> t T2 s.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T s : T2;\n        \\<lambda>T1:t \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                                T2\n 3. \\<And>\\<Gamma> \\<Delta> T c s.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>d.\n           c \\<^sub>C\\<longlonglongrightarrow> d \\<Longrightarrow>\n           \\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C d;\n        \\<mu>T:c \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x d.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T;\n        \\<Delta> x = T; <x>t \\<^sub>C\\<longlonglongrightarrow> d\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> s.\n       \\<lbrakk>\\<Gamma> x = T; `x \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 2. \\<And>\\<Gamma> T1 \\<Delta> t T2 s.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T s : T2;\n        \\<lambda>T1:t \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                                T2\n 3. \\<And>\\<Gamma> \\<Delta> T c s.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>d.\n           c \\<^sub>C\\<longlonglongrightarrow> d \\<Longrightarrow>\n           \\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C d;\n        \\<mu>T:c \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x d.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T;\n        \\<Delta> x = T; <x>t \\<^sub>C\\<longlonglongrightarrow> d\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "case (passivate \\<Gamma> \\<Delta> t T x)"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T\n  t \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T\n  \\<Delta> x = T\n  <x>t \\<^sub>C\\<longlonglongrightarrow> d\n\ngoal (4 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> s.\n       \\<lbrakk>\\<Gamma> x = T; `x \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 2. \\<And>\\<Gamma> T1 \\<Delta> t T2 s.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T s : T2;\n        \\<lambda>T1:t \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                                T2\n 3. \\<And>\\<Gamma> \\<Delta> T c s.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>d.\n           c \\<^sub>C\\<longlonglongrightarrow> d \\<Longrightarrow>\n           \\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C d;\n        \\<mu>T:c \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 4. \\<And>\\<Gamma> \\<Delta> t T x d.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T;\n        \\<Delta> x = T; <x>t \\<^sub>C\\<longlonglongrightarrow> d\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T\n  t \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T\n  \\<Delta> x = T\n  <x>t \\<^sub>C\\<longlonglongrightarrow> d", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : T\n  t \\<longlonglongrightarrow> ?s \\<Longrightarrow>\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T ?s : T\n  \\<Delta> x = T\n  <x>t \\<^sub>C\\<longlonglongrightarrow> d\n\ngoal (1 subgoal):\n 1. \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "apply clarsimp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : \\<Delta> x;\n     \\<And>s.\n        t \\<longlonglongrightarrow> s \\<Longrightarrow>\n        \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : \\<Delta> x;\n     <x>t \\<^sub>C\\<longlonglongrightarrow> d; T = \\<Delta> x\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "apply (erule redE, clarsimp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>\\<Delta> x:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : \\<Delta> x;\n        T = \\<Delta> x; t = \\<mu>\\<Delta> x:c;\n        d = dropM_cmd (c[0=x \\<diamond>]\\<^sup>C) x;\n        \\<Gamma> , \\<Delta>\\<langle>0:\\<Delta>\n x\\<rangle> \\<turnstile>\\<^sub>C c\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd\n                             (c[0=x \\<diamond>]\\<^sup>C) x\n 2. \\<And>s.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : \\<Delta> x;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : \\<Delta> x;\n        T = \\<Delta> x; d = <x>s; t \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "apply (drule struct_subst_type_command [where \\<beta> = x])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>\\<Delta> x:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : \\<Delta> x;\n        T = \\<Delta> x; t = \\<mu>\\<Delta> x:c;\n        d = dropM_cmd (c[0=x \\<diamond>]\\<^sup>C) x\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , ?\\<Delta>15\n                                     c \\<turnstile>\\<^sub>c\\<^sub>t\\<^sub>x\\<^sub>t ?E15\n         c : ?U15 c \\<Leftarrow> ?T1.15 c\n 2. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>\\<Delta> x:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : \\<Delta> x;\n        T = \\<Delta> x; t = \\<mu>\\<Delta> x:c;\n        d = dropM_cmd (c[0=x \\<diamond>]\\<^sup>C) x\\<rbrakk>\n       \\<Longrightarrow> \\<Delta>\\<langle>0:\\<Delta> x\\<rangle> =\n                         ?\\<Delta>15\n                          c\\<langle>?\\<alpha>15 c:?T1.15 c\\<rangle>\n 3. \\<And>c.\n       \\<lbrakk>\\<And>s.\n                   \\<mu>\\<Delta> x:c \\<longlonglongrightarrow>\n                   s \\<Longrightarrow>\n                   \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : \\<Delta> x;\n        T = \\<Delta> x; t = \\<mu>\\<Delta> x:c;\n        d = dropM_cmd (c[0=x \\<diamond>]\\<^sup>C) x;\n        \\<Gamma> , ?\\<Delta>15\n                    c\\<langle>x:?U15\n                                 c\\<rangle> \\<turnstile>\\<^sub>C c[?\\<alpha>15\n                              c=x liftM_ctxt (?E15 c) x]\\<^sup>C\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C dropM_cmd\n                             (c[0=x \\<diamond>]\\<^sup>C) x\n 4. \\<And>s.\n       \\<lbrakk>\\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T t : \\<Delta> x;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : \\<Delta> x;\n        T = \\<Delta> x; d = <x>s; t \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d", "apply (fastforce simp: dropM_env(2))+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>C d\n\ngoal (3 subgoals):\n 1. \\<And>\\<Gamma> x T \\<Delta> s.\n       \\<lbrakk>\\<Gamma> x = T; `x \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T\n 2. \\<And>\\<Gamma> T1 \\<Delta> t T2 s.\n       \\<lbrakk>\\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T t : T2;\n        \\<And>s.\n           t \\<longlonglongrightarrow> s \\<Longrightarrow>\n           \\<Gamma>\\<langle>0:T1\\<rangle> , \\<Delta> \\<turnstile>\\<^sub>T s : T2;\n        \\<lambda>T1:t \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T1 \\<rightarrow>\n                                T2\n 3. \\<And>\\<Gamma> \\<Delta> T c s.\n       \\<lbrakk>\\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C c;\n        \\<And>d.\n           c \\<^sub>C\\<longlonglongrightarrow> d \\<Longrightarrow>\n           \\<Gamma> , \\<Delta>\\<langle>0:T\\<rangle> \\<turnstile>\\<^sub>C d;\n        \\<mu>T:c \\<longlonglongrightarrow> s\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> , \\<Delta> \\<turnstile>\\<^sub>T s : T", "qed (force simp: dropM_type)+"], ["", "end"]]}