{"file_name": "/home/qj213/afp-2021-10-22/thys/Amortized_Complexity/Amortized_Framework0.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Amortized_Complexity", "problem_names": ["lemma inv_state: \"inv(state f n)\"", "lemma aeq: \"(\\<Sum>i<n. T (f i) (state f i)) = (\\<Sum>i<n. A f i) - \\<Phi>(state f n)\"", "lemma aa1: \"A f i \\<le> U (f i) (state f i)\"", "lemma ub: \"(\\<Sum>i<n. T (f i) (state f i)) \\<le> (\\<Sum>i<n. U (f i) (state f i))\"", "lemma A_incr: \"T_incr bs + \\<Phi>(incr bs) - \\<Phi> bs = 2\"", "lemma ac: \"a \\<ge> 1/(c - 1)\"", "lemma a0[arith]: \"a>0\"", "lemma b0[arith]: \"b > 0\""], "translations": [["", "lemma inv_state: \"inv(state f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv (state f n)", "by(induction n)(simp_all add: inv_init inv_nxt)"], ["", "definition A :: \"(nat \\<Rightarrow> 'o) \\<Rightarrow> nat \\<Rightarrow> real\" where\n\"A f i = T (f i) (state f i) + \\<Phi>(state f (i+1)) - \\<Phi>(state f i)\""], ["", "lemma aeq: \"(\\<Sum>i<n. T (f i) (state f i)) = (\\<Sum>i<n. A f i) - \\<Phi>(state f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n. T (f i) (state f i)) = sum (A f) {..<n} - \\<Phi> (state f n)", "apply(induction n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<Sum>i<0. T (f i) (state f i)) = sum (A f) {..<0} - \\<Phi> (state f 0)\n 2. \\<And>n.\n       (\\<Sum>i<n. T (f i) (state f i)) =\n       sum (A f) {..<n} - \\<Phi> (state f n) \\<Longrightarrow>\n       (\\<Sum>i<Suc n. T (f i) (state f i)) =\n       sum (A f) {..<Suc n} - \\<Phi> (state f (Suc n))", "apply (simp add: p0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<Sum>i<n. T (f i) (state f i)) =\n       sum (A f) {..<n} - \\<Phi> (state f n) \\<Longrightarrow>\n       (\\<Sum>i<Suc n. T (f i) (state f i)) =\n       sum (A f) {..<Suc n} - \\<Phi> (state f (Suc n))", "apply (simp add: A_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "corollary TA: \"(\\<Sum>i<n. T (f i) (state f i)) \\<le> (\\<Sum>i<n. A f i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n. T (f i) (state f i)) \\<le> sum (A f) {..<n}", "by (metis add.commute aeq diff_add_cancel le_add_same_cancel2 ppos[OF inv_state])"], ["", "lemma aa1: \"A f i \\<le> U (f i) (state f i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A f i \\<le> U (f i) (state f i)", "by(simp add: A_def U inv_state)"], ["", "lemma ub: \"(\\<Sum>i<n. T (f i) (state f i)) \\<le> (\\<Sum>i<n. U (f i) (state f i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n. T (f i) (state f i)) \\<le> (\\<Sum>i<n. U (f i) (state f i))", "by (metis (mono_tags) aa1 order.trans sum_mono TA)"], ["", "end"], ["", "subsection \"Binary Counter\""], ["", "locale BinCounter\nbegin"], ["", "fun incr where\n\"incr [] = [True]\" |\n\"incr (False#bs) = True # bs\" |\n\"incr (True#bs) = False # incr bs\""], ["", "fun T_incr :: \"bool list \\<Rightarrow> real\" where\n\"T_incr [] = 1\" |\n\"T_incr (False#bs) = 1\" |\n\"T_incr (True#bs) = T_incr bs + 1\""], ["", "definition p_incr :: \"bool list \\<Rightarrow> real\" (\"\\<Phi>\") where\n\"\\<Phi> bs = length(filter id bs)\""], ["", "lemma A_incr: \"T_incr bs + \\<Phi>(incr bs) - \\<Phi> bs = 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T_incr bs + \\<Phi> (incr bs) - \\<Phi> bs = 2", "apply(induction bs rule: incr.induct)"], ["proof (prove)\ngoal (3 subgoals):\n 1. T_incr [] + \\<Phi> (incr []) - \\<Phi> [] = 2\n 2. \\<And>bs.\n       T_incr (False # bs) + \\<Phi> (incr (False # bs)) -\n       \\<Phi> (False # bs) =\n       2\n 3. \\<And>bs.\n       T_incr bs + \\<Phi> (incr bs) - \\<Phi> bs = 2 \\<Longrightarrow>\n       T_incr (True # bs) + \\<Phi> (incr (True # bs)) - \\<Phi> (True # bs) =\n       2", "apply (simp_all add: p_incr_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "interpretation incr: Amortized\nwhere init = \"[]\" and nxt = \"%_. incr\" and inv = \"\\<lambda>_. True\"\nand T = \"\\<lambda>_. T_incr\" and \\<Phi> = \\<Phi> and U = \"\\<lambda>_ _. 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized [] (\\<lambda>_. incr) (\\<lambda>_. True) (\\<lambda>_. T_incr)\n     \\<Phi> (\\<lambda>_ _. 2)", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. True\n 2. \\<And>s f. True \\<Longrightarrow> True\n 3. \\<And>s. True \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 4. \\<Phi> [] = 0\n 5. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. True\n 2. \\<And>s f. True \\<Longrightarrow> True\n 3. \\<And>s. True \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 4. \\<Phi> [] = 0\n 5. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. True", "by simp"], ["proof (state)\nthis:\n  True\n\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s. True \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> [] = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s. True \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> [] = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "case 2"], ["proof (state)\nthis:\n  True\n\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s. True \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 3. \\<Phi> [] = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. True", "by simp"], ["proof (state)\nthis:\n  True\n\ngoal (3 subgoals):\n 1. \\<And>s. True \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> [] = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s. True \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> [] = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "case 3"], ["proof (state)\nthis:\n  True\n\ngoal (3 subgoals):\n 1. \\<And>s. True \\<Longrightarrow> 0 \\<le> \\<Phi> s\n 2. \\<Phi> [] = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> \\<Phi> s_", "by(simp add: p_incr_def)"], ["proof (state)\nthis:\n  0 \\<le> \\<Phi> s_\n\ngoal (2 subgoals):\n 1. \\<Phi> [] = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<Phi> [] = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<Phi> [] = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Phi> [] = 0", "by(simp add: p_incr_def)"], ["proof (state)\nthis:\n  \\<Phi> [] = 0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "case 5"], ["proof (state)\nthis:\n  True\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow> T_incr s + \\<Phi> (incr s) - \\<Phi> s \\<le> 2", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. T_incr s_ + \\<Phi> (incr s_) - \\<Phi> s_ \\<le> 2", "by(simp add: A_incr)"], ["proof (state)\nthis:\n  T_incr s_ + \\<Phi> (incr s_) - \\<Phi> s_ \\<le> 2\n\ngoal:\nNo subgoals!", "qed"], ["", "thm incr.ub"], ["", "end"], ["", "subsection \"Dynamic tables: insert only\""], ["", "fun T_ins :: \"nat \\<times> nat \\<Rightarrow> real\" where\n\"T_ins (n,l) = (if n<l then 1 else n+1)\""], ["", "interpretation ins: Amortized\nwhere init = \"(0::nat,0::nat)\"\nand nxt = \"\\<lambda>_ (n,l). (n+1, if n<l then l else if l=0 then 1 else 2*l)\"\nand inv = \"\\<lambda>(n,l). if l=0 then n=0 else n \\<le> l \\<and> l < 2*n\"\nand T = \"\\<lambda>_. T_ins\" and \\<Phi> = \"\\<lambda>(n,l). 2*n - l\" and U = \"\\<lambda>_ _. 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized (0, 0)\n     (\\<lambda>_ (n, l).\n         (n + 1, if n < l then l else if l = 0 then 1 else 2 * l))\n     (\\<lambda>(n, l). if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n)\n     (\\<lambda>_. T_ins) (\\<lambda>(xa, x). real (2 * xa - x))\n     (\\<lambda>_ _. 3)", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. case (0, 0) of\n    (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       case case s of\n            (n, l) \\<Rightarrow>\n              (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n 3. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n 4. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 5. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. case (0, 0) of\n    (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       case case s of\n            (n, l) \\<Rightarrow>\n              (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n 3. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n 4. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 5. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. case (0, 0) of\n    (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n", "by auto"], ["proof (state)\nthis:\n  case (0, 0) of\n  (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       case case s of\n            (n, l) \\<Rightarrow>\n              (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n 2. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n 3. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 4. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       case case s of\n            (n, l) \\<Rightarrow>\n              (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n 2. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n 3. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 4. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "case (2 s)"], ["proof (state)\nthis:\n  case s of\n  (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       case case s of\n            (n, l) \\<Rightarrow>\n              (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n 2. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n 3. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 4. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "thus ?case"], ["proof (prove)\nusing this:\n  case s of\n  (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n\ngoal (1 subgoal):\n 1. case case s of\n         (n, l) \\<Rightarrow>\n           (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n    (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n", "by(cases s) auto"], ["proof (state)\nthis:\n  case case s of\n       (n, l) \\<Rightarrow>\n         (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n  (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n 2. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 3. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n 2. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 3. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "case (3 s)"], ["proof (state)\nthis:\n  case s of\n  (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n 2. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 3. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "thus ?case"], ["proof (prove)\nusing this:\n  case s of\n  (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n\ngoal (1 subgoal):\n 1. 0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))", "by(cases s)(simp split: if_splits)"], ["proof (state)\nthis:\n  0 \\<le> (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n\ngoal (2 subgoals):\n 1. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0", "by(simp)"], ["proof (state)\nthis:\n  (case (0, 0) of (x, xa) \\<Rightarrow> real (2 * x - xa)) = 0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "case (5 s)"], ["proof (state)\nthis:\n  case s of\n  (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l < 2 * n \\<Longrightarrow>\n       T_ins s +\n       (case case s of\n             (n, l) \\<Rightarrow>\n               (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n        (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n       (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n       \\<le> 3", "thus ?case"], ["proof (prove)\nusing this:\n  case s of\n  (n, l) \\<Rightarrow> if l = 0 then n = 0 else n \\<le> l \\<and> l < 2 * n\n\ngoal (1 subgoal):\n 1. T_ins s +\n    (case case s of\n          (n, l) \\<Rightarrow>\n            (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n     (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n    (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n    \\<le> 3", "by(cases s) auto"], ["proof (state)\nthis:\n  T_ins s +\n  (case case s of\n        (n, l) \\<Rightarrow>\n          (n + 1, if n < l then l else if l = 0 then 1 else 2 * l) of\n   (x, xa) \\<Rightarrow> real (2 * x - xa)) -\n  (case s of (x, xa) \\<Rightarrow> real (2 * x - xa))\n  \\<le> 3\n\ngoal:\nNo subgoals!", "qed"], ["", "locale table_insert =\nfixes a :: real\nfixes c :: real\nassumes c1[arith]: \"c > 1\" \nassumes ac2: \"a \\<ge> c/(c - 1)\"\nbegin"], ["", "lemma ac: \"a \\<ge> 1/(c - 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / (c - 1) \\<le> a", "using ac2"], ["proof (prove)\nusing this:\n  c / (c - 1) \\<le> a\n\ngoal (1 subgoal):\n 1. 1 / (c - 1) \\<le> a", "by(simp add: field_simps)"], ["", "lemma a0[arith]: \"a>0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < a", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. 0 < a", "have \"1/(c - 1) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 / (c - 1)", "using ac"], ["proof (prove)\nusing this:\n  1 / (c - 1) \\<le> a\n\ngoal (1 subgoal):\n 1. 0 < 1 / (c - 1)", "by simp"], ["proof (state)\nthis:\n  0 < 1 / (c - 1)\n\ngoal (1 subgoal):\n 1. 0 < a", "thus ?thesis"], ["proof (prove)\nusing this:\n  0 < 1 / (c - 1)\n\ngoal (1 subgoal):\n 1. 0 < a", "by (metis ac dual_order.strict_trans1)"], ["proof (state)\nthis:\n  0 < a\n\ngoal:\nNo subgoals!", "qed"], ["", "definition \"b = 1/(c - 1)\""], ["", "lemma b0[arith]: \"b > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < b", "using ac"], ["proof (prove)\nusing this:\n  1 / (c - 1) \\<le> a\n\ngoal (1 subgoal):\n 1. 0 < b", "by (simp add: b_def)"], ["", "fun \"ins\" :: \"nat * nat \\<Rightarrow> nat * nat\" where\n\"ins(n,l) = (n+1, if n<l then l else if l=0 then 1 else nat(ceiling(c*l)))\""], ["", "fun pins :: \"nat * nat => real\" where\n\"pins(n,l) = a*n - b*l\""], ["", "interpretation ins: Amortized\nwhere init = \"(0,0)\" and nxt = \"%_. ins\"\nand inv = \"\\<lambda>(n,l). if l=0 then n=0 else n \\<le> l \\<and> (b/a)*l \\<le> n\"\nand T = \"\\<lambda>_. T_ins\" and \\<Phi> = pins and U = \"\\<lambda>_ _. a + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized (0, 0) (\\<lambda>_. ins)\n     (\\<lambda>x.\n         case case x of (x, y) \\<Rightarrow> (real x, real y) of\n         (n, l) \\<Rightarrow>\n           if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n)\n     (\\<lambda>_. T_ins) pins (\\<lambda>_ _. a + 1)", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. case case (0, 0) of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 3. \\<And>s.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       0 \\<le> pins s\n 4. pins (0, 0) = 0\n 5. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. case case (0, 0) of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 3. \\<And>s.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       0 \\<le> pins s\n 4. pins (0, 0) = 0\n 5. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. case case (0, 0) of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "by auto"], ["proof (state)\nthis:\n  case case (0, 0) of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<And>s.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       0 \\<le> pins s\n 3. pins (0, 0) = 0\n 4. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<And>s.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       0 \\<le> pins s\n 3. pins (0, 0) = 0\n 4. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "case (2 s)"], ["proof (state)\nthis:\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<And>s.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       0 \\<le> pins s\n 3. pins (0, 0) = 0\n 4. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "proof (cases s)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>aa ba.\n       s = (aa, ba) \\<Longrightarrow>\n       case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "case [simp]: (Pair n l)"], ["proof (state)\nthis:\n  s = (n, l)\n\ngoal (1 subgoal):\n 1. \\<And>aa ba.\n       s = (aa, ba) \\<Longrightarrow>\n       case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<not> ?P \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "assume \"l=0\""], ["proof (state)\nthis:\n  l = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<not> ?P \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "thus ?thesis"], ["proof (prove)\nusing this:\n  l = 0\n\ngoal (1 subgoal):\n 1. case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "using 2 ac"], ["proof (prove)\nusing this:\n  l = 0\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n  1 / (c - 1) \\<le> a\n\ngoal (1 subgoal):\n 1. case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "by (simp add: b_def field_simps)"], ["proof (state)\nthis:\n  case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (1 subgoal):\n 1. l \\<noteq> 0 \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. l \\<noteq> 0 \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "assume \"l\\<noteq>0\""], ["proof (state)\nthis:\n  l \\<noteq> 0\n\ngoal (1 subgoal):\n 1. l \\<noteq> 0 \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<not> ?P \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "assume \"n<l\""], ["proof (state)\nthis:\n  n < l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n 2. \\<not> ?P \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "thus ?thesis"], ["proof (prove)\nusing this:\n  n < l\n\ngoal (1 subgoal):\n 1. case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "using 2"], ["proof (prove)\nusing this:\n  n < l\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (1 subgoal):\n 1. case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "by(simp add: algebra_simps)"], ["proof (state)\nthis:\n  case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "assume \"\\<not> n<l\""], ["proof (state)\nthis:\n  \\<not> n < l\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "hence [simp]: \"n=l\""], ["proof (prove)\nusing this:\n  \\<not> n < l\n\ngoal (1 subgoal):\n 1. n = l", "using 2 \\<open>l\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  \\<not> n < l\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n  l \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n = l", "by simp"], ["proof (state)\nthis:\n  n = l\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "have 1: \"(b/a) * ceiling(c * l) \\<le> real l + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "have \"(b/a) * ceiling(c * l) = ceiling(c * l)/(a*(c - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> =\n    real_of_int \\<lceil>c * real l\\<rceil> / (a * (c - 1))", "by(simp add: b_def)"], ["proof (state)\nthis:\n  b / a * real_of_int \\<lceil>c * real l\\<rceil> =\n  real_of_int \\<lceil>c * real l\\<rceil> / (a * (c - 1))\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "also"], ["proof (state)\nthis:\n  b / a * real_of_int \\<lceil>c * real l\\<rceil> =\n  real_of_int \\<lceil>c * real l\\<rceil> / (a * (c - 1))\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "have \"ceiling(c * l) \\<le> c*l + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_int \\<lceil>c * real l\\<rceil> \\<le> c * real l + 1", "by simp"], ["proof (state)\nthis:\n  real_of_int \\<lceil>c * real l\\<rceil> \\<le> c * real l + 1\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "also"], ["proof (state)\nthis:\n  real_of_int \\<lceil>c * real l\\<rceil> \\<le> c * real l + 1\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "have \"\\<dots> \\<le> c*(real l+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c * real l + 1 \\<le> c * (real l + 1)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  c * real l + 1 \\<le> c * (real l + 1)\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "also"], ["proof (state)\nthis:\n  c * real l + 1 \\<le> c * (real l + 1)\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "have \"\\<dots> / (a*(c - 1)) = (c/(a*(c - 1))) * (real l + 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c * (real l + 1) / (a * (c - 1)) = c / (a * (c - 1)) * (real l + 1)", "by simp"], ["proof (state)\nthis:\n  c * (real l + 1) / (a * (c - 1)) = c / (a * (c - 1)) * (real l + 1)\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "also"], ["proof (state)\nthis:\n  c * (real l + 1) / (a * (c - 1)) = c / (a * (c - 1)) * (real l + 1)\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "have \"c/(a*(c - 1)) \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c / (a * (c - 1)) \\<le> 1", "using ac2"], ["proof (prove)\nusing this:\n  c / (c - 1) \\<le> a\n\ngoal (1 subgoal):\n 1. c / (a * (c - 1)) \\<le> 1", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  c / (a * (c - 1)) \\<le> 1\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              x / (a * (c - 1)) \\<le> y / (a * (c - 1));\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow> x / (a * (c - 1)) \\<le> y / (a * (c - 1));\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x * (real l + 1) \\<le> y * (real l + 1)\\<rbrakk>\n  \\<Longrightarrow> b / a * real_of_int \\<lceil>c * real l\\<rceil>\n                    \\<le> 1 * (real l + 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              x / (a * (c - 1)) \\<le> y / (a * (c - 1));\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow> x / (a * (c - 1)) \\<le> y / (a * (c - 1));\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x * (real l + 1) \\<le> y * (real l + 1)\\<rbrakk>\n  \\<Longrightarrow> b / a * real_of_int \\<lceil>c * real l\\<rceil>\n                    \\<le> 1 * (real l + 1)\n\ngoal (1 subgoal):\n 1. b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1", "by (simp add: divide_right_mono)"], ["proof (state)\nthis:\n  b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "have 2: \"real l + 1 \\<le> ceiling(c * real l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "have \"real l + 1 = of_int(int(l)) + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l + 1 = real_of_int (int l) + 1", "by simp"], ["proof (state)\nthis:\n  real l + 1 = real_of_int (int l) + 1\n\ngoal (1 subgoal):\n 1. real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "also"], ["proof (state)\nthis:\n  real l + 1 = real_of_int (int l) + 1\n\ngoal (1 subgoal):\n 1. real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "have \"... \\<le> ceiling(c * real l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_int (int l) + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "using \\<open>l \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  l \\<noteq> 0\n\ngoal (1 subgoal):\n 1. real_of_int (int l) + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "by(simp only: int_less_real_le[symmetric] less_ceiling_iff)\n              (simp add: mult_less_cancel_right1)"], ["proof (state)\nthis:\n  real_of_int (int l) + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "finally"], ["proof (chain)\npicking this:\n  real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "show ?thesis"], ["proof (prove)\nusing this:\n  real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "."], ["proof (state)\nthis:\n  real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "from \\<open>l\\<noteq>0\\<close> 1 2"], ["proof (chain)\npicking this:\n  l \\<noteq> 0\n  b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1\n  real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>", "show ?thesis"], ["proof (prove)\nusing this:\n  l \\<noteq> 0\n  b / a * real_of_int \\<lceil>c * real l\\<rceil> \\<le> real l + 1\n  real l + 1 \\<le> real_of_int \\<lceil>c * real l\\<rceil>\n\ngoal (1 subgoal):\n 1. case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n", "by simp (simp add: not_le zero_less_mult_iff)"], ["proof (state)\nthis:\n  case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  case case ins s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       0 \\<le> pins s\n 2. pins (0, 0) = 0\n 3. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       0 \\<le> pins s\n 2. pins (0, 0) = 0\n 3. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "case (3 s)"], ["proof (state)\nthis:\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       0 \\<le> pins s\n 2. pins (0, 0) = 0\n 3. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "thus ?case"], ["proof (prove)\nusing this:\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (1 subgoal):\n 1. 0 \\<le> pins s", "by(cases s)(simp add: field_simps split: if_splits)"], ["proof (state)\nthis:\n  0 \\<le> pins s\n\ngoal (2 subgoals):\n 1. pins (0, 0) = 0\n 2. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. pins (0, 0) = 0\n 2. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. pins (0, 0) = 0\n 2. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. pins (0, 0) = 0", "by(simp)"], ["proof (state)\nthis:\n  pins (0, 0) = 0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "case (5 s)"], ["proof (state)\nthis:\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case case s of (x, y) \\<Rightarrow> (real x, real y) of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> b / a * l \\<le> n \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s \\<le> a + 1", "proof (cases s)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>aa b.\n       s = (aa, b) \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "case [simp]: (Pair n l)"], ["proof (state)\nthis:\n  s = (n, l)\n\ngoal (1 subgoal):\n 1. \\<And>aa b.\n       s = (aa, b) \\<Longrightarrow>\n       T_ins s + pins (ins s) - pins s \\<le> a + 1", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s \\<le> a + 1", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> T_ins s + pins (ins s) - pins s \\<le> a + 1\n 2. \\<not> ?P \\<Longrightarrow> T_ins s + pins (ins s) - pins s \\<le> a + 1", "assume \"l=0\""], ["proof (state)\nthis:\n  l = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> T_ins s + pins (ins s) - pins s \\<le> a + 1\n 2. \\<not> ?P \\<Longrightarrow> T_ins s + pins (ins s) - pins s \\<le> a + 1", "thus ?thesis"], ["proof (prove)\nusing this:\n  l = 0\n\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s \\<le> a + 1", "using 5"], ["proof (prove)\nusing this:\n  l = 0\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s \\<le> a + 1", "by (simp)"], ["proof (state)\nthis:\n  T_ins s + pins (ins s) - pins s \\<le> a + 1\n\ngoal (1 subgoal):\n 1. l \\<noteq> 0 \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. l \\<noteq> 0 \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "assume [arith]: \"l\\<noteq>0\""], ["proof (state)\nthis:\n  l \\<noteq> 0\n\ngoal (1 subgoal):\n 1. l \\<noteq> 0 \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s \\<le> a + 1", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> T_ins s + pins (ins s) - pins s \\<le> a + 1\n 2. \\<not> ?P \\<Longrightarrow> T_ins s + pins (ins s) - pins s \\<le> a + 1", "assume \"n<l\""], ["proof (state)\nthis:\n  n < l\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> T_ins s + pins (ins s) - pins s \\<le> a + 1\n 2. \\<not> ?P \\<Longrightarrow> T_ins s + pins (ins s) - pins s \\<le> a + 1", "thus ?thesis"], ["proof (prove)\nusing this:\n  n < l\n\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s \\<le> a + 1", "using 5 ac"], ["proof (prove)\nusing this:\n  n < l\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n  1 / (c - 1) \\<le> a\n\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s \\<le> a + 1", "by(simp add: algebra_simps b_def)"], ["proof (state)\nthis:\n  T_ins s + pins (ins s) - pins s \\<le> a + 1\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "assume \"\\<not> n<l\""], ["proof (state)\nthis:\n  \\<not> n < l\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "hence [simp]: \"n=l\""], ["proof (prove)\nusing this:\n  \\<not> n < l\n\ngoal (1 subgoal):\n 1. n = l", "using 5"], ["proof (prove)\nusing this:\n  \\<not> n < l\n  case case s of (x, y) \\<Rightarrow> (real x, real y) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> b / a * l \\<le> n\n\ngoal (1 subgoal):\n 1. n = l", "by simp"], ["proof (state)\nthis:\n  n = l\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "have \"T_ins s + pins (ins s) - pins s = l + a + 1 + (- b*ceiling(c*l)) + b*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s =\n    real l + a + 1 + - b * real_of_int \\<lceil>c * real l\\<rceil> +\n    b * real l", "using \\<open>l\\<noteq>0\\<close>"], ["proof (prove)\nusing this:\n  l \\<noteq> 0\n\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s =\n    real l + a + 1 + - b * real_of_int \\<lceil>c * real l\\<rceil> +\n    b * real l", "by(simp add: algebra_simps less_trans[of \"-1::real\" 0])"], ["proof (state)\nthis:\n  T_ins s + pins (ins s) - pins s =\n  real l + a + 1 + - b * real_of_int \\<lceil>c * real l\\<rceil> + b * real l\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "also"], ["proof (state)\nthis:\n  T_ins s + pins (ins s) - pins s =\n  real l + a + 1 + - b * real_of_int \\<lceil>c * real l\\<rceil> + b * real l\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "have \"- b * ceiling(c*l) \\<le> - b * (c*l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - b * real_of_int \\<lceil>c * real l\\<rceil> \\<le> - b * (c * real l)", "by (simp add: ceiling_correct)"], ["proof (state)\nthis:\n  - b * real_of_int \\<lceil>c * real l\\<rceil> \\<le> - b * (c * real l)\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "also"], ["proof (state)\nthis:\n  - b * real_of_int \\<lceil>c * real l\\<rceil> \\<le> - b * (c * real l)\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "have \"l + a + 1 + - b*(c*l) + b*l = a + 1 + l*(1 - b*(c - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l + a + 1 + - b * (c * real l) + b * real l =\n    a + 1 + real l * (1 - b * (c - 1))", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  real l + a + 1 + - b * (c * real l) + b * real l =\n  a + 1 + real l * (1 - b * (c - 1))\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "also"], ["proof (state)\nthis:\n  real l + a + 1 + - b * (c * real l) + b * real l =\n  a + 1 + real l * (1 - b * (c - 1))\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "have \"b*(c - 1) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b * (c - 1) = 1", "by(simp add: b_def)"], ["proof (state)\nthis:\n  b * (c - 1) = 1\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "also"], ["proof (state)\nthis:\n  b * (c - 1) = 1\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "have \"a + 1 + (real l)*(1 - 1) = a+1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a + 1 + real l * (1 - 1) = a + 1", "by simp"], ["proof (state)\nthis:\n  a + 1 + real l * (1 - 1) = a + 1\n\ngoal (1 subgoal):\n 1. \\<not> n < l \\<Longrightarrow>\n    T_ins s + pins (ins s) - pins s \\<le> a + 1", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real l + a + 1 + x + b * real l\n      \\<le> real l + a + 1 + y + b * real l) \\<Longrightarrow>\n  T_ins s + pins (ins s) - pins s \\<le> a + 1", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real l + a + 1 + x + b * real l\n      \\<le> real l + a + 1 + y + b * real l) \\<Longrightarrow>\n  T_ins s + pins (ins s) - pins s \\<le> a + 1\n\ngoal (1 subgoal):\n 1. T_ins s + pins (ins s) - pins s \\<le> a + 1", "by simp"], ["proof (state)\nthis:\n  T_ins s + pins (ins s) - pins s \\<le> a + 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T_ins s + pins (ins s) - pins s \\<le> a + 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T_ins s + pins (ins s) - pins s \\<le> a + 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  T_ins s + pins (ins s) - pins s \\<le> a + 1\n\ngoal:\nNo subgoals!", "qed"], ["", "thm ins.ub"], ["", "end"], ["", "subsection \"Stack with multipop\""], ["", "datatype 'a op\\<^sub>s\\<^sub>t\\<^sub>k = Push 'a | Pop nat"], ["", "fun nxT_stk :: \"'a op\\<^sub>s\\<^sub>t\\<^sub>k \\<Rightarrow> 'a list \\<Rightarrow> 'a list\" where\n\"nxT_stk (Push x) xs = x # xs\" |\n\"nxT_stk (Pop n) xs = drop n xs\""], ["", "fun T_stk :: \"'a op\\<^sub>s\\<^sub>t\\<^sub>k \\<Rightarrow> 'a list \\<Rightarrow> real\" where\n\"T_stk (Push x) xs = 1\" |\n\"T_stk (Pop n) xs = min n (length xs)\""], ["", "interpretation stack: Amortized\nwhere init = \"[]\" and nxt = nxT_stk and inv = \"\\<lambda>_. True\"\nand T = T_stk and \\<Phi> = \"length\" and U = \"\\<lambda>f _. case f of Push _ \\<Rightarrow> 2 | Pop _ \\<Rightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized [] nxT_stk (\\<lambda>_. True) T_stk\n     (\\<lambda>x. real (length x))\n     (\\<lambda>f _.\n         case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. True\n 2. \\<And>s f. True \\<Longrightarrow> True\n 3. \\<And>s. True \\<Longrightarrow> 0 \\<le> real (length s)\n 4. real (length []) = 0\n 5. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. True\n 2. \\<And>s f. True \\<Longrightarrow> True\n 3. \\<And>s. True \\<Longrightarrow> 0 \\<le> real (length s)\n 4. real (length []) = 0\n 5. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. True", "by auto"], ["proof (state)\nthis:\n  True\n\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s. True \\<Longrightarrow> 0 \\<le> real (length s)\n 3. real (length []) = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s. True \\<Longrightarrow> 0 \\<le> real (length s)\n 3. real (length []) = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "case (2 s)"], ["proof (state)\nthis:\n  True\n\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s. True \\<Longrightarrow> 0 \\<le> real (length s)\n 3. real (length []) = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  True\n\ngoal (1 subgoal):\n 1. True", "by(cases s) auto"], ["proof (state)\nthis:\n  True\n\ngoal (3 subgoals):\n 1. \\<And>s. True \\<Longrightarrow> 0 \\<le> real (length s)\n 2. real (length []) = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s. True \\<Longrightarrow> 0 \\<le> real (length s)\n 2. real (length []) = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "case 3"], ["proof (state)\nthis:\n  True\n\ngoal (3 subgoals):\n 1. \\<And>s. True \\<Longrightarrow> 0 \\<le> real (length s)\n 2. real (length []) = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  True\n\ngoal (1 subgoal):\n 1. 0 \\<le> real (length s_)", "by simp"], ["proof (state)\nthis:\n  0 \\<le> real (length s_)\n\ngoal (2 subgoals):\n 1. real (length []) = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. real (length []) = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. real (length []) = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. real (length []) = 0", "by(simp)"], ["proof (state)\nthis:\n  real (length []) = 0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "case (5 _ f)"], ["proof (state)\nthis:\n  True\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow>\n       T_stk f s + real (length (nxT_stk f s)) - real (length s)\n       \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  True\n\ngoal (1 subgoal):\n 1. T_stk f s_ + real (length (nxT_stk f s_)) - real (length s_)\n    \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)", "by (cases f) auto"], ["proof (state)\nthis:\n  T_stk f s_ + real (length (nxT_stk f s_)) - real (length s_)\n  \\<le> (case f of Push x \\<Rightarrow> 2 | Pop x \\<Rightarrow> 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \"Queue\""], ["", "text\\<open>See, for example, the book by Okasaki~\\cite{Okasaki}.\\<close>"], ["", "datatype 'a op\\<^sub>q = Enq 'a | Deq"], ["", "type_synonym 'a queue = \"'a list * 'a list\""], ["", "fun nxT_q :: \"'a op\\<^sub>q \\<Rightarrow> 'a queue \\<Rightarrow> 'a queue\" where\n\"nxT_q (Enq x) (xs,ys) = (x#xs,ys)\" |\n\"nxT_q Deq (xs,ys) = (if ys = [] then ([], tl(rev xs)) else (xs,tl ys))\""], ["", "fun T_q :: \"'a op\\<^sub>q \\<Rightarrow> 'a queue \\<Rightarrow> real\" where\n\"T_q (Enq x) (xs,ys) = 1\" |\n\"T_q Deq (xs,ys) = (if ys = [] then length xs else 0)\""], ["", "interpretation queue: Amortized\nwhere init = \"([],[])\" and nxt = nxT_q and inv = \"\\<lambda>_. True\"\nand T = T_q and \\<Phi> = \"\\<lambda>(xs,ys). length xs\" and U = \"\\<lambda>f _. case f of Enq _ \\<Rightarrow> 2 | Deq \\<Rightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized ([], []) nxT_q (\\<lambda>_. True) T_q\n     (\\<lambda>x. real (case x of (xs, ys) \\<Rightarrow> length xs))\n     (\\<lambda>f _. case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. True\n 2. \\<And>s f. True \\<Longrightarrow> True\n 3. \\<And>s.\n       True \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n 4. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 5. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. True\n 2. \\<And>s f. True \\<Longrightarrow> True\n 3. \\<And>s.\n       True \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n 4. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 5. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. True", "by auto"], ["proof (state)\nthis:\n  True\n\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s.\n       True \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n 3. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s.\n       True \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n 3. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "case (2 s)"], ["proof (state)\nthis:\n  True\n\ngoal (4 subgoals):\n 1. \\<And>s f. True \\<Longrightarrow> True\n 2. \\<And>s.\n       True \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n 3. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 4. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  True\n\ngoal (1 subgoal):\n 1. True", "by(cases s) auto"], ["proof (state)\nthis:\n  True\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       True \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n 2. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s.\n       True \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n 2. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "case (3 s)"], ["proof (state)\nthis:\n  True\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       True \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n 2. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 3. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  True\n\ngoal (1 subgoal):\n 1. 0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)", "by(cases s) auto"], ["proof (state)\nthis:\n  0 \\<le> real (case s of (xs, ys) \\<Rightarrow> length xs)\n\ngoal (2 subgoals):\n 1. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n 2. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0", "by(simp)"], ["proof (state)\nthis:\n  real (case ([], []) of (xs, ys) \\<Rightarrow> length xs) = 0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "case (5 s f)"], ["proof (state)\nthis:\n  True\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       True \\<Longrightarrow>\n       T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  True\n\ngoal (1 subgoal):\n 1. T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n    real (case s of (xs, ys) \\<Rightarrow> length xs)\n    \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)", "apply(cases s)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>True; s = (a, b)\\<rbrakk>\n       \\<Longrightarrow> T_q f s +\n                         real\n                          (case nxT_q f s of\n                           (xs, ys) \\<Rightarrow> length xs) -\n                         real (case s of (xs, ys) \\<Rightarrow> length xs)\n                         \\<le> (case f of Enq x \\<Rightarrow> 2\n                                | Deq \\<Rightarrow> 0)", "apply(cases f)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x1.\n       \\<lbrakk>True; s = (a, b); f = Enq x1\\<rbrakk>\n       \\<Longrightarrow> T_q f s +\n                         real\n                          (case nxT_q f s of\n                           (xs, ys) \\<Rightarrow> length xs) -\n                         real (case s of (xs, ys) \\<Rightarrow> length xs)\n                         \\<le> (case f of Enq x \\<Rightarrow> 2\n                                | Deq \\<Rightarrow> 0)\n 2. \\<And>a b.\n       \\<lbrakk>True; s = (a, b); f = Deq\\<rbrakk>\n       \\<Longrightarrow> T_q f s +\n                         real\n                          (case nxT_q f s of\n                           (xs, ys) \\<Rightarrow> length xs) -\n                         real (case s of (xs, ys) \\<Rightarrow> length xs)\n                         \\<le> (case f of Enq x \\<Rightarrow> 2\n                                | Deq \\<Rightarrow> 0)", "by auto"], ["proof (state)\nthis:\n  T_q f s + real (case nxT_q f s of (xs, ys) \\<Rightarrow> length xs) -\n  real (case s of (xs, ys) \\<Rightarrow> length xs)\n  \\<le> (case f of Enq x \\<Rightarrow> 2 | Deq \\<Rightarrow> 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "fun balance :: \"'a queue \\<Rightarrow> 'a queue\" where\n\"balance(xs,ys) = (if size xs \\<le> size ys then (xs,ys) else ([], ys @ rev xs))\""], ["", "fun nxt_q2 :: \"'a op\\<^sub>q \\<Rightarrow> 'a queue \\<Rightarrow> 'a queue\" where\n\"nxt_q2 (Enq a) (xs,ys) = balance (a#xs,ys)\" |\n\"nxt_q2 Deq (xs,ys) = balance (xs, tl ys)\""], ["", "fun T_q2 :: \"'a op\\<^sub>q \\<Rightarrow> 'a queue \\<Rightarrow> real\" where\n\"T_q2 (Enq _) (xs,ys) = 1 + (if size xs + 1 \\<le> size ys then 0 else size xs + 1 + size ys)\" |\n\"T_q2 Deq (xs,ys) = (if size xs \\<le> size ys - 1 then 0 else size xs + (size ys - 1))\""], ["", "interpretation queue2: Amortized\nwhere init = \"([],[])\" and nxt = nxt_q2\nand inv = \"\\<lambda>(xs,ys). size xs \\<le> size ys\"\nand T = T_q2 and \\<Phi> = \"\\<lambda>(xs,ys). 2 * size xs\"\nand U = \"\\<lambda>f _. case f of Enq _ \\<Rightarrow> 3 | Deq \\<Rightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized ([], []) nxt_q2 (\\<lambda>(xs, ys). length xs \\<le> length ys)\n     T_q2\n     (\\<lambda>x. real (case x of (xs, ys) \\<Rightarrow> 2 * length xs))\n     (\\<lambda>f _. case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. case ([], []) of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n 2. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       case nxt_q2 f s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n 3. \\<And>s.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n 4. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 5. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. case ([], []) of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n 2. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       case nxt_q2 f s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n 3. \\<And>s.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n 4. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 5. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. case ([], []) of (xs, ys) \\<Rightarrow> length xs \\<le> length ys", "by auto"], ["proof (state)\nthis:\n  case ([], []) of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       case nxt_q2 f s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n 2. \\<And>s.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n 3. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 4. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       case nxt_q2 f s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n 2. \\<And>s.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n 3. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 4. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "case (2 s f)"], ["proof (state)\nthis:\n  case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       case nxt_q2 f s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n 2. \\<And>s.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n 3. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 4. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n\ngoal (1 subgoal):\n 1. case nxt_q2 f s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys", "by(cases s) (cases f, auto)"], ["proof (state)\nthis:\n  case nxt_q2 f s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n 2. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 3. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n 2. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 3. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "case (3 s)"], ["proof (state)\nthis:\n  case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n 2. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 3. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n\ngoal (1 subgoal):\n 1. 0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)", "by(cases s) auto"], ["proof (state)\nthis:\n  0 \\<le> real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n\ngoal (2 subgoals):\n 1. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 2. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 2. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n 2. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0", "by(simp)"], ["proof (state)\nthis:\n  real (case ([], []) of (xs, ys) \\<Rightarrow> 2 * length xs) = 0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "case (5 s f)"], ["proof (state)\nthis:\n  case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (xs, ys) \\<Rightarrow> length xs \\<le> length ys \\<Longrightarrow>\n       T_q2 f s +\n       real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n       real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n       \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "thus ?case"], ["proof (prove)\nusing this:\n  case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys\n\ngoal (1 subgoal):\n 1. T_q2 f s +\n    real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n    real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n    \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)", "apply(cases s)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys;\n        s = (a, b)\\<rbrakk>\n       \\<Longrightarrow> T_q2 f s +\n                         real\n                          (case nxt_q2 f s of\n                           (xs, ys) \\<Rightarrow> 2 * length xs) -\n                         real\n                          (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n                         \\<le> (case f of Enq x \\<Rightarrow> 3\n                                | Deq \\<Rightarrow> 0)", "apply(cases f)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x1.\n       \\<lbrakk>case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys;\n        s = (a, b); f = Enq x1\\<rbrakk>\n       \\<Longrightarrow> T_q2 f s +\n                         real\n                          (case nxt_q2 f s of\n                           (xs, ys) \\<Rightarrow> 2 * length xs) -\n                         real\n                          (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n                         \\<le> (case f of Enq x \\<Rightarrow> 3\n                                | Deq \\<Rightarrow> 0)\n 2. \\<And>a b.\n       \\<lbrakk>case s of (xs, ys) \\<Rightarrow> length xs \\<le> length ys;\n        s = (a, b); f = Deq\\<rbrakk>\n       \\<Longrightarrow> T_q2 f s +\n                         real\n                          (case nxt_q2 f s of\n                           (xs, ys) \\<Rightarrow> 2 * length xs) -\n                         real\n                          (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n                         \\<le> (case f of Enq x \\<Rightarrow> 3\n                                | Deq \\<Rightarrow> 0)", "by (auto simp: split: prod.splits)"], ["proof (state)\nthis:\n  T_q2 f s +\n  real (case nxt_q2 f s of (xs, ys) \\<Rightarrow> 2 * length xs) -\n  real (case s of (xs, ys) \\<Rightarrow> 2 * length xs)\n  \\<le> (case f of Enq x \\<Rightarrow> 3 | Deq \\<Rightarrow> 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \"Dynamic tables: insert and delete\""], ["", "datatype op\\<^sub>t\\<^sub>b = Ins | Del"], ["", "fun nxT_tb :: \"op\\<^sub>t\\<^sub>b \\<Rightarrow> nat*nat \\<Rightarrow> nat*nat\" where\n\"nxT_tb Ins (n,l) = (n+1, if n<l then l else if l=0 then 1 else 2*l)\" |\n\"nxT_tb Del (n,l) = (n - 1, if n=1 then 0 else if 4*(n - 1)<l then l div 2 else l)\""], ["", "fun T_tb :: \"op\\<^sub>t\\<^sub>b \\<Rightarrow> nat*nat \\<Rightarrow> real\" where\n\"T_tb Ins (n,l) = (if n<l then 1 else n+1)\" |\n\"T_tb Del (n,l) = (if n=1 then 1 else if 4*(n - 1)<l then n else 1)\""], ["", "interpretation tb: Amortized\nwhere init = \"(0,0)\" and nxt = nxT_tb\nand inv = \"\\<lambda>(n,l). if l=0 then n=0 else n \\<le> l \\<and> l \\<le> 4*n\"\nand T = T_tb and \\<Phi> = \"(\\<lambda>(n,l). if 2*n < l then l/2 - n else 2*n - l)\"\nand U = \"\\<lambda>f _. case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Amortized (0, 0) nxT_tb\n     (\\<lambda>(n, l).\n         if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n)\n     T_tb\n     (\\<lambda>(n, l).\n         if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n     (\\<lambda>f _. case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "proof (standard, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. case (0, 0) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       case nxT_tb f s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n 3. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       0 \\<le> (case s of\n                (n, l) \\<Rightarrow>\n                  if 2 * n < l then real l / 2 - real n\n                  else real (2 * n - l))\n 4. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 5. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. case (0, 0) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       case nxT_tb f s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n 3. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       0 \\<le> (case s of\n                (n, l) \\<Rightarrow>\n                  if 2 * n < l then real l / 2 - real n\n                  else real (2 * n - l))\n 4. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 5. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. case (0, 0) of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n", "by auto"], ["proof (state)\nthis:\n  case (0, 0) of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       case nxT_tb f s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n 2. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       0 \\<le> (case s of\n                (n, l) \\<Rightarrow>\n                  if 2 * n < l then real l / 2 - real n\n                  else real (2 * n - l))\n 3. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 4. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       case nxT_tb f s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n 2. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       0 \\<le> (case s of\n                (n, l) \\<Rightarrow>\n                  if 2 * n < l then real l / 2 - real n\n                  else real (2 * n - l))\n 3. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 4. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "case (2 s f)"], ["proof (state)\nthis:\n  case s of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n\ngoal (4 subgoals):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       case nxT_tb f s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n 2. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       0 \\<le> (case s of\n                (n, l) \\<Rightarrow>\n                  if 2 * n < l then real l / 2 - real n\n                  else real (2 * n - l))\n 3. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 4. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "thus ?case"], ["proof (prove)\nusing this:\n  case s of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n\ngoal (1 subgoal):\n 1. case nxT_tb f s of\n    (n, l) \\<Rightarrow>\n      if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n", "by(cases s, cases f) (auto split: if_splits)"], ["proof (state)\nthis:\n  case nxT_tb f s of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       0 \\<le> (case s of\n                (n, l) \\<Rightarrow>\n                  if 2 * n < l then real l / 2 - real n\n                  else real (2 * n - l))\n 2. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 3. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       0 \\<le> (case s of\n                (n, l) \\<Rightarrow>\n                  if 2 * n < l then real l / 2 - real n\n                  else real (2 * n - l))\n 2. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 3. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "case (3 s)"], ["proof (state)\nthis:\n  case s of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       0 \\<le> (case s of\n                (n, l) \\<Rightarrow>\n                  if 2 * n < l then real l / 2 - real n\n                  else real (2 * n - l))\n 2. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 3. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "thus ?case"], ["proof (prove)\nusing this:\n  case s of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n\ngoal (1 subgoal):\n 1. 0 \\<le> (case s of\n             (n, l) \\<Rightarrow>\n               if 2 * n < l then real l / 2 - real n else real (2 * n - l))", "by(cases s)(simp split: if_splits)"], ["proof (state)\nthis:\n  0 \\<le> (case s of\n           (n, l) \\<Rightarrow>\n             if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n\ngoal (2 subgoals):\n 1. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "case 4"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0\n 2. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (case (0, 0) of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n    0", "by(simp)"], ["proof (state)\nthis:\n  (case (0, 0) of\n   (n, l) \\<Rightarrow>\n     if 2 * n < l then real l / 2 - real n else real (2 * n - l)) =\n  0\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "case (5 s f)"], ["proof (state)\nthis:\n  case s of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n\ngoal (1 subgoal):\n 1. \\<And>s f.\n       case s of\n       (n, l) \\<Rightarrow>\n         if l = 0 then n = 0\n         else n \\<le> l \\<and> l \\<le> 4 * n \\<Longrightarrow>\n       T_tb f s +\n       (case nxT_tb f s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n       (case s of\n        (n, l) \\<Rightarrow>\n          if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n       \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "thus ?case"], ["proof (prove)\nusing this:\n  case s of\n  (n, l) \\<Rightarrow>\n    if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n\n\ngoal (1 subgoal):\n 1. T_tb f s +\n    (case nxT_tb f s of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n    (case s of\n     (n, l) \\<Rightarrow>\n       if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n    \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)", "apply(cases s)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>case s of\n                (n, l) \\<Rightarrow>\n                  if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n;\n        s = (a, b)\\<rbrakk>\n       \\<Longrightarrow> T_tb f s +\n                         (case nxT_tb f s of\n                          (n, l) \\<Rightarrow>\n                            if 2 * n < l then real l / 2 - real n\n                            else real (2 * n - l)) -\n                         (case s of\n                          (n, l) \\<Rightarrow>\n                            if 2 * n < l then real l / 2 - real n\n                            else real (2 * n - l))\n                         \\<le> (case f of Ins \\<Rightarrow> 3\n                                | Del \\<Rightarrow> 2)", "apply(cases f)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>case s of\n                (n, l) \\<Rightarrow>\n                  if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n;\n        s = (a, b); f = Ins\\<rbrakk>\n       \\<Longrightarrow> T_tb f s +\n                         (case nxT_tb f s of\n                          (n, l) \\<Rightarrow>\n                            if 2 * n < l then real l / 2 - real n\n                            else real (2 * n - l)) -\n                         (case s of\n                          (n, l) \\<Rightarrow>\n                            if 2 * n < l then real l / 2 - real n\n                            else real (2 * n - l))\n                         \\<le> (case f of Ins \\<Rightarrow> 3\n                                | Del \\<Rightarrow> 2)\n 2. \\<And>a b.\n       \\<lbrakk>case s of\n                (n, l) \\<Rightarrow>\n                  if l = 0 then n = 0 else n \\<le> l \\<and> l \\<le> 4 * n;\n        s = (a, b); f = Del\\<rbrakk>\n       \\<Longrightarrow> T_tb f s +\n                         (case nxT_tb f s of\n                          (n, l) \\<Rightarrow>\n                            if 2 * n < l then real l / 2 - real n\n                            else real (2 * n - l)) -\n                         (case s of\n                          (n, l) \\<Rightarrow>\n                            if 2 * n < l then real l / 2 - real n\n                            else real (2 * n - l))\n                         \\<le> (case f of Ins \\<Rightarrow> 3\n                                | Del \\<Rightarrow> 2)", "by (auto simp: field_simps)"], ["proof (state)\nthis:\n  T_tb f s +\n  (case nxT_tb f s of\n   (n, l) \\<Rightarrow>\n     if 2 * n < l then real l / 2 - real n else real (2 * n - l)) -\n  (case s of\n   (n, l) \\<Rightarrow>\n     if 2 * n < l then real l / 2 - real n else real (2 * n - l))\n  \\<le> (case f of Ins \\<Rightarrow> 3 | Del \\<Rightarrow> 2)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}