{"file_name": "/home/qj213/afp-2021-10-22/thys/Program-Conflict-Analysis/Interleave.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Program-Conflict-Analysis", "problem_names": ["lemma cons_set_cons_eq: \"a#l \\<in> b\\<cdot>S = (a=b & l\\<in>S)\"", "lemma append_set_append_eq: \"\\<lbrakk>length a = length b\\<rbrakk> \\<Longrightarrow> a@l \\<in> b\\<odot>S = (a=b & l\\<in>S)\"", "lemma list_set_cons_cases[cases set]: \"\\<lbrakk>w\\<in>a\\<cdot>S; !!w'. \\<lbrakk> w=a#w'; w'\\<in>S \\<rbrakk> \\<Longrightarrow> P\\<rbrakk> \\<Longrightarrow> P\"", "lemma list_set_append_cases[cases set]: \"\\<lbrakk>w\\<in>a\\<odot>S; !!w'. \\<lbrakk> w=a@w'; w'\\<in>S \\<rbrakk> \\<Longrightarrow> P\\<rbrakk> \\<Longrightarrow> P\"", "lemma interleave_cons1: \"l \\<in> a\\<otimes>b \\<Longrightarrow> x#l \\<in> x#a \\<otimes> b\"", "lemma interleave_cons2: \"l \\<in> a\\<otimes>b \\<Longrightarrow> x#l \\<in> a \\<otimes> x#b\"", "lemmas interleave_cons = interleave_cons1 interleave_cons2", "lemma interleave_empty[simp]: \"[]\\<in>a\\<otimes>b = (a=[] & b=[])\"", "lemma interleave_length[rule_format, simp]: \"ALL x : a\\<otimes>b . length x = length a + length b\"", "lemma interleave_same[simp]: \"y\\<in>l\\<otimes>y = (l=[])\"", "lemma interleave_comm[simp]: \"a\\<otimes>b = b\\<otimes>a\" (is \"?P f a b\")", "lemma interleave_cont_conc[rule_format, simp]: \"ALL b . a@b \\<in> a\\<otimes>b\"", "lemma interleave_cont_rev_conc[simp]: \"b@a \\<in> a\\<otimes>b\"", "lemma interleave_not_empty: \"a\\<otimes>b ~= {}\"", "lemma cons_interleave_split: \"\\<lbrakk>a#l \\<in> l1\\<otimes>l2\\<rbrakk> \\<Longrightarrow> (EX lh . l1=a#lh & l \\<in> lh\\<otimes>l2 | l2=a#lh & l \\<in> l1\\<otimes>lh )\"", "lemma cons_interleave_cases[cases set, case_names left right]: \"\\<lbrakk>a#l \\<in> l1\\<otimes>l2; !!lh . \\<lbrakk>l1=a#lh; l \\<in> lh\\<otimes>l2\\<rbrakk> \\<Longrightarrow> P; !!lh. \\<lbrakk>l2=a#lh; l \\<in> l1\\<otimes>lh\\<rbrakk> \\<Longrightarrow> P\\<rbrakk> \\<Longrightarrow> P\"", "lemma interleave_cases[cases set, case_names empty left right]: \"\\<lbrakk>l\\<in>l1\\<otimes>l2; \\<lbrakk> l=[]; l1=[]; l2=[] \\<rbrakk> \\<Longrightarrow> P; !!a l' l1'. \\<lbrakk>l=a#l'; l1=a#l1'; l'\\<in>l1'\\<otimes>l2\\<rbrakk> \\<Longrightarrow> P; !!a l' l2'. \\<lbrakk>l=a#l'; l2=a#l2'; l'\\<in>l1\\<otimes>l2'\\<rbrakk> \\<Longrightarrow> P \\<rbrakk> \\<Longrightarrow> P\"", "lemma interleave_elem_induct[induct set, case_names empty left right]: \n  \"!!w1 w2. \\<lbrakk> w\\<in>w1\\<otimes>w2; P [] [] []; !!e w w1 w2. \\<lbrakk> P w w1 w2; w\\<in>w1\\<otimes>w2 \\<rbrakk> \\<Longrightarrow> P (e#w) (e#w1) w2; !!e w w1 w2. \\<lbrakk> P w w1 w2; w\\<in>w1\\<otimes>w2 \\<rbrakk> \\<Longrightarrow> P (e#w) w1 (e#w2) \\<rbrakk> \\<Longrightarrow> P w w1 w2\"", "lemma interleave_rev_cons1[rule_format]: \"ALL a b . l \\<in> a\\<otimes>b \\<longrightarrow> l@[x] \\<in> a@[x] \\<otimes> b\" (is \"?P l\")", "lemmas interleave_rev_cons = interleave_rev_cons1 interleave_rev_cons2", "lemma interleave_append1: \"\\<lbrakk>l \\<in> a\\<otimes>b\\<rbrakk> \\<Longrightarrow> x@l \\<in> x@a \\<otimes> b\"", "lemma interleave_append2: \"\\<lbrakk>l \\<in> a\\<otimes>b\\<rbrakk> \\<Longrightarrow> x@l \\<in> a \\<otimes> x@b\"", "lemmas interleave_append = interleave_append1 interleave_append2", "lemma interleave_rev_append1: \"!!a b w. w\\<in>a\\<otimes>b \\<Longrightarrow> w@w' \\<in> a@w' \\<otimes> b\"", "lemma interleave_rev_append2: \"w\\<in>a\\<otimes>b \\<Longrightarrow> w@w' \\<in> a \\<otimes> b@w'\"", "lemmas interleave_rev_append = interleave_rev_append1 interleave_rev_append2", "lemma interleave_rev1[rule_format]: \"ALL w1 w2 . (w\\<in>w1\\<otimes>w2) \\<longrightarrow> (rev w \\<in> rev w1 \\<otimes> rev w2)\" (is \"?P w\")", "lemmas interleave_rev = interleave_rev1 interleave_rev2", "lemma rev_cons_interleave_split: \"\\<lbrakk>l@[a] \\<in> l1\\<otimes>l2\\<rbrakk> \\<Longrightarrow> (EX lh . l1=lh@[a] & l \\<in> lh\\<otimes>l2 | l2=lh@[a] & l \\<in> l1\\<otimes>lh )\"", "lemma interleave_s_assoc1[rule_format]: \"ALL w1 ws w2 w3 . (w\\<in>w1\\<otimes>ws & ws\\<in>w2\\<otimes>w3 \\<longrightarrow> (EX ws' : w1\\<otimes>w2 . w \\<in> ws'\\<otimes>w3))\"", "lemma interleave_s_assoc2: \"\\<lbrakk>w\\<in>ws\\<otimes>w3; ws\\<in>w1\\<otimes>w2\\<rbrakk> \\<Longrightarrow> EX ws' : w2\\<otimes>w3 . w \\<in> w1\\<otimes>ws'\"", "lemmas interleave_s_assoc = interleave_s_assoc1 interleave_s_assoc2", "lemma interleave_set: \"w\\<in>w1\\<otimes>w2 \\<Longrightarrow> set w = set w1 \\<union> set w2\"", "lemma interleave_map: \"w\\<in>w1\\<otimes>w2 \\<Longrightarrow> map f w \\<in> map f w1 \\<otimes> map f w2\"", "lemma interleave_filter: \"w\\<in>w1\\<otimes>w2 \\<Longrightarrow> filter f w \\<in> filter f w1 \\<otimes> filter f w2\"", "lemma ileq_interleave_alt: \"l'\\<preceq>l == \\<exists>lb. l\\<in>lb \\<otimes> l'\"", "lemma ileq_interleave: \"w\\<in>w1\\<otimes>w2 \\<Longrightarrow> w1\\<preceq>w & w2\\<preceq>w\"", "lemma ilt_ex_notempty: \"x < y \\<longleftrightarrow> (\\<exists>xs. xs \\<noteq> [] \\<and> y \\<in> xs \\<otimes> x)\"", "lemma ilt_interleave1: \"\\<lbrakk>w\\<in>w1\\<otimes>w2; w1~=[]\\<rbrakk> \\<Longrightarrow> w2<w\"", "lemma ilt_interleave2: \"\\<lbrakk>w\\<in>w1\\<otimes>w2; w2~=[]\\<rbrakk> \\<Longrightarrow> w1<w\"", "lemmas ilt_interleave = ilt_interleave1 ilt_interleave2", "lemma interleave_recover1[rule_format]: \"ALL w1a w1b w2 . w\\<in>(w1a@w1b)\\<otimes>w2 \\<longrightarrow> (EX wa wb w2a w2b . w=wa@wb & w2=w2a@w2b & wa\\<in>w1a\\<otimes>w2a & wb\\<in>w1b\\<otimes>w2b)\" \n  (is \"?P w\" is \"ALL w1a w1b w2 . ?PRE w w1a w1b w2 \\<longrightarrow> ?CONS w w1a w1b w2\")", "lemma interleave_recover2: \"w\\<in>w1\\<otimes>(w2a@w2b) \\<Longrightarrow> EX wa wb w1a w1b . w=wa@wb & w1=w1a@w1b & wa\\<in>w1a\\<otimes>w2a & wb\\<in>w1b\\<otimes>w2b\"", "lemmas interleave_recover = interleave_recover1 interleave_recover2\n\n\\<comment> \\<open>Split operands according to element of result\\<close>", "lemma interleave_unconc: \"!! l2 w1 w2 . l1@l2 \\<in> w1\\<otimes>w2 \\<Longrightarrow> \\<exists> w11 w12 w21 w22 . w1=w11@w12 \\<and> w2=w21@w22 \\<and> l1\\<in>w11\\<otimes>w21 \\<and> l2\\<in>w12\\<otimes>w22\"", "lemma interleave_reconc: \"!!w11 w21 l2 w12 w22 . \\<lbrakk>l1\\<in>w11\\<otimes>w21;l2\\<in>w12\\<otimes>w22\\<rbrakk> \\<Longrightarrow> l1@l2\\<in>(w11@w12)\\<otimes>(w21@w22)\"", "lemma interleave_unconc_eq: \"!! l2 w1 w2 . l1@l2 \\<in> w1\\<otimes>w2 = (\\<exists> w11 w12 w21 w22 . w1=w11@w12 \\<and> w2=w21@w22 \\<and> l1\\<in>w11\\<otimes>w21 \\<and> l2\\<in>w12\\<otimes>w22)\""], "translations": [["", "lemma cons_set_cons_eq: \"a#l \\<in> b\\<cdot>S = (a=b & l\\<in>S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (a # l \\<in> b \\<cdot> S) = (a = b \\<and> l \\<in> S)", "by auto"], ["", "lemma append_set_append_eq: \"\\<lbrakk>length a = length b\\<rbrakk> \\<Longrightarrow> a@l \\<in> b\\<odot>S = (a=b & l\\<in>S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length a = length b \\<Longrightarrow>\n    (a @ l \\<in> b \\<odot> S) = (a = b \\<and> l \\<in> S)", "by auto"], ["", "lemma list_set_cons_cases[cases set]: \"\\<lbrakk>w\\<in>a\\<cdot>S; !!w'. \\<lbrakk> w=a#w'; w'\\<in>S \\<rbrakk> \\<Longrightarrow> P\\<rbrakk> \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> a \\<cdot> S;\n     \\<And>w'.\n        \\<lbrakk>w = a # w'; w' \\<in> S\\<rbrakk>\n        \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "by auto"], ["", "lemma list_set_append_cases[cases set]: \"\\<lbrakk>w\\<in>a\\<odot>S; !!w'. \\<lbrakk> w=a@w'; w'\\<in>S \\<rbrakk> \\<Longrightarrow> P\\<rbrakk> \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> a \\<odot> S;\n     \\<And>w'.\n        \\<lbrakk>w = a @ w'; w' \\<in> S\\<rbrakk>\n        \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "by auto"], ["", "subsubsection \"Standard simplification-, introduction-, elimination-, and induction rules\""], ["", "lemma interleave_cons1: \"l \\<in> a\\<otimes>b \\<Longrightarrow> x#l \\<in> x#a \\<otimes> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x # l \\<in> x # a \\<otimes> b", "apply(case_tac b)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>l \\<in> a \\<otimes> b; b = []\\<rbrakk>\n    \\<Longrightarrow> x # l \\<in> x # a \\<otimes> b\n 2. \\<And>aa list.\n       \\<lbrakk>l \\<in> a \\<otimes> b; b = aa # list\\<rbrakk>\n       \\<Longrightarrow> x # l \\<in> x # a \\<otimes> b", "apply(auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma interleave_cons2: \"l \\<in> a\\<otimes>b \\<Longrightarrow> x#l \\<in> a \\<otimes> x#b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x # l \\<in> a \\<otimes> x # b", "apply(case_tac a)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>l \\<in> a \\<otimes> b; a = []\\<rbrakk>\n    \\<Longrightarrow> x # l \\<in> a \\<otimes> x # b\n 2. \\<And>aa list.\n       \\<lbrakk>l \\<in> a \\<otimes> b; a = aa # list\\<rbrakk>\n       \\<Longrightarrow> x # l \\<in> a \\<otimes> x # b", "apply(auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemmas interleave_cons = interleave_cons1 interleave_cons2"], ["", "lemma interleave_empty[simp]: \"[]\\<in>a\\<otimes>b = (a=[] & b=[])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])", "apply(case_tac a)"], ["proof (prove)\ngoal (2 subgoals):\n 1. a = [] \\<Longrightarrow>\n    ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])\n 2. \\<And>aa list.\n       a = aa # list \\<Longrightarrow>\n       ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])", "apply(case_tac b)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a = []; b = []\\<rbrakk>\n    \\<Longrightarrow> ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])\n 2. \\<And>aa list.\n       \\<lbrakk>a = []; b = aa # list\\<rbrakk>\n       \\<Longrightarrow> ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])\n 3. \\<And>aa list.\n       a = aa # list \\<Longrightarrow>\n       ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])", "apply(simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>aa list.\n       \\<lbrakk>a = []; b = aa # list\\<rbrakk>\n       \\<Longrightarrow> ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])\n 2. \\<And>aa list.\n       a = aa # list \\<Longrightarrow>\n       ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])", "apply(simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa list.\n       a = aa # list \\<Longrightarrow>\n       ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])", "apply(case_tac b)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>aa list.\n       \\<lbrakk>a = aa # list; b = []\\<rbrakk>\n       \\<Longrightarrow> ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])\n 2. \\<And>aa list aaa lista.\n       \\<lbrakk>a = aa # list; b = aaa # lista\\<rbrakk>\n       \\<Longrightarrow> ([] \\<in> a \\<otimes> b) = (a = [] \\<and> b = [])", "apply(auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(* TODO: Is this wise as default simp ?*)"], ["", "lemma interleave_length[rule_format, simp]: \"ALL x : a\\<otimes>b . length x = length a + length b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>a \\<otimes> b. length x = length a + length b", "apply(induct rule: interleave.induct)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b. \\<forall>x\\<in>[] \\<otimes> b. length x = length [] + length b\n 2. \\<And>a. \\<forall>x\\<in>a \\<otimes> []. length x = length a + length []\n 3. \\<And>a l b r.\n       \\<lbrakk>\\<forall>x\\<in>l \\<otimes> b # r.\n                   length x = length l + length (b # r);\n        \\<forall>x\\<in>a # l \\<otimes> r.\n           length x = length (a # l) + length r\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>a # l \\<otimes> b # r.\n                            length x = length (a # l) + length (b # r)", "apply(auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma interleave_same[simp]: \"y\\<in>l\\<otimes>y = (l=[])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (y \\<in> l \\<otimes> y) = (l = [])", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. y \\<in> l \\<otimes> y \\<Longrightarrow> l = []\n 2. l = [] \\<Longrightarrow> y \\<in> l \\<otimes> y", "apply (subgoal_tac \"length y = length l + length y\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>y \\<in> l \\<otimes> y; length y = length l + length y\\<rbrakk>\n    \\<Longrightarrow> l = []\n 2. y \\<in> l \\<otimes> y \\<Longrightarrow> length y = length l + length y\n 3. l = [] \\<Longrightarrow> y \\<in> l \\<otimes> y", "apply (simp del: interleave_length)"], ["proof (prove)\ngoal (2 subgoals):\n 1. y \\<in> l \\<otimes> y \\<Longrightarrow> length y = length l + length y\n 2. l = [] \\<Longrightarrow> y \\<in> l \\<otimes> y", "apply (erule interleave_length)"], ["proof (prove)\ngoal (1 subgoal):\n 1. l = [] \\<Longrightarrow> y \\<in> l \\<otimes> y", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma interleave_comm[simp]: \"a\\<otimes>b = b\\<otimes>a\" (is \"?P f a b\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<otimes> b = b \\<otimes> a", "apply(induct rule: interleave.induct)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b. b \\<otimes> [] = [] \\<otimes> b\n 2. \\<And>a. [] \\<otimes> a = a \\<otimes> []\n 3. \\<And>a l b r.\n       \\<lbrakk>b # r \\<otimes> l = l \\<otimes> b # r;\n        r \\<otimes> a # l = a # l \\<otimes> r\\<rbrakk>\n       \\<Longrightarrow> b # r \\<otimes> a # l = a # l \\<otimes> b # r", "apply(auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma interleave_cont_conc[rule_format, simp]: \"ALL b . a@b \\<in> a\\<otimes>b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>b. a @ b \\<in> a \\<otimes> b", "apply(induct_tac a)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>b. [] @ b \\<in> [] \\<otimes> b\n 2. \\<And>a list.\n       \\<forall>b. list @ b \\<in> list \\<otimes> b \\<Longrightarrow>\n       \\<forall>b. (a # list) @ b \\<in> a # list \\<otimes> b", "apply(auto simp add: interleave_cons)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma interleave_cont_rev_conc[simp]: \"b@a \\<in> a\\<otimes>b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b @ a \\<in> a \\<otimes> b", "apply (subgoal_tac \"b@a \\<in> b\\<otimes>a\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. b @ a \\<in> b \\<otimes> a \\<Longrightarrow> b @ a \\<in> a \\<otimes> b\n 2. b @ a \\<in> b \\<otimes> a", "apply(simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. b @ a \\<in> b \\<otimes> a", "apply(simp only: interleave_cont_conc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma interleave_not_empty: \"a\\<otimes>b ~= {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<otimes> b \\<noteq> {}", "apply(induct rule: interleave.induct)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b. [] \\<otimes> b \\<noteq> {}\n 2. \\<And>a. a \\<otimes> [] \\<noteq> {}\n 3. \\<And>a l b r.\n       \\<lbrakk>l \\<otimes> b # r \\<noteq> {};\n        a # l \\<otimes> r \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> a # l \\<otimes> b # r \\<noteq> {}", "apply(auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma cons_interleave_split: \"\\<lbrakk>a#l \\<in> l1\\<otimes>l2\\<rbrakk> \\<Longrightarrow> (EX lh . l1=a#lh & l \\<in> lh\\<otimes>l2 | l2=a#lh & l \\<in> l1\\<otimes>lh )\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a # l \\<in> l1 \\<otimes> l2 \\<Longrightarrow>\n    \\<exists>lh.\n       l1 = a # lh \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = a # lh \\<and> l \\<in> l1 \\<otimes> lh", "apply(case_tac l1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a # l \\<in> l1 \\<otimes> l2; l1 = []\\<rbrakk>\n    \\<Longrightarrow> \\<exists>lh.\n                         l1 = a # lh \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n                         l2 = a # lh \\<and> l \\<in> l1 \\<otimes> lh\n 2. \\<And>aa list.\n       \\<lbrakk>a # l \\<in> l1 \\<otimes> l2; l1 = aa # list\\<rbrakk>\n       \\<Longrightarrow> \\<exists>lh.\n                            l1 = a # lh \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n                            l2 = a # lh \\<and> l \\<in> l1 \\<otimes> lh", "apply(auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa list.\n       \\<lbrakk>a # l \\<in> l2 \\<otimes> aa # list; l1 = aa # list\\<rbrakk>\n       \\<Longrightarrow> \\<exists>lh.\n                            aa = a \\<and>\n                            list = lh \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n                            l2 = a # lh \\<and>\n                            l \\<in> lh \\<otimes> aa # list", "apply(case_tac l2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>aa list.\n       \\<lbrakk>a # l \\<in> l2 \\<otimes> aa # list; l1 = aa # list;\n        l2 = []\\<rbrakk>\n       \\<Longrightarrow> \\<exists>lh.\n                            aa = a \\<and>\n                            list = lh \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n                            l2 = a # lh \\<and>\n                            l \\<in> lh \\<otimes> aa # list\n 2. \\<And>aa list aaa lista.\n       \\<lbrakk>a # l \\<in> l2 \\<otimes> aa # list; l1 = aa # list;\n        l2 = aaa # lista\\<rbrakk>\n       \\<Longrightarrow> \\<exists>lh.\n                            aa = a \\<and>\n                            list = lh \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n                            l2 = a # lh \\<and>\n                            l \\<in> lh \\<otimes> aa # list", "apply(auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma cons_interleave_cases[cases set, case_names left right]: \"\\<lbrakk>a#l \\<in> l1\\<otimes>l2; !!lh . \\<lbrakk>l1=a#lh; l \\<in> lh\\<otimes>l2\\<rbrakk> \\<Longrightarrow> P; !!lh. \\<lbrakk>l2=a#lh; l \\<in> l1\\<otimes>lh\\<rbrakk> \\<Longrightarrow> P\\<rbrakk> \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a # l \\<in> l1 \\<otimes> l2;\n     \\<And>lh.\n        \\<lbrakk>l1 = a # lh; l \\<in> lh \\<otimes> l2\\<rbrakk>\n        \\<Longrightarrow> P;\n     \\<And>lh.\n        \\<lbrakk>l2 = a # lh; l \\<in> l1 \\<otimes> lh\\<rbrakk>\n        \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "by (blast dest: cons_interleave_split)"], ["", "lemma interleave_cases[cases set, case_names empty left right]: \"\\<lbrakk>l\\<in>l1\\<otimes>l2; \\<lbrakk> l=[]; l1=[]; l2=[] \\<rbrakk> \\<Longrightarrow> P; !!a l' l1'. \\<lbrakk>l=a#l'; l1=a#l1'; l'\\<in>l1'\\<otimes>l2\\<rbrakk> \\<Longrightarrow> P; !!a l' l2'. \\<lbrakk>l=a#l'; l2=a#l2'; l'\\<in>l1\\<otimes>l2'\\<rbrakk> \\<Longrightarrow> P \\<rbrakk> \\<Longrightarrow> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>l \\<in> l1 \\<otimes> l2;\n     \\<lbrakk>l = []; l1 = []; l2 = []\\<rbrakk> \\<Longrightarrow> P;\n     \\<And>a l' l1'.\n        \\<lbrakk>l = a # l'; l1 = a # l1';\n         l' \\<in> l1' \\<otimes> l2\\<rbrakk>\n        \\<Longrightarrow> P;\n     \\<And>a l' l2'.\n        \\<lbrakk>l = a # l'; l2 = a # l2';\n         l' \\<in> l1 \\<otimes> l2'\\<rbrakk>\n        \\<Longrightarrow> P\\<rbrakk>\n    \\<Longrightarrow> P", "apply (cases l)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>l \\<in> l1 \\<otimes> l2;\n     \\<lbrakk>l = []; l1 = []; l2 = []\\<rbrakk> \\<Longrightarrow> P;\n     \\<And>a l' l1'.\n        \\<lbrakk>l = a # l'; l1 = a # l1';\n         l' \\<in> l1' \\<otimes> l2\\<rbrakk>\n        \\<Longrightarrow> P;\n     \\<And>a l' l2'.\n        \\<lbrakk>l = a # l'; l2 = a # l2';\n         l' \\<in> l1 \\<otimes> l2'\\<rbrakk>\n        \\<Longrightarrow> P;\n     l = []\\<rbrakk>\n    \\<Longrightarrow> P\n 2. \\<And>a list.\n       \\<lbrakk>l \\<in> l1 \\<otimes> l2;\n        \\<lbrakk>l = []; l1 = []; l2 = []\\<rbrakk> \\<Longrightarrow> P;\n        \\<And>a l' l1'.\n           \\<lbrakk>l = a # l'; l1 = a # l1';\n            l' \\<in> l1' \\<otimes> l2\\<rbrakk>\n           \\<Longrightarrow> P;\n        \\<And>a l' l2'.\n           \\<lbrakk>l = a # l'; l2 = a # l2';\n            l' \\<in> l1 \\<otimes> l2'\\<rbrakk>\n           \\<Longrightarrow> P;\n        l = a # list\\<rbrakk>\n       \\<Longrightarrow> P", "apply (simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a list.\n       \\<lbrakk>l \\<in> l1 \\<otimes> l2;\n        \\<lbrakk>l = []; l1 = []; l2 = []\\<rbrakk> \\<Longrightarrow> P;\n        \\<And>a l' l1'.\n           \\<lbrakk>l = a # l'; l1 = a # l1';\n            l' \\<in> l1' \\<otimes> l2\\<rbrakk>\n           \\<Longrightarrow> P;\n        \\<And>a l' l2'.\n           \\<lbrakk>l = a # l'; l2 = a # l2';\n            l' \\<in> l1 \\<otimes> l2'\\<rbrakk>\n           \\<Longrightarrow> P;\n        l = a # list\\<rbrakk>\n       \\<Longrightarrow> P", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a list.\n       \\<lbrakk>a # list \\<in> l1 \\<otimes> l2;\n        \\<And>aa l1'.\n           \\<lbrakk>a = aa; l1 = aa # l1';\n            list \\<in> l1' \\<otimes> l2\\<rbrakk>\n           \\<Longrightarrow> P;\n        \\<And>aa l2'.\n           \\<lbrakk>a = aa; l2 = aa # l2';\n            list \\<in> l2' \\<otimes> l1\\<rbrakk>\n           \\<Longrightarrow> P;\n        l = a # list\\<rbrakk>\n       \\<Longrightarrow> P", "apply (erule cons_interleave_cases)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a list lh.\n       \\<lbrakk>\\<And>aa l1'.\n                   \\<lbrakk>a = aa; l1 = aa # l1';\n                    list \\<in> l1' \\<otimes> l2\\<rbrakk>\n                   \\<Longrightarrow> P;\n        \\<And>aa l2'.\n           \\<lbrakk>a = aa; l2 = aa # l2';\n            list \\<in> l2' \\<otimes> l1\\<rbrakk>\n           \\<Longrightarrow> P;\n        l = a # list; l1 = a # lh; list \\<in> lh \\<otimes> l2\\<rbrakk>\n       \\<Longrightarrow> P\n 2. \\<And>a list lh.\n       \\<lbrakk>\\<And>aa l1'.\n                   \\<lbrakk>a = aa; l1 = aa # l1';\n                    list \\<in> l1' \\<otimes> l2\\<rbrakk>\n                   \\<Longrightarrow> P;\n        \\<And>aa l2'.\n           \\<lbrakk>a = aa; l2 = aa # l2';\n            list \\<in> l2' \\<otimes> l1\\<rbrakk>\n           \\<Longrightarrow> P;\n        l = a # list; l2 = a # lh; list \\<in> l1 \\<otimes> lh\\<rbrakk>\n       \\<Longrightarrow> P", "apply simp_all"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma interleave_elem_induct[induct set, case_names empty left right]: \n  \"!!w1 w2. \\<lbrakk> w\\<in>w1\\<otimes>w2; P [] [] []; !!e w w1 w2. \\<lbrakk> P w w1 w2; w\\<in>w1\\<otimes>w2 \\<rbrakk> \\<Longrightarrow> P (e#w) (e#w1) w2; !!e w w1 w2. \\<lbrakk> P w w1 w2; w\\<in>w1\\<otimes>w2 \\<rbrakk> \\<Longrightarrow> P (e#w) w1 (e#w2) \\<rbrakk> \\<Longrightarrow> P w w1 w2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w1 w2.\n       \\<lbrakk>w \\<in> w1 \\<otimes> w2; P [] [] [];\n        \\<And>e w w1 w2.\n           \\<lbrakk>P w w1 w2; w \\<in> w1 \\<otimes> w2\\<rbrakk>\n           \\<Longrightarrow> P (e # w) (e # w1) w2;\n        \\<And>e w w1 w2.\n           \\<lbrakk>P w w1 w2; w \\<in> w1 \\<otimes> w2\\<rbrakk>\n           \\<Longrightarrow> P (e # w) w1 (e # w2)\\<rbrakk>\n       \\<Longrightarrow> P w w1 w2", "by (induct w) (auto elim!: cons_interleave_cases intro!: interleave_cons)"], ["", "lemma interleave_rev_cons1[rule_format]: \"ALL a b . l \\<in> a\\<otimes>b \\<longrightarrow> l@[x] \\<in> a@[x] \\<otimes> b\" (is \"?P l\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a b.\n       l \\<in> a \\<otimes> b \\<longrightarrow>\n       l @ [x] \\<in> a @ [x] \\<otimes> b", "proof (induct l)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>a b.\n       [] \\<in> a \\<otimes> b \\<longrightarrow>\n       [] @ [x] \\<in> a @ [x] \\<otimes> b\n 2. \\<And>a l.\n       \\<forall>a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          l @ [x] \\<in> a @ [x] \\<otimes> b \\<Longrightarrow>\n       \\<forall>aa b.\n          a # l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # l) @ [x] \\<in> aa @ [x] \\<otimes> b", "case Nil"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>a b.\n       [] \\<in> a \\<otimes> b \\<longrightarrow>\n       [] @ [x] \\<in> a @ [x] \\<otimes> b\n 2. \\<And>a l.\n       \\<forall>a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          l @ [x] \\<in> a @ [x] \\<otimes> b \\<Longrightarrow>\n       \\<forall>aa b.\n          a # l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # l) @ [x] \\<in> aa @ [x] \\<otimes> b", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a b.\n       [] \\<in> a \\<otimes> b \\<longrightarrow>\n       [] @ [x] \\<in> a @ [x] \\<otimes> b", "by (simp)"], ["proof (state)\nthis:\n  \\<forall>a b.\n     [] \\<in> a \\<otimes> b \\<longrightarrow>\n     [] @ [x] \\<in> a @ [x] \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<forall>a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          l @ [x] \\<in> a @ [x] \\<otimes> b \\<Longrightarrow>\n       \\<forall>aa b.\n          a # l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # l) @ [x] \\<in> aa @ [x] \\<otimes> b", "case (Cons e l)"], ["proof (state)\nthis:\n  \\<forall>a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow>\n     l @ [x] \\<in> a @ [x] \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<forall>a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          l @ [x] \\<in> a @ [x] \\<otimes> b \\<Longrightarrow>\n       \\<forall>aa b.\n          a # l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # l) @ [x] \\<in> aa @ [x] \\<otimes> b", "assume IH[rule_format]: \"?P l\""], ["proof (state)\nthis:\n  l \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  l @ [x] \\<in> ?a @ [x] \\<otimes> ?b\n\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<forall>a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          l @ [x] \\<in> a @ [x] \\<otimes> b \\<Longrightarrow>\n       \\<forall>aa b.\n          a # l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # l) @ [x] \\<in> aa @ [x] \\<otimes> b", "show \"?P (e#l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a b.\n       e # l \\<in> a \\<otimes> b \\<longrightarrow>\n       (e # l) @ [x] \\<in> a @ [x] \\<otimes> b", "proof (intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       e # l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # l) @ [x] \\<in> a @ [x] \\<otimes> b", "fix a b"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       e # l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # l) @ [x] \\<in> a @ [x] \\<otimes> b", "assume \"e#l \\<in> a\\<otimes>b\""], ["proof (state)\nthis:\n  e # l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       e # l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # l) @ [x] \\<in> a @ [x] \\<otimes> b", "then"], ["proof (chain)\npicking this:\n  e # l \\<in> a \\<otimes> b", "obtain c where SPLIT: \"a=e#c & l\\<in>c\\<otimes>b | b=e#c & l\\<in>a\\<otimes>c\""], ["proof (prove)\nusing this:\n  e # l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        a = e # c \\<and> l \\<in> c \\<otimes> b \\<or>\n        b = e # c \\<and> l \\<in> a \\<otimes> c \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (blast dest: cons_interleave_split)"], ["proof (state)\nthis:\n  a = e # c \\<and> l \\<in> c \\<otimes> b \\<or>\n  b = e # c \\<and> l \\<in> a \\<otimes> c\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       e # l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # l) @ [x] \\<in> a @ [x] \\<otimes> b", "with IH"], ["proof (chain)\npicking this:\n  l \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  l @ [x] \\<in> ?a @ [x] \\<otimes> ?b\n  a = e # c \\<and> l \\<in> c \\<otimes> b \\<or>\n  b = e # c \\<and> l \\<in> a \\<otimes> c", "have \"a=e#c & l@[x]\\<in>c@[x]\\<otimes>b | b=e#c & l@[x]\\<in>a@[x]\\<otimes>c\""], ["proof (prove)\nusing this:\n  l \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  l @ [x] \\<in> ?a @ [x] \\<otimes> ?b\n  a = e # c \\<and> l \\<in> c \\<otimes> b \\<or>\n  b = e # c \\<and> l \\<in> a \\<otimes> c\n\ngoal (1 subgoal):\n 1. a = e # c \\<and> l @ [x] \\<in> c @ [x] \\<otimes> b \\<or>\n    b = e # c \\<and> l @ [x] \\<in> a @ [x] \\<otimes> c", "by auto"], ["proof (state)\nthis:\n  a = e # c \\<and> l @ [x] \\<in> c @ [x] \\<otimes> b \\<or>\n  b = e # c \\<and> l @ [x] \\<in> a @ [x] \\<otimes> c\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       e # l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # l) @ [x] \\<in> a @ [x] \\<otimes> b", "hence \"a=e#c & e#l@[x]\\<in>e#c@[x]\\<otimes>b | b=e#c & e#l@[x]\\<in>a@[x]\\<otimes>e#c\""], ["proof (prove)\nusing this:\n  a = e # c \\<and> l @ [x] \\<in> c @ [x] \\<otimes> b \\<or>\n  b = e # c \\<and> l @ [x] \\<in> a @ [x] \\<otimes> c\n\ngoal (1 subgoal):\n 1. a = e # c \\<and> e # l @ [x] \\<in> e # c @ [x] \\<otimes> b \\<or>\n    b = e # c \\<and> e # l @ [x] \\<in> a @ [x] \\<otimes> e # c", "by (auto simp add: interleave_cons)"], ["proof (state)\nthis:\n  a = e # c \\<and> e # l @ [x] \\<in> e # c @ [x] \\<otimes> b \\<or>\n  b = e # c \\<and> e # l @ [x] \\<in> a @ [x] \\<otimes> e # c\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       e # l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # l) @ [x] \\<in> a @ [x] \\<otimes> b", "thus \"(e#l)@[x]\\<in>a@[x]\\<otimes>b\""], ["proof (prove)\nusing this:\n  a = e # c \\<and> e # l @ [x] \\<in> e # c @ [x] \\<otimes> b \\<or>\n  b = e # c \\<and> e # l @ [x] \\<in> a @ [x] \\<otimes> e # c\n\ngoal (1 subgoal):\n 1. (e # l) @ [x] \\<in> a @ [x] \\<otimes> b", "by auto"], ["proof (state)\nthis:\n  (e # l) @ [x] \\<in> a @ [x] \\<otimes> b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>a b.\n     e # l \\<in> a \\<otimes> b \\<longrightarrow>\n     (e # l) @ [x] \\<in> a @ [x] \\<otimes> b\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary interleave_rev_cons2: \"l \\<in> a\\<otimes>b \\<Longrightarrow> l@[x] \\<in> a \\<otimes> b@[x]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow>\n    l @ [x] \\<in> a \\<otimes> b @ [x]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow>\n    l @ [x] \\<in> a \\<otimes> b @ [x]", "assume \"l \\<in> a\\<otimes>b\""], ["proof (state)\nthis:\n  l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow>\n    l @ [x] \\<in> a \\<otimes> b @ [x]", "hence \"l\\<in>b\\<otimes>a\""], ["proof (prove)\nusing this:\n  l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. l \\<in> b \\<otimes> a", "by auto"], ["proof (state)\nthis:\n  l \\<in> b \\<otimes> a\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow>\n    l @ [x] \\<in> a \\<otimes> b @ [x]", "hence \"l@[x] \\<in> b@[x] \\<otimes> a\""], ["proof (prove)\nusing this:\n  l \\<in> b \\<otimes> a\n\ngoal (1 subgoal):\n 1. l @ [x] \\<in> b @ [x] \\<otimes> a", "by (blast dest: interleave_rev_cons1)"], ["proof (state)\nthis:\n  l @ [x] \\<in> b @ [x] \\<otimes> a\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow>\n    l @ [x] \\<in> a \\<otimes> b @ [x]", "thus ?thesis"], ["proof (prove)\nusing this:\n  l @ [x] \\<in> b @ [x] \\<otimes> a\n\ngoal (1 subgoal):\n 1. l @ [x] \\<in> a \\<otimes> b @ [x]", "by auto"], ["proof (state)\nthis:\n  l @ [x] \\<in> a \\<otimes> b @ [x]\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas interleave_rev_cons = interleave_rev_cons1 interleave_rev_cons2"], ["", "subsubsection \"Interleaving and list concatenation\""], ["", "lemma interleave_append1: \"\\<lbrakk>l \\<in> a\\<otimes>b\\<rbrakk> \\<Longrightarrow> x@l \\<in> x@a \\<otimes> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> x @ a \\<otimes> b", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> x @ a \\<otimes> b", "have \"ALL l a b . l \\<in> a\\<otimes>b \\<longrightarrow> x@l \\<in> x@a \\<otimes> b\" (is \"?P x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l a b.\n       l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> x @ a \\<otimes> b", "proof (induct x)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>l a b.\n       l \\<in> a \\<otimes> b \\<longrightarrow>\n       [] @ l \\<in> [] @ a \\<otimes> b\n 2. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> x @ a \\<otimes> b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> (a # x) @ aa \\<otimes> b", "show \"?P []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l a b.\n       l \\<in> a \\<otimes> b \\<longrightarrow>\n       [] @ l \\<in> [] @ a \\<otimes> b", "by simp"], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> [] @ l \\<in> [] @ a \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> x @ a \\<otimes> b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> (a # x) @ aa \\<otimes> b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> x @ a \\<otimes> b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> (a # x) @ aa \\<otimes> b", "fix e"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> x @ a \\<otimes> b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> (a # x) @ aa \\<otimes> b", "fix x::\"'a list\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> x @ a \\<otimes> b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> (a # x) @ aa \\<otimes> b", "assume IH: \"?P x\""], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> x @ a \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> x @ a \\<otimes> b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> (a # x) @ aa \\<otimes> b", "show \"?P (e#x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l a b.\n       l \\<in> a \\<otimes> b \\<longrightarrow>\n       (e # x) @ l \\<in> (e # x) @ a \\<otimes> b", "proof (intro impI allI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l a b.\n       l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # x) @ l \\<in> (e # x) @ a \\<otimes> b", "fix l::\"'a list\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l a b.\n       l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # x) @ l \\<in> (e # x) @ a \\<otimes> b", "fix a b"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l a b.\n       l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # x) @ l \\<in> (e # x) @ a \\<otimes> b", "assume \"l \\<in> a \\<otimes> b\""], ["proof (state)\nthis:\n  l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>l a b.\n       l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # x) @ l \\<in> (e # x) @ a \\<otimes> b", "with IH"], ["proof (chain)\npicking this:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> x @ a \\<otimes> b\n  l \\<in> a \\<otimes> b", "have \"x@l \\<in> x@a \\<otimes> b\""], ["proof (prove)\nusing this:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> x @ a \\<otimes> b\n  l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. x @ l \\<in> x @ a \\<otimes> b", "by auto"], ["proof (state)\nthis:\n  x @ l \\<in> x @ a \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>l a b.\n       l \\<in> a \\<otimes> b \\<Longrightarrow>\n       (e # x) @ l \\<in> (e # x) @ a \\<otimes> b", "with interleave_cons1"], ["proof (chain)\npicking this:\n  ?l \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  ?x # ?l \\<in> ?x # ?a \\<otimes> ?b\n  x @ l \\<in> x @ a \\<otimes> b", "show \"(e # x) @ l \\<in> (e # x) @ a \\<otimes> b\""], ["proof (prove)\nusing this:\n  ?l \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  ?x # ?l \\<in> ?x # ?a \\<otimes> ?b\n  x @ l \\<in> x @ a \\<otimes> b\n\ngoal (1 subgoal):\n 1. (e # x) @ l \\<in> (e # x) @ a \\<otimes> b", "by force"], ["proof (state)\nthis:\n  (e # x) @ l \\<in> (e # x) @ a \\<otimes> b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow>\n     (e # x) @ l \\<in> (e # x) @ a \\<otimes> b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> x @ a \\<otimes> b\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> x @ a \\<otimes> b", "moreover"], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> x @ a \\<otimes> b\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> x @ a \\<otimes> b", "assume \"l \\<in> a \\<otimes> b\""], ["proof (state)\nthis:\n  l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> x @ a \\<otimes> b", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> x @ a \\<otimes> b\n  l \\<in> a \\<otimes> b", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> x @ a \\<otimes> b\n  l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. x @ l \\<in> x @ a \\<otimes> b", "by blast"], ["proof (state)\nthis:\n  x @ l \\<in> x @ a \\<otimes> b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma interleave_append2: \"\\<lbrakk>l \\<in> a\\<otimes>b\\<rbrakk> \\<Longrightarrow> x@l \\<in> a \\<otimes> x@b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> a \\<otimes> x @ b", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> a \\<otimes> x @ b", "have \"ALL l a b . l \\<in> a\\<otimes>b \\<longrightarrow> x@l \\<in> a \\<otimes> x@b\" (is \"?P x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l a b.\n       l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b", "proof (induct x)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>l a b.\n       l \\<in> a \\<otimes> b \\<longrightarrow>\n       [] @ l \\<in> a \\<otimes> [] @ b\n 2. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> a \\<otimes> x @ b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b", "show \"?P []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l a b.\n       l \\<in> a \\<otimes> b \\<longrightarrow>\n       [] @ l \\<in> a \\<otimes> [] @ b", "by simp"], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> [] @ l \\<in> a \\<otimes> [] @ b\n\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> a \\<otimes> x @ b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> a \\<otimes> x @ b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b", "fix a"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> a \\<otimes> x @ b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b", "fix x::\"'a list\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> a \\<otimes> x @ b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b", "assume IH: \"\\<forall>l a b. l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b\""], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b\n\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<forall>l a b.\n          l \\<in> a \\<otimes> b \\<longrightarrow>\n          x @ l \\<in> a \\<otimes> x @ b \\<Longrightarrow>\n       \\<forall>l aa b.\n          l \\<in> aa \\<otimes> b \\<longrightarrow>\n          (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b", "show \"\\<forall>l aa b. l \\<in> aa \\<otimes> b \\<longrightarrow> (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l aaa b.\n       l \\<in> aaa \\<otimes> b \\<longrightarrow>\n       (a # x) @ l \\<in> aaa \\<otimes> (a # x) @ b", "proof (intro impI allI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l aaa b.\n       l \\<in> aaa \\<otimes> b \\<Longrightarrow>\n       (a # x) @ l \\<in> aaa \\<otimes> (a # x) @ b", "fix l::\"'a list\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l aaa b.\n       l \\<in> aaa \\<otimes> b \\<Longrightarrow>\n       (a # x) @ l \\<in> aaa \\<otimes> (a # x) @ b", "fix aa b"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l aaa b.\n       l \\<in> aaa \\<otimes> b \\<Longrightarrow>\n       (a # x) @ l \\<in> aaa \\<otimes> (a # x) @ b", "assume \"l \\<in> aa \\<otimes> b\""], ["proof (state)\nthis:\n  l \\<in> aa \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>l aaa b.\n       l \\<in> aaa \\<otimes> b \\<Longrightarrow>\n       (a # x) @ l \\<in> aaa \\<otimes> (a # x) @ b", "with IH"], ["proof (chain)\npicking this:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b\n  l \\<in> aa \\<otimes> b", "have \"x@l \\<in> aa \\<otimes> x@b\""], ["proof (prove)\nusing this:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b\n  l \\<in> aa \\<otimes> b\n\ngoal (1 subgoal):\n 1. x @ l \\<in> aa \\<otimes> x @ b", "by auto"], ["proof (state)\nthis:\n  x @ l \\<in> aa \\<otimes> x @ b\n\ngoal (1 subgoal):\n 1. \\<And>l aaa b.\n       l \\<in> aaa \\<otimes> b \\<Longrightarrow>\n       (a # x) @ l \\<in> aaa \\<otimes> (a # x) @ b", "with interleave_cons2"], ["proof (chain)\npicking this:\n  ?l \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  ?x # ?l \\<in> ?a \\<otimes> ?x # ?b\n  x @ l \\<in> aa \\<otimes> x @ b", "show \"(a # x) @ l \\<in> aa \\<otimes> (a # x) @ b\""], ["proof (prove)\nusing this:\n  ?l \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  ?x # ?l \\<in> ?a \\<otimes> ?x # ?b\n  x @ l \\<in> aa \\<otimes> x @ b\n\ngoal (1 subgoal):\n 1. (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b", "by force"], ["proof (state)\nthis:\n  (a # x) @ l \\<in> aa \\<otimes> (a # x) @ b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>l aaa b.\n     l \\<in> aaa \\<otimes> b \\<longrightarrow>\n     (a # x) @ l \\<in> aaa \\<otimes> (a # x) @ b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> a \\<otimes> x @ b", "moreover"], ["proof (state)\nthis:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> a \\<otimes> x @ b", "assume \"l \\<in> a \\<otimes> b\""], ["proof (state)\nthis:\n  l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. l \\<in> a \\<otimes> b \\<Longrightarrow> x @ l \\<in> a \\<otimes> x @ b", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b\n  l \\<in> a \\<otimes> b", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>l a b.\n     l \\<in> a \\<otimes> b \\<longrightarrow> x @ l \\<in> a \\<otimes> x @ b\n  l \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. x @ l \\<in> a \\<otimes> x @ b", "by blast"], ["proof (state)\nthis:\n  x @ l \\<in> a \\<otimes> x @ b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas interleave_append = interleave_append1 interleave_append2"], ["", "lemma interleave_rev_append1: \"!!a b w. w\\<in>a\\<otimes>b \\<Longrightarrow> w@w' \\<in> a@w' \\<otimes> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b w.\n       w \\<in> a \\<otimes> b \\<Longrightarrow>\n       w @ w' \\<in> a @ w' \\<otimes> b", "proof (induct w' rule: rev_induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>a b w.\n       w \\<in> a \\<otimes> b \\<Longrightarrow>\n       w @ [] \\<in> a @ [] \\<otimes> b\n 2. \\<And>x xs a b w.\n       \\<lbrakk>\\<And>a b w.\n                   w \\<in> a \\<otimes> b \\<Longrightarrow>\n                   w @ xs \\<in> a @ xs \\<otimes> b;\n        w \\<in> a \\<otimes> b\\<rbrakk>\n       \\<Longrightarrow> w @ xs @ [x] \\<in> a @ xs @ [x] \\<otimes> b", "case Nil"], ["proof (state)\nthis:\n  w \\<in> a \\<otimes> b\n\ngoal (2 subgoals):\n 1. \\<And>a b w.\n       w \\<in> a \\<otimes> b \\<Longrightarrow>\n       w @ [] \\<in> a @ [] \\<otimes> b\n 2. \\<And>x xs a b w.\n       \\<lbrakk>\\<And>a b w.\n                   w \\<in> a \\<otimes> b \\<Longrightarrow>\n                   w @ xs \\<in> a @ xs \\<otimes> b;\n        w \\<in> a \\<otimes> b\\<rbrakk>\n       \\<Longrightarrow> w @ xs @ [x] \\<in> a @ xs @ [x] \\<otimes> b", "thus ?case"], ["proof (prove)\nusing this:\n  w \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. w @ [] \\<in> a @ [] \\<otimes> b", "by simp"], ["proof (state)\nthis:\n  w @ [] \\<in> a @ [] \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>x xs a b w.\n       \\<lbrakk>\\<And>a b w.\n                   w \\<in> a \\<otimes> b \\<Longrightarrow>\n                   w @ xs \\<in> a @ xs \\<otimes> b;\n        w \\<in> a \\<otimes> b\\<rbrakk>\n       \\<Longrightarrow> w @ xs @ [x] \\<in> a @ xs @ [x] \\<otimes> b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xs a b w.\n       \\<lbrakk>\\<And>a b w.\n                   w \\<in> a \\<otimes> b \\<Longrightarrow>\n                   w @ xs \\<in> a @ xs \\<otimes> b;\n        w \\<in> a \\<otimes> b\\<rbrakk>\n       \\<Longrightarrow> w @ xs @ [x] \\<in> a @ xs @ [x] \\<otimes> b", "case (snoc e w')"], ["proof (state)\nthis:\n  ?w \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  ?w @ w' \\<in> ?a @ w' \\<otimes> ?b\n  w \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>x xs a b w.\n       \\<lbrakk>\\<And>a b w.\n                   w \\<in> a \\<otimes> b \\<Longrightarrow>\n                   w @ xs \\<in> a @ xs \\<otimes> b;\n        w \\<in> a \\<otimes> b\\<rbrakk>\n       \\<Longrightarrow> w @ xs @ [x] \\<in> a @ xs @ [x] \\<otimes> b", "note IHP=this"], ["proof (state)\nthis:\n  ?w \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  ?w @ w' \\<in> ?a @ w' \\<otimes> ?b\n  w \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>x xs a b w.\n       \\<lbrakk>\\<And>a b w.\n                   w \\<in> a \\<otimes> b \\<Longrightarrow>\n                   w @ xs \\<in> a @ xs \\<otimes> b;\n        w \\<in> a \\<otimes> b\\<rbrakk>\n       \\<Longrightarrow> w @ xs @ [x] \\<in> a @ xs @ [x] \\<otimes> b", "hence \"w@w'\\<in>a@w'\\<otimes>b\""], ["proof (prove)\nusing this:\n  ?w \\<in> ?a \\<otimes> ?b \\<Longrightarrow>\n  ?w @ w' \\<in> ?a @ w' \\<otimes> ?b\n  w \\<in> a \\<otimes> b\n\ngoal (1 subgoal):\n 1. w @ w' \\<in> a @ w' \\<otimes> b", "by auto"], ["proof (state)\nthis:\n  w @ w' \\<in> a @ w' \\<otimes> b\n\ngoal (1 subgoal):\n 1. \\<And>x xs a b w.\n       \\<lbrakk>\\<And>a b w.\n                   w \\<in> a \\<otimes> b \\<Longrightarrow>\n                   w @ xs \\<in> a @ xs \\<otimes> b;\n        w \\<in> a \\<otimes> b\\<rbrakk>\n       \\<Longrightarrow> w @ xs @ [x] \\<in> a @ xs @ [x] \\<otimes> b", "thus ?case"], ["proof (prove)\nusing this:\n  w @ w' \\<in> a @ w' \\<otimes> b\n\ngoal (1 subgoal):\n 1. w @ w' @ [e] \\<in> a @ w' @ [e] \\<otimes> b", "using interleave_rev_cons1[of \"w@w'\" \"a@w'\" \"b\"]"], ["proof (prove)\nusing this:\n  w @ w' \\<in> a @ w' \\<otimes> b\n  w @ w' \\<in> a @ w' \\<otimes> b \\<Longrightarrow>\n  (w @ w') @ [?x] \\<in> (a @ w') @ [?x] \\<otimes> b\n\ngoal (1 subgoal):\n 1. w @ w' @ [e] \\<in> a @ w' @ [e] \\<otimes> b", "by (simp)"], ["proof (state)\nthis:\n  w @ w' @ [e] \\<in> a @ w' @ [e] \\<otimes> b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma interleave_rev_append2: \"w\\<in>a\\<otimes>b \\<Longrightarrow> w@w' \\<in> a \\<otimes> b@w'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w \\<in> a \\<otimes> b \\<Longrightarrow> w @ w' \\<in> a \\<otimes> b @ w'", "by (simp only: interleave_comm[of a b] interleave_comm[of a \"b@w'\"]) (blast dest: interleave_rev_append1)"], ["", "lemmas interleave_rev_append = interleave_rev_append1 interleave_rev_append2"], ["", "lemma interleave_rev1[rule_format]: \"ALL w1 w2 . (w\\<in>w1\\<otimes>w2) \\<longrightarrow> (rev w \\<in> rev w1 \\<otimes> rev w2)\" (is \"?P w\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1 w2.\n       w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n       rev w \\<in> rev w1 \\<otimes> rev w2", "proof (induct w)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>w1 w2.\n       [] \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n       rev [] \\<in> rev w1 \\<otimes> rev w2\n 2. \\<And>a w.\n       \\<forall>w1 w2.\n          w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev w \\<in> rev w1 \\<otimes> rev w2 \\<Longrightarrow>\n       \\<forall>w1 w2.\n          a # w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev (a # w) \\<in> rev w1 \\<otimes> rev w2", "case Nil"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>w1 w2.\n       [] \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n       rev [] \\<in> rev w1 \\<otimes> rev w2\n 2. \\<And>a w.\n       \\<forall>w1 w2.\n          w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev w \\<in> rev w1 \\<otimes> rev w2 \\<Longrightarrow>\n       \\<forall>w1 w2.\n          a # w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev (a # w) \\<in> rev w1 \\<otimes> rev w2", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1 w2.\n       [] \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n       rev [] \\<in> rev w1 \\<otimes> rev w2", "by (simp)"], ["proof (state)\nthis:\n  \\<forall>w1 w2.\n     [] \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n     rev [] \\<in> rev w1 \\<otimes> rev w2\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1 w2.\n          w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev w \\<in> rev w1 \\<otimes> rev w2 \\<Longrightarrow>\n       \\<forall>w1 w2.\n          a # w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev (a # w) \\<in> rev w1 \\<otimes> rev w2", "case (Cons e w)"], ["proof (state)\nthis:\n  \\<forall>w1 w2.\n     w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n     rev w \\<in> rev w1 \\<otimes> rev w2\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1 w2.\n          w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev w \\<in> rev w1 \\<otimes> rev w2 \\<Longrightarrow>\n       \\<forall>w1 w2.\n          a # w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev (a # w) \\<in> rev w1 \\<otimes> rev w2", "assume IH[rule_format]: \"?P w\""], ["proof (state)\nthis:\n  w \\<in> ?w1.0 \\<otimes> ?w2.0 \\<Longrightarrow>\n  rev w \\<in> rev ?w1.0 \\<otimes> rev ?w2.0\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1 w2.\n          w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev w \\<in> rev w1 \\<otimes> rev w2 \\<Longrightarrow>\n       \\<forall>w1 w2.\n          a # w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n          rev (a # w) \\<in> rev w1 \\<otimes> rev w2", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1 w2.\n       e # w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n       rev (e # w) \\<in> rev w1 \\<otimes> rev w2", "proof (clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w1 w2.\n       e # w \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       rev w @ [e] \\<in> rev w1 \\<otimes> rev w2", "fix w1 w2"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w1 w2.\n       e # w \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       rev w @ [e] \\<in> rev w1 \\<otimes> rev w2", "assume \"e # w \\<in> w1 \\<otimes> w2\""], ["proof (state)\nthis:\n  e # w \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>w1 w2.\n       e # w \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       rev w @ [e] \\<in> rev w1 \\<otimes> rev w2", "then"], ["proof (chain)\npicking this:\n  e # w \\<in> w1 \\<otimes> w2", "obtain w' where \"w1=e#w' & w\\<in>w'\\<otimes>w2 | w2=e#w' & w\\<in>w1\\<otimes>w'\""], ["proof (prove)\nusing this:\n  e # w \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. (\\<And>w'.\n        w1 = e # w' \\<and> w \\<in> w' \\<otimes> w2 \\<or>\n        w2 = e # w' \\<and> w \\<in> w1 \\<otimes> w' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (blast dest: cons_interleave_split)"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> w \\<in> w' \\<otimes> w2 \\<or>\n  w2 = e # w' \\<and> w \\<in> w1 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>w1 w2.\n       e # w \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       rev w @ [e] \\<in> rev w1 \\<otimes> rev w2", "with IH"], ["proof (chain)\npicking this:\n  w \\<in> ?w1.0 \\<otimes> ?w2.0 \\<Longrightarrow>\n  rev w \\<in> rev ?w1.0 \\<otimes> rev ?w2.0\n  w1 = e # w' \\<and> w \\<in> w' \\<otimes> w2 \\<or>\n  w2 = e # w' \\<and> w \\<in> w1 \\<otimes> w'", "have \"w1=e#w' & rev w\\<in>rev w' \\<otimes> rev w2 | w2=e#w' & rev w \\<in> rev w1 \\<otimes> rev w'\""], ["proof (prove)\nusing this:\n  w \\<in> ?w1.0 \\<otimes> ?w2.0 \\<Longrightarrow>\n  rev w \\<in> rev ?w1.0 \\<otimes> rev ?w2.0\n  w1 = e # w' \\<and> w \\<in> w' \\<otimes> w2 \\<or>\n  w2 = e # w' \\<and> w \\<in> w1 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. w1 = e # w' \\<and> rev w \\<in> rev w' \\<otimes> rev w2 \\<or>\n    w2 = e # w' \\<and> rev w \\<in> rev w1 \\<otimes> rev w'", "by auto"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> rev w \\<in> rev w' \\<otimes> rev w2 \\<or>\n  w2 = e # w' \\<and> rev w \\<in> rev w1 \\<otimes> rev w'\n\ngoal (1 subgoal):\n 1. \\<And>w1 w2.\n       e # w \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       rev w @ [e] \\<in> rev w1 \\<otimes> rev w2", "thus \"rev w @ [e]\\<in>rev w1 \\<otimes> rev w2\""], ["proof (prove)\nusing this:\n  w1 = e # w' \\<and> rev w \\<in> rev w' \\<otimes> rev w2 \\<or>\n  w2 = e # w' \\<and> rev w \\<in> rev w1 \\<otimes> rev w'\n\ngoal (1 subgoal):\n 1. rev w @ [e] \\<in> rev w1 \\<otimes> rev w2", "by (auto simp add: interleave_rev_cons)"], ["proof (state)\nthis:\n  rev w @ [e] \\<in> rev w1 \\<otimes> rev w2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>w1 w2.\n     e # w \\<in> w1 \\<otimes> w2 \\<longrightarrow>\n     rev (e # w) \\<in> rev w1 \\<otimes> rev w2\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary interleave_rev2: \"(rev w \\<in> rev w1 \\<otimes> rev w2) \\<Longrightarrow> (w\\<in>w1\\<otimes>w2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rev w \\<in> rev w1 \\<otimes> rev w2 \\<Longrightarrow>\n    w \\<in> w1 \\<otimes> w2", "apply (subgoal_tac \"(rev w\\<in>rev w1\\<otimes>rev w2) = (rev (rev w) \\<in> rev (rev w1) \\<otimes> rev (rev w2))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>rev w \\<in> rev w1 \\<otimes> rev w2;\n     (rev w \\<in> rev w1 \\<otimes> rev w2) =\n     (rev (rev w) \\<in> rev (rev w1) \\<otimes> rev (rev w2))\\<rbrakk>\n    \\<Longrightarrow> w \\<in> w1 \\<otimes> w2\n 2. rev w \\<in> rev w1 \\<otimes> rev w2 \\<Longrightarrow>\n    (rev w \\<in> rev w1 \\<otimes> rev w2) =\n    (rev (rev w) \\<in> rev (rev w1) \\<otimes> rev (rev w2))", "apply(simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. rev w \\<in> rev w1 \\<otimes> rev w2 \\<Longrightarrow>\n    (rev w \\<in> rev w1 \\<otimes> rev w2) =\n    (rev (rev w) \\<in> rev (rev w1) \\<otimes> rev (rev w2))", "apply (blast dest: interleave_rev1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemmas interleave_rev = interleave_rev1 interleave_rev2"], ["", "lemma rev_cons_interleave_split: \"\\<lbrakk>l@[a] \\<in> l1\\<otimes>l2\\<rbrakk> \\<Longrightarrow> (EX lh . l1=lh@[a] & l \\<in> lh\\<otimes>l2 | l2=lh@[a] & l \\<in> l1\\<otimes>lh )\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l @ [a] \\<in> l1 \\<otimes> l2 \\<Longrightarrow>\n    \\<exists>lh.\n       l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. l @ [a] \\<in> l1 \\<otimes> l2 \\<Longrightarrow>\n    \\<exists>lh.\n       l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh", "assume \"l@[a] \\<in> l1\\<otimes>l2\""], ["proof (state)\nthis:\n  l @ [a] \\<in> l1 \\<otimes> l2\n\ngoal (1 subgoal):\n 1. l @ [a] \\<in> l1 \\<otimes> l2 \\<Longrightarrow>\n    \\<exists>lh.\n       l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh", "hence \"a#rev l \\<in> rev l1 \\<otimes> rev l2\""], ["proof (prove)\nusing this:\n  l @ [a] \\<in> l1 \\<otimes> l2\n\ngoal (1 subgoal):\n 1. a # rev l \\<in> rev l1 \\<otimes> rev l2", "by (auto dest: interleave_rev)"], ["proof (state)\nthis:\n  a # rev l \\<in> rev l1 \\<otimes> rev l2\n\ngoal (1 subgoal):\n 1. l @ [a] \\<in> l1 \\<otimes> l2 \\<Longrightarrow>\n    \\<exists>lh.\n       l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh", "then"], ["proof (chain)\npicking this:\n  a # rev l \\<in> rev l1 \\<otimes> rev l2", "obtain lh where \"rev l1 = a#lh & rev l \\<in> lh\\<otimes>rev l2 | rev l2 = a#lh & rev l \\<in> rev l1 \\<otimes> lh\""], ["proof (prove)\nusing this:\n  a # rev l \\<in> rev l1 \\<otimes> rev l2\n\ngoal (1 subgoal):\n 1. (\\<And>lh.\n        rev l1 = a # lh \\<and> rev l \\<in> lh \\<otimes> rev l2 \\<or>\n        rev l2 = a # lh \\<and>\n        rev l \\<in> rev l1 \\<otimes> lh \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (blast dest: cons_interleave_split)"], ["proof (state)\nthis:\n  rev l1 = a # lh \\<and> rev l \\<in> lh \\<otimes> rev l2 \\<or>\n  rev l2 = a # lh \\<and> rev l \\<in> rev l1 \\<otimes> lh\n\ngoal (1 subgoal):\n 1. l @ [a] \\<in> l1 \\<otimes> l2 \\<Longrightarrow>\n    \\<exists>lh.\n       l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh", "hence \"rev l1 = a#lh & l \\<in> rev lh \\<otimes> l2 | rev l2 = a#lh & l \\<in> l1 \\<otimes> rev lh\""], ["proof (prove)\nusing this:\n  rev l1 = a # lh \\<and> rev l \\<in> lh \\<otimes> rev l2 \\<or>\n  rev l2 = a # lh \\<and> rev l \\<in> rev l1 \\<otimes> lh\n\ngoal (1 subgoal):\n 1. rev l1 = a # lh \\<and> l \\<in> rev lh \\<otimes> l2 \\<or>\n    rev l2 = a # lh \\<and> l \\<in> l1 \\<otimes> rev lh", "by (auto dest: interleave_rev)"], ["proof (state)\nthis:\n  rev l1 = a # lh \\<and> l \\<in> rev lh \\<otimes> l2 \\<or>\n  rev l2 = a # lh \\<and> l \\<in> l1 \\<otimes> rev lh\n\ngoal (1 subgoal):\n 1. l @ [a] \\<in> l1 \\<otimes> l2 \\<Longrightarrow>\n    \\<exists>lh.\n       l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh", "hence \"l1 = rev lh @ [a] & l \\<in> rev lh \\<otimes> l2 | l2 = rev lh @ [a] & l \\<in> l1 \\<otimes> rev lh\""], ["proof (prove)\nusing this:\n  rev l1 = a # lh \\<and> l \\<in> rev lh \\<otimes> l2 \\<or>\n  rev l2 = a # lh \\<and> l \\<in> l1 \\<otimes> rev lh\n\ngoal (1 subgoal):\n 1. l1 = rev lh @ [a] \\<and> l \\<in> rev lh \\<otimes> l2 \\<or>\n    l2 = rev lh @ [a] \\<and> l \\<in> l1 \\<otimes> rev lh", "by (simp add: rev_swap)"], ["proof (state)\nthis:\n  l1 = rev lh @ [a] \\<and> l \\<in> rev lh \\<otimes> l2 \\<or>\n  l2 = rev lh @ [a] \\<and> l \\<in> l1 \\<otimes> rev lh\n\ngoal (1 subgoal):\n 1. l @ [a] \\<in> l1 \\<otimes> l2 \\<Longrightarrow>\n    \\<exists>lh.\n       l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh", "thus ?thesis"], ["proof (prove)\nusing this:\n  l1 = rev lh @ [a] \\<and> l \\<in> rev lh \\<otimes> l2 \\<or>\n  l2 = rev lh @ [a] \\<and> l \\<in> l1 \\<otimes> rev lh\n\ngoal (1 subgoal):\n 1. \\<exists>lh.\n       l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n       l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh", "by blast"], ["proof (state)\nthis:\n  \\<exists>lh.\n     l1 = lh @ [a] \\<and> l \\<in> lh \\<otimes> l2 \\<or>\n     l2 = lh @ [a] \\<and> l \\<in> l1 \\<otimes> lh\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \"Associativity\""], ["", "lemma interleave_s_assoc1[rule_format]: \"ALL w1 ws w2 w3 . (w\\<in>w1\\<otimes>ws & ws\\<in>w2\\<otimes>w3 \\<longrightarrow> (EX ws' : w1\\<otimes>w2 . w \\<in> ws'\\<otimes>w3))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1 ws w2 w3.\n       w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n       (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)", "proof (induct w)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>w1 ws w2 w3.\n       [] \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n       (\\<exists>ws'\\<in>w1 \\<otimes> w2. [] \\<in> ws' \\<otimes> w3)\n 2. \\<And>a w.\n       \\<forall>w1 ws w2 w3.\n          w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2.\n              w \\<in> ws' \\<otimes> w3) \\<Longrightarrow>\n       \\<forall>w1 ws w2 w3.\n          a # w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2. a # w \\<in> ws' \\<otimes> w3)", "case Nil"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>w1 ws w2 w3.\n       [] \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n       (\\<exists>ws'\\<in>w1 \\<otimes> w2. [] \\<in> ws' \\<otimes> w3)\n 2. \\<And>a w.\n       \\<forall>w1 ws w2 w3.\n          w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2.\n              w \\<in> ws' \\<otimes> w3) \\<Longrightarrow>\n       \\<forall>w1 ws w2 w3.\n          a # w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2. a # w \\<in> ws' \\<otimes> w3)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1 ws w2 w3.\n       [] \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n       (\\<exists>ws'\\<in>w1 \\<otimes> w2. [] \\<in> ws' \\<otimes> w3)", "by (auto)"], ["proof (state)\nthis:\n  \\<forall>w1 ws w2 w3.\n     [] \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. [] \\<in> ws' \\<otimes> w3)\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1 ws w2 w3.\n          w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2.\n              w \\<in> ws' \\<otimes> w3) \\<Longrightarrow>\n       \\<forall>w1 ws w2 w3.\n          a # w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2. a # w \\<in> ws' \\<otimes> w3)", "case (Cons e w)"], ["proof (state)\nthis:\n  \\<forall>w1 ws w2 w3.\n     w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1 ws w2 w3.\n          w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2.\n              w \\<in> ws' \\<otimes> w3) \\<Longrightarrow>\n       \\<forall>w1 ws w2 w3.\n          a # w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2. a # w \\<in> ws' \\<otimes> w3)", "assume IH: \"ALL w1 ws w2 w3 . w\\<in>w1\\<otimes>ws & ws\\<in>w2\\<otimes>w3 \\<longrightarrow> (EX ws' : w1\\<otimes>w2 . w \\<in> ws'\\<otimes>w3)\""], ["proof (state)\nthis:\n  \\<forall>w1 ws w2 w3.\n     w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1 ws w2 w3.\n          w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2.\n              w \\<in> ws' \\<otimes> w3) \\<Longrightarrow>\n       \\<forall>w1 ws w2 w3.\n          a # w \\<in> w1 \\<otimes> ws \\<and>\n          ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n          (\\<exists>ws'\\<in>w1 \\<otimes> w2. a # w \\<in> ws' \\<otimes> w3)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n       (\\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3)", "proof (intro impI allI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "fix w1 ws w2 w3"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "assume A: \"e#w \\<in> w1 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w3\""], ["proof (state)\nthis:\n  e # w \\<in> w1 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "then"], ["proof (chain)\npicking this:\n  e # w \\<in> w1 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w3", "obtain wh where CASES: \"w1=e#wh & w\\<in>wh\\<otimes>ws | ws=e#wh & w\\<in>w1\\<otimes>wh\""], ["proof (prove)\nusing this:\n  e # w \\<in> w1 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w3\n\ngoal (1 subgoal):\n 1. (\\<And>wh.\n        w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<or>\n        ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (blast dest!: cons_interleave_split)"], ["proof (state)\nthis:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<or>\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "moreover"], ["proof (state)\nthis:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<or>\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "{"], ["proof (state)\nthis:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<or>\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "assume CASE: \"w1=e#wh & w\\<in>wh\\<otimes>ws\""], ["proof (state)\nthis:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "with A IH"], ["proof (chain)\npicking this:\n  e # w \\<in> w1 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w3\n  \\<forall>w1 ws w2 w3.\n     w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws", "obtain ws' where \"ws'\\<in>wh\\<otimes>w2 & w\\<in>ws'\\<otimes>w3\""], ["proof (prove)\nusing this:\n  e # w \\<in> w1 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w3\n  \\<forall>w1 ws w2 w3.\n     w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws\n\ngoal (1 subgoal):\n 1. (\\<And>ws'.\n        ws' \\<in> wh \\<otimes> w2 \\<and>\n        w \\<in> ws' \\<otimes> w3 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (blast)"], ["proof (state)\nthis:\n  ws' \\<in> wh \\<otimes> w2 \\<and> w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "hence \"e#ws'\\<in> (e#wh)\\<otimes>w2 & e#w \\<in> (e#ws')\\<otimes>w3\""], ["proof (prove)\nusing this:\n  ws' \\<in> wh \\<otimes> w2 \\<and> w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. e # ws' \\<in> e # wh \\<otimes> w2 \\<and>\n    e # w \\<in> e # ws' \\<otimes> w3", "by (auto simp add: interleave_cons)"], ["proof (state)\nthis:\n  e # ws' \\<in> e # wh \\<otimes> w2 \\<and> e # w \\<in> e # ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "with CASE"], ["proof (chain)\npicking this:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws\n  e # ws' \\<in> e # wh \\<otimes> w2 \\<and> e # w \\<in> e # ws' \\<otimes> w3", "have \"\\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\""], ["proof (prove)\nusing this:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws\n  e # ws' \\<in> e # wh \\<otimes> w2 \\<and> e # w \\<in> e # ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "by blast"], ["proof (state)\nthis:\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "}"], ["proof (state)\nthis:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "moreover"], ["proof (state)\nthis:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "{"], ["proof (state)\nthis:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "assume CASE: \"ws=e#wh & w\\<in>w1\\<otimes>wh\""], ["proof (state)\nthis:\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "with A"], ["proof (chain)\npicking this:\n  e # w \\<in> w1 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w3\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh", "obtain whh where \"w2=e#whh & wh\\<in>whh\\<otimes>w3 | w3=e#whh & wh\\<in>w2\\<otimes>whh\""], ["proof (prove)\nusing this:\n  e # w \\<in> w1 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w3\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n\ngoal (1 subgoal):\n 1. (\\<And>whh.\n        w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<or>\n        w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (blast dest!: cons_interleave_split)"], ["proof (state)\nthis:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<or>\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "moreover"], ["proof (state)\nthis:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<or>\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "{"], ["proof (state)\nthis:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<or>\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "assume SCASE: \"w2=e#whh & wh\\<in>whh\\<otimes>w3\""], ["proof (state)\nthis:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "with CASE IH"], ["proof (chain)\npicking this:\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n  \\<forall>w1 ws w2 w3.\n     w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3", "obtain ws' where \"ws'\\<in>w1\\<otimes>whh & w\\<in>ws'\\<otimes>w3\""], ["proof (prove)\nusing this:\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n  \\<forall>w1 ws w2 w3.\n     w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3\n\ngoal (1 subgoal):\n 1. (\\<And>ws'.\n        ws' \\<in> w1 \\<otimes> whh \\<and>\n        w \\<in> ws' \\<otimes> w3 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ws' \\<in> w1 \\<otimes> whh \\<and> w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "with SCASE"], ["proof (chain)\npicking this:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3\n  ws' \\<in> w1 \\<otimes> whh \\<and> w \\<in> ws' \\<otimes> w3", "have \"e#ws'\\<in>w1\\<otimes>w2 & e#w \\<in> (e#ws')\\<otimes>w3\""], ["proof (prove)\nusing this:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3\n  ws' \\<in> w1 \\<otimes> whh \\<and> w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. e # ws' \\<in> w1 \\<otimes> w2 \\<and> e # w \\<in> e # ws' \\<otimes> w3", "by (auto simp add: interleave_cons)"], ["proof (state)\nthis:\n  e # ws' \\<in> w1 \\<otimes> w2 \\<and> e # w \\<in> e # ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "hence \"\\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\""], ["proof (prove)\nusing this:\n  e # ws' \\<in> w1 \\<otimes> w2 \\<and> e # w \\<in> e # ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "by blast"], ["proof (state)\nthis:\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "}"], ["proof (state)\nthis:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "moreover"], ["proof (state)\nthis:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "{"], ["proof (state)\nthis:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "assume SCASE: \"w3=e#whh & wh\\<in>w2\\<otimes>whh\""], ["proof (state)\nthis:\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "with CASE IH"], ["proof (chain)\npicking this:\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n  \\<forall>w1 ws w2 w3.\n     w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh", "obtain ws' where \"ws'\\<in>w1\\<otimes>w2 & w\\<in>ws'\\<otimes>whh\""], ["proof (prove)\nusing this:\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n  \\<forall>w1 ws w2 w3.\n     w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. w \\<in> ws' \\<otimes> w3)\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n\ngoal (1 subgoal):\n 1. (\\<And>ws'.\n        ws' \\<in> w1 \\<otimes> w2 \\<and>\n        w \\<in> ws' \\<otimes> whh \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ws' \\<in> w1 \\<otimes> w2 \\<and> w \\<in> ws' \\<otimes> whh\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "with SCASE"], ["proof (chain)\npicking this:\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n  ws' \\<in> w1 \\<otimes> w2 \\<and> w \\<in> ws' \\<otimes> whh", "have \"ws'\\<in>w1\\<otimes>w2 & e#w \\<in> ws'\\<otimes>w3\""], ["proof (prove)\nusing this:\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n  ws' \\<in> w1 \\<otimes> w2 \\<and> w \\<in> ws' \\<otimes> whh\n\ngoal (1 subgoal):\n 1. ws' \\<in> w1 \\<otimes> w2 \\<and> e # w \\<in> ws' \\<otimes> w3", "by (auto simp add: interleave_cons)"], ["proof (state)\nthis:\n  ws' \\<in> w1 \\<otimes> w2 \\<and> e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "hence \"\\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\""], ["proof (prove)\nusing this:\n  ws' \\<in> w1 \\<otimes> w2 \\<and> e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "by blast"], ["proof (state)\nthis:\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "}"], ["proof (state)\nthis:\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "ultimately"], ["proof (chain)\npicking this:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<or>\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "have \"\\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\""], ["proof (prove)\nusing this:\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<or>\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh\n  w2 = e # whh \\<and> wh \\<in> whh \\<otimes> w3 \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n  w3 = e # whh \\<and> wh \\<in> w2 \\<otimes> whh \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "by blast"], ["proof (state)\nthis:\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "}"], ["proof (state)\nthis:\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<And>w1 ws w2 w3.\n       e # w \\<in> w1 \\<otimes> ws \\<and>\n       ws \\<in> w2 \\<otimes> w3 \\<Longrightarrow>\n       \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "ultimately"], ["proof (chain)\npicking this:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<or>\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "show \"\\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\""], ["proof (prove)\nusing this:\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<or>\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh\n  w1 = e # wh \\<and> w \\<in> wh \\<otimes> ws \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n  ws = e # wh \\<and> w \\<in> w1 \\<otimes> wh \\<Longrightarrow>\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal (1 subgoal):\n 1. \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3", "by blast"], ["proof (state)\nthis:\n  \\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>w1 ws w2 w3.\n     e # w \\<in> w1 \\<otimes> ws \\<and>\n     ws \\<in> w2 \\<otimes> w3 \\<longrightarrow>\n     (\\<exists>ws'\\<in>w1 \\<otimes> w2. e # w \\<in> ws' \\<otimes> w3)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma interleave_s_assoc2: \"\\<lbrakk>w\\<in>ws\\<otimes>w3; ws\\<in>w1\\<otimes>w2\\<rbrakk> \\<Longrightarrow> EX ws' : w2\\<otimes>w3 . w \\<in> w1\\<otimes>ws'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> ws \\<otimes> w3; ws \\<in> w1 \\<otimes> w2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ws'\\<in>w2 \\<otimes> w3.\n                         w \\<in> w1 \\<otimes> ws'", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> ws \\<otimes> w3; ws \\<in> w1 \\<otimes> w2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ws'\\<in>w2 \\<otimes> w3.\n                         w \\<in> w1 \\<otimes> ws'", "assume \"w \\<in> ws \\<otimes> w3\" \"ws \\<in> w1 \\<otimes> w2\""], ["proof (state)\nthis:\n  w \\<in> ws \\<otimes> w3\n  ws \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> ws \\<otimes> w3; ws \\<in> w1 \\<otimes> w2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ws'\\<in>w2 \\<otimes> w3.\n                         w \\<in> w1 \\<otimes> ws'", "hence \"w \\<in> w3 \\<otimes> ws & ws \\<in> w2 \\<otimes> w1\""], ["proof (prove)\nusing this:\n  w \\<in> ws \\<otimes> w3\n  ws \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. w \\<in> w3 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w1", "by simp"], ["proof (state)\nthis:\n  w \\<in> w3 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> ws \\<otimes> w3; ws \\<in> w1 \\<otimes> w2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ws'\\<in>w2 \\<otimes> w3.\n                         w \\<in> w1 \\<otimes> ws'", "hence \"EX ws':w3\\<otimes>w2 . w\\<in>ws'\\<otimes>w1\""], ["proof (prove)\nusing this:\n  w \\<in> w3 \\<otimes> ws \\<and> ws \\<in> w2 \\<otimes> w1\n\ngoal (1 subgoal):\n 1. \\<exists>ws'\\<in>w3 \\<otimes> w2. w \\<in> ws' \\<otimes> w1", "by (simp only: interleave_s_assoc1)"], ["proof (state)\nthis:\n  \\<exists>ws'\\<in>w3 \\<otimes> w2. w \\<in> ws' \\<otimes> w1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> ws \\<otimes> w3; ws \\<in> w1 \\<otimes> w2\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ws'\\<in>w2 \\<otimes> w3.\n                         w \\<in> w1 \\<otimes> ws'", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>ws'\\<in>w3 \\<otimes> w2. w \\<in> ws' \\<otimes> w1\n\ngoal (1 subgoal):\n 1. \\<exists>ws'\\<in>w2 \\<otimes> w3. w \\<in> w1 \\<otimes> ws'", "by simp"], ["proof (state)\nthis:\n  \\<exists>ws'\\<in>w2 \\<otimes> w3. w \\<in> w1 \\<otimes> ws'\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas interleave_s_assoc = interleave_s_assoc1 interleave_s_assoc2"], ["", "subsubsection \"Relation to other standard list operations\""], ["", "lemma interleave_set: \"w\\<in>w1\\<otimes>w2 \\<Longrightarrow> set w = set w1 \\<union> set w2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2 \\<Longrightarrow> set w = set w1 \\<union> set w2", "by (induct rule: interleave_elem_induct) auto"], ["", "lemma interleave_map: \"w\\<in>w1\\<otimes>w2 \\<Longrightarrow> map f w \\<in> map f w1 \\<otimes> map f w2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n    map f w \\<in> map f w1 \\<otimes> map f w2", "by (induct rule: interleave_elem_induct) (auto intro!: interleave_cons)"], ["", "lemma interleave_filter: \"w\\<in>w1\\<otimes>w2 \\<Longrightarrow> filter f w \\<in> filter f w1 \\<otimes> filter f w2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n    filter f w \\<in> filter f w1 \\<otimes> filter f w2", "by (induct rule: interleave_elem_induct) (auto intro!: interleave_cons)"], ["", "subsubsection \"Relation to sublist order\""], ["", "lemma ileq_interleave_alt: \"l'\\<preceq>l == \\<exists>lb. l\\<in>lb \\<otimes> l'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l' \\<preceq> l \\<equiv> \\<exists>lb. l \\<in> lb \\<otimes> l'", "proof (rule eq_reflection)"], ["proof (state)\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "fix l' l"], ["proof (state)\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "have \"l'\\<preceq>l \\<Longrightarrow> \\<exists>lb. l\\<in>lb \\<otimes> l'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l' \\<preceq> l \\<Longrightarrow> \\<exists>lb. l \\<in> lb \\<otimes> l'", "by (induct rule: less_eq_list_induct) (simp, (blast intro: interleave_cons)+)"], ["proof (state)\nthis:\n  l' \\<preceq> l \\<Longrightarrow> \\<exists>lb. l \\<in> lb \\<otimes> l'\n\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "}"], ["proof (state)\nthis:\n  ?l'a2 \\<preceq> ?la2 \\<Longrightarrow>\n  \\<exists>lb. ?la2 \\<in> lb \\<otimes> ?l'a2\n\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "moreover"], ["proof (state)\nthis:\n  ?l'a2 \\<preceq> ?la2 \\<Longrightarrow>\n  \\<exists>lb. ?la2 \\<in> lb \\<otimes> ?l'a2\n\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "{"], ["proof (state)\nthis:\n  ?l'a2 \\<preceq> ?la2 \\<Longrightarrow>\n  \\<exists>lb. ?la2 \\<in> lb \\<otimes> ?l'a2\n\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "fix l"], ["proof (state)\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "have \"!!lb l'. l\\<in>lb\\<otimes>l' \\<Longrightarrow> l'\\<preceq>l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>lb l'. l \\<in> lb \\<otimes> l' \\<Longrightarrow> l' \\<preceq> l", "by (induct l) (auto intro: less_eq_list_drop elim!: cons_interleave_cases)"], ["proof (state)\nthis:\n  l \\<in> ?lb \\<otimes> ?l' \\<Longrightarrow> ?l' \\<preceq> l\n\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "}"], ["proof (state)\nthis:\n  ?la3 \\<in> ?lb \\<otimes> ?l' \\<Longrightarrow> ?l' \\<preceq> ?la3\n\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "ultimately"], ["proof (chain)\npicking this:\n  ?l'a2 \\<preceq> ?la2 \\<Longrightarrow>\n  \\<exists>lb. ?la2 \\<in> lb \\<otimes> ?l'a2\n  ?la3 \\<in> ?lb \\<otimes> ?l' \\<Longrightarrow> ?l' \\<preceq> ?la3", "show \"(l'\\<preceq>l) = (\\<exists>lb. l\\<in>lb \\<otimes> l')\""], ["proof (prove)\nusing this:\n  ?l'a2 \\<preceq> ?la2 \\<Longrightarrow>\n  \\<exists>lb. ?la2 \\<in> lb \\<otimes> ?l'a2\n  ?la3 \\<in> ?lb \\<otimes> ?l' \\<Longrightarrow> ?l' \\<preceq> ?la3\n\ngoal (1 subgoal):\n 1. (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')", "by blast"], ["proof (state)\nthis:\n  (l' \\<preceq> l) = (\\<exists>lb. l \\<in> lb \\<otimes> l')\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ileq_interleave: \"w\\<in>w1\\<otimes>w2 \\<Longrightarrow> w1\\<preceq>w & w2\\<preceq>w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n    w1 \\<preceq> w \\<and> w2 \\<preceq> w", "by (unfold ileq_interleave_alt, auto)"], ["", "lemma ilt_ex_notempty: \"x < y \\<longleftrightarrow> (\\<exists>xs. xs \\<noteq> [] \\<and> y \\<in> xs \\<otimes> x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<prec> y) =\n    (\\<exists>xs. xs \\<noteq> [] \\<and> y \\<in> xs \\<otimes> x)", "apply (auto simp add: order_less_le ileq_interleave_alt)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>lb.\n       \\<lbrakk>x \\<noteq> y; y \\<in> lb \\<otimes> x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xs.\n                            xs \\<noteq> [] \\<and> y \\<in> xs \\<otimes> x", "apply (case_tac lb)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>lb.\n       \\<lbrakk>x \\<noteq> y; y \\<in> lb \\<otimes> x; lb = []\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xs.\n                            xs \\<noteq> [] \\<and> y \\<in> xs \\<otimes> x\n 2. \\<And>lb a list.\n       \\<lbrakk>x \\<noteq> y; y \\<in> lb \\<otimes> x; lb = a # list\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xs.\n                            xs \\<noteq> [] \\<and> y \\<in> xs \\<otimes> x", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ilt_interleave1: \"\\<lbrakk>w\\<in>w1\\<otimes>w2; w1~=[]\\<rbrakk> \\<Longrightarrow> w2<w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> w1 \\<otimes> w2; w1 \\<noteq> []\\<rbrakk>\n    \\<Longrightarrow> w2 \\<prec> w", "by (simp only: ilt_ex_notempty, blast)"], ["", "lemma ilt_interleave2: \"\\<lbrakk>w\\<in>w1\\<otimes>w2; w2~=[]\\<rbrakk> \\<Longrightarrow> w1<w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>w \\<in> w1 \\<otimes> w2; w2 \\<noteq> []\\<rbrakk>\n    \\<Longrightarrow> w1 \\<prec> w", "by (simp only: ilt_ex_notempty interleave_comm[of w1 w2], blast)"], ["", "lemmas ilt_interleave = ilt_interleave1 ilt_interleave2"], ["", "subsubsection \"Exotic/specialized lemmas\"\n\\<comment> \\<open>Recover structure of @{text w} wrt. to structure of @{text \"w1\"}\\<close>"], ["", "lemma interleave_recover1[rule_format]: \"ALL w1a w1b w2 . w\\<in>(w1a@w1b)\\<otimes>w2 \\<longrightarrow> (EX wa wb w2a w2b . w=wa@wb & w2=w2a@w2b & wa\\<in>w1a\\<otimes>w2a & wb\\<in>w1b\\<otimes>w2b)\" \n  (is \"?P w\" is \"ALL w1a w1b w2 . ?PRE w w1a w1b w2 \\<longrightarrow> ?CONS w w1a w1b w2\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1a w1b w2.\n       w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n       (\\<exists>wa wb w2a w2b.\n           w = wa @ wb \\<and>\n           w2 = w2a @ w2b \\<and>\n           wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)", "proof (induct w)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>w1a w1b w2.\n       [] \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n       (\\<exists>wa wb w2a w2b.\n           [] = wa @ wb \\<and>\n           w2 = w2a @ w2b \\<and>\n           wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)\n 2. \\<And>a w.\n       \\<forall>w1a w1b w2.\n          w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and>\n              wb \\<in> w1b \\<otimes> w2b) \\<Longrightarrow>\n       \\<forall>w1a w1b w2.\n          a # w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              a # w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)", "case Nil"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>w1a w1b w2.\n       [] \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n       (\\<exists>wa wb w2a w2b.\n           [] = wa @ wb \\<and>\n           w2 = w2a @ w2b \\<and>\n           wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)\n 2. \\<And>a w.\n       \\<forall>w1a w1b w2.\n          w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and>\n              wb \\<in> w1b \\<otimes> w2b) \\<Longrightarrow>\n       \\<forall>w1a w1b w2.\n          a # w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              a # w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1a w1b w2.\n       [] \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n       (\\<exists>wa wb w2a w2b.\n           [] = wa @ wb \\<and>\n           w2 = w2a @ w2b \\<and>\n           wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)", "by (auto)"], ["proof (state)\nthis:\n  \\<forall>w1a w1b w2.\n     [] \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n     (\\<exists>wa wb w2a w2b.\n         [] = wa @ wb \\<and>\n         w2 = w2a @ w2b \\<and>\n         wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1a w1b w2.\n          w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and>\n              wb \\<in> w1b \\<otimes> w2b) \\<Longrightarrow>\n       \\<forall>w1a w1b w2.\n          a # w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              a # w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)", "case (Cons e w)"], ["proof (state)\nthis:\n  \\<forall>w1a w1b w2.\n     w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n     (\\<exists>waa wb w2a w2b.\n         w = waa @ wb \\<and>\n         w2 = w2a @ w2b \\<and>\n         waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1a w1b w2.\n          w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and>\n              wb \\<in> w1b \\<otimes> w2b) \\<Longrightarrow>\n       \\<forall>w1a w1b w2.\n          a # w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              a # w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)", "assume IH[rule_format]: \"?P w\""], ["proof (state)\nthis:\n  w \\<in> ?w1a @ ?w1b \\<otimes> ?w2.0 \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     w = waa @ wb \\<and>\n     ?w2.0 = w2a @ w2b \\<and>\n     waa \\<in> ?w1a \\<otimes> w2a \\<and> wb \\<in> ?w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>a w.\n       \\<forall>w1a w1b w2.\n          w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and>\n              wb \\<in> w1b \\<otimes> w2b) \\<Longrightarrow>\n       \\<forall>w1a w1b w2.\n          a # w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n          (\\<exists>wa wb w2a w2b.\n              a # w = wa @ wb \\<and>\n              w2 = w2a @ w2b \\<and>\n              wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)", "show \"?P (e#w)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n       (\\<exists>waa wb w2a w2b.\n           e # w = waa @ wb \\<and>\n           w2 = w2a @ w2b \\<and>\n           waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)", "proof (intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "fix w1a w1b w2"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "assume PRE: \"e # w \\<in> w1a @ w1b \\<otimes> w2\""], ["proof (state)\nthis:\n  e # w \\<in> w1a @ w1b \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "{"], ["proof (state)\nthis:\n  e # w \\<in> w1a @ w1b \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "assume CASE: \"w1a=[]\""], ["proof (state)\nthis:\n  w1a = []\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "with PRE"], ["proof (chain)\npicking this:\n  e # w \\<in> w1a @ w1b \\<otimes> w2\n  w1a = []", "have \"e#w=[]@(e#w) & w2=[]@w2 & []\\<in>w1a\\<otimes>[] & e#w\\<in>w1b\\<otimes>w2\""], ["proof (prove)\nusing this:\n  e # w \\<in> w1a @ w1b \\<otimes> w2\n  w1a = []\n\ngoal (1 subgoal):\n 1. e # w = [] @ e # w \\<and>\n    w2 = [] @ w2 \\<and>\n    [] \\<in> w1a \\<otimes> [] \\<and> e # w \\<in> w1b \\<otimes> w2", "by (auto)"], ["proof (state)\nthis:\n  e # w = [] @ e # w \\<and>\n  w2 = [] @ w2 \\<and>\n  [] \\<in> w1a \\<otimes> [] \\<and> e # w \\<in> w1b \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "hence \"?CONS (e#w) w1a w1b w2\""], ["proof (prove)\nusing this:\n  e # w = [] @ e # w \\<and>\n  w2 = [] @ w2 \\<and>\n  [] \\<in> w1a \\<otimes> [] \\<and> e # w \\<in> w1b \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<exists>waa wb w2a w2b.\n       e # w = waa @ wb \\<and>\n       w2 = w2a @ w2b \\<and>\n       waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "by blast"], ["proof (state)\nthis:\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "}"], ["proof (state)\nthis:\n  w1a = [] \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "moreover"], ["proof (state)\nthis:\n  w1a = [] \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "{"], ["proof (state)\nthis:\n  w1a = [] \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "assume CASE: \"w1a~=[]\""], ["proof (state)\nthis:\n  w1a \\<noteq> []\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "with PRE"], ["proof (chain)\npicking this:\n  e # w \\<in> w1a @ w1b \\<otimes> w2\n  w1a \\<noteq> []", "obtain wh where SCASES: \"w1a@w1b=e#wh & w\\<in>wh\\<otimes>w2 | w2=e#wh & w\\<in>w1a@w1b\\<otimes>wh\""], ["proof (prove)\nusing this:\n  e # w \\<in> w1a @ w1b \\<otimes> w2\n  w1a \\<noteq> []\n\ngoal (1 subgoal):\n 1. (\\<And>wh.\n        w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<or>\n        w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (blast dest: cons_interleave_split)"], ["proof (state)\nthis:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<or>\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "moreover"], ["proof (state)\nthis:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<or>\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "{"], ["proof (state)\nthis:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<or>\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "assume SCASE: \"w1a@w1b=e#wh & w\\<in>wh\\<otimes>w2\""], ["proof (state)\nthis:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "with CASE"], ["proof (chain)\npicking this:\n  w1a \\<noteq> []\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2", "obtain w1ah where W1AFMT: \"w1a=e#w1ah & w1ah@w1b=wh\""], ["proof (prove)\nusing this:\n  w1a \\<noteq> []\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2\n\ngoal (1 subgoal):\n 1. (\\<And>w1ah.\n        w1a = e # w1ah \\<and> w1ah @ w1b = wh \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (cases w1a, auto)"], ["proof (state)\nthis:\n  w1a = e # w1ah \\<and> w1ah @ w1b = wh\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "with SCASE"], ["proof (chain)\npicking this:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2\n  w1a = e # w1ah \\<and> w1ah @ w1b = wh", "have \"w\\<in>w1ah@w1b\\<otimes>w2\""], ["proof (prove)\nusing this:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2\n  w1a = e # w1ah \\<and> w1ah @ w1b = wh\n\ngoal (1 subgoal):\n 1. w \\<in> w1ah @ w1b \\<otimes> w2", "by auto"], ["proof (state)\nthis:\n  w \\<in> w1ah @ w1b \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "with IH[of w1ah w1b w2]"], ["proof (chain)\npicking this:\n  w \\<in> w1ah @ w1b \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1ah \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n  w \\<in> w1ah @ w1b \\<otimes> w2", "obtain wa wb w2a w2b where \"w=wa@wb & w2=w2a@w2b & wa\\<in>w1ah\\<otimes>w2a & wb\\<in>w1b\\<otimes>w2b\""], ["proof (prove)\nusing this:\n  w \\<in> w1ah @ w1b \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1ah \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n  w \\<in> w1ah @ w1b \\<otimes> w2\n\ngoal (1 subgoal):\n 1. (\\<And>waa wb w2a w2b.\n        w = waa @ wb \\<and>\n        w2 = w2a @ w2b \\<and>\n        waa \\<in> w1ah \\<otimes> w2a \\<and>\n        wb \\<in> w1b \\<otimes> w2b \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (blast)"], ["proof (state)\nthis:\n  w = wa @ wb \\<and>\n  w2 = w2a @ w2b \\<and>\n  wa \\<in> w1ah \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "with W1AFMT"], ["proof (chain)\npicking this:\n  w1a = e # w1ah \\<and> w1ah @ w1b = wh\n  w = wa @ wb \\<and>\n  w2 = w2a @ w2b \\<and>\n  wa \\<in> w1ah \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "have \"e#w=(e#wa)@wb & e#w\\<in>e#wa\\<otimes>wb & w2=w2a@w2b & e#wa\\<in>w1a\\<otimes>w2a & wb\\<in>w1b\\<otimes>w2b\""], ["proof (prove)\nusing this:\n  w1a = e # w1ah \\<and> w1ah @ w1b = wh\n  w = wa @ wb \\<and>\n  w2 = w2a @ w2b \\<and>\n  wa \\<in> w1ah \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. e # w = (e # wa) @ wb \\<and>\n    e # w \\<in> e # wa \\<otimes> wb \\<and>\n    w2 = w2a @ w2b \\<and>\n    e # wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "by (auto simp add: interleave_cons)"], ["proof (state)\nthis:\n  e # w = (e # wa) @ wb \\<and>\n  e # w \\<in> e # wa \\<otimes> wb \\<and>\n  w2 = w2a @ w2b \\<and>\n  e # wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "hence \"?CONS (e#w) w1a w1b w2\""], ["proof (prove)\nusing this:\n  e # w = (e # wa) @ wb \\<and>\n  e # w \\<in> e # wa \\<otimes> wb \\<and>\n  w2 = w2a @ w2b \\<and>\n  e # wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<exists>waa wb w2a w2b.\n       e # w = waa @ wb \\<and>\n       w2 = w2a @ w2b \\<and>\n       waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "by blast"], ["proof (state)\nthis:\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "}"], ["proof (state)\nthis:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "moreover"], ["proof (state)\nthis:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "{"], ["proof (state)\nthis:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "assume SCASE: \"w2=e#wh & w\\<in>w1a@w1b\\<otimes>wh\""], ["proof (state)\nthis:\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "with IH[of w1a w1b wh]"], ["proof (chain)\npicking this:\n  w \\<in> w1a @ w1b \\<otimes> wh \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     w = waa @ wb \\<and>\n     wh = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh", "obtain wa wb w2a w2b where \"w=wa@wb & wh=w2a@w2b & wa\\<in>w1a\\<otimes>w2a & wb\\<in>w1b\\<otimes>w2b\""], ["proof (prove)\nusing this:\n  w \\<in> w1a @ w1b \\<otimes> wh \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     w = waa @ wb \\<and>\n     wh = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n\ngoal (1 subgoal):\n 1. (\\<And>waa wb w2a w2b.\n        w = waa @ wb \\<and>\n        wh = w2a @ w2b \\<and>\n        waa \\<in> w1a \\<otimes> w2a \\<and>\n        wb \\<in> w1b \\<otimes> w2b \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  w = wa @ wb \\<and>\n  wh = w2a @ w2b \\<and>\n  wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "with SCASE"], ["proof (chain)\npicking this:\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n  w = wa @ wb \\<and>\n  wh = w2a @ w2b \\<and>\n  wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "have \"e#w=(e#wa)@wb & w2=(e#w2a)@w2b & e#wa\\<in>w1a\\<otimes>e#w2a & wb\\<in>w1b\\<otimes>w2b\""], ["proof (prove)\nusing this:\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n  w = wa @ wb \\<and>\n  wh = w2a @ w2b \\<and>\n  wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. e # w = (e # wa) @ wb \\<and>\n    w2 = (e # w2a) @ w2b \\<and>\n    e # wa \\<in> w1a \\<otimes> e # w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "by (auto simp add: interleave_cons)"], ["proof (state)\nthis:\n  e # w = (e # wa) @ wb \\<and>\n  w2 = (e # w2a) @ w2b \\<and>\n  e # wa \\<in> w1a \\<otimes> e # w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "hence \"?CONS (e#w) w1a w1b w2\""], ["proof (prove)\nusing this:\n  e # w = (e # wa) @ wb \\<and>\n  w2 = (e # w2a) @ w2b \\<and>\n  e # wa \\<in> w1a \\<otimes> e # w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<exists>waa wb w2a w2b.\n       e # w = waa @ wb \\<and>\n       w2 = w2a @ w2b \\<and>\n       waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "by blast"], ["proof (state)\nthis:\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "}"], ["proof (state)\nthis:\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "ultimately"], ["proof (chain)\npicking this:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<or>\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "have \"?CONS (e#w) w1a w1b w2\""], ["proof (prove)\nusing this:\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<or>\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh\n  w1a @ w1b = e # wh \\<and> w \\<in> wh \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n  w2 = e # wh \\<and> w \\<in> w1a @ w1b \\<otimes> wh \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<exists>waa wb w2a w2b.\n       e # w = waa @ wb \\<and>\n       w2 = w2a @ w2b \\<and>\n       waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "by blast"], ["proof (state)\nthis:\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "}"], ["proof (state)\nthis:\n  w1a \\<noteq> [] \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<And>w1a w1b w2.\n       e # w \\<in> w1a @ w1b \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>waa wb w2a w2b.\n          e # w = waa @ wb \\<and>\n          w2 = w2a @ w2b \\<and>\n          waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "ultimately"], ["proof (chain)\npicking this:\n  w1a = [] \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n  w1a \\<noteq> [] \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "show \"?CONS (e#w) w1a w1b w2\""], ["proof (prove)\nusing this:\n  w1a = [] \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n  w1a \\<noteq> [] \\<Longrightarrow>\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal (1 subgoal):\n 1. \\<exists>waa wb w2a w2b.\n       e # w = waa @ wb \\<and>\n       w2 = w2a @ w2b \\<and>\n       waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "by blast"], ["proof (state)\nthis:\n  \\<exists>waa wb w2a w2b.\n     e # w = waa @ wb \\<and>\n     w2 = w2a @ w2b \\<and>\n     waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>w1a w1b w2.\n     e # w \\<in> w1a @ w1b \\<otimes> w2 \\<longrightarrow>\n     (\\<exists>waa wb w2a w2b.\n         e # w = waa @ wb \\<and>\n         w2 = w2a @ w2b \\<and>\n         waa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma interleave_recover2: \"w\\<in>w1\\<otimes>(w2a@w2b) \\<Longrightarrow> EX wa wb w1a w1b . w=wa@wb & w1=w1a@w1b & wa\\<in>w1a\\<otimes>w2a & wb\\<in>w1b\\<otimes>w2b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2a @ w2b \\<Longrightarrow>\n    \\<exists>wa wb w1a w1b.\n       w = wa @ wb \\<and>\n       w1 = w1a @ w1b \\<and>\n       wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2a @ w2b \\<Longrightarrow>\n    \\<exists>wa wb w1a w1b.\n       w = wa @ wb \\<and>\n       w1 = w1a @ w1b \\<and>\n       wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "assume \"w\\<in>w1\\<otimes>(w2a@w2b)\""], ["proof (state)\nthis:\n  w \\<in> w1 \\<otimes> w2a @ w2b\n\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2a @ w2b \\<Longrightarrow>\n    \\<exists>wa wb w1a w1b.\n       w = wa @ wb \\<and>\n       w1 = w1a @ w1b \\<and>\n       wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "hence \"w\\<in>(w2a@w2b)\\<otimes>w1\""], ["proof (prove)\nusing this:\n  w \\<in> w1 \\<otimes> w2a @ w2b\n\ngoal (1 subgoal):\n 1. w \\<in> w2a @ w2b \\<otimes> w1", "by auto"], ["proof (state)\nthis:\n  w \\<in> w2a @ w2b \\<otimes> w1\n\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2a @ w2b \\<Longrightarrow>\n    \\<exists>wa wb w1a w1b.\n       w = wa @ wb \\<and>\n       w1 = w1a @ w1b \\<and>\n       wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "hence \"EX wa wb w1a w1b . w=wa@wb & w1=w1a@w1b & wa\\<in>w2a\\<otimes>w1a & wb\\<in>w2b\\<otimes>w1b\""], ["proof (prove)\nusing this:\n  w \\<in> w2a @ w2b \\<otimes> w1\n\ngoal (1 subgoal):\n 1. \\<exists>wa wb w1a w1b.\n       w = wa @ wb \\<and>\n       w1 = w1a @ w1b \\<and>\n       wa \\<in> w2a \\<otimes> w1a \\<and> wb \\<in> w2b \\<otimes> w1b", "by (blast dest: interleave_recover1)"], ["proof (state)\nthis:\n  \\<exists>wa wb w1a w1b.\n     w = wa @ wb \\<and>\n     w1 = w1a @ w1b \\<and>\n     wa \\<in> w2a \\<otimes> w1a \\<and> wb \\<in> w2b \\<otimes> w1b\n\ngoal (1 subgoal):\n 1. w \\<in> w1 \\<otimes> w2a @ w2b \\<Longrightarrow>\n    \\<exists>wa wb w1a w1b.\n       w = wa @ wb \\<and>\n       w1 = w1a @ w1b \\<and>\n       wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>wa wb w1a w1b.\n     w = wa @ wb \\<and>\n     w1 = w1a @ w1b \\<and>\n     wa \\<in> w2a \\<otimes> w1a \\<and> wb \\<in> w2b \\<otimes> w1b\n\ngoal (1 subgoal):\n 1. \\<exists>wa wb w1a w1b.\n       w = wa @ wb \\<and>\n       w1 = w1a @ w1b \\<and>\n       wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b", "by auto"], ["proof (state)\nthis:\n  \\<exists>wa wb w1a w1b.\n     w = wa @ wb \\<and>\n     w1 = w1a @ w1b \\<and>\n     wa \\<in> w1a \\<otimes> w2a \\<and> wb \\<in> w1b \\<otimes> w2b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas interleave_recover = interleave_recover1 interleave_recover2\n\n\\<comment> \\<open>Split operands according to element of result\\<close>"], ["", "lemma interleave_unconc: \"!! l2 w1 w2 . l1@l2 \\<in> w1\\<otimes>w2 \\<Longrightarrow> \\<exists> w11 w12 w21 w22 . w1=w11@w12 \\<and> w2=w21@w22 \\<and> l1\\<in>w11\\<otimes>w21 \\<and> l2\\<in>w12\\<otimes>w22\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l2 w1 w2.\n       l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>w11 w12 w21 w22.\n          w1 = w11 @ w12 \\<and>\n          w2 = w21 @ w22 \\<and>\n          l1 \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22", "proof (induct l1)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>l2 w1 w2.\n       [] @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>w11 w12 w21 w22.\n          w1 = w11 @ w12 \\<and>\n          w2 = w21 @ w22 \\<and>\n          [] \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n 2. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "case Nil"], ["proof (state)\nthis:\n  [] @ l2 \\<in> w1 \\<otimes> w2\n\ngoal (2 subgoals):\n 1. \\<And>l2 w1 w2.\n       [] @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>w11 w12 w21 w22.\n          w1 = w11 @ w12 \\<and>\n          w2 = w21 @ w22 \\<and>\n          [] \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n 2. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "hence \"w1=[]@w1 & w2=[]@w2 & []\\<in>[]\\<otimes>[] & l2\\<in>w1\\<otimes>w2\""], ["proof (prove)\nusing this:\n  [] @ l2 \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. w1 = [] @ w1 \\<and>\n    w2 = [] @ w2 \\<and>\n    [] \\<in> [] \\<otimes> [] \\<and> l2 \\<in> w1 \\<otimes> w2", "by auto"], ["proof (state)\nthis:\n  w1 = [] @ w1 \\<and>\n  w2 = [] @ w2 \\<and>\n  [] \\<in> [] \\<otimes> [] \\<and> l2 \\<in> w1 \\<otimes> w2\n\ngoal (2 subgoals):\n 1. \\<And>l2 w1 w2.\n       [] @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n       \\<exists>w11 w12 w21 w22.\n          w1 = w11 @ w12 \\<and>\n          w2 = w21 @ w22 \\<and>\n          [] \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n 2. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "thus ?case"], ["proof (prove)\nusing this:\n  w1 = [] @ w1 \\<and>\n  w2 = [] @ w2 \\<and>\n  [] \\<in> [] \\<otimes> [] \\<and> l2 \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<exists>w11 w12 w21 w22.\n       w1 = w11 @ w12 \\<and>\n       w2 = w21 @ w22 \\<and>\n       [] \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22", "by fast"], ["proof (state)\nthis:\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     [] \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "case (Cons e l1')"], ["proof (state)\nthis:\n  l1' @ ?l2.0 \\<in> ?w1.0 \\<otimes> ?w2.0 \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     ?w1.0 = w11 @ w12 \\<and>\n     ?w2.0 = w21 @ w22 \\<and>\n     l1' \\<in> w11 \\<otimes> w21 \\<and> ?l2.0 \\<in> w12 \\<otimes> w22\n  (e # l1') @ l2 \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "note IHP=this"], ["proof (state)\nthis:\n  l1' @ ?l2.0 \\<in> ?w1.0 \\<otimes> ?w2.0 \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     ?w1.0 = w11 @ w12 \\<and>\n     ?w2.0 = w21 @ w22 \\<and>\n     l1' \\<in> w11 \\<otimes> w21 \\<and> ?l2.0 \\<in> w12 \\<otimes> w22\n  (e # l1') @ l2 \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "hence \"e#(l1'@l2)\\<in>w1\\<otimes>w2\""], ["proof (prove)\nusing this:\n  l1' @ ?l2.0 \\<in> ?w1.0 \\<otimes> ?w2.0 \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     ?w1.0 = w11 @ w12 \\<and>\n     ?w2.0 = w21 @ w22 \\<and>\n     l1' \\<in> w11 \\<otimes> w21 \\<and> ?l2.0 \\<in> w12 \\<otimes> w22\n  (e # l1') @ l2 \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. e # l1' @ l2 \\<in> w1 \\<otimes> w2", "by auto"], ["proof (state)\nthis:\n  e # l1' @ l2 \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "with cons_interleave_split"], ["proof (chain)\npicking this:\n  ?a # ?l \\<in> ?l1.0 \\<otimes> ?l2.0 \\<Longrightarrow>\n  \\<exists>lh.\n     ?l1.0 = ?a # lh \\<and> ?l \\<in> lh \\<otimes> ?l2.0 \\<or>\n     ?l2.0 = ?a # lh \\<and> ?l \\<in> ?l1.0 \\<otimes> lh\n  e # l1' @ l2 \\<in> w1 \\<otimes> w2", "obtain w' where \"(w1=e#w' & l1'@l2\\<in>w'\\<otimes>w2) | (w2=e#w' & l1'@l2\\<in>w1\\<otimes>w')\" (is \"?C1 | ?C2\")"], ["proof (prove)\nusing this:\n  ?a # ?l \\<in> ?l1.0 \\<otimes> ?l2.0 \\<Longrightarrow>\n  \\<exists>lh.\n     ?l1.0 = ?a # lh \\<and> ?l \\<in> lh \\<otimes> ?l2.0 \\<or>\n     ?l2.0 = ?a # lh \\<and> ?l \\<in> ?l1.0 \\<otimes> lh\n  e # l1' @ l2 \\<in> w1 \\<otimes> w2\n\ngoal (1 subgoal):\n 1. (\\<And>w'.\n        w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<or>\n        w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (fast)"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<or>\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "moreover"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<or>\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "{"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<or>\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "assume CASE: ?C1"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "moreover"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "then"], ["proof (chain)\npicking this:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2", "obtain w11' w12' w21 w22 where \"w'=w11'@w12' \\<and> w2=w21@w22 \\<and> l1'\\<in>w11'\\<otimes>w21 \\<and> l2\\<in>w12'\\<otimes>w22\""], ["proof (prove)\nusing this:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2\n\ngoal (1 subgoal):\n 1. (\\<And>w11' w12' w21 w22.\n        w' = w11' @ w12' \\<and>\n        w2 = w21 @ w22 \\<and>\n        l1' \\<in> w11' \\<otimes> w21 \\<and>\n        l2 \\<in> w12' \\<otimes> w22 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (fast dest: IHP(1))"], ["proof (state)\nthis:\n  w' = w11' @ w12' \\<and>\n  w2 = w21 @ w22 \\<and>\n  l1' \\<in> w11' \\<otimes> w21 \\<and> l2 \\<in> w12' \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "moreover"], ["proof (state)\nthis:\n  w' = w11' @ w12' \\<and>\n  w2 = w21 @ w22 \\<and>\n  l1' \\<in> w11' \\<otimes> w21 \\<and> l2 \\<in> w12' \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "hence \"e#w'=(e#w11')@w12' & e#l1'\\<in>(e#w11')\\<otimes>w21\""], ["proof (prove)\nusing this:\n  w' = w11' @ w12' \\<and>\n  w2 = w21 @ w22 \\<and>\n  l1' \\<in> w11' \\<otimes> w21 \\<and> l2 \\<in> w12' \\<otimes> w22\n\ngoal (1 subgoal):\n 1. e # w' = (e # w11') @ w12' \\<and> e # l1' \\<in> e # w11' \\<otimes> w21", "by (auto dest: interleave_cons)"], ["proof (state)\nthis:\n  e # w' = (e # w11') @ w12' \\<and> e # l1' \\<in> e # w11' \\<otimes> w21\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "ultimately"], ["proof (chain)\npicking this:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2\n  w' = w11' @ w12' \\<and>\n  w2 = w21 @ w22 \\<and>\n  l1' \\<in> w11' \\<otimes> w21 \\<and> l2 \\<in> w12' \\<otimes> w22\n  e # w' = (e # w11') @ w12' \\<and> e # l1' \\<in> e # w11' \\<otimes> w21", "have ?case"], ["proof (prove)\nusing this:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2\n  w' = w11' @ w12' \\<and>\n  w2 = w21 @ w22 \\<and>\n  l1' \\<in> w11' \\<otimes> w21 \\<and> l2 \\<in> w12' \\<otimes> w22\n  e # w' = (e # w11') @ w12' \\<and> e # l1' \\<in> e # w11' \\<otimes> w21\n\ngoal (1 subgoal):\n 1. \\<exists>w11 w12 w21 w22.\n       w1 = w11 @ w12 \\<and>\n       w2 = w21 @ w22 \\<and>\n       e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22", "by fast"], ["proof (state)\nthis:\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "}"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "moreover"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "{"], ["proof (state)\nthis:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "assume CASE: ?C2"], ["proof (state)\nthis:\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "moreover"], ["proof (state)\nthis:\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "then"], ["proof (chain)\npicking this:\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'", "obtain w11 w12 w21' w22' where \"w1=w11@w12 \\<and> w'=w21'@w22' \\<and> l1'\\<in>w11\\<otimes>w21' \\<and> l2\\<in>w12\\<otimes>w22'\""], ["proof (prove)\nusing this:\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. (\\<And>w11 w12 w21' w22'.\n        w1 = w11 @ w12 \\<and>\n        w' = w21' @ w22' \\<and>\n        l1' \\<in> w11 \\<otimes> w21' \\<and>\n        l2 \\<in> w12 \\<otimes> w22' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (fast dest: IHP(1))"], ["proof (state)\nthis:\n  w1 = w11 @ w12 \\<and>\n  w' = w21' @ w22' \\<and>\n  l1' \\<in> w11 \\<otimes> w21' \\<and> l2 \\<in> w12 \\<otimes> w22'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "moreover"], ["proof (state)\nthis:\n  w1 = w11 @ w12 \\<and>\n  w' = w21' @ w22' \\<and>\n  l1' \\<in> w11 \\<otimes> w21' \\<and> l2 \\<in> w12 \\<otimes> w22'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "hence \"e#w'=(e#w21')@w22' & e#l1'\\<in>w11\\<otimes>(e#w21')\""], ["proof (prove)\nusing this:\n  w1 = w11 @ w12 \\<and>\n  w' = w21' @ w22' \\<and>\n  l1' \\<in> w11 \\<otimes> w21' \\<and> l2 \\<in> w12 \\<otimes> w22'\n\ngoal (1 subgoal):\n 1. e # w' = (e # w21') @ w22' \\<and> e # l1' \\<in> w11 \\<otimes> e # w21'", "by (auto dest: interleave_cons)"], ["proof (state)\nthis:\n  e # w' = (e # w21') @ w22' \\<and> e # l1' \\<in> w11 \\<otimes> e # w21'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "ultimately"], ["proof (chain)\npicking this:\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n  w1 = w11 @ w12 \\<and>\n  w' = w21' @ w22' \\<and>\n  l1' \\<in> w11 \\<otimes> w21' \\<and> l2 \\<in> w12 \\<otimes> w22'\n  e # w' = (e # w21') @ w22' \\<and> e # l1' \\<in> w11 \\<otimes> e # w21'", "have ?case"], ["proof (prove)\nusing this:\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n  w1 = w11 @ w12 \\<and>\n  w' = w21' @ w22' \\<and>\n  l1' \\<in> w11 \\<otimes> w21' \\<and> l2 \\<in> w12 \\<otimes> w22'\n  e # w' = (e # w21') @ w22' \\<and> e # l1' \\<in> w11 \\<otimes> e # w21'\n\ngoal (1 subgoal):\n 1. \\<exists>w11 w12 w21 w22.\n       w1 = w11 @ w12 \\<and>\n       w2 = w21 @ w22 \\<and>\n       e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22", "by fast"], ["proof (state)\nthis:\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "}"], ["proof (state)\nthis:\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w' \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 l2 w1 w2.\n       \\<lbrakk>\\<And>l2 w1 w2.\n                   l1 @ l2 \\<in> w1 \\<otimes> w2 \\<Longrightarrow>\n                   \\<exists>w11 w12 w21 w22.\n                      w1 = w11 @ w12 \\<and>\n                      w2 = w21 @ w22 \\<and>\n                      l1 \\<in> w11 \\<otimes> w21 \\<and>\n                      l2 \\<in> w12 \\<otimes> w22;\n        (a # l1) @ l2 \\<in> w1 \\<otimes> w2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>w11 w12 w21 w22.\n                            w1 = w11 @ w12 \\<and>\n                            w2 = w21 @ w22 \\<and>\n                            a # l1 \\<in> w11 \\<otimes> w21 \\<and>\n                            l2 \\<in> w12 \\<otimes> w22", "ultimately"], ["proof (chain)\npicking this:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<or>\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w' \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22", "show ?case"], ["proof (prove)\nusing this:\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<or>\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w'\n  w1 = e # w' \\<and> l1' @ l2 \\<in> w' \\<otimes> w2 \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n  w2 = e # w' \\<and> l1' @ l2 \\<in> w1 \\<otimes> w' \\<Longrightarrow>\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<exists>w11 w12 w21 w22.\n       w1 = w11 @ w12 \\<and>\n       w2 = w21 @ w22 \\<and>\n       e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22", "by fast"], ["proof (state)\nthis:\n  \\<exists>w11 w12 w21 w22.\n     w1 = w11 @ w12 \\<and>\n     w2 = w21 @ w22 \\<and>\n     e # l1' \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22\n\ngoal:\nNo subgoals!", "qed\n\n\\<comment> \\<open>Reverse direction of @{thm [source] \"interleave_unconc\"}\\<close>"], ["", "lemma interleave_reconc: \"!!w11 w21 l2 w12 w22 . \\<lbrakk>l1\\<in>w11\\<otimes>w21;l2\\<in>w12\\<otimes>w22\\<rbrakk> \\<Longrightarrow> l1@l2\\<in>(w11@w12)\\<otimes>(w21@w22)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w11 w21 l2 w12 w22.\n       \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n        l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> l1 @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "proof (induct l1)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>w11 w21 l2 w12 w22.\n       \\<lbrakk>[] \\<in> w11 \\<otimes> w21;\n        l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> [] @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n 2. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "case Nil"], ["proof (state)\nthis:\n  [] \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n\ngoal (2 subgoals):\n 1. \\<And>w11 w21 l2 w12 w22.\n       \\<lbrakk>[] \\<in> w11 \\<otimes> w21;\n        l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> [] @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n 2. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "thus ?case"], ["proof (prove)\nusing this:\n  [] \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. [] @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "by (auto)"], ["proof (state)\nthis:\n  [] @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "case (Cons e l1')"], ["proof (state)\nthis:\n  \\<lbrakk>l1' \\<in> ?w11.0 \\<otimes> ?w21.0;\n   ?l2.0 \\<in> ?w12.0 \\<otimes> ?w22.0\\<rbrakk>\n  \\<Longrightarrow> l1' @ ?l2.0\n                    \\<in> ?w11.0 @ ?w12.0 \\<otimes> ?w21.0 @ ?w22.0\n  e # l1' \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "note IHP=this"], ["proof (state)\nthis:\n  \\<lbrakk>l1' \\<in> ?w11.0 \\<otimes> ?w21.0;\n   ?l2.0 \\<in> ?w12.0 \\<otimes> ?w22.0\\<rbrakk>\n  \\<Longrightarrow> l1' @ ?l2.0\n                    \\<in> ?w11.0 @ ?w12.0 \\<otimes> ?w21.0 @ ?w22.0\n  e # l1' \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>l1' \\<in> ?w11.0 \\<otimes> ?w21.0;\n   ?l2.0 \\<in> ?w12.0 \\<otimes> ?w22.0\\<rbrakk>\n  \\<Longrightarrow> l1' @ ?l2.0\n                    \\<in> ?w11.0 @ ?w12.0 \\<otimes> ?w21.0 @ ?w22.0\n  e # l1' \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22", "obtain w' where \"(w11=e#w' & l1'\\<in>w'\\<otimes>w21) | (w21=e#w' & l1'\\<in>w11\\<otimes>w')\" (is \"?C1 | ?C2\")"], ["proof (prove)\nusing this:\n  \\<lbrakk>l1' \\<in> ?w11.0 \\<otimes> ?w21.0;\n   ?l2.0 \\<in> ?w12.0 \\<otimes> ?w22.0\\<rbrakk>\n  \\<Longrightarrow> l1' @ ?l2.0\n                    \\<in> ?w11.0 @ ?w12.0 \\<otimes> ?w21.0 @ ?w22.0\n  e # l1' \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n\ngoal (1 subgoal):\n 1. (\\<And>w'.\n        w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<or>\n        w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (fast dest: cons_interleave_split)"], ["proof (state)\nthis:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<or>\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "moreover"], ["proof (state)\nthis:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<or>\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "{"], ["proof (state)\nthis:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<or>\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "assume CASE: ?C1"], ["proof (state)\nthis:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "moreover"], ["proof (state)\nthis:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "with IHP"], ["proof (chain)\npicking this:\n  \\<lbrakk>l1' \\<in> ?w11.0 \\<otimes> ?w21.0;\n   ?l2.0 \\<in> ?w12.0 \\<otimes> ?w22.0\\<rbrakk>\n  \\<Longrightarrow> l1' @ ?l2.0\n                    \\<in> ?w11.0 @ ?w12.0 \\<otimes> ?w21.0 @ ?w22.0\n  e # l1' \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21", "have \"l1'@l2\\<in>(w'@w12)\\<otimes>(w21@w22)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>l1' \\<in> ?w11.0 \\<otimes> ?w21.0;\n   ?l2.0 \\<in> ?w12.0 \\<otimes> ?w22.0\\<rbrakk>\n  \\<Longrightarrow> l1' @ ?l2.0\n                    \\<in> ?w11.0 @ ?w12.0 \\<otimes> ?w21.0 @ ?w22.0\n  e # l1' \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21\n\ngoal (1 subgoal):\n 1. l1' @ l2 \\<in> w' @ w12 \\<otimes> w21 @ w22", "by auto"], ["proof (state)\nthis:\n  l1' @ l2 \\<in> w' @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "ultimately"], ["proof (chain)\npicking this:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21\n  l1' @ l2 \\<in> w' @ w12 \\<otimes> w21 @ w22", "have ?case"], ["proof (prove)\nusing this:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21\n  l1' @ l2 \\<in> w' @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "by (auto dest: interleave_cons)"], ["proof (state)\nthis:\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "}"], ["proof (state)\nthis:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<Longrightarrow>\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "moreover"], ["proof (state)\nthis:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<Longrightarrow>\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "{"], ["proof (state)\nthis:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<Longrightarrow>\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "assume CASE: ?C2"], ["proof (state)\nthis:\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "moreover"], ["proof (state)\nthis:\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "with IHP"], ["proof (chain)\npicking this:\n  \\<lbrakk>l1' \\<in> ?w11.0 \\<otimes> ?w21.0;\n   ?l2.0 \\<in> ?w12.0 \\<otimes> ?w22.0\\<rbrakk>\n  \\<Longrightarrow> l1' @ ?l2.0\n                    \\<in> ?w11.0 @ ?w12.0 \\<otimes> ?w21.0 @ ?w22.0\n  e # l1' \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'", "have \"l1'@l2\\<in>(w11@w12)\\<otimes>(w'@w22)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>l1' \\<in> ?w11.0 \\<otimes> ?w21.0;\n   ?l2.0 \\<in> ?w12.0 \\<otimes> ?w22.0\\<rbrakk>\n  \\<Longrightarrow> l1' @ ?l2.0\n                    \\<in> ?w11.0 @ ?w12.0 \\<otimes> ?w21.0 @ ?w22.0\n  e # l1' \\<in> w11 \\<otimes> w21\n  l2 \\<in> w12 \\<otimes> w22\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n\ngoal (1 subgoal):\n 1. l1' @ l2 \\<in> w11 @ w12 \\<otimes> w' @ w22", "by auto"], ["proof (state)\nthis:\n  l1' @ l2 \\<in> w11 @ w12 \\<otimes> w' @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "ultimately"], ["proof (chain)\npicking this:\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n  l1' @ l2 \\<in> w11 @ w12 \\<otimes> w' @ w22", "have ?case"], ["proof (prove)\nusing this:\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n  l1' @ l2 \\<in> w11 @ w12 \\<otimes> w' @ w22\n\ngoal (1 subgoal):\n 1. (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "by (auto dest: interleave_cons)"], ["proof (state)\nthis:\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "}"], ["proof (state)\nthis:\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w' \\<Longrightarrow>\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. \\<And>a l1 w11 w21 l2 w12 w22.\n       \\<lbrakk>\\<And>w11 w21 l2 w12 w22.\n                   \\<lbrakk>l1 \\<in> w11 \\<otimes> w21;\n                    l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n                   \\<Longrightarrow> l1 @ l2\n                                     \\<in> w11 @ w12 \\<otimes> w21 @ w22;\n        a # l1 \\<in> w11 \\<otimes> w21; l2 \\<in> w12 \\<otimes> w22\\<rbrakk>\n       \\<Longrightarrow> (a # l1) @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "ultimately"], ["proof (chain)\npicking this:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<or>\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<Longrightarrow>\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w' \\<Longrightarrow>\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "show ?case"], ["proof (prove)\nusing this:\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<or>\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w'\n  w11 = e # w' \\<and> l1' \\<in> w' \\<otimes> w21 \\<Longrightarrow>\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n  w21 = e # w' \\<and> l1' \\<in> w11 \\<otimes> w' \\<Longrightarrow>\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal (1 subgoal):\n 1. (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22", "by fast"], ["proof (state)\nthis:\n  (e # l1') @ l2 \\<in> w11 @ w12 \\<otimes> w21 @ w22\n\ngoal:\nNo subgoals!", "qed"], ["", "(* interleave_unconc and interleave_reconc as equivalence *)"], ["", "lemma interleave_unconc_eq: \"!! l2 w1 w2 . l1@l2 \\<in> w1\\<otimes>w2 = (\\<exists> w11 w12 w21 w22 . w1=w11@w12 \\<and> w2=w21@w22 \\<and> l1\\<in>w11\\<otimes>w21 \\<and> l2\\<in>w12\\<otimes>w22)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l2 w1 w2.\n       (l1 @ l2 \\<in> w1 \\<otimes> w2) =\n       (\\<exists>w11 w12 w21 w22.\n           w1 = w11 @ w12 \\<and>\n           w2 = w21 @ w22 \\<and>\n           l1 \\<in> w11 \\<otimes> w21 \\<and> l2 \\<in> w12 \\<otimes> w22)", "by (fast dest: interleave_reconc interleave_unconc)"], ["", "end"]]}