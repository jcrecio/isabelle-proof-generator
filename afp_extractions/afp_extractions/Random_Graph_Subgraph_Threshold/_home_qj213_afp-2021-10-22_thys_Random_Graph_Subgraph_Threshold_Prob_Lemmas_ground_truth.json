{"file_name": "/home/qj213/afp-2021-10-22/thys/Random_Graph_Subgraph_Threshold/Prob_Lemmas.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Random_Graph_Subgraph_Threshold", "problem_names": ["lemma product_indicator:\n  \"rind A x * rind B x = rind (A \\<inter> B) x\"", "lemma nonzero_fun_is_valid_fun: \"nonzero_prob_fun f \\<Longrightarrow> valid_prob_fun f\"", "lemma expectation_indicator:\n  \"A \\<in> events \\<Longrightarrow> expectation (rind A) = prob A\"", "lemma markov_inequality:\n  assumes \"\\<And>a. 0 \\<le> X a\" and \"integrable M X\" \"0 < t\"\n  shows \"prob {a \\<in> space M. t \\<le> X a} \\<le> expectation X / t\"", "lemma variance_expectation:\n  fixes X :: \"'a \\<Rightarrow> real\"\n  assumes \"integrable M (\\<lambda>x. (X x)^2)\" and \"X \\<in> borel_measurable M\"\n  shows\n    \"integrable M (\\<lambda>x. (X x - expectation X)^2)\" (is ?integrable)\n    \"variance X = expectation (\\<lambda>x. (X x)^2) - (expectation X)^2\" (is ?variance)", "lemma chebyshev_inequality:\n  fixes Y :: \"'a \\<Rightarrow> real\"\n  assumes Y_int: \"integrable M (\\<lambda>y. (Y y)^2)\"\n  assumes Y_borel: \"Y \\<in> borel_measurable M\"\n  fixes s :: \"real\"\n  assumes s_pos: \"0 < s\"\n  shows \"prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>} \\<le> variance Y / s^2\"", "lemma \\<Delta>_zero:\n  assumes \"\\<And>i j. i \\<in> I \\<Longrightarrow> j \\<in> I \\<Longrightarrow> i \\<noteq> j \\<Longrightarrow> indep (A i) (A j)\"\n  shows \"\\<Delta>\\<^sub>d = 0\"", "lemma A_events[measurable]: \"i \\<in> I \\<Longrightarrow> A i \\<in> events\"", "lemma expectation_X_Y: \"\\<mu> = (\\<Sum>i\\<in>I. expectation (X i))\"", "lemma expectation_X_non_zero: \"\\<exists>i \\<in> I. 0 < expectation (X i)\"", "lemma \\<Delta>\\<^sub>d_nonneg: \"0 \\<le> \\<Delta>\\<^sub>d\"", "lemma Y_square_unfold: \"(\\<lambda>x. (Y x)^2) = (\\<lambda>x. \\<Sum>i \\<in> I. \\<Sum>j \\<in> I. rind (A i \\<inter> A j) x)\"", "lemma integrable_Y_sq[simp]: \"integrable M (\\<lambda>y. (Y y)^2)\"", "lemma measurable_Y[measurable]: \"Y \\<in> borel_measurable M\"", "lemma expectation_Y_\\<Delta>: \"expectation (\\<lambda>x. (Y x)^2) = \\<mu> + \\<Delta>\\<^sub>a\"", "lemma \\<Delta>_expectation_X: \"\\<Delta>\\<^sub>a \\<le> \\<mu>^2 + \\<Delta>\\<^sub>d\"", "lemma prob_\\<mu>_\\<Delta>\\<^sub>a: \"prob {a \\<in> space M. Y a = 0} \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>^2 - 1\"", "lemma prob_\\<mu>_\\<Delta>\\<^sub>d: \"prob {a \\<in> space M. Y a = 0} \\<le> 1/\\<mu> + \\<Delta>\\<^sub>d/\\<mu>^2\""], "translations": [["", "lemma product_indicator:\n  \"rind A x * rind B x = rind (A \\<inter> B) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rind A x * rind B x = rind (A \\<inter> B) x", "unfolding indicator_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if x \\<in> A then 1 else 0) * (if x \\<in> B then 1 else 0) =\n    (if x \\<in> A \\<inter> B then 1 else 0)", "by auto"], ["", "text\\<open>We call a real number `valid' iff it is in the range 0 to 1, inclusively, and additionally\n`nonzero' iff it is neither 0 nor 1.\\<close>"], ["", "abbreviation \"valid_prob (p :: real) \\<equiv> 0 \\<le> p \\<and> p \\<le> 1\""], ["", "abbreviation \"nonzero_prob (p :: real) \\<equiv> 0 < p \\<and> p < 1\""], ["", "text\\<open>A function @{typ \"'a \\<Rightarrow> real\"} is a `valid probability function' iff each value in the image\nis valid, and similarly for `nonzero'.\\<close>"], ["", "abbreviation \"valid_prob_fun f \\<equiv> (\\<forall>n. valid_prob (f n))\""], ["", "abbreviation \"nonzero_prob_fun f \\<equiv> (\\<forall>n. nonzero_prob (f n))\""], ["", "lemma nonzero_fun_is_valid_fun: \"nonzero_prob_fun f \\<Longrightarrow> valid_prob_fun f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. nonzero_prob_fun f \\<Longrightarrow> valid_prob_fun f", "by (simp add: less_imp_le)"], ["", "subsection\\<open>Expectation and variance\\<close>"], ["", "context prob_space\nbegin"], ["", "text\\<open>Note that there is already a notion of independent sets (see @{term indep_set}), but we use\nthe following -- simpler -- definition:\\<close>"], ["", "definition \"indep A B \\<longleftrightarrow> prob (A \\<inter> B) = prob A * prob B\""], ["", "text\\<open>The probability of an indicator variable is equal to its expectation:\\<close>"], ["", "lemma expectation_indicator:\n  \"A \\<in> events \\<Longrightarrow> expectation (rind A) = prob A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> events \\<Longrightarrow> expectation (rind A) = prob A", "by simp"], ["", "text\\<open>For a non-negative random variable @{term X}, the Markov inequality gives the following\nupper bound: \\[ \\Pr[X \\ge a] \\le \\frac{\\Ex[X]}{a} \\]\\<close>"], ["", "lemma markov_inequality:\n  assumes \"\\<And>a. 0 \\<le> X a\" and \"integrable M X\" \"0 < t\"\n  shows \"prob {a \\<in> space M. t \\<le> X a} \\<le> expectation X / t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. t \\<le> X a} \\<le> expectation X / t", "proof -\n  \\<comment> \\<open>proof adapted from @{thm [source] edge_space.Markov_inequality}, but generalized to arbitrary\n       @{term prob_space}s\\<close>"], ["proof (state)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. t \\<le> X a} \\<le> expectation X / t", "have \"(\\<integral>\\<^sup>+ x. ennreal (X x) \\<partial>M) = (\\<integral>x. X x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (X x) \\<partial>M =\n    ennreal (expectation X)", "using assms"], ["proof (prove)\nusing this:\n  0 \\<le> X ?a12\n  integrable M X\n  0 < t\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (X x) \\<partial>M =\n    ennreal (expectation X)", "by (intro nn_integral_eq_integral) auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (X x) \\<partial>M = ennreal (expectation X)\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. t \\<le> X a} \\<le> expectation X / t", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal (X x) \\<partial>M = ennreal (expectation X)\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. t \\<le> X a} \\<le> expectation X / t", "using assms nn_integral_Markov_inequality[of X M \"space M\" \"1 / t\"]"], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal (X x) \\<partial>M = ennreal (expectation X)\n  0 \\<le> X ?a12\n  integrable M X\n  0 < t\n  \\<lbrakk>random_variable borel (\\<lambda>x. ennreal (X x));\n   space M \\<in> events\\<rbrakk>\n  \\<Longrightarrow> emeasure M\n                     ({x \\<in> space M.\n                       1 \\<le> ennreal (1 / t) * ennreal (X x)} \\<inter>\n                      space M)\n                    \\<le> ennreal (1 / t) *\n                          (\\<integral>\\<^sup>+x\\<in>space M. ennreal (X x)\n                           \\<partial>M)\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. t \\<le> X a} \\<le> expectation X / t", "by (auto cong: nn_integral_cong simp: emeasure_eq_measure ennreal_mult[symmetric])"], ["proof (state)\nthis:\n  prob {a \\<in> space M. t \\<le> X a} \\<le> expectation X / t\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>$\\Var[X] = \\Ex[X^2] - \\Ex[X]^2 $\\<close>"], ["", "lemma variance_expectation:\n  fixes X :: \"'a \\<Rightarrow> real\"\n  assumes \"integrable M (\\<lambda>x. (X x)^2)\" and \"X \\<in> borel_measurable M\"\n  shows\n    \"integrable M (\\<lambda>x. (X x - expectation X)^2)\" (is ?integrable)\n    \"variance X = expectation (\\<lambda>x. (X x)^2) - (expectation X)^2\" (is ?variance)"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2) &&&\n    expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    expectation (\\<lambda>x. (X x)\\<^sup>2) - (expectation X)\\<^sup>2", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)\n 2. expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    expectation (\\<lambda>x. (X x)\\<^sup>2) - (expectation X)\\<^sup>2", "have int: \"integrable M X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M X", "using integrable_squareD[OF assms]"], ["proof (prove)\nusing this:\n  integrable M X\n\ngoal (1 subgoal):\n 1. integrable M X", "by simp"], ["proof (state)\nthis:\n  integrable M X\n\ngoal (2 subgoals):\n 1. integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)\n 2. expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    expectation (\\<lambda>x. (X x)\\<^sup>2) - (expectation X)\\<^sup>2", "have \"(\\<lambda>x. (X x - expectation X)^2) = (\\<lambda>x. (X x)^2 + (expectation X)^2 - (2 * X x * expectation X))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    (\\<lambda>x.\n        (X x)\\<^sup>2 + (expectation X)\\<^sup>2 - 2 * X x * expectation X)", "by (simp only: power2_diff)"], ["proof (state)\nthis:\n  (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n  (\\<lambda>x.\n      (X x)\\<^sup>2 + (expectation X)\\<^sup>2 - 2 * X x * expectation X)\n\ngoal (2 subgoals):\n 1. integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)\n 2. expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    expectation (\\<lambda>x. (X x)\\<^sup>2) - (expectation X)\\<^sup>2", "hence\n    \"variance X = expectation (\\<lambda>x. (X x)^2) + (expectation X)^2 + expectation (\\<lambda>x. - (2 * X x * expectation X))\"\n    ?integrable"], ["proof (prove)\nusing this:\n  (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n  (\\<lambda>x.\n      (X x)\\<^sup>2 + (expectation X)\\<^sup>2 - 2 * X x * expectation X)\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    expectation (\\<lambda>x. (X x)\\<^sup>2) + (expectation X)\\<^sup>2 +\n    expectation (\\<lambda>x. - (2 * X x * expectation X)) &&&\n    integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)", "using integral_add"], ["proof (prove)\nusing this:\n  (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n  (\\<lambda>x.\n      (X x)\\<^sup>2 + (expectation X)\\<^sup>2 - 2 * X x * expectation X)\n  \\<lbrakk>?f integrable_on ?S; ?g integrable_on ?S\\<rbrakk>\n  \\<Longrightarrow> integral ?S (\\<lambda>x. ?f x + ?g x) =\n                    integral ?S ?f + integral ?S ?g\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    expectation (\\<lambda>x. (X x)\\<^sup>2) + (expectation X)\\<^sup>2 +\n    expectation (\\<lambda>x. - (2 * X x * expectation X)) &&&\n    integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)", "by (simp add: int assms prob_space)+"], ["proof (state)\nthis:\n  expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n  expectation (\\<lambda>x. (X x)\\<^sup>2) + (expectation X)\\<^sup>2 +\n  expectation (\\<lambda>x. - (2 * X x * expectation X))\n  integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)\n\ngoal (2 subgoals):\n 1. integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)\n 2. expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    expectation (\\<lambda>x. (X x)\\<^sup>2) - (expectation X)\\<^sup>2", "thus ?variance ?integrable"], ["proof (prove)\nusing this:\n  expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n  expectation (\\<lambda>x. (X x)\\<^sup>2) + (expectation X)\\<^sup>2 +\n  expectation (\\<lambda>x. - (2 * X x * expectation X))\n  integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n    expectation (\\<lambda>x. (X x)\\<^sup>2) - (expectation X)\\<^sup>2 &&&\n    integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)", "by (simp add: int power2_eq_square)+"], ["proof (state)\nthis:\n  expectation (\\<lambda>x. (X x - expectation X)\\<^sup>2) =\n  expectation (\\<lambda>x. (X x)\\<^sup>2) - (expectation X)\\<^sup>2\n  integrable M (\\<lambda>x. (X x - expectation X)\\<^sup>2)\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>A corollary from the Markov inequality is Chebyshev's inequality, which gives an upper\nbound for the deviation of a random variable from its expectation:\n\\[ \\Pr[\\left| Y - \\Ex[Y] \\right| \\ge s] \\le \\frac{\\Var[X]}{a^2} \\]\\<close>"], ["", "lemma chebyshev_inequality:\n  fixes Y :: \"'a \\<Rightarrow> real\"\n  assumes Y_int: \"integrable M (\\<lambda>y. (Y y)^2)\"\n  assumes Y_borel: \"Y \\<in> borel_measurable M\"\n  fixes s :: \"real\"\n  assumes s_pos: \"0 < s\"\n  shows \"prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>} \\<le> variance Y / s^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "let ?X = \"\\<lambda>a. (Y a - expectation Y)^2\""], ["proof (state)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "let ?t = \"s^2\""], ["proof (state)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "have \"0 < ?t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < s\\<^sup>2", "using s_pos"], ["proof (prove)\nusing this:\n  0 < s\n\ngoal (1 subgoal):\n 1. 0 < s\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  0 < s\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "hence \"prob {a \\<in> space M. ?t \\<le> ?X a} \\<le> variance Y / s^2\""], ["proof (prove)\nusing this:\n  0 < s\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "using markov_inequality variance_expectation[OF Y_int Y_borel]"], ["proof (prove)\nusing this:\n  0 < s\\<^sup>2\n  \\<lbrakk>\\<And>a. 0 \\<le> ?X a; integrable M ?X; 0 < ?t\\<rbrakk>\n  \\<Longrightarrow> prob {a \\<in> space M. ?t \\<le> ?X a}\n                    \\<le> expectation ?X / ?t\n  integrable M (\\<lambda>x. (Y x - expectation Y)\\<^sup>2)\n  expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) =\n  expectation (\\<lambda>x. (Y x)\\<^sup>2) - (expectation Y)\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  prob {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2}\n  \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) / s\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "moreover"], ["proof (state)\nthis:\n  prob {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2}\n  \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) / s\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "have \"{a \\<in> space M. ?t \\<le> ?X a} = {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2} =\n    {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}", "using abs_le_square_iff s_pos"], ["proof (prove)\nusing this:\n  (\\<bar>?x\\<bar> \\<le> \\<bar>?y\\<bar>) = (?x\\<^sup>2 \\<le> ?y\\<^sup>2)\n  0 < s\n\ngoal (1 subgoal):\n 1. {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2} =\n    {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}", "by force"], ["proof (state)\nthis:\n  {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2} =\n  {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "ultimately"], ["proof (chain)\npicking this:\n  prob {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2}\n  \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) / s\\<^sup>2\n  {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2} =\n  {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}", "show ?thesis"], ["proof (prove)\nusing this:\n  prob {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2}\n  \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) / s\\<^sup>2\n  {a \\<in> space M. s\\<^sup>2 \\<le> (Y a - expectation Y)\\<^sup>2} =\n  {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          s\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  prob {a \\<in> space M. s \\<le> \\<bar>Y a - expectation Y\\<bar>}\n  \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) / s\\<^sup>2\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>Hence, we can derive an upper bound for the probability that a random variable is $0$.\\<close>"], ["", "corollary chebyshev_prob_zero:\n  fixes Y :: \"'a \\<Rightarrow> real\"\n  assumes Y_int: \"integrable M (\\<lambda>y. (Y y)^2)\"\n  assumes Y_borel: \"Y \\<in> borel_measurable M\"\n  assumes \\<mu>_pos: \"expectation Y > 0\"\n  shows \"prob {a \\<in> space M. Y a = 0} \\<le> expectation (\\<lambda>y. (Y y)^2) / (expectation Y)^2 - 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "let ?s = \"expectation Y\""], ["proof (state)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "have \"prob {a \\<in> space M. Y a = 0} \\<le> prob {a \\<in> space M. ?s \\<le> \\<bar>Y a - ?s\\<bar>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> prob\n           {a \\<in> space M.\n            expectation Y \\<le> \\<bar>Y a - expectation Y\\<bar>}", "using Y_borel"], ["proof (prove)\nusing this:\n  random_variable borel Y\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> prob\n           {a \\<in> space M.\n            expectation Y \\<le> \\<bar>Y a - expectation Y\\<bar>}", "by (auto intro!: finite_measure_mono borel_measurable_diff borel_measurable_abs borel_measurable_le)"], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> prob\n         {a \\<in> space M.\n          expectation Y \\<le> \\<bar>Y a - expectation Y\\<bar>}\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "also"], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> prob\n         {a \\<in> space M.\n          expectation Y \\<le> \\<bar>Y a - expectation Y\\<bar>}\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "have \"\\<dots> \\<le> variance Y / ?s^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob\n     {a \\<in> space M. expectation Y \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2", "using assms"], ["proof (prove)\nusing this:\n  integrable M (\\<lambda>y. (Y y)\\<^sup>2)\n  random_variable borel Y\n  0 < expectation Y\n\ngoal (1 subgoal):\n 1. prob\n     {a \\<in> space M. expectation Y \\<le> \\<bar>Y a - expectation Y\\<bar>}\n    \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2", "by (fact chebyshev_inequality)"], ["proof (state)\nthis:\n  prob\n   {a \\<in> space M. expectation Y \\<le> \\<bar>Y a - expectation Y\\<bar>}\n  \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n        (expectation Y)\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "also"], ["proof (state)\nthis:\n  prob\n   {a \\<in> space M. expectation Y \\<le> \\<bar>Y a - expectation Y\\<bar>}\n  \\<le> expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n        (expectation Y)\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "have \"\\<dots> = (expectation (\\<lambda>y. (Y y)^2) - ?s^2) / ?s^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n    (expectation Y)\\<^sup>2 =\n    (expectation (\\<lambda>y. (Y y)\\<^sup>2) - (expectation Y)\\<^sup>2) /\n    (expectation Y)\\<^sup>2", "using Y_int Y_borel"], ["proof (prove)\nusing this:\n  integrable M (\\<lambda>y. (Y y)\\<^sup>2)\n  random_variable borel Y\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n    (expectation Y)\\<^sup>2 =\n    (expectation (\\<lambda>y. (Y y)\\<^sup>2) - (expectation Y)\\<^sup>2) /\n    (expectation Y)\\<^sup>2", "by (simp add: variance_expectation)"], ["proof (state)\nthis:\n  expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n  (expectation Y)\\<^sup>2 =\n  (expectation (\\<lambda>y. (Y y)\\<^sup>2) - (expectation Y)\\<^sup>2) /\n  (expectation Y)\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "also"], ["proof (state)\nthis:\n  expectation (\\<lambda>x. (Y x - expectation Y)\\<^sup>2) /\n  (expectation Y)\\<^sup>2 =\n  (expectation (\\<lambda>y. (Y y)\\<^sup>2) - (expectation Y)\\<^sup>2) /\n  (expectation Y)\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "have \"\\<dots> = expectation (\\<lambda>y. (Y y)^2) / ?s^2 - 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (expectation (\\<lambda>y. (Y y)\\<^sup>2) - (expectation Y)\\<^sup>2) /\n    (expectation Y)\\<^sup>2 =\n    expectation (\\<lambda>y. (Y y)\\<^sup>2) / (expectation Y)\\<^sup>2 - 1", "using \\<mu>_pos"], ["proof (prove)\nusing this:\n  0 < expectation Y\n\ngoal (1 subgoal):\n 1. (expectation (\\<lambda>y. (Y y)\\<^sup>2) - (expectation Y)\\<^sup>2) /\n    (expectation Y)\\<^sup>2 =\n    expectation (\\<lambda>y. (Y y)\\<^sup>2) / (expectation Y)\\<^sup>2 - 1", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  (expectation (\\<lambda>y. (Y y)\\<^sup>2) - (expectation Y)\\<^sup>2) /\n  (expectation Y)\\<^sup>2 =\n  expectation (\\<lambda>y. (Y y)\\<^sup>2) / (expectation Y)\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "finally"], ["proof (chain)\npicking this:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) / (expectation Y)\\<^sup>2 -\n        1", "show ?thesis"], ["proof (prove)\nusing this:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) / (expectation Y)\\<^sup>2 -\n        1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "."], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) / (expectation Y)\\<^sup>2 -\n        1\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "subsection\\<open>Sets of indicator variables\\<close>"], ["", "text\\<open>\\label{sec:delta}\nThis section introduces some inequalities about expectation and other values related to the sum of\na set of random indicators.\\<close>"], ["", "locale prob_space_with_indicators = prob_space +\n  fixes I :: \"'i set\"\n  assumes finite_I: \"finite I\"\n\n  fixes A :: \"'i \\<Rightarrow> 'a set\"\n  assumes A: \"A ` I \\<subseteq> events\"\n\n  assumes prob_non_zero: \"\\<exists>i \\<in> I. 0 < prob (A i)\"\nbegin"], ["", "text\\<open>We call the underlying sets @{term \"A i\"} for each @{term \"i \\<in> I\"}, and the corresponding\nindicator variables @{term \"X i\"}. The sum is denoted by @{term Y}, and its expectation by\n@{term \\<mu>}.\\<close>"], ["", "definition \"X i = rind (A i)\""], ["", "definition \"Y x = (\\<Sum>i \\<in> I. X i x)\""], ["", "definition \"\\<mu> = expectation Y\""], ["", "text\\<open>In the lecture notes, the following two relations are called $\\sim$ and $\\nsim$,\nrespectively. Note that they are not the opposite of each other.\\<close>"], ["", "abbreviation ineq_indep :: \"'i \\<Rightarrow> 'i \\<Rightarrow> bool\" where\n\"ineq_indep i j \\<equiv> (i \\<noteq> j \\<and> indep (A i) (A j))\""], ["", "abbreviation ineq_dep :: \"'i \\<Rightarrow> 'i \\<Rightarrow> bool\" where\n\"ineq_dep i j \\<equiv> (i \\<noteq> j \\<and> \\<not>indep (A i) (A j))\""], ["", "definition \"\\<Delta>\\<^sub>a = (\\<Sum>i \\<in> I. \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j. prob (A i \\<inter> A j))\""], ["", "definition \"\\<Delta>\\<^sub>d = (\\<Sum>i \\<in> I. \\<Sum>j | j \\<in> I \\<and> ineq_dep i j. prob (A i \\<inter> A j))\""], ["", "lemma \\<Delta>_zero:\n  assumes \"\\<And>i j. i \\<in> I \\<Longrightarrow> j \\<in> I \\<Longrightarrow> i \\<noteq> j \\<Longrightarrow> indep (A i) (A j)\"\n  shows \"\\<Delta>\\<^sub>d = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "assume \"i \\<in> I\""], ["proof (state)\nthis:\n  i \\<in> I\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "hence \"{j. j \\<in> I \\<and> ineq_dep i j} = {}\""], ["proof (prove)\nusing this:\n  i \\<in> I\n\ngoal (1 subgoal):\n 1. {j \\<in> I. i \\<noteq> j \\<and> \\<not> indep (A i) (A j)} = {}", "using assms"], ["proof (prove)\nusing this:\n  i \\<in> I\n  \\<lbrakk>?i12 \\<in> I; ?j12 \\<in> I; ?i12 \\<noteq> ?j12\\<rbrakk>\n  \\<Longrightarrow> indep (A ?i12) (A ?j12)\n\ngoal (1 subgoal):\n 1. {j \\<in> I. i \\<noteq> j \\<and> \\<not> indep (A i) (A j)} = {}", "by auto"], ["proof (state)\nthis:\n  {j \\<in> I. i \\<noteq> j \\<and> \\<not> indep (A i) (A j)} = {}\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "hence \"(\\<Sum>j | j \\<in> I \\<and> ineq_dep i j. prob (A i \\<inter> A j)) = 0\""], ["proof (prove)\nusing this:\n  {j \\<in> I. i \\<noteq> j \\<and> \\<not> indep (A i) (A j)} = {}\n\ngoal (1 subgoal):\n 1. (\\<Sum>j | j \\<in> I \\<and>\n               i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n       prob (A i \\<inter> A j)) =\n    0", "using sum.empty"], ["proof (prove)\nusing this:\n  {j \\<in> I. i \\<noteq> j \\<and> \\<not> indep (A i) (A j)} = {}\n  sum ?g {} = (0::?'a)\n\ngoal (1 subgoal):\n 1. (\\<Sum>j | j \\<in> I \\<and>\n               i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n       prob (A i \\<inter> A j)) =\n    0", "by metis"], ["proof (state)\nthis:\n  (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n     prob (A i \\<inter> A j)) =\n  0\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "}"], ["proof (state)\nthis:\n  ?i14 \\<in> I \\<Longrightarrow>\n  (\\<Sum>j | j \\<in> I \\<and>\n             ?i14 \\<noteq> j \\<and> \\<not> indep (A ?i14) (A j).\n     prob (A ?i14 \\<inter> A j)) =\n  0\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "hence \"\\<Delta>\\<^sub>d = (0 :: real) * card I\""], ["proof (prove)\nusing this:\n  ?i14 \\<in> I \\<Longrightarrow>\n  (\\<Sum>j | j \\<in> I \\<and>\n             ?i14 \\<noteq> j \\<and> \\<not> indep (A ?i14) (A j).\n     prob (A ?i14 \\<inter> A j)) =\n  0\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0 * real (card I)", "unfolding \\<Delta>\\<^sub>d_def"], ["proof (prove)\nusing this:\n  ?i14 \\<in> I \\<Longrightarrow>\n  (\\<Sum>j | j \\<in> I \\<and>\n             ?i14 \\<noteq> j \\<and> \\<not> indep (A ?i14) (A j).\n     prob (A ?i14 \\<inter> A j)) =\n  0\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and>\n                 i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n         prob (A i \\<inter> A j)) =\n    0 * real (card I)", "by simp"], ["proof (state)\nthis:\n  \\<Delta>\\<^sub>d = 0 * real (card I)\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Delta>\\<^sub>d = 0 * real (card I)\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>d = 0", "by simp"], ["proof (state)\nthis:\n  \\<Delta>\\<^sub>d = 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma A_events[measurable]: \"i \\<in> I \\<Longrightarrow> A i \\<in> events\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i \\<in> I \\<Longrightarrow> A i \\<in> events", "using A"], ["proof (prove)\nusing this:\n  A ` I \\<subseteq> events\n\ngoal (1 subgoal):\n 1. i \\<in> I \\<Longrightarrow> A i \\<in> events", "by auto"], ["", "lemma expectation_X_Y: \"\\<mu> = (\\<Sum>i\\<in>I. expectation (X i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<mu> = (\\<Sum>i\\<in>I. expectation (X i))", "unfolding \\<mu>_def Y_def[abs_def] X_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. \\<Sum>i\\<in>I. rind (A i) x) =\n    (\\<Sum>i\\<in>I. expectation (rind (A i)))", "by (simp add: less_top[symmetric])"], ["", "lemma expectation_X_non_zero: \"\\<exists>i \\<in> I. 0 < expectation (X i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>i\\<in>I. 0 < expectation (X i)", "unfolding X_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>i\\<in>I. 0 < expectation (rind (A i))", "using prob_non_zero expectation_indicator"], ["proof (prove)\nusing this:\n  \\<exists>i\\<in>I. 0 < prob (A i)\n  ?A \\<in> events \\<Longrightarrow> expectation (rind ?A) = prob ?A\n\ngoal (1 subgoal):\n 1. \\<exists>i\\<in>I. 0 < expectation (rind (A i))", "by simp"], ["", "corollary \\<mu>_non_zero[simp]: \"0 < \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < \\<mu>", "unfolding expectation_X_Y"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < (\\<Sum>i\\<in>I. expectation (X i))", "using expectation_X_non_zero"], ["proof (prove)\nusing this:\n  \\<exists>i\\<in>I. 0 < expectation (X i)\n\ngoal (1 subgoal):\n 1. 0 < (\\<Sum>i\\<in>I. expectation (X i))", "by (auto intro!: sum_lower finite_I\n         simp add: expectation_indicator X_def)"], ["", "lemma \\<Delta>\\<^sub>d_nonneg: \"0 \\<le> \\<Delta>\\<^sub>d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> \\<Delta>\\<^sub>d", "unfolding \\<Delta>\\<^sub>d_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i\\<in>I.\n               \\<Sum>j | j \\<in> I \\<and>\n                         i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n                 prob (A i \\<inter> A j))", "by (simp add: sum_nonneg)"], ["", "corollary \\<mu>_sq_non_zero[simp]: \"0 < \\<mu>^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < \\<mu>\\<^sup>2", "by (rule zero_less_power) simp"], ["", "lemma Y_square_unfold: \"(\\<lambda>x. (Y x)^2) = (\\<lambda>x. \\<Sum>i \\<in> I. \\<Sum>j \\<in> I. rind (A i \\<inter> A j) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. (Y x)\\<^sup>2) =\n    (\\<lambda>x. \\<Sum>i\\<in>I. \\<Sum>j\\<in>I. rind (A i \\<inter> A j) x)", "unfolding fun_eq_iff Y_def X_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x.\n       (\\<Sum>i\\<in>I. rind (A i) x)\\<^sup>2 =\n       (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. rind (A i \\<inter> A j) x)", "by (auto simp: sum_square product_indicator)"], ["", "lemma integrable_Y_sq[simp]: \"integrable M (\\<lambda>y. (Y y)^2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>y. (Y y)\\<^sup>2)", "unfolding Y_square_unfold"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M\n     (\\<lambda>y. \\<Sum>i\\<in>I. \\<Sum>j\\<in>I. rind (A i \\<inter> A j) y)", "by (simp add: sets.Int less_top[symmetric])"], ["", "lemma measurable_Y[measurable]: \"Y \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable borel Y", "unfolding Y_def[abs_def] X_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable borel (\\<lambda>x. \\<Sum>i\\<in>I. rind (A i) x)", "by simp"], ["", "lemma expectation_Y_\\<Delta>: \"expectation (\\<lambda>x. (Y x)^2) = \\<mu> + \\<Delta>\\<^sub>a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "let ?ei = \"\\<lambda>i j. expectation (rind (A i \\<inter> A j))\""], ["proof (state)\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "have \"expectation (\\<lambda>x. (Y x)^2) = (\\<Sum>i \\<in> I. \\<Sum>j \\<in> I. ?ei i j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) =\n    (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. expectation (rind (A i \\<inter> A j)))", "unfolding Y_square_unfold"], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation\n     (\\<lambda>x. \\<Sum>i\\<in>I. \\<Sum>j\\<in>I. rind (A i \\<inter> A j) x) =\n    (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. expectation (rind (A i \\<inter> A j)))", "by (simp add: less_top[symmetric])"], ["proof (state)\nthis:\n  expectation (\\<lambda>x. (Y x)\\<^sup>2) =\n  (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. expectation (rind (A i \\<inter> A j)))\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "also"], ["proof (state)\nthis:\n  expectation (\\<lambda>x. (Y x)\\<^sup>2) =\n  (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. expectation (rind (A i \\<inter> A j)))\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "have \"\\<dots> = (\\<Sum>i \\<in> I. \\<Sum>j \\<in> I. if i = j then ?ei i j else ?ei i j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. expectation (rind (A i \\<inter> A j))) =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j\\<in>I.\n         if i = j then expectation (rind (A i \\<inter> A j))\n         else expectation (rind (A i \\<inter> A j)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. expectation (rind (A i \\<inter> A j))) =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j\\<in>I.\n       if i = j then expectation (rind (A i \\<inter> A j))\n       else expectation (rind (A i \\<inter> A j)))\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. expectation (rind (A i \\<inter> A j))) =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j\\<in>I.\n       if i = j then expectation (rind (A i \\<inter> A j))\n       else expectation (rind (A i \\<inter> A j)))\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "have \"\\<dots> = (\\<Sum>i \\<in> I. (\\<Sum>j | j \\<in> I \\<and> i = j. ?ei i j) + (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j. ?ei i j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j\\<in>I.\n         if i = j then expectation (rind (A i \\<inter> A j))\n         else expectation (rind (A i \\<inter> A j))) =\n    (\\<Sum>i\\<in>I.\n       (\\<Sum>j | j \\<in> I \\<and> i = j.\n          expectation (rind (A i \\<inter> A j))) +\n       (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n          expectation (rind (A i \\<inter> A j))))", "by (simp only: sum_split[OF finite_I])"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j\\<in>I.\n       if i = j then expectation (rind (A i \\<inter> A j))\n       else expectation (rind (A i \\<inter> A j))) =\n  (\\<Sum>i\\<in>I.\n     (\\<Sum>j | j \\<in> I \\<and> i = j.\n        expectation (rind (A i \\<inter> A j))) +\n     (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n        expectation (rind (A i \\<inter> A j))))\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j\\<in>I.\n       if i = j then expectation (rind (A i \\<inter> A j))\n       else expectation (rind (A i \\<inter> A j))) =\n  (\\<Sum>i\\<in>I.\n     (\\<Sum>j | j \\<in> I \\<and> i = j.\n        expectation (rind (A i \\<inter> A j))) +\n     (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n        expectation (rind (A i \\<inter> A j))))\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "have \"\\<dots> = (\\<Sum>i \\<in> I. \\<Sum>j | j \\<in> I \\<and> i = j. ?ei i j) + (\\<Sum>i \\<in> I. \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j. ?ei i j)\" (is \"_ = ?lhs + ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       (\\<Sum>j | j \\<in> I \\<and> i = j.\n          expectation (rind (A i \\<inter> A j))) +\n       (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n          expectation (rind (A i \\<inter> A j)))) =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) +\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j)))", "by (fact sum.distrib)"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     (\\<Sum>j | j \\<in> I \\<and> i = j.\n        expectation (rind (A i \\<inter> A j))) +\n     (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n        expectation (rind (A i \\<inter> A j)))) =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) +\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       expectation (rind (A i \\<inter> A j)))\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     (\\<Sum>j | j \\<in> I \\<and> i = j.\n        expectation (rind (A i \\<inter> A j))) +\n     (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n        expectation (rind (A i \\<inter> A j)))) =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) +\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       expectation (rind (A i \\<inter> A j)))\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "have \"\\<dots> =  \\<mu> + \\<Delta>\\<^sub>a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) +\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu> + \\<Delta>\\<^sub>a", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) +\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu> + \\<Delta>\\<^sub>a", "have \"?lhs = \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "assume i: \"i \\<in> I\""], ["proof (state)\nthis:\n  i \\<in> I\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "have \"(\\<Sum>j | j \\<in> I \\<and> i = j. ?ei i j) = (\\<Sum>j | j \\<in> I \\<and> i = j. ?ei i i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n    (\\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A i)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>j | j \\<in> I \\<and> i = j.\n     expectation (rind (A i \\<inter> A j))) =\n  (\\<Sum>j | j \\<in> I \\<and> i = j. expectation (rind (A i \\<inter> A i)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "also"], ["proof (state)\nthis:\n  (\\<Sum>j | j \\<in> I \\<and> i = j.\n     expectation (rind (A i \\<inter> A j))) =\n  (\\<Sum>j | j \\<in> I \\<and> i = j. expectation (rind (A i \\<inter> A i)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "have \"\\<dots> = (\\<Sum>j | i = j. ?ei i i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A i))) =\n    (\\<Sum>j | i = j. expectation (rind (A i \\<inter> A i)))", "using i"], ["proof (prove)\nusing this:\n  i \\<in> I\n\ngoal (1 subgoal):\n 1. (\\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A i))) =\n    (\\<Sum>j | i = j. expectation (rind (A i \\<inter> A i)))", "by metis"], ["proof (state)\nthis:\n  (\\<Sum>j | j \\<in> I \\<and> i = j.\n     expectation (rind (A i \\<inter> A i))) =\n  (\\<Sum>j | i = j. expectation (rind (A i \\<inter> A i)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "also"], ["proof (state)\nthis:\n  (\\<Sum>j | j \\<in> I \\<and> i = j.\n     expectation (rind (A i \\<inter> A i))) =\n  (\\<Sum>j | i = j. expectation (rind (A i \\<inter> A i)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "have \"\\<dots> = expectation (rind (A i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j | i = j. expectation (rind (A i \\<inter> A i))) =\n    expectation (rind (A i))", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>j | i = j. expectation (rind (A i \\<inter> A i))) =\n  expectation (rind (A i))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>j | j \\<in> I \\<and> i = j.\n     expectation (rind (A i \\<inter> A j))) =\n  expectation (rind (A i))", "have \"(\\<Sum>j | j \\<in> I \\<and> i = j. ?ei i j) = \\<dots>\""], ["proof (prove)\nusing this:\n  (\\<Sum>j | j \\<in> I \\<and> i = j.\n     expectation (rind (A i \\<inter> A j))) =\n  expectation (rind (A i))\n\ngoal (1 subgoal):\n 1. (\\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n    expectation (rind (A i))", "."], ["proof (state)\nthis:\n  (\\<Sum>j | j \\<in> I \\<and> i = j.\n     expectation (rind (A i \\<inter> A j))) =\n  expectation (rind (A i))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "}"], ["proof (state)\nthis:\n  ?i14 \\<in> I \\<Longrightarrow>\n  (\\<Sum>j | j \\<in> I \\<and> ?i14 = j.\n     expectation (rind (A ?i14 \\<inter> A j))) =\n  expectation (rind (A ?i14))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "hence \"?lhs = (\\<Sum>i\\<in>I. expectation (rind (A i)))\""], ["proof (prove)\nusing this:\n  ?i14 \\<in> I \\<Longrightarrow>\n  (\\<Sum>j | j \\<in> I \\<and> ?i14 = j.\n     expectation (rind (A ?i14 \\<inter> A j))) =\n  expectation (rind (A ?i14))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    (\\<Sum>i\\<in>I. expectation (rind (A i)))", "by force"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  (\\<Sum>i\\<in>I. expectation (rind (A i)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  (\\<Sum>i\\<in>I. expectation (rind (A i)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "have \"\\<dots> = \\<mu>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. expectation (rind (A i))) = \\<mu>", "unfolding expectation_X_Y X_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. expectation (rind (A i))) =\n    (\\<Sum>i\\<in>I. expectation (rind (A i)))", ".."], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. expectation (rind (A i))) = \\<mu>\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu>", "show \"?lhs = \\<mu>\""], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu>\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu>", "."], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu>\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) +\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu> + \\<Delta>\\<^sub>a", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu>\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) +\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu> + \\<Delta>\\<^sub>a", "have \"?rhs = \\<Delta>\\<^sub>a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "fix i j"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "assume \"i \\<in> I\" \"j \\<in> I\""], ["proof (state)\nthis:\n  i \\<in> I\n  j \\<in> I\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "with A"], ["proof (chain)\npicking this:\n  A ` I \\<subseteq> events\n  i \\<in> I\n  j \\<in> I", "have \"A i \\<inter> A j \\<in> events\""], ["proof (prove)\nusing this:\n  A ` I \\<subseteq> events\n  i \\<in> I\n  j \\<in> I\n\ngoal (1 subgoal):\n 1. A i \\<inter> A j \\<in> events", "by blast"], ["proof (state)\nthis:\n  A i \\<inter> A j \\<in> events\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "hence \"?ei i j = prob (A i \\<inter> A j)\""], ["proof (prove)\nusing this:\n  A i \\<inter> A j \\<in> events\n\ngoal (1 subgoal):\n 1. expectation (rind (A i \\<inter> A j)) = prob (A i \\<inter> A j)", "by (fact expectation_indicator)"], ["proof (state)\nthis:\n  expectation (rind (A i \\<inter> A j)) = prob (A i \\<inter> A j)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?i14 \\<in> I; ?j14 \\<in> I\\<rbrakk>\n  \\<Longrightarrow> expectation (rind (A ?i14 \\<inter> A ?j14)) =\n                    prob (A ?i14 \\<inter> A ?j14)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?i14 \\<in> I; ?j14 \\<in> I\\<rbrakk>\n  \\<Longrightarrow> expectation (rind (A ?i14 \\<inter> A ?j14)) =\n                    prob (A ?i14 \\<inter> A ?j14)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<Delta>\\<^sub>a", "unfolding \\<Delta>\\<^sub>a_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>?i14 \\<in> I; ?j14 \\<in> I\\<rbrakk>\n  \\<Longrightarrow> expectation (rind (A ?i14 \\<inter> A ?j14)) =\n                    prob (A ?i14 \\<inter> A ?j14)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j. prob (A i \\<inter> A j))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<Delta>\\<^sub>a\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<Delta>\\<^sub>a\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) +\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu> + \\<Delta>\\<^sub>a", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu>\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<Delta>\\<^sub>a", "show \"?lhs + ?rhs = \\<mu> + \\<Delta>\\<^sub>a\""], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu>\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<Delta>\\<^sub>a\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i = j.\n         expectation (rind (A i \\<inter> A j))) +\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         expectation (rind (A i \\<inter> A j))) =\n    \\<mu> + \\<Delta>\\<^sub>a", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) +\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu> + \\<Delta>\\<^sub>a\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i = j.\n       expectation (rind (A i \\<inter> A j))) +\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       expectation (rind (A i \\<inter> A j))) =\n  \\<mu> + \\<Delta>\\<^sub>a\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "finally"], ["proof (chain)\npicking this:\n  expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "show ?thesis"], ["proof (prove)\nusing this:\n  expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a", "."], ["proof (state)\nthis:\n  expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma \\<Delta>_expectation_X: \"\\<Delta>\\<^sub>a \\<le> \\<mu>^2 + \\<Delta>\\<^sub>d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "let ?p = \"\\<lambda>i j. prob (A i \\<inter> A j)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "let ?p' = \"\\<lambda>i j. prob (A i) * prob (A j)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "let ?ie = \"\\<lambda>i j. indep (A i) (A j)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "have \"\\<Delta>\\<^sub>a = (\\<Sum>i \\<in> I. \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j. if ?ie i j then ?p i j else ?p i j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         if indep (A i) (A j) then prob (A i \\<inter> A j)\n         else prob (A i \\<inter> A j))", "unfolding \\<Delta>\\<^sub>a_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j. prob (A i \\<inter> A j)) =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         if indep (A i) (A j) then prob (A i \\<inter> A j)\n         else prob (A i \\<inter> A j))", "by simp"], ["proof (state)\nthis:\n  \\<Delta>\\<^sub>a =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       if indep (A i) (A j) then prob (A i \\<inter> A j)\n       else prob (A i \\<inter> A j))\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "also"], ["proof (state)\nthis:\n  \\<Delta>\\<^sub>a =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       if indep (A i) (A j) then prob (A i \\<inter> A j)\n       else prob (A i \\<inter> A j))\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "have \"\\<dots> = (\\<Sum>i \\<in> I. (\\<Sum>j | j \\<in> I \\<and> ineq_indep i j. ?p i j) + (\\<Sum>j | j \\<in> I \\<and> ineq_dep i j. ?p i j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n         if indep (A i) (A j) then prob (A i \\<inter> A j)\n         else prob (A i \\<inter> A j)) =\n    (\\<Sum>i\\<in>I.\n       (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n          prob (A i \\<inter> A j)) +\n       (\\<Sum>j | j \\<in> I \\<and>\n                  i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n          prob (A i \\<inter> A j)))", "by (simp only: sum_split2[OF finite_I])"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       if indep (A i) (A j) then prob (A i \\<inter> A j)\n       else prob (A i \\<inter> A j)) =\n  (\\<Sum>i\\<in>I.\n     (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n        prob (A i \\<inter> A j)) +\n     (\\<Sum>j | j \\<in> I \\<and>\n                i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n        prob (A i \\<inter> A j)))\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j.\n       if indep (A i) (A j) then prob (A i \\<inter> A j)\n       else prob (A i \\<inter> A j)) =\n  (\\<Sum>i\\<in>I.\n     (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n        prob (A i \\<inter> A j)) +\n     (\\<Sum>j | j \\<in> I \\<and>\n                i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n        prob (A i \\<inter> A j)))\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "have \"\\<dots> = (\\<Sum>i \\<in> I. \\<Sum>j | j \\<in> I \\<and> ineq_indep i j. ?p i j) + \\<Delta>\\<^sub>d\" (is \"_ = ?lhs + _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n          prob (A i \\<inter> A j)) +\n       (\\<Sum>j | j \\<in> I \\<and>\n                  i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n          prob (A i \\<inter> A j))) =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j)) +\n    \\<Delta>\\<^sub>d", "unfolding \\<Delta>\\<^sub>d_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n          prob (A i \\<inter> A j)) +\n       (\\<Sum>j | j \\<in> I \\<and>\n                  i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n          prob (A i \\<inter> A j))) =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j)) +\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and>\n                 i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n         prob (A i \\<inter> A j))", "by (fact sum.distrib)"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n        prob (A i \\<inter> A j)) +\n     (\\<Sum>j | j \\<in> I \\<and>\n                i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n        prob (A i \\<inter> A j))) =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i \\<inter> A j)) +\n  \\<Delta>\\<^sub>d\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n        prob (A i \\<inter> A j)) +\n     (\\<Sum>j | j \\<in> I \\<and>\n                i \\<noteq> j \\<and> \\<not> indep (A i) (A j).\n        prob (A i \\<inter> A j))) =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i \\<inter> A j)) +\n  \\<Delta>\\<^sub>d\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "have \"\\<dots> \\<le> \\<mu>^2 + \\<Delta>\\<^sub>d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j)) +\n    \\<Delta>\\<^sub>d\n    \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "proof (rule add_right_mono)"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "have \"(\\<Sum>i\\<in>I. \\<Sum>j | j \\<in> I \\<and> ineq_indep i j. ?p i j) = (\\<Sum>i \\<in> I. \\<Sum>j | j \\<in> I \\<and> ineq_indep i j. ?p' i j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j)) =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i) * prob (A j))", "unfolding indep_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and>\n                 i \\<noteq> j \\<and>\n                 prob (A i \\<inter> A j) = prob (A i) * prob (A j).\n         prob (A i \\<inter> A j)) =\n    (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and>\n                 i \\<noteq> j \\<and>\n                 prob (A i \\<inter> A j) = prob (A i) * prob (A j).\n         prob (A i) * prob (A j))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i \\<inter> A j)) =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i) * prob (A j))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i \\<inter> A j)) =\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i) * prob (A j))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "have \"\\<dots> \\<le> (\\<Sum>i \\<in> I. \\<Sum>j \\<in> I. ?p' i j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i) * prob (A j))\n    \\<le> (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. prob (A i) * prob (A j))", "proof (rule sum_mono)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> I \\<Longrightarrow>\n       (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n          prob (A i) * prob (A j))\n       \\<le> (\\<Sum>j\\<in>I. prob (A i) * prob (A j))", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> I \\<Longrightarrow>\n       (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n          prob (A i) * prob (A j))\n       \\<le> (\\<Sum>j\\<in>I. prob (A i) * prob (A j))", "assume \"i \\<in> I\""], ["proof (state)\nthis:\n  i \\<in> I\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> I \\<Longrightarrow>\n       (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n          prob (A i) * prob (A j))\n       \\<le> (\\<Sum>j\\<in>I. prob (A i) * prob (A j))", "show \"(\\<Sum>j | j \\<in> I \\<and> ineq_indep i j. ?p' i j) \\<le> (\\<Sum>j\\<in>I. ?p' i j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i) * prob (A j))\n    \\<le> (\\<Sum>j\\<in>I. prob (A i) * prob (A j))", "by (rule sum_upper[OF finite_I]) (simp add: zero_le_mult_iff)"], ["proof (state)\nthis:\n  (\\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n     prob (A i) * prob (A j))\n  \\<le> (\\<Sum>j\\<in>I. prob (A i) * prob (A j))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i) * prob (A j))\n  \\<le> (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. prob (A i) * prob (A j))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i) * prob (A j))\n  \\<le> (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. prob (A i) * prob (A j))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "have \"\\<dots> = (\\<Sum>i \\<in> I. prob (A i))^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. prob (A i) * prob (A j)) =\n    (\\<Sum>i\\<in>I. prob (A i))\\<^sup>2", "by (fact sum_square[symmetric])"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. prob (A i) * prob (A j)) =\n  (\\<Sum>i\\<in>I. prob (A i))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. \\<Sum>j\\<in>I. prob (A i) * prob (A j)) =\n  (\\<Sum>i\\<in>I. prob (A i))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "have \"\\<dots> = (\\<Sum>i \\<in> I. expectation (X i))^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. prob (A i))\\<^sup>2 =\n    (\\<Sum>i\\<in>I. expectation (X i))\\<^sup>2", "unfolding X_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. prob (A i))\\<^sup>2 =\n    (\\<Sum>i\\<in>I. expectation (rind (A i)))\\<^sup>2", "using expectation_indicator A"], ["proof (prove)\nusing this:\n  ?A \\<in> events \\<Longrightarrow> expectation (rind ?A) = prob ?A\n  A ` I \\<subseteq> events\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. prob (A i))\\<^sup>2 =\n    (\\<Sum>i\\<in>I. expectation (rind (A i)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. prob (A i))\\<^sup>2 =\n  (\\<Sum>i\\<in>I. expectation (X i))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. prob (A i))\\<^sup>2 =\n  (\\<Sum>i\\<in>I. expectation (X i))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "have \"\\<dots> = \\<mu>^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. expectation (X i))\\<^sup>2 = \\<mu>\\<^sup>2", "using expectation_X_Y[symmetric]"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>I. expectation (X i)) = \\<mu>\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. expectation (X i))\\<^sup>2 = \\<mu>\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. expectation (X i))\\<^sup>2 = \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i \\<inter> A j))\n  \\<le> \\<mu>\\<^sup>2", "show \"?lhs \\<le> \\<mu>^2\""], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i \\<inter> A j))\n  \\<le> \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n         prob (A i \\<inter> A j))\n    \\<le> \\<mu>\\<^sup>2", "."], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i \\<inter> A j))\n  \\<le> \\<mu>\\<^sup>2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     \\<Sum>j | j \\<in> I \\<and> i \\<noteq> j \\<and> indep (A i) (A j).\n       prob (A i \\<inter> A j)) +\n  \\<Delta>\\<^sub>d\n  \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "finally"], ["proof (chain)\npicking this:\n  \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d\n\ngoal (1 subgoal):\n 1. \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d", "."], ["proof (state)\nthis:\n  \\<Delta>\\<^sub>a \\<le> \\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma prob_\\<mu>_\\<Delta>\\<^sub>a: \"prob {a \\<in> space M. Y a = 0} \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>^2 - 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "have \"prob {a \\<in> space M. Y a = 0} \\<le> expectation (\\<lambda>y. (Y y)^2) / \\<mu>^2 - 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) / \\<mu>\\<^sup>2 - 1", "unfolding \\<mu>_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) /\n          (expectation Y)\\<^sup>2 -\n          1", "by (rule chebyshev_prob_zero) (simp add: \\<mu>_def[symmetric])+"], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) / \\<mu>\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "also"], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> expectation (\\<lambda>y. (Y y)\\<^sup>2) / \\<mu>\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "have \"\\<dots> = (\\<mu> + \\<Delta>\\<^sub>a) / \\<mu>^2 - 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (\\<lambda>y. (Y y)\\<^sup>2) / \\<mu>\\<^sup>2 - 1 =\n    (\\<mu> + \\<Delta>\\<^sub>a) / \\<mu>\\<^sup>2 - 1", "using expectation_Y_\\<Delta>"], ["proof (prove)\nusing this:\n  expectation (\\<lambda>x. (Y x)\\<^sup>2) = \\<mu> + \\<Delta>\\<^sub>a\n\ngoal (1 subgoal):\n 1. expectation (\\<lambda>y. (Y y)\\<^sup>2) / \\<mu>\\<^sup>2 - 1 =\n    (\\<mu> + \\<Delta>\\<^sub>a) / \\<mu>\\<^sup>2 - 1", "by simp"], ["proof (state)\nthis:\n  expectation (\\<lambda>y. (Y y)\\<^sup>2) / \\<mu>\\<^sup>2 - 1 =\n  (\\<mu> + \\<Delta>\\<^sub>a) / \\<mu>\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "also"], ["proof (state)\nthis:\n  expectation (\\<lambda>y. (Y y)\\<^sup>2) / \\<mu>\\<^sup>2 - 1 =\n  (\\<mu> + \\<Delta>\\<^sub>a) / \\<mu>\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "have \"\\<dots> = 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>^2 - 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<mu> + \\<Delta>\\<^sub>a) / \\<mu>\\<^sup>2 - 1 =\n    1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "unfolding power2_eq_square"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<mu> + \\<Delta>\\<^sub>a) / (\\<mu> * \\<mu>) - 1 =\n    1 / \\<mu> + \\<Delta>\\<^sub>a / (\\<mu> * \\<mu>) - 1", "by (simp add: field_simps add_divide_distrib)"], ["proof (state)\nthis:\n  (\\<mu> + \\<Delta>\\<^sub>a) / \\<mu>\\<^sup>2 - 1 =\n  1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "finally"], ["proof (chain)\npicking this:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "show ?thesis"], ["proof (prove)\nusing this:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "."], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma prob_\\<mu>_\\<Delta>\\<^sub>d: \"prob {a \\<in> space M. Y a = 0} \\<le> 1/\\<mu> + \\<Delta>\\<^sub>d/\\<mu>^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "have \"prob {a \\<in> space M. Y a = 0} \\<le> 1/\\<mu> + \\<Delta>\\<^sub>a/\\<mu>^2 - 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1", "by (fact prob_\\<mu>_\\<Delta>\\<^sub>a)"], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "also"], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "have \"\\<dots> = (1/\\<mu> - 1) + \\<Delta>\\<^sub>a/\\<mu>^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1 =\n    1 / \\<mu> - 1 + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1 =\n  1 / \\<mu> - 1 + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "also"], ["proof (state)\nthis:\n  1 / \\<mu> + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2 - 1 =\n  1 / \\<mu> - 1 + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "have \"\\<dots> \\<le> (1/\\<mu> - 1) + (\\<mu>^2 + \\<Delta>\\<^sub>d)/\\<mu>^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / \\<mu> - 1 + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2\n    \\<le> 1 / \\<mu> - 1 + (\\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d) / \\<mu>\\<^sup>2", "using divide_right_mono[OF \\<Delta>_expectation_X]"], ["proof (prove)\nusing this:\n  0 \\<le> ?c \\<Longrightarrow>\n  \\<Delta>\\<^sub>a / ?c \\<le> (\\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d) / ?c\n\ngoal (1 subgoal):\n 1. 1 / \\<mu> - 1 + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2\n    \\<le> 1 / \\<mu> - 1 + (\\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d) / \\<mu>\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  1 / \\<mu> - 1 + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2\n  \\<le> 1 / \\<mu> - 1 + (\\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d) / \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "also"], ["proof (state)\nthis:\n  1 / \\<mu> - 1 + \\<Delta>\\<^sub>a / \\<mu>\\<^sup>2\n  \\<le> 1 / \\<mu> - 1 + (\\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d) / \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "have \"\\<dots> = 1/\\<mu> + \\<Delta>\\<^sub>d/\\<mu>^2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / \\<mu> - 1 + (\\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d) / \\<mu>\\<^sup>2 =\n    1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "using \\<mu>_sq_non_zero"], ["proof (prove)\nusing this:\n  0 < \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. 1 / \\<mu> - 1 + (\\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d) / \\<mu>\\<^sup>2 =\n    1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  1 / \\<mu> - 1 + (\\<mu>\\<^sup>2 + \\<Delta>\\<^sub>d) / \\<mu>\\<^sup>2 =\n  1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "finally"], ["proof (chain)\npicking this:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "show ?thesis"], ["proof (prove)\nusing this:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob {a \\<in> space M. Y a = 0}\n    \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2", "."], ["proof (state)\nthis:\n  prob {a \\<in> space M. Y a = 0}\n  \\<le> 1 / \\<mu> + \\<Delta>\\<^sub>d / \\<mu>\\<^sup>2\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"]]}