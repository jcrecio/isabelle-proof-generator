{"file_name": "/home/qj213/afp-2021-10-22/thys/Knuth_Bendix_Order/Term_Aux.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Knuth_Bendix_Order", "problem_names": ["lemma vars_term_ms_subst [simp]:\n  \"vars_term_ms (t \\<cdot> \\<sigma>) =\n    \\<Sum>\\<^sub># (image_mset (\\<lambda> x. vars_term_ms (\\<sigma> x)) (vars_term_ms t))\" (is \"_ = ?V t\")", "lemma vars_term_ms_subst_mono:\n  assumes \"vars_term_ms s \\<subseteq># vars_term_ms t\"\n  shows \"vars_term_ms (s \\<cdot> \\<sigma>) \\<subseteq># vars_term_ms (t \\<cdot> \\<sigma>)\"", "lemma set_mset_vars_term_ms [simp]:\n  \"set_mset (vars_term_ms t) = vars_term t\"", "lemma ground_vars_term_empty:\n  \"ground t \\<longleftrightarrow> vars_term t = {}\"", "lemma ground_subst [simp]:\n  \"ground (t \\<cdot> \\<sigma>) \\<longleftrightarrow> (\\<forall>x \\<in> vars_term t. ground (\\<sigma> x))\"", "lemma ground_subst_apply:\n  assumes \"ground t\"\n  shows \"t \\<cdot> \\<sigma> = t\"", "lemma supt_imp_funas_term_subset:\n  assumes \"s \\<rhd> t\"\n  shows \"funas_term t \\<subseteq> funas_term s\"", "lemma supteq_imp_funas_term_subset[simp]:\n  assumes \"s \\<unrhd> t\"\n  shows \"funas_term t \\<subseteq> funas_term s\"", "lemma funas_term_ctxt_apply [simp]:\n  \"funas_term (C\\<langle>t\\<rangle>) = funas_ctxt C \\<union> funas_term t\"", "lemma funas_term_subst:\n  \"funas_term (t \\<cdot> \\<sigma>) = funas_term t \\<union> \\<Union>(funas_term ` \\<sigma> ` vars_term t)\"", "lemma funas_ctxt_compose [simp]:\n  \"funas_ctxt (C \\<circ>\\<^sub>c D) = funas_ctxt C \\<union> funas_ctxt D\"", "lemma funas_ctxt_subst [simp]:\n  \"funas_ctxt (C \\<cdot>\\<^sub>c \\<sigma>) = funas_ctxt C \\<union> \\<Union>(funas_term ` \\<sigma> ` vars_ctxt C)\""], "translations": [["", "lemma vars_term_ms_subst [simp]:\n  \"vars_term_ms (t \\<cdot> \\<sigma>) =\n    \\<Sum>\\<^sub># (image_mset (\\<lambda> x. vars_term_ms (\\<sigma> x)) (vars_term_ms t))\" (is \"_ = ?V t\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. vars_term_ms (t \\<cdot> \\<sigma>) =\n    (\\<Sum>x\\<in>#vars_term_ms t. vars_term_ms (\\<sigma> x))", "proof (induct t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       vars_term_ms (Var x \\<cdot> \\<sigma>) =\n       (\\<Sum>x\\<in>#vars_term_ms (Var x). vars_term_ms (\\<sigma> x))\n 2. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           vars_term_ms (x2a \\<cdot> \\<sigma>) =\n           (\\<Sum>x\\<in>#vars_term_ms\n                          x2a. vars_term_ms (\\<sigma> x))) \\<Longrightarrow>\n       vars_term_ms (Fun x1a x2 \\<cdot> \\<sigma>) =\n       (\\<Sum>x\\<in>#vars_term_ms (Fun x1a x2). vars_term_ms (\\<sigma> x))", "case (Fun f ts)"], ["proof (state)\nthis:\n  ?x2a \\<in> set ts \\<Longrightarrow>\n  vars_term_ms (?x2a \\<cdot> \\<sigma>) =\n  (\\<Sum>x\\<in>#vars_term_ms ?x2a. vars_term_ms (\\<sigma> x))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       vars_term_ms (Var x \\<cdot> \\<sigma>) =\n       (\\<Sum>x\\<in>#vars_term_ms (Var x). vars_term_ms (\\<sigma> x))\n 2. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           vars_term_ms (x2a \\<cdot> \\<sigma>) =\n           (\\<Sum>x\\<in>#vars_term_ms\n                          x2a. vars_term_ms (\\<sigma> x))) \\<Longrightarrow>\n       vars_term_ms (Fun x1a x2 \\<cdot> \\<sigma>) =\n       (\\<Sum>x\\<in>#vars_term_ms (Fun x1a x2). vars_term_ms (\\<sigma> x))", "have IH: \"map (\\<lambda> t. vars_term_ms (t \\<cdot> \\<sigma>)) ts = map (\\<lambda> t. ?V t) ts\""], ["proof (prove)\ngoal (1 subgoal):\n 1. map (\\<lambda>t. vars_term_ms (t \\<cdot> \\<sigma>)) ts =\n    map (\\<lambda>t. \\<Sum>x\\<in>#vars_term_ms t. vars_term_ms (\\<sigma> x))\n     ts", "by (rule map_cong[OF refl Fun])"], ["proof (state)\nthis:\n  map (\\<lambda>t. vars_term_ms (t \\<cdot> \\<sigma>)) ts =\n  map (\\<lambda>t. \\<Sum>x\\<in>#vars_term_ms t. vars_term_ms (\\<sigma> x))\n   ts\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       vars_term_ms (Var x \\<cdot> \\<sigma>) =\n       (\\<Sum>x\\<in>#vars_term_ms (Var x). vars_term_ms (\\<sigma> x))\n 2. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           vars_term_ms (x2a \\<cdot> \\<sigma>) =\n           (\\<Sum>x\\<in>#vars_term_ms\n                          x2a. vars_term_ms (\\<sigma> x))) \\<Longrightarrow>\n       vars_term_ms (Fun x1a x2 \\<cdot> \\<sigma>) =\n       (\\<Sum>x\\<in>#vars_term_ms (Fun x1a x2). vars_term_ms (\\<sigma> x))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. vars_term_ms (Fun f ts \\<cdot> \\<sigma>) =\n    (\\<Sum>x\\<in>#vars_term_ms (Fun f ts). vars_term_ms (\\<sigma> x))", "by (simp add: o_def IH, induct ts, auto)"], ["proof (state)\nthis:\n  vars_term_ms (Fun f ts \\<cdot> \\<sigma>) =\n  (\\<Sum>x\\<in>#vars_term_ms (Fun f ts). vars_term_ms (\\<sigma> x))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       vars_term_ms (Var x \\<cdot> \\<sigma>) =\n       (\\<Sum>x\\<in>#vars_term_ms (Var x). vars_term_ms (\\<sigma> x))", "qed simp"], ["", "lemma vars_term_ms_subst_mono:\n  assumes \"vars_term_ms s \\<subseteq># vars_term_ms t\"\n  shows \"vars_term_ms (s \\<cdot> \\<sigma>) \\<subseteq># vars_term_ms (t \\<cdot> \\<sigma>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vars_term_ms (s \\<cdot> \\<sigma>) \\<subseteq>#\n    vars_term_ms (t \\<cdot> \\<sigma>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. vars_term_ms (s \\<cdot> \\<sigma>) \\<subseteq>#\n    vars_term_ms (t \\<cdot> \\<sigma>)", "from assms[unfolded mset_subset_eq_exists_conv]"], ["proof (chain)\npicking this:\n  \\<exists>C. vars_term_ms t = vars_term_ms s + C", "obtain u where t: \"vars_term_ms t = vars_term_ms s + u\""], ["proof (prove)\nusing this:\n  \\<exists>C. vars_term_ms t = vars_term_ms s + C\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        vars_term_ms t = vars_term_ms s + u \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  vars_term_ms t = vars_term_ms s + u\n\ngoal (1 subgoal):\n 1. vars_term_ms (s \\<cdot> \\<sigma>) \\<subseteq>#\n    vars_term_ms (t \\<cdot> \\<sigma>)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. vars_term_ms (s \\<cdot> \\<sigma>) \\<subseteq>#\n    vars_term_ms (t \\<cdot> \\<sigma>)", "unfolding vars_term_ms_subst"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>#vars_term_ms s. vars_term_ms (\\<sigma> x)) \\<subseteq>#\n    (\\<Sum>x\\<in>#vars_term_ms t. vars_term_ms (\\<sigma> x))", "unfolding t"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>#vars_term_ms s. vars_term_ms (\\<sigma> x)) \\<subseteq>#\n    (\\<Sum>x\\<in>#vars_term_ms s + u. vars_term_ms (\\<sigma> x))", "by auto"], ["proof (state)\nthis:\n  vars_term_ms (s \\<cdot> \\<sigma>) \\<subseteq>#\n  vars_term_ms (t \\<cdot> \\<sigma>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma set_mset_vars_term_ms [simp]:\n  \"set_mset (vars_term_ms t) = vars_term t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_mset (vars_term_ms t) = vars_term t", "by (induct t) auto"], ["", "text \\<open>A term is called \\<^emph>\\<open>ground\\<close> if it does not contain any variables.\\<close>"], ["", "fun ground :: \"('f, 'v) term \\<Rightarrow> bool\"\n  where\n    \"ground (Var x) \\<longleftrightarrow> False\" |\n    \"ground (Fun f ts) \\<longleftrightarrow> (\\<forall>t \\<in> set ts. ground t)\""], ["", "lemma ground_vars_term_empty:\n  \"ground t \\<longleftrightarrow> vars_term t = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ground t = (vars_term t = {})", "by (induct t) simp_all"], ["", "lemma ground_subst [simp]:\n  \"ground (t \\<cdot> \\<sigma>) \\<longleftrightarrow> (\\<forall>x \\<in> vars_term t. ground (\\<sigma> x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ground (t \\<cdot> \\<sigma>) =\n    (\\<forall>x\\<in>vars_term t. ground (\\<sigma> x))", "by (induct t) simp_all"], ["", "lemma ground_subst_apply:\n  assumes \"ground t\"\n  shows \"t \\<cdot> \\<sigma> = t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<cdot> \\<sigma> = t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<cdot> \\<sigma> = t", "have \"t = t \\<cdot> Var\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t = t \\<cdot> Var", "by simp"], ["proof (state)\nthis:\n  t = t \\<cdot> Var\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<sigma> = t", "also"], ["proof (state)\nthis:\n  t = t \\<cdot> Var\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<sigma> = t", "have \"\\<dots> = t \\<cdot> \\<sigma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<cdot> Var = t \\<cdot> \\<sigma>", "by (rule term_subst_eq, insert assms[unfolded ground_vars_term_empty], auto)"], ["proof (state)\nthis:\n  t \\<cdot> Var = t \\<cdot> \\<sigma>\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<sigma> = t", "finally"], ["proof (chain)\npicking this:\n  t = t \\<cdot> \\<sigma>", "show ?thesis"], ["proof (prove)\nusing this:\n  t = t \\<cdot> \\<sigma>\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<sigma> = t", "by simp"], ["proof (state)\nthis:\n  t \\<cdot> \\<sigma> = t\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  A \\<^emph>\\<open>signature\\<close> is a set of function symbol/arity pairs, where the arity of a function symbol,\n  denotes the number of arguments it expects.\n\\<close>"], ["", "type_synonym 'f sig = \"('f \\<times> nat) set\""], ["", "text \\<open>The set of all function symbol/ arity pairs occurring in a term.\\<close>"], ["", "fun funas_term :: \"('f, 'v) term \\<Rightarrow> 'f sig\"\n  where\n    \"funas_term (Var _) = {}\" |\n    \"funas_term (Fun f ts) = {(f, length ts)} \\<union> \\<Union>(set (map funas_term ts))\""], ["", "lemma supt_imp_funas_term_subset:\n  assumes \"s \\<rhd> t\"\n  shows \"funas_term t \\<subseteq> funas_term s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. funas_term t \\<subseteq> funas_term s", "using assms"], ["proof (prove)\nusing this:\n  s \\<rhd> t\n\ngoal (1 subgoal):\n 1. funas_term t \\<subseteq> funas_term s", "by (induct) auto"], ["", "lemma supteq_imp_funas_term_subset[simp]:\n  assumes \"s \\<unrhd> t\"\n  shows \"funas_term t \\<subseteq> funas_term s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. funas_term t \\<subseteq> funas_term s", "using assms"], ["proof (prove)\nusing this:\n  s \\<unrhd> t\n\ngoal (1 subgoal):\n 1. funas_term t \\<subseteq> funas_term s", "by (induct) auto"], ["", "text \\<open>The set of all function symbol/arity pairs occurring in a context.\\<close>"], ["", "fun funas_ctxt :: \"('f, 'v) ctxt \\<Rightarrow> 'f sig\"\n  where\n    \"funas_ctxt Hole = {}\" |\n    \"funas_ctxt (More f ss1 D ss2) = {(f, Suc (length (ss1 @ ss2)))}\n     \\<union> funas_ctxt D \\<union> \\<Union>(set (map funas_term (ss1 @ ss2)))\""], ["", "lemma funas_term_ctxt_apply [simp]:\n  \"funas_term (C\\<langle>t\\<rangle>) = funas_ctxt C \\<union> funas_term t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. funas_term C\\<langle>t\\<rangle> = funas_ctxt C \\<union> funas_term t", "proof (induct t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       funas_term C\\<langle>Var x\\<rangle> =\n       funas_ctxt C \\<union> funas_term (Var x)\n 2. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           funas_term C\\<langle>x2a\\<rangle> =\n           funas_ctxt C \\<union> funas_term x2a) \\<Longrightarrow>\n       funas_term C\\<langle>Fun x1a x2\\<rangle> =\n       funas_ctxt C \\<union> funas_term (Fun x1a x2)", "case (Var x)"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<And>x.\n       funas_term C\\<langle>Var x\\<rangle> =\n       funas_ctxt C \\<union> funas_term (Var x)\n 2. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           funas_term C\\<langle>x2a\\<rangle> =\n           funas_ctxt C \\<union> funas_term x2a) \\<Longrightarrow>\n       funas_term C\\<langle>Fun x1a x2\\<rangle> =\n       funas_ctxt C \\<union> funas_term (Fun x1a x2)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. funas_term C\\<langle>Var x\\<rangle> =\n    funas_ctxt C \\<union> funas_term (Var x)", "by (induct C) auto"], ["proof (state)\nthis:\n  funas_term C\\<langle>Var x\\<rangle> =\n  funas_ctxt C \\<union> funas_term (Var x)\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           funas_term C\\<langle>x2a\\<rangle> =\n           funas_ctxt C \\<union> funas_term x2a) \\<Longrightarrow>\n       funas_term C\\<langle>Fun x1a x2\\<rangle> =\n       funas_ctxt C \\<union> funas_term (Fun x1a x2)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           funas_term C\\<langle>x2a\\<rangle> =\n           funas_ctxt C \\<union> funas_term x2a) \\<Longrightarrow>\n       funas_term C\\<langle>Fun x1a x2\\<rangle> =\n       funas_ctxt C \\<union> funas_term (Fun x1a x2)", "case (Fun f ts)"], ["proof (state)\nthis:\n  ?x2a \\<in> set ts \\<Longrightarrow>\n  funas_term C\\<langle>?x2a\\<rangle> = funas_ctxt C \\<union> funas_term ?x2a\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           funas_term C\\<langle>x2a\\<rangle> =\n           funas_ctxt C \\<union> funas_term x2a) \\<Longrightarrow>\n       funas_term C\\<langle>Fun x1a x2\\<rangle> =\n       funas_ctxt C \\<union> funas_term (Fun x1a x2)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. funas_term C\\<langle>Fun f ts\\<rangle> =\n    funas_ctxt C \\<union> funas_term (Fun f ts)", "by (induct C arbitrary: f ts) auto"], ["proof (state)\nthis:\n  funas_term C\\<langle>Fun f ts\\<rangle> =\n  funas_ctxt C \\<union> funas_term (Fun f ts)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma funas_term_subst:\n  \"funas_term (t \\<cdot> \\<sigma>) = funas_term t \\<union> \\<Union>(funas_term ` \\<sigma> ` vars_term t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. funas_term (t \\<cdot> \\<sigma>) =\n    funas_term t \\<union> \\<Union> (funas_term ` \\<sigma> ` vars_term t)", "by (induct t) auto"], ["", "lemma funas_ctxt_compose [simp]:\n  \"funas_ctxt (C \\<circ>\\<^sub>c D) = funas_ctxt C \\<union> funas_ctxt D\""], ["proof (prove)\ngoal (1 subgoal):\n 1. funas_ctxt (C \\<circ>\\<^sub>c D) = funas_ctxt C \\<union> funas_ctxt D", "by (induct C) auto"], ["", "lemma funas_ctxt_subst [simp]:\n  \"funas_ctxt (C \\<cdot>\\<^sub>c \\<sigma>) = funas_ctxt C \\<union> \\<Union>(funas_term ` \\<sigma> ` vars_ctxt C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. funas_ctxt (C \\<cdot>\\<^sub>c \\<sigma>) =\n    funas_ctxt C \\<union> \\<Union> (funas_term ` \\<sigma> ` vars_ctxt C)", "by (induct C, auto simp: funas_term_subst)"], ["", "end"]]}