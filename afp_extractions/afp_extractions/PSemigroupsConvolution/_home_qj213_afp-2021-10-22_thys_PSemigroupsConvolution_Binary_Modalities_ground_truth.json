{"file_name": "/home/qj213/afp-2021-10-22/thys/PSemigroupsConvolution/Binary_Modalities.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/PSemigroupsConvolution", "problem_names": ["lemma SUP_is_Sup: \"(SUP f\\<in>F. f y) = \\<Squnion>{(f::'a \\<Rightarrow> 'b::proto_near_quantale) y |f. f \\<in> F}\"", "lemma bmod_auxl: \"{x \\<cdot> g z |x. \\<exists>f. x = f y \\<and> f \\<in> F} = {f y \\<cdot> g z |f. f \\<in> F}\"", "lemma bmod_auxr: \"{f y \\<cdot> x |x. \\<exists>g. x = g z \\<and> g \\<in> G} = {f y \\<cdot> g z |g. g \\<in> G}\"", "lemma bmod_assoc_aux1: \n  \"\\<Squnion>{\\<Squnion>{(f :: 'a \\<Rightarrow> 'b::proto_near_quantale) u \\<cdot> g v \\<cdot> h w |u v. R y u v} |y w. R x y w} \n     = \\<Squnion>{(f u \\<cdot> g v) \\<cdot> h w |u v y w. R y u v \\<and> R x y w}\"", "lemma bmod_assoc_aux2:   \n  \"\\<Squnion>{\\<Squnion>{(f::'a \\<Rightarrow> 'b::proto_near_quantale) u \\<cdot> g v \\<cdot> h w |v w. R y v w} |u y. R x u y} \n     = \\<Squnion>{f u \\<cdot> g v \\<cdot> h w |u v w y. R y v w \\<and> R x u y}\"", "lemma bmod_un_rel: \"\\<otimes> (R \\<squnion> S) = \\<otimes> R \\<squnion> \\<otimes> S\"", "lemma bmod_Un_rel: \"\\<otimes> (\\<Squnion>\\<R>) f g x = \\<Squnion>{\\<otimes> R f g x |R. R \\<in> \\<R>}\"", "lemma bmod_sup_fun1: \"\\<otimes> R (f \\<squnion> g) = \\<otimes> R f \\<squnion> \\<otimes> R g\"", "lemma bmod_Sup_fun1: \"\\<otimes> R (\\<Squnion>\\<F>) g x = \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}\"", "lemma bmod_sup_fun2: \"\\<otimes> R (f::'a \\<Rightarrow> 'b::weak_proto_quantale) (g \\<squnion> h) = \\<otimes> R f g \\<squnion> \\<otimes> R f h\"", "lemma bmod_Sup_fun2_weak:\n  assumes \"\\<G> \\<noteq> {}\"\n  shows \"\\<otimes> R f (\\<Squnion>\\<G>) x = \\<Squnion>{\\<otimes> R f (g::'a \\<Rightarrow> 'b::weak_proto_quantale) x |g. g \\<in> \\<G>}\"", "lemma bmod_Sup_fun2: \"\\<otimes> R f (\\<Squnion>\\<G>) x = \\<Squnion>{\\<otimes> R f (g::'a \\<Rightarrow> 'b::proto_quantale) x |g. g \\<in> \\<G>}\"", "lemma bmod_comp_bres_galois: \"(\\<forall>x. \\<otimes> R f g x \\<le> h x) \\<longleftrightarrow> (\\<forall>x. g x \\<le> \\<lhd> R f h x)\"", "lemma bmod_comp_bres_galois: \"(\\<forall>x. \\<otimes> R (f::'a \\<Rightarrow> 'b::proto_quantale) g x \\<le> h x) \\<longleftrightarrow> (\\<forall>x. g x \\<le> \\<lhd> R f h x)\"", "lemma bmod_comp_fres_galois: \"(\\<forall>x. \\<otimes> R f g x \\<le> h x) \\<longleftrightarrow> (\\<forall>x. f x \\<le> \\<rhd> R h g x)\"", "lemma rel_fun_Sup_distl_weak: \n  \"G \\<noteq> {} \\<Longrightarrow> (f::'a \\<Rightarrow> 'b::weak_proto_quantale) \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}\"", "lemma rel_fun_Sup_distl: \"(f::'a \\<Rightarrow> 'b::proto_quantale) \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}\"", "lemma rel_fun_Sup_distr: \"\\<Squnion>G \\<star> (f::'a \\<Rightarrow> 'b::proto_near_quantale) = \\<Squnion>{g \\<star> f |g. g \\<in> G}\"", "lemma bmod_assoc: \"\\<otimes> \\<rho> (\\<otimes> \\<rho> (f::'a \\<Rightarrow> 'b::weak_quantale) g) h x = \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x\"", "lemma bmod_assoc: \"\\<otimes> \\<rho> (\\<otimes> \\<rho> (f::'a \\<Rightarrow> 'b::quantale) g) h x = \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x\"", "lemma rel_fun_assoc: \"((f :: 'a \\<Rightarrow> 'b::quantale) \\<star> g) \\<star> h = f \\<star> (g \\<star> h)\"", "lemma \"\\<otimes> R (\\<otimes> R f f) f x = \\<otimes> R f (\\<otimes> R f f) x\"", "lemma xi_prop: \"e1 \\<in> \\<xi> \\<Longrightarrow> e2 \\<in> \\<xi> \\<Longrightarrow> e1 \\<noteq> e2 \\<Longrightarrow> \\<not> \\<rho> x e1 e2 \\<and> \\<not> \\<rho> x e2 e1\"", "lemma bmod_onel: \"\\<otimes> \\<rho> f (\\<delta>::'a \\<Rightarrow> 'b::unital_weak_quantale) x = f x\"", "lemma bmod_onel: \"\\<otimes> \\<rho> f (\\<delta>::'a \\<Rightarrow> 'b::unital_quantale) x = f x\"", "lemma  bmod_oner: \"\\<otimes> \\<rho> \\<delta> f x = f x\"", "lemma pid_unitl [simp]: \"\\<delta> \\<star> f = f\"", "lemma pid_unitr [simp]: \"f \\<star> (\\<delta>::'a \\<Rightarrow> 'b::unital_quantale) = f\"", "lemma bmod_assoc_weak_aux: \n  \"f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} = \\<Squnion>{(f::'a \\<Rightarrow> 'b::weak_quantale) u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z}\"", "lemma bmod_assoc_weak: \"\\<otimes> \\<rho> (\\<otimes> \\<rho> (f::'a \\<Rightarrow> 'b::weak_quantale) g) h x = \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x\"", "lemma rel_fun_assoc_weak: \"((f :: 'a \\<Rightarrow> 'b::weak_quantale) \\<star> g) \\<star> h = f \\<star> (g \\<star> h)\"", "lemma (in rel_semigroup) \"\\<exists>id. \\<forall>f x. (\\<otimes> \\<rho> f id x = f x \\<and> \\<otimes> \\<rho> id f x = f x)\"", "lemma bmod_comm: \"\\<otimes> \\<rho> (f::'a \\<Rightarrow> 'b::ab_quantale) g = \\<otimes> \\<rho> g f\"", "lemma \"\\<otimes> \\<rho> f g = \\<otimes> \\<rho> g f\"", "lemma bmod_bres_fres_eq: \"\\<lhd> \\<rho> (f::'a \\<Rightarrow> 'b::ab_quantale) g = \\<rhd> \\<rho> g f\"", "lemma rel_fun_comm: \"(f :: 'a \\<Rightarrow> 'b::ab_quantale) \\<star> g = g \\<star> f\""], "translations": [["", "lemma SUP_is_Sup: \"(SUP f\\<in>F. f y) = \\<Squnion>{(f::'a \\<Rightarrow> 'b::proto_near_quantale) y |f. f \\<in> F}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (SUP f\\<in>F. f y) = \\<Squnion>{f y |f. f \\<in> F}", "proof (rule antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. (SUP f\\<in>F. f y) \\<le> \\<Squnion>{f y |f. f \\<in> F}\n 2. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "fix f::\"'a \\<Rightarrow> 'b::proto_near_quantale\""], ["proof (state)\ngoal (2 subgoals):\n 1. (SUP f\\<in>F. f y) \\<le> \\<Squnion>{f y |f. f \\<in> F}\n 2. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "have \"f \\<in> F \\<Longrightarrow> f y \\<in> {f y |f. f \\<in> F}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> F \\<Longrightarrow> f y \\<in> {f y |f. f \\<in> F}", "by (simp add: Setcompr_eq_image)"], ["proof (state)\nthis:\n  f \\<in> F \\<Longrightarrow> f y \\<in> {f y |f. f \\<in> F}\n\ngoal (2 subgoals):\n 1. (SUP f\\<in>F. f y) \\<le> \\<Squnion>{f y |f. f \\<in> F}\n 2. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "hence \"f \\<in> F \\<Longrightarrow> f y \\<le> \\<Squnion>{f y |f. f \\<in> F}\""], ["proof (prove)\nusing this:\n  f \\<in> F \\<Longrightarrow> f y \\<in> {f y |f. f \\<in> F}\n\ngoal (1 subgoal):\n 1. f \\<in> F \\<Longrightarrow> f y \\<le> \\<Squnion>{f y |f. f \\<in> F}", "by (simp add: Sup_upper)"], ["proof (state)\nthis:\n  f \\<in> F \\<Longrightarrow> f y \\<le> \\<Squnion>{f y |f. f \\<in> F}\n\ngoal (2 subgoals):\n 1. (SUP f\\<in>F. f y) \\<le> \\<Squnion>{f y |f. f \\<in> F}\n 2. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "thus \"(SUP f\\<in>F. f y) \\<le> \\<Squnion>{(f::'a \\<Rightarrow> 'b::proto_near_quantale) y |f. f \\<in> F}\""], ["proof (prove)\nusing this:\n  f \\<in> F \\<Longrightarrow> f y \\<le> \\<Squnion>{f y |f. f \\<in> F}\n\ngoal (1 subgoal):\n 1. (SUP f\\<in>F. f y) \\<le> \\<Squnion>{f y |f. f \\<in> F}", "by (simp add: Setcompr_eq_image)"], ["proof (state)\nthis:\n  (SUP f\\<in>F. f y) \\<le> \\<Squnion>{f y |f. f \\<in> F}\n\ngoal (1 subgoal):\n 1. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "have \"x \\<in> {f y |f. f \\<in> F} \\<Longrightarrow> x \\<le> (SUP f\\<in>F. f y) \""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> {f y |f. f \\<in> F} \\<Longrightarrow> x \\<le> (SUP f\\<in>F. f y)", "using mk_disjoint_insert"], ["proof (prove)\nusing this:\n  ?a \\<in> ?A \\<Longrightarrow>\n  \\<exists>B. ?A = insert ?a B \\<and> ?a \\<notin> B\n\ngoal (1 subgoal):\n 1. x \\<in> {f y |f. f \\<in> F} \\<Longrightarrow> x \\<le> (SUP f\\<in>F. f y)", "by force"], ["proof (state)\nthis:\n  x \\<in> {f y |f. f \\<in> F} \\<Longrightarrow> x \\<le> (SUP f\\<in>F. f y)\n\ngoal (1 subgoal):\n 1. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "thus \"Sup {(f::'a \\<Rightarrow> 'b::proto_near_quantale) y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)\""], ["proof (prove)\nusing this:\n  x \\<in> {f y |f. f \\<in> F} \\<Longrightarrow> x \\<le> (SUP f\\<in>F. f y)\n\ngoal (1 subgoal):\n 1. \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)", "by (simp add: Setcompr_eq_image)"], ["proof (state)\nthis:\n  \\<Squnion>{f y |f. f \\<in> F} \\<le> (SUP f\\<in>F. f y)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bmod_auxl: \"{x \\<cdot> g z |x. \\<exists>f. x = f y \\<and> f \\<in> F} = {f y \\<cdot> g z |f. f \\<in> F}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<cdot> g z |x. \\<exists>f. x = f y \\<and> f \\<in> F} =\n    {f y \\<cdot> g z |f. f \\<in> F}", "by force"], ["", "lemma bmod_auxr: \"{f y \\<cdot> x |x. \\<exists>g. x = g z \\<and> g \\<in> G} = {f y \\<cdot> g z |g. g \\<in> G}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {f y \\<cdot> x |x. \\<exists>g. x = g z \\<and> g \\<in> G} =\n    {f y \\<cdot> g z |g. g \\<in> G}", "by force"], ["", "lemma bmod_assoc_aux1: \n  \"\\<Squnion>{\\<Squnion>{(f :: 'a \\<Rightarrow> 'b::proto_near_quantale) u \\<cdot> g v \\<cdot> h w |u v. R y u v} |y w. R x y w} \n     = \\<Squnion>{(f u \\<cdot> g v) \\<cdot> h w |u v y w. R y u v \\<and> R x y w}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |u v. R y u v} |y w.\n               R x y w} =\n    \\<Squnion>{uu_.\n               \\<exists>u v y w.\n                  uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                  R y u v \\<and> R x y w}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |u v. R y u v} |y w.\n               R x y w}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y w.\n                        uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                        R y u v \\<and> R x y w}\n 2. \\<Squnion>{uu_.\n               \\<exists>u v y w.\n                  uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                  R y u v \\<and> R x y w}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |u v. R y u v} |\n                     y w. R x y w}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y w.\n       R x y w \\<Longrightarrow>\n       \\<Squnion>{f u \\<cdot> g v \\<cdot> h w |u v. R y u v}\n       \\<le> \\<Squnion>{uu_.\n                        \\<exists>u v y w.\n                           uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                           R y u v \\<and> R x y w}\n 2. \\<Squnion>{uu_.\n               \\<exists>u v y w.\n                  uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                  R y u v \\<and> R x y w}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |u v. R y u v} |\n                     y w. R x y w}", "apply (intro Sup_least Sup_upper, force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v y w.\n                  uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                  R y u v \\<and> R x y w}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |u v. R y u v} |\n                     y w. R x y w}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa u v y w.\n       \\<lbrakk>R y u v; R x y w\\<rbrakk>\n       \\<Longrightarrow> f u \\<cdot> g v \\<cdot> h w\n                         \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot>\n               h w |\n               u v. R y u v} |\n    y w. R x y w}", "by (rule Sup_upper2, auto)+"], ["", "lemma bmod_assoc_aux2:   \n  \"\\<Squnion>{\\<Squnion>{(f::'a \\<Rightarrow> 'b::proto_near_quantale) u \\<cdot> g v \\<cdot> h w |v w. R y v w} |u y. R x u y} \n     = \\<Squnion>{f u \\<cdot> g v \\<cdot> h w |u v w y. R y v w \\<and> R x u y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |v w. R y v w} |u y.\n               R x u y} =\n    \\<Squnion>{uu_.\n               \\<exists>u v w y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                  R y v w \\<and> R x u y}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |v w. R y v w} |u y.\n               R x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v w y.\n                        uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                        R y v w \\<and> R x u y}\n 2. \\<Squnion>{uu_.\n               \\<exists>u v w y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                  R y v w \\<and> R x u y}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |v w. R y v w} |\n                     u y. R x u y}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa u y.\n       R x u y \\<Longrightarrow>\n       \\<Squnion>{f u \\<cdot> g v \\<cdot> h w |v w. R y v w}\n       \\<le> \\<Squnion>{uu_.\n                        \\<exists>u v w y.\n                           uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                           R y v w \\<and> R x u y}\n 2. \\<Squnion>{uu_.\n               \\<exists>u v w y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                  R y v w \\<and> R x u y}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |v w. R y v w} |\n                     u y. R x u y}", "apply (intro Sup_least Sup_upper, force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v w y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h w \\<and>\n                  R y v w \\<and> R x u y}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h w |v w. R y v w} |\n                     u y. R x u y}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa u v w y.\n       \\<lbrakk>R y v w; R x u y\\<rbrakk>\n       \\<Longrightarrow> f u \\<cdot> g v \\<cdot> h w\n                         \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot>\n               h w |\n               v w. R y v w} |\n    u y. R x u y}", "by (rule Sup_upper2, auto)+"], ["", "subsection \\<open>Binary Modalities\\<close>"], ["", "text \\<open>Most of the development in the papers mentioned in the introduction generalises to proto-near-quantales. Binary modalities \nare interesting for various substructural logics over ternary Kripke frames. They also arise, e.g., \nas chop modalities in interval logics or as separation conjunction in separation logic. Binary modalities can be understood as a convolution\noperation parametrised by a ternary operation. Our development yields a \nunifying framework.\\<close>"], ["", "text \\<open>We would prefer a notation that is more similar to our articles, that is, $f\\ast_R g$, but we don' know how we could \nindex an infix operator by a variable in Isabelle.\\<close>"], ["", "definition bmod_comp :: \"('a \\<Rightarrow> 'b \\<Rightarrow> 'c \\<Rightarrow> bool) \\<Rightarrow> ('b \\<Rightarrow> 'd::proto_near_quantale) \\<Rightarrow> ('c \\<Rightarrow> 'd) \\<Rightarrow> 'a \\<Rightarrow> 'd\" (\"\\<otimes>\") where \n  \"\\<otimes> R f g x = \\<Squnion>{f y \\<cdot> g z |y z. R x y z}\""], ["", "definition bmod_bres :: \"('c \\<Rightarrow> 'b \\<Rightarrow> 'a \\<Rightarrow> bool) \\<Rightarrow> ('b \\<Rightarrow> 'd::proto_near_quantale) \\<Rightarrow> ('c \\<Rightarrow> 'd) \\<Rightarrow> 'a \\<Rightarrow> 'd\" (\"\\<lhd>\") where \n  \"\\<lhd> R f g x = \\<Sqinter>{(f y) \\<rightarrow> (g z) |y z. R z y x}\""], ["", "definition bmod_fres :: \"('b \\<Rightarrow> 'a \\<Rightarrow> 'c \\<Rightarrow> bool)  \\<Rightarrow> ('b \\<Rightarrow> 'd::proto_near_quantale) \\<Rightarrow> ('c \\<Rightarrow> 'd) \\<Rightarrow> 'a \\<Rightarrow> 'd\" (\"\\<rhd>\")where \n  \"\\<rhd> R f g x = \\<Sqinter>{(f y) \\<leftarrow> (g z) |y z. R y x z}\""], ["", "lemma bmod_un_rel: \"\\<otimes> (R \\<squnion> S) = \\<otimes> R \\<squnion> \\<otimes> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> (R \\<squnion> S) = \\<otimes> R \\<squnion> \\<otimes> S", "apply  (clarsimp simp: fun_eq_iff bmod_comp_def Sup_union_distrib[symmetric] Collect_disj_eq[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa xb.\n       \\<Squnion>{x y \\<cdot> xa z |y z. R xb y z \\<or> S xb y z} =\n       \\<Squnion>{uu_.\n                  (\\<exists>y z.\n                      uu_ = x y \\<cdot> xa z \\<and> R xb y z) \\<or>\n                  (\\<exists>y z. uu_ = x y \\<cdot> xa z \\<and> S xb y z)}", "by (metis (no_types, lifting))"], ["", "lemma bmod_Un_rel: \"\\<otimes> (\\<Squnion>\\<R>) f g x = \\<Squnion>{\\<otimes> R f g x |R. R \\<in> \\<R>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> (\\<Squnion>\\<R>) f g x =\n    \\<Squnion>{\\<otimes> R f g x |R. R \\<in> \\<R>}", "apply (simp add: bmod_comp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{f y \\<cdot> g z |y z. \\<exists>f\\<in>\\<R>. f x y z} =\n    \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |R. R \\<in> \\<R>}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{f y \\<cdot> g z |y z. \\<exists>f\\<in>\\<R>. f x y z}\n    \\<le> \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |R.\n                     R \\<in> \\<R>}\n 2. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |R. R \\<in> \\<R>}\n    \\<le> \\<Squnion>{f y \\<cdot> g z |y z. \\<exists>f\\<in>\\<R>. f x y z}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y z fa.\n       \\<lbrakk>fa \\<in> \\<R>; fa x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<cdot> g z\n                         \\<le> \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z.\n               R x y z} |\n    R. R \\<in> \\<R>}\n 2. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |R. R \\<in> \\<R>}\n    \\<le> \\<Squnion>{f y \\<cdot> g z |y z. \\<exists>f\\<in>\\<R>. f x y z}", "apply (rule Sup_upper2, force)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y z fa.\n       \\<lbrakk>fa \\<in> \\<R>; fa x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<cdot> g z\n                         \\<le> \\<Squnion>{f y \\<cdot> g z |y z. fa x y z}\n 2. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |R. R \\<in> \\<R>}\n    \\<le> \\<Squnion>{f y \\<cdot> g z |y z. \\<exists>f\\<in>\\<R>. f x y z}", "apply (rule Sup_upper, force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |R. R \\<in> \\<R>}\n    \\<le> \\<Squnion>{f y \\<cdot> g z |y z. \\<exists>f\\<in>\\<R>. f x y z}", "apply (rule Sup_least, safe)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa R xaa y z.\n       \\<lbrakk>R \\<in> \\<R>; R x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<cdot> g z\n                         \\<le> \\<Squnion>{f y \\<cdot> g z |y z.\n    \\<exists>f\\<in>\\<R>. f x y z}", "by (metis (mono_tags, lifting) Sup_upper mem_Collect_eq)"], ["", "lemma bmod_sup_fun1: \"\\<otimes> R (f \\<squnion> g) = \\<otimes> R f \\<squnion> \\<otimes> R g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R (f \\<squnion> g) = \\<otimes> R f \\<squnion> \\<otimes> R g", "apply (clarsimp simp add: fun_eq_iff bmod_comp_def sup_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z.\n                  R xa y z} =\n       \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n       \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z. R xa y z}\n       \\<le> \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n             \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n 2. \\<And>x xa.\n       \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n       \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n       \\<le> \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z.\n                        R xa y z}", "apply (intro Sup_least, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa xb y z.\n       R xa y z \\<Longrightarrow>\n       f y \\<cdot> x z \\<squnion> g y \\<cdot> x z\n       \\<le> \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n             \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n 2. \\<And>x xa.\n       \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n       \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n       \\<le> \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z.\n                        R xa y z}", "apply (rule sup_least)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa xb y z.\n       R xa y z \\<Longrightarrow>\n       f y \\<cdot> x z\n       \\<le> \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n             \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n 2. \\<And>x xa xb y z.\n       R xa y z \\<Longrightarrow>\n       g y \\<cdot> x z\n       \\<le> \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n             \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n 3. \\<And>x xa.\n       \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n       \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n       \\<le> \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z.\n                        R xa y z}", "apply (intro le_supI1 Sup_upper, force)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa xb y z.\n       R xa y z \\<Longrightarrow>\n       g y \\<cdot> x z\n       \\<le> \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n             \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n 2. \\<And>x xa.\n       \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n       \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n       \\<le> \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z.\n                        R xa y z}", "apply (intro le_supI2 Sup_upper, force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<Squnion>{f y \\<cdot> x z |y z. R xa y z} \\<squnion>\n       \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n       \\<le> \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z.\n                        R xa y z}", "apply (rule sup_least)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<Squnion>{f y \\<cdot> x z |y z. R xa y z}\n       \\<le> \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z.\n                        R xa y z}\n 2. \\<And>x xa.\n       \\<Squnion>{g y \\<cdot> x z |y z. R xa y z}\n       \\<le> \\<Squnion>{f y \\<cdot> x z \\<squnion> g y \\<cdot> x z |y z.\n                        R xa y z}", "by (intro Sup_least, safe, rule Sup_upper2, force, simp)+"], ["", "lemma bmod_Sup_fun1: \"\\<otimes> R (\\<Squnion>\\<F>) g x = \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>\\<F>) g x =\n    \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>\\<F>) g x =\n    \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}", "have \"\\<otimes> R (\\<Squnion>{f. f \\<in> \\<F>}) g x = \\<Squnion>{\\<Squnion>{f y |f. f \\<in> \\<F>} \\<cdot> g z |y z. R x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>{f. f \\<in> \\<F>}) g x =\n    \\<Squnion>{\\<Squnion>{f y |f. f \\<in> \\<F>} \\<cdot> g z |y z. R x y z}", "by (simp add: bmod_comp_def SUP_is_Sup)"], ["proof (state)\nthis:\n  \\<otimes> R (\\<Squnion>{f. f \\<in> \\<F>}) g x =\n  \\<Squnion>{\\<Squnion>{f y |f. f \\<in> \\<F>} \\<cdot> g z |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>\\<F>) g x =\n    \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}", "also"], ["proof (state)\nthis:\n  \\<otimes> R (\\<Squnion>{f. f \\<in> \\<F>}) g x =\n  \\<Squnion>{\\<Squnion>{f y |f. f \\<in> \\<F>} \\<cdot> g z |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>\\<F>) g x =\n    \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}", "have \"... = \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |f. f \\<in> \\<F>} |y z. R x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f y |f. f \\<in> \\<F>} \\<cdot> g z |y z. R x y z} =\n    \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |f. f \\<in> \\<F>} |y z. R x y z}", "by (simp add: Sup_distr bmod_auxl)"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f y |f. f \\<in> \\<F>} \\<cdot> g z |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |f. f \\<in> \\<F>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>\\<F>) g x =\n    \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}", "also"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f y |f. f \\<in> \\<F>} \\<cdot> g z |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |f. f \\<in> \\<F>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>\\<F>) g x =\n    \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}", "have \"... = \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |f. f \\<in> \\<F>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |f. f \\<in> \\<F>} |y z. R x y z} =\n    \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |f. f \\<in> \\<F>}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |f. f \\<in> \\<F>} |y z. R x y z}\n    \\<le> \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |f.\n                     f \\<in> \\<F>}\n 2. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |f. f \\<in> \\<F>}\n    \\<le> \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |f. f \\<in> \\<F>} |y z.\n                     R x y z}", "by ((rule Sup_least, safe)+ , (rule Sup_upper2, force, rule Sup_upper, force))+"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |f. f \\<in> \\<F>} |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |f. f \\<in> \\<F>}\n\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>\\<F>) g x =\n    \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}", "finally"], ["proof (chain)\npicking this:\n  \\<otimes> R (\\<Squnion>{f. f \\<in> \\<F>}) g x =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |f. f \\<in> \\<F>}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<otimes> R (\\<Squnion>{f. f \\<in> \\<F>}) g x =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |f. f \\<in> \\<F>}\n\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<Squnion>\\<F>) g x =\n    \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}", "by (simp add: bmod_comp_def)"], ["proof (state)\nthis:\n  \\<otimes> R (\\<Squnion>\\<F>) g x =\n  \\<Squnion>{\\<otimes> R f g x |f. f \\<in> \\<F>}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bmod_sup_fun2: \"\\<otimes> R (f::'a \\<Rightarrow> 'b::weak_proto_quantale) (g \\<squnion> h) = \\<otimes> R f g \\<squnion> \\<otimes> R f h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R f (g \\<squnion> h) =\n    \\<otimes> R f g \\<squnion> \\<otimes> R f h", "apply (clarsimp simp add: fun_eq_iff bmod_comp_def sup_distl)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z.\n                  R x y z} =\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n       \\<Squnion>{f y \\<cdot> h z |y z. R x y z}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z. R x y z}\n       \\<le> \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n             \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n 2. \\<And>x.\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n       \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n       \\<le> \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z.\n                        R x y z}", "apply (intro Sup_least, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y z.\n       R x y z \\<Longrightarrow>\n       f y \\<cdot> g z \\<squnion> f y \\<cdot> h z\n       \\<le> \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n             \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n 2. \\<And>x.\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n       \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n       \\<le> \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z.\n                        R x y z}", "apply (rule sup_least)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa y z.\n       R x y z \\<Longrightarrow>\n       f y \\<cdot> g z\n       \\<le> \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n             \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n 2. \\<And>x xa y z.\n       R x y z \\<Longrightarrow>\n       f y \\<cdot> h z\n       \\<le> \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n             \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n 3. \\<And>x.\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n       \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n       \\<le> \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z.\n                        R x y z}", "apply (intro le_supI1 Sup_upper, force)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y z.\n       R x y z \\<Longrightarrow>\n       f y \\<cdot> h z\n       \\<le> \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n             \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n 2. \\<And>x.\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n       \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n       \\<le> \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z.\n                        R x y z}", "apply (intro le_supI2 Sup_upper, force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<squnion>\n       \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n       \\<le> \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z.\n                        R x y z}", "apply (rule sup_least)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z}\n       \\<le> \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z.\n                        R x y z}\n 2. \\<And>x.\n       \\<Squnion>{f y \\<cdot> h z |y z. R x y z}\n       \\<le> \\<Squnion>{f y \\<cdot> g z \\<squnion> f y \\<cdot> h z |y z.\n                        R x y z}", "by (intro Sup_least, safe, rule Sup_upper2, force, simp)+"], ["", "lemma bmod_Sup_fun2_weak:\n  assumes \"\\<G> \\<noteq> {}\"\n  shows \"\\<otimes> R f (\\<Squnion>\\<G>) x = \\<Squnion>{\\<otimes> R f (g::'a \\<Rightarrow> 'b::weak_proto_quantale) x |g. g \\<in> \\<G>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "have set: \"\\<And>z. {g z |g::'a \\<Rightarrow> 'b. g \\<in> \\<G>} \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z. {g z |g. g \\<in> \\<G>} \\<noteq> {}", "using assms"], ["proof (prove)\nusing this:\n  \\<G> \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>z. {g z |g. g \\<in> \\<G>} \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  {g ?z |g. g \\<in> \\<G>} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "have \"\\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x = \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n    \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z}", "by (simp add: bmod_comp_def SUP_is_Sup)"], ["proof (state)\nthis:\n  \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n  \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "also"], ["proof (state)\nthis:\n  \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n  \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "have \"... = \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z} =\n    \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}", "by (simp add: weak_Sup_distl[OF set] bmod_auxr)"], ["proof (state)\nthis:\n  \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "also"], ["proof (state)\nthis:\n  \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "have \"... = \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z} =\n    \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}\n    \\<le> \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g.\n                     g \\<in> \\<G>}\n 2. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}\n    \\<le> \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z.\n                     R x y z}", "by ((rule Sup_least, safe)+, (rule Sup_upper2, force, rule Sup_upper, force))+"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "finally"], ["proof (chain)\npicking this:\n  \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "by (auto simp: bmod_comp_def)"], ["proof (state)\nthis:\n  \\<otimes> R f (\\<Squnion>\\<G>) x =\n  \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bmod_Sup_fun2: \"\\<otimes> R f (\\<Squnion>\\<G>) x = \\<Squnion>{\\<otimes> R f (g::'a \\<Rightarrow> 'b::proto_quantale) x |g. g \\<in> \\<G>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "have \"\\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x = \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n    \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z}", "by (simp add:  bmod_comp_def SUP_is_Sup)"], ["proof (state)\nthis:\n  \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n  \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "also"], ["proof (state)\nthis:\n  \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n  \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "have \"... = \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z} =\n    \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}", "by (simp add: Sup_distl bmod_auxr)"], ["proof (state)\nthis:\n  \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "also"], ["proof (state)\nthis:\n  \\<Squnion>{f y \\<cdot> \\<Squnion>{g z |g. g \\<in> \\<G>} |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "have \"... =  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z} =\n    \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z}\n    \\<le> \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g.\n                     g \\<in> \\<G>}\n 2. \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}\n    \\<le> \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z.\n                     R x y z}", "by ((rule Sup_least, safe)+, (rule Sup_upper2, force, rule Sup_upper, force))+"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |g. g \\<in> \\<G>} |y z. R x y z} =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "finally"], ["proof (chain)\npicking this:\n  \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<otimes> R f (\\<Squnion>{g. g \\<in> \\<G>}) x =\n  \\<Squnion>{\\<Squnion>{f y \\<cdot> g z |y z. R x y z} |g. g \\<in> \\<G>}\n\ngoal (1 subgoal):\n 1. \\<otimes> R f (\\<Squnion>\\<G>) x =\n    \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}", "by (auto simp: bmod_comp_def)"], ["proof (state)\nthis:\n  \\<otimes> R f (\\<Squnion>\\<G>) x =\n  \\<Squnion>{\\<otimes> R f g x |g. g \\<in> \\<G>}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bmod_comp_bres_galois: \"(\\<forall>x. \\<otimes> R f g x \\<le> h x) \\<longleftrightarrow> (\\<forall>x. g x \\<le> \\<lhd> R f h x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. g x \\<le> \\<lhd> R f h x)", "(* nitpick[expect=genuine] *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. g x \\<le> \\<lhd> R f h x)", "oops"], ["", "text \\<open>The following Galois connection requires functions into proto-quantales.\\<close>"], ["", "lemma bmod_comp_bres_galois: \"(\\<forall>x. \\<otimes> R (f::'a \\<Rightarrow> 'b::proto_quantale) g x \\<le> h x) \\<longleftrightarrow> (\\<forall>x. g x \\<le> \\<lhd> R f h x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. g x \\<le> \\<lhd> R f h x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. g x \\<le> \\<lhd> R f h x)", "have \"(\\<forall>x. \\<otimes> R f g x \\<le> h x) \\<longleftrightarrow> (\\<forall>x y z. R x y z \\<longrightarrow> (f y) \\<cdot> (g z) \\<le> h x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x)", "apply (simp add: bmod_comp_def, standard, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y z.\n       \\<lbrakk>\\<forall>x.\n                   \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<le> h x;\n        R x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<cdot> g z \\<le> h x\n 2. \\<And>x.\n       \\<forall>x y z.\n          R x y z \\<longrightarrow>\n          f y \\<cdot> g z \\<le> h x \\<Longrightarrow>\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<le> h x", "apply (metis (mono_tags, lifting) CollectI Sup_le_iff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<forall>x y z.\n          R x y z \\<longrightarrow>\n          f y \\<cdot> g z \\<le> h x \\<Longrightarrow>\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<le> h x", "by (rule Sup_least, force)"], ["proof (state)\nthis:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x)\n\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. g x \\<le> \\<lhd> R f h x)", "also"], ["proof (state)\nthis:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x)\n\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. g x \\<le> \\<lhd> R f h x)", "have \"... \\<longleftrightarrow>  (\\<forall>x y z. R x y z \\<longrightarrow> g z \\<le> (f y) \\<rightarrow> (h x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x) =\n    (\\<forall>x y z.\n        R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x)", "by (simp add: bres_galois)"], ["proof (state)\nthis:\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x) =\n  (\\<forall>x y z.\n      R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x)\n\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. g x \\<le> \\<lhd> R f h x)", "finally"], ["proof (chain)\npicking this:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x y z.\n      R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x y z.\n      R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x)\n\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. g x \\<le> \\<lhd> R f h x)", "apply (simp add: fun_eq_iff bmod_bres_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x y z.\n        R x y z \\<longrightarrow>\n        g z \\<le> f y \\<rightarrow> h x) \\<Longrightarrow>\n    (\\<forall>x y z.\n        R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x) =\n    (\\<forall>x. g x \\<le> \\<Sqinter>{f y \\<rightarrow> h z |y z. R z y x})", "apply standard"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x);\n     \\<forall>x y z.\n        R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         g x\n                         \\<le> \\<Sqinter>{f y \\<rightarrow> h z |y z.\n    R z y x}\n 2. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x);\n     \\<forall>x.\n        g x \\<le> \\<Sqinter>{f y \\<rightarrow> h z |y z. R z y x}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x y z.\n                         R x y z \\<longrightarrow>\n                         g z \\<le> f y \\<rightarrow> h x", "using le_Inf_iff"], ["proof (prove)\nusing this:\n  (?b \\<le> \\<Sqinter>?A) = (\\<forall>a\\<in>?A. ?b \\<le> a)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x);\n     \\<forall>x y z.\n        R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         g x\n                         \\<le> \\<Sqinter>{f y \\<rightarrow> h z |y z.\n    R z y x}\n 2. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x);\n     \\<forall>x.\n        g x \\<le> \\<Sqinter>{f y \\<rightarrow> h z |y z. R z y x}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x y z.\n                         R x y z \\<longrightarrow>\n                         g z \\<le> f y \\<rightarrow> h x", "apply fastforce"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> g z \\<le> f y \\<rightarrow> h x);\n     \\<forall>x.\n        g x \\<le> \\<Sqinter>{f y \\<rightarrow> h z |y z. R z y x}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x y z.\n                         R x y z \\<longrightarrow>\n                         g z \\<le> f y \\<rightarrow> h x", "by (metis (mono_tags, lifting) CollectI le_Inf_iff)"], ["proof (state)\nthis:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x. g x \\<le> \\<lhd> R f h x)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bmod_comp_fres_galois: \"(\\<forall>x. \\<otimes> R f g x \\<le> h x) \\<longleftrightarrow> (\\<forall>x. f x \\<le> \\<rhd> R h g x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. f x \\<le> \\<rhd> R h g x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. f x \\<le> \\<rhd> R h g x)", "have \"(\\<forall>x. \\<otimes> R f g x \\<le> h x) \\<longleftrightarrow> (\\<forall>x y z. R x y z \\<longrightarrow> (f y) \\<cdot> (g z) \\<le> h x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x)", "apply (simp add: bmod_comp_def, standard, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y z.\n       \\<lbrakk>\\<forall>x.\n                   \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<le> h x;\n        R x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<cdot> g z \\<le> h x\n 2. \\<And>x.\n       \\<forall>x y z.\n          R x y z \\<longrightarrow>\n          f y \\<cdot> g z \\<le> h x \\<Longrightarrow>\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<le> h x", "apply (metis (mono_tags, lifting) CollectI Sup_le_iff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<forall>x y z.\n          R x y z \\<longrightarrow>\n          f y \\<cdot> g z \\<le> h x \\<Longrightarrow>\n       \\<Squnion>{f y \\<cdot> g z |y z. R x y z} \\<le> h x", "by (rule Sup_least, force)"], ["proof (state)\nthis:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x)\n\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. f x \\<le> \\<rhd> R h g x)", "also"], ["proof (state)\nthis:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x)\n\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. f x \\<le> \\<rhd> R h g x)", "have \"... \\<longleftrightarrow>  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<le> (h x) \\<leftarrow> (g z))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x) =\n    (\\<forall>x y z.\n        R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z)", "by (simp add: fres_galois)"], ["proof (state)\nthis:\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<cdot> g z \\<le> h x) =\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z)\n\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. f x \\<le> \\<rhd> R h g x)", "finally"], ["proof (chain)\npicking this:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x y z. R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z)\n\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x. f x \\<le> \\<rhd> R h g x)", "apply (simp add: bmod_fres_def fun_eq_iff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n    (\\<forall>x y z.\n        R x y z \\<longrightarrow>\n        f y \\<le> h x \\<leftarrow> g z) \\<Longrightarrow>\n    (\\<forall>x y z.\n        R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z) =\n    (\\<forall>x. f x \\<le> \\<Sqinter>{h y \\<leftarrow> g z |y z. R y x z})", "apply standard"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z);\n     \\<forall>x y z.\n        R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         f x\n                         \\<le> \\<Sqinter>{h y \\<leftarrow> g z |y z.\n    R y x z}\n 2. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z);\n     \\<forall>x.\n        f x \\<le> \\<Sqinter>{h y \\<leftarrow> g z |y z. R y x z}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x y z.\n                         R x y z \\<longrightarrow>\n                         f y \\<le> h x \\<leftarrow> g z", "using le_Inf_iff"], ["proof (prove)\nusing this:\n  (?b \\<le> \\<Sqinter>?A) = (\\<forall>a\\<in>?A. ?b \\<le> a)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z);\n     \\<forall>x y z.\n        R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         f x\n                         \\<le> \\<Sqinter>{h y \\<leftarrow> g z |y z.\n    R y x z}\n 2. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z);\n     \\<forall>x.\n        f x \\<le> \\<Sqinter>{h y \\<leftarrow> g z |y z. R y x z}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x y z.\n                         R x y z \\<longrightarrow>\n                         f y \\<le> h x \\<leftarrow> g z", "apply fastforce"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n             (\\<forall>x y z.\n                 R x y z \\<longrightarrow> f y \\<le> h x \\<leftarrow> g z);\n     \\<forall>x.\n        f x \\<le> \\<Sqinter>{h y \\<leftarrow> g z |y z. R y x z}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x y z.\n                         R x y z \\<longrightarrow>\n                         f y \\<le> h x \\<leftarrow> g z", "by (metis (mono_tags, lifting) CollectI le_Inf_iff)"], ["proof (state)\nthis:\n  (\\<forall>x. \\<otimes> R f g x \\<le> h x) =\n  (\\<forall>x. f x \\<le> \\<rhd> R h g x)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Relational Convolution and Correspondence Theory\\<close>"], ["", "text\\<open>We now fix a ternary relation $\\rho$ and can then hide the parameter in a convolution-style notation.\\<close>"], ["", "class rel_magma = \n  fixes \\<rho> :: \"'a \\<Rightarrow> 'a \\<Rightarrow> 'a \\<Rightarrow> bool\"\n\nbegin"], ["", "definition times_rel_fun :: \"('a \\<Rightarrow> 'b::proto_near_quantale) \\<Rightarrow> ('a \\<Rightarrow> 'b) \\<Rightarrow> 'a \\<Rightarrow> 'b\" (infix \"\\<star>\" 70) where\n  \"f \\<star> g = \\<otimes> \\<rho> f g\""], ["", "lemma rel_fun_Sup_distl_weak: \n  \"G \\<noteq> {} \\<Longrightarrow> (f::'a \\<Rightarrow> 'b::weak_proto_quantale) \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G \\<noteq> {} \\<Longrightarrow>\n    f \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. G \\<noteq> {} \\<Longrightarrow>\n    f \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}", "fix f :: \"'a \\<Rightarrow> 'b\" and G :: \"('a \\<Rightarrow> 'b) set\""], ["proof (state)\ngoal (1 subgoal):\n 1. G \\<noteq> {} \\<Longrightarrow>\n    f \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}", "assume a: \"G \\<noteq> {}\""], ["proof (state)\nthis:\n  G \\<noteq> {}\n\ngoal (1 subgoal):\n 1. G \\<noteq> {} \\<Longrightarrow>\n    f \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}", "show \"f \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}", "apply (clarsimp simp: fun_eq_iff times_rel_fun_def bmod_Sup_fun2_weak[OF a])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G} =\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                      g \\<in> G}.\n           f x)", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G}\n       \\<le> (SUP f\\<in>{uu_.\n                         \\<exists>g.\n                            (\\<forall>x.\n                                uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                            g \\<in> G}.\n                 f x)\n 2. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa g.\n       g \\<in> G \\<Longrightarrow>\n       \\<otimes> \\<rho> f g x\n       \\<le> (SUP f\\<in>{uu_.\n                         \\<exists>g.\n                            (\\<forall>x.\n                                uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                            g \\<in> G}.\n                 f x)\n 2. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G}", "apply (rule SUP_upper2, force+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G}", "apply (rule SUP_least, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x f g.\n       \\<lbrakk>\\<forall>x. f x = \\<otimes> \\<rho> f g x; g \\<in> G\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<le> \\<Squnion>{\\<otimes> \\<rho> f g x |g.\n    g \\<in> G}", "by (rule Sup_upper2, force+)"], ["proof (state)\nthis:\n  f \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma rel_fun_Sup_distl: \"(f::'a \\<Rightarrow> 'b::proto_quantale) \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<star> \\<Squnion>G = \\<Squnion>{f \\<star> g |g. g \\<in> G}", "apply (clarsimp simp: fun_eq_iff times_rel_fun_def bmod_Sup_fun2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G} =\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                      g \\<in> G}.\n           f x)", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G}\n       \\<le> (SUP f\\<in>{uu_.\n                         \\<exists>g.\n                            (\\<forall>x.\n                                uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                            g \\<in> G}.\n                 f x)\n 2. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa g.\n       g \\<in> G \\<Longrightarrow>\n       \\<otimes> \\<rho> f g x\n       \\<le> (SUP f\\<in>{uu_.\n                         \\<exists>g.\n                            (\\<forall>x.\n                                uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                            g \\<in> G}.\n                 f x)\n 2. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G}", "apply (rule SUP_upper2, force+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> f g x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> f g x |g. g \\<in> G}", "apply (rule SUP_least, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x fa g.\n       \\<lbrakk>\\<forall>x. fa x = \\<otimes> \\<rho> f g x;\n        g \\<in> G\\<rbrakk>\n       \\<Longrightarrow> fa x\n                         \\<le> \\<Squnion>{\\<otimes> \\<rho> f g x |g.\n    g \\<in> G}", "by (rule Sup_upper2, force+)"], ["", "lemma rel_fun_Sup_distr: \"\\<Squnion>G \\<star> (f::'a \\<Rightarrow> 'b::proto_near_quantale) = \\<Squnion>{g \\<star> f |g. g \\<in> G}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>G \\<star> f = \\<Squnion>{g \\<star> f |g. g \\<in> G}", "apply (clarsimp simp: fun_eq_iff times_rel_fun_def bmod_Sup_fun1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<Squnion>{\\<otimes> \\<rho> fa f x |fa. fa \\<in> G} =\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> g f x) \\<and>\n                      g \\<in> G}.\n           f x)", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<Squnion>{\\<otimes> \\<rho> fa f x |fa. fa \\<in> G}\n       \\<le> (SUP f\\<in>{uu_.\n                         \\<exists>g.\n                            (\\<forall>x.\n                                uu_ x = \\<otimes> \\<rho> g f x) \\<and>\n                            g \\<in> G}.\n                 f x)\n 2. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> g f x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> fa f x |fa. fa \\<in> G}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa fa.\n       fa \\<in> G \\<Longrightarrow>\n       \\<otimes> \\<rho> fa f x\n       \\<le> (SUP f\\<in>{uu_.\n                         \\<exists>g.\n                            (\\<forall>x.\n                                uu_ x = \\<otimes> \\<rho> g f x) \\<and>\n                            g \\<in> G}.\n                 f x)\n 2. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> g f x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> fa f x |fa. fa \\<in> G}", "apply (rule SUP_upper2, force+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       (SUP f\\<in>{uu_.\n                   \\<exists>g.\n                      (\\<forall>x. uu_ x = \\<otimes> \\<rho> g f x) \\<and>\n                      g \\<in> G}.\n           f x)\n       \\<le> \\<Squnion>{\\<otimes> \\<rho> fa f x |fa. fa \\<in> G}", "apply (rule SUP_least, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x fa g.\n       \\<lbrakk>\\<forall>x. fa x = \\<otimes> \\<rho> g f x;\n        g \\<in> G\\<rbrakk>\n       \\<Longrightarrow> fa x\n                         \\<le> \\<Squnion>{\\<otimes> \\<rho> fa f x |fa.\n    fa \\<in> G}", "by (rule Sup_upper2, force+)"], ["", "end"], ["", "class rel_semigroup = rel_magma +\n  assumes rel_assoc: \"(\\<exists>y. \\<rho> y u v \\<and> \\<rho> x y w) \\<longleftrightarrow> (\\<exists>z. \\<rho> z v w \\<and> \\<rho> x u z)\"\n\nbegin"], ["", "text \\<open>Nitpick produces counterexamples even for weak quantales. \nHence one cannot generally lift functions into weak quantales to weak quantales.\\<close>"], ["", "lemma bmod_assoc: \"\\<otimes> \\<rho> (\\<otimes> \\<rho> (f::'a \\<Rightarrow> 'b::weak_quantale) g) h x = \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "(*nitpick[show_all,expect=genuine]*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "oops"], ["", "lemma bmod_assoc: \"\\<otimes> \\<rho> (\\<otimes> \\<rho> (f::'a \\<Rightarrow> 'b::quantale) g) h x = \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"\\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x = \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y z. \\<rho> x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n               z. \\<rho> x y z}", "apply (simp add: bmod_comp_def Sup_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{x \\<cdot> h z |x.\n                          \\<exists>ya z.\n                             x = f ya \\<cdot> g z \\<and> \\<rho> y ya z} |\n               y z. \\<rho> x y z} =\n    \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n               z. \\<rho> x y z}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{\\<Squnion>{x \\<cdot> h z |x.\n                          \\<exists>ya z.\n                             x = f ya \\<cdot> g z \\<and> \\<rho> y ya z} |\n               y z. \\<rho> x y z}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v.\n                                \\<rho> y u v} |\n                     y z. \\<rho> x y z}\n 2. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n               z. \\<rho> x y z}\n    \\<le> \\<Squnion>{\\<Squnion>{x \\<cdot> h z |x.\n                                \\<exists>ya z.\n                                   x = f ya \\<cdot> g z \\<and>\n                                   \\<rho> y ya z} |\n                     y z. \\<rho> x y z}", "by (intro Sup_least Sup_upper, safe, intro exI conjI, simp_all, rule_tac f = Sup and g = Sup in cong, auto)+"], ["proof (state)\nthis:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n             z. \\<rho> x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "also"], ["proof (state)\nthis:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n             z. \\<rho> x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"... = \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v y z. \\<rho> y u v \\<and> \\<rho> x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n               z. \\<rho> x y z} =\n    \\<Squnion>{uu_.\n               \\<exists>u v y z.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y u v \\<and> \\<rho> x y z}", "by (simp add: bmod_assoc_aux1)"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n             z. \\<rho> x y z} =\n  \\<Squnion>{uu_.\n             \\<exists>u v y z.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y u v \\<and> \\<rho> x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "also"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n             z. \\<rho> x y z} =\n  \\<Squnion>{uu_.\n             \\<exists>u v y z.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y u v \\<and> \\<rho> x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"... = \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v z y. \\<rho> y v z \\<and> \\<rho> x u y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v y z.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y u v \\<and> \\<rho> x y z} =\n    \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v y z.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y u v \\<and> \\<rho> x y z}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v z y.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y v z \\<and> \\<rho> x u y}\n 2. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y z.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y u v \\<and> \\<rho> x y z}", "apply (rule Sup_least, rule Sup_upper, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa u v y z.\n       \\<lbrakk>\\<rho> y u v; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ua va za y.\n                            f u \\<cdot> g v \\<cdot> h z =\n                            f ua \\<cdot> g va \\<cdot> h za \\<and>\n                            \\<rho> y va za \\<and> \\<rho> x ua y\n 2. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y z.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y u v \\<and> \\<rho> x y z}", "using rel_assoc"], ["proof (prove)\nusing this:\n  (\\<exists>y. \\<rho> y ?u ?v \\<and> \\<rho> ?x y ?w) =\n  (\\<exists>z. \\<rho> z ?v ?w \\<and> \\<rho> ?x ?u z)\n\ngoal (2 subgoals):\n 1. \\<And>xa u v y z.\n       \\<lbrakk>\\<rho> y u v; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ua va za y.\n                            f u \\<cdot> g v \\<cdot> h z =\n                            f ua \\<cdot> g va \\<cdot> h za \\<and>\n                            \\<rho> y va za \\<and> \\<rho> x ua y\n 2. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y z.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y u v \\<and> \\<rho> x y z}", "apply force"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y z.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y u v \\<and> \\<rho> x y z}", "apply (rule Sup_least, rule Sup_upper, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa u v z y.\n       \\<lbrakk>\\<rho> y v z; \\<rho> x u y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ua va y za.\n                            f u \\<cdot> g v \\<cdot> h z =\n                            f ua \\<cdot> g va \\<cdot> h za \\<and>\n                            \\<rho> y ua va \\<and> \\<rho> x y za", "using rel_assoc"], ["proof (prove)\nusing this:\n  (\\<exists>y. \\<rho> y ?u ?v \\<and> \\<rho> ?x y ?w) =\n  (\\<exists>z. \\<rho> z ?v ?w \\<and> \\<rho> ?x ?u z)\n\ngoal (1 subgoal):\n 1. \\<And>xa u v z y.\n       \\<lbrakk>\\<rho> y v z; \\<rho> x u y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ua va y za.\n                            f u \\<cdot> g v \\<cdot> h z =\n                            f ua \\<cdot> g va \\<cdot> h za \\<and>\n                            \\<rho> y ua va \\<and> \\<rho> x y za", "by blast"], ["proof (state)\nthis:\n  \\<Squnion>{uu_.\n             \\<exists>u v y z.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y u v \\<and> \\<rho> x y z} =\n  \\<Squnion>{uu_.\n             \\<exists>u v z y.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y v z \\<and> \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "also"], ["proof (state)\nthis:\n  \\<Squnion>{uu_.\n             \\<exists>u v y z.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y u v \\<and> \\<rho> x y z} =\n  \\<Squnion>{uu_.\n             \\<exists>u v z y.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y v z \\<and> \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"... = \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u y. \\<rho> x u y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y} =\n    \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n               y. \\<rho> x u y}", "by (simp add: bmod_assoc_aux2)"], ["proof (state)\nthis:\n  \\<Squnion>{uu_.\n             \\<exists>u v z y.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y v z \\<and> \\<rho> x u y} =\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "also"], ["proof (state)\nthis:\n  \\<Squnion>{uu_.\n             \\<exists>u v z y.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y v z \\<and> \\<rho> x u y} =\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"... = \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u y. \\<rho> x u y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n               y. \\<rho> x u y} =\n    \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u\n               y. \\<rho> x u y}", "apply (simp add: Sup_distl mult.assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> (g v \\<cdot> h z) |v z.\n                          \\<rho> y v z} |\n               u y. \\<rho> x u y} =\n    \\<Squnion>{\\<Squnion>{f u \\<cdot> ya |ya.\n                          \\<exists>v z.\n                             ya = g v \\<cdot> h z \\<and> \\<rho> y v z} |\n               u y. \\<rho> x u y}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> (g v \\<cdot> h z) |v z.\n                          \\<rho> y v z} |\n               u y. \\<rho> x u y}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> ya |ya.\n                                \\<exists>v z.\n                                   ya = g v \\<cdot> h z \\<and>\n                                   \\<rho> y v z} |\n                     u y. \\<rho> x u y}\n 2. \\<Squnion>{\\<Squnion>{f u \\<cdot> ya |ya.\n                          \\<exists>v z.\n                             ya = g v \\<cdot> h z \\<and> \\<rho> y v z} |\n               u y. \\<rho> x u y}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> (g v \\<cdot> h z) |v z.\n                                \\<rho> y v z} |\n                     u y. \\<rho> x u y}", "by (intro Sup_least Sup_upper, safe, intro exI conjI, simp_all, rule_tac f = Sup and g = Sup in cong, auto)+"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y} =\n  \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "finally"], ["proof (chain)\npicking this:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "by (auto simp: bmod_comp_def)"], ["proof (state)\nthis:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma rel_fun_assoc: \"((f :: 'a \\<Rightarrow> 'b::quantale) \\<star> g) \\<star> h = f \\<star> (g \\<star> h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<star> g) \\<star> h = f \\<star> (g \\<star> h)", "by (simp add: times_rel_fun_def fun_eq_iff bmod_assoc[symmetric])"], ["", "end"], ["", "lemma \"\\<otimes> R (\\<otimes> R f f) f x = \\<otimes> R f (\\<otimes> R f f) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<otimes> R f f) f x = \\<otimes> R f (\\<otimes> R f f) x", "(*apply (simp add: bmod_comp_def) nitpick[expect=genuine] *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> R (\\<otimes> R f f) f x = \\<otimes> R f (\\<otimes> R f f) x", "oops"], ["", "class rel_monoid = rel_semigroup + \n  fixes \\<xi> :: \"'a set\"\n  assumes unitl_ex: \"\\<exists>e \\<in> \\<xi>. \\<rho> x e x\" \n  and unitr_ex: \"\\<exists>e \\<in> \\<xi>. \\<rho> x x e\"\n  and unitl_eq: \"e \\<in> \\<xi> \\<Longrightarrow> \\<rho> x e y \\<Longrightarrow> x = y\"\n  and unitr_eq: \"e \\<in> \\<xi> \\<Longrightarrow> \\<rho> x y e \\<Longrightarrow> x = y\"\n\nbegin"], ["", "lemma xi_prop: \"e1 \\<in> \\<xi> \\<Longrightarrow> e2 \\<in> \\<xi> \\<Longrightarrow> e1 \\<noteq> e2 \\<Longrightarrow> \\<not> \\<rho> x e1 e2 \\<and> \\<not> \\<rho> x e2 e1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>e1 \\<in> \\<xi>; e2 \\<in> \\<xi>; e1 \\<noteq> e2\\<rbrakk>\n    \\<Longrightarrow> \\<not> \\<rho> x e1 e2 \\<and> \\<not> \\<rho> x e2 e1", "using unitl_eq unitr_eq"], ["proof (prove)\nusing this:\n  \\<lbrakk>?e \\<in> \\<xi>; \\<rho> ?x ?e ?y\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n  \\<lbrakk>?e \\<in> \\<xi>; \\<rho> ?x ?y ?e\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n\ngoal (1 subgoal):\n 1. \\<lbrakk>e1 \\<in> \\<xi>; e2 \\<in> \\<xi>; e1 \\<noteq> e2\\<rbrakk>\n    \\<Longrightarrow> \\<not> \\<rho> x e1 e2 \\<and> \\<not> \\<rho> x e2 e1", "by blast"], ["", "definition pid :: \"'a  \\<Rightarrow> 'b::unital_weak_quantale\" (\"\\<delta>\") where\n  \"\\<delta> x = (if x \\<in> \\<xi> then 1 else \\<bottom>)\""], ["", "text \\<open>Due to the absence of right annihilation, the right unit law fails for functions into weak quantales.\\<close>"], ["", "lemma bmod_onel: \"\\<otimes> \\<rho> f (\\<delta>::'a \\<Rightarrow> 'b::unital_weak_quantale) x = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> f \\<delta> x = f x", "(*nitpick[expect=genuine]*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> f \\<delta> x = f x", "oops"], ["", "text \\<open>A unital quantale is required for this lifting.\\<close>"], ["", "lemma bmod_onel: \"\\<otimes> \\<rho> f (\\<delta>::'a \\<Rightarrow> 'b::unital_quantale) x = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> f \\<delta> x = f x", "apply (simp add: bmod_comp_def pid_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>y z.\n                  (z \\<in> \\<xi> \\<longrightarrow>\n                   uu_ = f y \\<and> \\<rho> x y z) \\<and>\n                  (z \\<notin> \\<xi> \\<longrightarrow>\n                   uu_ = \\<bottom> \\<and> \\<rho> x y z)} =\n    f x", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{uu_.\n               \\<exists>y z.\n                  (z \\<in> \\<xi> \\<longrightarrow>\n                   uu_ = f y \\<and> \\<rho> x y z) \\<and>\n                  (z \\<notin> \\<xi> \\<longrightarrow>\n                   uu_ = \\<bottom> \\<and> \\<rho> x y z)}\n    \\<le> f x\n 2. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y z.\n                        (z \\<in> \\<xi> \\<longrightarrow>\n                         uu_ = f y \\<and> \\<rho> x y z) \\<and>\n                        (z \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> \\<rho> x y z)}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>xa y z.\n       \\<lbrakk>z \\<notin> \\<xi>; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> \\<bottom> \\<le> f x\n 2. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; \\<not> f y \\<le> f x; z \\<in> \\<xi>\\<rbrakk>\n       \\<Longrightarrow> False\n 3. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; f y = \\<bottom>; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<le> f x\n 4. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y z.\n                        (z \\<in> \\<xi> \\<longrightarrow>\n                         uu_ = f y \\<and> \\<rho> x y z) \\<and>\n                        (z \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> \\<rho> x y z)}", "apply (simp add: bres_galois)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; \\<not> f y \\<le> f x; z \\<in> \\<xi>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; f y = \\<bottom>; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<le> f x\n 3. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y z.\n                        (z \\<in> \\<xi> \\<longrightarrow>\n                         uu_ = f y \\<and> \\<rho> x y z) \\<and>\n                        (z \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> \\<rho> x y z)}", "using unitr_eq"], ["proof (prove)\nusing this:\n  \\<lbrakk>?e \\<in> \\<xi>; \\<rho> ?x ?y ?e\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n\ngoal (3 subgoals):\n 1. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; \\<not> f y \\<le> f x; z \\<in> \\<xi>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; f y = \\<bottom>; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<le> f x\n 3. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y z.\n                        (z \\<in> \\<xi> \\<longrightarrow>\n                         uu_ = f y \\<and> \\<rho> x y z) \\<and>\n                        (z \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> \\<rho> x y z)}", "apply fastforce"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; f y = \\<bottom>; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> f y \\<le> f x\n 2. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y z.\n                        (z \\<in> \\<xi> \\<longrightarrow>\n                         uu_ = f y \\<and> \\<rho> x y z) \\<and>\n                        (z \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> \\<rho> x y z)}", "apply (metis bot.extremum)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y z.\n                        (z \\<in> \\<xi> \\<longrightarrow>\n                         uu_ = f y \\<and> \\<rho> x y z) \\<and>\n                        (z \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> \\<rho> x y z)}", "by (metis (mono_tags, lifting) Sup_upper mem_Collect_eq unitr_ex)"], ["", "lemma  bmod_oner: \"\\<otimes> \\<rho> \\<delta> f x = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> \\<delta> f x = f x", "apply (simp add: bmod_comp_def pid_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>y.\n                  (y \\<in> \\<xi> \\<longrightarrow>\n                   (\\<exists>z. uu_ = f z \\<and> \\<rho> x y z)) \\<and>\n                  (y \\<notin> \\<xi> \\<longrightarrow>\n                   uu_ = \\<bottom> \\<and> (\\<exists>z. \\<rho> x y z))} =\n    f x", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{uu_.\n               \\<exists>y.\n                  (y \\<in> \\<xi> \\<longrightarrow>\n                   (\\<exists>z. uu_ = f z \\<and> \\<rho> x y z)) \\<and>\n                  (y \\<notin> \\<xi> \\<longrightarrow>\n                   uu_ = \\<bottom> \\<and> (\\<exists>z. \\<rho> x y z))}\n    \\<le> f x\n 2. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y.\n                        (y \\<in> \\<xi> \\<longrightarrow>\n                         (\\<exists>z. uu_ = f z \\<and> \\<rho> x y z)) \\<and>\n                        (y \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> (\\<exists>z. \\<rho> x y z))}", "apply (rule Sup_least, safe)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>xa y z.\n       \\<lbrakk>y \\<notin> \\<xi>; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> \\<bottom> \\<le> f x\n 2. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; \\<not> f z \\<le> f x; y \\<in> \\<xi>\\<rbrakk>\n       \\<Longrightarrow> False\n 3. \\<And>xa y z za.\n       \\<lbrakk>\\<rho> x y z; f z = \\<bottom>; \\<rho> x y za\\<rbrakk>\n       \\<Longrightarrow> f z \\<le> f x\n 4. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y.\n                        (y \\<in> \\<xi> \\<longrightarrow>\n                         (\\<exists>z. uu_ = f z \\<and> \\<rho> x y z)) \\<and>\n                        (y \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> (\\<exists>z. \\<rho> x y z))}", "apply (simp add: fres_galois)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; \\<not> f z \\<le> f x; y \\<in> \\<xi>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>xa y z za.\n       \\<lbrakk>\\<rho> x y z; f z = \\<bottom>; \\<rho> x y za\\<rbrakk>\n       \\<Longrightarrow> f z \\<le> f x\n 3. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y.\n                        (y \\<in> \\<xi> \\<longrightarrow>\n                         (\\<exists>z. uu_ = f z \\<and> \\<rho> x y z)) \\<and>\n                        (y \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> (\\<exists>z. \\<rho> x y z))}", "using unitl_eq"], ["proof (prove)\nusing this:\n  \\<lbrakk>?e \\<in> \\<xi>; \\<rho> ?x ?e ?y\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n\ngoal (3 subgoals):\n 1. \\<And>xa y z.\n       \\<lbrakk>\\<rho> x y z; \\<not> f z \\<le> f x; y \\<in> \\<xi>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>xa y z za.\n       \\<lbrakk>\\<rho> x y z; f z = \\<bottom>; \\<rho> x y za\\<rbrakk>\n       \\<Longrightarrow> f z \\<le> f x\n 3. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y.\n                        (y \\<in> \\<xi> \\<longrightarrow>\n                         (\\<exists>z. uu_ = f z \\<and> \\<rho> x y z)) \\<and>\n                        (y \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> (\\<exists>z. \\<rho> x y z))}", "apply fastforce"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y z za.\n       \\<lbrakk>\\<rho> x y z; f z = \\<bottom>; \\<rho> x y za\\<rbrakk>\n       \\<Longrightarrow> f z \\<le> f x\n 2. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y.\n                        (y \\<in> \\<xi> \\<longrightarrow>\n                         (\\<exists>z. uu_ = f z \\<and> \\<rho> x y z)) \\<and>\n                        (y \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> (\\<exists>z. \\<rho> x y z))}", "apply (metis bot.extremum)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f x\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>y.\n                        (y \\<in> \\<xi> \\<longrightarrow>\n                         (\\<exists>z. uu_ = f z \\<and> \\<rho> x y z)) \\<and>\n                        (y \\<notin> \\<xi> \\<longrightarrow>\n                         uu_ = \\<bottom> \\<and> (\\<exists>z. \\<rho> x y z))}", "by (metis (mono_tags, lifting) Sup_upper mem_Collect_eq unitl_ex)"], ["", "lemma pid_unitl [simp]: \"\\<delta> \\<star> f = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<delta> \\<star> f = f", "by (simp add: fun_eq_iff times_rel_fun_def bmod_oner)"], ["", "lemma pid_unitr [simp]: \"f \\<star> (\\<delta>::'a \\<Rightarrow> 'b::unital_quantale) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<star> \\<delta> = f", "by (simp add: fun_eq_iff times_rel_fun_def bmod_onel)"], ["", "lemma bmod_assoc_weak_aux: \n  \"f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} = \\<Squnion>{(f::'a \\<Rightarrow> 'b::weak_quantale) u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} =\n    \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z}", "apply (subst weak_Sup_distl)"], ["proof (prove)\ngoal (2 subgoals):\n 1. {g v \\<cdot> h z |v z. \\<rho> y v z} \\<noteq> {}\n 2. \\<Squnion>{f u \\<cdot> ya |ya.\n               ya \\<in> {g v \\<cdot> h z |v z. \\<rho> y v z}} =\n    \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z}", "using unitl_ex"], ["proof (prove)\nusing this:\n  \\<exists>e\\<in>\\<xi>. \\<rho> ?x e ?x\n\ngoal (2 subgoals):\n 1. {g v \\<cdot> h z |v z. \\<rho> y v z} \\<noteq> {}\n 2. \\<Squnion>{f u \\<cdot> ya |ya.\n               ya \\<in> {g v \\<cdot> h z |v z. \\<rho> y v z}} =\n    \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z}", "apply force"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{f u \\<cdot> ya |ya.\n               ya \\<in> {g v \\<cdot> h z |v z. \\<rho> y v z}} =\n    \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{f u \\<cdot> ya |ya.\n               \\<exists>v z. ya = g v \\<cdot> h z \\<and> \\<rho> y v z} =\n    \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z}", "by (metis (no_types, lifting) mult.assoc)"], ["", "lemma bmod_assoc_weak: \"\\<otimes> \\<rho> (\\<otimes> \\<rho> (f::'a \\<Rightarrow> 'b::weak_quantale) g) h x = \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"\\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x = \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y z. \\<rho> x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n               z. \\<rho> x y z}", "apply (simp add: bmod_comp_def Sup_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{x \\<cdot> h z |x.\n                          \\<exists>ya z.\n                             x = f ya \\<cdot> g z \\<and> \\<rho> y ya z} |\n               y z. \\<rho> x y z} =\n    \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n               z. \\<rho> x y z}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{\\<Squnion>{x \\<cdot> h z |x.\n                          \\<exists>ya z.\n                             x = f ya \\<cdot> g z \\<and> \\<rho> y ya z} |\n               y z. \\<rho> x y z}\n    \\<le> \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v.\n                                \\<rho> y u v} |\n                     y z. \\<rho> x y z}\n 2. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n               z. \\<rho> x y z}\n    \\<le> \\<Squnion>{\\<Squnion>{x \\<cdot> h z |x.\n                                \\<exists>ya z.\n                                   x = f ya \\<cdot> g z \\<and>\n                                   \\<rho> y ya z} |\n                     y z. \\<rho> x y z}", "by (intro Sup_least Sup_upper, safe, intro exI conjI, simp_all, rule_tac f = Sup and g = Sup in cong, auto)+"], ["proof (state)\nthis:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n             z. \\<rho> x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "also"], ["proof (state)\nthis:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n             z. \\<rho> x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"... = \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v y z. \\<rho> y u v \\<and> \\<rho> x y z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n               z. \\<rho> x y z} =\n    \\<Squnion>{uu_.\n               \\<exists>u v y z.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y u v \\<and> \\<rho> x y z}", "by (simp add: bmod_assoc_aux1)"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n             z. \\<rho> x y z} =\n  \\<Squnion>{uu_.\n             \\<exists>u v y z.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y u v \\<and> \\<rho> x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "also"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v. \\<rho> y u v} |y\n             z. \\<rho> x y z} =\n  \\<Squnion>{uu_.\n             \\<exists>u v y z.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y u v \\<and> \\<rho> x y z}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"... = \\<Squnion>{f u \\<cdot> g v \\<cdot> h z |u v z y. \\<rho> y v z \\<and> \\<rho> x u y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v y z.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y u v \\<and> \\<rho> x y z} =\n    \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v y z.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y u v \\<and> \\<rho> x y z}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v z y.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y v z \\<and> \\<rho> x u y}\n 2. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y z.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y u v \\<and> \\<rho> x y z}", "apply (rule Sup_least, rule Sup_upper, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa u v y z.\n       \\<lbrakk>\\<rho> y u v; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ua va za y.\n                            f u \\<cdot> g v \\<cdot> h z =\n                            f ua \\<cdot> g va \\<cdot> h za \\<and>\n                            \\<rho> y va za \\<and> \\<rho> x ua y\n 2. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y z.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y u v \\<and> \\<rho> x y z}", "using rel_assoc"], ["proof (prove)\nusing this:\n  (\\<exists>y. \\<rho> y ?u ?v \\<and> \\<rho> ?x y ?w) =\n  (\\<exists>z. \\<rho> z ?v ?w \\<and> \\<rho> ?x ?u z)\n\ngoal (2 subgoals):\n 1. \\<And>xa u v y z.\n       \\<lbrakk>\\<rho> y u v; \\<rho> x y z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ua va za y.\n                            f u \\<cdot> g v \\<cdot> h z =\n                            f ua \\<cdot> g va \\<cdot> h za \\<and>\n                            \\<rho> y va za \\<and> \\<rho> x ua y\n 2. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y z.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y u v \\<and> \\<rho> x y z}", "apply force"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y}\n    \\<le> \\<Squnion>{uu_.\n                     \\<exists>u v y z.\n                        uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                        \\<rho> y u v \\<and> \\<rho> x y z}", "apply (rule Sup_least, rule Sup_upper, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa u v z y.\n       \\<lbrakk>\\<rho> y v z; \\<rho> x u y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ua va y za.\n                            f u \\<cdot> g v \\<cdot> h z =\n                            f ua \\<cdot> g va \\<cdot> h za \\<and>\n                            \\<rho> y ua va \\<and> \\<rho> x y za", "using rel_assoc"], ["proof (prove)\nusing this:\n  (\\<exists>y. \\<rho> y ?u ?v \\<and> \\<rho> ?x y ?w) =\n  (\\<exists>z. \\<rho> z ?v ?w \\<and> \\<rho> ?x ?u z)\n\ngoal (1 subgoal):\n 1. \\<And>xa u v z y.\n       \\<lbrakk>\\<rho> y v z; \\<rho> x u y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ua va y za.\n                            f u \\<cdot> g v \\<cdot> h z =\n                            f ua \\<cdot> g va \\<cdot> h za \\<and>\n                            \\<rho> y ua va \\<and> \\<rho> x y za", "by blast"], ["proof (state)\nthis:\n  \\<Squnion>{uu_.\n             \\<exists>u v y z.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y u v \\<and> \\<rho> x y z} =\n  \\<Squnion>{uu_.\n             \\<exists>u v z y.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y v z \\<and> \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "also"], ["proof (state)\nthis:\n  \\<Squnion>{uu_.\n             \\<exists>u v y z.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y u v \\<and> \\<rho> x y z} =\n  \\<Squnion>{uu_.\n             \\<exists>u v z y.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y v z \\<and> \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"... = \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u y. \\<rho> x u y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{uu_.\n               \\<exists>u v z y.\n                  uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                  \\<rho> y v z \\<and> \\<rho> x u y} =\n    \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n               y. \\<rho> x u y}", "by (simp add: bmod_assoc_aux2)"], ["proof (state)\nthis:\n  \\<Squnion>{uu_.\n             \\<exists>u v z y.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y v z \\<and> \\<rho> x u y} =\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "also"], ["proof (state)\nthis:\n  \\<Squnion>{uu_.\n             \\<exists>u v z y.\n                uu_ = f u \\<cdot> g v \\<cdot> h z \\<and>\n                \\<rho> y v z \\<and> \\<rho> x u y} =\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "have \"... = \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u y. \\<rho> x u y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n               y. \\<rho> x u y} =\n    \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u\n               y. \\<rho> x u y}", "by (simp add: bmod_assoc_weak_aux)"], ["proof (state)\nthis:\n  \\<Squnion>{\\<Squnion>{f u \\<cdot> g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y} =\n  \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "finally"], ["proof (chain)\npicking this:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<Squnion>{f u \\<cdot> \\<Squnion>{g v \\<cdot> h z |v z. \\<rho> y v z} |u\n             y. \\<rho> x u y}\n\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n    \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x", "by (auto simp: bmod_comp_def)"], ["proof (state)\nthis:\n  \\<otimes> \\<rho> (\\<otimes> \\<rho> f g) h x =\n  \\<otimes> \\<rho> f (\\<otimes> \\<rho> g h) x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma rel_fun_assoc_weak: \"((f :: 'a \\<Rightarrow> 'b::weak_quantale) \\<star> g) \\<star> h = f \\<star> (g \\<star> h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<star> g) \\<star> h = f \\<star> (g \\<star> h)", "by (simp add: times_rel_fun_def fun_eq_iff bmod_assoc_weak[symmetric])"], ["", "end"], ["", "lemma (in rel_semigroup) \"\\<exists>id. \\<forall>f x. (\\<otimes> \\<rho> f id x = f x \\<and> \\<otimes> \\<rho> id f x = f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>id.\n       \\<forall>f x.\n          \\<otimes> \\<rho> f id x = f x \\<and> \\<otimes> \\<rho> id f x = f x", "(* apply (simp add: bmod_comp_def) nitpick [expect=genuine] *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>id.\n       \\<forall>f x.\n          \\<otimes> \\<rho> f id x = f x \\<and> \\<otimes> \\<rho> id f x = f x", "oops"], ["", "class rel_ab_semigroup = rel_semigroup +\n  assumes rel_comm: \"\\<rho> x y z \\<Longrightarrow>  \\<rho> x z y\" \n\nbegin"], ["", "lemma bmod_comm: \"\\<otimes> \\<rho> (f::'a \\<Rightarrow> 'b::ab_quantale) g = \\<otimes> \\<rho> g f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> f g = \\<otimes> \\<rho> g f", "by (simp add: fun_eq_iff bmod_comp_def mult.commute, meson rel_comm)"], ["", "lemma \"\\<otimes> \\<rho> f g = \\<otimes> \\<rho> g f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> f g = \\<otimes> \\<rho> g f", "(* nitpick [expect=genuine] *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<otimes> \\<rho> f g = \\<otimes> \\<rho> g f", "oops"], ["", "lemma bmod_bres_fres_eq: \"\\<lhd> \\<rho> (f::'a \\<Rightarrow> 'b::ab_quantale) g = \\<rhd> \\<rho> g f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lhd> \\<rho> f g = \\<rhd> \\<rho> g f", "by (simp add: fun_eq_iff bmod_bres_def bmod_fres_def bres_fres_eq, meson rel_comm)"], ["", "lemma rel_fun_comm: \"(f :: 'a \\<Rightarrow> 'b::ab_quantale) \\<star> g = g \\<star> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<star> g = g \\<star> f", "by (simp add: times_rel_fun_def bmod_comm)"], ["", "end"], ["", "class rel_ab_monoid = rel_ab_semigroup + rel_monoid"], ["", "subsection \\<open>Lifting to Function Spaces\\<close>"], ["", "text \\<open>We lift by interpretation, since we need sort instantiations to be\n     used for functions from PAM's to Quantales. Both instantiations cannot be\n     used in Isabelle at the same time.\\<close>"], ["", "interpretation rel_fun: weak_proto_quantale Inf Sup inf less_eq less sup bot \"top :: 'a::rel_magma \\<Rightarrow> 'b::weak_proto_quantale\" times_rel_fun"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.weak_proto_quantale Inf Sup (\\<sqinter>) (\\<le>) (<) (\\<squnion>)\n     \\<bottom> \\<top> (\\<star>)", "by standard (simp_all add: rel_fun_Sup_distr rel_fun_Sup_distl_weak)"], ["", "interpretation rel_fun: proto_quantale Inf Sup inf less_eq less sup bot \"top :: 'a::rel_magma \\<Rightarrow> 'b::proto_quantale\" times_rel_fun"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.proto_quantale Inf Sup (\\<sqinter>) (\\<le>) (<) (\\<squnion>)\n     \\<bottom> \\<top> (\\<star>)", "by standard (simp add: rel_fun_Sup_distl)"], ["", "text \\<open>Nitpick shows that the lifting of weak quantales to weak quantales does not work for relational semigroups, because associativity fails.\\<close>"], ["", "interpretation rel_fun: weak_quantale times_rel_fun Inf Sup inf less_eq less sup bot \"top::'a::rel_semigroup \\<Rightarrow> 'b::weak_quantale\""], ["proof (prove)\ngoal (1 subgoal):\n 1. class.weak_quantale (\\<star>) Inf Sup (\\<sqinter>) (\\<le>) (<)\n     (\\<squnion>) \\<bottom> \\<top>", "(*apply standard  nitpick[expect=genuine]*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.weak_quantale (\\<star>) Inf Sup (\\<sqinter>) (\\<le>) (<)\n     (\\<squnion>) \\<bottom> \\<top>", "oops"], ["", "text \\<open>Associativity is obtained when lifting from relational monoids, but the right unit law doesn't hold\n in the quantale on the function space, according to our above results. Hence the lifting results into a\nnon-unital quantale, in which only the left unit law holds, as shown above. We don't provide a special class for \nsuch quantales. Hence we lift only to non-unital quantales.\\<close>"], ["", "interpretation rel_fun: weak_quantale times_rel_fun Inf Sup inf less_eq less sup bot \"top::'a::rel_monoid \\<Rightarrow> 'b::unital_weak_quantale\""], ["proof (prove)\ngoal (1 subgoal):\n 1. class.weak_quantale (\\<star>) Inf Sup (\\<sqinter>) (\\<le>) (<)\n     (\\<squnion>) \\<bottom> \\<top>", "by standard (simp_all add: rel_fun_assoc_weak)"], ["", "interpretation rel_fun2: quantale times_rel_fun Inf Sup inf less_eq less sup bot \"top::'a::rel_semigroup \\<Rightarrow> 'b::quantale\""], ["proof (prove)\ngoal (1 subgoal):\n 1. class.quantale (\\<star>) Inf Sup (\\<sqinter>) (\\<le>) (<) (\\<squnion>)\n     \\<bottom> \\<top>", "by standard (simp add: rel_fun_assoc)"], ["", "interpretation rel_fun2: distrib_quantale Inf Sup inf less_eq less sup bot \"top::'a::rel_semigroup \\<Rightarrow> 'b::distrib_quantale\" times_rel_fun"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.distrib_quantale Inf Sup (\\<sqinter>) (\\<le>) (<) (\\<squnion>)\n     \\<bottom> \\<top> (\\<star>)", ".."], ["", "interpretation rel_fun2: bool_quantale Inf Sup inf less_eq less sup bot \"top::'a::rel_semigroup \\<Rightarrow> 'b::bool_quantale\" minus uminus times_rel_fun"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.bool_quantale Inf Sup (\\<sqinter>) (\\<le>) (<) (\\<squnion>)\n     \\<bottom> \\<top> (-) uminus (\\<star>)", ".."], ["", "interpretation rel_fun2: unital_quantale pid times_rel_fun Inf Sup inf less_eq less sup bot \"top::'a::rel_monoid \\<Rightarrow> 'b::unital_quantale\""], ["proof (prove)\ngoal (1 subgoal):\n 1. class.unital_quantale \\<delta> (\\<star>) Inf Sup (\\<sqinter>) (\\<le>)\n     (<) (\\<squnion>) \\<bottom> \\<top>", "by (standard; simp)"], ["", "interpretation rel_fun2: distrib_unital_quantale Inf Sup inf less_eq less sup bot \"top::'a::rel_monoid \\<Rightarrow> 'b::distrib_unital_quantale\" pid times_rel_fun"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.distrib_unital_quantale Inf Sup (\\<sqinter>) (\\<le>) (<)\n     (\\<squnion>) \\<bottom> \\<top> \\<delta> (\\<star>)", ".."], ["", "interpretation rel_fun2: bool_unital_quantale Inf Sup inf less_eq less sup bot \"top::'a::rel_monoid \\<Rightarrow> 'b::bool_unital_quantale\" minus uminus pid times_rel_fun"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.bool_unital_quantale Inf Sup (\\<sqinter>) (\\<le>) (<) (\\<squnion>)\n     \\<bottom> \\<top> (-) uminus \\<delta> (\\<star>)", ".."], ["", "interpretation rel_fun: ab_quantale times_rel_fun Inf Sup inf less_eq less sup bot \"top::'a::rel_ab_semigroup \\<Rightarrow> 'b::ab_quantale\""], ["proof (prove)\ngoal (1 subgoal):\n 1. class.ab_quantale (\\<star>) Inf Sup (\\<sqinter>) (\\<le>) (<)\n     (\\<squnion>) \\<bottom> \\<top>", "by standard (simp add: rel_fun_comm)"], ["", "interpretation rel_fun: ab_unital_quantale times_rel_fun Inf Sup inf less_eq less sup bot \"top::'a::rel_ab_monoid \\<Rightarrow> 'b::ab_unital_quantale\" pid"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.ab_unital_quantale (\\<star>) Inf Sup (\\<sqinter>) (\\<le>) (<)\n     (\\<squnion>) \\<bottom> \\<top> \\<delta>", ".."], ["", "interpretation rel_fun2: distrib_ab_unital_quantale Inf Sup inf less_eq less sup bot \"top::'a::rel_ab_monoid \\<Rightarrow> 'b::distrib_ab_unital_quantale\" times_rel_fun pid"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.distrib_ab_unital_quantale Inf Sup (\\<sqinter>) (\\<le>) (<)\n     (\\<squnion>) \\<bottom> \\<top> (\\<star>) \\<delta>", ".."], ["", "interpretation rel_fun2: bool_ab_unital_quantale times_rel_fun Inf Sup inf less_eq less sup bot \"top::'a::rel_ab_monoid \\<Rightarrow> 'b::bool_ab_unital_quantale\" minus uminus pid"], ["proof (prove)\ngoal (1 subgoal):\n 1. class.bool_ab_unital_quantale (\\<star>) Inf Sup (\\<sqinter>) (\\<le>) (<)\n     (\\<squnion>) \\<bottom> \\<top> (-) uminus \\<delta>", ".."], ["", "end"]]}