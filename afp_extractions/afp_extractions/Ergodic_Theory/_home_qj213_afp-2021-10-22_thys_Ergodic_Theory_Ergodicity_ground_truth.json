{"file_name": "/home/qj213/afp-2021-10-22/thys/Ergodic_Theory/Ergodicity.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ergodic_Theory", "problem_names": ["lemma (in ergodic_qmpt) AE_equal_preimage_then_null_or_conull:\n  assumes [measurable]: \"A \\<in> sets M\" and \"A \\<Delta> T--`A \\<in> null_sets M\"\n  shows \"A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\"", "lemma (in ergodic_qmpt) ergodic_Tinv:\n  assumes \"invertible_qmpt\"\n  shows \"ergodic_qmpt M Tinv\"", "lemma (in ergodic_conservative) preimage_included_then_null_or_conull:\n  assumes \"A \\<in> sets M\" \"T--`A \\<subseteq> A\"\n  shows \"A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\"", "lemma (in ergodic_conservative) preimage_includes_then_null_or_conull:\n  assumes \"A \\<in> sets M\" \"T--`A \\<supseteq> A\"\n  shows \"A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\"", "lemma (in ergodic_conservative) preimages_conull:\n  assumes [measurable]: \"A \\<in> sets M\" and \"emeasure M A > 0\"\n  shows \"space M - (\\<Union>n. (T^^n)--`A) \\<in> null_sets M\"\n        \"space M \\<Delta> (\\<Union>n. (T^^n)--`A) \\<in> null_sets M\"", "lemma (in ergodic_qmpt) Invariant_func_is_AE_constant:\n  fixes f::\"_\\<Rightarrow> 'b::{second_countable_topology, t1_space}\"\n  assumes \"f \\<in> borel_measurable Invariants\"\n  shows \"\\<exists>y. AE x in M. f x = y\"", "lemma (in ergodic_qmpt) AE_Invariant_func_is_AE_constant:\n  fixes f::\"_ \\<Rightarrow> 'b::{second_countable_topology, t2_space}\"\n  assumes \"f \\<in> borel_measurable M\" \"AE x in M. f(T x) = f x\"\n  shows \"\\<exists>y. AE x in M. f x = y\"", "lemma (in ergodic_conservative) AE_decreasing_func_is_AE_constant:\n  fixes f::\"_ \\<Rightarrow> 'b::{linorder_topology, second_countable_topology}\"\n  assumes \"AE x in M. f(T x) \\<le> f x\"\n    and [measurable]: \"f \\<in> borel_measurable M\"\n  shows \"\\<exists>y. AE x in M. f x = y\"", "lemma (in ergodic_conservative) AE_increasing_func_is_AE_constant:\n  fixes f::\"_ \\<Rightarrow> 'b::{linorder_topology, second_countable_topology}\"\n  assumes \"AE x in M. f(T x) \\<ge> f x\"\n    and [measurable]: \"f \\<in> borel_measurable M\"\n  shows \"\\<exists>y. AE x in M. f x = y\"", "lemma (in ergodic_fmpt) Invariant_func_integral:\n  fixes f::\"_ \\<Rightarrow> 'b::{banach, second_countable_topology}\"\n  assumes [measurable]: \"f \\<in> borel_measurable Invariants\"\n  shows \"integrable M f\"\n        \"AE x in M. f x = (\\<integral>x. f x \\<partial>M)/\\<^sub>R (measure M (space M))\"", "lemma (in ergodic_fmpt) Invariants_cond_exp_is_integral_fmpt:\n  fixes f::\"_ \\<Rightarrow> real\"\n  assumes \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants f x = (\\<integral>x. f x \\<partial>M) / measure M (space M)\"", "lemma (in ergodic_pmpt) Invariants_cond_exp_is_integral:\n  fixes f::\"_ \\<Rightarrow> real\"\n  assumes \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants f x = (\\<integral>x. f x \\<partial>M)\"", "lemma (in ergodic_conservative_mpt) local_time_unbounded:\n  assumes [measurable]: \"A \\<in> sets M\" \"B \\<in> sets M\"\n      and \"emeasure M A < \\<infinity>\" \"emeasure M B > 0\"\n  shows \"(\\<lambda>n. emeasure M {x \\<in> (T^^n)--`A. local_time B n x < k}) \\<longlonglongrightarrow> 0\"", "theorem (in ergodic_conservative_mpt) kac_formula:\n  assumes [measurable]: \"A \\<in> sets M\" and \"emeasure M A > 0\"\n  shows \"(\\<integral>\\<^sup>+y. return_time_function A y \\<partial>M) = emeasure M (space M)\"", "lemma (in ergodic_conservative_mpt) induced_function_integral:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"A \\<in> sets M\" \"integrable M f\" and \"emeasure M A > 0\"\n  shows \"integrable M (induced_function A f)\"\n        \"(\\<integral>y. induced_function A f y \\<partial>M) = (\\<integral> x. f x \\<partial>M)\"", "lemma (in ergodic_conservative_mpt) induced_function_integral_restr:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"A \\<in> sets M\" \"integrable M f\" and \"emeasure M A > 0\"\n  shows \"integrable (restrict_space M A) (induced_function A f)\"\n        \"(\\<integral>y. induced_function A f y \\<partial>(restrict_space M A)) = (\\<integral> x. f x \\<partial>M)\"", "theorem (in ergodic_pmpt) birkhoff_theorem_AE:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes \"integrable M f\"\n  shows \"AE x in M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> (\\<integral> x. f x \\<partial>M)\"", "theorem (in ergodic_pmpt) birkhoff_theorem_L1:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"(\\<lambda>n. \\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - (\\<integral> x. f x \\<partial>M)) \\<partial>M) \\<longlonglongrightarrow> 0\"", "theorem (in ergodic_pmpt) birkhoff_sum_small_asymp_pos:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"e>0\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) .. n * (\\<integral>x. f x \\<partial>M) + e}}\"", "theorem (in ergodic_pmpt) birkhoff_sum_small_asymp_neg:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"e>0\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) - e .. n * (\\<integral>x. f x \\<partial>M)}}\"", "lemma (in ergodic_pmpt) birkhoff_positive_average:\n      fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"AE x in M. (\\<lambda>n. birkhoff_sum f n x) \\<longlonglongrightarrow> \\<infinity>\"\n  shows \"(\\<integral> x. f x \\<partial>M) > 0\"", "lemma (in ergodic_pmpt) birkhoff_negative_average:\n      fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"AE x in M. (\\<lambda>n. birkhoff_sum f n x) \\<longlonglongrightarrow> -\\<infinity>\"\n  shows \"(\\<integral> x. f x \\<partial>M) < 0\"", "lemma (in ergodic_pmpt) birkhoff_nonzero_average:\n      fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"AE x in M. (\\<lambda>n. abs(birkhoff_sum f n x)) \\<longlonglongrightarrow> \\<infinity>\"\n  shows \"(\\<integral> x. f x \\<partial>M) \\<noteq> 0\""], "translations": [["", "lemma (in ergodic_qmpt) AE_equal_preimage_then_null_or_conull:\n  assumes [measurable]: \"A \\<in> sets M\" and \"A \\<Delta> T--`A \\<in> null_sets M\"\n  shows \"A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "obtain B where B: \"B \\<in> sets Invariants\" \"A \\<Delta> B \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>B \\<in> sets Invariants;\n         A \\<Delta> B \\<in> null_sets M\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis Un_commute Invariants_quasi_Invariants_sets[OF assms(1)] assms(2))"], ["proof (state)\nthis:\n  B \\<in> sets Invariants\n  A \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<in> sets M", "using B(1)"], ["proof (prove)\nusing this:\n  B \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "using Invariants_in_sets"], ["proof (prove)\nusing this:\n  B \\<in> sets Invariants\n  ?A \\<in> sets Invariants \\<Longrightarrow> ?A \\<in> sets M\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "by blast"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "have *: \"B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M", "using ergodic B(1)"], ["proof (prove)\nusing this:\n  ?A \\<in> sets Invariants \\<Longrightarrow>\n  ?A \\<in> null_sets M \\<or> space M - ?A \\<in> null_sets M\n  B \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M", "by blast"], ["proof (state)\nthis:\n  B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n 2. \\<not> ?P \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "assume \"B \\<in> null_sets M\""], ["proof (state)\nthis:\n  B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n 2. \\<not> ?P \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<in> null_sets M", "have \"A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M", "by (metis Un_commute B(2) Delta_null_of_null_is_null[OF assms(1), where ?A = B])"], ["proof (state)\nthis:\n  A \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n 2. \\<not> ?P \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  A \\<in> null_sets M", "show ?thesis"], ["proof (prove)\nusing this:\n  A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<notin> null_sets M \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. B \\<notin> null_sets M \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "assume \"\\<not>(B \\<in> null_sets M)\""], ["proof (state)\nthis:\n  B \\<notin> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<notin> null_sets M \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<notin> null_sets M", "have i: \"space M - B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<notin> null_sets M\n\ngoal (1 subgoal):\n 1. space M - B \\<in> null_sets M", "using *"], ["proof (prove)\nusing this:\n  B \\<notin> null_sets M\n  B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - B \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<notin> null_sets M \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "have \"(space M - B) \\<Delta> (space M - A) = A \\<Delta> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (space M - B) \\<Delta> (space M - A) = A \\<Delta> B", "using sets.sets_into_space[OF \\<open>A \\<in> sets M\\<close>] sets.sets_into_space[OF \\<open>B \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  A \\<subseteq> space M\n  B \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. (space M - B) \\<Delta> (space M - A) = A \\<Delta> B", "by blast"], ["proof (state)\nthis:\n  (space M - B) \\<Delta> (space M - A) = A \\<Delta> B\n\ngoal (1 subgoal):\n 1. B \\<notin> null_sets M \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  (space M - B) \\<Delta> (space M - A) = A \\<Delta> B", "have \"(space M - B) \\<Delta> (space M - A) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  (space M - B) \\<Delta> (space M - A) = A \\<Delta> B\n\ngoal (1 subgoal):\n 1. (space M - B) \\<Delta> (space M - A) \\<in> null_sets M", "using B(2)"], ["proof (prove)\nusing this:\n  (space M - B) \\<Delta> (space M - A) = A \\<Delta> B\n  A \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (space M - B) \\<Delta> (space M - A) \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  (space M - B) \\<Delta> (space M - A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<notin> null_sets M \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  (space M - B) \\<Delta> (space M - A) \\<in> null_sets M", "have \"space M - A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  (space M - B) \\<Delta> (space M - A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - A \\<in> null_sets M", "using Delta_null_of_null_is_null[where ?A = \"space M - B\" and ?B = \"space M - A\"] i"], ["proof (prove)\nusing this:\n  (space M - B) \\<Delta> (space M - A) \\<in> null_sets M\n  \\<lbrakk>space M - A \\<in> sets ?M;\n   (space M - B) \\<Delta> (space M - A) \\<in> null_sets ?M;\n   space M - B \\<in> null_sets ?M\\<rbrakk>\n  \\<Longrightarrow> space M - A \\<in> null_sets ?M\n  space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - A \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  space M - A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<notin> null_sets M \\<Longrightarrow>\n    A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  space M - A \\<in> null_sets M", "show ?thesis"], ["proof (prove)\nusing this:\n  space M - A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The inverse of an ergodic transformation is also ergodic.\\<close>"], ["", "lemma (in ergodic_qmpt) ergodic_Tinv:\n  assumes \"invertible_qmpt\"\n  shows \"ergodic_qmpt M Tinv\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ergodic_qmpt M Tinv", "unfolding ergodic_qmpt_def ergodic_qmpt_axioms_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. qmpt M Tinv \\<and>\n    (\\<forall>A.\n        A \\<in> sets (qmpt.Invariants M Tinv) \\<longrightarrow>\n        A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. qmpt M Tinv\n 2. \\<forall>A.\n       A \\<in> sets (qmpt.Invariants M Tinv) \\<longrightarrow>\n       A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "show \"qmpt M Tinv\""], ["proof (prove)\ngoal (1 subgoal):\n 1. qmpt M Tinv", "using Tinv_qmpt[OF assms]"], ["proof (prove)\nusing this:\n  qmpt M Tinv\n\ngoal (1 subgoal):\n 1. qmpt M Tinv", "by simp"], ["proof (state)\nthis:\n  qmpt M Tinv\n\ngoal (1 subgoal):\n 1. \\<forall>A.\n       A \\<in> sets (qmpt.Invariants M Tinv) \\<longrightarrow>\n       A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "show \"\\<forall>A. A \\<in> sets (qmpt.Invariants M Tinv) \\<longrightarrow> A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>A.\n       A \\<in> sets (qmpt.Invariants M Tinv) \\<longrightarrow>\n       A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "proof (intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A.\n       A \\<in> sets (qmpt.Invariants M Tinv) \\<Longrightarrow>\n       A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "fix A"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A.\n       A \\<in> sets (qmpt.Invariants M Tinv) \\<Longrightarrow>\n       A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "assume \"A \\<in> sets (qmpt.Invariants M Tinv)\""], ["proof (state)\nthis:\n  A \\<in> sets (qmpt.Invariants M Tinv)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       A \\<in> sets (qmpt.Invariants M Tinv) \\<Longrightarrow>\n       A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  A \\<in> sets (qmpt.Invariants M Tinv)", "have \"A \\<in> sets Invariants\""], ["proof (prove)\nusing this:\n  A \\<in> sets (qmpt.Invariants M Tinv)\n\ngoal (1 subgoal):\n 1. A \\<in> sets Invariants", "using Invariants_Tinv[OF assms]"], ["proof (prove)\nusing this:\n  A \\<in> sets (qmpt.Invariants M Tinv)\n  qmpt.Invariants M Tinv = Invariants\n\ngoal (1 subgoal):\n 1. A \\<in> sets Invariants", "by simp"], ["proof (state)\nthis:\n  A \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       A \\<in> sets (qmpt.Invariants M Tinv) \\<Longrightarrow>\n       A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  A \\<in> sets Invariants", "show \"A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "using ergodic"], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n  ?A \\<in> sets Invariants \\<Longrightarrow>\n  ?A \\<in> null_sets M \\<or> space M - ?A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>A.\n     A \\<in> sets (qmpt.Invariants M Tinv) \\<longrightarrow>\n     A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>In the conservative case, instead of the almost invariance of a set, it suffices to\nassume that the preimage is contained in the set, or contains the set, to deduce that it is null\nor conull.\\<close>"], ["", "lemma (in ergodic_conservative) preimage_included_then_null_or_conull:\n  assumes \"A \\<in> sets M\" \"T--`A \\<subseteq> A\"\n  shows \"A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "have \"A \\<Delta> T--`A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "using preimage_included_then_almost_invariant[OF assms]"], ["proof (prove)\nusing this:\n  A \\<Delta> T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  A \\<Delta> T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  A \\<Delta> T --` A \\<in> null_sets M", "show ?thesis"], ["proof (prove)\nusing this:\n  A \\<Delta> T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "using AE_equal_preimage_then_null_or_conull assms(1)"], ["proof (prove)\nusing this:\n  A \\<Delta> T --` A \\<in> null_sets M\n  \\<lbrakk>?A \\<in> sets M; ?A \\<Delta> T --` ?A \\<in> null_sets M\\<rbrakk>\n  \\<Longrightarrow> ?A \\<in> null_sets M \\<or>\n                    space M - ?A \\<in> null_sets M\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_conservative) preimage_includes_then_null_or_conull:\n  assumes \"A \\<in> sets M\" \"T--`A \\<supseteq> A\"\n  shows \"A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "have \"A \\<Delta> T--`A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "using preimage_includes_then_almost_invariant[OF assms]"], ["proof (prove)\nusing this:\n  A \\<Delta> T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  A \\<Delta> T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  A \\<Delta> T --` A \\<in> null_sets M", "show ?thesis"], ["proof (prove)\nusing this:\n  A \\<Delta> T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "using AE_equal_preimage_then_null_or_conull assms(1)"], ["proof (prove)\nusing this:\n  A \\<Delta> T --` A \\<in> null_sets M\n  \\<lbrakk>?A \\<in> sets M; ?A \\<Delta> T --` ?A \\<in> null_sets M\\<rbrakk>\n  \\<Longrightarrow> ?A \\<in> null_sets M \\<or>\n                    space M - ?A \\<in> null_sets M\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  A \\<in> null_sets M \\<or> space M - A \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_conservative) preimages_conull:\n  assumes [measurable]: \"A \\<in> sets M\" and \"emeasure M A > 0\"\n  shows \"space M - (\\<Union>n. (T^^n)--`A) \\<in> null_sets M\"\n        \"space M \\<Delta> (\\<Union>n. (T^^n)--`A) \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M &&&\n    space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "define B where \"B = (\\<Union>n. (T^^n)--`A)\""], ["proof (state)\nthis:\n  B = (\\<Union>n. (T ^^ n) --` A)\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B = (\\<Union>n. (T ^^ n) --` A)", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\nusing this:\n  B = (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "have \"T--`B = (\\<Union>n. (T^^(n+1))--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T --` B = (\\<Union>n. (T ^^ (n + 1)) --` A)", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. T --` (\\<Union>n. (T ^^ n) --` A) = (\\<Union>n. (T ^^ (n + 1)) --` A)", "using T_vrestr_composed(2)"], ["proof (prove)\nusing this:\n  ?A \\<in> sets M \\<Longrightarrow>\n  T --` (T ^^ ?m) --` ?A = (T ^^ (?m + 1)) --` ?A\n\ngoal (1 subgoal):\n 1. T --` (\\<Union>n. (T ^^ n) --` A) = (\\<Union>n. (T ^^ (n + 1)) --` A)", "by auto"], ["proof (state)\nthis:\n  T --` B = (\\<Union>n. (T ^^ (n + 1)) --` A)\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` B = (\\<Union>n. (T ^^ (n + 1)) --` A)", "have \"T--`B \\<subseteq> B\""], ["proof (prove)\nusing this:\n  T --` B = (\\<Union>n. (T ^^ (n + 1)) --` A)\n\ngoal (1 subgoal):\n 1. T --` B \\<subseteq> B", "using B_def"], ["proof (prove)\nusing this:\n  T --` B = (\\<Union>n. (T ^^ (n + 1)) --` A)\n  B = (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. T --` B \\<subseteq> B", "by blast"], ["proof (state)\nthis:\n  T --` B \\<subseteq> B\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` B \\<subseteq> B", "have *: \"B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` B \\<subseteq> B\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M", "using preimage_included_then_null_or_conull"], ["proof (prove)\nusing this:\n  T --` B \\<subseteq> B\n  \\<lbrakk>?A \\<in> sets M; T --` ?A \\<subseteq> ?A\\<rbrakk>\n  \\<Longrightarrow> ?A \\<in> null_sets M \\<or>\n                    space M - ?A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "have \"A \\<subseteq> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<subseteq> B", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<subseteq> (\\<Union>n. (T ^^ n) --` A)", "using T_vrestr_0 assms(1)"], ["proof (prove)\nusing this:\n  ?A \\<in> sets M \\<Longrightarrow> (T ^^ 0) --` ?A = ?A\n  ?A \\<in> sets M \\<Longrightarrow> id --` ?A = ?A\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. A \\<subseteq> (\\<Union>n. (T ^^ n) --` A)", "by blast"], ["proof (state)\nthis:\n  A \\<subseteq> B\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  A \\<subseteq> B", "have \"emeasure M B > 0\""], ["proof (prove)\nusing this:\n  A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. 0 < emeasure M B", "using assms(2)"], ["proof (prove)\nusing this:\n  A \\<subseteq> B\n  0 < emeasure M A\n\ngoal (1 subgoal):\n 1. 0 < emeasure M B", "by (metis \\<open>B \\<in> sets M\\<close> emeasure_eq_0 zero_less_iff_neq_zero)"], ["proof (state)\nthis:\n  0 < emeasure M B\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  0 < emeasure M B", "have \"B \\<notin> null_sets M\""], ["proof (prove)\nusing this:\n  0 < emeasure M B\n\ngoal (1 subgoal):\n 1. B \\<notin> null_sets M", "by auto"], ["proof (state)\nthis:\n  B \\<notin> null_sets M\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<notin> null_sets M", "have i: \"space M - B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<notin> null_sets M\n\ngoal (1 subgoal):\n 1. space M - B \\<in> null_sets M", "using *"], ["proof (prove)\nusing this:\n  B \\<notin> null_sets M\n  B \\<in> null_sets M \\<or> space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - B \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  space M - B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n 2. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  space M - B \\<in> null_sets M", "show \"space M - (\\<Union>n. (T^^n)--`A) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "using B_def"], ["proof (prove)\nusing this:\n  space M - B \\<in> null_sets M\n  B = (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  space M - (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "have \"B \\<subseteq> space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<subseteq> space M", "using sets.sets_into_space[OF \\<open>B \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  B \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. B \\<subseteq> space M", "by auto"], ["proof (state)\nthis:\n  B \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<subseteq> space M", "have \"space M \\<Delta> B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. space M \\<Delta> B \\<in> null_sets M", "using i"], ["proof (prove)\nusing this:\n  B \\<subseteq> space M\n  space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<Delta> B \\<in> null_sets M", "by (simp add: Diff_mono sup.absorb1)"], ["proof (state)\nthis:\n  space M \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  space M \\<Delta> B \\<in> null_sets M", "show \"space M \\<Delta> (\\<Union>n. (T^^n)--`A) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  space M \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "using B_def"], ["proof (prove)\nusing this:\n  space M \\<Delta> B \\<in> null_sets M\n  B = (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Behavior of functions in ergodic transformations\\<close>"], ["", "text \\<open>In the same way that invariant sets are null or conull, invariant functions are almost\neverywhere constant in an ergodic transformation. For real functions, one can consider\nthe set where $\\{f x \\geq d \\}$, it has measure $0$ or $1$ depending on $d$.\nThen $f$ is almost surely equal to the maximal $d$ such that this set has measure $1$. For functions\ntaking values in a general space, the argument is essentially the same, replacing intervals by\na basis of the topology.\\<close>"], ["", "lemma (in ergodic_qmpt) Invariant_func_is_AE_constant:\n  fixes f::\"_\\<Rightarrow> 'b::{second_countable_topology, t1_space}\"\n  assumes \"f \\<in> borel_measurable Invariants\"\n  shows \"\\<exists>y. AE x in M. f x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>y. AE x in M. f x = y\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>y. AE x in M. f x = y", "assume \"space M \\<in> null_sets M\""], ["proof (state)\nthis:\n  space M \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>y. AE x in M. f x = y\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>y. AE x in M. f x = y", "obtain y::'b where \"True\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (True \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  True\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>y. AE x in M. f x = y\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>y. AE x in M. f x = y", "have \"AE x in M. f x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. f x = y", "using \\<open>space M \\<in> null_sets M\\<close> AE_I'"], ["proof (prove)\nusing this:\n  space M \\<in> null_sets M\n  \\<lbrakk>?N \\<in> null_sets ?M;\n   {x \\<in> space ?M. \\<not> ?P x} \\<subseteq> ?N\\<rbrakk>\n  \\<Longrightarrow> almost_everywhere ?M ?P\n\ngoal (1 subgoal):\n 1. AE x in M. f x = y", "by blast"], ["proof (state)\nthis:\n  AE x in M. f x = y\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>y. AE x in M. f x = y\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  AE x in M. f x = y", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. f x = y\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y. AE x in M. f x = y\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "assume *: \"\\<not>(space M \\<in> null_sets M)\""], ["proof (state)\nthis:\n  space M \\<notin> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "obtain B::\"'b set set\" where B: \"countable B\" \"topological_basis B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>countable B; topological_basis B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using ex_countable_basis"], ["proof (prove)\nusing this:\n  \\<exists>B. countable B \\<and> topological_basis B\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>countable B; topological_basis B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  countable B\n  topological_basis B\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "define C where \"C = {b \\<in> B. space M - f-`b \\<in> null_sets M}\""], ["proof (state)\nthis:\n  C = {b \\<in> B. space M - f -` b \\<in> null_sets M}\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  C = {b \\<in> B. space M - f -` b \\<in> null_sets M}", "have \"countable C\""], ["proof (prove)\nusing this:\n  C = {b \\<in> B. space M - f -` b \\<in> null_sets M}\n\ngoal (1 subgoal):\n 1. countable C", "using \\<open>countable B\\<close>"], ["proof (prove)\nusing this:\n  C = {b \\<in> B. space M - f -` b \\<in> null_sets M}\n  countable B\n\ngoal (1 subgoal):\n 1. countable C", "by auto"], ["proof (state)\nthis:\n  countable C\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "define Y where \"Y = \\<Inter> C\""], ["proof (state)\nthis:\n  Y = \\<Inter> C\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "have \"space M - f-`Y = (\\<Union> b\\<in> C. space M - f-`b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - f -` Y = (\\<Union>b\\<in>C. space M - f -` b)", "unfolding Y_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - f -` \\<Inter> C = (\\<Union>b\\<in>C. space M - f -` b)", "by auto"], ["proof (state)\nthis:\n  space M - f -` Y = (\\<Union>b\\<in>C. space M - f -` b)\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "moreover"], ["proof (state)\nthis:\n  space M - f -` Y = (\\<Union>b\\<in>C. space M - f -` b)\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "have \"\\<And>b. b \\<in> C \\<Longrightarrow> space M - f-`b \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b. b \\<in> C \\<Longrightarrow> space M - f -` b \\<in> null_sets M", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       b \\<in> {b \\<in> B.\n                space M - f -` b \\<in> null_sets M} \\<Longrightarrow>\n       space M - f -` b \\<in> null_sets M", "by blast"], ["proof (state)\nthis:\n  ?b3 \\<in> C \\<Longrightarrow> space M - f -` ?b3 \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "ultimately"], ["proof (chain)\npicking this:\n  space M - f -` Y = (\\<Union>b\\<in>C. space M - f -` b)\n  ?b3 \\<in> C \\<Longrightarrow> space M - f -` ?b3 \\<in> null_sets M", "have i: \"space M - f-`Y \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  space M - f -` Y = (\\<Union>b\\<in>C. space M - f -` b)\n  ?b3 \\<in> C \\<Longrightarrow> space M - f -` ?b3 \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - f -` Y \\<in> null_sets M", "using \\<open>countable C\\<close>"], ["proof (prove)\nusing this:\n  space M - f -` Y = (\\<Union>b\\<in>C. space M - f -` b)\n  ?b3 \\<in> C \\<Longrightarrow> space M - f -` ?b3 \\<in> null_sets M\n  countable C\n\ngoal (1 subgoal):\n 1. space M - f -` Y \\<in> null_sets M", "by (metis null_sets_UN')"], ["proof (state)\nthis:\n  space M - f -` Y \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  space M - f -` Y \\<in> null_sets M", "have \"f-`Y \\<noteq> {}\""], ["proof (prove)\nusing this:\n  space M - f -` Y \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. f -` Y \\<noteq> {}", "using *"], ["proof (prove)\nusing this:\n  space M - f -` Y \\<in> null_sets M\n  space M \\<notin> null_sets M\n\ngoal (1 subgoal):\n 1. f -` Y \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  f -` Y \\<noteq> {}\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  f -` Y \\<noteq> {}", "have \"Y \\<noteq> {}\""], ["proof (prove)\nusing this:\n  f -` Y \\<noteq> {}\n\ngoal (1 subgoal):\n 1. Y \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  Y \\<noteq> {}\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  Y \\<noteq> {}", "obtain y where \"y \\<in> Y\""], ["proof (prove)\nusing this:\n  Y \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (\\<And>y. y \\<in> Y \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  y \\<in> Y\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "define D where \"D = {b \\<in> B. y\\<notin>b \\<and> f-`b \\<inter> space M \\<in> null_sets M}\""], ["proof (state)\nthis:\n  D =\n  {b \\<in> B. y \\<notin> b \\<and> f -` b \\<inter> space M \\<in> null_sets M}\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "have \"countable D\""], ["proof (prove)\ngoal (1 subgoal):\n 1. countable D", "using \\<open>countable B\\<close> D_def"], ["proof (prove)\nusing this:\n  countable B\n  D =\n  {b \\<in> B. y \\<notin> b \\<and> f -` b \\<inter> space M \\<in> null_sets M}\n\ngoal (1 subgoal):\n 1. countable D", "by auto"], ["proof (state)\nthis:\n  countable D\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "{"], ["proof (state)\nthis:\n  countable D\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "fix z"], ["proof (state)\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "assume \"z \\<noteq> y\""], ["proof (state)\nthis:\n  z \\<noteq> y\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "obtain U where U: \"open U\" \"z \\<in> U\" \"y \\<notin> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>open U; z \\<in> U; y \\<notin> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using t1_space[OF \\<open>z \\<noteq> y\\<close>]"], ["proof (prove)\nusing this:\n  \\<exists>U. open U \\<and> z \\<in> U \\<and> y \\<notin> U\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>open U; z \\<in> U; y \\<notin> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  open U\n  z \\<in> U\n  y \\<notin> U\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "obtain V where \"V \\<in> B\" \"V \\<subseteq> U\" \"z \\<in> V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>V.\n        \\<lbrakk>V \\<in> B; V \\<subseteq> U; z \\<in> V\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (rule topological_basisE[OF \\<open>topological_basis B\\<close> \\<open>open U\\<close> \\<open>z \\<in> U\\<close>])"], ["proof (state)\nthis:\n  V \\<in> B\n  V \\<subseteq> U\n  z \\<in> V\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  V \\<in> B\n  V \\<subseteq> U\n  z \\<in> V", "have \"y \\<notin> V\""], ["proof (prove)\nusing this:\n  V \\<in> B\n  V \\<subseteq> U\n  z \\<in> V\n\ngoal (1 subgoal):\n 1. y \\<notin> V", "using U"], ["proof (prove)\nusing this:\n  V \\<in> B\n  V \\<subseteq> U\n  z \\<in> V\n  open U\n  z \\<in> U\n  y \\<notin> U\n\ngoal (1 subgoal):\n 1. y \\<notin> V", "by blast"], ["proof (state)\nthis:\n  y \\<notin> V\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  y \\<notin> V", "have \"V \\<notin> C\""], ["proof (prove)\nusing this:\n  y \\<notin> V\n\ngoal (1 subgoal):\n 1. V \\<notin> C", "using \\<open>y \\<in> Y\\<close> Y_def"], ["proof (prove)\nusing this:\n  y \\<notin> V\n  y \\<in> Y\n  Y = \\<Inter> C\n\ngoal (1 subgoal):\n 1. V \\<notin> C", "by auto"], ["proof (state)\nthis:\n  V \\<notin> C\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  V \\<notin> C", "have \"space M - f-`V \\<inter> space M \\<notin> null_sets M\""], ["proof (prove)\nusing this:\n  V \\<notin> C\n\ngoal (1 subgoal):\n 1. space M - f -` V \\<inter> space M \\<notin> null_sets M", "unfolding C_def"], ["proof (prove)\nusing this:\n  V \\<notin> {b \\<in> B. space M - f -` b \\<in> null_sets M}\n\ngoal (1 subgoal):\n 1. space M - f -` V \\<inter> space M \\<notin> null_sets M", "using \\<open>V \\<in> B\\<close>"], ["proof (prove)\nusing this:\n  V \\<notin> {b \\<in> B. space M - f -` b \\<in> null_sets M}\n  V \\<in> B\n\ngoal (1 subgoal):\n 1. space M - f -` V \\<inter> space M \\<notin> null_sets M", "by (metis (no_types, lifting) Diff_Int2 inf.idem mem_Collect_eq)"], ["proof (state)\nthis:\n  space M - f -` V \\<inter> space M \\<notin> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "moreover"], ["proof (state)\nthis:\n  space M - f -` V \\<inter> space M \\<notin> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "have \"f-`V \\<inter> space M \\<in> sets Invariants\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f -` V \\<inter> space M \\<in> sets Invariants", "using measurable_sets[OF assms borel_open[OF topological_basis_open[OF B(2) \\<open>V \\<in> B\\<close>]]] subalgebra_def Invariants_is_subalg"], ["proof (prove)\nusing this:\n  f -` V \\<inter> space Invariants \\<in> sets Invariants\n  subalgebra ?M ?F =\n  (space ?F = space ?M \\<and> sets ?F \\<subseteq> sets ?M)\n  subalgebra M Invariants\n\ngoal (1 subgoal):\n 1. f -` V \\<inter> space M \\<in> sets Invariants", "by metis"], ["proof (state)\nthis:\n  f -` V \\<inter> space M \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "ultimately"], ["proof (chain)\npicking this:\n  space M - f -` V \\<inter> space M \\<notin> null_sets M\n  f -` V \\<inter> space M \\<in> sets Invariants", "have \"f-`V \\<inter> space M \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  space M - f -` V \\<inter> space M \\<notin> null_sets M\n  f -` V \\<inter> space M \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. f -` V \\<inter> space M \\<in> null_sets M", "using ergodic"], ["proof (prove)\nusing this:\n  space M - f -` V \\<inter> space M \\<notin> null_sets M\n  f -` V \\<inter> space M \\<in> sets Invariants\n  ?A \\<in> sets Invariants \\<Longrightarrow>\n  ?A \\<in> null_sets M \\<or> space M - ?A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. f -` V \\<inter> space M \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  f -` V \\<inter> space M \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  f -` V \\<inter> space M \\<in> null_sets M", "have \"V \\<in> D\""], ["proof (prove)\nusing this:\n  f -` V \\<inter> space M \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. V \\<in> D", "unfolding D_def"], ["proof (prove)\nusing this:\n  f -` V \\<inter> space M \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. V \\<in> {b \\<in> B.\n             y \\<notin> b \\<and> f -` b \\<inter> space M \\<in> null_sets M}", "using \\<open>V \\<in> B\\<close> \\<open>y \\<notin> V\\<close>"], ["proof (prove)\nusing this:\n  f -` V \\<inter> space M \\<in> null_sets M\n  V \\<in> B\n  y \\<notin> V\n\ngoal (1 subgoal):\n 1. V \\<in> {b \\<in> B.\n             y \\<notin> b \\<and> f -` b \\<inter> space M \\<in> null_sets M}", "by auto"], ["proof (state)\nthis:\n  V \\<in> D\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  V \\<in> D", "have \"\\<exists>b \\<in> D. z \\<in> b\""], ["proof (prove)\nusing this:\n  V \\<in> D\n\ngoal (1 subgoal):\n 1. \\<exists>b\\<in>D. z \\<in> b", "using \\<open>z \\<in> V\\<close>"], ["proof (prove)\nusing this:\n  V \\<in> D\n  z \\<in> V\n\ngoal (1 subgoal):\n 1. \\<exists>b\\<in>D. z \\<in> b", "by auto"], ["proof (state)\nthis:\n  \\<exists>b\\<in>D. z \\<in> b\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "}"], ["proof (state)\nthis:\n  ?z5 \\<noteq> y \\<Longrightarrow> \\<exists>b\\<in>D. ?z5 \\<in> b\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  ?z5 \\<noteq> y \\<Longrightarrow> \\<exists>b\\<in>D. ?z5 \\<in> b", "have *: \"\\<Union>D = UNIV - {y}\""], ["proof (prove)\nusing this:\n  ?z5 \\<noteq> y \\<Longrightarrow> \\<exists>b\\<in>D. ?z5 \\<in> b\n\ngoal (1 subgoal):\n 1. \\<Union> D = UNIV - {y}", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>X.\n       \\<lbrakk>\\<And>z.\n                   z \\<noteq> y \\<Longrightarrow>\n                   \\<exists>x\\<in>D. z \\<in> x;\n        y \\<in> X; X \\<in> D\\<rbrakk>\n       \\<Longrightarrow> False", "unfolding D_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>X.\n       \\<lbrakk>\\<And>z.\n                   z \\<noteq> y \\<Longrightarrow>\n                   \\<exists>x\\<in>{b \\<in> B.\n                                   y \\<notin> b \\<and>\n                                   f -` b \\<inter> space M\n                                   \\<in> null_sets M}.\n                      z \\<in> x;\n        y \\<in> X;\n        X \\<in> {b \\<in> B.\n                 y \\<notin> b \\<and>\n                 f -` b \\<inter> space M \\<in> null_sets M}\\<rbrakk>\n       \\<Longrightarrow> False", "by auto"], ["proof (state)\nthis:\n  \\<Union> D = UNIV - {y}\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "have \"space M - f-`{y} = f-`(UNIV -{y}) \\<inter> space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - f -` {y} = f -` (UNIV - {y}) \\<inter> space M", "by blast"], ["proof (state)\nthis:\n  space M - f -` {y} = f -` (UNIV - {y}) \\<inter> space M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "also"], ["proof (state)\nthis:\n  space M - f -` {y} = f -` (UNIV - {y}) \\<inter> space M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "have \"... = (\\<Union>b\\<in>D. f-`b \\<inter> space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f -` (UNIV - {y}) \\<inter> space M =\n    (\\<Union>b\\<in>D. f -` b \\<inter> space M)", "using *"], ["proof (prove)\nusing this:\n  \\<Union> D = UNIV - {y}\n\ngoal (1 subgoal):\n 1. f -` (UNIV - {y}) \\<inter> space M =\n    (\\<Union>b\\<in>D. f -` b \\<inter> space M)", "by auto"], ["proof (state)\nthis:\n  f -` (UNIV - {y}) \\<inter> space M =\n  (\\<Union>b\\<in>D. f -` b \\<inter> space M)\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "also"], ["proof (state)\nthis:\n  f -` (UNIV - {y}) \\<inter> space M =\n  (\\<Union>b\\<in>D. f -` b \\<inter> space M)\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "have \"... \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>b\\<in>D. f -` b \\<inter> space M) \\<in> null_sets M", "using D_def \\<open>countable D\\<close>"], ["proof (prove)\nusing this:\n  D =\n  {b \\<in> B. y \\<notin> b \\<and> f -` b \\<inter> space M \\<in> null_sets M}\n  countable D\n\ngoal (1 subgoal):\n 1. (\\<Union>b\\<in>D. f -` b \\<inter> space M) \\<in> null_sets M", "by (metis (no_types, lifting) mem_Collect_eq null_sets_UN')"], ["proof (state)\nthis:\n  (\\<Union>b\\<in>D. f -` b \\<inter> space M) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "finally"], ["proof (chain)\npicking this:\n  space M - f -` {y} \\<in> null_sets M", "have \"space M - f-`{y} \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  space M - f -` {y} \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - f -` {y} \\<in> null_sets M", "by blast"], ["proof (state)\nthis:\n  space M - f -` {y} \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "with AE_not_in[OF this]"], ["proof (chain)\npicking this:\n  AE x in M. x \\<notin> space M - f -` {y}\n  space M - f -` {y} \\<in> null_sets M", "have \"AE x in M. x \\<in> f-`{y}\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<notin> space M - f -` {y}\n  space M - f -` {y} \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> f -` {y}", "by auto"], ["proof (state)\nthis:\n  AE x in M. x \\<in> f -` {y}\n\ngoal (1 subgoal):\n 1. space M \\<notin> null_sets M \\<Longrightarrow>\n    \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  AE x in M. x \\<in> f -` {y}", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. x \\<in> f -` {y}\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y. AE x in M. f x = y\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The same goes for functions which are only almost invariant, as they coindice almost\neverywhere with genuine invariant functions.\\<close>"], ["", "lemma (in ergodic_qmpt) AE_Invariant_func_is_AE_constant:\n  fixes f::\"_ \\<Rightarrow> 'b::{second_countable_topology, t2_space}\"\n  assumes \"f \\<in> borel_measurable M\" \"AE x in M. f(T x) = f x\"\n  shows \"\\<exists>y. AE x in M. f x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "obtain g where g: \"g \\<in> borel_measurable Invariants\" \"AE x in M. f x = g x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>g \\<in> borel_measurable Invariants;\n         AE x in M. f x = g x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Invariants_quasi_Invariants_functions[OF assms(1)] assms(2)"], ["proof (prove)\nusing this:\n  (\\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x) =\n  (AE x in M. f (T x) = f x)\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>g \\<in> borel_measurable Invariants;\n         AE x in M. f x = g x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x", "obtain y where y: \"AE x in M. g x = y\""], ["proof (prove)\nusing this:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x\n\ngoal (1 subgoal):\n 1. (\\<And>y. AE x in M. g x = y \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Invariant_func_is_AE_constant"], ["proof (prove)\nusing this:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x\n  ?f \\<in> borel_measurable Invariants \\<Longrightarrow>\n  \\<exists>y. AE x in M. ?f x = y\n\ngoal (1 subgoal):\n 1. (\\<And>y. AE x in M. g x = y \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  AE x in M. g x = y\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "have \"AE x in M. f x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. f x = y", "using g(2) y"], ["proof (prove)\nusing this:\n  AE x in M. f x = g x\n  AE x in M. g x = y\n\ngoal (1 subgoal):\n 1. AE x in M. f x = y", "by auto"], ["proof (state)\nthis:\n  AE x in M. f x = y\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  AE x in M. f x = y", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. f x = y\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y. AE x in M. f x = y\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>In conservative systems, it suffices to have an inequality between $f$ and $f \\circ T$,\nsince such a function is almost invariant.\\<close>"], ["", "lemma (in ergodic_conservative) AE_decreasing_func_is_AE_constant:\n  fixes f::\"_ \\<Rightarrow> 'b::{linorder_topology, second_countable_topology}\"\n  assumes \"AE x in M. f(T x) \\<le> f x\"\n    and [measurable]: \"f \\<in> borel_measurable M\"\n  shows \"\\<exists>y. AE x in M. f x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "have \"AE x in M. f(T x) = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "using AE_decreasing_then_invariant[OF assms]"], ["proof (prove)\nusing this:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  AE x in M. f (T x) = f x", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "using AE_Invariant_func_is_AE_constant[OF assms(2)]"], ["proof (prove)\nusing this:\n  AE x in M. f (T x) = f x\n  AE x in M. f (T x) = f x \\<Longrightarrow> \\<exists>y. AE x in M. f x = y\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y. AE x in M. f x = y\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_conservative) AE_increasing_func_is_AE_constant:\n  fixes f::\"_ \\<Rightarrow> 'b::{linorder_topology, second_countable_topology}\"\n  assumes \"AE x in M. f(T x) \\<ge> f x\"\n    and [measurable]: \"f \\<in> borel_measurable M\"\n  shows \"\\<exists>y. AE x in M. f x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "have \"AE x in M. f(T x) = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "using AE_increasing_then_invariant[OF assms]"], ["proof (prove)\nusing this:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "then"], ["proof (chain)\npicking this:\n  AE x in M. f (T x) = f x", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "using AE_Invariant_func_is_AE_constant[OF assms(2)]"], ["proof (prove)\nusing this:\n  AE x in M. f (T x) = f x\n  AE x in M. f (T x) = f x \\<Longrightarrow> \\<exists>y. AE x in M. f x = y\n\ngoal (1 subgoal):\n 1. \\<exists>y. AE x in M. f x = y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y. AE x in M. f x = y\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>When the function takes values in a Banach space, the value of the invariant (hence constant)\nfunction can be recovered by integrating the function.\\<close>"], ["", "lemma (in ergodic_fmpt) Invariant_func_integral:\n  fixes f::\"_ \\<Rightarrow> 'b::{banach, second_countable_topology}\"\n  assumes [measurable]: \"f \\<in> borel_measurable Invariants\"\n  shows \"integrable M f\"\n        \"AE x in M. f x = (\\<integral>x. f x \\<partial>M)/\\<^sub>R (measure M (space M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M f &&&\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. integrable M f\n 2. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "have [measurable]: \"f \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable M", "using assms Invariants_measurable_func"], ["proof (prove)\nusing this:\n  f \\<in> borel_measurable Invariants\n  ?f \\<in> Invariants \\<rightarrow>\\<^sub>M ?N \\<Longrightarrow>\n  ?f \\<in> M \\<rightarrow>\\<^sub>M ?N\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable M", "by blast"], ["proof (state)\nthis:\n  f \\<in> borel_measurable M\n\ngoal (2 subgoals):\n 1. integrable M f\n 2. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "obtain y where y: \"AE x in M. f x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>y. AE x in M. f x = y \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Invariant_func_is_AE_constant[OF assms]"], ["proof (prove)\nusing this:\n  \\<exists>y. AE x in M. f x = y\n\ngoal (1 subgoal):\n 1. (\\<And>y. AE x in M. f x = y \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  AE x in M. f x = y\n\ngoal (2 subgoals):\n 1. integrable M f\n 2. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "moreover"], ["proof (state)\nthis:\n  AE x in M. f x = y\n\ngoal (2 subgoals):\n 1. integrable M f\n 2. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "have \"integrable M (\\<lambda>x. y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. y)", "by auto"], ["proof (state)\nthis:\n  integrable M (\\<lambda>x. y)\n\ngoal (2 subgoals):\n 1. integrable M f\n 2. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. f x = y\n  integrable M (\\<lambda>x. y)", "show \"integrable M f\""], ["proof (prove)\nusing this:\n  AE x in M. f x = y\n  integrable M (\\<lambda>x. y)\n\ngoal (1 subgoal):\n 1. integrable M f", "by (subst integrable_cong_AE[where ?g = \"\\<lambda>x. y\"], auto)"], ["proof (state)\nthis:\n  integrable M f\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "have \"(\\<integral>x. f x \\<partial>M) = (\\<integral>x. y \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral\\<^sup>L M f = LINT x|M. y", "by (subst integral_cong_AE[where ?g = \"\\<lambda>x. y\"], auto simp add: y)"], ["proof (state)\nthis:\n  integral\\<^sup>L M f = LINT x|M. y\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "also"], ["proof (state)\nthis:\n  integral\\<^sup>L M f = LINT x|M. y\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "have \"... = measure M (space M) *\\<^sub>R y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. y = Sigma_Algebra.measure M (space M) *\\<^sub>R y", "by auto"], ["proof (state)\nthis:\n  LINT x|M. y = Sigma_Algebra.measure M (space M) *\\<^sub>R y\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "finally"], ["proof (chain)\npicking this:\n  integral\\<^sup>L M f = Sigma_Algebra.measure M (space M) *\\<^sub>R y", "have *: \"(\\<integral>x. f x \\<partial>M) = measure M (space M) *\\<^sub>R y\""], ["proof (prove)\nusing this:\n  integral\\<^sup>L M f = Sigma_Algebra.measure M (space M) *\\<^sub>R y\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M f = Sigma_Algebra.measure M (space M) *\\<^sub>R y", "by simp"], ["proof (state)\nthis:\n  integral\\<^sup>L M f = Sigma_Algebra.measure M (space M) *\\<^sub>R y\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "show \"AE x in M. f x = (\\<integral>x. f x \\<partial>M)/\\<^sub>R (measure M (space M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)\n 2. \\<not> ?P \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "assume \"emeasure M (space M) = 0\""], ["proof (state)\nthis:\n  emeasure M (space M) = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)\n 2. \\<not> ?P \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "then"], ["proof (chain)\npicking this:\n  emeasure M (space M) = 0", "have \"space M \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  emeasure M (space M) = 0\n\ngoal (1 subgoal):\n 1. space M \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  space M \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)\n 2. \\<not> ?P \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "then"], ["proof (chain)\npicking this:\n  space M \\<in> null_sets M", "show ?thesis"], ["proof (prove)\nusing this:\n  space M \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "using AE_I'"], ["proof (prove)\nusing this:\n  space M \\<in> null_sets M\n  \\<lbrakk>?N \\<in> null_sets ?M;\n   {x \\<in> space ?M. \\<not> ?P x} \\<subseteq> ?N\\<rbrakk>\n  \\<Longrightarrow> almost_everywhere ?M ?P\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "by blast"], ["proof (state)\nthis:\n  AE x in M. f x =\n             integral\\<^sup>L M f /\\<^sub>R\n             Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. emeasure M (space M) \\<noteq> 0 \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure M (space M) \\<noteq> 0 \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "assume \"\\<not>(emeasure M (space M) = 0)\""], ["proof (state)\nthis:\n  emeasure M (space M) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. emeasure M (space M) \\<noteq> 0 \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "then"], ["proof (chain)\npicking this:\n  emeasure M (space M) \\<noteq> 0", "have \"measure M (space M) > 0\""], ["proof (prove)\nusing this:\n  emeasure M (space M) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < Sigma_Algebra.measure M (space M)", "using emeasure_eq_measure measure_le_0_iff"], ["proof (prove)\nusing this:\n  emeasure M (space M) \\<noteq> 0\n  emeasure M ?A = ennreal (Sigma_Algebra.measure M ?A)\n  (Sigma_Algebra.measure ?M ?X \\<le> 0) = (Sigma_Algebra.measure ?M ?X = 0)\n\ngoal (1 subgoal):\n 1. 0 < Sigma_Algebra.measure M (space M)", "by fastforce"], ["proof (state)\nthis:\n  0 < Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. emeasure M (space M) \\<noteq> 0 \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "then"], ["proof (chain)\npicking this:\n  0 < Sigma_Algebra.measure M (space M)", "have \"y = (\\<integral>x. f x \\<partial>M)/\\<^sub>R (measure M (space M))\""], ["proof (prove)\nusing this:\n  0 < Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. y = integral\\<^sup>L M f /\\<^sub>R Sigma_Algebra.measure M (space M)", "using *"], ["proof (prove)\nusing this:\n  0 < Sigma_Algebra.measure M (space M)\n  integral\\<^sup>L M f = Sigma_Algebra.measure M (space M) *\\<^sub>R y\n\ngoal (1 subgoal):\n 1. y = integral\\<^sup>L M f /\\<^sub>R Sigma_Algebra.measure M (space M)", "by auto"], ["proof (state)\nthis:\n  y = integral\\<^sup>L M f /\\<^sub>R Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. emeasure M (space M) \\<noteq> 0 \\<Longrightarrow>\n    AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "then"], ["proof (chain)\npicking this:\n  y = integral\\<^sup>L M f /\\<^sub>R Sigma_Algebra.measure M (space M)", "show ?thesis"], ["proof (prove)\nusing this:\n  y = integral\\<^sup>L M f /\\<^sub>R Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "using y"], ["proof (prove)\nusing this:\n  y = integral\\<^sup>L M f /\\<^sub>R Sigma_Algebra.measure M (space M)\n  AE x in M. f x = y\n\ngoal (1 subgoal):\n 1. AE x in M. f x =\n               integral\\<^sup>L M f /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "by auto"], ["proof (state)\nthis:\n  AE x in M. f x =\n             integral\\<^sup>L M f /\\<^sub>R\n             Sigma_Algebra.measure M (space M)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  AE x in M. f x =\n             integral\\<^sup>L M f /\\<^sub>R\n             Sigma_Algebra.measure M (space M)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>As the conditional expectation of a function and the original function have the same\nintegral, it follows that the conditional expectation of a function with respect to the\ninvariant sigma algebra is given by the average of the function.\\<close>"], ["", "lemma (in ergodic_fmpt) Invariants_cond_exp_is_integral_fmpt:\n  fixes f::\"_ \\<Rightarrow> real\"\n  assumes \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants f x = (\\<integral>x. f x \\<partial>M) / measure M (space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               integral\\<^sup>L M f / Sigma_Algebra.measure M (space M)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               integral\\<^sup>L M f / Sigma_Algebra.measure M (space M)", "have \"AE x in M. real_cond_exp M Invariants f x = (\\<integral>x. real_cond_exp M Invariants f x \\<partial>M)/\\<^sub>R (measure M (space M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               integral\\<^sup>L M (real_cond_exp M Invariants f) /\\<^sub>R\n               Sigma_Algebra.measure M (space M)", "by (rule Invariant_func_integral(2), simp add: borel_measurable_cond_exp)"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f x =\n             integral\\<^sup>L M (real_cond_exp M Invariants f) /\\<^sub>R\n             Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               integral\\<^sup>L M f / Sigma_Algebra.measure M (space M)", "moreover"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f x =\n             integral\\<^sup>L M (real_cond_exp M Invariants f) /\\<^sub>R\n             Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               integral\\<^sup>L M f / Sigma_Algebra.measure M (space M)", "have \"(\\<integral>x. real_cond_exp M Invariants f x \\<partial>M) = (\\<integral>x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (real_cond_exp M Invariants f) = integral\\<^sup>L M f", "by (simp add: assms real_cond_exp_int(2))"], ["proof (state)\nthis:\n  integral\\<^sup>L M (real_cond_exp M Invariants f) = integral\\<^sup>L M f\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               integral\\<^sup>L M f / Sigma_Algebra.measure M (space M)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants f x =\n             integral\\<^sup>L M (real_cond_exp M Invariants f) /\\<^sub>R\n             Sigma_Algebra.measure M (space M)\n  integral\\<^sup>L M (real_cond_exp M Invariants f) = integral\\<^sup>L M f", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants f x =\n             integral\\<^sup>L M (real_cond_exp M Invariants f) /\\<^sub>R\n             Sigma_Algebra.measure M (space M)\n  integral\\<^sup>L M (real_cond_exp M Invariants f) = integral\\<^sup>L M f\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               integral\\<^sup>L M f / Sigma_Algebra.measure M (space M)", "by (simp add: divide_real_def mult.commute)"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f x =\n             integral\\<^sup>L M f / Sigma_Algebra.measure M (space M)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_pmpt) Invariants_cond_exp_is_integral:\n  fixes f::\"_ \\<Rightarrow> real\"\n  assumes \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants f x = (\\<integral>x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "by (metis div_by_1 prob_space Invariants_cond_exp_is_integral_fmpt[OF assms])"], ["", "subsection \\<open>Kac formula\\<close>"], ["", "text \\<open>We reformulate the different versions of Kac formula. They simplify as, for any set $A$\nwith positive measure, the union $\\bigcup T^{-n} A$ (which appears in all these statements)\nalmost coincides with the whole space.\\<close>"], ["", "lemma (in ergodic_conservative_mpt) local_time_unbounded:\n  assumes [measurable]: \"A \\<in> sets M\" \"B \\<in> sets M\"\n      and \"emeasure M A < \\<infinity>\" \"emeasure M B > 0\"\n  shows \"(\\<lambda>n. emeasure M {x \\<in> (T^^n)--`A. local_time B n x < k}) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. emeasure M {x \\<in> (T ^^ n) --` A. local_time B n x < k})\n    \\<longlonglongrightarrow> 0", "proof (rule local_time_unbounded3)"], ["proof (state)\ngoal (4 subgoals):\n 1. A \\<in> sets M\n 2. B \\<in> sets M\n 3. emeasure M A < \\<infinity>\n 4. A - (\\<Union>i. (T ^^ i) --` B) \\<in> null_sets M", "have \"A - (\\<Union>i. (T ^^ i) --` B) \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A - (\\<Union>i. (T ^^ i) --` B) \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  A - (\\<Union>i. (T ^^ i) --` B) \\<in> sets M\n\ngoal (4 subgoals):\n 1. A \\<in> sets M\n 2. B \\<in> sets M\n 3. emeasure M A < \\<infinity>\n 4. A - (\\<Union>i. (T ^^ i) --` B) \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  A - (\\<Union>i. (T ^^ i) --` B) \\<in> sets M\n\ngoal (4 subgoals):\n 1. A \\<in> sets M\n 2. B \\<in> sets M\n 3. emeasure M A < \\<infinity>\n 4. A - (\\<Union>i. (T ^^ i) --` B) \\<in> null_sets M", "have \"A - (\\<Union>i. (T ^^ i) --` B) \\<subseteq> space M - (\\<Union>i. (T ^^ i) --` B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A - (\\<Union>i. (T ^^ i) --` B)\n    \\<subseteq> space M - (\\<Union>i. (T ^^ i) --` B)", "using sets.sets_into_space[OF assms(1)]"], ["proof (prove)\nusing this:\n  A \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. A - (\\<Union>i. (T ^^ i) --` B)\n    \\<subseteq> space M - (\\<Union>i. (T ^^ i) --` B)", "by blast"], ["proof (state)\nthis:\n  A - (\\<Union>i. (T ^^ i) --` B)\n  \\<subseteq> space M - (\\<Union>i. (T ^^ i) --` B)\n\ngoal (4 subgoals):\n 1. A \\<in> sets M\n 2. B \\<in> sets M\n 3. emeasure M A < \\<infinity>\n 4. A - (\\<Union>i. (T ^^ i) --` B) \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  A - (\\<Union>i. (T ^^ i) --` B) \\<in> sets M\n  A - (\\<Union>i. (T ^^ i) --` B)\n  \\<subseteq> space M - (\\<Union>i. (T ^^ i) --` B)", "show \"A - (\\<Union>i. (T ^^ i) --` B) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  A - (\\<Union>i. (T ^^ i) --` B) \\<in> sets M\n  A - (\\<Union>i. (T ^^ i) --` B)\n  \\<subseteq> space M - (\\<Union>i. (T ^^ i) --` B)\n\ngoal (1 subgoal):\n 1. A - (\\<Union>i. (T ^^ i) --` B) \\<in> null_sets M", "by (metis null_sets_subset preimages_conull(1)[OF assms(2) assms(4)])"], ["proof (state)\nthis:\n  A - (\\<Union>i. (T ^^ i) --` B) \\<in> null_sets M\n\ngoal (3 subgoals):\n 1. A \\<in> sets M\n 2. B \\<in> sets M\n 3. emeasure M A < \\<infinity>", "show \"emeasure M A < \\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M A < \\<infinity>", "using assms(3)"], ["proof (prove)\nusing this:\n  emeasure M A < \\<infinity>\n\ngoal (1 subgoal):\n 1. emeasure M A < \\<infinity>", "by simp"], ["proof (state)\nthis:\n  emeasure M A < \\<infinity>\n\ngoal (2 subgoals):\n 1. A \\<in> sets M\n 2. B \\<in> sets M", "qed (simp_all add: assms)"], ["", "theorem (in ergodic_conservative_mpt) kac_formula:\n  assumes [measurable]: \"A \\<in> sets M\" and \"emeasure M A > 0\"\n  shows \"(\\<integral>\\<^sup>+y. return_time_function A y \\<partial>M) = emeasure M (space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (space M)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (space M)", "have a [measurable]: \"(\\<Union>n. (T^^n)--`A) \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` A) \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` A) \\<in> sets M\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (space M)", "then"], ["proof (chain)\npicking this:\n  (\\<Union>n. (T ^^ n) --` A) \\<in> sets M", "have \"space M = (\\<Union>n. (T^^n)--`A) \\<union> (space M - (\\<Union>n. (T^^n)--`A))\""], ["proof (prove)\nusing this:\n  (\\<Union>n. (T ^^ n) --` A) \\<in> sets M\n\ngoal (1 subgoal):\n 1. space M =\n    (\\<Union>n. (T ^^ n) --` A) \\<union>\n    (space M - (\\<Union>n. (T ^^ n) --` A))", "using sets.sets_into_space"], ["proof (prove)\nusing this:\n  (\\<Union>n. (T ^^ n) --` A) \\<in> sets M\n  ?x \\<in> sets ?M \\<Longrightarrow> ?x \\<subseteq> space ?M\n\ngoal (1 subgoal):\n 1. space M =\n    (\\<Union>n. (T ^^ n) --` A) \\<union>\n    (space M - (\\<Union>n. (T ^^ n) --` A))", "by blast"], ["proof (state)\nthis:\n  space M =\n  (\\<Union>n. (T ^^ n) --` A) \\<union>\n  (space M - (\\<Union>n. (T ^^ n) --` A))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (space M)", "then"], ["proof (chain)\npicking this:\n  space M =\n  (\\<Union>n. (T ^^ n) --` A) \\<union>\n  (space M - (\\<Union>n. (T ^^ n) --` A))", "have \"emeasure M (space M) = emeasure M (\\<Union>n. (T^^n)--`A)\""], ["proof (prove)\nusing this:\n  space M =\n  (\\<Union>n. (T ^^ n) --` A) \\<union>\n  (space M - (\\<Union>n. (T ^^ n) --` A))\n\ngoal (1 subgoal):\n 1. emeasure M (space M) = emeasure M (\\<Union>n. (T ^^ n) --` A)", "by (metis a preimages_conull(1)[OF assms] emeasure_Un_null_set)"], ["proof (state)\nthis:\n  emeasure M (space M) = emeasure M (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (space M)", "moreover"], ["proof (state)\nthis:\n  emeasure M (space M) = emeasure M (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (space M)", "have \"(\\<integral>\\<^sup>+y. return_time_function A y \\<partial>M) = emeasure M (\\<Union>n. (T^^n)--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (\\<Union>n. (T ^^ n) --` A)", "using kac_formula_nonergodic[OF assms(1)]"], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n  emeasure M (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (\\<Union>n. (T ^^ n) --` A)", "by simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n  emeasure M (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (space M)", "ultimately"], ["proof (chain)\npicking this:\n  emeasure M (space M) = emeasure M (\\<Union>n. (T ^^ n) --` A)\n  \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n  emeasure M (\\<Union>n. (T ^^ n) --` A)", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure M (space M) = emeasure M (\\<Union>n. (T ^^ n) --` A)\n  \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n  emeasure M (\\<Union>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n    emeasure M (space M)", "by simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. of_nat (return_time_function A x) \\<partial>M =\n  emeasure M (space M)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_conservative_mpt) induced_function_integral:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"A \\<in> sets M\" \"integrable M f\" and \"emeasure M A > 0\"\n  shows \"integrable M (induced_function A f)\"\n        \"(\\<integral>y. induced_function A f y \\<partial>M) = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (induced_function A f) &&&\n    integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. integrable M (induced_function A f)\n 2. integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "show \"integrable M (induced_function A f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (induced_function A f)", "using induced_function_integral_nonergodic(1)[OF assms(1) assms(2)]"], ["proof (prove)\nusing this:\n  integrable M (induced_function A f)\n\ngoal (1 subgoal):\n 1. integrable M (induced_function A f)", "by auto"], ["proof (state)\nthis:\n  integrable M (induced_function A f)\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "have \"(\\<integral>y. induced_function A f y \\<partial>M) = (\\<integral> x \\<in> (\\<Union>n. (T^^n)--`A). f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) =\n    set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f", "using induced_function_integral_nonergodic(2)[OF assms(1) assms(2)]"], ["proof (prove)\nusing this:\n  integral\\<^sup>L M (induced_function A f) =\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) =\n    set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f", "by auto"], ["proof (state)\nthis:\n  integral\\<^sup>L M (induced_function A f) =\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "also"], ["proof (state)\nthis:\n  integral\\<^sup>L M (induced_function A f) =\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "have \"... = (\\<integral> x \\<in> space M. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f =\n    set_lebesgue_integral M (space M) f", "using set_integral_null_delta[OF assms(2), where ?A = \"space M\" and ?B = \"(\\<Union>n. (T^^n)--`A)\"]\n    preimages_conull(2)[OF assms(1) assms(3)]"], ["proof (prove)\nusing this:\n  \\<lbrakk>space M \\<in> sets M; (\\<Union>n. (T ^^ n) --` A) \\<in> sets M;\n   space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\\<rbrakk>\n  \\<Longrightarrow> set_lebesgue_integral M (space M) f =\n                    set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f\n  space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f =\n    set_lebesgue_integral M (space M) f", "by auto"], ["proof (state)\nthis:\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f =\n  set_lebesgue_integral M (space M) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "also"], ["proof (state)\nthis:\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f =\n  set_lebesgue_integral M (space M) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "have \"... = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_lebesgue_integral M (space M) f = integral\\<^sup>L M f", "using set_integral_space[OF assms(2)]"], ["proof (prove)\nusing this:\n  set_lebesgue_integral M (space M) f = integral\\<^sup>L M f\n\ngoal (1 subgoal):\n 1. set_lebesgue_integral M (space M) f = integral\\<^sup>L M f", "by auto"], ["proof (state)\nthis:\n  set_lebesgue_integral M (space M) f = integral\\<^sup>L M f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "finally"], ["proof (chain)\npicking this:\n  integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "show \"(\\<integral>y. induced_function A f y \\<partial>M) = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\nusing this:\n  integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f", "by simp"], ["proof (state)\nthis:\n  integral\\<^sup>L M (induced_function A f) = integral\\<^sup>L M f\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_conservative_mpt) induced_function_integral_restr:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"A \\<in> sets M\" \"integrable M f\" and \"emeasure M A > 0\"\n  shows \"integrable (restrict_space M A) (induced_function A f)\"\n        \"(\\<integral>y. induced_function A f y \\<partial>(restrict_space M A)) = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable (restrict_space M A) (induced_function A f) &&&\n    integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. integrable (restrict_space M A) (induced_function A f)\n 2. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "show \"integrable (restrict_space M A) (induced_function A f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable (restrict_space M A) (induced_function A f)", "using induced_function_integral_restr_nonergodic(1)[OF assms(1) assms(2)]"], ["proof (prove)\nusing this:\n  integrable (restrict_space M A) (induced_function A f)\n\ngoal (1 subgoal):\n 1. integrable (restrict_space M A) (induced_function A f)", "by auto"], ["proof (state)\nthis:\n  integrable (restrict_space M A) (induced_function A f)\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "have \"(\\<integral>y. induced_function A f y \\<partial>(restrict_space M A)) = (\\<integral> x \\<in> (\\<Union>n. (T^^n)--`A). f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f", "using induced_function_integral_restr_nonergodic(2)[OF assms(1) assms(2)]"], ["proof (prove)\nusing this:\n  integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f", "by auto"], ["proof (state)\nthis:\n  integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "also"], ["proof (state)\nthis:\n  integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "have \"... = (\\<integral> x \\<in> space M. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f =\n    set_lebesgue_integral M (space M) f", "using set_integral_null_delta[OF assms(2), where ?A = \"space M\" and ?B = \"(\\<Union>n. (T^^n)--`A)\"]\n    preimages_conull(2)[OF assms(1) assms(3)]"], ["proof (prove)\nusing this:\n  \\<lbrakk>space M \\<in> sets M; (\\<Union>n. (T ^^ n) --` A) \\<in> sets M;\n   space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\\<rbrakk>\n  \\<Longrightarrow> set_lebesgue_integral M (space M) f =\n                    set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f\n  space M \\<Delta> (\\<Union>n. (T ^^ n) --` A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f =\n    set_lebesgue_integral M (space M) f", "by auto"], ["proof (state)\nthis:\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f =\n  set_lebesgue_integral M (space M) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "also"], ["proof (state)\nthis:\n  set_lebesgue_integral M (\\<Union>n. (T ^^ n) --` A) f =\n  set_lebesgue_integral M (space M) f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "have \"... = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_lebesgue_integral M (space M) f = integral\\<^sup>L M f", "using set_integral_space[OF assms(2)]"], ["proof (prove)\nusing this:\n  set_lebesgue_integral M (space M) f = integral\\<^sup>L M f\n\ngoal (1 subgoal):\n 1. set_lebesgue_integral M (space M) f = integral\\<^sup>L M f", "by auto"], ["proof (state)\nthis:\n  set_lebesgue_integral M (space M) f = integral\\<^sup>L M f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "finally"], ["proof (chain)\npicking this:\n  integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n  integral\\<^sup>L M f", "show \"(\\<integral>y. induced_function A f y \\<partial>(restrict_space M A)) = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\nusing this:\n  integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n  integral\\<^sup>L M f\n\ngoal (1 subgoal):\n 1. integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n    integral\\<^sup>L M f", "by simp"], ["proof (state)\nthis:\n  integral\\<^sup>L (restrict_space M A) (induced_function A f) =\n  integral\\<^sup>L M f\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Birkhoff theorem\\<close>"], ["", "text \\<open>The general versions of Birkhoff theorem are formulated in terms of conditional expectations.\nIn ergodic probability measure preserving transformations (the most common setting), they\nreduce to simpler versions that we state now, as the conditional expectations are simply the\naverages of the functions.\\<close>"], ["", "theorem (in ergodic_pmpt) birkhoff_theorem_AE:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes \"integrable M f\"\n  shows \"AE x in M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> expectation f", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> expectation f", "have \"AE x in M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "using birkhoff_theorem_AE_nonergodic[OF assms]"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "by simp"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> expectation f", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> expectation f", "have \"AE x in M. real_cond_exp M Invariants f x = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "using Invariants_cond_exp_is_integral[OF assms]"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> expectation f", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  AE x in M. real_cond_exp M Invariants f x = expectation f", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> expectation f", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> expectation f\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem (in ergodic_pmpt) birkhoff_theorem_L1:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"(\\<lambda>n. \\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - (\\<integral> x. f x \\<partial>M)) \\<partial>M) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "fix n::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"AE x in M. real_cond_exp M Invariants f x = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "using Invariants_cond_exp_is_integral[OF assms]"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants f x = expectation f", "have *: \"AE x in M. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x)\n                = norm(birkhoff_sum f n x / n - (\\<integral> x. f x \\<partial>M))\""], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. norm\n                (birkhoff_sum f n x / real n -\n                 real_cond_exp M Invariants f x) =\n               norm (birkhoff_sum f n x / real n - expectation f)", "by auto"], ["proof (state)\nthis:\n  AE x in M. norm\n              (birkhoff_sum f n x / real n -\n               real_cond_exp M Invariants f x) =\n             norm (birkhoff_sum f n x / real n - expectation f)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"(\\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M)\n                = (\\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - (\\<integral> x. f x \\<partial>M)) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal\n                            (norm\n                              (birkhoff_sum f n x / real n -\n                               real_cond_exp M Invariants f x))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal\n                            (norm\n                              (birkhoff_sum f n x / real n - expectation f))\n                       \\<partial>M", "apply (rule nn_integral_cong_AE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. ennreal\n                (norm\n                  (birkhoff_sum f n x / real n -\n                   real_cond_exp M Invariants f x)) =\n               ennreal (norm (birkhoff_sum f n x / real n - expectation f))", "using *"], ["proof (prove)\nusing this:\n  AE x in M. norm\n              (birkhoff_sum f n x / real n -\n               real_cond_exp M Invariants f x) =\n             norm (birkhoff_sum f n x / real n - expectation f)\n\ngoal (1 subgoal):\n 1. AE x in M. ennreal\n                (norm\n                  (birkhoff_sum f n x / real n -\n                   real_cond_exp M Invariants f x)) =\n               ennreal (norm (birkhoff_sum f n x / real n - expectation f))", "by auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f n x / real n -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f n x / real n - expectation f))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "}"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n14 x / real ?n14 -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n14 x / real ?n14 -\n                             expectation f))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "moreover"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n14 x / real ?n14 -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n14 x / real ?n14 -\n                             expectation f))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. \\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "using birkhoff_theorem_L1_nonergodic[OF assms]"], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum f n x / real n -\n                                 real_cond_exp M Invariants f x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum f n x / real n -\n                                 real_cond_exp M Invariants f x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "ultimately"], ["proof (chain)\npicking this:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n14 x / real ?n14 -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n14 x / real ?n14 -\n                             expectation f))\n                     \\<partial>M\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum f n x / real n -\n                                 real_cond_exp M Invariants f x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n14 x / real ?n14 -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n14 x / real ?n14 -\n                             expectation f))\n                     \\<partial>M\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum f n x / real n -\n                                 real_cond_exp M Invariants f x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   expectation f))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum f n x / real n -\n                                 expectation f))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem (in ergodic_pmpt) birkhoff_sum_small_asymp_pos:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"e>0\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) .. n * (\\<integral>x. f x \\<partial>M) + e}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           expectation f..real n * expectation f + e}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           expectation f..real n * expectation f + e}}", "have \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x .. n * real_cond_exp M Invariants f x + e}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "using birkhoff_sum_small_asymp_pos_nonergodic[OF assms]"], ["proof (prove)\nusing this:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "by simp"], ["proof (state)\nthis:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           expectation f..real n * expectation f + e}}", "moreover"], ["proof (state)\nthis:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           expectation f..real n * expectation f + e}}", "have \"AE x in M. real_cond_exp M Invariants f x = (\\<integral>x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "using Invariants_cond_exp_is_integral[OF assms(1)]"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           expectation f..real n * expectation f + e}}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n  AE x in M. real_cond_exp M Invariants f x = expectation f", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           expectation f..real n * expectation f + e}}", "by auto"], ["proof (state)\nthis:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         expectation f..real n * expectation f + e}}\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem (in ergodic_pmpt) birkhoff_sum_small_asymp_neg:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"e>0\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) - e .. n * (\\<integral>x. f x \\<partial>M)}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * expectation f -\n                           e..real n * expectation f}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * expectation f -\n                           e..real n * expectation f}}", "have \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x - e .. n * real_cond_exp M Invariants f x}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "using birkhoff_sum_small_asymp_neg_nonergodic[OF assms]"], ["proof (prove)\nusing this:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "by simp"], ["proof (state)\nthis:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * expectation f -\n                           e..real n * expectation f}}", "moreover"], ["proof (state)\nthis:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * expectation f -\n                           e..real n * expectation f}}", "have \"AE x in M. real_cond_exp M Invariants f x = (\\<integral>x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "using Invariants_cond_exp_is_integral[OF assms(1)]"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x = expectation f", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * expectation f -\n                           e..real n * expectation f}}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n  AE x in M. real_cond_exp M Invariants f x = expectation f", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n  AE x in M. real_cond_exp M Invariants f x = expectation f\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * expectation f -\n                           e..real n * expectation f}}", "by auto"], ["proof (state)\nthis:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * expectation f -\n                         e..real n * expectation f}}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_pmpt) birkhoff_positive_average:\n      fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"AE x in M. (\\<lambda>n. birkhoff_sum f n x) \\<longlonglongrightarrow> \\<infinity>\"\n  shows \"(\\<integral> x. f x \\<partial>M) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < expectation f", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "assume \"\\<not>((\\<integral> x. f x \\<partial>M) > 0)\""], ["proof (state)\nthis:\n  \\<not> 0 < expectation f\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<not> 0 < expectation f", "have *: \"(\\<integral> x. f x \\<partial>M) \\<le> 0\""], ["proof (prove)\nusing this:\n  \\<not> 0 < expectation f\n\ngoal (1 subgoal):\n 1. expectation f \\<le> 0", "by simp"], ["proof (state)\nthis:\n  expectation f \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "have \"AE x in M. (\\<lambda>n. birkhoff_sum f n x) \\<longlonglongrightarrow> \\<infinity> \\<and> infinite {n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) - 1 .. n* (\\<integral>x. f x \\<partial>M)}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n               \\<longlonglongrightarrow> \\<infinity> \\<and>\n               infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * expectation f -\n                           1..real n * expectation f}}", "using assms(2) birkhoff_sum_small_asymp_neg[OF assms(1)]"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> \\<infinity>\n  0 < ?e \\<Longrightarrow>\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * expectation f -\n                         ?e..real n * expectation f}}\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n               \\<longlonglongrightarrow> \\<infinity> \\<and>\n               infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * expectation f -\n                           1..real n * expectation f}}", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> \\<infinity> \\<and>\n             infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * expectation f -\n                         1..real n * expectation f}}\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> \\<infinity> \\<and>\n             infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * expectation f -\n                         1..real n * expectation f}}", "obtain x where x: \"(\\<lambda>n. birkhoff_sum f n x) \\<longlonglongrightarrow> \\<infinity>\" \"infinite {n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) - 1 .. n* (\\<integral>x. f x \\<partial>M)}}\""], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> \\<infinity> \\<and>\n             infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * expectation f -\n                         1..real n * expectation f}}\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>(\\<lambda>xa. ereal (birkhoff_sum f xa x))\n                 \\<longlonglongrightarrow> \\<infinity>;\n         infinite\n          {n. birkhoff_sum f n x\n              \\<in> {real n * expectation f -\n                     1..real n * expectation f}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using AE_False eventually_elim2"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> \\<infinity> \\<and>\n             infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * expectation f -\n                         1..real n * expectation f}}\n  (AE x in M. False) = False\n  \\<lbrakk>eventually ?P ?F; eventually ?Q ?F;\n   \\<And>i. \\<lbrakk>?P i; ?Q i\\<rbrakk> \\<Longrightarrow> ?R i\\<rbrakk>\n  \\<Longrightarrow> eventually ?R ?F\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>(\\<lambda>xa. ereal (birkhoff_sum f xa x))\n                 \\<longlonglongrightarrow> \\<infinity>;\n         infinite\n          {n. birkhoff_sum f n x\n              \\<in> {real n * expectation f -\n                     1..real n * expectation f}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n  \\<longlonglongrightarrow> \\<infinity>\n  infinite\n   {n. birkhoff_sum f n x\n       \\<in> {real n * expectation f - 1..real n * expectation f}}\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "{"], ["proof (state)\nthis:\n  (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n  \\<longlonglongrightarrow> \\<infinity>\n  infinite\n   {n. birkhoff_sum f n x\n       \\<in> {real n * expectation f - 1..real n * expectation f}}\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "assume \"birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) - 1 .. n * (\\<integral>x. f x \\<partial>M)}\""], ["proof (state)\nthis:\n  birkhoff_sum f n x\n  \\<in> {real n * expectation f - 1..real n * expectation f}\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f n x\n  \\<in> {real n * expectation f - 1..real n * expectation f}", "have \"birkhoff_sum f n x \\<le> n * (\\<integral>x. f x \\<partial>M)\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n x\n  \\<in> {real n * expectation f - 1..real n * expectation f}\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x \\<le> real n * expectation f", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum f n x \\<le> real n * expectation f\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  birkhoff_sum f n x \\<le> real n * expectation f\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "have \"... \\<le> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n * expectation f \\<le> 0", "using *"], ["proof (prove)\nusing this:\n  expectation f \\<le> 0\n\ngoal (1 subgoal):\n 1. real n * expectation f \\<le> 0", "by (simp add: mult_nonneg_nonpos)"], ["proof (state)\nthis:\n  real n * expectation f \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "finally"], ["proof (chain)\npicking this:\n  birkhoff_sum f n x \\<le> 0", "have \"birkhoff_sum f n x \\<le> 0\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n x \\<le> 0\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x \\<le> 0", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum f n x \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "}"], ["proof (state)\nthis:\n  birkhoff_sum f ?n14 x\n  \\<in> {real ?n14 * expectation f -\n         1..real ?n14 * expectation f} \\<Longrightarrow>\n  birkhoff_sum f ?n14 x \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f ?n14 x\n  \\<in> {real ?n14 * expectation f -\n         1..real ?n14 * expectation f} \\<Longrightarrow>\n  birkhoff_sum f ?n14 x \\<le> 0", "have \"{n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) - 1 .. n* (\\<integral>x. f x \\<partial>M)}} \\<subseteq> {n. birkhoff_sum f n x \\<le> 0}\""], ["proof (prove)\nusing this:\n  birkhoff_sum f ?n14 x\n  \\<in> {real ?n14 * expectation f -\n         1..real ?n14 * expectation f} \\<Longrightarrow>\n  birkhoff_sum f ?n14 x \\<le> 0\n\ngoal (1 subgoal):\n 1. {n. birkhoff_sum f n x\n        \\<in> {real n * expectation f - 1..real n * expectation f}}\n    \\<subseteq> {n. birkhoff_sum f n x \\<le> 0}", "by auto"], ["proof (state)\nthis:\n  {n. birkhoff_sum f n x\n      \\<in> {real n * expectation f - 1..real n * expectation f}}\n  \\<subseteq> {n. birkhoff_sum f n x \\<le> 0}\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  {n. birkhoff_sum f n x\n      \\<in> {real n * expectation f - 1..real n * expectation f}}\n  \\<subseteq> {n. birkhoff_sum f n x \\<le> 0}", "have inf: \"infinite {n. birkhoff_sum f n x \\<le> 0}\""], ["proof (prove)\nusing this:\n  {n. birkhoff_sum f n x\n      \\<in> {real n * expectation f - 1..real n * expectation f}}\n  \\<subseteq> {n. birkhoff_sum f n x \\<le> 0}\n\ngoal (1 subgoal):\n 1. infinite {n. birkhoff_sum f n x \\<le> 0}", "using x(2) finite_subset"], ["proof (prove)\nusing this:\n  {n. birkhoff_sum f n x\n      \\<in> {real n * expectation f - 1..real n * expectation f}}\n  \\<subseteq> {n. birkhoff_sum f n x \\<le> 0}\n  infinite\n   {n. birkhoff_sum f n x\n       \\<in> {real n * expectation f - 1..real n * expectation f}}\n  \\<lbrakk>?A \\<subseteq> ?B; finite ?B\\<rbrakk> \\<Longrightarrow> finite ?A\n\ngoal (1 subgoal):\n 1. infinite {n. birkhoff_sum f n x \\<le> 0}", "by blast"], ["proof (state)\nthis:\n  infinite {n. birkhoff_sum f n x \\<le> 0}\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "have \"0 < (\\<infinity>::ereal)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < \\<infinity>", "by auto"], ["proof (state)\nthis:\n  0 < \\<infinity>\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  0 < \\<infinity>", "have \"eventually (\\<lambda>n. birkhoff_sum f n x > (0::ereal)) sequentially\""], ["proof (prove)\nusing this:\n  0 < \\<infinity>\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially. 0 < ereal (birkhoff_sum f n x)", "using x(1) order_tendsto_iff"], ["proof (prove)\nusing this:\n  0 < \\<infinity>\n  (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n  \\<longlonglongrightarrow> \\<infinity>\n  (?f \\<longlongrightarrow> ?x) ?F =\n  ((\\<forall>l<?x. \\<forall>\\<^sub>F x in ?F. l < ?f x) \\<and>\n   (\\<forall>u>?x. \\<forall>\\<^sub>F x in ?F. ?f x < u))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially. 0 < ereal (birkhoff_sum f n x)", "by metis"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially. 0 < ereal (birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially. 0 < ereal (birkhoff_sum f n x)", "obtain N where \"\\<And>n. n \\<ge> N \\<Longrightarrow> birkhoff_sum f n x > (0::ereal)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially. 0 < ereal (birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n.\n            N \\<le> n \\<Longrightarrow>\n            0 < ereal (birkhoff_sum f n x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (meson eventually_at_top_linorder)"], ["proof (state)\nthis:\n  N \\<le> ?n12 \\<Longrightarrow> 0 < ereal (birkhoff_sum f ?n12 x)\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  N \\<le> ?n12 \\<Longrightarrow> 0 < ereal (birkhoff_sum f ?n12 x)", "have \"\\<And>n. n \\<ge> N \\<Longrightarrow> birkhoff_sum f n x > 0\""], ["proof (prove)\nusing this:\n  N \\<le> ?n12 \\<Longrightarrow> 0 < ereal (birkhoff_sum f ?n12 x)\n\ngoal (1 subgoal):\n 1. \\<And>n. N \\<le> n \\<Longrightarrow> 0 < birkhoff_sum f n x", "by auto"], ["proof (state)\nthis:\n  N \\<le> ?n12 \\<Longrightarrow> 0 < birkhoff_sum f ?n12 x\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  N \\<le> ?n12 \\<Longrightarrow> 0 < birkhoff_sum f ?n12 x", "have \"{n. birkhoff_sum f n x \\<le> 0} \\<subseteq> {..<N}\""], ["proof (prove)\nusing this:\n  N \\<le> ?n12 \\<Longrightarrow> 0 < birkhoff_sum f ?n12 x\n\ngoal (1 subgoal):\n 1. {n. birkhoff_sum f n x \\<le> 0} \\<subseteq> {..<N}", "by (metis (mono_tags, lifting) lessThan_iff linorder_not_less mem_Collect_eq subsetI)"], ["proof (state)\nthis:\n  {n. birkhoff_sum f n x \\<le> 0} \\<subseteq> {..<N}\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  {n. birkhoff_sum f n x \\<le> 0} \\<subseteq> {..<N}", "have \"finite {n. birkhoff_sum f n x \\<le> 0}\""], ["proof (prove)\nusing this:\n  {n. birkhoff_sum f n x \\<le> 0} \\<subseteq> {..<N}\n\ngoal (1 subgoal):\n 1. finite {n. birkhoff_sum f n x \\<le> 0}", "using finite_nat_iff_bounded"], ["proof (prove)\nusing this:\n  {n. birkhoff_sum f n x \\<le> 0} \\<subseteq> {..<N}\n  finite ?S = (\\<exists>k. ?S \\<subseteq> {..<k})\n\ngoal (1 subgoal):\n 1. finite {n. birkhoff_sum f n x \\<le> 0}", "by blast"], ["proof (state)\nthis:\n  finite {n. birkhoff_sum f n x \\<le> 0}\n\ngoal (1 subgoal):\n 1. \\<not> 0 < expectation f \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  finite {n. birkhoff_sum f n x \\<le> 0}", "show \"False\""], ["proof (prove)\nusing this:\n  finite {n. birkhoff_sum f n x \\<le> 0}\n\ngoal (1 subgoal):\n 1. False", "using inf"], ["proof (prove)\nusing this:\n  finite {n. birkhoff_sum f n x \\<le> 0}\n  infinite {n. birkhoff_sum f n x \\<le> 0}\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_pmpt) birkhoff_negative_average:\n      fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"AE x in M. (\\<lambda>n. birkhoff_sum f n x) \\<longlonglongrightarrow> -\\<infinity>\"\n  shows \"(\\<integral> x. f x \\<partial>M) < 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation f < 0", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "assume \"\\<not>((\\<integral> x. f x \\<partial>M) < 0)\""], ["proof (state)\nthis:\n  \\<not> expectation f < 0\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<not> expectation f < 0", "have *: \"(\\<integral> x. f x \\<partial>M) \\<ge> 0\""], ["proof (prove)\nusing this:\n  \\<not> expectation f < 0\n\ngoal (1 subgoal):\n 1. 0 \\<le> expectation f", "by simp"], ["proof (state)\nthis:\n  0 \\<le> expectation f\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "have \"AE x in M. (\\<lambda>n. birkhoff_sum f n x) \\<longlonglongrightarrow> -\\<infinity> \\<and> infinite {n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) .. n* (\\<integral>x. f x \\<partial>M) + 1}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n               \\<longlonglongrightarrow> - \\<infinity> \\<and>\n               infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           expectation f..real n * expectation f + 1}}", "using assms(2) birkhoff_sum_small_asymp_pos[OF assms(1)]"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> - \\<infinity>\n  0 < ?e \\<Longrightarrow>\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         expectation f..real n * expectation f + ?e}}\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n               \\<longlonglongrightarrow> - \\<infinity> \\<and>\n               infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           expectation f..real n * expectation f + 1}}", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> - \\<infinity> \\<and>\n             infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         expectation f..real n * expectation f + 1}}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> - \\<infinity> \\<and>\n             infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         expectation f..real n * expectation f + 1}}", "obtain x where x: \"(\\<lambda>n. birkhoff_sum f n x) \\<longlonglongrightarrow> -\\<infinity>\" \"infinite {n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) .. n* (\\<integral>x. f x \\<partial>M) + 1}}\""], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> - \\<infinity> \\<and>\n             infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         expectation f..real n * expectation f + 1}}\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>(\\<lambda>xa. ereal (birkhoff_sum f xa x))\n                 \\<longlonglongrightarrow> - \\<infinity>;\n         infinite\n          {n. birkhoff_sum f n x\n              \\<in> {real n *\n                     expectation f..real n * expectation f + 1}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using AE_False eventually_elim2"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n             \\<longlonglongrightarrow> - \\<infinity> \\<and>\n             infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         expectation f..real n * expectation f + 1}}\n  (AE x in M. False) = False\n  \\<lbrakk>eventually ?P ?F; eventually ?Q ?F;\n   \\<And>i. \\<lbrakk>?P i; ?Q i\\<rbrakk> \\<Longrightarrow> ?R i\\<rbrakk>\n  \\<Longrightarrow> eventually ?R ?F\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>(\\<lambda>xa. ereal (birkhoff_sum f xa x))\n                 \\<longlonglongrightarrow> - \\<infinity>;\n         infinite\n          {n. birkhoff_sum f n x\n              \\<in> {real n *\n                     expectation f..real n * expectation f + 1}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n  \\<longlonglongrightarrow> - \\<infinity>\n  infinite\n   {n. birkhoff_sum f n x\n       \\<in> {real n * expectation f..real n * expectation f + 1}}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "{"], ["proof (state)\nthis:\n  (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n  \\<longlonglongrightarrow> - \\<infinity>\n  infinite\n   {n. birkhoff_sum f n x\n       \\<in> {real n * expectation f..real n * expectation f + 1}}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "assume \"birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) .. n * (\\<integral>x. f x \\<partial>M) + 1}\""], ["proof (state)\nthis:\n  birkhoff_sum f n x\n  \\<in> {real n * expectation f..real n * expectation f + 1}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f n x\n  \\<in> {real n * expectation f..real n * expectation f + 1}", "have \"birkhoff_sum f n x \\<ge> n * (\\<integral>x. f x \\<partial>M)\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n x\n  \\<in> {real n * expectation f..real n * expectation f + 1}\n\ngoal (1 subgoal):\n 1. real n * expectation f \\<le> birkhoff_sum f n x", "by simp"], ["proof (state)\nthis:\n  real n * expectation f \\<le> birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  real n * expectation f \\<le> birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "have \"n * (\\<integral>x. f x \\<partial>M) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> real n * expectation f", "using *"], ["proof (prove)\nusing this:\n  0 \\<le> expectation f\n\ngoal (1 subgoal):\n 1. 0 \\<le> real n * expectation f", "by simp"], ["proof (state)\nthis:\n  0 \\<le> real n * expectation f\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  real n * expectation f \\<le> birkhoff_sum f n x\n  0 \\<le> real n * expectation f", "have \"birkhoff_sum f n x \\<ge> 0\""], ["proof (prove)\nusing this:\n  real n * expectation f \\<le> birkhoff_sum f n x\n  0 \\<le> real n * expectation f\n\ngoal (1 subgoal):\n 1. 0 \\<le> birkhoff_sum f n x", "by simp"], ["proof (state)\nthis:\n  0 \\<le> birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "}"], ["proof (state)\nthis:\n  birkhoff_sum f ?n14 x\n  \\<in> {real ?n14 *\n         expectation f..real ?n14 * expectation f + 1} \\<Longrightarrow>\n  0 \\<le> birkhoff_sum f ?n14 x\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f ?n14 x\n  \\<in> {real ?n14 *\n         expectation f..real ?n14 * expectation f + 1} \\<Longrightarrow>\n  0 \\<le> birkhoff_sum f ?n14 x", "have \"{n. birkhoff_sum f n x \\<in> {n * (\\<integral>x. f x \\<partial>M) .. n* (\\<integral>x. f x \\<partial>M) + 1}} \\<subseteq> {n. birkhoff_sum f n x \\<ge> 0}\""], ["proof (prove)\nusing this:\n  birkhoff_sum f ?n14 x\n  \\<in> {real ?n14 *\n         expectation f..real ?n14 * expectation f + 1} \\<Longrightarrow>\n  0 \\<le> birkhoff_sum f ?n14 x\n\ngoal (1 subgoal):\n 1. {n. birkhoff_sum f n x\n        \\<in> {real n * expectation f..real n * expectation f + 1}}\n    \\<subseteq> {n. 0 \\<le> birkhoff_sum f n x}", "by auto"], ["proof (state)\nthis:\n  {n. birkhoff_sum f n x\n      \\<in> {real n * expectation f..real n * expectation f + 1}}\n  \\<subseteq> {n. 0 \\<le> birkhoff_sum f n x}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  {n. birkhoff_sum f n x\n      \\<in> {real n * expectation f..real n * expectation f + 1}}\n  \\<subseteq> {n. 0 \\<le> birkhoff_sum f n x}", "have inf: \"infinite {n. birkhoff_sum f n x \\<ge> 0}\""], ["proof (prove)\nusing this:\n  {n. birkhoff_sum f n x\n      \\<in> {real n * expectation f..real n * expectation f + 1}}\n  \\<subseteq> {n. 0 \\<le> birkhoff_sum f n x}\n\ngoal (1 subgoal):\n 1. infinite {n. 0 \\<le> birkhoff_sum f n x}", "using x(2) finite_subset"], ["proof (prove)\nusing this:\n  {n. birkhoff_sum f n x\n      \\<in> {real n * expectation f..real n * expectation f + 1}}\n  \\<subseteq> {n. 0 \\<le> birkhoff_sum f n x}\n  infinite\n   {n. birkhoff_sum f n x\n       \\<in> {real n * expectation f..real n * expectation f + 1}}\n  \\<lbrakk>?A \\<subseteq> ?B; finite ?B\\<rbrakk> \\<Longrightarrow> finite ?A\n\ngoal (1 subgoal):\n 1. infinite {n. 0 \\<le> birkhoff_sum f n x}", "by blast"], ["proof (state)\nthis:\n  infinite {n. 0 \\<le> birkhoff_sum f n x}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "have \"0 > (-\\<infinity>::ereal)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - \\<infinity> < 0", "by auto"], ["proof (state)\nthis:\n  - \\<infinity> < 0\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  - \\<infinity> < 0", "have \"eventually (\\<lambda>n. birkhoff_sum f n x < (0::ereal)) sequentially\""], ["proof (prove)\nusing this:\n  - \\<infinity> < 0\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially. ereal (birkhoff_sum f n x) < 0", "using x(1) order_tendsto_iff"], ["proof (prove)\nusing this:\n  - \\<infinity> < 0\n  (\\<lambda>xa. ereal (birkhoff_sum f xa x))\n  \\<longlonglongrightarrow> - \\<infinity>\n  (?f \\<longlongrightarrow> ?x) ?F =\n  ((\\<forall>l<?x. \\<forall>\\<^sub>F x in ?F. l < ?f x) \\<and>\n   (\\<forall>u>?x. \\<forall>\\<^sub>F x in ?F. ?f x < u))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially. ereal (birkhoff_sum f n x) < 0", "by metis"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially. ereal (birkhoff_sum f n x) < 0\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially. ereal (birkhoff_sum f n x) < 0", "obtain N where \"\\<And>n. n \\<ge> N \\<Longrightarrow> birkhoff_sum f n x < (0::ereal)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially. ereal (birkhoff_sum f n x) < 0\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n.\n            N \\<le> n \\<Longrightarrow>\n            ereal (birkhoff_sum f n x) < 0) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (meson eventually_at_top_linorder)"], ["proof (state)\nthis:\n  N \\<le> ?n12 \\<Longrightarrow> ereal (birkhoff_sum f ?n12 x) < 0\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  N \\<le> ?n12 \\<Longrightarrow> ereal (birkhoff_sum f ?n12 x) < 0", "have \"\\<And>n. n \\<ge> N \\<Longrightarrow> birkhoff_sum f n x < 0\""], ["proof (prove)\nusing this:\n  N \\<le> ?n12 \\<Longrightarrow> ereal (birkhoff_sum f ?n12 x) < 0\n\ngoal (1 subgoal):\n 1. \\<And>n. N \\<le> n \\<Longrightarrow> birkhoff_sum f n x < 0", "by auto"], ["proof (state)\nthis:\n  N \\<le> ?n12 \\<Longrightarrow> birkhoff_sum f ?n12 x < 0\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  N \\<le> ?n12 \\<Longrightarrow> birkhoff_sum f ?n12 x < 0", "have \"{n. birkhoff_sum f n x \\<ge> 0} \\<subseteq> {..<N}\""], ["proof (prove)\nusing this:\n  N \\<le> ?n12 \\<Longrightarrow> birkhoff_sum f ?n12 x < 0\n\ngoal (1 subgoal):\n 1. {n. 0 \\<le> birkhoff_sum f n x} \\<subseteq> {..<N}", "by (metis (mono_tags, lifting) lessThan_iff linorder_not_less mem_Collect_eq subsetI)"], ["proof (state)\nthis:\n  {n. 0 \\<le> birkhoff_sum f n x} \\<subseteq> {..<N}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  {n. 0 \\<le> birkhoff_sum f n x} \\<subseteq> {..<N}", "have \"finite {n. birkhoff_sum f n x \\<ge> 0}\""], ["proof (prove)\nusing this:\n  {n. 0 \\<le> birkhoff_sum f n x} \\<subseteq> {..<N}\n\ngoal (1 subgoal):\n 1. finite {n. 0 \\<le> birkhoff_sum f n x}", "using finite_nat_iff_bounded"], ["proof (prove)\nusing this:\n  {n. 0 \\<le> birkhoff_sum f n x} \\<subseteq> {..<N}\n  finite ?S = (\\<exists>k. ?S \\<subseteq> {..<k})\n\ngoal (1 subgoal):\n 1. finite {n. 0 \\<le> birkhoff_sum f n x}", "by blast"], ["proof (state)\nthis:\n  finite {n. 0 \\<le> birkhoff_sum f n x}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f < 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  finite {n. 0 \\<le> birkhoff_sum f n x}", "show \"False\""], ["proof (prove)\nusing this:\n  finite {n. 0 \\<le> birkhoff_sum f n x}\n\ngoal (1 subgoal):\n 1. False", "using inf"], ["proof (prove)\nusing this:\n  finite {n. 0 \\<le> birkhoff_sum f n x}\n  infinite {n. 0 \\<le> birkhoff_sum f n x}\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in ergodic_pmpt) birkhoff_nonzero_average:\n      fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" and \"AE x in M. (\\<lambda>n. abs(birkhoff_sum f n x)) \\<longlonglongrightarrow> \\<infinity>\"\n  shows \"(\\<integral> x. f x \\<partial>M) \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation f \\<noteq> 0", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "assume \"\\<not>((\\<integral> x. f x \\<partial>M) \\<noteq> 0)\""], ["proof (state)\nthis:\n  \\<not> expectation f \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<not> expectation f \\<noteq> 0", "have *: \"(\\<integral> x. f x \\<partial>M) = 0\""], ["proof (prove)\nusing this:\n  \\<not> expectation f \\<noteq> 0\n\ngoal (1 subgoal):\n 1. expectation f = 0", "by simp"], ["proof (state)\nthis:\n  expectation f = 0\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "have \"AE x in M. (\\<lambda>n. abs(birkhoff_sum f n x)) \\<longlonglongrightarrow> \\<infinity> \\<and> infinite {n. birkhoff_sum f n x \\<in> {0 .. 1}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n               \\<longlonglongrightarrow> \\<infinity> \\<and>\n               infinite {n. birkhoff_sum f n x \\<in> {0..1}}", "using assms(2) birkhoff_sum_small_asymp_pos[OF assms(1)] *"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n             \\<longlonglongrightarrow> \\<infinity>\n  0 < ?e \\<Longrightarrow>\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         expectation f..real n * expectation f + ?e}}\n  expectation f = 0\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n               \\<longlonglongrightarrow> \\<infinity> \\<and>\n               infinite {n. birkhoff_sum f n x \\<in> {0..1}}", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n             \\<longlonglongrightarrow> \\<infinity> \\<and>\n             infinite {n. birkhoff_sum f n x \\<in> {0..1}}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  AE x in M. (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n             \\<longlonglongrightarrow> \\<infinity> \\<and>\n             infinite {n. birkhoff_sum f n x \\<in> {0..1}}", "obtain x where x: \"(\\<lambda>n. abs(birkhoff_sum f n x)) \\<longlonglongrightarrow> \\<infinity>\" \"infinite {n. birkhoff_sum f n x \\<in> {0 .. 1}}\""], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n             \\<longlonglongrightarrow> \\<infinity> \\<and>\n             infinite {n. birkhoff_sum f n x \\<in> {0..1}}\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>(\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n                 \\<longlonglongrightarrow> \\<infinity>;\n         infinite {n. birkhoff_sum f n x \\<in> {0..1}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using AE_False eventually_elim2"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n             \\<longlonglongrightarrow> \\<infinity> \\<and>\n             infinite {n. birkhoff_sum f n x \\<in> {0..1}}\n  (AE x in M. False) = False\n  \\<lbrakk>eventually ?P ?F; eventually ?Q ?F;\n   \\<And>i. \\<lbrakk>?P i; ?Q i\\<rbrakk> \\<Longrightarrow> ?R i\\<rbrakk>\n  \\<Longrightarrow> eventually ?R ?F\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>(\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n                 \\<longlonglongrightarrow> \\<infinity>;\n         infinite {n. birkhoff_sum f n x \\<in> {0..1}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n  \\<longlonglongrightarrow> \\<infinity>\n  infinite {n. birkhoff_sum f n x \\<in> {0..1}}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "have \"1 < (\\<infinity>::ereal)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < \\<infinity>", "by auto"], ["proof (state)\nthis:\n  1 < \\<infinity>\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  1 < \\<infinity>", "have \"eventually (\\<lambda>n. abs(birkhoff_sum f n x) > (1::ereal)) sequentially\""], ["proof (prove)\nusing this:\n  1 < \\<infinity>\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       1 < ereal \\<bar>birkhoff_sum f n x\\<bar>", "using x(1) order_tendsto_iff"], ["proof (prove)\nusing this:\n  1 < \\<infinity>\n  (\\<lambda>xa. ereal \\<bar>birkhoff_sum f xa x\\<bar>)\n  \\<longlonglongrightarrow> \\<infinity>\n  (?f \\<longlongrightarrow> ?x) ?F =\n  ((\\<forall>l<?x. \\<forall>\\<^sub>F x in ?F. l < ?f x) \\<and>\n   (\\<forall>u>?x. \\<forall>\\<^sub>F x in ?F. ?f x < u))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       1 < ereal \\<bar>birkhoff_sum f n x\\<bar>", "by metis"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     1 < ereal \\<bar>birkhoff_sum f n x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     1 < ereal \\<bar>birkhoff_sum f n x\\<bar>", "obtain N where \"\\<And>n. n \\<ge> N \\<Longrightarrow> abs(birkhoff_sum f n x) > (1::ereal)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     1 < ereal \\<bar>birkhoff_sum f n x\\<bar>\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n.\n            N \\<le> n \\<Longrightarrow>\n            1 < ereal \\<bar>birkhoff_sum f n x\\<bar>) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (meson eventually_at_top_linorder)"], ["proof (state)\nthis:\n  N \\<le> ?n12 \\<Longrightarrow> 1 < ereal \\<bar>birkhoff_sum f ?n12 x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  N \\<le> ?n12 \\<Longrightarrow> 1 < ereal \\<bar>birkhoff_sum f ?n12 x\\<bar>", "have *: \"\\<And>n. n \\<ge> N \\<Longrightarrow> abs(birkhoff_sum f n x) > 1\""], ["proof (prove)\nusing this:\n  N \\<le> ?n12 \\<Longrightarrow> 1 < ereal \\<bar>birkhoff_sum f ?n12 x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<And>n. N \\<le> n \\<Longrightarrow> 1 < \\<bar>birkhoff_sum f n x\\<bar>", "by auto"], ["proof (state)\nthis:\n  N \\<le> ?n12 \\<Longrightarrow> 1 < \\<bar>birkhoff_sum f ?n12 x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "have \"{n. birkhoff_sum f n x \\<in> {0..1}} \\<subseteq> {..<N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. birkhoff_sum f n x \\<in> {0..1}} \\<subseteq> {..<N}", "by (auto, metis (full_types) * abs_of_nonneg not_less)"], ["proof (state)\nthis:\n  {n. birkhoff_sum f n x \\<in> {0..1}} \\<subseteq> {..<N}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  {n. birkhoff_sum f n x \\<in> {0..1}} \\<subseteq> {..<N}", "have \"finite {n. birkhoff_sum f n x \\<in> {0..1}}\""], ["proof (prove)\nusing this:\n  {n. birkhoff_sum f n x \\<in> {0..1}} \\<subseteq> {..<N}\n\ngoal (1 subgoal):\n 1. finite {n. birkhoff_sum f n x \\<in> {0..1}}", "using finite_nat_iff_bounded"], ["proof (prove)\nusing this:\n  {n. birkhoff_sum f n x \\<in> {0..1}} \\<subseteq> {..<N}\n  finite ?S = (\\<exists>k. ?S \\<subseteq> {..<k})\n\ngoal (1 subgoal):\n 1. finite {n. birkhoff_sum f n x \\<in> {0..1}}", "by blast"], ["proof (state)\nthis:\n  finite {n. birkhoff_sum f n x \\<in> {0..1}}\n\ngoal (1 subgoal):\n 1. \\<not> expectation f \\<noteq> 0 \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  finite {n. birkhoff_sum f n x \\<in> {0..1}}", "show \"False\""], ["proof (prove)\nusing this:\n  finite {n. birkhoff_sum f n x \\<in> {0..1}}\n\ngoal (1 subgoal):\n 1. False", "using x(2)"], ["proof (prove)\nusing this:\n  finite {n. birkhoff_sum f n x \\<in> {0..1}}\n  infinite {n. birkhoff_sum f n x \\<in> {0..1}}\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "(*of Ergodicity.thy*)"]]}