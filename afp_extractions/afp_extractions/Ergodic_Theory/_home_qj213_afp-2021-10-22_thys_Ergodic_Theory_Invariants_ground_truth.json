{"file_name": "/home/qj213/afp-2021-10-22/thys/Ergodic_Theory/Invariants.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ergodic_Theory", "problem_names": ["lemma Invariants_sets: \"sets Invariants = {A \\<in> sets M. T-`A \\<inter> space M = A}\"", "lemma Invariants_is_subalg: \"subalgebra M Invariants\"", "lemma Invariants_in_sets:\n  assumes \"A \\<in> sets Invariants\"\n  shows \"A \\<in> sets M\"", "lemma Invariants_measurable_func:\n  assumes \"f \\<in> measurable Invariants N\"\n  shows \"f \\<in> measurable M N\"", "lemma Invariants_vrestr:\n  assumes \"A \\<in> sets Invariants\"\n  shows \"T--`A = A\"", "lemma Invariants_points:\n  assumes \"A \\<in> sets Invariants\" \"x \\<in> A\"\n  shows \"T x \\<in> A\"", "lemma Invariants_func_is_invariant:\n  fixes f::\"_ \\<Rightarrow> 'b::t2_space\"\n  assumes \"f \\<in> borel_measurable Invariants\" \"x \\<in> space M\"\n  shows \"f (T x) = f x\"", "lemma Invariants_func_is_invariant_n:\n  fixes f::\"_ \\<Rightarrow> 'b::t2_space\"\n  assumes \"f \\<in> borel_measurable Invariants\" \"x \\<in> space M\"\n  shows \"f ((T^^n) x) = f x\"", "lemma Invariants_func_charac:\n  assumes [measurable]: \"f \\<in> measurable M N\"\n      and \"\\<And>x. x \\<in> space M \\<Longrightarrow> f(T x) = f x\"\n  shows \"f \\<in> measurable Invariants N\"", "lemma birkhoff_sum_of_invariants:\n  fixes f::\" _ \\<Rightarrow> real\"\n  assumes \"f \\<in> borel_measurable Invariants\" \"x \\<in> space M\"\n  shows \"birkhoff_sum f n x = n * f x\"", "lemma (in conservative) preimage_included_then_almost_invariant:\n  assumes [measurable]: \"A \\<in> sets M\" and \"T--`A \\<subseteq> A\"\n  shows \"A \\<Delta> (T--`A) \\<in> null_sets M\"", "lemma (in conservative) preimage_includes_then_almost_invariant:\n  assumes [measurable]: \"A \\<in> sets M\" and \"A \\<subseteq> T--`A\"\n  shows \"A \\<Delta> (T--`A) \\<in> null_sets M\"", "lemma Invariants_Tinv:\n  assumes \"invertible_qmpt\"\n  shows \"qmpt.Invariants M Tinv = Invariants\"", "lemma Invariants_of_foTn:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants (f o (T^^n)) x = real_cond_exp M Invariants f x\"", "lemma Invariants_of_foT:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants f x = real_cond_exp M Invariants (f o T) x\"", "lemma birkhoff_sum_Invariants:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x = n * real_cond_exp M Invariants f x\"", "lemma birkhoff_aux1:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  defines \"A \\<equiv> {x \\<in> space M. limsup (\\<lambda>n. ereal(birkhoff_sum f n x)) = \\<infinity>}\"\n    shows \"A \\<in> sets Invariants\" \"(\\<integral>x. f x * indicator A x \\<partial>M) \\<ge> 0\"", "lemma birkhoff_aux2:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. limsup (\\<lambda>n. ereal(birkhoff_sum f n x / n)) \\<le> real_cond_exp M Invariants f x\"", "theorem birkhoff_theorem_AE_nonergodic:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes \"integrable M f\"\n  shows \"AE x in M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\"", "lemma limit_foTn_over_n:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"f \\<in> borel_measurable M\"\n      and \"integrable M (\\<lambda>x. f(T x) - f x)\"\n  shows \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x = 0\"\n        \"AE x in M. (\\<lambda>n. f((T^^n) x) / n) \\<longlonglongrightarrow> 0\"", "lemma limit_foTn_over_n':\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. (\\<lambda>n. f((T^^n) x) / n) \\<longlonglongrightarrow> 0\"", "lemma cohomologous_approx_cond_exp_aux:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n      and \"AE x in M. real_cond_exp M Invariants f x > 0\"\n    shows \"\\<exists>u g. u \\<in> borel_measurable M \\<and> (integrable M g) \\<and> (AE x in M. g x \\<ge> 0 \\<and> g x \\<le> max 0 (f x)) \\<and> (\\<forall>x. f x = g x + u x - u (T x))\"", "lemma cohomologous_approx_cond_exp:\n  fixes f::\"'a \\<Rightarrow> real\" and B::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" \"B \\<in> borel_measurable M\"\n      and \"AE x in M. B x > 0\"\n    shows \"\\<exists>g u. u \\<in> borel_measurable M\n              \\<and> integrable M g\n              \\<and> (\\<forall>x. f x = g x + u x - u (T x))\n              \\<and> (AE x in M. abs(g x - real_cond_exp M Invariants f x) \\<le> B x)\"", "lemma birkhoff_lemma_L1:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes \"\\<And>x. f x \\<ge> 0\"\n      and [measurable]: \"integrable M f\"\n  shows \"(\\<lambda>n. \\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<longlonglongrightarrow> 0\"", "theorem birkhoff_theorem_L1_nonergodic:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"(\\<lambda>n. \\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<longlonglongrightarrow> 0\"", "theorem (in fmpt) skew_product_conservative:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n    and \"AE x in M. real_cond_exp M Invariants f x = 0\"\n  shows \"conservative_mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x,y). (T x, y + f x))\"", "lemma birkhoff_sum_small_asymp_lemma:\n  assumes [measurable]: \"integrable M f\"\n    and \"AE x in M. real_cond_exp M Invariants f x = 0\" \"e>(0::real)\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}\"", "theorem birkhoff_sum_small_asymp_pos_nonergodic:\n  assumes [measurable]: \"integrable M f\" and \"e > (0::real)\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x .. n * real_cond_exp M Invariants f x + e}}\"", "theorem birkhoff_sum_small_asymp_neg_nonergodic:\n  assumes [measurable]: \"integrable M f\" and \"e > (0::real)\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x - e .. n * real_cond_exp M Invariants f x}}\""], "translations": [["", "lemma Invariants_sets: \"sets Invariants = {A \\<in> sets M. T-`A \\<inter> space M = A}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}", "have \"sigma_algebra (space M) {A \\<in> sets M. T-`A \\<inter> space M = A}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "define I where \"I = {A. T-`A \\<inter> space M = A}\""], ["proof (state)\nthis:\n  I = {A. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "have i: \"\\<And>A. A \\<in> I \\<Longrightarrow> A \\<subseteq> space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>A. A \\<in> I \\<Longrightarrow> A \\<subseteq> space M", "unfolding I_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>A.\n       A \\<in> {A. T -` A \\<inter> space M = A} \\<Longrightarrow>\n       A \\<subseteq> space M", "by auto"], ["proof (state)\nthis:\n  ?A3 \\<in> I \\<Longrightarrow> ?A3 \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "have \"algebra (space M) I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. algebra (space M) I", "proof (subst algebra_iff_Un)"], ["proof (state)\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "have a: \"I \\<subseteq> Pow (space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M)", "using i"], ["proof (prove)\nusing this:\n  ?A3 \\<in> I \\<Longrightarrow> ?A3 \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M)", "by auto"], ["proof (state)\nthis:\n  I \\<subseteq> Pow (space M)\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "have b: \"{} \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {} \\<in> I", "unfolding I_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {} \\<in> {A. T -` A \\<inter> space M = A}", "by auto"], ["proof (state)\nthis:\n  {} \\<in> I\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "{"], ["proof (state)\nthis:\n  {} \\<in> I\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "fix A"], ["proof (state)\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "assume *: \"A \\<in> I\""], ["proof (state)\nthis:\n  A \\<in> I\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "then"], ["proof (chain)\npicking this:\n  A \\<in> I", "have \"T-`(space M - A) = T-`(space M) - T-`A\""], ["proof (prove)\nusing this:\n  A \\<in> I\n\ngoal (1 subgoal):\n 1. T -` (space M - A) = T -` space M - T -` A", "by auto"], ["proof (state)\nthis:\n  T -` (space M - A) = T -` space M - T -` A\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "then"], ["proof (chain)\npicking this:\n  T -` (space M - A) = T -` space M - T -` A", "have \"T-`(space M - A) \\<inter> space M = T-`(space M) \\<inter> (space M) - T-`A \\<inter> (space M)\""], ["proof (prove)\nusing this:\n  T -` (space M - A) = T -` space M - T -` A\n\ngoal (1 subgoal):\n 1. T -` (space M - A) \\<inter> space M =\n    T -` space M \\<inter> space M - T -` A \\<inter> space M", "by auto"], ["proof (state)\nthis:\n  T -` (space M - A) \\<inter> space M =\n  T -` space M \\<inter> space M - T -` A \\<inter> space M\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "also"], ["proof (state)\nthis:\n  T -` (space M - A) \\<inter> space M =\n  T -` space M \\<inter> space M - T -` A \\<inter> space M\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "have \"... = space M - A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T -` space M \\<inter> space M - T -` A \\<inter> space M = space M - A", "using * I_def"], ["proof (prove)\nusing this:\n  A \\<in> I\n  I = {A. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. T -` space M \\<inter> space M - T -` A \\<inter> space M = space M - A", "by (simp add: inf_absorb2 subsetI)"], ["proof (state)\nthis:\n  T -` space M \\<inter> space M - T -` A \\<inter> space M = space M - A\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "finally"], ["proof (chain)\npicking this:\n  T -` (space M - A) \\<inter> space M = space M - A", "have \"space M - A \\<in> I\""], ["proof (prove)\nusing this:\n  T -` (space M - A) \\<inter> space M = space M - A\n\ngoal (1 subgoal):\n 1. space M - A \\<in> I", "unfolding I_def"], ["proof (prove)\nusing this:\n  T -` (space M - A) \\<inter> space M = space M - A\n\ngoal (1 subgoal):\n 1. space M - A \\<in> {A. T -` A \\<inter> space M = A}", "by simp"], ["proof (state)\nthis:\n  space M - A \\<in> I\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "}"], ["proof (state)\nthis:\n  ?A5 \\<in> I \\<Longrightarrow> space M - ?A5 \\<in> I\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "then"], ["proof (chain)\npicking this:\n  ?A5 \\<in> I \\<Longrightarrow> space M - ?A5 \\<in> I", "have c: \"(\\<forall>a\\<in>I. space M - a \\<in> I)\""], ["proof (prove)\nusing this:\n  ?A5 \\<in> I \\<Longrightarrow> space M - ?A5 \\<in> I\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>I. space M - a \\<in> I", "by simp"], ["proof (state)\nthis:\n  \\<forall>a\\<in>I. space M - a \\<in> I\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "have d: \"(\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I", "unfolding I_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>{A. T -` A \\<inter> space M = A}.\n       \\<forall>b\\<in>{A. T -` A \\<inter> space M = A}.\n          a \\<union> b \\<in> {A. T -` A \\<inter> space M = A}", "by auto"], ["proof (state)\nthis:\n  \\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "show \"I \\<subseteq> Pow (space M) \\<and> {} \\<in> I \\<and> (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and> (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "using a b c d"], ["proof (prove)\nusing this:\n  I \\<subseteq> Pow (space M)\n  {} \\<in> I\n  \\<forall>a\\<in>I. space M - a \\<in> I\n  \\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I\n\ngoal (1 subgoal):\n 1. I \\<subseteq> Pow (space M) \\<and>\n    {} \\<in> I \\<and>\n    (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n    (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)", "by blast"], ["proof (state)\nthis:\n  I \\<subseteq> Pow (space M) \\<and>\n  {} \\<in> I \\<and>\n  (\\<forall>a\\<in>I. space M - a \\<in> I) \\<and>\n  (\\<forall>a\\<in>I. \\<forall>b\\<in>I. a \\<union> b \\<in> I)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  algebra (space M) I\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "moreover"], ["proof (state)\nthis:\n  algebra (space M) I\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "have \"(\\<forall>F. range F \\<subseteq> I \\<longrightarrow> (\\<Union>i::nat. F i) \\<in> I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>F.\n       range F \\<subseteq> I \\<longrightarrow> \\<Union> (range F) \\<in> I", "unfolding I_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>F.\n       range F\n       \\<subseteq> {A. T -` A \\<inter> space M = A} \\<longrightarrow>\n       \\<Union> (range F) \\<in> {A. T -` A \\<inter> space M = A}", "by auto"], ["proof (state)\nthis:\n  \\<forall>F.\n     range F \\<subseteq> I \\<longrightarrow> \\<Union> (range F) \\<in> I\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "ultimately"], ["proof (chain)\npicking this:\n  algebra (space M) I\n  \\<forall>F.\n     range F \\<subseteq> I \\<longrightarrow> \\<Union> (range F) \\<in> I", "have \"sigma_algebra (space M) I\""], ["proof (prove)\nusing this:\n  algebra (space M) I\n  \\<forall>F.\n     range F \\<subseteq> I \\<longrightarrow> \\<Union> (range F) \\<in> I\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) I", "using sigma_algebra_iff"], ["proof (prove)\nusing this:\n  algebra (space M) I\n  \\<forall>F.\n     range F \\<subseteq> I \\<longrightarrow> \\<Union> (range F) \\<in> I\n  sigma_algebra ?\\<Omega> ?M =\n  (algebra ?\\<Omega> ?M \\<and>\n   (\\<forall>A.\n       range A \\<subseteq> ?M \\<longrightarrow>\n       \\<Union> (range A) \\<in> ?M))\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) I", "by auto"], ["proof (state)\nthis:\n  sigma_algebra (space M) I\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "moreover"], ["proof (state)\nthis:\n  sigma_algebra (space M) I\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "have \"sigma_algebra (space M) (sets M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sigma_algebra (space M) (sets M)", "using measure_space measure_space_def"], ["proof (prove)\nusing this:\n  measure_space (space ?M) (sets ?M) (emeasure ?M)\n  measure_space ?\\<Omega> ?A ?\\<mu> =\n  (sigma_algebra ?\\<Omega> ?A \\<and>\n   positive ?A ?\\<mu> \\<and> countably_additive ?A ?\\<mu>)\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) (sets M)", "by auto"], ["proof (state)\nthis:\n  sigma_algebra (space M) (sets M)\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "ultimately"], ["proof (chain)\npicking this:\n  sigma_algebra (space M) I\n  sigma_algebra (space M) (sets M)", "have \"sigma_algebra (space M) (I \\<inter> (sets M))\""], ["proof (prove)\nusing this:\n  sigma_algebra (space M) I\n  sigma_algebra (space M) (sets M)\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) (I \\<inter> sets M)", "using sigma_algebra_intersection"], ["proof (prove)\nusing this:\n  sigma_algebra (space M) I\n  sigma_algebra (space M) (sets M)\n  \\<lbrakk>sigma_algebra ?\\<Omega> ?A; sigma_algebra ?\\<Omega> ?B\\<rbrakk>\n  \\<Longrightarrow> sigma_algebra ?\\<Omega> (?A \\<inter> ?B)\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) (I \\<inter> sets M)", "by auto"], ["proof (state)\nthis:\n  sigma_algebra (space M) (I \\<inter> sets M)\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "moreover"], ["proof (state)\nthis:\n  sigma_algebra (space M) (I \\<inter> sets M)\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "have \"I \\<inter> sets M = {A \\<in> sets M. T-`A \\<inter> space M = A}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I \\<inter> sets M = {A \\<in> sets M. T -` A \\<inter> space M = A}", "unfolding I_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {A. T -` A \\<inter> space M = A} \\<inter> sets M =\n    {A \\<in> sets M. T -` A \\<inter> space M = A}", "by auto"], ["proof (state)\nthis:\n  I \\<inter> sets M = {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "ultimately"], ["proof (chain)\npicking this:\n  sigma_algebra (space M) (I \\<inter> sets M)\n  I \\<inter> sets M = {A \\<in> sets M. T -` A \\<inter> space M = A}", "show ?thesis"], ["proof (prove)\nusing this:\n  sigma_algebra (space M) (I \\<inter> sets M)\n  I \\<inter> sets M = {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "by simp"], ["proof (state)\nthis:\n  sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}", "then"], ["proof (chain)\npicking this:\n  sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "show ?thesis"], ["proof (prove)\nusing this:\n  sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}", "unfolding Invariants_def"], ["proof (prove)\nusing this:\n  sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. sets (sigma (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}) =\n    {A \\<in> sets M. T -` A \\<inter> space M = A}", "using sigma_algebra.sets_measure_of_eq"], ["proof (prove)\nusing this:\n  sigma_algebra (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}\n  sigma_algebra ?\\<Omega> ?M \\<Longrightarrow>\n  sets (measure_of ?\\<Omega> ?M ?\\<mu>) = ?M\n\ngoal (1 subgoal):\n 1. sets (sigma (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}) =\n    {A \\<in> sets M. T -` A \\<inter> space M = A}", "by blast"], ["proof (state)\nthis:\n  sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>By definition, the invariant subalgebra is a subalgebra of the original algebra. This is\nexpressed in the following lemmas.\\<close>"], ["", "lemma Invariants_is_subalg: \"subalgebra M Invariants\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subalgebra M Invariants", "unfolding subalgebra_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. space Invariants = space M \\<and> sets Invariants \\<subseteq> sets M", "using Invariants_sets Invariants_def"], ["proof (prove)\nusing this:\n  sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}\n  Invariants = sigma (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. space Invariants = space M \\<and> sets Invariants \\<subseteq> sets M", "by (simp add: space_measure_of_conv)"], ["", "lemma Invariants_in_sets:\n  assumes \"A \\<in> sets Invariants\"\n  shows \"A \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> sets M", "using Invariants_sets assms"], ["proof (prove)\nusing this:\n  sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}\n  A \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. A \\<in> sets M", "by blast"], ["", "lemma Invariants_measurable_func:\n  assumes \"f \\<in> measurable Invariants N\"\n  shows \"f \\<in> measurable M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> M \\<rightarrow>\\<^sub>M N", "using Invariants_is_subalg measurable_from_subalg assms"], ["proof (prove)\nusing this:\n  subalgebra M Invariants\n  \\<lbrakk>subalgebra ?M ?F; ?f \\<in> ?F \\<rightarrow>\\<^sub>M ?N\\<rbrakk>\n  \\<Longrightarrow> ?f \\<in> ?M \\<rightarrow>\\<^sub>M ?N\n  f \\<in> Invariants \\<rightarrow>\\<^sub>M N\n\ngoal (1 subgoal):\n 1. f \\<in> M \\<rightarrow>\\<^sub>M N", "by auto"], ["", "text \\<open>We give several trivial characterizations of invariant sets or functions.\\<close>"], ["", "lemma Invariants_vrestr:\n  assumes \"A \\<in> sets Invariants\"\n  shows \"T--`A = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T --` A = A", "using assms Invariants_sets Invariants_in_sets[OF assms]"], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n  sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. T --` A = A", "by auto"], ["", "lemma Invariants_points:\n  assumes \"A \\<in> sets Invariants\" \"x \\<in> A\"\n  shows \"T x \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T x \\<in> A", "using assms Invariants_sets"], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n  x \\<in> A\n  sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. T x \\<in> A", "by auto"], ["", "lemma Invariants_func_is_invariant:\n  fixes f::\"_ \\<Rightarrow> 'b::t2_space\"\n  assumes \"f \\<in> borel_measurable Invariants\" \"x \\<in> space M\"\n  shows \"f (T x) = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (T x) = f x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f (T x) = f x", "have \"{f x} \\<in> sets borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {f x} \\<in> sets borel", "by simp"], ["proof (state)\nthis:\n  {f x} \\<in> sets borel\n\ngoal (1 subgoal):\n 1. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  {f x} \\<in> sets borel", "have \"f-`({f x}) \\<inter> space M \\<in> Invariants\""], ["proof (prove)\nusing this:\n  {f x} \\<in> sets borel\n\ngoal (1 subgoal):\n 1. f -` {f x} \\<inter> space M \\<in> sets Invariants", "using assms(1)"], ["proof (prove)\nusing this:\n  {f x} \\<in> sets borel\n  f \\<in> borel_measurable Invariants\n\ngoal (1 subgoal):\n 1. f -` {f x} \\<inter> space M \\<in> sets Invariants", "by (metis (no_types, lifting) Invariants_def measurable_sets space_measure_of_conv)"], ["proof (state)\nthis:\n  f -` {f x} \\<inter> space M \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. f (T x) = f x", "moreover"], ["proof (state)\nthis:\n  f -` {f x} \\<inter> space M \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. f (T x) = f x", "have \"x \\<in> f-`({f x}) \\<inter> space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> f -` {f x} \\<inter> space M", "using assms(2)"], ["proof (prove)\nusing this:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. x \\<in> f -` {f x} \\<inter> space M", "by blast"], ["proof (state)\nthis:\n  x \\<in> f -` {f x} \\<inter> space M\n\ngoal (1 subgoal):\n 1. f (T x) = f x", "ultimately"], ["proof (chain)\npicking this:\n  f -` {f x} \\<inter> space M \\<in> sets Invariants\n  x \\<in> f -` {f x} \\<inter> space M", "have \"T x \\<in> f-`({f x}) \\<inter> space M\""], ["proof (prove)\nusing this:\n  f -` {f x} \\<inter> space M \\<in> sets Invariants\n  x \\<in> f -` {f x} \\<inter> space M\n\ngoal (1 subgoal):\n 1. T x \\<in> f -` {f x} \\<inter> space M", "by (rule Invariants_points)"], ["proof (state)\nthis:\n  T x \\<in> f -` {f x} \\<inter> space M\n\ngoal (1 subgoal):\n 1. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  T x \\<in> f -` {f x} \\<inter> space M", "show ?thesis"], ["proof (prove)\nusing this:\n  T x \\<in> f -` {f x} \\<inter> space M\n\ngoal (1 subgoal):\n 1. f (T x) = f x", "by simp"], ["proof (state)\nthis:\n  f (T x) = f x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Invariants_func_is_invariant_n:\n  fixes f::\"_ \\<Rightarrow> 'b::t2_space\"\n  assumes \"f \\<in> borel_measurable Invariants\" \"x \\<in> space M\"\n  shows \"f ((T^^n) x) = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ n) x) = f x", "by (induction n, auto simp add: assms Invariants_func_is_invariant)"], ["", "lemma Invariants_func_charac:\n  assumes [measurable]: \"f \\<in> measurable M N\"\n      and \"\\<And>x. x \\<in> space M \\<Longrightarrow> f(T x) = f x\"\n  shows \"f \\<in> measurable Invariants N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> Invariants \\<rightarrow>\\<^sub>M N", "proof (rule measurableI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N\n 2. \\<And>A.\n       A \\<in> sets N \\<Longrightarrow>\n       f -` A \\<inter> space Invariants \\<in> sets Invariants", "fix A"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N\n 2. \\<And>A.\n       A \\<in> sets N \\<Longrightarrow>\n       f -` A \\<inter> space Invariants \\<in> sets Invariants", "assume \"A \\<in> sets N\""], ["proof (state)\nthis:\n  A \\<in> sets N\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N\n 2. \\<And>A.\n       A \\<in> sets N \\<Longrightarrow>\n       f -` A \\<inter> space Invariants \\<in> sets Invariants", "have \"space Invariants = space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space Invariants = space M", "using Invariants_is_subalg subalgebra_def"], ["proof (prove)\nusing this:\n  subalgebra M Invariants\n  subalgebra ?M ?F =\n  (space ?F = space ?M \\<and> sets ?F \\<subseteq> sets ?M)\n\ngoal (1 subgoal):\n 1. space Invariants = space M", "by force"], ["proof (state)\nthis:\n  space Invariants = space M\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N\n 2. \\<And>A.\n       A \\<in> sets N \\<Longrightarrow>\n       f -` A \\<inter> space Invariants \\<in> sets Invariants", "show \"f -` A \\<inter> space Invariants \\<in> sets Invariants\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f -` A \\<inter> space Invariants \\<in> sets Invariants", "apply (subst Invariants_sets)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f -` A \\<inter> space Invariants\n    \\<in> {A \\<in> sets M. T -` A \\<inter> space M = A}", "apply (auto simp add: assms \\<open>A \\<in> sets N\\<close> \\<open>space Invariants = space M\\<close>)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f -` A \\<inter> space M \\<in> sets M", "using \\<open>A \\<in> sets N\\<close> assms(1) measurable_sets"], ["proof (prove)\nusing this:\n  A \\<in> sets N\n  f \\<in> M \\<rightarrow>\\<^sub>M N\n  \\<lbrakk>?f \\<in> ?M \\<rightarrow>\\<^sub>M ?A; ?S \\<in> sets ?A\\<rbrakk>\n  \\<Longrightarrow> ?f -` ?S \\<inter> space ?M \\<in> sets ?M\n\ngoal (1 subgoal):\n 1. f -` A \\<inter> space M \\<in> sets M", "by blast"], ["proof (state)\nthis:\n  f -` A \\<inter> space Invariants \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N", "assume \"x \\<in> space Invariants\""], ["proof (state)\nthis:\n  x \\<in> space Invariants\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N", "have \"space Invariants = space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space Invariants = space M", "using Invariants_is_subalg subalgebra_def"], ["proof (prove)\nusing this:\n  subalgebra M Invariants\n  subalgebra ?M ?F =\n  (space ?F = space ?M \\<and> sets ?F \\<subseteq> sets ?M)\n\ngoal (1 subgoal):\n 1. space Invariants = space M", "by force"], ["proof (state)\nthis:\n  space Invariants = space M\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> space Invariants \\<Longrightarrow> f x \\<in> space N", "then"], ["proof (chain)\npicking this:\n  space Invariants = space M", "show \"f x \\<in> space N\""], ["proof (prove)\nusing this:\n  space Invariants = space M\n\ngoal (1 subgoal):\n 1. f x \\<in> space N", "using assms(1) \\<open>x \\<in> space Invariants\\<close>"], ["proof (prove)\nusing this:\n  space Invariants = space M\n  f \\<in> M \\<rightarrow>\\<^sub>M N\n  x \\<in> space Invariants\n\ngoal (1 subgoal):\n 1. f x \\<in> space N", "by (metis measurable_space)"], ["proof (state)\nthis:\n  f x \\<in> space N\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma birkhoff_sum_of_invariants:\n  fixes f::\" _ \\<Rightarrow> real\"\n  assumes \"f \\<in> borel_measurable Invariants\" \"x \\<in> space M\"\n  shows \"birkhoff_sum f n x = n * f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum f n x = real n * f x", "unfolding birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n. f ((T ^^ i) x)) = real n * f x", "using Invariants_func_is_invariant_n[OF assms]"], ["proof (prove)\nusing this:\n  f ((T ^^ ?n) x) = f x\n\ngoal (1 subgoal):\n 1. (\\<Sum>i<n. f ((T ^^ i) x)) = real n * f x", "by auto"], ["", "text \\<open>There are two possible definitions of the invariant sigma-algebra, competing in the\nliterature: one could also use the sets such that $T^{-1}A$ coincides with $A$ up to\na measure $0$ set. It turns out that this is equivalent to being invariant (in our sense) up\nto a measure $0$ set. Therefore, for all interesting purposes, the two definitions would\ngive the same results.\n\nFor the proof, we start from an almost invariant set, and build a genuinely invariant set that\ncoincides with it by adding or throwing away null parts.\n\\<close>"], ["", "proposition Invariants_quasi_Invariants_sets:\n  assumes [measurable]: \"A \\<in> sets M\"\n  shows \"(\\<exists>B \\<in> sets Invariants. A \\<Delta> B \\<in> null_sets M) \\<longleftrightarrow> (T--`A \\<Delta> A \\<in> null_sets M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M) =\n    (T --` A \\<Delta> A \\<in> null_sets M)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "assume \"\\<exists>B \\<in> sets Invariants. A \\<Delta> B \\<in> null_sets M\""], ["proof (state)\nthis:\n  \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "obtain B where \"B \\<in> sets Invariants\" \"A \\<Delta> B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>B \\<in> sets Invariants;\n         A \\<Delta> B \\<in> null_sets M\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  B \\<in> sets Invariants\n  A \\<Delta> B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<in> sets Invariants\n  A \\<Delta> B \\<in> null_sets M", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\nusing this:\n  B \\<in> sets Invariants\n  A \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "using Invariants_in_sets"], ["proof (prove)\nusing this:\n  B \\<in> sets Invariants\n  A \\<Delta> B \\<in> null_sets M\n  ?A \\<in> sets Invariants \\<Longrightarrow> ?A \\<in> sets M\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"B = T--` B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B = T --` B", "using Invariants_vrestr \\<open>B \\<in> sets Invariants\\<close>"], ["proof (prove)\nusing this:\n  ?A \\<in> sets Invariants \\<Longrightarrow> T --` ?A = ?A\n  B \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. B = T --` B", "by simp"], ["proof (state)\nthis:\n  B = T --` B\n\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B = T --` B", "have \"T--`A \\<Delta> B = T--`(A \\<Delta> B)\""], ["proof (prove)\nusing this:\n  B = T --` B\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> B = T --` (A \\<Delta> B)", "by simp"], ["proof (state)\nthis:\n  T --` A \\<Delta> B = T --` (A \\<Delta> B)\n\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  T --` A \\<Delta> B = T --` (A \\<Delta> B)\n\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"T--`(A \\<Delta> B) \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T --` (A \\<Delta> B) \\<in> null_sets M", "by (rule T_quasi_preserves_null2(1)[OF \\<open>A \\<Delta> B \\<in> null_sets M\\<close>])"], ["proof (state)\nthis:\n  T --` (A \\<Delta> B) \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  T --` A \\<Delta> B = T --` (A \\<Delta> B)\n  T --` (A \\<Delta> B) \\<in> null_sets M", "have \"T--`A \\<Delta> B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` A \\<Delta> B = T --` (A \\<Delta> B)\n  T --` (A \\<Delta> B) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> B \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  T --` A \\<Delta> B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. \\<exists>B\\<in>sets Invariants.\n       A \\<Delta> B \\<in> null_sets M \\<Longrightarrow>\n    T --` A \\<Delta> A \\<in> null_sets M\n 2. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` A \\<Delta> B \\<in> null_sets M", "show \"T--`A \\<Delta> A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` A \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M", "by (rule null_sym_diff_transitive) (auto simp add: \\<open>A \\<Delta> B \\<in> null_sets M\\<close> Un_commute)"], ["proof (state)\nthis:\n  T --` A \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "assume H: \"T --` A \\<Delta> A \\<in> null_sets M\""], ["proof (state)\nthis:\n  T --` A \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have [measurable]: \"\\<And>n. (T^^n)--`A \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n. (T ^^ n) --` A \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  (T ^^ ?n3) --` A \\<in> sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "{"], ["proof (state)\nthis:\n  (T ^^ ?n3) --` A \\<in> sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "fix K"], ["proof (state)\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "assume [measurable]: \"K \\<in> sets M\" and \"T--`K \\<Delta> K \\<in> null_sets M\""], ["proof (state)\nthis:\n  K \\<in> sets M\n  T --` K \\<Delta> K \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "fix n::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"(T^^n)--`K \\<Delta> K \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ n) --` K \\<Delta> K \\<in> null_sets M", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. (T ^^ 0) --` K \\<Delta> K \\<in> null_sets M\n 2. \\<And>n.\n       (T ^^ n) --` K \\<Delta> K \\<in> null_sets M \\<Longrightarrow>\n       (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "case 0"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. (T ^^ 0) --` K \\<Delta> K \\<in> null_sets M\n 2. \\<And>n.\n       (T ^^ n) --` K \\<Delta> K \\<in> null_sets M \\<Longrightarrow>\n       (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "have \"(T^^0)--` K = K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ 0) --` K = K", "using T_vrestr_0"], ["proof (prove)\nusing this:\n  ?A \\<in> sets M \\<Longrightarrow> (T ^^ 0) --` ?A = ?A\n  ?A \\<in> sets M \\<Longrightarrow> id --` ?A = ?A\n\ngoal (1 subgoal):\n 1. (T ^^ 0) --` K = K", "by simp"], ["proof (state)\nthis:\n  (T ^^ 0) --` K = K\n\ngoal (2 subgoals):\n 1. (T ^^ 0) --` K \\<Delta> K \\<in> null_sets M\n 2. \\<And>n.\n       (T ^^ n) --` K \\<Delta> K \\<in> null_sets M \\<Longrightarrow>\n       (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  (T ^^ 0) --` K = K", "show ?case"], ["proof (prove)\nusing this:\n  (T ^^ 0) --` K = K\n\ngoal (1 subgoal):\n 1. (T ^^ 0) --` K \\<Delta> K \\<in> null_sets M", "using Diff_cancel sup.idem"], ["proof (prove)\nusing this:\n  (T ^^ 0) --` K = K\n  ?A - ?A = {}\n  ?a \\<squnion> ?a = ?a\n\ngoal (1 subgoal):\n 1. (T ^^ 0) --` K \\<Delta> K \\<in> null_sets M", "by (metis null_sets.empty_sets)"], ["proof (state)\nthis:\n  (T ^^ 0) --` K \\<Delta> K \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (T ^^ n) --` K \\<Delta> K \\<in> null_sets M \\<Longrightarrow>\n       (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (T ^^ n) --` K \\<Delta> K \\<in> null_sets M \\<Longrightarrow>\n       (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "case (Suc n)"], ["proof (state)\nthis:\n  (T ^^ n) --` K \\<Delta> K \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (T ^^ n) --` K \\<Delta> K \\<in> null_sets M \\<Longrightarrow>\n       (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "have \"T--`((T^^n)--`K \\<Delta> K) \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T --` ((T ^^ n) --` K \\<Delta> K) \\<in> null_sets M", "using Suc.IH T_quasi_preserves_null(1)[of \"((T^^n)--`K \\<Delta> K)\"]"], ["proof (prove)\nusing this:\n  (T ^^ n) --` K \\<Delta> K \\<in> null_sets M\n  (T ^^ n) --` K \\<Delta> K \\<in> sets M \\<Longrightarrow>\n  ((T ^^ n) --` K \\<Delta> K \\<in> null_sets M) =\n  (T --` ((T ^^ n) --` K \\<Delta> K) \\<in> null_sets M)\n\ngoal (1 subgoal):\n 1. T --` ((T ^^ n) --` K \\<Delta> K) \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  T --` ((T ^^ n) --` K \\<Delta> K) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (T ^^ n) --` K \\<Delta> K \\<in> null_sets M \\<Longrightarrow>\n       (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` ((T ^^ n) --` K \\<Delta> K) \\<in> null_sets M", "have *: \"(T^^(Suc n))--`K \\<Delta> T--`K \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` ((T ^^ n) --` K \\<Delta> K) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (T ^^ Suc n) --` K \\<Delta> T --` K \\<in> null_sets M", "using T_vrestr_composed(2)[OF \\<open>K \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  T --` ((T ^^ n) --` K \\<Delta> K) \\<in> null_sets M\n  T --` (T ^^ ?m) --` K = (T ^^ (?m + 1)) --` K\n\ngoal (1 subgoal):\n 1. (T ^^ Suc n) --` K \\<Delta> T --` K \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  (T ^^ Suc n) --` K \\<Delta> T --` K \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (T ^^ n) --` K \\<Delta> K \\<in> null_sets M \\<Longrightarrow>\n       (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  (T ^^ Suc n) --` K \\<Delta> T --` K \\<in> null_sets M", "show ?case"], ["proof (prove)\nusing this:\n  (T ^^ Suc n) --` K \\<Delta> T --` K \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M", "by (rule null_sym_diff_transitive, simp add: \\<open>T--`K \\<Delta> K \\<in> null_sets M\\<close> \\<open>K \\<in> sets M\\<close>, measurable)"], ["proof (state)\nthis:\n  (T ^^ Suc n) --` K \\<Delta> K \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (T ^^ n) --` K \\<Delta> K \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?K5 \\<in> sets M;\n   T --` ?K5 \\<Delta> ?K5 \\<in> null_sets M\\<rbrakk>\n  \\<Longrightarrow> (T ^^ ?n5) --` ?K5 \\<Delta> ?K5 \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "note * = this"], ["proof (state)\nthis:\n  \\<lbrakk>?K5 \\<in> sets M;\n   T --` ?K5 \\<Delta> ?K5 \\<in> null_sets M\\<rbrakk>\n  \\<Longrightarrow> (T ^^ ?n5) --` ?K5 \\<Delta> ?K5 \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "define C where \"C = (\\<Inter>n. (T^^n)--`A)\""], ["proof (state)\nthis:\n  C = (\\<Inter>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have [measurable]: \"C \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C \\<in> sets M", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Inter>n. (T ^^ n) --` A) \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  C \\<in> sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"C \\<Delta> A \\<subseteq> (\\<Union>n. (T^^n)--`A \\<Delta> A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C \\<Delta> A \\<subseteq> (\\<Union>n. (T ^^ n) --` A \\<Delta> A)", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Inter>n. (T ^^ n) --` A) \\<Delta> A\n    \\<subseteq> (\\<Union>n. (T ^^ n) --` A \\<Delta> A)", "by auto"], ["proof (state)\nthis:\n  C \\<Delta> A \\<subseteq> (\\<Union>n. (T ^^ n) --` A \\<Delta> A)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  C \\<Delta> A \\<subseteq> (\\<Union>n. (T ^^ n) --` A \\<Delta> A)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"(\\<Union>n. (T^^n)--`A \\<Delta> A) \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` A \\<Delta> A) \\<in> null_sets M", "using * null_sets_UN assms \\<open>T --` A \\<Delta> A \\<in> null_sets M\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>?K5 \\<in> sets M;\n   T --` ?K5 \\<Delta> ?K5 \\<in> null_sets M\\<rbrakk>\n  \\<Longrightarrow> (T ^^ ?n5) --` ?K5 \\<Delta> ?K5 \\<in> null_sets M\n  (\\<And>i. ?N i \\<in> null_sets ?M) \\<Longrightarrow>\n  \\<Union> (range ?N) \\<in> null_sets ?M\n  A \\<in> sets M\n  T --` A \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` A \\<Delta> A) \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` A \\<Delta> A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  C \\<Delta> A \\<subseteq> (\\<Union>n. (T ^^ n) --` A \\<Delta> A)\n  (\\<Union>n. (T ^^ n) --` A \\<Delta> A) \\<in> null_sets M", "have CA: \"C \\<Delta> A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  C \\<Delta> A \\<subseteq> (\\<Union>n. (T ^^ n) --` A \\<Delta> A)\n  (\\<Union>n. (T ^^ n) --` A \\<Delta> A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. C \\<Delta> A \\<in> null_sets M", "by (meson \\<open>C \\<in> sets M\\<close> assms sets.Diff sets.Un null_sets_subset)"], ["proof (state)\nthis:\n  C \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  C \\<Delta> A \\<in> null_sets M", "have \"T--`(C \\<Delta> A) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  C \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` (C \\<Delta> A) \\<in> null_sets M", "by (rule T_quasi_preserves_null2(1))"], ["proof (state)\nthis:\n  T --` (C \\<Delta> A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` (C \\<Delta> A) \\<in> null_sets M", "have \"T--`C \\<Delta> T--`A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` (C \\<Delta> A) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` C \\<Delta> T --` A \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  T --` C \\<Delta> T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` C \\<Delta> T --` A \\<in> null_sets M", "have \"T--`C \\<Delta> A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` C \\<Delta> T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` C \\<Delta> A \\<in> null_sets M", "by (rule null_sym_diff_transitive, auto simp add: H)"], ["proof (state)\nthis:\n  T --` C \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` C \\<Delta> A \\<in> null_sets M", "have TCC: \"T--`C \\<Delta> C \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` C \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` C \\<Delta> C \\<in> null_sets M", "apply (rule null_sym_diff_transitive)"], ["proof (prove)\ngoal (3 subgoals):\n 1. A \\<Delta> C \\<in> null_sets M\n 2. T --` C \\<in> sets M\n 3. C \\<in> sets M", "using CA"], ["proof (prove)\nusing this:\n  C \\<Delta> A \\<in> null_sets M\n\ngoal (3 subgoals):\n 1. A \\<Delta> C \\<in> null_sets M\n 2. T --` C \\<in> sets M\n 3. C \\<in> sets M", "by (auto simp add: Un_commute)"], ["proof (state)\nthis:\n  T --` C \\<Delta> C \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"C \\<subseteq> (\\<Inter>n\\<in>{1..}. (T^^n)--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C \\<subseteq> (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Inter>n. (T ^^ n) --` A)\n    \\<subseteq> (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)", "by auto"], ["proof (state)\nthis:\n  C \\<subseteq> (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  C \\<subseteq> (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"T--`C = (\\<Inter>n\\<in>{1..}. (T^^n)--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T --` C = (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)", "using T_vrestr_composed(2)[OF assms]"], ["proof (prove)\nusing this:\n  T --` (T ^^ ?m) --` A = (T ^^ (?m + 1)) --` A\n\ngoal (1 subgoal):\n 1. T --` C = (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)", "by (simp add: C_def atLeast_Suc_greaterThan greaterThan_0)"], ["proof (state)\nthis:\n  T --` C = (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  C \\<subseteq> (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)\n  T --` C = (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)", "have \"C \\<subseteq> T--`C\""], ["proof (prove)\nusing this:\n  C \\<subseteq> (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)\n  T --` C = (\\<Inter>n\\<in>{1..}. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. C \\<subseteq> T --` C", "by blast"], ["proof (state)\nthis:\n  C \\<subseteq> T --` C\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  C \\<subseteq> T --` C", "have \"(T^^0)--`C \\<subseteq> (T^^1)--`C\""], ["proof (prove)\nusing this:\n  C \\<subseteq> T --` C\n\ngoal (1 subgoal):\n 1. (T ^^ 0) --` C \\<subseteq> (T ^^ 1) --` C", "using T_vrestr_0"], ["proof (prove)\nusing this:\n  C \\<subseteq> T --` C\n  ?A \\<in> sets M \\<Longrightarrow> (T ^^ 0) --` ?A = ?A\n  ?A \\<in> sets M \\<Longrightarrow> id --` ?A = ?A\n\ngoal (1 subgoal):\n 1. (T ^^ 0) --` C \\<subseteq> (T ^^ 1) --` C", "by auto"], ["proof (state)\nthis:\n  (T ^^ 0) --` C \\<subseteq> (T ^^ 1) --` C\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  (T ^^ 0) --` C \\<subseteq> (T ^^ 1) --` C\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"(T^^1)--`C \\<subseteq> (\\<Union>n\\<in>{1..}. (T^^n)--`C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ 1) --` C \\<subseteq> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "by auto"], ["proof (state)\nthis:\n  (T ^^ 1) --` C \\<subseteq> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  (T ^^ 0) --` C \\<subseteq> (T ^^ 1) --` C\n  (T ^^ 1) --` C \\<subseteq> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "have \"(T^^0)--`C \\<subseteq> (\\<Union>n\\<in>{1..}. (T^^n)--`C)\""], ["proof (prove)\nusing this:\n  (T ^^ 0) --` C \\<subseteq> (T ^^ 1) --` C\n  (T ^^ 1) --` C \\<subseteq> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. (T ^^ 0) --` C \\<subseteq> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "by auto"], ["proof (state)\nthis:\n  (T ^^ 0) --` C \\<subseteq> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  (T ^^ 0) --` C \\<subseteq> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "have \"(T^^0)--`C \\<union> (\\<Union>n\\<in>{1..}. (T^^n)--`C) = (\\<Union>n\\<in>{1..}. (T^^n)--`C)\""], ["proof (prove)\nusing this:\n  (T ^^ 0) --` C \\<subseteq> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C) =\n    (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "by auto"], ["proof (state)\nthis:\n  (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C) =\n  (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C) =\n  (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"(\\<Union>n. (T^^n)--`C) = (T^^0)--`C \\<union> (\\<Union>n\\<in>{1..}. (T^^n)--`C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` C) =\n    (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "by (rule union_insert_0)"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` C) =\n  (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C) =\n  (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n  (\\<Union>n. (T ^^ n) --` C) =\n  (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "have C2: \"(\\<Union>n. (T^^n)--`C) = (\\<Union>n\\<in>{1..}. (T^^n)--`C)\""], ["proof (prove)\nusing this:\n  (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C) =\n  (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n  (\\<Union>n. (T ^^ n) --` C) =\n  (T ^^ 0) --` C \\<union> (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` C) = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "by simp"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` C) = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "define B where \"B = (\\<Union>n. (T^^n)--`C)\""], ["proof (state)\nthis:\n  B = (\\<Union>n. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<in> sets M", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` C) \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"B \\<Delta> C \\<subseteq> (\\<Union>n. (T^^n)--`C \\<Delta> C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<Delta> C \\<subseteq> (\\<Union>n. (T ^^ n) --` C \\<Delta> C)", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` C) \\<Delta> C\n    \\<subseteq> (\\<Union>n. (T ^^ n) --` C \\<Delta> C)", "by auto"], ["proof (state)\nthis:\n  B \\<Delta> C \\<subseteq> (\\<Union>n. (T ^^ n) --` C \\<Delta> C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  B \\<Delta> C \\<subseteq> (\\<Union>n. (T ^^ n) --` C \\<Delta> C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"(\\<Union>n. (T^^n)--`C \\<Delta> C) \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` C \\<Delta> C) \\<in> null_sets M", "using * null_sets_UN assms TCC"], ["proof (prove)\nusing this:\n  \\<lbrakk>?K5 \\<in> sets M;\n   T --` ?K5 \\<Delta> ?K5 \\<in> null_sets M\\<rbrakk>\n  \\<Longrightarrow> (T ^^ ?n5) --` ?K5 \\<Delta> ?K5 \\<in> null_sets M\n  (\\<And>i. ?N i \\<in> null_sets ?M) \\<Longrightarrow>\n  \\<Union> (range ?N) \\<in> null_sets ?M\n  A \\<in> sets M\n  T --` C \\<Delta> C \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` C \\<Delta> C) \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` C \\<Delta> C) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  B \\<Delta> C \\<subseteq> (\\<Union>n. (T ^^ n) --` C \\<Delta> C)\n  (\\<Union>n. (T ^^ n) --` C \\<Delta> C) \\<in> null_sets M", "have \"B \\<Delta> C \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<Delta> C \\<subseteq> (\\<Union>n. (T ^^ n) --` C \\<Delta> C)\n  (\\<Union>n. (T ^^ n) --` C \\<Delta> C) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<Delta> C \\<in> null_sets M", "by (meson \\<open>B \\<in> sets M\\<close> \\<open>C \\<in> sets M\\<close> assms sets.Diff sets.Un null_sets_subset)"], ["proof (state)\nthis:\n  B \\<Delta> C \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<Delta> C \\<in> null_sets M", "have \"B \\<Delta> A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<Delta> C \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<Delta> A \\<in> null_sets M", "by (rule null_sym_diff_transitive, auto simp add: CA)"], ["proof (state)\nthis:\n  B \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<Delta> A \\<in> null_sets M", "have a: \"A \\<Delta> B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<Delta> A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> B \\<in> null_sets M", "by (simp add: Un_commute)"], ["proof (state)\nthis:\n  A \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "have \"T--`B = (\\<Union>n\\<in>{1..}. (T^^n)--`C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T --` B = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "using T_vrestr_composed(2)[OF \\<open>C \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  T --` (T ^^ ?m) --` C = (T ^^ (?m + 1)) --` C\n\ngoal (1 subgoal):\n 1. T --` B = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "by (simp add: B_def atLeast_Suc_greaterThan greaterThan_0)"], ["proof (state)\nthis:\n  T --` B = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` B = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)", "have \"T--`B = B\""], ["proof (prove)\nusing this:\n  T --` B = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` B = B", "unfolding B_def"], ["proof (prove)\nusing this:\n  T --` (\\<Union>n. (T ^^ n) --` C) = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` (\\<Union>n. (T ^^ n) --` C) = (\\<Union>n. (T ^^ n) --` C)", "using C2"], ["proof (prove)\nusing this:\n  T --` (\\<Union>n. (T ^^ n) --` C) = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n  (\\<Union>n. (T ^^ n) --` C) = (\\<Union>n\\<in>{1..}. (T ^^ n) --` C)\n\ngoal (1 subgoal):\n 1. T --` (\\<Union>n. (T ^^ n) --` C) = (\\<Union>n. (T ^^ n) --` C)", "by simp"], ["proof (state)\nthis:\n  T --` B = B\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  T --` B = B", "have \"B \\<in> sets Invariants\""], ["proof (prove)\nusing this:\n  T --` B = B\n\ngoal (1 subgoal):\n 1. B \\<in> sets Invariants", "using Invariants_sets vimage_restr_def"], ["proof (prove)\nusing this:\n  T --` B = B\n  sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}\n  ?f --` ?A \\<equiv> ?f -` (?A \\<inter> space M) \\<inter> space M\n\ngoal (1 subgoal):\n 1. B \\<in> sets Invariants", "by auto"], ["proof (state)\nthis:\n  B \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. T --` A \\<Delta> A \\<in> null_sets M \\<Longrightarrow>\n    \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<in> sets Invariants", "show \"\\<exists>B \\<in> sets Invariants. A \\<Delta> B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "using a"], ["proof (prove)\nusing this:\n  B \\<in> sets Invariants\n  A \\<Delta> B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M", "by blast"], ["proof (state)\nthis:\n  \\<exists>B\\<in>sets Invariants. A \\<Delta> B \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>In a conservative setting, it is enough to be included in its image or its preimage to be\nalmost invariant: otherwise, since the difference set has disjoint preimages, and is therefore\nnull by conservativity.\\<close>"], ["", "lemma (in conservative) preimage_included_then_almost_invariant:\n  assumes [measurable]: \"A \\<in> sets M\" and \"T--`A \\<subseteq> A\"\n  shows \"A \\<Delta> (T--`A) \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "define B where \"B = A - T--`A\""], ["proof (state)\nthis:\n  B = A - T --` A\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B = A - T --` A", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\nusing this:\n  B = A - T --` A\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "have \"(T^^(Suc n))--`A \\<subseteq> (T^^n)--`A\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ Suc n) --` A \\<subseteq> (T ^^ n) --` A", "using T_vrestr_composed(3)[OF assms(1)] vrestr_inclusion[OF assms(2)]"], ["proof (prove)\nusing this:\n  (T ^^ ?m) --` T --` A = (T ^^ (?m + 1)) --` A\n  ?f --` T --` A \\<subseteq> ?f --` A\n\ngoal (1 subgoal):\n 1. (T ^^ Suc n) --` A \\<subseteq> (T ^^ n) --` A", "by auto"], ["proof (state)\nthis:\n  (T ^^ Suc ?n3) --` A \\<subseteq> (T ^^ ?n3) --` A\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  (T ^^ Suc ?n3) --` A \\<subseteq> (T ^^ ?n3) --` A", "have \"disjoint_family (\\<lambda>n. (T^^n)--`A - (T^^(Suc n))--`A)\""], ["proof (prove)\nusing this:\n  (T ^^ Suc ?n3) --` A \\<subseteq> (T ^^ ?n3) --` A\n\ngoal (1 subgoal):\n 1. disjoint_family (\\<lambda>n. (T ^^ n) --` A - (T ^^ Suc n) --` A)", "by (rule disjoint_family_Suc2[where ?A = \"\\<lambda>n. (T^^n)--`A\"])"], ["proof (state)\nthis:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` A - (T ^^ Suc n) --` A)\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` A - (T ^^ Suc n) --` A)\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "have \"(T^^n)--`A - (T^^(Suc n))--`A = (T^^n)--`B\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ n) --` A - (T ^^ Suc n) --` A = (T ^^ n) --` B", "unfolding B_def Suc_eq_plus1"], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ n) --` A - (T ^^ (n + 1)) --` A = (T ^^ n) --` (A - T --` A)", "using T_vrestr_composed(3)[OF assms(1)]"], ["proof (prove)\nusing this:\n  (T ^^ ?m) --` T --` A = (T ^^ (?m + 1)) --` A\n\ngoal (1 subgoal):\n 1. (T ^^ n) --` A - (T ^^ (n + 1)) --` A = (T ^^ n) --` (A - T --` A)", "by auto"], ["proof (state)\nthis:\n  (T ^^ ?n3) --` A - (T ^^ Suc ?n3) --` A = (T ^^ ?n3) --` B\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` A - (T ^^ Suc n) --` A)\n  (T ^^ ?n3) --` A - (T ^^ Suc ?n3) --` A = (T ^^ ?n3) --` B", "have \"disjoint_family (\\<lambda>n. (T^^n)--` B)\""], ["proof (prove)\nusing this:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` A - (T ^^ Suc n) --` A)\n  (T ^^ ?n3) --` A - (T ^^ Suc ?n3) --` A = (T ^^ ?n3) --` B\n\ngoal (1 subgoal):\n 1. disjoint_family (\\<lambda>n. (T ^^ n) --` B)", "by simp"], ["proof (state)\nthis:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` B)\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` B)", "have \"\\<And>n. n \\<noteq> 0 \\<Longrightarrow> ((T^^n)--`B) \\<inter> B = {}\""], ["proof (prove)\nusing this:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` B)\n\ngoal (1 subgoal):\n 1. \\<And>n. n \\<noteq> 0 \\<Longrightarrow> (T ^^ n) --` B \\<inter> B = {}", "unfolding disjoint_family_on_def"], ["proof (prove)\nusing this:\n  \\<forall>m\\<in>UNIV.\n     \\<forall>n\\<in>UNIV.\n        m \\<noteq> n \\<longrightarrow>\n        (T ^^ m) --` B \\<inter> (T ^^ n) --` B = {}\n\ngoal (1 subgoal):\n 1. \\<And>n. n \\<noteq> 0 \\<Longrightarrow> (T ^^ n) --` B \\<inter> B = {}", "by (metis UNIV_I T_vrestr_0(1)[OF \\<open>B \\<in> sets M\\<close>])"], ["proof (state)\nthis:\n  ?n3 \\<noteq> 0 \\<Longrightarrow> (T ^^ ?n3) --` B \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  ?n3 \\<noteq> 0 \\<Longrightarrow> (T ^^ ?n3) --` B \\<inter> B = {}", "have \"\\<And>n. n > 0 \\<Longrightarrow> (T^^n)-`B \\<inter> B = {}\""], ["proof (prove)\nusing this:\n  ?n3 \\<noteq> 0 \\<Longrightarrow> (T ^^ ?n3) --` B \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. \\<And>n. 0 < n \\<Longrightarrow> (T ^^ n) -` B \\<inter> B = {}", "unfolding vimage_restr_def"], ["proof (prove)\nusing this:\n  ?n3 \\<noteq> 0 \\<Longrightarrow>\n  (T ^^ ?n3) -` (B \\<inter> space M) \\<inter> space M \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. \\<And>n. 0 < n \\<Longrightarrow> (T ^^ n) -` B \\<inter> B = {}", "by (simp add: Int_assoc)"], ["proof (state)\nthis:\n  0 < ?n3 \\<Longrightarrow> (T ^^ ?n3) -` B \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  0 < ?n3 \\<Longrightarrow> (T ^^ ?n3) -` B \\<inter> B = {}", "have \"B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  0 < ?n3 \\<Longrightarrow> (T ^^ ?n3) -` B \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M", "using disjoint_then_null[OF \\<open>B \\<in> sets M\\<close>] Int_commute"], ["proof (prove)\nusing this:\n  0 < ?n3 \\<Longrightarrow> (T ^^ ?n3) -` B \\<inter> B = {}\n  (\\<And>n.\n      0 < n \\<Longrightarrow>\n      B \\<inter> (T ^^ n) -` B = {}) \\<Longrightarrow>\n  B \\<in> null_sets M\n  ?A \\<inter> ?B = ?B \\<inter> ?A\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<in> null_sets M", "show ?thesis"], ["proof (prove)\nusing this:\n  B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "unfolding B_def"], ["proof (prove)\nusing this:\n  A - T --` A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "using assms(2)"], ["proof (prove)\nusing this:\n  A - T --` A \\<in> null_sets M\n  T --` A \\<subseteq> A\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "by (simp add: Diff_mono Un_absorb2)"], ["proof (state)\nthis:\n  A \\<Delta> T --` A \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in conservative) preimage_includes_then_almost_invariant:\n  assumes [measurable]: \"A \\<in> sets M\" and \"A \\<subseteq> T--`A\"\n  shows \"A \\<Delta> (T--`A) \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "define B where \"B = T--`A - A\""], ["proof (state)\nthis:\n  B = T --` A - A\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B = T --` A - A", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\nusing this:\n  B = T --` A - A\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "have \"\\<And>n. (T^^(Suc n))--`A \\<supseteq> (T^^n)--`A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n. (T ^^ n) --` A \\<subseteq> (T ^^ Suc n) --` A", "using T_vrestr_composed(3)[OF assms(1)] vrestr_inclusion[OF assms(2)]"], ["proof (prove)\nusing this:\n  (T ^^ ?m) --` T --` A = (T ^^ (?m + 1)) --` A\n  ?f --` A \\<subseteq> ?f --` T --` A\n\ngoal (1 subgoal):\n 1. \\<And>n. (T ^^ n) --` A \\<subseteq> (T ^^ Suc n) --` A", "by auto"], ["proof (state)\nthis:\n  (T ^^ ?n3) --` A \\<subseteq> (T ^^ Suc ?n3) --` A\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  (T ^^ ?n3) --` A \\<subseteq> (T ^^ Suc ?n3) --` A", "have \"disjoint_family (\\<lambda>n. (T^^(Suc n))--`A - (T^^n)--`A)\""], ["proof (prove)\nusing this:\n  (T ^^ ?n3) --` A \\<subseteq> (T ^^ Suc ?n3) --` A\n\ngoal (1 subgoal):\n 1. disjoint_family (\\<lambda>n. (T ^^ Suc n) --` A - (T ^^ n) --` A)", "by (rule disjoint_family_Suc[where ?A = \"\\<lambda>n. (T^^n)--`A\"])"], ["proof (state)\nthis:\n  disjoint_family (\\<lambda>n. (T ^^ Suc n) --` A - (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "moreover"], ["proof (state)\nthis:\n  disjoint_family (\\<lambda>n. (T ^^ Suc n) --` A - (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "have \"\\<And>n. (T^^(Suc n))--`A - (T^^n)--`A = (T^^n)--`B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n. (T ^^ Suc n) --` A - (T ^^ n) --` A = (T ^^ n) --` B", "unfolding B_def Suc_eq_plus1"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (T ^^ (n + 1)) --` A - (T ^^ n) --` A = (T ^^ n) --` (T --` A - A)", "using T_vrestr_composed(3)[OF assms(1)]"], ["proof (prove)\nusing this:\n  (T ^^ ?m) --` T --` A = (T ^^ (?m + 1)) --` A\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       (T ^^ (n + 1)) --` A - (T ^^ n) --` A = (T ^^ n) --` (T --` A - A)", "by auto"], ["proof (state)\nthis:\n  (T ^^ Suc ?n3) --` A - (T ^^ ?n3) --` A = (T ^^ ?n3) --` B\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "ultimately"], ["proof (chain)\npicking this:\n  disjoint_family (\\<lambda>n. (T ^^ Suc n) --` A - (T ^^ n) --` A)\n  (T ^^ Suc ?n3) --` A - (T ^^ ?n3) --` A = (T ^^ ?n3) --` B", "have \"disjoint_family (\\<lambda>n. (T^^n)--` B)\""], ["proof (prove)\nusing this:\n  disjoint_family (\\<lambda>n. (T ^^ Suc n) --` A - (T ^^ n) --` A)\n  (T ^^ Suc ?n3) --` A - (T ^^ ?n3) --` A = (T ^^ ?n3) --` B\n\ngoal (1 subgoal):\n 1. disjoint_family (\\<lambda>n. (T ^^ n) --` B)", "by simp"], ["proof (state)\nthis:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` B)\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` B)", "have \"\\<And>n. n \\<noteq> 0 \\<Longrightarrow> ((T^^n)--`B) \\<inter> B = {}\""], ["proof (prove)\nusing this:\n  disjoint_family (\\<lambda>n. (T ^^ n) --` B)\n\ngoal (1 subgoal):\n 1. \\<And>n. n \\<noteq> 0 \\<Longrightarrow> (T ^^ n) --` B \\<inter> B = {}", "unfolding disjoint_family_on_def"], ["proof (prove)\nusing this:\n  \\<forall>m\\<in>UNIV.\n     \\<forall>n\\<in>UNIV.\n        m \\<noteq> n \\<longrightarrow>\n        (T ^^ m) --` B \\<inter> (T ^^ n) --` B = {}\n\ngoal (1 subgoal):\n 1. \\<And>n. n \\<noteq> 0 \\<Longrightarrow> (T ^^ n) --` B \\<inter> B = {}", "by (metis UNIV_I T_vrestr_0(1)[OF \\<open>B \\<in> sets M\\<close>])"], ["proof (state)\nthis:\n  ?n3 \\<noteq> 0 \\<Longrightarrow> (T ^^ ?n3) --` B \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  ?n3 \\<noteq> 0 \\<Longrightarrow> (T ^^ ?n3) --` B \\<inter> B = {}", "have \"\\<And>n. n > 0 \\<Longrightarrow> (T^^n)-`B \\<inter> B = {}\""], ["proof (prove)\nusing this:\n  ?n3 \\<noteq> 0 \\<Longrightarrow> (T ^^ ?n3) --` B \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. \\<And>n. 0 < n \\<Longrightarrow> (T ^^ n) -` B \\<inter> B = {}", "unfolding vimage_restr_def"], ["proof (prove)\nusing this:\n  ?n3 \\<noteq> 0 \\<Longrightarrow>\n  (T ^^ ?n3) -` (B \\<inter> space M) \\<inter> space M \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. \\<And>n. 0 < n \\<Longrightarrow> (T ^^ n) -` B \\<inter> B = {}", "by (simp add: Int_assoc)"], ["proof (state)\nthis:\n  0 < ?n3 \\<Longrightarrow> (T ^^ ?n3) -` B \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  0 < ?n3 \\<Longrightarrow> (T ^^ ?n3) -` B \\<inter> B = {}", "have \"B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  0 < ?n3 \\<Longrightarrow> (T ^^ ?n3) -` B \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M", "using disjoint_then_null[OF \\<open>B \\<in> sets M\\<close>] Int_commute"], ["proof (prove)\nusing this:\n  0 < ?n3 \\<Longrightarrow> (T ^^ ?n3) -` B \\<inter> B = {}\n  (\\<And>n.\n      0 < n \\<Longrightarrow>\n      B \\<inter> (T ^^ n) -` B = {}) \\<Longrightarrow>\n  B \\<in> null_sets M\n  ?A \\<inter> ?B = ?B \\<inter> ?A\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "then"], ["proof (chain)\npicking this:\n  B \\<in> null_sets M", "show ?thesis"], ["proof (prove)\nusing this:\n  B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "unfolding B_def"], ["proof (prove)\nusing this:\n  T --` A - A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "using assms(2)"], ["proof (prove)\nusing this:\n  T --` A - A \\<in> null_sets M\n  A \\<subseteq> T --` A\n\ngoal (1 subgoal):\n 1. A \\<Delta> T --` A \\<in> null_sets M", "by (simp add: Diff_mono Un_absorb1)"], ["proof (state)\nthis:\n  A \\<Delta> T --` A \\<in> null_sets M\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The above properties for sets are also true for functions: if $f$ and $f \\circ T$\ncoincide almost everywhere, i.e., $f$ is almost invariant, then $f$ coincides almost everywhere\nwith a true invariant function.\n\nThe idea of the proof is straightforward: throw away the orbits on\nwhich $f$ is not really invariant (say this is the complement of the good set),\nand replace it by $0$ there. However, this does not work\ndirectly: the good set is not invariant, some points may have a non-constant value of $f$ on their\norbit but reach the good set eventually. One can however define $g$ to be equal to the\neventual value of $f$ along the orbit, if the orbit reaches the good set, and $0$ elsewhere.\\<close>"], ["", "proposition Invariants_quasi_Invariants_functions:\n  fixes f::\"_ \\<Rightarrow> 'b::{second_countable_topology, t2_space}\"\n  assumes f_meas [measurable]: \"f \\<in> borel_measurable M\"\n  shows \"(\\<exists>g \\<in> borel_measurable Invariants. AE x in M. f x = g x) \\<longleftrightarrow> (AE x in M. f(T x) = f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x) =\n    (AE x in M. f (T x) = f x)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "assume \"\\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x\""], ["proof (state)\nthis:\n  \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "obtain g where g:\"g\\<in>borel_measurable Invariants\" \"AE x in M. f x = g x\""], ["proof (prove)\nusing this:\n  \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>g \\<in> borel_measurable Invariants;\n         AE x in M. f x = g x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x", "have [measurable]: \"g \\<in> borel_measurable M\""], ["proof (prove)\nusing this:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x\n\ngoal (1 subgoal):\n 1. g \\<in> borel_measurable M", "using Invariants_measurable_func"], ["proof (prove)\nusing this:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x\n  ?f \\<in> Invariants \\<rightarrow>\\<^sub>M ?N \\<Longrightarrow>\n  ?f \\<in> M \\<rightarrow>\\<^sub>M ?N\n\ngoal (1 subgoal):\n 1. g \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  g \\<in> borel_measurable M\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "define A where \"A = {x \\<in> space M. f x = g x}\""], ["proof (state)\nthis:\n  A = {x \\<in> space M. f x = g x}\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have [measurable]: \"A \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> sets M", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M. f x = g x} \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  A \\<in> sets M\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "define B where \"B = space M - A\""], ["proof (state)\nthis:\n  B = space M - A\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<in> sets M", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - A \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "moreover"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have \"AE x in M. x \\<notin> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> B", "unfolding B_def A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> space M - {x \\<in> space M. f x = g x}", "using g(2)"], ["proof (prove)\nusing this:\n  AE x in M. f x = g x\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> space M - {x \\<in> space M. f x = g x}", "by auto"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> B\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "ultimately"], ["proof (chain)\npicking this:\n  B \\<in> sets M\n  AE x in M. x \\<notin> B", "have \"B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<in> sets M\n  AE x in M. x \\<notin> B\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M", "using AE_iff_null_sets"], ["proof (prove)\nusing this:\n  B \\<in> sets M\n  AE x in M. x \\<notin> B\n  ?N \\<in> sets ?M \\<Longrightarrow>\n  (?N \\<in> null_sets ?M) = (AE x in ?M. x \\<notin> ?N)\n\ngoal (1 subgoal):\n 1. B \\<in> null_sets M", "by blast"], ["proof (state)\nthis:\n  B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  B \\<in> null_sets M", "have \"T--`B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. T --` B \\<in> null_sets M", "by (rule T_quasi_preserves_null2(1))"], ["proof (state)\nthis:\n  T --` B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  T --` B \\<in> null_sets M", "have \"B \\<union> T--`B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<union> T --` B \\<in> null_sets M", "using \\<open>B \\<in> null_sets M\\<close>"], ["proof (prove)\nusing this:\n  T --` B \\<in> null_sets M\n  B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. B \\<union> T --` B \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  B \\<union> T --` B \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  B \\<union> T --` B \\<in> null_sets M", "have \"AE x in M. x \\<notin> (B \\<union> T--`B)\""], ["proof (prove)\nusing this:\n  B \\<union> T --` B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> B \\<union> T --` B", "using AE_iff_null_sets null_setsD2"], ["proof (prove)\nusing this:\n  B \\<union> T --` B \\<in> null_sets M\n  ?N \\<in> sets ?M \\<Longrightarrow>\n  (?N \\<in> null_sets ?M) = (AE x in ?M. x \\<notin> ?N)\n  ?A \\<in> null_sets ?M \\<Longrightarrow> ?A \\<in> sets ?M\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> B \\<union> T --` B", "by blast"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> B \\<union> T --` B\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  AE x in M. x \\<notin> B \\<union> T --` B", "have i: \"AE x in M. x \\<in> space M - (B \\<union> T--`B)\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<notin> B \\<union> T --` B\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> space M - (B \\<union> T --` B)", "by auto"], ["proof (state)\nthis:\n  AE x in M. x \\<in> space M - (B \\<union> T --` B)\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "{"], ["proof (state)\nthis:\n  AE x in M. x \\<in> space M - (B \\<union> T --` B)\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "assume *: \"x \\<in> space M - (B \\<union> T--`B)\""], ["proof (state)\nthis:\n  x \\<in> space M - (B \\<union> T --` B)\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  x \\<in> space M - (B \\<union> T --` B)", "have \"x \\<in> A\""], ["proof (prove)\nusing this:\n  x \\<in> space M - (B \\<union> T --` B)\n\ngoal (1 subgoal):\n 1. x \\<in> A", "unfolding B_def"], ["proof (prove)\nusing this:\n  x \\<in> space M - (space M - A \\<union> T --` (space M - A))\n\ngoal (1 subgoal):\n 1. x \\<in> A", "by blast"], ["proof (state)\nthis:\n  x \\<in> A\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  x \\<in> A", "have \"f x = g x\""], ["proof (prove)\nusing this:\n  x \\<in> A\n\ngoal (1 subgoal):\n 1. f x = g x", "unfolding A_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M. f x = g x}\n\ngoal (1 subgoal):\n 1. f x = g x", "by blast"], ["proof (state)\nthis:\n  f x = g x\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have \"T x \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T x \\<in> A", "using * B_def"], ["proof (prove)\nusing this:\n  x \\<in> space M - (B \\<union> T --` B)\n  B = space M - A\n\ngoal (1 subgoal):\n 1. T x \\<in> A", "by auto"], ["proof (state)\nthis:\n  T x \\<in> A\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  T x \\<in> A", "have \"f(T x) = g(T x)\""], ["proof (prove)\nusing this:\n  T x \\<in> A\n\ngoal (1 subgoal):\n 1. f (T x) = g (T x)", "unfolding A_def"], ["proof (prove)\nusing this:\n  T x \\<in> {x \\<in> space M. f x = g x}\n\ngoal (1 subgoal):\n 1. f (T x) = g (T x)", "by blast"], ["proof (state)\nthis:\n  f (T x) = g (T x)\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "moreover"], ["proof (state)\nthis:\n  f (T x) = g (T x)\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have \"g(T x) = g x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g (T x) = g x", "apply (rule Invariants_func_is_invariant)"], ["proof (prove)\ngoal (2 subgoals):\n 1. g \\<in> borel_measurable Invariants\n 2. x \\<in> space M", "using *"], ["proof (prove)\nusing this:\n  x \\<in> space M - (B \\<union> T --` B)\n\ngoal (2 subgoals):\n 1. g \\<in> borel_measurable Invariants\n 2. x \\<in> space M", "by (auto simp add: assms \\<open>g\\<in>borel_measurable Invariants\\<close>)"], ["proof (state)\nthis:\n  g (T x) = g x\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "ultimately"], ["proof (chain)\npicking this:\n  f (T x) = g (T x)\n  g (T x) = g x", "have \"f(T x) = f x\""], ["proof (prove)\nusing this:\n  f (T x) = g (T x)\n  g (T x) = g x\n\ngoal (1 subgoal):\n 1. f (T x) = f x", "using \\<open>f x = g x\\<close>"], ["proof (prove)\nusing this:\n  f (T x) = g (T x)\n  g (T x) = g x\n  f x = g x\n\ngoal (1 subgoal):\n 1. f (T x) = f x", "by simp"], ["proof (state)\nthis:\n  f (T x) = f x\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "}"], ["proof (state)\nthis:\n  ?x5 \\<in> space M - (B \\<union> T --` B) \\<Longrightarrow>\n  f (T ?x5) = f ?x5\n\ngoal (2 subgoals):\n 1. \\<exists>g\\<in>borel_measurable Invariants.\n       AE x in M. f x = g x \\<Longrightarrow>\n    AE x in M. f (T x) = f x\n 2. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  ?x5 \\<in> space M - (B \\<union> T --` B) \\<Longrightarrow>\n  f (T ?x5) = f ?x5", "show \"AE x in M. f(T x) = f x\""], ["proof (prove)\nusing this:\n  ?x5 \\<in> space M - (B \\<union> T --` B) \\<Longrightarrow>\n  f (T ?x5) = f ?x5\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "using i"], ["proof (prove)\nusing this:\n  ?x5 \\<in> space M - (B \\<union> T --` B) \\<Longrightarrow>\n  f (T ?x5) = f ?x5\n  AE x in M. x \\<in> space M - (B \\<union> T --` B)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "assume *: \"AE x in M. f (T x) = f x\""], ["proof (state)\nthis:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "text \\<open>\\verb+good_set+ is the set of points for which $f$ is constant on their orbit. Here, we define\n  $g = f$. If a point ever enters \\verb+good_set+, then we take $g$ to be the value of $f$ there. Otherwise,\n  $g$ takes an arbitrary value, say $y_0$.\\<close>"], ["proof (state)\nthis:\n  AE x in M. f (T x) = f x\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "define good_set where \"good_set = {x \\<in> space M. \\<forall>n. f((T^^(Suc n)) x) = f((T^^n) x)}\""], ["proof (state)\nthis:\n  good_set =\n  {x \\<in> space M. \\<forall>n. f ((T ^^ Suc n) x) = f ((T ^^ n) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "define good_time where \"good_time = (\\<lambda>x. Inf {n. (T^^n) x \\<in> good_set})\""], ["proof (state)\nthis:\n  good_time = (\\<lambda>x. \\<Sqinter> {n. (T ^^ n) x \\<in> good_set})\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have \"AE x in M. x \\<in> good_set\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> good_set", "using T_AE_iterates[OF *]"], ["proof (prove)\nusing this:\n  AE x in M. \\<forall>n. f (T ((T ^^ n) x)) = f ((T ^^ n) x)\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> good_set", "by (simp add: good_set_def)"], ["proof (state)\nthis:\n  AE x in M. x \\<in> good_set\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have [measurable]: \"good_set \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. good_set \\<in> sets M", "unfolding good_set_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M. \\<forall>n. f ((T ^^ Suc n) x) = f ((T ^^ n) x)}\n    \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  good_set \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "obtain y0::'b where True"], ["proof (prove)\ngoal (1 subgoal):\n 1. (True \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  True\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "define g where \"g = (\\<lambda>x. if (\\<exists>n. (T^^n) x \\<in> good_set) then f((T^^(good_time x)) x) else y0)\""], ["proof (state)\nthis:\n  g =\n  (\\<lambda>x.\n      if \\<exists>n. (T ^^ n) x \\<in> good_set then f ((T ^^ good_time x) x)\n      else y0)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have [measurable]: \"good_time \\<in> measurable M (count_space UNIV)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. good_time \\<in> M \\<rightarrow>\\<^sub>M count_space UNIV", "unfolding good_time_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. \\<Sqinter> {n. (T ^^ n) x \\<in> good_set})\n    \\<in> M \\<rightarrow>\\<^sub>M count_space UNIV", "by measurable"], ["proof (state)\nthis:\n  good_time \\<in> M \\<rightarrow>\\<^sub>M count_space UNIV\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have [measurable]: \"g \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g \\<in> borel_measurable M", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        if \\<exists>n. (T ^^ n) x \\<in> good_set\n        then f ((T ^^ good_time x) x) else y0)\n    \\<in> borel_measurable M", "by measurable"], ["proof (state)\nthis:\n  g \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have \"f x = g x\" if \"x \\<in> good_set\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. f x = g x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f x = g x", "have a: \"0 \\<in> {n. (T^^n) x \\<in> good_set}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<in> {n. (T ^^ n) x \\<in> good_set}", "using that"], ["proof (prove)\nusing this:\n  x \\<in> good_set\n\ngoal (1 subgoal):\n 1. 0 \\<in> {n. (T ^^ n) x \\<in> good_set}", "by simp"], ["proof (state)\nthis:\n  0 \\<in> {n. (T ^^ n) x \\<in> good_set}\n\ngoal (1 subgoal):\n 1. f x = g x", "have \"good_time x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. good_time x = 0", "unfolding good_time_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Sqinter> {n. (T ^^ n) x \\<in> good_set} = 0", "apply (intro cInf_eq_non_empty)"], ["proof (prove)\ngoal (3 subgoals):\n 1. {n. (T ^^ n) x \\<in> good_set} \\<noteq> {}\n 2. \\<And>xa.\n       xa \\<in> {n. (T ^^ n) x \\<in> good_set} \\<Longrightarrow> 0 \\<le> xa\n 3. \\<And>y.\n       (\\<And>xa.\n           xa \\<in> {n. (T ^^ n) x \\<in> good_set} \\<Longrightarrow>\n           y \\<le> xa) \\<Longrightarrow>\n       y \\<le> 0", "using a"], ["proof (prove)\nusing this:\n  0 \\<in> {n. (T ^^ n) x \\<in> good_set}\n\ngoal (3 subgoals):\n 1. {n. (T ^^ n) x \\<in> good_set} \\<noteq> {}\n 2. \\<And>xa.\n       xa \\<in> {n. (T ^^ n) x \\<in> good_set} \\<Longrightarrow> 0 \\<le> xa\n 3. \\<And>y.\n       (\\<And>xa.\n           xa \\<in> {n. (T ^^ n) x \\<in> good_set} \\<Longrightarrow>\n           y \\<le> xa) \\<Longrightarrow>\n       y \\<le> 0", "by blast+"], ["proof (state)\nthis:\n  good_time x = 0\n\ngoal (1 subgoal):\n 1. f x = g x", "moreover"], ["proof (state)\nthis:\n  good_time x = 0\n\ngoal (1 subgoal):\n 1. f x = g x", "have \"{n. (T^^n) x \\<in> good_set} \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. (T ^^ n) x \\<in> good_set} \\<noteq> {}", "using a"], ["proof (prove)\nusing this:\n  0 \\<in> {n. (T ^^ n) x \\<in> good_set}\n\ngoal (1 subgoal):\n 1. {n. (T ^^ n) x \\<in> good_set} \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  {n. (T ^^ n) x \\<in> good_set} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. f x = g x", "ultimately"], ["proof (chain)\npicking this:\n  good_time x = 0\n  {n. (T ^^ n) x \\<in> good_set} \\<noteq> {}", "show \"f x = g x\""], ["proof (prove)\nusing this:\n  good_time x = 0\n  {n. (T ^^ n) x \\<in> good_set} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. f x = g x", "unfolding g_def"], ["proof (prove)\nusing this:\n  good_time x = 0\n  {n. (T ^^ n) x \\<in> good_set} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. f x =\n    (if \\<exists>n. (T ^^ n) x \\<in> good_set then f ((T ^^ good_time x) x)\n     else y0)", "by auto"], ["proof (state)\nthis:\n  f x = g x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x3 \\<in> good_set \\<Longrightarrow> f ?x3 = g ?x3\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  ?x3 \\<in> good_set \\<Longrightarrow> f ?x3 = g ?x3", "have \"AE x in M. f x = g x\""], ["proof (prove)\nusing this:\n  ?x3 \\<in> good_set \\<Longrightarrow> f ?x3 = g ?x3\n\ngoal (1 subgoal):\n 1. AE x in M. f x = g x", "using \\<open>AE x in M. x \\<in> good_set\\<close>"], ["proof (prove)\nusing this:\n  ?x3 \\<in> good_set \\<Longrightarrow> f ?x3 = g ?x3\n  AE x in M. x \\<in> good_set\n\ngoal (1 subgoal):\n 1. AE x in M. f x = g x", "by auto"], ["proof (state)\nthis:\n  AE x in M. f x = g x\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have *: \"f((T^^(Suc 0)) x) = f((T^^0) x)\" if \"x \\<in> good_set\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ Suc 0) x) = f ((T ^^ 0) x)", "using that"], ["proof (prove)\nusing this:\n  x \\<in> good_set\n\ngoal (1 subgoal):\n 1. f ((T ^^ Suc 0) x) = f ((T ^^ 0) x)", "unfolding good_set_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M. \\<forall>n. f ((T ^^ Suc n) x) = f ((T ^^ n) x)}\n\ngoal (1 subgoal):\n 1. f ((T ^^ Suc 0) x) = f ((T ^^ 0) x)", "by blast"], ["proof (state)\nthis:\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  f ((T ^^ Suc 0) ?x3) = f ((T ^^ 0) ?x3)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have good_1: \"T x \\<in> good_set \\<and> f(T x) = f x\" if \"x \\<in> good_set\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. T x \\<in> good_set \\<and> f (T x) = f x", "using *[OF that] that"], ["proof (prove)\nusing this:\n  f ((T ^^ Suc 0) x) = f ((T ^^ 0) x)\n  x \\<in> good_set\n\ngoal (1 subgoal):\n 1. T x \\<in> good_set \\<and> f (T x) = f x", "unfolding good_set_def"], ["proof (prove)\nusing this:\n  f ((T ^^ Suc 0) x) = f ((T ^^ 0) x)\n  x \\<in> {x \\<in> space M. \\<forall>n. f ((T ^^ Suc n) x) = f ((T ^^ n) x)}\n\ngoal (1 subgoal):\n 1. T x\n    \\<in> {x \\<in> space M.\n           \\<forall>n. f ((T ^^ Suc n) x) = f ((T ^^ n) x)} \\<and>\n    f (T x) = f x", "apply (auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f (T x) = f x; x \\<in> space M;\n        \\<forall>n. f (T ((T ^^ n) x)) = f ((T ^^ n) x)\\<rbrakk>\n       \\<Longrightarrow> f (T ((T ^^ n) (T x))) = f ((T ^^ n) (T x))", "unfolding T_Tn_T_compose"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f (T x) = f x; x \\<in> space M;\n        \\<forall>n. f ((T ^^ Suc n) x) = f ((T ^^ n) x)\\<rbrakk>\n       \\<Longrightarrow> f ((T ^^ Suc (Suc n)) x) = f ((T ^^ Suc n) x)", "by blast"], ["proof (state)\nthis:\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  T ?x3 \\<in> good_set \\<and> f (T ?x3) = f ?x3\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  T ?x3 \\<in> good_set \\<and> f (T ?x3) = f ?x3", "have good_k: \"\\<And>x. x \\<in> good_set \\<Longrightarrow> (T^^k) x \\<in> good_set \\<and> f((T^^k) x) = f x\" for k"], ["proof (prove)\nusing this:\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  T ?x3 \\<in> good_set \\<and> f (T ?x3) = f ?x3\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> good_set \\<Longrightarrow>\n       (T ^^ k) x \\<in> good_set \\<and> f ((T ^^ k) x) = f x", "by (induction k, auto)"], ["proof (state)\nthis:\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  (T ^^ ?k4) ?x3 \\<in> good_set \\<and> f ((T ^^ ?k4) ?x3) = f ?x3\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "have \"g(T x) = g x\" if \"x \\<in> space M\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. g (T x) = g x", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "assume *: \"\\<exists>n. (T^^n) (T x) \\<in> good_set\""], ["proof (state)\nthis:\n  \\<exists>n. (T ^^ n) (T x) \\<in> good_set\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "define n where \"n = Inf {n. (T^^n) (T x) \\<in> good_set}\""], ["proof (state)\nthis:\n  n = \\<Sqinter> {n. (T ^^ n) (T x) \\<in> good_set}\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "have \"(T^^n)(T x) \\<in> good_set\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ n) (T x) \\<in> good_set", "using * Inf_nat_def1"], ["proof (prove)\nusing this:\n  \\<exists>n. (T ^^ n) (T x) \\<in> good_set\n  ?K \\<noteq> {} \\<Longrightarrow> \\<Sqinter> ?K \\<in> ?K\n\ngoal (1 subgoal):\n 1. (T ^^ n) (T x) \\<in> good_set", "by (metis empty_iff mem_Collect_eq n_def)"], ["proof (state)\nthis:\n  (T ^^ n) (T x) \\<in> good_set\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  (T ^^ n) (T x) \\<in> good_set", "have a: \"(T^^(n+1)) x \\<in> good_set\""], ["proof (prove)\nusing this:\n  (T ^^ n) (T x) \\<in> good_set\n\ngoal (1 subgoal):\n 1. (T ^^ (n + 1)) x \\<in> good_set", "by (metis Suc_eq_plus1 comp_eq_dest_lhs funpow.simps(2) funpow_swap1)"], ["proof (state)\nthis:\n  (T ^^ (n + 1)) x \\<in> good_set\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  (T ^^ (n + 1)) x \\<in> good_set", "have **: \"\\<exists>m. (T^^m) x \\<in> good_set\""], ["proof (prove)\nusing this:\n  (T ^^ (n + 1)) x \\<in> good_set\n\ngoal (1 subgoal):\n 1. \\<exists>m. (T ^^ m) x \\<in> good_set", "by blast"], ["proof (state)\nthis:\n  \\<exists>m. (T ^^ m) x \\<in> good_set\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "define m where \"m = Inf {m. (T^^m) x \\<in> good_set}\""], ["proof (state)\nthis:\n  m = \\<Sqinter> {m. (T ^^ m) x \\<in> good_set}\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  m = \\<Sqinter> {m. (T ^^ m) x \\<in> good_set}", "have \"(T^^m) x \\<in> good_set\""], ["proof (prove)\nusing this:\n  m = \\<Sqinter> {m. (T ^^ m) x \\<in> good_set}\n\ngoal (1 subgoal):\n 1. (T ^^ m) x \\<in> good_set", "using ** Inf_nat_def1"], ["proof (prove)\nusing this:\n  m = \\<Sqinter> {m. (T ^^ m) x \\<in> good_set}\n  \\<exists>m. (T ^^ m) x \\<in> good_set\n  ?K \\<noteq> {} \\<Longrightarrow> \\<Sqinter> ?K \\<in> ?K\n\ngoal (1 subgoal):\n 1. (T ^^ m) x \\<in> good_set", "by (metis empty_iff mem_Collect_eq)"], ["proof (state)\nthis:\n  (T ^^ m) x \\<in> good_set\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "have \"n+1 \\<in> {m. (T^^m) x \\<in> good_set}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n + 1 \\<in> {m. (T ^^ m) x \\<in> good_set}", "using a"], ["proof (prove)\nusing this:\n  (T ^^ (n + 1)) x \\<in> good_set\n\ngoal (1 subgoal):\n 1. n + 1 \\<in> {m. (T ^^ m) x \\<in> good_set}", "by simp"], ["proof (state)\nthis:\n  n + 1 \\<in> {m. (T ^^ m) x \\<in> good_set}\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  n + 1 \\<in> {m. (T ^^ m) x \\<in> good_set}", "have \"m \\<le> n+1\""], ["proof (prove)\nusing this:\n  n + 1 \\<in> {m. (T ^^ m) x \\<in> good_set}\n\ngoal (1 subgoal):\n 1. m \\<le> n + 1", "using m_def"], ["proof (prove)\nusing this:\n  n + 1 \\<in> {m. (T ^^ m) x \\<in> good_set}\n  m = \\<Sqinter> {m. (T ^^ m) x \\<in> good_set}\n\ngoal (1 subgoal):\n 1. m \\<le> n + 1", "by (simp add: Inf_nat_def Least_le)"], ["proof (state)\nthis:\n  m \\<le> n + 1\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  m \\<le> n + 1", "obtain k where \"n+1 = m + k\""], ["proof (prove)\nusing this:\n  m \\<le> n + 1\n\ngoal (1 subgoal):\n 1. (\\<And>k. n + 1 = m + k \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using le_iff_add"], ["proof (prove)\nusing this:\n  m \\<le> n + 1\n  (?a \\<le> ?b) = (\\<exists>c. ?b = ?a + c)\n\ngoal (1 subgoal):\n 1. (\\<And>k. n + 1 = m + k \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  n + 1 = m + k\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "have \"g x = f((T^^m) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g x = f ((T ^^ m) x)", "unfolding g_def good_time_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if \\<exists>n. (T ^^ n) x \\<in> good_set\n     then f ((T ^^ \\<Sqinter> {n. (T ^^ n) x \\<in> good_set}) x) else y0) =\n    f ((T ^^ m) x)", "using ** m_def"], ["proof (prove)\nusing this:\n  \\<exists>m. (T ^^ m) x \\<in> good_set\n  m = \\<Sqinter> {m. (T ^^ m) x \\<in> good_set}\n\ngoal (1 subgoal):\n 1. (if \\<exists>n. (T ^^ n) x \\<in> good_set\n     then f ((T ^^ \\<Sqinter> {n. (T ^^ n) x \\<in> good_set}) x) else y0) =\n    f ((T ^^ m) x)", "by simp"], ["proof (state)\nthis:\n  g x = f ((T ^^ m) x)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "also"], ["proof (state)\nthis:\n  g x = f ((T ^^ m) x)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "have \"... = f((T^^k) ((T^^m) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ m) x) = f ((T ^^ k) ((T ^^ m) x))", "using \\<open>(T^^m) x \\<in> good_set\\<close> good_k"], ["proof (prove)\nusing this:\n  (T ^^ m) x \\<in> good_set\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  (T ^^ ?k4) ?x3 \\<in> good_set \\<and> f ((T ^^ ?k4) ?x3) = f ?x3\n\ngoal (1 subgoal):\n 1. f ((T ^^ m) x) = f ((T ^^ k) ((T ^^ m) x))", "by simp"], ["proof (state)\nthis:\n  f ((T ^^ m) x) = f ((T ^^ k) ((T ^^ m) x))\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "also"], ["proof (state)\nthis:\n  f ((T ^^ m) x) = f ((T ^^ k) ((T ^^ m) x))\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "have \"... = f((T^^(n+1))x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ k) ((T ^^ m) x)) = f ((T ^^ (n + 1)) x)", "using \\<open>n+1 = m + k\\<close>[symmetric] funpow_add"], ["proof (prove)\nusing this:\n  m + k = n + 1\n  ?f ^^ (?m + ?n) = ?f ^^ ?m \\<circ> ?f ^^ ?n\n\ngoal (1 subgoal):\n 1. f ((T ^^ k) ((T ^^ m) x)) = f ((T ^^ (n + 1)) x)", "by (metis add.commute comp_apply)"], ["proof (state)\nthis:\n  f ((T ^^ k) ((T ^^ m) x)) = f ((T ^^ (n + 1)) x)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "also"], ["proof (state)\nthis:\n  f ((T ^^ k) ((T ^^ m) x)) = f ((T ^^ (n + 1)) x)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "have \"... = f((T^^n) (T x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ (n + 1)) x) = f ((T ^^ n) (T x))", "using funpow_Suc_right"], ["proof (prove)\nusing this:\n  ?f ^^ Suc ?n = ?f ^^ ?n \\<circ> ?f\n\ngoal (1 subgoal):\n 1. f ((T ^^ (n + 1)) x) = f ((T ^^ n) (T x))", "by (metis Suc_eq_plus1 comp_apply)"], ["proof (state)\nthis:\n  f ((T ^^ (n + 1)) x) = f ((T ^^ n) (T x))\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "also"], ["proof (state)\nthis:\n  f ((T ^^ (n + 1)) x) = f ((T ^^ n) (T x))\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "have \"... = g(T x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ n) (T x)) = g (T x)", "unfolding g_def good_time_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ n) (T x)) =\n    (if \\<exists>n. (T ^^ n) (T x) \\<in> good_set\n     then f ((T ^^ \\<Sqinter> {n. (T ^^ n) (T x) \\<in> good_set}) (T x))\n     else y0)", "using * n_def"], ["proof (prove)\nusing this:\n  \\<exists>n. (T ^^ n) (T x) \\<in> good_set\n  n = \\<Sqinter> {n. (T ^^ n) (T x) \\<in> good_set}\n\ngoal (1 subgoal):\n 1. f ((T ^^ n) (T x)) =\n    (if \\<exists>n. (T ^^ n) (T x) \\<in> good_set\n     then f ((T ^^ \\<Sqinter> {n. (T ^^ n) (T x) \\<in> good_set}) (T x))\n     else y0)", "by simp"], ["proof (state)\nthis:\n  f ((T ^^ n) (T x)) = g (T x)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> g (T x) = g x\n 2. \\<not> ?P \\<Longrightarrow> g (T x) = g x", "finally"], ["proof (chain)\npicking this:\n  g x = g (T x)", "show \"g(T x) = g x\""], ["proof (prove)\nusing this:\n  g x = g (T x)\n\ngoal (1 subgoal):\n 1. g (T x) = g x", "by simp"], ["proof (state)\nthis:\n  g (T x) = g x\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "assume *: \"\\<not>(\\<exists>n. (T^^n) (T x) \\<in> good_set)\""], ["proof (state)\nthis:\n  \\<nexists>n. (T ^^ n) (T x) \\<in> good_set\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  \\<nexists>n. (T ^^ n) (T x) \\<in> good_set", "have \"g(T x) = y0\""], ["proof (prove)\nusing this:\n  \\<nexists>n. (T ^^ n) (T x) \\<in> good_set\n\ngoal (1 subgoal):\n 1. g (T x) = y0", "unfolding g_def"], ["proof (prove)\nusing this:\n  \\<nexists>n. (T ^^ n) (T x) \\<in> good_set\n\ngoal (1 subgoal):\n 1. (if \\<exists>n. (T ^^ n) (T x) \\<in> good_set\n     then f ((T ^^ good_time (T x)) (T x)) else y0) =\n    y0", "by simp"], ["proof (state)\nthis:\n  g (T x) = y0\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "have **: \"\\<not>(\\<exists>n. (T^^(Suc n)) x \\<in> good_set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ Suc n) x \\<in> good_set", "using funpow_Suc_right *"], ["proof (prove)\nusing this:\n  ?f ^^ Suc ?n = ?f ^^ ?n \\<circ> ?f\n  \\<nexists>n. (T ^^ n) (T x) \\<in> good_set\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ Suc n) x \\<in> good_set", "by (metis comp_apply)"], ["proof (state)\nthis:\n  \\<nexists>n. (T ^^ Suc n) x \\<in> good_set\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "have \"T x \\<notin> good_set\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T x \\<notin> good_set", "using good_k *"], ["proof (prove)\nusing this:\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  (T ^^ ?k4) ?x3 \\<in> good_set \\<and> f ((T ^^ ?k4) ?x3) = f ?x3\n  \\<nexists>n. (T ^^ n) (T x) \\<in> good_set\n\ngoal (1 subgoal):\n 1. T x \\<notin> good_set", "by blast"], ["proof (state)\nthis:\n  T x \\<notin> good_set\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  T x \\<notin> good_set", "have \"x \\<notin> good_set\""], ["proof (prove)\nusing this:\n  T x \\<notin> good_set\n\ngoal (1 subgoal):\n 1. x \\<notin> good_set", "using good_1"], ["proof (prove)\nusing this:\n  T x \\<notin> good_set\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  T ?x3 \\<in> good_set \\<and> f (T ?x3) = f ?x3\n\ngoal (1 subgoal):\n 1. x \\<notin> good_set", "by auto"], ["proof (state)\nthis:\n  x \\<notin> good_set\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  x \\<notin> good_set", "have \"\\<not>(\\<exists>n. (T^^n) x \\<in> good_set)\""], ["proof (prove)\nusing this:\n  x \\<notin> good_set\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) x \\<in> good_set", "using **"], ["proof (prove)\nusing this:\n  x \\<notin> good_set\n  \\<nexists>n. (T ^^ Suc n) x \\<in> good_set\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) x \\<in> good_set", "using good_1"], ["proof (prove)\nusing this:\n  x \\<notin> good_set\n  \\<nexists>n. (T ^^ Suc n) x \\<in> good_set\n  ?x3 \\<in> good_set \\<Longrightarrow>\n  T ?x3 \\<in> good_set \\<and> f (T ?x3) = f ?x3\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) x \\<in> good_set", "by fastforce"], ["proof (state)\nthis:\n  \\<nexists>n. (T ^^ n) x \\<in> good_set\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  \\<nexists>n. (T ^^ n) x \\<in> good_set", "have \"g x = y0\""], ["proof (prove)\nusing this:\n  \\<nexists>n. (T ^^ n) x \\<in> good_set\n\ngoal (1 subgoal):\n 1. g x = y0", "unfolding g_def"], ["proof (prove)\nusing this:\n  \\<nexists>n. (T ^^ n) x \\<in> good_set\n\ngoal (1 subgoal):\n 1. (if \\<exists>n. (T ^^ n) x \\<in> good_set then f ((T ^^ good_time x) x)\n     else y0) =\n    y0", "by simp"], ["proof (state)\nthis:\n  g x = y0\n\ngoal (1 subgoal):\n 1. \\<nexists>n. (T ^^ n) (T x) \\<in> good_set \\<Longrightarrow>\n    g (T x) = g x", "then"], ["proof (chain)\npicking this:\n  g x = y0", "show \"g(T x) = g x\""], ["proof (prove)\nusing this:\n  g x = y0\n\ngoal (1 subgoal):\n 1. g (T x) = g x", "using \\<open>g(T x) = y0\\<close>"], ["proof (prove)\nusing this:\n  g x = y0\n  g (T x) = y0\n\ngoal (1 subgoal):\n 1. g (T x) = g x", "by simp"], ["proof (state)\nthis:\n  g (T x) = g x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x3 \\<in> space M \\<Longrightarrow> g (T ?x3) = g ?x3\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  ?x3 \\<in> space M \\<Longrightarrow> g (T ?x3) = g ?x3", "have \"g \\<in> borel_measurable Invariants\""], ["proof (prove)\nusing this:\n  ?x3 \\<in> space M \\<Longrightarrow> g (T ?x3) = g ?x3\n\ngoal (1 subgoal):\n 1. g \\<in> borel_measurable Invariants", "by (rule Invariants_func_charac[OF \\<open>g \\<in> borel_measurable M\\<close>])"], ["proof (state)\nthis:\n  g \\<in> borel_measurable Invariants\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x \\<Longrightarrow>\n    \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "then"], ["proof (chain)\npicking this:\n  g \\<in> borel_measurable Invariants", "show \"\\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x\""], ["proof (prove)\nusing this:\n  g \\<in> borel_measurable Invariants\n\ngoal (1 subgoal):\n 1. \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "using \\<open>AE x in M. f x = g x\\<close>"], ["proof (prove)\nusing this:\n  g \\<in> borel_measurable Invariants\n  AE x in M. f x = g x\n\ngoal (1 subgoal):\n 1. \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x", "by blast"], ["proof (state)\nthis:\n  \\<exists>g\\<in>borel_measurable Invariants. AE x in M. f x = g x\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>In a conservative setting, it suffices to have an almost everywhere inequality to get\nan almost everywhere equality, as the set where there is strict inequality has $0$ measure\nas its iterates are disjoint, by conservativity.\\<close>"], ["", "proposition (in conservative) AE_decreasing_then_invariant:\n  fixes f::\"_ \\<Rightarrow> 'b::{linorder_topology, second_countable_topology}\"\n  assumes \"AE x in M. f(T x) \\<le> f x\"\n    and [measurable]: \"f \\<in> borel_measurable M\"\n  shows \"AE x in M. f(T x) = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "obtain D::\"'b set\" where D: \"countable D\" \"(\\<forall>x y. x < y \\<longrightarrow> (\\<exists>d \\<in> D. x \\<le> d \\<and> d < y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>D.\n        \\<lbrakk>countable D;\n         \\<forall>x y.\n            x < y \\<longrightarrow>\n            (\\<exists>d\\<in>D. x \\<le> d \\<and> d < y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using countable_separating_set_linorder2"], ["proof (prove)\nusing this:\n  \\<exists>B.\n     countable B \\<and>\n     (\\<forall>x y.\n         x < y \\<longrightarrow> (\\<exists>b\\<in>B. x \\<le> b \\<and> b < y))\n\ngoal (1 subgoal):\n 1. (\\<And>D.\n        \\<lbrakk>countable D;\n         \\<forall>x y.\n            x < y \\<longrightarrow>\n            (\\<exists>d\\<in>D. x \\<le> d \\<and> d < y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  countable D\n  \\<forall>x y.\n     x < y \\<longrightarrow> (\\<exists>d\\<in>D. x \\<le> d \\<and> d < y)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "define A where \"A = {x \\<in> space M. f(T x) \\<le> f x}\""], ["proof (state)\nthis:\n  A = {x \\<in> space M. f (T x) \\<le> f x}\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  A = {x \\<in> space M. f (T x) \\<le> f x}", "have [measurable]: \"A \\<in> sets M\""], ["proof (prove)\nusing this:\n  A = {x \\<in> space M. f (T x) \\<le> f x}\n\ngoal (1 subgoal):\n 1. A \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "define B where \"B = {x \\<in> space M. \\<forall>n. f((T^^(n+1)) x) \\<le> f((T^^n)x)}\""], ["proof (state)\nthis:\n  B =\n  {x \\<in> space M. \\<forall>n. f ((T ^^ (n + 1)) x) \\<le> f ((T ^^ n) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  B =\n  {x \\<in> space M. \\<forall>n. f ((T ^^ (n + 1)) x) \\<le> f ((T ^^ n) x)}", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\nusing this:\n  B =\n  {x \\<in> space M. \\<forall>n. f ((T ^^ (n + 1)) x) \\<le> f ((T ^^ n) x)}\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"space M - A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - A \\<in> null_sets M", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - {x \\<in> space M. f (T x) \\<le> f x} \\<in> null_sets M", "using assms"], ["proof (prove)\nusing this:\n  AE x in M. f (T x) \\<le> f x\n  f \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. space M - {x \\<in> space M. f (T x) \\<le> f x} \\<in> null_sets M", "by (simp add: assms(1) AE_iff_null_sets)"], ["proof (state)\nthis:\n  space M - A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  space M - A \\<in> null_sets M", "have \"(\\<Union>n. (T^^n)--`(space M - A)) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  space M - A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M", "by (metis null_sets_UN T_quasi_preserves_null2(2))"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "moreover"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"space M - B = (\\<Union>n. (T^^n)--`(space M - A))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - B = (\\<Union>n. (T ^^ n) --` (space M - A))", "unfolding B_def A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. space M -\n    {x \\<in> space M.\n     \\<forall>n. f ((T ^^ (n + 1)) x) \\<le> f ((T ^^ n) x)} =\n    (\\<Union>n.\n        (T ^^ n) --` (space M - {x \\<in> space M. f (T x) \\<le> f x}))", "by auto"], ["proof (state)\nthis:\n  space M - B = (\\<Union>n. (T ^^ n) --` (space M - A))\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M\n  space M - B = (\\<Union>n. (T ^^ n) --` (space M - A))", "have \"space M - B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M\n  space M - B = (\\<Union>n. (T ^^ n) --` (space M - A))\n\ngoal (1 subgoal):\n 1. space M - B \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have *: \"B = (\\<Inter>n. (T^^n)--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B = (\\<Inter>n. (T ^^ n) --` A)", "unfolding B_def A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>n. f ((T ^^ (n + 1)) x) \\<le> f ((T ^^ n) x)} =\n    (\\<Inter>n. (T ^^ n) --` {x \\<in> space M. f (T x) \\<le> f x})", "by auto"], ["proof (state)\nthis:\n  B = (\\<Inter>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  B = (\\<Inter>n. (T ^^ n) --` A)", "have \"T--`B = (\\<Inter>n. T--` (T^^n)--`A)\""], ["proof (prove)\nusing this:\n  B = (\\<Inter>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. T --` B = (\\<Inter>n. T --` (T ^^ n) --` A)", "by auto"], ["proof (state)\nthis:\n  T --` B = (\\<Inter>n. T --` (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "also"], ["proof (state)\nthis:\n  T --` B = (\\<Inter>n. T --` (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"... = (\\<Inter>n. (T^^(n+1))--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Inter>n. T --` (T ^^ n) --` A) = (\\<Inter>n. (T ^^ (n + 1)) --` A)", "using T_vrestr_composed(2)[OF \\<open>A \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  T --` (T ^^ ?m) --` A = (T ^^ (?m + 1)) --` A\n\ngoal (1 subgoal):\n 1. (\\<Inter>n. T --` (T ^^ n) --` A) = (\\<Inter>n. (T ^^ (n + 1)) --` A)", "by simp"], ["proof (state)\nthis:\n  (\\<Inter>n. T --` (T ^^ n) --` A) = (\\<Inter>n. (T ^^ (n + 1)) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "also"], ["proof (state)\nthis:\n  (\\<Inter>n. T --` (T ^^ n) --` A) = (\\<Inter>n. (T ^^ (n + 1)) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"... \\<supseteq> (\\<Inter>n. (T^^n)--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Inter>n. (T ^^ n) --` A)\n    \\<subseteq> (\\<Inter>n. (T ^^ (n + 1)) --` A)", "by blast"], ["proof (state)\nthis:\n  (\\<Inter>n. (T ^^ n) --` A) \\<subseteq> (\\<Inter>n. (T ^^ (n + 1)) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "finally"], ["proof (chain)\npicking this:\n  (\\<Inter>n. (T ^^ n) --` A) \\<subseteq> T --` B", "have B1: \"B \\<subseteq> T--`B\""], ["proof (prove)\nusing this:\n  (\\<Inter>n. (T ^^ n) --` A) \\<subseteq> T --` B\n\ngoal (1 subgoal):\n 1. B \\<subseteq> T --` B", "using *"], ["proof (prove)\nusing this:\n  (\\<Inter>n. (T ^^ n) --` A) \\<subseteq> T --` B\n  B = (\\<Inter>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. B \\<subseteq> T --` B", "by simp"], ["proof (state)\nthis:\n  B \\<subseteq> T --` B\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"B \\<subseteq> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<subseteq> A", "using * T_vrestr_0[OF \\<open>A \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  B = (\\<Inter>n. (T ^^ n) --` A)\n  (T ^^ 0) --` A = A\n  id --` A = A\n\ngoal (1 subgoal):\n 1. B \\<subseteq> A", "by blast"], ["proof (state)\nthis:\n  B \\<subseteq> A\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  B \\<subseteq> A", "have B2: \"\\<And>x. x \\<in> B \\<Longrightarrow> f(T x) \\<le> f x\""], ["proof (prove)\nusing this:\n  B \\<subseteq> A\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> B \\<Longrightarrow> f (T x) \\<le> f x", "unfolding A_def"], ["proof (prove)\nusing this:\n  B \\<subseteq> {x \\<in> space M. f (T x) \\<le> f x}\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> B \\<Longrightarrow> f (T x) \\<le> f x", "by auto"], ["proof (state)\nthis:\n  ?x3 \\<in> B \\<Longrightarrow> f (T ?x3) \\<le> f ?x3\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "define C where \"C = (\\<lambda>t. {x \\<in> B. f x \\<le> t})\""], ["proof (state)\nthis:\n  C = (\\<lambda>t. {x \\<in> B. f x \\<le> t})\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "{"], ["proof (state)\nthis:\n  C = (\\<lambda>t. {x \\<in> B. f x \\<le> t})\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"C t = B \\<inter> f-`{..t} \\<inter> space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C t = B \\<inter> f -` {..t} \\<inter> space M", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> B. f x \\<le> t} = B \\<inter> f -` {..t} \\<inter> space M", "using sets.sets_into_space[OF \\<open>B \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  B \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. {x \\<in> B. f x \\<le> t} = B \\<inter> f -` {..t} \\<inter> space M", "by auto"], ["proof (state)\nthis:\n  C t = B \\<inter> f -` {..t} \\<inter> space M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  C t = B \\<inter> f -` {..t} \\<inter> space M", "have [measurable]: \"C t \\<in> sets M\""], ["proof (prove)\nusing this:\n  C t = B \\<inter> f -` {..t} \\<inter> space M\n\ngoal (1 subgoal):\n 1. C t \\<in> sets M", "using assms(2)"], ["proof (prove)\nusing this:\n  C t = B \\<inter> f -` {..t} \\<inter> space M\n  f \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. C t \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  C t \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"C t \\<subseteq> T--`(C t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C t \\<subseteq> T --` C t", "using B1"], ["proof (prove)\nusing this:\n  B \\<subseteq> T --` B\n\ngoal (1 subgoal):\n 1. C t \\<subseteq> T --` C t", "unfolding C_def vimage_restr_def"], ["proof (prove)\nusing this:\n  B \\<subseteq> T -` (B \\<inter> space M) \\<inter> space M\n\ngoal (1 subgoal):\n 1. {x \\<in> B. f x \\<le> t}\n    \\<subseteq> T -` ({x \\<in> B. f x \\<le> t} \\<inter> space M) \\<inter>\n                space M", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>B \\<subseteq> T -` B; B \\<subseteq> space M; x \\<in> B;\n        f x \\<le> t\\<rbrakk>\n       \\<Longrightarrow> f (T x) \\<le> t", "using B2 order_trans"], ["proof (prove)\nusing this:\n  ?x3 \\<in> B \\<Longrightarrow> f (T ?x3) \\<le> f ?x3\n  \\<lbrakk>?x \\<le> ?y; ?y \\<le> ?z\\<rbrakk> \\<Longrightarrow> ?x \\<le> ?z\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>B \\<subseteq> T -` B; B \\<subseteq> space M; x \\<in> B;\n        f x \\<le> t\\<rbrakk>\n       \\<Longrightarrow> f (T x) \\<le> t", "by blast"], ["proof (state)\nthis:\n  C t \\<subseteq> T --` C t\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  C t \\<subseteq> T --` C t", "have \"T--`(C t) - C t \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  C t \\<subseteq> T --` C t\n\ngoal (1 subgoal):\n 1. T --` C t - C t \\<in> null_sets M", "by (metis Diff_mono Un_absorb1 preimage_includes_then_almost_invariant[OF \\<open>C t \\<in> sets M\\<close>])"], ["proof (state)\nthis:\n  T --` C t - C t \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "}"], ["proof (state)\nthis:\n  T --` C ?t5 - C ?t5 \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  T --` C ?t5 - C ?t5 \\<in> null_sets M", "have \"(\\<Union>d\\<in>D. T--`(C d) - C d) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` C ?t5 - C ?t5 \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M", "using \\<open>countable D\\<close>"], ["proof (prove)\nusing this:\n  T --` C ?t5 - C ?t5 \\<in> null_sets M\n  countable D\n\ngoal (1 subgoal):\n 1. (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M", "by (simp add: null_sets_UN')"], ["proof (state)\nthis:\n  (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M", "have \"(space M - B) \\<union> (\\<Union>d\\<in>D. T--`(C d) - C d) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n    \\<in> null_sets M", "using \\<open>space M - B \\<in> null_sets M\\<close>"], ["proof (prove)\nusing this:\n  (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n  space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n    \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M", "have \"AE x in M. x \\<notin> (space M - B) \\<union> (\\<Union>d\\<in>D. T--`(C d) - C d)\""], ["proof (prove)\nusing this:\n  space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> space M - B \\<union>\n                          (\\<Union>d\\<in>D. T --` C d - C d)", "using AE_not_in"], ["proof (prove)\nusing this:\n  space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n  ?N \\<in> null_sets ?M \\<Longrightarrow> AE x in ?M. x \\<notin> ?N\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> space M - B \\<union>\n                          (\\<Union>d\\<in>D. T --` C d - C d)", "by blast"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "moreover"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "{"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "assume x: \"x \\<in> space M\" \"x \\<notin> (space M - B) \\<union> (\\<Union>d\\<in>D. T--`(C d) - C d)\""], ["proof (state)\nthis:\n  x \\<in> space M\n  x \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  x \\<in> space M\n  x \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)", "have \"x \\<in> B\""], ["proof (prove)\nusing this:\n  x \\<in> space M\n  x \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. x \\<in> B", "by simp"], ["proof (state)\nthis:\n  x \\<in> B\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  x \\<in> B", "have \"T x \\<in> B\""], ["proof (prove)\nusing this:\n  x \\<in> B\n\ngoal (1 subgoal):\n 1. T x \\<in> B", "using B1"], ["proof (prove)\nusing this:\n  x \\<in> B\n  B \\<subseteq> T --` B\n\ngoal (1 subgoal):\n 1. T x \\<in> B", "by auto"], ["proof (state)\nthis:\n  T x \\<in> B\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"f(T x) = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (T x) = f x", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "assume \"f(T x) \\<noteq> f x\""], ["proof (state)\nthis:\n  f (T x) \\<noteq> f x\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  f (T x) \\<noteq> f x", "have \"f(T x) < f x\""], ["proof (prove)\nusing this:\n  f (T x) \\<noteq> f x\n\ngoal (1 subgoal):\n 1. f (T x) < f x", "using B2[OF \\<open>x \\<in> B\\<close>]"], ["proof (prove)\nusing this:\n  f (T x) \\<noteq> f x\n  f (T x) \\<le> f x\n\ngoal (1 subgoal):\n 1. f (T x) < f x", "by simp"], ["proof (state)\nthis:\n  f (T x) < f x\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  f (T x) < f x", "obtain d where d: \"d \\<in> D\" \"f(T x) \\<le> d \\<and> d < f x\""], ["proof (prove)\nusing this:\n  f (T x) < f x\n\ngoal (1 subgoal):\n 1. (\\<And>d.\n        \\<lbrakk>d \\<in> D; f (T x) \\<le> d \\<and> d < f x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using D"], ["proof (prove)\nusing this:\n  f (T x) < f x\n  countable D\n  \\<forall>x y.\n     x < y \\<longrightarrow> (\\<exists>d\\<in>D. x \\<le> d \\<and> d < y)\n\ngoal (1 subgoal):\n 1. (\\<And>d.\n        \\<lbrakk>d \\<in> D; f (T x) \\<le> d \\<and> d < f x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  d \\<in> D\n  f (T x) \\<le> d \\<and> d < f x\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  d \\<in> D\n  f (T x) \\<le> d \\<and> d < f x", "have \"T x \\<in> C d\""], ["proof (prove)\nusing this:\n  d \\<in> D\n  f (T x) \\<le> d \\<and> d < f x\n\ngoal (1 subgoal):\n 1. T x \\<in> C d", "using \\<open>T x \\<in> B\\<close>"], ["proof (prove)\nusing this:\n  d \\<in> D\n  f (T x) \\<le> d \\<and> d < f x\n  T x \\<in> B\n\ngoal (1 subgoal):\n 1. T x \\<in> C d", "unfolding C_def"], ["proof (prove)\nusing this:\n  d \\<in> D\n  f (T x) \\<le> d \\<and> d < f x\n  T x \\<in> B\n\ngoal (1 subgoal):\n 1. T x \\<in> {x \\<in> B. f x \\<le> d}", "by simp"], ["proof (state)\nthis:\n  T x \\<in> C d\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  T x \\<in> C d", "have \"x \\<in> T--`(C d)\""], ["proof (prove)\nusing this:\n  T x \\<in> C d\n\ngoal (1 subgoal):\n 1. x \\<in> T --` C d", "using \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  T x \\<in> C d\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. x \\<in> T --` C d", "by simp"], ["proof (state)\nthis:\n  x \\<in> T --` C d\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  x \\<in> T --` C d", "have \"x \\<in> C d\""], ["proof (prove)\nusing this:\n  x \\<in> T --` C d\n\ngoal (1 subgoal):\n 1. x \\<in> C d", "using x \\<open>d \\<in> D\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> T --` C d\n  x \\<in> space M\n  x \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n  d \\<in> D\n\ngoal (1 subgoal):\n 1. x \\<in> C d", "by simp"], ["proof (state)\nthis:\n  x \\<in> C d\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  x \\<in> C d", "have \"f x \\<le> d\""], ["proof (prove)\nusing this:\n  x \\<in> C d\n\ngoal (1 subgoal):\n 1. f x \\<le> d", "unfolding C_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> B. f x \\<le> d}\n\ngoal (1 subgoal):\n 1. f x \\<le> d", "by simp"], ["proof (state)\nthis:\n  f x \\<le> d\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  f x \\<le> d", "show False"], ["proof (prove)\nusing this:\n  f x \\<le> d\n\ngoal (1 subgoal):\n 1. False", "using d"], ["proof (prove)\nusing this:\n  f x \\<le> d\n  d \\<in> D\n  f (T x) \\<le> d \\<and> d < f x\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f (T x) = f x\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?x5 \\<in> space M;\n   ?x5\n   \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\\<rbrakk>\n  \\<Longrightarrow> f (T ?x5) = f ?x5\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n  \\<lbrakk>?x5 \\<in> space M;\n   ?x5\n   \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\\<rbrakk>\n  \\<Longrightarrow> f (T ?x5) = f ?x5", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n  \\<lbrakk>?x5 \\<in> space M;\n   ?x5\n   \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\\<rbrakk>\n  \\<Longrightarrow> f (T ?x5) = f ?x5\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. f (T x) = f x\n\ngoal:\nNo subgoals!", "qed"], ["", "proposition (in conservative) AE_increasing_then_invariant:\n  fixes f::\"_ \\<Rightarrow> 'b::{linorder_topology, second_countable_topology}\"\n  assumes \"AE x in M. f(T x) \\<ge> f x\"\n    and [measurable]: \"f \\<in> borel_measurable M\"\n  shows \"AE x in M. f(T x) = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "obtain D::\"'b set\" where D: \"countable D\" \"(\\<forall>x y. x < y \\<longrightarrow> (\\<exists>d \\<in> D. x < d \\<and> d \\<le> y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>D.\n        \\<lbrakk>countable D;\n         \\<forall>x y.\n            x < y \\<longrightarrow>\n            (\\<exists>d\\<in>D. x < d \\<and> d \\<le> y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using countable_separating_set_linorder1"], ["proof (prove)\nusing this:\n  \\<exists>B.\n     countable B \\<and>\n     (\\<forall>x y.\n         x < y \\<longrightarrow> (\\<exists>b\\<in>B. x < b \\<and> b \\<le> y))\n\ngoal (1 subgoal):\n 1. (\\<And>D.\n        \\<lbrakk>countable D;\n         \\<forall>x y.\n            x < y \\<longrightarrow>\n            (\\<exists>d\\<in>D. x < d \\<and> d \\<le> y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  countable D\n  \\<forall>x y.\n     x < y \\<longrightarrow> (\\<exists>d\\<in>D. x < d \\<and> d \\<le> y)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "define A where \"A = {x \\<in> space M. f(T x) \\<ge> f x}\""], ["proof (state)\nthis:\n  A = {x \\<in> space M. f x \\<le> f (T x)}\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  A = {x \\<in> space M. f x \\<le> f (T x)}", "have [measurable]: \"A \\<in> sets M\""], ["proof (prove)\nusing this:\n  A = {x \\<in> space M. f x \\<le> f (T x)}\n\ngoal (1 subgoal):\n 1. A \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "define B where \"B = {x \\<in> space M. \\<forall>n. f((T^^(n+1)) x) \\<ge> f((T^^n)x)}\""], ["proof (state)\nthis:\n  B =\n  {x \\<in> space M. \\<forall>n. f ((T ^^ n) x) \\<le> f ((T ^^ (n + 1)) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  B =\n  {x \\<in> space M. \\<forall>n. f ((T ^^ n) x) \\<le> f ((T ^^ (n + 1)) x)}", "have [measurable]: \"B \\<in> sets M\""], ["proof (prove)\nusing this:\n  B =\n  {x \\<in> space M. \\<forall>n. f ((T ^^ n) x) \\<le> f ((T ^^ (n + 1)) x)}\n\ngoal (1 subgoal):\n 1. B \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  B \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"space M - A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - A \\<in> null_sets M", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - {x \\<in> space M. f x \\<le> f (T x)} \\<in> null_sets M", "using assms"], ["proof (prove)\nusing this:\n  AE x in M. f x \\<le> f (T x)\n  f \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. space M - {x \\<in> space M. f x \\<le> f (T x)} \\<in> null_sets M", "by (simp add: assms(1) AE_iff_null_sets)"], ["proof (state)\nthis:\n  space M - A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  space M - A \\<in> null_sets M", "have \"(\\<Union>n. (T^^n)--`(space M - A)) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  space M - A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M", "by (metis null_sets_UN T_quasi_preserves_null2(2))"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "moreover"], ["proof (state)\nthis:\n  (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"space M - B = (\\<Union>n. (T^^n)--`(space M - A))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - B = (\\<Union>n. (T ^^ n) --` (space M - A))", "unfolding B_def A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. space M -\n    {x \\<in> space M.\n     \\<forall>n. f ((T ^^ n) x) \\<le> f ((T ^^ (n + 1)) x)} =\n    (\\<Union>n.\n        (T ^^ n) --` (space M - {x \\<in> space M. f x \\<le> f (T x)}))", "by auto"], ["proof (state)\nthis:\n  space M - B = (\\<Union>n. (T ^^ n) --` (space M - A))\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M\n  space M - B = (\\<Union>n. (T ^^ n) --` (space M - A))", "have \"space M - B \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  (\\<Union>n. (T ^^ n) --` (space M - A)) \\<in> null_sets M\n  space M - B = (\\<Union>n. (T ^^ n) --` (space M - A))\n\ngoal (1 subgoal):\n 1. space M - B \\<in> null_sets M", "by simp"], ["proof (state)\nthis:\n  space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have *: \"B = (\\<Inter>n. (T^^n)--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B = (\\<Inter>n. (T ^^ n) --` A)", "unfolding B_def A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>n. f ((T ^^ n) x) \\<le> f ((T ^^ (n + 1)) x)} =\n    (\\<Inter>n. (T ^^ n) --` {x \\<in> space M. f x \\<le> f (T x)})", "by auto"], ["proof (state)\nthis:\n  B = (\\<Inter>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  B = (\\<Inter>n. (T ^^ n) --` A)", "have \"T--`B = (\\<Inter>n. T--` (T^^n)--`A)\""], ["proof (prove)\nusing this:\n  B = (\\<Inter>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. T --` B = (\\<Inter>n. T --` (T ^^ n) --` A)", "by auto"], ["proof (state)\nthis:\n  T --` B = (\\<Inter>n. T --` (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "also"], ["proof (state)\nthis:\n  T --` B = (\\<Inter>n. T --` (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"... = (\\<Inter>n. (T^^(n+1))--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Inter>n. T --` (T ^^ n) --` A) = (\\<Inter>n. (T ^^ (n + 1)) --` A)", "using T_vrestr_composed(2)[OF \\<open>A \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  T --` (T ^^ ?m) --` A = (T ^^ (?m + 1)) --` A\n\ngoal (1 subgoal):\n 1. (\\<Inter>n. T --` (T ^^ n) --` A) = (\\<Inter>n. (T ^^ (n + 1)) --` A)", "by simp"], ["proof (state)\nthis:\n  (\\<Inter>n. T --` (T ^^ n) --` A) = (\\<Inter>n. (T ^^ (n + 1)) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "also"], ["proof (state)\nthis:\n  (\\<Inter>n. T --` (T ^^ n) --` A) = (\\<Inter>n. (T ^^ (n + 1)) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"... \\<supseteq> (\\<Inter>n. (T^^n)--`A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Inter>n. (T ^^ n) --` A)\n    \\<subseteq> (\\<Inter>n. (T ^^ (n + 1)) --` A)", "by blast"], ["proof (state)\nthis:\n  (\\<Inter>n. (T ^^ n) --` A) \\<subseteq> (\\<Inter>n. (T ^^ (n + 1)) --` A)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "finally"], ["proof (chain)\npicking this:\n  (\\<Inter>n. (T ^^ n) --` A) \\<subseteq> T --` B", "have B1: \"B \\<subseteq> T--`B\""], ["proof (prove)\nusing this:\n  (\\<Inter>n. (T ^^ n) --` A) \\<subseteq> T --` B\n\ngoal (1 subgoal):\n 1. B \\<subseteq> T --` B", "using *"], ["proof (prove)\nusing this:\n  (\\<Inter>n. (T ^^ n) --` A) \\<subseteq> T --` B\n  B = (\\<Inter>n. (T ^^ n) --` A)\n\ngoal (1 subgoal):\n 1. B \\<subseteq> T --` B", "by simp"], ["proof (state)\nthis:\n  B \\<subseteq> T --` B\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"B \\<subseteq> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<subseteq> A", "using * T_vrestr_0[OF \\<open>A \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  B = (\\<Inter>n. (T ^^ n) --` A)\n  (T ^^ 0) --` A = A\n  id --` A = A\n\ngoal (1 subgoal):\n 1. B \\<subseteq> A", "by blast"], ["proof (state)\nthis:\n  B \\<subseteq> A\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  B \\<subseteq> A", "have B2: \"\\<And>x. x \\<in> B \\<Longrightarrow> f(T x) \\<ge> f x\""], ["proof (prove)\nusing this:\n  B \\<subseteq> A\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> B \\<Longrightarrow> f x \\<le> f (T x)", "unfolding A_def"], ["proof (prove)\nusing this:\n  B \\<subseteq> {x \\<in> space M. f x \\<le> f (T x)}\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> B \\<Longrightarrow> f x \\<le> f (T x)", "by auto"], ["proof (state)\nthis:\n  ?x3 \\<in> B \\<Longrightarrow> f ?x3 \\<le> f (T ?x3)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "define C where \"C = (\\<lambda>t. {x \\<in> B. f x \\<ge> t})\""], ["proof (state)\nthis:\n  C = (\\<lambda>t. {x \\<in> B. t \\<le> f x})\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "{"], ["proof (state)\nthis:\n  C = (\\<lambda>t. {x \\<in> B. t \\<le> f x})\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"C t = B \\<inter> f-`{t..} \\<inter> space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C t = B \\<inter> f -` {t..} \\<inter> space M", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> B. t \\<le> f x} = B \\<inter> f -` {t..} \\<inter> space M", "using sets.sets_into_space[OF \\<open>B \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  B \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. {x \\<in> B. t \\<le> f x} = B \\<inter> f -` {t..} \\<inter> space M", "by auto"], ["proof (state)\nthis:\n  C t = B \\<inter> f -` {t..} \\<inter> space M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  C t = B \\<inter> f -` {t..} \\<inter> space M", "have [measurable]: \"C t \\<in> sets M\""], ["proof (prove)\nusing this:\n  C t = B \\<inter> f -` {t..} \\<inter> space M\n\ngoal (1 subgoal):\n 1. C t \\<in> sets M", "using assms(2)"], ["proof (prove)\nusing this:\n  C t = B \\<inter> f -` {t..} \\<inter> space M\n  f \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. C t \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  C t \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"C t \\<subseteq> T--`(C t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C t \\<subseteq> T --` C t", "using B1"], ["proof (prove)\nusing this:\n  B \\<subseteq> T --` B\n\ngoal (1 subgoal):\n 1. C t \\<subseteq> T --` C t", "unfolding C_def vimage_restr_def"], ["proof (prove)\nusing this:\n  B \\<subseteq> T -` (B \\<inter> space M) \\<inter> space M\n\ngoal (1 subgoal):\n 1. {x \\<in> B. t \\<le> f x}\n    \\<subseteq> T -` ({x \\<in> B. t \\<le> f x} \\<inter> space M) \\<inter>\n                space M", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>B \\<subseteq> T -` B; B \\<subseteq> space M; x \\<in> B;\n        t \\<le> f x\\<rbrakk>\n       \\<Longrightarrow> t \\<le> f (T x)", "using B2 order_trans"], ["proof (prove)\nusing this:\n  ?x3 \\<in> B \\<Longrightarrow> f ?x3 \\<le> f (T ?x3)\n  \\<lbrakk>?x \\<le> ?y; ?y \\<le> ?z\\<rbrakk> \\<Longrightarrow> ?x \\<le> ?z\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>B \\<subseteq> T -` B; B \\<subseteq> space M; x \\<in> B;\n        t \\<le> f x\\<rbrakk>\n       \\<Longrightarrow> t \\<le> f (T x)", "by blast"], ["proof (state)\nthis:\n  C t \\<subseteq> T --` C t\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  C t \\<subseteq> T --` C t", "have \"T--`(C t) - C t \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  C t \\<subseteq> T --` C t\n\ngoal (1 subgoal):\n 1. T --` C t - C t \\<in> null_sets M", "by (metis Diff_mono Un_absorb1 preimage_includes_then_almost_invariant[OF \\<open>C t \\<in> sets M\\<close>])"], ["proof (state)\nthis:\n  T --` C t - C t \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "}"], ["proof (state)\nthis:\n  T --` C ?t5 - C ?t5 \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  T --` C ?t5 - C ?t5 \\<in> null_sets M", "have \"(\\<Union>d\\<in>D. T--`(C d) - C d) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  T --` C ?t5 - C ?t5 \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M", "using \\<open>countable D\\<close>"], ["proof (prove)\nusing this:\n  T --` C ?t5 - C ?t5 \\<in> null_sets M\n  countable D\n\ngoal (1 subgoal):\n 1. (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M", "by (simp add: null_sets_UN')"], ["proof (state)\nthis:\n  (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M", "have \"(space M - B) \\<union> (\\<Union>d\\<in>D. T--`(C d) - C d) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n    \\<in> null_sets M", "using \\<open>space M - B \\<in> null_sets M\\<close>"], ["proof (prove)\nusing this:\n  (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n  space M - B \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n    \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M", "have \"AE x in M. x \\<notin> (space M - B) \\<union> (\\<Union>d\\<in>D. T--`(C d) - C d)\""], ["proof (prove)\nusing this:\n  space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> space M - B \\<union>\n                          (\\<Union>d\\<in>D. T --` C d - C d)", "using AE_not_in"], ["proof (prove)\nusing this:\n  space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d) \\<in> null_sets M\n  ?N \\<in> null_sets ?M \\<Longrightarrow> AE x in ?M. x \\<notin> ?N\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> space M - B \\<union>\n                          (\\<Union>d\\<in>D. T --` C d - C d)", "by blast"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "moreover"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "{"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "assume x: \"x \\<in> space M\" \"x \\<notin> (space M - B) \\<union> (\\<Union>d\\<in>D. T--`(C d) - C d)\""], ["proof (state)\nthis:\n  x \\<in> space M\n  x \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  x \\<in> space M\n  x \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)", "have \"x \\<in> B\""], ["proof (prove)\nusing this:\n  x \\<in> space M\n  x \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n\ngoal (1 subgoal):\n 1. x \\<in> B", "by simp"], ["proof (state)\nthis:\n  x \\<in> B\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "then"], ["proof (chain)\npicking this:\n  x \\<in> B", "have \"T x \\<in> B\""], ["proof (prove)\nusing this:\n  x \\<in> B\n\ngoal (1 subgoal):\n 1. T x \\<in> B", "using B1"], ["proof (prove)\nusing this:\n  x \\<in> B\n  B \\<subseteq> T --` B\n\ngoal (1 subgoal):\n 1. T x \\<in> B", "by auto"], ["proof (state)\nthis:\n  T x \\<in> B\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "have \"f(T x) = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (T x) = f x", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "assume \"f(T x) \\<noteq> f x\""], ["proof (state)\nthis:\n  f (T x) \\<noteq> f x\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  f (T x) \\<noteq> f x", "have \"f(T x) > f x\""], ["proof (prove)\nusing this:\n  f (T x) \\<noteq> f x\n\ngoal (1 subgoal):\n 1. f x < f (T x)", "using B2[OF \\<open>x \\<in> B\\<close>]"], ["proof (prove)\nusing this:\n  f (T x) \\<noteq> f x\n  f x \\<le> f (T x)\n\ngoal (1 subgoal):\n 1. f x < f (T x)", "by simp"], ["proof (state)\nthis:\n  f x < f (T x)\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  f x < f (T x)", "obtain d where d: \"d \\<in> D\" \"f(T x) \\<ge> d \\<and> d > f x\""], ["proof (prove)\nusing this:\n  f x < f (T x)\n\ngoal (1 subgoal):\n 1. (\\<And>d.\n        \\<lbrakk>d \\<in> D; d \\<le> f (T x) \\<and> f x < d\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using D"], ["proof (prove)\nusing this:\n  f x < f (T x)\n  countable D\n  \\<forall>x y.\n     x < y \\<longrightarrow> (\\<exists>d\\<in>D. x < d \\<and> d \\<le> y)\n\ngoal (1 subgoal):\n 1. (\\<And>d.\n        \\<lbrakk>d \\<in> D; d \\<le> f (T x) \\<and> f x < d\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  d \\<in> D\n  d \\<le> f (T x) \\<and> f x < d\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  d \\<in> D\n  d \\<le> f (T x) \\<and> f x < d", "have \"T x \\<in> C d\""], ["proof (prove)\nusing this:\n  d \\<in> D\n  d \\<le> f (T x) \\<and> f x < d\n\ngoal (1 subgoal):\n 1. T x \\<in> C d", "using \\<open>T x \\<in> B\\<close>"], ["proof (prove)\nusing this:\n  d \\<in> D\n  d \\<le> f (T x) \\<and> f x < d\n  T x \\<in> B\n\ngoal (1 subgoal):\n 1. T x \\<in> C d", "unfolding C_def"], ["proof (prove)\nusing this:\n  d \\<in> D\n  d \\<le> f (T x) \\<and> f x < d\n  T x \\<in> B\n\ngoal (1 subgoal):\n 1. T x \\<in> {x \\<in> B. d \\<le> f x}", "by simp"], ["proof (state)\nthis:\n  T x \\<in> C d\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  T x \\<in> C d", "have \"x \\<in> T--`(C d)\""], ["proof (prove)\nusing this:\n  T x \\<in> C d\n\ngoal (1 subgoal):\n 1. x \\<in> T --` C d", "using \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  T x \\<in> C d\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. x \\<in> T --` C d", "by simp"], ["proof (state)\nthis:\n  x \\<in> T --` C d\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  x \\<in> T --` C d", "have \"x \\<in> C d\""], ["proof (prove)\nusing this:\n  x \\<in> T --` C d\n\ngoal (1 subgoal):\n 1. x \\<in> C d", "using x \\<open>d \\<in> D\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> T --` C d\n  x \\<in> space M\n  x \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\n  d \\<in> D\n\ngoal (1 subgoal):\n 1. x \\<in> C d", "by simp"], ["proof (state)\nthis:\n  x \\<in> C d\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  x \\<in> C d", "have \"f x \\<ge> d\""], ["proof (prove)\nusing this:\n  x \\<in> C d\n\ngoal (1 subgoal):\n 1. d \\<le> f x", "unfolding C_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> B. d \\<le> f x}\n\ngoal (1 subgoal):\n 1. d \\<le> f x", "by simp"], ["proof (state)\nthis:\n  d \\<le> f x\n\ngoal (1 subgoal):\n 1. f (T x) \\<noteq> f x \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  d \\<le> f x", "show False"], ["proof (prove)\nusing this:\n  d \\<le> f x\n\ngoal (1 subgoal):\n 1. False", "using d"], ["proof (prove)\nusing this:\n  d \\<le> f x\n  d \\<in> D\n  d \\<le> f (T x) \\<and> f x < d\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f (T x) = f x\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?x5 \\<in> space M;\n   ?x5\n   \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\\<rbrakk>\n  \\<Longrightarrow> f (T ?x5) = f ?x5\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n  \\<lbrakk>?x5 \\<in> space M;\n   ?x5\n   \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\\<rbrakk>\n  \\<Longrightarrow> f (T ?x5) = f ?x5", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. x \\<notin> space M - B \\<union>\n                        (\\<Union>d\\<in>D. T --` C d - C d)\n  \\<lbrakk>?x5 \\<in> space M;\n   ?x5\n   \\<notin> space M - B \\<union> (\\<Union>d\\<in>D. T --` C d - C d)\\<rbrakk>\n  \\<Longrightarrow> f (T ?x5) = f ?x5\n\ngoal (1 subgoal):\n 1. AE x in M. f (T x) = f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. f (T x) = f x\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>For an invertible map, the invariants of $T$ and $T^{-1}$ are the same.\\<close>"], ["", "lemma Invariants_Tinv:\n  assumes \"invertible_qmpt\"\n  shows \"qmpt.Invariants M Tinv = Invariants\""], ["proof (prove)\ngoal (1 subgoal):\n 1. qmpt.Invariants M Tinv = Invariants", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. qmpt.Invariants M Tinv = Invariants", "interpret I: qmpt M Tinv"], ["proof (prove)\ngoal (1 subgoal):\n 1. qmpt M Tinv", "using Tinv_qmpt[OF assms]"], ["proof (prove)\nusing this:\n  qmpt M Tinv\n\ngoal (1 subgoal):\n 1. qmpt M Tinv", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. I.Invariants = Invariants", "have \"(T -` A \\<inter> space M = A) \\<longleftrightarrow> (Tinv -` A \\<inter> space M = A)\" if \"A \\<in> sets M\" for A"], ["proof (prove)\ngoal (1 subgoal):\n 1. (T -` A \\<inter> space M = A) = (Tinv -` A \\<inter> space M = A)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. T -` A \\<inter> space M = A \\<Longrightarrow>\n    Tinv -` A \\<inter> space M = A\n 2. Tinv -` A \\<inter> space M = A \\<Longrightarrow>\n    T -` A \\<inter> space M = A", "assume \"T -` A \\<inter> space M = A\""], ["proof (state)\nthis:\n  T -` A \\<inter> space M = A\n\ngoal (2 subgoals):\n 1. T -` A \\<inter> space M = A \\<Longrightarrow>\n    Tinv -` A \\<inter> space M = A\n 2. Tinv -` A \\<inter> space M = A \\<Longrightarrow>\n    T -` A \\<inter> space M = A", "then"], ["proof (chain)\npicking this:\n  T -` A \\<inter> space M = A", "show \"Tinv -` A \\<inter> space M = A\""], ["proof (prove)\nusing this:\n  T -` A \\<inter> space M = A\n\ngoal (1 subgoal):\n 1. Tinv -` A \\<inter> space M = A", "using assms that"], ["proof (prove)\nusing this:\n  T -` A \\<inter> space M = A\n  invertible_qmpt\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. Tinv -` A \\<inter> space M = A", "unfolding Tinv_def invertible_qmpt_def"], ["proof (prove)\nusing this:\n  T -` A \\<inter> space M = A\n  bij T \\<and> inv T \\<in> M \\<rightarrow>\\<^sub>M M\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. inv T -` A \\<inter> space M = A", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>T -` A \\<inter> space M = A; A \\<in> sets M; bij T;\n        inv T \\<in> M \\<rightarrow>\\<^sub>M M; x \\<in> space M;\n        inv T x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A\n 2. \\<And>x.\n       \\<lbrakk>T -` A \\<inter> space M = A; A \\<in> sets M; bij T;\n        inv T \\<in> M \\<rightarrow>\\<^sub>M M; x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> inv T x \\<in> A", "apply (metis IntE UNIV_I bij_def imageE inv_f_f vimageE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>T -` A \\<inter> space M = A; A \\<in> sets M; bij T;\n        inv T \\<in> M \\<rightarrow>\\<^sub>M M; x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> inv T x \\<in> A", "apply (metis I.T_spaceM_stable(1) Int_iff Tinv_def bij_inv_eq_iff vimageI)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  Tinv -` A \\<inter> space M = A\n\ngoal (1 subgoal):\n 1. Tinv -` A \\<inter> space M = A \\<Longrightarrow>\n    T -` A \\<inter> space M = A", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. Tinv -` A \\<inter> space M = A \\<Longrightarrow>\n    T -` A \\<inter> space M = A", "assume \"Tinv -` A \\<inter> space M = A\""], ["proof (state)\nthis:\n  Tinv -` A \\<inter> space M = A\n\ngoal (1 subgoal):\n 1. Tinv -` A \\<inter> space M = A \\<Longrightarrow>\n    T -` A \\<inter> space M = A", "then"], ["proof (chain)\npicking this:\n  Tinv -` A \\<inter> space M = A", "show \"T -` A \\<inter> space M = A\""], ["proof (prove)\nusing this:\n  Tinv -` A \\<inter> space M = A\n\ngoal (1 subgoal):\n 1. T -` A \\<inter> space M = A", "using assms that"], ["proof (prove)\nusing this:\n  Tinv -` A \\<inter> space M = A\n  invertible_qmpt\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. T -` A \\<inter> space M = A", "unfolding Tinv_def invertible_qmpt_def"], ["proof (prove)\nusing this:\n  inv T -` A \\<inter> space M = A\n  bij T \\<and> inv T \\<in> M \\<rightarrow>\\<^sub>M M\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. T -` A \\<inter> space M = A", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>inv T -` A \\<inter> space M = A; A \\<in> sets M; bij T;\n        inv T \\<in> M \\<rightarrow>\\<^sub>M M; x \\<in> space M;\n        T x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A\n 2. \\<And>x.\n       \\<lbrakk>inv T -` A \\<inter> space M = A; A \\<in> sets M; bij T;\n        inv T \\<in> M \\<rightarrow>\\<^sub>M M; x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> T x \\<in> A", "apply (metis IntE bij_def inv_f_f vimageE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>inv T -` A \\<inter> space M = A; A \\<in> sets M; bij T;\n        inv T \\<in> M \\<rightarrow>\\<^sub>M M; x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> T x \\<in> A", "apply (metis T_Tinv_of_set T_meas Tinv_def assms qmpt.vrestr_of_set qmpt_axioms vrestr_image(3))"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  T -` A \\<inter> space M = A\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?A3 \\<in> sets M \\<Longrightarrow>\n  (T -` ?A3 \\<inter> space M = ?A3) = (Tinv -` ?A3 \\<inter> space M = ?A3)\n\ngoal (1 subgoal):\n 1. I.Invariants = Invariants", "then"], ["proof (chain)\npicking this:\n  ?A3 \\<in> sets M \\<Longrightarrow>\n  (T -` ?A3 \\<inter> space M = ?A3) = (Tinv -` ?A3 \\<inter> space M = ?A3)", "have \"{A \\<in> sets M. Tinv -` A \\<inter> space M = A} = {A \\<in> sets M. T -` A \\<inter> space M = A}\""], ["proof (prove)\nusing this:\n  ?A3 \\<in> sets M \\<Longrightarrow>\n  (T -` ?A3 \\<inter> space M = ?A3) = (Tinv -` ?A3 \\<inter> space M = ?A3)\n\ngoal (1 subgoal):\n 1. {A \\<in> sets M. Tinv -` A \\<inter> space M = A} =\n    {A \\<in> sets M. T -` A \\<inter> space M = A}", "by blast"], ["proof (state)\nthis:\n  {A \\<in> sets M. Tinv -` A \\<inter> space M = A} =\n  {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. I.Invariants = Invariants", "then"], ["proof (chain)\npicking this:\n  {A \\<in> sets M. Tinv -` A \\<inter> space M = A} =\n  {A \\<in> sets M. T -` A \\<inter> space M = A}", "show ?thesis"], ["proof (prove)\nusing this:\n  {A \\<in> sets M. Tinv -` A \\<inter> space M = A} =\n  {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. I.Invariants = Invariants", "unfolding Invariants_def I.Invariants_def"], ["proof (prove)\nusing this:\n  {A \\<in> sets M. Tinv -` A \\<inter> space M = A} =\n  {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. sigma (space M) {A \\<in> sets M. Tinv -` A \\<inter> space M = A} =\n    sigma (space M) {A \\<in> sets M. T -` A \\<inter> space M = A}", "by auto"], ["proof (state)\nthis:\n  I.Invariants = Invariants\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "sublocale fmpt \\<subseteq> finite_measure_subalgebra M Invariants"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite_measure_subalgebra M Invariants", "unfolding finite_measure_subalgebra_def finite_measure_subalgebra_axioms_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite_measure M \\<and> subalgebra M Invariants", "using Invariants_is_subalg"], ["proof (prove)\nusing this:\n  subalgebra M Invariants\n\ngoal (1 subgoal):\n 1. finite_measure M \\<and> subalgebra M Invariants", "by (simp add: finite_measureI)"], ["", "context fmpt\nbegin"], ["", "text \\<open>The conditional expectation with respect to the invariant sigma-algebra is the same\nfor $f$ or $f \\circ T$, essentially by definition.\\<close>"], ["", "lemma Invariants_of_foTn:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants (f o (T^^n)) x = real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (f \\<circ> T ^^ n) x =\n               real_cond_exp M Invariants f x", "proof (rule real_cond_exp_charact)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "fix A"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "assume [measurable]: \"A \\<in> sets Invariants\""], ["proof (state)\nthis:\n  A \\<in> sets Invariants\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "then"], ["proof (chain)\npicking this:\n  A \\<in> sets Invariants", "have [measurable]: \"A \\<in> sets M\""], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. A \\<in> sets M", "using Invariants_in_sets"], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n  ?A \\<in> sets Invariants \\<Longrightarrow> ?A \\<in> sets M\n\ngoal (1 subgoal):\n 1. A \\<in> sets M", "by blast"], ["proof (state)\nthis:\n  A \\<in> sets M\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "then"], ["proof (chain)\npicking this:\n  A \\<in> sets M", "have ind_meas [measurable]: \"((indicator A)::('a \\<Rightarrow> real)) \\<in> borel_measurable Invariants\""], ["proof (prove)\nusing this:\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. indicat_real A \\<in> borel_measurable Invariants", "by auto"], ["proof (state)\nthis:\n  indicat_real A \\<in> borel_measurable Invariants\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "have \"set_lebesgue_integral M A (f \\<circ> (T^^n)) = (\\<integral>x. indicator A x * f((T^^n) x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n    LINT x|M. indicat_real A x * f ((T ^^ n) x)", "by (auto simp: comp_def set_lebesgue_integral_def)"], ["proof (state)\nthis:\n  set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n  LINT x|M. indicat_real A x * f ((T ^^ n) x)\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "also"], ["proof (state)\nthis:\n  set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n  LINT x|M. indicat_real A x * f ((T ^^ n) x)\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "have \"... = (\\<integral>x. indicator A ((T^^n) x) * f ((T^^n) x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. indicat_real A x * f ((T ^^ n) x) =\n    LINT x|M. indicat_real A ((T ^^ n) x) * f ((T ^^ n) x)", "by (rule Bochner_Integration.integral_cong, auto simp add: Invariants_func_is_invariant_n[OF ind_meas])"], ["proof (state)\nthis:\n  LINT x|M. indicat_real A x * f ((T ^^ n) x) =\n  LINT x|M. indicat_real A ((T ^^ n) x) * f ((T ^^ n) x)\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "also"], ["proof (state)\nthis:\n  LINT x|M. indicat_real A x * f ((T ^^ n) x) =\n  LINT x|M. indicat_real A ((T ^^ n) x) * f ((T ^^ n) x)\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "have \"... = (\\<integral>x. indicator A x * f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. indicat_real A ((T ^^ n) x) * f ((T ^^ n) x) =\n    LINT x|M. indicat_real A x * f x", "apply (rule Tn_integral_preserving(2))"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. indicat_real A x * f x)", "using integrable_mult_indicator[OF \\<open>A \\<in> sets M\\<close> assms]"], ["proof (prove)\nusing this:\n  integrable M (\\<lambda>x. indicat_real A x *\\<^sub>R f x)\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. indicat_real A x * f x)", "by auto"], ["proof (state)\nthis:\n  LINT x|M. indicat_real A ((T ^^ n) x) * f ((T ^^ n) x) =\n  LINT x|M. indicat_real A x * f x\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "also"], ["proof (state)\nthis:\n  LINT x|M. indicat_real A ((T ^^ n) x) * f ((T ^^ n) x) =\n  LINT x|M. indicat_real A x * f x\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "have \"... = (\\<integral>x. indicator A x * real_cond_exp M Invariants f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. indicat_real A x * f x =\n    LINT x|M. indicat_real A x * real_cond_exp M Invariants f x", "apply (rule real_cond_exp_intg(2)[symmetric])"], ["proof (prove)\ngoal (3 subgoals):\n 1. integrable M (\\<lambda>x. indicat_real A x * f x)\n 2. indicat_real A \\<in> borel_measurable Invariants\n 3. f \\<in> borel_measurable M", "using integrable_mult_indicator[OF \\<open>A \\<in> sets M\\<close> assms]"], ["proof (prove)\nusing this:\n  integrable M (\\<lambda>x. indicat_real A x *\\<^sub>R f x)\n\ngoal (3 subgoals):\n 1. integrable M (\\<lambda>x. indicat_real A x * f x)\n 2. indicat_real A \\<in> borel_measurable Invariants\n 3. f \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  LINT x|M. indicat_real A x * f x =\n  LINT x|M. indicat_real A x * real_cond_exp M Invariants f x\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "also"], ["proof (state)\nthis:\n  LINT x|M. indicat_real A x * f x =\n  LINT x|M. indicat_real A x * real_cond_exp M Invariants f x\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "have \"... = set_lebesgue_integral M A (real_cond_exp M Invariants f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. indicat_real A x * real_cond_exp M Invariants f x =\n    set_lebesgue_integral M A (real_cond_exp M Invariants f)", "by (auto simp: set_lebesgue_integral_def)"], ["proof (state)\nthis:\n  LINT x|M. indicat_real A x * real_cond_exp M Invariants f x =\n  set_lebesgue_integral M A (real_cond_exp M Invariants f)\n\ngoal (4 subgoals):\n 1. \\<And>A.\n       A \\<in> sets Invariants \\<Longrightarrow>\n       set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n       set_lebesgue_integral M A (real_cond_exp M Invariants f)\n 2. integrable M (f \\<circ> T ^^ n)\n 3. integrable M (real_cond_exp M Invariants f)\n 4. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "finally"], ["proof (chain)\npicking this:\n  set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n  set_lebesgue_integral M A (real_cond_exp M Invariants f)", "show \"set_lebesgue_integral M A (f \\<circ> (T^^n)) = set_lebesgue_integral M A (real_cond_exp M Invariants f)\""], ["proof (prove)\nusing this:\n  set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n  set_lebesgue_integral M A (real_cond_exp M Invariants f)\n\ngoal (1 subgoal):\n 1. set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n    set_lebesgue_integral M A (real_cond_exp M Invariants f)", "by simp"], ["proof (state)\nthis:\n  set_lebesgue_integral M A (f \\<circ> T ^^ n) =\n  set_lebesgue_integral M A (real_cond_exp M Invariants f)\n\ngoal (3 subgoals):\n 1. integrable M (f \\<circ> T ^^ n)\n 2. integrable M (real_cond_exp M Invariants f)\n 3. real_cond_exp M Invariants f \\<in> borel_measurable Invariants", "qed (auto simp add: assms real_cond_exp_int Tn_integral_preserving(1)[OF assms] comp_def)"], ["", "lemma Invariants_of_foT:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants f x = real_cond_exp M Invariants (f o T) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               real_cond_exp M Invariants (f \\<circ> T) x", "using Invariants_of_foTn[OF assms, where ?n = 1]"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (f \\<circ> T ^^ 1) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f x =\n               real_cond_exp M Invariants (f \\<circ> T) x", "by auto"], ["", "lemma birkhoff_sum_Invariants:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x = n * real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "define F where \"F = (\\<lambda>i. f o (T^^i))\""], ["proof (state)\nthis:\n  F = (\\<lambda>i. f \\<circ> T ^^ i)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "have [measurable]: \"\\<And>i. F i \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i. F i \\<in> borel_measurable M", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i. f \\<circ> T ^^ i \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  F ?i3 \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "have *: \"integrable M (F i)\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (F i)", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (f \\<circ> T ^^ i)", "by (subst comp_def, rule Tn_integral_preserving(1)[OF assms, of i])"], ["proof (state)\nthis:\n  integrable M (F ?i3)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "have \"AE x in M. n * real_cond_exp M Invariants f x = (\\<Sum>i\\<in>{..<n}. real_cond_exp M Invariants f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real n * real_cond_exp M Invariants f x =\n               (\\<Sum>i<n. real_cond_exp M Invariants f x)", "by auto"], ["proof (state)\nthis:\n  AE x in M. real n * real_cond_exp M Invariants f x =\n             (\\<Sum>i<n. real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "moreover"], ["proof (state)\nthis:\n  AE x in M. real n * real_cond_exp M Invariants f x =\n             (\\<Sum>i<n. real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "have \"AE x in M. (\\<Sum>i\\<in>{..<n}. real_cond_exp M Invariants f x) = (\\<Sum>i\\<in>{..<n}. real_cond_exp M Invariants (F i) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants f x) =\n               (\\<Sum>i<n. real_cond_exp M Invariants (F i) x)", "apply (rule AE_symmetric[OF AE_equal_sum])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       AE x in M. real_cond_exp M Invariants (F i) x =\n                  real_cond_exp M Invariants f x", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       AE x in M. real_cond_exp M Invariants (f \\<circ> T ^^ i) x =\n                  real_cond_exp M Invariants f x", "using Invariants_of_foTn[OF assms]"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (f \\<circ> T ^^ ?n) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       AE x in M. real_cond_exp M Invariants (f \\<circ> T ^^ i) x =\n                  real_cond_exp M Invariants f x", "by simp"], ["proof (state)\nthis:\n  AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants f x) =\n             (\\<Sum>i<n. real_cond_exp M Invariants (F i) x)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants f x) =\n             (\\<Sum>i<n. real_cond_exp M Invariants (F i) x)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "have \"AE x in M. (\\<Sum>i\\<in>{..<n}. real_cond_exp M Invariants (F i) x) = real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i\\<in>{..<n}. F i x) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants (F i) x) =\n               real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x", "by (rule AE_symmetric[OF real_cond_exp_sum [OF *]])"], ["proof (state)\nthis:\n  AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants (F i) x) =\n             real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants (F i) x) =\n             real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "have \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i\\<in>{..<n}. F i x) x = real_cond_exp M Invariants (birkhoff_sum f n) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x =\n               real_cond_exp M Invariants (birkhoff_sum f n) x", "apply (rule real_cond_exp_cong)"], ["proof (prove)\ngoal (3 subgoals):\n 1. AE x in M. (\\<Sum>i<n. F i x) = birkhoff_sum f n x\n 2. (\\<lambda>x. \\<Sum>i<n. F i x) \\<in> borel_measurable M\n 3. birkhoff_sum f n \\<in> borel_measurable M", "unfolding F_def"], ["proof (prove)\ngoal (3 subgoals):\n 1. AE x in M. (\\<Sum>i<n. (f \\<circ> T ^^ i) x) = birkhoff_sum f n x\n 2. (\\<lambda>x. \\<Sum>i<n. (f \\<circ> T ^^ i) x) \\<in> borel_measurable M\n 3. birkhoff_sum f n \\<in> borel_measurable M", "using birkhoff_sum_def[symmetric]"], ["proof (prove)\nusing this:\n  (\\<Sum>i<?n. ?f ((T ^^ i) ?x)) = birkhoff_sum ?f ?n ?x\n\ngoal (3 subgoals):\n 1. AE x in M. (\\<Sum>i<n. (f \\<circ> T ^^ i) x) = birkhoff_sum f n x\n 2. (\\<lambda>x. \\<Sum>i<n. (f \\<circ> T ^^ i) x) \\<in> borel_measurable M\n 3. birkhoff_sum f n \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x =\n             real_cond_exp M Invariants (birkhoff_sum f n) x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. real n * real_cond_exp M Invariants f x =\n             (\\<Sum>i<n. real_cond_exp M Invariants f x)\n  AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants f x) =\n             (\\<Sum>i<n. real_cond_exp M Invariants (F i) x)\n  AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants (F i) x) =\n             real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x =\n             real_cond_exp M Invariants (birkhoff_sum f n) x", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. real n * real_cond_exp M Invariants f x =\n             (\\<Sum>i<n. real_cond_exp M Invariants f x)\n  AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants f x) =\n             (\\<Sum>i<n. real_cond_exp M Invariants (F i) x)\n  AE x in M. (\\<Sum>i<n. real_cond_exp M Invariants (F i) x) =\n             real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. \\<Sum>i<n. F i x) x =\n             real_cond_exp M Invariants (birkhoff_sum f n) x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n               real n * real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (birkhoff_sum f n) x =\n             real n * real_cond_exp M Invariants f x\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "(* of context fmpt *)"], ["", "subsection \\<open>Birkhoff theorem\\<close>"], ["", "subsubsection \\<open>Almost everywhere version of Birkhoff theorem\\<close>"], ["", "text \\<open>This paragraph is devoted to the proof of Birkhoff theorem, arguably\nthe most fundamental result of ergodic theory.\nThis theorem asserts that Birkhoff averages of an integrable function $f$ converge almost surely,\nto the conditional expectation of $f$ with respect to the invariant sigma algebra.\n\nThis result implies for instance the strong law of large numbers (in probability theory).\n\nThere are numerous proofs of this statement, but none is really easy. We follow the very efficient\nargument given in Katok-Hasselblatt. To help the reader, here is the same proof informally. The\nfirst part of the proof is formalized in \\verb+birkhoff_lemma1+, the second one in\n\\verb+birkhoff_lemma+, and the conclusion in \\verb+birkhoff_theorem+.\n\nStart with an integrable function $g$. let $G_n(x) = \\max_{k\\leq n} S_k g(x)$. Then $\\limsup S_n g/n\n\\leq 0$ outside of $A$, the set where $G_n$ tends to infinity. Moreover, $G_{n+1} - G_n \\circ T$ is\nbounded by $g$, and tends to $g$ on $A$. It follows from the dominated convergence theorem that\n$\\int_A G_{n+1} - G_n \\circ T \\to \\int_A g$. As $\\int_A G_{n+1} - G_n \\circ T = \\int_A G_{n+1} - G_n\n\\geq 0$, we obtain $\\int_A g \\geq 0$.\n\nApply now this result to the function $g = f - E(f | I) - \\epsilon$, where $\\epsilon>0$ is fixed.\nThen $\\int_A g = -\\epsilon \\mu(A)$, then have $\\mu(A) = 0$. Thus, almost surely, $\\limsup S_n\ng/n\\leq 0$, i.e., $\\limsup S_n f/n \\leq E(f|I)+\\epsilon$. Letting $\\epsilon$ tend to $0$ gives\n$\\limsup S_n f/n \\leq E(f|I)$.\n\nApplying the same result to $-f$ gives $S_n f/n \\to E(f|I)$.\n\\<close>"], ["", "context fmpt\nbegin"], ["", "lemma birkhoff_aux1:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  defines \"A \\<equiv> {x \\<in> space M. limsup (\\<lambda>n. ereal(birkhoff_sum f n x)) = \\<infinity>}\"\n    shows \"A \\<in> sets Invariants\" \"(\\<integral>x. f x * indicator A x \\<partial>M) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> sets Invariants &&& 0 \\<le> LINT x|M. f x * indicat_real A x", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. A \\<in> sets Invariants\n 2. 0 \\<le> LINT x|M. f x * indicat_real A x", "let ?bsf = \"birkhoff_sum f\""], ["proof (state)\ngoal (2 subgoals):\n 1. A \\<in> sets Invariants\n 2. 0 \\<le> LINT x|M. f x * indicat_real A x", "have [measurable]: \"A \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> sets M", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>}\n    \\<in> sets M", "by simp"], ["proof (state)\nthis:\n  A \\<in> sets M\n\ngoal (2 subgoals):\n 1. A \\<in> sets Invariants\n 2. 0 \\<le> LINT x|M. f x * indicat_real A x", "have Ainv: \"x \\<in> A \\<longleftrightarrow> T x \\<in> A\" if \"x \\<in> space M\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "have \"ereal(?bsf (1 + n) x) = ereal(f x) + ereal(?bsf n (T x))\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. ereal (birkhoff_sum f (1 + n) x) =\n    ereal (f x) + ereal (birkhoff_sum f n (T x))", "unfolding birkhoff_sum_cocycle birkhoff_sum_1"], ["proof (prove)\ngoal (1 subgoal):\n 1. ereal (f x + birkhoff_sum f n ((T ^^ 1) x)) =\n    ereal (f x) + ereal (birkhoff_sum f n (T x))", "by simp"], ["proof (state)\nthis:\n  ereal (birkhoff_sum f (1 + ?n3) x) =\n  ereal (f x) + ereal (birkhoff_sum f ?n3 (T x))\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "moreover"], ["proof (state)\nthis:\n  ereal (birkhoff_sum f (1 + ?n3) x) =\n  ereal (f x) + ereal (birkhoff_sum f ?n3 (T x))\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "have \"limsup (\\<lambda>n. ereal(f x) + ereal(?bsf n (T x)))\n                    = ereal(f x) + limsup(\\<lambda>n. ereal(?bsf n (T x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (f x) + ereal (birkhoff_sum f n (T x))) =\n    ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))", "by (rule ereal_limsup_lim_add, auto)"], ["proof (state)\nthis:\n  limsup (\\<lambda>n. ereal (f x) + ereal (birkhoff_sum f n (T x))) =\n  ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "moreover"], ["proof (state)\nthis:\n  limsup (\\<lambda>n. ereal (f x) + ereal (birkhoff_sum f n (T x))) =\n  ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "have \"limsup (\\<lambda>n. ereal(?bsf (n+1) x)) = limsup (\\<lambda>n. ereal(?bsf n x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (birkhoff_sum f (n + 1) x)) =\n    limsup (\\<lambda>n. ereal (birkhoff_sum f n x))", "using limsup_shift"], ["proof (prove)\nusing this:\n  limsup (\\<lambda>n. ?u (n + 1)) = limsup ?u\n\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (birkhoff_sum f (n + 1) x)) =\n    limsup (\\<lambda>n. ereal (birkhoff_sum f n x))", "by simp"], ["proof (state)\nthis:\n  limsup (\\<lambda>n. ereal (birkhoff_sum f (n + 1) x)) =\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x))\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "ultimately"], ["proof (chain)\npicking this:\n  ereal (birkhoff_sum f (1 + ?n3) x) =\n  ereal (f x) + ereal (birkhoff_sum f ?n3 (T x))\n  limsup (\\<lambda>n. ereal (f x) + ereal (birkhoff_sum f n (T x))) =\n  ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n  limsup (\\<lambda>n. ereal (birkhoff_sum f (n + 1) x)) =\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x))", "have \"limsup (\\<lambda>n. ereal(birkhoff_sum f n x)) = ereal(f x) + limsup (\\<lambda>n. ereal(?bsf n (T x)))\""], ["proof (prove)\nusing this:\n  ereal (birkhoff_sum f (1 + ?n3) x) =\n  ereal (f x) + ereal (birkhoff_sum f ?n3 (T x))\n  limsup (\\<lambda>n. ereal (f x) + ereal (birkhoff_sum f n (T x))) =\n  ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n  limsup (\\<lambda>n. ereal (birkhoff_sum f (n + 1) x)) =\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x))\n\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) =\n    ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))", "by simp"], ["proof (state)\nthis:\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) =\n  ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "then"], ["proof (chain)\npicking this:\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) =\n  ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))", "have \"limsup (\\<lambda>n. ereal(?bsf n x)) = \\<infinity> \\<longleftrightarrow> limsup (\\<lambda>n. ereal(?bsf n (T x))) = \\<infinity>\""], ["proof (prove)\nusing this:\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) =\n  ereal (f x) + limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n\ngoal (1 subgoal):\n 1. (limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>) =\n    (limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x))) = \\<infinity>)", "by simp"], ["proof (state)\nthis:\n  (limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>) =\n  (limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x))) = \\<infinity>)\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "then"], ["proof (chain)\npicking this:\n  (limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>) =\n  (limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x))) = \\<infinity>)", "show \"x \\<in> A \\<longleftrightarrow> T x \\<in> A\""], ["proof (prove)\nusing this:\n  (limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>) =\n  (limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x))) = \\<infinity>)\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "using \\<open>x \\<in> space M\\<close> A_def"], ["proof (prove)\nusing this:\n  (limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>) =\n  (limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x))) = \\<infinity>)\n  x \\<in> space M\n  A \\<equiv>\n  {x \\<in> space M.\n   limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>}\n\ngoal (1 subgoal):\n 1. (x \\<in> A) = (T x \\<in> A)", "by simp"], ["proof (state)\nthis:\n  (x \\<in> A) = (T x \\<in> A)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x3 \\<in> space M \\<Longrightarrow> (?x3 \\<in> A) = (T ?x3 \\<in> A)\n\ngoal (2 subgoals):\n 1. A \\<in> sets Invariants\n 2. 0 \\<le> LINT x|M. f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  ?x3 \\<in> space M \\<Longrightarrow> (?x3 \\<in> A) = (T ?x3 \\<in> A)", "show \"A \\<in> sets Invariants\""], ["proof (prove)\nusing this:\n  ?x3 \\<in> space M \\<Longrightarrow> (?x3 \\<in> A) = (T ?x3 \\<in> A)\n\ngoal (1 subgoal):\n 1. A \\<in> sets Invariants", "using assms(2) Invariants_sets"], ["proof (prove)\nusing this:\n  ?x3 \\<in> space M \\<Longrightarrow> (?x3 \\<in> A) = (T ?x3 \\<in> A)\n  A \\<equiv>\n  {x \\<in> space M.\n   limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>}\n  sets Invariants = {A \\<in> sets M. T -` A \\<inter> space M = A}\n\ngoal (1 subgoal):\n 1. A \\<in> sets Invariants", "by auto"], ["proof (state)\nthis:\n  A \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "define F where \"F = (\\<lambda>n x. MAX k \\<in>{0..n}. ?bsf k x)\""], ["proof (state)\nthis:\n  F = (\\<lambda>n x. MAX k\\<in>{0..n}. birkhoff_sum f k x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "have [measurable]: \"\\<And>n. F n \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n. F n \\<in> borel_measurable M", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<lambda>x. MAX k\\<in>{0..n}. birkhoff_sum f k x)\n       \\<in> borel_measurable M", "by measurable"], ["proof (state)\nthis:\n  F ?n3 \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "have intFn: \"integrable M (F n)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (F n)", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. MAX k\\<in>{0..n}. birkhoff_sum f k x)", "by (rule integrable_MAX, auto simp add: birkhoff_sum_integral(1)[OF assms(1)])"], ["proof (state)\nthis:\n  integrable M (F ?n3)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "have Frec: \"F (n+1) x - F n (T x) = max (-F n (T x)) (f x)\" for n x"], ["proof (prove)\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "have \"{0..n+1} = {0} \\<union> {1..n+1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0..n + 1} = {0} \\<union> {1..n + 1}", "by auto"], ["proof (state)\nthis:\n  {0..n + 1} = {0} \\<union> {1..n + 1}\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "then"], ["proof (chain)\npicking this:\n  {0..n + 1} = {0} \\<union> {1..n + 1}", "have \"(\\<lambda>k. ?bsf k x) ` {0..n+1} = (\\<lambda>k. ?bsf k x) ` {0} \\<union> (\\<lambda>k. ?bsf k x) ` {1..n+1}\""], ["proof (prove)\nusing this:\n  {0..n + 1} = {0} \\<union> {1..n + 1}\n\ngoal (1 subgoal):\n 1. (\\<lambda>k. birkhoff_sum f k x) ` {0..n + 1} =\n    (\\<lambda>k. birkhoff_sum f k x) ` {0} \\<union>\n    (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1}", "by blast"], ["proof (state)\nthis:\n  (\\<lambda>k. birkhoff_sum f k x) ` {0..n + 1} =\n  (\\<lambda>k. birkhoff_sum f k x) ` {0} \\<union>\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1}\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>k. birkhoff_sum f k x) ` {0..n + 1} =\n  (\\<lambda>k. birkhoff_sum f k x) ` {0} \\<union>\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1}", "have *: \"(\\<lambda>k. ?bsf k x) ` {0..n+1} = {0} \\<union> (\\<lambda>k. ?bsf k x) ` {1..n+1}\""], ["proof (prove)\nusing this:\n  (\\<lambda>k. birkhoff_sum f k x) ` {0..n + 1} =\n  (\\<lambda>k. birkhoff_sum f k x) ` {0} \\<union>\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1}\n\ngoal (1 subgoal):\n 1. (\\<lambda>k. birkhoff_sum f k x) ` {0..n + 1} =\n    {0} \\<union> (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1}", "using birkhoff_sum_1(1)"], ["proof (prove)\nusing this:\n  (\\<lambda>k. birkhoff_sum f k x) ` {0..n + 1} =\n  (\\<lambda>k. birkhoff_sum f k x) ` {0} \\<union>\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1}\n  birkhoff_sum ?f 0 ?x = (0::?'b)\n\ngoal (1 subgoal):\n 1. (\\<lambda>k. birkhoff_sum f k x) ` {0..n + 1} =\n    {0} \\<union> (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1}", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>k. birkhoff_sum f k x) ` {0..n + 1} =\n  {0} \\<union> (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1}\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "have b: \"F (n+1) x = max (Max {0}) (MAX k \\<in>{1..n+1}. ?bsf k x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (n + 1) x = max (Max {0}) (MAX k\\<in>{1..n + 1}. birkhoff_sum f k x)", "by (subst F_def, subst *, rule Max.union, auto)"], ["proof (state)\nthis:\n  F (n + 1) x = max (Max {0}) (MAX k\\<in>{1..n + 1}. birkhoff_sum f k x)\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "have \"(\\<lambda>k. ?bsf k x) ` {1..n+1} = (\\<lambda>k. ?bsf (1+k) x) ` {0..n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1} =\n    (\\<lambda>k. birkhoff_sum f (1 + k) x) ` {0..n}", "using Suc_le_D"], ["proof (prove)\nusing this:\n  Suc ?n \\<le> ?m' \\<Longrightarrow> \\<exists>m. ?m' = Suc m\n\ngoal (1 subgoal):\n 1. (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1} =\n    (\\<lambda>k. birkhoff_sum f (1 + k) x) ` {0..n}", "by fastforce"], ["proof (state)\nthis:\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1} =\n  (\\<lambda>k. birkhoff_sum f (1 + k) x) ` {0..n}\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "also"], ["proof (state)\nthis:\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1} =\n  (\\<lambda>k. birkhoff_sum f (1 + k) x) ` {0..n}\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "have \"... = (\\<lambda>k. f x + ?bsf k (T x)) ` {0..n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>k. birkhoff_sum f (1 + k) x) ` {0..n} =\n    (\\<lambda>k. f x + birkhoff_sum f k (T x)) ` {0..n}", "by (subst birkhoff_sum_cocycle, subst birkhoff_sum_1(2), auto)"], ["proof (state)\nthis:\n  (\\<lambda>k. birkhoff_sum f (1 + k) x) ` {0..n} =\n  (\\<lambda>k. f x + birkhoff_sum f k (T x)) ` {0..n}\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1} =\n  (\\<lambda>k. f x + birkhoff_sum f k (T x)) ` {0..n}", "have c: \"F (n+1) x = max 0 (MAX k \\<in>{0..n}. ?bsf k (T x) + f x)\""], ["proof (prove)\nusing this:\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1} =\n  (\\<lambda>k. f x + birkhoff_sum f k (T x)) ` {0..n}\n\ngoal (1 subgoal):\n 1. F (n + 1) x = max 0 (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x)", "using b"], ["proof (prove)\nusing this:\n  (\\<lambda>k. birkhoff_sum f k x) ` {1..n + 1} =\n  (\\<lambda>k. f x + birkhoff_sum f k (T x)) ` {0..n}\n  F (n + 1) x = max (Max {0}) (MAX k\\<in>{1..n + 1}. birkhoff_sum f k x)\n\ngoal (1 subgoal):\n 1. F (n + 1) x = max 0 (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x)", "by (simp add: add_ac)"], ["proof (state)\nthis:\n  F (n + 1) x = max 0 (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x)\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "have \"{f x + birkhoff_sum f k (T x) |k. k \\<in>{0..n}} = (+) (f x) ` {birkhoff_sum f k (T x) |k. k \\<in>{0..n}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {f x + birkhoff_sum f k (T x) |k. k \\<in> {0..n}} =\n    (+) (f x) ` {birkhoff_sum f k (T x) |k. k \\<in> {0..n}}", "by blast"], ["proof (state)\nthis:\n  {f x + birkhoff_sum f k (T x) |k. k \\<in> {0..n}} =\n  (+) (f x) ` {birkhoff_sum f k (T x) |k. k \\<in> {0..n}}\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "have \"(MAX k \\<in>{0..n}. ?bsf k (T x) + f x) = (MAX k \\<in>{0..n}. ?bsf k (T x)) + f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) =\n    (MAX k\\<in>{0..n}. birkhoff_sum f k (T x)) + f x", "by (rule Max_add_commute) auto"], ["proof (state)\nthis:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) =\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x)) + f x\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "also"], ["proof (state)\nthis:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) =\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x)) + f x\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "have \"... = F n (T x) + f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (MAX k\\<in>{0..n}. birkhoff_sum f k (T x)) + f x = F n (T x) + f x", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (MAX k\\<in>{0..n}. birkhoff_sum f k (T x)) + f x =\n    (MAX k\\<in>{0..n}. birkhoff_sum f k (T x)) + f x", "by simp"], ["proof (state)\nthis:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x)) + f x = F n (T x) + f x\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "finally"], ["proof (chain)\npicking this:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) = F n (T x) + f x", "have \"(MAX k \\<in>{0..n}. ?bsf k (T x) + f x) = f x + F n (T x)\""], ["proof (prove)\nusing this:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) = F n (T x) + f x\n\ngoal (1 subgoal):\n 1. (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) = f x + F n (T x)", "by simp"], ["proof (state)\nthis:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) = f x + F n (T x)\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "then"], ["proof (chain)\npicking this:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) = f x + F n (T x)", "have \"F (n+1) x = max 0 (f x + F n (T x))\""], ["proof (prove)\nusing this:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) = f x + F n (T x)\n\ngoal (1 subgoal):\n 1. F (n + 1) x = max 0 (f x + F n (T x))", "using c"], ["proof (prove)\nusing this:\n  (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x) = f x + F n (T x)\n  F (n + 1) x = max 0 (MAX k\\<in>{0..n}. birkhoff_sum f k (T x) + f x)\n\ngoal (1 subgoal):\n 1. F (n + 1) x = max 0 (f x + F n (T x))", "by simp"], ["proof (state)\nthis:\n  F (n + 1) x = max 0 (f x + F n (T x))\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "then"], ["proof (chain)\npicking this:\n  F (n + 1) x = max 0 (f x + F n (T x))", "show \"F (n+1) x - F n (T x) = max (-F n (T x)) (f x)\""], ["proof (prove)\nusing this:\n  F (n + 1) x = max 0 (f x + F n (T x))\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)", "by auto"], ["proof (state)\nthis:\n  F (n + 1) x - F n (T x) = max (- F n (T x)) (f x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F (?n3 + 1) ?x3 - F ?n3 (T ?x3) = max (- F ?n3 (T ?x3)) (f ?x3)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "have a: \"abs((F (n+1) x - F n (T x)) * indicator A x) \\<le> abs(f x)\" for n x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "have \"F (n+1) x -F n (T x) \\<ge> f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f x \\<le> F (n + 1) x - F n (T x)", "using Frec"], ["proof (prove)\nusing this:\n  F (?n3 + 1) ?x3 - F ?n3 (T ?x3) = max (- F ?n3 (T ?x3)) (f ?x3)\n\ngoal (1 subgoal):\n 1. f x \\<le> F (n + 1) x - F n (T x)", "by simp"], ["proof (state)\nthis:\n  f x \\<le> F (n + 1) x - F n (T x)\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "then"], ["proof (chain)\npicking this:\n  f x \\<le> F (n + 1) x - F n (T x)", "have *: \"F (n+1) x -F n (T x) \\<ge> - abs(f x)\""], ["proof (prove)\nusing this:\n  f x \\<le> F (n + 1) x - F n (T x)\n\ngoal (1 subgoal):\n 1. - \\<bar>f x\\<bar> \\<le> F (n + 1) x - F n (T x)", "by simp"], ["proof (state)\nthis:\n  - \\<bar>f x\\<bar> \\<le> F (n + 1) x - F n (T x)\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "have \"F n (T x) \\<ge> birkhoff_sum f 0 (T x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum f 0 (T x) \\<le> F n (T x)", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum f 0 (T x) \\<le> (MAX k\\<in>{0..n}. birkhoff_sum f k (T x))", "apply (rule Max_ge, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum f 0 (T x)\n    \\<in> (\\<lambda>k. birkhoff_sum f k (T x)) ` {0..n}", "using atLeastAtMost_iff"], ["proof (prove)\nusing this:\n  (?i \\<in> {?l..?u}) = (?l \\<le> ?i \\<and> ?i \\<le> ?u)\n\ngoal (1 subgoal):\n 1. birkhoff_sum f 0 (T x)\n    \\<in> (\\<lambda>k. birkhoff_sum f k (T x)) ` {0..n}", "by blast"], ["proof (state)\nthis:\n  birkhoff_sum f 0 (T x) \\<le> F n (T x)\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f 0 (T x) \\<le> F n (T x)", "have \"F n (T x) \\<ge> 0\""], ["proof (prove)\nusing this:\n  birkhoff_sum f 0 (T x) \\<le> F n (T x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> F n (T x)", "using birkhoff_sum_1(1)"], ["proof (prove)\nusing this:\n  birkhoff_sum f 0 (T x) \\<le> F n (T x)\n  birkhoff_sum ?f 0 ?x = (0::?'b)\n\ngoal (1 subgoal):\n 1. 0 \\<le> F n (T x)", "by simp"], ["proof (state)\nthis:\n  0 \\<le> F n (T x)\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "then"], ["proof (chain)\npicking this:\n  0 \\<le> F n (T x)", "have \"-F n (T x) \\<le> abs (f x)\""], ["proof (prove)\nusing this:\n  0 \\<le> F n (T x)\n\ngoal (1 subgoal):\n 1. - F n (T x) \\<le> \\<bar>f x\\<bar>", "by simp"], ["proof (state)\nthis:\n  - F n (T x) \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "moreover"], ["proof (state)\nthis:\n  - F n (T x) \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "have \"f x \\<le> abs(f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f x \\<le> \\<bar>f x\\<bar>", "by simp"], ["proof (state)\nthis:\n  f x \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "ultimately"], ["proof (chain)\npicking this:\n  - F n (T x) \\<le> \\<bar>f x\\<bar>\n  f x \\<le> \\<bar>f x\\<bar>", "have \"F (n+1) x -F n (T x) \\<le> abs(f x)\""], ["proof (prove)\nusing this:\n  - F n (T x) \\<le> \\<bar>f x\\<bar>\n  f x \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) \\<le> \\<bar>f x\\<bar>", "using Frec"], ["proof (prove)\nusing this:\n  - F n (T x) \\<le> \\<bar>f x\\<bar>\n  f x \\<le> \\<bar>f x\\<bar>\n  F (?n3 + 1) ?x3 - F ?n3 (T ?x3) = max (- F ?n3 (T ?x3)) (f ?x3)\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) \\<le> \\<bar>f x\\<bar>", "by simp"], ["proof (state)\nthis:\n  F (n + 1) x - F n (T x) \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "then"], ["proof (chain)\npicking this:\n  F (n + 1) x - F n (T x) \\<le> \\<bar>f x\\<bar>", "have \"abs(F (n+1) x - F n (T x)) \\<le> abs(f x)\""], ["proof (prove)\nusing this:\n  F (n + 1) x - F n (T x) \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>F (n + 1) x - F n (T x)\\<bar> \\<le> \\<bar>f x\\<bar>", "using *"], ["proof (prove)\nusing this:\n  F (n + 1) x - F n (T x) \\<le> \\<bar>f x\\<bar>\n  - \\<bar>f x\\<bar> \\<le> F (n + 1) x - F n (T x)\n\ngoal (1 subgoal):\n 1. \\<bar>F (n + 1) x - F n (T x)\\<bar> \\<le> \\<bar>f x\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>F (n + 1) x - F n (T x)\\<bar> \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "then"], ["proof (chain)\npicking this:\n  \\<bar>F (n + 1) x - F n (T x)\\<bar> \\<le> \\<bar>f x\\<bar>", "show \"abs((F (n+1) x - F n (T x)) * indicator A x) \\<le> abs(f x)\""], ["proof (prove)\nusing this:\n  \\<bar>F (n + 1) x - F n (T x)\\<bar> \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "unfolding indicator_def"], ["proof (prove)\nusing this:\n  \\<bar>F (n + 1) x - F n (T x)\\<bar> \\<le> \\<bar>f x\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(F (n + 1) x - F n (T x)) * (if x \\<in> A then 1 else 0)\\<bar>\n    \\<le> \\<bar>f x\\<bar>", "by auto"], ["proof (state)\nthis:\n  \\<bar>(F (n + 1) x - F n (T x)) * indicat_real A x\\<bar>\n  \\<le> \\<bar>f x\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>(F (?n3 + 1) ?x3 - F ?n3 (T ?x3)) * indicat_real A ?x3\\<bar>\n  \\<le> \\<bar>f ?x3\\<bar>\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "have b: \"(\\<lambda>n. (F (n+1) x - F n (T x)) * indicator A x) \\<longlonglongrightarrow> f x * indicator A x\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. (F (n + 1) x - F n (T x)) * indicat_real A x)\n    \\<longlonglongrightarrow> f x * indicat_real A x", "proof (rule tendsto_eventually, cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "assume \"x \\<in> A\""], ["proof (state)\nthis:\n  x \\<in> A\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  x \\<in> A", "have \"T x \\<in> A\""], ["proof (prove)\nusing this:\n  x \\<in> A\n\ngoal (1 subgoal):\n 1. T x \\<in> A", "using Ainv A_def"], ["proof (prove)\nusing this:\n  x \\<in> A\n  ?x3 \\<in> space M \\<Longrightarrow> (?x3 \\<in> A) = (T ?x3 \\<in> A)\n  A \\<equiv>\n  {x \\<in> space M.\n   limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>}\n\ngoal (1 subgoal):\n 1. T x \\<in> A", "by auto"], ["proof (state)\nthis:\n  T x \\<in> A\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  T x \\<in> A", "have \"limsup (\\<lambda>n. ereal(birkhoff_sum f n (T x))) > ereal(-f x)\""], ["proof (prove)\nusing this:\n  T x \\<in> A\n\ngoal (1 subgoal):\n 1. ereal (- f x) < limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))", "unfolding A_def"], ["proof (prove)\nusing this:\n  T x\n  \\<in> {x \\<in> space M.\n         limsup (\\<lambda>n. ereal (birkhoff_sum f n x)) = \\<infinity>}\n\ngoal (1 subgoal):\n 1. ereal (- f x) < limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))", "by simp"], ["proof (state)\nthis:\n  ereal (- f x) < limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  ereal (- f x) < limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))", "obtain N where \"ereal(?bsf N (T x)) > ereal(-f x)\""], ["proof (prove)\nusing this:\n  ereal (- f x) < limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        ereal (- f x) < ereal (birkhoff_sum f N (T x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using Limsup_obtain"], ["proof (prove)\nusing this:\n  ereal (- f x) < limsup (\\<lambda>n. ereal (birkhoff_sum f n (T x)))\n  ?c < Limsup ?F ?u \\<Longrightarrow> \\<exists>i. ?c < ?u i\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        ereal (- f x) < ereal (birkhoff_sum f N (T x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ereal (- f x) < ereal (birkhoff_sum f N (T x))\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  ereal (- f x) < ereal (birkhoff_sum f N (T x))", "have *: \"?bsf N (T x) > -f x\""], ["proof (prove)\nusing this:\n  ereal (- f x) < ereal (birkhoff_sum f N (T x))\n\ngoal (1 subgoal):\n 1. - f x < birkhoff_sum f N (T x)", "by simp"], ["proof (state)\nthis:\n  - f x < birkhoff_sum f N (T x)\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "{"], ["proof (state)\nthis:\n  - f x < birkhoff_sum f N (T x)\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "fix n"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "assume \"n\\<ge>N\""], ["proof (state)\nthis:\n  N \\<le> n\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  N \\<le> n", "have \"?bsf N (T x) \\<in> (\\<lambda>k. ?bsf k (T x)) ` {0..n}\""], ["proof (prove)\nusing this:\n  N \\<le> n\n\ngoal (1 subgoal):\n 1. birkhoff_sum f N (T x)\n    \\<in> (\\<lambda>k. birkhoff_sum f k (T x)) ` {0..n}", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum f N (T x) \\<in> (\\<lambda>k. birkhoff_sum f k (T x)) ` {0..n}\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f N (T x) \\<in> (\\<lambda>k. birkhoff_sum f k (T x)) ` {0..n}", "have \"F n (T x) \\<ge> ?bsf N (T x)\""], ["proof (prove)\nusing this:\n  birkhoff_sum f N (T x) \\<in> (\\<lambda>k. birkhoff_sum f k (T x)) ` {0..n}\n\ngoal (1 subgoal):\n 1. birkhoff_sum f N (T x) \\<le> F n (T x)", "unfolding F_def"], ["proof (prove)\nusing this:\n  birkhoff_sum f N (T x) \\<in> (\\<lambda>k. birkhoff_sum f k (T x)) ` {0..n}\n\ngoal (1 subgoal):\n 1. birkhoff_sum f N (T x) \\<le> (MAX k\\<in>{0..n}. birkhoff_sum f k (T x))", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum f N (T x) \\<le> F n (T x)\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f N (T x) \\<le> F n (T x)", "have \"F n (T x) \\<ge> -f x\""], ["proof (prove)\nusing this:\n  birkhoff_sum f N (T x) \\<le> F n (T x)\n\ngoal (1 subgoal):\n 1. - f x \\<le> F n (T x)", "using *"], ["proof (prove)\nusing this:\n  birkhoff_sum f N (T x) \\<le> F n (T x)\n  - f x < birkhoff_sum f N (T x)\n\ngoal (1 subgoal):\n 1. - f x \\<le> F n (T x)", "by simp"], ["proof (state)\nthis:\n  - f x \\<le> F n (T x)\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  - f x \\<le> F n (T x)", "have \"max (-F n (T x)) (f x) = f x\""], ["proof (prove)\nusing this:\n  - f x \\<le> F n (T x)\n\ngoal (1 subgoal):\n 1. max (- F n (T x)) (f x) = f x", "by simp"], ["proof (state)\nthis:\n  max (- F n (T x)) (f x) = f x\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  max (- F n (T x)) (f x) = f x", "have \"F (n+1) x - F n (T x) = f x\""], ["proof (prove)\nusing this:\n  max (- F n (T x)) (f x) = f x\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = f x", "using Frec"], ["proof (prove)\nusing this:\n  max (- F n (T x)) (f x) = f x\n  F (?n3 + 1) ?x3 - F ?n3 (T ?x3) = max (- F ?n3 (T ?x3)) (f ?x3)\n\ngoal (1 subgoal):\n 1. F (n + 1) x - F n (T x) = f x", "by simp"], ["proof (state)\nthis:\n  F (n + 1) x - F n (T x) = f x\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  F (n + 1) x - F n (T x) = f x", "have \"(F (n+1) x - F n (T x)) * indicator A x = f x * indicator A x\""], ["proof (prove)\nusing this:\n  F (n + 1) x - F n (T x) = f x\n\ngoal (1 subgoal):\n 1. (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "by simp"], ["proof (state)\nthis:\n  (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "}"], ["proof (state)\nthis:\n  N \\<le> ?n5 \\<Longrightarrow>\n  (F (?n5 + 1) x - F ?n5 (T x)) * indicat_real A x = f x * indicat_real A x\n\ngoal (2 subgoals):\n 1. ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n 2. \\<not> ?P2 \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  N \\<le> ?n5 \\<Longrightarrow>\n  (F (?n5 + 1) x - F ?n5 (T x)) * indicat_real A x = f x * indicat_real A x", "show \"eventually (\\<lambda>n. (F (n+1) x - F n (T x)) * indicator A x = f x * indicator A x) sequentially\""], ["proof (prove)\nusing this:\n  N \\<le> ?n5 \\<Longrightarrow>\n  (F (?n5 + 1) x - F ?n5 (T x)) * indicat_real A x = f x * indicat_real A x\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "using eventually_sequentially"], ["proof (prove)\nusing this:\n  N \\<le> ?n5 \\<Longrightarrow>\n  (F (?n5 + 1) x - F ?n5 (T x)) * indicat_real A x = f x * indicat_real A x\n  eventually ?P sequentially = (\\<exists>N. \\<forall>n\\<ge>N. ?P n)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "by blast"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n\ngoal (1 subgoal):\n 1. x \\<notin> A \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<notin> A \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "assume \"\\<not>(x \\<in> A)\""], ["proof (state)\nthis:\n  x \\<notin> A\n\ngoal (1 subgoal):\n 1. x \\<notin> A \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  x \\<notin> A", "have \"indicator A x = (0::real)\""], ["proof (prove)\nusing this:\n  x \\<notin> A\n\ngoal (1 subgoal):\n 1. indicat_real A x = 0", "by simp"], ["proof (state)\nthis:\n  indicat_real A x = 0\n\ngoal (1 subgoal):\n 1. x \\<notin> A \\<Longrightarrow>\n    \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  indicat_real A x = 0", "show \"eventually (\\<lambda>n. (F (n+1) x - F n (T x)) * indicator A x = f x * indicator A x) sequentially\""], ["proof (prove)\nusing this:\n  indicat_real A x = 0\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     (F (n + 1) x - F n (T x)) * indicat_real A x = f x * indicat_real A x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>n. (F (n + 1) ?x3 - F n (T ?x3)) * indicat_real A ?x3)\n  \\<longlonglongrightarrow> f ?x3 * indicat_real A ?x3\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "have lim: \"(\\<lambda>n. (\\<integral>x. (F (n+1) x - F n (T x)) * indicator A x \\<partial>M)) \\<longlonglongrightarrow> (\\<integral>x. f x * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x)\n    \\<longlonglongrightarrow> LINT x|M. f x * indicat_real A x", "proof (rule integral_dominated_convergence[where ?w = \"(\\<lambda>x. abs(f x))\"])"], ["proof (state)\ngoal (5 subgoals):\n 1. (\\<lambda>x. f x * indicat_real A x) \\<in> borel_measurable M\n 2. \\<And>n.\n       (\\<lambda>x. (F (n + 1) x - F n (T x)) * indicat_real A x)\n       \\<in> borel_measurable M\n 3. integrable M (\\<lambda>x. \\<bar>f x\\<bar>)\n 4. AE x in M. (\\<lambda>n. (F (n + 1) x - F n (T x)) * indicat_real A x)\n               \\<longlonglongrightarrow> f x * indicat_real A x\n 5. \\<And>n.\n       AE x in M. norm ((F (n + 1) x - F n (T x)) * indicat_real A x)\n                  \\<le> \\<bar>f x\\<bar>", "show \"integrable M (\\<lambda>x. \\<bar>f x\\<bar>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. \\<bar>f x\\<bar>)", "using assms(1)"], ["proof (prove)\nusing this:\n  integrable M f\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. \\<bar>f x\\<bar>)", "by auto"], ["proof (state)\nthis:\n  integrable M (\\<lambda>x. \\<bar>f x\\<bar>)\n\ngoal (4 subgoals):\n 1. (\\<lambda>x. f x * indicat_real A x) \\<in> borel_measurable M\n 2. \\<And>n.\n       (\\<lambda>x. (F (n + 1) x - F n (T x)) * indicat_real A x)\n       \\<in> borel_measurable M\n 3. AE x in M. (\\<lambda>n. (F (n + 1) x - F n (T x)) * indicat_real A x)\n               \\<longlonglongrightarrow> f x * indicat_real A x\n 4. \\<And>n.\n       AE x in M. norm ((F (n + 1) x - F n (T x)) * indicat_real A x)\n                  \\<le> \\<bar>f x\\<bar>", "show \"AE x in M. (\\<lambda>n. (F (n + 1) x - F n (T x)) * indicator A x) \\<longlonglongrightarrow> f x * indicator A x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. (F (n + 1) x - F n (T x)) * indicat_real A x)\n               \\<longlonglongrightarrow> f x * indicat_real A x", "using b"], ["proof (prove)\nusing this:\n  (\\<lambda>n. (F (n + 1) ?x3 - F n (T ?x3)) * indicat_real A ?x3)\n  \\<longlonglongrightarrow> f ?x3 * indicat_real A ?x3\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. (F (n + 1) x - F n (T x)) * indicat_real A x)\n               \\<longlonglongrightarrow> f x * indicat_real A x", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. (F (n + 1) x - F n (T x)) * indicat_real A x)\n             \\<longlonglongrightarrow> f x * indicat_real A x\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f x * indicat_real A x) \\<in> borel_measurable M\n 2. \\<And>n.\n       (\\<lambda>x. (F (n + 1) x - F n (T x)) * indicat_real A x)\n       \\<in> borel_measurable M\n 3. \\<And>n.\n       AE x in M. norm ((F (n + 1) x - F n (T x)) * indicat_real A x)\n                  \\<le> \\<bar>f x\\<bar>", "show \"\\<And>n. AE x in M. norm ((F (n + 1) x - F n (T x)) * indicator A x) \\<le> \\<bar>f x\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       AE x in M. norm ((F (n + 1) x - F n (T x)) * indicat_real A x)\n                  \\<le> \\<bar>f x\\<bar>", "using a"], ["proof (prove)\nusing this:\n  \\<bar>(F (?n3 + 1) ?x3 - F ?n3 (T ?x3)) * indicat_real A ?x3\\<bar>\n  \\<le> \\<bar>f ?x3\\<bar>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       AE x in M. norm ((F (n + 1) x - F n (T x)) * indicat_real A x)\n                  \\<le> \\<bar>f x\\<bar>", "by auto"], ["proof (state)\nthis:\n  AE x in M. norm ((F (?n3 + 1) x - F ?n3 (T x)) * indicat_real A x)\n             \\<le> \\<bar>f x\\<bar>\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. f x * indicat_real A x) \\<in> borel_measurable M\n 2. \\<And>n.\n       (\\<lambda>x. (F (n + 1) x - F n (T x)) * indicat_real A x)\n       \\<in> borel_measurable M", "qed (simp_all)"], ["proof (state)\nthis:\n  (\\<lambda>n. LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x)\n  \\<longlonglongrightarrow> LINT x|M. f x * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "have \"(\\<integral>x. (F (n+1) x - F n (T x)) * indicator A x \\<partial>M) \\<ge> 0\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "have \"(\\<integral>x. F n (T x) * indicator A x \\<partial>M) = (\\<integral>x. (\\<lambda>x. F n x * indicator A x) (T x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. F n (T x) * indicat_real A x =\n    LINT x|M. F n (T x) * indicat_real A (T x)", "by (rule Bochner_Integration.integral_cong, auto simp add: Ainv indicator_def)"], ["proof (state)\nthis:\n  LINT x|M. F n (T x) * indicat_real A x =\n  LINT x|M. F n (T x) * indicat_real A (T x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "also"], ["proof (state)\nthis:\n  LINT x|M. F n (T x) * indicat_real A x =\n  LINT x|M. F n (T x) * indicat_real A (T x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "have \"... = (\\<integral>x. F n x * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. F n (T x) * indicat_real A (T x) =\n    LINT x|M. F n x * indicat_real A x", "by (rule T_integral_preserving, auto simp add: intFn integrable_real_mult_indicator)"], ["proof (state)\nthis:\n  LINT x|M. F n (T x) * indicat_real A (T x) =\n  LINT x|M. F n x * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "finally"], ["proof (chain)\npicking this:\n  LINT x|M. F n (T x) * indicat_real A x =\n  LINT x|M. F n x * indicat_real A x", "have i: \"(\\<integral>x. F n (T x) * indicator A x \\<partial>M) = (\\<integral>x. F n x * indicator A x \\<partial>M)\""], ["proof (prove)\nusing this:\n  LINT x|M. F n (T x) * indicat_real A x =\n  LINT x|M. F n x * indicat_real A x\n\ngoal (1 subgoal):\n 1. LINT x|M. F n (T x) * indicat_real A x =\n    LINT x|M. F n x * indicat_real A x", "by simp"], ["proof (state)\nthis:\n  LINT x|M. F n (T x) * indicat_real A x =\n  LINT x|M. F n x * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "have \"(\\<integral>x. (F (n+1) x - F n (T x)) * indicator A x \\<partial>M) = (\\<integral>x. F (n+1) x * indicator A x - F n (T x) * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x =\n    LINT x|M. F (n + 1) x * indicat_real A x - F n (T x) * indicat_real A x", "by (simp add: mult.commute right_diff_distrib)"], ["proof (state)\nthis:\n  LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x =\n  LINT x|M. F (n + 1) x * indicat_real A x - F n (T x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "also"], ["proof (state)\nthis:\n  LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x =\n  LINT x|M. F (n + 1) x * indicat_real A x - F n (T x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "have \"... = (\\<integral>x. F (n+1) x * indicator A x \\<partial>M) - (\\<integral>x. F n (T x) * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M.\n       F (n + 1) x * indicat_real A x - F n (T x) * indicat_real A x =\n    (LINT x|M. F (n + 1) x * indicat_real A x) -\n    (LINT x|M. F n (T x) * indicat_real A x)", "by (rule Bochner_Integration.integral_diff, auto simp add: intFn integrable_real_mult_indicator T_meas T_integral_preserving(1))"], ["proof (state)\nthis:\n  LINT x|M. F (n + 1) x * indicat_real A x - F n (T x) * indicat_real A x =\n  (LINT x|M. F (n + 1) x * indicat_real A x) -\n  (LINT x|M. F n (T x) * indicat_real A x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "also"], ["proof (state)\nthis:\n  LINT x|M. F (n + 1) x * indicat_real A x - F n (T x) * indicat_real A x =\n  (LINT x|M. F (n + 1) x * indicat_real A x) -\n  (LINT x|M. F n (T x) * indicat_real A x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "have \"... = (\\<integral>x. F (n+1) x * indicator A x \\<partial>M) - (\\<integral>x. F n x * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (LINT x|M. F (n + 1) x * indicat_real A x) -\n    (LINT x|M. F n (T x) * indicat_real A x) =\n    (LINT x|M. F (n + 1) x * indicat_real A x) -\n    (LINT x|M. F n x * indicat_real A x)", "using i"], ["proof (prove)\nusing this:\n  LINT x|M. F n (T x) * indicat_real A x =\n  LINT x|M. F n x * indicat_real A x\n\ngoal (1 subgoal):\n 1. (LINT x|M. F (n + 1) x * indicat_real A x) -\n    (LINT x|M. F n (T x) * indicat_real A x) =\n    (LINT x|M. F (n + 1) x * indicat_real A x) -\n    (LINT x|M. F n x * indicat_real A x)", "by simp"], ["proof (state)\nthis:\n  (LINT x|M. F (n + 1) x * indicat_real A x) -\n  (LINT x|M. F n (T x) * indicat_real A x) =\n  (LINT x|M. F (n + 1) x * indicat_real A x) -\n  (LINT x|M. F n x * indicat_real A x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "also"], ["proof (state)\nthis:\n  (LINT x|M. F (n + 1) x * indicat_real A x) -\n  (LINT x|M. F n (T x) * indicat_real A x) =\n  (LINT x|M. F (n + 1) x * indicat_real A x) -\n  (LINT x|M. F n x * indicat_real A x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "have \"... = (\\<integral>x. F (n+1) x * indicator A x - F n x * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (LINT x|M. F (n + 1) x * indicat_real A x) -\n    (LINT x|M. F n x * indicat_real A x) =\n    LINT x|M. F (n + 1) x * indicat_real A x - F n x * indicat_real A x", "by (rule Bochner_Integration.integral_diff[symmetric], auto simp add: intFn integrable_real_mult_indicator)"], ["proof (state)\nthis:\n  (LINT x|M. F (n + 1) x * indicat_real A x) -\n  (LINT x|M. F n x * indicat_real A x) =\n  LINT x|M. F (n + 1) x * indicat_real A x - F n x * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "also"], ["proof (state)\nthis:\n  (LINT x|M. F (n + 1) x * indicat_real A x) -\n  (LINT x|M. F n x * indicat_real A x) =\n  LINT x|M. F (n + 1) x * indicat_real A x - F n x * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "have \"... = (\\<integral>x. (F (n+1) x - F n x) * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. F (n + 1) x * indicat_real A x - F n x * indicat_real A x =\n    LINT x|M. (F (n + 1) x - F n x) * indicat_real A x", "by (simp add: mult.commute right_diff_distrib)"], ["proof (state)\nthis:\n  LINT x|M. F (n + 1) x * indicat_real A x - F n x * indicat_real A x =\n  LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "finally"], ["proof (chain)\npicking this:\n  LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x =\n  LINT x|M. (F (n + 1) x - F n x) * indicat_real A x", "have *: \"(\\<integral>x. (F (n+1) x - F n (T x)) * indicator A x \\<partial>M) = (\\<integral>x. (F (n+1) x - F n x) * indicator A x \\<partial>M)\""], ["proof (prove)\nusing this:\n  LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x =\n  LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x =\n    LINT x|M. (F (n + 1) x - F n x) * indicat_real A x", "by simp"], ["proof (state)\nthis:\n  LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x =\n  LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "have \"F n x \\<le> F (n+1) x\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. F n x \\<le> F (n + 1) x", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (MAX k\\<in>{0..n}. birkhoff_sum f k x)\n    \\<le> (MAX k\\<in>{0..n + 1}. birkhoff_sum f k x)", "by (rule Max_mono, auto)"], ["proof (state)\nthis:\n  F n ?x3 \\<le> F (n + 1) ?x3\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  F n ?x3 \\<le> F (n + 1) ?x3", "have \"(F (n+1) x - F n x) * indicator A x \\<ge> 0\" for x"], ["proof (prove)\nusing this:\n  F n ?x3 \\<le> F (n + 1) ?x3\n\ngoal (1 subgoal):\n 1. 0 \\<le> (F (n + 1) x - F n x) * indicat_real A x", "by simp"], ["proof (state)\nthis:\n  0 \\<le> (F (n + 1) ?x3 - F n ?x3) * indicat_real A ?x3\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  0 \\<le> (F (n + 1) ?x3 - F n ?x3) * indicat_real A ?x3", "have \"integral\\<^sup>L M (\\<lambda>x. 0) \\<le> integral\\<^sup>L M (\\<lambda>x. (F (n+1) x - F n x) * indicator A x)\""], ["proof (prove)\nusing this:\n  0 \\<le> (F (n + 1) ?x3 - F n ?x3) * indicat_real A ?x3\n\ngoal (1 subgoal):\n 1. LINT x|M. 0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x", "by (auto simp add: intFn integrable_real_mult_indicator intro: integral_mono)"], ["proof (state)\nthis:\n  LINT x|M. 0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  LINT x|M. 0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x", "have \"(\\<integral>x. (F (n+1) x - F n x) * indicator A x \\<partial>M) \\<ge> 0\""], ["proof (prove)\nusing this:\n  LINT x|M. 0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x", "by simp"], ["proof (state)\nthis:\n  0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x", "show \"(\\<integral>x. (F (n+1) x - F n (T x)) * indicator A x \\<partial>M) \\<ge> 0\""], ["proof (prove)\nusing this:\n  0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "using *"], ["proof (prove)\nusing this:\n  0 \\<le> LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n  LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x =\n  LINT x|M. (F (n + 1) x - F n x) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x", "by simp"], ["proof (state)\nthis:\n  0 \\<le> LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  0 \\<le> LINT x|M. (F (?n3 + 1) x - F ?n3 (T x)) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "then"], ["proof (chain)\npicking this:\n  0 \\<le> LINT x|M. (F (?n3 + 1) x - F ?n3 (T x)) * indicat_real A x", "show \"(\\<integral>x. f x * indicator A x \\<partial>M) \\<ge> 0\""], ["proof (prove)\nusing this:\n  0 \\<le> LINT x|M. (F (?n3 + 1) x - F ?n3 (T x)) * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "using lim"], ["proof (prove)\nusing this:\n  0 \\<le> LINT x|M. (F (?n3 + 1) x - F ?n3 (T x)) * indicat_real A x\n  (\\<lambda>n. LINT x|M. (F (n + 1) x - F n (T x)) * indicat_real A x)\n  \\<longlonglongrightarrow> LINT x|M. f x * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. f x * indicat_real A x", "by (simp add: LIMSEQ_le_const)"], ["proof (state)\nthis:\n  0 \\<le> LINT x|M. f x * indicat_real A x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma birkhoff_aux2:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. limsup (\\<lambda>n. ereal(birkhoff_sum f n x / n)) \\<le> real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "fix \\<epsilon>"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "assume \"\\<epsilon> > (0::real)\""], ["proof (state)\nthis:\n  0 < \\<epsilon>\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "define g where \"g = (\\<lambda>x. f x - real_cond_exp M Invariants f x - \\<epsilon>)\""], ["proof (state)\nthis:\n  g = (\\<lambda>x. f x - real_cond_exp M Invariants f x - \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  g = (\\<lambda>x. f x - real_cond_exp M Invariants f x - \\<epsilon>)", "have intg: \"integrable M g\""], ["proof (prove)\nusing this:\n  g = (\\<lambda>x. f x - real_cond_exp M Invariants f x - \\<epsilon>)\n\ngoal (1 subgoal):\n 1. integrable M g", "using assms real_cond_exp_int(1) assms"], ["proof (prove)\nusing this:\n  g = (\\<lambda>x. f x - real_cond_exp M Invariants f x - \\<epsilon>)\n  integrable M f\n  integrable M ?f \\<Longrightarrow>\n  integrable M (real_cond_exp M Invariants ?f)\n  integrable M f\n\ngoal (1 subgoal):\n 1. integrable M g", "by auto"], ["proof (state)\nthis:\n  integrable M g\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "define A where \"A = {x \\<in> space M. limsup (\\<lambda>n. ereal(birkhoff_sum g n x)) = \\<infinity>}\""], ["proof (state)\nthis:\n  A =\n  {x \\<in> space M.\n   limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) = \\<infinity>}\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have Ag: \"A \\<in> sets Invariants\" \"(\\<integral>x. g x * indicator A x \\<partial>M) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<in> sets Invariants &&& 0 \\<le> LINT x|M. g x * indicat_real A x", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) = \\<infinity>}\n    \\<in> sets Invariants &&&\n    0 \\<le> LINT x|M.\n               g x *\n               indicat_real\n                {x \\<in> space M.\n                 limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) =\n                 \\<infinity>}\n                x", "by (rule birkhoff_aux1[where ?f = g, OF intg])+"], ["proof (state)\nthis:\n  A \\<in> sets Invariants\n  0 \\<le> LINT x|M. g x * indicat_real A x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  A \\<in> sets Invariants\n  0 \\<le> LINT x|M. g x * indicat_real A x", "have [measurable]: \"A \\<in> sets M\""], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n  0 \\<le> LINT x|M. g x * indicat_real A x\n\ngoal (1 subgoal):\n 1. A \\<in> sets M", "by (simp add: Invariants_in_sets)"], ["proof (state)\nthis:\n  A \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have eq: \"(\\<integral>x. indicator A x * real_cond_exp M Invariants f x \\<partial>M) = (\\<integral>x. indicator A x * f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. indicat_real A x * real_cond_exp M Invariants f x =\n    LINT x|M. indicat_real A x * f x", "proof (rule real_cond_exp_intg[where ?f = \"\\<lambda>x. (indicator A x)::real\" and ?g = f])"], ["proof (state)\ngoal (3 subgoals):\n 1. integrable M (\\<lambda>x. indicat_real A x * f x)\n 2. indicat_real A \\<in> borel_measurable Invariants\n 3. f \\<in> borel_measurable M", "have \"(\\<lambda>x. indicator A x * f x) = (\\<lambda>x. f x * indicator A x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. indicat_real A x * f x) =\n    (\\<lambda>x. f x * indicat_real A x)", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>x. indicat_real A x * f x) =\n  (\\<lambda>x. f x * indicat_real A x)\n\ngoal (3 subgoals):\n 1. integrable M (\\<lambda>x. indicat_real A x * f x)\n 2. indicat_real A \\<in> borel_measurable Invariants\n 3. f \\<in> borel_measurable M", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>x. indicat_real A x * f x) =\n  (\\<lambda>x. f x * indicat_real A x)", "show \"integrable M (\\<lambda>x. indicator A x * f x)\""], ["proof (prove)\nusing this:\n  (\\<lambda>x. indicat_real A x * f x) =\n  (\\<lambda>x. f x * indicat_real A x)\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. indicat_real A x * f x)", "using integrable_real_mult_indicator[OF \\<open>A \\<in> sets M\\<close> assms]"], ["proof (prove)\nusing this:\n  (\\<lambda>x. indicat_real A x * f x) =\n  (\\<lambda>x. f x * indicat_real A x)\n  integrable M (\\<lambda>x. f x * indicat_real A x)\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. indicat_real A x * f x)", "by simp"], ["proof (state)\nthis:\n  integrable M (\\<lambda>x. indicat_real A x * f x)\n\ngoal (2 subgoals):\n 1. indicat_real A \\<in> borel_measurable Invariants\n 2. f \\<in> borel_measurable M", "show \"indicator A \\<in> borel_measurable Invariants\""], ["proof (prove)\ngoal (1 subgoal):\n 1. indicator A \\<in> borel_measurable Invariants", "using \\<open>A \\<in> sets Invariants\\<close>"], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n\ngoal (1 subgoal):\n 1. indicator A \\<in> borel_measurable Invariants", "by measurable"], ["proof (state)\nthis:\n  indicator A \\<in> borel_measurable Invariants\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable M", "qed (simp)"], ["proof (state)\nthis:\n  LINT x|M. indicat_real A x * real_cond_exp M Invariants f x =\n  LINT x|M. indicat_real A x * f x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"0 \\<le> (\\<integral>x. g x * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. g x * indicat_real A x", "using Ag"], ["proof (prove)\nusing this:\n  A \\<in> sets Invariants\n  0 \\<le> LINT x|M. g x * indicat_real A x\n\ngoal (1 subgoal):\n 1. 0 \\<le> LINT x|M. g x * indicat_real A x", "by simp"], ["proof (state)\nthis:\n  0 \\<le> LINT x|M. g x * indicat_real A x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "also"], ["proof (state)\nthis:\n  0 \\<le> LINT x|M. g x * indicat_real A x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"... = (\\<integral>x. f x * indicator A x - real_cond_exp M Invariants f x * indicator A x - \\<epsilon> * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. g x * indicat_real A x =\n    LINT x|M.\n       f x * indicat_real A x -\n       real_cond_exp M Invariants f x * indicat_real A x -\n       \\<epsilon> * indicat_real A x", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M.\n       (f x - real_cond_exp M Invariants f x - \\<epsilon>) *\n       indicat_real A x =\n    LINT x|M.\n       f x * indicat_real A x -\n       real_cond_exp M Invariants f x * indicat_real A x -\n       \\<epsilon> * indicat_real A x", "by (simp add: left_diff_distrib)"], ["proof (state)\nthis:\n  LINT x|M. g x * indicat_real A x =\n  LINT x|M.\n     f x * indicat_real A x -\n     real_cond_exp M Invariants f x * indicat_real A x -\n     \\<epsilon> * indicat_real A x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "also"], ["proof (state)\nthis:\n  LINT x|M. g x * indicat_real A x =\n  LINT x|M.\n     f x * indicat_real A x -\n     real_cond_exp M Invariants f x * indicat_real A x -\n     \\<epsilon> * indicat_real A x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"... = (\\<integral>x. f x * indicator A x \\<partial>M) - (\\<integral>x. real_cond_exp M Invariants f x * indicator A x \\<partial>M) - (\\<integral>x. \\<epsilon> * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M.\n       f x * indicat_real A x -\n       real_cond_exp M Invariants f x * indicat_real A x -\n       \\<epsilon> * indicat_real A x =\n    (LINT x|M. f x * indicat_real A x) -\n    (LINT x|M. real_cond_exp M Invariants f x * indicat_real A x) -\n    (LINT x|M. \\<epsilon> * indicat_real A x)", "using assms real_cond_exp_int(1)[OF assms] integrable_real_mult_indicator[OF \\<open>A \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  integrable M f\n  integrable M (real_cond_exp M Invariants f)\n  integrable M ?f \\<Longrightarrow>\n  integrable M (\\<lambda>x. ?f x * indicat_real A x)\n\ngoal (1 subgoal):\n 1. LINT x|M.\n       f x * indicat_real A x -\n       real_cond_exp M Invariants f x * indicat_real A x -\n       \\<epsilon> * indicat_real A x =\n    (LINT x|M. f x * indicat_real A x) -\n    (LINT x|M. real_cond_exp M Invariants f x * indicat_real A x) -\n    (LINT x|M. \\<epsilon> * indicat_real A x)", "by (auto simp: simp del: integrable_mult_left_iff)"], ["proof (state)\nthis:\n  LINT x|M.\n     f x * indicat_real A x -\n     real_cond_exp M Invariants f x * indicat_real A x -\n     \\<epsilon> * indicat_real A x =\n  (LINT x|M. f x * indicat_real A x) -\n  (LINT x|M. real_cond_exp M Invariants f x * indicat_real A x) -\n  (LINT x|M. \\<epsilon> * indicat_real A x)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "also"], ["proof (state)\nthis:\n  LINT x|M.\n     f x * indicat_real A x -\n     real_cond_exp M Invariants f x * indicat_real A x -\n     \\<epsilon> * indicat_real A x =\n  (LINT x|M. f x * indicat_real A x) -\n  (LINT x|M. real_cond_exp M Invariants f x * indicat_real A x) -\n  (LINT x|M. \\<epsilon> * indicat_real A x)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"... = - (\\<integral>x. \\<epsilon> * indicator A x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (LINT x|M. f x * indicat_real A x) -\n    (LINT x|M. real_cond_exp M Invariants f x * indicat_real A x) -\n    (LINT x|M. \\<epsilon> * indicat_real A x) =\n    - (LINT x|M. \\<epsilon> * indicat_real A x)", "by (auto simp add: eq mult.commute)"], ["proof (state)\nthis:\n  (LINT x|M. f x * indicat_real A x) -\n  (LINT x|M. real_cond_exp M Invariants f x * indicat_real A x) -\n  (LINT x|M. \\<epsilon> * indicat_real A x) =\n  - (LINT x|M. \\<epsilon> * indicat_real A x)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "also"], ["proof (state)\nthis:\n  (LINT x|M. f x * indicat_real A x) -\n  (LINT x|M. real_cond_exp M Invariants f x * indicat_real A x) -\n  (LINT x|M. \\<epsilon> * indicat_real A x) =\n  - (LINT x|M. \\<epsilon> * indicat_real A x)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"... = - \\<epsilon> * measure M A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - (LINT x|M. \\<epsilon> * indicat_real A x) =\n    - \\<epsilon> * Sigma_Algebra.measure M A", "by auto"], ["proof (state)\nthis:\n  - (LINT x|M. \\<epsilon> * indicat_real A x) =\n  - \\<epsilon> * Sigma_Algebra.measure M A\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "finally"], ["proof (chain)\npicking this:\n  0 \\<le> - \\<epsilon> * Sigma_Algebra.measure M A", "have \"0 \\<le> - \\<epsilon> * measure M A\""], ["proof (prove)\nusing this:\n  0 \\<le> - \\<epsilon> * Sigma_Algebra.measure M A\n\ngoal (1 subgoal):\n 1. 0 \\<le> - \\<epsilon> * Sigma_Algebra.measure M A", "by simp"], ["proof (state)\nthis:\n  0 \\<le> - \\<epsilon> * Sigma_Algebra.measure M A\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  0 \\<le> - \\<epsilon> * Sigma_Algebra.measure M A", "have \"measure M A = 0\""], ["proof (prove)\nusing this:\n  0 \\<le> - \\<epsilon> * Sigma_Algebra.measure M A\n\ngoal (1 subgoal):\n 1. Sigma_Algebra.measure M A = 0", "using \\<open>\\<epsilon> > 0\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> - \\<epsilon> * Sigma_Algebra.measure M A\n  0 < \\<epsilon>\n\ngoal (1 subgoal):\n 1. Sigma_Algebra.measure M A = 0", "by (simp add: measure_le_0_iff mult_le_0_iff)"], ["proof (state)\nthis:\n  Sigma_Algebra.measure M A = 0\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  Sigma_Algebra.measure M A = 0", "have \"A \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  Sigma_Algebra.measure M A = 0\n\ngoal (1 subgoal):\n 1. A \\<in> null_sets M", "by (simp add: emeasure_eq_measure null_setsI)"], ["proof (state)\nthis:\n  A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  A \\<in> null_sets M", "have \"AE x in M. x \\<in> space M - A\""], ["proof (prove)\nusing this:\n  A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> space M - A", "by (metis (no_types, lifting) AE_cong Diff_iff AE_not_in)"], ["proof (state)\nthis:\n  AE x in M. x \\<in> space M - A\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "moreover"], ["proof (state)\nthis:\n  AE x in M. x \\<in> space M - A\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "{"], ["proof (state)\nthis:\n  AE x in M. x \\<in> space M - A\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "assume \"x \\<in> space M - A\""], ["proof (state)\nthis:\n  x \\<in> space M - A\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  x \\<in> space M - A", "have \"limsup (\\<lambda>n. ereal(birkhoff_sum g n x)) < \\<infinity>\""], ["proof (prove)\nusing this:\n  x \\<in> space M - A\n\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) < \\<infinity>", "unfolding A_def"], ["proof (prove)\nusing this:\n  x \\<in> space M -\n          {x \\<in> space M.\n           limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) = \\<infinity>}\n\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) < \\<infinity>", "by auto"], ["proof (state)\nthis:\n  limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) < \\<infinity>\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) < \\<infinity>", "obtain C where C: \"\\<And>n. birkhoff_sum g n x \\<le> C\""], ["proof (prove)\nusing this:\n  limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) < \\<infinity>\n\ngoal (1 subgoal):\n 1. (\\<And>C.\n        (\\<And>n. birkhoff_sum g n x \\<le> C) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using limsup_finite_then_bounded"], ["proof (prove)\nusing this:\n  limsup (\\<lambda>n. ereal (birkhoff_sum g n x)) < \\<infinity>\n  limsup (\\<lambda>x. ereal (?u x)) < \\<infinity> \\<Longrightarrow>\n  \\<exists>C. \\<forall>n. ?u n \\<le> C\n\ngoal (1 subgoal):\n 1. (\\<And>C.\n        (\\<And>n. birkhoff_sum g n x \\<le> C) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by presburger"], ["proof (state)\nthis:\n  birkhoff_sum g ?n3 x \\<le> C\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "{"], ["proof (state)\nthis:\n  birkhoff_sum g ?n3 x \\<le> C\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "fix n::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "assume \"n > 0\""], ["proof (state)\nthis:\n  0 < n\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"birkhoff_sum g n x = birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum (\\<lambda>x. \\<epsilon>) n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum g n x =\n    birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x -\n    birkhoff_sum (\\<lambda>x. \\<epsilon>) n x", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum\n     (\\<lambda>x. f x - real_cond_exp M Invariants f x - \\<epsilon>) n x =\n    birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x -\n    birkhoff_sum (\\<lambda>x. \\<epsilon>) n x", "using birkhoff_sum_add birkhoff_sum_diff"], ["proof (prove)\nusing this:\n  birkhoff_sum (\\<lambda>x. ?f x + ?g x) ?n ?x =\n  birkhoff_sum ?f ?n ?x + birkhoff_sum ?g ?n ?x\n  birkhoff_sum (\\<lambda>x. ?f x - ?g x) ?n ?x =\n  birkhoff_sum ?f ?n ?x - birkhoff_sum ?g ?n ?x\n\ngoal (1 subgoal):\n 1. birkhoff_sum\n     (\\<lambda>x. f x - real_cond_exp M Invariants f x - \\<epsilon>) n x =\n    birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x -\n    birkhoff_sum (\\<lambda>x. \\<epsilon>) n x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x -\n  birkhoff_sum (\\<lambda>x. \\<epsilon>) n x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "moreover"], ["proof (state)\nthis:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x -\n  birkhoff_sum (\\<lambda>x. \\<epsilon>) n x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"birkhoff_sum (real_cond_exp M Invariants f) n x = n * real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (real_cond_exp M Invariants f) n x =\n    real n * real_cond_exp M Invariants f x", "using birkhoff_sum_of_invariants"], ["proof (prove)\nusing this:\n  \\<lbrakk>?f \\<in> borel_measurable Invariants; ?x \\<in> space M\\<rbrakk>\n  \\<Longrightarrow> birkhoff_sum ?f ?n ?x = real ?n * ?f ?x\n\ngoal (1 subgoal):\n 1. birkhoff_sum (real_cond_exp M Invariants f) n x =\n    real n * real_cond_exp M Invariants f x", "using \\<open>x \\<in> space M - A\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>?f \\<in> borel_measurable Invariants; ?x \\<in> space M\\<rbrakk>\n  \\<Longrightarrow> birkhoff_sum ?f ?n ?x = real ?n * ?f ?x\n  x \\<in> space M - A\n\ngoal (1 subgoal):\n 1. birkhoff_sum (real_cond_exp M Invariants f) n x =\n    real n * real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum (real_cond_exp M Invariants f) n x =\n  real n * real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "moreover"], ["proof (state)\nthis:\n  birkhoff_sum (real_cond_exp M Invariants f) n x =\n  real n * real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"birkhoff_sum (\\<lambda>x. \\<epsilon>) n x = n * \\<epsilon>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. \\<epsilon>) n x = real n * \\<epsilon>", "unfolding birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n. \\<epsilon>) = real n * \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum (\\<lambda>x. \\<epsilon>) n x = real n * \\<epsilon>\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "ultimately"], ["proof (chain)\npicking this:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x -\n  birkhoff_sum (\\<lambda>x. \\<epsilon>) n x\n  birkhoff_sum (real_cond_exp M Invariants f) n x =\n  real n * real_cond_exp M Invariants f x\n  birkhoff_sum (\\<lambda>x. \\<epsilon>) n x = real n * \\<epsilon>", "have \"birkhoff_sum g n x = birkhoff_sum f n x - n * real_cond_exp M Invariants f x - n * \\<epsilon>\""], ["proof (prove)\nusing this:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x -\n  birkhoff_sum (\\<lambda>x. \\<epsilon>) n x\n  birkhoff_sum (real_cond_exp M Invariants f) n x =\n  real n * real_cond_exp M Invariants f x\n  birkhoff_sum (\\<lambda>x. \\<epsilon>) n x = real n * \\<epsilon>\n\ngoal (1 subgoal):\n 1. birkhoff_sum g n x =\n    birkhoff_sum f n x - real n * real_cond_exp M Invariants f x -\n    real n * \\<epsilon>", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - real n * real_cond_exp M Invariants f x -\n  real n * \\<epsilon>\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - real n * real_cond_exp M Invariants f x -\n  real n * \\<epsilon>", "have \"birkhoff_sum f n x = birkhoff_sum g n x + n * real_cond_exp M Invariants f x + n * \\<epsilon>\""], ["proof (prove)\nusing this:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - real n * real_cond_exp M Invariants f x -\n  real n * \\<epsilon>\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x =\n    birkhoff_sum g n x + real n * real_cond_exp M Invariants f x +\n    real n * \\<epsilon>", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum f n x =\n  birkhoff_sum g n x + real n * real_cond_exp M Invariants f x +\n  real n * \\<epsilon>\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f n x =\n  birkhoff_sum g n x + real n * real_cond_exp M Invariants f x +\n  real n * \\<epsilon>", "have \"birkhoff_sum f n x / n = birkhoff_sum g n x / n + real_cond_exp M Invariants f x + \\<epsilon>\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n x =\n  birkhoff_sum g n x + real n * real_cond_exp M Invariants f x +\n  real n * \\<epsilon>\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x / real n =\n    birkhoff_sum g n x / real n + real_cond_exp M Invariants f x +\n    \\<epsilon>", "using \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  birkhoff_sum f n x =\n  birkhoff_sum g n x + real n * real_cond_exp M Invariants f x +\n  real n * \\<epsilon>\n  0 < n\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x / real n =\n    birkhoff_sum g n x / real n + real_cond_exp M Invariants f x +\n    \\<epsilon>", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  birkhoff_sum f n x / real n =\n  birkhoff_sum g n x / real n + real_cond_exp M Invariants f x + \\<epsilon>\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f n x / real n =\n  birkhoff_sum g n x / real n + real_cond_exp M Invariants f x + \\<epsilon>", "have \"birkhoff_sum f n x / n \\<le> C/n + real_cond_exp M Invariants f x + \\<epsilon>\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n x / real n =\n  birkhoff_sum g n x / real n + real_cond_exp M Invariants f x + \\<epsilon>\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x / real n\n    \\<le> C / real n + real_cond_exp M Invariants f x + \\<epsilon>", "using C[of n] \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  birkhoff_sum f n x / real n =\n  birkhoff_sum g n x / real n + real_cond_exp M Invariants f x + \\<epsilon>\n  birkhoff_sum g n x \\<le> C\n  0 < n\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x / real n\n    \\<le> C / real n + real_cond_exp M Invariants f x + \\<epsilon>", "by (simp add: divide_right_mono)"], ["proof (state)\nthis:\n  birkhoff_sum f n x / real n\n  \\<le> C / real n + real_cond_exp M Invariants f x + \\<epsilon>\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f n x / real n\n  \\<le> C / real n + real_cond_exp M Invariants f x + \\<epsilon>", "have \"ereal(birkhoff_sum f n x / n) \\<le> ereal(C/n + real_cond_exp M Invariants f x + \\<epsilon>)\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n x / real n\n  \\<le> C / real n + real_cond_exp M Invariants f x + \\<epsilon>\n\ngoal (1 subgoal):\n 1. ereal (birkhoff_sum f n x / real n)\n    \\<le> ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)", "by simp"], ["proof (state)\nthis:\n  ereal (birkhoff_sum f n x / real n)\n  \\<le> ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "}"], ["proof (state)\nthis:\n  0 < ?n5 \\<Longrightarrow>\n  ereal (birkhoff_sum f ?n5 x / real ?n5)\n  \\<le> ereal (C / real ?n5 + real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  0 < ?n5 \\<Longrightarrow>\n  ereal (birkhoff_sum f ?n5 x / real ?n5)\n  \\<le> ereal (C / real ?n5 + real_cond_exp M Invariants f x + \\<epsilon>)", "have \"eventually (\\<lambda>n. ereal(birkhoff_sum f n x / n) \\<le> ereal(C/n + real_cond_exp M Invariants f x + \\<epsilon>)) sequentially\""], ["proof (prove)\nusing this:\n  0 < ?n5 \\<Longrightarrow>\n  ereal (birkhoff_sum f ?n5 x / real ?n5)\n  \\<le> ereal (C / real ?n5 + real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       ereal (birkhoff_sum f n x / real n)\n       \\<le> ereal\n              (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)", "by (simp add: eventually_at_top_dense)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (birkhoff_sum f n x / real n)\n     \\<le> ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (birkhoff_sum f n x / real n)\n     \\<le> ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)", "have b: \"limsup (\\<lambda>n. ereal(birkhoff_sum f n x / n)) \\<le> limsup (\\<lambda>n. ereal(C/n + real_cond_exp M Invariants f x + \\<epsilon>))\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (birkhoff_sum f n x / real n)\n     \\<le> ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n    \\<le> limsup\n           (\\<lambda>xa.\n               ereal\n                (C / real xa + real_cond_exp M Invariants f x + \\<epsilon>))", "by (simp add: Limsup_mono)"], ["proof (state)\nthis:\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  \\<le> limsup\n         (\\<lambda>xa.\n             ereal\n              (C / real xa + real_cond_exp M Invariants f x + \\<epsilon>))\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "have \"(\\<lambda>n. ereal(C*(1/real n) + real_cond_exp M Invariants f x + \\<epsilon>)) \\<longlonglongrightarrow> ereal(C * 0 + real_cond_exp M Invariants f x + \\<epsilon>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        ereal\n         (C * (1 / real n) + real_cond_exp M Invariants f x + \\<epsilon>))\n    \\<longlonglongrightarrow> ereal\n                               (C * 0 + real_cond_exp M Invariants f x +\n                                \\<epsilon>)", "by (intro tendsto_intros)"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      ereal\n       (C * (1 / real n) + real_cond_exp M Invariants f x + \\<epsilon>))\n  \\<longlonglongrightarrow> ereal\n                             (C * 0 + real_cond_exp M Invariants f x +\n                              \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n.\n      ereal\n       (C * (1 / real n) + real_cond_exp M Invariants f x + \\<epsilon>))\n  \\<longlonglongrightarrow> ereal\n                             (C * 0 + real_cond_exp M Invariants f x +\n                              \\<epsilon>)", "have \"limsup (\\<lambda>n. ereal(C/real n + real_cond_exp M Invariants f x + \\<epsilon>)) = real_cond_exp M Invariants f x + \\<epsilon>\""], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      ereal\n       (C * (1 / real n) + real_cond_exp M Invariants f x + \\<epsilon>))\n  \\<longlonglongrightarrow> ereal\n                             (C * 0 + real_cond_exp M Invariants f x +\n                              \\<epsilon>)\n\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>n.\n         ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)) =\n    ereal (real_cond_exp M Invariants f x + \\<epsilon>)", "using sequentially_bot tendsto_iff_Liminf_eq_Limsup"], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      ereal\n       (C * (1 / real n) + real_cond_exp M Invariants f x + \\<epsilon>))\n  \\<longlonglongrightarrow> ereal\n                             (C * 0 + real_cond_exp M Invariants f x +\n                              \\<epsilon>)\n  sequentially \\<noteq> \\<bottom>\n  ?F \\<noteq> \\<bottom> \\<Longrightarrow>\n  (?f \\<longlongrightarrow> ?f0.0) ?F =\n  (Liminf ?F ?f = ?f0.0 \\<and> Limsup ?F ?f = ?f0.0)\n\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>n.\n         ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)) =\n    ereal (real_cond_exp M Invariants f x + \\<epsilon>)", "by force"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>n.\n       ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)) =\n  ereal (real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  limsup\n   (\\<lambda>n.\n       ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)) =\n  ereal (real_cond_exp M Invariants f x + \\<epsilon>)", "have \"limsup (\\<lambda>n. ereal(birkhoff_sum f n x / n)) \\<le> real_cond_exp M Invariants f x + \\<epsilon>\""], ["proof (prove)\nusing this:\n  limsup\n   (\\<lambda>n.\n       ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)) =\n  ereal (real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n    \\<le> ereal (real_cond_exp M Invariants f x + \\<epsilon>)", "using b"], ["proof (prove)\nusing this:\n  limsup\n   (\\<lambda>n.\n       ereal (C / real n + real_cond_exp M Invariants f x + \\<epsilon>)) =\n  ereal (real_cond_exp M Invariants f x + \\<epsilon>)\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  \\<le> limsup\n         (\\<lambda>xa.\n             ereal\n              (C / real xa + real_cond_exp M Invariants f x + \\<epsilon>))\n\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n    \\<le> ereal (real_cond_exp M Invariants f x + \\<epsilon>)", "by simp"], ["proof (state)\nthis:\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  \\<le> ereal (real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "}"], ["proof (state)\nthis:\n  ?x5 \\<in> space M - A \\<Longrightarrow>\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n ?x5 / real n))\n  \\<le> ereal (real_cond_exp M Invariants f ?x5 + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. x \\<in> space M - A\n  ?x5 \\<in> space M - A \\<Longrightarrow>\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n ?x5 / real n))\n  \\<le> ereal (real_cond_exp M Invariants f ?x5 + \\<epsilon>)", "have \"AE x in M. limsup (\\<lambda>n. ereal(birkhoff_sum f n x / n)) \\<le> real_cond_exp M Invariants f x + \\<epsilon>\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<in> space M - A\n  ?x5 \\<in> space M - A \\<Longrightarrow>\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n ?x5 / real n))\n  \\<le> ereal (real_cond_exp M Invariants f ?x5 + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x + \\<epsilon>)", "by auto"], ["proof (state)\nthis:\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x + \\<epsilon>)", "have \"AE x in M. limsup (\\<lambda>n. ereal(birkhoff_sum f n x / n)) \\<le> ereal(real_cond_exp M Invariants f x) + \\<epsilon>\""], ["proof (prove)\nusing this:\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x + \\<epsilon>)\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x) +\n                     ereal \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x) + ereal \\<epsilon>\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "}"], ["proof (state)\nthis:\n  0 < ?\\<epsilon>5 \\<Longrightarrow>\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x) +\n                   ereal ?\\<epsilon>5\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "then"], ["proof (chain)\npicking this:\n  0 < ?\\<epsilon>5 \\<Longrightarrow>\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x) +\n                   ereal ?\\<epsilon>5", "show ?thesis"], ["proof (prove)\nusing this:\n  0 < ?\\<epsilon>5 \\<Longrightarrow>\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x) +\n                   ereal ?\\<epsilon>5\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "by (rule AE_upper_bound_inf_ereal)"], ["proof (state)\nthis:\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x)\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem birkhoff_theorem_AE_nonergodic:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes \"integrable M f\"\n  shows \"AE x in M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "assume i: \"limsup (\\<lambda>n. ereal(birkhoff_sum f n x /n)) \\<le> real_cond_exp M Invariants f x\"\n             and ii: \"limsup (\\<lambda>n. ereal(birkhoff_sum (\\<lambda>x. -f x) n x / n)) \\<le> real_cond_exp M Invariants (\\<lambda>x. -f x) x\"\n             and iii: \"real_cond_exp M Invariants (\\<lambda>x. -f x) x = - real_cond_exp M Invariants f x\""], ["proof (state)\nthis:\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  \\<le> ereal (real_cond_exp M Invariants f x)\n  limsup (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n  \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) x)\n  real_cond_exp M Invariants (\\<lambda>x. - f x) x =\n  - real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "have \"\\<And>n. birkhoff_sum (\\<lambda>x. -f x) n x = - birkhoff_sum f n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n. birkhoff_sum (\\<lambda>x. - f x) n x = - birkhoff_sum f n x", "using birkhoff_sum_cmult[where ?c = \"-1\" and ?f = f]"], ["proof (prove)\nusing this:\n  birkhoff_sum (\\<lambda>x. - 1 * f x) ?n ?x = - 1 * birkhoff_sum f ?n ?x\n\ngoal (1 subgoal):\n 1. \\<And>n. birkhoff_sum (\\<lambda>x. - f x) n x = - birkhoff_sum f n x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum (\\<lambda>x. - f x) ?n3 x = - birkhoff_sum f ?n3 x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum (\\<lambda>x. - f x) ?n3 x = - birkhoff_sum f ?n3 x", "have \"\\<And>n. ereal(birkhoff_sum (\\<lambda>x. -f x) n x / n) = - ereal(birkhoff_sum f n x / n)\""], ["proof (prove)\nusing this:\n  birkhoff_sum (\\<lambda>x. - f x) ?n3 x = - birkhoff_sum f ?n3 x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n) =\n       - ereal (birkhoff_sum f n x / real n)", "by auto"], ["proof (state)\nthis:\n  ereal (birkhoff_sum (\\<lambda>x. - f x) ?n3 x / real ?n3) =\n  - ereal (birkhoff_sum f ?n3 x / real ?n3)\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "moreover"], ["proof (state)\nthis:\n  ereal (birkhoff_sum (\\<lambda>x. - f x) ?n3 x / real ?n3) =\n  - ereal (birkhoff_sum f ?n3 x / real ?n3)\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "have \"limsup (\\<lambda>n. - ereal(birkhoff_sum f n x / n)) = - liminf (\\<lambda>n. ereal(birkhoff_sum f n x /n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. limsup (\\<lambda>n. - ereal (birkhoff_sum f n x / real n)) =\n    - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))", "by (rule ereal_Limsup_uminus)"], ["proof (state)\nthis:\n  limsup (\\<lambda>n. - ereal (birkhoff_sum f n x / real n)) =\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "ultimately"], ["proof (chain)\npicking this:\n  ereal (birkhoff_sum (\\<lambda>x. - f x) ?n3 x / real ?n3) =\n  - ereal (birkhoff_sum f ?n3 x / real ?n3)\n  limsup (\\<lambda>n. - ereal (birkhoff_sum f n x / real n)) =\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))", "have \"-liminf (\\<lambda>n. ereal(birkhoff_sum f n x /n)) = limsup (\\<lambda>n. ereal(birkhoff_sum (\\<lambda>x. -f x) n x / n))\""], ["proof (prove)\nusing this:\n  ereal (birkhoff_sum (\\<lambda>x. - f x) ?n3 x / real ?n3) =\n  - ereal (birkhoff_sum f ?n3 x / real ?n3)\n  limsup (\\<lambda>n. - ereal (birkhoff_sum f n x / real n)) =\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n\ngoal (1 subgoal):\n 1. - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n)) =\n    limsup\n     (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))", "by simp"], ["proof (state)\nthis:\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n)) =\n  limsup (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "then"], ["proof (chain)\npicking this:\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n)) =\n  limsup (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))", "have \"-liminf (\\<lambda>n. ereal(birkhoff_sum f n x /n)) \\<le> - real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n)) =\n  limsup (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n\ngoal (1 subgoal):\n 1. - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n    \\<le> ereal (- real_cond_exp M Invariants f x)", "using ii iii"], ["proof (prove)\nusing this:\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n)) =\n  limsup (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n  limsup (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n  \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) x)\n  real_cond_exp M Invariants (\\<lambda>x. - f x) x =\n  - real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n    \\<le> ereal (- real_cond_exp M Invariants f x)", "by simp"], ["proof (state)\nthis:\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  \\<le> ereal (- real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "then"], ["proof (chain)\npicking this:\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  \\<le> ereal (- real_cond_exp M Invariants f x)", "have \"liminf (\\<lambda>n. ereal(birkhoff_sum f n x /n)) \\<ge> real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  - liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  \\<le> ereal (- real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. ereal (real_cond_exp M Invariants f x)\n    \\<le> liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))", "by (simp add: ereal_uminus_le_reorder)"], ["proof (state)\nthis:\n  ereal (real_cond_exp M Invariants f x)\n  \\<le> liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "then"], ["proof (chain)\npicking this:\n  ereal (real_cond_exp M Invariants f x)\n  \\<le> liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))", "have \"(\\<lambda>n. birkhoff_sum f n x /n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  ereal (real_cond_exp M Invariants f x)\n  \\<le> liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f n x / real n)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "using i"], ["proof (prove)\nusing this:\n  ereal (real_cond_exp M Invariants f x)\n  \\<le> liminf (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n  \\<le> ereal (real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f n x / real n)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "by (simp add: limsup_le_liminf_real)"], ["proof (state)\nthis:\n  (\\<lambda>n. birkhoff_sum f n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "}"], ["proof (state)\nthis:\n  \\<lbrakk>limsup (\\<lambda>n. ereal (birkhoff_sum f n ?x5 / real n))\n           \\<le> ereal (real_cond_exp M Invariants f ?x5);\n   limsup\n    (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n ?x5 / real n))\n   \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5);\n   real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5 =\n   - real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n                    \\<longlonglongrightarrow> real_cond_exp M Invariants f\n         ?x5\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "note * = this"], ["proof (state)\nthis:\n  \\<lbrakk>limsup (\\<lambda>n. ereal (birkhoff_sum f n ?x5 / real n))\n           \\<le> ereal (real_cond_exp M Invariants f ?x5);\n   limsup\n    (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n ?x5 / real n))\n   \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5);\n   real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5 =\n   - real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n                    \\<longlonglongrightarrow> real_cond_exp M Invariants f\n         ?x5\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>limsup (\\<lambda>n. ereal (birkhoff_sum f n ?x5 / real n))\n           \\<le> ereal (real_cond_exp M Invariants f ?x5);\n   limsup\n    (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n ?x5 / real n))\n   \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5);\n   real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5 =\n   - real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n                    \\<longlonglongrightarrow> real_cond_exp M Invariants f\n         ?x5\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "have \"AE x in M. limsup (\\<lambda>n. ereal(birkhoff_sum f n x /n)) \\<le> real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "using birkhoff_aux2 assms"], ["proof (prove)\nusing this:\n  integrable M ?f \\<Longrightarrow>\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum ?f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants ?f x)\n  integrable M f\n\ngoal (1 subgoal):\n 1. AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n               \\<le> ereal (real_cond_exp M Invariants f x)", "by simp"], ["proof (state)\nthis:\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "moreover"], ["proof (state)\nthis:\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "have \"AE x in M. limsup (\\<lambda>n. ereal(birkhoff_sum (\\<lambda>x. -f x) n x / n)) \\<le> real_cond_exp M Invariants (\\<lambda>x. -f x) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. limsup\n                (\\<lambda>n.\n                    ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n               \\<le> ereal\n                      (real_cond_exp M Invariants (\\<lambda>x. - f x) x)", "using birkhoff_aux2 assms"], ["proof (prove)\nusing this:\n  integrable M ?f \\<Longrightarrow>\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum ?f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants ?f x)\n  integrable M f\n\ngoal (1 subgoal):\n 1. AE x in M. limsup\n                (\\<lambda>n.\n                    ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n               \\<le> ereal\n                      (real_cond_exp M Invariants (\\<lambda>x. - f x) x)", "by simp"], ["proof (state)\nthis:\n  AE x in M. limsup\n              (\\<lambda>n.\n                  ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) x)\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "moreover"], ["proof (state)\nthis:\n  AE x in M. limsup\n              (\\<lambda>n.\n                  ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) x)\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "have \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. -f x) x = - real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. - f x) x =\n               - real_cond_exp M Invariants f x", "using real_cond_exp_cmult[where ?c = \"-1\"] assms"], ["proof (prove)\nusing this:\n  integrable M ?f \\<Longrightarrow>\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. - 1 * ?f x) x =\n             - 1 * real_cond_exp M Invariants ?f x\n  integrable M f\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. - f x) x =\n               - real_cond_exp M Invariants f x", "by force"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. - f x) x =\n             - real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "ultimately"], ["proof (chain)\npicking this:\n  \\<lbrakk>limsup (\\<lambda>n. ereal (birkhoff_sum f n ?x5 / real n))\n           \\<le> ereal (real_cond_exp M Invariants f ?x5);\n   limsup\n    (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n ?x5 / real n))\n   \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5);\n   real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5 =\n   - real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n                    \\<longlonglongrightarrow> real_cond_exp M Invariants f\n         ?x5\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x)\n  AE x in M. limsup\n              (\\<lambda>n.\n                  ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) x)\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. - f x) x =\n             - real_cond_exp M Invariants f x", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>limsup (\\<lambda>n. ereal (birkhoff_sum f n ?x5 / real n))\n           \\<le> ereal (real_cond_exp M Invariants f ?x5);\n   limsup\n    (\\<lambda>n. ereal (birkhoff_sum (\\<lambda>x. - f x) n ?x5 / real n))\n   \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5);\n   real_cond_exp M Invariants (\\<lambda>x. - f x) ?x5 =\n   - real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n                    \\<longlonglongrightarrow> real_cond_exp M Invariants f\n         ?x5\n  AE x in M. limsup (\\<lambda>n. ereal (birkhoff_sum f n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants f x)\n  AE x in M. limsup\n              (\\<lambda>n.\n                  ereal (birkhoff_sum (\\<lambda>x. - f x) n x / real n))\n             \\<le> ereal (real_cond_exp M Invariants (\\<lambda>x. - f x) x)\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. - f x) x =\n             - real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If a function $f$ is integrable, then $E(f\\circ T - f | I) = E(f\\circ T | I) - E(f|I) = 0$.\nHence, $S_n(f \\circ T - f) / n$ converges almost everywhere to $0$, i.e., $f(T^n x)/n \\to 0$.\nIt is remarkable (and sometimes useful) that this holds under the weaker condition that\n$f\\circ T - f$ is integrable (but not necessarily $f$), where this naive argument fails.\n\nThe reason is that the Birkhoff sum of $f \\circ T - f$ is $f\\circ T^n - f$. If $n$ is such that $x$\nand $T^n(x)$ belong to a set where $f$ is bounded, it follows that this Birkhoff sum is also\nbounded. Along such a sequence of times, $S_n(f\\circ T - f)/n$ tends to $0$.\nBy Poincare recurrence theorem, there are such times for almost every points. As it also converges\nto $E(f \\circ T - f | I)$, it follows that this function is almost everywhere $0$. Then\n$f (T^n x)/n = S_n(f\\circ T^n - f)/n - f/n$ tends almost surely to $E(f\\circ T-f |I) = 0$.\n\\<close>"], ["", "lemma limit_foTn_over_n:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"f \\<in> borel_measurable M\"\n      and \"integrable M (\\<lambda>x. f(T x) - f x)\"\n  shows \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x = 0\"\n        \"AE x in M. (\\<lambda>n. f((T^^n) x) / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x =\n               0 &&&\n    AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "define E::\"nat \\<Rightarrow> 'a set\" where \"E k = {x \\<in> space M. \\<bar>f x\\<bar> \\<le> k}\" for k"], ["proof (state)\nthis:\n  E ?k = {x \\<in> space M. \\<bar>f x\\<bar> \\<le> real ?k}\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "have [measurable]: \"E k \\<in> sets M\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. E k \\<in> sets M", "unfolding E_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M. \\<bar>f x\\<bar> \\<le> real k} \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  E ?k3 \\<in> sets M\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "have *: \"(\\<Union>k. E k) = space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (range E) = space M", "unfolding E_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>k. {x \\<in> space M. \\<bar>f x\\<bar> \\<le> real k}) = space M", "by (auto simp add: real_arch_simple)"], ["proof (state)\nthis:\n  \\<Union> (range E) = space M\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "define F::\"nat \\<Rightarrow> 'a set\" where \"F k = recurrent_subset_infty (E k)\" for k"], ["proof (state)\nthis:\n  F ?k = recurrent_subset_infty (E ?k)\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "have [measurable]: \"F k \\<in> sets M\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. F k \\<in> sets M", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. recurrent_subset_infty (E k) \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  F ?k3 \\<in> sets M\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "have **: \"E k - F k \\<in> null_sets M\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. E k - F k \\<in> null_sets M", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. E k - recurrent_subset_infty (E k) \\<in> null_sets M", "using Poincare_recurrence_thm"], ["proof (prove)\nusing this:\n  ?A \\<in> sets M \\<Longrightarrow>\n  ?A - recurrent_subset ?A \\<in> null_sets M\n  ?A \\<in> sets M \\<Longrightarrow>\n  ?A - recurrent_subset_infty ?A \\<in> null_sets M\n  ?A \\<in> sets M \\<Longrightarrow>\n  ?A \\<Delta> recurrent_subset ?A \\<in> null_sets M\n  ?A \\<in> sets M \\<Longrightarrow>\n  ?A \\<Delta> recurrent_subset_infty ?A \\<in> null_sets M\n  ?A \\<in> sets M \\<Longrightarrow>\n  emeasure M (recurrent_subset ?A) = emeasure M ?A\n  ?A \\<in> sets M \\<Longrightarrow>\n  emeasure M (recurrent_subset_infty ?A) = emeasure M ?A\n  ?A \\<in> sets M \\<Longrightarrow>\n  AE x\\<in>?A in M. x \\<in> recurrent_subset_infty ?A\n\ngoal (1 subgoal):\n 1. E k - recurrent_subset_infty (E k) \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  E ?k3 - F ?k3 \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "have \"space M - (\\<Union>k. F k) \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space M - \\<Union> (range F) \\<in> null_sets M", "apply (rule null_sets_subset[of \"(\\<Union>k. E k - F k)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<Union>k. E k - F k) \\<in> null_sets M\n 2. space M - \\<Union> (range F) \\<in> sets M\n 3. space M - \\<Union> (range F) \\<subseteq> (\\<Union>k. E k - F k)", "unfolding *[symmetric]"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<Union>k. E k - F k) \\<in> null_sets M\n 2. \\<Union> (range E) - \\<Union> (range F) \\<in> sets M\n 3. \\<Union> (range E) - \\<Union> (range F)\n    \\<subseteq> (\\<Union>k. E k - F k)", "using **"], ["proof (prove)\nusing this:\n  E ?k3 - F ?k3 \\<in> null_sets M\n\ngoal (3 subgoals):\n 1. (\\<Union>k. E k - F k) \\<in> null_sets M\n 2. \\<Union> (range E) - \\<Union> (range F) \\<in> sets M\n 3. \\<Union> (range E) - \\<Union> (range F)\n    \\<subseteq> (\\<Union>k. E k - F k)", "by auto"], ["proof (state)\nthis:\n  space M - \\<Union> (range F) \\<in> null_sets M\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "with AE_not_in[OF this]"], ["proof (chain)\npicking this:\n  AE x in M. x \\<notin> space M - \\<Union> (range F)\n  space M - \\<Union> (range F) \\<in> null_sets M", "have \"AE x in M. x \\<in> (\\<Union>k. F k)\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<notin> space M - \\<Union> (range F)\n  space M - \\<Union> (range F) \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> \\<Union> (range F)", "by auto"], ["proof (state)\nthis:\n  AE x in M. x \\<in> \\<Union> (range F)\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "moreover"], ["proof (state)\nthis:\n  AE x in M. x \\<in> \\<Union> (range F)\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "have \"AE x in M. (\\<lambda>n. birkhoff_sum (\\<lambda>x. f(T x) - f x) n x / n)\n      \\<longlonglongrightarrow> real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n.\n                   birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants\n    (\\<lambda>x. f (T x) - f x) x", "by (rule birkhoff_theorem_AE_nonergodic[OF assms(2)])"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. f (T x) - f x) x\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. f (T x) - f x) x\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "have \"real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x = 0 \\<and> (\\<lambda>n. f((T^^n) x) / n) \\<longlonglongrightarrow> 0\"\n    if H: \"(\\<lambda>n. birkhoff_sum (\\<lambda>x. f(T x) - f x) n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x\"\n          \"x \\<in> (\\<Union>k. F k)\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "have \"f((T^^n) x) = birkhoff_sum (\\<lambda>x. f(T x) - f x) n x + f x\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ n) x) = birkhoff_sum (\\<lambda>x. f (T x) - f x) n x + f x", "unfolding birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. f ((T ^^ n) x) = (\\<Sum>i<n. f (T ((T ^^ i) x)) - f ((T ^^ i) x)) + f x", "by (induction n, auto)"], ["proof (state)\nthis:\n  f ((T ^^ ?n3) x) = birkhoff_sum (\\<lambda>x. f (T x) - f x) ?n3 x + f x\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  f ((T ^^ ?n3) x) = birkhoff_sum (\\<lambda>x. f (T x) - f x) ?n3 x + f x", "have \"f((T^^n) x) / n = birkhoff_sum (\\<lambda>x. f(T x) - f x) n x / n + f x * (1/n)\" for n"], ["proof (prove)\nusing this:\n  f ((T ^^ ?n3) x) = birkhoff_sum (\\<lambda>x. f (T x) - f x) ?n3 x + f x\n\ngoal (1 subgoal):\n 1. f ((T ^^ n) x) / real n =\n    birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n +\n    f x * (1 / real n)", "by (auto simp add: divide_simps)"], ["proof (state)\nthis:\n  f ((T ^^ ?n3) x) / real ?n3 =\n  birkhoff_sum (\\<lambda>x. f (T x) - f x) ?n3 x / real ?n3 +\n  f x * (1 / real ?n3)\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "moreover"], ["proof (state)\nthis:\n  f ((T ^^ ?n3) x) / real ?n3 =\n  birkhoff_sum (\\<lambda>x. f (T x) - f x) ?n3 x / real ?n3 +\n  f x * (1 / real ?n3)\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. birkhoff_sum (\\<lambda>x. f(T x) - f x) n x / n + f x * (1/n)) \\<longlonglongrightarrow> real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x + f x * 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n +\n        f x * (1 / real n))\n    \\<longlonglongrightarrow> real_cond_exp M Invariants\n                               (\\<lambda>x. f (T x) - f x) x +\n                              f x * 0", "by (intro tendsto_intros H(1))"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n +\n      f x * (1 / real n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x +\n                            f x * 0\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "ultimately"], ["proof (chain)\npicking this:\n  f ((T ^^ ?n3) x) / real ?n3 =\n  birkhoff_sum (\\<lambda>x. f (T x) - f x) ?n3 x / real ?n3 +\n  f x * (1 / real ?n3)\n  (\\<lambda>n.\n      birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n +\n      f x * (1 / real n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x +\n                            f x * 0", "have lim: \"(\\<lambda>n. f((T^^n) x) / n) \\<longlonglongrightarrow> real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x\""], ["proof (prove)\nusing this:\n  f ((T ^^ ?n3) x) / real ?n3 =\n  birkhoff_sum (\\<lambda>x. f (T x) - f x) ?n3 x / real ?n3 +\n  f x * (1 / real ?n3)\n  (\\<lambda>n.\n      birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n +\n      f x * (1 / real n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x +\n                            f x * 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. f ((T ^^ n) x) / real n)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants\n                               (\\<lambda>x. f (T x) - f x) x", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. f ((T ^^ n) x) / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "obtain k where \"x \\<in> F k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>k. x \\<in> F k \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "using H(2)"], ["proof (prove)\nusing this:\n  x \\<in> \\<Union> (range F)\n\ngoal (1 subgoal):\n 1. (\\<And>k. x \\<in> F k \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  x \\<in> F k\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  x \\<in> F k", "have \"infinite {n. (T^^n) x \\<in> E k}\""], ["proof (prove)\nusing this:\n  x \\<in> F k\n\ngoal (1 subgoal):\n 1. infinite {n. (T ^^ n) x \\<in> E k}", "unfolding F_def recurrent_subset_infty_inf_returns"], ["proof (prove)\nusing this:\n  x \\<in> E k \\<and> infinite {n. (T ^^ n) x \\<in> E k}\n\ngoal (1 subgoal):\n 1. infinite {n. (T ^^ n) x \\<in> E k}", "by auto"], ["proof (state)\nthis:\n  infinite {n. (T ^^ n) x \\<in> E k}\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "with infinite_enumerate[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>r.\n     strict_mono r \\<and> (\\<forall>n. r n \\<in> {n. (T ^^ n) x \\<in> E k})\n  infinite {n. (T ^^ n) x \\<in> E k}", "obtain r :: \"nat \\<Rightarrow> nat\"\n      where r: \"strict_mono r\" \"\\<And>n. r n \\<in> {n. (T^^n) x \\<in> E k}\""], ["proof (prove)\nusing this:\n  \\<exists>r.\n     strict_mono r \\<and> (\\<forall>n. r n \\<in> {n. (T ^^ n) x \\<in> E k})\n  infinite {n. (T ^^ n) x \\<in> E k}\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>strict_mono r;\n         \\<And>n. r n \\<in> {n. (T ^^ n) x \\<in> E k}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  strict_mono r\n  r ?n3 \\<in> {n. (T ^^ n) x \\<in> E k}\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "have A: \"(\\<lambda>n. k * (1/r n)) \\<longlonglongrightarrow> real k * 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. real k * (1 / real (r n)))\n    \\<longlonglongrightarrow> real k * 0", "apply (intro tendsto_intros)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. 1 / real (r x)) \\<longlonglongrightarrow> 0", "using LIMSEQ_subseq_LIMSEQ[OF lim_1_over_n \\<open>strict_mono r\\<close>]"], ["proof (prove)\nusing this:\n  ((\\<lambda>n. (1::?'a1) / of_nat n) \\<circ> r)\n  \\<longlonglongrightarrow> (0::?'a1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. 1 / real (r x)) \\<longlonglongrightarrow> 0", "unfolding comp_def"], ["proof (prove)\nusing this:\n  (\\<lambda>x. (1::?'a1) / of_nat (r x)) \\<longlonglongrightarrow> (0::?'a1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. 1 / real (r x)) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. real k * (1 / real (r n)))\n  \\<longlonglongrightarrow> real k * 0\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "have B: \"\\<bar>f((T^^(r n)) x) / r n\\<bar> \\<le> k / (r n)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>f ((T ^^ r n) x) / real (r n)\\<bar> \\<le> real k / real (r n)", "using r(2)"], ["proof (prove)\nusing this:\n  r ?n3 \\<in> {n. (T ^^ n) x \\<in> E k}\n\ngoal (1 subgoal):\n 1. \\<bar>f ((T ^^ r n) x) / real (r n)\\<bar> \\<le> real k / real (r n)", "unfolding E_def"], ["proof (prove)\nusing this:\n  r ?n3\n  \\<in> {n. (T ^^ n) x\n            \\<in> {x \\<in> space M. \\<bar>f x\\<bar> \\<le> real k}}\n\ngoal (1 subgoal):\n 1. \\<bar>f ((T ^^ r n) x) / real (r n)\\<bar> \\<le> real k / real (r n)", "by (auto simp add: divide_simps)"], ["proof (state)\nthis:\n  \\<bar>f ((T ^^ r ?n3) x) / real (r ?n3)\\<bar> \\<le> real k / real (r ?n3)\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. f((T^^(r n)) x) / r n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. f ((T ^^ r n) x) / real (r n)) \\<longlonglongrightarrow> 0", "apply (rule tendsto_rabs_zero_cancel, rule tendsto_sandwich[of \"\\<lambda>n. 0\" _ _ \"\\<lambda>n. k * (1/r n)\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       0 \\<le> \\<bar>f ((T ^^ r n) x) / real (r n)\\<bar>\n 2. \\<forall>\\<^sub>F n in sequentially.\n       \\<bar>f ((T ^^ r n) x) / real (r n)\\<bar>\n       \\<le> real k * (1 / real (r n))\n 3. (\\<lambda>n. 0) \\<longlonglongrightarrow> 0\n 4. (\\<lambda>n. real k * (1 / real (r n))) \\<longlonglongrightarrow> 0", "using A B"], ["proof (prove)\nusing this:\n  (\\<lambda>n. real k * (1 / real (r n)))\n  \\<longlonglongrightarrow> real k * 0\n  \\<bar>f ((T ^^ r ?n3) x) / real (r ?n3)\\<bar> \\<le> real k / real (r ?n3)\n\ngoal (4 subgoals):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       0 \\<le> \\<bar>f ((T ^^ r n) x) / real (r n)\\<bar>\n 2. \\<forall>\\<^sub>F n in sequentially.\n       \\<bar>f ((T ^^ r n) x) / real (r n)\\<bar>\n       \\<le> real k * (1 / real (r n))\n 3. (\\<lambda>n. 0) \\<longlonglongrightarrow> 0\n 4. (\\<lambda>n. real k * (1 / real (r n))) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n)) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n)) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. f((T^^(r n)) x) / r n) \\<longlonglongrightarrow> real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. f ((T ^^ r n) x) / real (r n))\n    \\<longlonglongrightarrow> real_cond_exp M Invariants\n                               (\\<lambda>x. f (T x) - f x) x", "using LIMSEQ_subseq_LIMSEQ[OF lim \\<open>strict_mono r\\<close>]"], ["proof (prove)\nusing this:\n  ((\\<lambda>n. f ((T ^^ n) x) / real n) \\<circ> r)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. f ((T ^^ r n) x) / real (r n))\n    \\<longlonglongrightarrow> real_cond_exp M Invariants\n                               (\\<lambda>x. f (T x) - f x) x", "unfolding comp_def"], ["proof (prove)\nusing this:\n  (\\<lambda>xa. f ((T ^^ r xa) x) / real (r xa))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. f ((T ^^ r n) x) / real (r n))\n    \\<longlonglongrightarrow> real_cond_exp M Invariants\n                               (\\<lambda>x. f (T x) - f x) x", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n)) \\<longlonglongrightarrow> 0\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x", "have *: \"real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x = 0\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n)) \\<longlonglongrightarrow> 0\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0", "using LIMSEQ_unique"], ["proof (prove)\nusing this:\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n)) \\<longlonglongrightarrow> 0\n  (\\<lambda>n. f ((T ^^ r n) x) / real (r n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x\n  \\<lbrakk>?X \\<longlonglongrightarrow> ?a;\n   ?X \\<longlonglongrightarrow> ?b\\<rbrakk>\n  \\<Longrightarrow> ?a = ?b\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0", "by auto"], ["proof (state)\nthis:\n  real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0", "have \"(\\<lambda>n. f((T^^n) x) / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "using lim"], ["proof (prove)\nusing this:\n  real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n  (\\<lambda>n. f ((T ^^ n) x) / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants\n                             (\\<lambda>x. f (T x) - f x) x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "using *"], ["proof (prove)\nusing this:\n  (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0\n  real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n    (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0 \\<and>\n  (\\<lambda>n. f ((T ^^ n) x) / real n) \\<longlonglongrightarrow> 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>(\\<lambda>n.\n               birkhoff_sum (\\<lambda>x. f (T x) - f x) n ?x3 / real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants\n(\\<lambda>x. f (T x) - f x) ?x3;\n   ?x3 \\<in> \\<Union> (range F)\\<rbrakk>\n  \\<Longrightarrow> real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x)\n                     ?x3 =\n                    0 \\<and>\n                    (\\<lambda>n. f ((T ^^ n) ?x3) / real n)\n                    \\<longlonglongrightarrow> 0\n\ngoal (2 subgoals):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n 2. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. x \\<in> \\<Union> (range F)\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. f (T x) - f x) x\n  \\<lbrakk>(\\<lambda>n.\n               birkhoff_sum (\\<lambda>x. f (T x) - f x) n ?x3 / real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants\n(\\<lambda>x. f (T x) - f x) ?x3;\n   ?x3 \\<in> \\<Union> (range F)\\<rbrakk>\n  \\<Longrightarrow> real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x)\n                     ?x3 =\n                    0 \\<and>\n                    (\\<lambda>n. f ((T ^^ n) ?x3) / real n)\n                    \\<longlonglongrightarrow> 0", "show \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. f(T x) - f x) x = 0\"\n                  \"AE x in M. (\\<lambda>n. f((T^^n) x) / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<in> \\<Union> (range F)\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. f (T x) - f x) n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. f (T x) - f x) x\n  \\<lbrakk>(\\<lambda>n.\n               birkhoff_sum (\\<lambda>x. f (T x) - f x) n ?x3 / real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants\n(\\<lambda>x. f (T x) - f x) ?x3;\n   ?x3 \\<in> \\<Union> (range F)\\<rbrakk>\n  \\<Longrightarrow> real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x)\n                     ?x3 =\n                    0 \\<and>\n                    (\\<lambda>n. f ((T ^^ n) ?x3) / real n)\n                    \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x =\n               0 &&&\n    AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f (T x) - f x) x = 0\n  AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n             \\<longlonglongrightarrow> 0\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>We specialize the previous statement to the case where $f$ itself is integrable.\\<close>"], ["", "lemma limit_foTn_over_n':\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"AE x in M. (\\<lambda>n. f((T^^n) x) / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. f ((T ^^ n) x) / real n)\n               \\<longlonglongrightarrow> 0", "by (rule limit_foTn_over_n, simp, rule Bochner_Integration.integrable_diff)\n   (auto intro: assms T_integral_preserving(1))"], ["", "text \\<open>It is often useful to show that a function is cohomologous to a nicer function, i.e., to\nprove that a given $f$ can be written as $f = g + u - u \\circ T$ where $g$ is nicer than $f$. We\nshow below that any integrable function is cohomologous to a function which is arbitrarily close to\n$E(f|I)$. This is an improved version of Lemma 2.1 in [Benoist-Quint, Annals of maths, 2011]. Note\nthat the function $g$ to which $f$ is cohomologous is very nice (and, in particular, integrable),\nbut the transfer function is only measurable in this argument. The fact that the control on\nconditional expectation is nevertheless preserved throughout the argument follows from\nLemma~\\verb+limit_foTn_over_n+ above.\\<close>"], ["", "text \\<open>We start with the lemma (and the proof) of [BQ2011]. It shows that, if a function has a\nconditional expectation with respect to invariants which is positive, then it is cohomologous to a\nnonnegative function. The argument is the clever remark that $g = \\max (0, \\inf_n S_n f)$ and $u =\n\\min (0, \\inf_n S_n f)$ work (where these expressions are well defined as $S_n f$ tends to infinity\nthanks to our assumption).\\<close>"], ["", "lemma cohomologous_approx_cond_exp_aux:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n      and \"AE x in M. real_cond_exp M Invariants f x > 0\"\n    shows \"\\<exists>u g. u \\<in> borel_measurable M \\<and> (integrable M g) \\<and> (AE x in M. g x \\<ge> 0 \\<and> g x \\<le> max 0 (f x)) \\<and> (\\<forall>x. f x = g x + u x - u (T x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "define h::\"'a \\<Rightarrow> real\" where \"h = (\\<lambda>x. (INF n\\<in>{1..}. birkhoff_sum f n x))\""], ["proof (state)\nthis:\n  h = (\\<lambda>x. \\<Sqinter>n\\<in>{1..}. birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "define u where \"u = (\\<lambda>x. min (h x) 0)\""], ["proof (state)\nthis:\n  u = (\\<lambda>x. min (h x) 0)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "define g where \"g = (\\<lambda>x. f x - u x + u (T x))\""], ["proof (state)\nthis:\n  g = (\\<lambda>x. f x - u x + u (T x))\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have [measurable]: \"h \\<in> borel_measurable M\" \"u \\<in> borel_measurable M\" \"g \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. h \\<in> borel_measurable M &&&\n    u \\<in> borel_measurable M &&& g \\<in> borel_measurable M", "unfolding g_def h_def u_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. \\<Sqinter>n\\<in>{1..}. birkhoff_sum f n x)\n    \\<in> borel_measurable M &&&\n    (\\<lambda>x. min (\\<Sqinter>n\\<in>{1..}. birkhoff_sum f n x) 0)\n    \\<in> borel_measurable M &&&\n    (\\<lambda>x.\n        f x - min (\\<Sqinter>n\\<in>{1..}. birkhoff_sum f n x) 0 +\n        min (\\<Sqinter>n\\<in>{1..}. birkhoff_sum f n (T x)) 0)\n    \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  h \\<in> borel_measurable M\n  u \\<in> borel_measurable M\n  g \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"f x = g x + u x - u (T x)\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. f x = g x + u x - u (T x)", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. f x = f x - u x + u (T x) + u x - u (T x)", "by auto"], ["proof (state)\nthis:\n  f ?x3 = g ?x3 + u ?x3 - u (T ?x3)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "{"], ["proof (state)\nthis:\n  f ?x3 = g ?x3 + u ?x3 - u (T ?x3)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "assume H: \"real_cond_exp M Invariants f x > 0\"\n                    \"(\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (state)\nthis:\n  0 < real_cond_exp M Invariants f x\n  (\\<lambda>n. birkhoff_sum f n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"eventually (\\<lambda>n. ereal(birkhoff_sum f n x / n) * ereal n = ereal(birkhoff_sum f n x)) sequentially\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       ereal (birkhoff_sum f n x / real n) * ereal (real n) =\n       ereal (birkhoff_sum f n x)", "unfolding eventually_sequentially"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>n\\<ge>N.\n          ereal (birkhoff_sum f n x / real n) * ereal (real n) =\n          ereal (birkhoff_sum f n x)", "by (rule exI[of _ 1], auto)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (birkhoff_sum f n x / real n) * ereal (real n) =\n     ereal (birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (birkhoff_sum f n x / real n) * ereal (real n) =\n     ereal (birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"(\\<lambda>n. ereal(birkhoff_sum f n x / n) * ereal n) \\<longlonglongrightarrow> ereal(real_cond_exp M Invariants f x) * \\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. ereal (birkhoff_sum f n x / real n) * ereal (real n))\n    \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                              \\<infinity>", "apply (intro tendsto_intros)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>xa. birkhoff_sum f xa x / real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n 2. \\<not> (ereal (real_cond_exp M Invariants f x) = 0 \\<and>\n            \\<bar>\\<infinity>\\<bar> = \\<infinity> \\<or>\n            \\<infinity> = 0 \\<and>\n            \\<bar>ereal (real_cond_exp M Invariants f x)\\<bar> =\n            \\<infinity>)", "using H"], ["proof (prove)\nusing this:\n  0 < real_cond_exp M Invariants f x\n  (\\<lambda>n. birkhoff_sum f n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (2 subgoals):\n 1. (\\<lambda>xa. birkhoff_sum f xa x / real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n 2. \\<not> (ereal (real_cond_exp M Invariants f x) = 0 \\<and>\n            \\<bar>\\<infinity>\\<bar> = \\<infinity> \\<or>\n            \\<infinity> = 0 \\<and>\n            \\<bar>ereal (real_cond_exp M Invariants f x)\\<bar> =\n            \\<infinity>)", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. ereal (birkhoff_sum f n x / real n) * ereal (real n))\n  \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                            \\<infinity>\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (birkhoff_sum f n x / real n) * ereal (real n) =\n     ereal (birkhoff_sum f n x)\n  (\\<lambda>n. ereal (birkhoff_sum f n x / real n) * ereal (real n))\n  \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                            \\<infinity>", "have \"(\\<lambda>n. ereal(birkhoff_sum f n x)) \\<longlonglongrightarrow> ereal(real_cond_exp M Invariants f x) * \\<infinity>\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (birkhoff_sum f n x / real n) * ereal (real n) =\n     ereal (birkhoff_sum f n x)\n  (\\<lambda>n. ereal (birkhoff_sum f n x / real n) * ereal (real n))\n  \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                            \\<infinity>\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. ereal (birkhoff_sum f n x))\n    \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                              \\<infinity>", "by (blast intro: Lim_transform_eventually)"], ["proof (state)\nthis:\n  (\\<lambda>n. ereal (birkhoff_sum f n x))\n  \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                            \\<infinity>\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. ereal (birkhoff_sum f n x))\n  \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                            \\<infinity>", "have \"(\\<lambda>n. ereal(birkhoff_sum f n x)) \\<longlonglongrightarrow> \\<infinity>\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. ereal (birkhoff_sum f n x))\n  \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                            \\<infinity>\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. ereal (birkhoff_sum f n x))\n    \\<longlonglongrightarrow> \\<infinity>", "using H"], ["proof (prove)\nusing this:\n  (\\<lambda>n. ereal (birkhoff_sum f n x))\n  \\<longlonglongrightarrow> ereal (real_cond_exp M Invariants f x) *\n                            \\<infinity>\n  0 < real_cond_exp M Invariants f x\n  (\\<lambda>n. birkhoff_sum f n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. ereal (birkhoff_sum f n x))\n    \\<longlonglongrightarrow> \\<infinity>", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. ereal (birkhoff_sum f n x))\n  \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. ereal (birkhoff_sum f n x))\n  \\<longlonglongrightarrow> \\<infinity>", "have B: \"\\<exists>C. \\<forall>n. C \\<le> birkhoff_sum f n x\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. ereal (birkhoff_sum f n x))\n  \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. \\<exists>C. \\<forall>n. C \\<le> birkhoff_sum f n x", "by (intro liminf_finite_then_bounded_below, simp add: liminf_PInfty)"], ["proof (state)\nthis:\n  \\<exists>C. \\<forall>n. C \\<le> birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"h x \\<le> f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. h x \\<le> f x", "unfolding h_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sqinter>n\\<in>{1..}. birkhoff_sum f n x) \\<le> f x", "apply (rule cInf_lower)"], ["proof (prove)\ngoal (2 subgoals):\n 1. f x \\<in> (\\<lambda>n. birkhoff_sum f n x) ` {1..}\n 2. bdd_below ((\\<lambda>n. birkhoff_sum f n x) ` {1..})", "using B"], ["proof (prove)\nusing this:\n  \\<exists>C. \\<forall>n. C \\<le> birkhoff_sum f n x\n\ngoal (2 subgoals):\n 1. f x \\<in> (\\<lambda>n. birkhoff_sum f n x) ` {1..}\n 2. bdd_below ((\\<lambda>n. birkhoff_sum f n x) ` {1..})", "by force+"], ["proof (state)\nthis:\n  h x \\<le> f x\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"{birkhoff_sum f n (T x) |n. n \\<in> {1..}} = {birkhoff_sum f (1+n) (x) - f x |n. n \\<in> {1..}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n    {birkhoff_sum f (1 + n) x - f x |n. n \\<in> {1..}}", "unfolding birkhoff_sum_cocycle"], ["proof (prove)\ngoal (1 subgoal):\n 1. {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n    {birkhoff_sum f 1 x + birkhoff_sum f n ((T ^^ 1) x) - f x |n.\n     n \\<in> {1..}}", "by auto"], ["proof (state)\nthis:\n  {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n  {birkhoff_sum f (1 + n) x - f x |n. n \\<in> {1..}}\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "also"], ["proof (state)\nthis:\n  {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n  {birkhoff_sum f (1 + n) x - f x |n. n \\<in> {1..}}\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"... = {birkhoff_sum f n x - f x |n. n \\<in> {2..}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {birkhoff_sum f (1 + n) x - f x |n. n \\<in> {1..}} =\n    {birkhoff_sum f n x - f x |n. n \\<in> {2..}}", "by (metis (no_types, hide_lams) Suc_1 Suc_eq_plus1_left Suc_le_D Suc_le_mono atLeast_iff)"], ["proof (state)\nthis:\n  {birkhoff_sum f (1 + n) x - f x |n. n \\<in> {1..}} =\n  {birkhoff_sum f n x - f x |n. n \\<in> {2..}}\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "finally"], ["proof (chain)\npicking this:\n  {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n  {birkhoff_sum f n x - f x |n. n \\<in> {2..}}", "have *: \"{birkhoff_sum f n (T x) |n. n \\<in> {1..}} = (\\<lambda>t. t - (f x))`{birkhoff_sum f n x |n. n \\<in> {2..}}\""], ["proof (prove)\nusing this:\n  {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n  {birkhoff_sum f n x - f x |n. n \\<in> {2..}}\n\ngoal (1 subgoal):\n 1. {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n    (\\<lambda>t. t - f x) ` {birkhoff_sum f n x |n. n \\<in> {2..}}", "by auto"], ["proof (state)\nthis:\n  {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n  (\\<lambda>t. t - f x) ` {birkhoff_sum f n x |n. n \\<in> {2..}}\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"h(T x) = Inf {birkhoff_sum f n (T x) |n. n \\<in> {1..}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. h (T x) = \\<Sqinter> {birkhoff_sum f n (T x) |n. n \\<in> {1..}}", "unfolding h_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sqinter>n\\<in>{1..}. birkhoff_sum f n (T x)) =\n    \\<Sqinter> {birkhoff_sum f n (T x) |n. n \\<in> {1..}}", "by (metis Setcompr_eq_image)"], ["proof (state)\nthis:\n  h (T x) = \\<Sqinter> {birkhoff_sum f n (T x) |n. n \\<in> {1..}}\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "also"], ["proof (state)\nthis:\n  h (T x) = \\<Sqinter> {birkhoff_sum f n (T x) |n. n \\<in> {1..}}\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"... =  (\\<Sqinter>t\\<in>{birkhoff_sum f n x |n. n \\<in> {2..}}. t - f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Sqinter> {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n    (\\<Sqinter>t\\<in>{birkhoff_sum f n x |n. n \\<in> {2..}}. t - f x)", "by (simp only: *)"], ["proof (state)\nthis:\n  \\<Sqinter> {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n  (\\<Sqinter>t\\<in>{birkhoff_sum f n x |n. n \\<in> {2..}}. t - f x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "also"], ["proof (state)\nthis:\n  \\<Sqinter> {birkhoff_sum f n (T x) |n. n \\<in> {1..}} =\n  (\\<Sqinter>t\\<in>{birkhoff_sum f n x |n. n \\<in> {2..}}. t - f x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"... = (\\<lambda>t. t - (f x)) (Inf {birkhoff_sum f n x |n. n \\<in> {2..}})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sqinter>t\\<in>{birkhoff_sum f n x |n. n \\<in> {2..}}. t - f x) =\n    \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}} - f x", "using B"], ["proof (prove)\nusing this:\n  \\<exists>C. \\<forall>n. C \\<le> birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. (\\<Sqinter>t\\<in>{birkhoff_sum f n x |n. n \\<in> {2..}}. t - f x) =\n    \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}} - f x", "by (auto intro!: monoI bijI mono_bij_cInf [symmetric])"], ["proof (state)\nthis:\n  (\\<Sqinter>t\\<in>{birkhoff_sum f n x |n. n \\<in> {2..}}. t - f x) =\n  \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}} - f x\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "finally"], ["proof (chain)\npicking this:\n  h (T x) = \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}} - f x", "have I: \"Inf {birkhoff_sum f n x |n. n \\<in> {2..}} = f x + h (T x)\""], ["proof (prove)\nusing this:\n  h (T x) = \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}} - f x\n\ngoal (1 subgoal):\n 1. \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}} = f x + h (T x)", "by auto"], ["proof (state)\nthis:\n  \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}} = f x + h (T x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"max 0 (h x) + u x = h x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. max 0 (h x) + u x = h x", "unfolding u_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. max 0 (h x) + min (h x) 0 = h x", "by auto"], ["proof (state)\nthis:\n  max 0 (h x) + u x = h x\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "also"], ["proof (state)\nthis:\n  max 0 (h x) + u x = h x\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"... = Inf {birkhoff_sum f n x |n. n \\<in> {1..}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. h x = \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1..}}", "unfolding h_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sqinter>n\\<in>{1..}. birkhoff_sum f n x) =\n    \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1..}}", "by (metis Setcompr_eq_image)"], ["proof (state)\nthis:\n  h x = \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1..}}\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "also"], ["proof (state)\nthis:\n  h x = \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1..}}\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"... = Inf ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union> {birkhoff_sum f n x |n. n \\<in> {2..}})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1..}} =\n    \\<Sqinter> ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union>\n                {birkhoff_sum f n x |n. n \\<in> {2..}})", "by (auto intro!: arg_cong[of _ _ Inf], metis One_nat_def Suc_1 antisym birkhoff_sum_1(2) not_less_eq_eq, force)"], ["proof (state)\nthis:\n  \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1..}} =\n  \\<Sqinter> ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union>\n              {birkhoff_sum f n x |n. n \\<in> {2..}})\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "also"], ["proof (state)\nthis:\n  \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1..}} =\n  \\<Sqinter> ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union>\n              {birkhoff_sum f n x |n. n \\<in> {2..}})\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"Inf ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union> {birkhoff_sum f n x |n. n \\<in> {2..}})\n      = min (Inf {birkhoff_sum f n x |n. n \\<in> {1}}) (Inf {birkhoff_sum f n x |n. n \\<in> {2..}})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Sqinter> ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union>\n                {birkhoff_sum f n x |n. n \\<in> {2..}}) =\n    min (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1}})\n     (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}})", "unfolding inf_min[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Sqinter> ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union>\n                {birkhoff_sum f n x |n. n \\<in> {2..}}) =\n    \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1}} \\<sqinter>\n    \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}}", "apply (intro cInf_union_distrib)"], ["proof (prove)\ngoal (4 subgoals):\n 1. {birkhoff_sum f n x |n. n \\<in> {1}} \\<noteq> {}\n 2. bdd_below {birkhoff_sum f n x |n. n \\<in> {1}}\n 3. {birkhoff_sum f n x |n. n \\<in> {2..}} \\<noteq> {}\n 4. bdd_below {birkhoff_sum f n x |n. n \\<in> {2..}}", "using B"], ["proof (prove)\nusing this:\n  \\<exists>C. \\<forall>n. C \\<le> birkhoff_sum f n x\n\ngoal (4 subgoals):\n 1. {birkhoff_sum f n x |n. n \\<in> {1}} \\<noteq> {}\n 2. bdd_below {birkhoff_sum f n x |n. n \\<in> {1}}\n 3. {birkhoff_sum f n x |n. n \\<in> {2..}} \\<noteq> {}\n 4. bdd_below {birkhoff_sum f n x |n. n \\<in> {2..}}", "by auto"], ["proof (state)\nthis:\n  \\<Sqinter> ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union>\n              {birkhoff_sum f n x |n. n \\<in> {2..}}) =\n  min (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1}})\n   (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}})\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "also"], ["proof (state)\nthis:\n  \\<Sqinter> ({birkhoff_sum f n x |n. n \\<in> {1}} \\<union>\n              {birkhoff_sum f n x |n. n \\<in> {2..}}) =\n  min (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1}})\n   (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}})\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"... = min (f x) (f x + h (T x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. min (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1}})\n     (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}}) =\n    min (f x) (f x + h (T x))", "using I"], ["proof (prove)\nusing this:\n  \\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}} = f x + h (T x)\n\ngoal (1 subgoal):\n 1. min (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1}})\n     (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}}) =\n    min (f x) (f x + h (T x))", "by auto"], ["proof (state)\nthis:\n  min (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1}})\n   (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}}) =\n  min (f x) (f x + h (T x))\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "also"], ["proof (state)\nthis:\n  min (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {1}})\n   (\\<Sqinter> {birkhoff_sum f n x |n. n \\<in> {2..}}) =\n  min (f x) (f x + h (T x))\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"... = f x + u (T x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. min (f x) (f x + h (T x)) = f x + u (T x)", "unfolding u_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. min (f x) (f x + h (T x)) = f x + min (h (T x)) 0", "by auto"], ["proof (state)\nthis:\n  min (f x) (f x + h (T x)) = f x + u (T x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "finally"], ["proof (chain)\npicking this:\n  max 0 (h x) + u x = f x + u (T x)", "have \"max 0 (h x) = f x + u (T x) - u x\""], ["proof (prove)\nusing this:\n  max 0 (h x) + u x = f x + u (T x)\n\ngoal (1 subgoal):\n 1. max 0 (h x) = f x + u (T x) - u x", "by auto"], ["proof (state)\nthis:\n  max 0 (h x) = f x + u (T x) - u x\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "then"], ["proof (chain)\npicking this:\n  max 0 (h x) = f x + u (T x) - u x", "have \"g x = max 0 (h x)\""], ["proof (prove)\nusing this:\n  max 0 (h x) = f x + u (T x) - u x\n\ngoal (1 subgoal):\n 1. g x = max 0 (h x)", "unfolding g_def"], ["proof (prove)\nusing this:\n  max 0 (h x) = f x + u (T x) - u x\n\ngoal (1 subgoal):\n 1. f x - u x + u (T x) = max 0 (h x)", "by auto"], ["proof (state)\nthis:\n  g x = max 0 (h x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "then"], ["proof (chain)\npicking this:\n  g x = max 0 (h x)", "have \"g x \\<ge> 0 \\<and> g x \\<le> max 0 (f x)\""], ["proof (prove)\nusing this:\n  g x = max 0 (h x)\n\ngoal (1 subgoal):\n 1. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)", "using \\<open>h x \\<le> f x\\<close>"], ["proof (prove)\nusing this:\n  g x = max 0 (h x)\n  h x \\<le> f x\n\ngoal (1 subgoal):\n 1. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)", "by auto"], ["proof (state)\nthis:\n  0 \\<le> g x \\<and> g x \\<le> max 0 (f x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "}"], ["proof (state)\nthis:\n  \\<lbrakk>0 < real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> g ?x5 \\<and> g ?x5 \\<le> max 0 (f ?x5)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>0 < real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> g ?x5 \\<and> g ?x5 \\<le> max 0 (f ?x5)", "have *: \"AE x in M. g x \\<ge> 0 \\<and> g x \\<le> max 0 (f x)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> g ?x5 \\<and> g ?x5 \\<le> max 0 (f ?x5)\n\ngoal (1 subgoal):\n 1. AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)", "using assms(2) birkhoff_theorem_AE_nonergodic[OF assms(1)]"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> g ?x5 \\<and> g ?x5 \\<le> max 0 (f ?x5)\n  AE x in M. 0 < real_cond_exp M Invariants f x\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)", "by auto"], ["proof (state)\nthis:\n  AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "moreover"], ["proof (state)\nthis:\n  AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "have \"integrable M g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M g", "apply (rule Bochner_Integration.integrable_bound[of _ f])"], ["proof (prove)\ngoal (3 subgoals):\n 1. integrable M f\n 2. g \\<in> borel_measurable M\n 3. AE x in M. norm (g x) \\<le> norm (f x)", "using *"], ["proof (prove)\nusing this:\n  AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)\n\ngoal (3 subgoals):\n 1. integrable M f\n 2. g \\<in> borel_measurable M\n 3. AE x in M. norm (g x) \\<le> norm (f x)", "by (auto simp add: assms)"], ["proof (state)\nthis:\n  integrable M g\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)\n  integrable M g", "have \"u \\<in> borel_measurable M \\<and> integrable M g \\<and> (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and> (\\<forall>x. f x = g x + u x - u (T x))\""], ["proof (prove)\nusing this:\n  AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)\n  integrable M g\n\ngoal (1 subgoal):\n 1. u \\<in> borel_measurable M \\<and>\n    integrable M g \\<and>\n    (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n    (\\<forall>x. f x = g x + u x - u (T x))", "using \\<open>\\<And>x. f x = g x + u x - u (T x)\\<close> \\<open>u \\<in> borel_measurable M\\<close>"], ["proof (prove)\nusing this:\n  AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)\n  integrable M g\n  f ?x = g ?x + u ?x - u (T ?x)\n  u \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. u \\<in> borel_measurable M \\<and>\n    integrable M g \\<and>\n    (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n    (\\<forall>x. f x = g x + u x - u (T x))", "by auto"], ["proof (state)\nthis:\n  u \\<in> borel_measurable M \\<and>\n  integrable M g \\<and>\n  (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n  (\\<forall>x. f x = g x + u x - u (T x))\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "then"], ["proof (chain)\npicking this:\n  u \\<in> borel_measurable M \\<and>\n  integrable M g \\<and>\n  (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n  (\\<forall>x. f x = g x + u x - u (T x))", "show ?thesis"], ["proof (prove)\nusing this:\n  u \\<in> borel_measurable M \\<and>\n  integrable M g \\<and>\n  (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n  (\\<forall>x. f x = g x + u x - u (T x))\n\ngoal (1 subgoal):\n 1. \\<exists>u g.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x))", "by blast"], ["proof (state)\nthis:\n  \\<exists>u g.\n     u \\<in> borel_measurable M \\<and>\n     integrable M g \\<and>\n     (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f x)) \\<and>\n     (\\<forall>x. f x = g x + u x - u (T x))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>To deduce the stronger version that $f$ is cohomologous to an arbitrarily good approximation\nof $E(f|I)$, we apply the previous lemma twice, to control successively the negative and the\npositive side. The sign control in the conclusion of the previous lemma implies that the second step\ndoes not spoil the first one.\\<close>"], ["", "lemma cohomologous_approx_cond_exp:\n  fixes f::\"'a \\<Rightarrow> real\" and B::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\" \"B \\<in> borel_measurable M\"\n      and \"AE x in M. B x > 0\"\n    shows \"\\<exists>g u. u \\<in> borel_measurable M\n              \\<and> integrable M g\n              \\<and> (\\<forall>x. f x = g x + u x - u (T x))\n              \\<and> (AE x in M. abs(g x - real_cond_exp M Invariants f x) \\<le> B x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "define C where \"C = (\\<lambda>x. min (B x) 1)\""], ["proof (state)\nthis:\n  C = (\\<lambda>x. min (B x) 1)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have [measurable]: \"integrable M C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M C", "apply (rule Bochner_Integration.integrable_bound[of _ \"\\<lambda>_. (1::real)\"], auto)"], ["proof (prove)\ngoal (2 subgoals):\n 1. C \\<in> borel_measurable M\n 2. AE x in M. \\<bar>C x\\<bar> \\<le> 1", "unfolding C_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>x. min (B x) 1) \\<in> borel_measurable M\n 2. AE x in M. \\<bar>min (B x) 1\\<bar> \\<le> 1", "using assms(3)"], ["proof (prove)\nusing this:\n  AE x in M. 0 < B x\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. min (B x) 1) \\<in> borel_measurable M\n 2. AE x in M. \\<bar>min (B x) 1\\<bar> \\<le> 1", "by auto"], ["proof (state)\nthis:\n  integrable M C\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"C x \\<le> B x\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. C x \\<le> B x", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. min (B x) 1 \\<le> B x", "by auto"], ["proof (state)\nthis:\n  C ?x3 \\<le> B ?x3\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. C x > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. 0 < C x", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. 0 < min (B x) 1", "using assms(3)"], ["proof (prove)\nusing this:\n  AE x in M. 0 < B x\n\ngoal (1 subgoal):\n 1. AE x in M. 0 < min (B x) 1", "by auto"], ["proof (state)\nthis:\n  AE x in M. 0 < C x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have AECI: \"AE x in M. real_cond_exp M Invariants C x > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. 0 < real_cond_exp M Invariants C x", "by (intro real_cond_exp_gr_c \\<open>integrable M C\\<close> \\<open>AE x in M. C x > 0\\<close>)"], ["proof (state)\nthis:\n  AE x in M. 0 < real_cond_exp M Invariants C x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "define f1 where \"f1 = (\\<lambda>x. f x - real_cond_exp M Invariants f x)\""], ["proof (state)\nthis:\n  f1 = (\\<lambda>x. f x - real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"integrable M f1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M f1", "unfolding f1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. f x - real_cond_exp M Invariants f x)", "by (intro Bochner_Integration.integrable_diff \\<open>integrable M f\\<close> real_cond_exp_int(1))"], ["proof (state)\nthis:\n  integrable M f1\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. real_cond_exp M Invariants f1 x = real_cond_exp M Invariants f x - real_cond_exp M Invariants (real_cond_exp M Invariants f) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f1 x =\n               real_cond_exp M Invariants f x -\n               real_cond_exp M Invariants (real_cond_exp M Invariants f) x", "unfolding f1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants\n                (\\<lambda>x. f x - real_cond_exp M Invariants f x) x =\n               real_cond_exp M Invariants f x -\n               real_cond_exp M Invariants (real_cond_exp M Invariants f) x", "apply (rule real_cond_exp_diff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. integrable M f\n 2. integrable M (real_cond_exp M Invariants f)", "by (intro Bochner_Integration.integrable_diff\n                \\<open>integrable M f\\<close> \\<open>integrable M C\\<close> real_cond_exp_int(1))+"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f1 x =\n             real_cond_exp M Invariants f x -\n             real_cond_exp M Invariants (real_cond_exp M Invariants f) x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "moreover"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f1 x =\n             real_cond_exp M Invariants f x -\n             real_cond_exp M Invariants (real_cond_exp M Invariants f) x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x = real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n               real_cond_exp M Invariants f x", "by (intro real_cond_exp_nested_subalg subalg \\<open>integrable M f\\<close>, auto)"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants f1 x =\n             real_cond_exp M Invariants f x -\n             real_cond_exp M Invariants (real_cond_exp M Invariants f) x\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x", "have AEf1: \"AE x in M. real_cond_exp M Invariants f1 x = 0\""], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants f1 x =\n             real_cond_exp M Invariants f x -\n             real_cond_exp M Invariants (real_cond_exp M Invariants f) x\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f1 x = 0", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f1 x = 0\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have A [measurable]: \"integrable M (\\<lambda>x. f1 x + C x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. f1 x + C x)", "by (intro Bochner_Integration.integrable_add \\<open>integrable M f1\\<close> \\<open>integrable M C\\<close>)"], ["proof (state)\nthis:\n  integrable M (\\<lambda>x. f1 x + C x)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x = real_cond_exp M Invariants f1 x + real_cond_exp M Invariants C x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x =\n               real_cond_exp M Invariants f1 x +\n               real_cond_exp M Invariants C x", "by (intro real_cond_exp_add \\<open>integrable M f1\\<close> \\<open>integrable M C\\<close>)"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x =\n             real_cond_exp M Invariants f1 x +\n             real_cond_exp M Invariants C x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "then"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x =\n             real_cond_exp M Invariants f1 x +\n             real_cond_exp M Invariants C x", "have B: \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x > 0\""], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x =\n             real_cond_exp M Invariants f1 x +\n             real_cond_exp M Invariants C x\n\ngoal (1 subgoal):\n 1. AE x in M. 0 < real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x", "using AECI AEf1"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x =\n             real_cond_exp M Invariants f1 x +\n             real_cond_exp M Invariants C x\n  AE x in M. 0 < real_cond_exp M Invariants C x\n  AE x in M. real_cond_exp M Invariants f1 x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. 0 < real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x", "by auto"], ["proof (state)\nthis:\n  AE x in M. 0 < real_cond_exp M Invariants (\\<lambda>x. f1 x + C x) x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "obtain u2 g2 where H2: \"u2 \\<in> borel_measurable M\" \"integrable M g2\" \"AE x in M. g2 x \\<ge> 0 \\<and> g2 x \\<le> max 0 (f1 x + C x)\" \"\\<And>x. f1 x + C x = g2 x + u2 x - u2 (T x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>u2 g2.\n        \\<lbrakk>u2 \\<in> borel_measurable M; integrable M g2;\n         AE x in M. 0 \\<le> g2 x \\<and> g2 x \\<le> max 0 (f1 x + C x);\n         \\<And>x. f1 x + C x = g2 x + u2 x - u2 (T x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using cohomologous_approx_cond_exp_aux[OF A B]"], ["proof (prove)\nusing this:\n  \\<exists>u g.\n     u \\<in> borel_measurable M \\<and>\n     integrable M g \\<and>\n     (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (f1 x + C x)) \\<and>\n     (\\<forall>x. f1 x + C x = g x + u x - u (T x))\n\ngoal (1 subgoal):\n 1. (\\<And>u2 g2.\n        \\<lbrakk>u2 \\<in> borel_measurable M; integrable M g2;\n         AE x in M. 0 \\<le> g2 x \\<and> g2 x \\<le> max 0 (f1 x + C x);\n         \\<And>x. f1 x + C x = g2 x + u2 x - u2 (T x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  u2 \\<in> borel_measurable M\n  integrable M g2\n  AE x in M. 0 \\<le> g2 x \\<and> g2 x \\<le> max 0 (f1 x + C x)\n  f1 ?x3 + C ?x3 = g2 ?x3 + u2 ?x3 - u2 (T ?x3)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "define f2 where \"f2 = (\\<lambda>x. (g2 x - C x))\""], ["proof (state)\nthis:\n  f2 = (\\<lambda>x. g2 x - C x)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have *: \"u2(T x) - u2 x = f2 x -f1 x\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. u2 (T x) - u2 x = f2 x - f1 x", "unfolding f2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. u2 (T x) - u2 x = g2 x - C x - f1 x", "using H2(4)[of x]"], ["proof (prove)\nusing this:\n  f1 x + C x = g2 x + u2 x - u2 (T x)\n\ngoal (1 subgoal):\n 1. u2 (T x) - u2 x = g2 x - C x - f1 x", "by auto"], ["proof (state)\nthis:\n  u2 (T ?x3) - u2 ?x3 = f2 ?x3 - f1 ?x3\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. f2 x \\<ge> - C x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. - C x \\<le> f2 x", "using H2(3)"], ["proof (prove)\nusing this:\n  AE x in M. 0 \\<le> g2 x \\<and> g2 x \\<le> max 0 (f1 x + C x)\n\ngoal (1 subgoal):\n 1. AE x in M. - C x \\<le> f2 x", "unfolding f2_def"], ["proof (prove)\nusing this:\n  AE x in M. 0 \\<le> g2 x \\<and> g2 x \\<le> max 0 (f1 x + C x)\n\ngoal (1 subgoal):\n 1. AE x in M. - C x \\<le> g2 x - C x", "by auto"], ["proof (state)\nthis:\n  AE x in M. - C x \\<le> f2 x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"integrable M f2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M f2", "unfolding f2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. g2 x - C x)", "by (intro Bochner_Integration.integrable_diff \\<open>integrable M g2\\<close> \\<open>integrable M C\\<close>)"], ["proof (state)\nthis:\n  integrable M f2\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. u2(T x) - u2 x) x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. u2 (T x) - u2 x) x =\n               0", "proof (rule limit_foTn_over_n)"], ["proof (state)\ngoal (2 subgoals):\n 1. u2 \\<in> borel_measurable M\n 2. integrable M (\\<lambda>x. u2 (T x) - u2 x)", "show \"integrable M (\\<lambda>x. u2(T x) - u2 x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. u2 (T x) - u2 x)", "unfolding *"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. f2 x - f1 x)", "by (intro Bochner_Integration.integrable_diff \\<open>integrable M f1\\<close> \\<open>integrable M f2\\<close>)"], ["proof (state)\nthis:\n  integrable M (\\<lambda>x. u2 (T x) - u2 x)\n\ngoal (1 subgoal):\n 1. u2 \\<in> borel_measurable M", "qed (simp add: \\<open>u2 \\<in> borel_measurable M\\<close>)"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. u2 (T x) - u2 x) x = 0\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "then"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. u2 (T x) - u2 x) x = 0", "have \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0\""], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. u2 (T x) - u2 x) x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0", "unfolding *"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0", "by simp"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "moreover"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = real_cond_exp M Invariants f2 x - real_cond_exp M Invariants f1 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x =\n               real_cond_exp M Invariants f2 x -\n               real_cond_exp M Invariants f1 x", "by (intro real_cond_exp_diff \\<open>integrable M f2\\<close> \\<open>integrable M f1\\<close>)"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x =\n             real_cond_exp M Invariants f2 x -\n             real_cond_exp M Invariants f1 x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x =\n             real_cond_exp M Invariants f2 x -\n             real_cond_exp M Invariants f1 x", "have AEf2: \"AE x in M. real_cond_exp M Invariants f2 x = 0\""], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x =\n             real_cond_exp M Invariants f2 x -\n             real_cond_exp M Invariants f1 x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f2 x = 0", "using AEf1"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x = 0\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. f2 x - f1 x) x =\n             real_cond_exp M Invariants f2 x -\n             real_cond_exp M Invariants f1 x\n  AE x in M. real_cond_exp M Invariants f1 x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants f2 x = 0", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants f2 x = 0\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have A [measurable]: \"integrable M (\\<lambda>x. C x - f2 x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. C x - f2 x)", "by (intro Bochner_Integration.integrable_diff \\<open>integrable M f2\\<close> \\<open>integrable M C\\<close>)"], ["proof (state)\nthis:\n  integrable M (\\<lambda>x. C x - f2 x)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x = real_cond_exp M Invariants C x - real_cond_exp M Invariants f2 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x =\n               real_cond_exp M Invariants C x -\n               real_cond_exp M Invariants f2 x", "by (intro real_cond_exp_diff \\<open>integrable M f2\\<close> \\<open>integrable M C\\<close>)"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x =\n             real_cond_exp M Invariants C x -\n             real_cond_exp M Invariants f2 x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "then"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x =\n             real_cond_exp M Invariants C x -\n             real_cond_exp M Invariants f2 x", "have B: \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x > 0\""], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x =\n             real_cond_exp M Invariants C x -\n             real_cond_exp M Invariants f2 x\n\ngoal (1 subgoal):\n 1. AE x in M. 0 < real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x", "using AECI AEf2"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x =\n             real_cond_exp M Invariants C x -\n             real_cond_exp M Invariants f2 x\n  AE x in M. 0 < real_cond_exp M Invariants C x\n  AE x in M. real_cond_exp M Invariants f2 x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. 0 < real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x", "by auto"], ["proof (state)\nthis:\n  AE x in M. 0 < real_cond_exp M Invariants (\\<lambda>x. C x - f2 x) x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "obtain u3 g3 where H3: \"u3 \\<in> borel_measurable M\" \"integrable M g3\" \"AE x in M. g3 x \\<ge> 0 \\<and> g3 x \\<le> max 0 (C x - f2 x)\" \"\\<And>x. C x - f2 x = g3 x + u3 x - u3 (T x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>u3 g3.\n        \\<lbrakk>u3 \\<in> borel_measurable M; integrable M g3;\n         AE x in M. 0 \\<le> g3 x \\<and> g3 x \\<le> max 0 (C x - f2 x);\n         \\<And>x. C x - f2 x = g3 x + u3 x - u3 (T x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using cohomologous_approx_cond_exp_aux[OF A B]"], ["proof (prove)\nusing this:\n  \\<exists>u g.\n     u \\<in> borel_measurable M \\<and>\n     integrable M g \\<and>\n     (AE x in M. 0 \\<le> g x \\<and> g x \\<le> max 0 (C x - f2 x)) \\<and>\n     (\\<forall>x. C x - f2 x = g x + u x - u (T x))\n\ngoal (1 subgoal):\n 1. (\\<And>u3 g3.\n        \\<lbrakk>u3 \\<in> borel_measurable M; integrable M g3;\n         AE x in M. 0 \\<le> g3 x \\<and> g3 x \\<le> max 0 (C x - f2 x);\n         \\<And>x. C x - f2 x = g3 x + u3 x - u3 (T x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  u3 \\<in> borel_measurable M\n  integrable M g3\n  AE x in M. 0 \\<le> g3 x \\<and> g3 x \\<le> max 0 (C x - f2 x)\n  C ?x3 - f2 ?x3 = g3 ?x3 + u3 ?x3 - u3 (T ?x3)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "define f3 where \"f3 = (\\<lambda>x. C x - g3 x)\""], ["proof (state)\nthis:\n  f3 = (\\<lambda>x. C x - g3 x)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. f3 x \\<ge> min (C x) (f2 x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. min (C x) (f2 x) \\<le> f3 x", "unfolding f3_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. min (C x) (f2 x) \\<le> C x - g3 x", "using H3(3)"], ["proof (prove)\nusing this:\n  AE x in M. 0 \\<le> g3 x \\<and> g3 x \\<le> max 0 (C x - f2 x)\n\ngoal (1 subgoal):\n 1. AE x in M. min (C x) (f2 x) \\<le> C x - g3 x", "by auto"], ["proof (state)\nthis:\n  AE x in M. min (C x) (f2 x) \\<le> f3 x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "then"], ["proof (chain)\npicking this:\n  AE x in M. min (C x) (f2 x) \\<le> f3 x", "have \"AE x in M. f3 x \\<ge> -C x\""], ["proof (prove)\nusing this:\n  AE x in M. min (C x) (f2 x) \\<le> f3 x\n\ngoal (1 subgoal):\n 1. AE x in M. - C x \\<le> f3 x", "using \\<open>AE x in M. f2 x \\<ge> - C x\\<close> \\<open>AE x in M. C x > 0\\<close>"], ["proof (prove)\nusing this:\n  AE x in M. min (C x) (f2 x) \\<le> f3 x\n  AE x in M. - C x \\<le> f2 x\n  AE x in M. 0 < C x\n\ngoal (1 subgoal):\n 1. AE x in M. - C x \\<le> f3 x", "by auto"], ["proof (state)\nthis:\n  AE x in M. - C x \\<le> f3 x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "moreover"], ["proof (state)\nthis:\n  AE x in M. - C x \\<le> f3 x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. f3 x \\<le> C x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. f3 x \\<le> C x", "unfolding f3_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. C x - g3 x \\<le> C x", "using H3(3)"], ["proof (prove)\nusing this:\n  AE x in M. 0 \\<le> g3 x \\<and> g3 x \\<le> max 0 (C x - f2 x)\n\ngoal (1 subgoal):\n 1. AE x in M. C x - g3 x \\<le> C x", "by auto"], ["proof (state)\nthis:\n  AE x in M. f3 x \\<le> C x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. - C x \\<le> f3 x\n  AE x in M. f3 x \\<le> C x", "have \"AE x in M. abs(f3 x) \\<le> C x\""], ["proof (prove)\nusing this:\n  AE x in M. - C x \\<le> f3 x\n  AE x in M. f3 x \\<le> C x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<bar>f3 x\\<bar> \\<le> C x", "by auto"], ["proof (state)\nthis:\n  AE x in M. \\<bar>f3 x\\<bar> \\<le> C x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "then"], ["proof (chain)\npicking this:\n  AE x in M. \\<bar>f3 x\\<bar> \\<le> C x", "have *: \"AE x in M. abs(f3 x) \\<le> B x\""], ["proof (prove)\nusing this:\n  AE x in M. \\<bar>f3 x\\<bar> \\<le> C x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<bar>f3 x\\<bar> \\<le> B x", "using order_trans[OF _ \\<open>\\<And>x. C x \\<le> B x\\<close>]"], ["proof (prove)\nusing this:\n  AE x in M. \\<bar>f3 x\\<bar> \\<le> C x\n  ?x \\<le> C ?x1 \\<Longrightarrow> ?x \\<le> B ?x1\n\ngoal (1 subgoal):\n 1. AE x in M. \\<bar>f3 x\\<bar> \\<le> B x", "by auto"], ["proof (state)\nthis:\n  AE x in M. \\<bar>f3 x\\<bar> \\<le> B x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "define g where \"g = (\\<lambda>x. f3 x + real_cond_exp M Invariants f x)\""], ["proof (state)\nthis:\n  g = (\\<lambda>x. f3 x + real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "define u where \"u = (\\<lambda>x. u2 x - u3 x)\""], ["proof (state)\nthis:\n  u = (\\<lambda>x. u2 x - u3 x)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"AE x in M. abs (g x - real_cond_exp M Invariants f x) \\<le> B x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar> \\<le> B x", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. \\<bar>f3 x + real_cond_exp M Invariants f x -\n                     real_cond_exp M Invariants f x\\<bar>\n               \\<le> B x", "using *"], ["proof (prove)\nusing this:\n  AE x in M. \\<bar>f3 x\\<bar> \\<le> B x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<bar>f3 x + real_cond_exp M Invariants f x -\n                     real_cond_exp M Invariants f x\\<bar>\n               \\<le> B x", "by auto"], ["proof (state)\nthis:\n  AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar> \\<le> B x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "moreover"], ["proof (state)\nthis:\n  AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar> \\<le> B x\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"f x = g x + u x - u(T x)\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. f x = g x + u x - u (T x)", "using H3(4)[of x] H2(4)[of x]"], ["proof (prove)\nusing this:\n  C x - f2 x = g3 x + u3 x - u3 (T x)\n  f1 x + C x = g2 x + u2 x - u2 (T x)\n\ngoal (1 subgoal):\n 1. f x = g x + u x - u (T x)", "unfolding u_def g_def f3_def f2_def f1_def"], ["proof (prove)\nusing this:\n  C x - (g2 x - C x) = g3 x + u3 x - u3 (T x)\n  f x - real_cond_exp M Invariants f x + C x = g2 x + u2 x - u2 (T x)\n\ngoal (1 subgoal):\n 1. f x =\n    C x - g3 x + real_cond_exp M Invariants f x + (u2 x - u3 x) -\n    (u2 (T x) - u3 (T x))", "by auto"], ["proof (state)\nthis:\n  f ?x3 = g ?x3 + u ?x3 - u (T ?x3)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "moreover"], ["proof (state)\nthis:\n  f ?x3 = g ?x3 + u ?x3 - u (T ?x3)\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"u \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> borel_measurable M", "unfolding u_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. u2 x - u3 x) \\<in> borel_measurable M", "using \\<open>u2 \\<in> borel_measurable M\\<close> \\<open>u3 \\<in> borel_measurable M\\<close>"], ["proof (prove)\nusing this:\n  u2 \\<in> borel_measurable M\n  u3 \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. u2 x - u3 x) \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  u \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "moreover"], ["proof (state)\nthis:\n  u \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "have \"integrable M g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M g", "unfolding g_def f3_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. C x - g3 x + real_cond_exp M Invariants f x)", "by (intro Bochner_Integration.integrable_add Bochner_Integration.integrable_diff\n    \\<open>integrable M C\\<close> \\<open>integrable M g3\\<close> \\<open>integrable M f\\<close> real_cond_exp_int(1))"], ["proof (state)\nthis:\n  integrable M g\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar> \\<le> B x\n  f ?x3 = g ?x3 + u ?x3 - u (T ?x3)\n  u \\<in> borel_measurable M\n  integrable M g", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar> \\<le> B x\n  f ?x3 = g ?x3 + u ?x3 - u (T ?x3)\n  u \\<in> borel_measurable M\n  integrable M g\n\ngoal (1 subgoal):\n 1. \\<exists>g u.\n       u \\<in> borel_measurable M \\<and>\n       integrable M g \\<and>\n       (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n       (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar>\n                   \\<le> B x)", "by auto"], ["proof (state)\nthis:\n  \\<exists>g u.\n     u \\<in> borel_measurable M \\<and>\n     integrable M g \\<and>\n     (\\<forall>x. f x = g x + u x - u (T x)) \\<and>\n     (AE x in M. \\<bar>g x - real_cond_exp M Invariants f x\\<bar> \\<le> B x)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>$L^1$ version of Birkhoff theorem\\<close>"], ["", "text \\<open>The $L^1$ convergence in Birkhoff theorem follows from the almost everywhere convergence and\ngeneral considerations on $L^1$ convergence (Scheffe's lemma) explained\nin \\verb+AE_and_int_bound_implies_L1_conv2+.\nThis argument works neatly for nonnegative functions, the general case reduces to this one by taking\nthe positive and negative parts of a given function.\n\nOne could also prove it by truncation: for bounded functions, the $L^1$ convergence follows\nfrom the boundedness and almost sure convergence. The general case follows by density, but it\nis a little bit tedious to write as one need to make sure that the conditional expectation\nof the truncation converges to the conditional expectation of the original function. This is true\nin $L^1$ as the conditional expectation is a contraction in $L^1$, it follows almost everywhere\nafter taking a subsequence. All in all, the argument based on Scheffe's lemma seems more\neconomical.\\<close>"], ["", "lemma birkhoff_lemma_L1:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes \"\\<And>x. f x \\<ge> 0\"\n      and [measurable]: \"integrable M f\"\n  shows \"(\\<lambda>n. \\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "proof (rule Scheffe_lemma2)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>n.\n       (\\<lambda>x. birkhoff_sum f n x / real n) \\<in> borel_measurable M\n 2. integrable M (real_cond_exp M Invariants f)\n 3. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n 4. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "show i: \"integrable M (real_cond_exp M Invariants f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (real_cond_exp M Invariants f)", "using assms"], ["proof (prove)\nusing this:\n  0 \\<le> f ?x3\n  integrable M f\n\ngoal (1 subgoal):\n 1. integrable M (real_cond_exp M Invariants f)", "by (simp add: real_cond_exp_int(1))"], ["proof (state)\nthis:\n  integrable M (real_cond_exp M Invariants f)\n\ngoal (3 subgoals):\n 1. \\<And>n.\n       (\\<lambda>x. birkhoff_sum f n x / real n) \\<in> borel_measurable M\n 2. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n 3. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "show \"AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "using birkhoff_theorem_AE_nonergodic assms"], ["proof (prove)\nusing this:\n  integrable M ?f \\<Longrightarrow>\n  AE x in M. (\\<lambda>n. birkhoff_sum ?f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants ?f x\n  0 \\<le> f ?x3\n  integrable M f\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "by simp"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (2 subgoals):\n 1. \\<And>n.\n       (\\<lambda>x. birkhoff_sum f n x / real n) \\<in> borel_measurable M\n 2. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "fix n"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>n.\n       (\\<lambda>x. birkhoff_sum f n x / real n) \\<in> borel_measurable M\n 2. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have [measurable]: \"(\\<lambda>x. ennreal \\<bar>birkhoff_sum f n x\\<bar>) \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. ennreal \\<bar>birkhoff_sum f n x\\<bar>)\n    \\<in> borel_measurable M", "by measurable"], ["proof (state)\nthis:\n  (\\<lambda>x. ennreal \\<bar>birkhoff_sum f n x\\<bar>)\n  \\<in> borel_measurable M\n\ngoal (2 subgoals):\n 1. \\<And>n.\n       (\\<lambda>x. birkhoff_sum f n x / real n) \\<in> borel_measurable M\n 2. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "show [measurable]: \"(\\<lambda>x. birkhoff_sum f n x / real n) \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. birkhoff_sum f n x / real n) \\<in> borel_measurable M", "by measurable"], ["proof (state)\nthis:\n  (\\<lambda>x. birkhoff_sum f n x / real n) \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"AE x in M. real_cond_exp M Invariants f x \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. 0 \\<le> real_cond_exp M Invariants f x", "using assms(1) real_cond_exp_pos"], ["proof (prove)\nusing this:\n  0 \\<le> f ?x3\n  \\<lbrakk>AE x in M. 0 \\<le> ?f x; ?f \\<in> borel_measurable M\\<rbrakk>\n  \\<Longrightarrow> AE x in M. 0 \\<le> real_cond_exp M Invariants ?f x\n\ngoal (1 subgoal):\n 1. AE x in M. 0 \\<le> real_cond_exp M Invariants f x", "by simp"], ["proof (state)\nthis:\n  AE x in M. 0 \\<le> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "then"], ["proof (chain)\npicking this:\n  AE x in M. 0 \\<le> real_cond_exp M Invariants f x", "have *: \"AE x in M. norm (real_cond_exp M Invariants f x) = real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  AE x in M. 0 \\<le> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. norm (real_cond_exp M Invariants f x) =\n               real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. norm (real_cond_exp M Invariants f x) =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have **: \"(\\<integral> x. norm (real_cond_exp M Invariants f x) \\<partial>M) = (\\<integral> x. real_cond_exp M Invariants f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LINT x|M. norm (real_cond_exp M Invariants f x) =\n    integral\\<^sup>L M (real_cond_exp M Invariants f)", "apply (rule integral_cong_AE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<lambda>x. norm (real_cond_exp M Invariants f x))\n    \\<in> borel_measurable M\n 2. real_cond_exp M Invariants f \\<in> borel_measurable M\n 3. AE x in M. norm (real_cond_exp M Invariants f x) =\n               real_cond_exp M Invariants f x", "using *"], ["proof (prove)\nusing this:\n  AE x in M. norm (real_cond_exp M Invariants f x) =\n             real_cond_exp M Invariants f x\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. norm (real_cond_exp M Invariants f x))\n    \\<in> borel_measurable M\n 2. real_cond_exp M Invariants f \\<in> borel_measurable M\n 3. AE x in M. norm (real_cond_exp M Invariants f x) =\n               real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  LINT x|M. norm (real_cond_exp M Invariants f x) =\n  integral\\<^sup>L M (real_cond_exp M Invariants f)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"(\\<integral>\\<^sup>+x. ennreal (norm (real_cond_exp M Invariants f x)) \\<partial>M) = (\\<integral> x. norm (real_cond_exp M Invariants f x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                       \\<partial>M =\n    ennreal (LINT x|M. norm (real_cond_exp M Invariants f x))", "by (rule nn_integral_eq_integral) (auto simp add: i)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  ennreal (LINT x|M. norm (real_cond_exp M Invariants f x))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  ennreal (LINT x|M. norm (real_cond_exp M Invariants f x))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"... = (\\<integral> x. real_cond_exp M Invariants f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (LINT x|M. norm (real_cond_exp M Invariants f x)) =\n    ennreal (integral\\<^sup>L M (real_cond_exp M Invariants f))", "using **"], ["proof (prove)\nusing this:\n  LINT x|M. norm (real_cond_exp M Invariants f x) =\n  integral\\<^sup>L M (real_cond_exp M Invariants f)\n\ngoal (1 subgoal):\n 1. ennreal (LINT x|M. norm (real_cond_exp M Invariants f x)) =\n    ennreal (integral\\<^sup>L M (real_cond_exp M Invariants f))", "by simp"], ["proof (state)\nthis:\n  ennreal (LINT x|M. norm (real_cond_exp M Invariants f x)) =\n  ennreal (integral\\<^sup>L M (real_cond_exp M Invariants f))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "also"], ["proof (state)\nthis:\n  ennreal (LINT x|M. norm (real_cond_exp M Invariants f x)) =\n  ennreal (integral\\<^sup>L M (real_cond_exp M Invariants f))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"... = (\\<integral> x. f x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (integral\\<^sup>L M (real_cond_exp M Invariants f)) =\n    ennreal (integral\\<^sup>L M f)", "using real_cond_exp_int(2) assms(2)"], ["proof (prove)\nusing this:\n  integrable M ?f \\<Longrightarrow>\n  integral\\<^sup>L M (real_cond_exp M Invariants ?f) = integral\\<^sup>L M ?f\n  integrable M f\n\ngoal (1 subgoal):\n 1. ennreal (integral\\<^sup>L M (real_cond_exp M Invariants f)) =\n    ennreal (integral\\<^sup>L M f)", "by auto"], ["proof (state)\nthis:\n  ennreal (integral\\<^sup>L M (real_cond_exp M Invariants f)) =\n  ennreal (integral\\<^sup>L M f)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "also"], ["proof (state)\nthis:\n  ennreal (integral\\<^sup>L M (real_cond_exp M Invariants f)) =\n  ennreal (integral\\<^sup>L M f)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"... = (\\<integral>x. norm(f x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (integral\\<^sup>L M f) = ennreal (LINT x|M. norm (f x))", "using assms"], ["proof (prove)\nusing this:\n  0 \\<le> f ?x3\n  integrable M f\n\ngoal (1 subgoal):\n 1. ennreal (integral\\<^sup>L M f) = ennreal (LINT x|M. norm (f x))", "by auto"], ["proof (state)\nthis:\n  ennreal (integral\\<^sup>L M f) = ennreal (LINT x|M. norm (f x))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "also"], ["proof (state)\nthis:\n  ennreal (integral\\<^sup>L M f) = ennreal (LINT x|M. norm (f x))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"... = (\\<integral>\\<^sup>+x. norm(f x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (LINT x|M. norm (f x)) =\n    \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M", "by (rule nn_integral_eq_integral[symmetric], auto simp add: assms(2))"], ["proof (state)\nthis:\n  ennreal (LINT x|M. norm (f x)) =\n  \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "finally"], ["proof (chain)\npicking this:\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M", "have eq: \"(\\<integral>\\<^sup>+ x. norm (real_cond_exp M Invariants f x) \\<partial>M) = (\\<integral>\\<^sup>+ x. norm(f x) \\<partial>M)\""], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M", "by simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "{"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"norm(birkhoff_sum f n x) \\<le> birkhoff_sum (\\<lambda>x. norm(f x)) n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm (birkhoff_sum f n x)\n    \\<le> birkhoff_sum (\\<lambda>x. norm (f x)) n x", "using birkhoff_sum_abs"], ["proof (prove)\nusing this:\n  norm (birkhoff_sum ?f ?n ?x)\n  \\<le> birkhoff_sum (\\<lambda>x. norm (?f x)) ?n ?x\n\ngoal (1 subgoal):\n 1. norm (birkhoff_sum f n x)\n    \\<le> birkhoff_sum (\\<lambda>x. norm (f x)) n x", "by fastforce"], ["proof (state)\nthis:\n  norm (birkhoff_sum f n x) \\<le> birkhoff_sum (\\<lambda>x. norm (f x)) n x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "then"], ["proof (chain)\npicking this:\n  norm (birkhoff_sum f n x) \\<le> birkhoff_sum (\\<lambda>x. norm (f x)) n x", "have \"norm(birkhoff_sum f n x) \\<le> birkhoff_sum (\\<lambda>x. ennreal(norm(f x))) n x\""], ["proof (prove)\nusing this:\n  norm (birkhoff_sum f n x) \\<le> birkhoff_sum (\\<lambda>x. norm (f x)) n x\n\ngoal (1 subgoal):\n 1. ennreal (norm (birkhoff_sum f n x))\n    \\<le> birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n x", "unfolding birkhoff_sum_def"], ["proof (prove)\nusing this:\n  norm (\\<Sum>i<n. f ((T ^^ i) x)) \\<le> (\\<Sum>i<n. norm (f ((T ^^ i) x)))\n\ngoal (1 subgoal):\n 1. ennreal (norm (\\<Sum>i<n. f ((T ^^ i) x)))\n    \\<le> (\\<Sum>i<n. ennreal (norm (f ((T ^^ i) x))))", "by auto"], ["proof (state)\nthis:\n  ennreal (norm (birkhoff_sum f n x))\n  \\<le> birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "}"], ["proof (state)\nthis:\n  ennreal (norm (birkhoff_sum f n ?x5))\n  \\<le> birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n ?x5\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "then"], ["proof (chain)\npicking this:\n  ennreal (norm (birkhoff_sum f n ?x5))\n  \\<le> birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n ?x5", "have \"(\\<integral>\\<^sup>+x. norm(birkhoff_sum f n x) \\<partial>M) \\<le> (\\<integral>\\<^sup>+x. birkhoff_sum (\\<lambda>x. ennreal(norm(f x))) n x \\<partial>M)\""], ["proof (prove)\nusing this:\n  ennreal (norm (birkhoff_sum f n ?x5))\n  \\<le> birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n ?x5\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n    \\<le> integral\\<^sup>N M\n           (birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n)", "by (simp add: nn_integral_mono)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n  \\<le> integral\\<^sup>N M\n         (birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n  \\<le> integral\\<^sup>N M\n         (birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"... = n * (\\<integral>\\<^sup>+x. norm(f x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral\\<^sup>N M (birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n) =\n    of_nat n * \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M", "by (rule birkhoff_sum_nn_integral, auto)"], ["proof (state)\nthis:\n  integral\\<^sup>N M (birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n) =\n  of_nat n * \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "also"], ["proof (state)\nthis:\n  integral\\<^sup>N M (birkhoff_sum (\\<lambda>x. ennreal (norm (f x))) n) =\n  of_nat n * \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "have \"... = n * (\\<integral>\\<^sup>+ x. norm (real_cond_exp M Invariants f x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_nat n * \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M =\n    of_nat n *\n    \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                       \\<partial>M", "using eq"], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. of_nat n * \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M =\n    of_nat n *\n    \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                       \\<partial>M", "by simp"], ["proof (state)\nthis:\n  of_nat n * \\<integral>\\<^sup>+ x. ennreal (norm (f x)) \\<partial>M =\n  of_nat n *\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "finally"], ["proof (chain)\npicking this:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n  \\<le> of_nat n *\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M", "have *: \"(\\<integral>\\<^sup>+x. norm(birkhoff_sum f n x) \\<partial>M) \\<le> n * (\\<integral>\\<^sup>+ x. norm (real_cond_exp M Invariants f x) \\<partial>M)\""], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n  \\<le> of_nat n *\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n    \\<le> of_nat n *\n          \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "by simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n  \\<le> of_nat n *\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm (real_cond_exp M Invariants f x))\n                                \\<partial>M", "show \"(\\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n)) \\<partial>M) \\<le> (\\<integral>\\<^sup>+ x. norm (real_cond_exp M Invariants f x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M\n 2. \\<not> ?P \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "assume \"n = 0\""], ["proof (state)\nthis:\n  n = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M\n 2. \\<not> ?P \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "then"], ["proof (chain)\npicking this:\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "by auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "assume \"\\<not>(n = 0)\""], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "then"], ["proof (chain)\npicking this:\n  n \\<noteq> 0", "have \"n > 0\""], ["proof (prove)\nusing this:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < n", "by simp"], ["proof (state)\nthis:\n  0 < n\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "then"], ["proof (chain)\npicking this:\n  0 < n", "have \"1/ennreal(real n) \\<ge> 0\""], ["proof (prove)\nusing this:\n  0 < n\n\ngoal (1 subgoal):\n 1. 0 \\<le> 1 / ennreal (real n)", "by simp"], ["proof (state)\nthis:\n  0 \\<le> 1 / ennreal (real n)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "have \"(\\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n)) \\<partial>M) = (\\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) / ennreal(real n) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) /\n                           ennreal (real n)\n                       \\<partial>M", "using \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < n\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) /\n                           ennreal (real n)\n                       \\<partial>M", "by (auto simp: divide_ennreal)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) /\n                         ennreal (real n)\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) /\n                         ennreal (real n)\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "have \"... = (\\<integral>\\<^sup>+ x. (1/ennreal(real n)) * ennreal (norm (birkhoff_sum f n x)) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) /\n                           ennreal (real n)\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. 1 / ennreal (real n) *\n                           ennreal (norm (birkhoff_sum f n x))\n                       \\<partial>M", "by (simp add: \\<open>0 < n\\<close> divide_ennreal_def mult.commute)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) /\n                         ennreal (real n)\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. 1 / ennreal (real n) *\n                         ennreal (norm (birkhoff_sum f n x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) /\n                         ennreal (real n)\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. 1 / ennreal (real n) *\n                         ennreal (norm (birkhoff_sum f n x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "have \"... = (1/ennreal(real n) * (\\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. 1 / ennreal (real n) *\n                           ennreal (norm (birkhoff_sum f n x))\n                       \\<partial>M =\n    1 / ennreal (real n) *\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M", "by (subst nn_integral_cmult) auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. 1 / ennreal (real n) *\n                         ennreal (norm (birkhoff_sum f n x))\n                     \\<partial>M =\n  1 / ennreal (real n) *\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. 1 / ennreal (real n) *\n                         ennreal (norm (birkhoff_sum f n x))\n                     \\<partial>M =\n  1 / ennreal (real n) *\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "have \"... \\<le> (1/ennreal(real n)) * (ennreal(real n) * (\\<integral>\\<^sup>+ x. norm (real_cond_exp M Invariants f x) \\<partial>M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / ennreal (real n) *\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n    \\<le> 1 / ennreal (real n) *\n          (ennreal (real n) *\n           \\<integral>\\<^sup>+ x. ennreal\n                                   (norm (real_cond_exp M Invariants f x))\n                              \\<partial>M)", "using *"], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n  \\<le> of_nat n *\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. 1 / ennreal (real n) *\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n    \\<le> 1 / ennreal (real n) *\n          (ennreal (real n) *\n           \\<integral>\\<^sup>+ x. ennreal\n                                   (norm (real_cond_exp M Invariants f x))\n                              \\<partial>M)", "by (intro mult_mono) (auto simp: ennreal_of_nat_eq_real_of_nat)"], ["proof (state)\nthis:\n  1 / ennreal (real n) *\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n  \\<le> 1 / ennreal (real n) *\n        (ennreal (real n) *\n         \\<integral>\\<^sup>+ x. ennreal\n                                 (norm (real_cond_exp M Invariants f x))\n                            \\<partial>M)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "also"], ["proof (state)\nthis:\n  1 / ennreal (real n) *\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x)) \\<partial>M\n  \\<le> 1 / ennreal (real n) *\n        (ennreal (real n) *\n         \\<integral>\\<^sup>+ x. ennreal\n                                 (norm (real_cond_exp M Invariants f x))\n                            \\<partial>M)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "have \"... = (\\<integral>\\<^sup>+ x. norm (real_cond_exp M Invariants f x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / ennreal (real n) *\n    (ennreal (real n) *\n     \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                        \\<partial>M) =\n    \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                       \\<partial>M", "using \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < n\n\ngoal (1 subgoal):\n 1. 1 / ennreal (real n) *\n    (ennreal (real n) *\n     \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                        \\<partial>M) =\n    \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                       \\<partial>M", "by (auto simp del: ennreal_1 simp add: ennreal_1[symmetric] divide_ennreal ennreal_mult[symmetric] mult.assoc[symmetric])\n        simp"], ["proof (state)\nthis:\n  1 / ennreal (real n) *\n  (ennreal (real n) *\n   \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                      \\<partial>M) =\n  \\<integral>\\<^sup>+ x. ennreal (norm (real_cond_exp M Invariants f x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "finally"], ["proof (chain)\npicking this:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm (real_cond_exp M Invariants f x))\n                             \\<partial>M", "by simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (norm (birkhoff_sum f n x / real n))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm (real_cond_exp M Invariants f x))\n                           \\<partial>M\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem birkhoff_theorem_L1_nonergodic:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n  shows \"(\\<lambda>n. \\<integral>\\<^sup>+x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "define g where \"g = (\\<lambda>x. max (f x) 0)\""], ["proof (state)\nthis:\n  g = (\\<lambda>x. max (f x) 0)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have g_int [measurable]: \"integrable M g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M g", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. max (f x) 0)", "using assms"], ["proof (prove)\nusing this:\n  integrable M f\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. max (f x) 0)", "by auto"], ["proof (state)\nthis:\n  integrable M g\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "define h where \"h = (\\<lambda>x. max (-f x) 0)\""], ["proof (state)\nthis:\n  h = (\\<lambda>x. max (- f x) 0)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have h_int [measurable]: \"integrable M h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M h", "unfolding h_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. max (- f x) 0)", "using assms"], ["proof (prove)\nusing this:\n  integrable M f\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. max (- f x) 0)", "by auto"], ["proof (state)\nthis:\n  integrable M h\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"f = (\\<lambda>x. g x - h x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f = (\\<lambda>x. g x - h x)", "unfolding g_def h_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. f = (\\<lambda>x. max (f x) 0 - max (- f x) 0)", "by auto"], ["proof (state)\nthis:\n  f = (\\<lambda>x. g x - h x)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "{"], ["proof (state)\nthis:\n  f = (\\<lambda>x. g x - h x)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "fix n::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "assume \"n > 0\""], ["proof (state)\nthis:\n  0 < n\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"\\<And>x. birkhoff_sum f n x = birkhoff_sum g n x - birkhoff_sum h n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. birkhoff_sum f n x = birkhoff_sum g n x - birkhoff_sum h n x", "using birkhoff_sum_diff \\<open>f = (\\<lambda>x. g x - h x)\\<close>"], ["proof (prove)\nusing this:\n  birkhoff_sum (\\<lambda>x. ?f x - ?g x) ?n ?x =\n  birkhoff_sum ?f ?n ?x - birkhoff_sum ?g ?n ?x\n  f = (\\<lambda>x. g x - h x)\n\ngoal (1 subgoal):\n 1. \\<And>x. birkhoff_sum f n x = birkhoff_sum g n x - birkhoff_sum h n x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum f n ?x3 = birkhoff_sum g n ?x3 - birkhoff_sum h n ?x3\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f n ?x3 = birkhoff_sum g n ?x3 - birkhoff_sum h n ?x3", "have \"\\<And>x. birkhoff_sum f n x / n = birkhoff_sum g n x / n - birkhoff_sum h n x / n\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n ?x3 = birkhoff_sum g n ?x3 - birkhoff_sum h n ?x3\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       birkhoff_sum f n x / real n =\n       birkhoff_sum g n x / real n - birkhoff_sum h n x / real n", "using \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  birkhoff_sum f n ?x3 = birkhoff_sum g n ?x3 - birkhoff_sum h n ?x3\n  0 < n\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       birkhoff_sum f n x / real n =\n       birkhoff_sum g n x / real n - birkhoff_sum h n x / real n", "by (simp add: diff_divide_distrib)"], ["proof (state)\nthis:\n  birkhoff_sum f n ?x3 / real n =\n  birkhoff_sum g n ?x3 / real n - birkhoff_sum h n ?x3 / real n\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "moreover"], ["proof (state)\nthis:\n  birkhoff_sum f n ?x3 / real n =\n  birkhoff_sum g n ?x3 / real n - birkhoff_sum h n ?x3 / real n\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"AE x in M. real_cond_exp M Invariants g x - real_cond_exp M Invariants h x = real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants g x -\n               real_cond_exp M Invariants h x =\n               real_cond_exp M Invariants f x", "using AE_symmetric[OF real_cond_exp_diff] g_int h_int \\<open>f = (\\<lambda>x. g x - h x)\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>integrable M ?f1; integrable M ?g1\\<rbrakk>\n  \\<Longrightarrow> AE x in M. real_cond_exp M Invariants ?f1 x -\n                               real_cond_exp M Invariants ?g1 x =\n                               real_cond_exp M Invariants\n                                (\\<lambda>x. ?f1 x - ?g1 x) x\n  integrable M g\n  integrable M h\n  f = (\\<lambda>x. g x - h x)\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants g x -\n               real_cond_exp M Invariants h x =\n               real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants g x -\n             real_cond_exp M Invariants h x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "ultimately"], ["proof (chain)\npicking this:\n  birkhoff_sum f n ?x3 / real n =\n  birkhoff_sum g n ?x3 / real n - birkhoff_sum h n ?x3 / real n\n  AE x in M. real_cond_exp M Invariants g x -\n             real_cond_exp M Invariants h x =\n             real_cond_exp M Invariants f x", "have \"AE x in M. birkhoff_sum f n x / n - real_cond_exp M Invariants f x =\n        (birkhoff_sum g n x / n - real_cond_exp M Invariants g x) - (birkhoff_sum h n x / n - real_cond_exp M Invariants h x)\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n ?x3 / real n =\n  birkhoff_sum g n ?x3 / real n - birkhoff_sum h n ?x3 / real n\n  AE x in M. real_cond_exp M Invariants g x -\n             real_cond_exp M Invariants h x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. birkhoff_sum f n x / real n -\n               real_cond_exp M Invariants f x =\n               birkhoff_sum g n x / real n -\n               real_cond_exp M Invariants g x -\n               (birkhoff_sum h n x / real n -\n                real_cond_exp M Invariants h x)", "by auto"], ["proof (state)\nthis:\n  AE x in M. birkhoff_sum f n x / real n - real_cond_exp M Invariants f x =\n             birkhoff_sum g n x / real n - real_cond_exp M Invariants g x -\n             (birkhoff_sum h n x / real n - real_cond_exp M Invariants h x)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  AE x in M. birkhoff_sum f n x / real n - real_cond_exp M Invariants f x =\n             birkhoff_sum g n x / real n - real_cond_exp M Invariants g x -\n             (birkhoff_sum h n x / real n - real_cond_exp M Invariants h x)", "have *: \"AE x in M. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<le>\n      norm(birkhoff_sum g n x / n - real_cond_exp M Invariants g x) + norm(birkhoff_sum h n x / n - real_cond_exp M Invariants h x)\""], ["proof (prove)\nusing this:\n  AE x in M. birkhoff_sum f n x / real n - real_cond_exp M Invariants f x =\n             birkhoff_sum g n x / real n - real_cond_exp M Invariants g x -\n             (birkhoff_sum h n x / real n - real_cond_exp M Invariants h x)\n\ngoal (1 subgoal):\n 1. AE x in M. norm\n                (birkhoff_sum f n x / real n -\n                 real_cond_exp M Invariants f x)\n               \\<le> norm\n                      (birkhoff_sum g n x / real n -\n                       real_cond_exp M Invariants g x) +\n                     norm\n                      (birkhoff_sum h n x / real n -\n                       real_cond_exp M Invariants h x)", "by auto"], ["proof (state)\nthis:\n  AE x in M. norm\n              (birkhoff_sum f n x / real n - real_cond_exp M Invariants f x)\n             \\<le> norm\n                    (birkhoff_sum g n x / real n -\n                     real_cond_exp M Invariants g x) +\n                   norm\n                    (birkhoff_sum h n x / real n -\n                     real_cond_exp M Invariants h x)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"(\\<integral>\\<^sup>+ x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<le>\n      (\\<integral>\\<^sup>+ x. ennreal(norm(birkhoff_sum g n x / n - real_cond_exp M Invariants g x)) + norm(birkhoff_sum h n x / n - real_cond_exp M Invariants h x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal\n                            (norm\n                              (birkhoff_sum f n x / real n -\n                               real_cond_exp M Invariants f x))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm\n                                    (birkhoff_sum g n x / real n -\n                                     real_cond_exp M Invariants g x)) +\n                                 ennreal\n                                  (norm\n                                    (birkhoff_sum h n x / real n -\n                                     real_cond_exp M Invariants h x))\n                             \\<partial>M", "apply (rule nn_integral_mono_AE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. ennreal\n                (norm\n                  (birkhoff_sum f n x / real n -\n                   real_cond_exp M Invariants f x))\n               \\<le> ennreal\n                      (norm\n                        (birkhoff_sum g n x / real n -\n                         real_cond_exp M Invariants g x)) +\n                     ennreal\n                      (norm\n                        (birkhoff_sum h n x / real n -\n                         real_cond_exp M Invariants h x))", "using *"], ["proof (prove)\nusing this:\n  AE x in M. norm\n              (birkhoff_sum f n x / real n - real_cond_exp M Invariants f x)\n             \\<le> norm\n                    (birkhoff_sum g n x / real n -\n                     real_cond_exp M Invariants g x) +\n                   norm\n                    (birkhoff_sum h n x / real n -\n                     real_cond_exp M Invariants h x)\n\ngoal (1 subgoal):\n 1. AE x in M. ennreal\n                (norm\n                  (birkhoff_sum f n x / real n -\n                   real_cond_exp M Invariants f x))\n               \\<le> ennreal\n                      (norm\n                        (birkhoff_sum g n x / real n -\n                         real_cond_exp M Invariants g x)) +\n                     ennreal\n                      (norm\n                        (birkhoff_sum h n x / real n -\n                         real_cond_exp M Invariants h x))", "by (simp add: ennreal_plus[symmetric] del: ennreal_plus)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f n x / real n -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g n x / real n -\n                                   real_cond_exp M Invariants g x)) +\n                               ennreal\n                                (norm\n                                  (birkhoff_sum h n x / real n -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f n x / real n -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g n x / real n -\n                                   real_cond_exp M Invariants g x)) +\n                               ennreal\n                                (norm\n                                  (birkhoff_sum h n x / real n -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"... = (\\<integral>\\<^sup>+ x. norm(birkhoff_sum g n x / n - real_cond_exp M Invariants g x) \\<partial>M) + (\\<integral>\\<^sup>+ x. norm(birkhoff_sum h n x / n - real_cond_exp M Invariants h x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal\n                            (norm\n                              (birkhoff_sum g n x / real n -\n                               real_cond_exp M Invariants g x)) +\n                           ennreal\n                            (norm\n                              (birkhoff_sum h n x / real n -\n                               real_cond_exp M Invariants h x))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal\n                            (norm\n                              (birkhoff_sum g n x / real n -\n                               real_cond_exp M Invariants g x))\n                       \\<partial>M +\n    \\<integral>\\<^sup>+ x. ennreal\n                            (norm\n                              (birkhoff_sum h n x / real n -\n                               real_cond_exp M Invariants h x))\n                       \\<partial>M", "apply (rule nn_integral_add)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>x.\n        ennreal\n         (norm\n           (birkhoff_sum g n x / real n - real_cond_exp M Invariants g x)))\n    \\<in> borel_measurable M\n 2. (\\<lambda>x.\n        ennreal\n         (norm\n           (birkhoff_sum h n x / real n - real_cond_exp M Invariants h x)))\n    \\<in> borel_measurable M", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "using real_cond_exp_F_meas borel_measurable_cond_exp2"], ["proof (prove)\nusing this:\n  \\<lbrakk>integrable M ?f; ?f \\<in> borel_measurable Invariants\\<rbrakk>\n  \\<Longrightarrow> AE x in M. real_cond_exp M Invariants ?f x = ?f x\n  real_cond_exp ?M ?F ?f \\<in> borel_measurable ?M\n\ngoal:\nNo subgoals!", "by measurable"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum g n x / real n -\n                             real_cond_exp M Invariants g x)) +\n                         ennreal\n                          (norm\n                            (birkhoff_sum h n x / real n -\n                             real_cond_exp M Invariants h x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum g n x / real n -\n                             real_cond_exp M Invariants g x))\n                     \\<partial>M +\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum h n x / real n -\n                             real_cond_exp M Invariants h x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "finally"], ["proof (chain)\npicking this:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f n x / real n -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g n x / real n -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h n x / real n -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M", "have \"(\\<integral>\\<^sup>+ x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<le>\n      (\\<integral>\\<^sup>+ x. norm(birkhoff_sum g n x / n - real_cond_exp M Invariants g x) \\<partial>M) + (\\<integral>\\<^sup>+ x. norm(birkhoff_sum h n x / n - real_cond_exp M Invariants h x) \\<partial>M)\""], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f n x / real n -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g n x / real n -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h n x / real n -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal\n                            (norm\n                              (birkhoff_sum f n x / real n -\n                               real_cond_exp M Invariants f x))\n                       \\<partial>M\n    \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                  (norm\n                                    (birkhoff_sum g n x / real n -\n                                     real_cond_exp M Invariants g x))\n                             \\<partial>M +\n          \\<integral>\\<^sup>+ x. ennreal\n                                  (norm\n                                    (birkhoff_sum h n x / real n -\n                                     real_cond_exp M Invariants h x))\n                             \\<partial>M", "by simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f n x / real n -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g n x / real n -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h n x / real n -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "}"], ["proof (state)\nthis:\n  0 < ?n5 \\<Longrightarrow>\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n5 x / real ?n5 -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g ?n5 x / real ?n5 -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h ?n5 x / real ?n5 -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  0 < ?n5 \\<Longrightarrow>\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n5 x / real ?n5 -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g ?n5 x / real ?n5 -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h ?n5 x / real ?n5 -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M", "have *: \"eventually (\\<lambda>n. (\\<integral>\\<^sup>+ x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<le>\n      (\\<integral>\\<^sup>+ x. norm(birkhoff_sum g n x / n - real_cond_exp M Invariants g x) \\<partial>M) + (\\<integral>\\<^sup>+ x. norm(birkhoff_sum h n x / n - real_cond_exp M Invariants h x) \\<partial>M))\n      sequentially\""], ["proof (prove)\nusing this:\n  0 < ?n5 \\<Longrightarrow>\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n5 x / real ?n5 -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g ?n5 x / real ?n5 -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h ?n5 x / real ?n5 -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       \\<integral>\\<^sup>+ x. ennreal\n                               (norm\n                                 (birkhoff_sum f n x / real n -\n                                  real_cond_exp M Invariants f x))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm\n (birkhoff_sum g n x / real n - real_cond_exp M Invariants g x))\n                                \\<partial>M +\n             \\<integral>\\<^sup>+ x. ennreal\n                                     (norm\n (birkhoff_sum h n x / real n - real_cond_exp M Invariants h x))\n                                \\<partial>M", "using eventually_at_top_dense"], ["proof (prove)\nusing this:\n  0 < ?n5 \\<Longrightarrow>\n  \\<integral>\\<^sup>+ x. ennreal\n                          (norm\n                            (birkhoff_sum f ?n5 x / real ?n5 -\n                             real_cond_exp M Invariants f x))\n                     \\<partial>M\n  \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g ?n5 x / real ?n5 -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h ?n5 x / real ?n5 -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M\n  eventually ?P at_top = (\\<exists>N. \\<forall>n>N. ?P n)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       \\<integral>\\<^sup>+ x. ennreal\n                               (norm\n                                 (birkhoff_sum f n x / real n -\n                                  real_cond_exp M Invariants f x))\n                          \\<partial>M\n       \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm\n (birkhoff_sum g n x / real n - real_cond_exp M Invariants g x))\n                                \\<partial>M +\n             \\<integral>\\<^sup>+ x. ennreal\n                                     (norm\n (birkhoff_sum h n x / real n - real_cond_exp M Invariants h x))\n                                \\<partial>M", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     \\<integral>\\<^sup>+ x. ennreal\n                             (norm\n                               (birkhoff_sum f n x / real n -\n                                real_cond_exp M Invariants f x))\n                        \\<partial>M\n     \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                   (norm\n                                     (birkhoff_sum g n x / real n -\nreal_cond_exp M Invariants g x))\n                              \\<partial>M +\n           \\<integral>\\<^sup>+ x. ennreal\n                                   (norm\n                                     (birkhoff_sum h n x / real n -\nreal_cond_exp M Invariants h x))\n                              \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have **: \"eventually (\\<lambda>n. (\\<integral>\\<^sup>+ x. norm(birkhoff_sum f n x / n - real_cond_exp M Invariants f x) \\<partial>M) \\<ge> 0) sequentially\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       0 \\<le> \\<integral>\\<^sup>+ x. ennreal\n (norm (birkhoff_sum f n x / real n - real_cond_exp M Invariants f x))\n                                  \\<partial>M", "by simp"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     0 \\<le> \\<integral>\\<^sup>+ x. ennreal\n                                     (norm\n (birkhoff_sum f n x / real n - real_cond_exp M Invariants f x))\n                                \\<partial>M\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. (\\<integral>\\<^sup>+ x. norm(birkhoff_sum g n x / n - real_cond_exp M Invariants g x) \\<partial>M)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g n x / real n -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "apply (rule birkhoff_lemma_L1, auto simp add: g_int)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. 0 \\<le> g x", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. 0 \\<le> max (f x) 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. (\\<integral>\\<^sup>+ x. norm(birkhoff_sum h n x / n - real_cond_exp M Invariants h x) \\<partial>M)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h n x / real n -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "apply (rule birkhoff_lemma_L1, auto simp add: h_int)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. 0 \\<le> h x", "unfolding h_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. 0 \\<le> max (- f x) 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum h n x / real n -\n                                 real_cond_exp M Invariants h x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum h n x / real n -\n                                 real_cond_exp M Invariants h x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. (\\<integral>\\<^sup>+ x. norm(birkhoff_sum g n x / n - real_cond_exp M Invariants g x) \\<partial>M) + (\\<integral>\\<^sup>+ x. norm(birkhoff_sum h n x / n - real_cond_exp M Invariants h x) \\<partial>M)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum h n x / real n -\n                                 real_cond_exp M Invariants h x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g n x / real n -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h n x / real n -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "using tendsto_add[of _ 0 _ _ 0]"], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum h n x / real n -\n                                 real_cond_exp M Invariants h x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n  \\<lbrakk>(?f \\<longlongrightarrow> (0::?'b3)) ?F;\n   (?g \\<longlongrightarrow> (0::?'b3)) ?F\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. ?f x + ?g x) \\<longlongrightarrow>\n                     (0::?'b3) + (0::?'b3))\n                     ?F\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum g n x / real n -\n                                   real_cond_exp M Invariants g x))\n                           \\<partial>M +\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum h n x / real n -\n                                   real_cond_exp M Invariants h x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M +\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum h n x / real n -\n                                 real_cond_exp M Invariants h x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M +\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum h n x / real n -\n                                 real_cond_exp M Invariants h x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M +\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum h n x / real n -\n                                 real_cond_exp M Invariants h x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "using tendsto_sandwich[OF ** *]"], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum g n x / real n -\n                                 real_cond_exp M Invariants g x))\n                         \\<partial>M +\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum h n x / real n -\n                                 real_cond_exp M Invariants h x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n  \\<lbrakk>(\\<lambda>n. 0) \\<longlonglongrightarrow> ?c;\n   (\\<lambda>n.\n       \\<integral>\\<^sup>+ x. ennreal\n                               (norm\n                                 (birkhoff_sum g n x / real n -\n                                  real_cond_exp M Invariants g x))\n                          \\<partial>M +\n       \\<integral>\\<^sup>+ x. ennreal\n                               (norm\n                                 (birkhoff_sum h n x / real n -\n                                  real_cond_exp M Invariants h x))\n                          \\<partial>M)\n   \\<longlonglongrightarrow> ?c\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>n.\n                        \\<integral>\\<^sup>+ x.\n       ennreal\n        (norm\n          (birkhoff_sum f n x / real n - real_cond_exp M Invariants f x))\n     \\<partial>M)\n                    \\<longlonglongrightarrow> ?c\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                (norm\n                                  (birkhoff_sum f n x / real n -\n                                   real_cond_exp M Invariants f x))\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              (norm\n                                (birkhoff_sum f n x / real n -\n                                 real_cond_exp M Invariants f x))\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Conservativity of skew products\\<close>"], ["", "text \\<open>The behaviour of skew-products of the form $(x, y) \\mapsto (Tx, y + f x)$ is directly related\nto Birkhoff theorem, as the iterates involve the Birkhoff sums in the fiber. Birkhoff theorem\nimplies that such a skew product is conservative when the function $f$ has vanishing conditional\nexpectation.\n\nTo prove the theorem, assume by contradiction that a set $A$ with positive measure does not\nintersect its preimages. Replacing $A$ with a smaller set $C$, we can assume that $C$ is bounded in\nthe $y$-direction, by a constant $N$, and also that all its nonempty vertical fibers, above the\nprojection $Cx$, have a measure bounded from below. Then, by Birkhoff theorem, for any $r>0$, most\nof the first $n$ preimages of $C$ are contained in the set $\\{|y| \\leq r n+N\\}$, of measure $O(r\nn)$. Hence, they can not be disjoint if $r < \\mu(C)$. To make this argument rigorous, one should\nonly consider the preimages whose $x$-component belongs to a set $Dx$ where the Birkhoff sums are\nsmall. This condition has a positive measure if $\\mu(Cx) + \\mu(Dx) > \\mu(M)$, which one can ensure\nby taking $Dx$ large enough.\\<close>"], ["", "theorem (in fmpt) skew_product_conservative:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"integrable M f\"\n    and \"AE x in M. real_cond_exp M Invariants f x = 0\"\n  shows \"conservative_mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x,y). (T x, y + f x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. conservative_mpt (M \\<Otimes>\\<^sub>M lborel)\n     (\\<lambda>(x, y). (T x, y + f x))", "proof (rule conservative_mptI)"], ["proof (state)\ngoal (2 subgoals):\n 1. mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n 2. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "let ?TS = \"(\\<lambda>(x,y). (T x, y + f x))\""], ["proof (state)\ngoal (2 subgoals):\n 1. mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n 2. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "let ?MS = \"M \\<Otimes>\\<^sub>M (lborel::real measure)\""], ["proof (state)\ngoal (2 subgoals):\n 1. mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n 2. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have f_meas [measurable]: \"f \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  f \\<in> borel_measurable M\n\ngoal (2 subgoals):\n 1. mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n 2. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"mpt M T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mpt M T", "by (simp add: mpt_axioms)"], ["proof (state)\nthis:\n  mpt M T\n\ngoal (2 subgoals):\n 1. mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n 2. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "with mpt_skew_product_real[OF this f_meas]"], ["proof (chain)\npicking this:\n  mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n  mpt M T", "show \"mpt ?MS ?TS\""], ["proof (prove)\nusing this:\n  mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n  mpt M T\n\ngoal (1 subgoal):\n 1. mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))", "by simp"], ["proof (state)\nthis:\n  mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))", "interpret TS: mpt ?MS ?TS"], ["proof (prove)\nusing this:\n  mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))\n\ngoal (1 subgoal):\n 1. mpt (M \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (T x, y + f x))", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "fix A::\"('a \\<times> real) set\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "assume A1 [measurable]: \"A \\<in> sets ?MS\" and A2: \"emeasure ?MS A > 0\""], ["proof (state)\nthis:\n  A \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n  0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"A = (\\<Union>N::nat. A \\<inter> {(x,y). abs(y) \\<le> N})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A = (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})", "by (auto simp add: real_arch_simple)"], ["proof (state)\nthis:\n  A = (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  A = (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})", "have *: \"emeasure ?MS (\\<Union>N::nat. A \\<inter> {(x,y). abs(y) \\<le> N}) > 0\""], ["proof (prove)\nusing this:\n  A = (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})\n\ngoal (1 subgoal):\n 1. 0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n         (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})", "using A2"], ["proof (prove)\nusing this:\n  A = (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})\n  0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\n\ngoal (1 subgoal):\n 1. 0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n         (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})", "by simp"], ["proof (state)\nthis:\n  0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n       (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"space ?MS = space M \\<times> space (lborel::real measure)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. space (M \\<Otimes>\\<^sub>M lborel) = space M \\<times> space lborel", "using space_pair_measure"], ["proof (prove)\nusing this:\n  space (?A \\<Otimes>\\<^sub>M ?B) = space ?A \\<times> space ?B\n\ngoal (1 subgoal):\n 1. space (M \\<Otimes>\\<^sub>M lborel) = space M \\<times> space lborel", "by auto"], ["proof (state)\nthis:\n  space (M \\<Otimes>\\<^sub>M lborel) = space M \\<times> space lborel\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  space (M \\<Otimes>\\<^sub>M lborel) = space M \\<times> space lborel", "have A_inc: \"A \\<subseteq> space M \\<times> space (lborel::real measure)\""], ["proof (prove)\nusing this:\n  space (M \\<Otimes>\\<^sub>M lborel) = space M \\<times> space lborel\n\ngoal (1 subgoal):\n 1. A \\<subseteq> space M \\<times> space lborel", "using sets.sets_into_space[OF A1]"], ["proof (prove)\nusing this:\n  space (M \\<Otimes>\\<^sub>M lborel) = space M \\<times> space lborel\n  A \\<subseteq> space (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. A \\<subseteq> space M \\<times> space lborel", "by auto"], ["proof (state)\nthis:\n  A \\<subseteq> space M \\<times> space lborel\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "{"], ["proof (state)\nthis:\n  A \\<subseteq> space M \\<times> space lborel\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "fix N::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"{(x, y). abs(y) \\<le> real N \\<and> x \\<in> space M} = space M \\<times> {-(real N)..(real N)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M} =\n    space M \\<times> {- real N..real N}", "by auto"], ["proof (state)\nthis:\n  {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M} =\n  space M \\<times> {- real N..real N}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M} =\n  space M \\<times> {- real N..real N}", "have \"{(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M} \\<in> sets ?MS\""], ["proof (prove)\nusing this:\n  {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M} =\n  space M \\<times> {- real N..real N}\n\ngoal (1 subgoal):\n 1. {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "have \"A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M} \\<in> sets ?MS\""], ["proof (prove)\nusing this:\n  {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "using A1"], ["proof (prove)\nusing this:\n  {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n  A \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "moreover"], ["proof (state)\nthis:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"A \\<inter> {(x,y). abs(y) \\<le> real N} = A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} =\n    A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}", "using A_inc"], ["proof (prove)\nusing this:\n  A \\<subseteq> space M \\<times> space lborel\n\ngoal (1 subgoal):\n 1. A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} =\n    A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}", "by blast"], ["proof (state)\nthis:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} =\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "ultimately"], ["proof (chain)\npicking this:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} =\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}", "have \"A \\<inter> {(x,y). abs(y) \\<le> real N} \\<in> sets ?MS\""], ["proof (prove)\nusing this:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} =\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N \\<and> x \\<in> space M}\n\ngoal (1 subgoal):\n 1. A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "}"], ["proof (state)\nthis:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real ?N5}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real ?N5}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "have [measurable]: \"\\<And>N::nat. A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} \\<in> sets (M \\<Otimes>\\<^sub>M borel)\""], ["proof (prove)\nusing this:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real ?N5}\n  \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>N.\n       A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N}\n       \\<in> sets (M \\<Otimes>\\<^sub>M borel)", "by auto"], ["proof (state)\nthis:\n  A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real ?N3}\n  \\<in> sets (M \\<Otimes>\\<^sub>M borel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"\\<exists>N::nat. emeasure ?MS (A \\<inter> {(x,y). abs(y) \\<le> N}) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x.\n       0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n            (A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})", "apply (rule emeasure_pos_unionE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x}\n       \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n 2. 0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n         (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})", "using *"], ["proof (prove)\nusing this:\n  0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n       (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x}\n       \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n 2. 0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n         (\\<Union>x. A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})", "by auto"], ["proof (state)\nthis:\n  \\<exists>x.\n     0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n          (A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  \\<exists>x.\n     0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n          (A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})", "obtain N::nat where N: \"emeasure ?MS (A \\<inter> {(x,y). abs(y) \\<le> N}) > 0\""], ["proof (prove)\nusing this:\n  \\<exists>x.\n     0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n          (A \\<inter> {(xa, y). \\<bar>y\\<bar> \\<le> real x})\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n             (A \\<inter>\n              {(x, y). \\<bar>y\\<bar> \\<le> real N}) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n       (A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N})\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "define B where \"B = A \\<inter> {(x,y). abs(y) \\<le> N}\""], ["proof (state)\nthis:\n  B = A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have B_meas [measurable]: \"B \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  B \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"0 < emeasure (M \\<Otimes>\\<^sub>M lborel) B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < emeasure (M \\<Otimes>\\<^sub>M lborel) B", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n         (A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N})", "using N"], ["proof (prove)\nusing this:\n  0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n       (A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N})\n\ngoal (1 subgoal):\n 1. 0 < emeasure (M \\<Otimes>\\<^sub>M lborel)\n         (A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N})", "by auto"], ["proof (state)\nthis:\n  0 < emeasure (M \\<Otimes>\\<^sub>M lborel) B\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "also"], ["proof (state)\nthis:\n  0 < emeasure (M \\<Otimes>\\<^sub>M lborel) B\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"... = (\\<integral>\\<^sup>+x. emeasure lborel (Pair x -` B) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel) B =\n    \\<integral>\\<^sup>+ x. emeasure lborel (Pair x -` B) \\<partial>M", "apply (rule sigma_finite_measure.emeasure_pair_measure_alt)"], ["proof (prove)\ngoal (2 subgoals):\n 1. sigma_finite_measure lborel\n 2. B \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "using B_meas"], ["proof (prove)\nusing this:\n  B \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (2 subgoals):\n 1. sigma_finite_measure lborel\n 2. B \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by (auto simp add: lborel.sigma_finite_measure_axioms)"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) B =\n  \\<integral>\\<^sup>+ x. emeasure lborel (Pair x -` B) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "finally"], ["proof (chain)\npicking this:\n  0 < \\<integral>\\<^sup>+ x. emeasure lborel (Pair x -` B) \\<partial>M", "have *: \"(\\<integral>\\<^sup>+x. emeasure lborel (Pair x -` B) \\<partial>M) > 0\""], ["proof (prove)\nusing this:\n  0 < \\<integral>\\<^sup>+ x. emeasure lborel (Pair x -` B) \\<partial>M\n\ngoal (1 subgoal):\n 1. 0 < \\<integral>\\<^sup>+ x. emeasure lborel (Pair x -` B) \\<partial>M", "by simp"], ["proof (state)\nthis:\n  0 < \\<integral>\\<^sup>+ x. emeasure lborel (Pair x -` B) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"\\<exists>Cx\\<in>sets M. \\<exists>e::real>0. emeasure M Cx > 0 \\<and> (\\<forall>x \\<in> Cx. emeasure lborel (Pair x -` B) \\<ge> e)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>Cx\\<in>sets M.\n       \\<exists>e>0.\n          0 < emeasure M Cx \\<and>\n          (\\<forall>x\\<in>Cx. ennreal e \\<le> emeasure lborel (Pair x -` B))", "by (rule not_AE_zero_int_ennreal_E, auto simp add: *)"], ["proof (state)\nthis:\n  \\<exists>Cx\\<in>sets M.\n     \\<exists>e>0.\n        0 < emeasure M Cx \\<and>\n        (\\<forall>x\\<in>Cx. ennreal e \\<le> emeasure lborel (Pair x -` B))\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  \\<exists>Cx\\<in>sets M.\n     \\<exists>e>0.\n        0 < emeasure M Cx \\<and>\n        (\\<forall>x\\<in>Cx. ennreal e \\<le> emeasure lborel (Pair x -` B))", "obtain Cx e where [measurable]: \"Cx \\<in> sets M\" and Cxe: \"e>(0::real)\" \"emeasure M Cx > 0\" \"\\<And>x. x \\<in> Cx \\<Longrightarrow> emeasure lborel (Pair x -` B) \\<ge> e\""], ["proof (prove)\nusing this:\n  \\<exists>Cx\\<in>sets M.\n     \\<exists>e>0.\n        0 < emeasure M Cx \\<and>\n        (\\<forall>x\\<in>Cx. ennreal e \\<le> emeasure lborel (Pair x -` B))\n\ngoal (1 subgoal):\n 1. (\\<And>Cx e.\n        \\<lbrakk>Cx \\<in> sets M; 0 < e; 0 < emeasure M Cx;\n         \\<And>x.\n            x \\<in> Cx \\<Longrightarrow>\n            ennreal e \\<le> emeasure lborel (Pair x -` B)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  Cx \\<in> sets M\n  0 < e\n  0 < emeasure M Cx\n  ?x3 \\<in> Cx \\<Longrightarrow>\n  ennreal e \\<le> emeasure lborel (Pair ?x3 -` B)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "define C where \"C = B \\<inter> (Cx \\<times> (UNIV::real set))\""], ["proof (state)\nthis:\n  C = B \\<inter> Cx \\<times> UNIV\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have C_meas [measurable]: \"C \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<inter> Cx \\<times> UNIV \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "using B_meas"], ["proof (prove)\nusing this:\n  B \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. B \\<inter> Cx \\<times> UNIV \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  C \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have Cx_fibers: \"\\<And>x. x \\<in> Cx \\<Longrightarrow> emeasure lborel (Pair x -` C) \\<ge> e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Cx \\<Longrightarrow>\n       ennreal e \\<le> emeasure lborel (Pair x -` C)", "using Cxe(3) C_def"], ["proof (prove)\nusing this:\n  ?x3 \\<in> Cx \\<Longrightarrow>\n  ennreal e \\<le> emeasure lborel (Pair ?x3 -` B)\n  C = B \\<inter> Cx \\<times> UNIV\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Cx \\<Longrightarrow>\n       ennreal e \\<le> emeasure lborel (Pair x -` C)", "by auto"], ["proof (state)\nthis:\n  ?x3 \\<in> Cx \\<Longrightarrow>\n  ennreal e \\<le> emeasure lborel (Pair ?x3 -` C)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "define c where \"c = (measure M Cx)/2\""], ["proof (state)\nthis:\n  c = Sigma_Algebra.measure M Cx / 2\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"c > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < c", "unfolding c_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < Sigma_Algebra.measure M Cx / 2", "using Cxe(2)"], ["proof (prove)\nusing this:\n  0 < emeasure M Cx\n\ngoal (1 subgoal):\n 1. 0 < Sigma_Algebra.measure M Cx / 2", "by (simp add: emeasure_eq_measure)"], ["proof (state)\nthis:\n  0 < c\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "text \\<open>We will apply Birkhoff theorem to show that most preimages of $C$ at time $n$ are contained in a cylinder\n  of height roughly $r n$, for some suitably small $r$. How small $r$ should be to get a\n  contradiction can be determined at the end of the proof. It turns out that the good condition\n  is the following one -- this is by no means obvious now.\\<close>"], ["proof (state)\nthis:\n  0 < c\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "define r where \"r = (if measure M (space M) = 0 then 1 else e * c / (4 * measure M (space M)))\""], ["proof (state)\nthis:\n  r =\n  (if Sigma_Algebra.measure M (space M) = 0 then 1\n   else e * c / (4 * Sigma_Algebra.measure M (space M)))\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"r > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < r", "using \\<open>e > 0\\<close> \\<open>c > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < e\n  0 < c\n\ngoal (1 subgoal):\n 1. 0 < r", "unfolding r_def"], ["proof (prove)\nusing this:\n  0 < e\n  0 < c\n\ngoal (1 subgoal):\n 1. 0 < (if Sigma_Algebra.measure M (space M) = 0 then 1\n         else e * c / (4 * Sigma_Algebra.measure M (space M)))", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < e; 0 < c;\n     Sigma_Algebra.measure M (space M) \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < e * c / (4 * Sigma_Algebra.measure M (space M))", "using measure_le_0_iff"], ["proof (prove)\nusing this:\n  (Sigma_Algebra.measure ?M ?X \\<le> 0) = (Sigma_Algebra.measure ?M ?X = 0)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < e; 0 < c;\n     Sigma_Algebra.measure M (space M) \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 < e * c / (4 * Sigma_Algebra.measure M (space M))", "by fastforce"], ["proof (state)\nthis:\n  0 < r\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have pos: \"e*c-2*r*measure M (space M) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < e * c - 2 * r * Sigma_Algebra.measure M (space M)", "using \\<open>e > 0\\<close> \\<open>c > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < e\n  0 < c\n\ngoal (1 subgoal):\n 1. 0 < e * c - 2 * r * Sigma_Algebra.measure M (space M)", "unfolding r_def"], ["proof (prove)\nusing this:\n  0 < e\n  0 < c\n\ngoal (1 subgoal):\n 1. 0 < e * c -\n        2 *\n        (if Sigma_Algebra.measure M (space M) = 0 then 1\n         else e * c / (4 * Sigma_Algebra.measure M (space M))) *\n        Sigma_Algebra.measure M (space M)", "by auto"], ["proof (state)\nthis:\n  0 < e * c - 2 * r * Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "define Bgood where \"Bgood = {x \\<in> space M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> 0}\""], ["proof (state)\nthis:\n  Bgood =\n  {x \\<in> space M.\n   (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have [measurable]: \"Bgood \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Bgood \\<in> sets M", "unfolding Bgood_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0}\n    \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  Bgood \\<in> sets M\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have *: \"AE x in M. x \\<in> Bgood\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> Bgood", "unfolding Bgood_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> {x \\<in> space M.\n                        (\\<lambda>n. birkhoff_sum f n x / real n)\n                        \\<longlonglongrightarrow> 0}", "using birkhoff_theorem_AE_nonergodic[OF assms(1)] assms(2)"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  AE x in M. real_cond_exp M Invariants f x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> {x \\<in> space M.\n                        (\\<lambda>n. birkhoff_sum f n x / real n)\n                        \\<longlonglongrightarrow> 0}", "by auto"], ["proof (state)\nthis:\n  AE x in M. x \\<in> Bgood\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  AE x in M. x \\<in> Bgood", "have \"emeasure M Bgood = emeasure M (space M)\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<in> Bgood\n\ngoal (1 subgoal):\n 1. emeasure M Bgood = emeasure M (space M)", "by (intro emeasure_eq_AE) auto"], ["proof (state)\nthis:\n  emeasure M Bgood = emeasure M (space M)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "{"], ["proof (state)\nthis:\n  emeasure M Bgood = emeasure M (space M)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "assume \"x \\<in> Bgood\""], ["proof (state)\nthis:\n  x \\<in> Bgood\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  x \\<in> Bgood", "have \"x \\<in> space M\""], ["proof (prove)\nusing this:\n  x \\<in> Bgood\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "unfolding Bgood_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           (\\<lambda>n. birkhoff_sum f n x / real n)\n           \\<longlonglongrightarrow> 0}\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "by auto"], ["proof (state)\nthis:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"(\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0", "using \\<open>x \\<in> Bgood\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> Bgood\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0", "unfolding Bgood_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           (\\<lambda>n. birkhoff_sum f n x / real n)\n           \\<longlonglongrightarrow> 0}\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"0 \\<in> {-r<..<r}\" \"open {-r<..<r}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<in> {- r<..<r} &&& open {- r<..<r}", "using \\<open>r>0\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n\ngoal (1 subgoal):\n 1. 0 \\<in> {- r<..<r} &&& open {- r<..<r}", "by auto"], ["proof (state)\nthis:\n  0 \\<in> {- r<..<r}\n  open {- r<..<r}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0\n  0 \\<in> {- r<..<r}\n  open {- r<..<r}", "have \"eventually (\\<lambda>n. birkhoff_sum f n x / n \\<in> {-r<..<r}) sequentially\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0\n  0 \\<in> {- r<..<r}\n  open {- r<..<r}\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       birkhoff_sum f n x / real n \\<in> {- r<..<r}", "using topological_tendstoD"], ["proof (prove)\nusing this:\n  (\\<lambda>n. birkhoff_sum f n x / real n) \\<longlonglongrightarrow> 0\n  0 \\<in> {- r<..<r}\n  open {- r<..<r}\n  \\<lbrakk>(?f \\<longlongrightarrow> ?l) ?F; open ?S; ?l \\<in> ?S\\<rbrakk>\n  \\<Longrightarrow> \\<forall>\\<^sub>F x in ?F. ?f x \\<in> ?S\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       birkhoff_sum f n x / real n \\<in> {- r<..<r}", "by blast"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     birkhoff_sum f n x / real n \\<in> {- r<..<r}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     birkhoff_sum f n x / real n \\<in> {- r<..<r}", "obtain n0 where n0: \"n0>0\" \"\\<And>n. n \\<ge> n0 \\<Longrightarrow> birkhoff_sum f n x / n \\<in> {-r<..<r}\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     birkhoff_sum f n x / real n \\<in> {- r<..<r}\n\ngoal (1 subgoal):\n 1. (\\<And>n0.\n        \\<lbrakk>0 < n0;\n         \\<And>n.\n            n0 \\<le> n \\<Longrightarrow>\n            birkhoff_sum f n x / real n \\<in> {- r<..<r}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using eventually_sequentially"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     birkhoff_sum f n x / real n \\<in> {- r<..<r}\n  eventually ?P sequentially = (\\<exists>N. \\<forall>n\\<ge>N. ?P n)\n\ngoal (1 subgoal):\n 1. (\\<And>n0.\n        \\<lbrakk>0 < n0;\n         \\<And>n.\n            n0 \\<le> n \\<Longrightarrow>\n            birkhoff_sum f n x / real n \\<in> {- r<..<r}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis (mono_tags, lifting) le0 le_simps(3) neq0_conv)"], ["proof (state)\nthis:\n  0 < n0\n  n0 \\<le> ?n3 \\<Longrightarrow>\n  birkhoff_sum f ?n3 x / real ?n3 \\<in> {- r<..<r}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "{"], ["proof (state)\nthis:\n  0 < n0\n  n0 \\<le> ?n3 \\<Longrightarrow>\n  birkhoff_sum f ?n3 x / real ?n3 \\<in> {- r<..<r}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "assume \"n \\<ge> n0\""], ["proof (state)\nthis:\n  n0 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  n0 \\<le> n", "have \"n>0\""], ["proof (prove)\nusing this:\n  n0 \\<le> n\n\ngoal (1 subgoal):\n 1. 0 < n", "using \\<open>n0>0\\<close>"], ["proof (prove)\nusing this:\n  n0 \\<le> n\n  0 < n0\n\ngoal (1 subgoal):\n 1. 0 < n", "by auto"], ["proof (state)\nthis:\n  0 < n\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "with n0(2)[OF \\<open>n \\<ge> n0\\<close>]"], ["proof (chain)\npicking this:\n  birkhoff_sum f n x / real n \\<in> {- r<..<r}\n  0 < n", "have \"abs(birkhoff_sum f n x / n) \\<le> r\""], ["proof (prove)\nusing this:\n  birkhoff_sum f n x / real n \\<in> {- r<..<r}\n  0 < n\n\ngoal (1 subgoal):\n 1. \\<bar>birkhoff_sum f n x / real n\\<bar> \\<le> r", "by auto"], ["proof (state)\nthis:\n  \\<bar>birkhoff_sum f n x / real n\\<bar> \\<le> r\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  \\<bar>birkhoff_sum f n x / real n\\<bar> \\<le> r", "have \"abs(birkhoff_sum f n x) \\<le> r * n\""], ["proof (prove)\nusing this:\n  \\<bar>birkhoff_sum f n x / real n\\<bar> \\<le> r\n\ngoal (1 subgoal):\n 1. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n", "using \\<open>n>0\\<close>"], ["proof (prove)\nusing this:\n  \\<bar>birkhoff_sum f n x / real n\\<bar> \\<le> r\n  0 < n\n\ngoal (1 subgoal):\n 1. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n", "by (simp add: divide_le_eq)"], ["proof (state)\nthis:\n  \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "}"], ["proof (state)\nthis:\n  n0 \\<le> ?n5 \\<Longrightarrow>\n  \\<bar>birkhoff_sum f ?n5 x\\<bar> \\<le> r * real ?n5\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  n0 \\<le> ?n5 \\<Longrightarrow>\n  \\<bar>birkhoff_sum f ?n5 x\\<bar> \\<le> r * real ?n5", "have \"x \\<in> (\\<Union>n0. {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n})\""], ["proof (prove)\nusing this:\n  n0 \\<le> ?n5 \\<Longrightarrow>\n  \\<bar>birkhoff_sum f ?n5 x\\<bar> \\<le> r * real ?n5\n\ngoal (1 subgoal):\n 1. x \\<in> (\\<Union>n0.\n                {x \\<in> space M.\n                 \\<forall>n\\<in>{n0..}.\n                    \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n})", "using \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  n0 \\<le> ?n5 \\<Longrightarrow>\n  \\<bar>birkhoff_sum f ?n5 x\\<bar> \\<le> r * real ?n5\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. x \\<in> (\\<Union>n0.\n                {x \\<in> space M.\n                 \\<forall>n\\<in>{n0..}.\n                    \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n})", "by blast"], ["proof (state)\nthis:\n  x \\<in> (\\<Union>n0.\n              {x \\<in> space M.\n               \\<forall>n\\<in>{n0..}.\n                  \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n})\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "}"], ["proof (state)\nthis:\n  ?x5 \\<in> Bgood \\<Longrightarrow>\n  ?x5\n  \\<in> (\\<Union>n0.\n            {x \\<in> space M.\n             \\<forall>n\\<in>{n0..}.\n                \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n})\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  ?x5 \\<in> Bgood \\<Longrightarrow>\n  ?x5\n  \\<in> (\\<Union>n0.\n            {x \\<in> space M.\n             \\<forall>n\\<in>{n0..}.\n                \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n})", "have \"AE x in M. x \\<notin> space M - (\\<Union>n0. {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n})\""], ["proof (prove)\nusing this:\n  ?x5 \\<in> Bgood \\<Longrightarrow>\n  ?x5\n  \\<in> (\\<Union>n0.\n            {x \\<in> space M.\n             \\<forall>n\\<in>{n0..}.\n                \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n})\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> space M -\n                          (\\<Union>n0.\n                              {x \\<in> space M.\n                               \\<forall>n\\<in>{n0..}.\n                                  \\<bar>birkhoff_sum f n x\\<bar>\n                                  \\<le> r * real n})", "using *"], ["proof (prove)\nusing this:\n  ?x5 \\<in> Bgood \\<Longrightarrow>\n  ?x5\n  \\<in> (\\<Union>n0.\n            {x \\<in> space M.\n             \\<forall>n\\<in>{n0..}.\n                \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n})\n  AE x in M. x \\<in> Bgood\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<notin> space M -\n                          (\\<Union>n0.\n                              {x \\<in> space M.\n                               \\<forall>n\\<in>{n0..}.\n                                  \\<bar>birkhoff_sum f n x\\<bar>\n                                  \\<le> r * real n})", "by auto"], ["proof (state)\nthis:\n  AE x in M. x \\<notin> space M -\n                        (\\<Union>n0.\n                            {x \\<in> space M.\n                             \\<forall>n\\<in>{n0..}.\n                                \\<bar>birkhoff_sum f n x\\<bar>\n                                \\<le> r * real n})\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  AE x in M. x \\<notin> space M -\n                        (\\<Union>n0.\n                            {x \\<in> space M.\n                             \\<forall>n\\<in>{n0..}.\n                                \\<bar>birkhoff_sum f n x\\<bar>\n                                \\<le> r * real n})", "have eqM: \"emeasure M (\\<Union>n0. {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n}) = emeasure M (space M)\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<notin> space M -\n                        (\\<Union>n0.\n                            {x \\<in> space M.\n                             \\<forall>n\\<in>{n0..}.\n                                \\<bar>birkhoff_sum f n x\\<bar>\n                                \\<le> r * real n})\n\ngoal (1 subgoal):\n 1. emeasure M\n     (\\<Union>n0.\n         {x \\<in> space M.\n          \\<forall>n\\<in>{n0..}.\n             \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) =\n    emeasure M (space M)", "by (intro emeasure_eq_AE) auto"], ["proof (state)\nthis:\n  emeasure M\n   (\\<Union>n0.\n       {x \\<in> space M.\n        \\<forall>n\\<in>{n0..}.\n           \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) =\n  emeasure M (space M)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"(\\<lambda>n0. emeasure M {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n} + c)\n          \\<longlonglongrightarrow> emeasure M (\\<Union>n0. {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n}) + c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n0.\n        emeasure M\n         {x \\<in> space M.\n          \\<forall>n\\<in>{n0..}.\n             \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n        ennreal c)\n    \\<longlonglongrightarrow> emeasure M\n                               (\\<Union>n0.\n                                   {x \\<in> space M.\n                                    \\<forall>n\\<in>{n0..}.\n \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n                              ennreal c", "by (intro tendsto_intros Lim_emeasure_incseq) (auto simp add: incseq_def)"], ["proof (state)\nthis:\n  (\\<lambda>n0.\n      emeasure M\n       {x \\<in> space M.\n        \\<forall>n\\<in>{n0..}.\n           \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n      ennreal c)\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>n0.\n                                 {x \\<in> space M.\n                                  \\<forall>n\\<in>{n0..}.\n                                     \\<bar>birkhoff_sum f n x\\<bar>\n                                     \\<le> r * real n}) +\n                            ennreal c\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>n0.\n      emeasure M\n       {x \\<in> space M.\n        \\<forall>n\\<in>{n0..}.\n           \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n      ennreal c)\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>n0.\n                                 {x \\<in> space M.\n                                  \\<forall>n\\<in>{n0..}.\n                                     \\<bar>birkhoff_sum f n x\\<bar>\n                                     \\<le> r * real n}) +\n                            ennreal c\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"emeasure M (\\<Union>n0. {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n}) + c > emeasure M (space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M (space M)\n    < emeasure M\n       (\\<Union>n0.\n           {x \\<in> space M.\n            \\<forall>n\\<in>{n0..}.\n               \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n      ennreal c", "using eqM \\<open>c > 0\\<close> emeasure_eq_measure"], ["proof (prove)\nusing this:\n  emeasure M\n   (\\<Union>n0.\n       {x \\<in> space M.\n        \\<forall>n\\<in>{n0..}.\n           \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) =\n  emeasure M (space M)\n  0 < c\n  emeasure M ?A = ennreal (Sigma_Algebra.measure M ?A)\n\ngoal (1 subgoal):\n 1. emeasure M (space M)\n    < emeasure M\n       (\\<Union>n0.\n           {x \\<in> space M.\n            \\<forall>n\\<in>{n0..}.\n               \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n      ennreal c", "by auto"], ["proof (state)\nthis:\n  emeasure M (space M)\n  < emeasure M\n     (\\<Union>n0.\n         {x \\<in> space M.\n          \\<forall>n\\<in>{n0..}.\n             \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n    ennreal c\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>n0.\n      emeasure M\n       {x \\<in> space M.\n        \\<forall>n\\<in>{n0..}.\n           \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n      ennreal c)\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>n0.\n                                 {x \\<in> space M.\n                                  \\<forall>n\\<in>{n0..}.\n                                     \\<bar>birkhoff_sum f n x\\<bar>\n                                     \\<le> r * real n}) +\n                            ennreal c\n  emeasure M (space M)\n  < emeasure M\n     (\\<Union>n0.\n         {x \\<in> space M.\n          \\<forall>n\\<in>{n0..}.\n             \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n    ennreal c", "have \"eventually (\\<lambda>n0. emeasure M {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n} + c > emeasure M (space M)) sequentially\""], ["proof (prove)\nusing this:\n  (\\<lambda>n0.\n      emeasure M\n       {x \\<in> space M.\n        \\<forall>n\\<in>{n0..}.\n           \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n      ennreal c)\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>n0.\n                                 {x \\<in> space M.\n                                  \\<forall>n\\<in>{n0..}.\n                                     \\<bar>birkhoff_sum f n x\\<bar>\n                                     \\<le> r * real n}) +\n                            ennreal c\n  emeasure M (space M)\n  < emeasure M\n     (\\<Union>n0.\n         {x \\<in> space M.\n          \\<forall>n\\<in>{n0..}.\n             \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n    ennreal c\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n0 in sequentially.\n       emeasure M (space M)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>n\\<in>{n0..}.\n              \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n         ennreal c", "unfolding order_tendsto_iff"], ["proof (prove)\nusing this:\n  (\\<forall>l<emeasure M\n               (\\<Union>n0.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{n0..}.\n                       \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n              ennreal c.\n      \\<forall>\\<^sub>F x in sequentially.\n         l < emeasure M\n              {xa \\<in> space M.\n               \\<forall>n\\<in>{x..}.\n                  \\<bar>birkhoff_sum f n xa\\<bar> \\<le> r * real n} +\n             ennreal c) \\<and>\n  (\\<forall>u>emeasure M\n               (\\<Union>n0.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{n0..}.\n                       \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n              ennreal c.\n      \\<forall>\\<^sub>F x in sequentially.\n         emeasure M\n          {xa \\<in> space M.\n           \\<forall>n\\<in>{x..}.\n              \\<bar>birkhoff_sum f n xa\\<bar> \\<le> r * real n} +\n         ennreal c\n         < u)\n  emeasure M (space M)\n  < emeasure M\n     (\\<Union>n0.\n         {x \\<in> space M.\n          \\<forall>n\\<in>{n0..}.\n             \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}) +\n    ennreal c\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n0 in sequentially.\n       emeasure M (space M)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>n\\<in>{n0..}.\n              \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n         ennreal c", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n0 in sequentially.\n     emeasure M (space M)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>n\\<in>{n0..}.\n            \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n       ennreal c\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n0 in sequentially.\n     emeasure M (space M)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>n\\<in>{n0..}.\n            \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n       ennreal c", "obtain n0 where n0: \"emeasure M {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n} + c > emeasure M (space M)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n0 in sequentially.\n     emeasure M (space M)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>n\\<in>{n0..}.\n            \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n       ennreal c\n\ngoal (1 subgoal):\n 1. (\\<And>n0.\n        emeasure M (space M)\n        < emeasure M\n           {x \\<in> space M.\n            \\<forall>n\\<in>{n0..}.\n               \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n          ennreal c \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using eventually_sequentially"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n0 in sequentially.\n     emeasure M (space M)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>n\\<in>{n0..}.\n            \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n       ennreal c\n  eventually ?P sequentially = (\\<exists>N. \\<forall>n\\<ge>N. ?P n)\n\ngoal (1 subgoal):\n 1. (\\<And>n0.\n        emeasure M (space M)\n        < emeasure M\n           {x \\<in> space M.\n            \\<forall>n\\<in>{n0..}.\n               \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n          ennreal c \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  emeasure M (space M)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>n\\<in>{n0..}.\n         \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n    ennreal c\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "define Dx where \"Dx = {x \\<in> space M. \\<forall>n\\<in>{n0..}. abs(birkhoff_sum f n x) \\<le> r * n}\""], ["proof (state)\nthis:\n  Dx =\n  {x \\<in> space M.\n   \\<forall>n\\<in>{n0..}. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have Dx_meas [measurable]: \"Dx \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Dx \\<in> sets M", "unfolding Dx_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>n\\<in>{n0..}. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}\n    \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  Dx \\<in> sets M\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"emeasure M Dx + c \\<ge> emeasure M (space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M (space M) \\<le> emeasure M Dx + ennreal c", "using n0 Dx_def"], ["proof (prove)\nusing this:\n  emeasure M (space M)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>n\\<in>{n0..}.\n         \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n} +\n    ennreal c\n  Dx =\n  {x \\<in> space M.\n   \\<forall>n\\<in>{n0..}. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}\n\ngoal (1 subgoal):\n 1. emeasure M (space M) \\<le> emeasure M Dx + ennreal c", "by auto"], ["proof (state)\nthis:\n  emeasure M (space M) \\<le> emeasure M Dx + ennreal c\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "obtain n1::nat where n1: \"n1 > max n0 ((measure M (space M) * 2 * N + e*c*n0 - e*c) / (e*c-2*r*measure M (space M)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n1.\n        max (real n0)\n         ((Sigma_Algebra.measure M (space M) * 2 * real N +\n           e * c * real n0 -\n           e * c) /\n          (e * c - 2 * r * Sigma_Algebra.measure M (space M)))\n        < real n1 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (metis mult.commute mult.left_neutral numeral_One reals_Archimedean3 zero_less_numeral)"], ["proof (state)\nthis:\n  max (real n0)\n   ((Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n     e * c) /\n    (e * c - 2 * r * Sigma_Algebra.measure M (space M)))\n  < real n1\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  max (real n0)\n   ((Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n     e * c) /\n    (e * c - 2 * r * Sigma_Algebra.measure M (space M)))\n  < real n1", "have \"n1 > n0\""], ["proof (prove)\nusing this:\n  max (real n0)\n   ((Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n     e * c) /\n    (e * c - 2 * r * Sigma_Algebra.measure M (space M)))\n  < real n1\n\ngoal (1 subgoal):\n 1. n0 < n1", "by auto"], ["proof (state)\nthis:\n  n0 < n1\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have n1_ineq: \"n1 * (e*c-2*r*measure M (space M)) > (measure M (space M) * 2 * N + e*c*n0 - e*c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 - e * c\n    < real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))", "using n1 pos"], ["proof (prove)\nusing this:\n  max (real n0)\n   ((Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n     e * c) /\n    (e * c - 2 * r * Sigma_Algebra.measure M (space M)))\n  < real n1\n  0 < e * c - 2 * r * Sigma_Algebra.measure M (space M)\n\ngoal (1 subgoal):\n 1. Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 - e * c\n    < real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))", "by (simp add: pos_divide_less_eq)"], ["proof (state)\nthis:\n  Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 - e * c\n  < real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "define D where \"D = (\\<lambda>n. Dx \\<times> {-r*n1-N..r*n1+N} \\<inter> (?TS^^n)-`C)\""], ["proof (state)\nthis:\n  D =\n  (\\<lambda>n.\n      Dx \\<times> {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n      ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` C)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have Dn_meas [measurable]: \"D n \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. D n \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "unfolding D_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Dx \\<times> {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n    ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` C\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "apply (rule TS.T_intersec_meas(2))"], ["proof (prove)\ngoal (2 subgoals):\n 1. Dx \\<times> {- r * real n1 - real N..r * real n1 + real N}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n 2. C \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "using C_meas"], ["proof (prove)\nusing this:\n  C \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (2 subgoals):\n 1. Dx \\<times> {- r * real n1 - real N..r * real n1 + real N}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n 2. C \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  D ?n3 \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"emeasure ?MS (D n) \\<ge> e * c\" if \"n \\<in> {n0..n1}\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"n \\<ge> n0\" \"n \\<le> n1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n0 \\<le> n &&& n \\<le> n1", "using that"], ["proof (prove)\nusing this:\n  n \\<in> {n0..n1}\n\ngoal (1 subgoal):\n 1. n0 \\<le> n &&& n \\<le> n1", "by auto"], ["proof (state)\nthis:\n  n0 \\<le> n\n  n \\<le> n1\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "{"], ["proof (state)\nthis:\n  n0 \\<le> n\n  n \\<le> n1\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "assume [simp]: \"x \\<in> space M\""], ["proof (state)\nthis:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "define F where \"F = {y \\<in> {-r*n1-N..r*n1+N}. y + birkhoff_sum f n x \\<in> Pair ((T^^n)x) -`C}\""], ["proof (state)\nthis:\n  F =\n  {y \\<in> {- r * real n1 - real N..r * real n1 + real N}.\n   y + birkhoff_sum f n x \\<in> Pair ((T ^^ n) x) -` C}\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have [measurable]: \"F \\<in> sets lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<in> sets lborel", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {y \\<in> {- r * real n1 - real N..r * real n1 + real N}.\n     y + birkhoff_sum f n x \\<in> Pair ((T ^^ n) x) -` C}\n    \\<in> sets lborel", "by measurable"], ["proof (state)\nthis:\n  F \\<in> sets lborel\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "{"], ["proof (state)\nthis:\n  F \\<in> sets lborel\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "fix y::real"], ["proof (state)\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"(?TS^^n)(x,y) = ((T^^n)x, y + birkhoff_sum f n x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y) =\n    ((T ^^ n) x, y + birkhoff_sum f n x)", "using skew_product_real_iterates"], ["proof (prove)\nusing this:\n  ((\\<lambda>(x, y). (T x, y + ?f x)) ^^ ?n) (?x, ?y) =\n  ((T ^^ ?n) ?x, ?y + birkhoff_sum ?f ?n ?x)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y) =\n    ((T ^^ n) x, y + birkhoff_sum f n x)", "by simp"], ["proof (state)\nthis:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y) =\n  ((T ^^ n) x, y + birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "then"], ["proof (chain)\npicking this:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y) =\n  ((T ^^ n) x, y + birkhoff_sum f n x)", "have \"(indicator C ((?TS^^n) (x,y))::ennreal) = indicator Cx ((T^^n)x) * indicator (Pair ((T^^n)x) -`C) (y + birkhoff_sum f n x)\""], ["proof (prove)\nusing this:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y) =\n  ((T ^^ n) x, y + birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y)) =\n    indicator Cx ((T ^^ n) x) *\n    indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)", "using C_def"], ["proof (prove)\nusing this:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y) =\n  ((T ^^ n) x, y + birkhoff_sum f n x)\n  C = B \\<inter> Cx \\<times> UNIV\n\ngoal (1 subgoal):\n 1. indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y)) =\n    indicator Cx ((T ^^ n) x) *\n    indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)", "by (simp add: indicator_def)"], ["proof (state)\nthis:\n  indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y)) =\n  indicator Cx ((T ^^ n) x) *\n  indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "moreover"], ["proof (state)\nthis:\n  indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y)) =\n  indicator Cx ((T ^^ n) x) *\n  indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"(indicator (D n) (x, y)::ennreal) = indicator Dx x * indicator {-r*n1-N..r*n1+N} y * indicator C ((?TS^^n) (x,y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. indicator (D n) (x, y) =\n    indicator Dx x *\n    indicator {- r * real n1 - real N..r * real n1 + real N} y *\n    indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y))", "unfolding D_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. indicator\n     (Dx \\<times> {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n      ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` C)\n     (x, y) =\n    indicator Dx x *\n    indicator {- r * real n1 - real N..r * real n1 + real N} y *\n    indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y))", "by (simp add: indicator_def)"], ["proof (state)\nthis:\n  indicator (D n) (x, y) =\n  indicator Dx x *\n  indicator {- r * real n1 - real N..r * real n1 + real N} y *\n  indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y))\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "ultimately"], ["proof (chain)\npicking this:\n  indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y)) =\n  indicator Cx ((T ^^ n) x) *\n  indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)\n  indicator (D n) (x, y) =\n  indicator Dx x *\n  indicator {- r * real n1 - real N..r * real n1 + real N} y *\n  indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y))", "have \"(indicator (D n) (x, y)::ennreal) = indicator Dx x * indicator {-r*n1-N..r*n1+N} y\n            * indicator Cx ((T^^n)x) * indicator (Pair ((T^^n)x) -`C) (y + birkhoff_sum f n x)\""], ["proof (prove)\nusing this:\n  indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y)) =\n  indicator Cx ((T ^^ n) x) *\n  indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)\n  indicator (D n) (x, y) =\n  indicator Dx x *\n  indicator {- r * real n1 - real N..r * real n1 + real N} y *\n  indicator C (((\\<lambda>(x, y). (T x, y + f x)) ^^ n) (x, y))\n\ngoal (1 subgoal):\n 1. indicator (D n) (x, y) =\n    indicator Dx x *\n    indicator {- r * real n1 - real N..r * real n1 + real N} y *\n    indicator Cx ((T ^^ n) x) *\n    indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)", "by (simp add: mult.assoc)"], ["proof (state)\nthis:\n  indicator (D n) (x, y) =\n  indicator Dx x *\n  indicator {- r * real n1 - real N..r * real n1 + real N} y *\n  indicator Cx ((T ^^ n) x) *\n  indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "then"], ["proof (chain)\npicking this:\n  indicator (D n) (x, y) =\n  indicator Dx x *\n  indicator {- r * real n1 - real N..r * real n1 + real N} y *\n  indicator Cx ((T ^^ n) x) *\n  indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)", "have \"(indicator (D n) (x, y)::ennreal) = indicator (Dx \\<inter> (T^^n)-`Cx) x * indicator F y\""], ["proof (prove)\nusing this:\n  indicator (D n) (x, y) =\n  indicator Dx x *\n  indicator {- r * real n1 - real N..r * real n1 + real N} y *\n  indicator Cx ((T ^^ n) x) *\n  indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. indicator (D n) (x, y) =\n    indicator (Dx \\<inter> (T ^^ n) -` Cx) x * indicator F y", "unfolding F_def"], ["proof (prove)\nusing this:\n  indicator (D n) (x, y) =\n  indicator Dx x *\n  indicator {- r * real n1 - real N..r * real n1 + real N} y *\n  indicator Cx ((T ^^ n) x) *\n  indicator (Pair ((T ^^ n) x) -` C) (y + birkhoff_sum f n x)\n\ngoal (1 subgoal):\n 1. indicator (D n) (x, y) =\n    indicator (Dx \\<inter> (T ^^ n) -` Cx) x *\n    indicator\n     {y \\<in> {- r * real n1 - real N..r * real n1 + real N}.\n      y + birkhoff_sum f n x \\<in> Pair ((T ^^ n) x) -` C}\n     y", "by (simp add: indicator_def)"], ["proof (state)\nthis:\n  indicator (D n) (x, y) =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * indicator F y\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "}"], ["proof (state)\nthis:\n  indicator (D n) (x, ?y5) =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * indicator F ?y5\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "then"], ["proof (chain)\npicking this:\n  indicator (D n) (x, ?y5) =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * indicator F ?y5", "have \"(\\<integral>\\<^sup>+y. indicator (D n) (x, y) \\<partial>lborel) = (\\<integral>\\<^sup>+y. indicator (Dx \\<inter> (T^^n)-`Cx) x * indicator F y \\<partial>lborel)\""], ["proof (prove)\nusing this:\n  indicator (D n) (x, ?y5) =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * indicator F ?y5\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel =\n    \\<integral>\\<^sup>+y\\<in>F. indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<partial>lborel", "by auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel =\n  \\<integral>\\<^sup>+y\\<in>F. indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n  \\<partial>lborel\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel =\n  \\<integral>\\<^sup>+y\\<in>F. indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n  \\<partial>lborel\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"... = indicator (Dx \\<inter> (T^^n)-`Cx) x * (\\<integral>\\<^sup>+y. indicator F y \\<partial>lborel)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+y\\<in>F. indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<partial>lborel =\n    indicator (Dx \\<inter> (T ^^ n) -` Cx) x *\n    integral\\<^sup>N lborel (indicator F)", "by (rule nn_integral_cmult, auto)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+y\\<in>F. indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n  \\<partial>lborel =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x *\n  integral\\<^sup>N lborel (indicator F)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+y\\<in>F. indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n  \\<partial>lborel =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x *\n  integral\\<^sup>N lborel (indicator F)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"... = indicator (Dx \\<inter> (T^^n)-`Cx) x * emeasure lborel F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x *\n    integral\\<^sup>N lborel (indicator F) =\n    indicator (Dx \\<inter> (T ^^ n) -` Cx) x * emeasure lborel F", "using \\<open>F \\<in> sets lborel\\<close>"], ["proof (prove)\nusing this:\n  F \\<in> sets lborel\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x *\n    integral\\<^sup>N lborel (indicator F) =\n    indicator (Dx \\<inter> (T ^^ n) -` Cx) x * emeasure lborel F", "by auto"], ["proof (state)\nthis:\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x *\n  integral\\<^sup>N lborel (indicator F) =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * emeasure lborel F\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "finally"], ["proof (chain)\npicking this:\n  \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * emeasure lborel F", "have A: \"(\\<integral>\\<^sup>+y. indicator (D n) (x, y) \\<partial>lborel) = indicator (Dx \\<inter> (T^^n)-`Cx) x * emeasure lborel F\""], ["proof (prove)\nusing this:\n  \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * emeasure lborel F\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel =\n    indicator (Dx \\<inter> (T ^^ n) -` Cx) x * emeasure lborel F", "by simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * emeasure lborel F\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"(\\<integral>\\<^sup>+y. indicator (D n) (x, y) \\<partial>lborel) \\<ge> ennreal e * indicator (Dx \\<inter> (T^^n)-`Cx) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel\n 2. \\<not> ?P \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "assume \"indicator (Dx \\<inter> (T^^n)-`Cx) x = (0::ennreal)\""], ["proof (state)\nthis:\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x = 0\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel\n 2. \\<not> ?P \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "then"], ["proof (chain)\npicking this:\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x = 0\n\ngoal (1 subgoal):\n 1. ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "by auto"], ["proof (state)\nthis:\n  ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n  \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "assume \"\\<not>(indicator (Dx \\<inter> (T^^n)-`Cx) x = (0::ennreal))\""], ["proof (state)\nthis:\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "then"], ["proof (chain)\npicking this:\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0", "have \"x \\<in> Dx \\<inter> (T^^n)-`Cx\""], ["proof (prove)\nusing this:\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0\n\ngoal (1 subgoal):\n 1. x \\<in> Dx \\<inter> (T ^^ n) -` Cx", "by (simp add: indicator_eq_0_iff)"], ["proof (state)\nthis:\n  x \\<in> Dx \\<inter> (T ^^ n) -` Cx\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "then"], ["proof (chain)\npicking this:\n  x \\<in> Dx \\<inter> (T ^^ n) -` Cx", "have \"x \\<in> Dx\" \"(T^^n) x \\<in> Cx\""], ["proof (prove)\nusing this:\n  x \\<in> Dx \\<inter> (T ^^ n) -` Cx\n\ngoal (1 subgoal):\n 1. x \\<in> Dx &&& (T ^^ n) x \\<in> Cx", "by auto"], ["proof (state)\nthis:\n  x \\<in> Dx\n  (T ^^ n) x \\<in> Cx\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "then"], ["proof (chain)\npicking this:\n  x \\<in> Dx\n  (T ^^ n) x \\<in> Cx", "have \"abs(birkhoff_sum f n x) \\<le> r * n\""], ["proof (prove)\nusing this:\n  x \\<in> Dx\n  (T ^^ n) x \\<in> Cx\n\ngoal (1 subgoal):\n 1. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n", "using \\<open>n \\<in> {n0..n1}\\<close> Dx_def"], ["proof (prove)\nusing this:\n  x \\<in> Dx\n  (T ^^ n) x \\<in> Cx\n  n \\<in> {n0..n1}\n  Dx =\n  {x \\<in> space M.\n   \\<forall>n\\<in>{n0..}. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n}\n\ngoal (1 subgoal):\n 1. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n", "by auto"], ["proof (state)\nthis:\n  \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "then"], ["proof (chain)\npicking this:\n  \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n", "have *: \"abs(birkhoff_sum f n x) \\<le> r * n1\""], ["proof (prove)\nusing this:\n  \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n\n\ngoal (1 subgoal):\n 1. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n1", "using \\<open>n \\<le> n1\\<close> \\<open>r>0\\<close>"], ["proof (prove)\nusing this:\n  \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n\n  n \\<le> n1\n  0 < r\n\ngoal (1 subgoal):\n 1. \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n1", "by (meson of_nat_le_iff order_trans mult_le_cancel_iff2)"], ["proof (state)\nthis:\n  \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n1\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "have F_expr: \"F = {-r*n1-N..r*n1+N} \\<inter> (+)(birkhoff_sum f n x) -` (Pair ((T^^n)x) -`C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F =\n    {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n    (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {y \\<in> {- r * real n1 - real N..r * real n1 + real N}.\n     y + birkhoff_sum f n x \\<in> Pair ((T ^^ n) x) -` C} =\n    {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n    (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C", "by (auto simp add: add.commute)"], ["proof (state)\nthis:\n  F =\n  {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n  (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "have \"(Pair ((T^^n)x) -`C) \\<subseteq> {real_of_int (- int N)..real N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Pair ((T ^^ n) x) -` C \\<subseteq> {real_of_int (- int N)..real N}", "unfolding C_def B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Pair ((T ^^ n) x) -`\n    (A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} \\<inter>\n     Cx \\<times> UNIV)\n    \\<subseteq> {real_of_int (- int N)..real N}", "by auto"], ["proof (state)\nthis:\n  Pair ((T ^^ n) x) -` C \\<subseteq> {real_of_int (- int N)..real N}\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "then"], ["proof (chain)\npicking this:\n  Pair ((T ^^ n) x) -` C \\<subseteq> {real_of_int (- int N)..real N}", "have \"((+)(birkhoff_sum f n x)) -` (Pair ((T^^n)x) -`C) \\<subseteq> {-N-birkhoff_sum f n x..N-birkhoff_sum f n x}\""], ["proof (prove)\nusing this:\n  Pair ((T ^^ n) x) -` C \\<subseteq> {real_of_int (- int N)..real N}\n\ngoal (1 subgoal):\n 1. (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n    \\<subseteq> {real_of_int (- int N) -\n                 birkhoff_sum f n x..real N - birkhoff_sum f n x}", "by auto"], ["proof (state)\nthis:\n  (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n  \\<subseteq> {real_of_int (- int N) -\n               birkhoff_sum f n x..real N - birkhoff_sum f n x}\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "also"], ["proof (state)\nthis:\n  (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n  \\<subseteq> {real_of_int (- int N) -\n               birkhoff_sum f n x..real N - birkhoff_sum f n x}\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "have \"... \\<subseteq> {-r * n1 - N .. r * n1 + N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {real_of_int (- int N) -\n     birkhoff_sum f n x..real N - birkhoff_sum f n x}\n    \\<subseteq> {- r * real n1 - real N..r * real n1 + real N}", "using *"], ["proof (prove)\nusing this:\n  \\<bar>birkhoff_sum f n x\\<bar> \\<le> r * real n1\n\ngoal (1 subgoal):\n 1. {real_of_int (- int N) -\n     birkhoff_sum f n x..real N - birkhoff_sum f n x}\n    \\<subseteq> {- r * real n1 - real N..r * real n1 + real N}", "by auto"], ["proof (state)\nthis:\n  {real_of_int (- int N) - birkhoff_sum f n x..real N - birkhoff_sum f n x}\n  \\<subseteq> {- r * real n1 - real N..r * real n1 + real N}\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "finally"], ["proof (chain)\npicking this:\n  (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n  \\<subseteq> {- r * real n1 - real N..r * real n1 + real N}", "have \"F = ((+)(birkhoff_sum f n x)) -` (Pair ((T^^n)x) -`C)\""], ["proof (prove)\nusing this:\n  (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n  \\<subseteq> {- r * real n1 - real N..r * real n1 + real N}\n\ngoal (1 subgoal):\n 1. F = (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C", "unfolding F_expr"], ["proof (prove)\nusing this:\n  (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n  \\<subseteq> {- r * real n1 - real N..r * real n1 + real N}\n\ngoal (1 subgoal):\n 1. {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n    (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C =\n    (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C", "by auto"], ["proof (state)\nthis:\n  F = (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "then"], ["proof (chain)\npicking this:\n  F = (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C", "have \"emeasure lborel F = emeasure lborel ((+)(birkhoff_sum f n x) -` (Pair ((T^^n)x) -`C))\""], ["proof (prove)\nusing this:\n  F = (+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C\n\ngoal (1 subgoal):\n 1. emeasure lborel F =\n    emeasure lborel ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C)", "by auto"], ["proof (state)\nthis:\n  emeasure lborel F =\n  emeasure lborel ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "also"], ["proof (state)\nthis:\n  emeasure lborel F =\n  emeasure lborel ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "have \"... = emeasure lborel (((+)(birkhoff_sum f n x) -` (Pair ((T^^n)x) -`C)) \\<inter> space lborel)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C) =\n    emeasure lborel\n     ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C \\<inter>\n      space lborel)", "by simp"], ["proof (state)\nthis:\n  emeasure lborel ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C) =\n  emeasure lborel\n   ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C \\<inter>\n    space lborel)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "also"], ["proof (state)\nthis:\n  emeasure lborel ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C) =\n  emeasure lborel\n   ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C \\<inter>\n    space lborel)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "have \"... = emeasure (distr lborel borel ((+) (birkhoff_sum f n x))) (Pair ((T^^n)x) -`C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel\n     ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C \\<inter>\n      space lborel) =\n    emeasure (distr lborel borel ((+) (birkhoff_sum f n x)))\n     (Pair ((T ^^ n) x) -` C)", "apply (rule emeasure_distr[symmetric])"], ["proof (prove)\ngoal (2 subgoals):\n 1. (+) (birkhoff_sum f n x) \\<in> borel_measurable lborel\n 2. Pair ((T ^^ n) x) -` C \\<in> sets borel", "using C_meas"], ["proof (prove)\nusing this:\n  C \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (2 subgoals):\n 1. (+) (birkhoff_sum f n x) \\<in> borel_measurable lborel\n 2. Pair ((T ^^ n) x) -` C \\<in> sets borel", "by auto"], ["proof (state)\nthis:\n  emeasure lborel\n   ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C \\<inter>\n    space lborel) =\n  emeasure (distr lborel borel ((+) (birkhoff_sum f n x)))\n   (Pair ((T ^^ n) x) -` C)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "also"], ["proof (state)\nthis:\n  emeasure lborel\n   ((+) (birkhoff_sum f n x) -` Pair ((T ^^ n) x) -` C \\<inter>\n    space lborel) =\n  emeasure (distr lborel borel ((+) (birkhoff_sum f n x)))\n   (Pair ((T ^^ n) x) -` C)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "have \"... = emeasure lborel (Pair ((T^^n)x) -`C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (distr lborel borel ((+) (birkhoff_sum f n x)))\n     (Pair ((T ^^ n) x) -` C) =\n    emeasure lborel (Pair ((T ^^ n) x) -` C)", "using lborel_distr_plus[of \"birkhoff_sum f n x\"]"], ["proof (prove)\nusing this:\n  distr lborel borel ((+) (birkhoff_sum f n x)) = lborel\n\ngoal (1 subgoal):\n 1. emeasure (distr lborel borel ((+) (birkhoff_sum f n x)))\n     (Pair ((T ^^ n) x) -` C) =\n    emeasure lborel (Pair ((T ^^ n) x) -` C)", "by simp"], ["proof (state)\nthis:\n  emeasure (distr lborel borel ((+) (birkhoff_sum f n x)))\n   (Pair ((T ^^ n) x) -` C) =\n  emeasure lborel (Pair ((T ^^ n) x) -` C)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "also"], ["proof (state)\nthis:\n  emeasure (distr lborel borel ((+) (birkhoff_sum f n x)))\n   (Pair ((T ^^ n) x) -` C) =\n  emeasure lborel (Pair ((T ^^ n) x) -` C)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "have \"... \\<ge> e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal e \\<le> emeasure lborel (Pair ((T ^^ n) x) -` C)", "using Cx_fibers \\<open>(T^^n) x \\<in> Cx\\<close>"], ["proof (prove)\nusing this:\n  ?x3 \\<in> Cx \\<Longrightarrow>\n  ennreal e \\<le> emeasure lborel (Pair ?x3 -` C)\n  (T ^^ n) x \\<in> Cx\n\ngoal (1 subgoal):\n 1. ennreal e \\<le> emeasure lborel (Pair ((T ^^ n) x) -` C)", "by auto"], ["proof (state)\nthis:\n  ennreal e \\<le> emeasure lborel (Pair ((T ^^ n) x) -` C)\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "finally"], ["proof (chain)\npicking this:\n  ennreal e \\<le> emeasure lborel F", "have \"emeasure lborel F \\<ge> e\""], ["proof (prove)\nusing this:\n  ennreal e \\<le> emeasure lborel F\n\ngoal (1 subgoal):\n 1. ennreal e \\<le> emeasure lborel F", "by auto"], ["proof (state)\nthis:\n  ennreal e \\<le> emeasure lborel F\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<noteq> 0 \\<Longrightarrow>\n    ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "then"], ["proof (chain)\npicking this:\n  ennreal e \\<le> emeasure lborel F", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal e \\<le> emeasure lborel F\n\ngoal (1 subgoal):\n 1. ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "using A"], ["proof (prove)\nusing this:\n  ennreal e \\<le> emeasure lborel F\n  \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel =\n  indicator (Dx \\<inter> (T ^^ n) -` Cx) x * emeasure lborel F\n\ngoal (1 subgoal):\n 1. ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n    \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel", "by (simp add: indicator_def)"], ["proof (state)\nthis:\n  ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n  \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x\n  \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (x, y) \\<partial>lborel\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "}"], ["proof (state)\nthis:\n  ?x5 \\<in> space M \\<Longrightarrow>\n  ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) ?x5\n  \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (?x5, y) \\<partial>lborel\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "moreover"], ["proof (state)\nthis:\n  ?x5 \\<in> space M \\<Longrightarrow>\n  ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) ?x5\n  \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (?x5, y) \\<partial>lborel\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"emeasure ?MS (D n) = (\\<integral>\\<^sup>+x. (\\<integral>\\<^sup>+y. indicator (D n) (x, y) \\<partial>lborel) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n) =\n    \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y. indicator (D n) (x, y)\n        \\<partial>lborel\n                       \\<partial>M", "using Dn_meas lborel.emeasure_pair_measure"], ["proof (prove)\nusing this:\n  D ?n3 \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n  ?X \\<in> sets (?N \\<Otimes>\\<^sub>M lborel) \\<Longrightarrow>\n  emeasure (?N \\<Otimes>\\<^sub>M lborel) ?X =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y. indicator ?X (x, y)\n      \\<partial>lborel\n                     \\<partial>?N\n\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n) =\n    \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y. indicator (D n) (x, y)\n        \\<partial>lborel\n                       \\<partial>M", "by blast"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) (D n) =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y. indicator (D n) (x, y)\n      \\<partial>lborel\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "ultimately"], ["proof (chain)\npicking this:\n  ?x5 \\<in> space M \\<Longrightarrow>\n  ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) ?x5\n  \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (?x5, y) \\<partial>lborel\n  emeasure (M \\<Otimes>\\<^sub>M lborel) (D n) =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y. indicator (D n) (x, y)\n      \\<partial>lborel\n                     \\<partial>M", "have \"emeasure ?MS (D n) \\<ge> (\\<integral>\\<^sup>+x. ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<partial>M)\""], ["proof (prove)\nusing this:\n  ?x5 \\<in> space M \\<Longrightarrow>\n  ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) ?x5\n  \\<le> \\<integral>\\<^sup>+ y. indicator (D n) (?x5, y) \\<partial>lborel\n  emeasure (M \\<Otimes>\\<^sub>M lborel) (D n) =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y. indicator (D n) (x, y)\n      \\<partial>lborel\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>Dx \\<inter> (T ^^ n) -` Cx. ennreal e\n    \\<partial>M\n    \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "by (simp add: nn_integral_mono)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>Dx \\<inter> (T ^^ n) -` Cx. ennreal e\\<partial>M\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>Dx \\<inter> (T ^^ n) -` Cx. ennreal e\\<partial>M\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"(\\<integral>\\<^sup>+x. ennreal e * indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<partial>M) = e * (\\<integral>\\<^sup>+x. indicator (Dx \\<inter> (T ^^ n) -` Cx) x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>Dx \\<inter> (T ^^ n) -` Cx. ennreal e\n    \\<partial>M =\n    ennreal e * integral\\<^sup>N M (indicator (Dx \\<inter> (T ^^ n) -` Cx))", "apply (rule nn_integral_cmult)"], ["proof (prove)\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) \\<in> borel_measurable M", "using \\<open>e>0\\<close>"], ["proof (prove)\nusing this:\n  0 < e\n\ngoal (1 subgoal):\n 1. indicator (Dx \\<inter> (T ^^ n) -` Cx) \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>Dx \\<inter> (T ^^ n) -` Cx. ennreal e\n  \\<partial>M =\n  ennreal e * integral\\<^sup>N M (indicator (Dx \\<inter> (T ^^ n) -` Cx))\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>Dx \\<inter> (T ^^ n) -` Cx. ennreal e\n  \\<partial>M =\n  ennreal e * integral\\<^sup>N M (indicator (Dx \\<inter> (T ^^ n) -` Cx))\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"... = ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal e *\n    integral\\<^sup>N M (indicator (Dx \\<inter> (T ^^ n) -` Cx)) =\n    ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "by simp"], ["proof (state)\nthis:\n  ennreal e * integral\\<^sup>N M (indicator (Dx \\<inter> (T ^^ n) -` Cx)) =\n  ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "finally"], ["proof (chain)\npicking this:\n  ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have *: \"emeasure ?MS (D n) \\<ge> ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\""], ["proof (prove)\nusing this:\n  ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)\n\ngoal (1 subgoal):\n 1. ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n    \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "by auto"], ["proof (state)\nthis:\n  ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"c + emeasure M (space M) \\<le> emeasure M Dx + emeasure M Cx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal c + emeasure M (space M) \\<le> emeasure M Dx + emeasure M Cx", "using \\<open>emeasure M Dx + c \\<ge> emeasure M (space M)\\<close>"], ["proof (prove)\nusing this:\n  emeasure M (space M) \\<le> emeasure M Dx + ennreal c\n\ngoal (1 subgoal):\n 1. ennreal c + emeasure M (space M) \\<le> emeasure M Dx + emeasure M Cx", "unfolding c_def"], ["proof (prove)\nusing this:\n  emeasure M (space M)\n  \\<le> emeasure M Dx + ennreal (Sigma_Algebra.measure M Cx / 2)\n\ngoal (1 subgoal):\n 1. ennreal (Sigma_Algebra.measure M Cx / 2) + emeasure M (space M)\n    \\<le> emeasure M Dx + emeasure M Cx", "by (auto simp: emeasure_eq_measure ennreal_plus[symmetric] simp del: ennreal_plus)"], ["proof (state)\nthis:\n  ennreal c + emeasure M (space M) \\<le> emeasure M Dx + emeasure M Cx\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "also"], ["proof (state)\nthis:\n  ennreal c + emeasure M (space M) \\<le> emeasure M Dx + emeasure M Cx\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"... = emeasure M Dx + emeasure M ((T^^n)--`Cx)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M Dx + emeasure M Cx =\n    emeasure M Dx + emeasure M ((T ^^ n) --` Cx)", "by (simp add: T_vrestr_same_emeasure(2))"], ["proof (state)\nthis:\n  emeasure M Dx + emeasure M Cx =\n  emeasure M Dx + emeasure M ((T ^^ n) --` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "also"], ["proof (state)\nthis:\n  emeasure M Dx + emeasure M Cx =\n  emeasure M Dx + emeasure M ((T ^^ n) --` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"... = emeasure M (Dx \\<union> ((T^^n)--`Cx)) + emeasure M (Dx \\<inter> ((T^^n)--`Cx))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M Dx + emeasure M ((T ^^ n) --` Cx) =\n    emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n    emeasure M (Dx \\<inter> (T ^^ n) --` Cx)", "by (rule emeasure_Un_Int, auto)"], ["proof (state)\nthis:\n  emeasure M Dx + emeasure M ((T ^^ n) --` Cx) =\n  emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n  emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "also"], ["proof (state)\nthis:\n  emeasure M Dx + emeasure M ((T ^^ n) --` Cx) =\n  emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n  emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "have \"... \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> ((T^^n)-`Cx))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n    emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n    \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n    emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n    \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "have \"emeasure M (Dx \\<union> ((T^^n)--`Cx)) \\<le> emeasure M (space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M (Dx \\<union> (T ^^ n) --` Cx) \\<le> emeasure M (space M)", "by (rule emeasure_mono, auto simp add: sets.sets_into_space)"], ["proof (state)\nthis:\n  emeasure M (Dx \\<union> (T ^^ n) --` Cx) \\<le> emeasure M (space M)\n\ngoal (1 subgoal):\n 1. emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n    emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n    \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "moreover"], ["proof (state)\nthis:\n  emeasure M (Dx \\<union> (T ^^ n) --` Cx) \\<le> emeasure M (space M)\n\ngoal (1 subgoal):\n 1. emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n    emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n    \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "have \"Dx \\<inter> ((T^^n)--`Cx) = Dx \\<inter> ((T^^n)-`Cx)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Dx \\<inter> (T ^^ n) --` Cx = Dx \\<inter> (T ^^ n) -` Cx", "by (simp add: vrestr_intersec_in_space)"], ["proof (state)\nthis:\n  Dx \\<inter> (T ^^ n) --` Cx = Dx \\<inter> (T ^^ n) -` Cx\n\ngoal (1 subgoal):\n 1. emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n    emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n    \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "ultimately"], ["proof (chain)\npicking this:\n  emeasure M (Dx \\<union> (T ^^ n) --` Cx) \\<le> emeasure M (space M)\n  Dx \\<inter> (T ^^ n) --` Cx = Dx \\<inter> (T ^^ n) -` Cx", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure M (Dx \\<union> (T ^^ n) --` Cx) \\<le> emeasure M (space M)\n  Dx \\<inter> (T ^^ n) --` Cx = Dx \\<inter> (T ^^ n) -` Cx\n\ngoal (1 subgoal):\n 1. emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n    emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n    \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "by (metis add.commute add_left_mono)"], ["proof (state)\nthis:\n  emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n  emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n  \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  emeasure M (Dx \\<union> (T ^^ n) --` Cx) +\n  emeasure M (Dx \\<inter> (T ^^ n) --` Cx)\n  \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "finally"], ["proof (chain)\npicking this:\n  ennreal c + emeasure M (space M)\n  \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "have \"emeasure M (Dx \\<inter> ((T^^n)-`Cx)) \\<ge> c\""], ["proof (prove)\nusing this:\n  ennreal c + emeasure M (space M)\n  \\<le> emeasure M (space M) + emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n\ngoal (1 subgoal):\n 1. ennreal c \\<le> emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "by (simp add: emeasure_eq_measure)"], ["proof (state)\nthis:\n  ennreal c \\<le> emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "then"], ["proof (chain)\npicking this:\n  ennreal c \\<le> emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "have \"ennreal e * emeasure M (Dx \\<inter> ((T^^n)-`Cx)) \\<ge> ennreal e * c\""], ["proof (prove)\nusing this:\n  ennreal c \\<le> emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n\ngoal (1 subgoal):\n 1. ennreal e * ennreal c\n    \\<le> ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "using \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  ennreal c \\<le> emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  0 < e\n\ngoal (1 subgoal):\n 1. ennreal e * ennreal c\n    \\<le> ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "using mult_left_mono"], ["proof (prove)\nusing this:\n  ennreal c \\<le> emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  0 < e\n  \\<lbrakk>?a \\<le> ?b; (0::?'a) \\<le> ?c\\<rbrakk>\n  \\<Longrightarrow> ?c * ?a \\<le> ?c * ?b\n\ngoal (1 subgoal):\n 1. ennreal e * ennreal c\n    \\<le> ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "by fastforce"], ["proof (state)\nthis:\n  ennreal e * ennreal c\n  \\<le> ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "with *"], ["proof (chain)\npicking this:\n  ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)\n  ennreal e * ennreal c\n  \\<le> ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)", "show \"emeasure ?MS (D n) \\<ge> e * c\""], ["proof (prove)\nusing this:\n  ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)\n  ennreal e * ennreal c\n  \\<le> ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "using \\<open>0<c\\<close> \\<open>0<e\\<close>"], ["proof (prove)\nusing this:\n  ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)\n  ennreal e * ennreal c\n  \\<le> ennreal e * emeasure M (Dx \\<inter> (T ^^ n) -` Cx)\n  0 < c\n  0 < e\n\ngoal (1 subgoal):\n 1. ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)", "by (auto simp: ennreal_mult[symmetric])"], ["proof (state)\nthis:\n  ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?n3 \\<in> {n0..n1} \\<Longrightarrow>\n  ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D ?n3)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"\\<not>(disjoint_family_on D {n0..n1})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> disjoint_family_on D {n0..n1}", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "assume D: \"disjoint_family_on D {n0..n1}\""], ["proof (state)\nthis:\n  disjoint_family_on D {n0..n1}\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"emeasure lborel {-r*n1-N..r*n1+N} = (r * real n1 + real N) - (- r * real n1 - real N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n    ennreal (r * real n1 + real N - (- r * real n1 - real N))", "apply (rule emeasure_lborel_Icc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. - r * real n1 - real N \\<le> r * real n1 + real N", "using \\<open>r>0\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n\ngoal (1 subgoal):\n 1. - r * real n1 - real N \\<le> r * real n1 + real N", "by auto"], ["proof (state)\nthis:\n  emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n  ennreal (r * real n1 + real N - (- r * real n1 - real N))\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n  ennreal (r * real n1 + real N - (- r * real n1 - real N))", "have *: \"emeasure lborel {-r*n1-N..r*n1+N} = ennreal(2 * r * real n1 + 2 * real N)\""], ["proof (prove)\nusing this:\n  emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n  ennreal (r * real n1 + real N - (- r * real n1 - real N))\n\ngoal (1 subgoal):\n 1. emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n    ennreal (2 * r * real n1 + 2 * real N)", "by (auto simp: ac_simps)"], ["proof (state)\nthis:\n  emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n  ennreal (2 * r * real n1 + 2 * real N)\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"ennreal(e * c) * (real n1 - real n0 + 1) = ennreal(e*c) * card {n0..n1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (e * c) * ennreal (real n1 - real n0 + 1) =\n    ennreal (e * c) * of_nat (card {n0..n1})", "using \\<open>n1 > n0\\<close>"], ["proof (prove)\nusing this:\n  n0 < n1\n\ngoal (1 subgoal):\n 1. ennreal (e * c) * ennreal (real n1 - real n0 + 1) =\n    ennreal (e * c) * of_nat (card {n0..n1})", "by (auto simp: ennreal_of_nat_eq_real_of_nat Suc_diff_le ac_simps of_nat_diff)"], ["proof (state)\nthis:\n  ennreal (e * c) * ennreal (real n1 - real n0 + 1) =\n  ennreal (e * c) * of_nat (card {n0..n1})\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  ennreal (e * c) * ennreal (real n1 - real n0 + 1) =\n  ennreal (e * c) * of_nat (card {n0..n1})\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"... = (\\<Sum>n\\<in>{n0..n1}. ennreal(e*c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (e * c) * of_nat (card {n0..n1}) =\n    (\\<Sum>n = n0..n1. ennreal (e * c))", "by (simp add: ac_simps)"], ["proof (state)\nthis:\n  ennreal (e * c) * of_nat (card {n0..n1}) =\n  (\\<Sum>n = n0..n1. ennreal (e * c))\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  ennreal (e * c) * of_nat (card {n0..n1}) =\n  (\\<Sum>n = n0..n1. ennreal (e * c))\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"... \\<le> (\\<Sum>n\\<in>{n0..n1}. emeasure ?MS (D n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n = n0..n1. ennreal (e * c))\n    \\<le> (\\<Sum>n = n0..n1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n))", "using \\<open>\\<And>n. n \\<in> {n0..n1} \\<Longrightarrow> emeasure ?MS (D n) \\<ge> e * c\\<close>"], ["proof (prove)\nusing this:\n  ?n \\<in> {n0..n1} \\<Longrightarrow>\n  ennreal (e * c) \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel) (D ?n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>n = n0..n1. ennreal (e * c))\n    \\<le> (\\<Sum>n = n0..n1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n))", "by (meson sum_mono)"], ["proof (state)\nthis:\n  (\\<Sum>n = n0..n1. ennreal (e * c))\n  \\<le> (\\<Sum>n = n0..n1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n))\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  (\\<Sum>n = n0..n1. ennreal (e * c))\n  \\<le> (\\<Sum>n = n0..n1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n))\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"... = emeasure ?MS (\\<Union>n\\<in>{n0..n1}. D n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n = n0..n1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)) =\n    emeasure (M \\<Otimes>\\<^sub>M lborel) (\\<Union> (D ` {n0..n1}))", "apply (rule sum_emeasure)"], ["proof (prove)\ngoal (3 subgoals):\n 1. D ` {n0..n1} \\<subseteq> sets (M \\<Otimes>\\<^sub>M lborel)\n 2. disjoint_family_on D {n0..n1}\n 3. finite {n0..n1}", "using Dn_meas"], ["proof (prove)\nusing this:\n  D ?n3 \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (3 subgoals):\n 1. D ` {n0..n1} \\<subseteq> sets (M \\<Otimes>\\<^sub>M lborel)\n 2. disjoint_family_on D {n0..n1}\n 3. finite {n0..n1}", "by (auto simp add: D)"], ["proof (state)\nthis:\n  (\\<Sum>n = n0..n1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)) =\n  emeasure (M \\<Otimes>\\<^sub>M lborel) (\\<Union> (D ` {n0..n1}))\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  (\\<Sum>n = n0..n1. emeasure (M \\<Otimes>\\<^sub>M lborel) (D n)) =\n  emeasure (M \\<Otimes>\\<^sub>M lborel) (\\<Union> (D ` {n0..n1}))\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"... \\<le> emeasure ?MS (space M \\<times> {-r*n1-N..r*n1+N})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel) (\\<Union> (D ` {n0..n1}))\n    \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel)\n           (space M \\<times> {- r * real n1 - real N..r * real n1 + real N})", "apply (rule emeasure_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Union> (D ` {n0..n1})\n    \\<subseteq> space M \\<times>\n                {- r * real n1 - real N..r * real n1 + real N}\n 2. space M \\<times> {- r * real n1 - real N..r * real n1 + real N}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "unfolding D_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<Union>n\\<in>{n0..n1}.\n        Dx \\<times> {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n        ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` C)\n    \\<subseteq> space M \\<times>\n                {- r * real n1 - real N..r * real n1 + real N}\n 2. space M \\<times> {- r * real n1 - real N..r * real n1 + real N}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "using sets.sets_into_space[OF Dx_meas]"], ["proof (prove)\nusing this:\n  Dx \\<subseteq> space M\n\ngoal (2 subgoals):\n 1. (\\<Union>n\\<in>{n0..n1}.\n        Dx \\<times> {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n        ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` C)\n    \\<subseteq> space M \\<times>\n                {- r * real n1 - real N..r * real n1 + real N}\n 2. space M \\<times> {- r * real n1 - real N..r * real n1 + real N}\n    \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) (\\<Union> (D ` {n0..n1}))\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel)\n         (space M \\<times> {- r * real n1 - real N..r * real n1 + real N})\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) (\\<Union> (D ` {n0..n1}))\n  \\<le> emeasure (M \\<Otimes>\\<^sub>M lborel)\n         (space M \\<times> {- r * real n1 - real N..r * real n1 + real N})\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"... = emeasure M (space M) * emeasure lborel {-r*n1-N..r*n1+N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel)\n     (space M \\<times> {- r * real n1 - real N..r * real n1 + real N}) =\n    emeasure M (space M) *\n    emeasure lborel {- r * real n1 - real N..r * real n1 + real N}", "by (rule sigma_finite_measure.emeasure_pair_measure_Times, auto simp add: lborel.sigma_finite_measure_axioms)"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel)\n   (space M \\<times> {- r * real n1 - real N..r * real n1 + real N}) =\n  emeasure M (space M) *\n  emeasure lborel {- r * real n1 - real N..r * real n1 + real N}\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel)\n   (space M \\<times> {- r * real n1 - real N..r * real n1 + real N}) =\n  emeasure M (space M) *\n  emeasure lborel {- r * real n1 - real N..r * real n1 + real N}\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"... = emeasure M (space M) * ennreal(2 * r * real n1 + 2 * real N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M (space M) *\n    emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n    emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)", "using *"], ["proof (prove)\nusing this:\n  emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n  ennreal (2 * r * real n1 + 2 * real N)\n\ngoal (1 subgoal):\n 1. emeasure M (space M) *\n    emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n    emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)", "by auto"], ["proof (state)\nthis:\n  emeasure M (space M) *\n  emeasure lborel {- r * real n1 - real N..r * real n1 + real N} =\n  emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "finally"], ["proof (chain)\npicking this:\n  ennreal (e * c) * ennreal (real n1 - real n0 + 1)\n  \\<le> emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)", "have \"ennreal(e * c) * (real n1- real n0+1) \\<le> emeasure M (space M) * ennreal(2 * r * real n1 + 2 * real N)\""], ["proof (prove)\nusing this:\n  ennreal (e * c) * ennreal (real n1 - real n0 + 1)\n  \\<le> emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)\n\ngoal (1 subgoal):\n 1. ennreal (e * c) * ennreal (real n1 - real n0 + 1)\n    \\<le> emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)", "by simp"], ["proof (state)\nthis:\n  ennreal (e * c) * ennreal (real n1 - real n0 + 1)\n  \\<le> emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  ennreal (e * c) * ennreal (real n1 - real n0 + 1)\n  \\<le> emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)", "have \"e*c * (real n1- real n0 + 1) \\<le> measure M (space M) * (2 * r * real n1 + 2 * real N)\""], ["proof (prove)\nusing this:\n  ennreal (e * c) * ennreal (real n1 - real n0 + 1)\n  \\<le> emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)\n\ngoal (1 subgoal):\n 1. e * c * (real n1 - real n0 + 1)\n    \\<le> Sigma_Algebra.measure M (space M) * (2 * r * real n1 + 2 * real N)", "using \\<open>0<r\\<close> \\<open>0<e\\<close> \\<open>0<c\\<close> \\<open>n0 < n1\\<close> emeasure_eq_measure"], ["proof (prove)\nusing this:\n  ennreal (e * c) * ennreal (real n1 - real n0 + 1)\n  \\<le> emeasure M (space M) * ennreal (2 * r * real n1 + 2 * real N)\n  0 < r\n  0 < e\n  0 < c\n  n0 < n1\n  emeasure M ?A = ennreal (Sigma_Algebra.measure M ?A)\n\ngoal (1 subgoal):\n 1. e * c * (real n1 - real n0 + 1)\n    \\<le> Sigma_Algebra.measure M (space M) * (2 * r * real n1 + 2 * real N)", "by (auto simp: ennreal_mult'[symmetric] simp del: ennreal_plus)"], ["proof (state)\nthis:\n  e * c * (real n1 - real n0 + 1)\n  \\<le> Sigma_Algebra.measure M (space M) * (2 * r * real n1 + 2 * real N)\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  e * c * (real n1 - real n0 + 1)\n  \\<le> Sigma_Algebra.measure M (space M) * (2 * r * real n1 + 2 * real N)", "have \"0 \\<le> measure M (space M) * (2 * r * real n1 + 2 * real N) - e*c * (real n1- real n0 + 1)\""], ["proof (prove)\nusing this:\n  e * c * (real n1 - real n0 + 1)\n  \\<le> Sigma_Algebra.measure M (space M) * (2 * r * real n1 + 2 * real N)\n\ngoal (1 subgoal):\n 1. 0 \\<le> Sigma_Algebra.measure M (space M) *\n            (2 * r * real n1 + 2 * real N) -\n            e * c * (real n1 - real n0 + 1)", "by auto"], ["proof (state)\nthis:\n  0 \\<le> Sigma_Algebra.measure M (space M) *\n          (2 * r * real n1 + 2 * real N) -\n          e * c * (real n1 - real n0 + 1)\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  0 \\<le> Sigma_Algebra.measure M (space M) *\n          (2 * r * real n1 + 2 * real N) -\n          e * c * (real n1 - real n0 + 1)\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "have \"... = (measure M (space M) * 2 * N + e*c*n0 - e*c) - n1 * (e*c-2*r*measure M (space M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sigma_Algebra.measure M (space M) * (2 * r * real n1 + 2 * real N) -\n    e * c * (real n1 - real n0 + 1) =\n    Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n    e * c -\n    real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))", "by algebra"], ["proof (state)\nthis:\n  Sigma_Algebra.measure M (space M) * (2 * r * real n1 + 2 * real N) -\n  e * c * (real n1 - real n0 + 1) =\n  Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 - e * c -\n  real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "finally"], ["proof (chain)\npicking this:\n  0 \\<le> Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n          e * c -\n          real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))", "have \"n1 * (e*c-2*r*measure M (space M)) \\<le> measure M (space M) * 2 * N + e*c*n0 - e*c\""], ["proof (prove)\nusing this:\n  0 \\<le> Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n          e * c -\n          real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n\ngoal (1 subgoal):\n 1. real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n    \\<le> Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n          e * c", "by linarith"], ["proof (state)\nthis:\n  real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n  \\<le> Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n        e * c\n\ngoal (1 subgoal):\n 1. disjoint_family_on D {n0..n1} \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n  \\<le> Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n        e * c", "show False"], ["proof (prove)\nusing this:\n  real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n  \\<le> Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n        e * c\n\ngoal (1 subgoal):\n 1. False", "using n1_ineq"], ["proof (prove)\nusing this:\n  real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n  \\<le> Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 -\n        e * c\n  Sigma_Algebra.measure M (space M) * 2 * real N + e * c * real n0 - e * c\n  < real n1 * (e * c - 2 * r * Sigma_Algebra.measure M (space M))\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<not> disjoint_family_on D {n0..n1}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  \\<not> disjoint_family_on D {n0..n1}", "obtain n m where nm: \"n<m\" \"D m \\<inter> D n \\<noteq> {}\""], ["proof (prove)\nusing this:\n  \\<not> disjoint_family_on D {n0..n1}\n\ngoal (1 subgoal):\n 1. (\\<And>n m.\n        \\<lbrakk>n < m; D m \\<inter> D n \\<noteq> {}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding disjoint_family_on_def"], ["proof (prove)\nusing this:\n  \\<not> (\\<forall>m\\<in>{n0..n1}.\n             \\<forall>n\\<in>{n0..n1}.\n                m \\<noteq> n \\<longrightarrow> D m \\<inter> D n = {})\n\ngoal (1 subgoal):\n 1. (\\<And>n m.\n        \\<lbrakk>n < m; D m \\<inter> D n \\<noteq> {}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis inf_sup_aci(1) linorder_cases)"], ["proof (state)\nthis:\n  n < m\n  D m \\<inter> D n \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "define k where \"k = m-n\""], ["proof (state)\nthis:\n  k = m - n\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  k = m - n", "have \"k>0\" \"D (n+k) \\<inter> D n \\<noteq> {}\""], ["proof (prove)\nusing this:\n  k = m - n\n\ngoal (1 subgoal):\n 1. 0 < k &&& D (n + k) \\<inter> D n \\<noteq> {}", "using nm"], ["proof (prove)\nusing this:\n  k = m - n\n  n < m\n  D m \\<inter> D n \\<noteq> {}\n\ngoal (1 subgoal):\n 1. 0 < k &&& D (n + k) \\<inter> D n \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  0 < k\n  D (n + k) \\<inter> D n \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  0 < k\n  D (n + k) \\<inter> D n \\<noteq> {}", "have \"((?TS^^(n+k))-`A) \\<inter> ((?TS^^n)-`A) \\<noteq> {}\""], ["proof (prove)\nusing this:\n  0 < k\n  D (n + k) \\<inter> D n \\<noteq> {}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n    ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A \\<noteq>\n    {}", "unfolding D_def C_def B_def"], ["proof (prove)\nusing this:\n  0 < k\n  Dx \\<times> {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -`\n  (A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} \\<inter>\n   Cx \\<times> UNIV) \\<inter>\n  (Dx \\<times> {- r * real n1 - real N..r * real n1 + real N} \\<inter>\n   ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n   (A \\<inter> {(x, y). \\<bar>y\\<bar> \\<le> real N} \\<inter>\n    Cx \\<times> UNIV)) \\<noteq>\n  {}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n    ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A \\<noteq>\n    {}", "by auto"], ["proof (state)\nthis:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A \\<noteq>\n  {}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "moreover"], ["proof (state)\nthis:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A \\<noteq>\n  {}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "have \"((?TS^^(n+k))-`A) \\<inter> ((?TS^^n)-`A) = (?TS^^n)-`(((?TS^^k)-`A) \\<inter> A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n    ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A =\n    ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n    (((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A)", "using funpow_add"], ["proof (prove)\nusing this:\n  ?f ^^ (?m + ?n) = ?f ^^ ?m \\<circ> ?f ^^ ?n\n\ngoal (1 subgoal):\n 1. ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n    ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A =\n    ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n    (((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A)", "by (simp add: add.commute funpow_add set.compositionality)"], ["proof (state)\nthis:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A =\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n  (((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A)\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "ultimately"], ["proof (chain)\npicking this:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A \\<noteq>\n  {}\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A =\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n  (((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A)", "have \"((?TS^^k)-`A) \\<inter> A \\<noteq> {}\""], ["proof (prove)\nusing this:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A \\<noteq>\n  {}\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ (n + k)) -` A \\<inter>\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -` A =\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n  (((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>A.\n       \\<lbrakk>A \\<in> sets (M \\<Otimes>\\<^sub>M lborel);\n        0 < emeasure (M \\<Otimes>\\<^sub>M lborel) A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n>0.\n                            ((\\<lambda>(x, y). (T x, y + f x)) ^^ n) -`\n                            A \\<inter>\n                            A \\<noteq>\n                            {}", "then"], ["proof (chain)\npicking this:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A \\<noteq> {}", "show \"\\<exists>k>0. ((?TS^^k)-`A) \\<inter> A \\<noteq> {}\""], ["proof (prove)\nusing this:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       ((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A \\<noteq> {}", "using \\<open>k>0\\<close>"], ["proof (prove)\nusing this:\n  ((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A \\<noteq> {}\n  0 < k\n\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       ((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     ((\\<lambda>(x, y). (T x, y + f x)) ^^ k) -` A \\<inter> A \\<noteq> {}\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Oscillations around the limit in Birkhoff theorem\\<close>"], ["", "text \\<open>In this paragraph, we prove that, in Birkhoff theorem with vanishing limit, the Birkhoff sums\nare infinitely many times arbitrarily close to $0$, both on the positive and the negative side.\n\nIn the ergodic case, this statement implies for instance that if the Birkhoff sums of an integrable\nfunction tend to infinity almost everywhere, then the integral of the function can not vanish, it\nhas to be strictly positive (while Birkhoff theorem per se does not exclude the convergence to\ninfinity, at a rate slower than linear). This converts a qualitative information (convergence to\ninfinity at an unknown rate) to a quantitative information (linear convergence to infinity). This\nresult (sometimes known as Atkinson's Lemma) has been reinvented many times, for instance by Kesten\nand by Guivarch. It plays an important role in the study of random products of matrices.\n\nThis is essentially a consequence of the conservativity of the corresponding skew-product, proved in\n\\verb+skew_product_conservative+. Indeed, this implies that, starting from a small set $X \\times\n[-e/2, e/2]$, the skew-product comes back infinitely often to itself, which implies that the\nBirkhoff sums at these times are bounded by $e$.\n\nTo show that the Birkhoff sums come back to $[0,e]$ is a little bit more tricky. Argue by\ncontradiction, and induce on $A \\times [0,e/2]$ where $A$ is the set of points where the Birkhoff\nsums don't come back to $[0,e]$. Then the second coordinate decreases strictly when one iterates the\nskew product, which is not compatible with conservativity.\\<close>"], ["", "lemma birkhoff_sum_small_asymp_lemma:\n  assumes [measurable]: \"integrable M f\"\n    and \"AE x in M. real_cond_exp M Invariants f x = 0\" \"e>(0::real)\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have [measurable]: \"f \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable M", "by auto"], ["proof (state)\nthis:\n  f \\<in> borel_measurable M\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have [measurable]: \"\\<And>N. {x \\<in> space M. \\<exists>N. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}} \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>N.\n       {x \\<in> space M.\n        \\<exists>N.\n           \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\n       \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  {x \\<in> space M.\n   \\<exists>N. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\n  \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "{"], ["proof (state)\nthis:\n  {x \\<in> space M.\n   \\<exists>N. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\n  \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "fix N"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "assume \"N>(0::nat)\""], ["proof (state)\nthis:\n  0 < N\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "define Ax where \"Ax = {x \\<in> space M. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\""], ["proof (state)\nthis:\n  Ax =\n  {x \\<in> space M.\n   \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  Ax =\n  {x \\<in> space M.\n   \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}", "have [measurable]: \"Ax \\<in> sets M\""], ["proof (prove)\nusing this:\n  Ax =\n  {x \\<in> space M.\n   \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\n\ngoal (1 subgoal):\n 1. Ax \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  Ax \\<in> sets M\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "define A where \"A = Ax \\<times> {0..e/2}\""], ["proof (state)\nthis:\n  A = Ax \\<times> {0..e / 2}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  A = Ax \\<times> {0..e / 2}", "have A_meas [measurable]: \"A \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\""], ["proof (prove)\nusing this:\n  A = Ax \\<times> {0..e / 2}\n\ngoal (1 subgoal):\n 1. A \\<in> sets (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  A \\<in> sets (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "define TN where \"TN = T^^N\""], ["proof (state)\nthis:\n  TN = T ^^ N\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "interpret TN: fmpt M TN"], ["proof (prove)\ngoal (1 subgoal):\n 1. fmpt M TN", "unfolding TN_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. fmpt M (T ^^ N)", "using fmpt_power"], ["proof (prove)\nusing this:\n  fmpt M (T ^^ ?n)\n\ngoal (1 subgoal):\n 1. fmpt M (T ^^ N)", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "define fN where \"fN = birkhoff_sum f N\""], ["proof (state)\nthis:\n  fN = birkhoff_sum f N\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"TN.birkhoff_sum fN n x = birkhoff_sum f (n*N) x\" for n x"], ["proof (prove)\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. TN.birkhoff_sum fN 0 x = birkhoff_sum f (0 * N) x\n 2. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "case 0"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. TN.birkhoff_sum fN 0 x = birkhoff_sum f (0 * N) x\n 2. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN 0 x = birkhoff_sum f (0 * N) x", "by auto"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN 0 x = birkhoff_sum f (0 * N) x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "case (Suc n)"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "have \"TN.birkhoff_sum fN (Suc n) x = TN.birkhoff_sum fN n x + fN ((TN^^n) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN (Suc n) x = TN.birkhoff_sum fN n x + fN ((TN ^^ n) x)", "using TN.birkhoff_sum_cocycle[of fN n 1]"], ["proof (prove)\nusing this:\n  TN.birkhoff_sum fN (n + 1) ?x =\n  TN.birkhoff_sum fN n ?x + TN.birkhoff_sum fN 1 ((TN ^^ n) ?x)\n\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN (Suc n) x = TN.birkhoff_sum fN n x + fN ((TN ^^ n) x)", "by auto"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN (Suc n) x = TN.birkhoff_sum fN n x + fN ((TN ^^ n) x)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "also"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN (Suc n) x = TN.birkhoff_sum fN n x + fN ((TN ^^ n) x)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "have \"... = birkhoff_sum f (n*N) x + birkhoff_sum f N ((TN^^n) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN n x + fN ((TN ^^ n) x) =\n    birkhoff_sum f (n * N) x + birkhoff_sum f N ((TN ^^ n) x)", "using Suc.IH fN_def"], ["proof (prove)\nusing this:\n  TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x\n  fN = birkhoff_sum f N\n\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN n x + fN ((TN ^^ n) x) =\n    birkhoff_sum f (n * N) x + birkhoff_sum f N ((TN ^^ n) x)", "by auto"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN n x + fN ((TN ^^ n) x) =\n  birkhoff_sum f (n * N) x + birkhoff_sum f N ((TN ^^ n) x)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "also"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN n x + fN ((TN ^^ n) x) =\n  birkhoff_sum f (n * N) x + birkhoff_sum f N ((TN ^^ n) x)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "have \"... = birkhoff_sum f (n*N+N) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum f (n * N) x + birkhoff_sum f N ((TN ^^ n) x) =\n    birkhoff_sum f (n * N + N) x", "unfolding TN_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum f (n * N) x + birkhoff_sum f N (((T ^^ N) ^^ n) x) =\n    birkhoff_sum f (n * N + N) x", "by (subst funpow_mult, subst mult.commute[of N n], rule birkhoff_sum_cocycle[of f \"n*N\" N x, symmetric])"], ["proof (state)\nthis:\n  birkhoff_sum f (n * N) x + birkhoff_sum f N ((TN ^^ n) x) =\n  birkhoff_sum f (n * N + N) x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       TN.birkhoff_sum fN n x = birkhoff_sum f (n * N) x \\<Longrightarrow>\n       TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "finally"], ["proof (chain)\npicking this:\n  TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (n * N + N) x", "show ?case"], ["proof (prove)\nusing this:\n  TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (n * N + N) x\n\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x", "by (simp add: add.commute)"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN (Suc n) x = birkhoff_sum f (Suc n * N) x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN ?n4 ?x4 = birkhoff_sum f (?n4 * N) ?x4\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  TN.birkhoff_sum fN ?n4 ?x4 = birkhoff_sum f (?n4 * N) ?x4", "have not0e: \"\\<And>x n. x \\<in> Ax \\<Longrightarrow> n \\<noteq> 0 \\<Longrightarrow> TN.birkhoff_sum fN n x \\<notin> {0..e}\""], ["proof (prove)\nusing this:\n  TN.birkhoff_sum fN ?n4 ?x4 = birkhoff_sum f (?n4 * N) ?x4\n\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>x \\<in> Ax; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> TN.birkhoff_sum fN n x \\<notin> {0..e}", "unfolding Ax_def"], ["proof (prove)\nusing this:\n  TN.birkhoff_sum fN ?n4 ?x4 = birkhoff_sum f (?n4 * N) ?x4\n\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>x \\<in> {x \\<in> space M.\n                         \\<forall>n\\<in>{N..}.\n                            birkhoff_sum f n x \\<notin> {0..e}};\n        n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> TN.birkhoff_sum fN n x \\<notin> {0..e}", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>?x4 \\<in> Ax; ?n4 \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> TN.birkhoff_sum fN ?n4 ?x4 \\<notin> {0..e}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "let ?TS = \"(\\<lambda>(x,y). (T x, y + f x))\""], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "let ?MS = \"M \\<Otimes>\\<^sub>M (lborel::real measure)\""], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "interpret TS: conservative_mpt ?MS ?TS"], ["proof (prove)\ngoal (1 subgoal):\n 1. conservative_mpt (M \\<Otimes>\\<^sub>M lborel)\n     (\\<lambda>(x, y). (T x, y + f x))", "by (rule skew_product_conservative, auto simp add: assms)"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "let ?TSN = \"(\\<lambda>(x,y). (TN x, y + fN x))\""], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have *:\"?TSN = ?TS^^N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>(x, y). (TN x, y + fN x)) =\n    (\\<lambda>(x, y). (T x, y + f x)) ^^ N", "unfolding TN_def fN_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>(x, y). ((T ^^ N) x, y + birkhoff_sum f N x)) =\n    (\\<lambda>(x, y). (T x, y + f x)) ^^ N", "using skew_product_real_iterates"], ["proof (prove)\nusing this:\n  ((\\<lambda>(x, y). (T x, y + ?f x)) ^^ ?n) (?x, ?y) =\n  ((T ^^ ?n) ?x, ?y + birkhoff_sum ?f ?n ?x)\n\ngoal (1 subgoal):\n 1. (\\<lambda>(x, y). ((T ^^ N) x, y + birkhoff_sum f N x)) =\n    (\\<lambda>(x, y). (T x, y + f x)) ^^ N", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>(x, y). (TN x, y + fN x)) =\n  (\\<lambda>(x, y). (T x, y + f x)) ^^ N\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "interpret TSN: conservative_mpt ?MS ?TSN"], ["proof (prove)\ngoal (1 subgoal):\n 1. conservative_mpt (M \\<Otimes>\\<^sub>M lborel)\n     (\\<lambda>(x, y). (TN x, y + fN x))", "using * TS.conservative_mpt_power"], ["proof (prove)\nusing this:\n  (\\<lambda>(x, y). (TN x, y + fN x)) =\n  (\\<lambda>(x, y). (T x, y + f x)) ^^ N\n  conservative_mpt (M \\<Otimes>\\<^sub>M lborel)\n   ((\\<lambda>(x, y). (T x, y + f x)) ^^ ?n)\n\ngoal (1 subgoal):\n 1. conservative_mpt (M \\<Otimes>\\<^sub>M lborel)\n     (\\<lambda>(x, y). (TN x, y + fN x))", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "define MA TA where \"MA = restrict_space ?MS A\" and \"TA = TSN.induced_map A\""], ["proof (state)\nthis:\n  MA = restrict_space (M \\<Otimes>\\<^sub>M lborel) A\n  TA = TSN.induced_map A\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "interpret TA: conservative_mpt MA TA"], ["proof (prove)\ngoal (1 subgoal):\n 1. conservative_mpt MA TA", "unfolding MA_def TA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. conservative_mpt (restrict_space (M \\<Otimes>\\<^sub>M lborel) A)\n     (TSN.induced_map A)", "by (rule TSN.induced_map_conservative_mpt, measurable)"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have *: \"\\<And> x y. snd (TA (x,y)) = snd (x,y) + TN.birkhoff_sum fN (TSN.return_time_function A (x,y)) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       snd (TA (x, y)) =\n       snd (x, y) + TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x", "unfolding TA_def TSN.induced_map_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       snd (((\\<lambda>(x, y). (TN x, y + fN x)) ^^\n             TSN.return_time_function A (x, y))\n             (x, y)) =\n       snd (x, y) + TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x", "using TN.skew_product_real_iterates Pair_def"], ["proof (prove)\nusing this:\n  ((\\<lambda>(x, y). (TN x, y + ?f x)) ^^ ?n) (?x, ?y) =\n  ((TN ^^ ?n) ?x, ?y + TN.birkhoff_sum ?f ?n ?x)\n  (?a, ?b) = Abs_prod (Pair_Rep ?a ?b)\n\ngoal (1 subgoal):\n 1. \\<And>x y.\n       snd (((\\<lambda>(x, y). (TN x, y + fN x)) ^^\n             TSN.return_time_function A (x, y))\n             (x, y)) =\n       snd (x, y) + TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x", "by auto"], ["proof (state)\nthis:\n  snd (TA (?x4, ?y4)) =\n  snd (?x4, ?y4) +\n  TN.birkhoff_sum fN (TSN.return_time_function A (?x4, ?y4)) ?x4\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have [measurable]: \"snd \\<in> borel_measurable ?MS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. snd \\<in> borel_measurable (M \\<Otimes>\\<^sub>M lborel)", "by auto"], ["proof (state)\nthis:\n  snd \\<in> borel_measurable (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  snd \\<in> borel_measurable (M \\<Otimes>\\<^sub>M lborel)", "have [measurable]: \"snd \\<in> borel_measurable MA\""], ["proof (prove)\nusing this:\n  snd \\<in> borel_measurable (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. snd \\<in> borel_measurable MA", "unfolding MA_def"], ["proof (prove)\nusing this:\n  snd \\<in> borel_measurable (M \\<Otimes>\\<^sub>M lborel)\n\ngoal (1 subgoal):\n 1. snd\n    \\<in> borel_measurable (restrict_space (M \\<Otimes>\\<^sub>M lborel) A)", "using measurable_restrict_space1"], ["proof (prove)\nusing this:\n  snd \\<in> borel_measurable (M \\<Otimes>\\<^sub>M lborel)\n  ?f \\<in> ?M \\<rightarrow>\\<^sub>M ?N \\<Longrightarrow>\n  ?f \\<in> restrict_space ?M ?\\<Omega> \\<rightarrow>\\<^sub>M ?N\n\ngoal (1 subgoal):\n 1. snd\n    \\<in> borel_measurable (restrict_space (M \\<Otimes>\\<^sub>M lborel) A)", "by blast"], ["proof (state)\nthis:\n  snd \\<in> borel_measurable MA\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"AE z in MA. z \\<in> TSN.recurrent_subset A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE z in MA. z \\<in> TSN.recurrent_subset A", "unfolding MA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE z in restrict_space (M \\<Otimes>\\<^sub>M lborel)\n             A. z \\<in> TSN.recurrent_subset A", "using TSN.induced_map_recurrent_typical(1)[OF A_meas]"], ["proof (prove)\nusing this:\n  AE z in restrict_space (M \\<Otimes>\\<^sub>M lborel)\n           A. z \\<in> TSN.recurrent_subset A\n\ngoal (1 subgoal):\n 1. AE z in restrict_space (M \\<Otimes>\\<^sub>M lborel)\n             A. z \\<in> TSN.recurrent_subset A", "."], ["proof (state)\nthis:\n  AE z in MA. z \\<in> TSN.recurrent_subset A\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "moreover"], ["proof (state)\nthis:\n  AE z in MA. z \\<in> TSN.recurrent_subset A\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "{"], ["proof (state)\nthis:\n  AE z in MA. z \\<in> TSN.recurrent_subset A\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "fix z"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "assume z: \"z \\<in> TSN.recurrent_subset A\""], ["proof (state)\nthis:\n  z \\<in> TSN.recurrent_subset A\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "define x y where \"x = fst z\" and \"y = snd z\""], ["proof (state)\nthis:\n  x = fst z\n  y = snd z\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  x = fst z\n  y = snd z", "have \"z = (x,y)\""], ["proof (prove)\nusing this:\n  x = fst z\n  y = snd z\n\ngoal (1 subgoal):\n 1. z = (x, y)", "by simp"], ["proof (state)\nthis:\n  z = (x, y)\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"z \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z \\<in> A", "using z \"TSN.recurrent_subset_incl\"(1)"], ["proof (prove)\nusing this:\n  z \\<in> TSN.recurrent_subset A\n  TSN.recurrent_subset ?A \\<subseteq> ?A\n\ngoal (1 subgoal):\n 1. z \\<in> A", "by auto"], ["proof (state)\nthis:\n  z \\<in> A\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  z \\<in> A", "have \"x \\<in> Ax\" \"y \\<in> {0..e/2}\""], ["proof (prove)\nusing this:\n  z \\<in> A\n\ngoal (1 subgoal):\n 1. x \\<in> Ax &&& y \\<in> {0..e / 2}", "unfolding A_def x_def y_def"], ["proof (prove)\nusing this:\n  z \\<in> Ax \\<times> {0..e / 2}\n\ngoal (1 subgoal):\n 1. fst z \\<in> Ax &&& snd z \\<in> {0..e / 2}", "by auto"], ["proof (state)\nthis:\n  x \\<in> Ax\n  y \\<in> {0..e / 2}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "define y2 where \"y2 = y + TN.birkhoff_sum fN (TSN.return_time_function A (x,y)) x\""], ["proof (state)\nthis:\n  y2 = y + TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"y2 = snd (TA z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y2 = snd (TA z)", "unfolding y2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. y + TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x =\n    snd (TA z)", "using * \\<open>z = (x, y)\\<close>"], ["proof (prove)\nusing this:\n  snd (TA (?x4, ?y4)) =\n  snd (?x4, ?y4) +\n  TN.birkhoff_sum fN (TSN.return_time_function A (?x4, ?y4)) ?x4\n  z = (x, y)\n\ngoal (1 subgoal):\n 1. y + TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x =\n    snd (TA z)", "by force"], ["proof (state)\nthis:\n  y2 = snd (TA z)\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "moreover"], ["proof (state)\nthis:\n  y2 = snd (TA z)\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"TA z \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. TA z \\<in> A", "unfolding TA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. TSN.induced_map A z \\<in> A", "using \\<open>z \\<in> A\\<close> TSN.induced_map_stabilizes_A"], ["proof (prove)\nusing this:\n  z \\<in> A\n  (?x \\<in> ?A) = (TSN.induced_map ?A ?x \\<in> ?A)\n\ngoal (1 subgoal):\n 1. TSN.induced_map A z \\<in> A", "by auto"], ["proof (state)\nthis:\n  TA z \\<in> A\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "ultimately"], ["proof (chain)\npicking this:\n  y2 = snd (TA z)\n  TA z \\<in> A", "have \"y2 \\<in> {0..e/2}\""], ["proof (prove)\nusing this:\n  y2 = snd (TA z)\n  TA z \\<in> A\n\ngoal (1 subgoal):\n 1. y2 \\<in> {0..e / 2}", "unfolding A_def"], ["proof (prove)\nusing this:\n  y2 = snd (TA z)\n  TA z \\<in> Ax \\<times> {0..e / 2}\n\ngoal (1 subgoal):\n 1. y2 \\<in> {0..e / 2}", "by auto"], ["proof (state)\nthis:\n  y2 \\<in> {0..e / 2}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"TSN.return_time_function A (x,y) \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. TSN.return_time_function A (x, y) \\<noteq> 0", "using \\<open>z = (x,y)\\<close> \\<open>z \\<in> TSN.recurrent_subset A\\<close> TSN.return_time0[of A]"], ["proof (prove)\nusing this:\n  z = (x, y)\n  z \\<in> TSN.recurrent_subset A\n  TSN.return_time_function A -` {0} = UNIV - TSN.recurrent_subset A\n\ngoal (1 subgoal):\n 1. TSN.return_time_function A (x, y) \\<noteq> 0", "by fast"], ["proof (state)\nthis:\n  TSN.return_time_function A (x, y) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  TSN.return_time_function A (x, y) \\<noteq> 0", "have \"TN.birkhoff_sum fN (TSN.return_time_function A (x,y)) x \\<notin> {0..e}\""], ["proof (prove)\nusing this:\n  TSN.return_time_function A (x, y) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<notin> {0..e}", "using not0e[OF \\<open>x \\<in> Ax\\<close>]"], ["proof (prove)\nusing this:\n  TSN.return_time_function A (x, y) \\<noteq> 0\n  ?n4 \\<noteq> 0 \\<Longrightarrow> TN.birkhoff_sum fN ?n4 x \\<notin> {0..e}\n\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<notin> {0..e}", "by auto"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<notin> {0..e}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "moreover"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<notin> {0..e}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"TN.birkhoff_sum fN (TSN.return_time_function A (x,y)) x \\<in> {-e..e}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..e}", "using \\<open>y \\<in> {0..e/2}\\<close> \\<open>y2 \\<in> {0..e/2}\\<close> y2_def"], ["proof (prove)\nusing this:\n  y \\<in> {0..e / 2}\n  y2 \\<in> {0..e / 2}\n  y2 = y + TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x\n\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..e}", "by auto"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..e}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "ultimately"], ["proof (chain)\npicking this:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<notin> {0..e}\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..e}", "have \"TN.birkhoff_sum fN (TSN.return_time_function A (x,y)) x \\<in> {-e..<0}\""], ["proof (prove)\nusing this:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<notin> {0..e}\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..e}\n\ngoal (1 subgoal):\n 1. TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..<0}", "by auto"], ["proof (state)\nthis:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..<0}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..<0}", "have \"y2 < y\""], ["proof (prove)\nusing this:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..<0}\n\ngoal (1 subgoal):\n 1. y2 < y", "using y2_def"], ["proof (prove)\nusing this:\n  TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x \\<in> {- e..<0}\n  y2 = y + TN.birkhoff_sum fN (TSN.return_time_function A (x, y)) x\n\ngoal (1 subgoal):\n 1. y2 < y", "by auto"], ["proof (state)\nthis:\n  y2 < y\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  y2 < y", "have \"snd(TA z) < snd z\""], ["proof (prove)\nusing this:\n  y2 < y\n\ngoal (1 subgoal):\n 1. snd (TA z) < snd z", "unfolding y_def"], ["proof (prove)\nusing this:\n  y2 < snd z\n\ngoal (1 subgoal):\n 1. snd (TA z) < snd z", "using \\<open>y2 = snd (TA z)\\<close>"], ["proof (prove)\nusing this:\n  y2 < snd z\n  y2 = snd (TA z)\n\ngoal (1 subgoal):\n 1. snd (TA z) < snd z", "by auto"], ["proof (state)\nthis:\n  snd (TA z) < snd z\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "}"], ["proof (state)\nthis:\n  ?z6 \\<in> TSN.recurrent_subset A \\<Longrightarrow> snd (TA ?z6) < snd ?z6\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "ultimately"], ["proof (chain)\npicking this:\n  AE z in MA. z \\<in> TSN.recurrent_subset A\n  ?z6 \\<in> TSN.recurrent_subset A \\<Longrightarrow> snd (TA ?z6) < snd ?z6", "have a: \"AE z in MA. snd(TA z) < snd z\""], ["proof (prove)\nusing this:\n  AE z in MA. z \\<in> TSN.recurrent_subset A\n  ?z6 \\<in> TSN.recurrent_subset A \\<Longrightarrow> snd (TA ?z6) < snd ?z6\n\ngoal (1 subgoal):\n 1. AE z in MA. snd (TA z) < snd z", "by auto"], ["proof (state)\nthis:\n  AE z in MA. snd (TA z) < snd z\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  AE z in MA. snd (TA z) < snd z", "have \"AE z in MA. snd(TA z) \\<le> snd z\""], ["proof (prove)\nusing this:\n  AE z in MA. snd (TA z) < snd z\n\ngoal (1 subgoal):\n 1. AE z in MA. snd (TA z) \\<le> snd z", "by auto"], ["proof (state)\nthis:\n  AE z in MA. snd (TA z) \\<le> snd z\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  AE z in MA. snd (TA z) \\<le> snd z", "have \"AE z in MA. snd(TA z) = snd z\""], ["proof (prove)\nusing this:\n  AE z in MA. snd (TA z) \\<le> snd z\n\ngoal (1 subgoal):\n 1. AE z in MA. snd (TA z) = snd z", "using TA.AE_decreasing_then_invariant[of snd]"], ["proof (prove)\nusing this:\n  AE z in MA. snd (TA z) \\<le> snd z\n  \\<lbrakk>AE x in MA. snd (TA x) \\<le> snd x;\n   snd \\<in> borel_measurable MA\\<rbrakk>\n  \\<Longrightarrow> AE x in MA. snd (TA x) = snd x\n\ngoal (1 subgoal):\n 1. AE z in MA. snd (TA z) = snd z", "by auto"], ["proof (state)\nthis:\n  AE z in MA. snd (TA z) = snd z\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  AE z in MA. snd (TA z) = snd z", "have \"AE z in MA. False\""], ["proof (prove)\nusing this:\n  AE z in MA. snd (TA z) = snd z\n\ngoal (1 subgoal):\n 1. AE z in MA. False", "using a"], ["proof (prove)\nusing this:\n  AE z in MA. snd (TA z) = snd z\n  AE z in MA. snd (TA z) < snd z\n\ngoal (1 subgoal):\n 1. AE z in MA. False", "by auto"], ["proof (state)\nthis:\n  AE z in MA. False\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  AE z in MA. False", "have \"space MA \\<in> null_sets MA\""], ["proof (prove)\nusing this:\n  AE z in MA. False\n\ngoal (1 subgoal):\n 1. space MA \\<in> null_sets MA", "by (simp add: AE_iff_null_sets)"], ["proof (state)\nthis:\n  space MA \\<in> null_sets MA\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  space MA \\<in> null_sets MA", "have \"emeasure MA A = 0\""], ["proof (prove)\nusing this:\n  space MA \\<in> null_sets MA\n\ngoal (1 subgoal):\n 1. emeasure MA A = 0", "by (metis A_meas MA_def null_setsD1 space_restrict_space2)"], ["proof (state)\nthis:\n  emeasure MA A = 0\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  emeasure MA A = 0", "have \"emeasure ?MS A = 0\""], ["proof (prove)\nusing this:\n  emeasure MA A = 0\n\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel) A = 0", "unfolding MA_def"], ["proof (prove)\nusing this:\n  emeasure (restrict_space (M \\<Otimes>\\<^sub>M lborel) A) A = 0\n\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel) A = 0", "by (metis A_meas emeasure_restrict_space sets.sets_into_space sets.top space_restrict_space space_restrict_space2)"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A = 0\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "moreover"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A = 0\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"emeasure ?MS A = emeasure M Ax * emeasure lborel {0..e/2}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel) A =\n    emeasure M Ax * emeasure lborel {0..e / 2}", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (M \\<Otimes>\\<^sub>M lborel) (Ax \\<times> {0..e / 2}) =\n    emeasure M Ax * emeasure lborel {0..e / 2}", "by (intro lborel.emeasure_pair_measure_Times) auto"], ["proof (state)\nthis:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A =\n  emeasure M Ax * emeasure lborel {0..e / 2}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "ultimately"], ["proof (chain)\npicking this:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A = 0\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A =\n  emeasure M Ax * emeasure lborel {0..e / 2}", "have \"emeasure M {x \\<in> space M. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}} = 0\""], ["proof (prove)\nusing this:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A = 0\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A =\n  emeasure M Ax * emeasure lborel {0..e / 2}\n\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}} =\n    0", "using \\<open>e>0\\<close> Ax_def"], ["proof (prove)\nusing this:\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A = 0\n  emeasure (M \\<Otimes>\\<^sub>M lborel) A =\n  emeasure M Ax * emeasure lborel {0..e / 2}\n  0 < e\n  Ax =\n  {x \\<in> space M.\n   \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\n\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}} =\n    0", "by simp"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}} =\n  0\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}} =\n  0", "have \"{x \\<in> space M. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}} \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}} =\n  0\n\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\n    \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  {x \\<in> space M.\n   \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}\n  \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "}"], ["proof (state)\nthis:\n  0 < ?N6 \\<Longrightarrow>\n  {x \\<in> space M.\n   \\<forall>n\\<in>{?N6..}. birkhoff_sum f n x \\<notin> {0..e}}\n  \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "then"], ["proof (chain)\npicking this:\n  0 < ?N6 \\<Longrightarrow>\n  {x \\<in> space M.\n   \\<forall>n\\<in>{?N6..}. birkhoff_sum f n x \\<notin> {0..e}}\n  \\<in> null_sets M", "have \"(\\<Union>N\\<in>{0<..}. {x \\<in> space M. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}}) \\<in> null_sets M\""], ["proof (prove)\nusing this:\n  0 < ?N6 \\<Longrightarrow>\n  {x \\<in> space M.\n   \\<forall>n\\<in>{?N6..}. birkhoff_sum f n x \\<notin> {0..e}}\n  \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. (\\<Union>N\\<in>{0<..}.\n        {x \\<in> space M.\n         \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\n    \\<in> null_sets M", "by (auto simp: greaterThan_0)"], ["proof (state)\nthis:\n  (\\<Union>N\\<in>{0<..}.\n      {x \\<in> space M.\n       \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\n  \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "moreover"], ["proof (state)\nthis:\n  (\\<Union>N\\<in>{0<..}.\n      {x \\<in> space M.\n       \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\n  \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"{x \\<in> space M. \\<not>(infinite {n. birkhoff_sum f n x \\<in> {0..e}})} \\<subseteq> (\\<Union>N\\<in>{0<..}. {x \\<in> space M. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M. \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}\n    \\<subseteq> (\\<Union>N\\<in>{0<..}.\n                    {x \\<in> space M.\n                     \\<forall>n\\<in>{N..}.\n                        birkhoff_sum f n x \\<notin> {0..e}})", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "assume H: \"x \\<in> {x \\<in> space M. \\<not>(infinite {n. birkhoff_sum f n x \\<in> {0..e}})}\""], ["proof (state)\nthis:\n  x \\<in> {x \\<in> space M.\n           \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "then"], ["proof (chain)\npicking this:\n  x \\<in> {x \\<in> space M.\n           \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}", "have \"x \\<in> space M\""], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "by auto"], ["proof (state)\nthis:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "have *: \"finite {n. birkhoff_sum f n x \\<in> {0..e}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {n. birkhoff_sum f n x \\<in> {0..e}}", "using H"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}\n\ngoal (1 subgoal):\n 1. finite {n. birkhoff_sum f n x \\<in> {0..e}}", "by auto"], ["proof (state)\nthis:\n  finite {n. birkhoff_sum f n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "then"], ["proof (chain)\npicking this:\n  finite {n. birkhoff_sum f n x \\<in> {0..e}}", "obtain N where \"\\<And>n. n \\<ge> N \\<Longrightarrow> n \\<notin> {n. birkhoff_sum f n x \\<in> {0..e}}\""], ["proof (prove)\nusing this:\n  finite {n. birkhoff_sum f n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n.\n            N \\<le> n \\<Longrightarrow>\n            n \\<notin> {n. birkhoff_sum f n x\n                           \\<in> {0..e}}) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (metis finite_nat_set_iff_bounded not_less)"], ["proof (state)\nthis:\n  N \\<le> ?n4 \\<Longrightarrow>\n  ?n4 \\<notin> {n. birkhoff_sum f n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "then"], ["proof (chain)\npicking this:\n  N \\<le> ?n4 \\<Longrightarrow>\n  ?n4 \\<notin> {n. birkhoff_sum f n x \\<in> {0..e}}", "have \"x \\<in> {x \\<in> space M. \\<forall>n\\<in>{N+1..}. birkhoff_sum f n x \\<notin> {0..e}}\""], ["proof (prove)\nusing this:\n  N \\<le> ?n4 \\<Longrightarrow>\n  ?n4 \\<notin> {n. birkhoff_sum f n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> space M.\n             \\<forall>n\\<in>{N + 1..}. birkhoff_sum f n x \\<notin> {0..e}}", "using \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  N \\<le> ?n4 \\<Longrightarrow>\n  ?n4 \\<notin> {n. birkhoff_sum f n x \\<in> {0..e}}\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> space M.\n             \\<forall>n\\<in>{N + 1..}. birkhoff_sum f n x \\<notin> {0..e}}", "by auto"], ["proof (state)\nthis:\n  x \\<in> {x \\<in> space M.\n           \\<forall>n\\<in>{N + 1..}. birkhoff_sum f n x \\<notin> {0..e}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "moreover"], ["proof (state)\nthis:\n  x \\<in> {x \\<in> space M.\n           \\<forall>n\\<in>{N + 1..}. birkhoff_sum f n x \\<notin> {0..e}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "have \"N+1>0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < N + 1", "by auto"], ["proof (state)\nthis:\n  0 < N + 1\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                \\<not> infinite\n                        {n. birkhoff_sum f n x\n                            \\<in> {0..e}}} \\<Longrightarrow>\n       x \\<in> (\\<Union>N\\<in>{0<..}.\n                   {x \\<in> space M.\n                    \\<forall>n\\<in>{N..}.\n                       birkhoff_sum f n x \\<notin> {0..e}})", "ultimately"], ["proof (chain)\npicking this:\n  x \\<in> {x \\<in> space M.\n           \\<forall>n\\<in>{N + 1..}. birkhoff_sum f n x \\<notin> {0..e}}\n  0 < N + 1", "show \"x \\<in> (\\<Union>N\\<in>{0<..}. {x \\<in> space M. \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\""], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           \\<forall>n\\<in>{N + 1..}. birkhoff_sum f n x \\<notin> {0..e}}\n  0 < N + 1\n\ngoal (1 subgoal):\n 1. x \\<in> (\\<Union>N\\<in>{0<..}.\n                {x \\<in> space M.\n                 \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})", "by auto"], ["proof (state)\nthis:\n  x \\<in> (\\<Union>N\\<in>{0<..}.\n              {x \\<in> space M.\n               \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  {x \\<in> space M. \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}\n  \\<subseteq> (\\<Union>N\\<in>{0<..}.\n                  {x \\<in> space M.\n                   \\<forall>n\\<in>{N..}.\n                      birkhoff_sum f n x \\<notin> {0..e}})\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Union>N\\<in>{0<..}.\n      {x \\<in> space M.\n       \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\n  \\<in> null_sets M\n  {x \\<in> space M. \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}\n  \\<subseteq> (\\<Union>N\\<in>{0<..}.\n                  {x \\<in> space M.\n                   \\<forall>n\\<in>{N..}.\n                      birkhoff_sum f n x \\<notin> {0..e}})", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Union>N\\<in>{0<..}.\n      {x \\<in> space M.\n       \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\n  \\<in> null_sets M\n  {x \\<in> space M. \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}\n  \\<subseteq> (\\<Union>N\\<in>{0<..}.\n                  {x \\<in> space M.\n                   \\<forall>n\\<in>{N..}.\n                      birkhoff_sum f n x \\<notin> {0..e}})\n\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}", "unfolding eventually_ae_filter"], ["proof (prove)\nusing this:\n  (\\<Union>N\\<in>{0<..}.\n      {x \\<in> space M.\n       \\<forall>n\\<in>{N..}. birkhoff_sum f n x \\<notin> {0..e}})\n  \\<in> null_sets M\n  {x \\<in> space M. \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}}\n  \\<subseteq> (\\<Union>N\\<in>{0<..}.\n                  {x \\<in> space M.\n                   \\<forall>n\\<in>{N..}.\n                      birkhoff_sum f n x \\<notin> {0..e}})\n\ngoal (1 subgoal):\n 1. Bex (null_sets M)\n     ((\\<subseteq>)\n       {x \\<in> space M.\n        \\<not> infinite {n. birkhoff_sum f n x \\<in> {0..e}}})", "by auto"], ["proof (state)\nthis:\n  AE x in M. infinite {n. birkhoff_sum f n x \\<in> {0..e}}\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem birkhoff_sum_small_asymp_pos_nonergodic:\n  assumes [measurable]: \"integrable M f\" and \"e > (0::real)\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x .. n * real_cond_exp M Invariants f x + e}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "define g where \"g = (\\<lambda>x. f x - real_cond_exp M Invariants f x)\""], ["proof (state)\nthis:\n  g = (\\<lambda>x. f x - real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "have g_meas [measurable]: \"integrable M g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M g", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. f x - real_cond_exp M Invariants f x)", "using real_cond_exp_int(1)[OF assms(1)] assms(1)"], ["proof (prove)\nusing this:\n  integrable M (real_cond_exp M Invariants f)\n  integrable M f\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. f x - real_cond_exp M Invariants f x)", "by auto"], ["proof (state)\nthis:\n  integrable M g\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "have \"AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x = real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n               real_cond_exp M Invariants f x", "by (rule real_cond_exp_F_meas, auto simp add: real_cond_exp_int(1)[OF assms(1)])"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "then"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x", "have *: \"AE x in M. real_cond_exp M Invariants g x = 0\""], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants g x = 0", "unfolding g_def"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants\n                (\\<lambda>x. f x - real_cond_exp M Invariants f x) x =\n               0", "using real_cond_exp_diff[OF assms(1) real_cond_exp_int(1)[OF assms(1)]]"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n  AE x in M. real_cond_exp M Invariants\n              (\\<lambda>x. f x - real_cond_exp M Invariants f x) x =\n             real_cond_exp M Invariants f x -\n             real_cond_exp M Invariants (real_cond_exp M Invariants f) x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants\n                (\\<lambda>x. f x - real_cond_exp M Invariants f x) x =\n               0", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants g x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "have \"AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}", "by (rule birkhoff_sum_small_asymp_lemma, auto simp add: \\<open>e>0\\<close> * g_meas)"], ["proof (state)\nthis:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "moreover"], ["proof (state)\nthis:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "{"], ["proof (state)\nthis:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "assume \"x \\<in> space M\" \"infinite {n. birkhoff_sum g n x \\<in> {0..e}}\""], ["proof (state)\nthis:\n  x \\<in> space M\n  infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "{"], ["proof (state)\nthis:\n  x \\<in> space M\n  infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "assume H: \"birkhoff_sum g n x \\<in> {0..e}\""], ["proof (state)\nthis:\n  birkhoff_sum g n x \\<in> {0..e}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "have \"birkhoff_sum g n x = birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum g n x =\n    birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. f x - real_cond_exp M Invariants f x) n x =\n    birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x", "using birkhoff_sum_diff"], ["proof (prove)\nusing this:\n  birkhoff_sum (\\<lambda>x. ?f x - ?g x) ?n ?x =\n  birkhoff_sum ?f ?n ?x - birkhoff_sum ?g ?n ?x\n\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. f x - real_cond_exp M Invariants f x) n x =\n    birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "also"], ["proof (state)\nthis:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "have \"... = birkhoff_sum f n x - n * real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x =\n    birkhoff_sum f n x - real n * real_cond_exp M Invariants f x", "using birkhoff_sum_of_invariants \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>?f \\<in> borel_measurable Invariants; ?x \\<in> space M\\<rbrakk>\n  \\<Longrightarrow> birkhoff_sum ?f ?n ?x = real ?n * ?f ?x\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x =\n    birkhoff_sum f n x - real n * real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum f n x - birkhoff_sum (real_cond_exp M Invariants f) n x =\n  birkhoff_sum f n x - real n * real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "finally"], ["proof (chain)\npicking this:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - real n * real_cond_exp M Invariants f x", "have \"birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x .. n * real_cond_exp M Invariants f x + e}\""], ["proof (prove)\nusing this:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - real n * real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x\n    \\<in> {real n *\n           real_cond_exp M Invariants f\n            x..real n * real_cond_exp M Invariants f x + e}", "using H"], ["proof (prove)\nusing this:\n  birkhoff_sum g n x =\n  birkhoff_sum f n x - real n * real_cond_exp M Invariants f x\n  birkhoff_sum g n x \\<in> {0..e}\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x\n    \\<in> {real n *\n           real_cond_exp M Invariants f\n            x..real n * real_cond_exp M Invariants f x + e}", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum f n x\n  \\<in> {real n *\n         real_cond_exp M Invariants f\n          x..real n * real_cond_exp M Invariants f x + e}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "}"], ["proof (state)\nthis:\n  birkhoff_sum g ?n5 x \\<in> {0..e} \\<Longrightarrow>\n  birkhoff_sum f ?n5 x\n  \\<in> {real ?n5 *\n         real_cond_exp M Invariants f\n          x..real ?n5 * real_cond_exp M Invariants f x + e}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum g ?n5 x \\<in> {0..e} \\<Longrightarrow>\n  birkhoff_sum f ?n5 x\n  \\<in> {real ?n5 *\n         real_cond_exp M Invariants f\n          x..real ?n5 * real_cond_exp M Invariants f x + e}", "have \"{n. birkhoff_sum g n x \\<in> {0..e}} \\<subseteq> {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x .. n * real_cond_exp M Invariants f x + e}}\""], ["proof (prove)\nusing this:\n  birkhoff_sum g ?n5 x \\<in> {0..e} \\<Longrightarrow>\n  birkhoff_sum f ?n5 x\n  \\<in> {real ?n5 *\n         real_cond_exp M Invariants f\n          x..real ?n5 * real_cond_exp M Invariants f x + e}\n\ngoal (1 subgoal):\n 1. {n. birkhoff_sum g n x \\<in> {0..e}}\n    \\<subseteq> {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "by auto"], ["proof (state)\nthis:\n  {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<subseteq> {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "then"], ["proof (chain)\npicking this:\n  {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<subseteq> {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}", "have \"infinite {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x .. n * real_cond_exp M Invariants f x + e}}\""], ["proof (prove)\nusing this:\n  {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<subseteq> {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n\ngoal (1 subgoal):\n 1. infinite\n     {n. birkhoff_sum f n x\n         \\<in> {real n *\n                real_cond_exp M Invariants f\n                 x..real n * real_cond_exp M Invariants f x + e}}", "using \\<open>infinite {n. birkhoff_sum g n x \\<in> {0..e}}\\<close> finite_subset"], ["proof (prove)\nusing this:\n  {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<subseteq> {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n  infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<lbrakk>?A \\<subseteq> ?B; finite ?B\\<rbrakk> \\<Longrightarrow> finite ?A\n\ngoal (1 subgoal):\n 1. infinite\n     {n. birkhoff_sum f n x\n         \\<in> {real n *\n                real_cond_exp M Invariants f\n                 x..real n * real_cond_exp M Invariants f x + e}}", "by blast"], ["proof (state)\nthis:\n  infinite\n   {n. birkhoff_sum f n x\n       \\<in> {real n *\n              real_cond_exp M Invariants f\n               x..real n * real_cond_exp M Invariants f x + e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?x5 \\<in> space M;\n   infinite {n. birkhoff_sum g n ?x5 \\<in> {0..e}}\\<rbrakk>\n  \\<Longrightarrow> infinite\n                     {n. birkhoff_sum f n ?x5\n                         \\<in> {real n *\n                                real_cond_exp M Invariants f\n                                 ?x5..real n *\nreal_cond_exp M Invariants f ?x5 +\ne}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<lbrakk>?x5 \\<in> space M;\n   infinite {n. birkhoff_sum g n ?x5 \\<in> {0..e}}\\<rbrakk>\n  \\<Longrightarrow> infinite\n                     {n. birkhoff_sum f n ?x5\n                         \\<in> {real n *\n                                real_cond_exp M Invariants f\n                                 ?x5..real n *\nreal_cond_exp M Invariants f ?x5 +\ne}}", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<lbrakk>?x5 \\<in> space M;\n   infinite {n. birkhoff_sum g n ?x5 \\<in> {0..e}}\\<rbrakk>\n  \\<Longrightarrow> infinite\n                     {n. birkhoff_sum f n ?x5\n                         \\<in> {real n *\n                                real_cond_exp M Invariants f\n                                 ?x5..real n *\nreal_cond_exp M Invariants f ?x5 +\ne}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n *\n                           real_cond_exp M Invariants f\n                            x..real n * real_cond_exp M Invariants f x + e}}", "by auto"], ["proof (state)\nthis:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n *\n                         real_cond_exp M Invariants f\n                          x..real n * real_cond_exp M Invariants f x + e}}\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem birkhoff_sum_small_asymp_neg_nonergodic:\n  assumes [measurable]: \"integrable M f\" and \"e > (0::real)\"\n  shows \"AE x in M. infinite {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x - e .. n * real_cond_exp M Invariants f x}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "define g where \"g = (\\<lambda>x. real_cond_exp M Invariants f x - f x)\""], ["proof (state)\nthis:\n  g = (\\<lambda>x. real_cond_exp M Invariants f x - f x)\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "have g_meas [measurable]: \"integrable M g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M g", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. real_cond_exp M Invariants f x - f x)", "using real_cond_exp_int(1)[OF assms(1)] assms(1)"], ["proof (prove)\nusing this:\n  integrable M (real_cond_exp M Invariants f)\n  integrable M f\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. real_cond_exp M Invariants f x - f x)", "by auto"], ["proof (state)\nthis:\n  integrable M g\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "have \"AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x = real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n               real_cond_exp M Invariants f x", "by (rule real_cond_exp_F_meas, auto simp add: real_cond_exp_int(1)[OF assms(1)])"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "then"], ["proof (chain)\npicking this:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x", "have *: \"AE x in M. real_cond_exp M Invariants g x = 0\""], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants g x = 0", "unfolding g_def"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants\n                (\\<lambda>x. real_cond_exp M Invariants f x - f x) x =\n               0", "using real_cond_exp_diff[OF real_cond_exp_int(1)[OF assms(1)] assms(1)]"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants (real_cond_exp M Invariants f) x =\n             real_cond_exp M Invariants f x\n  AE x in M. real_cond_exp M Invariants\n              (\\<lambda>x. real_cond_exp M Invariants f x - f x) x =\n             real_cond_exp M Invariants (real_cond_exp M Invariants f) x -\n             real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants\n                (\\<lambda>x. real_cond_exp M Invariants f x - f x) x =\n               0", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants g x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "have \"AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}", "by (rule birkhoff_sum_small_asymp_lemma, auto simp add: \\<open>e>0\\<close> * g_meas)"], ["proof (state)\nthis:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "moreover"], ["proof (state)\nthis:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "{"], ["proof (state)\nthis:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "assume \"x \\<in> space M\" \"infinite {n. birkhoff_sum g n x \\<in> {0..e}}\""], ["proof (state)\nthis:\n  x \\<in> space M\n  infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "{"], ["proof (state)\nthis:\n  x \\<in> space M\n  infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "assume H: \"birkhoff_sum g n x \\<in> {0..e}\""], ["proof (state)\nthis:\n  birkhoff_sum g n x \\<in> {0..e}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "have \"birkhoff_sum g n x = birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum g n x =\n    birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. real_cond_exp M Invariants f x - f x) n x =\n    birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x", "using birkhoff_sum_diff"], ["proof (prove)\nusing this:\n  birkhoff_sum (\\<lambda>x. ?f x - ?g x) ?n ?x =\n  birkhoff_sum ?f ?n ?x - birkhoff_sum ?g ?n ?x\n\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. real_cond_exp M Invariants f x - f x) n x =\n    birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum g n x =\n  birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "also"], ["proof (state)\nthis:\n  birkhoff_sum g n x =\n  birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "have \"... = n * real_cond_exp M Invariants f x - birkhoff_sum f n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x =\n    real n * real_cond_exp M Invariants f x - birkhoff_sum f n x", "using birkhoff_sum_of_invariants \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>?f \\<in> borel_measurable Invariants; ?x \\<in> space M\\<rbrakk>\n  \\<Longrightarrow> birkhoff_sum ?f ?n ?x = real ?n * ?f ?x\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x =\n    real n * real_cond_exp M Invariants f x - birkhoff_sum f n x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum (real_cond_exp M Invariants f) n x - birkhoff_sum f n x =\n  real n * real_cond_exp M Invariants f x - birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "finally"], ["proof (chain)\npicking this:\n  birkhoff_sum g n x =\n  real n * real_cond_exp M Invariants f x - birkhoff_sum f n x", "have \"birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x - e .. n * real_cond_exp M Invariants f x}\""], ["proof (prove)\nusing this:\n  birkhoff_sum g n x =\n  real n * real_cond_exp M Invariants f x - birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x\n    \\<in> {real n * real_cond_exp M Invariants f x -\n           e..real n * real_cond_exp M Invariants f x}", "using H"], ["proof (prove)\nusing this:\n  birkhoff_sum g n x =\n  real n * real_cond_exp M Invariants f x - birkhoff_sum f n x\n  birkhoff_sum g n x \\<in> {0..e}\n\ngoal (1 subgoal):\n 1. birkhoff_sum f n x\n    \\<in> {real n * real_cond_exp M Invariants f x -\n           e..real n * real_cond_exp M Invariants f x}", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum f n x\n  \\<in> {real n * real_cond_exp M Invariants f x -\n         e..real n * real_cond_exp M Invariants f x}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "}"], ["proof (state)\nthis:\n  birkhoff_sum g ?n5 x \\<in> {0..e} \\<Longrightarrow>\n  birkhoff_sum f ?n5 x\n  \\<in> {real ?n5 * real_cond_exp M Invariants f x -\n         e..real ?n5 * real_cond_exp M Invariants f x}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum g ?n5 x \\<in> {0..e} \\<Longrightarrow>\n  birkhoff_sum f ?n5 x\n  \\<in> {real ?n5 * real_cond_exp M Invariants f x -\n         e..real ?n5 * real_cond_exp M Invariants f x}", "have \"{n. birkhoff_sum g n x \\<in> {0..e}} \\<subseteq> {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x - e .. n * real_cond_exp M Invariants f x}}\""], ["proof (prove)\nusing this:\n  birkhoff_sum g ?n5 x \\<in> {0..e} \\<Longrightarrow>\n  birkhoff_sum f ?n5 x\n  \\<in> {real ?n5 * real_cond_exp M Invariants f x -\n         e..real ?n5 * real_cond_exp M Invariants f x}\n\ngoal (1 subgoal):\n 1. {n. birkhoff_sum g n x \\<in> {0..e}}\n    \\<subseteq> {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "by auto"], ["proof (state)\nthis:\n  {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<subseteq> {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "then"], ["proof (chain)\npicking this:\n  {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<subseteq> {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}", "have \"infinite {n. birkhoff_sum f n x \\<in> {n * real_cond_exp M Invariants f x - e .. n * real_cond_exp M Invariants f x}}\""], ["proof (prove)\nusing this:\n  {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<subseteq> {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n\ngoal (1 subgoal):\n 1. infinite\n     {n. birkhoff_sum f n x\n         \\<in> {real n * real_cond_exp M Invariants f x -\n                e..real n * real_cond_exp M Invariants f x}}", "using \\<open>infinite {n. birkhoff_sum g n x \\<in> {0..e}}\\<close> finite_subset"], ["proof (prove)\nusing this:\n  {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<subseteq> {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n  infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<lbrakk>?A \\<subseteq> ?B; finite ?B\\<rbrakk> \\<Longrightarrow> finite ?A\n\ngoal (1 subgoal):\n 1. infinite\n     {n. birkhoff_sum f n x\n         \\<in> {real n * real_cond_exp M Invariants f x -\n                e..real n * real_cond_exp M Invariants f x}}", "by blast"], ["proof (state)\nthis:\n  infinite\n   {n. birkhoff_sum f n x\n       \\<in> {real n * real_cond_exp M Invariants f x -\n              e..real n * real_cond_exp M Invariants f x}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?x5 \\<in> space M;\n   infinite {n. birkhoff_sum g n ?x5 \\<in> {0..e}}\\<rbrakk>\n  \\<Longrightarrow> infinite\n                     {n. birkhoff_sum f n ?x5\n                         \\<in> {real n * real_cond_exp M Invariants f ?x5 -\n                                e..real n *\n                                   real_cond_exp M Invariants f ?x5}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<lbrakk>?x5 \\<in> space M;\n   infinite {n. birkhoff_sum g n ?x5 \\<in> {0..e}}\\<rbrakk>\n  \\<Longrightarrow> infinite\n                     {n. birkhoff_sum f n ?x5\n                         \\<in> {real n * real_cond_exp M Invariants f ?x5 -\n                                e..real n *\n                                   real_cond_exp M Invariants f ?x5}}", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. infinite {n. birkhoff_sum g n x \\<in> {0..e}}\n  \\<lbrakk>?x5 \\<in> space M;\n   infinite {n. birkhoff_sum g n ?x5 \\<in> {0..e}}\\<rbrakk>\n  \\<Longrightarrow> infinite\n                     {n. birkhoff_sum f n ?x5\n                         \\<in> {real n * real_cond_exp M Invariants f ?x5 -\n                                e..real n *\n                                   real_cond_exp M Invariants f ?x5}}\n\ngoal (1 subgoal):\n 1. AE x in M. infinite\n                {n. birkhoff_sum f n x\n                    \\<in> {real n * real_cond_exp M Invariants f x -\n                           e..real n * real_cond_exp M Invariants f x}}", "by auto"], ["proof (state)\nthis:\n  AE x in M. infinite\n              {n. birkhoff_sum f n x\n                  \\<in> {real n * real_cond_exp M Invariants f x -\n                         e..real n * real_cond_exp M Invariants f x}}\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Conditional expectation for the induced map\\<close>"], ["", "text \\<open>Thanks to Birkhoff theorem, one can relate conditional expectations with respect to the invariant\nsigma algebra, for a map and for a corresponding induced map, as follows.\\<close>"], ["", "proposition Invariants_cond_exp_induced_map:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"A \\<in> sets M\" \"integrable M f\"\n  defines \"MA \\<equiv> restrict_space M A\" and \"TA \\<equiv> induced_map A\" and \"fA \\<equiv> induced_function A f\"\n  shows \"AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x\n      = real_cond_exp M Invariants f x * real_cond_exp MA (qmpt.Invariants MA TA) (return_time_function A) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA (qmpt.Invariants MA TA)\n                 (\\<lambda>x. real (return_time_function A x)) x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA (qmpt.Invariants MA TA)\n                 (\\<lambda>x. real (return_time_function A x)) x", "interpret A: fmpt MA TA"], ["proof (prove)\ngoal (1 subgoal):\n 1. fmpt MA TA", "unfolding MA_def TA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. fmpt (restrict_space M A) (induced_map A)", "by (rule induced_map_fmpt[OF assms(1)])"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"integrable M fA\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M fA", "unfolding fA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (induced_function A f)", "using induced_function_integral_nonergodic(1) assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>?A \\<in> sets M; integrable M ?f\\<rbrakk>\n  \\<Longrightarrow> integrable M (induced_function ?A ?f)\n  A \\<in> sets M\n  integrable M f\n  MA \\<equiv> restrict_space M A\n  TA \\<equiv> induced_map A\n  fA \\<equiv> induced_function A f\n\ngoal (1 subgoal):\n 1. integrable M (induced_function A f)", "by auto"], ["proof (state)\nthis:\n  integrable M fA\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  integrable M fA", "have \"integrable MA fA\""], ["proof (prove)\nusing this:\n  integrable M fA\n\ngoal (1 subgoal):\n 1. integrable MA fA", "unfolding MA_def"], ["proof (prove)\nusing this:\n  integrable M fA\n\ngoal (1 subgoal):\n 1. integrable (restrict_space M A) fA", "by (metis assms(1) integrable_mult_indicator integrable_restrict_space sets.Int_space_eq2)"], ["proof (state)\nthis:\n  integrable MA fA\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  integrable MA fA", "have a: \"AE x in MA. (\\<lambda>n. A.birkhoff_sum fA n x / n) \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x\""], ["proof (prove)\nusing this:\n  integrable MA fA\n\ngoal (1 subgoal):\n 1. AE x in MA. (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n                \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x", "using A.birkhoff_theorem_AE_nonergodic"], ["proof (prove)\nusing this:\n  integrable MA fA\n  integrable MA ?f \\<Longrightarrow>\n  AE x in MA. (\\<lambda>n. A.birkhoff_sum ?f n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp MA A.Invariants ?f x\n\ngoal (1 subgoal):\n 1. AE x in MA. (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n                \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x", "by auto"], ["proof (state)\nthis:\n  AE x in MA. (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"AE x in M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "using birkhoff_theorem_AE_nonergodic assms(2)"], ["proof (prove)\nusing this:\n  integrable M ?f \\<Longrightarrow>\n  AE x in M. (\\<lambda>n. birkhoff_sum ?f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants ?f x\n  integrable M f\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "have b: \"AE x in MA. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in MA. (\\<lambda>n. birkhoff_sum f n x / real n)\n                \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "unfolding MA_def"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in restrict_space M\n             A. (\\<lambda>n. birkhoff_sum f n x / real n)\n                \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "by (metis (mono_tags, lifting) AE_restrict_space_iff assms(1) eventually_mono sets.Int_space_eq2)"], ["proof (state)\nthis:\n  AE x in MA. (\\<lambda>n. birkhoff_sum f n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "define phiA where \"phiA = (\\<lambda>x. return_time_function A x)\""], ["proof (state)\nthis:\n  phiA = return_time_function A\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"integrable M phiA\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. real (phiA x))", "unfolding phiA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. real (return_time_function A x))", "using return_time_integrable"], ["proof (prove)\nusing this:\n  ?A \\<in> sets M \\<Longrightarrow>\n  integrable M (\\<lambda>x. real (return_time_function ?A x))\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. real (return_time_function A x))", "by auto"], ["proof (state)\nthis:\n  integrable M (\\<lambda>x. real (phiA x))\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  integrable M (\\<lambda>x. real (phiA x))", "have \"integrable MA phiA\""], ["proof (prove)\nusing this:\n  integrable M (\\<lambda>x. real (phiA x))\n\ngoal (1 subgoal):\n 1. integrable MA (\\<lambda>x. real (phiA x))", "unfolding MA_def"], ["proof (prove)\nusing this:\n  integrable M (\\<lambda>x. real (phiA x))\n\ngoal (1 subgoal):\n 1. integrable (restrict_space M A) (\\<lambda>x. real (phiA x))", "by (metis assms(1) integrable_mult_indicator integrable_restrict_space sets.Int_space_eq2)"], ["proof (state)\nthis:\n  integrable MA (\\<lambda>x. real (phiA x))\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  integrable MA (\\<lambda>x. real (phiA x))", "have c: \"AE x in MA. (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real(phiA x)) n x / n) \\<longlonglongrightarrow> real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\nusing this:\n  integrable MA (\\<lambda>x. real (phiA x))\n\ngoal (1 subgoal):\n 1. AE x in MA. (\\<lambda>n.\n                    A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n                \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n     (\\<lambda>x. real (phiA x)) x", "using A.birkhoff_theorem_AE_nonergodic"], ["proof (prove)\nusing this:\n  integrable MA (\\<lambda>x. real (phiA x))\n  integrable MA ?f \\<Longrightarrow>\n  AE x in MA. (\\<lambda>n. A.birkhoff_sum ?f n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp MA A.Invariants ?f x\n\ngoal (1 subgoal):\n 1. AE x in MA. (\\<lambda>n.\n                    A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n                \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n     (\\<lambda>x. real (phiA x)) x", "by auto"], ["proof (state)\nthis:\n  AE x in MA. (\\<lambda>n.\n                  A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n   (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"A-recurrent_subset A \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A - recurrent_subset A \\<in> null_sets M", "using Poincare_recurrence_thm(1)[OF assms(1)]"], ["proof (prove)\nusing this:\n  A - recurrent_subset A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A - recurrent_subset A \\<in> null_sets M", "by auto"], ["proof (state)\nthis:\n  A - recurrent_subset A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  A - recurrent_subset A \\<in> null_sets M", "have \"A - recurrent_subset A \\<in> null_sets MA\""], ["proof (prove)\nusing this:\n  A - recurrent_subset A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A - recurrent_subset A \\<in> null_sets MA", "unfolding MA_def"], ["proof (prove)\nusing this:\n  A - recurrent_subset A \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. A - recurrent_subset A \\<in> null_sets (restrict_space M A)", "by (metis Diff_subset assms(1) emeasure_restrict_space null_setsD1 null_setsD2 null_setsI sets.Int_space_eq2 sets_restrict_space_iff)"], ["proof (state)\nthis:\n  A - recurrent_subset A \\<in> null_sets MA\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  A - recurrent_subset A \\<in> null_sets MA", "have \"AE x in MA. x \\<in> recurrent_subset A\""], ["proof (prove)\nusing this:\n  A - recurrent_subset A \\<in> null_sets MA\n\ngoal (1 subgoal):\n 1. AE x in MA. x \\<in> recurrent_subset A", "by (simp add: AE_iff_null MA_def null_setsD2 set_diff_eq space_restrict_space2)"], ["proof (state)\nthis:\n  AE x in MA. x \\<in> recurrent_subset A\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "moreover"], ["proof (state)\nthis:\n  AE x in MA. x \\<in> recurrent_subset A\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"\\<And>x. x \\<in> recurrent_subset A \\<Longrightarrow> phiA x > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> recurrent_subset A \\<Longrightarrow> 0 < phiA x", "unfolding phiA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> recurrent_subset A \\<Longrightarrow>\n       0 < return_time_function A x", "using return_time0"], ["proof (prove)\nusing this:\n  return_time_function ?A -` {0} = UNIV - recurrent_subset ?A\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> recurrent_subset A \\<Longrightarrow>\n       0 < return_time_function A x", "by fastforce"], ["proof (state)\nthis:\n  ?x3 \\<in> recurrent_subset A \\<Longrightarrow> 0 < phiA ?x3\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "ultimately"], ["proof (chain)\npicking this:\n  AE x in MA. x \\<in> recurrent_subset A\n  ?x3 \\<in> recurrent_subset A \\<Longrightarrow> 0 < phiA ?x3", "have *: \"AE x in MA. phiA x > 0\""], ["proof (prove)\nusing this:\n  AE x in MA. x \\<in> recurrent_subset A\n  ?x3 \\<in> recurrent_subset A \\<Longrightarrow> 0 < phiA ?x3\n\ngoal (1 subgoal):\n 1. AE x in MA. 0 < phiA x", "by auto"], ["proof (state)\nthis:\n  AE x in MA. 0 < phiA x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have d: \"AE x in MA. real_cond_exp MA A.Invariants phiA x > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MA. 0 < real_cond_exp MA A.Invariants\n                     (\\<lambda>x. real (phiA x)) x", "by (rule A.real_cond_exp_gr_c, auto simp add: * \\<open>integrable MA phiA\\<close>)"], ["proof (state)\nthis:\n  AE x in MA. 0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x))\n                   x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "{"], ["proof (state)\nthis:\n  AE x in MA. 0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x))\n                   x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "assume A: \"(\\<lambda>n. A.birkhoff_sum fA n x / n) \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x\"\n       and B: \"(\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\"\n       and C: \"(\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real(phiA x)) n x / n) \\<longlonglongrightarrow> real_cond_exp MA A.Invariants phiA x\"\n       and D: \"real_cond_exp MA A.Invariants phiA x > 0\""], ["proof (state)\nthis:\n  (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x\n  (\\<lambda>n. birkhoff_sum f n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n  0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "define R where \"R = (\\<lambda>n. A.birkhoff_sum phiA n x)\""], ["proof (state)\nthis:\n  R = (\\<lambda>n. A.birkhoff_sum phiA n x)\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have D2: \"ereal(real_cond_exp MA A.Invariants phiA x) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < ereal (real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x)) x)", "using D"], ["proof (prove)\nusing this:\n  0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. 0 < ereal (real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x)) x)", "by simp"], ["proof (state)\nthis:\n  0 < ereal (real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x)) x)\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"\\<And>n. real(R n)/ n = A.birkhoff_sum (\\<lambda>x. real(phiA x)) n x / n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       real (R n) / real n =\n       A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n", "unfolding R_def A.birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       real (\\<Sum>i<n. phiA ((TA ^^ i) x)) / real n =\n       (\\<Sum>i<n. real (phiA ((TA ^^ i) x))) / real n", "by auto"], ["proof (state)\nthis:\n  real (R ?n3) / real ?n3 =\n  A.birkhoff_sum (\\<lambda>x. real (phiA x)) ?n3 x / real ?n3\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "moreover"], ["proof (state)\nthis:\n  real (R ?n3) / real ?n3 =\n  A.birkhoff_sum (\\<lambda>x. real (phiA x)) ?n3 x / real ?n3\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"(\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real(phiA x)) n x / n) \\<longlonglongrightarrow> real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n    \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x", "using C"], ["proof (prove)\nusing this:\n  (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n    \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "ultimately"], ["proof (chain)\npicking this:\n  real (R ?n3) / real ?n3 =\n  A.birkhoff_sum (\\<lambda>x. real (phiA x)) ?n3 x / real ?n3\n  (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x", "have Rnn: \"(\\<lambda>n. real(R n)/n) \\<longlonglongrightarrow> real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\nusing this:\n  real (R ?n3) / real ?n3 =\n  A.birkhoff_sum (\\<lambda>x. real (phiA x)) ?n3 x / real ?n3\n  (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. real (R n) / real n)\n    \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x", "by presburger"], ["proof (state)\nthis:\n  (\\<lambda>n. real (R n) / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"\\<And>n. ereal(real(R n))/ n = ereal(A.birkhoff_sum (\\<lambda>x. real(phiA x)) n x / n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       ereal (real (R n)) / ereal (real n) =\n       ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)", "unfolding R_def A.birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       ereal (real (\\<Sum>i<n. phiA ((TA ^^ i) x))) / ereal (real n) =\n       ereal ((\\<Sum>i<n. real (phiA ((TA ^^ i) x))) / real n)", "by auto"], ["proof (state)\nthis:\n  ereal (real (R ?n3)) / ereal (real ?n3) =\n  ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) ?n3 x / real ?n3)\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "moreover"], ["proof (state)\nthis:\n  ereal (real (R ?n3)) / ereal (real ?n3) =\n  ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) ?n3 x / real ?n3)\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"(\\<lambda>n. ereal(A.birkhoff_sum (\\<lambda>x. real(phiA x)) n x / n)) \\<longlonglongrightarrow> real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n))\n    \\<longlonglongrightarrow> ereal\n                               (real_cond_exp MA A.Invariants\n                                 (\\<lambda>x. real (phiA x)) x)", "using C"], ["proof (prove)\nusing this:\n  (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n))\n    \\<longlonglongrightarrow> ereal\n                               (real_cond_exp MA A.Invariants\n                                 (\\<lambda>x. real (phiA x)) x)", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n))\n  \\<longlonglongrightarrow> ereal\n                             (real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x)\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "ultimately"], ["proof (chain)\npicking this:\n  ereal (real (R ?n3)) / ereal (real ?n3) =\n  ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) ?n3 x / real ?n3)\n  (\\<lambda>n.\n      ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n))\n  \\<longlonglongrightarrow> ereal\n                             (real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x)", "have i: \"(\\<lambda>n. ereal(real(R n))/n) \\<longlonglongrightarrow> real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\nusing this:\n  ereal (real (R ?n3)) / ereal (real ?n3) =\n  ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) ?n3 x / real ?n3)\n  (\\<lambda>n.\n      ereal (A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n))\n  \\<longlonglongrightarrow> ereal\n                             (real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. ereal (real (R n)) / ereal (real n))\n    \\<longlonglongrightarrow> ereal\n                               (real_cond_exp MA A.Invariants\n                                 (\\<lambda>x. real (phiA x)) x)", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. ereal (real (R n)) / ereal (real n))\n  \\<longlonglongrightarrow> ereal\n                             (real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x)\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have ii: \"(\\<lambda>n. real n) \\<longlonglongrightarrow> \\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. ereal (real x)) \\<longlonglongrightarrow> \\<infinity>", "by (rule id_nat_ereal_tendsto_PInf)"], ["proof (state)\nthis:\n  (\\<lambda>x. ereal (real x)) \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have iii: \"(\\<lambda>n. ereal(real(R n))/n * real n) \\<longlonglongrightarrow> \\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. ereal (real (R n)) / ereal (real n) * ereal (real n))\n    \\<longlonglongrightarrow> \\<infinity>", "using tendsto_mult_ereal_PInf[OF i D2 ii]"], ["proof (prove)\nusing this:\n  (\\<lambda>x. ereal (real (R x)) / ereal (real x) * ereal (real x))\n  \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. ereal (real (R n)) / ereal (real n) * ereal (real n))\n    \\<longlonglongrightarrow> \\<infinity>", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>n. ereal (real (R n)) / ereal (real n) * ereal (real n))\n  \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"\\<And>n. n > 0 \\<Longrightarrow> ereal(real(R n))/n * real n = R n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       0 < n \\<Longrightarrow>\n       ereal (real (R n)) / ereal (real n) * ereal (real n) =\n       ereal (real (R n))", "by auto"], ["proof (state)\nthis:\n  0 < ?n3 \\<Longrightarrow>\n  ereal (real (R ?n3)) / ereal (real ?n3) * ereal (real ?n3) =\n  ereal (real (R ?n3))\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  0 < ?n3 \\<Longrightarrow>\n  ereal (real (R ?n3)) / ereal (real ?n3) * ereal (real ?n3) =\n  ereal (real (R ?n3))", "have \"eventually (\\<lambda>n. ereal(real(R n))/n * real n = R n) sequentially\""], ["proof (prove)\nusing this:\n  0 < ?n3 \\<Longrightarrow>\n  ereal (real (R ?n3)) / ereal (real ?n3) * ereal (real ?n3) =\n  ereal (real (R ?n3))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       ereal (real (R n)) / ereal (real n) * ereal (real n) =\n       ereal (real (R n))", "using eventually_at_top_dense"], ["proof (prove)\nusing this:\n  0 < ?n3 \\<Longrightarrow>\n  ereal (real (R ?n3)) / ereal (real ?n3) * ereal (real ?n3) =\n  ereal (real (R ?n3))\n  eventually ?P at_top = (\\<exists>N. \\<forall>n>N. ?P n)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       ereal (real (R n)) / ereal (real n) * ereal (real n) =\n       ereal (real (R n))", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (real (R n)) / ereal (real n) * ereal (real n) =\n     ereal (real (R n))\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (real (R n)) / ereal (real n) * ereal (real n) =\n     ereal (real (R n))", "have \"(\\<lambda>n. real(R n)) \\<longlonglongrightarrow> \\<infinity>\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (real (R n)) / ereal (real n) * ereal (real n) =\n     ereal (real (R n))\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. ereal (real (R x))) \\<longlonglongrightarrow> \\<infinity>", "using iii"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     ereal (real (R n)) / ereal (real n) * ereal (real n) =\n     ereal (real (R n))\n  (\\<lambda>n. ereal (real (R n)) / ereal (real n) * ereal (real n))\n  \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. ereal (real (R x))) \\<longlonglongrightarrow> \\<infinity>", "by (simp add: filterlim_cong)"], ["proof (state)\nthis:\n  (\\<lambda>x. ereal (real (R x))) \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>x. ereal (real (R x))) \\<longlonglongrightarrow> \\<infinity>", "have \"(\\<lambda>n. birkhoff_sum f (R n) x / (R n)) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  (\\<lambda>x. ereal (real (R x))) \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f (R n) x / real (R n))\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "using limit_along_weak_subseq B"], ["proof (prove)\nusing this:\n  (\\<lambda>x. ereal (real (R x))) \\<longlonglongrightarrow> \\<infinity>\n  \\<lbrakk>(\\<lambda>x. ereal (real (?u x)))\n           \\<longlonglongrightarrow> \\<infinity>;\n   ?v \\<longlonglongrightarrow> ?l\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>n. ?v (?u n)) \\<longlonglongrightarrow> ?l\n  (\\<lambda>n. birkhoff_sum f n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f (R n) x / real (R n))\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. birkhoff_sum f (R n) x / real (R n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. birkhoff_sum f (R n) x / real (R n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "have l: \"(\\<lambda>n. (birkhoff_sum f (R n) x / (R n)) * ((R n)/n)) \\<longlonglongrightarrow> real_cond_exp M Invariants f x * real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. birkhoff_sum f (R n) x / real (R n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n))\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                              real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x", "by (rule tendsto_mult, simp add: Rnn)"], ["proof (state)\nthis:\n  (\\<lambda>n. birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                            real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "obtain N where N: \"\\<And>n. n > N \\<Longrightarrow> R n > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n. N < n \\<Longrightarrow> 0 < R n) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using \\<open>(\\<lambda>n. real(R n)) \\<longlonglongrightarrow> \\<infinity>\\<close>"], ["proof (prove)\nusing this:\n  (\\<lambda>x. ereal (real (R x))) \\<longlonglongrightarrow> \\<infinity>\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n. N < n \\<Longrightarrow> 0 < R n) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (metis (full_types) eventually_at_top_dense filterlim_iff filterlim_weak_subseq)"], ["proof (state)\nthis:\n  N < ?n3 \\<Longrightarrow> 0 < R ?n3\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  N < ?n3 \\<Longrightarrow> 0 < R ?n3", "have \"\\<And>n. n > N \\<Longrightarrow> (birkhoff_sum f (R n) x / (R n)) * ((R n)/n) = birkhoff_sum f (R n) x / n\""], ["proof (prove)\nusing this:\n  N < ?n3 \\<Longrightarrow> 0 < R ?n3\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       N < n \\<Longrightarrow>\n       birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n) =\n       birkhoff_sum f (R n) x / real n", "by auto"], ["proof (state)\nthis:\n  N < ?n3 \\<Longrightarrow>\n  birkhoff_sum f (R ?n3) x / real (R ?n3) * (real (R ?n3) / real ?n3) =\n  birkhoff_sum f (R ?n3) x / real ?n3\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  N < ?n3 \\<Longrightarrow>\n  birkhoff_sum f (R ?n3) x / real (R ?n3) * (real (R ?n3) / real ?n3) =\n  birkhoff_sum f (R ?n3) x / real ?n3", "have \"eventually (\\<lambda>n. (birkhoff_sum f (R n) x / (R n)) * ((R n)/n) = birkhoff_sum f (R n) x / n) sequentially\""], ["proof (prove)\nusing this:\n  N < ?n3 \\<Longrightarrow>\n  birkhoff_sum f (R ?n3) x / real (R ?n3) * (real (R ?n3) / real ?n3) =\n  birkhoff_sum f (R ?n3) x / real ?n3\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n) =\n       birkhoff_sum f (R n) x / real n", "by simp"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n) =\n     birkhoff_sum f (R n) x / real n\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "with tendsto_cong[OF this]"], ["proof (chain)\npicking this:\n  (\\<lambda>n. birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n))\n  \\<longlonglongrightarrow> ?c =\n  (\\<lambda>n. birkhoff_sum f (R n) x / real n) \\<longlonglongrightarrow> ?c\n  \\<forall>\\<^sub>F n in sequentially.\n     birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n) =\n     birkhoff_sum f (R n) x / real n", "have main_limit: \"(\\<lambda>n. birkhoff_sum f (R n) x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x * real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n))\n  \\<longlonglongrightarrow> ?c =\n  (\\<lambda>n. birkhoff_sum f (R n) x / real n) \\<longlonglongrightarrow> ?c\n  \\<forall>\\<^sub>F n in sequentially.\n     birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n) =\n     birkhoff_sum f (R n) x / real n\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f (R n) x / real n)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                              real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x", "using l"], ["proof (prove)\nusing this:\n  (\\<lambda>n. birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n))\n  \\<longlonglongrightarrow> ?c =\n  (\\<lambda>n. birkhoff_sum f (R n) x / real n) \\<longlonglongrightarrow> ?c\n  \\<forall>\\<^sub>F n in sequentially.\n     birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n) =\n     birkhoff_sum f (R n) x / real n\n  (\\<lambda>n. birkhoff_sum f (R n) x / real (R n) * (real (R n) / real n))\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                            real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. birkhoff_sum f (R n) x / real n)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                              real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. birkhoff_sum f (R n) x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                            real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "have \"\\<And>n. birkhoff_sum f (R n) x = A.birkhoff_sum fA n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n. birkhoff_sum f (R n) x = A.birkhoff_sum fA n x", "unfolding R_def fA_def phiA_def TA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       birkhoff_sum f\n        (qmpt.birkhoff_sum (induced_map A) (return_time_function A) n x) x =\n       qmpt.birkhoff_sum (induced_map A) (induced_function A f) n x", "using induced_function_birkhoff_sum[OF assms(1)]"], ["proof (prove)\nusing this:\n  birkhoff_sum ?f\n   (qmpt.birkhoff_sum (induced_map A) (return_time_function A) ?n ?x) ?x =\n  qmpt.birkhoff_sum (induced_map A) (induced_function A ?f) ?n ?x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       birkhoff_sum f\n        (qmpt.birkhoff_sum (induced_map A) (return_time_function A) n x) x =\n       qmpt.birkhoff_sum (induced_map A) (induced_function A f) n x", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum f (R ?n3) x = A.birkhoff_sum fA ?n3 x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f (R ?n3) x = A.birkhoff_sum fA ?n3 x", "have \"\\<And>n. birkhoff_sum f (R n) x /n = A.birkhoff_sum fA n x / n\""], ["proof (prove)\nusing this:\n  birkhoff_sum f (R ?n3) x = A.birkhoff_sum fA ?n3 x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       birkhoff_sum f (R n) x / real n = A.birkhoff_sum fA n x / real n", "by simp"], ["proof (state)\nthis:\n  birkhoff_sum f (R ?n3) x / real ?n3 = A.birkhoff_sum fA ?n3 x / real ?n3\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  birkhoff_sum f (R ?n3) x / real ?n3 = A.birkhoff_sum fA ?n3 x / real ?n3", "have \"(\\<lambda>n. A.birkhoff_sum fA n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x * real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\nusing this:\n  birkhoff_sum f (R ?n3) x / real ?n3 = A.birkhoff_sum fA ?n3 x / real ?n3\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                              real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x", "using main_limit"], ["proof (prove)\nusing this:\n  birkhoff_sum f (R ?n3) x / real ?n3 = A.birkhoff_sum fA ?n3 x / real ?n3\n  (\\<lambda>n. birkhoff_sum f (R n) x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                            real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                              real_cond_exp MA A.Invariants\n                               (\\<lambda>x. real (phiA x)) x", "by presburger"], ["proof (state)\nthis:\n  (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                            real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                            real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x", "have \"real_cond_exp MA A.Invariants fA x = real_cond_exp M Invariants f x * real_cond_exp MA A.Invariants phiA x\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                            real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. real_cond_exp MA A.Invariants fA x =\n    real_cond_exp M Invariants f x *\n    real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x)) x", "using A LIMSEQ_unique"], ["proof (prove)\nusing this:\n  (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x *\n                            real_cond_exp MA A.Invariants\n                             (\\<lambda>x. real (phiA x)) x\n  (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n  \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x\n  \\<lbrakk>?X \\<longlonglongrightarrow> ?a;\n   ?X \\<longlonglongrightarrow> ?b\\<rbrakk>\n  \\<Longrightarrow> ?a = ?b\n\ngoal (1 subgoal):\n 1. real_cond_exp MA A.Invariants fA x =\n    real_cond_exp M Invariants f x *\n    real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x)) x", "by auto"], ["proof (state)\nthis:\n  real_cond_exp MA A.Invariants fA x =\n  real_cond_exp M Invariants f x *\n  real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "}"], ["proof (state)\nthis:\n  \\<lbrakk>(\\<lambda>n. A.birkhoff_sum fA n ?x5 / real n)\n           \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                              (\\<lambda>x. real (phiA x)) ?x5;\n   0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x))\n        ?x5\\<rbrakk>\n  \\<Longrightarrow> real_cond_exp MA A.Invariants fA ?x5 =\n                    real_cond_exp M Invariants f ?x5 *\n                    real_cond_exp MA A.Invariants\n                     (\\<lambda>x. real (phiA x)) ?x5\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>(\\<lambda>n. A.birkhoff_sum fA n ?x5 / real n)\n           \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                              (\\<lambda>x. real (phiA x)) ?x5;\n   0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x))\n        ?x5\\<rbrakk>\n  \\<Longrightarrow> real_cond_exp MA A.Invariants fA ?x5 =\n                    real_cond_exp M Invariants f ?x5 *\n                    real_cond_exp MA A.Invariants\n                     (\\<lambda>x. real (phiA x)) ?x5", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>(\\<lambda>n. A.birkhoff_sum fA n ?x5 / real n)\n           \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                              (\\<lambda>x. real (phiA x)) ?x5;\n   0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x))\n        ?x5\\<rbrakk>\n  \\<Longrightarrow> real_cond_exp MA A.Invariants fA ?x5 =\n                    real_cond_exp M Invariants f ?x5 *\n                    real_cond_exp MA A.Invariants\n                     (\\<lambda>x. real (phiA x)) ?x5\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "using a b c d"], ["proof (prove)\nusing this:\n  \\<lbrakk>(\\<lambda>n. A.birkhoff_sum fA n ?x5 / real n)\n           \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n. A.birkhoff_sum (\\<lambda>x. real (phiA x)) n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                              (\\<lambda>x. real (phiA x)) ?x5;\n   0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x))\n        ?x5\\<rbrakk>\n  \\<Longrightarrow> real_cond_exp MA A.Invariants fA ?x5 =\n                    real_cond_exp M Invariants f ?x5 *\n                    real_cond_exp MA A.Invariants\n                     (\\<lambda>x. real (phiA x)) ?x5\n  AE x in MA. (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x\n  AE x in MA. (\\<lambda>n. birkhoff_sum f n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  AE x in MA. (\\<lambda>n.\n                  A.birkhoff_sum (\\<lambda>x. real (phiA x)) n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n   (\\<lambda>x. real (phiA x)) x\n  AE x in MA. 0 < real_cond_exp MA A.Invariants (\\<lambda>x. real (phiA x))\n                   x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "unfolding phiA_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>(\\<lambda>n. A.birkhoff_sum fA n ?x5 / real n)\n           \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA ?x5;\n   (\\<lambda>n. birkhoff_sum f n ?x5 / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f ?x5;\n   (\\<lambda>n.\n       A.birkhoff_sum (\\<lambda>x. real (return_time_function A x)) n ?x5 /\n       real n)\n   \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n                              (\\<lambda>x. real (return_time_function A x))\n                              ?x5;\n   0 < real_cond_exp MA A.Invariants\n        (\\<lambda>x. real (return_time_function A x)) ?x5\\<rbrakk>\n  \\<Longrightarrow> real_cond_exp MA A.Invariants fA ?x5 =\n                    real_cond_exp M Invariants f ?x5 *\n                    real_cond_exp MA A.Invariants\n                     (\\<lambda>x. real (return_time_function A x)) ?x5\n  AE x in MA. (\\<lambda>n. A.birkhoff_sum fA n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp MA A.Invariants fA x\n  AE x in MA. (\\<lambda>n. birkhoff_sum f n x / real n)\n              \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  AE x in MA. (\\<lambda>n.\n                  A.birkhoff_sum\n                   (\\<lambda>x. real (return_time_function A x)) n x /\n                  real n)\n              \\<longlonglongrightarrow> real_cond_exp MA A.Invariants\n   (\\<lambda>x. real (return_time_function A x)) x\n  AE x in MA. 0 < real_cond_exp MA A.Invariants\n                   (\\<lambda>x. real (return_time_function A x)) x\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA A.Invariants fA x =\n                real_cond_exp M Invariants f x *\n                real_cond_exp MA A.Invariants\n                 (\\<lambda>x. real (return_time_function A x)) x", "by auto"], ["proof (state)\nthis:\n  AE x in MA. real_cond_exp MA A.Invariants fA x =\n              real_cond_exp M Invariants f x *\n              real_cond_exp MA A.Invariants\n               (\\<lambda>x. real (return_time_function A x)) x\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary Invariants_cond_exp_induced_map_0:\n  fixes f::\"'a \\<Rightarrow> real\"\n  assumes [measurable]: \"A \\<in> sets M\" \"integrable M f\" and \"AE x in M. real_cond_exp M Invariants f x = 0\"\n  defines \"MA \\<equiv> restrict_space M A\" and \"TA \\<equiv> induced_map A\" and \"fA \\<equiv> induced_function A f\"\n  shows \"AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x = 0", "have \"AE x in MA. real_cond_exp M Invariants f x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp M Invariants f x = 0", "unfolding MA_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in restrict_space M A. real_cond_exp M Invariants f x = 0", "apply (subst AE_restrict_space_iff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. A \\<inter> space M \\<in> sets M\n 2. AE x\\<in>A in M. real_cond_exp M Invariants f x = 0", "using assms(3)"], ["proof (prove)\nusing this:\n  AE x in M. real_cond_exp M Invariants f x = 0\n\ngoal (2 subgoals):\n 1. A \\<inter> space M \\<in> sets M\n 2. AE x\\<in>A in M. real_cond_exp M Invariants f x = 0", "by auto"], ["proof (state)\nthis:\n  AE x in MA. real_cond_exp M Invariants f x = 0\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x = 0", "then"], ["proof (chain)\npicking this:\n  AE x in MA. real_cond_exp M Invariants f x = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in MA. real_cond_exp M Invariants f x = 0\n\ngoal (1 subgoal):\n 1. AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x = 0", "unfolding MA_def TA_def fA_def"], ["proof (prove)\nusing this:\n  AE x in restrict_space M A. real_cond_exp M Invariants f x = 0\n\ngoal (1 subgoal):\n 1. AE x in restrict_space M\n             A. real_cond_exp (restrict_space M A)\n                 (qmpt.Invariants (restrict_space M A) (induced_map A))\n                 (induced_function A f) x =\n                0", "using Invariants_cond_exp_induced_map[OF assms(1) assms(2)]"], ["proof (prove)\nusing this:\n  AE x in restrict_space M A. real_cond_exp M Invariants f x = 0\n  AE x in restrict_space M\n           A. real_cond_exp (restrict_space M A)\n               (qmpt.Invariants (restrict_space M A) (induced_map A))\n               (induced_function A f) x =\n              real_cond_exp M Invariants f x *\n              real_cond_exp (restrict_space M A)\n               (qmpt.Invariants (restrict_space M A) (induced_map A))\n               (\\<lambda>x. real (return_time_function A x)) x\n\ngoal (1 subgoal):\n 1. AE x in restrict_space M\n             A. real_cond_exp (restrict_space M A)\n                 (qmpt.Invariants (restrict_space M A) (induced_map A))\n                 (induced_function A f) x =\n                0", "by auto"], ["proof (state)\nthis:\n  AE x in MA. real_cond_exp MA (qmpt.Invariants MA TA) fA x = 0\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "(*of locale fmpt*)"], ["", "end"], ["", "(*of Invariants.thy*)"]]}