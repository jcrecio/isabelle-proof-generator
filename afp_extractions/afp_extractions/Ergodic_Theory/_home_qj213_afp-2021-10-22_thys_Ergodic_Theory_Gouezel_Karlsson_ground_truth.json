{"file_name": "/home/qj213/afp-2021-10-22/thys/Ergodic_Theory/Gouezel_Karlsson.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Ergodic_Theory", "problem_names": ["lemma upper_density_eventually_measure:\n  fixes a::real\n  assumes [measurable]: \"\\<And>n. {x \\<in> space M. P x n} \\<in> sets M\"\n    and \"emeasure M {x \\<in> space M. upper_asymptotic_density {n. P x n} < a} > b\"\n  shows \"\\<exists>N. emeasure M {x \\<in> space M. \\<forall>n \\<ge> N. card ({n. P x n} \\<inter> {..<n}) < a * n} > b\"", "lemma int_u [measurable]:\n  \"integrable M (u n)\"", "lemma upper_density_all_times:\n  assumes \"d > (0::real)\"\n  shows \"\\<exists>c> (0::real).\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - c * l} < d} > 1 - d\"", "lemma upper_density_large_k:\n  assumes \"d > (0::real)\" \"d \\<le> 1\"\n  shows \"\\<exists>k::nat.\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - d * l} < d} > 1 - d\"", "lemma upper_density_delta:\n  fixes d::real\n  assumes \"d > 0\" \"d \\<le> 1\"\n  shows \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n        emeasure M {x \\<in> space M. \\<forall>(N::nat). card {n \\<in>{..<N}. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - delta l * l} \\<le> d * N} > 1 - d\"", "lemma upper_density_good_direction_invertible:\n  assumes \"invertible_qmpt\"\n          \"d>(0::real)\" \"d \\<le> 1\"\n  shows \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} \\<ge> 1-d} \\<ge> ennreal(1-d)\"", "lemma upper_density_good_direction:\n  assumes \"d>(0::real)\" \"d \\<le> 1\"\n  shows \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} \\<ge> 1-d} \\<ge> ennreal(1-d)\"", "lemma infinite_AE:\n  shows \"AE x in M. \\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l})\"", "theorem (in pmpt) Gouezel_Karlsson_Kingman:\n  assumes \"subcocycle u\" \"subcocycle_avg_ereal u > -\\<infinity>\"\n  shows \"AE x in M. \\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x > - delta l * l})\"", "theorem (in pmpt) Gouezel_Karlsson_Kingman':\n  assumes \"subcocycle u\" \"subcocycle_avg_ereal u > -\\<infinity>\"\n  shows \"AE x in M. \\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. abs(u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x) < delta l * l})\""], "translations": [["", "lemma upper_density_eventually_measure:\n  fixes a::real\n  assumes [measurable]: \"\\<And>n. {x \\<in> space M. P x n} \\<in> sets M\"\n    and \"emeasure M {x \\<in> space M. upper_asymptotic_density {n. P x n} < a} > b\"\n  shows \"\\<exists>N. emeasure M {x \\<in> space M. \\<forall>n \\<ge> N. card ({n. P x n} \\<inter> {..<n}) < a * n} > b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "define G where \"G = {x \\<in> space M. upper_asymptotic_density {n. P x n} < a}\""], ["proof (state)\nthis:\n  G = {x \\<in> space M. upper_asymptotic_density {n. P x n} < a}\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "define H where \"H = (\\<lambda>N. {x \\<in> space M. \\<forall>n \\<ge> N. card ({n. P x n} \\<inter> {..<n}) < a * n})\""], ["proof (state)\nthis:\n  H =\n  (\\<lambda>N.\n      {x \\<in> space M.\n       \\<forall>n\\<ge>N.\n          real (card ({n. P x n} \\<inter> {..<n})) < a * real n})\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "have [measurable]: \"G \\<in> sets M\" \"\\<And>N. H N \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G \\<in> sets M &&& (\\<And>N. H N \\<in> sets M)", "unfolding G_def H_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M. upper_asymptotic_density (Collect (P x)) < a}\n    \\<in> sets M &&&\n    (\\<And>N.\n        {x \\<in> space M.\n         \\<forall>n\\<ge>N.\n            real (card (Collect (P x) \\<inter> {..<n})) < a * real n}\n        \\<in> sets M)", "by auto"], ["proof (state)\nthis:\n  G \\<in> sets M\n  H ?N \\<in> sets M\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "have \"G \\<subseteq> (\\<Union>N. H N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G \\<subseteq> \\<Union> (range H)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> G \\<Longrightarrow> x \\<in> \\<Union> (range H)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> G \\<Longrightarrow> x \\<in> \\<Union> (range H)", "assume \"x \\<in> G\""], ["proof (state)\nthis:\n  x \\<in> G\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> G \\<Longrightarrow> x \\<in> \\<Union> (range H)", "then"], ["proof (chain)\npicking this:\n  x \\<in> G", "have \"x \\<in> space M\""], ["proof (prove)\nusing this:\n  x \\<in> G\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "unfolding G_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M. upper_asymptotic_density (Collect (P x)) < a}\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "by simp"], ["proof (state)\nthis:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> G \\<Longrightarrow> x \\<in> \\<Union> (range H)", "have \"eventually (\\<lambda>n. card({n. P x n} \\<inter> {..<n}) < a * n) sequentially\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       real (card ({n. P x n} \\<inter> {..<n})) < a * real n", "using \\<open>x \\<in> G\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> G\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       real (card ({n. P x n} \\<inter> {..<n})) < a * real n", "unfolding G_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M. upper_asymptotic_density (Collect (P x)) < a}\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       real (card ({n. P x n} \\<inter> {..<n})) < a * real n", "using upper_asymptotic_densityD"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M. upper_asymptotic_density (Collect (P x)) < a}\n  upper_asymptotic_density ?A < ?l \\<Longrightarrow>\n  \\<forall>\\<^sub>F n in sequentially.\n     real (card (?A \\<inter> {..<n})) < ?l * real n\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       real (card ({n. P x n} \\<inter> {..<n})) < a * real n", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     real (card ({n. P x n} \\<inter> {..<n})) < a * real n\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> G \\<Longrightarrow> x \\<in> \\<Union> (range H)", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     real (card ({n. P x n} \\<inter> {..<n})) < a * real n", "obtain N where \"\\<And>n. n \\<ge> N \\<Longrightarrow> card({n. P x n} \\<inter> {..<n}) < a * n\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     real (card ({n. P x n} \\<inter> {..<n})) < a * real n\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n.\n            N \\<le> n \\<Longrightarrow>\n            real (card ({n. P x n} \\<inter> {..<n}))\n            < a * real n) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using eventually_sequentially"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     real (card ({n. P x n} \\<inter> {..<n})) < a * real n\n  eventually ?P sequentially = (\\<exists>N. \\<forall>n\\<ge>N. ?P n)\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n.\n            N \\<le> n \\<Longrightarrow>\n            real (card ({n. P x n} \\<inter> {..<n}))\n            < a * real n) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  N \\<le> ?n \\<Longrightarrow>\n  real (card ({n. P x n} \\<inter> {..<?n})) < a * real ?n\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> G \\<Longrightarrow> x \\<in> \\<Union> (range H)", "then"], ["proof (chain)\npicking this:\n  N \\<le> ?n \\<Longrightarrow>\n  real (card ({n. P x n} \\<inter> {..<?n})) < a * real ?n", "have \"x \\<in> H N\""], ["proof (prove)\nusing this:\n  N \\<le> ?n \\<Longrightarrow>\n  real (card ({n. P x n} \\<inter> {..<?n})) < a * real ?n\n\ngoal (1 subgoal):\n 1. x \\<in> H N", "unfolding H_def"], ["proof (prove)\nusing this:\n  N \\<le> ?n \\<Longrightarrow>\n  real (card ({n. P x n} \\<inter> {..<?n})) < a * real ?n\n\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card (Collect (P x) \\<inter> {..<n})) < a * real n}", "using \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  N \\<le> ?n \\<Longrightarrow>\n  real (card ({n. P x n} \\<inter> {..<?n})) < a * real ?n\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card (Collect (P x) \\<inter> {..<n})) < a * real n}", "by auto"], ["proof (state)\nthis:\n  x \\<in> H N\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> G \\<Longrightarrow> x \\<in> \\<Union> (range H)", "then"], ["proof (chain)\npicking this:\n  x \\<in> H N", "show \"x \\<in> (\\<Union>N. H N)\""], ["proof (prove)\nusing this:\n  x \\<in> H N\n\ngoal (1 subgoal):\n 1. x \\<in> \\<Union> (range H)", "by blast"], ["proof (state)\nthis:\n  x \\<in> \\<Union> (range H)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  G \\<subseteq> \\<Union> (range H)\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "have \"b < emeasure M G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b < emeasure M G", "using assms(2)"], ["proof (prove)\nusing this:\n  b < emeasure M {x \\<in> space M. upper_asymptotic_density {n. P x n} < a}\n\ngoal (1 subgoal):\n 1. b < emeasure M G", "unfolding G_def"], ["proof (prove)\nusing this:\n  b < emeasure M {x \\<in> space M. upper_asymptotic_density {n. P x n} < a}\n\ngoal (1 subgoal):\n 1. b < emeasure M\n         {x \\<in> space M. upper_asymptotic_density (Collect (P x)) < a}", "by simp"], ["proof (state)\nthis:\n  b < emeasure M G\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "also"], ["proof (state)\nthis:\n  b < emeasure M G\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "have \"... \\<le> emeasure M (\\<Union>N. H N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M G \\<le> emeasure M (\\<Union> (range H))", "apply (rule emeasure_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. G \\<subseteq> \\<Union> (range H)\n 2. \\<Union> (range H) \\<in> sets M", "using \\<open>G \\<subseteq> (\\<Union>N. H N)\\<close>"], ["proof (prove)\nusing this:\n  G \\<subseteq> \\<Union> (range H)\n\ngoal (2 subgoals):\n 1. G \\<subseteq> \\<Union> (range H)\n 2. \\<Union> (range H) \\<in> sets M", "by auto"], ["proof (state)\nthis:\n  emeasure M G \\<le> emeasure M (\\<Union> (range H))\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "finally"], ["proof (chain)\npicking this:\n  b < emeasure M (\\<Union> (range H))", "have \"emeasure M (\\<Union>N. H N) > b\""], ["proof (prove)\nusing this:\n  b < emeasure M (\\<Union> (range H))\n\ngoal (1 subgoal):\n 1. b < emeasure M (\\<Union> (range H))", "by simp"], ["proof (state)\nthis:\n  b < emeasure M (\\<Union> (range H))\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "moreover"], ["proof (state)\nthis:\n  b < emeasure M (\\<Union> (range H))\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "have \"(\\<lambda>N. emeasure M (H N)) \\<longlonglongrightarrow> emeasure M (\\<Union>N. H N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>N. emeasure M (H N))\n    \\<longlonglongrightarrow> emeasure M (\\<Union> (range H))", "apply (rule Lim_emeasure_incseq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. range H \\<subseteq> sets M\n 2. incseq H", "unfolding H_def incseq_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. range\n     (\\<lambda>i.\n         {x \\<in> space M.\n          \\<forall>n\\<ge>i.\n             real (card (Collect (P x) \\<inter> {..<n})) < a * real n})\n    \\<subseteq> sets M\n 2. \\<forall>m n.\n       m \\<le> n \\<longrightarrow>\n       {x \\<in> space M.\n        \\<forall>n\\<ge>m.\n           real (card (Collect (P x) \\<inter> {..<n})) < a * real n}\n       \\<subseteq> {x \\<in> space M.\n                    \\<forall>na\\<ge>n.\n                       real (card (Collect (P x) \\<inter> {..<na}))\n                       < a * real na}", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>N. emeasure M (H N))\n  \\<longlonglongrightarrow> emeasure M (\\<Union> (range H))\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "ultimately"], ["proof (chain)\npicking this:\n  b < emeasure M (\\<Union> (range H))\n  (\\<lambda>N. emeasure M (H N))\n  \\<longlonglongrightarrow> emeasure M (\\<Union> (range H))", "have \"eventually (\\<lambda>N. emeasure M (H N) > b) sequentially\""], ["proof (prove)\nusing this:\n  b < emeasure M (\\<Union> (range H))\n  (\\<lambda>N. emeasure M (H N))\n  \\<longlonglongrightarrow> emeasure M (\\<Union> (range H))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F N in sequentially. b < emeasure M (H N)", "by (simp add: order_tendsto_iff)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F N in sequentially. b < emeasure M (H N)\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F N in sequentially. b < emeasure M (H N)", "obtain N where \"emeasure M (H N) > b\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F N in sequentially. b < emeasure M (H N)\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        b < emeasure M (H N) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using eventually_False_sequentially eventually_mono"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F N in sequentially. b < emeasure M (H N)\n  \\<not> (\\<forall>\\<^sub>F n in sequentially. False)\n  \\<lbrakk>eventually ?P ?F; \\<And>x. ?P x \\<Longrightarrow> ?Q x\\<rbrakk>\n  \\<Longrightarrow> eventually ?Q ?F\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        b < emeasure M (H N) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  b < emeasure M (H N)\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "then"], ["proof (chain)\npicking this:\n  b < emeasure M (H N)", "show ?thesis"], ["proof (prove)\nusing this:\n  b < emeasure M (H N)\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "unfolding H_def"], ["proof (prove)\nusing this:\n  b < emeasure M\n       {x \\<in> space M.\n        \\<forall>n\\<ge>N.\n           real (card (Collect (P x) \\<inter> {..<n})) < a * real n}\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       b < emeasure M\n            {x \\<in> space M.\n             \\<forall>n\\<ge>N.\n                real (card ({n. P x n} \\<inter> {..<n})) < a * real n}", "by blast"], ["proof (state)\nthis:\n  \\<exists>N.\n     b < emeasure M\n          {x \\<in> space M.\n           \\<forall>n\\<ge>N.\n              real (card ({n. P x n} \\<inter> {..<n})) < a * real n}\n\ngoal:\nNo subgoals!", "qed"], ["", "locale Gouezel_Karlsson_Kingman = pmpt +\n  fixes u::\"nat \\<Rightarrow> 'a \\<Rightarrow> real\"\n  assumes subu: \"subcocycle u\"\n    and subu_fin: \"subcocycle_avg_ereal u > -\\<infinity>\"\n    and subu_0: \"AE x in M. subcocycle_lim u x = 0\"\nbegin"], ["", "lemma int_u [measurable]:\n  \"integrable M (u n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (u n)", "using subu"], ["proof (prove)\nusing this:\n  subcocycle u\n\ngoal (1 subgoal):\n 1. integrable M (u n)", "unfolding subcocycle_def"], ["proof (prove)\nusing this:\n  (\\<forall>n. integrable M (u n)) \\<and>\n  (\\<forall>n m x. u (n + m) x \\<le> u n x + u m ((T ^^ n) x))\n\ngoal (1 subgoal):\n 1. integrable M (u n)", "by auto"], ["", "text \\<open>Next lemma is Lemma 2.1 in~\\cite{gouezel_karlsson}.\\<close>"], ["", "lemma upper_density_all_times:\n  assumes \"d > (0::real)\"\n  shows \"\\<exists>c> (0::real).\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - c * l} < d} > 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "define f where \"f = (\\<lambda>x. abs (u 1 x))\""], ["proof (state)\nthis:\n  f = (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have [measurable]: \"f \\<in> borel_measurable M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable borel f", "unfolding f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable borel (\\<lambda>x. \\<bar>u 1 x\\<bar>)", "by auto"], ["proof (state)\nthis:\n  random_variable borel f\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "define G where \"G = {x \\<in> space M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n                      \\<and> (\\<lambda>n. u n x / n) \\<longlonglongrightarrow> 0}\""], ["proof (state)\nthis:\n  G =\n  {x \\<in> space M.\n   (\\<lambda>n. birkhoff_sum f n x / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f x \\<and>\n   (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have [measurable]: \"G \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G \\<in> events", "unfolding G_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     (\\<lambda>n. birkhoff_sum f n x / real n)\n     \\<longlonglongrightarrow> real_cond_exp M Invariants f x \\<and>\n     (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  G \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have \"AE x in M. (\\<lambda>n. birkhoff_sum f n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "apply (rule birkhoff_theorem_AE_nonergodic)"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M f", "using subu"], ["proof (prove)\nusing this:\n  subcocycle u\n\ngoal (1 subgoal):\n 1. integrable M f", "unfolding f_def subcocycle_def"], ["proof (prove)\nusing this:\n  (\\<forall>n. integrable M (u n)) \\<and>\n  (\\<forall>n m x. u (n + m) x \\<le> u n x + u m ((T ^^ n) x))\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have \"AE x in M. (\\<lambda>n. u n x / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0", "using subu_0 kingman_theorem_nonergodic(1)[OF subu subu_fin]"], ["proof (prove)\nusing this:\n  AE x in M. subcocycle_lim u x = 0\n  AE x in M. (\\<lambda>n. u n x / real n)\n             \\<longlonglongrightarrow> subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0", "have \"AE x in M. x \\<in> G\""], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> G", "unfolding G_def"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. birkhoff_sum f n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> {x \\<in> space M.\n                        (\\<lambda>n. birkhoff_sum f n x / real n)\n                        \\<longlonglongrightarrow> real_cond_exp M Invariants\n             f x \\<and>\n                        (\\<lambda>n. u n x / real n)\n                        \\<longlonglongrightarrow> 0}", "by auto"], ["proof (state)\nthis:\n  AE x in M. x \\<in> G\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  AE x in M. x \\<in> G", "have \"emeasure M G = 1\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<in> G\n\ngoal (1 subgoal):\n 1. emeasure M G = 1", "by (simp add: emeasure_eq_1_AE)"], ["proof (state)\nthis:\n  emeasure M G = 1\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "define V where \"V = (\\<lambda>c x. {n. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - c * l})\""], ["proof (state)\nthis:\n  V =\n  (\\<lambda>c x.\n      {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c * real l})\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "define Good where \"Good = (\\<lambda>c. {x \\<in> G. upper_asymptotic_density (V c x) < d})\""], ["proof (state)\nthis:\n  Good = (\\<lambda>c. {x \\<in> G. upper_asymptotic_density (V c x) < d})\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have [measurable]: \"Good c \\<in> sets M\" for c"], ["proof (prove)\ngoal (1 subgoal):\n 1. Good c \\<in> events", "unfolding Good_def V_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> G.\n     upper_asymptotic_density\n      {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c * real l}\n     < d}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  Good ?c12 \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have I: \"upper_asymptotic_density (V c x) \\<le> real_cond_exp M Invariants f x / c\" if \"c>0\" \"x \\<in> G\" for c x"], ["proof (prove)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have [simp]: \"c>0\" \"c \\<noteq> 0\" \"c \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < c &&& c \\<noteq> 0 &&& 0 \\<le> c", "using \\<open>c>0\\<close>"], ["proof (prove)\nusing this:\n  0 < c\n\ngoal (1 subgoal):\n 1. 0 < c &&& c \\<noteq> 0 &&& 0 \\<le> c", "by auto"], ["proof (state)\nthis:\n  0 < c\n  c \\<noteq> 0\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "define U where \"U = (\\<lambda>n. abs(u 0 x) + birkhoff_sum f n x - c * card (V c x \\<inter> {1..n}))\""], ["proof (state)\nthis:\n  U =\n  (\\<lambda>n.\n      \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n      c * real (card (V c x \\<inter> {1..n})))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have main: \"u n x \\<le> U n\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. u n x \\<le> U n", "proof (rule nat_less_induct)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n. \\<forall>m<n. u m x \\<le> U m \\<Longrightarrow> u n x \\<le> U n", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n. \\<forall>m<n. u m x \\<le> U m \\<Longrightarrow> u n x \\<le> U n", "assume H: \"\\<forall>m<n. u m x \\<le> U m\""], ["proof (state)\nthis:\n  \\<forall>m<n. u m x \\<le> U m\n\ngoal (1 subgoal):\n 1. \\<And>n. \\<forall>m<n. u m x \\<le> U m \\<Longrightarrow> u n x \\<le> U n", "consider \"n = 0\" | \"n\\<ge>1 \\<and> n \\<notin> V c x\" | \"n\\<ge>1 \\<and> n \\<in> V c x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>n = 0 \\<Longrightarrow> thesis;\n     1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> thesis;\n     1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by linarith"], ["proof (state)\nthis:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis12;\n   1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> ?thesis12;\n   1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. \\<And>n. \\<forall>m<n. u m x \\<le> U m \\<Longrightarrow> u n x \\<le> U n", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis12;\n   1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> ?thesis12;\n   1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12", "show \"u n x \\<le> U n\""], ["proof (prove)\nusing this:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis12;\n   1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> ?thesis12;\n   1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. u n x \\<le> U n", "proof (cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 3. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "assume \"n = 0\""], ["proof (state)\nthis:\n  n = 0\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 3. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "then"], ["proof (chain)\npicking this:\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. u n x \\<le> U n", "unfolding U_def"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. u n x\n    \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n          c * real (card (V c x \\<inter> {1..n}))", "by auto"], ["proof (state)\nthis:\n  u n x \\<le> U n\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "assume A: \"n\\<ge>1 \\<and> n \\<notin> V c x\""], ["proof (state)\nthis:\n  1 \\<le> n \\<and> n \\<notin> V c x\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n \\<and> n \\<notin> V c x", "have \"n \\<ge> 1\""], ["proof (prove)\nusing this:\n  1 \\<le> n \\<and> n \\<notin> V c x\n\ngoal (1 subgoal):\n 1. 1 \\<le> n", "by simp"], ["proof (state)\nthis:\n  1 \\<le> n\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n", "have \"n-1<n\""], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. n - 1 < n", "by simp"], ["proof (state)\nthis:\n  n - 1 < n\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"{1..n} = {1..n-1} \\<union> {n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {1..n} = {1..n - 1} \\<union> {n}", "using \\<open>1 \\<le> n\\<close> atLeastLessThanSuc"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  {?m..<Suc ?n} = (if ?m \\<le> ?n then insert ?n {?m..<?n} else {})\n\ngoal (1 subgoal):\n 1. {1..n} = {1..n - 1} \\<union> {n}", "by auto"], ["proof (state)\nthis:\n  {1..n} = {1..n - 1} \\<union> {n}\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "then"], ["proof (chain)\npicking this:\n  {1..n} = {1..n - 1} \\<union> {n}", "have *: \"card (V c x \\<inter> {1..n}) = card (V c x \\<inter> {1..n-1})\""], ["proof (prove)\nusing this:\n  {1..n} = {1..n - 1} \\<union> {n}\n\ngoal (1 subgoal):\n 1. card (V c x \\<inter> {1..n}) = card (V c x \\<inter> {1..n - 1})", "using A"], ["proof (prove)\nusing this:\n  {1..n} = {1..n - 1} \\<union> {n}\n  1 \\<le> n \\<and> n \\<notin> V c x\n\ngoal (1 subgoal):\n 1. card (V c x \\<inter> {1..n}) = card (V c x \\<inter> {1..n - 1})", "by auto"], ["proof (state)\nthis:\n  card (V c x \\<inter> {1..n}) = card (V c x \\<inter> {1..n - 1})\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"u n x \\<le> u (n-1) x + u 1 ((T^^(n-1)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u n x \\<le> u (n - 1) x + u 1 ((T ^^ (n - 1)) x)", "using \\<open>n\\<ge>1\\<close> subu"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  subcocycle u\n\ngoal (1 subgoal):\n 1. u n x \\<le> u (n - 1) x + u 1 ((T ^^ (n - 1)) x)", "unfolding subcocycle_def"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  (\\<forall>n. integrable M (u n)) \\<and>\n  (\\<forall>n m x. u (n + m) x \\<le> u n x + u m ((T ^^ n) x))\n\ngoal (1 subgoal):\n 1. u n x \\<le> u (n - 1) x + u 1 ((T ^^ (n - 1)) x)", "by (metis le_add_diff_inverse2)"], ["proof (state)\nthis:\n  u n x \\<le> u (n - 1) x + u 1 ((T ^^ (n - 1)) x)\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  u n x \\<le> u (n - 1) x + u 1 ((T ^^ (n - 1)) x)\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... \\<le> U (n-1) + f ((T^^(n-1)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n - 1) x + u 1 ((T ^^ (n - 1)) x)\n    \\<le> U (n - 1) + f ((T ^^ (n - 1)) x)", "unfolding f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n - 1) x + u 1 ((T ^^ (n - 1)) x)\n    \\<le> U (n - 1) + \\<bar>u 1 ((T ^^ (n - 1)) x)\\<bar>", "using H \\<open>n-1<n\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>m<n. u m x \\<le> U m\n  n - 1 < n\n\ngoal (1 subgoal):\n 1. u (n - 1) x + u 1 ((T ^^ (n - 1)) x)\n    \\<le> U (n - 1) + \\<bar>u 1 ((T ^^ (n - 1)) x)\\<bar>", "by auto"], ["proof (state)\nthis:\n  u (n - 1) x + u 1 ((T ^^ (n - 1)) x)\n  \\<le> U (n - 1) + f ((T ^^ (n - 1)) x)\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  u (n - 1) x + u 1 ((T ^^ (n - 1)) x)\n  \\<le> U (n - 1) + f ((T ^^ (n - 1)) x)\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... = abs(u 0 x) + birkhoff_sum f (n-1) x + f ((T^^(n-1)) x) - c * card (V c x \\<inter> {1..n-1})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U (n - 1) + f ((T ^^ (n - 1)) x) =\n    \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x + f ((T ^^ (n - 1)) x) -\n    c * real (card (V c x \\<inter> {1..n - 1}))", "unfolding U_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x -\n    c * real (card (V c x \\<inter> {1..n - 1})) +\n    f ((T ^^ (n - 1)) x) =\n    \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x + f ((T ^^ (n - 1)) x) -\n    c * real (card (V c x \\<inter> {1..n - 1}))", "by auto"], ["proof (state)\nthis:\n  U (n - 1) + f ((T ^^ (n - 1)) x) =\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x + f ((T ^^ (n - 1)) x) -\n  c * real (card (V c x \\<inter> {1..n - 1}))\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  U (n - 1) + f ((T ^^ (n - 1)) x) =\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x + f ((T ^^ (n - 1)) x) -\n  c * real (card (V c x \\<inter> {1..n - 1}))\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... = abs(u 0 x) + birkhoff_sum f n x - c * card (V c x \\<inter> {1..n})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x + f ((T ^^ (n - 1)) x) -\n    c * real (card (V c x \\<inter> {1..n - 1})) =\n    \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n    c * real (card (V c x \\<inter> {1..n}))", "using * birkhoff_sum_cocycle[of f \"n-1\" 1 x] \\<open>1 \\<le> n\\<close>"], ["proof (prove)\nusing this:\n  card (V c x \\<inter> {1..n}) = card (V c x \\<inter> {1..n - 1})\n  birkhoff_sum f (n - 1 + 1) x =\n  birkhoff_sum f (n - 1) x + birkhoff_sum f 1 ((T ^^ (n - 1)) x)\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x + f ((T ^^ (n - 1)) x) -\n    c * real (card (V c x \\<inter> {1..n - 1})) =\n    \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n    c * real (card (V c x \\<inter> {1..n}))", "by auto"], ["proof (state)\nthis:\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x + f ((T ^^ (n - 1)) x) -\n  c * real (card (V c x \\<inter> {1..n - 1})) =\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n  c * real (card (V c x \\<inter> {1..n}))\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - 1) x + f ((T ^^ (n - 1)) x) -\n  c * real (card (V c x \\<inter> {1..n - 1})) =\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n  c * real (card (V c x \\<inter> {1..n}))\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... = U n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n    c * real (card (V c x \\<inter> {1..n})) =\n    U n", "unfolding U_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n    c * real (card (V c x \\<inter> {1..n})) =\n    \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n    c * real (card (V c x \\<inter> {1..n}))", "by simp"], ["proof (state)\nthis:\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n  c * real (card (V c x \\<inter> {1..n})) =\n  U n\n\ngoal (2 subgoals):\n 1. 1 \\<le> n \\<and> n \\<notin> V c x \\<Longrightarrow> u n x \\<le> U n\n 2. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "finally"], ["proof (chain)\npicking this:\n  u n x \\<le> U n", "show ?thesis"], ["proof (prove)\nusing this:\n  u n x \\<le> U n\n\ngoal (1 subgoal):\n 1. u n x \\<le> U n", "by auto"], ["proof (state)\nthis:\n  u n x \\<le> U n\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "assume B: \"n\\<ge>1 \\<and> n \\<in> V c x\""], ["proof (state)\nthis:\n  1 \\<le> n \\<and> n \\<in> V c x\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n \\<and> n \\<in> V c x", "obtain l where l: \"l\\<in>{1..n}\" \"u n x - u (n-l) x \\<le> - c * l\""], ["proof (prove)\nusing this:\n  1 \\<le> n \\<and> n \\<in> V c x\n\ngoal (1 subgoal):\n 1. (\\<And>l.\n        \\<lbrakk>l \\<in> {1..n};\n         u n x - u (n - l) x \\<le> - c * real l\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding V_def"], ["proof (prove)\nusing this:\n  1 \\<le> n \\<and>\n  n \\<in> {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c * real l}\n\ngoal (1 subgoal):\n 1. (\\<And>l.\n        \\<lbrakk>l \\<in> {1..n};\n         u n x - u (n - l) x \\<le> - c * real l\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  l \\<in> {1..n}\n  u n x - u (n - l) x \\<le> - c * real l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "then"], ["proof (chain)\npicking this:\n  l \\<in> {1..n}\n  u n x - u (n - l) x \\<le> - c * real l", "have \"n-l < n\""], ["proof (prove)\nusing this:\n  l \\<in> {1..n}\n  u n x - u (n - l) x \\<le> - c * real l\n\ngoal (1 subgoal):\n 1. n - l < n", "by simp"], ["proof (state)\nthis:\n  n - l < n\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have m: \"- (r * ra) - r * rb = - (r * (rb + ra))\" for r ra rb::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. - (r * ra) - r * rb = - (r * (rb + ra))", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  - (?r12 * ?ra12) - ?r12 * ?rb12 = - (?r12 * (?rb12 + ?ra12))\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"card(V c x \\<inter> {1..n}) \\<le> card ((V c x \\<inter> {1..n-l}) \\<union> {n-l+1..n})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (V c x \\<inter> {1..n})\n    \\<le> card (V c x \\<inter> {1..n - l} \\<union> {n - l + 1..n})", "by (rule card_mono, auto)"], ["proof (state)\nthis:\n  card (V c x \\<inter> {1..n})\n  \\<le> card (V c x \\<inter> {1..n - l} \\<union> {n - l + 1..n})\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  card (V c x \\<inter> {1..n})\n  \\<le> card (V c x \\<inter> {1..n - l} \\<union> {n - l + 1..n})\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... \\<le> card (V c x \\<inter> {1..n-l}) + card {n-l+1..n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (V c x \\<inter> {1..n - l} \\<union> {n - l + 1..n})\n    \\<le> card (V c x \\<inter> {1..n - l}) + card {n - l + 1..n}", "by (rule card_Un_le)"], ["proof (state)\nthis:\n  card (V c x \\<inter> {1..n - l} \\<union> {n - l + 1..n})\n  \\<le> card (V c x \\<inter> {1..n - l}) + card {n - l + 1..n}\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  card (V c x \\<inter> {1..n - l} \\<union> {n - l + 1..n})\n  \\<le> card (V c x \\<inter> {1..n - l}) + card {n - l + 1..n}\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... \\<le> card (V c x \\<inter> {1..n-l}) + l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (V c x \\<inter> {1..n - l}) + card {n - l + 1..n}\n    \\<le> card (V c x \\<inter> {1..n - l}) + l", "by auto"], ["proof (state)\nthis:\n  card (V c x \\<inter> {1..n - l}) + card {n - l + 1..n}\n  \\<le> card (V c x \\<inter> {1..n - l}) + l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "finally"], ["proof (chain)\npicking this:\n  card (V c x \\<inter> {1..n}) \\<le> card (V c x \\<inter> {1..n - l}) + l", "have \"card(V c x \\<inter> {1..n}) \\<le> card (V c x \\<inter> {1..n-l}) + real l\""], ["proof (prove)\nusing this:\n  card (V c x \\<inter> {1..n}) \\<le> card (V c x \\<inter> {1..n - l}) + l\n\ngoal (1 subgoal):\n 1. real (card (V c x \\<inter> {1..n}))\n    \\<le> real (card (V c x \\<inter> {1..n - l})) + real l", "by auto"], ["proof (state)\nthis:\n  real (card (V c x \\<inter> {1..n}))\n  \\<le> real (card (V c x \\<inter> {1..n - l})) + real l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "then"], ["proof (chain)\npicking this:\n  real (card (V c x \\<inter> {1..n}))\n  \\<le> real (card (V c x \\<inter> {1..n - l})) + real l", "have *: \"-c * card (V c x \\<inter> {1..n-l}) - c * l \\<le> -c * card(V c x \\<inter> {1..n})\""], ["proof (prove)\nusing this:\n  real (card (V c x \\<inter> {1..n}))\n  \\<le> real (card (V c x \\<inter> {1..n - l})) + real l\n\ngoal (1 subgoal):\n 1. - c * real (card (V c x \\<inter> {1..n - l})) - c * real l\n    \\<le> - c * real (card (V c x \\<inter> {1..n}))", "using m"], ["proof (prove)\nusing this:\n  real (card (V c x \\<inter> {1..n}))\n  \\<le> real (card (V c x \\<inter> {1..n - l})) + real l\n  - (?r12 * ?ra12) - ?r12 * ?rb12 = - (?r12 * (?rb12 + ?ra12))\n\ngoal (1 subgoal):\n 1. - c * real (card (V c x \\<inter> {1..n - l})) - c * real l\n    \\<le> - c * real (card (V c x \\<inter> {1..n}))", "by auto"], ["proof (state)\nthis:\n  - c * real (card (V c x \\<inter> {1..n - l})) - c * real l\n  \\<le> - c * real (card (V c x \\<inter> {1..n}))\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"birkhoff_sum f ((n-l) + l) x = birkhoff_sum f (n-l) x + birkhoff_sum f l ((T^^(n-l))x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum f (n - l + l) x =\n    birkhoff_sum f (n - l) x + birkhoff_sum f l ((T ^^ (n - l)) x)", "by (rule birkhoff_sum_cocycle)"], ["proof (state)\nthis:\n  birkhoff_sum f (n - l + l) x =\n  birkhoff_sum f (n - l) x + birkhoff_sum f l ((T ^^ (n - l)) x)\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "moreover"], ["proof (state)\nthis:\n  birkhoff_sum f (n - l + l) x =\n  birkhoff_sum f (n - l) x + birkhoff_sum f l ((T ^^ (n - l)) x)\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"birkhoff_sum f l ((T^^(n-l))x) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> birkhoff_sum f l ((T ^^ (n - l)) x)", "unfolding f_def birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i<l. \\<bar>u 1 ((T ^^ i) ((T ^^ (n - l)) x))\\<bar>)", "using sum_nonneg"], ["proof (prove)\nusing this:\n  (\\<And>x.\n      x \\<in> ?A \\<Longrightarrow> (0::?'a) \\<le> ?f x) \\<Longrightarrow>\n  (0::?'a) \\<le> sum ?f ?A\n\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i<l. \\<bar>u 1 ((T ^^ i) ((T ^^ (n - l)) x))\\<bar>)", "by auto"], ["proof (state)\nthis:\n  0 \\<le> birkhoff_sum f l ((T ^^ (n - l)) x)\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "ultimately"], ["proof (chain)\npicking this:\n  birkhoff_sum f (n - l + l) x =\n  birkhoff_sum f (n - l) x + birkhoff_sum f l ((T ^^ (n - l)) x)\n  0 \\<le> birkhoff_sum f l ((T ^^ (n - l)) x)", "have **: \"birkhoff_sum f (n-l) x \\<le> birkhoff_sum f n x\""], ["proof (prove)\nusing this:\n  birkhoff_sum f (n - l + l) x =\n  birkhoff_sum f (n - l) x + birkhoff_sum f l ((T ^^ (n - l)) x)\n  0 \\<le> birkhoff_sum f l ((T ^^ (n - l)) x)\n\ngoal (1 subgoal):\n 1. birkhoff_sum f (n - l) x \\<le> birkhoff_sum f n x", "using l(1)"], ["proof (prove)\nusing this:\n  birkhoff_sum f (n - l + l) x =\n  birkhoff_sum f (n - l) x + birkhoff_sum f l ((T ^^ (n - l)) x)\n  0 \\<le> birkhoff_sum f l ((T ^^ (n - l)) x)\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. birkhoff_sum f (n - l) x \\<le> birkhoff_sum f n x", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum f (n - l) x \\<le> birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"u n x \\<le> u (n-l) x - c * l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u n x \\<le> u (n - l) x - c * real l", "using l"], ["proof (prove)\nusing this:\n  l \\<in> {1..n}\n  u n x - u (n - l) x \\<le> - c * real l\n\ngoal (1 subgoal):\n 1. u n x \\<le> u (n - l) x - c * real l", "by simp"], ["proof (state)\nthis:\n  u n x \\<le> u (n - l) x - c * real l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  u n x \\<le> u (n - l) x - c * real l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... \\<le> U (n-l) - c* l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n - l) x - c * real l \\<le> U (n - l) - c * real l", "using H \\<open>n-l < n\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>m<n. u m x \\<le> U m\n  n - l < n\n\ngoal (1 subgoal):\n 1. u (n - l) x - c * real l \\<le> U (n - l) - c * real l", "by auto"], ["proof (state)\nthis:\n  u (n - l) x - c * real l \\<le> U (n - l) - c * real l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  u (n - l) x - c * real l \\<le> U (n - l) - c * real l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... = abs(u 0 x) + birkhoff_sum f (n-l) x - c * card (V c x \\<inter> {1..n-l}) - c*l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U (n - l) - c * real l =\n    \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - l) x -\n    c * real (card (V c x \\<inter> {1..n - l})) -\n    c * real l", "unfolding U_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - l) x -\n    c * real (card (V c x \\<inter> {1..n - l})) -\n    c * real l =\n    \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - l) x -\n    c * real (card (V c x \\<inter> {1..n - l})) -\n    c * real l", "by auto"], ["proof (state)\nthis:\n  U (n - l) - c * real l =\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - l) x -\n  c * real (card (V c x \\<inter> {1..n - l})) -\n  c * real l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "also"], ["proof (state)\nthis:\n  U (n - l) - c * real l =\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - l) x -\n  c * real (card (V c x \\<inter> {1..n - l})) -\n  c * real l\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "have \"... \\<le> abs(u 0 x) + birkhoff_sum f n x - c * card (V c x \\<inter> {1..n})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - l) x -\n    c * real (card (V c x \\<inter> {1..n - l})) -\n    c * real l\n    \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n          c * real (card (V c x \\<inter> {1..n}))", "using * **"], ["proof (prove)\nusing this:\n  - c * real (card (V c x \\<inter> {1..n - l})) - c * real l\n  \\<le> - c * real (card (V c x \\<inter> {1..n}))\n  birkhoff_sum f (n - l) x \\<le> birkhoff_sum f n x\n\ngoal (1 subgoal):\n 1. \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - l) x -\n    c * real (card (V c x \\<inter> {1..n - l})) -\n    c * real l\n    \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n          c * real (card (V c x \\<inter> {1..n}))", "by simp"], ["proof (state)\nthis:\n  \\<bar>u 0 x\\<bar> + birkhoff_sum f (n - l) x -\n  c * real (card (V c x \\<inter> {1..n - l})) -\n  c * real l\n  \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n        c * real (card (V c x \\<inter> {1..n}))\n\ngoal (1 subgoal):\n 1. 1 \\<le> n \\<and> n \\<in> V c x \\<Longrightarrow> u n x \\<le> U n", "finally"], ["proof (chain)\npicking this:\n  u n x\n  \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n        c * real (card (V c x \\<inter> {1..n}))", "show ?thesis"], ["proof (prove)\nusing this:\n  u n x\n  \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n        c * real (card (V c x \\<inter> {1..n}))\n\ngoal (1 subgoal):\n 1. u n x \\<le> U n", "unfolding U_def"], ["proof (prove)\nusing this:\n  u n x\n  \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n        c * real (card (V c x \\<inter> {1..n}))\n\ngoal (1 subgoal):\n 1. u n x\n    \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n          c * real (card (V c x \\<inter> {1..n}))", "by auto"], ["proof (state)\nthis:\n  u n x \\<le> U n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u n x \\<le> U n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u ?n12 x \\<le> U ?n12\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have \"(\\<lambda>n. abs(u 0 x) * (1/n) + birkhoff_sum f n x / n - u n x / n) \\<longlonglongrightarrow> abs(u 0 x) * 0 + real_cond_exp M Invariants f x - 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<bar>u 0 x\\<bar> * (1 / real n) + birkhoff_sum f n x / real n -\n        u n x / real n)\n    \\<longlonglongrightarrow> \\<bar>u 0 x\\<bar> * 0 +\n                              real_cond_exp M Invariants f x -\n                              0", "apply (intro tendsto_intros)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>xa. birkhoff_sum f xa x / real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n 2. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> 0", "using \\<open>x \\<in> G\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> G\n\ngoal (2 subgoals):\n 1. (\\<lambda>xa. birkhoff_sum f xa x / real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n 2. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> 0", "unfolding G_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           (\\<lambda>n. birkhoff_sum f n x / real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants f x \\<and>\n           (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0}\n\ngoal (2 subgoals):\n 1. (\\<lambda>xa. birkhoff_sum f xa x / real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n 2. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<bar>u 0 x\\<bar> * (1 / real n) + birkhoff_sum f n x / real n -\n      u n x / real n)\n  \\<longlonglongrightarrow> \\<bar>u 0 x\\<bar> * 0 +\n                            real_cond_exp M Invariants f x -\n                            0\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<bar>u 0 x\\<bar> * (1 / real n) + birkhoff_sum f n x / real n -\n      u n x / real n)\n  \\<longlonglongrightarrow> \\<bar>u 0 x\\<bar> * 0 +\n                            real_cond_exp M Invariants f x -\n                            0\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have \"(abs(u 0 x) + birkhoff_sum f n x - u n x)/n = abs(u 0 x) * (1/n) + birkhoff_sum f n x / n - u n x / n\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<bar>u 0 x\\<bar> + birkhoff_sum f n x - u n x) / real n =\n    \\<bar>u 0 x\\<bar> * (1 / real n) + birkhoff_sum f n x / real n -\n    u n x / real n", "by (auto simp add: add_divide_distrib diff_divide_distrib)"], ["proof (state)\nthis:\n  (\\<bar>u 0 x\\<bar> + birkhoff_sum f ?n12 x - u ?n12 x) / real ?n12 =\n  \\<bar>u 0 x\\<bar> * (1 / real ?n12) + birkhoff_sum f ?n12 x / real ?n12 -\n  u ?n12 x / real ?n12\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>n.\n      \\<bar>u 0 x\\<bar> * (1 / real n) + birkhoff_sum f n x / real n -\n      u n x / real n)\n  \\<longlonglongrightarrow> \\<bar>u 0 x\\<bar> * 0 +\n                            real_cond_exp M Invariants f x -\n                            0\n  (\\<bar>u 0 x\\<bar> + birkhoff_sum f ?n12 x - u ?n12 x) / real ?n12 =\n  \\<bar>u 0 x\\<bar> * (1 / real ?n12) + birkhoff_sum f ?n12 x / real ?n12 -\n  u ?n12 x / real ?n12", "have \"(\\<lambda>n. (abs(u 0 x) + birkhoff_sum f n x - u n x)/n) \\<longlonglongrightarrow> real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      \\<bar>u 0 x\\<bar> * (1 / real n) + birkhoff_sum f n x / real n -\n      u n x / real n)\n  \\<longlonglongrightarrow> \\<bar>u 0 x\\<bar> * 0 +\n                            real_cond_exp M Invariants f x -\n                            0\n  (\\<bar>u 0 x\\<bar> + birkhoff_sum f ?n12 x - u ?n12 x) / real ?n12 =\n  \\<bar>u 0 x\\<bar> * (1 / real ?n12) + birkhoff_sum f ?n12 x / real ?n12 -\n  u ?n12 x / real ?n12\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. (\\<bar>u 0 x\\<bar> + birkhoff_sum f n x - u n x) / real n)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. (\\<bar>u 0 x\\<bar> + birkhoff_sum f n x - u n x) / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. (\\<bar>u 0 x\\<bar> + birkhoff_sum f n x - u n x) / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x", "have a: \"limsup (\\<lambda>n. (abs(u 0 x) + birkhoff_sum f n x - u n x)/n) = real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. (\\<bar>u 0 x\\<bar> + birkhoff_sum f n x - u n x) / real n)\n  \\<longlonglongrightarrow> real_cond_exp M Invariants f x\n\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>xa.\n         ereal\n          ((\\<bar>u 0 x\\<bar> + birkhoff_sum f xa x - u xa x) / real xa)) =\n    ereal (real_cond_exp M Invariants f x)", "by (simp add: assms lim_imp_Limsup)"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>xa.\n       ereal\n        ((\\<bar>u 0 x\\<bar> + birkhoff_sum f xa x - u xa x) / real xa)) =\n  ereal (real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have \"c * card (V c x \\<inter> {1..n})/n \\<le> (abs(u 0 x) + birkhoff_sum f n x - u n x)/n\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. c * real (card (V c x \\<inter> {1..n})) / real n\n    \\<le> (\\<bar>u 0 x\\<bar> + birkhoff_sum f n x - u n x) / real n", "using main[of n]"], ["proof (prove)\nusing this:\n  u n x \\<le> U n\n\ngoal (1 subgoal):\n 1. c * real (card (V c x \\<inter> {1..n})) / real n\n    \\<le> (\\<bar>u 0 x\\<bar> + birkhoff_sum f n x - u n x) / real n", "unfolding U_def"], ["proof (prove)\nusing this:\n  u n x\n  \\<le> \\<bar>u 0 x\\<bar> + birkhoff_sum f n x -\n        c * real (card (V c x \\<inter> {1..n}))\n\ngoal (1 subgoal):\n 1. c * real (card (V c x \\<inter> {1..n})) / real n\n    \\<le> (\\<bar>u 0 x\\<bar> + birkhoff_sum f n x - u n x) / real n", "by (simp add: divide_right_mono)"], ["proof (state)\nthis:\n  c * real (card (V c x \\<inter> {1..?n12})) / real ?n12\n  \\<le> (\\<bar>u 0 x\\<bar> + birkhoff_sum f ?n12 x - u ?n12 x) / real ?n12\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "then"], ["proof (chain)\npicking this:\n  c * real (card (V c x \\<inter> {1..?n12})) / real ?n12\n  \\<le> (\\<bar>u 0 x\\<bar> + birkhoff_sum f ?n12 x - u ?n12 x) / real ?n12", "have \"limsup (\\<lambda>n. c * card (V c x \\<inter> {1..n})/n) \\<le> limsup (\\<lambda>n. (abs(u 0 x) + birkhoff_sum f n x - u n x)/n)\""], ["proof (prove)\nusing this:\n  c * real (card (V c x \\<inter> {1..?n12})) / real ?n12\n  \\<le> (\\<bar>u 0 x\\<bar> + birkhoff_sum f ?n12 x - u ?n12 x) / real ?n12\n\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>xa.\n         ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n    \\<le> limsup\n           (\\<lambda>xa.\n               ereal\n                ((\\<bar>u 0 x\\<bar> + birkhoff_sum f xa x - u xa x) /\n                 real xa))", "by (simp add: Limsup_mono)"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>xa. ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n  \\<le> limsup\n         (\\<lambda>xa.\n             ereal\n              ((\\<bar>u 0 x\\<bar> + birkhoff_sum f xa x - u xa x) /\n               real xa))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "then"], ["proof (chain)\npicking this:\n  limsup\n   (\\<lambda>xa. ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n  \\<le> limsup\n         (\\<lambda>xa.\n             ereal\n              ((\\<bar>u 0 x\\<bar> + birkhoff_sum f xa x - u xa x) /\n               real xa))", "have b: \"limsup (\\<lambda>n. c * card (V c x \\<inter> {1..n})/n) \\<le> real_cond_exp M Invariants f x\""], ["proof (prove)\nusing this:\n  limsup\n   (\\<lambda>xa. ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n  \\<le> limsup\n         (\\<lambda>xa.\n             ereal\n              ((\\<bar>u 0 x\\<bar> + birkhoff_sum f xa x - u xa x) /\n               real xa))\n\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>xa.\n         ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n    \\<le> ereal (real_cond_exp M Invariants f x)", "using a"], ["proof (prove)\nusing this:\n  limsup\n   (\\<lambda>xa. ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n  \\<le> limsup\n         (\\<lambda>xa.\n             ereal\n              ((\\<bar>u 0 x\\<bar> + birkhoff_sum f xa x - u xa x) /\n               real xa))\n  limsup\n   (\\<lambda>xa.\n       ereal\n        ((\\<bar>u 0 x\\<bar> + birkhoff_sum f xa x - u xa x) / real xa)) =\n  ereal (real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>xa.\n         ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n    \\<le> ereal (real_cond_exp M Invariants f x)", "by simp"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>xa. ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n  \\<le> ereal (real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have \"ereal(upper_asymptotic_density (V c x)) = limsup (\\<lambda>n. card (V c x \\<inter> {1..n})/n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ereal (upper_asymptotic_density (V c x)) =\n    limsup\n     (\\<lambda>xa. ereal (real (card (V c x \\<inter> {1..xa})) / real xa))", "using upper_asymptotic_density_shift[of \"V c x\" 1 0]"], ["proof (prove)\nusing this:\n  ereal (upper_asymptotic_density (V c x)) =\n  limsup\n   (\\<lambda>xa.\n       ereal (real (card (V c x \\<inter> {1..nat (int xa + 0)})) / real xa))\n\ngoal (1 subgoal):\n 1. ereal (upper_asymptotic_density (V c x)) =\n    limsup\n     (\\<lambda>xa. ereal (real (card (V c x \\<inter> {1..xa})) / real xa))", "by auto"], ["proof (state)\nthis:\n  ereal (upper_asymptotic_density (V c x)) =\n  limsup\n   (\\<lambda>xa. ereal (real (card (V c x \\<inter> {1..xa})) / real xa))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "also"], ["proof (state)\nthis:\n  ereal (upper_asymptotic_density (V c x)) =\n  limsup\n   (\\<lambda>xa. ereal (real (card (V c x \\<inter> {1..xa})) / real xa))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have \"... = limsup (\\<lambda>n. ereal(1/c) * ereal(c * card (V c x \\<inter> {1..n})/n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>xa. ereal (real (card (V c x \\<inter> {1..xa})) / real xa)) =\n    limsup\n     (\\<lambda>n.\n         ereal (1 / c) *\n         ereal (c * real (card (V c x \\<inter> {1..n})) / real n))", "by auto"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>xa. ereal (real (card (V c x \\<inter> {1..xa})) / real xa)) =\n  limsup\n   (\\<lambda>n.\n       ereal (1 / c) *\n       ereal (c * real (card (V c x \\<inter> {1..n})) / real n))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "also"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>xa. ereal (real (card (V c x \\<inter> {1..xa})) / real xa)) =\n  limsup\n   (\\<lambda>n.\n       ereal (1 / c) *\n       ereal (c * real (card (V c x \\<inter> {1..n})) / real n))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have \"... = (1/c) * limsup (\\<lambda>n. c * card (V c x \\<inter> {1..n})/n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>n.\n         ereal (1 / c) *\n         ereal (c * real (card (V c x \\<inter> {1..n})) / real n)) =\n    ereal (1 / c) *\n    limsup\n     (\\<lambda>xa.\n         ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))", "by (rule limsup_ereal_mult_left, auto)"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>n.\n       ereal (1 / c) *\n       ereal (c * real (card (V c x \\<inter> {1..n})) / real n)) =\n  ereal (1 / c) *\n  limsup\n   (\\<lambda>xa. ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "also"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>n.\n       ereal (1 / c) *\n       ereal (c * real (card (V c x \\<inter> {1..n})) / real n)) =\n  ereal (1 / c) *\n  limsup\n   (\\<lambda>xa. ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "have \"... \\<le> ereal (1/c) * real_cond_exp M Invariants f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ereal (1 / c) *\n    limsup\n     (\\<lambda>xa.\n         ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n    \\<le> ereal (1 / c) * ereal (real_cond_exp M Invariants f x)", "by (rule ereal_mult_left_mono[OF b], auto)"], ["proof (state)\nthis:\n  ereal (1 / c) *\n  limsup\n   (\\<lambda>xa. ereal (c * real (card (V c x \\<inter> {1..xa})) / real xa))\n  \\<le> ereal (1 / c) * ereal (real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "finally"], ["proof (chain)\npicking this:\n  ereal (upper_asymptotic_density (V c x))\n  \\<le> ereal (1 / c) * ereal (real_cond_exp M Invariants f x)", "show \"upper_asymptotic_density (V c x) \\<le> real_cond_exp M Invariants f x / c\""], ["proof (prove)\nusing this:\n  ereal (upper_asymptotic_density (V c x))\n  \\<le> ereal (1 / c) * ereal (real_cond_exp M Invariants f x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V c x)\n    \\<le> real_cond_exp M Invariants f x / c", "by auto"], ["proof (state)\nthis:\n  upper_asymptotic_density (V c x) \\<le> real_cond_exp M Invariants f x / c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?c12; ?x12 \\<in> G\\<rbrakk>\n  \\<Longrightarrow> upper_asymptotic_density (V ?c12 ?x12)\n                    \\<le> real_cond_exp M Invariants f ?x12 / ?c12\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "{"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?c12; ?x12 \\<in> G\\<rbrakk>\n  \\<Longrightarrow> upper_asymptotic_density (V ?c12 ?x12)\n                    \\<le> real_cond_exp M Invariants f ?x12 / ?c12\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "fix r::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "obtain c::nat where \"r / d < c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c. r / d < real c \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using reals_Archimedean2"], ["proof (prove)\nusing this:\n  \\<exists>n. ?x < of_nat n\n\ngoal (1 subgoal):\n 1. (\\<And>c. r / d < real c \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  r / d < real c\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  r / d < real c", "have \"r/d < real c+1\""], ["proof (prove)\nusing this:\n  r / d < real c\n\ngoal (1 subgoal):\n 1. r / d < real c + 1", "by auto"], ["proof (state)\nthis:\n  r / d < real c + 1\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  r / d < real c + 1", "have \"r / (real c+1) < d\""], ["proof (prove)\nusing this:\n  r / d < real c + 1\n\ngoal (1 subgoal):\n 1. r / (real c + 1) < d", "using \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  r / d < real c + 1\n  0 < d\n\ngoal (1 subgoal):\n 1. r / (real c + 1) < d", "by (simp add: divide_less_eq mult.commute)"], ["proof (state)\nthis:\n  r / (real c + 1) < d\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  r / (real c + 1) < d", "have \"\\<exists>c::nat. r / (real c+1) < d\""], ["proof (prove)\nusing this:\n  r / (real c + 1) < d\n\ngoal (1 subgoal):\n 1. \\<exists>c. r / (real c + 1) < d", "by auto"], ["proof (state)\nthis:\n  \\<exists>c. r / (real c + 1) < d\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "}"], ["proof (state)\nthis:\n  \\<exists>c. ?r14 / (real c + 1) < d\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  \\<exists>c. ?r14 / (real c + 1) < d", "have unG: \"(\\<Union>c::nat. {x \\<in> G. real_cond_exp M Invariants f x / (c+1) < d}) = G\""], ["proof (prove)\nusing this:\n  \\<exists>c. ?r14 / (real c + 1) < d\n\ngoal (1 subgoal):\n 1. (\\<Union>x.\n        {xa \\<in> G. real_cond_exp M Invariants f xa / (real x + 1) < d}) =\n    G", "by auto"], ["proof (state)\nthis:\n  (\\<Union>x.\n      {xa \\<in> G. real_cond_exp M Invariants f xa / (real x + 1) < d}) =\n  G\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have *: \"r < d * (real n + 1)\" if \"m \\<le> n\" \"r < d * (real m + 1)\" for m n r"], ["proof (prove)\ngoal (1 subgoal):\n 1. r < d * (real n + 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. r < d * (real n + 1)", "have \"d * (real m + 1) \\<le> d * (real n + 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d * (real m + 1) \\<le> d * (real n + 1)", "using \\<open>d>0\\<close> \\<open>m \\<le> n\\<close>"], ["proof (prove)\nusing this:\n  0 < d\n  m \\<le> n\n\ngoal (1 subgoal):\n 1. d * (real m + 1) \\<le> d * (real n + 1)", "by auto"], ["proof (state)\nthis:\n  d * (real m + 1) \\<le> d * (real n + 1)\n\ngoal (1 subgoal):\n 1. r < d * (real n + 1)", "then"], ["proof (chain)\npicking this:\n  d * (real m + 1) \\<le> d * (real n + 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  d * (real m + 1) \\<le> d * (real n + 1)\n\ngoal (1 subgoal):\n 1. r < d * (real n + 1)", "using \\<open>r < d * (real m + 1)\\<close>"], ["proof (prove)\nusing this:\n  d * (real m + 1) \\<le> d * (real n + 1)\n  r < d * (real m + 1)\n\ngoal (1 subgoal):\n 1. r < d * (real n + 1)", "by auto"], ["proof (state)\nthis:\n  r < d * (real n + 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?m12 \\<le> ?n12; ?r12 < d * (real ?m12 + 1)\\<rbrakk>\n  \\<Longrightarrow> ?r12 < d * (real ?n12 + 1)\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have \"(\\<lambda>c. emeasure M {x \\<in> G. real_cond_exp M Invariants f x / (real c+1) < d})\n          \\<longlonglongrightarrow> emeasure M (\\<Union>c::nat. {x \\<in> G. real_cond_exp M Invariants f x / (c+1) < d})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>c.\n        emeasure M\n         {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n    \\<longlonglongrightarrow> emeasure M\n                               (\\<Union>x.\n                                   {xa \\<in> G.\n                                    real_cond_exp M Invariants f xa /\n                                    (real x + 1)\n                                    < d})", "apply (rule Lim_emeasure_incseq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. range\n     (\\<lambda>i.\n         {x \\<in> G. real_cond_exp M Invariants f x / (real i + 1) < d})\n    \\<subseteq> events\n 2. incseq\n     (\\<lambda>i.\n         {x \\<in> G. real_cond_exp M Invariants f x / (real i + 1) < d})", "unfolding incseq_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. range\n     (\\<lambda>i.\n         {x \\<in> G. real_cond_exp M Invariants f x / (real i + 1) < d})\n    \\<subseteq> events\n 2. \\<forall>m n.\n       m \\<le> n \\<longrightarrow>\n       {x \\<in> G. real_cond_exp M Invariants f x / (real m + 1) < d}\n       \\<subseteq> {x \\<in> G.\n                    real_cond_exp M Invariants f x / (real n + 1) < d}", "by (auto simp add: divide_simps *)"], ["proof (state)\nthis:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>x.\n                                 {xa \\<in> G.\n                                  real_cond_exp M Invariants f xa /\n                                  (real x + 1)\n                                  < d})\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>x.\n                                 {xa \\<in> G.\n                                  real_cond_exp M Invariants f xa /\n                                  (real x + 1)\n                                  < d})", "have \"(\\<lambda>c. emeasure M {x \\<in> G. real_cond_exp M Invariants f x / (real c+1) < d}) \\<longlonglongrightarrow> emeasure M G\""], ["proof (prove)\nusing this:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>x.\n                                 {xa \\<in> G.\n                                  real_cond_exp M Invariants f xa /\n                                  (real x + 1)\n                                  < d})\n\ngoal (1 subgoal):\n 1. (\\<lambda>c.\n        emeasure M\n         {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n    \\<longlonglongrightarrow> emeasure M G", "using unG"], ["proof (prove)\nusing this:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>x.\n                                 {xa \\<in> G.\n                                  real_cond_exp M Invariants f xa /\n                                  (real x + 1)\n                                  < d})\n  (\\<Union>x.\n      {xa \\<in> G. real_cond_exp M Invariants f xa / (real x + 1) < d}) =\n  G\n\ngoal (1 subgoal):\n 1. (\\<lambda>c.\n        emeasure M\n         {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n    \\<longlonglongrightarrow> emeasure M G", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> emeasure M G\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> emeasure M G", "have \"(\\<lambda>c. emeasure M {x \\<in> G. real_cond_exp M Invariants f x / (real c+1) < d}) \\<longlonglongrightarrow> 1\""], ["proof (prove)\nusing this:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> emeasure M G\n\ngoal (1 subgoal):\n 1. (\\<lambda>c.\n        emeasure M\n         {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n    \\<longlonglongrightarrow> 1", "using \\<open>emeasure M G = 1\\<close>"], ["proof (prove)\nusing this:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> emeasure M G\n  emeasure M G = 1\n\ngoal (1 subgoal):\n 1. (\\<lambda>c.\n        emeasure M\n         {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n    \\<longlonglongrightarrow> 1", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> 1\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> 1", "have \"eventually (\\<lambda>c. emeasure M {x \\<in> G. real_cond_exp M Invariants f x / (real c+1) < d} > 1 - d) sequentially\""], ["proof (prove)\nusing this:\n  (\\<lambda>c.\n      emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d})\n  \\<longlonglongrightarrow> 1\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F c in sequentially.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d}", "apply (rule order_tendstoD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d) < 1", "apply (insert \\<open>0<d\\<close>, auto simp add: ennreal_1[symmetric] ennreal_lessI simp del: ennreal_1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F c in sequentially.\n     ennreal (1 - d)\n     < emeasure M\n        {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F c in sequentially.\n     ennreal (1 - d)\n     < emeasure M\n        {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d}", "obtain c0 where c0: \"emeasure M {x \\<in> G. real_cond_exp M Invariants f x / (real c0+1) < d} > 1 - d\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F c in sequentially.\n     ennreal (1 - d)\n     < emeasure M\n        {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d}\n\ngoal (1 subgoal):\n 1. (\\<And>c0.\n        ennreal (1 - d)\n        < emeasure M\n           {x \\<in> G.\n            real_cond_exp M Invariants f x / (real c0 + 1)\n            < d} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using eventually_sequentially"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F c in sequentially.\n     ennreal (1 - d)\n     < emeasure M\n        {x \\<in> G. real_cond_exp M Invariants f x / (real c + 1) < d}\n  eventually ?P sequentially = (\\<exists>N. \\<forall>n\\<ge>N. ?P n)\n\ngoal (1 subgoal):\n 1. (\\<And>c0.\n        ennreal (1 - d)\n        < emeasure M\n           {x \\<in> G.\n            real_cond_exp M Invariants f x / (real c0 + 1)\n            < d} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> G. real_cond_exp M Invariants f x / (real c0 + 1) < d}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "define c where \"c = real c0 + 1\""], ["proof (state)\nthis:\n  c = real c0 + 1\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  c = real c0 + 1", "have \"c > 0\""], ["proof (prove)\nusing this:\n  c = real c0 + 1\n\ngoal (1 subgoal):\n 1. 0 < c", "by auto"], ["proof (state)\nthis:\n  0 < c\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have *: \"emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d} > 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d}", "unfolding c_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c0 + 1) < d}", "using c0"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> G. real_cond_exp M Invariants f x / (real c0 + 1) < d}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       {x \\<in> G. real_cond_exp M Invariants f x / (real c0 + 1) < d}", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  < emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "have \"{x \\<in> G. real_cond_exp M Invariants f x / c < d} \\<subseteq> {x \\<in> space M. upper_asymptotic_density (V c x) < d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n    \\<subseteq> {x \\<in> space M. upper_asymptotic_density (V c x) < d}", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> G; real_cond_exp M Invariants f x / c < d\\<rbrakk>\n       \\<Longrightarrow> x \\<in> space M\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> G; real_cond_exp M Invariants f x / c < d\\<rbrakk>\n       \\<Longrightarrow> upper_asymptotic_density (V c x) < d", "using G_def"], ["proof (prove)\nusing this:\n  G =\n  {x \\<in> space M.\n   (\\<lambda>n. birkhoff_sum f n x / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants f x \\<and>\n   (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0}\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> G; real_cond_exp M Invariants f x / c < d\\<rbrakk>\n       \\<Longrightarrow> x \\<in> space M\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> G; real_cond_exp M Invariants f x / c < d\\<rbrakk>\n       \\<Longrightarrow> upper_asymptotic_density (V c x) < d", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> G; real_cond_exp M Invariants f x / c < d\\<rbrakk>\n       \\<Longrightarrow> upper_asymptotic_density (V c x) < d", "using I[OF \\<open>c>0\\<close>]"], ["proof (prove)\nusing this:\n  ?x12 \\<in> G \\<Longrightarrow>\n  upper_asymptotic_density (V c ?x12)\n  \\<le> real_cond_exp M Invariants f ?x12 / c\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> G; real_cond_exp M Invariants f x / c < d\\<rbrakk>\n       \\<Longrightarrow> upper_asymptotic_density (V c x) < d", "by fastforce"], ["proof (state)\nthis:\n  {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n  \\<subseteq> {x \\<in> space M. upper_asymptotic_density (V c x) < d}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n  \\<subseteq> {x \\<in> space M. upper_asymptotic_density (V c x) < d}", "have \"emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d} \\<le> emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}\""], ["proof (prove)\nusing this:\n  {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n  \\<subseteq> {x \\<in> space M. upper_asymptotic_density (V c x) < d}\n\ngoal (1 subgoal):\n 1. emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n    \\<le> emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}", "apply (rule emeasure_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M. upper_asymptotic_density (V c x) < d} \\<in> events", "unfolding V_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     upper_asymptotic_density\n      {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c * real l}\n     < d}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n  \\<le> emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n  \\<le> emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}", "have \"emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d} > 1 - d\""], ["proof (prove)\nusing this:\n  emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n  \\<le> emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}", "using *"], ["proof (prove)\nusing this:\n  emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n  \\<le> emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}\n  ennreal (1 - d)\n  < emeasure M {x \\<in> G. real_cond_exp M Invariants f x / c < d}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  < emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  ennreal (1 - d)\n  < emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  < emeasure M {x \\<in> space M. upper_asymptotic_density (V c x) < d}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "unfolding V_def"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c * real l}\n      < d}\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "using \\<open>c>0\\<close>"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c * real l}\n      < d}\n  0 < c\n\ngoal (1 subgoal):\n 1. \\<exists>c>0.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c * real l}\n           < d}", "by auto"], ["proof (state)\nthis:\n  \\<exists>c>0.\n     ennreal (1 - d)\n     < emeasure M\n        {x \\<in> space M.\n         upper_asymptotic_density\n          {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c * real l}\n         < d}\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Next lemma is Lemma 2.2 in~\\cite{gouezel_karlsson}.\\<close>"], ["", "lemma upper_density_large_k:\n  assumes \"d > (0::real)\" \"d \\<le> 1\"\n  shows \"\\<exists>k::nat.\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - d * l} < d} > 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have [simp]: \"d>0\" \"d \\<noteq> 0\" \"d \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < d &&& d \\<noteq> 0 &&& 0 \\<le> d", "using \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  0 < d\n\ngoal (1 subgoal):\n 1. 0 < d &&& d \\<noteq> 0 &&& 0 \\<le> d", "by auto"], ["proof (state)\nthis:\n  0 < d\n  d \\<noteq> 0\n  0 \\<le> d\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define rho where \"rho = d * d * d / 4\""], ["proof (state)\nthis:\n  rho = d * d * d / 4\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have [simp]: \"rho > 0\" \"rho \\<noteq> 0\" \"rho \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < rho &&& rho \\<noteq> 0 &&& 0 \\<le> rho", "unfolding rho_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < d * d * d / 4 &&& d * d * d / 4 \\<noteq> 0 &&& 0 \\<le> d * d * d / 4", "using assms"], ["proof (prove)\nusing this:\n  0 < d\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. 0 < d * d * d / 4 &&& d * d * d / 4 \\<noteq> 0 &&& 0 \\<le> d * d * d / 4", "by auto"], ["proof (state)\nthis:\n  0 < rho\n  rho \\<noteq> 0\n  0 \\<le> rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "text \\<open>First step: choose a time scale $s$ at which all the computations will be done. the\n  integral of $u_s$ should be suitably small -- how small precisely is given by $\\rho$.\\<close>"], ["proof (state)\nthis:\n  0 < rho\n  rho \\<noteq> 0\n  0 \\<le> rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"ennreal(\\<integral>x. abs(u n x / n) \\<partial>M) = (\\<integral>\\<^sup>+x. abs(u n x /n - subcocycle_lim u x) \\<partial>M)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n    \\<integral>\\<^sup>+ x. ennreal\n                            \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                       \\<partial>M", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n    \\<integral>\\<^sup>+ x. ennreal\n                            \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                       \\<partial>M", "have \"ennreal(\\<integral>x. abs(u n x / n) \\<partial>M) = (\\<integral>\\<^sup>+x. abs(u n x /n) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n    \\<integral>\\<^sup>+ x. ennreal \\<bar>u n x / real n\\<bar> \\<partial>M", "apply (rule nn_integral_eq_integral[symmetric])"], ["proof (prove)\ngoal (2 subgoals):\n 1. integrable M (\\<lambda>x. \\<bar>u n x / real n\\<bar>)\n 2. AE x in M. 0 \\<le> \\<bar>u n x / real n\\<bar>", "using int_u"], ["proof (prove)\nusing this:\n  integrable M (u ?n)\n\ngoal (2 subgoals):\n 1. integrable M (\\<lambda>x. \\<bar>u n x / real n\\<bar>)\n 2. AE x in M. 0 \\<le> \\<bar>u n x / real n\\<bar>", "by auto"], ["proof (state)\nthis:\n  ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal \\<bar>u n x / real n\\<bar> \\<partial>M\n\ngoal (1 subgoal):\n 1. ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n    \\<integral>\\<^sup>+ x. ennreal\n                            \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                       \\<partial>M", "also"], ["proof (state)\nthis:\n  ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal \\<bar>u n x / real n\\<bar> \\<partial>M\n\ngoal (1 subgoal):\n 1. ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n    \\<integral>\\<^sup>+ x. ennreal\n                            \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                       \\<partial>M", "have \"... = (\\<integral>\\<^sup>+x. abs(u n x /n - subcocycle_lim u x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal \\<bar>u n x / real n\\<bar> \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal\n                            \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                       \\<partial>M", "apply (rule nn_integral_cong_AE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. ennreal \\<bar>u n x / real n\\<bar> =\n               ennreal \\<bar>u n x / real n - subcocycle_lim u x\\<bar>", "using subu_0"], ["proof (prove)\nusing this:\n  AE x in M. subcocycle_lim u x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. ennreal \\<bar>u n x / real n\\<bar> =\n               ennreal \\<bar>u n x / real n - subcocycle_lim u x\\<bar>", "by auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal \\<bar>u n x / real n\\<bar> \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n    \\<integral>\\<^sup>+ x. ennreal\n                            \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                       \\<partial>M", "finally"], ["proof (chain)\npicking this:\n  ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal\n                          \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                     \\<partial>M", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal\n                          \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n    \\<integral>\\<^sup>+ x. ennreal\n                            \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                       \\<partial>M", "by simp"], ["proof (state)\nthis:\n  ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal\n                          \\<bar>u n x / real n - subcocycle_lim u x\\<bar>\n                     \\<partial>M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ennreal (expectation (\\<lambda>x. \\<bar>u ?n12 x / real ?n12\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal\n                          \\<bar>u ?n12 x / real ?n12 -\n                                subcocycle_lim u x\\<bar>\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "moreover"], ["proof (state)\nthis:\n  ennreal (expectation (\\<lambda>x. \\<bar>u ?n12 x / real ?n12\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal\n                          \\<bar>u ?n12 x / real ?n12 -\n                                subcocycle_lim u x\\<bar>\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"(\\<lambda>n. \\<integral>\\<^sup>+x. abs(u n x /n - subcocycle_lim u x) \\<partial>M) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        \\<integral>\\<^sup>+ x. ennreal\n                                \\<bar>u n x / real n -\nsubcocycle_lim u x\\<bar>\n                           \\<partial>M)\n    \\<longlonglongrightarrow> 0", "by (rule kingman_theorem_nonergodic(3)[OF subu subu_fin])"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              \\<bar>u n x / real n -\n                                    subcocycle_lim u x\\<bar>\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "ultimately"], ["proof (chain)\npicking this:\n  ennreal (expectation (\\<lambda>x. \\<bar>u ?n12 x / real ?n12\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal\n                          \\<bar>u ?n12 x / real ?n12 -\n                                subcocycle_lim u x\\<bar>\n                     \\<partial>M\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              \\<bar>u n x / real n -\n                                    subcocycle_lim u x\\<bar>\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. ennreal(\\<integral>x. abs(u n x / n) \\<partial>M)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  ennreal (expectation (\\<lambda>x. \\<bar>u ?n12 x / real ?n12\\<bar>)) =\n  \\<integral>\\<^sup>+ x. ennreal\n                          \\<bar>u ?n12 x / real ?n12 -\n                                subcocycle_lim u x\\<bar>\n                     \\<partial>M\n  (\\<lambda>n.\n      \\<integral>\\<^sup>+ x. ennreal\n                              \\<bar>u n x / real n -\n                                    subcocycle_lim u x\\<bar>\n                         \\<partial>M)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)))\n    \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n.\n      ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)))\n  \\<longlonglongrightarrow> 0", "have \"(\\<lambda>n. (\\<integral>x. abs(u n x / n) \\<partial>M)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      ennreal (expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>)))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>))\n    \\<longlonglongrightarrow> 0", "by (simp add: ennreal_0[symmetric] del: ennreal_0)"], ["proof (state)\nthis:\n  (\\<lambda>n. expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>))\n  \\<longlonglongrightarrow> 0", "have \"eventually (\\<lambda>n. (\\<integral>x. abs(u n x / n) \\<partial>M) < rho) sequentially\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>) < rho", "by (rule order_tendstoD(2), auto)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>) < rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>) < rho", "obtain s::nat where [simp]: \"s>0\" and s_int: \"(\\<integral>x. abs(u s x / s) \\<partial>M) < rho\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     expectation (\\<lambda>x. \\<bar>u n x / real n\\<bar>) < rho\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>0 < s;\n         expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>) < rho\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis (mono_tags, lifting) neq0_conv eventually_sequentially gr_implies_not0\n        linorder_not_le of_nat_0_eq_iff order_refl zero_neq_one)"], ["proof (state)\nthis:\n  0 < s\n  expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>) < rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "text \\<open>Second step: a truncation argument, to decompose $|u_1|$ as a sum of a constant (its\n  contribution will be small if $k$ is large at the end of the argument) and of a function with\n  small integral).\\<close>"], ["proof (state)\nthis:\n  0 < s\n  expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>) < rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"(\\<lambda>n. (\\<integral>x. abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> n} x \\<partial>M)) \\<longlonglongrightarrow> (\\<integral>x. 0 \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        expectation\n         (\\<lambda>xa.\n             \\<bar>u 1 xa\\<bar> *\n             indicat_real\n              {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>} xa))\n    \\<longlonglongrightarrow> expectation (\\<lambda>x. 0)", "proof (rule integral_dominated_convergence[where ?w = \"\\<lambda>x. abs(u 1 x)\"])"], ["proof (state)\ngoal (5 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 4. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0\n 5. \\<And>x.\n       AE xa in M. norm\n                    (\\<bar>u 1 xa\\<bar> *\n                     indicat_real\n                      {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n                      xa)\n                   \\<le> \\<bar>u 1 xa\\<bar>", "show \"AE x in M. norm (abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> n} x) \\<le> abs(u 1 x)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. norm\n                (\\<bar>u 1 x\\<bar> *\n                 indicat_real {x \\<in> space M. n \\<le> \\<bar>u 1 x\\<bar>}\n                  x)\n               \\<le> \\<bar>u 1 x\\<bar>", "unfolding indicator_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. norm\n                (\\<bar>u 1 x\\<bar> *\n                 (if x \\<in> {x \\<in> space M. n \\<le> \\<bar>u 1 x\\<bar>}\n                  then 1 else 0))\n               \\<le> \\<bar>u 1 x\\<bar>", "by auto"], ["proof (state)\nthis:\n  AE x in M. norm\n              (\\<bar>u 1 x\\<bar> *\n               indicat_real {x \\<in> space M. ?n12 \\<le> \\<bar>u 1 x\\<bar>}\n                x)\n             \\<le> \\<bar>u 1 x\\<bar>\n\ngoal (4 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 4. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0", "{"], ["proof (state)\nthis:\n  AE x in M. norm\n              (\\<bar>u 1 x\\<bar> *\n               indicat_real {x \\<in> space M. ?n12 \\<le> \\<bar>u 1 x\\<bar>}\n                x)\n             \\<le> \\<bar>u 1 x\\<bar>\n\ngoal (4 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 4. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0", "fix x"], ["proof (state)\ngoal (4 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 4. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0", "have \"abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> n} x = (0::real)\" if \"n > abs(u 1 x)\" for n::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 1 x\\<bar> *\n    indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} x =\n    0", "unfolding indicator_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 1 x\\<bar> *\n    (if x \\<in> {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} then 1\n     else 0) =\n    0", "using that"], ["proof (prove)\nusing this:\n  \\<bar>u 1 x\\<bar> < real n\n\ngoal (1 subgoal):\n 1. \\<bar>u 1 x\\<bar> *\n    (if x \\<in> {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} then 1\n     else 0) =\n    0", "by auto"], ["proof (state)\nthis:\n  \\<bar>u 1 x\\<bar> < real ?n12 \\<Longrightarrow>\n  \\<bar>u 1 x\\<bar> *\n  indicat_real {x \\<in> space M. real ?n12 \\<le> \\<bar>u 1 x\\<bar>} x =\n  0\n\ngoal (4 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 4. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  \\<bar>u 1 x\\<bar> < real ?n12 \\<Longrightarrow>\n  \\<bar>u 1 x\\<bar> *\n  indicat_real {x \\<in> space M. real ?n12 \\<le> \\<bar>u 1 x\\<bar>} x =\n  0", "have \"eventually (\\<lambda>n. abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> n} x = 0) sequentially\""], ["proof (prove)\nusing this:\n  \\<bar>u 1 x\\<bar> < real ?n12 \\<Longrightarrow>\n  \\<bar>u 1 x\\<bar> *\n  indicat_real {x \\<in> space M. real ?n12 \\<le> \\<bar>u 1 x\\<bar>} x =\n  0\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} x =\n       0", "by (metis (mono_tags, lifting) eventually_at_top_linorder reals_Archimedean2 less_le_trans of_nat_le_iff)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     \\<bar>u 1 x\\<bar> *\n     indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} x =\n     0\n\ngoal (4 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 4. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     \\<bar>u 1 x\\<bar> *\n     indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} x =\n     0", "have \"(\\<lambda>n. abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> n} x) \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     \\<bar>u 1 x\\<bar> *\n     indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} x =\n     0\n\ngoal (1 subgoal):\n 1. (\\<lambda>xa.\n        \\<bar>u 1 x\\<bar> *\n        indicat_real {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n    \\<longlonglongrightarrow> 0", "by (rule tendsto_eventually)"], ["proof (state)\nthis:\n  (\\<lambda>xa.\n      \\<bar>u 1 x\\<bar> *\n      indicat_real {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n  \\<longlonglongrightarrow> 0\n\ngoal (4 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 4. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0", "}"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      \\<bar>u 1 ?x14\\<bar> *\n      indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>} ?x14)\n  \\<longlonglongrightarrow> 0\n\ngoal (4 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 4. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      \\<bar>u 1 ?x14\\<bar> *\n      indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>} ?x14)\n  \\<longlonglongrightarrow> 0", "show \"AE x in M. (\\<lambda>n. abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> n} x) \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      \\<bar>u 1 ?x14\\<bar> *\n      indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>} ?x14)\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>xa.\n                   \\<bar>u 1 x\\<bar> *\n                   indicat_real\n                    {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<longlonglongrightarrow> 0", "by simp"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>xa.\n                 \\<bar>u 1 x\\<bar> *\n                 indicat_real\n                  {x \\<in> space M. real xa \\<le> \\<bar>u 1 x\\<bar>} x)\n             \\<longlonglongrightarrow> 0\n\ngoal (3 subgoals):\n 1. random_variable borel (\\<lambda>x. 0)\n 2. \\<And>x.\n       random_variable borel\n        (\\<lambda>xa.\n            \\<bar>u 1 xa\\<bar> *\n            indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n             xa)\n 3. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)", "qed (auto simp add: int_u)"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      expectation\n       (\\<lambda>xa.\n           \\<bar>u 1 xa\\<bar> *\n           indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n            xa))\n  \\<longlonglongrightarrow> expectation (\\<lambda>x. 0)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      expectation\n       (\\<lambda>xa.\n           \\<bar>u 1 xa\\<bar> *\n           indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n            xa))\n  \\<longlonglongrightarrow> expectation (\\<lambda>x. 0)", "have \"eventually (\\<lambda>n. (\\<integral>x. abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> n} x \\<partial>M) < rho) sequentially\""], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      expectation\n       (\\<lambda>xa.\n           \\<bar>u 1 xa\\<bar> *\n           indicat_real {xa \\<in> space M. real x \\<le> \\<bar>u 1 xa\\<bar>}\n            xa))\n  \\<longlonglongrightarrow> expectation (\\<lambda>x. 0)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       expectation\n        (\\<lambda>x.\n            \\<bar>u 1 x\\<bar> *\n            indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>}\n             x)\n       < rho", "by (rule order_tendstoD(2), auto)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     expectation\n      (\\<lambda>x.\n          \\<bar>u 1 x\\<bar> *\n          indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} x)\n     < rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially.\n     expectation\n      (\\<lambda>x.\n          \\<bar>u 1 x\\<bar> *\n          indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} x)\n     < rho", "obtain Knat::nat where Knat: \"Knat > 0\" \"(\\<integral>x. abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> Knat} x \\<partial>M) < rho\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially.\n     expectation\n      (\\<lambda>x.\n          \\<bar>u 1 x\\<bar> *\n          indicat_real {x \\<in> space M. real n \\<le> \\<bar>u 1 x\\<bar>} x)\n     < rho\n\ngoal (1 subgoal):\n 1. (\\<And>Knat.\n        \\<lbrakk>0 < Knat;\n         expectation\n          (\\<lambda>x.\n              \\<bar>u 1 x\\<bar> *\n              indicat_real\n               {x \\<in> space M. real Knat \\<le> \\<bar>u 1 x\\<bar>} x)\n         < rho\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis (mono_tags, lifting) eventually_sequentially gr_implies_not0 neq0_conv\n        linorder_not_le of_nat_0_eq_iff order_refl zero_neq_one)"], ["proof (state)\nthis:\n  0 < Knat\n  expectation\n   (\\<lambda>x.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. real Knat \\<le> \\<bar>u 1 x\\<bar>} x)\n  < rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define K where \"K = real Knat\""], ["proof (state)\nthis:\n  K = real Knat\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  K = real Knat", "have [simp]: \"K \\<ge> 0\" \"K>0\" and K: \"(\\<integral>x. abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> K} x \\<partial>M) < rho\""], ["proof (prove)\nusing this:\n  K = real Knat\n\ngoal (1 subgoal):\n 1. (0 \\<le> K &&& 0 < K) &&&\n    expectation\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> *\n         indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n    < rho", "using Knat"], ["proof (prove)\nusing this:\n  K = real Knat\n  0 < Knat\n  expectation\n   (\\<lambda>x.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. real Knat \\<le> \\<bar>u 1 x\\<bar>} x)\n  < rho\n\ngoal (1 subgoal):\n 1. (0 \\<le> K &&& 0 < K) &&&\n    expectation\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> *\n         indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n    < rho", "by auto"], ["proof (state)\nthis:\n  0 \\<le> K\n  0 < K\n  expectation\n   (\\<lambda>x.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n  < rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define F where \"F = (\\<lambda>x. abs(u 1 x) * indicator {x. abs(u 1 x) \\<ge> K} x)\""], ["proof (state)\nthis:\n  F =\n  (\\<lambda>x.\n      \\<bar>u 1 x\\<bar> * indicat_real {x. K \\<le> \\<bar>u 1 x\\<bar>} x)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have int_F [measurable]: \"integrable M F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M F", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> * indicat_real {x. K \\<le> \\<bar>u 1 x\\<bar>} x)", "apply (rule Bochner_Integration.integrable_bound[where ?f = \"\\<lambda>x. abs(u 1 x)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 2. random_variable borel\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> * indicat_real {x. K \\<le> \\<bar>u 1 x\\<bar>} x)\n 3. AE x in M. norm\n                (\\<bar>u 1 x\\<bar> *\n                 indicat_real {x. K \\<le> \\<bar>u 1 x\\<bar>} x)\n               \\<le> norm \\<bar>u 1 x\\<bar>", "unfolding indicator_def"], ["proof (prove)\ngoal (3 subgoals):\n 1. integrable M (\\<lambda>x. \\<bar>u 1 x\\<bar>)\n 2. random_variable borel\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> *\n         (if x \\<in> {x. K \\<le> \\<bar>u 1 x\\<bar>} then 1 else 0))\n 3. AE x in M. norm\n                (\\<bar>u 1 x\\<bar> *\n                 (if x \\<in> {x. K \\<le> \\<bar>u 1 x\\<bar>} then 1 else 0))\n               \\<le> norm \\<bar>u 1 x\\<bar>", "by (auto simp add: int_u)"], ["proof (state)\nthis:\n  integrable M F\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"(\\<integral>x. F x \\<partial>M) = (\\<integral>x. abs(u 1 x) * indicator {x \\<in> space M. abs(u 1 x) \\<ge> K} x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation F =\n    expectation\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> *\n         indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)", "apply (rule integral_cong_AE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. random_variable borel F\n 2. random_variable borel\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> *\n         indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n 3. AE x in M. F x =\n               \\<bar>u 1 x\\<bar> *\n               indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x", "unfolding F_def"], ["proof (prove)\ngoal (3 subgoals):\n 1. random_variable borel\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> * indicat_real {x. K \\<le> \\<bar>u 1 x\\<bar>} x)\n 2. random_variable borel\n     (\\<lambda>x.\n         \\<bar>u 1 x\\<bar> *\n         indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n 3. AE x in M. \\<bar>u 1 x\\<bar> *\n               indicat_real {x. K \\<le> \\<bar>u 1 x\\<bar>} x =\n               \\<bar>u 1 x\\<bar> *\n               indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x", "by (auto simp add: indicator_def)"], ["proof (state)\nthis:\n  expectation F =\n  expectation\n   (\\<lambda>x.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  expectation F =\n  expectation\n   (\\<lambda>x.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)", "have F_int: \"(\\<integral>x. F x \\<partial>M) < rho\""], ["proof (prove)\nusing this:\n  expectation F =\n  expectation\n   (\\<lambda>x.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n\ngoal (1 subgoal):\n 1. expectation F < rho", "using K"], ["proof (prove)\nusing this:\n  expectation F =\n  expectation\n   (\\<lambda>x.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n  expectation\n   (\\<lambda>x.\n       \\<bar>u 1 x\\<bar> *\n       indicat_real {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} x)\n  < rho\n\ngoal (1 subgoal):\n 1. expectation F < rho", "by auto"], ["proof (state)\nthis:\n  expectation F < rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have F_pos: \"F x \\<ge> 0\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> F x", "unfolding F_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> \\<bar>u 1 x\\<bar> *\n            indicat_real {x. K \\<le> \\<bar>u 1 x\\<bar>} x", "by auto"], ["proof (state)\nthis:\n  0 \\<le> F ?x12\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have u1_bound: \"abs(u 1 x) \\<le> K + F x\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 1 x\\<bar> \\<le> K + F x", "unfolding F_def indicator_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u 1 x\\<bar>\n    \\<le> K +\n          \\<bar>u 1 x\\<bar> *\n          (if x \\<in> {x. K \\<le> \\<bar>u 1 x\\<bar>} then 1 else 0)", "apply (cases \"x \\<in> {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. x \\<in> {x \\<in> space M. K \\<le> \\<bar>u 1 x\\<bar>} \\<Longrightarrow>\n    \\<bar>u 1 x\\<bar>\n    \\<le> K +\n          \\<bar>u 1 x\\<bar> *\n          (if x \\<in> {x. K \\<le> \\<bar>u 1 x\\<bar>} then 1 else 0)\n 2. x \\<notin> {x \\<in> space M.\n                K \\<le> \\<bar>u 1 x\\<bar>} \\<Longrightarrow>\n    \\<bar>u 1 x\\<bar>\n    \\<le> K +\n          \\<bar>u 1 x\\<bar> *\n          (if x \\<in> {x. K \\<le> \\<bar>u 1 x\\<bar>} then 1 else 0)", "by auto"], ["proof (state)\nthis:\n  \\<bar>u 1 ?x12\\<bar> \\<le> K + F ?x12\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define F2 where \"F2 = (\\<lambda>x. F x + abs(u s x/s))\""], ["proof (state)\nthis:\n  F2 = (\\<lambda>x. F x + \\<bar>u s x / real s\\<bar>)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have int_F2 [measurable]: \"integrable M F2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M F2", "unfolding F2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. F x + \\<bar>u s x / real s\\<bar>)", "using int_F int_u[of s]"], ["proof (prove)\nusing this:\n  integrable M F\n  integrable M (u s)\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. F x + \\<bar>u s x / real s\\<bar>)", "by auto"], ["proof (state)\nthis:\n  integrable M F2\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have F2_pos: \"F2 x \\<ge> 0\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> F2 x", "unfolding F2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> F x + \\<bar>u s x / real s\\<bar>", "using F_pos"], ["proof (prove)\nusing this:\n  0 \\<le> F ?x12\n\ngoal (1 subgoal):\n 1. 0 \\<le> F x + \\<bar>u s x / real s\\<bar>", "by auto"], ["proof (state)\nthis:\n  0 \\<le> F2 ?x12\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"(\\<integral>x. F2 x \\<partial>M) = (\\<integral>x. F x \\<partial>M) + (\\<integral>x. abs(u s x/s) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation F2 =\n    expectation F + expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "unfolding F2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. expectation (\\<lambda>x. F x + \\<bar>u s x / real s\\<bar>) =\n    expectation F + expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "apply (rule Bochner_Integration.integral_add)"], ["proof (prove)\ngoal (2 subgoals):\n 1. integrable M F\n 2. integrable M (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "using int_F int_u"], ["proof (prove)\nusing this:\n  integrable M F\n  integrable M (u ?n)\n\ngoal (2 subgoals):\n 1. integrable M F\n 2. integrable M (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "by auto"], ["proof (state)\nthis:\n  expectation F2 =\n  expectation F + expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  expectation F2 =\n  expectation F + expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "have F2_int: \"(\\<integral>x. F2 x \\<partial>M) < 2 * rho\""], ["proof (prove)\nusing this:\n  expectation F2 =\n  expectation F + expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>)\n\ngoal (1 subgoal):\n 1. expectation F2 < 2 * rho", "using F_int s_int"], ["proof (prove)\nusing this:\n  expectation F2 =\n  expectation F + expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>)\n  expectation F < rho\n  expectation (\\<lambda>x. \\<bar>u s x / real s\\<bar>) < rho\n\ngoal (1 subgoal):\n 1. expectation F2 < 2 * rho", "by auto"], ["proof (state)\nthis:\n  expectation F2 < 2 * rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "text \\<open>We can now choose $k$, large enough. The reason for our choice will only appear\n  at the end of the proof.\\<close>"], ["proof (state)\nthis:\n  expectation F2 < 2 * rho\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define k where \"k = max (2 * s + 1) (nat(ceiling((2 * d * s + 2 * K * s)/(d/2))))\""], ["proof (state)\nthis:\n  k =\n  max (2 * s + 1)\n   (nat \\<lceil>(2 * d * real s + 2 * K * real s) / (d / 2)\\<rceil>)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"k > 2 * s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * s < k", "unfolding k_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * s\n    < max (2 * s + 1)\n       (nat \\<lceil>(2 * d * real s + 2 * K * real s) / (d / 2)\\<rceil>)", "by auto"], ["proof (state)\nthis:\n  2 * s < k\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"k \\<ge> (2 * d * s + 2 * K * s)/(d/2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (2 * d * real s + 2 * K * real s) / (d / 2) \\<le> real k", "unfolding k_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (2 * d * real s + 2 * K * real s) / (d / 2)\n    \\<le> real\n           (max (2 * s + 1)\n             (nat \\<lceil>(2 * d * real s + 2 * K * real s) /\n                          (d / 2)\\<rceil>))", "by linarith"], ["proof (state)\nthis:\n  (2 * d * real s + 2 * K * real s) / (d / 2) \\<le> real k\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  (2 * d * real s + 2 * K * real s) / (d / 2) \\<le> real k", "have \"(2 * d * s + 2 * K * s)/k \\<le> d/2\""], ["proof (prove)\nusing this:\n  (2 * d * real s + 2 * K * real s) / (d / 2) \\<le> real k\n\ngoal (1 subgoal):\n 1. (2 * d * real s + 2 * K * real s) / real k \\<le> d / 2", "using \\<open>k > 2 * s\\<close>"], ["proof (prove)\nusing this:\n  (2 * d * real s + 2 * K * real s) / (d / 2) \\<le> real k\n  2 * s < k\n\ngoal (1 subgoal):\n 1. (2 * d * real s + 2 * K * real s) / real k \\<le> d / 2", "by (simp add: divide_simps mult.commute)"], ["proof (state)\nthis:\n  (2 * d * real s + 2 * K * real s) / real k \\<le> d / 2\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "text \\<open>Third step: definition of a good set $G$ where everything goes well.\\<close>"], ["proof (state)\nthis:\n  (2 * d * real s + 2 * K * real s) / real k \\<le> d / 2\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define G where \"G = {x \\<in> space M. (\\<lambda>n. u n x / n) \\<longlonglongrightarrow> 0\n                      \\<and> (\\<lambda>n. birkhoff_sum (\\<lambda>x. abs(u s x / s)) n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants (\\<lambda>x. abs(u s x / s)) x\n                      \\<and> (\\<lambda>n. birkhoff_sum F n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n                      \\<and> real_cond_exp M Invariants F x + real_cond_exp M Invariants (\\<lambda>x. abs(u s x / s)) x = real_cond_exp M Invariants F2 x}\""], ["proof (state)\nthis:\n  G =\n  {x \\<in> space M.\n   (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0 \\<and>\n   (\\<lambda>n.\n       birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants\n                              (\\<lambda>x. \\<bar>u s x / real s\\<bar>)\n                              x \\<and>\n   (\\<lambda>n. birkhoff_sum F n x / real n)\n   \\<longlonglongrightarrow> real_cond_exp M Invariants F x \\<and>\n   real_cond_exp M Invariants F x +\n   real_cond_exp M Invariants (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n   real_cond_exp M Invariants F2 x}\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have [measurable]: \"G \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G \\<in> events", "unfolding G_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0 \\<and>\n     (\\<lambda>n.\n         birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x / real n)\n     \\<longlonglongrightarrow> real_cond_exp M Invariants\n                                (\\<lambda>x. \\<bar>u s x / real s\\<bar>)\n                                x \\<and>\n     (\\<lambda>n. birkhoff_sum F n x / real n)\n     \\<longlonglongrightarrow> real_cond_exp M Invariants F x \\<and>\n     real_cond_exp M Invariants F x +\n     real_cond_exp M Invariants (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n     real_cond_exp M Invariants F2 x}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  G \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"AE x in M. (\\<lambda>n. u n x / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0", "using kingman_theorem_nonergodic(1)[OF subu subu_fin] subu_0"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. u n x / real n)\n             \\<longlonglongrightarrow> subcocycle_lim u x\n  AE x in M. subcocycle_lim u x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"AE x in M.(\\<lambda>n. birkhoff_sum (\\<lambda>x. abs(u s x / s)) n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants (\\<lambda>x. abs(u s x / s)) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n.\n                   birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n\n                    x /\n                   real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants\n    (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x", "apply (rule birkhoff_theorem_AE_nonergodic)"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "using int_u[of s]"], ["proof (prove)\nusing this:\n  integrable M (u s)\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n                 real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n                 real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"AE x in M. (\\<lambda>n. birkhoff_sum F n x / n) \\<longlonglongrightarrow> real_cond_exp M Invariants F x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. birkhoff_sum F n x / real n)\n               \\<longlonglongrightarrow> real_cond_exp M Invariants F x", "by (rule birkhoff_theorem_AE_nonergodic[OF int_F])"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum F n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. birkhoff_sum F n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"AE x in M. real_cond_exp M Invariants F x + real_cond_exp M Invariants (\\<lambda>x. abs(u s x / s)) x = real_cond_exp M Invariants F2 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants F x +\n               real_cond_exp M Invariants\n                (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n               real_cond_exp M Invariants F2 x", "unfolding F2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants F x +\n               real_cond_exp M Invariants\n                (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n               real_cond_exp M Invariants\n                (\\<lambda>x. F x + \\<bar>u s x / real s\\<bar>) x", "apply (rule AE_symmetric[OF real_cond_exp_add])"], ["proof (prove)\ngoal (2 subgoals):\n 1. integrable M F\n 2. integrable M (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "using int_u[of s] int_F int_u[of s]"], ["proof (prove)\nusing this:\n  integrable M (u s)\n  integrable M F\n  integrable M (u s)\n\ngoal (2 subgoals):\n 1. integrable M F\n 2. integrable M (\\<lambda>x. \\<bar>u s x / real s\\<bar>)", "by auto"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants F x +\n             real_cond_exp M Invariants\n              (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n             real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n                 real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x\n  AE x in M. (\\<lambda>n. birkhoff_sum F n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n  AE x in M. real_cond_exp M Invariants F x +\n             real_cond_exp M Invariants\n              (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n             real_cond_exp M Invariants F2 x", "have \"AE x in M. x \\<in> G\""], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n                 real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x\n  AE x in M. (\\<lambda>n. birkhoff_sum F n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n  AE x in M. real_cond_exp M Invariants F x +\n             real_cond_exp M Invariants\n              (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n             real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> G", "unfolding G_def"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0\n  AE x in M. (\\<lambda>n.\n                 birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n                 real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants\n  (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x\n  AE x in M. (\\<lambda>n. birkhoff_sum F n x / real n)\n             \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n  AE x in M. real_cond_exp M Invariants F x +\n             real_cond_exp M Invariants\n              (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n             real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> {x \\<in> space M.\n                        (\\<lambda>n. u n x / real n)\n                        \\<longlonglongrightarrow> 0 \\<and>\n                        (\\<lambda>n.\n                            birkhoff_sum\n                             (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n                            real n)\n                        \\<longlonglongrightarrow> real_cond_exp M Invariants\n             (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x \\<and>\n                        (\\<lambda>n. birkhoff_sum F n x / real n)\n                        \\<longlonglongrightarrow> real_cond_exp M Invariants\n             F x \\<and>\n                        real_cond_exp M Invariants F x +\n                        real_cond_exp M Invariants\n                         (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n                        real_cond_exp M Invariants F2 x}", "by auto"], ["proof (state)\nthis:\n  AE x in M. x \\<in> G\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  AE x in M. x \\<in> G", "have \"emeasure M G = 1\""], ["proof (prove)\nusing this:\n  AE x in M. x \\<in> G\n\ngoal (1 subgoal):\n 1. emeasure M G = 1", "by (simp add: emeasure_eq_1_AE)"], ["proof (state)\nthis:\n  emeasure M G = 1\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "text \\<open>Estimation of asymptotic densities of bad times, for points in $G$.\n  There is a trivial part, named $U$ below, that has to be treated separately because it creates\n  problematic boundary effects.\\<close>"], ["proof (state)\nthis:\n  emeasure M G = 1\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define U where \"U = (\\<lambda>x. {n. \\<exists>l \\<in> {n-s<..n}. u n x - u (n-l) x \\<le> - d * l})\""], ["proof (state)\nthis:\n  U =\n  (\\<lambda>x.\n      {n. \\<exists>l\\<in>{n - s<..n}.\n             u n x - u (n - l) x \\<le> - d * real l})\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define V where \"V = (\\<lambda>x. {n. \\<exists>l \\<in> {k..n-s}. u n x - u (n-l) x \\<le> - d * l})\""], ["proof (state)\nthis:\n  V =\n  (\\<lambda>x.\n      {n. \\<exists>l\\<in>{k..n - s}.\n             u n x - u (n - l) x \\<le> - d * real l})\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "text \\<open>Trivial estimate for $U(x)$: this set is finite for $x\\in G$.\\<close>"], ["proof (state)\nthis:\n  V =\n  (\\<lambda>x.\n      {n. \\<exists>l\\<in>{k..n - s}.\n             u n x - u (n - l) x \\<le> - d * real l})\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have densU: \"upper_asymptotic_density (U x) = 0\" if \"x \\<in> G\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "define C where \"C = Max {abs(u m x) |m. m<s} + d * s\""], ["proof (state)\nthis:\n  C = Max {\\<bar>u m x\\<bar> |m. m < s} + d * real s\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "have *: \"U x \\<subseteq> {n. u n x \\<le> C - d * n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U x \\<subseteq> {n. u n x \\<le> C - d * real n}", "proof (auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "assume \"n \\<in> U x\""], ["proof (state)\nthis:\n  n \\<in> U x\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "then"], ["proof (chain)\npicking this:\n  n \\<in> U x", "obtain l where l: \"l\\<in> {n-s <..n}\" \"u n x - u (n-l) x \\<le> - d * l\""], ["proof (prove)\nusing this:\n  n \\<in> U x\n\ngoal (1 subgoal):\n 1. (\\<And>l.\n        \\<lbrakk>l \\<in> {n - s<..n};\n         u n x - u (n - l) x \\<le> - d * real l\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding U_def"], ["proof (prove)\nusing this:\n  n \\<in> {n. \\<exists>l\\<in>{n - s<..n}.\n                 u n x - u (n - l) x \\<le> - d * real l}\n\ngoal (1 subgoal):\n 1. (\\<And>l.\n        \\<lbrakk>l \\<in> {n - s<..n};\n         u n x - u (n - l) x \\<le> - d * real l\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  l \\<in> {n - s<..n}\n  u n x - u (n - l) x \\<le> - d * real l\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "define m where \"m = n-l\""], ["proof (state)\nthis:\n  m = n - l\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "have \"m < s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m < s", "unfolding m_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. n - l < s", "using l"], ["proof (prove)\nusing this:\n  l \\<in> {n - s<..n}\n  u n x - u (n - l) x \\<le> - d * real l\n\ngoal (1 subgoal):\n 1. n - l < s", "by auto"], ["proof (state)\nthis:\n  m < s\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "have \"u n x \\<le> u m x - d * l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u n x \\<le> u m x - d * real l", "using l m_def"], ["proof (prove)\nusing this:\n  l \\<in> {n - s<..n}\n  u n x - u (n - l) x \\<le> - d * real l\n  m = n - l\n\ngoal (1 subgoal):\n 1. u n x \\<le> u m x - d * real l", "by auto"], ["proof (state)\nthis:\n  u n x \\<le> u m x - d * real l\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "also"], ["proof (state)\nthis:\n  u n x \\<le> u m x - d * real l\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "have \"... \\<le> abs(u m x) - d * n + d * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u m x - d * real l \\<le> \\<bar>u m x\\<bar> - d * real n + d * real m", "unfolding m_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n - l) x - d * real l\n    \\<le> \\<bar>u (n - l) x\\<bar> - d * real n + d * real (n - l)", "using l"], ["proof (prove)\nusing this:\n  l \\<in> {n - s<..n}\n  u n x - u (n - l) x \\<le> - d * real l\n\ngoal (1 subgoal):\n 1. u (n - l) x - d * real l\n    \\<le> \\<bar>u (n - l) x\\<bar> - d * real n + d * real (n - l)", "by (simp add: algebra_simps of_nat_diff)"], ["proof (state)\nthis:\n  u m x - d * real l \\<le> \\<bar>u m x\\<bar> - d * real n + d * real m\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "also"], ["proof (state)\nthis:\n  u m x - d * real l \\<le> \\<bar>u m x\\<bar> - d * real n + d * real m\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "have \"... \\<le> Max {abs(u m x) |m. m<s} - d * n + d * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u m x\\<bar> - d * real n + d * real m\n    \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} - d * real n + d * real m", "using \\<open>m < s\\<close>"], ["proof (prove)\nusing this:\n  m < s\n\ngoal (1 subgoal):\n 1. \\<bar>u m x\\<bar> - d * real n + d * real m\n    \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} - d * real n + d * real m", "apply (auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. m < s \\<Longrightarrow>\n    \\<bar>u m x\\<bar> \\<le> Max {\\<bar>u m x\\<bar> |m. m < s}", "by (rule Max_ge, auto)"], ["proof (state)\nthis:\n  \\<bar>u m x\\<bar> - d * real n + d * real m\n  \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} - d * real n + d * real m\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "also"], ["proof (state)\nthis:\n  \\<bar>u m x\\<bar> - d * real n + d * real m\n  \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} - d * real n + d * real m\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "have \"... \\<le> Max {abs(u m x) |m. m<s} + d * s - d * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {\\<bar>u m x\\<bar> |m. m < s} - d * real n + d * real m\n    \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} + d * real s - d * real n", "using \\<open>m < s\\<close> \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  m < s\n  0 < d\n\ngoal (1 subgoal):\n 1. Max {\\<bar>u m x\\<bar> |m. m < s} - d * real n + d * real m\n    \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} + d * real s - d * real n", "by auto"], ["proof (state)\nthis:\n  Max {\\<bar>u m x\\<bar> |m. m < s} - d * real n + d * real m\n  \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} + d * real s - d * real n\n\ngoal (1 subgoal):\n 1. \\<And>xa. xa \\<in> U x \\<Longrightarrow> u xa x \\<le> C - d * real xa", "finally"], ["proof (chain)\npicking this:\n  u n x \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} + d * real s - d * real n", "show \"u n x \\<le> C - d * n\""], ["proof (prove)\nusing this:\n  u n x \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} + d * real s - d * real n\n\ngoal (1 subgoal):\n 1. u n x \\<le> C - d * real n", "unfolding C_def"], ["proof (prove)\nusing this:\n  u n x \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} + d * real s - d * real n\n\ngoal (1 subgoal):\n 1. u n x \\<le> Max {\\<bar>u m x\\<bar> |m. m < s} + d * real s - d * real n", "by auto"], ["proof (state)\nthis:\n  u n x \\<le> C - d * real n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  U x \\<subseteq> {n. u n x \\<le> C - d * real n}\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "have \"eventually (\\<lambda>n. u n x / n > -d/2) sequentially\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially. - d / 2 < u n x / real n", "apply (rule order_tendstoD(1))"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> ?y\n 2. - d / 2 < ?y", "using \\<open>x \\<in> G\\<close> \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> G\n  0 < d\n\ngoal (2 subgoals):\n 1. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> ?y\n 2. - d / 2 < ?y", "unfolding G_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0 \\<and>\n           (\\<lambda>n.\n               birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n               real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants\n(\\<lambda>x. \\<bar>u s x / real s\\<bar>) x \\<and>\n           (\\<lambda>n. birkhoff_sum F n x / real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants F x \\<and>\n           real_cond_exp M Invariants F x +\n           real_cond_exp M Invariants\n            (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n           real_cond_exp M Invariants F2 x}\n  0 < d\n\ngoal (2 subgoals):\n 1. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> ?y\n 2. - d / 2 < ?y", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially. - d / 2 < u n x / real n\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F n in sequentially. - d / 2 < u n x / real n", "obtain N where N: \"\\<And>n. n \\<ge> N \\<Longrightarrow> u n x / n > - d/2\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially. - d / 2 < u n x / real n\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n.\n            N \\<le> n \\<Longrightarrow>\n            - d / 2 < u n x / real n) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using eventually_sequentially"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F n in sequentially. - d / 2 < u n x / real n\n  eventually ?P sequentially = (\\<exists>N. \\<forall>n\\<ge>N. ?P n)\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n.\n            N \\<le> n \\<Longrightarrow>\n            - d / 2 < u n x / real n) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  N \\<le> ?n12 \\<Longrightarrow> - d / 2 < u ?n12 x / real ?n12\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "{"], ["proof (state)\nthis:\n  N \\<le> ?n12 \\<Longrightarrow> - d / 2 < u ?n12 x / real ?n12\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "assume *: \"u n x \\<le> C - d * n\" \"n > N\""], ["proof (state)\nthis:\n  u n x \\<le> C - d * real n\n  N < n\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "then"], ["proof (chain)\npicking this:\n  u n x \\<le> C - d * real n\n  N < n", "have \"n \\<ge> N\" \"n > 0\""], ["proof (prove)\nusing this:\n  u n x \\<le> C - d * real n\n  N < n\n\ngoal (1 subgoal):\n 1. N \\<le> n &&& 0 < n", "by auto"], ["proof (state)\nthis:\n  N \\<le> n\n  0 < n\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "have \"2 * u n x \\<le> 2 * C - 2 * d * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * u n x \\<le> 2 * C - 2 * d * real n", "using *"], ["proof (prove)\nusing this:\n  u n x \\<le> C - d * real n\n  N < n\n\ngoal (1 subgoal):\n 1. 2 * u n x \\<le> 2 * C - 2 * d * real n", "by auto"], ["proof (state)\nthis:\n  2 * u n x \\<le> 2 * C - 2 * d * real n\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "moreover"], ["proof (state)\nthis:\n  2 * u n x \\<le> 2 * C - 2 * d * real n\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "have \"2 * u n x \\<ge> - d * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - d * real n \\<le> 2 * u n x", "using N[OF \\<open>n \\<ge> N\\<close>] \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  - d / 2 < u n x / real n\n  0 < n\n\ngoal (1 subgoal):\n 1. - d * real n \\<le> 2 * u n x", "by (simp add: divide_simps)"], ["proof (state)\nthis:\n  - d * real n \\<le> 2 * u n x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "ultimately"], ["proof (chain)\npicking this:\n  2 * u n x \\<le> 2 * C - 2 * d * real n\n  - d * real n \\<le> 2 * u n x", "have \"- d * n \\<le> 2 * C - 2 * d * n\""], ["proof (prove)\nusing this:\n  2 * u n x \\<le> 2 * C - 2 * d * real n\n  - d * real n \\<le> 2 * u n x\n\ngoal (1 subgoal):\n 1. - d * real n \\<le> 2 * C - 2 * d * real n", "by auto"], ["proof (state)\nthis:\n  - d * real n \\<le> 2 * C - 2 * d * real n\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "then"], ["proof (chain)\npicking this:\n  - d * real n \\<le> 2 * C - 2 * d * real n", "have \"d * n \\<le> 2 * C\""], ["proof (prove)\nusing this:\n  - d * real n \\<le> 2 * C - 2 * d * real n\n\ngoal (1 subgoal):\n 1. d * real n \\<le> 2 * C", "by auto"], ["proof (state)\nthis:\n  d * real n \\<le> 2 * C\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "then"], ["proof (chain)\npicking this:\n  d * real n \\<le> 2 * C", "have \"n \\<le> 2 * C / d\""], ["proof (prove)\nusing this:\n  d * real n \\<le> 2 * C\n\ngoal (1 subgoal):\n 1. real n \\<le> 2 * C / d", "using \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  d * real n \\<le> 2 * C\n  0 < d\n\ngoal (1 subgoal):\n 1. real n \\<le> 2 * C / d", "by (simp add: mult.commute divide_simps)"], ["proof (state)\nthis:\n  real n \\<le> 2 * C / d\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "}"], ["proof (state)\nthis:\n  \\<lbrakk>u ?n14 x \\<le> C - d * real ?n14; N < ?n14\\<rbrakk>\n  \\<Longrightarrow> real ?n14 \\<le> 2 * C / d\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>u ?n14 x \\<le> C - d * real ?n14; N < ?n14\\<rbrakk>\n  \\<Longrightarrow> real ?n14 \\<le> 2 * C / d", "have \"{n. u n x \\<le> C - d * n} \\<subseteq> {..max (nat (floor(2*C/d))) N}\""], ["proof (prove)\nusing this:\n  \\<lbrakk>u ?n14 x \\<le> C - d * real ?n14; N < ?n14\\<rbrakk>\n  \\<Longrightarrow> real ?n14 \\<le> 2 * C / d\n\ngoal (1 subgoal):\n 1. {n. u n x \\<le> C - d * real n}\n    \\<subseteq> {..max (nat \\<lfloor>2 * C / d\\<rfloor>) N}", "by (auto, meson le_max_iff_disj le_nat_floor not_le)"], ["proof (state)\nthis:\n  {n. u n x \\<le> C - d * real n}\n  \\<subseteq> {..max (nat \\<lfloor>2 * C / d\\<rfloor>) N}\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "then"], ["proof (chain)\npicking this:\n  {n. u n x \\<le> C - d * real n}\n  \\<subseteq> {..max (nat \\<lfloor>2 * C / d\\<rfloor>) N}", "have \"finite {n. u n x \\<le> C - d * n}\""], ["proof (prove)\nusing this:\n  {n. u n x \\<le> C - d * real n}\n  \\<subseteq> {..max (nat \\<lfloor>2 * C / d\\<rfloor>) N}\n\ngoal (1 subgoal):\n 1. finite {n. u n x \\<le> C - d * real n}", "using finite_subset"], ["proof (prove)\nusing this:\n  {n. u n x \\<le> C - d * real n}\n  \\<subseteq> {..max (nat \\<lfloor>2 * C / d\\<rfloor>) N}\n  \\<lbrakk>?A \\<subseteq> ?B; finite ?B\\<rbrakk> \\<Longrightarrow> finite ?A\n\ngoal (1 subgoal):\n 1. finite {n. u n x \\<le> C - d * real n}", "by blast"], ["proof (state)\nthis:\n  finite {n. u n x \\<le> C - d * real n}\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "then"], ["proof (chain)\npicking this:\n  finite {n. u n x \\<le> C - d * real n}", "have \"finite (U x)\""], ["proof (prove)\nusing this:\n  finite {n. u n x \\<le> C - d * real n}\n\ngoal (1 subgoal):\n 1. finite (U x)", "using * finite_subset"], ["proof (prove)\nusing this:\n  finite {n. u n x \\<le> C - d * real n}\n  U x \\<subseteq> {n. u n x \\<le> C - d * real n}\n  \\<lbrakk>?A \\<subseteq> ?B; finite ?B\\<rbrakk> \\<Longrightarrow> finite ?A\n\ngoal (1 subgoal):\n 1. finite (U x)", "by blast"], ["proof (state)\nthis:\n  finite (U x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "then"], ["proof (chain)\npicking this:\n  finite (U x)", "show ?thesis"], ["proof (prove)\nusing this:\n  finite (U x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "using upper_asymptotic_density_finite"], ["proof (prove)\nusing this:\n  finite (U x)\n  finite ?A \\<Longrightarrow> upper_asymptotic_density ?A = 0\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) = 0", "by auto"], ["proof (state)\nthis:\n  upper_asymptotic_density (U x) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x12 \\<in> G \\<Longrightarrow> upper_asymptotic_density (U ?x12) = 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "text \\<open>Main step: control of $u$ along the sequence $ns+t$, with a term\n  $-(d/2) Card(V(x) \\cap [1,ns+t])$ on the right.\n  Then, after averaging in $t$, Birkhoff theorem will imply that\n  $Card(V(x) \\cap [1,n])$ is suitably small.\\<close>"], ["proof (state)\nthis:\n  ?x12 \\<in> G \\<Longrightarrow> upper_asymptotic_density (U ?x12) = 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define Z where \"Z = (\\<lambda>t n x. Max {u i x|i. i< s} + (\\<Sum>i<n. abs(u s ((T^^(i * s + t))x)))\n                  + birkhoff_sum F (n * s + t) x - (d/2) * card(V x \\<inter> {1..n * s + t}))\""], ["proof (state)\nthis:\n  Z =\n  (\\<lambda>t n x.\n      Max {u i x |i. i < s} +\n      (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n      birkhoff_sum F (n * s + t) x -\n      d / 2 * real (card (V x \\<inter> {1..n * s + t})))\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have Main: \"u (n * s + t) x \\<le> Z t n x\" if \"t < s\" for n x t"], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n * s + t) x \\<le> Z t n x", "proof (rule nat_less_induct[where ?n = n])"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>m<n. u (m * s + t) x \\<le> Z t m x \\<Longrightarrow>\n       u (n * s + t) x \\<le> Z t n x", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>m<n. u (m * s + t) x \\<le> Z t m x \\<Longrightarrow>\n       u (n * s + t) x \\<le> Z t n x", "assume H: \"\\<forall>m<n. u (m * s + t) x \\<le> Z t m x\""], ["proof (state)\nthis:\n  \\<forall>m<n. u (m * s + t) x \\<le> Z t m x\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>m<n. u (m * s + t) x \\<le> Z t m x \\<Longrightarrow>\n       u (n * s + t) x \\<le> Z t n x", "consider \"n = 0\"|\"n>0 \\<and> V x \\<inter> {(n-1) * s+t<..n * s+t} = {}\"|\"n>0 \\<and> V x \\<inter> {(n-1) * s+t<..n * s+t} \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>n = 0 \\<Longrightarrow> thesis;\n     0 < n \\<and>\n     V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n     thesis;\n     0 < n \\<and>\n     V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq>\n     {} \\<Longrightarrow>\n     thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis12;\n   0 < n \\<and>\n   V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n   ?thesis12;\n   0 < n \\<and>\n   V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n   ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>m<n. u (m * s + t) x \\<le> Z t m x \\<Longrightarrow>\n       u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis12;\n   0 < n \\<and>\n   V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n   ?thesis12;\n   0 < n \\<and>\n   V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n   ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12", "show \"u (n * s+t) x \\<le> Z t n x\""], ["proof (prove)\nusing this:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis12;\n   0 < n \\<and>\n   V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n   ?thesis12;\n   0 < n \\<and>\n   V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n   ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. u (n * s + t) x \\<le> Z t n x", "proof (cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "assume \"n = 0\""], ["proof (state)\nthis:\n  n = 0\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  n = 0", "have \"V x \\<inter> {1..n * s + t} = {}\""], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. V x \\<inter> {1..n * s + t} = {}", "unfolding V_def"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. {n. \\<exists>l\\<in>{k..n - s}.\n           u n x - u (n - l) x \\<le> - d * real l} \\<inter>\n    {1..n * s + t} =\n    {}", "using \\<open>t<s\\<close> \\<open>k>2* s\\<close>"], ["proof (prove)\nusing this:\n  n = 0\n  t < s\n  2 * s < k\n\ngoal (1 subgoal):\n 1. {n. \\<exists>l\\<in>{k..n - s}.\n           u n x - u (n - l) x \\<le> - d * real l} \\<inter>\n    {1..n * s + t} =\n    {}", "by auto"], ["proof (state)\nthis:\n  V x \\<inter> {1..n * s + t} = {}\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  V x \\<inter> {1..n * s + t} = {}", "have *: \"card(V x \\<inter> {1..n * s+t}) = 0\""], ["proof (prove)\nusing this:\n  V x \\<inter> {1..n * s + t} = {}\n\ngoal (1 subgoal):\n 1. card (V x \\<inter> {1..n * s + t}) = 0", "by simp"], ["proof (state)\nthis:\n  card (V x \\<inter> {1..n * s + t}) = 0\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have **: \"0 \\<le> (\\<Sum>i<t. F ((T ^^ i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i<t. F ((T ^^ i) x))", "by (rule sum_nonneg, simp add: F_pos)"], ["proof (state)\nthis:\n  0 \\<le> (\\<Sum>i<t. F ((T ^^ i) x))\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"u (n * s + t) x = u t x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n * s + t) x = u t x", "using \\<open>n = 0\\<close>"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. u (n * s + t) x = u t x", "by auto"], ["proof (state)\nthis:\n  u (n * s + t) x = u t x\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  u (n * s + t) x = u t x\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> Max {u i x|i. i< s}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u t x \\<le> Max {u i x |i. i < s}", "by (rule Max_ge, auto simp add: \\<open>t<s\\<close>)"], ["proof (state)\nthis:\n  u t x \\<le> Max {u i x |i. i < s}\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  u t x \\<le> Max {u i x |i. i < s}\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> Z t n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} \\<le> Z t n x", "unfolding Z_def birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s}\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          (\\<Sum>i<n * s + t. F ((T ^^ i) x)) -\n          d / 2 * real (card (V x \\<inter> {1..n * s + t}))", "using \\<open>n = 0\\<close> * **"], ["proof (prove)\nusing this:\n  n = 0\n  card (V x \\<inter> {1..n * s + t}) = 0\n  0 \\<le> (\\<Sum>i<t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s}\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          (\\<Sum>i<n * s + t. F ((T ^^ i) x)) -\n          d / 2 * real (card (V x \\<inter> {1..n * s + t}))", "by auto"], ["proof (state)\nthis:\n  Max {u i x |i. i < s} \\<le> Z t n x\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 3. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "finally"], ["proof (chain)\npicking this:\n  u (n * s + t) x \\<le> Z t n x", "show ?thesis"], ["proof (prove)\nusing this:\n  u (n * s + t) x \\<le> Z t n x\n\ngoal (1 subgoal):\n 1. u (n * s + t) x \\<le> Z t n x", "by simp"], ["proof (state)\nthis:\n  u (n * s + t) x \\<le> Z t n x\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "assume A: \"n>0 \\<and> V x \\<inter> {(n-1) * s+t<..n * s+t} = {}\""], ["proof (state)\nthis:\n  0 < n \\<and> V x \\<inter> {(n - 1) * s + t<..n * s + t} = {}\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  0 < n \\<and> V x \\<inter> {(n - 1) * s + t<..n * s + t} = {}", "have \"n\\<ge>1\""], ["proof (prove)\nusing this:\n  0 < n \\<and> V x \\<inter> {(n - 1) * s + t<..n * s + t} = {}\n\ngoal (1 subgoal):\n 1. 1 \\<le> n", "by simp"], ["proof (state)\nthis:\n  1 \\<le> n\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"n * s + t = (n-1) * s + t + s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n * s + t = (n - 1) * s + t + s", "using \\<open>n\\<ge>1\\<close>"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. n * s + t = (n - 1) * s + t + s", "by (simp add: add.commute add.left_commute mult_eq_if)"], ["proof (state)\nthis:\n  n * s + t = (n - 1) * s + t + s\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"V x \\<inter> {1..n * s + t} = V x \\<inter> {1..(n-1) * s + t} \\<union> V x \\<inter> {(n-1) * s + t<..n * s + t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. V x \\<inter> {1..n * s + t} =\n    V x \\<inter> {1..(n - 1) * s + t} \\<union>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t}", "using \\<open>n\\<ge>1\\<close>"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. V x \\<inter> {1..n * s + t} =\n    V x \\<inter> {1..(n - 1) * s + t} \\<union>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t}", "by (auto, simp add: mult_eq_if)"], ["proof (state)\nthis:\n  V x \\<inter> {1..n * s + t} =\n  V x \\<inter> {1..(n - 1) * s + t} \\<union>\n  V x \\<inter> {(n - 1) * s + t<..n * s + t}\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  V x \\<inter> {1..n * s + t} =\n  V x \\<inter> {1..(n - 1) * s + t} \\<union>\n  V x \\<inter> {(n - 1) * s + t<..n * s + t}", "have *: \"card(V x \\<inter> {1..n * s+t}) = card(V x \\<inter> {1..(n-1) * s+t})\""], ["proof (prove)\nusing this:\n  V x \\<inter> {1..n * s + t} =\n  V x \\<inter> {1..(n - 1) * s + t} \\<union>\n  V x \\<inter> {(n - 1) * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. card (V x \\<inter> {1..n * s + t}) =\n    card (V x \\<inter> {1..(n - 1) * s + t})", "using A"], ["proof (prove)\nusing this:\n  V x \\<inter> {1..n * s + t} =\n  V x \\<inter> {1..(n - 1) * s + t} \\<union>\n  V x \\<inter> {(n - 1) * s + t<..n * s + t}\n  0 < n \\<and> V x \\<inter> {(n - 1) * s + t<..n * s + t} = {}\n\ngoal (1 subgoal):\n 1. card (V x \\<inter> {1..n * s + t}) =\n    card (V x \\<inter> {1..(n - 1) * s + t})", "by auto"], ["proof (state)\nthis:\n  card (V x \\<inter> {1..n * s + t}) =\n  card (V x \\<inter> {1..(n - 1) * s + t})\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have **: \"birkhoff_sum F ((n-1) * s + t) x \\<le> birkhoff_sum F (n * s + t) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum F ((n - 1) * s + t) x \\<le> birkhoff_sum F (n * s + t) x", "unfolding birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<(n - 1) * s + t. F ((T ^^ i) x))\n    \\<le> (\\<Sum>i<n * s + t. F ((T ^^ i) x))", "apply (rule sum_mono2)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite {..<n * s + t}\n 2. {..<(n - 1) * s + t} \\<subseteq> {..<n * s + t}\n 3. \\<And>b.\n       b \\<in> {..<n * s + t} - {..<(n - 1) * s + t} \\<Longrightarrow>\n       0 \\<le> F ((T ^^ b) x)", "using \\<open>n * s+t = (n-1) * s+t + s\\<close> F_pos"], ["proof (prove)\nusing this:\n  n * s + t = (n - 1) * s + t + s\n  0 \\<le> F ?x12\n\ngoal (3 subgoals):\n 1. finite {..<n * s + t}\n 2. {..<(n - 1) * s + t} \\<subseteq> {..<n * s + t}\n 3. \\<And>b.\n       b \\<in> {..<n * s + t} - {..<(n - 1) * s + t} \\<Longrightarrow>\n       0 \\<le> F ((T ^^ b) x)", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum F ((n - 1) * s + t) x \\<le> birkhoff_sum F (n * s + t) x\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"(\\<Sum>i<n-1. abs(u s ((T^^(i * s+t))x))) + u s ((T^^((n-1) * s+t)) x)\n        \\<le> (\\<Sum>i<n-1. abs(u s ((T^^(i * s+t))x))) + abs(u s ((T^^((n-1) * s+t)) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    u s ((T ^^ ((n - 1) * s + t)) x)\n    \\<le> (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          \\<bar>u s ((T ^^ ((n - 1) * s + t)) x)\\<bar>", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        \\<bar>u s ((T ^^ ((n - 1) * s + t)) x)\\<bar>\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        \\<bar>u s ((T ^^ ((n - 1) * s + t)) x)\\<bar>\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> (\\<Sum>i<n. abs(u s ((T^^(i* s+t))x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    \\<bar>u s ((T ^^ ((n - 1) * s + t)) x)\\<bar>\n    \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "using \\<open>n\\<ge>1\\<close> lessThan_Suc_atMost sum.lessThan_Suc[of \"\\<lambda>i. abs(u s ((T^^(i* s+t))x))\" \"n-1\", symmetric]"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  {..<Suc ?k} = {..?k}\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  \\<bar>u s ((T ^^ ((n - 1) * s + t)) x)\\<bar> =\n  (\\<Sum>i<Suc (n - 1). \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    \\<bar>u s ((T ^^ ((n - 1) * s + t)) x)\\<bar>\n    \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  \\<bar>u s ((T ^^ ((n - 1) * s + t)) x)\\<bar>\n  \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "have ***: \"(\\<Sum>i<n-1. abs(u s ((T^^(i* s+t))x))) + u s ((T^^((n-1) * s+t)) x) \\<le> (\\<Sum>i<n. abs(u s ((T^^(i* s+t))x)))\""], ["proof (prove)\nusing this:\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    u s ((T ^^ ((n - 1) * s + t)) x)\n    \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"u (n * s+t) x = u ((n-1) * s+t + s) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n * s + t) x = u ((n - 1) * s + t + s) x", "using \\<open>n\\<ge>1\\<close>"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. u (n * s + t) x = u ((n - 1) * s + t + s) x", "by (simp add: add.commute add.left_commute mult_eq_if)"], ["proof (state)\nthis:\n  u (n * s + t) x = u ((n - 1) * s + t + s) x\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  u (n * s + t) x = u ((n - 1) * s + t + s) x\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> u ((n-1) * s+t) x + u s ((T^^((n-1) * s+t)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u ((n - 1) * s + t + s) x\n    \\<le> u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)", "using subcocycle_ineq[OF subu, of \"(n-1) * s+t\" s x]"], ["proof (prove)\nusing this:\n  u ((n - 1) * s + t + s) x\n  \\<le> u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)\n\ngoal (1 subgoal):\n 1. u ((n - 1) * s + t + s) x\n    \\<le> u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)", "by simp"], ["proof (state)\nthis:\n  u ((n - 1) * s + t + s) x\n  \\<le> u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  u ((n - 1) * s + t + s) x\n  \\<le> u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> Max {u i x|i. i< s} + (\\<Sum>i<n-1. abs(u s ((T^^(i* s+t))x)))\n        + birkhoff_sum F ((n-1) * s+t) x - (d/2) * card(V x \\<inter> {1..(n-1) * s+t}) + u s ((T^^((n-1) * s+t)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F ((n - 1) * s + t) x -\n          d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n          u s ((T ^^ ((n - 1) * s + t)) x)", "using H \\<open>n\\<ge>1\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>m<n. u (m * s + t) x \\<le> Z t m x\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F ((n - 1) * s + t) x -\n          d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n          u s ((T ^^ ((n - 1) * s + t)) x)", "unfolding Z_def"], ["proof (prove)\nusing this:\n  \\<forall>m<n.\n     u (m * s + t) x\n     \\<le> Max {u i x |i. i < s} +\n           (\\<Sum>i<m. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n           birkhoff_sum F (m * s + t) x -\n           d / 2 * real (card (V x \\<inter> {1..m * s + t}))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F ((n - 1) * s + t) x -\n          d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n          u s ((T ^^ ((n - 1) * s + t)) x)", "by auto"], ["proof (state)\nthis:\n  u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> Max {u i x |i. i < s} +\n        (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        birkhoff_sum F ((n - 1) * s + t) x -\n        d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n        u s ((T ^^ ((n - 1) * s + t)) x)\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  u ((n - 1) * s + t) x + u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> Max {u i x |i. i < s} +\n        (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        birkhoff_sum F ((n - 1) * s + t) x -\n        d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n        u s ((T ^^ ((n - 1) * s + t)) x)\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> Max {u i x|i. i< s} + (\\<Sum>i<n. abs(u s ((T^^(i* s+t))x)))\n        + birkhoff_sum F (n * s+t) x - (d/2) * card(V x \\<inter> {1..n * s+t})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F ((n - 1) * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n    u s ((T ^^ ((n - 1) * s + t)) x)\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F (n * s + t) x -\n          d / 2 * real (card (V x \\<inter> {1..n * s + t}))", "using * ** ***"], ["proof (prove)\nusing this:\n  card (V x \\<inter> {1..n * s + t}) =\n  card (V x \\<inter> {1..(n - 1) * s + t})\n  birkhoff_sum F ((n - 1) * s + t) x \\<le> birkhoff_sum F (n * s + t) x\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F ((n - 1) * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n    u s ((T ^^ ((n - 1) * s + t)) x)\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F (n * s + t) x -\n          d / 2 * real (card (V x \\<inter> {1..n * s + t}))", "by auto"], ["proof (state)\nthis:\n  Max {u i x |i. i < s} +\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  birkhoff_sum F ((n - 1) * s + t) x -\n  d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n  u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> Max {u i x |i. i < s} +\n        (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        birkhoff_sum F (n * s + t) x -\n        d / 2 * real (card (V x \\<inter> {1..n * s + t}))\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  Max {u i x |i. i < s} +\n  (\\<Sum>i<n - 1. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  birkhoff_sum F ((n - 1) * s + t) x -\n  d / 2 * real (card (V x \\<inter> {1..(n - 1) * s + t})) +\n  u s ((T ^^ ((n - 1) * s + t)) x)\n  \\<le> Max {u i x |i. i < s} +\n        (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        birkhoff_sum F (n * s + t) x -\n        d / 2 * real (card (V x \\<inter> {1..n * s + t}))\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> Z t n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (n * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..n * s + t}))\n    \\<le> Z t n x", "unfolding Z_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (n * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..n * s + t}))\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F (n * s + t) x -\n          d / 2 * real (card (V x \\<inter> {1..n * s + t}))", "by (auto simp add: divide_simps)"], ["proof (state)\nthis:\n  Max {u i x |i. i < s} +\n  (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  birkhoff_sum F (n * s + t) x -\n  d / 2 * real (card (V x \\<inter> {1..n * s + t}))\n  \\<le> Z t n x\n\ngoal (2 subgoals):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} = {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x\n 2. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "finally"], ["proof (chain)\npicking this:\n  u (n * s + t) x \\<le> Z t n x", "show ?thesis"], ["proof (prove)\nusing this:\n  u (n * s + t) x \\<le> Z t n x\n\ngoal (1 subgoal):\n 1. u (n * s + t) x \\<le> Z t n x", "by simp"], ["proof (state)\nthis:\n  u (n * s + t) x \\<le> Z t n x\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "assume B: \"n>0 \\<and> V x \\<inter> {(n-1) * s+t<..n * s+t} \\<noteq> {}\""], ["proof (state)\nthis:\n  0 < n \\<and> V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  0 < n \\<and> V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {}", "have [simp]: \"n>0\" \"n\\<ge>1\" \"n \\<noteq> 0\""], ["proof (prove)\nusing this:\n  0 < n \\<and> V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. 0 < n &&& 1 \\<le> n &&& n \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  0 < n\n  1 \\<le> n\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "obtain m where m: \"m \\<in> V x \\<inter> {(n-1) * s + t<..n * s + t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>m.\n        m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using B"], ["proof (prove)\nusing this:\n  0 < n \\<and> V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (\\<And>m.\n        m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t}", "obtain l where l: \"l \\<in> {k..m-s}\" \"u m x - u (m-l) x \\<le> - d * l\""], ["proof (prove)\nusing this:\n  m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. (\\<And>l.\n        \\<lbrakk>l \\<in> {k..m - s};\n         u m x - u (m - l) x \\<le> - d * real l\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding V_def"], ["proof (prove)\nusing this:\n  m \\<in> {n. \\<exists>l\\<in>{k..n - s}.\n                 u n x - u (n - l) x \\<le> - d * real l} \\<inter>\n          {(n - 1) * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. (\\<And>l.\n        \\<lbrakk>l \\<in> {k..m - s};\n         u m x - u (m - l) x \\<le> - d * real l\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  l \\<in> {k..m - s}\n  u m x - u (m - l) x \\<le> - d * real l\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  l \\<in> {k..m - s}\n  u m x - u (m - l) x \\<le> - d * real l", "have \"m-s>0\""], ["proof (prove)\nusing this:\n  l \\<in> {k..m - s}\n  u m x - u (m - l) x \\<le> - d * real l\n\ngoal (1 subgoal):\n 1. 0 < m - s", "using \\<open>k>2* s\\<close>"], ["proof (prove)\nusing this:\n  l \\<in> {k..m - s}\n  u m x - u (m - l) x \\<le> - d * real l\n  2 * s < k\n\ngoal (1 subgoal):\n 1. 0 < m - s", "by auto"], ["proof (state)\nthis:\n  0 < m - s\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  0 < m - s", "have \"m-l \\<ge> s\""], ["proof (prove)\nusing this:\n  0 < m - s\n\ngoal (1 subgoal):\n 1. s \\<le> m - l", "using l"], ["proof (prove)\nusing this:\n  0 < m - s\n  l \\<in> {k..m - s}\n  u m x - u (m - l) x \\<le> - d * real l\n\ngoal (1 subgoal):\n 1. s \\<le> m - l", "by auto"], ["proof (state)\nthis:\n  s \\<le> m - l\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "define p where \"p = (m-l-t) div s\""], ["proof (state)\nthis:\n  p = (m - l - t) div s\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have p1: \"m-l \\<ge> p * s + t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p * s + t \\<le> m - l", "unfolding p_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (m - l - t) div s * s + t \\<le> m - l", "using \\<open>m-l \\<ge> s\\<close> \\<open>s>t\\<close> minus_mod_eq_div_mult [symmetric, of \"m - l - t\" s]"], ["proof (prove)\nusing this:\n  s \\<le> m - l\n  t < s\n  (m - l - t) div s * s = m - l - t - (m - l - t) mod s\n\ngoal (1 subgoal):\n 1. (m - l - t) div s * s + t \\<le> m - l", "by simp"], ["proof (state)\nthis:\n  p * s + t \\<le> m - l\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have p2: \"m-l < p* s + t + s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m - l < p * s + t + s", "unfolding p_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. m - l < (m - l - t) div s * s + t + s", "using \\<open>m-l \\<ge> s\\<close> \\<open>s>t\\<close>\n        div_mult_mod_eq[of \"m-l-t\" s] mod_less_divisor[OF \\<open>s>0\\<close>, of \"m-l-t\"]"], ["proof (prove)\nusing this:\n  s \\<le> m - l\n  t < s\n  (m - l - t) div s * s + (m - l - t) mod s = m - l - t\n  (m - l - t) mod s < s\n\ngoal (1 subgoal):\n 1. m - l < (m - l - t) div s * s + t + s", "by linarith"], ["proof (state)\nthis:\n  m - l < p * s + t + s\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  m - l < p * s + t + s", "have \"l \\<ge> m - p * s - t -s\""], ["proof (prove)\nusing this:\n  m - l < p * s + t + s\n\ngoal (1 subgoal):\n 1. m - p * s - t - s \\<le> l", "by auto"], ["proof (state)\nthis:\n  m - p * s - t - s \\<le> l\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  m - p * s - t - s \\<le> l", "have \"l \\<ge> (n-1) * s + t -p * s - t- s\""], ["proof (prove)\nusing this:\n  m - p * s - t - s \\<le> l\n\ngoal (1 subgoal):\n 1. (n - 1) * s + t - p * s - t - s \\<le> l", "using m"], ["proof (prove)\nusing this:\n  m - p * s - t - s \\<le> l\n  m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. (n - 1) * s + t - p * s - t - s \\<le> l", "by auto"], ["proof (state)\nthis:\n  (n - 1) * s + t - p * s - t - s \\<le> l\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  (n - 1) * s + t - p * s - t - s \\<le> l", "have \"l + 2 * s\\<ge> (n * s + t) - (p * s+t)\""], ["proof (prove)\nusing this:\n  (n - 1) * s + t - p * s - t - s \\<le> l\n\ngoal (1 subgoal):\n 1. n * s + t - (p * s + t) \\<le> l + 2 * s", "by (simp add: diff_mult_distrib)"], ["proof (state)\nthis:\n  n * s + t - (p * s + t) \\<le> l + 2 * s\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"(p+1) * s + t \\<le> (n-1) * s + t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (p + 1) * s + t \\<le> (n - 1) * s + t", "using \\<open>k> 2 * s\\<close> m l(1) p1"], ["proof (prove)\nusing this:\n  2 * s < k\n  m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t}\n  l \\<in> {k..m - s}\n  p * s + t \\<le> m - l\n\ngoal (1 subgoal):\n 1. (p + 1) * s + t \\<le> (n - 1) * s + t", "by (auto simp add: algebra_simps)"], ["proof (state)\nthis:\n  (p + 1) * s + t \\<le> (n - 1) * s + t\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  (p + 1) * s + t \\<le> (n - 1) * s + t", "have \"p+1 \\<le> n-1\""], ["proof (prove)\nusing this:\n  (p + 1) * s + t \\<le> (n - 1) * s + t\n\ngoal (1 subgoal):\n 1. p + 1 \\<le> n - 1", "using \\<open>s>0\\<close>"], ["proof (prove)\nusing this:\n  (p + 1) * s + t \\<le> (n - 1) * s + t\n  0 < s\n\ngoal (1 subgoal):\n 1. p + 1 \\<le> n - 1", "by (meson add_le_cancel_right mult_le_cancel2)"], ["proof (state)\nthis:\n  p + 1 \\<le> n - 1\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  p + 1 \\<le> n - 1", "have \"p \\<le> n-1\" \"p<n\""], ["proof (prove)\nusing this:\n  p + 1 \\<le> n - 1\n\ngoal (1 subgoal):\n 1. p \\<le> n - 1 &&& p < n", "by auto"], ["proof (state)\nthis:\n  p \\<le> n - 1\n  p < n\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"(p* s + t) + k \\<le> (n * s + t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p * s + t + k \\<le> n * s + t", "using m l(1) p1"], ["proof (prove)\nusing this:\n  m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t}\n  l \\<in> {k..m - s}\n  p * s + t \\<le> m - l\n\ngoal (1 subgoal):\n 1. p * s + t + k \\<le> n * s + t", "by (auto simp add: algebra_simps)"], ["proof (state)\nthis:\n  p * s + t + k \\<le> n * s + t\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  p * s + t + k \\<le> n * s + t", "have \"(1::real) \\<le> ((n * s + t) - (p* s + t)) / k\""], ["proof (prove)\nusing this:\n  p * s + t + k \\<le> n * s + t\n\ngoal (1 subgoal):\n 1. 1 \\<le> real (n * s + t - (p * s + t)) / real k", "using \\<open>k > 2* s\\<close>"], ["proof (prove)\nusing this:\n  p * s + t + k \\<le> n * s + t\n  2 * s < k\n\ngoal (1 subgoal):\n 1. 1 \\<le> real (n * s + t - (p * s + t)) / real k", "by auto"], ["proof (state)\nthis:\n  1 \\<le> real (n * s + t - (p * s + t)) / real k\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have In: \"u (n * s + t) x \\<le> u m x + (\\<Sum>i \\<in> {(n-1) * s + t..<n * s + t}. abs(u 1 ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "proof (cases \"m = n * s + t\")"], ["proof (state)\ngoal (2 subgoals):\n 1. m = n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n 2. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "case True"], ["proof (state)\nthis:\n  m = n * s + t\n\ngoal (2 subgoals):\n 1. m = n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n 2. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"(\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^i) x))) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n                \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by (rule sum_nonneg, auto)"], ["proof (state)\nthis:\n  0 \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (2 subgoals):\n 1. m = n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n 2. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "then"], ["proof (chain)\npicking this:\n  0 \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "show ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "using True"], ["proof (prove)\nusing this:\n  0 \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  m = n * s + t\n\ngoal (1 subgoal):\n 1. u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  u (n * s + t) x\n  \\<le> u m x +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "case False"], ["proof (state)\nthis:\n  m \\<noteq> n * s + t\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "then"], ["proof (chain)\npicking this:\n  m \\<noteq> n * s + t", "have m2: \"n * s + t - m >0\" \"(n-1) * s+t \\<le> m\""], ["proof (prove)\nusing this:\n  m \\<noteq> n * s + t\n\ngoal (1 subgoal):\n 1. 0 < n * s + t - m &&& (n - 1) * s + t \\<le> m", "using m"], ["proof (prove)\nusing this:\n  m \\<noteq> n * s + t\n  m \\<in> V x \\<inter> {(n - 1) * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. 0 < n * s + t - m &&& (n - 1) * s + t \\<le> m", "by auto"], ["proof (state)\nthis:\n  0 < n * s + t - m\n  (n - 1) * s + t \\<le> m\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"birkhoff_sum (u 1) (n * s+t-m) ((T^^m) x) = (\\<Sum>i<n * s+t-m. u 1 ((T^^i)((T^^m) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x) =\n    (\\<Sum>i<n * s + t - m. u 1 ((T ^^ i) ((T ^^ m) x)))", "unfolding birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n * s + t - m. u 1 ((T ^^ i) ((T ^^ m) x))) =\n    (\\<Sum>i<n * s + t - m. u 1 ((T ^^ i) ((T ^^ m) x)))", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x) =\n  (\\<Sum>i<n * s + t - m. u 1 ((T ^^ i) ((T ^^ m) x)))\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x) =\n  (\\<Sum>i<n * s + t - m. u 1 ((T ^^ i) ((T ^^ m) x)))\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... = (\\<Sum>i<n * s+t-m. u 1 ((T^^(i+m)) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n * s + t - m. u 1 ((T ^^ i) ((T ^^ m) x))) =\n    (\\<Sum>i<n * s + t - m. u 1 ((T ^^ (i + m)) x))", "by (simp add: funpow_add)"], ["proof (state)\nthis:\n  (\\<Sum>i<n * s + t - m. u 1 ((T ^^ i) ((T ^^ m) x))) =\n  (\\<Sum>i<n * s + t - m. u 1 ((T ^^ (i + m)) x))\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i<n * s + t - m. u 1 ((T ^^ i) ((T ^^ m) x))) =\n  (\\<Sum>i<n * s + t - m. u 1 ((T ^^ (i + m)) x))\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... = (\\<Sum>j \\<in> {m..<n * s+t}. u 1 ((T^^j) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<n * s + t - m. u 1 ((T ^^ (i + m)) x)) =\n    (\\<Sum>j = m..<n * s + t. u 1 ((T ^^ j) x))", "by (rule sum.reindex_bij_betw, rule bij_betw_byWitness[where ?f' = \"\\<lambda>i. i - m\"], auto)"], ["proof (state)\nthis:\n  (\\<Sum>i<n * s + t - m. u 1 ((T ^^ (i + m)) x)) =\n  (\\<Sum>j = m..<n * s + t. u 1 ((T ^^ j) x))\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i<n * s + t - m. u 1 ((T ^^ (i + m)) x)) =\n  (\\<Sum>j = m..<n * s + t. u 1 ((T ^^ j) x))\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... \\<le> (\\<Sum>j \\<in> {m..<n * s+t}. abs(u 1 ((T^^j) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j = m..<n * s + t. u 1 ((T ^^ j) x))\n    \\<le> (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "by (rule sum_mono, auto)"], ["proof (state)\nthis:\n  (\\<Sum>j = m..<n * s + t. u 1 ((T ^^ j) x))\n  \\<le> (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>j = m..<n * s + t. u 1 ((T ^^ j) x))\n  \\<le> (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... \\<le> (\\<Sum>j \\<in> {(n-1) * s+t..<m}. abs(u 1 ((T^^j) x))) + (\\<Sum>j \\<in> {m..<n * s+t}. abs(u 1 ((T^^j) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n    \\<le> (\\<Sum>j = (n - 1) * s + t..<m. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n          (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n  \\<le> (\\<Sum>j = (n - 1) * s + t..<m. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n        (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n  \\<le> (\\<Sum>j = (n - 1) * s + t..<m. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n        (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... = (\\<Sum>j \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^j) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j = (n - 1) * s + t..<m. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n    (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>) =\n    (\\<Sum>j = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "apply (rule sum.atLeastLessThan_concat)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (n - 1) * s + t \\<le> m\n 2. m \\<le> n * s + t", "using m2"], ["proof (prove)\nusing this:\n  0 < n * s + t - m\n  (n - 1) * s + t \\<le> m\n\ngoal (2 subgoals):\n 1. (n - 1) * s + t \\<le> m\n 2. m \\<le> n * s + t", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>j = (n - 1) * s + t..<m. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n  (\\<Sum>j = m..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>) =\n  (\\<Sum>j = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "finally"], ["proof (chain)\npicking this:\n  birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n  \\<le> (\\<Sum>j = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "have *: \"birkhoff_sum (u 1) (n * s+t-m) ((T^^m) x) \\<le> (\\<Sum>j \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^j) x)))\""], ["proof (prove)\nusing this:\n  birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n  \\<le> (\\<Sum>j = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n    \\<le> (\\<Sum>j = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n  \\<le> (\\<Sum>j = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"u (n * s+t) x \\<le> u m x + u (n * s+t-m) ((T^^m) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n * s + t) x \\<le> u m x + u (n * s + t - m) ((T ^^ m) x)", "using subcocycle_ineq[OF subu, of m \"n * s+t-m\"] m2"], ["proof (prove)\nusing this:\n  u (m + (n * s + t - m)) ?x \\<le> u m ?x + u (n * s + t - m) ((T ^^ m) ?x)\n  0 < n * s + t - m\n  (n - 1) * s + t \\<le> m\n\ngoal (1 subgoal):\n 1. u (n * s + t) x \\<le> u m x + u (n * s + t - m) ((T ^^ m) x)", "by auto"], ["proof (state)\nthis:\n  u (n * s + t) x \\<le> u m x + u (n * s + t - m) ((T ^^ m) x)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  u (n * s + t) x \\<le> u m x + u (n * s + t - m) ((T ^^ m) x)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... \\<le> u m x + birkhoff_sum (u 1) (n * s+t-m) ((T^^m) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u m x + u (n * s + t - m) ((T ^^ m) x)\n    \\<le> u m x + birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)", "using subcocycle_bounded_by_birkhoff1[OF subu \\<open>n * s+t - m >0\\<close>, of \"(T^^m)x\"]"], ["proof (prove)\nusing this:\n  u (n * s + t - m) ((T ^^ m) x)\n  \\<le> birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n\ngoal (1 subgoal):\n 1. u m x + u (n * s + t - m) ((T ^^ m) x)\n    \\<le> u m x + birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)", "by simp"], ["proof (state)\nthis:\n  u m x + u (n * s + t - m) ((T ^^ m) x)\n  \\<le> u m x + birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n\ngoal (1 subgoal):\n 1. m \\<noteq> n * s + t \\<Longrightarrow>\n    u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "finally"], ["proof (chain)\npicking this:\n  u (n * s + t) x\n  \\<le> u m x + birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)", "show ?thesis"], ["proof (prove)\nusing this:\n  u (n * s + t) x\n  \\<le> u m x + birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n\ngoal (1 subgoal):\n 1. u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "using *"], ["proof (prove)\nusing this:\n  u (n * s + t) x\n  \\<le> u m x + birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n  birkhoff_sum (u 1) (n * s + t - m) ((T ^^ m) x)\n  \\<le> (\\<Sum>j = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  u (n * s + t) x\n  \\<le> u m x +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u (n * s + t) x\n  \\<le> u m x +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have Ip: \"u (m-l) x \\<le> u (p* s+t) x + (\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "proof (cases \"m-l = p* s+t\")"], ["proof (state)\ngoal (2 subgoals):\n 1. m - l = p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n 2. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "case True"], ["proof (state)\nthis:\n  m - l = p * s + t\n\ngoal (2 subgoals):\n 1. m - l = p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n 2. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"(\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^i) x))) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n                \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by (rule sum_nonneg, auto)"], ["proof (state)\nthis:\n  0 \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (2 subgoals):\n 1. m - l = p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n 2. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "then"], ["proof (chain)\npicking this:\n  0 \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "show ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "using True"], ["proof (prove)\nusing this:\n  0 \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  m - l = p * s + t\n\ngoal (1 subgoal):\n 1. u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  u (m - l) x\n  \\<le> u (p * s + t) x +\n        (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "case False"], ["proof (state)\nthis:\n  m - l \\<noteq> p * s + t\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "then"], ["proof (chain)\npicking this:\n  m - l \\<noteq> p * s + t", "have \"m-l - (p* s+t) > 0\""], ["proof (prove)\nusing this:\n  m - l \\<noteq> p * s + t\n\ngoal (1 subgoal):\n 1. 0 < m - l - (p * s + t)", "using p1"], ["proof (prove)\nusing this:\n  m - l \\<noteq> p * s + t\n  p * s + t \\<le> m - l\n\ngoal (1 subgoal):\n 1. 0 < m - l - (p * s + t)", "by auto"], ["proof (state)\nthis:\n  0 < m - l - (p * s + t)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have I: \"p * s + t + (m - l - (p * s + t)) = m - l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p * s + t + (m - l - (p * s + t)) = m - l", "using p1"], ["proof (prove)\nusing this:\n  p * s + t \\<le> m - l\n\ngoal (1 subgoal):\n 1. p * s + t + (m - l - (p * s + t)) = m - l", "by auto"], ["proof (state)\nthis:\n  p * s + t + (m - l - (p * s + t)) = m - l\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"birkhoff_sum (u 1) (m-l - (p* s+t)) ((T^^(p* s+t)) x) = (\\<Sum>i<m-l - (p* s+t). u 1 ((T^^i) ((T^^(p* s+t)) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x) =\n    (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ i) ((T ^^ (p * s + t)) x)))", "unfolding birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ i) ((T ^^ (p * s + t)) x))) =\n    (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ i) ((T ^^ (p * s + t)) x)))", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x) =\n  (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ i) ((T ^^ (p * s + t)) x)))\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x) =\n  (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ i) ((T ^^ (p * s + t)) x)))\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... = (\\<Sum>i<m-l - (p* s+t). u 1 ((T^^(i+p* s+t)) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ i) ((T ^^ (p * s + t)) x))) =\n    (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ (i + p * s + t)) x))", "by (simp add: funpow_add)"], ["proof (state)\nthis:\n  (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ i) ((T ^^ (p * s + t)) x))) =\n  (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ (i + p * s + t)) x))\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ i) ((T ^^ (p * s + t)) x))) =\n  (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ (i + p * s + t)) x))\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... = (\\<Sum>j \\<in> {p* s+t..<m-l}. u 1 ((T^^j) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ (i + p * s + t)) x)) =\n    (\\<Sum>j = p * s + t..<m - l. u 1 ((T ^^ j) x))", "by (rule sum.reindex_bij_betw, rule bij_betw_byWitness[where ?f' = \"\\<lambda>i. i - (p* s+t)\"], auto)"], ["proof (state)\nthis:\n  (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ (i + p * s + t)) x)) =\n  (\\<Sum>j = p * s + t..<m - l. u 1 ((T ^^ j) x))\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i<m - l - (p * s + t). u 1 ((T ^^ (i + p * s + t)) x)) =\n  (\\<Sum>j = p * s + t..<m - l. u 1 ((T ^^ j) x))\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... \\<le> (\\<Sum>j \\<in> {p* s+t..<m-l}. abs(u 1 ((T^^j) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j = p * s + t..<m - l. u 1 ((T ^^ j) x))\n    \\<le> (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "by (rule sum_mono, auto)"], ["proof (state)\nthis:\n  (\\<Sum>j = p * s + t..<m - l. u 1 ((T ^^ j) x))\n  \\<le> (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>j = p * s + t..<m - l. u 1 ((T ^^ j) x))\n  \\<le> (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... \\<le> (\\<Sum>j \\<in> {p* s+t..<m-l}. abs(u 1 ((T^^j) x))) + (\\<Sum>j \\<in> {m-l..<(p+1)* s+t}. abs(u 1 ((T^^j) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n    \\<le> (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n          (\\<Sum>j = m - l..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n  \\<le> (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n        (\\<Sum>j = m - l..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n  \\<le> (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n        (\\<Sum>j = m - l..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... = (\\<Sum>j \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^j) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n    (\\<Sum>j = m - l..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>) =\n    (\\<Sum>j = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "apply (rule sum.atLeastLessThan_concat)"], ["proof (prove)\ngoal (2 subgoals):\n 1. p * s + t \\<le> m - l\n 2. m - l \\<le> (p + 1) * s + t", "using p1 p2"], ["proof (prove)\nusing this:\n  p * s + t \\<le> m - l\n  m - l < p * s + t + s\n\ngoal (2 subgoals):\n 1. p * s + t \\<le> m - l\n 2. m - l \\<le> (p + 1) * s + t", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>j = p * s + t..<m - l. \\<bar>u 1 ((T ^^ j) x)\\<bar>) +\n  (\\<Sum>j = m - l..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>) =\n  (\\<Sum>j = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "finally"], ["proof (chain)\npicking this:\n  birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n  \\<le> (\\<Sum>j = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "have *: \"birkhoff_sum (u 1) (m-l - (p* s+t)) ((T^^(p* s+t)) x)\n          \\<le> (\\<Sum>j \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^j) x)))\""], ["proof (prove)\nusing this:\n  birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n  \\<le> (\\<Sum>j = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n    \\<le> (\\<Sum>j = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ j) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n  \\<le> (\\<Sum>j = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"u (m-l) x \\<le> u (p* s+t) x + u (m-l - (p* s+t)) ((T^^(p* s+t)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (m - l) x\n    \\<le> u (p * s + t) x + u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)", "using subcocycle_ineq[OF subu, of \"p* s+t\" \"m-l - (p* s+t)\" x] I"], ["proof (prove)\nusing this:\n  u (p * s + t + (m - l - (p * s + t))) x\n  \\<le> u (p * s + t) x + u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n  p * s + t + (m - l - (p * s + t)) = m - l\n\ngoal (1 subgoal):\n 1. u (m - l) x\n    \\<le> u (p * s + t) x + u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)", "by auto"], ["proof (state)\nthis:\n  u (m - l) x\n  \\<le> u (p * s + t) x + u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  u (m - l) x\n  \\<le> u (p * s + t) x + u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "have \"... \\<le> u (p* s+t) x + birkhoff_sum (u 1) (m-l - (p* s+t)) ((T^^(p* s+t)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (p * s + t) x + u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n    \\<le> u (p * s + t) x +\n          birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)", "using subcocycle_bounded_by_birkhoff1[OF subu \\<open>m-l - (p* s+t) > 0\\<close>, of \"(T^^(p* s+t)) x\"]"], ["proof (prove)\nusing this:\n  u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n  \\<le> birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n\ngoal (1 subgoal):\n 1. u (p * s + t) x + u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n    \\<le> u (p * s + t) x +\n          birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)", "by simp"], ["proof (state)\nthis:\n  u (p * s + t) x + u (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n  \\<le> u (p * s + t) x +\n        birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n\ngoal (1 subgoal):\n 1. m - l \\<noteq> p * s + t \\<Longrightarrow>\n    u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "finally"], ["proof (chain)\npicking this:\n  u (m - l) x\n  \\<le> u (p * s + t) x +\n        birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)", "show ?thesis"], ["proof (prove)\nusing this:\n  u (m - l) x\n  \\<le> u (p * s + t) x +\n        birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n\ngoal (1 subgoal):\n 1. u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "using *"], ["proof (prove)\nusing this:\n  u (m - l) x\n  \\<le> u (p * s + t) x +\n        birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n  birkhoff_sum (u 1) (m - l - (p * s + t)) ((T ^^ (p * s + t)) x)\n  \\<le> (\\<Sum>j = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ j) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. u (m - l) x\n    \\<le> u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  u (m - l) x\n  \\<le> u (p * s + t) x +\n        (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u (m - l) x\n  \\<le> u (p * s + t) x +\n        (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"(\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^i) x))) \\<le> (\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. K + F ((T^^i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x))", "apply (rule sum_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> {p * s + t..<(p + 1) * s + t} \\<Longrightarrow>\n       \\<bar>u 1 ((T ^^ i) x)\\<bar> \\<le> K + F ((T ^^ i) x)", "using u1_bound"], ["proof (prove)\nusing this:\n  \\<bar>u 1 ?x12\\<bar> \\<le> K + F ?x12\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> {p * s + t..<(p + 1) * s + t} \\<Longrightarrow>\n       \\<bar>u 1 ((T ^^ i) x)\\<bar> \\<le> K + F ((T ^^ i) x)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"(\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^i) x))) \\<le> (\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. K + F ((T^^i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x))", "apply (rule sum_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> {(n - 1) * s + t..<n * s + t} \\<Longrightarrow>\n       \\<bar>u 1 ((T ^^ i) x)\\<bar> \\<le> K + F ((T ^^ i) x)", "using u1_bound"], ["proof (prove)\nusing this:\n  \\<bar>u 1 ?x12\\<bar> \\<le> K + F ?x12\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> {(n - 1) * s + t..<n * s + t} \\<Longrightarrow>\n       \\<bar>u 1 ((T ^^ i) x)\\<bar> \\<le> K + F ((T ^^ i) x)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x))\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x))", "have \"(\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^i) x))) + (\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^i) x)))\n        \\<le> (\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. K + F ((T^^i) x)) + (\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. K + F ((T^^i) x))\""], ["proof (prove)\nusing this:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x))\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x)) +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x))", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x)) +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x)) +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... = 2* K* s + (\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. F ((T^^i) x)) + (\\<Sum>i \\<in>{(n-1) * s+t..<n * s+t}. F ((T^^i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x)) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x)) =\n    2 * K * real s +\n    (\\<Sum>i = p * s + t..<(p + 1) * s + t. F ((T ^^ i) x)) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))", "by (auto simp add: mult_eq_if sum.distrib)"], ["proof (state)\nthis:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x)) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x)) =\n  2 * K * real s + (\\<Sum>i = p * s + t..<(p + 1) * s + t. F ((T ^^ i) x)) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. K + F ((T ^^ i) x)) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. K + F ((T ^^ i) x)) =\n  2 * K * real s + (\\<Sum>i = p * s + t..<(p + 1) * s + t. F ((T ^^ i) x)) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> 2* K * s + (\\<Sum>i \\<in> {p* s+t..<(n-1) * s+t}. F ((T^^i) x)) + (\\<Sum>i \\<in>{(n-1) * s+t..<n * s+t}. F ((T^^i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * K * real s +\n    (\\<Sum>i = p * s + t..<(p + 1) * s + t. F ((T ^^ i) x)) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))\n    \\<le> 2 * K * real s +\n          (\\<Sum>i = p * s + t..<(n - 1) * s + t. F ((T ^^ i) x)) +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))", "apply (auto, rule sum_mono2)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite {p * s + t..<(n - Suc 0) * s + t}\n 2. {p * s + t..<s + p * s + t}\n    \\<subseteq> {p * s + t..<(n - Suc 0) * s + t}\n 3. \\<And>b.\n       b \\<in> {p * s + t..<(n - Suc 0) * s + t} -\n               {p * s + t..<s + p * s + t} \\<Longrightarrow>\n       0 \\<le> F ((T ^^ b) x)", "using \\<open>(p+1)* s+t\\<le>(n-1) * s+t\\<close> F_pos"], ["proof (prove)\nusing this:\n  (p + 1) * s + t \\<le> (n - 1) * s + t\n  0 \\<le> F ?x12\n\ngoal (3 subgoals):\n 1. finite {p * s + t..<(n - Suc 0) * s + t}\n 2. {p * s + t..<s + p * s + t}\n    \\<subseteq> {p * s + t..<(n - Suc 0) * s + t}\n 3. \\<And>b.\n       b \\<in> {p * s + t..<(n - Suc 0) * s + t} -\n               {p * s + t..<s + p * s + t} \\<Longrightarrow>\n       0 \\<le> F ((T ^^ b) x)", "by auto"], ["proof (state)\nthis:\n  2 * K * real s + (\\<Sum>i = p * s + t..<(p + 1) * s + t. F ((T ^^ i) x)) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))\n  \\<le> 2 * K * real s +\n        (\\<Sum>i = p * s + t..<(n - 1) * s + t. F ((T ^^ i) x)) +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  2 * K * real s + (\\<Sum>i = p * s + t..<(p + 1) * s + t. F ((T ^^ i) x)) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))\n  \\<le> 2 * K * real s +\n        (\\<Sum>i = p * s + t..<(n - 1) * s + t. F ((T ^^ i) x)) +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... = 2* K * s + (\\<Sum>i \\<in> {p* s+t..<n * s+t}. F ((T^^i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * K * real s +\n    (\\<Sum>i = p * s + t..<(n - 1) * s + t. F ((T ^^ i) x)) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x)) =\n    2 * K * real s + (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "apply (auto, rule sum.atLeastLessThan_concat)"], ["proof (prove)\ngoal (2 subgoals):\n 1. p * s + t \\<le> (n - Suc 0) * s + t\n 2. (n - Suc 0) * s + t \\<le> n * s + t", "using \\<open>p\\<le>n-1\\<close>"], ["proof (prove)\nusing this:\n  p \\<le> n - 1\n\ngoal (2 subgoals):\n 1. p * s + t \\<le> (n - Suc 0) * s + t\n 2. (n - Suc 0) * s + t \\<le> n * s + t", "by auto"], ["proof (state)\nthis:\n  2 * K * real s + (\\<Sum>i = p * s + t..<(n - 1) * s + t. F ((T ^^ i) x)) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. F ((T ^^ i) x)) =\n  2 * K * real s + (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> 2 * K * real s + (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "have A0: \"(\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^i) x))) + (\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^i) x)))\n        \\<le> 2* K * s + (\\<Sum>i \\<in> {p* s+t..<n * s+t}. F ((T^^i) x))\""], ["proof (prove)\nusing this:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> 2 * K * real s + (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> 2 * K * real s + (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> 2 * K * real s + (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"card(V x \\<inter> {p * s + t<.. n * s+t}) \\<le> card {p * s + t<.. n * s+t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (V x \\<inter> {p * s + t<..n * s + t})\n    \\<le> card {p * s + t<..n * s + t}", "by (rule card_mono, auto)"], ["proof (state)\nthis:\n  card (V x \\<inter> {p * s + t<..n * s + t})\n  \\<le> card {p * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"2 * d * s + 2 * K * s > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 2 * d * real s + 2 * K * real s", "using \\<open>K>0\\<close> \\<open>s>0\\<close> \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  0 < K\n  0 < s\n  0 < d\n\ngoal (1 subgoal):\n 1. 0 < 2 * d * real s + 2 * K * real s", "by (metis add_pos_pos mult_2 mult_zero_left of_nat_0_less_iff pos_divide_less_eq times_divide_eq_right)"], ["proof (state)\nthis:\n  0 < 2 * d * real s + 2 * K * real s\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  0 < 2 * d * real s + 2 * K * real s", "have \"2 * d * s + 2 * K * s \\<le> ((n * s + t) - (p* s + t)) * ((2 * d * s + 2 * K * s) / k)\""], ["proof (prove)\nusing this:\n  0 < 2 * d * real s + 2 * K * real s\n\ngoal (1 subgoal):\n 1. 2 * d * real s + 2 * K * real s\n    \\<le> real (n * s + t - (p * s + t)) *\n          ((2 * d * real s + 2 * K * real s) / real k)", "using \\<open>1 \\<le> ((n * s + t) - (p* s + t)) / k\\<close>"], ["proof (prove)\nusing this:\n  0 < 2 * d * real s + 2 * K * real s\n  1 \\<le> real (n * s + t - (p * s + t)) / real k\n\ngoal (1 subgoal):\n 1. 2 * d * real s + 2 * K * real s\n    \\<le> real (n * s + t - (p * s + t)) *\n          ((2 * d * real s + 2 * K * real s) / real k)", "by (simp add: le_divide_eq_1 pos_le_divide_eq)"], ["proof (state)\nthis:\n  2 * d * real s + 2 * K * real s\n  \\<le> real (n * s + t - (p * s + t)) *\n        ((2 * d * real s + 2 * K * real s) / real k)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  2 * d * real s + 2 * K * real s\n  \\<le> real (n * s + t - (p * s + t)) *\n        ((2 * d * real s + 2 * K * real s) / real k)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> ((n * s + t) - (p* s + t)) * (d/2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n * s + t - (p * s + t)) *\n    ((2 * d * real s + 2 * K * real s) / real k)\n    \\<le> real (n * s + t - (p * s + t)) * (d / 2)", "apply (rule mult_left_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (2 * d * real s + 2 * K * real s) / real k \\<le> d / 2\n 2. 0 \\<le> real (n * s + t - (p * s + t))", "using \\<open>(2 * d * s + 2 * K * s)/k \\<le> d/2\\<close>"], ["proof (prove)\nusing this:\n  (2 * d * real s + 2 * K * real s) / real k \\<le> d / 2\n\ngoal (2 subgoals):\n 1. (2 * d * real s + 2 * K * real s) / real k \\<le> d / 2\n 2. 0 \\<le> real (n * s + t - (p * s + t))", "by auto"], ["proof (state)\nthis:\n  real (n * s + t - (p * s + t)) *\n  ((2 * d * real s + 2 * K * real s) / real k)\n  \\<le> real (n * s + t - (p * s + t)) * (d / 2)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "finally"], ["proof (chain)\npicking this:\n  2 * d * real s + 2 * K * real s\n  \\<le> real (n * s + t - (p * s + t)) * (d / 2)", "have \"2 * d * s + 2 * K * s \\<le> ((n * s + t) - (p* s + t)) * (d/2)\""], ["proof (prove)\nusing this:\n  2 * d * real s + 2 * K * real s\n  \\<le> real (n * s + t - (p * s + t)) * (d / 2)\n\ngoal (1 subgoal):\n 1. 2 * d * real s + 2 * K * real s\n    \\<le> real (n * s + t - (p * s + t)) * (d / 2)", "by auto"], ["proof (state)\nthis:\n  2 * d * real s + 2 * K * real s\n  \\<le> real (n * s + t - (p * s + t)) * (d / 2)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  2 * d * real s + 2 * K * real s\n  \\<le> real (n * s + t - (p * s + t)) * (d / 2)", "have \"-d * ((n * s+t) - (p* s+t)) + 2 * d * s + 2 * K * s \\<le> -d * ((n * s+t) - (p* s+t)) + ((n * s + t) - (p* s + t)) * (d/2)\""], ["proof (prove)\nusing this:\n  2 * d * real s + 2 * K * real s\n  \\<le> real (n * s + t - (p * s + t)) * (d / 2)\n\ngoal (1 subgoal):\n 1. - d * real (n * s + t - (p * s + t)) + 2 * d * real s + 2 * K * real s\n    \\<le> - d * real (n * s + t - (p * s + t)) +\n          real (n * s + t - (p * s + t)) * (d / 2)", "by linarith"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + 2 * K * real s\n  \\<le> - d * real (n * s + t - (p * s + t)) +\n        real (n * s + t - (p * s + t)) * (d / 2)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + 2 * K * real s\n  \\<le> - d * real (n * s + t - (p * s + t)) +\n        real (n * s + t - (p * s + t)) * (d / 2)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... = (-d/2) * card {p * s + t<.. n * s+t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - d * real (n * s + t - (p * s + t)) +\n    real (n * s + t - (p * s + t)) * (d / 2) =\n    - d / 2 * real (card {p * s + t<..n * s + t})", "by auto"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) +\n  real (n * s + t - (p * s + t)) * (d / 2) =\n  - d / 2 * real (card {p * s + t<..n * s + t})\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) +\n  real (n * s + t - (p * s + t)) * (d / 2) =\n  - d / 2 * real (card {p * s + t<..n * s + t})\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> (-d/2) * card(V x \\<inter> {p * s + t<.. n * s+t})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - d / 2 * real (card {p * s + t<..n * s + t})\n    \\<le> - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))", "using \\<open>card(V x \\<inter> {p * s + t<.. n * s+t}) \\<le> card {p * s + t<.. n * s+t}\\<close>"], ["proof (prove)\nusing this:\n  card (V x \\<inter> {p * s + t<..n * s + t})\n  \\<le> card {p * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. - d / 2 * real (card {p * s + t<..n * s + t})\n    \\<le> - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))", "by auto"], ["proof (state)\nthis:\n  - d / 2 * real (card {p * s + t<..n * s + t})\n  \\<le> - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "finally"], ["proof (chain)\npicking this:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + 2 * K * real s\n  \\<le> - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))", "have A1: \"-d * ((n * s+t) - (p* s+t)) + 2 * d * s + 2 * K * s \\<le> (-d/2) * card(V x \\<inter> {p * s + t<.. n * s+t})\""], ["proof (prove)\nusing this:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + 2 * K * real s\n  \\<le> - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))\n\ngoal (1 subgoal):\n 1. - d * real (n * s + t - (p * s + t)) + 2 * d * real s + 2 * K * real s\n    \\<le> - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))", "by simp"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + 2 * K * real s\n  \\<le> - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"V x \\<inter> {1.. n * s+t} = V x \\<inter> {1..p * s + t} \\<union> V x \\<inter> {p * s + t<.. n * s+t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. V x \\<inter> {1..n * s + t} =\n    V x \\<inter> {1..p * s + t} \\<union>\n    V x \\<inter> {p * s + t<..n * s + t}", "using \\<open>p * s + t + k \\<le> n * s + t\\<close>"], ["proof (prove)\nusing this:\n  p * s + t + k \\<le> n * s + t\n\ngoal (1 subgoal):\n 1. V x \\<inter> {1..n * s + t} =\n    V x \\<inter> {1..p * s + t} \\<union>\n    V x \\<inter> {p * s + t<..n * s + t}", "by auto"], ["proof (state)\nthis:\n  V x \\<inter> {1..n * s + t} =\n  V x \\<inter> {1..p * s + t} \\<union> V x \\<inter> {p * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "then"], ["proof (chain)\npicking this:\n  V x \\<inter> {1..n * s + t} =\n  V x \\<inter> {1..p * s + t} \\<union> V x \\<inter> {p * s + t<..n * s + t}", "have \"card (V x \\<inter> {1.. n * s+t}) = card(V x \\<inter> {1..p * s + t} \\<union> V x \\<inter> {p * s + t<.. n * s+t})\""], ["proof (prove)\nusing this:\n  V x \\<inter> {1..n * s + t} =\n  V x \\<inter> {1..p * s + t} \\<union> V x \\<inter> {p * s + t<..n * s + t}\n\ngoal (1 subgoal):\n 1. card (V x \\<inter> {1..n * s + t}) =\n    card\n     (V x \\<inter> {1..p * s + t} \\<union>\n      V x \\<inter> {p * s + t<..n * s + t})", "by auto"], ["proof (state)\nthis:\n  card (V x \\<inter> {1..n * s + t}) =\n  card\n   (V x \\<inter> {1..p * s + t} \\<union>\n    V x \\<inter> {p * s + t<..n * s + t})\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  card (V x \\<inter> {1..n * s + t}) =\n  card\n   (V x \\<inter> {1..p * s + t} \\<union>\n    V x \\<inter> {p * s + t<..n * s + t})\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... = card (V x \\<inter> {1..p * s + t}) + card (V x \\<inter> {p * s + t<.. n * s+t})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     (V x \\<inter> {1..p * s + t} \\<union>\n      V x \\<inter> {p * s + t<..n * s + t}) =\n    card (V x \\<inter> {1..p * s + t}) +\n    card (V x \\<inter> {p * s + t<..n * s + t})", "by (rule card_Un_disjoint, auto)"], ["proof (state)\nthis:\n  card\n   (V x \\<inter> {1..p * s + t} \\<union>\n    V x \\<inter> {p * s + t<..n * s + t}) =\n  card (V x \\<inter> {1..p * s + t}) +\n  card (V x \\<inter> {p * s + t<..n * s + t})\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "finally"], ["proof (chain)\npicking this:\n  card (V x \\<inter> {1..n * s + t}) =\n  card (V x \\<inter> {1..p * s + t}) +\n  card (V x \\<inter> {p * s + t<..n * s + t})", "have A2: \"card (V x \\<inter> {1..p * s + t}) + card (V x \\<inter> {p * s + t<.. n * s+t}) = card (V x \\<inter> {1.. n * s+t})\""], ["proof (prove)\nusing this:\n  card (V x \\<inter> {1..n * s + t}) =\n  card (V x \\<inter> {1..p * s + t}) +\n  card (V x \\<inter> {p * s + t<..n * s + t})\n\ngoal (1 subgoal):\n 1. card (V x \\<inter> {1..p * s + t}) +\n    card (V x \\<inter> {p * s + t<..n * s + t}) =\n    card (V x \\<inter> {1..n * s + t})", "by simp"], ["proof (state)\nthis:\n  card (V x \\<inter> {1..p * s + t}) +\n  card (V x \\<inter> {p * s + t<..n * s + t}) =\n  card (V x \\<inter> {1..n * s + t})\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have A3: \"(\\<Sum>i<p. abs(u s ((T ^^ (i * s + t)) x))) \\<le> (\\<Sum>i<n. abs(u s ((T ^^ (i * s + t)) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n    \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "apply (rule sum_mono2)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite {..<n}\n 2. {..<p} \\<subseteq> {..<n}\n 3. \\<And>b.\n       b \\<in> {..<n} - {..<p} \\<Longrightarrow>\n       0 \\<le> \\<bar>u s ((T ^^ (b * s + t)) x)\\<bar>", "using \\<open>p\\<le>n-1\\<close>"], ["proof (prove)\nusing this:\n  p \\<le> n - 1\n\ngoal (3 subgoals):\n 1. finite {..<n}\n 2. {..<p} \\<subseteq> {..<n}\n 3. \\<And>b.\n       b \\<in> {..<n} - {..<p} \\<Longrightarrow>\n       0 \\<le> \\<bar>u s ((T ^^ (b * s + t)) x)\\<bar>", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have A4: \"birkhoff_sum F (p * s + t) x + (\\<Sum>i \\<in> {p* s+t..<n * s+t}. F ((T^^i) x)) = birkhoff_sum F (n * s + t) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum F (p * s + t) x +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n    birkhoff_sum F (n * s + t) x", "unfolding birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<p * s + t. F ((T ^^ i) x)) +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n    (\\<Sum>i<n * s + t. F ((T ^^ i) x))", "apply (subst atLeast0LessThan[symmetric])+"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 0..<p * s + t. F ((T ^^ i) x)) +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n    (\\<Sum>i = 0..<n * s + t. F ((T ^^ i) x))", "apply (rule sum.atLeastLessThan_concat)"], ["proof (prove)\ngoal (2 subgoals):\n 1. 0 \\<le> p * s + t\n 2. p * s + t \\<le> n * s + t", "using \\<open>p\\<le>n-1\\<close>"], ["proof (prove)\nusing this:\n  p \\<le> n - 1\n\ngoal (2 subgoals):\n 1. 0 \\<le> p * s + t\n 2. p * s + t \\<le> n * s + t", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum F (p * s + t) x +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n  birkhoff_sum F (n * s + t) x\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"u (n * s+t) x \\<le> u m x + (\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "using In"], ["proof (prove)\nusing this:\n  u (n * s + t) x\n  \\<le> u m x +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. u (n * s + t) x\n    \\<le> u m x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by simp"], ["proof (state)\nthis:\n  u (n * s + t) x\n  \\<le> u m x +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  u (n * s + t) x\n  \\<le> u m x +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> (u m x - u (m-l) x) + u (m-l) x + (\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u m x +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> u m x - u (m - l) x + u (m - l) x +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by simp"], ["proof (state)\nthis:\n  u m x +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> u m x - u (m - l) x + u (m - l) x +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  u m x +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> u m x - u (m - l) x + u (m - l) x +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> - d * l + u (p* s+t) x + (\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^i) x))) + (\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u m x - u (m - l) x + u (m - l) x +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> - d * real l + u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "using Ip l"], ["proof (prove)\nusing this:\n  u (m - l) x\n  \\<le> u (p * s + t) x +\n        (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  l \\<in> {k..m - s}\n  u m x - u (m - l) x \\<le> - d * real l\n\ngoal (1 subgoal):\n 1. u m x - u (m - l) x + u (m - l) x +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> - d * real l + u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  u m x - u (m - l) x + u (m - l) x +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> - d * real l + u (p * s + t) x +\n        (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  u m x - u (m - l) x + u (m - l) x +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> - d * real l + u (p * s + t) x +\n        (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> - d * ((n * s+t) - (p* s+t)) + 2*d* s + u (p* s+t) x + (\\<Sum>i \\<in> {p* s+t..<(p+1)* s+t}. abs(u 1 ((T^^i) x))) + (\\<Sum>i \\<in> {(n-1) * s+t..<n * s+t}. abs(u 1 ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - d * real l + u (p * s + t) x +\n    (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> - d * real (n * s + t - (p * s + t)) + 2 * d * real s +\n          u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "using \\<open>l + 2* s\\<ge> (n * s+t) - (p* s+t)\\<close>"], ["proof (prove)\nusing this:\n  n * s + t - (p * s + t) \\<le> l + 2 * s\n\ngoal (1 subgoal):\n 1. - d * real l + u (p * s + t) x +\n    (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> - d * real (n * s + t - (p * s + t)) + 2 * d * real s +\n          u (p * s + t) x +\n          (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n          (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n              \\<bar>u 1 ((T ^^ i) x)\\<bar>)", "apply (auto simp add: algebra_simps)"], ["proof (prove)\ngoal (1 subgoal):\n 1. n * s - p * s \\<le> l + s * 2 \\<Longrightarrow>\n    d * real (n * s - p * s) \\<le> d * real l + d * (real s * 2)", "by (metis assms(1) distrib_left mult.commute mult_2 of_nat_add of_nat_le_iff mult_le_cancel_iff2)"], ["proof (state)\nthis:\n  - d * real l + u (p * s + t) x +\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> - d * real (n * s + t - (p * s + t)) + 2 * d * real s +\n        u (p * s + t) x +\n        (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  - d * real l + u (p * s + t) x +\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> - d * real (n * s + t - (p * s + t)) + 2 * d * real s +\n        u (p * s + t) x +\n        (\\<Sum>i = p * s + t..<(p + 1) * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n        (\\<Sum>i = (n - 1) * s + t..<n * s + t.\n            \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> -d * ((n * s+t) - (p* s+t)) + 2*d* s + Z t p x + 2* K * s + (\\<Sum>i \\<in> {p* s+t..<n * s+t}. F ((T^^i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - d * real (n * s + t - (p * s + t)) + 2 * d * real s +\n    u (p * s + t) x +\n    (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> - d * real (n * s + t - (p * s + t)) + 2 * d * real s + Z t p x +\n          2 * K * real s +\n          (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "using A0 H \\<open>p<n\\<close>"], ["proof (prove)\nusing this:\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> 2 * K * real s + (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n  \\<forall>m<n. u (m * s + t) x \\<le> Z t m x\n  p < n\n\ngoal (1 subgoal):\n 1. - d * real (n * s + t - (p * s + t)) + 2 * d * real s +\n    u (p * s + t) x +\n    (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n    (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n    \\<le> - d * real (n * s + t - (p * s + t)) + 2 * d * real s + Z t p x +\n          2 * K * real s +\n          (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "by auto"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + u (p * s + t) x +\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> - d * real (n * s + t - (p * s + t)) + 2 * d * real s + Z t p x +\n        2 * K * real s +\n        (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + u (p * s + t) x +\n  (\\<Sum>i = p * s + t..<(p + 1) * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>) +\n  (\\<Sum>i = (n - 1) * s + t..<n * s + t. \\<bar>u 1 ((T ^^ i) x)\\<bar>)\n  \\<le> - d * real (n * s + t - (p * s + t)) + 2 * d * real s + Z t p x +\n        2 * K * real s +\n        (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> Z t p x - d/2 * card(V x \\<inter> {p * s + t<.. n * s+t}) + (\\<Sum>i \\<in> {p* s+t..<n * s+t}. F ((T^^i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - d * real (n * s + t - (p * s + t)) + 2 * d * real s + Z t p x +\n    2 * K * real s +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n    \\<le> Z t p x -\n          d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n          (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "using A1"], ["proof (prove)\nusing this:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + 2 * K * real s\n  \\<le> - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))\n\ngoal (1 subgoal):\n 1. - d * real (n * s + t - (p * s + t)) + 2 * d * real s + Z t p x +\n    2 * K * real s +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n    \\<le> Z t p x -\n          d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n          (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "by auto"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + Z t p x +\n  2 * K * real s +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n  \\<le> Z t p x -\n        d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n        (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  - d * real (n * s + t - (p * s + t)) + 2 * d * real s + Z t p x +\n  2 * K * real s +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n  \\<le> Z t p x -\n        d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n        (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... = Max {u i x |i. i < s} + (\\<Sum>i<p. abs(u s ((T ^^ (i * s + t)) x))) + birkhoff_sum F (p * s + t) x\n          - d / 2 * card (V x \\<inter> {1..p * s + t}) - d/2 * card(V x \\<inter> {p * s + t<.. n * s+t}) + (\\<Sum>i \\<in> {p* s+t..<n * s+t}. F ((T^^i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Z t p x - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n    Max {u i x |i. i < s} +\n    (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (p * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n    d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "unfolding Z_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (p * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n    d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n    Max {u i x |i. i < s} +\n    (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (p * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n    d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))", "by auto"], ["proof (state)\nthis:\n  Z t p x - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n  Max {u i x |i. i < s} +\n  (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  birkhoff_sum F (p * s + t) x -\n  d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n  d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  Z t p x - d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n  Max {u i x |i. i < s} +\n  (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  birkhoff_sum F (p * s + t) x -\n  d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n  d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... \\<le> Max {u i x |i. i < s} + (\\<Sum>i<n. abs(u s ((T ^^ (i * s + t)) x)))\n        + (birkhoff_sum F (p * s + t) x + (\\<Sum>i \\<in> {p* s+t..<n * s+t}. F ((T^^i) x)))\n        - d/2 * card (V x \\<inter> {1..p * s + t}) - d/2 * card(V x \\<inter> {p * s + t<.. n * s+t})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (p * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n    d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          (birkhoff_sum F (p * s + t) x +\n           (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))) -\n          d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n          d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))", "using A3"], ["proof (prove)\nusing this:\n  (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (p * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n    d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n    (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n    \\<le> Max {u i x |i. i < s} +\n          (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          (birkhoff_sum F (p * s + t) x +\n           (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))) -\n          d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n          d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))", "by auto"], ["proof (state)\nthis:\n  Max {u i x |i. i < s} +\n  (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  birkhoff_sum F (p * s + t) x -\n  d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n  d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n  \\<le> Max {u i x |i. i < s} +\n        (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        (birkhoff_sum F (p * s + t) x +\n         (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))) -\n        d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n        d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "also"], ["proof (state)\nthis:\n  Max {u i x |i. i < s} +\n  (\\<Sum>i<p. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  birkhoff_sum F (p * s + t) x -\n  d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n  d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))\n  \\<le> Max {u i x |i. i < s} +\n        (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        (birkhoff_sum F (p * s + t) x +\n         (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))) -\n        d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n        d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t}))\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "have \"... = Z t n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    (birkhoff_sum F (p * s + t) x +\n     (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))) -\n    d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n    d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) =\n    Z t n x", "unfolding Z_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    (birkhoff_sum F (p * s + t) x +\n     (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))) -\n    d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n    d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) =\n    Max {u i x |i. i < s} +\n    (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (n * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..n * s + t}))", "using A2 A4"], ["proof (prove)\nusing this:\n  card (V x \\<inter> {1..p * s + t}) +\n  card (V x \\<inter> {p * s + t<..n * s + t}) =\n  card (V x \\<inter> {1..n * s + t})\n  birkhoff_sum F (p * s + t) x +\n  (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x)) =\n  birkhoff_sum F (n * s + t) x\n\ngoal (1 subgoal):\n 1. Max {u i x |i. i < s} +\n    (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    (birkhoff_sum F (p * s + t) x +\n     (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))) -\n    d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n    d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) =\n    Max {u i x |i. i < s} +\n    (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (n * s + t) x -\n    d / 2 * real (card (V x \\<inter> {1..n * s + t}))", "by (auto simp add: algebra_simps, metis distrib_left of_nat_add)"], ["proof (state)\nthis:\n  Max {u i x |i. i < s} +\n  (\\<Sum>i<n. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  (birkhoff_sum F (p * s + t) x +\n   (\\<Sum>i = p * s + t..<n * s + t. F ((T ^^ i) x))) -\n  d / 2 * real (card (V x \\<inter> {1..p * s + t})) -\n  d / 2 * real (card (V x \\<inter> {p * s + t<..n * s + t})) =\n  Z t n x\n\ngoal (1 subgoal):\n 1. 0 < n \\<and>\n    V x \\<inter> {(n - 1) * s + t<..n * s + t} \\<noteq> {} \\<Longrightarrow>\n    u (n * s + t) x \\<le> Z t n x", "finally"], ["proof (chain)\npicking this:\n  u (n * s + t) x \\<le> Z t n x", "show ?thesis"], ["proof (prove)\nusing this:\n  u (n * s + t) x \\<le> Z t n x\n\ngoal (1 subgoal):\n 1. u (n * s + t) x \\<le> Z t n x", "by simp"], ["proof (state)\nthis:\n  u (n * s + t) x \\<le> Z t n x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u (n * s + t) x \\<le> Z t n x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?t12 < s \\<Longrightarrow> u (?n12 * s + ?t12) ?x12 \\<le> Z ?t12 ?n12 ?x12\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have Main2: \"(d/2) * card(V x \\<inter> {1..n}) \\<le> Max {u i x|i. i< s} + birkhoff_sum (\\<lambda>x. abs(u s x/ s)) (n+2* s) x\n    + birkhoff_sum F (n + 2 * s) x + (1/s) * (\\<Sum>i< 2 * s. abs(u (n+i) x))\" for n x"], ["proof (prove)\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "define N where \"N = (n div s) + 1\""], ["proof (state)\nthis:\n  N = n div s + 1\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "then"], ["proof (chain)\npicking this:\n  N = n div s + 1", "have \"n \\<le> N * s\""], ["proof (prove)\nusing this:\n  N = n div s + 1\n\ngoal (1 subgoal):\n 1. n \\<le> N * s", "using \\<open>s > 0\\<close> dividend_less_div_times less_or_eq_imp_le"], ["proof (prove)\nusing this:\n  N = n div s + 1\n  0 < s\n  0 < ?n \\<Longrightarrow> ?m < ?n + ?m div ?n * ?n\n  ?m < ?n \\<or> ?m = ?n \\<Longrightarrow> ?m \\<le> ?n\n\ngoal (1 subgoal):\n 1. n \\<le> N * s", "by auto"], ["proof (state)\nthis:\n  n \\<le> N * s\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"N * s \\<le> n + s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. N * s \\<le> n + s", "by (auto simp add: N_def)"], ["proof (state)\nthis:\n  N * s \\<le> n + s\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have eq_t: \"(d/2) * card(V x \\<inter> {1..n}) \\<le> abs(u(N* s+t) x) + (Max {u i x|i. i< s} + birkhoff_sum F (n + 2* s) x)\n            + (\\<Sum>i<N. abs(u s ((T^^(i * s+t))x)))\"\n      if \"t<s\" for t"], ["proof (prove)\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "have *: \"birkhoff_sum F (N * s+t) x \\<le> birkhoff_sum F (n+ 2* s) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum F (N * s + t) x \\<le> birkhoff_sum F (n + 2 * s) x", "unfolding birkhoff_sum_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<N * s + t. F ((T ^^ i) x))\n    \\<le> (\\<Sum>i<n + 2 * s. F ((T ^^ i) x))", "apply (rule sum_mono2)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite {..<n + 2 * s}\n 2. {..<N * s + t} \\<subseteq> {..<n + 2 * s}\n 3. \\<And>b.\n       b \\<in> {..<n + 2 * s} - {..<N * s + t} \\<Longrightarrow>\n       0 \\<le> F ((T ^^ b) x)", "using F_pos \\<open>N * s \\<le> n + s\\<close> \\<open>t<s\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> F ?x12\n  N * s \\<le> n + s\n  t < s\n\ngoal (3 subgoals):\n 1. finite {..<n + 2 * s}\n 2. {..<N * s + t} \\<subseteq> {..<n + 2 * s}\n 3. \\<And>b.\n       b \\<in> {..<n + 2 * s} - {..<N * s + t} \\<Longrightarrow>\n       0 \\<le> F ((T ^^ b) x)", "by auto"], ["proof (state)\nthis:\n  birkhoff_sum F (N * s + t) x \\<le> birkhoff_sum F (n + 2 * s) x\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "have \"card(V x \\<inter> {1..n}) \\<le> card(V x \\<inter> {1..N* s+t})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (V x \\<inter> {1..n}) \\<le> card (V x \\<inter> {1..N * s + t})", "apply (rule card_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite (V x \\<inter> {1..N * s + t})\n 2. V x \\<inter> {1..n} \\<subseteq> V x \\<inter> {1..N * s + t}", "using \\<open>n \\<le> N * s\\<close>"], ["proof (prove)\nusing this:\n  n \\<le> N * s\n\ngoal (2 subgoals):\n 1. finite (V x \\<inter> {1..N * s + t})\n 2. V x \\<inter> {1..n} \\<subseteq> V x \\<inter> {1..N * s + t}", "by auto"], ["proof (state)\nthis:\n  card (V x \\<inter> {1..n}) \\<le> card (V x \\<inter> {1..N * s + t})\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "then"], ["proof (chain)\npicking this:\n  card (V x \\<inter> {1..n}) \\<le> card (V x \\<inter> {1..N * s + t})", "have \"(d/2) * card(V x \\<inter> {1..n}) \\<le> (d/2) * card(V x \\<inter> {1..N* s+t})\""], ["proof (prove)\nusing this:\n  card (V x \\<inter> {1..n}) \\<le> card (V x \\<inter> {1..N * s + t})\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> d / 2 * real (card (V x \\<inter> {1..N * s + t}))", "by auto"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> d / 2 * real (card (V x \\<inter> {1..N * s + t}))\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> d / 2 * real (card (V x \\<inter> {1..N * s + t}))\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "have \"... \\<le> - u (N* s+t) x + Max {u i x|i. i< s} + (\\<Sum>i<N. abs(u s ((T^^(i* s+t))x))) + birkhoff_sum F (N * s+t) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..N * s + t}))\n    \\<le> - u (N * s + t) x + Max {u i x |i. i < s} +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F (N * s + t) x", "using Main[OF \\<open>t < s\\<close>, of N x]"], ["proof (prove)\nusing this:\n  u (N * s + t) x \\<le> Z t N x\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..N * s + t}))\n    \\<le> - u (N * s + t) x + Max {u i x |i. i < s} +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F (N * s + t) x", "unfolding Z_def"], ["proof (prove)\nusing this:\n  u (N * s + t) x\n  \\<le> Max {u i x |i. i < s} +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        birkhoff_sum F (N * s + t) x -\n        d / 2 * real (card (V x \\<inter> {1..N * s + t}))\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..N * s + t}))\n    \\<le> - u (N * s + t) x + Max {u i x |i. i < s} +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n          birkhoff_sum F (N * s + t) x", "by auto"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..N * s + t}))\n  \\<le> - u (N * s + t) x + Max {u i x |i. i < s} +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        birkhoff_sum F (N * s + t) x\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "also"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..N * s + t}))\n  \\<le> - u (N * s + t) x + Max {u i x |i. i < s} +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n        birkhoff_sum F (N * s + t) x\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "have \"... \\<le> abs(u(N* s+t) x) + Max {u i x|i. i< s} + birkhoff_sum F (n + 2* s) x + (\\<Sum>i<N. abs(u s ((T^^(i* s+t))x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - u (N * s + t) x + Max {u i x |i. i < s} +\n    (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (N * s + t) x\n    \\<le> \\<bar>u (N * s + t) x\\<bar> + Max {u i x |i. i < s} +\n          birkhoff_sum F (n + 2 * s) x +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "using *"], ["proof (prove)\nusing this:\n  birkhoff_sum F (N * s + t) x \\<le> birkhoff_sum F (n + 2 * s) x\n\ngoal (1 subgoal):\n 1. - u (N * s + t) x + Max {u i x |i. i < s} +\n    (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n    birkhoff_sum F (N * s + t) x\n    \\<le> \\<bar>u (N * s + t) x\\<bar> + Max {u i x |i. i < s} +\n          birkhoff_sum F (n + 2 * s) x +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  - u (N * s + t) x + Max {u i x |i. i < s} +\n  (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) +\n  birkhoff_sum F (N * s + t) x\n  \\<le> \\<bar>u (N * s + t) x\\<bar> + Max {u i x |i. i < s} +\n        birkhoff_sum F (n + 2 * s) x +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "finally"], ["proof (chain)\npicking this:\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> \\<bar>u (N * s + t) x\\<bar> + Max {u i x |i. i < s} +\n        birkhoff_sum F (n + 2 * s) x +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "show ?thesis"], ["proof (prove)\nusing this:\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> \\<bar>u (N * s + t) x\\<bar> + Max {u i x |i. i < s} +\n        birkhoff_sum F (n + 2 * s) x +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> \\<bar>u (N * s + t) x\\<bar> +\n          (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "by simp"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> \\<bar>u (N * s + t) x\\<bar> +\n        (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?t12 < s \\<Longrightarrow>\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> \\<bar>u (N * s + ?t12) x\\<bar> +\n        (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + ?t12)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"(\\<Sum>t<s. abs(u(N* s+t) x)) = (\\<Sum>i\\<in>{N* s..<N* s+s}. abs (u i x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) =\n    (\\<Sum>i = N * s..<N * s + s. \\<bar>u i x\\<bar>)", "by (rule sum.reindex_bij_betw, rule bij_betw_byWitness[where ?f' = \"\\<lambda>i. i - N* s\"], auto)"], ["proof (state)\nthis:\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) =\n  (\\<Sum>i = N * s..<N * s + s. \\<bar>u i x\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) =\n  (\\<Sum>i = N * s..<N * s + s. \\<bar>u i x\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"... \\<le> (\\<Sum>i\\<in>{n..<n + 2* s}. abs (u i x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = N * s..<N * s + s. \\<bar>u i x\\<bar>)\n    \\<le> (\\<Sum>i = n..<n + 2 * s. \\<bar>u i x\\<bar>)", "apply (rule sum_mono2)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite {n..<n + 2 * s}\n 2. {N * s..<N * s + s} \\<subseteq> {n..<n + 2 * s}\n 3. \\<And>b.\n       b \\<in> {n..<n + 2 * s} - {N * s..<N * s + s} \\<Longrightarrow>\n       0 \\<le> \\<bar>u b x\\<bar>", "using \\<open>n \\<le> N * s\\<close> \\<open>N * s \\<le> n + s\\<close>"], ["proof (prove)\nusing this:\n  n \\<le> N * s\n  N * s \\<le> n + s\n\ngoal (3 subgoals):\n 1. finite {n..<n + 2 * s}\n 2. {N * s..<N * s + s} \\<subseteq> {n..<n + 2 * s}\n 3. \\<And>b.\n       b \\<in> {n..<n + 2 * s} - {N * s..<N * s + s} \\<Longrightarrow>\n       0 \\<le> \\<bar>u b x\\<bar>", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i = N * s..<N * s + s. \\<bar>u i x\\<bar>)\n  \\<le> (\\<Sum>i = n..<n + 2 * s. \\<bar>u i x\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = N * s..<N * s + s. \\<bar>u i x\\<bar>)\n  \\<le> (\\<Sum>i = n..<n + 2 * s. \\<bar>u i x\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"... = (\\<Sum>i<2* s. abs (u (n+i) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = n..<n + 2 * s. \\<bar>u i x\\<bar>) =\n    (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "by (rule sum.reindex_bij_betw[symmetric], rule bij_betw_byWitness[where ?f' = \"\\<lambda>i. i - n\"], auto)"], ["proof (state)\nthis:\n  (\\<Sum>i = n..<n + 2 * s. \\<bar>u i x\\<bar>) =\n  (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>)\n  \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have **: \"(\\<Sum>t<s. abs(u(N* s+t) x)) \\<le> (\\<Sum>i<2* s. abs (u (n+i) x))\""], ["proof (prove)\nusing this:\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>)\n  \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)\n\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>)\n    \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>)\n  \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"(\\<Sum>t<s. (\\<Sum>i<N. abs(u s ((T^^(i* s+t))x)))) = (\\<Sum>i<N* s. abs(u s ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) =\n    (\\<Sum>i<N * s. \\<bar>u s ((T ^^ i) x)\\<bar>)", "by (rule sum_arith_progression)"], ["proof (state)\nthis:\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) =\n  (\\<Sum>i<N * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>) =\n  (\\<Sum>i<N * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"... \\<le> (\\<Sum>i<n + 2* s. abs(u s ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<N * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n    \\<le> (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar>)", "apply (rule sum_mono2)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite {..<n + 2 * s}\n 2. {..<N * s} \\<subseteq> {..<n + 2 * s}\n 3. \\<And>b.\n       b \\<in> {..<n + 2 * s} - {..<N * s} \\<Longrightarrow>\n       0 \\<le> \\<bar>u s ((T ^^ b) x)\\<bar>", "using \\<open>N * s \\<le> n + s\\<close>"], ["proof (prove)\nusing this:\n  N * s \\<le> n + s\n\ngoal (3 subgoals):\n 1. finite {..<n + 2 * s}\n 2. {..<N * s} \\<subseteq> {..<n + 2 * s}\n 3. \\<And>b.\n       b \\<in> {..<n + 2 * s} - {..<N * s} \\<Longrightarrow>\n       0 \\<le> \\<bar>u s ((T ^^ b) x)\\<bar>", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i<N * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n  \\<le> (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar>)", "have ***: \"(\\<Sum>t<s. (\\<Sum>i<N. abs(u s ((T^^(i* s+t))x)))) \\<le> s * birkhoff_sum (\\<lambda>x. abs(u s x/ s)) (n+2* s) x\""], ["proof (prove)\nusing this:\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n    \\<le> real s *\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x", "unfolding birkhoff_sum_def"], ["proof (prove)\nusing this:\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n    \\<le> real s *\n          (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x) / real s\\<bar>)", "using \\<open>s>0\\<close>"], ["proof (prove)\nusing this:\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n  0 < s\n\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n    \\<le> real s *\n          (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x) / real s\\<bar>)", "by (auto simp add: sum_divide_distrib[symmetric])"], ["proof (state)\nthis:\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> real s *\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have ****: \"s * (\\<Sum>i<n + 2* s. abs(u s ((T^^i) x)) /s) = (\\<Sum>i<n + 2* s. abs(u s ((T^^i) x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real s * (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar> / real s) =\n    (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar>)", "by (auto simp add: sum_divide_distrib[symmetric])"], ["proof (state)\nthis:\n  real s * (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar> / real s) =\n  (\\<Sum>i<n + 2 * s. \\<bar>u s ((T ^^ i) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"s * (d/2) * card(V x \\<inter> {1..n}) = (\\<Sum>t<s. (d/2) * card(V x \\<inter> {1..n}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real s * (d / 2) * real (card (V x \\<inter> {1..n})) =\n    (\\<Sum>t<s. d / 2 * real (card (V x \\<inter> {1..n})))", "by auto"], ["proof (state)\nthis:\n  real s * (d / 2) * real (card (V x \\<inter> {1..n})) =\n  (\\<Sum>t<s. d / 2 * real (card (V x \\<inter> {1..n})))\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "also"], ["proof (state)\nthis:\n  real s * (d / 2) * real (card (V x \\<inter> {1..n})) =\n  (\\<Sum>t<s. d / 2 * real (card (V x \\<inter> {1..n})))\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"... \\<le> (\\<Sum>t<s. abs(u(N* s+t) x) + (Max {u i x|i. i< s} + birkhoff_sum F (n + 2* s) x)\n            + (\\<Sum>i<N. abs(u s ((T^^(i* s+t))x))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. d / 2 * real (card (V x \\<inter> {1..n})))\n    \\<le> (\\<Sum>t<s.\n              \\<bar>u (N * s + t) x\\<bar> +\n              (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n              (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>))", "apply (rule sum_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {..<s} \\<Longrightarrow>\n       d / 2 * real (card (V x \\<inter> {1..n}))\n       \\<le> \\<bar>u (N * s + t) x\\<bar> +\n             (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n             (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "using eq_t"], ["proof (prove)\nusing this:\n  ?t12 < s \\<Longrightarrow>\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> \\<bar>u (N * s + ?t12) x\\<bar> +\n        (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + ?t12)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> {..<s} \\<Longrightarrow>\n       d / 2 * real (card (V x \\<inter> {1..n}))\n       \\<le> \\<bar>u (N * s + t) x\\<bar> +\n             (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n             (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>t<s. d / 2 * real (card (V x \\<inter> {1..n})))\n  \\<le> (\\<Sum>t<s.\n            \\<bar>u (N * s + t) x\\<bar> +\n            (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n            (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>))\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>t<s. d / 2 * real (card (V x \\<inter> {1..n})))\n  \\<le> (\\<Sum>t<s.\n            \\<bar>u (N * s + t) x\\<bar> +\n            (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n            (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>))\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"... = (\\<Sum>t<s. abs(u(N* s+t) x)) + (\\<Sum>t<s. Max {u i x|i. i< s} + birkhoff_sum F (n + 2* s) x) + (\\<Sum>t<s. (\\<Sum>i<N. abs(u s ((T^^(i* s+t))x))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>t<s.\n        \\<bar>u (N * s + t) x\\<bar> +\n        (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n        (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)) =\n    (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) +\n    (\\<Sum>t<s. Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n    (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)", "by (auto simp add: sum.distrib)"], ["proof (state)\nthis:\n  (\\<Sum>t<s.\n      \\<bar>u (N * s + t) x\\<bar> +\n      (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n      (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)) =\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) +\n  (\\<Sum>t<s. Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>t<s.\n      \\<bar>u (N * s + t) x\\<bar> +\n      (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n      (\\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)) =\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) +\n  (\\<Sum>t<s. Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"... \\<le> (\\<Sum>i<2* s. abs (u (n+i) x)) + s * (Max {u i x|i. i< s} + birkhoff_sum F (n + 2* s) x) + s * birkhoff_sum (\\<lambda>x. abs(u s x/ s)) (n+2* s) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) +\n    (\\<Sum>t<s. Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n    (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n    \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n          real s * (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          real s *\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x", "using ** ***"], ["proof (prove)\nusing this:\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>)\n  \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> real s *\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x\n\ngoal (1 subgoal):\n 1. (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) +\n    (\\<Sum>t<s. Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n    (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n    \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n          real s * (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n          real s *\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) +\n  (\\<Sum>t<s. Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n        real s * (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n        real s *\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>t<s. \\<bar>u (N * s + t) x\\<bar>) +\n  (\\<Sum>t<s. Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n  (\\<Sum>t<s. \\<Sum>i<N. \\<bar>u s ((T ^^ (i * s + t)) x)\\<bar>)\n  \\<le> (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n        real s * (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n        real s *\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "have \"... = s * ((1/s) * (\\<Sum>i<2* s. abs (u (n+i) x)) + Max {u i x|i. i< s} + birkhoff_sum F (n + 2* s) x + birkhoff_sum (\\<lambda>x. abs(u s x/ s)) (n+2* s) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n    real s * (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n    real s *\n    birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x =\n    real s *\n    (1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n     Max {u i x |i. i < s} +\n     birkhoff_sum F (n + 2 * s) x +\n     birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x)", "by (auto simp add: divide_simps mult.commute distrib_left)"], ["proof (state)\nthis:\n  (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n  real s * (Max {u i x |i. i < s} + birkhoff_sum F (n + 2 * s) x) +\n  real s *\n  birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x =\n  real s *\n  (1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n   Max {u i x |i. i < s} +\n   birkhoff_sum F (n + 2 * s) x +\n   birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "finally"], ["proof (chain)\npicking this:\n  real s * (d / 2) * real (card (V x \\<inter> {1..n}))\n  \\<le> real s *\n        (1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n         Max {u i x |i. i < s} +\n         birkhoff_sum F (n + 2 * s) x +\n         birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n          x)", "show ?thesis"], ["proof (prove)\nusing this:\n  real s * (d / 2) * real (card (V x \\<inter> {1..n}))\n  \\<le> real s *\n        (1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>) +\n         Max {u i x |i. i < s} +\n         birkhoff_sum F (n + 2 * s) x +\n         birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n          x)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n}))\n    \\<le> Max {u i x |i. i < s} +\n          birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n           x +\n          birkhoff_sum F (n + 2 * s) x +\n          1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)", "by auto"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> Max {u i x |i. i < s} +\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n         x +\n        birkhoff_sum F (n + 2 * s) x +\n        1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  d / 2 * real (card (V ?x12 \\<inter> {1..?n12}))\n  \\<le> Max {u i ?x12 |i. i < s} +\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (?n12 + 2 * s)\n         ?x12 +\n        birkhoff_sum F (?n12 + 2 * s) ?x12 +\n        1 / real s * (\\<Sum>i<2 * s. \\<bar>u (?n12 + i) ?x12\\<bar>)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have densV: \"upper_asymptotic_density (V x) \\<le> (2/d) * real_cond_exp M Invariants F2 x\" if \"x \\<in> G\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have *: \"(\\<lambda>n. abs(u n x/n)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. \\<bar>u n x / real n\\<bar>) \\<longlonglongrightarrow> 0", "apply (rule tendsto_rabs_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> 0", "using \\<open>x\\<in>G\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> G\n\ngoal (1 subgoal):\n 1. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> 0", "unfolding G_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0 \\<and>\n           (\\<lambda>n.\n               birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n               real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants\n(\\<lambda>x. \\<bar>u s x / real s\\<bar>) x \\<and>\n           (\\<lambda>n. birkhoff_sum F n x / real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants F x \\<and>\n           real_cond_exp M Invariants F x +\n           real_cond_exp M Invariants\n            (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n           real_cond_exp M Invariants F2 x}\n\ngoal (1 subgoal):\n 1. (\\<lambda>xa. u xa x / real xa) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. \\<bar>u n x / real n\\<bar>) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "define Bound where \"Bound = (\\<lambda>n. (Max {u i x|i. i< s}*(1/n) + birkhoff_sum (\\<lambda>x. abs(u s x/ s)) (n+2* s) x / n\n      + birkhoff_sum F (n + 2* s) x / n + (1/s) * (\\<Sum>i<2* s. abs(u (n+i) x) / n)))\""], ["proof (state)\nthis:\n  Bound =\n  (\\<lambda>n.\n      Max {u i x |i. i < s} * (1 / real n) +\n      birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x /\n      real n +\n      birkhoff_sum F (n + 2 * s) x / real n +\n      1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar> / real n))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have \"Bound \\<longlonglongrightarrow> (Max {u i x|i. i< s} * 0 + real_cond_exp M Invariants (\\<lambda>x. abs(u s x/s)) x\n                      + real_cond_exp M Invariants F x + (1/s) * (\\<Sum>i < 2 * s. 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Bound\n    \\<longlonglongrightarrow> Max {u i x |i. i < s} * 0 +\n                              real_cond_exp M Invariants\n                               (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n                              real_cond_exp M Invariants F x +\n                              1 / real s * (\\<Sum>i<2 * s. 0)", "unfolding Bound_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        Max {u i x |i. i < s} * (1 / real n) +\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n         x /\n        real n +\n        birkhoff_sum F (n + 2 * s) x / real n +\n        1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar> / real n))\n    \\<longlonglongrightarrow> Max {u i x |i. i < s} * 0 +\n                              real_cond_exp M Invariants\n                               (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n                              real_cond_exp M Invariants F x +\n                              1 / real s * (\\<Sum>i<2 * s. 0)", "apply (intro tendsto_intros)"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<lambda>xa.\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) xa x /\n        real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants\n                               (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x\n 2. (\\<lambda>xa. birkhoff_sum F xa x / real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n 3. \\<And>i.\n       i \\<in> {..<2 * s} \\<Longrightarrow>\n       (\\<lambda>xa. \\<bar>u xa x\\<bar> / real xa)\n       \\<longlonglongrightarrow> 0", "using \\<open>x\\<in>G\\<close> *"], ["proof (prove)\nusing this:\n  x \\<in> G\n  (\\<lambda>n. \\<bar>u n x / real n\\<bar>) \\<longlonglongrightarrow> 0\n\ngoal (3 subgoals):\n 1. (\\<lambda>xa.\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) xa x /\n        real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants\n                               (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x\n 2. (\\<lambda>xa. birkhoff_sum F xa x / real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n 3. \\<And>i.\n       i \\<in> {..<2 * s} \\<Longrightarrow>\n       (\\<lambda>xa. \\<bar>u xa x\\<bar> / real xa)\n       \\<longlonglongrightarrow> 0", "unfolding G_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0 \\<and>\n           (\\<lambda>n.\n               birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n               real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants\n(\\<lambda>x. \\<bar>u s x / real s\\<bar>) x \\<and>\n           (\\<lambda>n. birkhoff_sum F n x / real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants F x \\<and>\n           real_cond_exp M Invariants F x +\n           real_cond_exp M Invariants\n            (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n           real_cond_exp M Invariants F2 x}\n  (\\<lambda>n. \\<bar>u n x / real n\\<bar>) \\<longlonglongrightarrow> 0\n\ngoal (3 subgoals):\n 1. (\\<lambda>xa.\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) xa x /\n        real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants\n                               (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x\n 2. (\\<lambda>xa. birkhoff_sum F xa x / real xa)\n    \\<longlonglongrightarrow> real_cond_exp M Invariants F x\n 3. \\<And>i.\n       i \\<in> {..<2 * s} \\<Longrightarrow>\n       (\\<lambda>xa. \\<bar>u xa x\\<bar> / real xa)\n       \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  Bound\n  \\<longlonglongrightarrow> Max {u i x |i. i < s} * 0 +\n                            real_cond_exp M Invariants\n                             (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n                            real_cond_exp M Invariants F x +\n                            1 / real s * (\\<Sum>i<2 * s. 0)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "moreover"], ["proof (state)\nthis:\n  Bound\n  \\<longlonglongrightarrow> Max {u i x |i. i < s} * 0 +\n                            real_cond_exp M Invariants\n                             (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n                            real_cond_exp M Invariants F x +\n                            1 / real s * (\\<Sum>i<2 * s. 0)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have \"real_cond_exp M Invariants (\\<lambda>x. abs(u s x/s)) x + real_cond_exp M Invariants F x = real_cond_exp M Invariants F2 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n    real_cond_exp M Invariants F x =\n    real_cond_exp M Invariants F2 x", "using \\<open>x \\<in> G\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> G\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n    real_cond_exp M Invariants F x =\n    real_cond_exp M Invariants F2 x", "unfolding G_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           (\\<lambda>n. u n x / real n) \\<longlonglongrightarrow> 0 \\<and>\n           (\\<lambda>n.\n               birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) n x /\n               real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants\n(\\<lambda>x. \\<bar>u s x / real s\\<bar>) x \\<and>\n           (\\<lambda>n. birkhoff_sum F n x / real n)\n           \\<longlonglongrightarrow> real_cond_exp M Invariants F x \\<and>\n           real_cond_exp M Invariants F x +\n           real_cond_exp M Invariants\n            (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x =\n           real_cond_exp M Invariants F2 x}\n\ngoal (1 subgoal):\n 1. real_cond_exp M Invariants (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n    real_cond_exp M Invariants F x =\n    real_cond_exp M Invariants F2 x", "by auto"], ["proof (state)\nthis:\n  real_cond_exp M Invariants (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n  real_cond_exp M Invariants F x =\n  real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "ultimately"], ["proof (chain)\npicking this:\n  Bound\n  \\<longlonglongrightarrow> Max {u i x |i. i < s} * 0 +\n                            real_cond_exp M Invariants\n                             (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n                            real_cond_exp M Invariants F x +\n                            1 / real s * (\\<Sum>i<2 * s. 0)\n  real_cond_exp M Invariants (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n  real_cond_exp M Invariants F x =\n  real_cond_exp M Invariants F2 x", "have B_conv: \"Bound \\<longlonglongrightarrow> real_cond_exp M Invariants F2 x\""], ["proof (prove)\nusing this:\n  Bound\n  \\<longlonglongrightarrow> Max {u i x |i. i < s} * 0 +\n                            real_cond_exp M Invariants\n                             (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n                            real_cond_exp M Invariants F x +\n                            1 / real s * (\\<Sum>i<2 * s. 0)\n  real_cond_exp M Invariants (\\<lambda>x. \\<bar>u s x / real s\\<bar>) x +\n  real_cond_exp M Invariants F x =\n  real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. Bound \\<longlonglongrightarrow> real_cond_exp M Invariants F2 x", "by simp"], ["proof (state)\nthis:\n  Bound \\<longlonglongrightarrow> real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have *: \"(d/2) * card(V x \\<inter> {1..n}) / n \\<le> Bound n\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n", "have \"(d/2) * card(V x \\<inter> {1..n}) / n \\<le> (Max {u i x|i. i< s} + birkhoff_sum (\\<lambda>x. abs(u s x/ s)) (n+2* s) x\n        + birkhoff_sum F (n + 2* s) x + (1/s) * (\\<Sum>i<2* s. abs(u (n+i) x)))/n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n\n    \\<le> (Max {u i x |i. i < s} +\n           birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n            x +\n           birkhoff_sum F (n + 2 * s) x +\n           1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)) /\n          real n", "using Main2[of x n]"], ["proof (prove)\nusing this:\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> Max {u i x |i. i < s} +\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n         x +\n        birkhoff_sum F (n + 2 * s) x +\n        1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n\n    \\<le> (Max {u i x |i. i < s} +\n           birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n            x +\n           birkhoff_sum F (n + 2 * s) x +\n           1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)) /\n          real n", "using divide_right_mono of_nat_0_le_iff"], ["proof (prove)\nusing this:\n  d / 2 * real (card (V x \\<inter> {1..n}))\n  \\<le> Max {u i x |i. i < s} +\n        birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n         x +\n        birkhoff_sum F (n + 2 * s) x +\n        1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)\n  \\<lbrakk>?a \\<le> ?b; (0::?'a) \\<le> ?c\\<rbrakk>\n  \\<Longrightarrow> ?a / ?c \\<le> ?b / ?c\n  (0::?'a) \\<le> of_nat ?n\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n\n    \\<le> (Max {u i x |i. i < s} +\n           birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n            x +\n           birkhoff_sum F (n + 2 * s) x +\n           1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)) /\n          real n", "by blast"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..n})) / real n\n  \\<le> (Max {u i x |i. i < s} +\n         birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n          x +\n         birkhoff_sum F (n + 2 * s) x +\n         1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)) /\n        real n\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n", "also"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..n})) / real n\n  \\<le> (Max {u i x |i. i < s} +\n         birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s)\n          x +\n         birkhoff_sum F (n + 2 * s) x +\n         1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)) /\n        real n\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n", "have \"... = Bound n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Max {u i x |i. i < s} +\n     birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x +\n     birkhoff_sum F (n + 2 * s) x +\n     1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)) /\n    real n =\n    Bound n", "unfolding Bound_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (Max {u i x |i. i < s} +\n     birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x +\n     birkhoff_sum F (n + 2 * s) x +\n     1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)) /\n    real n =\n    Max {u i x |i. i < s} * (1 / real n) +\n    birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x /\n    real n +\n    birkhoff_sum F (n + 2 * s) x / real n +\n    1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar> / real n)", "by (auto simp add: add_divide_distrib sum_divide_distrib[symmetric])"], ["proof (state)\nthis:\n  (Max {u i x |i. i < s} +\n   birkhoff_sum (\\<lambda>x. \\<bar>u s x / real s\\<bar>) (n + 2 * s) x +\n   birkhoff_sum F (n + 2 * s) x +\n   1 / real s * (\\<Sum>i<2 * s. \\<bar>u (n + i) x\\<bar>)) /\n  real n =\n  Bound n\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n", "finally"], ["proof (chain)\npicking this:\n  d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n", "show ?thesis"], ["proof (prove)\nusing this:\n  d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n\n\ngoal (1 subgoal):\n 1. d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n", "by simp"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..n})) / real n \\<le> Bound n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  d / 2 * real (card (V x \\<inter> {1..?n12})) / real ?n12 \\<le> Bound ?n12\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have \"ereal(d/2 * upper_asymptotic_density (V x)) = ereal(d/2) * ereal(upper_asymptotic_density (V x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ereal (d / 2 * upper_asymptotic_density (V x)) =\n    ereal (d / 2) * ereal (upper_asymptotic_density (V x))", "by auto"], ["proof (state)\nthis:\n  ereal (d / 2 * upper_asymptotic_density (V x)) =\n  ereal (d / 2) * ereal (upper_asymptotic_density (V x))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "also"], ["proof (state)\nthis:\n  ereal (d / 2 * upper_asymptotic_density (V x)) =\n  ereal (d / 2) * ereal (upper_asymptotic_density (V x))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have \"... = ereal (d/2) * limsup(\\<lambda>n. card(V x \\<inter> {1..n}) / n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ereal (d / 2) * ereal (upper_asymptotic_density (V x)) =\n    ereal (d / 2) *\n    limsup\n     (\\<lambda>xa. ereal (real (card (V x \\<inter> {1..xa})) / real xa))", "using upper_asymptotic_density_shift[of \"V x\" 1 0]"], ["proof (prove)\nusing this:\n  ereal (upper_asymptotic_density (V x)) =\n  limsup\n   (\\<lambda>xa.\n       ereal (real (card (V x \\<inter> {1..nat (int xa + 0)})) / real xa))\n\ngoal (1 subgoal):\n 1. ereal (d / 2) * ereal (upper_asymptotic_density (V x)) =\n    ereal (d / 2) *\n    limsup\n     (\\<lambda>xa. ereal (real (card (V x \\<inter> {1..xa})) / real xa))", "by auto"], ["proof (state)\nthis:\n  ereal (d / 2) * ereal (upper_asymptotic_density (V x)) =\n  ereal (d / 2) *\n  limsup (\\<lambda>xa. ereal (real (card (V x \\<inter> {1..xa})) / real xa))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "also"], ["proof (state)\nthis:\n  ereal (d / 2) * ereal (upper_asymptotic_density (V x)) =\n  ereal (d / 2) *\n  limsup (\\<lambda>xa. ereal (real (card (V x \\<inter> {1..xa})) / real xa))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have \"... = limsup(\\<lambda>n. ereal (d/2) * (card(V x \\<inter> {1..n}) / n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ereal (d / 2) *\n    limsup\n     (\\<lambda>xa. ereal (real (card (V x \\<inter> {1..xa})) / real xa)) =\n    limsup\n     (\\<lambda>n.\n         ereal (d / 2) * ereal (real (card (V x \\<inter> {1..n})) / real n))", "by (rule limsup_ereal_mult_left[symmetric], auto)"], ["proof (state)\nthis:\n  ereal (d / 2) *\n  limsup\n   (\\<lambda>xa. ereal (real (card (V x \\<inter> {1..xa})) / real xa)) =\n  limsup\n   (\\<lambda>n.\n       ereal (d / 2) * ereal (real (card (V x \\<inter> {1..n})) / real n))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "also"], ["proof (state)\nthis:\n  ereal (d / 2) *\n  limsup\n   (\\<lambda>xa. ereal (real (card (V x \\<inter> {1..xa})) / real xa)) =\n  limsup\n   (\\<lambda>n.\n       ereal (d / 2) * ereal (real (card (V x \\<inter> {1..n})) / real n))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have \"... \\<le> limsup Bound\""], ["proof (prove)\ngoal (1 subgoal):\n 1. limsup\n     (\\<lambda>n.\n         ereal (d / 2) * ereal (real (card (V x \\<inter> {1..n})) / real n))\n    \\<le> limsup (\\<lambda>x. ereal (Bound x))", "apply (rule Limsup_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F xa in sequentially.\n       ereal (d / 2) * ereal (real (card (V x \\<inter> {1..xa})) / real xa)\n       \\<le> ereal (Bound xa)", "using * not_eventuallyD"], ["proof (prove)\nusing this:\n  d / 2 * real (card (V x \\<inter> {1..?n12})) / real ?n12 \\<le> Bound ?n12\n  \\<not> eventually ?P ?F \\<Longrightarrow> \\<exists>x. \\<not> ?P x\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F xa in sequentially.\n       ereal (d / 2) * ereal (real (card (V x \\<inter> {1..xa})) / real xa)\n       \\<le> ereal (Bound xa)", "by auto"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>n.\n       ereal (d / 2) * ereal (real (card (V x \\<inter> {1..n})) / real n))\n  \\<le> limsup (\\<lambda>x. ereal (Bound x))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "also"], ["proof (state)\nthis:\n  limsup\n   (\\<lambda>n.\n       ereal (d / 2) * ereal (real (card (V x \\<inter> {1..n})) / real n))\n  \\<le> limsup (\\<lambda>x. ereal (Bound x))\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "have \"... = ereal(real_cond_exp M Invariants F2 x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. limsup (\\<lambda>x. ereal (Bound x)) =\n    ereal (real_cond_exp M Invariants F2 x)", "using B_conv convergent_limsup_cl convergent_def convergent_real_imp_convergent_ereal limI"], ["proof (prove)\nusing this:\n  Bound \\<longlonglongrightarrow> real_cond_exp M Invariants F2 x\n  convergent ?X \\<Longrightarrow> limsup ?X = lim ?X\n  convergent ?X = (\\<exists>L. ?X \\<longlonglongrightarrow> L)\n  convergent ?a \\<Longrightarrow> convergent (\\<lambda>n. ereal (?a n))\n  convergent ?a \\<Longrightarrow>\n  lim (\\<lambda>n. ereal (?a n)) = ereal (lim ?a)\n  ?X \\<longlonglongrightarrow> ?L \\<Longrightarrow> lim ?X = ?L\n\ngoal (1 subgoal):\n 1. limsup (\\<lambda>x. ereal (Bound x)) =\n    ereal (real_cond_exp M Invariants F2 x)", "by force"], ["proof (state)\nthis:\n  limsup (\\<lambda>x. ereal (Bound x)) =\n  ereal (real_cond_exp M Invariants F2 x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "finally"], ["proof (chain)\npicking this:\n  ereal (d / 2 * upper_asymptotic_density (V x))\n  \\<le> ereal (real_cond_exp M Invariants F2 x)", "have \"d/2 * upper_asymptotic_density (V x) \\<le> real_cond_exp M Invariants F2 x\""], ["proof (prove)\nusing this:\n  ereal (d / 2 * upper_asymptotic_density (V x))\n  \\<le> ereal (real_cond_exp M Invariants F2 x)\n\ngoal (1 subgoal):\n 1. d / 2 * upper_asymptotic_density (V x)\n    \\<le> real_cond_exp M Invariants F2 x", "by auto"], ["proof (state)\nthis:\n  d / 2 * upper_asymptotic_density (V x)\n  \\<le> real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "then"], ["proof (chain)\npicking this:\n  d / 2 * upper_asymptotic_density (V x)\n  \\<le> real_cond_exp M Invariants F2 x", "show ?thesis"], ["proof (prove)\nusing this:\n  d / 2 * upper_asymptotic_density (V x)\n  \\<le> real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "by (simp add: divide_simps mult.commute)"], ["proof (state)\nthis:\n  upper_asymptotic_density (V x)\n  \\<le> 2 / d * real_cond_exp M Invariants F2 x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x12 \\<in> G \\<Longrightarrow>\n  upper_asymptotic_density (V ?x12)\n  \\<le> 2 / d * real_cond_exp M Invariants F2 ?x12\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define epsilon where \"epsilon = 2 * rho / d\""], ["proof (state)\nthis:\n  epsilon = 2 * rho / d\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have [simp]: \"epsilon > 0\" \"epsilon \\<noteq> 0\" \"epsilon \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < epsilon &&& epsilon \\<noteq> 0 &&& 0 \\<le> epsilon", "unfolding epsilon_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 2 * rho / d &&& 2 * rho / d \\<noteq> 0 &&& 0 \\<le> 2 * rho / d", "by auto"], ["proof (state)\nthis:\n  0 < epsilon\n  epsilon \\<noteq> 0\n  0 \\<le> epsilon\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"emeasure M {x\\<in>space M. real_cond_exp M Invariants F2 x \\<ge> epsilon} \\<le> (1/epsilon) * (\\<integral>x. real_cond_exp M Invariants F2 x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n    \\<le> ennreal\n           (1 / epsilon * expectation (real_cond_exp M Invariants F2))", "apply (intro integral_Markov_inequality real_cond_exp_pos real_cond_exp_int(1))"], ["proof (prove)\ngoal (4 subgoals):\n 1. integrable M F2\n 2. AE x in M. 0 \\<le> F2 x\n 3. random_variable borel F2\n 4. 0 < epsilon", "by (auto simp add: int_F2 F2_pos)"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n  \\<le> ennreal (1 / epsilon * expectation (real_cond_exp M Invariants F2))\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "also"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n  \\<le> ennreal (1 / epsilon * expectation (real_cond_exp M Invariants F2))\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"... = (1/epsilon) * (\\<integral>x. F2 x \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 / epsilon * expectation (real_cond_exp M Invariants F2)) =\n    ennreal (1 / epsilon * expectation F2)", "apply (intro arg_cong[where f = ennreal])"], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / epsilon * expectation (real_cond_exp M Invariants F2) =\n    1 / epsilon * expectation F2", "by (simp, rule real_cond_exp_int(2), simp add: int_F2)"], ["proof (state)\nthis:\n  ennreal (1 / epsilon * expectation (real_cond_exp M Invariants F2)) =\n  ennreal (1 / epsilon * expectation F2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "also"], ["proof (state)\nthis:\n  ennreal (1 / epsilon * expectation (real_cond_exp M Invariants F2)) =\n  ennreal (1 / epsilon * expectation F2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"... < (1/epsilon) * 2 * rho\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 / epsilon * expectation F2) < ennreal (1 / epsilon * 2 * rho)", "using F2_int"], ["proof (prove)\nusing this:\n  expectation F2 < 2 * rho\n\ngoal (1 subgoal):\n 1. ennreal (1 / epsilon * expectation F2) < ennreal (1 / epsilon * 2 * rho)", "by (intro ennreal_lessI) (auto simp add: divide_simps)"], ["proof (state)\nthis:\n  ennreal (1 / epsilon * expectation F2) < ennreal (1 / epsilon * 2 * rho)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "also"], ["proof (state)\nthis:\n  ennreal (1 / epsilon * expectation F2) < ennreal (1 / epsilon * 2 * rho)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"... = d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 / epsilon * 2 * rho) = ennreal d", "unfolding epsilon_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 / (2 * rho / d) * 2 * rho) = ennreal d", "by auto"], ["proof (state)\nthis:\n  ennreal (1 / epsilon * 2 * rho) = ennreal d\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "finally"], ["proof (chain)\npicking this:\n  emeasure M\n   {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n  < ennreal d", "have *: \"emeasure M {x\\<in>space M. real_cond_exp M Invariants F2 x \\<ge> epsilon} < d\""], ["proof (prove)\nusing this:\n  emeasure M\n   {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n  < ennreal d\n\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n    < ennreal d", "by simp"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n  < ennreal d\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "define G2 where \"G2 = {x \\<in> G. real_cond_exp M Invariants F2 x < epsilon}\""], ["proof (state)\nthis:\n  G2 = {x \\<in> G. real_cond_exp M Invariants F2 x < epsilon}\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have [measurable]: \"G2 \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. G2 \\<in> events", "unfolding G2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> G. real_cond_exp M Invariants F2 x < epsilon} \\<in> events", "by simp"], ["proof (state)\nthis:\n  G2 \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"1 = emeasure M G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 = emeasure M G", "using \\<open>emeasure M G = 1\\<close>"], ["proof (prove)\nusing this:\n  emeasure M G = 1\n\ngoal (1 subgoal):\n 1. 1 = emeasure M G", "by simp"], ["proof (state)\nthis:\n  1 = emeasure M G\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "also"], ["proof (state)\nthis:\n  1 = emeasure M G\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"... \\<le> emeasure M (G2 \\<union> {x\\<in>space M. real_cond_exp M Invariants F2 x \\<ge> epsilon})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M G\n    \\<le> emeasure M\n           (G2 \\<union>\n            {x \\<in> space M.\n             epsilon \\<le> real_cond_exp M Invariants F2 x})", "apply (rule emeasure_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. G \\<subseteq> G2 \\<union>\n                  {x \\<in> space M.\n                   epsilon \\<le> real_cond_exp M Invariants F2 x}\n 2. G2 \\<union>\n    {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n    \\<in> events", "unfolding G2_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. G \\<subseteq> {x \\<in> G.\n                   real_cond_exp M Invariants F2 x < epsilon} \\<union>\n                  {x \\<in> space M.\n                   epsilon \\<le> real_cond_exp M Invariants F2 x}\n 2. {x \\<in> G. real_cond_exp M Invariants F2 x < epsilon} \\<union>\n    {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n    \\<in> events", "using sets.sets_into_space[OF \\<open>G \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  G \\<subseteq> space M\n\ngoal (2 subgoals):\n 1. G \\<subseteq> {x \\<in> G.\n                   real_cond_exp M Invariants F2 x < epsilon} \\<union>\n                  {x \\<in> space M.\n                   epsilon \\<le> real_cond_exp M Invariants F2 x}\n 2. {x \\<in> G. real_cond_exp M Invariants F2 x < epsilon} \\<union>\n    {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  emeasure M G\n  \\<le> emeasure M\n         (G2 \\<union>\n          {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x})\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "also"], ["proof (state)\nthis:\n  emeasure M G\n  \\<le> emeasure M\n         (G2 \\<union>\n          {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x})\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"... \\<le> emeasure M G2 + emeasure M {x\\<in>space M. real_cond_exp M Invariants F2 x \\<ge> epsilon}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     (G2 \\<union>\n      {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x})\n    \\<le> emeasure M G2 +\n          emeasure M\n           {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}", "by (rule emeasure_subadditive, auto)"], ["proof (state)\nthis:\n  emeasure M\n   (G2 \\<union>\n    {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x})\n  \\<le> emeasure M G2 +\n        emeasure M\n         {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "also"], ["proof (state)\nthis:\n  emeasure M\n   (G2 \\<union>\n    {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x})\n  \\<le> emeasure M G2 +\n        emeasure M\n         {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"... < emeasure M G2 + d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M G2 +\n    emeasure M\n     {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n    < emeasure M G2 + ennreal d", "using *"], ["proof (prove)\nusing this:\n  emeasure M\n   {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n  < ennreal d\n\ngoal (1 subgoal):\n 1. emeasure M G2 +\n    emeasure M\n     {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n    < emeasure M G2 + ennreal d", "by auto"], ["proof (state)\nthis:\n  emeasure M G2 +\n  emeasure M\n   {x \\<in> space M. epsilon \\<le> real_cond_exp M Invariants F2 x}\n  < emeasure M G2 + ennreal d\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "finally"], ["proof (chain)\npicking this:\n  1 < emeasure M G2 + ennreal d", "have \"1 - d < emeasure M G2\""], ["proof (prove)\nusing this:\n  1 < emeasure M G2 + ennreal d\n\ngoal (1 subgoal):\n 1. ennreal (1 - d) < emeasure M G2", "using emeasure_eq_measure \\<open>d \\<le> 1\\<close>"], ["proof (prove)\nusing this:\n  1 < emeasure M G2 + ennreal d\n  emeasure M ?A = ennreal (prob ?A)\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. ennreal (1 - d) < emeasure M G2", "by (auto intro!: ennreal_less_iff[THEN iffD2] simp del: ennreal_plus simp add: ennreal_plus[symmetric])"], ["proof (state)\nthis:\n  ennreal (1 - d) < emeasure M G2\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "have \"upper_asymptotic_density {n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - d * l} < d\"\n    if \"x \\<in> G2\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "have \"x \\<in> G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> G", "using \\<open>x \\<in> G2\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> G2\n\ngoal (1 subgoal):\n 1. x \\<in> G", "unfolding G2_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> G. real_cond_exp M Invariants F2 x < epsilon}\n\ngoal (1 subgoal):\n 1. x \\<in> G", "by auto"], ["proof (state)\nthis:\n  x \\<in> G\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "have \"{n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - d * l} \\<subseteq> U x \\<union> V x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    \\<subseteq> U x \\<union> V x", "unfolding U_def V_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    \\<subseteq> {n. \\<exists>l\\<in>{n - s<..n}.\n                       u n x - u (n - l) x \\<le> - d * real l} \\<union>\n                {n. \\<exists>l\\<in>{k..n - s}.\n                       u n x - u (n - l) x \\<le> - d * real l}", "by fastforce"], ["proof (state)\nthis:\n  {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n  \\<subseteq> U x \\<union> V x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "then"], ["proof (chain)\npicking this:\n  {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n  \\<subseteq> U x \\<union> V x", "have \"upper_asymptotic_density {n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - d * l} \\<le> upper_asymptotic_density (U x \\<union> V x)\""], ["proof (prove)\nusing this:\n  {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n  \\<subseteq> U x \\<union> V x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    \\<le> upper_asymptotic_density (U x \\<union> V x)", "by (rule upper_asymptotic_density_subset)"], ["proof (state)\nthis:\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n  \\<le> upper_asymptotic_density (U x \\<union> V x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "also"], ["proof (state)\nthis:\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n  \\<le> upper_asymptotic_density (U x \\<union> V x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "have \"... \\<le> upper_asymptotic_density (U x) + upper_asymptotic_density (V x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x \\<union> V x)\n    \\<le> upper_asymptotic_density (U x) + upper_asymptotic_density (V x)", "by (rule upper_asymptotic_density_union)"], ["proof (state)\nthis:\n  upper_asymptotic_density (U x \\<union> V x)\n  \\<le> upper_asymptotic_density (U x) + upper_asymptotic_density (V x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "also"], ["proof (state)\nthis:\n  upper_asymptotic_density (U x \\<union> V x)\n  \\<le> upper_asymptotic_density (U x) + upper_asymptotic_density (V x)\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "have \"... \\<le> (2/d) * real_cond_exp M Invariants F2 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) + upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "using densU[OF \\<open>x \\<in> G\\<close>] densV[OF \\<open>x \\<in> G\\<close>]"], ["proof (prove)\nusing this:\n  upper_asymptotic_density (U x) = 0\n  upper_asymptotic_density (V x)\n  \\<le> 2 / d * real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density (U x) + upper_asymptotic_density (V x)\n    \\<le> 2 / d * real_cond_exp M Invariants F2 x", "by auto"], ["proof (state)\nthis:\n  upper_asymptotic_density (U x) + upper_asymptotic_density (V x)\n  \\<le> 2 / d * real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "also"], ["proof (state)\nthis:\n  upper_asymptotic_density (U x) + upper_asymptotic_density (V x)\n  \\<le> 2 / d * real_cond_exp M Invariants F2 x\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "have \"... < (2/d) * epsilon\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 / d * real_cond_exp M Invariants F2 x < 2 / d * epsilon", "using \\<open>x \\<in> G2\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> G2\n\ngoal (1 subgoal):\n 1. 2 / d * real_cond_exp M Invariants F2 x < 2 / d * epsilon", "unfolding G2_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> G. real_cond_exp M Invariants F2 x < epsilon}\n\ngoal (1 subgoal):\n 1. 2 / d * real_cond_exp M Invariants F2 x < 2 / d * epsilon", "by (simp add: divide_simps)"], ["proof (state)\nthis:\n  2 / d * real_cond_exp M Invariants F2 x < 2 / d * epsilon\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "text \\<open>This is where the choice of $\\rho$ at the beginning of the proof is relevant:\n    we choose it so that the above term is at most $d$.\\<close>"], ["proof (state)\nthis:\n  2 / d * real_cond_exp M Invariants F2 x < 2 / d * epsilon\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "also"], ["proof (state)\nthis:\n  2 / d * real_cond_exp M Invariants F2 x < 2 / d * epsilon\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "have \"... = d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 / d * epsilon = d", "unfolding epsilon_def rho_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 / d * (2 * (d * d * d / 4) / d) = d", "by auto"], ["proof (state)\nthis:\n  2 / d * epsilon = d\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "finally"], ["proof (chain)\npicking this:\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n  < d", "show ?thesis"], ["proof (prove)\nusing this:\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n  < d\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n    < d", "by simp"], ["proof (state)\nthis:\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n  < d\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x12 \\<in> G2 \\<Longrightarrow>\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n ?x12 - u (n - l) ?x12 \\<le> - d * real l}\n  < d\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  ?x12 \\<in> G2 \\<Longrightarrow>\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n ?x12 - u (n - l) ?x12 \\<le> - d * real l}\n  < d", "have \"G2 \\<subseteq> {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - d * l} < d}\""], ["proof (prove)\nusing this:\n  ?x12 \\<in> G2 \\<Longrightarrow>\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n ?x12 - u (n - l) ?x12 \\<le> - d * real l}\n  < d\n\ngoal (1 subgoal):\n 1. G2 \\<subseteq> {x \\<in> space M.\n                    upper_asymptotic_density\n                     {n. \\<exists>l\\<in>{k..n}.\n                            u n x - u (n - l) x \\<le> - d * real l}\n                    < d}", "using sets.sets_into_space[OF \\<open>G2 \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  ?x12 \\<in> G2 \\<Longrightarrow>\n  upper_asymptotic_density\n   {n. \\<exists>l\\<in>{k..n}. u n ?x12 - u (n - l) ?x12 \\<le> - d * real l}\n  < d\n  G2 \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. G2 \\<subseteq> {x \\<in> space M.\n                    upper_asymptotic_density\n                     {n. \\<exists>l\\<in>{k..n}.\n                            u n x - u (n - l) x \\<le> - d * real l}\n                    < d}", "by blast"], ["proof (state)\nthis:\n  G2 \\<subseteq> {x \\<in> space M.\n                  upper_asymptotic_density\n                   {n. \\<exists>l\\<in>{k..n}.\n                          u n x - u (n - l) x \\<le> - d * real l}\n                  < d}\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  G2 \\<subseteq> {x \\<in> space M.\n                  upper_asymptotic_density\n                   {n. \\<exists>l\\<in>{k..n}.\n                          u n x - u (n - l) x \\<le> - d * real l}\n                  < d}", "have \"emeasure M G2 \\<le> emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - d * l} < d}\""], ["proof (prove)\nusing this:\n  G2 \\<subseteq> {x \\<in> space M.\n                  upper_asymptotic_density\n                   {n. \\<exists>l\\<in>{k..n}.\n                          u n x - u (n - l) x \\<le> - d * real l}\n                  < d}\n\ngoal (1 subgoal):\n 1. emeasure M G2\n    \\<le> emeasure M\n           {x \\<in> space M.\n            upper_asymptotic_density\n             {n. \\<exists>l\\<in>{k..n}.\n                    u n x - u (n - l) x \\<le> - d * real l}\n            < d}", "by (rule emeasure_mono, auto)"], ["proof (state)\nthis:\n  emeasure M G2\n  \\<le> emeasure M\n         {x \\<in> space M.\n          upper_asymptotic_density\n           {n. \\<exists>l\\<in>{k..n}.\n                  u n x - u (n - l) x \\<le> - d * real l}\n          < d}\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  emeasure M G2\n  \\<le> emeasure M\n         {x \\<in> space M.\n          upper_asymptotic_density\n           {n. \\<exists>l\\<in>{k..n}.\n                  u n x - u (n - l) x \\<le> - d * real l}\n          < d}", "have \"emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - d * l} < d} > 1 -d\""], ["proof (prove)\nusing this:\n  emeasure M G2\n  \\<le> emeasure M\n         {x \\<in> space M.\n          upper_asymptotic_density\n           {n. \\<exists>l\\<in>{k..n}.\n                  u n x - u (n - l) x \\<le> - d * real l}\n          < d}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       {x \\<in> space M.\n        upper_asymptotic_density\n         {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n        < d}", "using \\<open>emeasure M G2 > 1 - d\\<close>"], ["proof (prove)\nusing this:\n  emeasure M G2\n  \\<le> emeasure M\n         {x \\<in> space M.\n          upper_asymptotic_density\n           {n. \\<exists>l\\<in>{k..n}.\n                  u n x - u (n - l) x \\<le> - d * real l}\n          < d}\n  ennreal (1 - d) < emeasure M G2\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       {x \\<in> space M.\n        upper_asymptotic_density\n         {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n        < d}", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n      < d}\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "then"], ["proof (chain)\npicking this:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n      < d}", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n      < d}\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - d * real l}\n           < d}", "by blast"], ["proof (state)\nthis:\n  \\<exists>k.\n     ennreal (1 - d)\n     < emeasure M\n        {x \\<in> space M.\n         upper_asymptotic_density\n          {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - d * real l}\n         < d}\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The two previous lemmas are put together in the following lemma,\ncorresponding to Lemma 2.3 in~\\cite{gouezel_karlsson}.\\<close>"], ["", "lemma upper_density_delta:\n  fixes d::real\n  assumes \"d > 0\" \"d \\<le> 1\"\n  shows \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n        emeasure M {x \\<in> space M. \\<forall>(N::nat). card {n \\<in>{..<N}. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - delta l * l} \\<le> d * N} > 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define d2 where \"d2 = d/2\""], ["proof (state)\nthis:\n  d2 = d / 2\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have [simp]: \"d2 > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < d2", "unfolding d2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < d / 2", "using assms"], ["proof (prove)\nusing this:\n  0 < d\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. 0 < d / 2", "by simp"], ["proof (state)\nthis:\n  0 < d2\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  0 < d2", "have \"\\<not> d2 < 0\""], ["proof (prove)\nusing this:\n  0 < d2\n\ngoal (1 subgoal):\n 1. \\<not> d2 < 0", "using not_less [of d2 0]"], ["proof (prove)\nusing this:\n  0 < d2\n  (\\<not> d2 < 0) = (0 \\<le> d2)\n\ngoal (1 subgoal):\n 1. \\<not> d2 < 0", "by (simp add: less_le)"], ["proof (state)\nthis:\n  \\<not> d2 < 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"d2/2 > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < d2 / 2", "by simp"], ["proof (state)\nthis:\n  0 < d2 / 2\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "obtain c0 where c0: \"c0> (0::real)\" \"emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - c0 * l} < d2/2} > 1 - (d2/2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c0.\n        \\<lbrakk>0 < c0;\n         ennreal (1 - d2 / 2)\n         < emeasure M\n            {x \\<in> space M.\n             upper_asymptotic_density\n              {n. \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - c0 * real l}\n             < d2 / 2}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using upper_density_all_times[OF \\<open>d2/2 > 0\\<close>]"], ["proof (prove)\nusing this:\n  \\<exists>c>0.\n     ennreal (1 - d2 / 2)\n     < emeasure M\n        {x \\<in> space M.\n         upper_asymptotic_density\n          {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c * real l}\n         < d2 / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>c0.\n        \\<lbrakk>0 < c0;\n         ennreal (1 - d2 / 2)\n         < emeasure M\n            {x \\<in> space M.\n             upper_asymptotic_density\n              {n. \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - c0 * real l}\n             < d2 / 2}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < c0\n  ennreal (1 - d2 / 2)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c0 * real l}\n      < d2 / 2}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"\\<exists>N. emeasure M {x \\<in> space M. \\<forall>n \\<ge> N. card ({n. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - c0 * l} \\<inter> {..<n}) < (d2/2) * n} > 1 - (d2/2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - d2 / 2)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>n\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{1..n}.\n                         u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n                  {..<n}))\n              < d2 / 2 * real n}", "apply (rule upper_density_eventually_measure)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       {x \\<in> space M.\n        \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c0 * real l}\n       \\<in> events\n 2. ennreal (1 - d2 / 2)\n    < emeasure M\n       {x \\<in> space M.\n        upper_asymptotic_density\n         {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c0 * real l}\n        < d2 / 2}", "using c0(2)"], ["proof (prove)\nusing this:\n  ennreal (1 - d2 / 2)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c0 * real l}\n      < d2 / 2}\n\ngoal (2 subgoals):\n 1. \\<And>n.\n       {x \\<in> space M.\n        \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c0 * real l}\n       \\<in> events\n 2. ennreal (1 - d2 / 2)\n    < emeasure M\n       {x \\<in> space M.\n        upper_asymptotic_density\n         {n. \\<exists>l\\<in>{1..n}. u n x - u (n - l) x \\<le> - c0 * real l}\n        < d2 / 2}", "by auto"], ["proof (state)\nthis:\n  \\<exists>N.\n     ennreal (1 - d2 / 2)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>n\\<ge>N.\n            real\n             (card\n               ({n. \\<exists>l\\<in>{1..n}.\n                       u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n                {..<n}))\n            < d2 / 2 * real n}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  \\<exists>N.\n     ennreal (1 - d2 / 2)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>n\\<ge>N.\n            real\n             (card\n               ({n. \\<exists>l\\<in>{1..n}.\n                       u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n                {..<n}))\n            < d2 / 2 * real n}", "obtain N1 where N1: \"emeasure M {x \\<in> space M. \\<forall>B \\<ge> N1. card ({n. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - c0 * l} \\<inter> {..<B}) < (d2/2) * B} > 1 - (d2/2)\""], ["proof (prove)\nusing this:\n  \\<exists>N.\n     ennreal (1 - d2 / 2)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>n\\<ge>N.\n            real\n             (card\n               ({n. \\<exists>l\\<in>{1..n}.\n                       u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n                {..<n}))\n            < d2 / 2 * real n}\n\ngoal (1 subgoal):\n 1. (\\<And>N1.\n        ennreal (1 - d2 / 2)\n        < emeasure M\n           {x \\<in> space M.\n            \\<forall>B\\<ge>N1.\n               real\n                (card\n                  ({n. \\<exists>l\\<in>{1..n}.\n                          u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n                   {..<B}))\n               < d2 / 2 * real B} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ennreal (1 - d2 / 2)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>N1.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{1..n}.\n                    u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n             {..<B}))\n         < d2 / 2 * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define O1 where \"O1 = {x \\<in> space M. \\<forall>B \\<ge> N1. card ({n. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - c0 * l} \\<inter> {..<B}) < (d2/2) * B}\""], ["proof (state)\nthis:\n  O1 =\n  {x \\<in> space M.\n   \\<forall>B\\<ge>N1.\n      real\n       (card\n         ({n. \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n          {..<B}))\n      < d2 / 2 * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have [measurable]: \"O1 \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. O1 \\<in> events", "unfolding O1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>B\\<ge>N1.\n        real\n         (card\n           ({n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n            {..<B}))\n        < d2 / 2 * real B}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  O1 \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"emeasure M O1 > 1 - (d2/2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d2 / 2) < emeasure M O1", "unfolding O1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d2 / 2)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B\\<ge>N1.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{1..n}.\n                      u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n               {..<B}))\n           < d2 / 2 * real B}", "using N1"], ["proof (prove)\nusing this:\n  ennreal (1 - d2 / 2)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>N1.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{1..n}.\n                    u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n             {..<B}))\n         < d2 / 2 * real B}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d2 / 2)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B\\<ge>N1.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{1..n}.\n                      u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n               {..<B}))\n           < d2 / 2 * real B}", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - d2 / 2) < emeasure M O1\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have *: \"\\<exists>N. emeasure M {x \\<in> space M. \\<forall>B \\<ge> N. card({n. \\<exists>l \\<in> {N..n}. u n x - u (n-l) x \\<le> - e * l} \\<inter> {..<B}) < e * B} > 1 - e\"\n    if \"e>0\" \"e \\<le> 1\" for e::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - e)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>B\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{N..n}.\n                         u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                  {..<B}))\n              < e * real B}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - e)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>B\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{N..n}.\n                         u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                  {..<B}))\n              < e * real B}", "obtain k where k: \"emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - e * l} < e} > 1 - e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>k.\n        ennreal (1 - e)\n        < emeasure M\n           {x \\<in> space M.\n            upper_asymptotic_density\n             {n. \\<exists>l\\<in>{k..n}.\n                    u n x - u (n - l) x \\<le> - e * real l}\n            < e} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using upper_density_large_k[OF \\<open>e>0\\<close> \\<open>e \\<le> 1\\<close>]"], ["proof (prove)\nusing this:\n  \\<exists>k.\n     ennreal (1 - e)\n     < emeasure M\n        {x \\<in> space M.\n         upper_asymptotic_density\n          {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - e * real l}\n         < e}\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        ennreal (1 - e)\n        < emeasure M\n           {x \\<in> space M.\n            upper_asymptotic_density\n             {n. \\<exists>l\\<in>{k..n}.\n                    u n x - u (n - l) x \\<le> - e * real l}\n            < e} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - e * real l}\n      < e}\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - e)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>B\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{N..n}.\n                         u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                  {..<B}))\n              < e * real B}", "then"], ["proof (chain)\npicking this:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - e * real l}\n      < e}", "obtain N0 where N0: \"emeasure M {x \\<in> space M. \\<forall>B \\<ge> N0. card({n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - e * l} \\<inter> {..<B}) < e * B} > 1 - e\""], ["proof (prove)\nusing this:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - e * real l}\n      < e}\n\ngoal (1 subgoal):\n 1. (\\<And>N0.\n        ennreal (1 - e)\n        < emeasure M\n           {x \\<in> space M.\n            \\<forall>B\\<ge>N0.\n               real\n                (card\n                  ({n. \\<exists>l\\<in>{k..n}.\n                          u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                   {..<B}))\n               < e * real B} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using upper_density_eventually_measure[OF _ k]"], ["proof (prove)\nusing this:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - e * real l}\n      < e}\n  (\\<And>n.\n      {x \\<in> space M.\n       \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - e * real l}\n      \\<in> events) \\<Longrightarrow>\n  \\<exists>N.\n     ennreal (1 - e)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>n\\<ge>N.\n            real\n             (card\n               ({n. \\<exists>l\\<in>{k..n}.\n                       u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                {..<n}))\n            < e * real n}\n\ngoal (1 subgoal):\n 1. (\\<And>N0.\n        ennreal (1 - e)\n        < emeasure M\n           {x \\<in> space M.\n            \\<forall>B\\<ge>N0.\n               real\n                (card\n                  ({n. \\<exists>l\\<in>{k..n}.\n                          u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                   {..<B}))\n               < e * real B} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>N0.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{k..n}.\n                    u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n             {..<B}))\n         < e * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - e)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>B\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{N..n}.\n                         u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                  {..<B}))\n              < e * real B}", "define N where \"N = max k N0\""], ["proof (state)\nthis:\n  N = max k N0\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - e)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>B\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{N..n}.\n                         u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                  {..<B}))\n              < e * real B}", "have \"emeasure M {x \\<in> space M. \\<forall>B \\<ge> N0. card({n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> - e * l} \\<inter> {..<B}) < e * B}\n            \\<le> emeasure M {x \\<in> space M. \\<forall>B \\<ge> N. card({n. \\<exists>l \\<in> {N..n}. u n x - u (n-l) x \\<le> - e * l} \\<inter> {..<B}) < e * B}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>N0.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{k..n}.\n                    u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n             {..<B}))\n         < e * real B}\n    \\<le> emeasure M\n           {x \\<in> space M.\n            \\<forall>B\\<ge>N.\n               real\n                (card\n                  ({n. \\<exists>l\\<in>{N..n}.\n                          u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                   {..<B}))\n               < e * real B}", "proof (rule emeasure_mono, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>N0.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{k..n}.\n                      u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n               {..<B}))\n           < e * real B;\n        N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (e * real l)} \\<inter>\n                             {..<B}))\n                         < e * real B", "fix x B"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>N0.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{k..n}.\n                      u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n               {..<B}))\n           < e * real B;\n        N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (e * real l)} \\<inter>\n                             {..<B}))\n                         < e * real B", "assume H: \"x \\<in> space M\" \"\\<forall>B\\<ge>N0. card ({n. \\<exists>l\\<in>{k..n}. u n x - u (n - l) x \\<le> - (e * real l)} \\<inter> {..<B}) < e * B\" \"N \\<le> B\""], ["proof (state)\nthis:\n  x \\<in> space M\n  \\<forall>B\\<ge>N0.\n     real\n      (card\n        ({n. \\<exists>l\\<in>{k..n}.\n                u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n         {..<B}))\n     < e * real B\n  N \\<le> B\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>N0.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{k..n}.\n                      u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n               {..<B}))\n           < e * real B;\n        N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (e * real l)} \\<inter>\n                             {..<B}))\n                         < e * real B", "have \"card({n. \\<exists>l \\<in> {N..n}. u n x - u (n-l) x \\<le> - (e * real l)} \\<inter> {..<B}) \\<le> card({n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> -(e * real l)} \\<inter> {..<B})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     ({n. \\<exists>l\\<in>{N..n}.\n             u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n      {..<B})\n    \\<le> card\n           ({n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n            {..<B})", "unfolding N_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     ({n. \\<exists>l\\<in>{max k N0..n}.\n             u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n      {..<B})\n    \\<le> card\n           ({n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n            {..<B})", "by (rule card_mono, auto)"], ["proof (state)\nthis:\n  card\n   ({n. \\<exists>l\\<in>{N..n}.\n           u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n    {..<B})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{k..n}.\n                 u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n          {..<B})\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>N0.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{k..n}.\n                      u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n               {..<B}))\n           < e * real B;\n        N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (e * real l)} \\<inter>\n                             {..<B}))\n                         < e * real B", "then"], ["proof (chain)\npicking this:\n  card\n   ({n. \\<exists>l\\<in>{N..n}.\n           u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n    {..<B})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{k..n}.\n                 u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n          {..<B})", "have \"real(card({n. \\<exists>l \\<in> {N..n}. u n x - u (n-l) x \\<le> - (e * real l)} \\<inter> {..<B})) \\<le> card({n. \\<exists>l \\<in> {k..n}. u n x - u (n-l) x \\<le> -(e * real l)} \\<inter> {..<B})\""], ["proof (prove)\nusing this:\n  card\n   ({n. \\<exists>l\\<in>{N..n}.\n           u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n    {..<B})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{k..n}.\n                 u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n          {..<B})\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{N..n}.\n               u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n        {..<B}))\n    \\<le> real\n           (card\n             ({n. \\<exists>l\\<in>{k..n}.\n                     u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n              {..<B}))", "by simp"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{N..n}.\n             u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n      {..<B}))\n  \\<le> real\n         (card\n           ({n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n            {..<B}))\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>N0.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{k..n}.\n                      u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n               {..<B}))\n           < e * real B;\n        N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (e * real l)} \\<inter>\n                             {..<B}))\n                         < e * real B", "also"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{N..n}.\n             u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n      {..<B}))\n  \\<le> real\n         (card\n           ({n. \\<exists>l\\<in>{k..n}.\n                   u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n            {..<B}))\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>N0.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{k..n}.\n                      u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n               {..<B}))\n           < e * real B;\n        N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (e * real l)} \\<inter>\n                             {..<B}))\n                         < e * real B", "have \"... < e * B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{k..n}.\n               u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n        {..<B}))\n    < e * real B", "using H(2) \\<open>B\\<ge>N\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>B\\<ge>N0.\n     real\n      (card\n        ({n. \\<exists>l\\<in>{k..n}.\n                u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n         {..<B}))\n     < e * real B\n  N \\<le> B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{k..n}.\n               u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n        {..<B}))\n    < e * real B", "unfolding N_def"], ["proof (prove)\nusing this:\n  \\<forall>B\\<ge>N0.\n     real\n      (card\n        ({n. \\<exists>l\\<in>{k..n}.\n                u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n         {..<B}))\n     < e * real B\n  max k N0 \\<le> B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{k..n}.\n               u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n        {..<B}))\n    < e * real B", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{k..n}.\n             u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n      {..<B}))\n  < e * real B\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>N0.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{k..n}.\n                      u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n               {..<B}))\n           < e * real B;\n        N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (e * real l)} \\<inter>\n                             {..<B}))\n                         < e * real B", "finally"], ["proof (chain)\npicking this:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{N..n}.\n             u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n      {..<B}))\n  < e * real B", "show \"card ({n. \\<exists>l\\<in>{N..n}. u n x - u (n - l) x \\<le> - (e * real l)} \\<inter> {..<B}) < e * B\""], ["proof (prove)\nusing this:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{N..n}.\n             u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n      {..<B}))\n  < e * real B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{N..n}.\n               u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n        {..<B}))\n    < e * real B", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{N..n}.\n             u n x - u (n - l) x \\<le> - (e * real l)} \\<inter>\n      {..<B}))\n  < e * real B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>B\\<ge>N0.\n       real\n        (card\n          ({n. \\<exists>l\\<in>{k..n}.\n                  u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n           {..<B}))\n       < e * real B}\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B\\<ge>N.\n             real\n              (card\n                ({n. \\<exists>l\\<in>{N..n}.\n                        u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                 {..<B}))\n             < e * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - e)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>B\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{N..n}.\n                         u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                  {..<B}))\n              < e * real B}", "then"], ["proof (chain)\npicking this:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>B\\<ge>N0.\n       real\n        (card\n          ({n. \\<exists>l\\<in>{k..n}.\n                  u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n           {..<B}))\n       < e * real B}\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B\\<ge>N.\n             real\n              (card\n                ({n. \\<exists>l\\<in>{N..n}.\n                        u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                 {..<B}))\n             < e * real B}", "have \"emeasure M {x \\<in> space M. \\<forall>B \\<ge> N. card({n. \\<exists>l \\<in> {N..n}. u n x - u (n-l) x \\<le> - e * l} \\<inter> {..<B}) < e * B} > 1 - e\""], ["proof (prove)\nusing this:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>B\\<ge>N0.\n       real\n        (card\n          ({n. \\<exists>l\\<in>{k..n}.\n                  u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n           {..<B}))\n       < e * real B}\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B\\<ge>N.\n             real\n              (card\n                ({n. \\<exists>l\\<in>{N..n}.\n                        u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                 {..<B}))\n             < e * real B}\n\ngoal (1 subgoal):\n 1. ennreal (1 - e)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B\\<ge>N.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{N..n}.\n                      u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n               {..<B}))\n           < e * real B}", "using N0"], ["proof (prove)\nusing this:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>B\\<ge>N0.\n       real\n        (card\n          ({n. \\<exists>l\\<in>{k..n}.\n                  u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n           {..<B}))\n       < e * real B}\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B\\<ge>N.\n             real\n              (card\n                ({n. \\<exists>l\\<in>{N..n}.\n                        u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                 {..<B}))\n             < e * real B}\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>N0.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{k..n}.\n                    u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n             {..<B}))\n         < e * real B}\n\ngoal (1 subgoal):\n 1. ennreal (1 - e)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B\\<ge>N.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{N..n}.\n                      u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n               {..<B}))\n           < e * real B}", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>N.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{N..n}.\n                    u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n             {..<B}))\n         < e * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - e)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>B\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{N..n}.\n                         u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                  {..<B}))\n              < e * real B}", "then"], ["proof (chain)\npicking this:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>N.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{N..n}.\n                    u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n             {..<B}))\n         < e * real B}", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>N.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{N..n}.\n                    u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n             {..<B}))\n         < e * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       ennreal (1 - e)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>B\\<ge>N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{N..n}.\n                         u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                  {..<B}))\n              < e * real B}", "by auto"], ["proof (state)\nthis:\n  \\<exists>N.\n     ennreal (1 - e)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>B\\<ge>N.\n            real\n             (card\n               ({n. \\<exists>l\\<in>{N..n}.\n                       u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                {..<B}))\n            < e * real B}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?e12; ?e12 \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> \\<exists>N.\n                       ennreal (1 - ?e12)\n                       < emeasure M\n                          {x \\<in> space M.\n                           \\<forall>B\\<ge>N.\n                              real\n                               (card\n                                 ({n. \\<exists>l\\<in>{N..n}.\n   u n x - u (n - l) x \\<le> - ?e12 * real l} \\<inter>\n                                  {..<B}))\n                              < ?e12 * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define Ne where \"Ne = (\\<lambda>(e::real). SOME N. emeasure M {x \\<in> space M. \\<forall>B \\<ge> N. card({n. \\<exists>l \\<in> {N..n}. u n x - u (n-l) x \\<le> - e * l} \\<inter> {..<B}) < e * B} > 1 - e)\""], ["proof (state)\nthis:\n  Ne =\n  (\\<lambda>e.\n      SOME N.\n         ennreal (1 - e)\n         < emeasure M\n            {x \\<in> space M.\n             \\<forall>B\\<ge>N.\n                real\n                 (card\n                   ({n. \\<exists>l\\<in>{N..n}.\n                           u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                    {..<B}))\n                < e * real B})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have Ne: \"emeasure M {x \\<in> space M. \\<forall>B \\<ge> Ne e. card({n. \\<exists>l \\<in> {Ne e..n}. u n x - u (n-l) x \\<le> - e * l} \\<inter> {..<B}) < e * B} > 1 - e\"\n    if \"e>0\" \"e \\<le> 1\" for e::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - e)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B\\<ge>Ne e.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne e..n}.\n                      u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n               {..<B}))\n           < e * real B}", "unfolding Ne_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - e)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B\\<ge>SOME N.\n                          ennreal (1 - e)\n                          < emeasure M\n                             {x \\<in> space M.\n                              \\<forall>B\\<ge>N.\n                                 real\n                                  (card\n                                    ({n.\n\\<exists>l\\<in>{N..n}. u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n                                     {..<B}))\n                                 < e * real B}.\n           real\n            (card\n              ({n. \\<exists>l\\<in>{SOME N.\nennreal (1 - e)\n< emeasure M\n   {x \\<in> space M.\n    \\<forall>B\\<ge>N.\n       real\n        (card\n          ({n. \\<exists>l\\<in>{N..n}.\n                  u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n           {..<B}))\n       < e * real B}..n}.\n                      u n x - u (n - l) x \\<le> - e * real l} \\<inter>\n               {..<B}))\n           < e * real B}", "by (rule someI_ex[OF *[OF that]])"], ["proof (state)\nthis:\n  \\<lbrakk>0 < ?e12; ?e12 \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> ennreal (1 - ?e12)\n                    < emeasure M\n                       {x \\<in> space M.\n                        \\<forall>B\\<ge>Ne ?e12.\n                           real\n                            (card\n                              ({n. \\<exists>l\\<in>{Ne ?e12..n}.\nu n x - u (n - l) x \\<le> - ?e12 * real l} \\<inter>\n                               {..<B}))\n                           < ?e12 * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define eps where \"eps = (\\<lambda>(n::nat). d2 * (1/2)^n)\""], ["proof (state)\nthis:\n  eps = (\\<lambda>n. d2 * (1 / 2) ^ n)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have [simp]: \"eps n > 0\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < eps n", "unfolding eps_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < d2 * (1 / 2) ^ n", "by auto"], ["proof (state)\nthis:\n  0 < eps ?n12\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  0 < eps ?n12", "have [simp]: \"eps n \\<ge> 0\" for n"], ["proof (prove)\nusing this:\n  0 < eps ?n12\n\ngoal (1 subgoal):\n 1. 0 \\<le> eps n", "by (rule less_imp_le)"], ["proof (state)\nthis:\n  0 \\<le> eps ?n12\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"eps n \\<le> (1 / 2) * 1\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. eps n \\<le> 1 / 2 * 1", "unfolding eps_def d2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. d / 2 * (1 / 2) ^ n \\<le> 1 / 2 * 1", "using \\<open>d \\<le> 1\\<close>"], ["proof (prove)\nusing this:\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. d / 2 * (1 / 2) ^ n \\<le> 1 / 2 * 1", "by (intro mult_mono power_le_one) auto"], ["proof (state)\nthis:\n  eps ?n12 \\<le> 1 / 2 * 1\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "also"], ["proof (state)\nthis:\n  eps ?n12 \\<le> 1 / 2 * 1\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"\\<dots> < 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / 2 * 1 < 1", "by auto"], ["proof (state)\nthis:\n  1 / 2 * 1 < 1\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "finally"], ["proof (chain)\npicking this:\n  eps ?n13 < 1", "have [simp]: \"eps n < 1\" for n"], ["proof (prove)\nusing this:\n  eps ?n13 < 1\n\ngoal (1 subgoal):\n 1. eps n < 1", "by simp"], ["proof (state)\nthis:\n  eps ?n12 < 1\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  eps ?n12 < 1", "have [simp]: \"eps n \\<le> 1\" for n"], ["proof (prove)\nusing this:\n  eps ?n12 < 1\n\ngoal (1 subgoal):\n 1. eps n \\<le> 1", "by (rule less_imp_le)"], ["proof (state)\nthis:\n  eps ?n12 \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"(\\<lambda>n. d2 * (1/2)^n) \\<longlonglongrightarrow> d2 * 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. d2 * (1 / 2) ^ n) \\<longlonglongrightarrow> d2 * 0", "by (rule tendsto_mult, auto simp add: LIMSEQ_realpow_zero)"], ["proof (state)\nthis:\n  (\\<lambda>n. d2 * (1 / 2) ^ n) \\<longlonglongrightarrow> d2 * 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. d2 * (1 / 2) ^ n) \\<longlonglongrightarrow> d2 * 0", "have \"eps \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. d2 * (1 / 2) ^ n) \\<longlonglongrightarrow> d2 * 0\n\ngoal (1 subgoal):\n 1. eps \\<longlonglongrightarrow> 0", "unfolding eps_def"], ["proof (prove)\nusing this:\n  (\\<lambda>n. d2 * (1 / 2) ^ n) \\<longlonglongrightarrow> d2 * 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. d2 * (1 / 2) ^ n) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  eps \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define Nf where \"Nf = (\\<lambda>N. (if (N = 0) then 0\n                else if (N = 1) then N1 + 1\n                else max (N1+1) (Max {Ne(eps n)|n. n \\<le> N}) + N))\""], ["proof (state)\nthis:\n  Nf =\n  (\\<lambda>N.\n      if N = 0 then 0\n      else if N = 1 then N1 + 1\n           else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> N}) + N)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"Nf N < Nf (N+1)\" for N"], ["proof (prove)\ngoal (1 subgoal):\n 1. Nf N < Nf (N + 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. Nf N < Nf (N + 1)", "consider \"N = 0\" | \"N = 1\" | \"N>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>N = 0 \\<Longrightarrow> thesis; N = 1 \\<Longrightarrow> thesis;\n     1 < N \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by fastforce"], ["proof (state)\nthis:\n  \\<lbrakk>N = 0 \\<Longrightarrow> ?thesis12;\n   N = 1 \\<Longrightarrow> ?thesis12;\n   1 < N \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. Nf N < Nf (N + 1)", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>N = 0 \\<Longrightarrow> ?thesis12;\n   N = 1 \\<Longrightarrow> ?thesis12;\n   1 < N \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>N = 0 \\<Longrightarrow> ?thesis12;\n   N = 1 \\<Longrightarrow> ?thesis12;\n   1 < N \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. Nf N < Nf (N + 1)", "proof (cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. N = 0 \\<Longrightarrow> Nf N < Nf (N + 1)\n 2. N = 1 \\<Longrightarrow> Nf N < Nf (N + 1)\n 3. 1 < N \\<Longrightarrow> Nf N < Nf (N + 1)", "assume \"N>1\""], ["proof (state)\nthis:\n  1 < N\n\ngoal (3 subgoals):\n 1. N = 0 \\<Longrightarrow> Nf N < Nf (N + 1)\n 2. N = 1 \\<Longrightarrow> Nf N < Nf (N + 1)\n 3. 1 < N \\<Longrightarrow> Nf N < Nf (N + 1)", "have \"Max {Ne (eps n) |n. n \\<le> N} \\<le> Max {Ne (eps n) |n. n \\<le> Suc N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {Ne (eps n) |n. n \\<le> N} \\<le> Max {Ne (eps n) |n. n \\<le> Suc N}", "by (rule Max_mono, auto)"], ["proof (state)\nthis:\n  Max {Ne (eps n) |n. n \\<le> N} \\<le> Max {Ne (eps n) |n. n \\<le> Suc N}\n\ngoal (3 subgoals):\n 1. N = 0 \\<Longrightarrow> Nf N < Nf (N + 1)\n 2. N = 1 \\<Longrightarrow> Nf N < Nf (N + 1)\n 3. 1 < N \\<Longrightarrow> Nf N < Nf (N + 1)", "then"], ["proof (chain)\npicking this:\n  Max {Ne (eps n) |n. n \\<le> N} \\<le> Max {Ne (eps n) |n. n \\<le> Suc N}", "show ?thesis"], ["proof (prove)\nusing this:\n  Max {Ne (eps n) |n. n \\<le> N} \\<le> Max {Ne (eps n) |n. n \\<le> Suc N}\n\ngoal (1 subgoal):\n 1. Nf N < Nf (N + 1)", "unfolding Nf_def"], ["proof (prove)\nusing this:\n  Max {Ne (eps n) |n. n \\<le> N} \\<le> Max {Ne (eps n) |n. n \\<le> Suc N}\n\ngoal (1 subgoal):\n 1. (if N = 0 then 0\n     else if N = 1 then N1 + 1\n          else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> N}) + N)\n    < (if N + 1 = 0 then 0\n       else if N + 1 = 1 then N1 + 1\n            else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> N + 1}) +\n                 (N + 1))", "by auto"], ["proof (state)\nthis:\n  Nf N < Nf (N + 1)\n\ngoal (2 subgoals):\n 1. N = 0 \\<Longrightarrow> Nf N < Nf (N + 1)\n 2. N = 1 \\<Longrightarrow> Nf N < Nf (N + 1)", "qed (auto simp add: Nf_def)"], ["proof (state)\nthis:\n  Nf N < Nf (N + 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Nf ?N12 < Nf (?N12 + 1)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  Nf ?N12 < Nf (?N12 + 1)", "have \"strict_mono Nf\""], ["proof (prove)\nusing this:\n  Nf ?N12 < Nf (?N12 + 1)\n\ngoal (1 subgoal):\n 1. strict_mono Nf", "using strict_mono_Suc_iff"], ["proof (prove)\nusing this:\n  Nf ?N12 < Nf (?N12 + 1)\n  strict_mono ?f = (\\<forall>n. ?f n < ?f (Suc n))\n\ngoal (1 subgoal):\n 1. strict_mono Nf", "by auto"], ["proof (state)\nthis:\n  strict_mono Nf\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define On where \"On = (\\<lambda>(N::nat).\n    (if (N = 1) then O1\n    else {x \\<in> space M. \\<forall>B \\<ge> Nf N. card({n. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N) * l} \\<inter> {..<B}) < (eps N) * B}))\""], ["proof (state)\nthis:\n  On =\n  (\\<lambda>N.\n      if N = 1 then O1\n      else {x \\<in> space M.\n            \\<forall>B\\<ge>Nf N.\n               real\n                (card\n                  ({n. \\<exists>l\\<in>{Nf N..n}.\n                          u n x - u (n - l) x\n                          \\<le> - eps N * real l} \\<inter>\n                   {..<B}))\n               < eps N * real B})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have [measurable]: \"On N \\<in> sets M\" for N"], ["proof (prove)\ngoal (1 subgoal):\n 1. On N \\<in> events", "unfolding On_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if N = 1 then O1\n     else {x \\<in> space M.\n           \\<forall>B\\<ge>Nf N.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{Nf N..n}.\n                         u n x - u (n - l) x\n                         \\<le> - eps N * real l} \\<inter>\n                  {..<B}))\n              < eps N * real B})\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  On ?N12 \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"emeasure M (On N) > 1 - eps N\" if \"N>0\" for N"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - eps N) < emeasure M (On N)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ennreal (1 - eps N) < emeasure M (On N)", "consider \"N = 1\" | \"N>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>N = 1 \\<Longrightarrow> thesis;\n     1 < N \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "using \\<open>N>0\\<close>"], ["proof (prove)\nusing this:\n  0 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>N = 1 \\<Longrightarrow> thesis;\n     1 < N \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by linarith"], ["proof (state)\nthis:\n  \\<lbrakk>N = 1 \\<Longrightarrow> ?thesis12;\n   1 < N \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. ennreal (1 - eps N) < emeasure M (On N)", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>N = 1 \\<Longrightarrow> ?thesis12;\n   1 < N \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>N = 1 \\<Longrightarrow> ?thesis12;\n   1 < N \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. ennreal (1 - eps N) < emeasure M (On N)", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. N = 1 \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)\n 2. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "case 1"], ["proof (state)\nthis:\n  N = 1\n\ngoal (2 subgoals):\n 1. N = 1 \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)\n 2. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "then"], ["proof (chain)\npicking this:\n  N = 1", "show ?thesis"], ["proof (prove)\nusing this:\n  N = 1\n\ngoal (1 subgoal):\n 1. ennreal (1 - eps N) < emeasure M (On N)", "unfolding On_def eps_def"], ["proof (prove)\nusing this:\n  N = 1\n\ngoal (1 subgoal):\n 1. ennreal (1 - d2 * (1 / 2) ^ N)\n    < emeasure M\n       (if N = 1 then O1\n        else {x \\<in> space M.\n              \\<forall>B\\<ge>Nf N.\n                 real\n                  (card\n                    ({n. \\<exists>l\\<in>{Nf N..n}.\n                            u n x - u (n - l) x\n                            \\<le> - (d2 * (1 / 2) ^ N) * real l} \\<inter>\n                     {..<B}))\n                 < d2 * (1 / 2) ^ N * real B})", "using \\<open>emeasure M O1 > 1 - (d2/2)\\<close>"], ["proof (prove)\nusing this:\n  N = 1\n  ennreal (1 - d2 / 2) < emeasure M O1\n\ngoal (1 subgoal):\n 1. ennreal (1 - d2 * (1 / 2) ^ N)\n    < emeasure M\n       (if N = 1 then O1\n        else {x \\<in> space M.\n              \\<forall>B\\<ge>Nf N.\n                 real\n                  (card\n                    ({n. \\<exists>l\\<in>{Nf N..n}.\n                            u n x - u (n - l) x\n                            \\<le> - (d2 * (1 / 2) ^ N) * real l} \\<inter>\n                     {..<B}))\n                 < d2 * (1 / 2) ^ N * real B})", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - eps N) < emeasure M (On N)\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "case 2"], ["proof (state)\nthis:\n  1 < N\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "have \"Ne (eps N) \\<le> Max {Ne(eps n)|n. n \\<le> N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ne (eps N) \\<le> Max {Ne (eps n) |n. n \\<le> N}", "by (rule Max.coboundedI, auto)"], ["proof (state)\nthis:\n  Ne (eps N) \\<le> Max {Ne (eps n) |n. n \\<le> N}\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "also"], ["proof (state)\nthis:\n  Ne (eps N) \\<le> Max {Ne (eps n) |n. n \\<le> N}\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "have \"... \\<le> Nf N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {Ne (eps n) |n. n \\<le> N} \\<le> Nf N", "unfolding Nf_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {Ne (eps n) |n. n \\<le> N}\n    \\<le> (if N = 0 then 0\n           else if N = 1 then N1 + 1\n                else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> N}) + N)", "using \\<open>N>1\\<close>"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. Max {Ne (eps n) |n. n \\<le> N}\n    \\<le> (if N = 0 then 0\n           else if N = 1 then N1 + 1\n                else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> N}) + N)", "by auto"], ["proof (state)\nthis:\n  Max {Ne (eps n) |n. n \\<le> N} \\<le> Nf N\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "finally"], ["proof (chain)\npicking this:\n  Ne (eps N) \\<le> Nf N", "have \"Ne (eps N) \\<le> Nf N\""], ["proof (prove)\nusing this:\n  Ne (eps N) \\<le> Nf N\n\ngoal (1 subgoal):\n 1. Ne (eps N) \\<le> Nf N", "by simp"], ["proof (state)\nthis:\n  Ne (eps N) \\<le> Nf N\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "have \"1 - eps N < emeasure M {x \\<in> space M. \\<forall>B \\<ge> Ne(eps N). card({n. \\<exists>l \\<in> {Ne(eps N)..n}. u n x - u (n-l) x \\<le> - (eps N) * l} \\<inter> {..<B}) < (eps N) * B}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - eps N)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B\\<ge>Ne (eps N).\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                      u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n               {..<B}))\n           < eps N * real B}", "by (rule Ne) simp_all"], ["proof (state)\nthis:\n  ennreal (1 - eps N)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>Ne (eps N).\n         real\n          (card\n            ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                    u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n             {..<B}))\n         < eps N * real B}\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "also"], ["proof (state)\nthis:\n  ennreal (1 - eps N)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>Ne (eps N).\n         real\n          (card\n            ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                    u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n             {..<B}))\n         < eps N * real B}\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "have \"... \\<le> emeasure M {x \\<in> space M. \\<forall>B \\<ge> Nf N. card({n. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N) * l} \\<inter> {..<B}) < (eps N) * B}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>Ne (eps N).\n         real\n          (card\n            ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                    u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n             {..<B}))\n         < eps N * real B}\n    \\<le> emeasure M\n           {x \\<in> space M.\n            \\<forall>B\\<ge>Nf N.\n               real\n                (card\n                  ({n. \\<exists>l\\<in>{Nf N..n}.\n                          u n x - u (n - l) x\n                          \\<le> - eps N * real l} \\<inter>\n                   {..<B}))\n               < eps N * real B}", "proof (rule emeasure_mono, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>Ne (eps N).\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n               {..<B}))\n           < eps N * real B;\n        Nf N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{Nf N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (eps N * real l)} \\<inter>\n                             {..<B}))\n                         < eps N * real B", "fix x n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>Ne (eps N).\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n               {..<B}))\n           < eps N * real B;\n        Nf N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{Nf N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (eps N * real l)} \\<inter>\n                             {..<B}))\n                         < eps N * real B", "assume H: \"x \\<in> space M\"\n                          \"\\<forall>n\\<ge>Ne (eps N). card ({n. \\<exists>l\\<in>{Ne (eps N)..n}. u n x - u (n - l) x \\<le> - (eps N * l)} \\<inter> {..<n}) < eps N * n\"\n                          \"Nf N \\<le> n\""], ["proof (state)\nthis:\n  x \\<in> space M\n  \\<forall>n\\<ge>Ne (eps N).\n     real\n      (card\n        ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n         {..<n}))\n     < eps N * real n\n  Nf N \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>Ne (eps N).\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n               {..<B}))\n           < eps N * real B;\n        Nf N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{Nf N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (eps N * real l)} \\<inter>\n                             {..<B}))\n                         < eps N * real B", "have \"card({n. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<n}) \\<le> card({n. \\<exists>l \\<in> {Ne(eps N)..n}. u n x - u (n-l) x \\<le> -(eps N) * l} \\<inter> {..<n})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     ({n. \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<n})\n    \\<le> card\n           ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                   u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n            {..<n})", "apply (rule card_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite\n     ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n             u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n      {..<n})\n 2. {n. \\<exists>l\\<in>{Nf N..n}.\n           u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<n}\n    \\<subseteq> {n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                       u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n                {..<n}", "using \\<open>Ne (eps N) \\<le> Nf N\\<close>"], ["proof (prove)\nusing this:\n  Ne (eps N) \\<le> Nf N\n\ngoal (2 subgoals):\n 1. finite\n     ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n             u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n      {..<n})\n 2. {n. \\<exists>l\\<in>{Nf N..n}.\n           u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<n}\n    \\<subseteq> {n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                       u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n                {..<n}", "by auto"], ["proof (state)\nthis:\n  card\n   ({n. \\<exists>l\\<in>{Nf N..n}.\n           u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<n})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                 u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n          {..<n})\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>Ne (eps N).\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n               {..<B}))\n           < eps N * real B;\n        Nf N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{Nf N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (eps N * real l)} \\<inter>\n                             {..<B}))\n                         < eps N * real B", "then"], ["proof (chain)\npicking this:\n  card\n   ({n. \\<exists>l\\<in>{Nf N..n}.\n           u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<n})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                 u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n          {..<n})", "have \"real(card({n. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<n})) \\<le> card({n. \\<exists>l \\<in> {Ne(eps N)..n}. u n x - u (n-l) x \\<le> -(eps N) * l} \\<inter> {..<n})\""], ["proof (prove)\nusing this:\n  card\n   ({n. \\<exists>l\\<in>{Nf N..n}.\n           u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<n})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                 u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n          {..<n})\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{Nf N..n}.\n               u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<n}))\n    \\<le> real\n           (card\n             ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                     u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n              {..<n}))", "by simp"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<n}))\n  \\<le> real\n         (card\n           ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                   u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n            {..<n}))\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>Ne (eps N).\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n               {..<B}))\n           < eps N * real B;\n        Nf N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{Nf N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (eps N * real l)} \\<inter>\n                             {..<B}))\n                         < eps N * real B", "also"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<n}))\n  \\<le> real\n         (card\n           ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                   u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n            {..<n}))\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>Ne (eps N).\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n               {..<B}))\n           < eps N * real B;\n        Nf N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{Nf N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (eps N * real l)} \\<inter>\n                             {..<B}))\n                         < eps N * real B", "have \"... < (eps N) * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n               u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n        {..<n}))\n    < eps N * real n", "using H(2) \\<open>n \\<ge> Nf N\\<close> \\<open>Ne (eps N) \\<le> Nf N\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>n\\<ge>Ne (eps N).\n     real\n      (card\n        ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n         {..<n}))\n     < eps N * real n\n  Nf N \\<le> n\n  Ne (eps N) \\<le> Nf N\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n               u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n        {..<n}))\n    < eps N * real n", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n             u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n      {..<n}))\n  < eps N * real n\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       \\<lbrakk>x \\<in> space M;\n        \\<forall>B\\<ge>Ne (eps N).\n           real\n            (card\n              ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n               {..<B}))\n           < eps N * real B;\n        Nf N \\<le> B\\<rbrakk>\n       \\<Longrightarrow> real\n                          (card\n                            ({n. \\<exists>l\\<in>{Nf N..n}.\n                                    u n x - u (n - l) x\n                                    \\<le> - (eps N * real l)} \\<inter>\n                             {..<B}))\n                         < eps N * real B", "finally"], ["proof (chain)\npicking this:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<n}))\n  < eps N * real n", "show \"real (card ({n. \\<exists>l\\<in>{Nf N..n}. u n x - u (n - l) x \\<le> - (eps N * l)} \\<inter> {..<n})) < eps N * real n\""], ["proof (prove)\nusing this:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<n}))\n  < eps N * real n\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{Nf N..n}.\n               u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<n}))\n    < eps N * real n", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<n}))\n  < eps N * real n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>B\\<ge>Ne (eps N).\n       real\n        (card\n          ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                  u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n           {..<B}))\n       < eps N * real B}\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B\\<ge>Nf N.\n             real\n              (card\n                ({n. \\<exists>l\\<in>{Nf N..n}.\n                        u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n                 {..<B}))\n             < eps N * real B}\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "also"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>B\\<ge>Ne (eps N).\n       real\n        (card\n          ({n. \\<exists>l\\<in>{Ne (eps N)..n}.\n                  u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n           {..<B}))\n       < eps N * real B}\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B\\<ge>Nf N.\n             real\n              (card\n                ({n. \\<exists>l\\<in>{Nf N..n}.\n                        u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n                 {..<B}))\n             < eps N * real B}\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "have \"... = emeasure M (On N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>Nf N.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n             {..<B}))\n         < eps N * real B} =\n    emeasure M (On N)", "unfolding On_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>Nf N.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n             {..<B}))\n         < eps N * real B} =\n    emeasure M\n     (if N = 1 then O1\n      else {x \\<in> space M.\n            \\<forall>B\\<ge>Nf N.\n               real\n                (card\n                  ({n. \\<exists>l\\<in>{Nf N..n}.\n                          u n x - u (n - l) x\n                          \\<le> - eps N * real l} \\<inter>\n                   {..<B}))\n               < eps N * real B})", "using \\<open>N>1\\<close>"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      \\<forall>B\\<ge>Nf N.\n         real\n          (card\n            ({n. \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n             {..<B}))\n         < eps N * real B} =\n    emeasure M\n     (if N = 1 then O1\n      else {x \\<in> space M.\n            \\<forall>B\\<ge>Nf N.\n               real\n                (card\n                  ({n. \\<exists>l\\<in>{Nf N..n}.\n                          u n x - u (n - l) x\n                          \\<le> - eps N * real l} \\<inter>\n                   {..<B}))\n               < eps N * real B})", "by auto"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M.\n    \\<forall>B\\<ge>Nf N.\n       real\n        (card\n          ({n. \\<exists>l\\<in>{Nf N..n}.\n                  u n x - u (n - l) x \\<le> - eps N * real l} \\<inter>\n           {..<B}))\n       < eps N * real B} =\n  emeasure M (On N)\n\ngoal (1 subgoal):\n 1. 1 < N \\<Longrightarrow> ennreal (1 - eps N) < emeasure M (On N)", "finally"], ["proof (chain)\npicking this:\n  ennreal (1 - eps N) < emeasure M (On N)", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - eps N) < emeasure M (On N)\n\ngoal (1 subgoal):\n 1. ennreal (1 - eps N) < emeasure M (On N)", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - eps N) < emeasure M (On N)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ennreal (1 - eps N) < emeasure M (On N)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  0 < ?N12 \\<Longrightarrow> ennreal (1 - eps ?N12) < emeasure M (On ?N12)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  0 < ?N12 \\<Longrightarrow> ennreal (1 - eps ?N12) < emeasure M (On ?N12)", "have *: \"emeasure M (On (N+1)) > 1 - eps (N+1)\" for N"], ["proof (prove)\nusing this:\n  0 < ?N12 \\<Longrightarrow> ennreal (1 - eps ?N12) < emeasure M (On ?N12)\n\ngoal (1 subgoal):\n 1. ennreal (1 - eps (N + 1)) < emeasure M (On (N + 1))", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - eps (?N12 + 1)) < emeasure M (On (?N12 + 1))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define Ogood where \"Ogood = (\\<Inter>N. On (N+1))\""], ["proof (state)\nthis:\n  Ogood = (\\<Inter>N. On (N + 1))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have [measurable]: \"Ogood \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ogood \\<in> events", "unfolding Ogood_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Inter>N. On (N + 1)) \\<in> events", "by auto"], ["proof (state)\nthis:\n  Ogood \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"emeasure M Ogood \\<ge> 1 - (\\<Sum>N. eps(N+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - (\\<Sum>N. eps (N + 1))) \\<le> emeasure M Ogood", "unfolding Ogood_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - (\\<Sum>N. eps (N + 1)))\n    \\<le> emeasure M (\\<Inter>N. On (N + 1))", "apply (intro emeasure_intersection, auto)"], ["proof (prove)\ngoal (2 subgoals):\n 1. summable (\\<lambda>n. eps (Suc n))\n 2. \\<And>N. ennreal (1 - eps (Suc N)) \\<le> emeasure M (On (Suc N))", "using *"], ["proof (prove)\nusing this:\n  ennreal (1 - eps (?N12 + 1)) < emeasure M (On (?N12 + 1))\n\ngoal (2 subgoals):\n 1. summable (\\<lambda>n. eps (Suc n))\n 2. \\<And>N. ennreal (1 - eps (Suc N)) \\<le> emeasure M (On (Suc N))", "by (auto simp add: eps_def summable_mult summable_divide summable_geometric less_imp_le)"], ["proof (state)\nthis:\n  ennreal (1 - (\\<Sum>N. eps (N + 1))) \\<le> emeasure M Ogood\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "moreover"], ["proof (state)\nthis:\n  ennreal (1 - (\\<Sum>N. eps (N + 1))) \\<le> emeasure M Ogood\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"(\\<Sum>N. eps(N+1)) = d2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N. eps (N + 1)) = d2", "unfolding eps_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N. d2 * (1 / 2) ^ (N + 1)) = d2", "apply (subst suminf_mult)"], ["proof (prove)\ngoal (2 subgoals):\n 1. summable (\\<lambda>N. (1 / 2) ^ (N + 1))\n 2. d2 * (\\<Sum>N. (1 / 2) ^ (N + 1)) = d2", "using sums_unique[OF power_half_series, symmetric]"], ["proof (prove)\nusing this:\n  (\\<Sum>n. (1 / 2) ^ Suc n) = 1\n\ngoal (2 subgoals):\n 1. summable (\\<lambda>N. (1 / 2) ^ (N + 1))\n 2. d2 * (\\<Sum>N. (1 / 2) ^ (N + 1)) = d2", "by (auto intro!: summable_divide summable_geometric)"], ["proof (state)\nthis:\n  (\\<Sum>N. eps (N + 1)) = d2\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "finally"], ["proof (chain)\npicking this:\n  ennreal (1 - d2) \\<le> emeasure M Ogood", "have \"emeasure M Ogood \\<ge> 1 - d2\""], ["proof (prove)\nusing this:\n  ennreal (1 - d2) \\<le> emeasure M Ogood\n\ngoal (1 subgoal):\n 1. ennreal (1 - d2) \\<le> emeasure M Ogood", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - d2) \\<le> emeasure M Ogood\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  ennreal (1 - d2) \\<le> emeasure M Ogood", "have \"emeasure M Ogood > 1 - d\""], ["proof (prove)\nusing this:\n  ennreal (1 - d2) \\<le> emeasure M Ogood\n\ngoal (1 subgoal):\n 1. ennreal (1 - d) < emeasure M Ogood", "unfolding d2_def"], ["proof (prove)\nusing this:\n  ennreal (1 - d / 2) \\<le> emeasure M Ogood\n\ngoal (1 subgoal):\n 1. ennreal (1 - d) < emeasure M Ogood", "using \\<open>d>0\\<close> \\<open>d \\<le> 1\\<close>"], ["proof (prove)\nusing this:\n  ennreal (1 - d / 2) \\<le> emeasure M Ogood\n  0 < d\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. ennreal (1 - d) < emeasure M Ogood", "by (simp add: emeasure_eq_measure field_sum_of_halves ennreal_less_iff)"], ["proof (state)\nthis:\n  ennreal (1 - d) < emeasure M Ogood\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have Ogood_union: \"Ogood = (\\<Union>(K::nat). Ogood \\<inter> {x \\<in> space M. \\<forall>n \\<in> {1..Nf 1}. \\<forall>l \\<in> {1..n}. u n x - u (n-l) x > - (real K * l)})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ogood =\n    (\\<Union>K.\n        Ogood \\<inter>\n        {x \\<in> space M.\n         \\<forall>n\\<in>{1..Nf 1}.\n            \\<forall>l\\<in>{1..n}.\n               - (real K * real l) < u n x - u (n - l) x})", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> Ogood \\<Longrightarrow> x \\<in> space M\n 2. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "using sets.sets_into_space[OF \\<open>Ogood \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  Ogood \\<subseteq> space M\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> Ogood \\<Longrightarrow> x \\<in> space M\n 2. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "define M where \"M = Max {abs(u n x - u (n-l) x)/l | n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\""], ["proof (state)\nthis:\n  M =\n  Max {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n       n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "obtain N::nat where \"N > M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>N. M < real N \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "using reals_Archimedean2"], ["proof (prove)\nusing this:\n  \\<exists>n. ?x < of_nat n\n\ngoal (1 subgoal):\n 1. (\\<And>N. M < real N \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by blast"], ["proof (state)\nthis:\n  M < real N\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "have \"finite { (n, l) | n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}", "by (rule finite_subset[where ?B = \"{1.. Nf 1} \\<times> {1..Nf 1}\"], auto)"], ["proof (state)\nthis:\n  finite {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "moreover"], ["proof (state)\nthis:\n  finite {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "have \"{abs(u n x - u (n-l) x)/l | n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n      = (\\<lambda> (n, l). abs(u n x - u (n-l) x)/l)` { (n, l) | n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n     n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}} =\n    (\\<lambda>(n, l). \\<bar>u n x - u (n - l) x\\<bar> / real l) `\n    {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}", "by auto"], ["proof (state)\nthis:\n  {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n   n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}} =\n  (\\<lambda>(n, l). \\<bar>u n x - u (n - l) x\\<bar> / real l) `\n  {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "ultimately"], ["proof (chain)\npicking this:\n  finite {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n  {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n   n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}} =\n  (\\<lambda>(n, l). \\<bar>u n x - u (n - l) x\\<bar> / real l) `\n  {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}", "have fin: \"finite {abs(u n x - u (n-l) x)/l | n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\""], ["proof (prove)\nusing this:\n  finite {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n  {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n   n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}} =\n  (\\<lambda>(n, l). \\<bar>u n x - u (n - l) x\\<bar> / real l) `\n  {(n, l) |n l. n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. finite\n     {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n      n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}", "by auto"], ["proof (state)\nthis:\n  finite\n   {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n    n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "{"], ["proof (state)\nthis:\n  finite\n   {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n    n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "fix n l"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "assume nl: \"n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}\""], ["proof (state)\nthis:\n  n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}", "have \"real l>0\""], ["proof (prove)\nusing this:\n  n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. 0 < real l", "by simp"], ["proof (state)\nthis:\n  0 < real l\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "have \"abs(u n x - u (n-l) x)/l \\<le> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u n x - u (n - l) x\\<bar> / real l \\<le> M", "unfolding M_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u n x - u (n - l) x\\<bar> / real l\n    \\<le> Max {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n               n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}", "apply (rule Max_ge)"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite\n     {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n      n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n 2. \\<bar>u n x - u (n - l) x\\<bar> / real l\n    \\<in> {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n           n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}", "using fin nl"], ["proof (prove)\nusing this:\n  finite\n   {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n    n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n  n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}\n\ngoal (2 subgoals):\n 1. finite\n     {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n      n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}\n 2. \\<bar>u n x - u (n - l) x\\<bar> / real l\n    \\<in> {\\<bar>u n x - u (n - l) x\\<bar> / real l |n l.\n           n \\<in> {1..Nf 1} \\<and> l \\<in> {1..n}}", "by auto"], ["proof (state)\nthis:\n  \\<bar>u n x - u (n - l) x\\<bar> / real l \\<le> M\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  \\<bar>u n x - u (n - l) x\\<bar> / real l \\<le> M", "have \"abs(u n x - u (n-l) x)/l < real N\""], ["proof (prove)\nusing this:\n  \\<bar>u n x - u (n - l) x\\<bar> / real l \\<le> M\n\ngoal (1 subgoal):\n 1. \\<bar>u n x - u (n - l) x\\<bar> / real l < real N", "using \\<open>N>M\\<close>"], ["proof (prove)\nusing this:\n  \\<bar>u n x - u (n - l) x\\<bar> / real l \\<le> M\n  M < real N\n\ngoal (1 subgoal):\n 1. \\<bar>u n x - u (n - l) x\\<bar> / real l < real N", "by simp"], ["proof (state)\nthis:\n  \\<bar>u n x - u (n - l) x\\<bar> / real l < real N\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  \\<bar>u n x - u (n - l) x\\<bar> / real l < real N", "have \"abs(u n x - u (n-l) x)< real N * l\""], ["proof (prove)\nusing this:\n  \\<bar>u n x - u (n - l) x\\<bar> / real l < real N\n\ngoal (1 subgoal):\n 1. \\<bar>u n x - u (n - l) x\\<bar> < real N * real l", "using \\<open>0 < real l\\<close> pos_divide_less_eq"], ["proof (prove)\nusing this:\n  \\<bar>u n x - u (n - l) x\\<bar> / real l < real N\n  0 < real l\n  (0::?'a) < ?c \\<Longrightarrow> (?b / ?c < ?a) = (?b < ?a * ?c)\n\ngoal (1 subgoal):\n 1. \\<bar>u n x - u (n - l) x\\<bar> < real N * real l", "by blast"], ["proof (state)\nthis:\n  \\<bar>u n x - u (n - l) x\\<bar> < real N * real l\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  \\<bar>u n x - u (n - l) x\\<bar> < real N * real l", "have \"u n x - u (n-l) x > - (real N * l)\""], ["proof (prove)\nusing this:\n  \\<bar>u n x - u (n - l) x\\<bar> < real N * real l\n\ngoal (1 subgoal):\n 1. - (real N * real l) < u n x - u (n - l) x", "by simp"], ["proof (state)\nthis:\n  - (real N * real l) < u n x - u (n - l) x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "}"], ["proof (state)\nthis:\n  ?n14 \\<in> {1..Nf 1} \\<and> ?l14 \\<in> {1..?n14} \\<Longrightarrow>\n  - (real N * real ?l14) < u ?n14 x - u (?n14 - ?l14) x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  ?n14 \\<in> {1..Nf 1} \\<and> ?l14 \\<in> {1..?n14} \\<Longrightarrow>\n  - (real N * real ?l14) < u ?n14 x - u (?n14 - ?l14) x", "have \"\\<forall>n\\<in>{Suc 0..Nf (Suc 0)}. \\<forall>l\\<in>{Suc 0..n}. - (real N * real l) < u n x - u (n - l) x\""], ["proof (prove)\nusing this:\n  ?n14 \\<in> {1..Nf 1} \\<and> ?l14 \\<in> {1..?n14} \\<Longrightarrow>\n  - (real N * real ?l14) < u ?n14 x - u (?n14 - ?l14) x\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n       \\<forall>l\\<in>{Suc 0..n}. - (real N * real l) < u n x - u (n - l) x", "by auto"], ["proof (state)\nthis:\n  \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n     \\<forall>l\\<in>{Suc 0..n}. - (real N * real l) < u n x - u (n - l) x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Ogood \\<Longrightarrow>\n       \\<exists>xa.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real xa * real l) < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n     \\<forall>l\\<in>{Suc 0..n}. - (real N * real l) < u n x - u (n - l) x", "show \"\\<exists>N. \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}. \\<forall>l\\<in>{Suc 0..n}. - (real N * real l) < u n x - u (n - l) x\""], ["proof (prove)\nusing this:\n  \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n     \\<forall>l\\<in>{Suc 0..n}. - (real N * real l) < u n x - u (n - l) x\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n          \\<forall>l\\<in>{Suc 0..n}.\n             - (real N * real l) < u n x - u (n - l) x", "by auto"], ["proof (state)\nthis:\n  \\<exists>N.\n     \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n        \\<forall>l\\<in>{Suc 0..n}. - (real N * real l) < u n x - u (n - l) x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Ogood =\n  (\\<Union>K.\n      Ogood \\<inter>\n      {x \\<in> space M.\n       \\<forall>n\\<in>{1..Nf 1}.\n          \\<forall>l\\<in>{1..n}. - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"(\\<lambda>K. emeasure M (Ogood \\<inter> {x \\<in> space M. \\<forall>n \\<in> {1..Nf 1}. \\<forall>l \\<in> {1..n}. u n x - u (n-l) x > - (real K * l)}))\n    \\<longlonglongrightarrow> emeasure M (\\<Union>(K::nat). Ogood \\<inter> {x \\<in> space M. \\<forall>n \\<in> {1..Nf 1}. \\<forall>l \\<in> {1..n}. u n x - u (n-l) x > - (real K * l)})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>K.\n        emeasure M\n         (Ogood \\<inter>\n          {x \\<in> space M.\n           \\<forall>n\\<in>{1..Nf 1}.\n              \\<forall>l\\<in>{1..n}.\n                 - (real K * real l) < u n x - u (n - l) x}))\n    \\<longlonglongrightarrow> emeasure M\n                               (\\<Union>K.\n                                   Ogood \\<inter>\n                                   {x \\<in> space M.\n                                    \\<forall>n\\<in>{1..Nf 1}.\n \\<forall>l\\<in>{1..n}. - (real K * real l) < u n x - u (n - l) x})", "apply (rule Lim_emeasure_incseq, auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. incseq\n     (\\<lambda>i.\n         Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n             \\<forall>l\\<in>{Suc 0..n}.\n                - (real i * real l) < u n x - u (n - l) x})", "unfolding incseq_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>m n.\n       m \\<le> n \\<longrightarrow>\n       Ogood \\<inter>\n       {x \\<in> space M.\n        \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n           \\<forall>l\\<in>{Suc 0..n}.\n              - (real m * real l) < u n x - u (n - l) x}\n       \\<subseteq> Ogood \\<inter>\n                   {x \\<in> space M.\n                    \\<forall>na\\<in>{Suc 0..Nf (Suc 0)}.\n                       \\<forall>l\\<in>{Suc 0..na}.\n                          - (real n * real l) < u na x - u (na - l) x}", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m n x na l.\n       \\<lbrakk>m \\<le> n; x \\<in> Ogood; x \\<in> space M;\n        \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n           \\<forall>l\\<in>{Suc 0..n}.\n              - (real m * real l) < u n x - u (n - l) x;\n        na \\<le> Nf (Suc 0); Suc 0 \\<le> l; l \\<le> na\\<rbrakk>\n       \\<Longrightarrow> - (real n * real l) < u na x - u (na - l) x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>m n x na l.\n       \\<lbrakk>m \\<le> n; x \\<in> Ogood; x \\<in> space M;\n        \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n           \\<forall>l\\<in>{Suc 0..n}.\n              - (real m * real l) < u n x - u (n - l) x;\n        na \\<le> Nf (Suc 0); Suc 0 \\<le> l; l \\<le> na\\<rbrakk>\n       \\<Longrightarrow> - (real n * real l) < u na x - u (na - l) x", "fix m n x na l"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>m n x na l.\n       \\<lbrakk>m \\<le> n; x \\<in> Ogood; x \\<in> space M;\n        \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n           \\<forall>l\\<in>{Suc 0..n}.\n              - (real m * real l) < u n x - u (n - l) x;\n        na \\<le> Nf (Suc 0); Suc 0 \\<le> l; l \\<le> na\\<rbrakk>\n       \\<Longrightarrow> - (real n * real l) < u na x - u (na - l) x", "assume \"m \\<le> (n::nat)\" \"\\<forall>n\\<in>{Suc 0..Nf (Suc 0)}. \\<forall>l\\<in>{Suc 0..n}. - (real m * real l) < u n x - u (n - l) x\"\n             \"Suc 0 \\<le> l\" \"l \\<le> na\" \"na \\<le> Nf (Suc 0)\""], ["proof (state)\nthis:\n  m \\<le> n\n  \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n     \\<forall>l\\<in>{Suc 0..n}. - (real m * real l) < u n x - u (n - l) x\n  Suc 0 \\<le> l\n  l \\<le> na\n  na \\<le> Nf (Suc 0)\n\ngoal (1 subgoal):\n 1. \\<And>m n x na l.\n       \\<lbrakk>m \\<le> n; x \\<in> Ogood; x \\<in> space M;\n        \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n           \\<forall>l\\<in>{Suc 0..n}.\n              - (real m * real l) < u n x - u (n - l) x;\n        na \\<le> Nf (Suc 0); Suc 0 \\<le> l; l \\<le> na\\<rbrakk>\n       \\<Longrightarrow> - (real n * real l) < u na x - u (na - l) x", "then"], ["proof (chain)\npicking this:\n  m \\<le> n\n  \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n     \\<forall>l\\<in>{Suc 0..n}. - (real m * real l) < u n x - u (n - l) x\n  Suc 0 \\<le> l\n  l \\<le> na\n  na \\<le> Nf (Suc 0)", "have \"- (real m * real l) < u na x - u (na - l) x\""], ["proof (prove)\nusing this:\n  m \\<le> n\n  \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n     \\<forall>l\\<in>{Suc 0..n}. - (real m * real l) < u n x - u (n - l) x\n  Suc 0 \\<le> l\n  l \\<le> na\n  na \\<le> Nf (Suc 0)\n\ngoal (1 subgoal):\n 1. - (real m * real l) < u na x - u (na - l) x", "by auto"], ["proof (state)\nthis:\n  - (real m * real l) < u na x - u (na - l) x\n\ngoal (1 subgoal):\n 1. \\<And>m n x na l.\n       \\<lbrakk>m \\<le> n; x \\<in> Ogood; x \\<in> space M;\n        \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n           \\<forall>l\\<in>{Suc 0..n}.\n              - (real m * real l) < u n x - u (n - l) x;\n        na \\<le> Nf (Suc 0); Suc 0 \\<le> l; l \\<le> na\\<rbrakk>\n       \\<Longrightarrow> - (real n * real l) < u na x - u (na - l) x", "moreover"], ["proof (state)\nthis:\n  - (real m * real l) < u na x - u (na - l) x\n\ngoal (1 subgoal):\n 1. \\<And>m n x na l.\n       \\<lbrakk>m \\<le> n; x \\<in> Ogood; x \\<in> space M;\n        \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n           \\<forall>l\\<in>{Suc 0..n}.\n              - (real m * real l) < u n x - u (n - l) x;\n        na \\<le> Nf (Suc 0); Suc 0 \\<le> l; l \\<le> na\\<rbrakk>\n       \\<Longrightarrow> - (real n * real l) < u na x - u (na - l) x", "have \"- (real n * real l) \\<le> - (real m * real l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - (real n * real l) \\<le> - (real m * real l)", "using \\<open>m \\<le> n\\<close>"], ["proof (prove)\nusing this:\n  m \\<le> n\n\ngoal (1 subgoal):\n 1. - (real n * real l) \\<le> - (real m * real l)", "by (simp add: mult_mono)"], ["proof (state)\nthis:\n  - (real n * real l) \\<le> - (real m * real l)\n\ngoal (1 subgoal):\n 1. \\<And>m n x na l.\n       \\<lbrakk>m \\<le> n; x \\<in> Ogood; x \\<in> space M;\n        \\<forall>n\\<in>{Suc 0..Nf (Suc 0)}.\n           \\<forall>l\\<in>{Suc 0..n}.\n              - (real m * real l) < u n x - u (n - l) x;\n        na \\<le> Nf (Suc 0); Suc 0 \\<le> l; l \\<le> na\\<rbrakk>\n       \\<Longrightarrow> - (real n * real l) < u na x - u (na - l) x", "ultimately"], ["proof (chain)\npicking this:\n  - (real m * real l) < u na x - u (na - l) x\n  - (real n * real l) \\<le> - (real m * real l)", "show \"- (real n * real l) < u na x - u (na - l) x\""], ["proof (prove)\nusing this:\n  - (real m * real l) < u na x - u (na - l) x\n  - (real n * real l) \\<le> - (real m * real l)\n\ngoal (1 subgoal):\n 1. - (real n * real l) < u na x - u (na - l) x", "by auto"], ["proof (state)\nthis:\n  - (real n * real l) < u na x - u (na - l) x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>K.\n      emeasure M\n       (Ogood \\<inter>\n        {x \\<in> space M.\n         \\<forall>n\\<in>{1..Nf 1}.\n            \\<forall>l\\<in>{1..n}.\n               - (real K * real l) < u n x - u (n - l) x}))\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>K.\n                                 Ogood \\<inter>\n                                 {x \\<in> space M.\n                                  \\<forall>n\\<in>{1..Nf 1}.\n                                     \\<forall>l\\<in>{1..n}.\n  - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>K.\n      emeasure M\n       (Ogood \\<inter>\n        {x \\<in> space M.\n         \\<forall>n\\<in>{1..Nf 1}.\n            \\<forall>l\\<in>{1..n}.\n               - (real K * real l) < u n x - u (n - l) x}))\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>K.\n                                 Ogood \\<inter>\n                                 {x \\<in> space M.\n                                  \\<forall>n\\<in>{1..Nf 1}.\n                                     \\<forall>l\\<in>{1..n}.\n  - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"emeasure M (\\<Union>(K::nat). Ogood \\<inter> {x \\<in> space M. \\<forall>n \\<in> {1..Nf 1}. \\<forall>l \\<in> {1..n}. u n x - u (n-l) x > - (real K * l)}) > 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       (\\<Union>K.\n           Ogood \\<inter>\n           {x \\<in> space M.\n            \\<forall>n\\<in>{1..Nf 1}.\n               \\<forall>l\\<in>{1..n}.\n                  - (real K * real l) < u n x - u (n - l) x})", "using Ogood_union \\<open>emeasure M Ogood > 1 - d\\<close>"], ["proof (prove)\nusing this:\n  Ogood =\n  (\\<Union>K.\n      Ogood \\<inter>\n      {x \\<in> space M.\n       \\<forall>n\\<in>{1..Nf 1}.\n          \\<forall>l\\<in>{1..n}. - (real K * real l) < u n x - u (n - l) x})\n  ennreal (1 - d) < emeasure M Ogood\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       (\\<Union>K.\n           Ogood \\<inter>\n           {x \\<in> space M.\n            \\<forall>n\\<in>{1..Nf 1}.\n               \\<forall>l\\<in>{1..n}.\n                  - (real K * real l) < u n x - u (n - l) x})", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  < emeasure M\n     (\\<Union>K.\n         Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{1..Nf 1}.\n             \\<forall>l\\<in>{1..n}.\n                - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>K.\n      emeasure M\n       (Ogood \\<inter>\n        {x \\<in> space M.\n         \\<forall>n\\<in>{1..Nf 1}.\n            \\<forall>l\\<in>{1..n}.\n               - (real K * real l) < u n x - u (n - l) x}))\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>K.\n                                 Ogood \\<inter>\n                                 {x \\<in> space M.\n                                  \\<forall>n\\<in>{1..Nf 1}.\n                                     \\<forall>l\\<in>{1..n}.\n  - (real K * real l) < u n x - u (n - l) x})\n  ennreal (1 - d)\n  < emeasure M\n     (\\<Union>K.\n         Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{1..Nf 1}.\n             \\<forall>l\\<in>{1..n}.\n                - (real K * real l) < u n x - u (n - l) x})", "have a: \"eventually (\\<lambda>K. emeasure M (Ogood \\<inter> {x \\<in> space M. \\<forall>n \\<in> {1..Nf 1}. \\<forall>l \\<in> {1..n}. u n x - u (n-l) x > - (real K * l)}) > 1 - d) sequentially\""], ["proof (prove)\nusing this:\n  (\\<lambda>K.\n      emeasure M\n       (Ogood \\<inter>\n        {x \\<in> space M.\n         \\<forall>n\\<in>{1..Nf 1}.\n            \\<forall>l\\<in>{1..n}.\n               - (real K * real l) < u n x - u (n - l) x}))\n  \\<longlonglongrightarrow> emeasure M\n                             (\\<Union>K.\n                                 Ogood \\<inter>\n                                 {x \\<in> space M.\n                                  \\<forall>n\\<in>{1..Nf 1}.\n                                     \\<forall>l\\<in>{1..n}.\n  - (real K * real l) < u n x - u (n - l) x})\n  ennreal (1 - d)\n  < emeasure M\n     (\\<Union>K.\n         Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{1..Nf 1}.\n             \\<forall>l\\<in>{1..n}.\n                - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F K in sequentially.\n       ennreal (1 - d)\n       < emeasure M\n          (Ogood \\<inter>\n           {x \\<in> space M.\n            \\<forall>n\\<in>{1..Nf 1}.\n               \\<forall>l\\<in>{1..n}.\n                  - (real K * real l) < u n x - u (n - l) x})", "by (rule order_tendstoD(1))"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F K in sequentially.\n     ennreal (1 - d)\n     < emeasure M\n        (Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{1..Nf 1}.\n             \\<forall>l\\<in>{1..n}.\n                - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have b: \"eventually (\\<lambda>K. K \\<ge> max c0 d2) sequentially\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F K in sequentially. max c0 d2 \\<le> real K", "using eventually_at_top_linorder nat_ceiling_le_eq"], ["proof (prove)\nusing this:\n  eventually ?P at_top = (\\<exists>N. \\<forall>n\\<ge>N. ?P n)\n  (nat \\<lceil>?x\\<rceil> \\<le> ?a) = (?x \\<le> real ?a)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F K in sequentially. max c0 d2 \\<le> real K", "by blast"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F K in sequentially. max c0 d2 \\<le> real K\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"eventually (\\<lambda>K. K \\<ge> max c0 d2 \\<and> emeasure M (Ogood \\<inter> {x \\<in> space M. \\<forall>n \\<in> {1..Nf 1}. \\<forall>l \\<in> {1..n}. u n x - u (n-l) x > - (real K * l)}) > 1 - d) sequentially\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F K in sequentially.\n       max c0 d2 \\<le> real K \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          (Ogood \\<inter>\n           {x \\<in> space M.\n            \\<forall>n\\<in>{1..Nf 1}.\n               \\<forall>l\\<in>{1..n}.\n                  - (real K * real l) < u n x - u (n - l) x})", "by (rule eventually_elim2[OF a b], auto)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F K in sequentially.\n     max c0 d2 \\<le> real K \\<and>\n     ennreal (1 - d)\n     < emeasure M\n        (Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{1..Nf 1}.\n             \\<forall>l\\<in>{1..n}.\n                - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F K in sequentially.\n     max c0 d2 \\<le> real K \\<and>\n     ennreal (1 - d)\n     < emeasure M\n        (Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{1..Nf 1}.\n             \\<forall>l\\<in>{1..n}.\n                - (real K * real l) < u n x - u (n - l) x})", "obtain K where K: \"K\\<ge>max c0 d2\" \"emeasure M (Ogood \\<inter> {x \\<in> space M. \\<forall>n \\<in> {1..Nf 1}. \\<forall>l \\<in> {1..n}. u n x - u (n-l) x > - (real K * l)}) > 1 - d\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F K in sequentially.\n     max c0 d2 \\<le> real K \\<and>\n     ennreal (1 - d)\n     < emeasure M\n        (Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{1..Nf 1}.\n             \\<forall>l\\<in>{1..n}.\n                - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. (\\<And>K.\n        \\<lbrakk>max c0 d2 \\<le> real K;\n         ennreal (1 - d)\n         < emeasure M\n            (Ogood \\<inter>\n             {x \\<in> space M.\n              \\<forall>n\\<in>{1..Nf 1}.\n                 \\<forall>l\\<in>{1..n}.\n                    - (real K * real l) < u n x - u (n - l) x})\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using eventually_False_sequentially eventually_elim2"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F K in sequentially.\n     max c0 d2 \\<le> real K \\<and>\n     ennreal (1 - d)\n     < emeasure M\n        (Ogood \\<inter>\n         {x \\<in> space M.\n          \\<forall>n\\<in>{1..Nf 1}.\n             \\<forall>l\\<in>{1..n}.\n                - (real K * real l) < u n x - u (n - l) x})\n  \\<not> (\\<forall>\\<^sub>F n in sequentially. False)\n  \\<lbrakk>eventually ?P ?F; eventually ?Q ?F;\n   \\<And>i. \\<lbrakk>?P i; ?Q i\\<rbrakk> \\<Longrightarrow> ?R i\\<rbrakk>\n  \\<Longrightarrow> eventually ?R ?F\n\ngoal (1 subgoal):\n 1. (\\<And>K.\n        \\<lbrakk>max c0 d2 \\<le> real K;\n         ennreal (1 - d)\n         < emeasure M\n            (Ogood \\<inter>\n             {x \\<in> space M.\n              \\<forall>n\\<in>{1..Nf 1}.\n                 \\<forall>l\\<in>{1..n}.\n                    - (real K * real l) < u n x - u (n - l) x})\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  max c0 d2 \\<le> real K\n  ennreal (1 - d)\n  < emeasure M\n     (Ogood \\<inter>\n      {x \\<in> space M.\n       \\<forall>n\\<in>{1..Nf 1}.\n          \\<forall>l\\<in>{1..n}. - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define Og where \"Og = Ogood \\<inter> {x \\<in> space M. \\<forall>n \\<in> {1..Nf 1}. \\<forall>l \\<in> {1..n}. u n x - u (n-l) x > - (real K * l)}\""], ["proof (state)\nthis:\n  Og =\n  Ogood \\<inter>\n  {x \\<in> space M.\n   \\<forall>n\\<in>{1..Nf 1}.\n      \\<forall>l\\<in>{1..n}. - (real K * real l) < u n x - u (n - l) x}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have [measurable]: \"Og \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Og \\<in> events", "unfolding Og_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Ogood \\<inter>\n    {x \\<in> space M.\n     \\<forall>n\\<in>{1..Nf 1}.\n        \\<forall>l\\<in>{1..n}. - (real K * real l) < u n x - u (n - l) x}\n    \\<in> events", "by simp"], ["proof (state)\nthis:\n  Og \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"emeasure M Og > 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d) < emeasure M Og", "unfolding Og_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       (Ogood \\<inter>\n        {x \\<in> space M.\n         \\<forall>n\\<in>{1..Nf 1}.\n            \\<forall>l\\<in>{1..n}.\n               - (real K * real l) < u n x - u (n - l) x})", "using K"], ["proof (prove)\nusing this:\n  max c0 d2 \\<le> real K\n  ennreal (1 - d)\n  < emeasure M\n     (Ogood \\<inter>\n      {x \\<in> space M.\n       \\<forall>n\\<in>{1..Nf 1}.\n          \\<forall>l\\<in>{1..n}. - (real K * real l) < u n x - u (n - l) x})\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       (Ogood \\<inter>\n        {x \\<in> space M.\n         \\<forall>n\\<in>{1..Nf 1}.\n            \\<forall>l\\<in>{1..n}.\n               - (real K * real l) < u n x - u (n - l) x})", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - d) < emeasure M Og\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have fin: \"finite {N. Nf N \\<le> n}\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {N. Nf N \\<le> n}", "using pseudo_inverse_finite_set[OF filterlim_subseq[OF \\<open>strict_mono Nf\\<close>]]"], ["proof (prove)\nusing this:\n  finite {N. Nf N \\<le> ?n}\n\ngoal (1 subgoal):\n 1. finite {N. Nf N \\<le> n}", "by auto"], ["proof (state)\nthis:\n  finite {N. Nf N \\<le> ?n12}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define prev_N where \"prev_N = (\\<lambda>n. Max {N. Nf N \\<le> n})\""], ["proof (state)\nthis:\n  prev_N = (\\<lambda>n. Max {N. Nf N \\<le> n})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define delta where \"delta = (\\<lambda>l. if (prev_N l \\<le> 1) then K else eps (prev_N l))\""], ["proof (state)\nthis:\n  delta = (\\<lambda>l. if prev_N l \\<le> 1 then real K else eps (prev_N l))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"\\<forall>l. delta l > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l. 0 < delta l", "unfolding delta_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l. 0 < (if prev_N l \\<le> 1 then real K else eps (prev_N l))", "using \\<open>K\\<ge>max c0 d2\\<close> \\<open>c0>0\\<close>"], ["proof (prove)\nusing this:\n  max c0 d2 \\<le> real K\n  0 < c0\n\ngoal (1 subgoal):\n 1. \\<forall>l. 0 < (if prev_N l \\<le> 1 then real K else eps (prev_N l))", "by auto"], ["proof (state)\nthis:\n  \\<forall>l. 0 < delta l\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"LIM n sequentially. prev_N n :> at_top\""], ["proof (prove)\ngoal (1 subgoal):\n 1. filterlim prev_N sequentially sequentially", "unfolding prev_N_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. LIM n sequentially. Max {N. Nf N \\<le> n} :> sequentially", "apply (rule tendsto_at_top_pseudo_inverse2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. filterlim Nf sequentially sequentially", "using \\<open>strict_mono Nf\\<close>"], ["proof (prove)\nusing this:\n  strict_mono Nf\n\ngoal (1 subgoal):\n 1. filterlim Nf sequentially sequentially", "by (simp add: filterlim_subseq)"], ["proof (state)\nthis:\n  filterlim prev_N sequentially sequentially\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  filterlim prev_N sequentially sequentially", "have \"eventually (\\<lambda>l. prev_N l > 1) sequentially\""], ["proof (prove)\nusing this:\n  filterlim prev_N sequentially sequentially\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F l in sequentially. 1 < prev_N l", "by (simp add: filterlim_iff)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F l in sequentially. 1 < prev_N l\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F l in sequentially. 1 < prev_N l", "have \"eventually (\\<lambda>l. delta l = eps(prev_N l)) sequentially\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F l in sequentially. 1 < prev_N l\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F l in sequentially. delta l = eps (prev_N l)", "unfolding delta_def"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F l in sequentially. 1 < prev_N l\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F l in sequentially.\n       (if prev_N l \\<le> 1 then real K else eps (prev_N l)) =\n       eps (prev_N l)", "by (simp add: eventually_mono)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F l in sequentially. delta l = eps (prev_N l)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "moreover"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F l in sequentially. delta l = eps (prev_N l)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"(\\<lambda>l. eps(prev_N l)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>l. eps (prev_N l)) \\<longlonglongrightarrow> 0", "by (rule filterlim_compose[OF \\<open>eps \\<longlonglongrightarrow> 0\\<close> \\<open>LIM n sequentially. prev_N n :> at_top\\<close>])"], ["proof (state)\nthis:\n  (\\<lambda>l. eps (prev_N l)) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F l in sequentially. delta l = eps (prev_N l)\n  (\\<lambda>l. eps (prev_N l)) \\<longlonglongrightarrow> 0", "have \"delta \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F l in sequentially. delta l = eps (prev_N l)\n  (\\<lambda>l. eps (prev_N l)) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. delta \\<longlonglongrightarrow> 0", "by (simp add: filterlim_cong)"], ["proof (state)\nthis:\n  delta \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"delta n \\<le> K\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. delta n \\<le> real K", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. delta n \\<le> real K", "have *: \"d2 * (1 / 2) ^ prev_N n \\<le> real K * 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d2 * (1 / 2) ^ prev_N n \\<le> real K * 1", "apply (rule mult_mono')"], ["proof (prove)\ngoal (4 subgoals):\n 1. d2 \\<le> real K\n 2. (1 / 2) ^ prev_N n \\<le> 1\n 3. 0 \\<le> d2\n 4. 0 \\<le> (1 / 2) ^ prev_N n", "using \\<open>K \\<ge> max c0 d2\\<close> \\<open>d2>0\\<close>"], ["proof (prove)\nusing this:\n  max c0 d2 \\<le> real K\n  0 < d2\n\ngoal (4 subgoals):\n 1. d2 \\<le> real K\n 2. (1 / 2) ^ prev_N n \\<le> 1\n 3. 0 \\<le> d2\n 4. 0 \\<le> (1 / 2) ^ prev_N n", "by (auto simp add: power_le_one less_imp_le)"], ["proof (state)\nthis:\n  d2 * (1 / 2) ^ prev_N n \\<le> real K * 1\n\ngoal (1 subgoal):\n 1. delta n \\<le> real K", "then"], ["proof (chain)\npicking this:\n  d2 * (1 / 2) ^ prev_N n \\<le> real K * 1", "show ?thesis"], ["proof (prove)\nusing this:\n  d2 * (1 / 2) ^ prev_N n \\<le> real K * 1\n\ngoal (1 subgoal):\n 1. delta n \\<le> real K", "unfolding delta_def"], ["proof (prove)\nusing this:\n  d2 * (1 / 2) ^ prev_N n \\<le> real K * 1\n\ngoal (1 subgoal):\n 1. (if prev_N n \\<le> 1 then real K else eps (prev_N n)) \\<le> real K", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>d2 * (1 / 2) ^ prev_N n \\<le> real K;\n     \\<not> prev_N n \\<le> Suc 0\\<rbrakk>\n    \\<Longrightarrow> eps (prev_N n) \\<le> real K", "unfolding eps_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>d2 * (1 / 2) ^ prev_N n \\<le> real K;\n     \\<not> prev_N n \\<le> Suc 0\\<rbrakk>\n    \\<Longrightarrow> d2 * (1 / 2) ^ prev_N n \\<le> real K", "using *"], ["proof (prove)\nusing this:\n  d2 * (1 / 2) ^ prev_N n \\<le> real K * 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>d2 * (1 / 2) ^ prev_N n \\<le> real K;\n     \\<not> prev_N n \\<le> Suc 0\\<rbrakk>\n    \\<Longrightarrow> d2 * (1 / 2) ^ prev_N n \\<le> real K", "by auto"], ["proof (state)\nthis:\n  delta n \\<le> real K\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  delta ?n12 \\<le> real K\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "define bad_times where \"bad_times = (\\<lambda>x. {n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<union>\n                      (\\<Union>N\\<in>{2..}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)}))\""], ["proof (state)\nthis:\n  bad_times =\n  (\\<lambda>x.\n      {n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<union>\n      (\\<Union>N\\<in>{2..}.\n          {n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)}))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have card_bad_times: \"card (bad_times x \\<inter> {..<B}) \\<le> d2 * B\" if \"x \\<in> Og\" for x B"], ["proof (prove)\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"(\\<Sum>N\\<in>{..<B}. (1/(2::real))^N) \\<le> (\\<Sum>N. (1/2)^N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum ((^) (1 / 2)) {..<B} \\<le> (\\<Sum>N. (1 / 2) ^ N)", "by (rule sum_le_suminf, auto simp add: summable_geometric)"], ["proof (state)\nthis:\n  sum ((^) (1 / 2)) {..<B} \\<le> (\\<Sum>N. (1 / 2) ^ N)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  sum ((^) (1 / 2)) {..<B} \\<le> (\\<Sum>N. (1 / 2) ^ N)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... = 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N. (1 / 2) ^ N) = 2", "using suminf_geometric[of \"1/(2::real)\"]"], ["proof (prove)\nusing this:\n  norm (1 / 2) < 1 \\<Longrightarrow>\n  (\\<Sum>n. (1 / 2) ^ n) = 1 / (1 - 1 / 2)\n\ngoal (1 subgoal):\n 1. (\\<Sum>N. (1 / 2) ^ N) = 2", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>N. (1 / 2) ^ N) = 2\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "finally"], ["proof (chain)\npicking this:\n  sum ((^) (1 / 2)) {..<B} \\<le> 2", "have *: \"(\\<Sum>N\\<in>{..<B}. (1/(2::real))^N) \\<le> 2\""], ["proof (prove)\nusing this:\n  sum ((^) (1 / 2)) {..<B} \\<le> 2\n\ngoal (1 subgoal):\n 1. sum ((^) (1 / 2)) {..<B} \\<le> 2", "by simp"], ["proof (state)\nthis:\n  sum ((^) (1 / 2)) {..<B} \\<le> 2\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"(\\<Sum> N \\<in> {2..<B}. eps N * B) \\<le> (\\<Sum> N \\<in> {2..<B+2}. eps N * B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N = 2..<B. eps N * real B)\n    \\<le> (\\<Sum>N = 2..<B + 2. eps N * real B)", "by (rule sum_mono2, auto)"], ["proof (state)\nthis:\n  (\\<Sum>N = 2..<B. eps N * real B)\n  \\<le> (\\<Sum>N = 2..<B + 2. eps N * real B)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  (\\<Sum>N = 2..<B. eps N * real B)\n  \\<le> (\\<Sum>N = 2..<B + 2. eps N * real B)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... = (\\<Sum>N\\<in>{2..<B+2}. d2 * (1/2)^N * B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N = 2..<B + 2. eps N * real B) =\n    (\\<Sum>N = 2..<B + 2. d2 * (1 / 2) ^ N * real B)", "unfolding eps_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N = 2..<B + 2. d2 * (1 / 2) ^ N * real B) =\n    (\\<Sum>N = 2..<B + 2. d2 * (1 / 2) ^ N * real B)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>N = 2..<B + 2. eps N * real B) =\n  (\\<Sum>N = 2..<B + 2. d2 * (1 / 2) ^ N * real B)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  (\\<Sum>N = 2..<B + 2. eps N * real B) =\n  (\\<Sum>N = 2..<B + 2. d2 * (1 / 2) ^ N * real B)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... = (\\<Sum>N\\<in>{..<B}. d2 * (1/2)^(N+2) * B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N = 2..<B + 2. d2 * (1 / 2) ^ N * real B) =\n    (\\<Sum>N<B. d2 * (1 / 2) ^ (N + 2) * real B)", "by (rule sum.reindex_bij_betw[symmetric],rule bij_betw_byWitness[where ?f' = \"\\<lambda>i. i-2\"], auto)"], ["proof (state)\nthis:\n  (\\<Sum>N = 2..<B + 2. d2 * (1 / 2) ^ N * real B) =\n  (\\<Sum>N<B. d2 * (1 / 2) ^ (N + 2) * real B)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  (\\<Sum>N = 2..<B + 2. d2 * (1 / 2) ^ N * real B) =\n  (\\<Sum>N<B. d2 * (1 / 2) ^ (N + 2) * real B)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... = (\\<Sum>N\\<in>{..<B}. (d2 * (1/4) * B) * (1/2)^N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N<B. d2 * (1 / 2) ^ (N + 2) * real B) =\n    (\\<Sum>N<B. d2 * (1 / 4) * real B * (1 / 2) ^ N)", "by (auto, metis (lifting) mult.commute mult.left_commute)"], ["proof (state)\nthis:\n  (\\<Sum>N<B. d2 * (1 / 2) ^ (N + 2) * real B) =\n  (\\<Sum>N<B. d2 * (1 / 4) * real B * (1 / 2) ^ N)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  (\\<Sum>N<B. d2 * (1 / 2) ^ (N + 2) * real B) =\n  (\\<Sum>N<B. d2 * (1 / 4) * real B * (1 / 2) ^ N)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... = (d2 * (1/4) * B) * (\\<Sum>N\\<in>{..<B}. (1/2)^N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>N<B. d2 * (1 / 4) * real B * (1 / 2) ^ N) =\n    d2 * (1 / 4) * real B * sum ((^) (1 / 2)) {..<B}", "by (rule sum_distrib_left[symmetric])"], ["proof (state)\nthis:\n  (\\<Sum>N<B. d2 * (1 / 4) * real B * (1 / 2) ^ N) =\n  d2 * (1 / 4) * real B * sum ((^) (1 / 2)) {..<B}\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  (\\<Sum>N<B. d2 * (1 / 4) * real B * (1 / 2) ^ N) =\n  d2 * (1 / 4) * real B * sum ((^) (1 / 2)) {..<B}\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... \\<le> (d2 * (1/4) * B) * 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d2 * (1 / 4) * real B * sum ((^) (1 / 2)) {..<B}\n    \\<le> d2 * (1 / 4) * real B * 2", "apply (rule mult_left_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. sum ((^) (1 / 2)) {..<B} \\<le> 2\n 2. 0 \\<le> d2 * (1 / 4) * real B", "using * \\<open>d2 > 0\\<close>"], ["proof (prove)\nusing this:\n  sum ((^) (1 / 2)) {..<B} \\<le> 2\n  0 < d2\n\ngoal (2 subgoals):\n 1. sum ((^) (1 / 2)) {..<B} \\<le> 2\n 2. 0 \\<le> d2 * (1 / 4) * real B", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. sum ((^) (1 / 2)) {..<B} \\<le> 2 \\<Longrightarrow> 0 \\<le> d2 * real B", "by (metis \\<open>0 < d2\\<close> mult_eq_0_iff mult_le_0_iff not_le of_nat_eq_0_iff of_nat_le_0_iff)"], ["proof (state)\nthis:\n  d2 * (1 / 4) * real B * sum ((^) (1 / 2)) {..<B}\n  \\<le> d2 * (1 / 4) * real B * 2\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>N = 2..<B. eps N * real B) \\<le> d2 * (1 / 4) * real B * 2", "have I: \"(\\<Sum> N \\<in> {2..<B}. eps N * B) \\<le> d2/2 * B\""], ["proof (prove)\nusing this:\n  (\\<Sum>N = 2..<B. eps N * real B) \\<le> d2 * (1 / 4) * real B * 2\n\ngoal (1 subgoal):\n 1. (\\<Sum>N = 2..<B. eps N * real B) \\<le> d2 / 2 * real B", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>N = 2..<B. eps N * real B) \\<le> d2 / 2 * real B\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"x \\<in> On 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> On 1", "using \\<open>x \\<in> Og\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> Og\n\ngoal (1 subgoal):\n 1. x \\<in> On 1", "unfolding Og_def Ogood_def"], ["proof (prove)\nusing this:\n  x \\<in> (\\<Inter>N. On (N + 1)) \\<inter>\n          {x \\<in> space M.\n           \\<forall>n\\<in>{1..Nf 1}.\n              \\<forall>l\\<in>{1..n}.\n                 - (real K * real l) < u n x - u (n - l) x}\n\ngoal (1 subgoal):\n 1. x \\<in> On 1", "by auto"], ["proof (state)\nthis:\n  x \\<in> On 1\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "then"], ["proof (chain)\npicking this:\n  x \\<in> On 1", "have \"x \\<in> O1\""], ["proof (prove)\nusing this:\n  x \\<in> On 1\n\ngoal (1 subgoal):\n 1. x \\<in> O1", "unfolding On_def"], ["proof (prove)\nusing this:\n  x \\<in> (if 1 = 1 then O1\n           else {x \\<in> space M.\n                 \\<forall>B\\<ge>Nf 1.\n                    real\n                     (card\n                       ({n. \\<exists>l\\<in>{Nf 1..n}.\n                               u n x - u (n - l) x\n                               \\<le> - eps 1 * real l} \\<inter>\n                        {..<B}))\n                    < eps 1 * real B})\n\ngoal (1 subgoal):\n 1. x \\<in> O1", "by auto"], ["proof (state)\nthis:\n  x \\<in> O1\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have B1: \"real(card({n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B})) \\<le> (d2/2) * B\" for B"], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "proof (cases \"B \\<ge> N1\")"], ["proof (state)\ngoal (2 subgoals):\n 1. N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B\n 2. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "case True"], ["proof (state)\nthis:\n  N1 \\<le> B\n\ngoal (2 subgoals):\n 1. N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B\n 2. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "have \"card({n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B})\n        \\<le> card({n. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B})\n    \\<le> card\n           ({n. \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n            {..<B})", "by (rule card_mono, auto)"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf 1..}.\n     \\<exists>l\\<in>{1..n}.\n        u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n    {..<B})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B})\n\ngoal (2 subgoals):\n 1. N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B\n 2. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "also"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf 1..}.\n     \\<exists>l\\<in>{1..n}.\n        u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n    {..<B})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B})\n\ngoal (2 subgoals):\n 1. N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B\n 2. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "have \"... \\<le> (d2/2) * B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{1..n}.\n               u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "using \\<open>x \\<in> O1\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> O1\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{1..n}.\n               u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "unfolding O1_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           \\<forall>B\\<ge>N1.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{1..n}.\n                         u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n                  {..<B}))\n              < d2 / 2 * real B}\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{1..n}.\n               u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "using True"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           \\<forall>B\\<ge>N1.\n              real\n               (card\n                 ({n. \\<exists>l\\<in>{1..n}.\n                         u n x - u (n - l) x \\<le> - c0 * real l} \\<inter>\n                  {..<B}))\n              < d2 / 2 * real B}\n  N1 \\<le> B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{1..n}.\n               u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{1..n}.\n             u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}))\n  \\<le> d2 / 2 * real B\n\ngoal (2 subgoals):\n 1. N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B\n 2. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}))\n  \\<le> d2 / 2 * real B", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}))\n  \\<le> d2 / 2 * real B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}))\n  \\<le> d2 / 2 * real B\n\ngoal (1 subgoal):\n 1. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "case False"], ["proof (state)\nthis:\n  \\<not> N1 \\<le> B\n\ngoal (1 subgoal):\n 1. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "then"], ["proof (chain)\npicking this:\n  \\<not> N1 \\<le> B", "have \"B < Nf 1\""], ["proof (prove)\nusing this:\n  \\<not> N1 \\<le> B\n\ngoal (1 subgoal):\n 1. B < Nf 1", "unfolding Nf_def"], ["proof (prove)\nusing this:\n  \\<not> N1 \\<le> B\n\ngoal (1 subgoal):\n 1. B < (if 1 = 0 then 0\n         else if 1 = 1 then N1 + 1\n              else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> 1}) + 1)", "by auto"], ["proof (state)\nthis:\n  B < Nf 1\n\ngoal (1 subgoal):\n 1. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "then"], ["proof (chain)\npicking this:\n  B < Nf 1", "have \"{n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B} = {}\""], ["proof (prove)\nusing this:\n  B < Nf 1\n\ngoal (1 subgoal):\n 1. {n \\<in> {Nf 1..}.\n     \\<exists>l\\<in>{1..n}.\n        u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n    {..<B} =\n    {}", "by auto"], ["proof (state)\nthis:\n  {n \\<in> {Nf 1..}.\n   \\<exists>l\\<in>{1..n}.\n      u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n  {..<B} =\n  {}\n\ngoal (1 subgoal):\n 1. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "then"], ["proof (chain)\npicking this:\n  {n \\<in> {Nf 1..}.\n   \\<exists>l\\<in>{1..n}.\n      u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n  {..<B} =\n  {}", "have \"card ({n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B}) = 0\""], ["proof (prove)\nusing this:\n  {n \\<in> {Nf 1..}.\n   \\<exists>l\\<in>{1..n}.\n      u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n  {..<B} =\n  {}\n\ngoal (1 subgoal):\n 1. card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}) =\n    0", "by auto"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf 1..}.\n     \\<exists>l\\<in>{1..n}.\n        u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n    {..<B}) =\n  0\n\ngoal (1 subgoal):\n 1. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "also"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf 1..}.\n     \\<exists>l\\<in>{1..n}.\n        u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n    {..<B}) =\n  0\n\ngoal (1 subgoal):\n 1. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "have \"... \\<le> (d2/2) * B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real 0 \\<le> d2 / 2 * real B", "using \\<open>\\<not> d2 < 0\\<close>"], ["proof (prove)\nusing this:\n  \\<not> d2 < 0\n\ngoal (1 subgoal):\n 1. real 0 \\<le> d2 / 2 * real B", "by simp"], ["proof (state)\nthis:\n  real 0 \\<le> d2 / 2 * real B\n\ngoal (1 subgoal):\n 1. \\<not> N1 \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "finally"], ["proof (chain)\npicking this:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}))\n  \\<le> d2 / 2 * real B", "show ?thesis"], ["proof (prove)\nusing this:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}))\n  \\<le> d2 / 2 * real B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}))\n    \\<le> d2 / 2 * real B", "by simp"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}))\n  \\<le> d2 / 2 * real B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<?B12}))\n  \\<le> d2 / 2 * real ?B12\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have BN: \"real(card ({n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})) \\<le> eps N * B\" if \"N \\<ge> 2\" for N B"], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "have \"x \\<in> On ((N-1) + 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> On (N - 1 + 1)", "using \\<open>x \\<in> Og\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> Og\n\ngoal (1 subgoal):\n 1. x \\<in> On (N - 1 + 1)", "unfolding Og_def Ogood_def"], ["proof (prove)\nusing this:\n  x \\<in> (\\<Inter>N. On (N + 1)) \\<inter>\n          {x \\<in> space M.\n           \\<forall>n\\<in>{1..Nf 1}.\n              \\<forall>l\\<in>{1..n}.\n                 - (real K * real l) < u n x - u (n - l) x}\n\ngoal (1 subgoal):\n 1. x \\<in> On (N - 1 + 1)", "by auto"], ["proof (state)\nthis:\n  x \\<in> On (N - 1 + 1)\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "then"], ["proof (chain)\npicking this:\n  x \\<in> On (N - 1 + 1)", "have \"x \\<in> On N\""], ["proof (prove)\nusing this:\n  x \\<in> On (N - 1 + 1)\n\ngoal (1 subgoal):\n 1. x \\<in> On N", "using \\<open>N\\<ge>2\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> On (N - 1 + 1)\n  2 \\<le> N\n\ngoal (1 subgoal):\n 1. x \\<in> On N", "by auto"], ["proof (state)\nthis:\n  x \\<in> On N\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "proof (cases \"B \\<ge> Nf N\")"], ["proof (state)\ngoal (2 subgoals):\n 1. Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B\n 2. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "case True"], ["proof (state)\nthis:\n  Nf N \\<le> B\n\ngoal (2 subgoals):\n 1. Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B\n 2. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "have \"card ({n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B}) \\<le>\n          card ({n. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B})\n    \\<le> card\n           ({n. \\<exists>l\\<in>{Nf N..n}.\n                   u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n            {..<B})", "by (rule card_mono, auto)"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf N..}.\n     \\<exists>l\\<in>{Nf N..n}.\n        u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<B})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{Nf N..n}.\n                 u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B})\n\ngoal (2 subgoals):\n 1. Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B\n 2. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "also"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf N..}.\n     \\<exists>l\\<in>{Nf N..n}.\n        u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<B})\n  \\<le> card\n         ({n. \\<exists>l\\<in>{Nf N..n}.\n                 u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B})\n\ngoal (2 subgoals):\n 1. Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B\n 2. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "have \"... \\<le> eps N * B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{Nf N..n}.\n               u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "using \\<open>x \\<in> On N\\<close> \\<open>N\\<ge>2\\<close> True"], ["proof (prove)\nusing this:\n  x \\<in> On N\n  2 \\<le> N\n  Nf N \\<le> B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{Nf N..n}.\n               u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "unfolding On_def"], ["proof (prove)\nusing this:\n  x \\<in> (if N = 1 then O1\n           else {x \\<in> space M.\n                 \\<forall>B\\<ge>Nf N.\n                    real\n                     (card\n                       ({n. \\<exists>l\\<in>{Nf N..n}.\n                               u n x - u (n - l) x\n                               \\<le> - eps N * real l} \\<inter>\n                        {..<B}))\n                    < eps N * real B})\n  2 \\<le> N\n  Nf N \\<le> B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n. \\<exists>l\\<in>{Nf N..n}.\n               u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     ({n. \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}))\n  \\<le> eps N * real B\n\ngoal (2 subgoals):\n 1. Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B\n 2. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}))\n  \\<le> eps N * real B", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}))\n  \\<le> eps N * real B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "by simp"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}))\n  \\<le> eps N * real B\n\ngoal (1 subgoal):\n 1. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "case False"], ["proof (state)\nthis:\n  \\<not> Nf N \\<le> B\n\ngoal (1 subgoal):\n 1. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "then"], ["proof (chain)\npicking this:\n  \\<not> Nf N \\<le> B", "have \"{n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B} = {}\""], ["proof (prove)\nusing this:\n  \\<not> Nf N \\<le> B\n\ngoal (1 subgoal):\n 1. {n \\<in> {Nf N..}.\n     \\<exists>l\\<in>{Nf N..n}.\n        u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<B} =\n    {}", "by auto"], ["proof (state)\nthis:\n  {n \\<in> {Nf N..}.\n   \\<exists>l\\<in>{Nf N..n}.\n      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n  {..<B} =\n  {}\n\ngoal (1 subgoal):\n 1. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "then"], ["proof (chain)\npicking this:\n  {n \\<in> {Nf N..}.\n   \\<exists>l\\<in>{Nf N..n}.\n      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n  {..<B} =\n  {}", "have \"card ({n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B}) = 0\""], ["proof (prove)\nusing this:\n  {n \\<in> {Nf N..}.\n   \\<exists>l\\<in>{Nf N..n}.\n      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n  {..<B} =\n  {}\n\ngoal (1 subgoal):\n 1. card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}) =\n    0", "by auto"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf N..}.\n     \\<exists>l\\<in>{Nf N..n}.\n        u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<B}) =\n  0\n\ngoal (1 subgoal):\n 1. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "also"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf N..}.\n     \\<exists>l\\<in>{Nf N..n}.\n        u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<B}) =\n  0\n\ngoal (1 subgoal):\n 1. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "have \"... \\<le> eps N * B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real 0 \\<le> eps N * real B", "by (metis \\<open>\\<And>n. 0 < eps n\\<close> le_less mult_eq_0_iff mult_pos_pos of_nat_0 of_nat_0_le_iff)"], ["proof (state)\nthis:\n  real 0 \\<le> eps N * real B\n\ngoal (1 subgoal):\n 1. \\<not> Nf N \\<le> B \\<Longrightarrow>\n    real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "finally"], ["proof (chain)\npicking this:\n  real\n   (card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}))\n  \\<le> eps N * real B", "show ?thesis"], ["proof (prove)\nusing this:\n  real\n   (card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}))\n  \\<le> eps N * real B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n    \\<le> eps N * real B", "by simp"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}))\n  \\<le> eps N * real B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}))\n  \\<le> eps N * real B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  2 \\<le> ?N12 \\<Longrightarrow>\n  real\n   (card\n     ({n \\<in> {Nf ?N12..}.\n       \\<exists>l\\<in>{Nf ?N12..n}.\n          u n x - u (n - l) x \\<le> - (eps ?N12 * real l)} \\<inter>\n      {..<?B12}))\n  \\<le> eps ?N12 * real ?B12\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "{"], ["proof (state)\nthis:\n  2 \\<le> ?N12 \\<Longrightarrow>\n  real\n   (card\n     ({n \\<in> {Nf ?N12..}.\n       \\<exists>l\\<in>{Nf ?N12..n}.\n          u n x - u (n - l) x \\<le> - (eps ?N12 * real l)} \\<inter>\n      {..<?B12}))\n  \\<le> eps ?N12 * real ?B12\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "fix N"], ["proof (state)\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "assume \"N \\<ge> B\""], ["proof (state)\nthis:\n  B \\<le> N\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"Nf N \\<ge> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<le> Nf N", "using seq_suble[OF \\<open>strict_mono Nf\\<close>, of N] \\<open>N \\<ge> B\\<close>"], ["proof (prove)\nusing this:\n  N \\<le> Nf N\n  B \\<le> N\n\ngoal (1 subgoal):\n 1. B \\<le> Nf N", "by simp"], ["proof (state)\nthis:\n  B \\<le> Nf N\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "then"], ["proof (chain)\npicking this:\n  B \\<le> Nf N", "have \"{Nf N..} \\<inter> {..<B} = {}\""], ["proof (prove)\nusing this:\n  B \\<le> Nf N\n\ngoal (1 subgoal):\n 1. {Nf N..} \\<inter> {..<B} = {}", "by auto"], ["proof (state)\nthis:\n  {Nf N..} \\<inter> {..<B} = {}\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "then"], ["proof (chain)\npicking this:\n  {Nf N..} \\<inter> {..<B} = {}", "have \"{n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B} = {}\""], ["proof (prove)\nusing this:\n  {Nf N..} \\<inter> {..<B} = {}\n\ngoal (1 subgoal):\n 1. {n \\<in> {Nf N..}.\n     \\<exists>l\\<in>{Nf N..n}.\n        u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n    {..<B} =\n    {}", "by auto"], ["proof (state)\nthis:\n  {n \\<in> {Nf N..}.\n   \\<exists>l\\<in>{Nf N..n}.\n      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n  {..<B} =\n  {}\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "}"], ["proof (state)\nthis:\n  B \\<le> ?N14 \\<Longrightarrow>\n  {n \\<in> {Nf ?N14..}.\n   \\<exists>l\\<in>{Nf ?N14..n}.\n      u n x - u (n - l) x \\<le> - (eps ?N14 * real l)} \\<inter>\n  {..<B} =\n  {}\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "then"], ["proof (chain)\npicking this:\n  B \\<le> ?N14 \\<Longrightarrow>\n  {n \\<in> {Nf ?N14..}.\n   \\<exists>l\\<in>{Nf ?N14..n}.\n      u n x - u (n - l) x \\<le> - (eps ?N14 * real l)} \\<inter>\n  {..<B} =\n  {}", "have *: \"(\\<Union>N\\<in>{B..}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B}) = {}\""], ["proof (prove)\nusing this:\n  B \\<le> ?N14 \\<Longrightarrow>\n  {n \\<in> {Nf ?N14..}.\n   \\<exists>l\\<in>{Nf ?N14..n}.\n      u n x - u (n - l) x \\<le> - (eps ?N14 * real l)} \\<inter>\n  {..<B} =\n  {}\n\ngoal (1 subgoal):\n 1. (\\<Union>N\\<in>{B..}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}) =\n    {}", "by auto"], ["proof (state)\nthis:\n  (\\<Union>N\\<in>{B..}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}) =\n  {}\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"{2..} \\<subseteq> {2..<B} \\<union> {B..}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {2..} \\<subseteq> {2..<B} \\<union> {B..}", "by auto"], ["proof (state)\nthis:\n  {2..} \\<subseteq> {2..<B} \\<union> {B..}\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "then"], ["proof (chain)\npicking this:\n  {2..} \\<subseteq> {2..<B} \\<union> {B..}", "have \"(\\<Union>N\\<in>{2..}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})\n      \\<subseteq> (\\<Union>N\\<in>{2..<B}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})\n        \\<union> (\\<Union>N\\<in>{B..}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})\""], ["proof (prove)\nusing this:\n  {2..} \\<subseteq> {2..<B} \\<union> {B..}\n\ngoal (1 subgoal):\n 1. (\\<Union>N\\<in>{2..}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B})\n    \\<subseteq> (\\<Union>N\\<in>{2..<B}.\n                    {n \\<in> {Nf N..}.\n                     \\<exists>l\\<in>{Nf N..n}.\n                        u n x - u (n - l) x\n                        \\<le> - (eps N * real l)} \\<inter>\n                    {..<B}) \\<union>\n                (\\<Union>N\\<in>{B..}.\n                    {n \\<in> {Nf N..}.\n                     \\<exists>l\\<in>{Nf N..n}.\n                        u n x - u (n - l) x\n                        \\<le> - (eps N * real l)} \\<inter>\n                    {..<B})", "by auto"], ["proof (state)\nthis:\n  (\\<Union>N\\<in>{2..}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B})\n  \\<subseteq> (\\<Union>N\\<in>{2..<B}.\n                  {n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B}) \\<union>\n              (\\<Union>N\\<in>{B..}.\n                  {n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  (\\<Union>N\\<in>{2..}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B})\n  \\<subseteq> (\\<Union>N\\<in>{2..<B}.\n                  {n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B}) \\<union>\n              (\\<Union>N\\<in>{B..}.\n                  {n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... = (\\<Union>N\\<in>{2..<B}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>N\\<in>{2..<B}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}) \\<union>\n    (\\<Union>N\\<in>{B..}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}) =\n    (\\<Union>N\\<in>{2..<B}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B})", "using *"], ["proof (prove)\nusing this:\n  (\\<Union>N\\<in>{B..}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}) =\n  {}\n\ngoal (1 subgoal):\n 1. (\\<Union>N\\<in>{2..<B}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}) \\<union>\n    (\\<Union>N\\<in>{B..}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}) =\n    (\\<Union>N\\<in>{2..<B}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B})", "by auto"], ["proof (state)\nthis:\n  (\\<Union>N\\<in>{2..<B}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}) \\<union>\n  (\\<Union>N\\<in>{B..}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B}) =\n  (\\<Union>N\\<in>{2..<B}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B})\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "finally"], ["proof (chain)\npicking this:\n  (\\<Union>N\\<in>{2..}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B})\n  \\<subseteq> (\\<Union>N\\<in>{2..<B}.\n                  {n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})", "have *: \"bad_times x \\<inter> {..<B} \\<subseteq> {n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B}\n            \\<union> (\\<Union>N\\<in>{2..<B}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})\""], ["proof (prove)\nusing this:\n  (\\<Union>N\\<in>{2..}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B})\n  \\<subseteq> (\\<Union>N\\<in>{2..<B}.\n                  {n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})\n\ngoal (1 subgoal):\n 1. bad_times x \\<inter> {..<B}\n    \\<subseteq> {n \\<in> {Nf 1..}.\n                 \\<exists>l\\<in>{1..n}.\n                    u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n                {..<B} \\<union>\n                (\\<Union>N\\<in>{2..<B}.\n                    {n \\<in> {Nf N..}.\n                     \\<exists>l\\<in>{Nf N..n}.\n                        u n x - u (n - l) x\n                        \\<le> - (eps N * real l)} \\<inter>\n                    {..<B})", "unfolding bad_times_def"], ["proof (prove)\nusing this:\n  (\\<Union>N\\<in>{2..}.\n      {n \\<in> {Nf N..}.\n       \\<exists>l\\<in>{Nf N..n}.\n          u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n      {..<B})\n  \\<subseteq> (\\<Union>N\\<in>{2..<B}.\n                  {n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})\n\ngoal (1 subgoal):\n 1. ({n \\<in> {Nf 1..}.\n      \\<exists>l\\<in>{1..n}.\n         u n x - u (n - l) x \\<le> - (c0 * real l)} \\<union>\n     (\\<Union>N\\<in>{2..}.\n         {n \\<in> {Nf N..}.\n          \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)})) \\<inter>\n    {..<B}\n    \\<subseteq> {n \\<in> {Nf 1..}.\n                 \\<exists>l\\<in>{1..n}.\n                    u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n                {..<B} \\<union>\n                (\\<Union>N\\<in>{2..<B}.\n                    {n \\<in> {Nf N..}.\n                     \\<exists>l\\<in>{Nf N..n}.\n                        u n x - u (n - l) x\n                        \\<le> - (eps N * real l)} \\<inter>\n                    {..<B})", "by auto"], ["proof (state)\nthis:\n  bad_times x \\<inter> {..<B}\n  \\<subseteq> {n \\<in> {Nf 1..}.\n               \\<exists>l\\<in>{1..n}.\n                  u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n              {..<B} \\<union>\n              (\\<Union>N\\<in>{2..<B}.\n                  {n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"card(bad_times x \\<inter> {..<B}) \\<le> card({n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B}\n        \\<union> (\\<Union>N\\<in>{2..<B}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (bad_times x \\<inter> {..<B})\n    \\<le> card\n           ({n \\<in> {Nf 1..}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n            {..<B} \\<union>\n            (\\<Union>N\\<in>{2..<B}.\n                {n \\<in> {Nf N..}.\n                 \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                {..<B}))", "by (rule card_mono[OF _ *], auto)"], ["proof (state)\nthis:\n  card (bad_times x \\<inter> {..<B})\n  \\<le> card\n         ({n \\<in> {Nf 1..}.\n           \\<exists>l\\<in>{1..n}.\n              u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B} \\<union>\n          (\\<Union>N\\<in>{2..<B}.\n              {n \\<in> {Nf N..}.\n               \\<exists>l\\<in>{Nf N..n}.\n                  u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n              {..<B}))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  card (bad_times x \\<inter> {..<B})\n  \\<le> card\n         ({n \\<in> {Nf 1..}.\n           \\<exists>l\\<in>{1..n}.\n              u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B} \\<union>\n          (\\<Union>N\\<in>{2..<B}.\n              {n \\<in> {Nf N..}.\n               \\<exists>l\\<in>{Nf N..n}.\n                  u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n              {..<B}))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... \\<le> card({n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B}) +\n      card (\\<Union>N\\<in>{2..<B}. {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B} \\<union>\n      (\\<Union>N\\<in>{2..<B}.\n          {n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B}))\n    \\<le> card\n           ({n \\<in> {Nf 1..}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n            {..<B}) +\n          card\n           (\\<Union>N\\<in>{2..<B}.\n               {n \\<in> {Nf N..}.\n                \\<exists>l\\<in>{Nf N..n}.\n                   u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n               {..<B})", "by (rule card_Un_le)"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf 1..}.\n     \\<exists>l\\<in>{1..n}.\n        u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n    {..<B} \\<union>\n    (\\<Union>N\\<in>{2..<B}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n  \\<le> card\n         ({n \\<in> {Nf 1..}.\n           \\<exists>l\\<in>{1..n}.\n              u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B}) +\n        card\n         (\\<Union>N\\<in>{2..<B}.\n             {n \\<in> {Nf N..}.\n              \\<exists>l\\<in>{Nf N..n}.\n                 u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n             {..<B})\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf 1..}.\n     \\<exists>l\\<in>{1..n}.\n        u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n    {..<B} \\<union>\n    (\\<Union>N\\<in>{2..<B}.\n        {n \\<in> {Nf N..}.\n         \\<exists>l\\<in>{Nf N..n}.\n            u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n        {..<B}))\n  \\<le> card\n         ({n \\<in> {Nf 1..}.\n           \\<exists>l\\<in>{1..n}.\n              u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B}) +\n        card\n         (\\<Union>N\\<in>{2..<B}.\n             {n \\<in> {Nf N..}.\n              \\<exists>l\\<in>{Nf N..n}.\n                 u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n             {..<B})\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... \\<le> card({n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B}) +\n      (\\<Sum> N\\<in>{2..<B}. card ({n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}) +\n    card\n     (\\<Union>N\\<in>{2..<B}.\n         {n \\<in> {Nf N..}.\n          \\<exists>l\\<in>{Nf N..n}.\n             u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n         {..<B})\n    \\<le> card\n           ({n \\<in> {Nf 1..}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n            {..<B}) +\n          (\\<Sum>N = 2..<B.\n              card\n               ({n \\<in> {Nf N..}.\n                 \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                {..<B}))", "by (simp del: UN_simps, rule card_UN_le, auto)"], ["proof (state)\nthis:\n  card\n   ({n \\<in> {Nf 1..}.\n     \\<exists>l\\<in>{1..n}.\n        u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n    {..<B}) +\n  card\n   (\\<Union>N\\<in>{2..<B}.\n       {n \\<in> {Nf N..}.\n        \\<exists>l\\<in>{Nf N..n}.\n           u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n       {..<B})\n  \\<le> card\n         ({n \\<in> {Nf 1..}.\n           \\<exists>l\\<in>{1..n}.\n              u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B}) +\n        (\\<Sum>N = 2..<B.\n            card\n             ({n \\<in> {Nf N..}.\n               \\<exists>l\\<in>{Nf N..n}.\n                  u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n              {..<B}))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "finally"], ["proof (chain)\npicking this:\n  card (bad_times x \\<inter> {..<B})\n  \\<le> card\n         ({n \\<in> {Nf 1..}.\n           \\<exists>l\\<in>{1..n}.\n              u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B}) +\n        (\\<Sum>N = 2..<B.\n            card\n             ({n \\<in> {Nf N..}.\n               \\<exists>l\\<in>{Nf N..n}.\n                  u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n              {..<B}))", "have \"real (card(bad_times x \\<inter> {..<B})) \\<le>\n      real(card({n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B})\n      + (\\<Sum> N\\<in>{2..<B}. card ({n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})))\""], ["proof (prove)\nusing this:\n  card (bad_times x \\<inter> {..<B})\n  \\<le> card\n         ({n \\<in> {Nf 1..}.\n           \\<exists>l\\<in>{1..n}.\n              u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n          {..<B}) +\n        (\\<Sum>N = 2..<B.\n            card\n             ({n \\<in> {Nf N..}.\n               \\<exists>l\\<in>{Nf N..n}.\n                  u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n              {..<B}))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B}))\n    \\<le> real\n           (card\n             ({n \\<in> {Nf 1..}.\n               \\<exists>l\\<in>{1..n}.\n                  u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n              {..<B}) +\n            (\\<Sum>N = 2..<B.\n                card\n                 ({n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})))", "by (subst of_nat_le_iff, simp)"], ["proof (state)\nthis:\n  real (card (bad_times x \\<inter> {..<B}))\n  \\<le> real\n         (card\n           ({n \\<in> {Nf 1..}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n            {..<B}) +\n          (\\<Sum>N = 2..<B.\n              card\n               ({n \\<in> {Nf N..}.\n                 \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                {..<B})))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  real (card (bad_times x \\<inter> {..<B}))\n  \\<le> real\n         (card\n           ({n \\<in> {Nf 1..}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n            {..<B}) +\n          (\\<Sum>N = 2..<B.\n              card\n               ({n \\<in> {Nf N..}.\n                 \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                {..<B})))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... = real(card({n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)} \\<inter> {..<B}))\n      + (\\<Sum> N\\<in>{2..<B}. real(card ({n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B}) +\n      (\\<Sum>N = 2..<B.\n          card\n           ({n \\<in> {Nf N..}.\n             \\<exists>l\\<in>{Nf N..n}.\n                u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n            {..<B}))) =\n    real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B})) +\n    (\\<Sum>N = 2..<B.\n        real\n         (card\n           ({n \\<in> {Nf N..}.\n             \\<exists>l\\<in>{Nf N..n}.\n                u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n            {..<B})))", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}) +\n    (\\<Sum>N = 2..<B.\n        card\n         ({n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B}))) =\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B})) +\n  (\\<Sum>N = 2..<B.\n      real\n       (card\n         ({n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B})))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B}) +\n    (\\<Sum>N = 2..<B.\n        card\n         ({n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B}))) =\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B})) +\n  (\\<Sum>N = 2..<B.\n      real\n       (card\n         ({n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B})))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... \\<le> (d2/2 * B) + (\\<Sum> N\\<in>{2..<B}. real(card ({n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)} \\<inter> {..<B})))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B})) +\n    (\\<Sum>N = 2..<B.\n        real\n         (card\n           ({n \\<in> {Nf N..}.\n             \\<exists>l\\<in>{Nf N..n}.\n                u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n            {..<B})))\n    \\<le> d2 / 2 * real B +\n          (\\<Sum>N = 2..<B.\n              real\n               (card\n                 ({n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})))", "using B1"], ["proof (prove)\nusing this:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<?B12}))\n  \\<le> d2 / 2 * real ?B12\n\ngoal (1 subgoal):\n 1. real\n     (card\n       ({n \\<in> {Nf 1..}.\n         \\<exists>l\\<in>{1..n}.\n            u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n        {..<B})) +\n    (\\<Sum>N = 2..<B.\n        real\n         (card\n           ({n \\<in> {Nf N..}.\n             \\<exists>l\\<in>{Nf N..n}.\n                u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n            {..<B})))\n    \\<le> d2 / 2 * real B +\n          (\\<Sum>N = 2..<B.\n              real\n               (card\n                 ({n \\<in> {Nf N..}.\n                   \\<exists>l\\<in>{Nf N..n}.\n                      u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                  {..<B})))", "by simp"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B})) +\n  (\\<Sum>N = 2..<B.\n      real\n       (card\n         ({n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B})))\n  \\<le> d2 / 2 * real B +\n        (\\<Sum>N = 2..<B.\n            real\n             (card\n               ({n \\<in> {Nf N..}.\n                 \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                {..<B})))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  real\n   (card\n     ({n \\<in> {Nf 1..}.\n       \\<exists>l\\<in>{1..n}.\n          u n x - u (n - l) x \\<le> - (c0 * real l)} \\<inter>\n      {..<B})) +\n  (\\<Sum>N = 2..<B.\n      real\n       (card\n         ({n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B})))\n  \\<le> d2 / 2 * real B +\n        (\\<Sum>N = 2..<B.\n            real\n             (card\n               ({n \\<in> {Nf N..}.\n                 \\<exists>l\\<in>{Nf N..n}.\n                    u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n                {..<B})))\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... \\<le> (d2/2 * B) + (\\<Sum> N \\<in> {2..<B}. eps N * B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d2 / 2 * real B +\n    (\\<Sum>N = 2..<B.\n        real\n         (card\n           ({n \\<in> {Nf N..}.\n             \\<exists>l\\<in>{Nf N..n}.\n                u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n            {..<B})))\n    \\<le> d2 / 2 * real B + (\\<Sum>N = 2..<B. eps N * real B)", "apply (simp, rule sum_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>N.\n       N \\<in> {2..<B} \\<Longrightarrow>\n       real\n        (card\n          ({n. Nf N \\<le> n \\<and>\n               (\\<exists>l\\<in>{Nf N..n}.\n                   u n x - u (n - l) x \\<le> - (eps N * real l))} \\<inter>\n           {..<B}))\n       \\<le> eps N * real B", "using BN"], ["proof (prove)\nusing this:\n  2 \\<le> ?N12 \\<Longrightarrow>\n  real\n   (card\n     ({n \\<in> {Nf ?N12..}.\n       \\<exists>l\\<in>{Nf ?N12..n}.\n          u n x - u (n - l) x \\<le> - (eps ?N12 * real l)} \\<inter>\n      {..<?B12}))\n  \\<le> eps ?N12 * real ?B12\n\ngoal (1 subgoal):\n 1. \\<And>N.\n       N \\<in> {2..<B} \\<Longrightarrow>\n       real\n        (card\n          ({n. Nf N \\<le> n \\<and>\n               (\\<exists>l\\<in>{Nf N..n}.\n                   u n x - u (n - l) x \\<le> - (eps N * real l))} \\<inter>\n           {..<B}))\n       \\<le> eps N * real B", "by auto"], ["proof (state)\nthis:\n  d2 / 2 * real B +\n  (\\<Sum>N = 2..<B.\n      real\n       (card\n         ({n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B})))\n  \\<le> d2 / 2 * real B + (\\<Sum>N = 2..<B. eps N * real B)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "also"], ["proof (state)\nthis:\n  d2 / 2 * real B +\n  (\\<Sum>N = 2..<B.\n      real\n       (card\n         ({n \\<in> {Nf N..}.\n           \\<exists>l\\<in>{Nf N..n}.\n              u n x - u (n - l) x \\<le> - (eps N * real l)} \\<inter>\n          {..<B})))\n  \\<le> d2 / 2 * real B + (\\<Sum>N = 2..<B. eps N * real B)\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "have \"... \\<le> (d2/2 * B) + (d2/2*B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d2 / 2 * real B + (\\<Sum>N = 2..<B. eps N * real B)\n    \\<le> d2 / 2 * real B + d2 / 2 * real B", "using I"], ["proof (prove)\nusing this:\n  (\\<Sum>N = 2..<B. eps N * real B) \\<le> d2 / 2 * real B\n\ngoal (1 subgoal):\n 1. d2 / 2 * real B + (\\<Sum>N = 2..<B. eps N * real B)\n    \\<le> d2 / 2 * real B + d2 / 2 * real B", "by auto"], ["proof (state)\nthis:\n  d2 / 2 * real B + (\\<Sum>N = 2..<B. eps N * real B)\n  \\<le> d2 / 2 * real B + d2 / 2 * real B\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "finally"], ["proof (chain)\npicking this:\n  real (card (bad_times x \\<inter> {..<B}))\n  \\<le> d2 / 2 * real B + d2 / 2 * real B", "show ?thesis"], ["proof (prove)\nusing this:\n  real (card (bad_times x \\<inter> {..<B}))\n  \\<le> d2 / 2 * real B + d2 / 2 * real B\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "by simp"], ["proof (state)\nthis:\n  real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x12 \\<in> Og \\<Longrightarrow>\n  real (card (bad_times ?x12 \\<inter> {..<?B12})) \\<le> d2 * real ?B12\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have ineq_on_Og: \"u n x - u (n-l) x > - delta l * l\" if \"l \\<in> {1..n}\" \"n \\<notin> bad_times x\" \"x \\<in> Og\" for n x l"], ["proof (prove)\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "consider \"n < Nf 1\" | \"n \\<ge> Nf 1 \\<and> prev_N l \\<le> 1\" | \"n \\<ge> Nf 1 \\<and> prev_N l \\<ge> 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>n < Nf 1 \\<Longrightarrow> thesis;\n     Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow> thesis;\n     Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by linarith"], ["proof (state)\nthis:\n  \\<lbrakk>n < Nf 1 \\<Longrightarrow> ?thesis12;\n   Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow> ?thesis12;\n   Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>n < Nf 1 \\<Longrightarrow> ?thesis12;\n   Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow> ?thesis12;\n   Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>n < Nf 1 \\<Longrightarrow> ?thesis12;\n   Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow> ?thesis12;\n   Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow> ?thesis12\\<rbrakk>\n  \\<Longrightarrow> ?thesis12\n\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "proof (cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "assume \"n < Nf 1\""], ["proof (state)\nthis:\n  n < Nf 1\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  n < Nf 1", "have \"{N. Nf N \\<le> n} = {0}\""], ["proof (prove)\nusing this:\n  n < Nf 1\n\ngoal (1 subgoal):\n 1. {N. Nf N \\<le> n} = {0}", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>n < Nf (Suc 0); Nf x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x = 0\n 2. n < Nf (Suc 0) \\<Longrightarrow> Nf 0 \\<le> n", "using \\<open>strict_mono Nf\\<close>"], ["proof (prove)\nusing this:\n  strict_mono Nf\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>n < Nf (Suc 0); Nf x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x = 0\n 2. n < Nf (Suc 0) \\<Longrightarrow> Nf 0 \\<le> n", "unfolding strict_mono_def"], ["proof (prove)\nusing this:\n  \\<forall>x y. x < y \\<longrightarrow> Nf x < Nf y\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>n < Nf (Suc 0); Nf x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x = 0\n 2. n < Nf (Suc 0) \\<Longrightarrow> Nf 0 \\<le> n", "apply (metis le_trans less_Suc0 less_imp_le_nat linorder_neqE_nat not_less)"], ["proof (prove)\ngoal (1 subgoal):\n 1. n < Nf (Suc 0) \\<Longrightarrow> Nf 0 \\<le> n", "unfolding Nf_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. n < (if Suc 0 = 0 then 0\n         else if Suc 0 = 1 then N1 + 1\n              else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> Suc 0}) +\n                   Suc 0) \\<Longrightarrow>\n    (if 0 = 0 then 0\n     else if 0 = 1 then N1 + 1\n          else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> 0}) + 0)\n    \\<le> n", "by auto"], ["proof (state)\nthis:\n  {N. Nf N \\<le> n} = {0}\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  {N. Nf N \\<le> n} = {0}", "have \"prev_N n = 0\""], ["proof (prove)\nusing this:\n  {N. Nf N \\<le> n} = {0}\n\ngoal (1 subgoal):\n 1. prev_N n = 0", "unfolding prev_N_def"], ["proof (prove)\nusing this:\n  {N. Nf N \\<le> n} = {0}\n\ngoal (1 subgoal):\n 1. Max {N. Nf N \\<le> n} = 0", "by auto"], ["proof (state)\nthis:\n  prev_N n = 0\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "moreover"], ["proof (state)\nthis:\n  prev_N n = 0\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"prev_N l \\<le> prev_N n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prev_N l \\<le> prev_N n", "unfolding prev_N_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {N. Nf N \\<le> l} \\<le> Max {N. Nf N \\<le> n}", "apply (rule Max_mono)"], ["proof (prove)\ngoal (3 subgoals):\n 1. {N. Nf N \\<le> l} \\<subseteq> {N. Nf N \\<le> n}\n 2. {N. Nf N \\<le> l} \\<noteq> {}\n 3. finite {N. Nf N \\<le> n}", "using \\<open>l \\<in> {1..n}\\<close> fin"], ["proof (prove)\nusing this:\n  l \\<in> {1..n}\n  finite {N. Nf N \\<le> ?n12}\n\ngoal (3 subgoals):\n 1. {N. Nf N \\<le> l} \\<subseteq> {N. Nf N \\<le> n}\n 2. {N. Nf N \\<le> l} \\<noteq> {}\n 3. finite {N. Nf N \\<le> n}", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>n. finite {N. Nf N \\<le> n}; Suc 0 \\<le> l;\n     l \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. Nf x \\<le> l", "unfolding Nf_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>n.\n                finite\n                 {N. (if N = 0 then 0\n                      else if N = 1 then N1 + 1\n                           else max (N1 + 1)\n                                 (Max {Ne (eps n) |n. n \\<le> N}) +\n                                N)\n                     \\<le> n};\n     Suc 0 \\<le> l; l \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         (if x = 0 then 0\n                          else if x = 1 then N1 + 1\n                               else max (N1 + 1)\n                                     (Max {Ne (eps n) |n. n \\<le> x}) +\n                                    x)\n                         \\<le> l", "by auto"], ["proof (state)\nthis:\n  prev_N l \\<le> prev_N n\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "ultimately"], ["proof (chain)\npicking this:\n  prev_N n = 0\n  prev_N l \\<le> prev_N n", "have \"prev_N l = 0\""], ["proof (prove)\nusing this:\n  prev_N n = 0\n  prev_N l \\<le> prev_N n\n\ngoal (1 subgoal):\n 1. prev_N l = 0", "using \\<open>prev_N l \\<le> prev_N n\\<close>"], ["proof (prove)\nusing this:\n  prev_N n = 0\n  prev_N l \\<le> prev_N n\n  prev_N l \\<le> prev_N n\n\ngoal (1 subgoal):\n 1. prev_N l = 0", "by auto"], ["proof (state)\nthis:\n  prev_N l = 0\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  prev_N l = 0", "have \"delta l = K\""], ["proof (prove)\nusing this:\n  prev_N l = 0\n\ngoal (1 subgoal):\n 1. delta l = real K", "unfolding delta_def"], ["proof (prove)\nusing this:\n  prev_N l = 0\n\ngoal (1 subgoal):\n 1. (if prev_N l \\<le> 1 then real K else eps (prev_N l)) = real K", "by auto"], ["proof (state)\nthis:\n  delta l = real K\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"1 \\<notin> {N. Nf N \\<le> n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<notin> {N. Nf N \\<le> n}", "using fin[of n]"], ["proof (prove)\nusing this:\n  finite {N. Nf N \\<le> n}\n\ngoal (1 subgoal):\n 1. 1 \\<notin> {N. Nf N \\<le> n}", "by (metis (full_types) Max_ge \\<open>prev_N n = 0\\<close> fin not_one_le_zero prev_N_def)"], ["proof (state)\nthis:\n  1 \\<notin> {N. Nf N \\<le> n}\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  1 \\<notin> {N. Nf N \\<le> n}", "have \"n < Nf 1\""], ["proof (prove)\nusing this:\n  1 \\<notin> {N. Nf N \\<le> n}\n\ngoal (1 subgoal):\n 1. n < Nf 1", "by auto"], ["proof (state)\nthis:\n  n < Nf 1\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "moreover"], ["proof (state)\nthis:\n  n < Nf 1\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"n \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> n", "using \\<open>l \\<in> {1..n}\\<close>"], ["proof (prove)\nusing this:\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. 1 \\<le> n", "by auto"], ["proof (state)\nthis:\n  1 \\<le> n\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "ultimately"], ["proof (chain)\npicking this:\n  n < Nf 1\n  1 \\<le> n", "have \"n \\<in> {1..Nf 1}\""], ["proof (prove)\nusing this:\n  n < Nf 1\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. n \\<in> {1..Nf 1}", "by auto"], ["proof (state)\nthis:\n  n \\<in> {1..Nf 1}\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  n \\<in> {1..Nf 1}", "have \"u n x - u (n-l) x > - (real K * l)\""], ["proof (prove)\nusing this:\n  n \\<in> {1..Nf 1}\n\ngoal (1 subgoal):\n 1. - (real K * real l) < u n x - u (n - l) x", "using \\<open>x \\<in> Og\\<close>"], ["proof (prove)\nusing this:\n  n \\<in> {1..Nf 1}\n  x \\<in> Og\n\ngoal (1 subgoal):\n 1. - (real K * real l) < u n x - u (n - l) x", "unfolding Og_def"], ["proof (prove)\nusing this:\n  n \\<in> {1..Nf 1}\n  x \\<in> Ogood \\<inter>\n          {x \\<in> space M.\n           \\<forall>n\\<in>{1..Nf 1}.\n              \\<forall>l\\<in>{1..n}.\n                 - (real K * real l) < u n x - u (n - l) x}\n\ngoal (1 subgoal):\n 1. - (real K * real l) < u n x - u (n - l) x", "using \\<open>l \\<in> {1..n}\\<close>"], ["proof (prove)\nusing this:\n  n \\<in> {1..Nf 1}\n  x \\<in> Ogood \\<inter>\n          {x \\<in> space M.\n           \\<forall>n\\<in>{1..Nf 1}.\n              \\<forall>l\\<in>{1..n}.\n                 - (real K * real l) < u n x - u (n - l) x}\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. - (real K * real l) < u n x - u (n - l) x", "by auto"], ["proof (state)\nthis:\n  - (real K * real l) < u n x - u (n - l) x\n\ngoal (3 subgoals):\n 1. n < Nf 1 \\<Longrightarrow> - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 3. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  - (real K * real l) < u n x - u (n - l) x", "show ?thesis"], ["proof (prove)\nusing this:\n  - (real K * real l) < u n x - u (n - l) x\n\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "using \\<open>delta l = K\\<close>"], ["proof (prove)\nusing this:\n  - (real K * real l) < u n x - u (n - l) x\n  delta l = real K\n\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "by auto"], ["proof (state)\nthis:\n  - delta l * real l < u n x - u (n - l) x\n\ngoal (2 subgoals):\n 1. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "assume H: \"n \\<ge> Nf 1 \\<and> prev_N l \\<le> 1\""], ["proof (state)\nthis:\n  Nf 1 \\<le> n \\<and> prev_N l \\<le> 1\n\ngoal (2 subgoals):\n 1. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  Nf 1 \\<le> n \\<and> prev_N l \\<le> 1", "have \"delta l = K\""], ["proof (prove)\nusing this:\n  Nf 1 \\<le> n \\<and> prev_N l \\<le> 1\n\ngoal (1 subgoal):\n 1. delta l = real K", "unfolding delta_def"], ["proof (prove)\nusing this:\n  Nf 1 \\<le> n \\<and> prev_N l \\<le> 1\n\ngoal (1 subgoal):\n 1. (if prev_N l \\<le> 1 then real K else eps (prev_N l)) = real K", "by auto"], ["proof (state)\nthis:\n  delta l = real K\n\ngoal (2 subgoals):\n 1. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"n \\<notin> {n \\<in> {Nf 1..}. \\<exists>l\\<in>{1..n}. u n x - u (n-l) x \\<le> - (c0 * l)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<notin> {n \\<in> {Nf 1..}.\n                \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - (c0 * real l)}", "using \\<open>n \\<notin> bad_times x\\<close>"], ["proof (prove)\nusing this:\n  n \\<notin> bad_times x\n\ngoal (1 subgoal):\n 1. n \\<notin> {n \\<in> {Nf 1..}.\n                \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - (c0 * real l)}", "unfolding bad_times_def"], ["proof (prove)\nusing this:\n  n \\<notin> {n \\<in> {Nf 1..}.\n              \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - (c0 * real l)} \\<union>\n             (\\<Union>N\\<in>{2..}.\n                 {n \\<in> {Nf N..}.\n                  \\<exists>l\\<in>{Nf N..n}.\n                     u n x - u (n - l) x \\<le> - (eps N * real l)})\n\ngoal (1 subgoal):\n 1. n \\<notin> {n \\<in> {Nf 1..}.\n                \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - (c0 * real l)}", "by auto"], ["proof (state)\nthis:\n  n \\<notin> {n \\<in> {Nf 1..}.\n              \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - (c0 * real l)}\n\ngoal (2 subgoals):\n 1. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  n \\<notin> {n \\<in> {Nf 1..}.\n              \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - (c0 * real l)}", "have \"u n x - u (n-l) x > - (c0 * l)\""], ["proof (prove)\nusing this:\n  n \\<notin> {n \\<in> {Nf 1..}.\n              \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - (c0 * real l)}\n\ngoal (1 subgoal):\n 1. - (c0 * real l) < u n x - u (n - l) x", "using H \\<open>l \\<in> {1..n}\\<close>"], ["proof (prove)\nusing this:\n  n \\<notin> {n \\<in> {Nf 1..}.\n              \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - (c0 * real l)}\n  Nf 1 \\<le> n \\<and> prev_N l \\<le> 1\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. - (c0 * real l) < u n x - u (n - l) x", "by force"], ["proof (state)\nthis:\n  - (c0 * real l) < u n x - u (n - l) x\n\ngoal (2 subgoals):\n 1. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "moreover"], ["proof (state)\nthis:\n  - (c0 * real l) < u n x - u (n - l) x\n\ngoal (2 subgoals):\n 1. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"- (c0 * l) \\<ge> - (real K * l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - (real K * real l) \\<le> - (c0 * real l)", "using K(1)"], ["proof (prove)\nusing this:\n  max c0 d2 \\<le> real K\n\ngoal (1 subgoal):\n 1. - (real K * real l) \\<le> - (c0 * real l)", "by (simp add: mult_mono)"], ["proof (state)\nthis:\n  - (real K * real l) \\<le> - (c0 * real l)\n\ngoal (2 subgoals):\n 1. Nf 1 \\<le> n \\<and> prev_N l \\<le> 1 \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x\n 2. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "ultimately"], ["proof (chain)\npicking this:\n  - (c0 * real l) < u n x - u (n - l) x\n  - (real K * real l) \\<le> - (c0 * real l)", "show ?thesis"], ["proof (prove)\nusing this:\n  - (c0 * real l) < u n x - u (n - l) x\n  - (real K * real l) \\<le> - (c0 * real l)\n\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "using \\<open>delta l = K\\<close>"], ["proof (prove)\nusing this:\n  - (c0 * real l) < u n x - u (n - l) x\n  - (real K * real l) \\<le> - (c0 * real l)\n  delta l = real K\n\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "by auto"], ["proof (state)\nthis:\n  - delta l * real l < u n x - u (n - l) x\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "assume H: \"n \\<ge> Nf 1 \\<and> prev_N l \\<ge> 2\""], ["proof (state)\nthis:\n  Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "define N where \"N = prev_N l\""], ["proof (state)\nthis:\n  N = prev_N l\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"N \\<ge> 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<le> N", "unfolding N_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<le> prev_N l", "using H"], ["proof (prove)\nusing this:\n  Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l\n\ngoal (1 subgoal):\n 1. 2 \\<le> prev_N l", "by auto"], ["proof (state)\nthis:\n  2 \\<le> N\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"prev_N l \\<in> {N. Nf N \\<le> l}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prev_N l \\<in> {N. Nf N \\<le> l}", "unfolding prev_N_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. Max {N. Nf N \\<le> l} \\<in> {N. Nf N \\<le> l}", "apply (rule Max_in, auto simp add: fin)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x. Nf x \\<le> l", "unfolding Nf_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x.\n       (if x = 0 then 0\n        else if x = 1 then N1 + 1\n             else max (N1 + 1) (Max {Ne (eps n) |n. n \\<le> x}) + x)\n       \\<le> l", "by auto"], ["proof (state)\nthis:\n  prev_N l \\<in> {N. Nf N \\<le> l}\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  prev_N l \\<in> {N. Nf N \\<le> l}", "have \"Nf N \\<le> l\""], ["proof (prove)\nusing this:\n  prev_N l \\<in> {N. Nf N \\<le> l}\n\ngoal (1 subgoal):\n 1. Nf N \\<le> l", "unfolding N_def"], ["proof (prove)\nusing this:\n  prev_N l \\<in> {N. Nf N \\<le> l}\n\ngoal (1 subgoal):\n 1. Nf (prev_N l) \\<le> l", "by auto"], ["proof (state)\nthis:\n  Nf N \\<le> l\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  Nf N \\<le> l", "have \"Nf N \\<le> n\""], ["proof (prove)\nusing this:\n  Nf N \\<le> l\n\ngoal (1 subgoal):\n 1. Nf N \\<le> n", "using \\<open>l \\<in> {1..n}\\<close>"], ["proof (prove)\nusing this:\n  Nf N \\<le> l\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. Nf N \\<le> n", "by auto"], ["proof (state)\nthis:\n  Nf N \\<le> n\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"n \\<notin> {n \\<in> {Nf N..}. \\<exists>l \\<in> {Nf N..n}. u n x - u (n-l) x \\<le> - (eps N * l)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<notin> {n \\<in> {Nf N..}.\n                \\<exists>l\\<in>{Nf N..n}.\n                   u n x - u (n - l) x \\<le> - (eps N * real l)}", "using \\<open>n \\<notin> bad_times x\\<close> \\<open>N\\<ge>2\\<close>"], ["proof (prove)\nusing this:\n  n \\<notin> bad_times x\n  2 \\<le> N\n\ngoal (1 subgoal):\n 1. n \\<notin> {n \\<in> {Nf N..}.\n                \\<exists>l\\<in>{Nf N..n}.\n                   u n x - u (n - l) x \\<le> - (eps N * real l)}", "unfolding bad_times_def"], ["proof (prove)\nusing this:\n  n \\<notin> {n \\<in> {Nf 1..}.\n              \\<exists>l\\<in>{1..n}.\n                 u n x - u (n - l) x \\<le> - (c0 * real l)} \\<union>\n             (\\<Union>N\\<in>{2..}.\n                 {n \\<in> {Nf N..}.\n                  \\<exists>l\\<in>{Nf N..n}.\n                     u n x - u (n - l) x \\<le> - (eps N * real l)})\n  2 \\<le> N\n\ngoal (1 subgoal):\n 1. n \\<notin> {n \\<in> {Nf N..}.\n                \\<exists>l\\<in>{Nf N..n}.\n                   u n x - u (n - l) x \\<le> - (eps N * real l)}", "by auto"], ["proof (state)\nthis:\n  n \\<notin> {n \\<in> {Nf N..}.\n              \\<exists>l\\<in>{Nf N..n}.\n                 u n x - u (n - l) x \\<le> - (eps N * real l)}\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "then"], ["proof (chain)\npicking this:\n  n \\<notin> {n \\<in> {Nf N..}.\n              \\<exists>l\\<in>{Nf N..n}.\n                 u n x - u (n - l) x \\<le> - (eps N * real l)}", "have \"u n x - u (n-l) x > - (eps N * l)\""], ["proof (prove)\nusing this:\n  n \\<notin> {n \\<in> {Nf N..}.\n              \\<exists>l\\<in>{Nf N..n}.\n                 u n x - u (n - l) x \\<le> - (eps N * real l)}\n\ngoal (1 subgoal):\n 1. - (eps N * real l) < u n x - u (n - l) x", "using \\<open>Nf N \\<le> n\\<close> \\<open>Nf N \\<le> l\\<close> \\<open>l \\<in> {1..n}\\<close>"], ["proof (prove)\nusing this:\n  n \\<notin> {n \\<in> {Nf N..}.\n              \\<exists>l\\<in>{Nf N..n}.\n                 u n x - u (n - l) x \\<le> - (eps N * real l)}\n  Nf N \\<le> n\n  Nf N \\<le> l\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. - (eps N * real l) < u n x - u (n - l) x", "by force"], ["proof (state)\nthis:\n  - (eps N * real l) < u n x - u (n - l) x\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "moreover"], ["proof (state)\nthis:\n  - (eps N * real l) < u n x - u (n - l) x\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "have \"eps N = delta l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eps N = delta l", "unfolding delta_def N_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. eps (prev_N l) = (if prev_N l \\<le> 1 then real K else eps (prev_N l))", "using H"], ["proof (prove)\nusing this:\n  Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l\n\ngoal (1 subgoal):\n 1. eps (prev_N l) = (if prev_N l \\<le> 1 then real K else eps (prev_N l))", "by auto"], ["proof (state)\nthis:\n  eps N = delta l\n\ngoal (1 subgoal):\n 1. Nf 1 \\<le> n \\<and> 2 \\<le> prev_N l \\<Longrightarrow>\n    - delta l * real l < u n x - u (n - l) x", "ultimately"], ["proof (chain)\npicking this:\n  - (eps N * real l) < u n x - u (n - l) x\n  eps N = delta l", "show ?thesis"], ["proof (prove)\nusing this:\n  - (eps N * real l) < u n x - u (n - l) x\n  eps N = delta l\n\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) x", "by auto"], ["proof (state)\nthis:\n  - delta l * real l < u n x - u (n - l) x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  - delta l * real l < u n x - u (n - l) x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?l12 \\<in> {1..?n12}; ?n12 \\<notin> bad_times ?x12;\n   ?x12 \\<in> Og\\<rbrakk>\n  \\<Longrightarrow> - delta ?l12 * real ?l12\n                    < u ?n12 ?x12 - u (?n12 - ?l12) ?x12\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "have \"Og \\<subseteq> {x \\<in> space M. \\<forall>(B::nat). card {n \\<in>{..<B}. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - delta l * l} \\<le> d * B}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Og \\<subseteq> {x \\<in> space M.\n                    \\<forall>B.\n                       real\n                        (card\n                          {n \\<in> {..<B}.\n                           \\<exists>l\\<in>{1..n}.\n                              u n x - u (n - l) x \\<le> - delta l * real l})\n                       \\<le> d * real B}", "proof (auto)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> Og \\<Longrightarrow> x \\<in> space M\n 2. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> Og \\<Longrightarrow> x \\<in> space M\n 2. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "assume \"x \\<in> Og\""], ["proof (state)\nthis:\n  x \\<in> Og\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> Og \\<Longrightarrow> x \\<in> space M\n 2. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "then"], ["proof (chain)\npicking this:\n  x \\<in> Og", "show \"x \\<in> space M\""], ["proof (prove)\nusing this:\n  x \\<in> Og\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "unfolding Og_def"], ["proof (prove)\nusing this:\n  x \\<in> Ogood \\<inter>\n          {x \\<in> space M.\n           \\<forall>n\\<in>{1..Nf 1}.\n              \\<forall>l\\<in>{1..n}.\n                 - (real K * real l) < u n x - u (n - l) x}\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "by auto"], ["proof (state)\nthis:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "fix x B"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "assume \"x \\<in> Og\""], ["proof (state)\nthis:\n  x \\<in> Og\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "have *: \"{n. n < B \\<and> (\\<exists>l\\<in>{Suc 0..n}. u n x - u (n - l) x \\<le> - (delta l * real l))} \\<subseteq> bad_times x \\<inter> {..<B}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. n < B \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n x - u (n - l) x \\<le> - (delta l * real l))}\n    \\<subseteq> bad_times x \\<inter> {..<B}", "using ineq_on_Og \\<open>x\\<in>Og\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>?l12 \\<in> {1..?n12}; ?n12 \\<notin> bad_times ?x12;\n   ?x12 \\<in> Og\\<rbrakk>\n  \\<Longrightarrow> - delta ?l12 * real ?l12\n                    < u ?n12 ?x12 - u (?n12 - ?l12) ?x12\n  x \\<in> Og\n\ngoal (1 subgoal):\n 1. {n. n < B \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n x - u (n - l) x \\<le> - (delta l * real l))}\n    \\<subseteq> bad_times x \\<inter> {..<B}", "by force"], ["proof (state)\nthis:\n  {n. n < B \\<and>\n      (\\<exists>l\\<in>{Suc 0..n}.\n          u n x - u (n - l) x \\<le> - (delta l * real l))}\n  \\<subseteq> bad_times x \\<inter> {..<B}\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "have \"card {n. n < B \\<and> (\\<exists>l\\<in>{Suc 0..n}. u n x - u (n - l) x \\<le> - (delta l * real l))} \\<le> card (bad_times x \\<inter> {..<B})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card\n     {n. n < B \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n x - u (n - l) x \\<le> - (delta l * real l))}\n    \\<le> card (bad_times x \\<inter> {..<B})", "apply (rule card_mono, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. n < B \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n x - u (n - l) x \\<le> - (delta l * real l))}\n    \\<subseteq> bad_times x \\<inter> {..<B}", "using *"], ["proof (prove)\nusing this:\n  {n. n < B \\<and>\n      (\\<exists>l\\<in>{Suc 0..n}.\n          u n x - u (n - l) x \\<le> - (delta l * real l))}\n  \\<subseteq> bad_times x \\<inter> {..<B}\n\ngoal (1 subgoal):\n 1. {n. n < B \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n x - u (n - l) x \\<le> - (delta l * real l))}\n    \\<subseteq> bad_times x \\<inter> {..<B}", "by auto"], ["proof (state)\nthis:\n  card\n   {n. n < B \\<and>\n       (\\<exists>l\\<in>{Suc 0..n}.\n           u n x - u (n - l) x \\<le> - (delta l * real l))}\n  \\<le> card (bad_times x \\<inter> {..<B})\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "also"], ["proof (state)\nthis:\n  card\n   {n. n < B \\<and>\n       (\\<exists>l\\<in>{Suc 0..n}.\n           u n x - u (n - l) x \\<le> - (delta l * real l))}\n  \\<le> card (bad_times x \\<inter> {..<B})\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "have \"... \\<le> d2 * B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "using card_bad_times \\<open>x \\<in> Og\\<close>"], ["proof (prove)\nusing this:\n  ?x12 \\<in> Og \\<Longrightarrow>\n  real (card (bad_times ?x12 \\<inter> {..<?B12})) \\<le> d2 * real ?B12\n  x \\<in> Og\n\ngoal (1 subgoal):\n 1. real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B", "by auto"], ["proof (state)\nthis:\n  real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "also"], ["proof (state)\nthis:\n  real (card (bad_times x \\<inter> {..<B})) \\<le> d2 * real B\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "have \"... \\<le> d * B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d2 * real B \\<le> d * real B", "unfolding d2_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. d / 2 * real B \\<le> d * real B", "using \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  0 < d\n\ngoal (1 subgoal):\n 1. d / 2 * real B \\<le> d * real B", "by auto"], ["proof (state)\nthis:\n  d2 * real B \\<le> d * real B\n\ngoal (1 subgoal):\n 1. \\<And>x B.\n       x \\<in> Og \\<Longrightarrow>\n       real\n        (card\n          {n. n < B \\<and>\n              (\\<exists>l\\<in>{Suc 0..n}.\n                  u n x - u (n - l) x \\<le> - (delta l * real l))})\n       \\<le> d * real B", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     {n. n < B \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n x - u (n - l) x \\<le> - (delta l * real l))})\n  \\<le> d * real B", "show \"card {n. n < B \\<and> (\\<exists>l\\<in>{Suc 0..n}. u n x - u (n - l) x \\<le> - (delta l * real l))} \\<le> d * B\""], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> real x \\<le> real y) \\<Longrightarrow>\n  real\n   (card\n     {n. n < B \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n x - u (n - l) x \\<le> - (delta l * real l))})\n  \\<le> d * real B\n\ngoal (1 subgoal):\n 1. real\n     (card\n       {n. n < B \\<and>\n           (\\<exists>l\\<in>{Suc 0..n}.\n               u n x - u (n - l) x \\<le> - (delta l * real l))})\n    \\<le> d * real B", "by simp"], ["proof (state)\nthis:\n  real\n   (card\n     {n. n < B \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n x - u (n - l) x \\<le> - (delta l * real l))})\n  \\<le> d * real B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Og \\<subseteq> {x \\<in> space M.\n                  \\<forall>B.\n                     real\n                      (card\n                        {n \\<in> {..<B}.\n                         \\<exists>l\\<in>{1..n}.\n                            u n x - u (n - l) x \\<le> - delta l * real l})\n                     \\<le> d * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  Og \\<subseteq> {x \\<in> space M.\n                  \\<forall>B.\n                     real\n                      (card\n                        {n \\<in> {..<B}.\n                         \\<exists>l\\<in>{1..n}.\n                            u n x - u (n - l) x \\<le> - delta l * real l})\n                     \\<le> d * real B}", "have \"emeasure M Og \\<le> emeasure M {x \\<in> space M. \\<forall>(B::nat). card {n \\<in>{..<B}. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - delta l * l} \\<le> d * B}\""], ["proof (prove)\nusing this:\n  Og \\<subseteq> {x \\<in> space M.\n                  \\<forall>B.\n                     real\n                      (card\n                        {n \\<in> {..<B}.\n                         \\<exists>l\\<in>{1..n}.\n                            u n x - u (n - l) x \\<le> - delta l * real l})\n                     \\<le> d * real B}\n\ngoal (1 subgoal):\n 1. emeasure M Og\n    \\<le> emeasure M\n           {x \\<in> space M.\n            \\<forall>B.\n               real\n                (card\n                  {n \\<in> {..<B}.\n                   \\<exists>l\\<in>{1..n}.\n                      u n x - u (n - l) x \\<le> - delta l * real l})\n               \\<le> d * real B}", "by (rule emeasure_mono, auto)"], ["proof (state)\nthis:\n  emeasure M Og\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B.\n             real\n              (card\n                {n \\<in> {..<B}.\n                 \\<exists>l\\<in>{1..n}.\n                    u n x - u (n - l) x \\<le> - delta l * real l})\n             \\<le> d * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  emeasure M Og\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B.\n             real\n              (card\n                {n \\<in> {..<B}.\n                 \\<exists>l\\<in>{1..n}.\n                    u n x - u (n - l) x \\<le> - delta l * real l})\n             \\<le> d * real B}", "have \"emeasure M {x \\<in> space M. \\<forall>(B::nat). card {n \\<in>{..<B}. \\<exists>l \\<in> {1..n}. u n x - u (n-l) x \\<le> - delta l * l} \\<le> d * B} > 1-d\""], ["proof (prove)\nusing this:\n  emeasure M Og\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B.\n             real\n              (card\n                {n \\<in> {..<B}.\n                 \\<exists>l\\<in>{1..n}.\n                    u n x - u (n - l) x \\<le> - delta l * real l})\n             \\<le> d * real B}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B.\n           real\n            (card\n              {n \\<in> {..<B}.\n               \\<exists>l\\<in>{1..n}.\n                  u n x - u (n - l) x \\<le> - delta l * real l})\n           \\<le> d * real B}", "using \\<open>emeasure M Og > 1 - d\\<close>"], ["proof (prove)\nusing this:\n  emeasure M Og\n  \\<le> emeasure M\n         {x \\<in> space M.\n          \\<forall>B.\n             real\n              (card\n                {n \\<in> {..<B}.\n                 \\<exists>l\\<in>{1..n}.\n                    u n x - u (n - l) x \\<le> - delta l * real l})\n             \\<le> d * real B}\n  ennreal (1 - d) < emeasure M Og\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>B.\n           real\n            (card\n              {n \\<in> {..<B}.\n               \\<exists>l\\<in>{1..n}.\n                  u n x - u (n - l) x \\<le> - delta l * real l})\n           \\<le> d * real B}", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B.\n         real\n          (card\n            {n \\<in> {..<B}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - delta l * real l})\n         \\<le> d * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "then"], ["proof (chain)\npicking this:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B.\n         real\n          (card\n            {n \\<in> {..<B}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - delta l * real l})\n         \\<le> d * real B}", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B.\n         real\n          (card\n            {n \\<in> {..<B}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - delta l * real l})\n         \\<le> d * real B}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "using \\<open>delta \\<longlonglongrightarrow> 0\\<close> \\<open>\\<forall>l. delta l > 0\\<close>"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>B.\n         real\n          (card\n            {n \\<in> {..<B}.\n             \\<exists>l\\<in>{1..n}.\n                u n x - u (n - l) x \\<le> - delta l * real l})\n         \\<le> d * real B}\n  delta \\<longlonglongrightarrow> 0\n  \\<forall>l. 0 < delta l\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       < emeasure M\n          {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n x - u (n - l) x \\<le> - delta l * real l})\n              \\<le> d * real N}", "by auto"], ["proof (state)\nthis:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     ennreal (1 - d)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>N.\n            real\n             (card\n               {n \\<in> {..<N}.\n                \\<exists>l\\<in>{1..n}.\n                   u n x - u (n - l) x \\<le> - delta l * real l})\n            \\<le> d * real N}\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>We go back to the natural time direction, by using the previous result for the inverse map\nand the inverse subcocycle, and a change of variables argument. The price to pay is that the\nestimates we get are weaker: we have a control on a set of upper asymptotic density close to $1$, while\nhaving a set of lower asymptotic density close to $1$ as before would be stronger. This will\nnevertheless be sufficient for our purposes below.\\<close>"], ["", "lemma upper_density_good_direction_invertible:\n  assumes \"invertible_qmpt\"\n          \"d>(0::real)\" \"d \\<le> 1\"\n  shows \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} \\<ge> 1-d} \\<ge> ennreal(1-d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "interpret I: Gouezel_Karlsson_Kingman M Tinv \"(\\<lambda>n x. u n ((Tinv^^n) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Gouezel_Karlsson_Kingman M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))", "proof"], ["proof (state)\ngoal (5 subgoals):\n 1. Tinv \\<in> quasi_measure_preserving M M\n 2. Tinv \\<in> measure_preserving M M\n 3. mpt.subcocycle M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))\n 4. - \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x))\n 5. AE x in M. fmpt.subcocycle_lim M Tinv\n                (\\<lambda>n x. u n ((Tinv ^^ n) x)) x =\n               0", "show \"Tinv \\<in> quasi_measure_preserving M M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Tinv \\<in> quasi_measure_preserving M M", "using Tinv_qmpt[OF \\<open>invertible_qmpt\\<close>]"], ["proof (prove)\nusing this:\n  qmpt M Tinv\n\ngoal (1 subgoal):\n 1. Tinv \\<in> quasi_measure_preserving M M", "unfolding qmpt_def qmpt_axioms_def"], ["proof (prove)\nusing this:\n  sigma_finite_measure M \\<and> Tinv \\<in> quasi_measure_preserving M M\n\ngoal (1 subgoal):\n 1. Tinv \\<in> quasi_measure_preserving M M", "by simp"], ["proof (state)\nthis:\n  Tinv \\<in> quasi_measure_preserving M M\n\ngoal (4 subgoals):\n 1. Tinv \\<in> measure_preserving M M\n 2. mpt.subcocycle M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))\n 3. - \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x))\n 4. AE x in M. fmpt.subcocycle_lim M Tinv\n                (\\<lambda>n x. u n ((Tinv ^^ n) x)) x =\n               0", "show \"Tinv \\<in> measure_preserving M M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Tinv \\<in> measure_preserving M M", "using Tinv_mpt[OF \\<open>invertible_qmpt\\<close>]"], ["proof (prove)\nusing this:\n  mpt M Tinv\n\ngoal (1 subgoal):\n 1. Tinv \\<in> measure_preserving M M", "unfolding mpt_def mpt_axioms_def"], ["proof (prove)\nusing this:\n  qmpt M Tinv \\<and> Tinv \\<in> measure_preserving M M\n\ngoal (1 subgoal):\n 1. Tinv \\<in> measure_preserving M M", "by simp"], ["proof (state)\nthis:\n  Tinv \\<in> measure_preserving M M\n\ngoal (3 subgoals):\n 1. mpt.subcocycle M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))\n 2. - \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x))\n 3. AE x in M. fmpt.subcocycle_lim M Tinv\n                (\\<lambda>n x. u n ((Tinv ^^ n) x)) x =\n               0", "show \"mpt.subcocycle M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mpt.subcocycle M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))", "using subcocycle_u_Tinv[OF subu \\<open>invertible_qmpt\\<close>]"], ["proof (prove)\nusing this:\n  mpt.subcocycle M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))\n\ngoal (1 subgoal):\n 1. mpt.subcocycle M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))", "by simp"], ["proof (state)\nthis:\n  mpt.subcocycle M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))\n\ngoal (2 subgoals):\n 1. - \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x))\n 2. AE x in M. fmpt.subcocycle_lim M Tinv\n                (\\<lambda>n x. u n ((Tinv ^^ n) x)) x =\n               0", "show \"- \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x))", "using subcocycle_avg_ereal_Tinv[OF subu \\<open>invertible_qmpt\\<close>] subu_fin"], ["proof (prove)\nusing this:\n  subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x)) =\n  subcocycle_avg_ereal u\n  - \\<infinity> < subcocycle_avg_ereal u\n\ngoal (1 subgoal):\n 1. - \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x))", "by simp"], ["proof (state)\nthis:\n  - \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n ((Tinv ^^ n) x))\n\ngoal (1 subgoal):\n 1. AE x in M. fmpt.subcocycle_lim M Tinv\n                (\\<lambda>n x. u n ((Tinv ^^ n) x)) x =\n               0", "show \"AE x in M. fmpt.subcocycle_lim M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x)) x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. fmpt.subcocycle_lim M Tinv\n                (\\<lambda>n x. u n ((Tinv ^^ n) x)) x =\n               0", "using subcocycle_lim_Tinv[OF subu \\<open>invertible_qmpt\\<close>] subu_0"], ["proof (prove)\nusing this:\n  AE x in M. fmpt.subcocycle_lim M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))\n              x =\n             subcocycle_lim u x\n  AE x in M. subcocycle_lim u x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. fmpt.subcocycle_lim M Tinv\n                (\\<lambda>n x. u n ((Tinv ^^ n) x)) x =\n               0", "by auto"], ["proof (state)\nthis:\n  AE x in M. fmpt.subcocycle_lim M Tinv (\\<lambda>n x. u n ((Tinv ^^ n) x))\n              x =\n             0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have bij: \"bij T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij T", "using \\<open>invertible_qmpt\\<close>"], ["proof (prove)\nusing this:\n  invertible_qmpt\n\ngoal (1 subgoal):\n 1. bij T", "unfolding invertible_qmpt_def"], ["proof (prove)\nusing this:\n  bij T \\<and> random_variable M (inv T)\n\ngoal (1 subgoal):\n 1. bij T", "by simp"], ["proof (state)\nthis:\n  bij T\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define e where \"e = d * d / 2\""], ["proof (state)\nthis:\n  e = d * d / 2\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"e>0\" \"e\\<le>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < e &&& e \\<le> 1", "unfolding e_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < d * d / 2 &&& d * d / 2 \\<le> 1", "using \\<open>d>0\\<close> \\<open>d \\<le> 1\\<close>"], ["proof (prove)\nusing this:\n  0 < d\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. 0 < d * d / 2 &&& d * d / 2 \\<le> 1", "by (auto, meson less_imp_le mult_left_le one_le_numeral order_trans)"], ["proof (state)\nthis:\n  0 < e\n  e \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "obtain delta::\"nat \\<Rightarrow> real\" where d: \"\\<And>l. delta l > 0\"\n                                       \"delta \\<longlonglongrightarrow> 0\"\n        \"emeasure M {x \\<in> space M. \\<forall>N.\n        card {n \\<in> {..<N}. \\<exists>l\\<in>{1..n}. u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x) \\<le> - delta l * real l} \\<le> e * real N}\n        > 1-e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>delta.\n        \\<lbrakk>\\<And>l. 0 < delta l; delta \\<longlonglongrightarrow> 0;\n         ennreal (1 - e)\n         < emeasure M\n            {x \\<in> space M.\n             \\<forall>N.\n                real\n                 (card\n                   {n \\<in> {..<N}.\n                    \\<exists>l\\<in>{1..n}.\n                       u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n                       \\<le> - delta l * real l})\n                \\<le> e * real N}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using I.upper_density_delta[OF \\<open>e>0\\<close> \\<open>e\\<le>1\\<close>]"], ["proof (prove)\nusing this:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     ennreal (1 - e)\n     < emeasure M\n        {x \\<in> space M.\n         \\<forall>N.\n            real\n             (card\n               {n \\<in> {..<N}.\n                \\<exists>l\\<in>{1..n}.\n                   u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n                   \\<le> - delta l * real l})\n            \\<le> e * real N}\n\ngoal (1 subgoal):\n 1. (\\<And>delta.\n        \\<lbrakk>\\<And>l. 0 < delta l; delta \\<longlonglongrightarrow> 0;\n         ennreal (1 - e)\n         < emeasure M\n            {x \\<in> space M.\n             \\<forall>N.\n                real\n                 (card\n                   {n \\<in> {..<N}.\n                    \\<exists>l\\<in>{1..n}.\n                       u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n                       \\<le> - delta l * real l})\n                \\<le> e * real N}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < delta ?l12\n  delta \\<longlonglongrightarrow> 0\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>N.\n         real\n          (card\n            {n \\<in> {..<N}.\n             \\<exists>l\\<in>{1..n}.\n                u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n                \\<le> - delta l * real l})\n         \\<le> e * real N}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define S where \"S = {x \\<in> space M. \\<forall>N.\n          card {n \\<in> {..<N}. \\<exists>l\\<in>{1..n}. u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x) \\<le> - delta l * real l} \\<le> e * real N}\""], ["proof (state)\nthis:\n  S =\n  {x \\<in> space M.\n   \\<forall>N.\n      real\n       (card\n         {n \\<in> {..<N}.\n          \\<exists>l\\<in>{1..n}.\n             u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n             \\<le> - delta l * real l})\n      \\<le> e * real N}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have [measurable]: \"S \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<in> events", "unfolding S_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>N.\n        real\n         (card\n           {n \\<in> {..<N}.\n            \\<exists>l\\<in>{1..n}.\n               u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n               \\<le> - delta l * real l})\n        \\<le> e * real N}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  S \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"emeasure M S > 1 - e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - e) < emeasure M S", "unfolding S_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - e)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>N.\n           real\n            (card\n              {n \\<in> {..<N}.\n               \\<exists>l\\<in>{1..n}.\n                  u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n                  \\<le> - delta l * real l})\n           \\<le> e * real N}", "using d(3)"], ["proof (prove)\nusing this:\n  ennreal (1 - e)\n  < emeasure M\n     {x \\<in> space M.\n      \\<forall>N.\n         real\n          (card\n            {n \\<in> {..<N}.\n             \\<exists>l\\<in>{1..n}.\n                u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n                \\<le> - delta l * real l})\n         \\<le> e * real N}\n\ngoal (1 subgoal):\n 1. ennreal (1 - e)\n    < emeasure M\n       {x \\<in> space M.\n        \\<forall>N.\n           real\n            (card\n              {n \\<in> {..<N}.\n               \\<exists>l\\<in>{1..n}.\n                  u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n                  \\<le> - delta l * real l})\n           \\<le> e * real N}", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - e) < emeasure M S\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define Og where \"Og = (\\<lambda>n. {x \\<in> space M. \\<forall>l\\<in>{1..n}. u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x) > - delta l * real l})\""], ["proof (state)\nthis:\n  Og =\n  (\\<lambda>n.\n      {x \\<in> space M.\n       \\<forall>l\\<in>{1..n}.\n          - delta l * real l\n          < u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have [measurable]: \"Og n \\<in> sets M\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. Og n \\<in> events", "unfolding Og_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>l\\<in>{1..n}.\n        - delta l * real l\n        < u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  Og ?n12 \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define Pg where \"Pg = (\\<lambda>n. {x \\<in> space M. \\<forall>l\\<in>{1..n}. u n x - u (n - l) ((T^^l) x) > - delta l * real l})\""], ["proof (state)\nthis:\n  Pg =\n  (\\<lambda>n.\n      {x \\<in> space M.\n       \\<forall>l\\<in>{1..n}.\n          - delta l * real l < u n x - u (n - l) ((T ^^ l) x)})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have [measurable]: \"Pg n \\<in> sets M\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. Pg n \\<in> events", "unfolding Pg_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>l\\<in>{1..n}.\n        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  Pg ?n12 \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define Bad where \"Bad = (\\<lambda>i::nat. {x \\<in> space M. \\<forall>N\\<ge>i. card {n \\<in> {..<N}. x \\<in> Pg n} \\<le> (1-d) * real N})\""], ["proof (state)\nthis:\n  Bad =\n  (\\<lambda>i.\n      {x \\<in> space M.\n       \\<forall>N\\<ge>i.\n          real (card {n \\<in> {..<N}. x \\<in> Pg n})\n          \\<le> (1 - d) * real N})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have [measurable]: \"Bad i \\<in> sets M\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. Bad i \\<in> events", "unfolding Bad_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     \\<forall>N\\<ge>i.\n        real (card {n \\<in> {..<N}. x \\<in> Pg n}) \\<le> (1 - d) * real N}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  Bad ?i12 \\<in> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  Bad ?i12 \\<in> events", "have \"range Bad \\<subseteq> sets M\""], ["proof (prove)\nusing this:\n  Bad ?i12 \\<in> events\n\ngoal (1 subgoal):\n 1. range Bad \\<subseteq> events", "by auto"], ["proof (state)\nthis:\n  range Bad \\<subseteq> events\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"incseq Bad\""], ["proof (prove)\ngoal (1 subgoal):\n 1. incseq Bad", "unfolding Bad_def incseq_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>m n.\n       m \\<le> n \\<longrightarrow>\n       {x \\<in> space M.\n        \\<forall>N\\<ge>m.\n           real (card {n \\<in> {..<N}. x \\<in> Pg n})\n           \\<le> (1 - d) * real N}\n       \\<subseteq> {x \\<in> space M.\n                    \\<forall>N\\<ge>n.\n                       real (card {n \\<in> {..<N}. x \\<in> Pg n})\n                       \\<le> (1 - d) * real N}", "by auto"], ["proof (state)\nthis:\n  incseq Bad\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have inc: \"{x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} < 1-d}\n        \\<subseteq> (\\<Union>i. Bad i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     upper_asymptotic_density\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n     < 1 - d}\n    \\<subseteq> \\<Union> (range Bad)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "assume H: \"x \\<in> {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} < 1-d}\""], ["proof (state)\nthis:\n  x \\<in> {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n           < 1 - d}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "then"], ["proof (chain)\npicking this:\n  x \\<in> {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n           < 1 - d}", "have \"x \\<in> space M\""], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n           < 1 - d}\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "by simp"], ["proof (state)\nthis:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "define A where \"A = {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l}\""], ["proof (state)\nthis:\n  A =\n  {n. \\<forall>l\\<in>{1..n}.\n         - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "have \"upper_asymptotic_density A < 1-d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. upper_asymptotic_density A < 1 - d", "using H"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n           < 1 - d}\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density A < 1 - d", "unfolding A_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n           < 1 - d}\n\ngoal (1 subgoal):\n 1. upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d", "by simp"], ["proof (state)\nthis:\n  upper_asymptotic_density A < 1 - d\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "then"], ["proof (chain)\npicking this:\n  upper_asymptotic_density A < 1 - d", "have \"\\<exists>i. \\<forall>N\\<ge>i. card (A \\<inter> {..<N}) \\<le> (1-d)* real N\""], ["proof (prove)\nusing this:\n  upper_asymptotic_density A < 1 - d\n\ngoal (1 subgoal):\n 1. \\<exists>i.\n       \\<forall>N\\<ge>i.\n          real (card (A \\<inter> {..<N})) \\<le> (1 - d) * real N", "using upper_asymptotic_densityD[of A \"1-d\"]"], ["proof (prove)\nusing this:\n  upper_asymptotic_density A < 1 - d\n  upper_asymptotic_density A < 1 - d \\<Longrightarrow>\n  \\<forall>\\<^sub>F n in sequentially.\n     real (card (A \\<inter> {..<n})) < (1 - d) * real n\n\ngoal (1 subgoal):\n 1. \\<exists>i.\n       \\<forall>N\\<ge>i.\n          real (card (A \\<inter> {..<N})) \\<le> (1 - d) * real N", "by (metis (no_types, lifting) eventually_sequentially less_imp_le)"], ["proof (state)\nthis:\n  \\<exists>i.\n     \\<forall>N\\<ge>i.\n        real (card (A \\<inter> {..<N})) \\<le> (1 - d) * real N\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "then"], ["proof (chain)\npicking this:\n  \\<exists>i.\n     \\<forall>N\\<ge>i.\n        real (card (A \\<inter> {..<N})) \\<le> (1 - d) * real N", "obtain i where \"card (A \\<inter> {..<N}) \\<le> (1-d)* real N\" if \"N\\<ge>i\" for N"], ["proof (prove)\nusing this:\n  \\<exists>i.\n     \\<forall>N\\<ge>i.\n        real (card (A \\<inter> {..<N})) \\<le> (1 - d) * real N\n\ngoal (1 subgoal):\n 1. (\\<And>i.\n        (\\<And>N.\n            i \\<le> N \\<Longrightarrow>\n            real (card (A \\<inter> {..<N}))\n            \\<le> (1 - d) * real N) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  i \\<le> ?N12 \\<Longrightarrow>\n  real (card (A \\<inter> {..<?N12})) \\<le> (1 - d) * real ?N12\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "moreover"], ["proof (state)\nthis:\n  i \\<le> ?N12 \\<Longrightarrow>\n  real (card (A \\<inter> {..<?N12})) \\<le> (1 - d) * real ?N12\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "have \"A \\<inter> {..<N} = {n. n<N \\<and> (\\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l)}\" for N"], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<inter> {..<N} =\n    {n. n < N \\<and>\n        (\\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x))}", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. \\<forall>l\\<in>{1..n}.\n           - delta l * real l < u n x - u (n - l) ((T ^^ l) x)} \\<inter>\n    {..<N} =\n    {n. n < N \\<and>\n        (\\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x))}", "by auto"], ["proof (state)\nthis:\n  A \\<inter> {..<?N12} =\n  {n. n < ?N12 \\<and>\n      (\\<forall>l\\<in>{1..n}.\n          - delta l * real l < u n x - u (n - l) ((T ^^ l) x))}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "ultimately"], ["proof (chain)\npicking this:\n  i \\<le> ?N12 \\<Longrightarrow>\n  real (card (A \\<inter> {..<?N12})) \\<le> (1 - d) * real ?N12\n  A \\<inter> {..<?N12} =\n  {n. n < ?N12 \\<and>\n      (\\<forall>l\\<in>{1..n}.\n          - delta l * real l < u n x - u (n - l) ((T ^^ l) x))}", "have \"x \\<in> Bad i\""], ["proof (prove)\nusing this:\n  i \\<le> ?N12 \\<Longrightarrow>\n  real (card (A \\<inter> {..<?N12})) \\<le> (1 - d) * real ?N12\n  A \\<inter> {..<?N12} =\n  {n. n < ?N12 \\<and>\n      (\\<forall>l\\<in>{1..n}.\n          - delta l * real l < u n x - u (n - l) ((T ^^ l) x))}\n\ngoal (1 subgoal):\n 1. x \\<in> Bad i", "unfolding Bad_def Pg_def"], ["proof (prove)\nusing this:\n  i \\<le> ?N12 \\<Longrightarrow>\n  real (card (A \\<inter> {..<?N12})) \\<le> (1 - d) * real ?N12\n  A \\<inter> {..<?N12} =\n  {n. n < ?N12 \\<and>\n      (\\<forall>l\\<in>{1..n}.\n          - delta l * real l < u n x - u (n - l) ((T ^^ l) x))}\n\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> space M.\n             \\<forall>N\\<ge>i.\n                real\n                 (card\n                   {n \\<in> {..<N}.\n                    x \\<in> {x \\<in> space M.\n                             \\<forall>l\\<in>{1..n}.\n                                - delta l * real l\n                                < u n x - u (n - l) ((T ^^ l) x)}})\n                \\<le> (1 - d) * real N}", "using \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  i \\<le> ?N12 \\<Longrightarrow>\n  real (card (A \\<inter> {..<?N12})) \\<le> (1 - d) * real ?N12\n  A \\<inter> {..<?N12} =\n  {n. n < ?N12 \\<and>\n      (\\<forall>l\\<in>{1..n}.\n          - delta l * real l < u n x - u (n - l) ((T ^^ l) x))}\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> space M.\n             \\<forall>N\\<ge>i.\n                real\n                 (card\n                   {n \\<in> {..<N}.\n                    x \\<in> {x \\<in> space M.\n                             \\<forall>l\\<in>{1..n}.\n                                - delta l * real l\n                                < u n x - u (n - l) ((T ^^ l) x)}})\n                \\<le> (1 - d) * real N}", "by auto"], ["proof (state)\nthis:\n  x \\<in> Bad i\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {x \\<in> space M.\n                upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n                < 1 - d} \\<Longrightarrow>\n       x \\<in> \\<Union> (range Bad)", "then"], ["proof (chain)\npicking this:\n  x \\<in> Bad i", "show \"x \\<in> (\\<Union>i. Bad i)\""], ["proof (prove)\nusing this:\n  x \\<in> Bad i\n\ngoal (1 subgoal):\n 1. x \\<in> \\<Union> (range Bad)", "by blast"], ["proof (state)\nthis:\n  x \\<in> \\<Union> (range Bad)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  {x \\<in> space M.\n   upper_asymptotic_density\n    {n. \\<forall>l\\<in>{1..n}.\n           - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n   < 1 - d}\n  \\<subseteq> \\<Union> (range Bad)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"emeasure M (Og n) \\<le> emeasure M (Pg n)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M (Og n) \\<le> emeasure M (Pg n)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure M (Og n) \\<le> emeasure M (Pg n)", "have *: \"(T^^n)-`(Og n) \\<inter> space M \\<subseteq> Pg n\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ n) -` Og n \\<inter> space M \\<subseteq> Pg n", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "assume x: \"x \\<in> (T^^n)-`(Og n) \\<inter> space M\""], ["proof (state)\nthis:\n  x \\<in> (T ^^ n) -` Og n \\<inter> space M\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "define y where \"y = (T^^n) x\""], ["proof (state)\nthis:\n  y = (T ^^ n) x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "then"], ["proof (chain)\npicking this:\n  y = (T ^^ n) x", "have \"y \\<in> Og n\""], ["proof (prove)\nusing this:\n  y = (T ^^ n) x\n\ngoal (1 subgoal):\n 1. y \\<in> Og n", "using x"], ["proof (prove)\nusing this:\n  y = (T ^^ n) x\n  x \\<in> (T ^^ n) -` Og n \\<inter> space M\n\ngoal (1 subgoal):\n 1. y \\<in> Og n", "by auto"], ["proof (state)\nthis:\n  y \\<in> Og n\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "have \"y \\<in> space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> space M", "using sets.sets_into_space[OF \\<open>Og n \\<in> sets M\\<close>] \\<open>y \\<in> Og n\\<close>"], ["proof (prove)\nusing this:\n  Og n \\<subseteq> space M\n  y \\<in> Og n\n\ngoal (1 subgoal):\n 1. y \\<in> space M", "by auto"], ["proof (state)\nthis:\n  y \\<in> space M\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "have \"x = (Tinv^^n) y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = (Tinv ^^ n) y", "unfolding y_def Tinv_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. x = (inv T ^^ n) ((T ^^ n) x)", "using inv_fn_o_fn_is_id[OF bij, of n]"], ["proof (prove)\nusing this:\n  inv T ^^ n \\<circ> T ^^ n = (\\<lambda>x. x)\n\ngoal (1 subgoal):\n 1. x = (inv T ^^ n) ((T ^^ n) x)", "by (metis comp_apply)"], ["proof (state)\nthis:\n  x = (Tinv ^^ n) y\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "{"], ["proof (state)\nthis:\n  x = (Tinv ^^ n) y\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "fix l"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "assume \"l \\<in> {1..n}\""], ["proof (state)\nthis:\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "have \"(T^^l) x = (T^^l) ((Tinv^^l) ((Tinv^^(n-l))y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ l) x = (T ^^ l) ((Tinv ^^ l) ((Tinv ^^ (n - l)) y))", "apply (subst \\<open>x = (Tinv^^n) y\\<close>)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ l) ((Tinv ^^ n) y) = (T ^^ l) ((Tinv ^^ l) ((Tinv ^^ (n - l)) y))", "using funpow_add[of l \"n-l\" Tinv] \\<open>l \\<in> {1..n}\\<close>"], ["proof (prove)\nusing this:\n  Tinv ^^ (l + (n - l)) = Tinv ^^ l \\<circ> Tinv ^^ (n - l)\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. (T ^^ l) ((Tinv ^^ n) y) = (T ^^ l) ((Tinv ^^ l) ((Tinv ^^ (n - l)) y))", "by fastforce"], ["proof (state)\nthis:\n  (T ^^ l) x = (T ^^ l) ((Tinv ^^ l) ((Tinv ^^ (n - l)) y))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "then"], ["proof (chain)\npicking this:\n  (T ^^ l) x = (T ^^ l) ((Tinv ^^ l) ((Tinv ^^ (n - l)) y))", "have *: \"(T^^l) x = (Tinv^^(n-l)) y\""], ["proof (prove)\nusing this:\n  (T ^^ l) x = (T ^^ l) ((Tinv ^^ l) ((Tinv ^^ (n - l)) y))\n\ngoal (1 subgoal):\n 1. (T ^^ l) x = (Tinv ^^ (n - l)) y", "unfolding Tinv_def"], ["proof (prove)\nusing this:\n  (T ^^ l) x = (T ^^ l) ((inv T ^^ l) ((inv T ^^ (n - l)) y))\n\ngoal (1 subgoal):\n 1. (T ^^ l) x = (inv T ^^ (n - l)) y", "using fn_o_inv_fn_is_id[OF bij]"], ["proof (prove)\nusing this:\n  (T ^^ l) x = (T ^^ l) ((inv T ^^ l) ((inv T ^^ (n - l)) y))\n  T ^^ ?n \\<circ> inv T ^^ ?n = (\\<lambda>x. x)\n\ngoal (1 subgoal):\n 1. (T ^^ l) x = (inv T ^^ (n - l)) y", "by (metis comp_apply)"], ["proof (state)\nthis:\n  (T ^^ l) x = (Tinv ^^ (n - l)) y\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "then"], ["proof (chain)\npicking this:\n  (T ^^ l) x = (Tinv ^^ (n - l)) y", "have \"u n x - u (n-l) ((T^^l) x) = u n ((Tinv^^n) y) - u (n-l) ((Tinv^^(n-l)) y)\""], ["proof (prove)\nusing this:\n  (T ^^ l) x = (Tinv ^^ (n - l)) y\n\ngoal (1 subgoal):\n 1. u n x - u (n - l) ((T ^^ l) x) =\n    u n ((Tinv ^^ n) y) - u (n - l) ((Tinv ^^ (n - l)) y)", "using \\<open>x = (Tinv^^n) y\\<close>"], ["proof (prove)\nusing this:\n  (T ^^ l) x = (Tinv ^^ (n - l)) y\n  x = (Tinv ^^ n) y\n\ngoal (1 subgoal):\n 1. u n x - u (n - l) ((T ^^ l) x) =\n    u n ((Tinv ^^ n) y) - u (n - l) ((Tinv ^^ (n - l)) y)", "by auto"], ["proof (state)\nthis:\n  u n x - u (n - l) ((T ^^ l) x) =\n  u n ((Tinv ^^ n) y) - u (n - l) ((Tinv ^^ (n - l)) y)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "also"], ["proof (state)\nthis:\n  u n x - u (n - l) ((T ^^ l) x) =\n  u n ((Tinv ^^ n) y) - u (n - l) ((Tinv ^^ (n - l)) y)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "have \"... > - delta l * real l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - delta l * real l\n    < u n ((Tinv ^^ n) y) - u (n - l) ((Tinv ^^ (n - l)) y)", "using \\<open>y \\<in> Og n\\<close> \\<open>l \\<in> {1..n}\\<close>"], ["proof (prove)\nusing this:\n  y \\<in> Og n\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. - delta l * real l\n    < u n ((Tinv ^^ n) y) - u (n - l) ((Tinv ^^ (n - l)) y)", "unfolding Og_def"], ["proof (prove)\nusing this:\n  y \\<in> {x \\<in> space M.\n           \\<forall>l\\<in>{1..n}.\n              - delta l * real l\n              < u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)}\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. - delta l * real l\n    < u n ((Tinv ^^ n) y) - u (n - l) ((Tinv ^^ (n - l)) y)", "by auto"], ["proof (state)\nthis:\n  - delta l * real l < u n ((Tinv ^^ n) y) - u (n - l) ((Tinv ^^ (n - l)) y)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "finally"], ["proof (chain)\npicking this:\n  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)", "have \"u n x - u (n-l) ((T^^l) x) > - delta l * real l\""], ["proof (prove)\nusing this:\n  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)\n\ngoal (1 subgoal):\n 1. - delta l * real l < u n x - u (n - l) ((T ^^ l) x)", "by simp"], ["proof (state)\nthis:\n  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "}"], ["proof (state)\nthis:\n  ?l14 \\<in> {1..n} \\<Longrightarrow>\n  - delta ?l14 * real ?l14 < u n x - u (n - ?l14) ((T ^^ ?l14) x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (T ^^ n) -` Og n \\<inter> space M \\<Longrightarrow>\n       x \\<in> Pg n", "then"], ["proof (chain)\npicking this:\n  ?l14 \\<in> {1..n} \\<Longrightarrow>\n  - delta ?l14 * real ?l14 < u n x - u (n - ?l14) ((T ^^ ?l14) x)", "show \"x \\<in> Pg n\""], ["proof (prove)\nusing this:\n  ?l14 \\<in> {1..n} \\<Longrightarrow>\n  - delta ?l14 * real ?l14 < u n x - u (n - ?l14) ((T ^^ ?l14) x)\n\ngoal (1 subgoal):\n 1. x \\<in> Pg n", "unfolding Pg_def"], ["proof (prove)\nusing this:\n  ?l14 \\<in> {1..n} \\<Longrightarrow>\n  - delta ?l14 * real ?l14 < u n x - u (n - ?l14) ((T ^^ ?l14) x)\n\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> space M.\n             \\<forall>l\\<in>{1..n}.\n                - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}", "using x"], ["proof (prove)\nusing this:\n  ?l14 \\<in> {1..n} \\<Longrightarrow>\n  - delta ?l14 * real ?l14 < u n x - u (n - ?l14) ((T ^^ ?l14) x)\n  x \\<in> (T ^^ n) -` Og n \\<inter> space M\n\ngoal (1 subgoal):\n 1. x \\<in> {x \\<in> space M.\n             \\<forall>l\\<in>{1..n}.\n                - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}", "by auto"], ["proof (state)\nthis:\n  x \\<in> Pg n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (T ^^ ?n12) -` Og ?n12 \\<inter> space M \\<subseteq> Pg ?n12\n\ngoal (1 subgoal):\n 1. emeasure M (Og n) \\<le> emeasure M (Pg n)", "have \"emeasure M (Og n) = emeasure M ((T^^n)-`(Og n) \\<inter> space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M (Og n) = emeasure M ((T ^^ n) -` Og n \\<inter> space M)", "using T_vrestr_same_emeasure(2)"], ["proof (prove)\nusing this:\n  ?A \\<in> events \\<Longrightarrow>\n  emeasure M ((T ^^ ?n) --` ?A) = emeasure M ?A\n\ngoal (1 subgoal):\n 1. emeasure M (Og n) = emeasure M ((T ^^ n) -` Og n \\<inter> space M)", "unfolding vimage_restr_def"], ["proof (prove)\nusing this:\n  ?A \\<in> events \\<Longrightarrow>\n  emeasure M ((T ^^ ?n) -` (?A \\<inter> space M) \\<inter> space M) =\n  emeasure M ?A\n\ngoal (1 subgoal):\n 1. emeasure M (Og n) = emeasure M ((T ^^ n) -` Og n \\<inter> space M)", "by auto"], ["proof (state)\nthis:\n  emeasure M (Og n) = emeasure M ((T ^^ n) -` Og n \\<inter> space M)\n\ngoal (1 subgoal):\n 1. emeasure M (Og n) \\<le> emeasure M (Pg n)", "also"], ["proof (state)\nthis:\n  emeasure M (Og n) = emeasure M ((T ^^ n) -` Og n \\<inter> space M)\n\ngoal (1 subgoal):\n 1. emeasure M (Og n) \\<le> emeasure M (Pg n)", "have \"... \\<le> emeasure M (Pg n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M ((T ^^ n) -` Og n \\<inter> space M) \\<le> emeasure M (Pg n)", "apply (rule emeasure_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (T ^^ n) -` Og n \\<inter> space M \\<subseteq> Pg n\n 2. Pg n \\<in> events", "using *"], ["proof (prove)\nusing this:\n  (T ^^ ?n12) -` Og ?n12 \\<inter> space M \\<subseteq> Pg ?n12\n\ngoal (2 subgoals):\n 1. (T ^^ n) -` Og n \\<inter> space M \\<subseteq> Pg n\n 2. Pg n \\<in> events", "by auto"], ["proof (state)\nthis:\n  emeasure M ((T ^^ n) -` Og n \\<inter> space M) \\<le> emeasure M (Pg n)\n\ngoal (1 subgoal):\n 1. emeasure M (Og n) \\<le> emeasure M (Pg n)", "finally"], ["proof (chain)\npicking this:\n  emeasure M (Og n) \\<le> emeasure M (Pg n)", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure M (Og n) \\<le> emeasure M (Pg n)\n\ngoal (1 subgoal):\n 1. emeasure M (Og n) \\<le> emeasure M (Pg n)", "by simp"], ["proof (state)\nthis:\n  emeasure M (Og n) \\<le> emeasure M (Pg n)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  emeasure M (Og ?n12) \\<le> emeasure M (Pg ?n12)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "{"], ["proof (state)\nthis:\n  emeasure M (Og ?n12) \\<le> emeasure M (Pg ?n12)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "fix N::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "assume \"N \\<ge> 1\""], ["proof (state)\nthis:\n  1 \\<le> N\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have I: \"card {n\\<in>{..<N}. x \\<in> Og n} \\<ge> (1-e) * real N\" if \"x \\<in> S\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "have \"x \\<in> space M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> space M", "using \\<open>x \\<in> S\\<close> sets.sets_into_space[OF \\<open>S \\<in> sets M\\<close>]"], ["proof (prove)\nusing this:\n  x \\<in> S\n  S \\<subseteq> space M\n\ngoal (1 subgoal):\n 1. x \\<in> space M", "by auto"], ["proof (state)\nthis:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "have a: \"real (card {n. n < N \\<and> (\\<exists>l\\<in>{Suc 0..n}. u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x) \\<le> - (delta l * real l))}) \\<le> e * real N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real\n     (card\n       {n. n < N \\<and>\n           (\\<exists>l\\<in>{Suc 0..n}.\n               u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n               \\<le> - (delta l * real l))})\n    \\<le> e * real N", "using \\<open>x \\<in> S\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> S\n\ngoal (1 subgoal):\n 1. real\n     (card\n       {n. n < N \\<and>\n           (\\<exists>l\\<in>{Suc 0..n}.\n               u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n               \\<le> - (delta l * real l))})\n    \\<le> e * real N", "unfolding S_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           \\<forall>N.\n              real\n               (card\n                 {n \\<in> {..<N}.\n                  \\<exists>l\\<in>{1..n}.\n                     u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n                     \\<le> - delta l * real l})\n              \\<le> e * real N}\n\ngoal (1 subgoal):\n 1. real\n     (card\n       {n. n < N \\<and>\n           (\\<exists>l\\<in>{Suc 0..n}.\n               u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n               \\<le> - (delta l * real l))})\n    \\<le> e * real N", "by auto"], ["proof (state)\nthis:\n  real\n   (card\n     {n. n < N \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n             \\<le> - (delta l * real l))})\n  \\<le> e * real N\n\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "have *: \"{n. n < N} = {n. n < N \\<and> (\\<exists>l\\<in>{Suc 0..n}. u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x) \\<le> - (delta l * real l))}\n              \\<union> {n. n < N \\<and> x \\<in> Og n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. n < N} =\n    {n. n < N \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n            \\<le> - (delta l * real l))} \\<union>\n    {n. n < N \\<and> x \\<in> Og n}", "unfolding Og_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {n. n < N} =\n    {n. n < N \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n            \\<le> - (delta l * real l))} \\<union>\n    {n. n < N \\<and>\n        x \\<in> {x \\<in> space M.\n                 \\<forall>l\\<in>{1..n}.\n                    - delta l * real l\n                    < u n ((Tinv ^^ n) x) -\n                      u (n - l) ((Tinv ^^ (n - l)) x)}}", "using \\<open>x \\<in> space M\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. {n. n < N} =\n    {n. n < N \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n            \\<le> - (delta l * real l))} \\<union>\n    {n. n < N \\<and>\n        x \\<in> {x \\<in> space M.\n                 \\<forall>l\\<in>{1..n}.\n                    - delta l * real l\n                    < u n ((Tinv ^^ n) x) -\n                      u (n - l) ((Tinv ^^ (n - l)) x)}}", "by (auto, meson atLeastAtMost_iff linorder_not_le)"], ["proof (state)\nthis:\n  {n. n < N} =\n  {n. n < N \\<and>\n      (\\<exists>l\\<in>{Suc 0..n}.\n          u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n          \\<le> - (delta l * real l))} \\<union>\n  {n. n < N \\<and> x \\<in> Og n}\n\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "have \"N = card {n. n < N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. N = card {n. n < N}", "by auto"], ["proof (state)\nthis:\n  N = card {n. n < N}\n\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "also"], ["proof (state)\nthis:\n  N = card {n. n < N}\n\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "have \"... = card {n. n < N \\<and> (\\<exists>l\\<in>{Suc 0..n}. u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x) \\<le> - (delta l * real l))}\n              + card {n. n < N \\<and> x \\<in> Og n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card {n. n < N} =\n    card\n     {n. n < N \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n             \\<le> - (delta l * real l))} +\n    card {n. n < N \\<and> x \\<in> Og n}", "apply (subst *, rule card_Un_disjoint)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite\n     {n. n < N \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n             \\<le> - (delta l * real l))}\n 2. finite {n. n < N \\<and> x \\<in> Og n}\n 3. {n. n < N \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n            \\<le> - (delta l * real l))} \\<inter>\n    {n. n < N \\<and> x \\<in> Og n} =\n    {}", "unfolding Og_def"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite\n     {n. n < N \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n             \\<le> - (delta l * real l))}\n 2. finite\n     {n. n < N \\<and>\n         x \\<in> {x \\<in> space M.\n                  \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < u n ((Tinv ^^ n) x) -\n                       u (n - l) ((Tinv ^^ (n - l)) x)}}\n 3. {n. n < N \\<and>\n        (\\<exists>l\\<in>{Suc 0..n}.\n            u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n            \\<le> - (delta l * real l))} \\<inter>\n    {n. n < N \\<and>\n        x \\<in> {x \\<in> space M.\n                 \\<forall>l\\<in>{1..n}.\n                    - delta l * real l\n                    < u n ((Tinv ^^ n) x) -\n                      u (n - l) ((Tinv ^^ (n - l)) x)}} =\n    {}", "by auto"], ["proof (state)\nthis:\n  card {n. n < N} =\n  card\n   {n. n < N \\<and>\n       (\\<exists>l\\<in>{Suc 0..n}.\n           u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n           \\<le> - (delta l * real l))} +\n  card {n. n < N \\<and> x \\<in> Og n}\n\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "ultimately"], ["proof (chain)\npicking this:\n  N = card {n. n < N}\n  card {n. n < N} =\n  card\n   {n. n < N \\<and>\n       (\\<exists>l\\<in>{Suc 0..n}.\n           u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n           \\<le> - (delta l * real l))} +\n  card {n. n < N \\<and> x \\<in> Og n}", "have \"real N \\<le> e * real N + card {n. n < N \\<and> x \\<in> Og n}\""], ["proof (prove)\nusing this:\n  N = card {n. n < N}\n  card {n. n < N} =\n  card\n   {n. n < N \\<and>\n       (\\<exists>l\\<in>{Suc 0..n}.\n           u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n           \\<le> - (delta l * real l))} +\n  card {n. n < N \\<and> x \\<in> Og n}\n\ngoal (1 subgoal):\n 1. real N \\<le> e * real N + real (card {n. n < N \\<and> x \\<in> Og n})", "using a"], ["proof (prove)\nusing this:\n  N = card {n. n < N}\n  card {n. n < N} =\n  card\n   {n. n < N \\<and>\n       (\\<exists>l\\<in>{Suc 0..n}.\n           u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n           \\<le> - (delta l * real l))} +\n  card {n. n < N \\<and> x \\<in> Og n}\n  real\n   (card\n     {n. n < N \\<and>\n         (\\<exists>l\\<in>{Suc 0..n}.\n             u n ((Tinv ^^ n) x) - u (n - l) ((Tinv ^^ (n - l)) x)\n             \\<le> - (delta l * real l))})\n  \\<le> e * real N\n\ngoal (1 subgoal):\n 1. real N \\<le> e * real N + real (card {n. n < N \\<and> x \\<in> Og n})", "by auto"], ["proof (state)\nthis:\n  real N \\<le> e * real N + real (card {n. n < N \\<and> x \\<in> Og n})\n\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "then"], ["proof (chain)\npicking this:\n  real N \\<le> e * real N + real (card {n. n < N \\<and> x \\<in> Og n})", "show ?thesis"], ["proof (prove)\nusing this:\n  real N \\<le> e * real N + real (card {n. n < N \\<and> x \\<in> Og n})\n\ngoal (1 subgoal):\n 1. (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})", "by (auto simp add: algebra_simps)"], ["proof (state)\nthis:\n  (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. x \\<in> Og n})\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x12 \\<in> S \\<Longrightarrow>\n  (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. ?x12 \\<in> Og n})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define m where \"m = measure M (Bad N)\""], ["proof (state)\nthis:\n  m = prob (Bad N)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"m \\<ge> 0\" \"1-m \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> m &&& 0 \\<le> 1 - m", "unfolding m_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> prob (Bad N) &&& 0 \\<le> 1 - prob (Bad N)", "by auto"], ["proof (state)\nthis:\n  0 \\<le> m\n  0 \\<le> 1 - m\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have *: \"1-e \\<le> emeasure M S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - e) \\<le> emeasure M S", "using \\<open>emeasure M S > 1 - e\\<close>"], ["proof (prove)\nusing this:\n  ennreal (1 - e) < emeasure M S\n\ngoal (1 subgoal):\n 1. ennreal (1 - e) \\<le> emeasure M S", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - e) \\<le> emeasure M S\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"ennreal((1-e) * ((1-e) * real N)) = ennreal(1-e) * ennreal((1-e) * real N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal ((1 - e) * ((1 - e) * real N)) =\n    ennreal (1 - e) * ennreal ((1 - e) * real N)", "apply (rule ennreal_mult)"], ["proof (prove)\ngoal (2 subgoals):\n 1. 0 \\<le> 1 - e\n 2. 0 \\<le> (1 - e) * real N", "using \\<open>e \\<le> 1\\<close>"], ["proof (prove)\nusing this:\n  e \\<le> 1\n\ngoal (2 subgoals):\n 1. 0 \\<le> 1 - e\n 2. 0 \\<le> (1 - e) * real N", "by auto"], ["proof (state)\nthis:\n  ennreal ((1 - e) * ((1 - e) * real N)) =\n  ennreal (1 - e) * ennreal ((1 - e) * real N)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  ennreal ((1 - e) * ((1 - e) * real N)) =\n  ennreal (1 - e) * ennreal ((1 - e) * real N)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... \\<le> emeasure M S * ennreal((1-e) * real N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - e) * ennreal ((1 - e) * real N)\n    \\<le> emeasure M S * ennreal ((1 - e) * real N)", "using mult_right_mono[OF *]"], ["proof (prove)\nusing this:\n  0 \\<le> ?c \\<Longrightarrow> ennreal (1 - e) * ?c \\<le> emeasure M S * ?c\n\ngoal (1 subgoal):\n 1. ennreal (1 - e) * ennreal ((1 - e) * real N)\n    \\<le> emeasure M S * ennreal ((1 - e) * real N)", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - e) * ennreal ((1 - e) * real N)\n  \\<le> emeasure M S * ennreal ((1 - e) * real N)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  ennreal (1 - e) * ennreal ((1 - e) * real N)\n  \\<le> emeasure M S * ennreal ((1 - e) * real N)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+ x\\<in>S. ((1-e) * real N) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M S * ennreal ((1 - e) * real N) =\n    \\<integral>\\<^sup>+x\\<in>S. ennreal ((1 - e) * real N)\\<partial>M", "by (metis \\<open>S \\<in> events\\<close> mult.commute nn_integral_cmult_indicator)"], ["proof (state)\nthis:\n  emeasure M S * ennreal ((1 - e) * real N) =\n  \\<integral>\\<^sup>+x\\<in>S. ennreal ((1 - e) * real N)\\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  emeasure M S * ennreal ((1 - e) * real N) =\n  \\<integral>\\<^sup>+x\\<in>S. ennreal ((1 - e) * real N)\\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... \\<le> (\\<integral>\\<^sup>+x \\<in> S. ennreal(card {n\\<in>{..<N}. x \\<in> Og n}) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>S. ennreal ((1 - e) * real N)\\<partial>M\n    \\<le> \\<integral>\\<^sup>+x\\<in>S.\n                             ennreal\n                              (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n          \\<partial>M", "apply (rule nn_integral_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal ((1 - e) * real N) * indicator S x\n       \\<le> ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n})) *\n             indicator S x", "using I"], ["proof (prove)\nusing this:\n  ?x12 \\<in> S \\<Longrightarrow>\n  (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. ?x12 \\<in> Og n})\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal ((1 - e) * real N) * indicator S x\n       \\<le> ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n})) *\n             indicator S x", "unfolding indicator_def"], ["proof (prove)\nusing this:\n  ?x12 \\<in> S \\<Longrightarrow>\n  (1 - e) * real N \\<le> real (card {n \\<in> {..<N}. ?x12 \\<in> Og n})\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal ((1 - e) * real N) * (if x \\<in> S then 1 else 0)\n       \\<le> ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n})) *\n             (if x \\<in> S then 1 else 0)", "by (simp)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>S. ennreal ((1 - e) * real N)\\<partial>M\n  \\<le> \\<integral>\\<^sup>+x\\<in>S.\n                           ennreal\n                            (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n        \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>S. ennreal ((1 - e) * real N)\\<partial>M\n  \\<le> \\<integral>\\<^sup>+x\\<in>S.\n                           ennreal\n                            (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n        \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... \\<le> (\\<integral>\\<^sup>+x \\<in> space M. ennreal(card {n\\<in>{..<N}. x \\<in> Og n}) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>S.\n                       ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n    \\<partial>M\n    \\<le> \\<integral>\\<^sup>+x\\<in>space M.\n                             ennreal\n                              (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n          \\<partial>M", "by (rule nn_set_integral_set_mono, simp only: sets.sets_into_space[OF \\<open>S \\<in> sets M\\<close>])"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>S.\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n  \\<partial>M\n  \\<le> \\<integral>\\<^sup>+x\\<in>space M.\n                           ennreal\n                            (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n        \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>S.\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n  \\<partial>M\n  \\<le> \\<integral>\\<^sup>+x\\<in>space M.\n                           ennreal\n                            (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n        \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x. ennreal(card {n\\<in>{..<N}. x \\<in> Og n}) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>space M.\n                       ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n    \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal\n                            (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n                       \\<partial>M", "by (rule nn_set_integral_space)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>space M.\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n  \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>space M.\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n  \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x. ennreal (\\<Sum>n\\<in>{..<N}. ((indicator (Og n) x)::nat)) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal\n                            (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Og n) x))\n                       \\<partial>M", "apply (rule nn_integral_cong)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n})) =\n       ennreal (real (\\<Sum>n<N. indicator (Og n) x))", "using sum_indicator_eq_card2[of \"{..<N}\" Og]"], ["proof (prove)\nusing this:\n  finite {..<N} \\<Longrightarrow>\n  (\\<Sum>i<N. indicator (Og i) ?x) = card {i \\<in> {..<N}. ?x \\<in> Og i}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal (real (card {n \\<in> {..<N}. x \\<in> Og n})) =\n       ennreal (real (\\<Sum>n<N. indicator (Og n) x))", "by auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Og n) x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (real (card {n \\<in> {..<N}. x \\<in> Og n}))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Og n) x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x. (\\<Sum>n\\<in>{..<N}. indicator (Og n) x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Og n) x))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Og n) x) \\<partial>M", "apply (rule nn_integral_cong, auto, simp only: sum_ennreal[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       (\\<Sum>i<N. ennreal (real (indicator (Og i) x))) =\n       (\\<Sum>n<N. indicator (Og n) x)", "by (metis ennreal_0 ennreal_eq_1 indicator_eq_1_iff indicator_simps(2) real_of_nat_indicator)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Og n) x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Og n) x) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Og n) x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Og n) x) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<Sum>n \\<in>{..<N}. (\\<integral>\\<^sup>+x. (indicator (Og n) x) \\<partial>M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Og n) x) \\<partial>M =\n    (\\<Sum>n<N. integral\\<^sup>N M (indicator (Og n)))", "by (rule nn_integral_sum, simp)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Og n) x) \\<partial>M =\n  (\\<Sum>n<N. integral\\<^sup>N M (indicator (Og n)))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Og n) x) \\<partial>M =\n  (\\<Sum>n<N. integral\\<^sup>N M (indicator (Og n)))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<Sum>n \\<in>{..<N}. emeasure M (Og n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n<N. integral\\<^sup>N M (indicator (Og n))) =\n    (\\<Sum>n<N. emeasure M (Og n))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>n<N. integral\\<^sup>N M (indicator (Og n))) =\n  (\\<Sum>n<N. emeasure M (Og n))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  (\\<Sum>n<N. integral\\<^sup>N M (indicator (Og n))) =\n  (\\<Sum>n<N. emeasure M (Og n))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... \\<le> (\\<Sum>n \\<in>{..<N}. emeasure M (Pg n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n<N. emeasure M (Og n)) \\<le> (\\<Sum>n<N. emeasure M (Pg n))", "apply (rule sum_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {..<N} \\<Longrightarrow>\n       emeasure M (Og n) \\<le> emeasure M (Pg n)", "using \\<open>\\<And>n. emeasure M (Og n) \\<le> emeasure M (Pg n)\\<close>"], ["proof (prove)\nusing this:\n  emeasure M (Og ?n) \\<le> emeasure M (Pg ?n)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       n \\<in> {..<N} \\<Longrightarrow>\n       emeasure M (Og n) \\<le> emeasure M (Pg n)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>n<N. emeasure M (Og n)) \\<le> (\\<Sum>n<N. emeasure M (Pg n))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  (\\<Sum>n<N. emeasure M (Og n)) \\<le> (\\<Sum>n<N. emeasure M (Pg n))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<Sum>n \\<in>{..<N}. (\\<integral>\\<^sup>+x. (indicator (Pg n) x) \\<partial>M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n<N. emeasure M (Pg n)) =\n    (\\<Sum>n<N. integral\\<^sup>N M (indicator (Pg n)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>n<N. emeasure M (Pg n)) =\n  (\\<Sum>n<N. integral\\<^sup>N M (indicator (Pg n)))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  (\\<Sum>n<N. emeasure M (Pg n)) =\n  (\\<Sum>n<N. integral\\<^sup>N M (indicator (Pg n)))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x. (\\<Sum>n\\<in>{..<N}. indicator (Pg n) x) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n<N. integral\\<^sup>N M (indicator (Pg n))) =\n    \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Pg n) x) \\<partial>M", "by (rule nn_integral_sum[symmetric], simp)"], ["proof (state)\nthis:\n  (\\<Sum>n<N. integral\\<^sup>N M (indicator (Pg n))) =\n  \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Pg n) x) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  (\\<Sum>n<N. integral\\<^sup>N M (indicator (Pg n))) =\n  \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Pg n) x) \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x. ennreal (\\<Sum>n\\<in>{..<N}. ((indicator (Pg n) x)::nat)) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Pg n) x) \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Pg n) x))\n                       \\<partial>M", "apply (rule nn_integral_cong, auto, simp only: sum_ennreal[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       (\\<Sum>n<N. indicator (Pg n) x) =\n       (\\<Sum>i<N. ennreal (real (indicator (Pg i) x)))", "by (metis ennreal_0 ennreal_eq_1 indicator_eq_1_iff indicator_simps(2) real_of_nat_indicator)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Pg n) x) \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Pg n) x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. (\\<Sum>n<N. indicator (Pg n) x) \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Pg n) x))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x. ennreal(card {n\\<in>{..<N}. x \\<in> Pg n}) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Pg n) x))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+ x. ennreal\n                            (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n                       \\<partial>M", "apply (rule nn_integral_cong)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal (real (\\<Sum>n<N. indicator (Pg n) x)) =\n       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))", "using sum_indicator_eq_card2[of \"{..<N}\" Pg]"], ["proof (prove)\nusing this:\n  finite {..<N} \\<Longrightarrow>\n  (\\<Sum>i<N. indicator (Pg i) ?x) = card {i \\<in> {..<N}. ?x \\<in> Pg i}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal (real (\\<Sum>n<N. indicator (Pg n) x)) =\n       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))", "by auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Pg n) x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal (real (\\<Sum>n<N. indicator (Pg n) x))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+ x. ennreal\n                          (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n                     \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x \\<in> space M. ennreal(card {n\\<in>{..<N}. x \\<in> Pg n}) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. ennreal\n                            (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n                       \\<partial>M =\n    \\<integral>\\<^sup>+x\\<in>space M.\n                       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n    \\<partial>M", "by (rule nn_set_integral_space[symmetric])"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+x\\<in>space M.\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n  \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. ennreal\n                          (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n                     \\<partial>M =\n  \\<integral>\\<^sup>+x\\<in>space M.\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n  \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x \\<in> Bad N \\<union> (space M - Bad N). ennreal(card {n\\<in>{..<N}. x \\<in> Pg n}) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>space M.\n                       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n    \\<partial>M =\n    \\<integral>\\<^sup>+x\\<in>Bad N \\<union> (space M - Bad N).\n                       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n    \\<partial>M", "apply (rule nn_integral_cong)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n})) *\n       indicator (space M) x =\n       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n})) *\n       indicator (Bad N \\<union> (space M - Bad N)) x", "unfolding indicator_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space M \\<Longrightarrow>\n       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n})) *\n       (if x \\<in> space M then 1 else 0) =\n       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n})) *\n       (if x \\<in> Bad N \\<union> (space M - Bad N) then 1 else 0)", "by auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>space M.\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n  \\<partial>M =\n  \\<integral>\\<^sup>+x\\<in>Bad N \\<union> (space M - Bad N).\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n  \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>space M.\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n  \\<partial>M =\n  \\<integral>\\<^sup>+x\\<in>Bad N \\<union> (space M - Bad N).\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n  \\<partial>M\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = (\\<integral>\\<^sup>+x \\<in> Bad N. ennreal(card {n\\<in>{..<N}. x \\<in> Pg n}) \\<partial>M)\n                      + (\\<integral>\\<^sup>+x \\<in> space M - Bad N. ennreal(card {n\\<in>{..<N}. x \\<in> Pg n}) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>Bad N \\<union> (space M - Bad N).\n                       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n    \\<partial>M =\n    (\\<integral>\\<^sup>+x\\<in>Bad N.\n                        ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n     \\<partial>M) +\n    (\\<integral>\\<^sup>+x\\<in>space M - Bad N.\n                        ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n     \\<partial>M)", "by (rule nn_integral_disjoint_pair, auto)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>Bad N \\<union> (space M - Bad N).\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n  \\<partial>M =\n  (\\<integral>\\<^sup>+x\\<in>Bad N.\n                      ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n   \\<partial>M) +\n  (\\<integral>\\<^sup>+x\\<in>space M - Bad N.\n                      ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n   \\<partial>M)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>Bad N \\<union> (space M - Bad N).\n                     ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n  \\<partial>M =\n  (\\<integral>\\<^sup>+x\\<in>Bad N.\n                      ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n   \\<partial>M) +\n  (\\<integral>\\<^sup>+x\\<in>space M - Bad N.\n                      ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n   \\<partial>M)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... \\<le> (\\<integral>\\<^sup>+x \\<in> Bad N. ennreal((1-d) * real N) \\<partial>M) + (\\<integral>\\<^sup>+x \\<in> space M - Bad N. ennreal(real N) \\<partial>M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<integral>\\<^sup>+x\\<in>Bad N.\n                        ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n     \\<partial>M) +\n    (\\<integral>\\<^sup>+x\\<in>space M - Bad N.\n                        ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n     \\<partial>M)\n    \\<le> (\\<integral>\\<^sup>+x\\<in>Bad N. ennreal ((1 - d) * real N)\n           \\<partial>M) +\n          (\\<integral>\\<^sup>+x\\<in>space M - Bad N. ennreal (real N)\n           \\<partial>M)", "apply (rule add_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<integral>\\<^sup>+x\\<in>Bad N.\n                       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n    \\<partial>M\n    \\<le> \\<integral>\\<^sup>+x\\<in>Bad N. ennreal ((1 - d) * real N)\n          \\<partial>M\n 2. \\<integral>\\<^sup>+x\\<in>space M - Bad N.\n                       ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n    \\<partial>M\n    \\<le> \\<integral>\\<^sup>+x\\<in>space M - Bad N. ennreal (real N)\n          \\<partial>M", "apply (rule nn_integral_mono, simp add: Bad_def indicator_def, auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>space M - Bad N.\n                       ennreal (real (card {n. n < N \\<and> x \\<in> Pg n}))\n    \\<partial>M\n    \\<le> \\<integral>\\<^sup>+x\\<in>space M - Bad N. ennreal (real N)\n          \\<partial>M", "apply (rule nn_integral_mono, simp add: indicator_def, auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> space M; x \\<notin> Bad N\\<rbrakk>\n       \\<Longrightarrow> card {n. n < N \\<and> x \\<in> Pg n} \\<le> N", "using card_Collect_less_nat[of N] card_mono[of \"{n. n < N}\"]"], ["proof (prove)\nusing this:\n  card {i. i < N} = N\n  \\<lbrakk>finite {n. n < N}; ?A \\<subseteq> {n. n < N}\\<rbrakk>\n  \\<Longrightarrow> card ?A \\<le> card {n. n < N}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> space M; x \\<notin> Bad N\\<rbrakk>\n       \\<Longrightarrow> card {n. n < N \\<and> x \\<in> Pg n} \\<le> N", "by (simp add: Collect_mono_iff)"], ["proof (state)\nthis:\n  (\\<integral>\\<^sup>+x\\<in>Bad N.\n                      ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n   \\<partial>M) +\n  (\\<integral>\\<^sup>+x\\<in>space M - Bad N.\n                      ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n   \\<partial>M)\n  \\<le> (\\<integral>\\<^sup>+x\\<in>Bad N. ennreal ((1 - d) * real N)\n         \\<partial>M) +\n        (\\<integral>\\<^sup>+x\\<in>space M - Bad N. ennreal (real N)\n         \\<partial>M)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  (\\<integral>\\<^sup>+x\\<in>Bad N.\n                      ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n   \\<partial>M) +\n  (\\<integral>\\<^sup>+x\\<in>space M - Bad N.\n                      ennreal (real (card {n \\<in> {..<N}. x \\<in> Pg n}))\n   \\<partial>M)\n  \\<le> (\\<integral>\\<^sup>+x\\<in>Bad N. ennreal ((1 - d) * real N)\n         \\<partial>M) +\n        (\\<integral>\\<^sup>+x\\<in>space M - Bad N. ennreal (real N)\n         \\<partial>M)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = ennreal((1-d) * real N) * emeasure M (Bad N) + ennreal(real N) * emeasure M (space M - Bad N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<integral>\\<^sup>+x\\<in>Bad N. ennreal ((1 - d) * real N)\n     \\<partial>M) +\n    (\\<integral>\\<^sup>+x\\<in>space M - Bad N. ennreal (real N)\n     \\<partial>M) =\n    ennreal ((1 - d) * real N) * emeasure M (Bad N) +\n    ennreal (real N) * emeasure M (space M - Bad N)", "by (simp add: nn_integral_cmult_indicator)"], ["proof (state)\nthis:\n  (\\<integral>\\<^sup>+x\\<in>Bad N. ennreal ((1 - d) * real N)\\<partial>M) +\n  (\\<integral>\\<^sup>+x\\<in>space M - Bad N. ennreal (real N)\\<partial>M) =\n  ennreal ((1 - d) * real N) * emeasure M (Bad N) +\n  ennreal (real N) * emeasure M (space M - Bad N)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  (\\<integral>\\<^sup>+x\\<in>Bad N. ennreal ((1 - d) * real N)\\<partial>M) +\n  (\\<integral>\\<^sup>+x\\<in>space M - Bad N. ennreal (real N)\\<partial>M) =\n  ennreal ((1 - d) * real N) * emeasure M (Bad N) +\n  ennreal (real N) * emeasure M (space M - Bad N)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = ennreal((1-d) * real N) * ennreal(m) + ennreal(real N) * ennreal(1-m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal ((1 - d) * real N) * emeasure M (Bad N) +\n    ennreal (real N) * emeasure M (space M - Bad N) =\n    ennreal ((1 - d) * real N) * ennreal m +\n    ennreal (real N) * ennreal (1 - m)", "unfolding m_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal ((1 - d) * real N) * emeasure M (Bad N) +\n    ennreal (real N) * emeasure M (space M - Bad N) =\n    ennreal ((1 - d) * real N) * ennreal (prob (Bad N)) +\n    ennreal (real N) * ennreal (1 - prob (Bad N))", "by (simp add: emeasure_eq_measure prob_compl)"], ["proof (state)\nthis:\n  ennreal ((1 - d) * real N) * emeasure M (Bad N) +\n  ennreal (real N) * emeasure M (space M - Bad N) =\n  ennreal ((1 - d) * real N) * ennreal m +\n  ennreal (real N) * ennreal (1 - m)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  ennreal ((1 - d) * real N) * emeasure M (Bad N) +\n  ennreal (real N) * emeasure M (space M - Bad N) =\n  ennreal ((1 - d) * real N) * ennreal m +\n  ennreal (real N) * ennreal (1 - m)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = ennreal((1-d) * real N * m + real N * (1-m))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal ((1 - d) * real N) * ennreal m +\n    ennreal (real N) * ennreal (1 - m) =\n    ennreal ((1 - d) * real N * m + real N * (1 - m))", "using \\<open>m \\<ge> 0\\<close> \\<open>1-m \\<ge> 0\\<close> \\<open>d \\<le> 1\\<close> ennreal_plus ennreal_mult"], ["proof (prove)\nusing this:\n  0 \\<le> m\n  0 \\<le> 1 - m\n  d \\<le> 1\n  \\<lbrakk>0 \\<le> ?a; 0 \\<le> ?b\\<rbrakk>\n  \\<Longrightarrow> ennreal (?a + ?b) = ennreal ?a + ennreal ?b\n  \\<lbrakk>0 \\<le> ?a; 0 \\<le> ?b\\<rbrakk>\n  \\<Longrightarrow> ennreal (?a * ?b) = ennreal ?a * ennreal ?b\n\ngoal (1 subgoal):\n 1. ennreal ((1 - d) * real N) * ennreal m +\n    ennreal (real N) * ennreal (1 - m) =\n    ennreal ((1 - d) * real N * m + real N * (1 - m))", "by auto"], ["proof (state)\nthis:\n  ennreal ((1 - d) * real N) * ennreal m +\n  ennreal (real N) * ennreal (1 - m) =\n  ennreal ((1 - d) * real N * m + real N * (1 - m))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "finally"], ["proof (chain)\npicking this:\n  ennreal ((1 - e) * ((1 - e) * real N))\n  \\<le> ennreal ((1 - d) * real N * m + real N * (1 - m))", "have \"ennreal((1-e) * ((1-e) * real N)) \\<le> ennreal((1-d) * real N * m + real N * (1-m))\""], ["proof (prove)\nusing this:\n  ennreal ((1 - e) * ((1 - e) * real N))\n  \\<le> ennreal ((1 - d) * real N * m + real N * (1 - m))\n\ngoal (1 subgoal):\n 1. ennreal ((1 - e) * ((1 - e) * real N))\n    \\<le> ennreal ((1 - d) * real N * m + real N * (1 - m))", "by simp"], ["proof (state)\nthis:\n  ennreal ((1 - e) * ((1 - e) * real N))\n  \\<le> ennreal ((1 - d) * real N * m + real N * (1 - m))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "moreover"], ["proof (state)\nthis:\n  ennreal ((1 - e) * ((1 - e) * real N))\n  \\<le> ennreal ((1 - d) * real N * m + real N * (1 - m))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"(1-d) * real N * m + real N * (1-m) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (1 - d) * real N * m + real N * (1 - m)", "using \\<open>m \\<ge> 0\\<close> \\<open>1-m \\<ge> 0\\<close> \\<open>d \\<le> 1\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> m\n  0 \\<le> 1 - m\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> (1 - d) * real N * m + real N * (1 - m)", "by auto"], ["proof (state)\nthis:\n  0 \\<le> (1 - d) * real N * m + real N * (1 - m)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "ultimately"], ["proof (chain)\npicking this:\n  ennreal ((1 - e) * ((1 - e) * real N))\n  \\<le> ennreal ((1 - d) * real N * m + real N * (1 - m))\n  0 \\<le> (1 - d) * real N * m + real N * (1 - m)", "have \"(1-e) * ((1-e) * real N) \\<le> (1-d) * real N * m + real N * (1-m)\""], ["proof (prove)\nusing this:\n  ennreal ((1 - e) * ((1 - e) * real N))\n  \\<le> ennreal ((1 - d) * real N * m + real N * (1 - m))\n  0 \\<le> (1 - d) * real N * m + real N * (1 - m)\n\ngoal (1 subgoal):\n 1. (1 - e) * ((1 - e) * real N)\n    \\<le> (1 - d) * real N * m + real N * (1 - m)", "using ennreal_le_iff"], ["proof (prove)\nusing this:\n  ennreal ((1 - e) * ((1 - e) * real N))\n  \\<le> ennreal ((1 - d) * real N * m + real N * (1 - m))\n  0 \\<le> (1 - d) * real N * m + real N * (1 - m)\n  0 \\<le> ?y \\<Longrightarrow> (ennreal ?x \\<le> ennreal ?y) = (?x \\<le> ?y)\n\ngoal (1 subgoal):\n 1. (1 - e) * ((1 - e) * real N)\n    \\<le> (1 - d) * real N * m + real N * (1 - m)", "by auto"], ["proof (state)\nthis:\n  (1 - e) * ((1 - e) * real N) \\<le> (1 - d) * real N * m + real N * (1 - m)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  (1 - e) * ((1 - e) * real N) \\<le> (1 - d) * real N * m + real N * (1 - m)", "have \"0 \\<le> (e * 2 - d * m - e * e) * real N\""], ["proof (prove)\nusing this:\n  (1 - e) * ((1 - e) * real N) \\<le> (1 - d) * real N * m + real N * (1 - m)\n\ngoal (1 subgoal):\n 1. 0 \\<le> (e * 2 - d * m - e * e) * real N", "by (auto simp add: algebra_simps)"], ["proof (state)\nthis:\n  0 \\<le> (e * 2 - d * m - e * e) * real N\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  0 \\<le> (e * 2 - d * m - e * e) * real N", "have \"0 \\<le> e * 2 - d * m - e * e\""], ["proof (prove)\nusing this:\n  0 \\<le> (e * 2 - d * m - e * e) * real N\n\ngoal (1 subgoal):\n 1. 0 \\<le> e * 2 - d * m - e * e", "using \\<open>N \\<ge> 1\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> (e * 2 - d * m - e * e) * real N\n  1 \\<le> N\n\ngoal (1 subgoal):\n 1. 0 \\<le> e * 2 - d * m - e * e", "by (simp add: zero_le_mult_iff)"], ["proof (state)\nthis:\n  0 \\<le> e * 2 - d * m - e * e\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  0 \\<le> e * 2 - d * m - e * e\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... \\<le> e * 2 - d * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e * 2 - d * m - e * e \\<le> e * 2 - d * m", "using \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < e\n\ngoal (1 subgoal):\n 1. e * 2 - d * m - e * e \\<le> e * 2 - d * m", "by auto"], ["proof (state)\nthis:\n  e * 2 - d * m - e * e \\<le> e * 2 - d * m\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "finally"], ["proof (chain)\npicking this:\n  0 \\<le> e * 2 - d * m", "have \"m \\<le> e * 2 / d\""], ["proof (prove)\nusing this:\n  0 \\<le> e * 2 - d * m\n\ngoal (1 subgoal):\n 1. m \\<le> e * 2 / d", "using \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> e * 2 - d * m\n  0 < d\n\ngoal (1 subgoal):\n 1. m \\<le> e * 2 / d", "by (auto simp add: algebra_simps divide_simps)"], ["proof (state)\nthis:\n  m \\<le> e * 2 / d\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  m \\<le> e * 2 / d", "have \"m \\<le> d\""], ["proof (prove)\nusing this:\n  m \\<le> e * 2 / d\n\ngoal (1 subgoal):\n 1. m \\<le> d", "unfolding e_def"], ["proof (prove)\nusing this:\n  m \\<le> d * d / 2 * 2 / d\n\ngoal (1 subgoal):\n 1. m \\<le> d", "using \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  m \\<le> d * d / 2 * 2 / d\n  0 < d\n\ngoal (1 subgoal):\n 1. m \\<le> d", "by (auto simp add: divide_simps)"], ["proof (state)\nthis:\n  m \\<le> d\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  m \\<le> d", "have \"emeasure M (Bad N) \\<le> d\""], ["proof (prove)\nusing this:\n  m \\<le> d\n\ngoal (1 subgoal):\n 1. emeasure M (Bad N) \\<le> ennreal d", "unfolding m_def"], ["proof (prove)\nusing this:\n  prob (Bad N) \\<le> d\n\ngoal (1 subgoal):\n 1. emeasure M (Bad N) \\<le> ennreal d", "by (simp add: emeasure_eq_measure ennreal_leI)"], ["proof (state)\nthis:\n  emeasure M (Bad N) \\<le> ennreal d\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "}"], ["proof (state)\nthis:\n  1 \\<le> ?N14 \\<Longrightarrow> emeasure M (Bad ?N14) \\<le> ennreal d\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  1 \\<le> ?N14 \\<Longrightarrow> emeasure M (Bad ?N14) \\<le> ennreal d", "have \"emeasure M (\\<Union>i. Bad i) \\<le> d\""], ["proof (prove)\nusing this:\n  1 \\<le> ?N14 \\<Longrightarrow> emeasure M (Bad ?N14) \\<le> ennreal d\n\ngoal (1 subgoal):\n 1. emeasure M (\\<Union> (range Bad)) \\<le> ennreal d", "using LIMSEQ_le_const2[OF Lim_emeasure_incseq[OF \\<open>range Bad \\<subseteq> sets M\\<close> \\<open>incseq Bad\\<close>]]"], ["proof (prove)\nusing this:\n  1 \\<le> ?N14 \\<Longrightarrow> emeasure M (Bad ?N14) \\<le> ennreal d\n  \\<exists>N.\n     \\<forall>n\\<ge>N. emeasure M (Bad n) \\<le> ?a \\<Longrightarrow>\n  emeasure M (\\<Union> (range Bad)) \\<le> ?a\n\ngoal (1 subgoal):\n 1. emeasure M (\\<Union> (range Bad)) \\<le> ennreal d", "by auto"], ["proof (state)\nthis:\n  emeasure M (\\<Union> (range Bad)) \\<le> ennreal d\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  emeasure M (\\<Union> (range Bad)) \\<le> ennreal d", "have \"emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} < 1-d} \\<le> d\""], ["proof (prove)\nusing this:\n  emeasure M (\\<Union> (range Bad)) \\<le> ennreal d\n\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<forall>l\\<in>{1..n}.\n              - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n      < 1 - d}\n    \\<le> ennreal d", "using emeasure_mono[OF inc, of M]"], ["proof (prove)\nusing this:\n  emeasure M (\\<Union> (range Bad)) \\<le> ennreal d\n  \\<Union> (range Bad) \\<in> events \\<Longrightarrow>\n  emeasure M\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n  \\<le> emeasure M (\\<Union> (range Bad))\n\ngoal (1 subgoal):\n 1. emeasure M\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<forall>l\\<in>{1..n}.\n              - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n      < 1 - d}\n    \\<le> ennreal d", "by auto"], ["proof (state)\nthis:\n  emeasure M\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n  \\<le> ennreal d\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  emeasure M\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n  \\<le> ennreal d", "have *: \"measure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} < 1-d} \\<le> d\""], ["proof (prove)\nusing this:\n  emeasure M\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n  \\<le> ennreal d\n\ngoal (1 subgoal):\n 1. prob\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<forall>l\\<in>{1..n}.\n              - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n      < 1 - d}\n    \\<le> d", "using emeasure_eq_measure \\<open>d>0\\<close>"], ["proof (prove)\nusing this:\n  emeasure M\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n  \\<le> ennreal d\n  emeasure M ?A = ennreal (prob ?A)\n  0 < d\n\ngoal (1 subgoal):\n 1. prob\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<forall>l\\<in>{1..n}.\n              - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n      < 1 - d}\n    \\<le> d", "by fastforce"], ["proof (state)\nthis:\n  prob\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n  \\<le> d\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"{x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} \\<ge> 1-d}\n        = space M - {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} < 1-d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n    space M -\n    {x \\<in> space M.\n     upper_asymptotic_density\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n     < 1 - d}", "by auto"], ["proof (state)\nthis:\n  {x \\<in> space M.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n  space M -\n  {x \\<in> space M.\n   upper_asymptotic_density\n    {n. \\<forall>l\\<in>{1..n}.\n           - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n   < 1 - d}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  {x \\<in> space M.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n  space M -\n  {x \\<in> space M.\n   upper_asymptotic_density\n    {n. \\<forall>l\\<in>{1..n}.\n           - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n   < 1 - d}", "have \"measure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} \\<ge> 1-d}\n    = measure M (space M - {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} < 1-d})\""], ["proof (prove)\nusing this:\n  {x \\<in> space M.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n  space M -\n  {x \\<in> space M.\n   upper_asymptotic_density\n    {n. \\<forall>l\\<in>{1..n}.\n           - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n   < 1 - d}\n\ngoal (1 subgoal):\n 1. prob\n     {x \\<in> space M.\n      1 - d\n      \\<le> upper_asymptotic_density\n             {n. \\<forall>l\\<in>{1..n}.\n                    - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n    prob\n     (space M -\n      {x \\<in> space M.\n       upper_asymptotic_density\n        {n. \\<forall>l\\<in>{1..n}.\n               - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n       < 1 - d})", "by simp"], ["proof (state)\nthis:\n  prob\n   {x \\<in> space M.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n  prob\n   (space M -\n    {x \\<in> space M.\n     upper_asymptotic_density\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n     < 1 - d})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  prob\n   {x \\<in> space M.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n  prob\n   (space M -\n    {x \\<in> space M.\n     upper_asymptotic_density\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n     < 1 - d})\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = measure M (space M)\n    - measure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} < 1-d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob\n     (space M -\n      {x \\<in> space M.\n       upper_asymptotic_density\n        {n. \\<forall>l\\<in>{1..n}.\n               - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n       < 1 - d}) =\n    prob (space M) -\n    prob\n     {x \\<in> space M.\n      upper_asymptotic_density\n       {n. \\<forall>l\\<in>{1..n}.\n              - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n      < 1 - d}", "by (rule measure_Diff, auto)"], ["proof (state)\nthis:\n  prob\n   (space M -\n    {x \\<in> space M.\n     upper_asymptotic_density\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n     < 1 - d}) =\n  prob (space M) -\n  prob\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  prob\n   (space M -\n    {x \\<in> space M.\n     upper_asymptotic_density\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n     < 1 - d}) =\n  prob (space M) -\n  prob\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... \\<ge> 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 - d\n    \\<le> prob (space M) -\n          prob\n           {x \\<in> space M.\n            upper_asymptotic_density\n             {n. \\<forall>l\\<in>{1..n}.\n                    - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n            < 1 - d}", "using * prob_space"], ["proof (prove)\nusing this:\n  prob\n   {x \\<in> space M.\n    upper_asymptotic_density\n     {n. \\<forall>l\\<in>{1..n}.\n            - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n    < 1 - d}\n  \\<le> d\n  prob (space M) = 1\n\ngoal (1 subgoal):\n 1. 1 - d\n    \\<le> prob (space M) -\n          prob\n           {x \\<in> space M.\n            upper_asymptotic_density\n             {n. \\<forall>l\\<in>{1..n}.\n                    - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n            < 1 - d}", "by linarith"], ["proof (state)\nthis:\n  1 - d\n  \\<le> prob (space M) -\n        prob\n         {x \\<in> space M.\n          upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n          < 1 - d}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "finally"], ["proof (chain)\npicking this:\n  1 - d\n  \\<le> prob\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}", "have \"emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} \\<ge> 1-d} \\<ge> 1 - d\""], ["proof (prove)\nusing this:\n  1 - d\n  \\<le> prob\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "using emeasure_eq_measure"], ["proof (prove)\nusing this:\n  1 - d\n  \\<le> prob\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n  emeasure M ?A = ennreal (prob ?A)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "using d(1) d(2)"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n  0 < delta ?l12\n  delta \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "by blast"], ["proof (state)\nthis:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     ennreal (1 - d)\n     \\<le> emeasure M\n            {x \\<in> space M.\n             1 - d\n             \\<le> upper_asymptotic_density\n                    {n. \\<forall>l\\<in>{1..n}.\n                           - delta l * real l\n                           < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Now, we want to remove the invertibility assumption in the previous lemma. The idea is to\ngo to the natural extension of the system, use the result there and project it back.\nHowever, if the system is not defined on a polish space, there is no reason why it should have\na natural extension, so we have first to project the original system on a polish space on which\nthe subcocycle is defined. This system is obtained by considering the joint distribution of the\nsubcocycle and all its iterates (this is indeed a polish system, as a space of functions from\n$\\mathbb{N}^2$ to $\\mathbb{R}$).\\<close>"], ["", "lemma upper_density_good_direction:\n  assumes \"d>(0::real)\" \"d \\<le> 1\"\n  shows \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l} \\<ge> 1-d} \\<ge> ennreal(1-d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define U where \"U = (\\<lambda>x. (\\<lambda>n. u n x))\""], ["proof (state)\nthis:\n  U = (\\<lambda>x n. u n x)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define projJ where \"projJ = (\\<lambda>x. (\\<lambda>n. U ((T^^n)x)))\""], ["proof (state)\nthis:\n  projJ = (\\<lambda>x n. U ((T ^^ n) x))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define MJ where \"MJ = (distr M borel (\\<lambda>x. (\\<lambda>n. U ((T^^n)x))))\""], ["proof (state)\nthis:\n  MJ = distr M borel (\\<lambda>x n. U ((T ^^ n) x))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define TJ::\"(nat \\<Rightarrow> nat \\<Rightarrow> real) \\<Rightarrow> (nat \\<Rightarrow> nat \\<Rightarrow> real)\" where \"TJ = nat_left_shift\""], ["proof (state)\nthis:\n  TJ = nat_left_shift\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have *: \"mpt_factor projJ MJ TJ\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mpt_factor projJ MJ TJ", "unfolding projJ_def MJ_def TJ_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. mpt_factor (\\<lambda>x n. U ((T ^^ n) x))\n     (distr M borel (\\<lambda>x n. U ((T ^^ n) x))) nat_left_shift", "apply (rule fmpt_factor_projection)"], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable borel U", "unfolding U_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. random_variable borel (\\<lambda>a b. u b a)", "by (rule measurable_coordinatewise_then_product, simp)"], ["proof (state)\nthis:\n  mpt_factor projJ MJ TJ\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "interpret J: polish_pmpt MJ TJ"], ["proof (prove)\ngoal (1 subgoal):\n 1. polish_pmpt MJ TJ", "unfolding projJ_def polish_pmpt_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. pmpt MJ TJ \\<and> polish_pmpt_axioms MJ", "apply (auto)"], ["proof (prove)\ngoal (2 subgoals):\n 1. pmpt MJ TJ\n 2. polish_pmpt_axioms MJ", "apply (rule pmpt_factor)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mpt_factor ?proj2 MJ TJ\n 2. polish_pmpt_axioms MJ", "using *"], ["proof (prove)\nusing this:\n  mpt_factor projJ MJ TJ\n\ngoal (2 subgoals):\n 1. mpt_factor ?proj2 MJ TJ\n 2. polish_pmpt_axioms MJ", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. polish_pmpt_axioms MJ", "unfolding polish_pmpt_axioms_def MJ_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. sets (distr M borel (\\<lambda>x n. U ((T ^^ n) x))) = sets borel", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have [simp]: \"projJ \\<in> measure_preserving M MJ\""], ["proof (prove)\ngoal (1 subgoal):\n 1. projJ \\<in> measure_preserving M MJ", "using mpt_factorE(1)[OF *]"], ["proof (prove)\nusing this:\n  projJ \\<in> measure_preserving M MJ\n\ngoal (1 subgoal):\n 1. projJ \\<in> measure_preserving M MJ", "by simp"], ["proof (state)\nthis:\n  projJ \\<in> measure_preserving M MJ\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  projJ \\<in> measure_preserving M MJ", "have [measurable]: \"projJ \\<in> measurable M MJ\""], ["proof (prove)\nusing this:\n  projJ \\<in> measure_preserving M MJ\n\ngoal (1 subgoal):\n 1. random_variable MJ projJ", "by (simp add: measure_preservingE(1))"], ["proof (state)\nthis:\n  random_variable MJ projJ\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "text \\<open>We define a subcocycle $uJ$ in the projection corresponding to the original\n        subcocycle $u$ above. (With the natural definition, it is only a subcocycle almost\n        everywhere.) We check that it shares most properties of $u$.\\<close>"], ["proof (state)\nthis:\n  random_variable MJ projJ\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define uJ::\"nat \\<Rightarrow> (nat \\<Rightarrow> nat \\<Rightarrow> real) \\<Rightarrow> real\" where \"uJ = (\\<lambda>n x. x 0 n)\""], ["proof (state)\nthis:\n  uJ = (\\<lambda>n x. x 0 n)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have [measurable]: \"uJ n \\<in> borel_measurable borel\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. uJ n \\<in> borel_measurable borel", "unfolding uJ_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. x 0 n) \\<in> borel_measurable borel", "by (metis measurable_product_coordinates measurable_product_then_coordinatewise)"], ["proof (state)\nthis:\n  uJ ?n12 \\<in> borel_measurable borel\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "moreover"], ["proof (state)\nthis:\n  uJ ?n12 \\<in> borel_measurable borel\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"measurable borel borel = measurable MJ borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. borel_measurable borel = borel_measurable MJ", "apply (rule measurable_cong_sets)"], ["proof (prove)\ngoal (2 subgoals):\n 1. sets borel = J.events\n 2. sets borel = sets borel", "unfolding MJ_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. sets borel = sets (distr M borel (\\<lambda>x n. U ((T ^^ n) x)))\n 2. sets borel = sets borel", "by auto"], ["proof (state)\nthis:\n  borel_measurable borel = borel_measurable MJ\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "ultimately"], ["proof (chain)\npicking this:\n  uJ ?n12 \\<in> borel_measurable borel\n  borel_measurable borel = borel_measurable MJ", "have [measurable]: \"uJ n \\<in> borel_measurable MJ\" for n"], ["proof (prove)\nusing this:\n  uJ ?n12 \\<in> borel_measurable borel\n  borel_measurable borel = borel_measurable MJ\n\ngoal (1 subgoal):\n 1. J.random_variable borel (uJ n)", "by fast"], ["proof (state)\nthis:\n  J.random_variable borel (uJ ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have uJ_proj: \"u n x = uJ n (projJ x)\" for n x"], ["proof (prove)\ngoal (1 subgoal):\n 1. u n x = uJ n (projJ x)", "unfolding uJ_def projJ_def U_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. u n x = u n ((T ^^ 0) x)", "by auto"], ["proof (state)\nthis:\n  u ?n13 ?x13 = uJ ?n13 (projJ ?x13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have uJ_int: \"integrable MJ (uJ n)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable MJ (uJ n)", "apply (rule measure_preserving_preserves_integral'(1)[OF \\<open>projJ \\<in> measure_preserving M MJ\\<close>])"], ["proof (prove)\ngoal (2 subgoals):\n 1. integrable M (\\<lambda>x. uJ n (projJ x))\n 2. J.random_variable borel (uJ n)", "apply (subst uJ_proj[of n, symmetric])"], ["proof (prove)\ngoal (2 subgoals):\n 1. integrable M (u n)\n 2. J.random_variable borel (uJ n)", "using int_u[of n]"], ["proof (prove)\nusing this:\n  integrable M (u n)\n\ngoal (2 subgoals):\n 1. integrable M (u n)\n 2. J.random_variable borel (uJ n)", "by auto"], ["proof (state)\nthis:\n  integrable MJ (uJ ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have uJ_int2: \"(\\<integral>x. uJ n x \\<partial>MJ) = (\\<integral>x. u n x \\<partial>M)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. J.expectation (uJ n) = expectation (u n)", "unfolding uJ_proj"], ["proof (prove)\ngoal (1 subgoal):\n 1. J.expectation (uJ n) = expectation (\\<lambda>x. uJ n (projJ x))", "apply (rule measure_preserving_preserves_integral'(2)[OF \\<open>projJ \\<in> measure_preserving M MJ\\<close>])"], ["proof (prove)\ngoal (2 subgoals):\n 1. integrable M (\\<lambda>x. uJ n (projJ x))\n 2. J.random_variable borel (uJ n)", "apply (subst uJ_proj[of n, symmetric])"], ["proof (prove)\ngoal (2 subgoals):\n 1. integrable M (u n)\n 2. J.random_variable borel (uJ n)", "using int_u[of n]"], ["proof (prove)\nusing this:\n  integrable M (u n)\n\ngoal (2 subgoals):\n 1. integrable M (u n)\n 2. J.random_variable borel (uJ n)", "by auto"], ["proof (state)\nthis:\n  J.expectation (uJ ?n13) = expectation (u ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have uJ_AE: \"AE x in MJ. uJ (n+m) x \\<le> uJ n x + uJ m ((TJ^^n) x)\" for m n"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "have \"AE x in M. uJ (n+m) (projJ x) \\<le> uJ n (projJ x) + uJ m (projJ ((T^^n) x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. uJ (n + m) (projJ x)\n               \\<le> uJ n (projJ x) + uJ m (projJ ((T ^^ n) x))", "unfolding uJ_proj[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. u (n + m) x \\<le> u n x + u m ((T ^^ n) x)", "using subcocycle_ineq[OF subu]"], ["proof (prove)\nusing this:\n  u (?n + ?m) ?x \\<le> u ?n ?x + u ?m ((T ^^ ?n) ?x)\n\ngoal (1 subgoal):\n 1. AE x in M. u (n + m) x \\<le> u n x + u m ((T ^^ n) x)", "by auto"], ["proof (state)\nthis:\n  AE x in M. uJ (n + m) (projJ x)\n             \\<le> uJ n (projJ x) + uJ m (projJ ((T ^^ n) x))\n\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "moreover"], ["proof (state)\nthis:\n  AE x in M. uJ (n + m) (projJ x)\n             \\<le> uJ n (projJ x) + uJ m (projJ ((T ^^ n) x))\n\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "have \"AE x in M. projJ ((T^^n) x) = (TJ^^n) (projJ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x)", "using qmpt_factor_iterates[OF mpt_factor_is_qmpt_factor[OF *]]"], ["proof (prove)\nusing this:\n  AE x in M. \\<forall>n. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x)\n\ngoal (1 subgoal):\n 1. AE x in M. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x)", "by auto"], ["proof (state)\nthis:\n  AE x in M. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x)\n\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. uJ (n + m) (projJ x)\n             \\<le> uJ n (projJ x) + uJ m (projJ ((T ^^ n) x))\n  AE x in M. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x)", "have *: \"AE x in M. uJ (n+m) (projJ x) \\<le> uJ n (projJ x) + uJ m ((TJ^^n) (projJ x))\""], ["proof (prove)\nusing this:\n  AE x in M. uJ (n + m) (projJ x)\n             \\<le> uJ n (projJ x) + uJ m (projJ ((T ^^ n) x))\n  AE x in M. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x)\n\ngoal (1 subgoal):\n 1. AE x in M. uJ (n + m) (projJ x)\n               \\<le> uJ n (projJ x) + uJ m ((TJ ^^ n) (projJ x))", "by auto"], ["proof (state)\nthis:\n  AE x in M. uJ (n + m) (projJ x)\n             \\<le> uJ n (projJ x) + uJ m ((TJ ^^ n) (projJ x))\n\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "apply (rule quasi_measure_preserving_AE'[OF measure_preserving_is_quasi_measure_preserving[OF \\<open>projJ \\<in> measure_preserving M MJ\\<close>], OF *])"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)}\n    \\<in> J.events", "by auto"], ["proof (state)\nthis:\n  AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  AE x in MJ. uJ (?n13 + ?m13) x \\<le> uJ ?n13 x + uJ ?m13 ((TJ ^^ ?n13) x)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have uJ_0: \"AE x in MJ. (\\<lambda>n. uJ n x / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "have \"AE x in M. (\\<lambda>n. u n x / n) \\<longlonglongrightarrow> subcocycle_lim u x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. u n x / real n)\n               \\<longlonglongrightarrow> subcocycle_lim u x", "by (rule kingman_theorem_nonergodic(1)[OF subu subu_fin])"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. u n x / real n)\n             \\<longlonglongrightarrow> subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "moreover"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. u n x / real n)\n             \\<longlonglongrightarrow> subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "have \"AE x in M. subcocycle_lim u x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim u x = 0", "using subu_0"], ["proof (prove)\nusing this:\n  AE x in M. subcocycle_lim u x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim u x = 0", "by simp"], ["proof (state)\nthis:\n  AE x in M. subcocycle_lim u x = 0\n\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. (\\<lambda>n. u n x / real n)\n             \\<longlonglongrightarrow> subcocycle_lim u x\n  AE x in M. subcocycle_lim u x = 0", "have *: \"AE x in M. (\\<lambda>n. uJ n (projJ x) / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. u n x / real n)\n             \\<longlonglongrightarrow> subcocycle_lim u x\n  AE x in M. subcocycle_lim u x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. uJ n (projJ x) / real n)\n               \\<longlonglongrightarrow> 0", "unfolding uJ_proj"], ["proof (prove)\nusing this:\n  AE x in M. (\\<lambda>n. uJ n (projJ x) / real n)\n             \\<longlonglongrightarrow> subcocycle_lim\n  (\\<lambda>n x. uJ n (projJ x)) x\n  AE x in M. subcocycle_lim (\\<lambda>n x. uJ n (projJ x)) x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. (\\<lambda>n. uJ n (projJ x) / real n)\n               \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  AE x in M. (\\<lambda>n. uJ n (projJ x) / real n)\n             \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "apply (rule quasi_measure_preserving_AE'[OF measure_preserving_is_quasi_measure_preserving[OF \\<open>projJ \\<in> measure_preserving M MJ\\<close>], OF *])"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space MJ.\n     (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0}\n    \\<in> J.events", "by auto"], ["proof (state)\nthis:\n  AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "text \\<open>Then, we go to the natural extension of $TJ$, to have an invertible system.\\<close>"], ["proof (state)\nthis:\n  AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define MI where \"MI = J.natural_extension_measure\""], ["proof (state)\nthis:\n  MI = J.natural_extension_measure\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define TI where \"TI = J.natural_extension_map\""], ["proof (state)\nthis:\n  TI = J.natural_extension_map\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define projI where \"projI = J.natural_extension_proj\""], ["proof (state)\nthis:\n  projI = J.natural_extension_proj\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "interpret I: pmpt MI TI"], ["proof (prove)\ngoal (1 subgoal):\n 1. pmpt MI TI", "unfolding MI_def TI_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. pmpt J.natural_extension_measure J.natural_extension_map", "by (rule J.natural_extension(1))"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"I.mpt_factor projI MJ TJ\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I.mpt_factor projI MJ TJ", "unfolding projI_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. I.mpt_factor J.natural_extension_proj MJ TJ", "using I.mpt_factorE(1) J.natural_extension(3) MI_def TI_def"], ["proof (prove)\nusing this:\n  I.mpt_factor ?proj ?M2.0 ?T2.0 \\<Longrightarrow>\n  ?proj \\<in> measure_preserving MI ?M2.0\n  mpt.mpt_factor J.natural_extension_measure J.natural_extension_map\n   J.natural_extension_proj MJ TJ\n  MI = J.natural_extension_measure\n  TI = J.natural_extension_map\n\ngoal (1 subgoal):\n 1. I.mpt_factor J.natural_extension_proj MJ TJ", "by auto"], ["proof (state)\nthis:\n  I.mpt_factor projI MJ TJ\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  I.mpt_factor projI MJ TJ", "have [simp]: \"projI \\<in> measure_preserving MI MJ\""], ["proof (prove)\nusing this:\n  I.mpt_factor projI MJ TJ\n\ngoal (1 subgoal):\n 1. projI \\<in> measure_preserving MI MJ", "using I.mpt_factorE(1)"], ["proof (prove)\nusing this:\n  I.mpt_factor projI MJ TJ\n  I.mpt_factor ?proj ?M2.0 ?T2.0 \\<Longrightarrow>\n  ?proj \\<in> measure_preserving MI ?M2.0\n\ngoal (1 subgoal):\n 1. projI \\<in> measure_preserving MI MJ", "by auto"], ["proof (state)\nthis:\n  projI \\<in> measure_preserving MI MJ\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  projI \\<in> measure_preserving MI MJ", "have [measurable]: \"projI \\<in> measurable MI MJ\""], ["proof (prove)\nusing this:\n  projI \\<in> measure_preserving MI MJ\n\ngoal (1 subgoal):\n 1. I.random_variable MJ projI", "by (simp add: measure_preservingE(1))"], ["proof (state)\nthis:\n  I.random_variable MJ projI\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"I.invertible_qmpt\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I.invertible_qmpt", "using J.natural_extension(2) MI_def TI_def"], ["proof (prove)\nusing this:\n  qmpt.invertible_qmpt J.natural_extension_measure J.natural_extension_map\n  MI = J.natural_extension_measure\n  TI = J.natural_extension_map\n\ngoal (1 subgoal):\n 1. I.invertible_qmpt", "by auto"], ["proof (state)\nthis:\n  I.invertible_qmpt\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "text \\<open>We define a natural subcocycle $uI$ there, and check its properties.\\<close>"], ["proof (state)\nthis:\n  I.invertible_qmpt\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "define uI where uI_proj: \"uI = (\\<lambda>n x. uJ n (projI x))\""], ["proof (state)\nthis:\n  uI = (\\<lambda>n x. uJ n (projI x))\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have [measurable]: \"uI n \\<in> borel_measurable MI\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. I.random_variable borel (uI n)", "unfolding uI_proj"], ["proof (prove)\ngoal (1 subgoal):\n 1. I.random_variable borel (\\<lambda>x. uJ n (projI x))", "by auto"], ["proof (state)\nthis:\n  I.random_variable borel (uI ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have uI_int: \"integrable MI (uI n)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable MI (uI n)", "unfolding uI_proj"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable MI (\\<lambda>x. uJ n (projI x))", "by (rule measure_preserving_preserves_integral(1)[OF \\<open>projI \\<in> measure_preserving MI MJ\\<close> uJ_int])"], ["proof (state)\nthis:\n  integrable MI (uI ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"(\\<integral>x. uJ n x \\<partial>MJ) = (\\<integral>x. uI n x \\<partial>MI)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. J.expectation (uJ n) = I.expectation (uI n)", "unfolding uI_proj"], ["proof (prove)\ngoal (1 subgoal):\n 1. J.expectation (uJ n) = I.expectation (\\<lambda>x. uJ n (projI x))", "by (rule measure_preserving_preserves_integral(2)[OF \\<open>projI \\<in> measure_preserving MI MJ\\<close> uJ_int])"], ["proof (state)\nthis:\n  J.expectation (uJ ?n13) = I.expectation (uI ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  J.expectation (uJ ?n13) = I.expectation (uI ?n13)", "have uI_int2: \"(\\<integral>x. uI n x \\<partial>MI) = (\\<integral>x. u n x \\<partial>M)\" for n"], ["proof (prove)\nusing this:\n  J.expectation (uJ ?n13) = I.expectation (uI ?n13)\n\ngoal (1 subgoal):\n 1. I.expectation (uI n) = expectation (u n)", "using uJ_int2"], ["proof (prove)\nusing this:\n  J.expectation (uJ ?n13) = I.expectation (uI ?n13)\n  J.expectation (uJ ?n13) = expectation (u ?n13)\n\ngoal (1 subgoal):\n 1. I.expectation (uI n) = expectation (u n)", "by simp"], ["proof (state)\nthis:\n  I.expectation (uI ?n13) = expectation (u ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have uI_AE: \"AE x in MI. uI (n+m) x \\<le> uI n x + uI m (((TI)^^n) x)\" for m n"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. uI (n + m) x \\<le> uI n x + uI m ((TI ^^ n) x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in MI. uI (n + m) x \\<le> uI n x + uI m ((TI ^^ n) x)", "have \"AE x in MI. uJ (n+m) (projI x) \\<le> uJ n (projI x) + uJ m (((TJ)^^n) (projI x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. uJ (n + m) (projI x)\n                \\<le> uJ n (projI x) + uJ m ((TJ ^^ n) (projI x))", "apply (rule quasi_measure_preserving_AE[OF measure_preserving_is_quasi_measure_preserving[OF \\<open>projI \\<in> measure_preserving MI MJ\\<close>]])"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "using uJ_AE"], ["proof (prove)\nusing this:\n  AE x in MJ. uJ (?n13 + ?m13) x \\<le> uJ ?n13 x + uJ ?m13 ((TJ ^^ ?n13) x)\n\ngoal (1 subgoal):\n 1. AE x in MJ. uJ (n + m) x \\<le> uJ n x + uJ m ((TJ ^^ n) x)", "by auto"], ["proof (state)\nthis:\n  AE x in MI. uJ (n + m) (projI x)\n              \\<le> uJ n (projI x) + uJ m ((TJ ^^ n) (projI x))\n\ngoal (1 subgoal):\n 1. AE x in MI. uI (n + m) x \\<le> uI n x + uI m ((TI ^^ n) x)", "moreover"], ["proof (state)\nthis:\n  AE x in MI. uJ (n + m) (projI x)\n              \\<le> uJ n (projI x) + uJ m ((TJ ^^ n) (projI x))\n\ngoal (1 subgoal):\n 1. AE x in MI. uI (n + m) x \\<le> uI n x + uI m ((TI ^^ n) x)", "have \"AE x in MI. ((TJ)^^n) (projI x) = projI (((TI)^^n) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. (TJ ^^ n) (projI x) = projI ((TI ^^ n) x)", "using I.qmpt_factor_iterates[OF I.mpt_factor_is_qmpt_factor[OF \\<open>I.mpt_factor projI MJ TJ\\<close>]]"], ["proof (prove)\nusing this:\n  AE x in MI. \\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x)\n\ngoal (1 subgoal):\n 1. AE x in MI. (TJ ^^ n) (projI x) = projI ((TI ^^ n) x)", "by auto"], ["proof (state)\nthis:\n  AE x in MI. (TJ ^^ n) (projI x) = projI ((TI ^^ n) x)\n\ngoal (1 subgoal):\n 1. AE x in MI. uI (n + m) x \\<le> uI n x + uI m ((TI ^^ n) x)", "ultimately"], ["proof (chain)\npicking this:\n  AE x in MI. uJ (n + m) (projI x)\n              \\<le> uJ n (projI x) + uJ m ((TJ ^^ n) (projI x))\n  AE x in MI. (TJ ^^ n) (projI x) = projI ((TI ^^ n) x)", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in MI. uJ (n + m) (projI x)\n              \\<le> uJ n (projI x) + uJ m ((TJ ^^ n) (projI x))\n  AE x in MI. (TJ ^^ n) (projI x) = projI ((TI ^^ n) x)\n\ngoal (1 subgoal):\n 1. AE x in MI. uI (n + m) x \\<le> uI n x + uI m ((TI ^^ n) x)", "unfolding uI_proj"], ["proof (prove)\nusing this:\n  AE x in MI. uJ (n + m) (projI x)\n              \\<le> uJ n (projI x) + uJ m ((TJ ^^ n) (projI x))\n  AE x in MI. (TJ ^^ n) (projI x) = projI ((TI ^^ n) x)\n\ngoal (1 subgoal):\n 1. AE x in MI. uJ (n + m) (projI x)\n                \\<le> uJ n (projI x) + uJ m (projI ((TI ^^ n) x))", "by auto"], ["proof (state)\nthis:\n  AE x in MI. uI (n + m) x \\<le> uI n x + uI m ((TI ^^ n) x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  AE x in MI. uI (?n13 + ?m13) x \\<le> uI ?n13 x + uI ?m13 ((TI ^^ ?n13) x)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have uI_0: \"AE x in MI. (\\<lambda>n. uI n x / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. (\\<lambda>n. uI n x / real n) \\<longlonglongrightarrow> 0", "unfolding uI_proj"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. (\\<lambda>n. uJ n (projI x) / real n)\n                \\<longlonglongrightarrow> 0", "apply (rule quasi_measure_preserving_AE[OF measure_preserving_is_quasi_measure_preserving[OF \\<open>projI \\<in> measure_preserving MI MJ\\<close>]])"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "using uJ_0"], ["proof (prove)\nusing this:\n  AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. AE x in MJ. (\\<lambda>n. uJ n x / real n) \\<longlonglongrightarrow> 0", "by simp"], ["proof (state)\nthis:\n  AE x in MI. (\\<lambda>n. uI n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "text \\<open>As $uI$ is only a subcocycle almost everywhere, we correct it to get a genuine subcocycle,\n        to which we will apply Lemma \\verb+upper_density_good_direction_invertible+.\\<close>"], ["proof (state)\nthis:\n  AE x in MI. (\\<lambda>n. uI n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "obtain vI where H: \"I.subcocycle vI\" \"AE x in MI. \\<forall>n. vI n x = uI n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>vI.\n        \\<lbrakk>I.subcocycle vI;\n         AE x in MI. \\<forall>n. vI n x = uI n x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using I.subcocycle_AE[OF uI_AE uI_int]"], ["proof (prove)\nusing this:\n  \\<exists>w. I.subcocycle w \\<and> (AE x in MI. \\<forall>n. w n x = uI n x)\n\ngoal (1 subgoal):\n 1. (\\<And>vI.\n        \\<lbrakk>I.subcocycle vI;\n         AE x in MI. \\<forall>n. vI n x = uI n x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  I.subcocycle vI\n  AE x in MI. \\<forall>n. vI n x = uI n x\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have [measurable]: \"\\<And>n. vI n \\<in> borel_measurable MI\" \"\\<And>n. integrable MI (vI n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n. I.random_variable borel (vI n)) &&&\n    (\\<And>n. integrable MI (vI n))", "using I.subcocycle_integrable[OF H(1)]"], ["proof (prove)\nusing this:\n  integrable MI (vI ?n)\n  I.random_variable borel (vI ?n)\n\ngoal (1 subgoal):\n 1. (\\<And>n. I.random_variable borel (vI n)) &&&\n    (\\<And>n. integrable MI (vI n))", "by auto"], ["proof (state)\nthis:\n  I.random_variable borel (vI ?n13)\n  integrable MI (vI ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"(\\<integral>x. vI n x \\<partial>MI) = (\\<integral>x. uI n x \\<partial>MI)\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. I.expectation (vI n) = I.expectation (uI n)", "apply (rule integral_cong_AE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. I.random_variable borel (vI n)\n 2. I.random_variable borel (uI n)\n 3. AE x in MI. vI n x = uI n x", "using H(2)"], ["proof (prove)\nusing this:\n  AE x in MI. \\<forall>n. vI n x = uI n x\n\ngoal (3 subgoals):\n 1. I.random_variable borel (vI n)\n 2. I.random_variable borel (uI n)\n 3. AE x in MI. vI n x = uI n x", "by auto"], ["proof (state)\nthis:\n  I.expectation (vI ?n13) = I.expectation (uI ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  I.expectation (vI ?n13) = I.expectation (uI ?n13)", "have \"(\\<integral>x. vI n x \\<partial>MI) = (\\<integral>x. u n x \\<partial>M)\" for n"], ["proof (prove)\nusing this:\n  I.expectation (vI ?n13) = I.expectation (uI ?n13)\n\ngoal (1 subgoal):\n 1. I.expectation (vI n) = expectation (u n)", "using uI_int2"], ["proof (prove)\nusing this:\n  I.expectation (vI ?n13) = I.expectation (uI ?n13)\n  I.expectation (uI ?n13) = expectation (u ?n13)\n\ngoal (1 subgoal):\n 1. I.expectation (vI n) = expectation (u n)", "by simp"], ["proof (state)\nthis:\n  I.expectation (vI ?n13) = expectation (u ?n13)\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  I.expectation (vI ?n13) = expectation (u ?n13)", "have \"I.subcocycle_avg_ereal vI = subcocycle_avg_ereal u\""], ["proof (prove)\nusing this:\n  I.expectation (vI ?n13) = expectation (u ?n13)\n\ngoal (1 subgoal):\n 1. I.subcocycle_avg_ereal vI = subcocycle_avg_ereal u", "unfolding I.subcocycle_avg_ereal_def subcocycle_avg_ereal_def"], ["proof (prove)\nusing this:\n  I.expectation (vI ?n13) = expectation (u ?n13)\n\ngoal (1 subgoal):\n 1. \\<Sqinter> {ereal (I.expectation (vI n) / real n) |n. 0 < n} =\n    \\<Sqinter> {ereal (expectation (u n) / real n) |n. 0 < n}", "by auto"], ["proof (state)\nthis:\n  I.subcocycle_avg_ereal vI = subcocycle_avg_ereal u\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  I.subcocycle_avg_ereal vI = subcocycle_avg_ereal u", "have vI_fin: \"I.subcocycle_avg_ereal vI > -\\<infinity>\""], ["proof (prove)\nusing this:\n  I.subcocycle_avg_ereal vI = subcocycle_avg_ereal u\n\ngoal (1 subgoal):\n 1. - \\<infinity> < I.subcocycle_avg_ereal vI", "using subu_fin"], ["proof (prove)\nusing this:\n  I.subcocycle_avg_ereal vI = subcocycle_avg_ereal u\n  - \\<infinity> < subcocycle_avg_ereal u\n\ngoal (1 subgoal):\n 1. - \\<infinity> < I.subcocycle_avg_ereal vI", "by simp"], ["proof (state)\nthis:\n  - \\<infinity> < I.subcocycle_avg_ereal vI\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"AE x in MI. (\\<lambda>n. vI n x / n) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. (\\<lambda>n. vI n x / real n) \\<longlonglongrightarrow> 0", "using uI_0 H(2)"], ["proof (prove)\nusing this:\n  AE x in MI. (\\<lambda>n. uI n x / real n) \\<longlonglongrightarrow> 0\n  AE x in MI. \\<forall>n. vI n x = uI n x\n\ngoal (1 subgoal):\n 1. AE x in MI. (\\<lambda>n. vI n x / real n) \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  AE x in MI. (\\<lambda>n. vI n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "moreover"], ["proof (state)\nthis:\n  AE x in MI. (\\<lambda>n. vI n x / real n) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"AE x in MI. (\\<lambda>n. vI n x / n) \\<longlonglongrightarrow> I.subcocycle_lim vI x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. (\\<lambda>n. vI n x / real n)\n                \\<longlonglongrightarrow> I.subcocycle_lim vI x", "by (rule I.kingman_theorem_nonergodic(1)[OF H(1) vI_fin])"], ["proof (state)\nthis:\n  AE x in MI. (\\<lambda>n. vI n x / real n)\n              \\<longlonglongrightarrow> I.subcocycle_lim vI x\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in MI. (\\<lambda>n. vI n x / real n) \\<longlonglongrightarrow> 0\n  AE x in MI. (\\<lambda>n. vI n x / real n)\n              \\<longlonglongrightarrow> I.subcocycle_lim vI x", "have vI_0: \"AE x in MI. I.subcocycle_lim vI x = 0\""], ["proof (prove)\nusing this:\n  AE x in MI. (\\<lambda>n. vI n x / real n) \\<longlonglongrightarrow> 0\n  AE x in MI. (\\<lambda>n. vI n x / real n)\n              \\<longlonglongrightarrow> I.subcocycle_lim vI x\n\ngoal (1 subgoal):\n 1. AE x in MI. I.subcocycle_lim vI x = 0", "using LIMSEQ_unique"], ["proof (prove)\nusing this:\n  AE x in MI. (\\<lambda>n. vI n x / real n) \\<longlonglongrightarrow> 0\n  AE x in MI. (\\<lambda>n. vI n x / real n)\n              \\<longlonglongrightarrow> I.subcocycle_lim vI x\n  \\<lbrakk>?X \\<longlonglongrightarrow> ?a;\n   ?X \\<longlonglongrightarrow> ?b\\<rbrakk>\n  \\<Longrightarrow> ?a = ?b\n\ngoal (1 subgoal):\n 1. AE x in MI. I.subcocycle_lim vI x = 0", "by auto"], ["proof (state)\nthis:\n  AE x in MI. I.subcocycle_lim vI x = 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "interpret GKK: Gouezel_Karlsson_Kingman MI TI vI"], ["proof (prove)\ngoal (1 subgoal):\n 1. Gouezel_Karlsson_Kingman MI TI vI", "apply standard"], ["proof (prove)\ngoal (3 subgoals):\n 1. I.subcocycle vI\n 2. - \\<infinity> < I.subcocycle_avg_ereal vI\n 3. AE x in MI. I.subcocycle_lim vI x = 0", "using H(1) vI_fin vI_0"], ["proof (prove)\nusing this:\n  I.subcocycle vI\n  - \\<infinity> < I.subcocycle_avg_ereal vI\n  AE x in MI. I.subcocycle_lim vI x = 0\n\ngoal (3 subgoals):\n 1. I.subcocycle vI\n 2. - \\<infinity> < I.subcocycle_avg_ereal vI\n 3. AE x in MI. I.subcocycle_lim vI x = 0", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "obtain delta where delta: \"\\<And>l. delta l > 0\" \"delta \\<longlonglongrightarrow> 0\"\n      \"emeasure MI {x \\<in> space MI. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)} \\<ge> 1 - d } \\<ge> 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>delta.\n        \\<lbrakk>\\<And>l. 0 < delta l; delta \\<longlonglongrightarrow> 0;\n         ennreal (1 - d)\n         \\<le> emeasure MI\n                {x \\<in> space MI.\n                 1 - d\n                 \\<le> upper_asymptotic_density\n                        {n. \\<forall>l\\<in>{1..n}.\n                               - delta l * real l\n                               < vI n x -\n                                 vI (n - l) ((TI ^^ l) x)}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using GKK.upper_density_good_direction_invertible[OF \\<open>I.invertible_qmpt\\<close> \\<open>d>0\\<close> \\<open>d\\<le>1\\<close>]"], ["proof (prove)\nusing this:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     ennreal (1 - d)\n     \\<le> emeasure MI\n            {x \\<in> space MI.\n             1 - d\n             \\<le> upper_asymptotic_density\n                    {n. \\<forall>l\\<in>{1..n}.\n                           - delta l * real l\n                           < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. (\\<And>delta.\n        \\<lbrakk>\\<And>l. 0 < delta l; delta \\<longlonglongrightarrow> 0;\n         ennreal (1 - d)\n         \\<le> emeasure MI\n                {x \\<in> space MI.\n                 1 - d\n                 \\<le> upper_asymptotic_density\n                        {n. \\<forall>l\\<in>{1..n}.\n                               - delta l * real l\n                               < vI n x -\n                                 vI (n - l) ((TI ^^ l) x)}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < delta ?l13\n  delta \\<longlonglongrightarrow> 0\n  ennreal (1 - d)\n  \\<le> emeasure MI\n         {x \\<in> space MI.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "text \\<open>Then, we need to go back to the original system, showing that the estimates for $TI$ carry\n        over. First, we go to $TJ$.\\<close>"], ["proof (state)\nthis:\n  0 < delta ?l13\n  delta \\<longlonglongrightarrow> 0\n  ennreal (1 - d)\n  \\<le> emeasure MI\n         {x \\<in> space MI.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have BJ: \"emeasure MJ {x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d } \\<ge> 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have *: \"AE x in MI. uJ n (projI x) = vI n x\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. uJ n (projI x) = vI n x", "using uI_proj H(2)"], ["proof (prove)\nusing this:\n  uI = (\\<lambda>n x. uJ n (projI x))\n  AE x in MI. \\<forall>n. vI n x = uI n x\n\ngoal (1 subgoal):\n 1. AE x in MI. uJ n (projI x) = vI n x", "by auto"], ["proof (state)\nthis:\n  AE x in MI. uJ ?n13 (projI x) = vI ?n13 x\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have **: \"AE x in MI. \\<forall>n. uJ n (projI x) = vI n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. \\<forall>n. uJ n (projI x) = vI n x", "by (subst AE_all_countable, auto intro: *)"], ["proof (state)\nthis:\n  AE x in MI. \\<forall>n. uJ n (projI x) = vI n x\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"AE x in MI. \\<forall>m n. uJ n (projI ((TI^^m) x)) = vI n ((TI^^m) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in MI. \\<forall>m n.\n                   uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)", "by (rule I.T_AE_iterates[OF **])"], ["proof (state)\nthis:\n  AE x in MI. \\<forall>m n. uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  AE x in MI. \\<forall>m n. uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)", "have \"AE x in MI. (\\<forall>m n. uJ n (projI ((TI^^m) x)) = vI n ((TI^^m) x)) \\<and> (\\<forall>n. projI ((TI^^n) x) = (TJ^^n) (projI x))\""], ["proof (prove)\nusing this:\n  AE x in MI. \\<forall>m n. uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)\n\ngoal (1 subgoal):\n 1. AE x in MI. (\\<forall>m n.\n                    uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)) \\<and>\n                (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x))", "using I.qmpt_factor_iterates[OF I.mpt_factor_is_qmpt_factor[OF \\<open>I.mpt_factor projI MJ TJ\\<close>]]"], ["proof (prove)\nusing this:\n  AE x in MI. \\<forall>m n. uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)\n  AE x in MI. \\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x)\n\ngoal (1 subgoal):\n 1. AE x in MI. (\\<forall>m n.\n                    uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)) \\<and>\n                (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x))", "by auto"], ["proof (state)\nthis:\n  AE x in MI. (\\<forall>m n.\n                  uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)) \\<and>\n              (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x))\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  AE x in MI. (\\<forall>m n.\n                  uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)) \\<and>\n              (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x))", "obtain ZI where ZI: \"\\<And>x. x \\<in> space MI - ZI \\<Longrightarrow> (\\<forall>m n. uJ n (projI ((TI^^m) x)) = vI n ((TI^^m) x)) \\<and> (\\<forall>n. projI ((TI^^n) x) = (TJ^^n) (projI x))\"\n                             \"ZI \\<in> null_sets MI\""], ["proof (prove)\nusing this:\n  AE x in MI. (\\<forall>m n.\n                  uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)) \\<and>\n              (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x))\n\ngoal (1 subgoal):\n 1. (\\<And>ZI.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> space MI - ZI \\<Longrightarrow>\n                    (\\<forall>m n.\n                        uJ n (projI ((TI ^^ m) x)) =\n                        vI n ((TI ^^ m) x)) \\<and>\n                    (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x));\n         ZI \\<in> null_sets MI\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using AE_E3"], ["proof (prove)\nusing this:\n  AE x in MI. (\\<forall>m n.\n                  uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)) \\<and>\n              (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x))\n  \\<lbrakk>almost_everywhere ?M ?P;\n   \\<And>N.\n      \\<lbrakk>\\<And>x. x \\<in> space ?M - N \\<Longrightarrow> ?P x;\n       N \\<in> null_sets ?M\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>ZI.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> space MI - ZI \\<Longrightarrow>\n                    (\\<forall>m n.\n                        uJ n (projI ((TI ^^ m) x)) =\n                        vI n ((TI ^^ m) x)) \\<and>\n                    (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x));\n         ZI \\<in> null_sets MI\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ?x13 \\<in> space MI - ZI \\<Longrightarrow>\n  (\\<forall>m n.\n      uJ n (projI ((TI ^^ m) ?x13)) = vI n ((TI ^^ m) ?x13)) \\<and>\n  (\\<forall>n. projI ((TI ^^ n) ?x13) = (TJ ^^ n) (projI ?x13))\n  ZI \\<in> null_sets MI\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have *: \"uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x)) = vI n x - vI (n - l) ((TI ^^ l) x)\" if \"x \\<in> space MI - ZI\" for x n l"], ["proof (prove)\ngoal (1 subgoal):\n 1. uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x)) =\n    vI n x - vI (n - l) ((TI ^^ l) x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x)) =\n    vI n x - vI (n - l) ((TI ^^ l) x)", "have \"(TI^^0) x = x\" \"(TJ^^0) (projI x) = (projI x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (TI ^^ 0) x = x &&& (TJ ^^ 0) (projI x) = projI x", "by auto"], ["proof (state)\nthis:\n  (TI ^^ 0) x = x\n  (TJ ^^ 0) (projI x) = projI x\n\ngoal (1 subgoal):\n 1. uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x)) =\n    vI n x - vI (n - l) ((TI ^^ l) x)", "then"], ["proof (chain)\npicking this:\n  (TI ^^ 0) x = x\n  (TJ ^^ 0) (projI x) = projI x", "show ?thesis"], ["proof (prove)\nusing this:\n  (TI ^^ 0) x = x\n  (TJ ^^ 0) (projI x) = projI x\n\ngoal (1 subgoal):\n 1. uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x)) =\n    vI n x - vI (n - l) ((TI ^^ l) x)", "using ZI(1)[OF that]"], ["proof (prove)\nusing this:\n  (TI ^^ 0) x = x\n  (TJ ^^ 0) (projI x) = projI x\n  (\\<forall>m n. uJ n (projI ((TI ^^ m) x)) = vI n ((TI ^^ m) x)) \\<and>\n  (\\<forall>n. projI ((TI ^^ n) x) = (TJ ^^ n) (projI x))\n\ngoal (1 subgoal):\n 1. uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x)) =\n    vI n x - vI (n - l) ((TI ^^ l) x)", "by metis"], ["proof (state)\nthis:\n  uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x)) =\n  vI n x - vI (n - l) ((TI ^^ l) x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x13 \\<in> space MI - ZI \\<Longrightarrow>\n  uJ ?n13 (projI ?x13) - uJ (?n13 - ?l13) ((TJ ^^ ?l13) (projI ?x13)) =\n  vI ?n13 ?x13 - vI (?n13 - ?l13) ((TI ^^ ?l13) ?x13)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"projI-`{x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d} \\<inter> space MI - ZI\n          = {x \\<in> space MI - ZI. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x))} \\<ge> 1 - d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI -\n    ZI =\n    {x \\<in> space MI - ZI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x))}}", "by (auto simp add: measurable_space[OF \\<open>projI \\<in> measurable MI MJ\\<close>])"], ["proof (state)\nthis:\n  projI -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space MI -\n  ZI =\n  {x \\<in> space MI - ZI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x))}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  projI -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space MI -\n  ZI =\n  {x \\<in> space MI - ZI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x))}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"... = {x \\<in> space MI - ZI. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)} \\<ge> 1 - d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space MI - ZI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x))}} =\n    {x \\<in> space MI - ZI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}}", "using *"], ["proof (prove)\nusing this:\n  ?x13 \\<in> space MI - ZI \\<Longrightarrow>\n  uJ ?n13 (projI ?x13) - uJ (?n13 - ?l13) ((TJ ^^ ?l13) (projI ?x13)) =\n  vI ?n13 ?x13 - vI (?n13 - ?l13) ((TI ^^ ?l13) ?x13)\n\ngoal (1 subgoal):\n 1. {x \\<in> space MI - ZI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x))}} =\n    {x \\<in> space MI - ZI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}}", "by auto"], ["proof (state)\nthis:\n  {x \\<in> space MI - ZI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x))}} =\n  {x \\<in> space MI - ZI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  {x \\<in> space MI - ZI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n (projI x) - uJ (n - l) ((TJ ^^ l) (projI x))}} =\n  {x \\<in> space MI - ZI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"... = {x \\<in> space MI. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)} \\<ge> 1 - d} - ZI\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space MI - ZI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < vI n x - vI (n - l) ((TI ^^ l) x)}} =\n    {x \\<in> space MI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n    ZI", "by auto"], ["proof (state)\nthis:\n  {x \\<in> space MI - ZI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}} =\n  {x \\<in> space MI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n  ZI\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "finally"], ["proof (chain)\npicking this:\n  projI -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space MI -\n  ZI =\n  {x \\<in> space MI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n  ZI", "have *: \"projI-`{x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d} \\<inter> space MI - ZI\n      = {x \\<in> space MI. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)} \\<ge> 1 - d} - ZI\""], ["proof (prove)\nusing this:\n  projI -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space MI -\n  ZI =\n  {x \\<in> space MI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n  ZI\n\ngoal (1 subgoal):\n 1. projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI -\n    ZI =\n    {x \\<in> space MI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n    ZI", "by simp"], ["proof (state)\nthis:\n  projI -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space MI -\n  ZI =\n  {x \\<in> space MI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n  ZI\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"emeasure MJ {x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d}\n          = emeasure MI (projI-`{x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d} \\<inter> space MI)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure MJ\n     {x \\<in> space MJ.\n      1 - d\n      \\<le> upper_asymptotic_density\n             {n. \\<forall>l\\<in>{1..n}.\n                    - delta l * real l\n                    < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n    emeasure MI\n     (projI -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space MI)", "by (rule measure_preservingE(2)[symmetric], auto)"], ["proof (state)\nthis:\n  emeasure MJ\n   {x \\<in> space MJ.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n  emeasure MI\n   (projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  emeasure MJ\n   {x \\<in> space MJ.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n  emeasure MI\n   (projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"... = emeasure MI ((projI-`{x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d} \\<inter> space MI) - ZI)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure MI\n     (projI -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space MI) =\n    emeasure MI\n     (projI -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space MI -\n      ZI)", "by (rule emeasure_Diff_null_set[OF \\<open>ZI \\<in> null_sets MI\\<close>, symmetric], measurable)"], ["proof (state)\nthis:\n  emeasure MI\n   (projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI) =\n  emeasure MI\n   (projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI -\n    ZI)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  emeasure MI\n   (projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI) =\n  emeasure MI\n   (projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI -\n    ZI)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"... = emeasure MI ({x \\<in> space MI. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)} \\<ge> 1 - d} - ZI)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure MI\n     (projI -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space MI -\n      ZI) =\n    emeasure MI\n     ({x \\<in> space MI.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n      ZI)", "using *"], ["proof (prove)\nusing this:\n  projI -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space MI -\n  ZI =\n  {x \\<in> space MI.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n  ZI\n\ngoal (1 subgoal):\n 1. emeasure MI\n     (projI -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space MI -\n      ZI) =\n    emeasure MI\n     ({x \\<in> space MI.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n      ZI)", "by simp"], ["proof (state)\nthis:\n  emeasure MI\n   (projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI -\n    ZI) =\n  emeasure MI\n   ({x \\<in> space MI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n    ZI)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  emeasure MI\n   (projI -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space MI -\n    ZI) =\n  emeasure MI\n   ({x \\<in> space MI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n    ZI)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"... = emeasure MI {x \\<in> space MI. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)} \\<ge> 1 - d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure MI\n     ({x \\<in> space MI.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n      ZI) =\n    emeasure MI\n     {x \\<in> space MI.\n      1 - d\n      \\<le> upper_asymptotic_density\n             {n. \\<forall>l\\<in>{1..n}.\n                    - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}}", "by (rule emeasure_Diff_null_set[OF \\<open>ZI \\<in> null_sets MI\\<close>], measurable)"], ["proof (state)\nthis:\n  emeasure MI\n   ({x \\<in> space MI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n    ZI) =\n  emeasure MI\n   {x \\<in> space MI.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  emeasure MI\n   ({x \\<in> space MI.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < vI n x - vI (n - l) ((TI ^^ l) x)}} -\n    ZI) =\n  emeasure MI\n   {x \\<in> space MI.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "have \"... \\<ge> 1-d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MI\n           {x \\<in> space MI.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < vI n x - vI (n - l) ((TI ^^ l) x)}}", "using delta(3)"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  \\<le> emeasure MI\n         {x \\<in> space MI.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MI\n           {x \\<in> space MI.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < vI n x - vI (n - l) ((TI ^^ l) x)}}", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  \\<le> emeasure MI\n         {x \\<in> space MI.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < vI n x - vI (n - l) ((TI ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "finally"], ["proof (chain)\npicking this:\n  ennreal (1 - d)\n  \\<le> emeasure MJ\n         {x \\<in> space MJ.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  \\<le> emeasure MJ\n         {x \\<in> space MJ.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure MJ\n           {x \\<in> space MJ.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  \\<le> emeasure MJ\n         {x \\<in> space MJ.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  \\<le> emeasure MJ\n         {x \\<in> space MJ.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "text \\<open>Then, we go back to $T$ with virtually the same argument.\\<close>"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  \\<le> emeasure MJ\n         {x \\<in> space MJ.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "have \"emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < u n x - u (n - l) ((T ^^ l) x)} \\<ge> 1 - d } \\<ge> 1 - d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "obtain Z where Z: \"\\<And>x. x \\<in> space M - Z \\<Longrightarrow> (\\<forall>n. projJ ((T^^n) x) = (TJ^^n) (projJ x))\"\n                        \"Z \\<in> null_sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Z.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> space M - Z \\<Longrightarrow>\n                    \\<forall>n. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x);\n         Z \\<in> null_sets M\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using AE_E3[OF qmpt_factor_iterates[OF mpt_factor_is_qmpt_factor[OF \\<open>mpt_factor projJ MJ TJ\\<close>]]]"], ["proof (prove)\nusing this:\n  (\\<And>N.\n      \\<lbrakk>\\<And>x.\n                  x \\<in> space M - N \\<Longrightarrow>\n                  \\<forall>n. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x);\n       N \\<in> null_sets M\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>Z.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> space M - Z \\<Longrightarrow>\n                    \\<forall>n. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x);\n         Z \\<in> null_sets M\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ?x13 \\<in> space M - Z \\<Longrightarrow>\n  \\<forall>n. projJ ((T ^^ n) ?x13) = (TJ ^^ n) (projJ ?x13)\n  Z \\<in> null_sets M\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "have *: \"uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x)) = u n x - u (n - l) ((T^^ l) x)\" if \"x \\<in> space M - Z\" for x n l"], ["proof (prove)\ngoal (1 subgoal):\n 1. uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x)) =\n    u n x - u (n - l) ((T ^^ l) x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x)) =\n    u n x - u (n - l) ((T ^^ l) x)", "have \"(T^^0) x = x\" \"(TJ^^0) (projJ x) = (projJ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (T ^^ 0) x = x &&& (TJ ^^ 0) (projJ x) = projJ x", "by auto"], ["proof (state)\nthis:\n  (T ^^ 0) x = x\n  (TJ ^^ 0) (projJ x) = projJ x\n\ngoal (1 subgoal):\n 1. uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x)) =\n    u n x - u (n - l) ((T ^^ l) x)", "then"], ["proof (chain)\npicking this:\n  (T ^^ 0) x = x\n  (TJ ^^ 0) (projJ x) = projJ x", "show ?thesis"], ["proof (prove)\nusing this:\n  (T ^^ 0) x = x\n  (TJ ^^ 0) (projJ x) = projJ x\n\ngoal (1 subgoal):\n 1. uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x)) =\n    u n x - u (n - l) ((T ^^ l) x)", "using Z(1)[OF that] uJ_proj"], ["proof (prove)\nusing this:\n  (T ^^ 0) x = x\n  (TJ ^^ 0) (projJ x) = projJ x\n  \\<forall>n. projJ ((T ^^ n) x) = (TJ ^^ n) (projJ x)\n  u ?n13 ?x13 = uJ ?n13 (projJ ?x13)\n\ngoal (1 subgoal):\n 1. uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x)) =\n    u n x - u (n - l) ((T ^^ l) x)", "by metis"], ["proof (state)\nthis:\n  uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x)) =\n  u n x - u (n - l) ((T ^^ l) x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x13 \\<in> space M - Z \\<Longrightarrow>\n  uJ ?n13 (projJ ?x13) - uJ (?n13 - ?l13) ((TJ ^^ ?l13) (projJ ?x13)) =\n  u ?n13 ?x13 - u (?n13 - ?l13) ((T ^^ ?l13) ?x13)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "have \"projJ-`{x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d} \\<inter> space M - Z\n          = {x \\<in> space M - Z. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x))} \\<ge> 1 - d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M -\n    Z =\n    {x \\<in> space M - Z.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x))}}", "by (auto simp add: measurable_space[OF \\<open>projJ \\<in> measurable M MJ\\<close>])"], ["proof (state)\nthis:\n  projJ -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space M -\n  Z =\n  {x \\<in> space M - Z.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x))}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  projJ -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space M -\n  Z =\n  {x \\<in> space M - Z.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x))}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = {x \\<in> space M - Z. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < u n x - u (n - l) ((T ^^ l) x)} \\<ge> 1 - d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M - Z.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x))}} =\n    {x \\<in> space M - Z.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}", "using *"], ["proof (prove)\nusing this:\n  ?x13 \\<in> space M - Z \\<Longrightarrow>\n  uJ ?n13 (projJ ?x13) - uJ (?n13 - ?l13) ((TJ ^^ ?l13) (projJ ?x13)) =\n  u ?n13 ?x13 - u (?n13 - ?l13) ((T ^^ ?l13) ?x13)\n\ngoal (1 subgoal):\n 1. {x \\<in> space M - Z.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x))}} =\n    {x \\<in> space M - Z.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}", "by auto"], ["proof (state)\nthis:\n  {x \\<in> space M - Z.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x))}} =\n  {x \\<in> space M - Z.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  {x \\<in> space M - Z.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n (projJ x) - uJ (n - l) ((TJ ^^ l) (projJ x))}} =\n  {x \\<in> space M - Z.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < u n x - u (n - l) ((T ^^ l) x)} \\<ge> 1 - d} - Z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M - Z.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n    {x \\<in> space M.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n    Z", "by auto"], ["proof (state)\nthis:\n  {x \\<in> space M - Z.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} =\n  {x \\<in> space M.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n  Z\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "finally"], ["proof (chain)\npicking this:\n  projJ -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space M -\n  Z =\n  {x \\<in> space M.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n  Z", "have *: \"projJ-`{x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d} \\<inter> space M - Z\n      = {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < u n x - u (n - l) ((T ^^ l) x)} \\<ge> 1 - d} - Z\""], ["proof (prove)\nusing this:\n  projJ -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space M -\n  Z =\n  {x \\<in> space M.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n  Z\n\ngoal (1 subgoal):\n 1. projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M -\n    Z =\n    {x \\<in> space M.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n    Z", "by simp"], ["proof (state)\nthis:\n  projJ -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space M -\n  Z =\n  {x \\<in> space M.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n  Z\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "have \"emeasure MJ {x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d}\n        = emeasure M (projJ-`{x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d} \\<inter> space M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure MJ\n     {x \\<in> space MJ.\n      1 - d\n      \\<le> upper_asymptotic_density\n             {n. \\<forall>l\\<in>{1..n}.\n                    - delta l * real l\n                    < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n    emeasure M\n     (projJ -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space M)", "by (rule measure_preservingE(2)[symmetric], auto)"], ["proof (state)\nthis:\n  emeasure MJ\n   {x \\<in> space MJ.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n  emeasure M\n   (projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  emeasure MJ\n   {x \\<in> space MJ.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n  emeasure M\n   (projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = emeasure M ((projJ-`{x \\<in> space MJ. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)} \\<ge> 1 - d} \\<inter> space M) - Z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     (projJ -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space M) =\n    emeasure M\n     (projJ -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space M -\n      Z)", "by (rule emeasure_Diff_null_set[OF \\<open>Z \\<in> null_sets M\\<close>, symmetric], measurable)"], ["proof (state)\nthis:\n  emeasure M\n   (projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M) =\n  emeasure M\n   (projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M -\n    Z)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  emeasure M\n   (projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M) =\n  emeasure M\n   (projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M -\n    Z)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = emeasure M ({x \\<in> space M. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < u n x - u (n - l) ((T ^^ l) x)} \\<ge> 1 - d} - Z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     (projJ -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space M -\n      Z) =\n    emeasure M\n     ({x \\<in> space M.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n      Z)", "using *"], ["proof (prove)\nusing this:\n  projJ -`\n  {x \\<in> space MJ.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l\n                 < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n  space M -\n  Z =\n  {x \\<in> space M.\n   1 - d\n   \\<le> upper_asymptotic_density\n          {n. \\<forall>l\\<in>{1..n}.\n                 - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n  Z\n\ngoal (1 subgoal):\n 1. emeasure M\n     (projJ -`\n      {x \\<in> space MJ.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l\n                     < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n      space M -\n      Z) =\n    emeasure M\n     ({x \\<in> space M.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n      Z)", "by simp"], ["proof (state)\nthis:\n  emeasure M\n   (projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M -\n    Z) =\n  emeasure M\n   ({x \\<in> space M.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n    Z)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "also"], ["proof (state)\nthis:\n  emeasure M\n   (projJ -`\n    {x \\<in> space MJ.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l\n                   < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} \\<inter>\n    space M -\n    Z) =\n  emeasure M\n   ({x \\<in> space M.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n    Z)\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "have \"... = emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l\\<in>{1..n}. - delta l * real l < u n x - u (n - l) ((T ^^ l) x)} \\<ge> 1 - d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M\n     ({x \\<in> space M.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n      Z) =\n    emeasure M\n     {x \\<in> space M.\n      1 - d\n      \\<le> upper_asymptotic_density\n             {n. \\<forall>l\\<in>{1..n}.\n                    - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}", "by (rule emeasure_Diff_null_set[OF \\<open>Z \\<in> null_sets M\\<close>], measurable)"], ["proof (state)\nthis:\n  emeasure M\n   ({x \\<in> space M.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}} -\n    Z) =\n  emeasure M\n   {x \\<in> space M.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "finally"], ["proof (chain)\npicking this:\n  emeasure MJ\n   {x \\<in> space MJ.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n  emeasure M\n   {x \\<in> space M.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure MJ\n   {x \\<in> space MJ.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n  emeasure M\n   {x \\<in> space M.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "using BJ"], ["proof (prove)\nusing this:\n  emeasure MJ\n   {x \\<in> space MJ.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < uJ n x - uJ (n - l) ((TJ ^^ l) x)}} =\n  emeasure M\n   {x \\<in> space M.\n    1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}\n  ennreal (1 - d)\n  \\<le> emeasure MJ\n         {x \\<in> space MJ.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < uJ n x - uJ (n - l) ((TJ ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "then"], ["proof (chain)\npicking this:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "using delta(1) delta(2)"], ["proof (prove)\nusing this:\n  ennreal (1 - d)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - d\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n  0 < delta ?l13\n  delta \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       ennreal (1 - d)\n       \\<le> emeasure M\n              {x \\<in> space M.\n               1 - d\n               \\<le> upper_asymptotic_density\n                      {n. \\<forall>l\\<in>{1..n}.\n                             - delta l * real l\n                             < u n x - u (n - l) ((T ^^ l) x)}}", "by auto"], ["proof (state)\nthis:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     ennreal (1 - d)\n     \\<le> emeasure M\n            {x \\<in> space M.\n             1 - d\n             \\<le> upper_asymptotic_density\n                    {n. \\<forall>l\\<in>{1..n}.\n                           - delta l * real l\n                           < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>From the quantitative lemma above, we deduce the qualitative statement we are after,\nstill in the setting of the locale.\\<close>"], ["", "lemma infinite_AE:\n  shows \"AE x in M. \\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have \"\\<exists>deltaf::real \\<Rightarrow> nat \\<Rightarrow> real. \\<forall>d. ((d > 0 \\<and> d \\<le> 1) \\<longrightarrow> ((\\<forall>l. deltaf d l > 0) \\<and> (deltaf d \\<longlonglongrightarrow> 0) \\<and>\n        emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - (deltaf d l) * l} \\<ge> 1-d} \\<ge> ennreal(1-d)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>deltaf.\n       \\<forall>d.\n          0 < d \\<and> d \\<le> 1 \\<longrightarrow>\n          (\\<forall>l. 0 < deltaf d l) \\<and>\n          deltaf d \\<longlonglongrightarrow> 0 \\<and>\n          ennreal (1 - d)\n          \\<le> emeasure M\n                 {x \\<in> space M.\n                  1 - d\n                  \\<le> upper_asymptotic_density\n                         {n. \\<forall>l\\<in>{1..n}.\n                                - deltaf d l * real l\n                                < u n x - u (n - l) ((T ^^ l) x)}}", "apply (subst choice_iff'[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x.\n       0 < x \\<and> x \\<le> 1 \\<longrightarrow>\n       (\\<exists>y.\n           (\\<forall>l. 0 < y l) \\<and>\n           y \\<longlonglongrightarrow> 0 \\<and>\n           ennreal (1 - x)\n           \\<le> emeasure M\n                  {xa \\<in> space M.\n                   1 - x\n                   \\<le> upper_asymptotic_density\n                          {n. \\<forall>l\\<in>{1..n}.\n                                 - y l * real l\n                                 < u n xa - u (n - l) ((T ^^ l) xa)}})", "using upper_density_good_direction"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < ?d; ?d \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> \\<exists>delta.\n                       (\\<forall>l. 0 < delta l) \\<and>\n                       delta \\<longlonglongrightarrow> 0 \\<and>\n                       ennreal (1 - ?d)\n                       \\<le> emeasure M\n                              {x \\<in> space M.\n                               1 - ?d\n                               \\<le> upper_asymptotic_density\n{n. \\<forall>l\\<in>{1..n}.\n       - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. \\<forall>x.\n       0 < x \\<and> x \\<le> 1 \\<longrightarrow>\n       (\\<exists>y.\n           (\\<forall>l. 0 < y l) \\<and>\n           y \\<longlonglongrightarrow> 0 \\<and>\n           ennreal (1 - x)\n           \\<le> emeasure M\n                  {xa \\<in> space M.\n                   1 - x\n                   \\<le> upper_asymptotic_density\n                          {n. \\<forall>l\\<in>{1..n}.\n                                 - y l * real l\n                                 < u n xa - u (n - l) ((T ^^ l) xa)}})", "by auto"], ["proof (state)\nthis:\n  \\<exists>deltaf.\n     \\<forall>d.\n        0 < d \\<and> d \\<le> 1 \\<longrightarrow>\n        (\\<forall>l. 0 < deltaf d l) \\<and>\n        deltaf d \\<longlonglongrightarrow> 0 \\<and>\n        ennreal (1 - d)\n        \\<le> emeasure M\n               {x \\<in> space M.\n                1 - d\n                \\<le> upper_asymptotic_density\n                       {n. \\<forall>l\\<in>{1..n}.\n                              - deltaf d l * real l\n                              < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "then"], ["proof (chain)\npicking this:\n  \\<exists>deltaf.\n     \\<forall>d.\n        0 < d \\<and> d \\<le> 1 \\<longrightarrow>\n        (\\<forall>l. 0 < deltaf d l) \\<and>\n        deltaf d \\<longlonglongrightarrow> 0 \\<and>\n        ennreal (1 - d)\n        \\<le> emeasure M\n               {x \\<in> space M.\n                1 - d\n                \\<le> upper_asymptotic_density\n                       {n. \\<forall>l\\<in>{1..n}.\n                              - deltaf d l * real l\n                              < u n x - u (n - l) ((T ^^ l) x)}}", "obtain deltaf::\"real \\<Rightarrow> nat \\<Rightarrow> real\" where H: \"\\<And>d. d > 0 \\<and> d \\<le>1 \\<Longrightarrow> (\\<forall>l. deltaf d l > 0) \\<and> (deltaf d \\<longlonglongrightarrow> 0) \\<and>\n      emeasure M {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - (deltaf d l) * l} \\<ge> 1-d} \\<ge> ennreal(1-d)\""], ["proof (prove)\nusing this:\n  \\<exists>deltaf.\n     \\<forall>d.\n        0 < d \\<and> d \\<le> 1 \\<longrightarrow>\n        (\\<forall>l. 0 < deltaf d l) \\<and>\n        deltaf d \\<longlonglongrightarrow> 0 \\<and>\n        ennreal (1 - d)\n        \\<le> emeasure M\n               {x \\<in> space M.\n                1 - d\n                \\<le> upper_asymptotic_density\n                       {n. \\<forall>l\\<in>{1..n}.\n                              - deltaf d l * real l\n                              < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. (\\<And>deltaf.\n        (\\<And>d.\n            0 < d \\<and> d \\<le> 1 \\<Longrightarrow>\n            (\\<forall>l. 0 < deltaf d l) \\<and>\n            deltaf d \\<longlonglongrightarrow> 0 \\<and>\n            ennreal (1 - d)\n            \\<le> emeasure M\n                   {x \\<in> space M.\n                    1 - d\n                    \\<le> upper_asymptotic_density\n                           {n. \\<forall>l\\<in>{1..n}.\n                                  - deltaf d l * real l\n                                  < u n x -\n                                    u (n - l)\n                                     ((T ^^ l) x)}}) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < ?d12 \\<and> ?d12 \\<le> 1 \\<Longrightarrow>\n  (\\<forall>l. 0 < deltaf ?d12 l) \\<and>\n  deltaf ?d12 \\<longlonglongrightarrow> 0 \\<and>\n  ennreal (1 - ?d12)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - ?d12\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - deltaf ?d12 l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "define U where \"U = (\\<lambda>d. {x \\<in> space M. upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - (deltaf d l) * l} \\<ge> 1-d})\""], ["proof (state)\nthis:\n  U =\n  (\\<lambda>d.\n      {x \\<in> space M.\n       1 - d\n       \\<le> upper_asymptotic_density\n              {n. \\<forall>l\\<in>{1..n}.\n                     - deltaf d l * real l\n                     < u n x - u (n - l) ((T ^^ l) x)}})\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have [measurable]: \"U d \\<in> sets M\" for d"], ["proof (prove)\ngoal (1 subgoal):\n 1. U d \\<in> events", "unfolding U_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> space M.\n     1 - d\n     \\<le> upper_asymptotic_density\n            {n. \\<forall>l\\<in>{1..n}.\n                   - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}}\n    \\<in> events", "by auto"], ["proof (state)\nthis:\n  U ?d12 \\<in> events\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have *: \"emeasure M (U d) \\<ge> 1 - d\" if \"d>0 \\<and> d\\<le> 1\" for d"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d) \\<le> emeasure M (U d)", "unfolding U_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - deltaf d l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "using H that"], ["proof (prove)\nusing this:\n  0 < ?d12 \\<and> ?d12 \\<le> 1 \\<Longrightarrow>\n  (\\<forall>l. 0 < deltaf ?d12 l) \\<and>\n  deltaf ?d12 \\<longlonglongrightarrow> 0 \\<and>\n  ennreal (1 - ?d12)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - ?d12\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - deltaf ?d12 l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n  0 < d \\<and> d \\<le> 1\n\ngoal (1 subgoal):\n 1. ennreal (1 - d)\n    \\<le> emeasure M\n           {x \\<in> space M.\n            1 - d\n            \\<le> upper_asymptotic_density\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - deltaf d l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}}", "by auto"], ["proof (state)\nthis:\n  0 < ?d12 \\<and> ?d12 \\<le> 1 \\<Longrightarrow>\n  ennreal (1 - ?d12) \\<le> emeasure M (U ?d12)\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "define V where \"V = (\\<Union>n::nat. U (1/(n+2)))\""], ["proof (state)\nthis:\n  V = (\\<Union>x. U (1 / (real x + 2)))\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have [measurable]: \"V \\<in> sets M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. V \\<in> events", "unfolding V_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>x. U (1 / (real x + 2))) \\<in> events", "by auto"], ["proof (state)\nthis:\n  V \\<in> events\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have a: \"emeasure M V \\<ge> 1 - 1 / (n + 2)\" for n::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "have \"1 - 1 / (n + 2) = 1 - 1 / (real n + 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 - 1 / real (n + 2) = 1 - 1 / (real n + 2)", "by auto"], ["proof (state)\nthis:\n  1 - 1 / real (n + 2) = 1 - 1 / (real n + 2)\n\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "also"], ["proof (state)\nthis:\n  1 - 1 / real (n + 2) = 1 - 1 / (real n + 2)\n\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "have \"... \\<le> emeasure M (U (1/(real n+2)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / (real n + 2)) \\<le> emeasure M (U (1 / (real n + 2)))", "using *[of \"1 / (real n + 2)\"]"], ["proof (prove)\nusing this:\n  0 < 1 / (real n + 2) \\<and> 1 / (real n + 2) \\<le> 1 \\<Longrightarrow>\n  ennreal (1 - 1 / (real n + 2)) \\<le> emeasure M (U (1 / (real n + 2)))\n\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / (real n + 2)) \\<le> emeasure M (U (1 / (real n + 2)))", "by auto"], ["proof (state)\nthis:\n  ennreal (1 - 1 / (real n + 2)) \\<le> emeasure M (U (1 / (real n + 2)))\n\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "also"], ["proof (state)\nthis:\n  ennreal (1 - 1 / (real n + 2)) \\<le> emeasure M (U (1 / (real n + 2)))\n\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "have \"... \\<le> emeasure M V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure M (U (1 / (real n + 2))) \\<le> emeasure M V", "apply (rule Measure_Space.emeasure_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. U (1 / (real n + 2)) \\<subseteq> V\n 2. V \\<in> events", "unfolding V_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. U (1 / (real n + 2)) \\<subseteq> (\\<Union>x. U (1 / (real x + 2)))\n 2. (\\<Union>x. U (1 / (real x + 2))) \\<in> events", "by auto"], ["proof (state)\nthis:\n  emeasure M (U (1 / (real n + 2))) \\<le> emeasure M V\n\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "finally"], ["proof (chain)\npicking this:\n  ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "show ?thesis"], ["proof (prove)\nusing this:\n  ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V\n\ngoal (1 subgoal):\n 1. ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V", "by simp"], ["proof (state)\nthis:\n  ennreal (1 - 1 / real (n + 2)) \\<le> emeasure M V\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ennreal (1 - 1 / real (?n12 + 2)) \\<le> emeasure M V\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have b: \"(\\<lambda>n::nat. 1 - 1 / (n + 2)) \\<longlonglongrightarrow> ennreal(1 - 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. ennreal (1 - 1 / real (x + 2)))\n    \\<longlonglongrightarrow> ennreal (1 - 0)", "by (intro tendsto_intros LIMSEQ_ignore_initial_segment)"], ["proof (state)\nthis:\n  (\\<lambda>x. ennreal (1 - 1 / real (x + 2)))\n  \\<longlonglongrightarrow> ennreal (1 - 0)\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have \"emeasure M V \\<ge> 1 - 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 - 0 \\<le> emeasure M V", "apply (rule Lim_bounded)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ?f \\<longlonglongrightarrow> 1 - 0\n 2. \\<forall>n\\<ge>?M. ?f n \\<le> emeasure M V", "using a b"], ["proof (prove)\nusing this:\n  ennreal (1 - 1 / real (?n12 + 2)) \\<le> emeasure M V\n  (\\<lambda>x. ennreal (1 - 1 / real (x + 2)))\n  \\<longlonglongrightarrow> ennreal (1 - 0)\n\ngoal (2 subgoals):\n 1. ?f \\<longlonglongrightarrow> 1 - 0\n 2. \\<forall>n\\<ge>?M. ?f n \\<le> emeasure M V", "by auto"], ["proof (state)\nthis:\n  1 - 0 \\<le> emeasure M V\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "then"], ["proof (chain)\npicking this:\n  1 - 0 \\<le> emeasure M V", "have \"emeasure M V = 1\""], ["proof (prove)\nusing this:\n  1 - 0 \\<le> emeasure M V\n\ngoal (1 subgoal):\n 1. emeasure M V = 1", "by (simp add: emeasure_ge_1_iff)"], ["proof (state)\nthis:\n  emeasure M V = 1\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "then"], ["proof (chain)\npicking this:\n  emeasure M V = 1", "have \"AE x in M. x \\<in> V\""], ["proof (prove)\nusing this:\n  emeasure M V = 1\n\ngoal (1 subgoal):\n 1. AE x in M. x \\<in> V", "by (simp add: emeasure_eq_measure prob_eq_1)"], ["proof (state)\nthis:\n  AE x in M. x \\<in> V\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "moreover"], ["proof (state)\nthis:\n  AE x in M. x \\<in> V\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "{"], ["proof (state)\nthis:\n  AE x in M. x \\<in> V\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "assume \"x \\<in> V\""], ["proof (state)\nthis:\n  x \\<in> V\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "then"], ["proof (chain)\npicking this:\n  x \\<in> V", "obtain n::nat where \"x \\<in> U (1/(real n+2))\""], ["proof (prove)\nusing this:\n  x \\<in> V\n\ngoal (1 subgoal):\n 1. (\\<And>n.\n        x \\<in> U (1 / (real n + 2)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "unfolding V_def"], ["proof (prove)\nusing this:\n  x \\<in> (\\<Union>x. U (1 / (real x + 2)))\n\ngoal (1 subgoal):\n 1. (\\<And>n.\n        x \\<in> U (1 / (real n + 2)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  x \\<in> U (1 / (real n + 2))\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "define d where \"d = 1/(real n + 2)\""], ["proof (state)\nthis:\n  d = 1 / (real n + 2)\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have \"0 < d\" \"d\\<le>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < d &&& d \\<le> 1", "unfolding d_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 / (real n + 2) &&& 1 / (real n + 2) \\<le> 1", "by auto"], ["proof (state)\nthis:\n  0 < d\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have \"0 < 1-d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 - d", "unfolding d_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 - 1 / (real n + 2)", "by auto"], ["proof (state)\nthis:\n  0 < 1 - d\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "also"], ["proof (state)\nthis:\n  0 < 1 - d\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "have \"... \\<le> upper_asymptotic_density {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - (deltaf d l) * l}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}", "using \\<open>x \\<in> U (1/(real n+2))\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> U (1 / (real n + 2))\n\ngoal (1 subgoal):\n 1. 1 - d\n    \\<le> upper_asymptotic_density\n           {n. \\<forall>l\\<in>{1..n}.\n                  - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}", "unfolding U_def d_def"], ["proof (prove)\nusing this:\n  x \\<in> {x \\<in> space M.\n           1 - 1 / (real n + 2)\n           \\<le> upper_asymptotic_density\n                  {na.\n                   \\<forall>l\\<in>{1..na}.\n                      - deltaf (1 / (real n + 2)) l * real l\n                      < u na x - u (na - l) ((T ^^ l) x)}}\n\ngoal (1 subgoal):\n 1. 1 - 1 / (real n + 2)\n    \\<le> upper_asymptotic_density\n           {na.\n            \\<forall>l\\<in>{1..na}.\n               - deltaf (1 / (real n + 2)) l * real l\n               < u na x - u (na - l) ((T ^^ l) x)}", "by auto"], ["proof (state)\nthis:\n  1 - d\n  \\<le> upper_asymptotic_density\n         {n. \\<forall>l\\<in>{1..n}.\n                - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "finally"], ["proof (chain)\npicking this:\n  0 < upper_asymptotic_density\n       {n. \\<forall>l\\<in>{1..n}.\n              - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}", "have \"infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - (deltaf d l) * l}\""], ["proof (prove)\nusing this:\n  0 < upper_asymptotic_density\n       {n. \\<forall>l\\<in>{1..n}.\n              - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. infinite\n     {n. \\<forall>l\\<in>{1..n}.\n            - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}", "using upper_asymptotic_density_finite"], ["proof (prove)\nusing this:\n  0 < upper_asymptotic_density\n       {n. \\<forall>l\\<in>{1..n}.\n              - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}\n  finite ?A \\<Longrightarrow> upper_asymptotic_density ?A = 0\n\ngoal (1 subgoal):\n 1. infinite\n     {n. \\<forall>l\\<in>{1..n}.\n            - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}", "by force"], ["proof (state)\nthis:\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "then"], ["proof (chain)\npicking this:\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}", "have \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) > - delta l * l})\""], ["proof (prove)\nusing this:\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       infinite\n        {n. \\<forall>l\\<in>{1..n}.\n               - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}", "using H \\<open>0 < d\\<close> \\<open>d\\<le>1\\<close>"], ["proof (prove)\nusing this:\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          - deltaf d l * real l < u n x - u (n - l) ((T ^^ l) x)}\n  0 < ?d12 \\<and> ?d12 \\<le> 1 \\<Longrightarrow>\n  (\\<forall>l. 0 < deltaf ?d12 l) \\<and>\n  deltaf ?d12 \\<longlonglongrightarrow> 0 \\<and>\n  ennreal (1 - ?d12)\n  \\<le> emeasure M\n         {x \\<in> space M.\n          1 - ?d12\n          \\<le> upper_asymptotic_density\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - deltaf ?d12 l * real l\n                        < u n x - u (n - l) ((T ^^ l) x)}}\n  0 < d\n  d \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       infinite\n        {n. \\<forall>l\\<in>{1..n}.\n               - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}", "by auto"], ["proof (state)\nthis:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "}"], ["proof (state)\nthis:\n  ?x14 \\<in> V \\<Longrightarrow>\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n ?x14 - u (n - l) ((T ^^ l) ?x14)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. x \\<in> V\n  ?x14 \\<in> V \\<Longrightarrow>\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n ?x14 - u (n - l) ((T ^^ l) ?x14)}", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. x \\<in> V\n  ?x14 \\<in> V \\<Longrightarrow>\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < u n ?x14 - u (n - l) ((T ^^ l) ?x14)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x)}", "by auto"], ["proof (state)\nthis:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < u n x - u (n - l) ((T ^^ l) x)}\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "text \\<open>Finally, we obtain the full statement, by reducing to the previous situation where the\nasymptotic average vanishes.\\<close>"], ["", "theorem (in pmpt) Gouezel_Karlsson_Kingman:\n  assumes \"subcocycle u\" \"subcocycle_avg_ereal u > -\\<infinity>\"\n  shows \"AE x in M. \\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x > - delta l * l})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have [measurable]: \"integrable M (u n)\" \"u n \\<in> borel_measurable M\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (u n) &&& random_variable borel (u n)", "using subcocycle_integrable[OF assms(1)]"], ["proof (prove)\nusing this:\n  integrable M (u ?n)\n  random_variable borel (u ?n)\n\ngoal (1 subgoal):\n 1. integrable M (u n) &&& random_variable borel (u n)", "by auto"], ["proof (state)\nthis:\n  integrable M (u ?n12)\n  random_variable borel (u ?n12)\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "define v where \"v = birkhoff_sum (\\<lambda>x. -subcocycle_lim u x)\""], ["proof (state)\nthis:\n  v = birkhoff_sum (\\<lambda>x. - subcocycle_lim u x)\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have int [measurable]: \"integrable M (\\<lambda>x. -subcocycle_lim u x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. - subcocycle_lim u x)", "using kingman_theorem_nonergodic(2)[OF assms]"], ["proof (prove)\nusing this:\n  integrable M (subcocycle_lim u)\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. - subcocycle_lim u x)", "by auto"], ["proof (state)\nthis:\n  integrable M (\\<lambda>x. - subcocycle_lim u x)\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have \"subcocycle v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subcocycle v", "unfolding v_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. subcocycle (birkhoff_sum (\\<lambda>x. - subcocycle_lim u x))", "apply (rule subcocycle_birkhoff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. - subcocycle_lim u x)", "using assms \\<open>integrable M (\\<lambda>x. -subcocycle_lim u x)\\<close>"], ["proof (prove)\nusing this:\n  subcocycle u\n  - \\<infinity> < subcocycle_avg_ereal u\n  integrable M (\\<lambda>x. - subcocycle_lim u x)\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. - subcocycle_lim u x)", "unfolding subcocycle_def"], ["proof (prove)\nusing this:\n  (\\<forall>n. integrable M (u n)) \\<and>\n  (\\<forall>n m x. u (n + m) x \\<le> u n x + u m ((T ^^ n) x))\n  - \\<infinity> < subcocycle_avg_ereal u\n  integrable M (\\<lambda>x. - subcocycle_lim u x)\n\ngoal (1 subgoal):\n 1. integrable M (\\<lambda>x. - subcocycle_lim u x)", "by auto"], ["proof (state)\nthis:\n  subcocycle v\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have \"subcocycle_avg_ereal v > - \\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - \\<infinity> < subcocycle_avg_ereal v", "unfolding v_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. - \\<infinity>\n    < subcocycle_avg_ereal (birkhoff_sum (\\<lambda>x. - subcocycle_lim u x))", "using subcocycle_avg_ereal_birkhoff[OF int] kingman_theorem_nonergodic(2)[OF assms]"], ["proof (prove)\nusing this:\n  subcocycle_avg_ereal (birkhoff_sum (\\<lambda>x. - subcocycle_lim u x)) =\n  ereal (expectation (\\<lambda>x. - subcocycle_lim u x))\n  integrable M (subcocycle_lim u)\n\ngoal (1 subgoal):\n 1. - \\<infinity>\n    < subcocycle_avg_ereal (birkhoff_sum (\\<lambda>x. - subcocycle_lim u x))", "by auto"], ["proof (state)\nthis:\n  - \\<infinity> < subcocycle_avg_ereal v\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have \"AE x in M. subcocycle_lim v x = real_cond_exp M Invariants (\\<lambda>x. -subcocycle_lim u x) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim v x =\n               real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x)\n                x", "unfolding v_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim\n                (birkhoff_sum (\\<lambda>x. - subcocycle_lim u x)) x =\n               real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x)\n                x", "by (rule subcocycle_lim_birkhoff[OF int])"], ["proof (state)\nthis:\n  AE x in M. subcocycle_lim v x =\n             real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x) x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "moreover"], ["proof (state)\nthis:\n  AE x in M. subcocycle_lim v x =\n             real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x) x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have \"AE x in M. real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x) x = - subcocycle_lim u x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x)\n                x =\n               - subcocycle_lim u x", "by (rule real_cond_exp_F_meas[OF int], auto)"], ["proof (state)\nthis:\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x)\n              x =\n             - subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. subcocycle_lim v x =\n             real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x) x\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x)\n              x =\n             - subcocycle_lim u x", "have AEv: \"AE x in M. subcocycle_lim v x = - subcocycle_lim u x\""], ["proof (prove)\nusing this:\n  AE x in M. subcocycle_lim v x =\n             real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x) x\n  AE x in M. real_cond_exp M Invariants (\\<lambda>x. - subcocycle_lim u x)\n              x =\n             - subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim v x = - subcocycle_lim u x", "by auto"], ["proof (state)\nthis:\n  AE x in M. subcocycle_lim v x = - subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "define w where \"w = (\\<lambda>n x. u n x + v n x)\""], ["proof (state)\nthis:\n  w = (\\<lambda>n x. u n x + v n x)\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have a: \"subcocycle w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subcocycle w", "unfolding w_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. subcocycle (\\<lambda>n x. u n x + v n x)", "by (rule subcocycle_add[OF assms(1) \\<open>subcocycle v\\<close>])"], ["proof (state)\nthis:\n  subcocycle w\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have b: \"subcocycle_avg_ereal w > -\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - \\<infinity> < subcocycle_avg_ereal w", "unfolding w_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. - \\<infinity> < subcocycle_avg_ereal (\\<lambda>n x. u n x + v n x)", "by (rule subcocycle_avg_add(1)[OF assms(1) \\<open>subcocycle v\\<close> assms(2) \\<open>subcocycle_avg_ereal v > - \\<infinity>\\<close>])"], ["proof (state)\nthis:\n  - \\<infinity> < subcocycle_avg_ereal w\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have \"AE x in M. subcocycle_lim w x = subcocycle_lim u x + subcocycle_lim v x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim w x = subcocycle_lim u x + subcocycle_lim v x", "unfolding w_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim (\\<lambda>n x. u n x + v n x) x =\n               subcocycle_lim u x + subcocycle_lim v x", "by (rule subcocycle_lim_add[OF assms(1) \\<open>subcocycle v\\<close> assms(2) \\<open>subcocycle_avg_ereal v > - \\<infinity>\\<close>])"], ["proof (state)\nthis:\n  AE x in M. subcocycle_lim w x = subcocycle_lim u x + subcocycle_lim v x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "then"], ["proof (chain)\npicking this:\n  AE x in M. subcocycle_lim w x = subcocycle_lim u x + subcocycle_lim v x", "have c: \"AE x in M. subcocycle_lim w x = 0\""], ["proof (prove)\nusing this:\n  AE x in M. subcocycle_lim w x = subcocycle_lim u x + subcocycle_lim v x\n\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim w x = 0", "using AEv"], ["proof (prove)\nusing this:\n  AE x in M. subcocycle_lim w x = subcocycle_lim u x + subcocycle_lim v x\n  AE x in M. subcocycle_lim v x = - subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. subcocycle_lim w x = 0", "by auto"], ["proof (state)\nthis:\n  AE x in M. subcocycle_lim w x = 0\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "interpret Gouezel_Karlsson_Kingman M T w"], ["proof (prove)\ngoal (1 subgoal):\n 1. Gouezel_Karlsson_Kingman M T w", "apply standard"], ["proof (prove)\ngoal (3 subgoals):\n 1. subcocycle w\n 2. - \\<infinity> < subcocycle_avg_ereal w\n 3. AE x in M. subcocycle_lim w x = 0", "using a b c"], ["proof (prove)\nusing this:\n  subcocycle w\n  - \\<infinity> < subcocycle_avg_ereal w\n  AE x in M. subcocycle_lim w x = 0\n\ngoal (3 subgoals):\n 1. subcocycle w\n 2. - \\<infinity> < subcocycle_avg_ereal w\n 3. AE x in M. subcocycle_lim w x = 0", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have \"AE x in M. \\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. w n x - w (n-l) ((T^^l) x) > - delta l * l})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < w n x - w (n - l) ((T ^^ l) x)}", "using infinite_AE"], ["proof (prove)\nusing this:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < w n x - w (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < w n x - w (n - l) ((T ^^ l) x)}", "by auto"], ["proof (state)\nthis:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < w n x - w (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "moreover"], ["proof (state)\nthis:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < w n x - w (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "{"], ["proof (state)\nthis:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < w n x - w (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "assume H: \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. w n x - w (n-l) ((T^^l) x) > - delta l * l})\"\n            \"x \\<in> space M\""], ["proof (state)\nthis:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < w n x - w (n - l) ((T ^^ l) x)}\n  x \\<in> space M\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have *: \"v n x = - n * subcocycle_lim u x\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. v n x = - real n * subcocycle_lim u x", "unfolding v_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. - subcocycle_lim u x) n x =\n    - real n * subcocycle_lim u x", "using birkhoff_sum_of_invariants[OF _ \\<open>x \\<in> space M\\<close>]"], ["proof (prove)\nusing this:\n  ?f \\<in> borel_measurable Invariants \\<Longrightarrow>\n  birkhoff_sum ?f ?n x = real ?n * ?f x\n\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. - subcocycle_lim u x) n x =\n    - real n * subcocycle_lim u x", "by auto"], ["proof (state)\nthis:\n  v ?n12 x = - real ?n12 * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have **: \"v n ((T^^l) x) = - n * subcocycle_lim u x\" for n l"], ["proof (prove)\ngoal (1 subgoal):\n 1. v n ((T ^^ l) x) = - real n * subcocycle_lim u x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. v n ((T ^^ l) x) = - real n * subcocycle_lim u x", "have \"v n ((T^^l) x) = - n * subcocycle_lim u ((T^^l) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v n ((T ^^ l) x) = real_of_int (- int n) * subcocycle_lim u ((T ^^ l) x)", "unfolding v_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. - subcocycle_lim u x) n ((T ^^ l) x) =\n    real_of_int (- int n) * subcocycle_lim u ((T ^^ l) x)", "using birkhoff_sum_of_invariants[OF _ T_spaceM_stable(2)[OF \\<open>x \\<in> space M\\<close>]]"], ["proof (prove)\nusing this:\n  ?f \\<in> borel_measurable Invariants \\<Longrightarrow>\n  birkhoff_sum ?f ?n ((T ^^ ?n1) x) = real ?n * ?f ((T ^^ ?n1) x)\n\ngoal (1 subgoal):\n 1. birkhoff_sum (\\<lambda>x. - subcocycle_lim u x) n ((T ^^ l) x) =\n    real_of_int (- int n) * subcocycle_lim u ((T ^^ l) x)", "by auto"], ["proof (state)\nthis:\n  v n ((T ^^ l) x) = real_of_int (- int n) * subcocycle_lim u ((T ^^ l) x)\n\ngoal (1 subgoal):\n 1. v n ((T ^^ l) x) = - real n * subcocycle_lim u x", "also"], ["proof (state)\nthis:\n  v n ((T ^^ l) x) = real_of_int (- int n) * subcocycle_lim u ((T ^^ l) x)\n\ngoal (1 subgoal):\n 1. v n ((T ^^ l) x) = - real n * subcocycle_lim u x", "have \"... = - n * subcocycle_lim u x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_int (- int n) * subcocycle_lim u ((T ^^ l) x) =\n    real_of_int (- int n) * subcocycle_lim u x", "using Invariants_func_is_invariant_n[OF subcocycle_lim_meas_Inv(2) \\<open>x \\<in> space M\\<close>]"], ["proof (prove)\nusing this:\n  subcocycle_lim ?u1 ((T ^^ ?n) x) = subcocycle_lim ?u1 x\n\ngoal (1 subgoal):\n 1. real_of_int (- int n) * subcocycle_lim u ((T ^^ l) x) =\n    real_of_int (- int n) * subcocycle_lim u x", "by auto"], ["proof (state)\nthis:\n  real_of_int (- int n) * subcocycle_lim u ((T ^^ l) x) =\n  real_of_int (- int n) * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. v n ((T ^^ l) x) = - real n * subcocycle_lim u x", "finally"], ["proof (chain)\npicking this:\n  v n ((T ^^ l) x) = real_of_int (- int n) * subcocycle_lim u x", "show ?thesis"], ["proof (prove)\nusing this:\n  v n ((T ^^ l) x) = real_of_int (- int n) * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. v n ((T ^^ l) x) = - real n * subcocycle_lim u x", "by simp"], ["proof (state)\nthis:\n  v n ((T ^^ l) x) = - real n * subcocycle_lim u x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  v ?n12 ((T ^^ ?l12) x) = - real ?n12 * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "have \"w n x - w (n-l) ((T^^l) x) = u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x\" if \"l \\<in> {1..n}\" for n l"], ["proof (prove)\ngoal (1 subgoal):\n 1. w n x - w (n - l) ((T ^^ l) x) =\n    u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "unfolding w_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. u n x + v n x - (u (n - l) ((T ^^ l) x) + v (n - l) ((T ^^ l) x)) =\n    u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "using *[of n] **[of \"n-l\" l] that"], ["proof (prove)\nusing this:\n  v n x = - real n * subcocycle_lim u x\n  v (n - l) ((T ^^ l) x) = - real (n - l) * subcocycle_lim u x\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. u n x + v n x - (u (n - l) ((T ^^ l) x) + v (n - l) ((T ^^ l) x)) =\n    u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "apply (auto simp add: algebra_simps)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>v n x = - (real n * subcocycle_lim u x);\n     v (n - l) ((T ^^ l) x) = - (real (n - l) * subcocycle_lim u x);\n     Suc 0 \\<le> l; l \\<le> n\\<rbrakk>\n    \\<Longrightarrow> real l * subcocycle_lim u x +\n                      real (n - l) * subcocycle_lim u x =\n                      real n * subcocycle_lim u x", "by (metis comm_semiring_class.distrib diff_add_inverse nat_le_iff_add of_nat_add)"], ["proof (state)\nthis:\n  ?l12 \\<in> {1..?n12} \\<Longrightarrow>\n  w ?n12 x - w (?n12 - ?l12) ((T ^^ ?l12) x) =\n  u ?n12 x - u (?n12 - ?l12) ((T ^^ ?l12) x) -\n  real ?l12 * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "then"], ["proof (chain)\npicking this:\n  ?l12 \\<in> {1..?n12} \\<Longrightarrow>\n  w ?n12 x - w (?n12 - ?l12) ((T ^^ ?l12) x) =\n  u ?n12 x - u (?n12 - ?l12) ((T ^^ ?l12) x) -\n  real ?l12 * subcocycle_lim u x", "have \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x > - delta l * l})\""], ["proof (prove)\nusing this:\n  ?l12 \\<in> {1..?n12} \\<Longrightarrow>\n  w ?n12 x - w (?n12 - ?l12) ((T ^^ ?l12) x) =\n  u ?n12 x - u (?n12 - ?l12) ((T ^^ ?l12) x) -\n  real ?l12 * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       infinite\n        {n. \\<forall>l\\<in>{1..n}.\n               - delta l * real l\n               < u n x - u (n - l) ((T ^^ l) x) -\n                 real l * subcocycle_lim u x}", "using H(1)"], ["proof (prove)\nusing this:\n  ?l12 \\<in> {1..?n12} \\<Longrightarrow>\n  w ?n12 x - w (?n12 - ?l12) ((T ^^ ?l12) x) =\n  u ?n12 x - u (?n12 - ?l12) ((T ^^ ?l12) x) -\n  real ?l12 * subcocycle_lim u x\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l < w n x - w (n - l) ((T ^^ l) x)}\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       infinite\n        {n. \\<forall>l\\<in>{1..n}.\n               - delta l * real l\n               < u n x - u (n - l) ((T ^^ l) x) -\n                 real l * subcocycle_lim u x}", "by auto"], ["proof (state)\nthis:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l\n             < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "}"], ["proof (state)\nthis:\n  \\<lbrakk>\\<exists>delta.\n              (\\<forall>l. 0 < delta l) \\<and>\n              delta \\<longlonglongrightarrow> 0 \\<and>\n              infinite\n               {n. \\<forall>l\\<in>{1..n}.\n                      - delta l * real l\n                      < w n ?x14 - w (n - l) ((T ^^ l) ?x14)};\n   ?x14 \\<in> space M\\<rbrakk>\n  \\<Longrightarrow> \\<exists>delta.\n                       (\\<forall>l. 0 < delta l) \\<and>\n                       delta \\<longlonglongrightarrow> 0 \\<and>\n                       infinite\n                        {n. \\<forall>l\\<in>{1..n}.\n                               - delta l * real l\n                               < u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                                 real l * subcocycle_lim u ?x14}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "ultimately"], ["proof (chain)\npicking this:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < w n x - w (n - l) ((T ^^ l) x)}\n  \\<lbrakk>\\<exists>delta.\n              (\\<forall>l. 0 < delta l) \\<and>\n              delta \\<longlonglongrightarrow> 0 \\<and>\n              infinite\n               {n. \\<forall>l\\<in>{1..n}.\n                      - delta l * real l\n                      < w n ?x14 - w (n - l) ((T ^^ l) ?x14)};\n   ?x14 \\<in> space M\\<rbrakk>\n  \\<Longrightarrow> \\<exists>delta.\n                       (\\<forall>l. 0 < delta l) \\<and>\n                       delta \\<longlonglongrightarrow> 0 \\<and>\n                       infinite\n                        {n. \\<forall>l\\<in>{1..n}.\n                               - delta l * real l\n                               < u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                                 real l * subcocycle_lim u ?x14}", "show ?thesis"], ["proof (prove)\nusing this:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l < w n x - w (n - l) ((T ^^ l) x)}\n  \\<lbrakk>\\<exists>delta.\n              (\\<forall>l. 0 < delta l) \\<and>\n              delta \\<longlonglongrightarrow> 0 \\<and>\n              infinite\n               {n. \\<forall>l\\<in>{1..n}.\n                      - delta l * real l\n                      < w n ?x14 - w (n - l) ((T ^^ l) ?x14)};\n   ?x14 \\<in> space M\\<rbrakk>\n  \\<Longrightarrow> \\<exists>delta.\n                       (\\<forall>l. 0 < delta l) \\<and>\n                       delta \\<longlonglongrightarrow> 0 \\<and>\n                       infinite\n                        {n. \\<forall>l\\<in>{1..n}.\n                               - delta l * real l\n                               < u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                                 real l * subcocycle_lim u ?x14}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          - delta l * real l\n                          < u n x - u (n - l) ((T ^^ l) x) -\n                            real l * subcocycle_lim u x}", "by auto"], ["proof (state)\nthis:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x) -\n                          real l * subcocycle_lim u x}\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The previous theorem only contains a lower bound. The corresponding upper bound follows\nreadily from Kingman's theorem. The next statement combines both upper and lower bounds.\\<close>"], ["", "theorem (in pmpt) Gouezel_Karlsson_Kingman':\n  assumes \"subcocycle u\" \"subcocycle_avg_ereal u > -\\<infinity>\"\n  shows \"AE x in M. \\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. abs(u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x) < delta l * l})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "assume x: \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x > - delta l * l})\"\n                    \"(\\<lambda>l. u l x/l) \\<longlonglongrightarrow> subcocycle_lim u x\""], ["proof (state)\nthis:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l\n             < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n  (\\<lambda>l. u l x / real l) \\<longlonglongrightarrow> subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "then"], ["proof (chain)\npicking this:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l\n             < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n  (\\<lambda>l. u l x / real l) \\<longlonglongrightarrow> subcocycle_lim u x", "obtain alpha::\"nat \\<Rightarrow> real\" where a: \"\\<And>l. alpha l > 0\" \"alpha \\<longlonglongrightarrow> 0\"\n        \"infinite {n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x > - alpha l * l}\""], ["proof (prove)\nusing this:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             - delta l * real l\n             < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n  (\\<lambda>l. u l x / real l) \\<longlonglongrightarrow> subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. (\\<And>alpha.\n        \\<lbrakk>\\<And>l. 0 < alpha l; alpha \\<longlonglongrightarrow> 0;\n         infinite\n          {n. \\<forall>l\\<in>{1..n}.\n                 - alpha l * real l\n                 < u n x - u (n - l) ((T ^^ l) x) -\n                   real l * subcocycle_lim u x}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < alpha ?l12\n  alpha \\<longlonglongrightarrow> 0\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          - alpha l * real l\n          < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "define delta::\"nat \\<Rightarrow> real\" where \"delta = (\\<lambda>l. alpha l + norm(u l x / l - subcocycle_lim u x))\""], ["proof (state)\nthis:\n  delta = (\\<lambda>l. alpha l + norm (u l x / real l - subcocycle_lim u x))\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "{"], ["proof (state)\nthis:\n  delta = (\\<lambda>l. alpha l + norm (u l x / real l - subcocycle_lim u x))\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "assume *: \"\\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x > - alpha l * l\""], ["proof (state)\nthis:\n  \\<forall>l\\<in>{1..n}.\n     - alpha l * real l\n     < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "have H: \"x > -a \\<Longrightarrow> x < a \\<Longrightarrow> abs x < a\" for a x::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>- a < x; x < a\\<rbrakk> \\<Longrightarrow> \\<bar>x\\<bar> < a", "by simp"], ["proof (state)\nthis:\n  \\<lbrakk>- ?a12 < ?x12; ?x12 < ?a12\\<rbrakk>\n  \\<Longrightarrow> \\<bar>?x12\\<bar> < ?a12\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "have \"abs(u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x) < delta l * l\" if \"l\\<in>{1..n}\" for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\\<bar>\n    < delta l * real l", "proof (rule H)"], ["proof (state)\ngoal (2 subgoals):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n 2. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    < delta l * real l", "have \"u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x \\<le> u l x - l * subcocycle_lim u x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    \\<le> u l x - real l * subcocycle_lim u x", "using assms(1) subcocycle_ineq[OF assms(1), of l \"n-l\" x] that"], ["proof (prove)\nusing this:\n  subcocycle u\n  u (l + (n - l)) x \\<le> u l x + u (n - l) ((T ^^ l) x)\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    \\<le> u l x - real l * subcocycle_lim u x", "by auto"], ["proof (state)\nthis:\n  u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n  \\<le> u l x - real l * subcocycle_lim u x\n\ngoal (2 subgoals):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n 2. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    < delta l * real l", "also"], ["proof (state)\nthis:\n  u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n  \\<le> u l x - real l * subcocycle_lim u x\n\ngoal (2 subgoals):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n 2. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    < delta l * real l", "have \"... \\<le> l * norm(u l x/l - subcocycle_lim u x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u l x - real l * subcocycle_lim u x\n    \\<le> real l * norm (u l x / real l - subcocycle_lim u x)", "using that"], ["proof (prove)\nusing this:\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. u l x - real l * subcocycle_lim u x\n    \\<le> real l * norm (u l x / real l - subcocycle_lim u x)", "by (auto simp add: algebra_simps divide_simps)"], ["proof (state)\nthis:\n  u l x - real l * subcocycle_lim u x\n  \\<le> real l * norm (u l x / real l - subcocycle_lim u x)\n\ngoal (2 subgoals):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n 2. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    < delta l * real l", "also"], ["proof (state)\nthis:\n  u l x - real l * subcocycle_lim u x\n  \\<le> real l * norm (u l x / real l - subcocycle_lim u x)\n\ngoal (2 subgoals):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n 2. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    < delta l * real l", "have \"... < delta l * l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real l * norm (u l x / real l - subcocycle_lim u x) < delta l * real l", "unfolding delta_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. real l * norm (u l x / real l - subcocycle_lim u x)\n    < (alpha l + norm (u l x / real l - subcocycle_lim u x)) * real l", "using a(1)[of l] that"], ["proof (prove)\nusing this:\n  0 < alpha l\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. real l * norm (u l x / real l - subcocycle_lim u x)\n    < (alpha l + norm (u l x / real l - subcocycle_lim u x)) * real l", "by auto"], ["proof (state)\nthis:\n  real l * norm (u l x / real l - subcocycle_lim u x) < delta l * real l\n\ngoal (2 subgoals):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n 2. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    < delta l * real l", "finally"], ["proof (chain)\npicking this:\n  u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n  < delta l * real l", "show \"u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x < delta l * l\""], ["proof (prove)\nusing this:\n  u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n  < delta l * real l\n\ngoal (1 subgoal):\n 1. u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n    < delta l * real l", "by simp"], ["proof (state)\nthis:\n  u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n  < delta l * real l\n\ngoal (1 subgoal):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "have \"- (delta l * l) \\<le> -alpha l * l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - (delta l * real l) \\<le> - alpha l * real l", "unfolding delta_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. - ((alpha l + norm (u l x / real l - subcocycle_lim u x)) * real l)\n    \\<le> - alpha l * real l", "by (auto simp add: algebra_simps)"], ["proof (state)\nthis:\n  - (delta l * real l) \\<le> - alpha l * real l\n\ngoal (1 subgoal):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "also"], ["proof (state)\nthis:\n  - (delta l * real l) \\<le> - alpha l * real l\n\ngoal (1 subgoal):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "have \"... < u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - alpha l * real l\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "using * that"], ["proof (prove)\nusing this:\n  \\<forall>l\\<in>{1..n}.\n     - alpha l * real l\n     < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n  l \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. - alpha l * real l\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "by auto"], ["proof (state)\nthis:\n  - alpha l * real l\n  < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "finally"], ["proof (chain)\npicking this:\n  - (delta l * real l)\n  < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "show \"u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x > -(delta l * l)\""], ["proof (prove)\nusing this:\n  - (delta l * real l)\n  < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. - (delta l * real l)\n    < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x", "by simp"], ["proof (state)\nthis:\n  - (delta l * real l)\n  < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?l12 \\<in> {1..n} \\<Longrightarrow>\n  \\<bar>u n x - u (n - ?l12) ((T ^^ ?l12) x) -\n        real ?l12 * subcocycle_lim u x\\<bar>\n  < delta ?l12 * real ?l12\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "then"], ["proof (chain)\npicking this:\n  ?l12 \\<in> {1..n} \\<Longrightarrow>\n  \\<bar>u n x - u (n - ?l12) ((T ^^ ?l12) x) -\n        real ?l12 * subcocycle_lim u x\\<bar>\n  < delta ?l12 * real ?l12", "have \"\\<forall>l \\<in> {1..n}. abs(u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x) < delta l * l\""], ["proof (prove)\nusing this:\n  ?l12 \\<in> {1..n} \\<Longrightarrow>\n  \\<bar>u n x - u (n - ?l12) ((T ^^ ?l12) x) -\n        real ?l12 * subcocycle_lim u x\\<bar>\n  < delta ?l12 * real ?l12\n\ngoal (1 subgoal):\n 1. \\<forall>l\\<in>{1..n}.\n       \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n             real l * subcocycle_lim u x\\<bar>\n       < delta l * real l", "by auto"], ["proof (state)\nthis:\n  \\<forall>l\\<in>{1..n}.\n     \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n           real l * subcocycle_lim u x\\<bar>\n     < delta l * real l\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "}"], ["proof (state)\nthis:\n  \\<forall>l\\<in>{1..?n14}.\n     - alpha l * real l\n     < u ?n14 x - u (?n14 - l) ((T ^^ l) x) -\n       real l * subcocycle_lim u x \\<Longrightarrow>\n  \\<forall>l\\<in>{1..?n14}.\n     \\<bar>u ?n14 x - u (?n14 - l) ((T ^^ l) x) -\n           real l * subcocycle_lim u x\\<bar>\n     < delta l * real l\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "then"], ["proof (chain)\npicking this:\n  \\<forall>l\\<in>{1..?n14}.\n     - alpha l * real l\n     < u ?n14 x - u (?n14 - l) ((T ^^ l) x) -\n       real l * subcocycle_lim u x \\<Longrightarrow>\n  \\<forall>l\\<in>{1..?n14}.\n     \\<bar>u ?n14 x - u (?n14 - l) ((T ^^ l) x) -\n           real l * subcocycle_lim u x\\<bar>\n     < delta l * real l", "have \"{n. \\<forall>l \\<in> {1..n}. u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x > - alpha l * l}\n          \\<subseteq> {n. \\<forall>l \\<in> {1..n}. abs(u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x) < delta l * l}\""], ["proof (prove)\nusing this:\n  \\<forall>l\\<in>{1..?n14}.\n     - alpha l * real l\n     < u ?n14 x - u (?n14 - l) ((T ^^ l) x) -\n       real l * subcocycle_lim u x \\<Longrightarrow>\n  \\<forall>l\\<in>{1..?n14}.\n     \\<bar>u ?n14 x - u (?n14 - l) ((T ^^ l) x) -\n           real l * subcocycle_lim u x\\<bar>\n     < delta l * real l\n\ngoal (1 subgoal):\n 1. {n. \\<forall>l\\<in>{1..n}.\n           - alpha l * real l\n           < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n    \\<subseteq> {n. \\<forall>l\\<in>{1..n}.\n                       \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                             real l * subcocycle_lim u x\\<bar>\n                       < delta l * real l}", "by auto"], ["proof (state)\nthis:\n  {n. \\<forall>l\\<in>{1..n}.\n         - alpha l * real l\n         < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n  \\<subseteq> {n. \\<forall>l\\<in>{1..n}.\n                     \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                           real l * subcocycle_lim u x\\<bar>\n                     < delta l * real l}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "then"], ["proof (chain)\npicking this:\n  {n. \\<forall>l\\<in>{1..n}.\n         - alpha l * real l\n         < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n  \\<subseteq> {n. \\<forall>l\\<in>{1..n}.\n                     \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                           real l * subcocycle_lim u x\\<bar>\n                     < delta l * real l}", "have \"infinite {n. \\<forall>l \\<in> {1..n}. abs(u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x) < delta l * l}\""], ["proof (prove)\nusing this:\n  {n. \\<forall>l\\<in>{1..n}.\n         - alpha l * real l\n         < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n  \\<subseteq> {n. \\<forall>l\\<in>{1..n}.\n                     \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                           real l * subcocycle_lim u x\\<bar>\n                     < delta l * real l}\n\ngoal (1 subgoal):\n 1. infinite\n     {n. \\<forall>l\\<in>{1..n}.\n            \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                  real l * subcocycle_lim u x\\<bar>\n            < delta l * real l}", "using a(3) finite_subset"], ["proof (prove)\nusing this:\n  {n. \\<forall>l\\<in>{1..n}.\n         - alpha l * real l\n         < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n  \\<subseteq> {n. \\<forall>l\\<in>{1..n}.\n                     \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                           real l * subcocycle_lim u x\\<bar>\n                     < delta l * real l}\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          - alpha l * real l\n          < u n x - u (n - l) ((T ^^ l) x) - real l * subcocycle_lim u x}\n  \\<lbrakk>?A \\<subseteq> ?B; finite ?B\\<rbrakk> \\<Longrightarrow> finite ?A\n\ngoal (1 subgoal):\n 1. infinite\n     {n. \\<forall>l\\<in>{1..n}.\n            \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                  real l * subcocycle_lim u x\\<bar>\n            < delta l * real l}", "by blast"], ["proof (state)\nthis:\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                real l * subcocycle_lim u x\\<bar>\n          < delta l * real l}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "moreover"], ["proof (state)\nthis:\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                real l * subcocycle_lim u x\\<bar>\n          < delta l * real l}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "have \"delta \\<longlonglongrightarrow> 0 + 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. delta \\<longlonglongrightarrow> 0 + 0", "unfolding delta_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>l. alpha l + norm (u l x / real l - subcocycle_lim u x))\n    \\<longlonglongrightarrow> 0 + 0", "using x(2)"], ["proof (prove)\nusing this:\n  (\\<lambda>l. u l x / real l) \\<longlonglongrightarrow> subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. (\\<lambda>l. alpha l + norm (u l x / real l - subcocycle_lim u x))\n    \\<longlonglongrightarrow> 0 + 0", "by (intro tendsto_intros a(2) tendsto_norm_zero LIM_zero)"], ["proof (state)\nthis:\n  delta \\<longlonglongrightarrow> 0 + 0\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "moreover"], ["proof (state)\nthis:\n  delta \\<longlonglongrightarrow> 0 + 0\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "have \"delta l > 0\" for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < delta l", "unfolding delta_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < alpha l + norm (u l x / real l - subcocycle_lim u x)", "using a(1)[of l]"], ["proof (prove)\nusing this:\n  0 < alpha l\n\ngoal (1 subgoal):\n 1. 0 < alpha l + norm (u l x / real l - subcocycle_lim u x)", "by auto"], ["proof (state)\nthis:\n  0 < delta ?l12\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "ultimately"], ["proof (chain)\npicking this:\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                real l * subcocycle_lim u x\\<bar>\n          < delta l * real l}\n  delta \\<longlonglongrightarrow> 0 + 0\n  0 < delta ?l12", "have \"\\<exists>delta::nat\\<Rightarrow>real. (\\<forall>l. delta l > 0) \\<and> (delta \\<longlonglongrightarrow> 0) \\<and>\n          (infinite {n. \\<forall>l \\<in> {1..n}. abs(u n x - u (n-l) ((T^^l) x) - l * subcocycle_lim u x) < delta l * l})\""], ["proof (prove)\nusing this:\n  infinite\n   {n. \\<forall>l\\<in>{1..n}.\n          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                real l * subcocycle_lim u x\\<bar>\n          < delta l * real l}\n  delta \\<longlonglongrightarrow> 0 + 0\n  0 < delta ?l12\n\ngoal (1 subgoal):\n 1. \\<exists>delta.\n       (\\<forall>l. 0 < delta l) \\<and>\n       delta \\<longlonglongrightarrow> 0 \\<and>\n       infinite\n        {n. \\<forall>l\\<in>{1..n}.\n               \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                     real l * subcocycle_lim u x\\<bar>\n               < delta l * real l}", "by auto"], ["proof (state)\nthis:\n  \\<exists>delta.\n     (\\<forall>l. 0 < delta l) \\<and>\n     delta \\<longlonglongrightarrow> 0 \\<and>\n     infinite\n      {n. \\<forall>l\\<in>{1..n}.\n             \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                   real l * subcocycle_lim u x\\<bar>\n             < delta l * real l}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "}"], ["proof (state)\nthis:\n  \\<lbrakk>\\<exists>delta.\n              (\\<forall>l. 0 < delta l) \\<and>\n              delta \\<longlonglongrightarrow> 0 \\<and>\n              infinite\n               {n. \\<forall>l\\<in>{1..n}.\n                      - delta l * real l\n                      < u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                        real l * subcocycle_lim u ?x14};\n   (\\<lambda>l. u l ?x14 / real l)\n   \\<longlonglongrightarrow> subcocycle_lim u ?x14\\<rbrakk>\n  \\<Longrightarrow> \\<exists>delta.\n                       (\\<forall>l. 0 < delta l) \\<and>\n                       delta \\<longlonglongrightarrow> 0 \\<and>\n                       infinite\n                        {n. \\<forall>l\\<in>{1..n}.\n                               \\<bar>u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                                     real l * subcocycle_lim u ?x14\\<bar>\n                               < delta l * real l}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<exists>delta.\n              (\\<forall>l. 0 < delta l) \\<and>\n              delta \\<longlonglongrightarrow> 0 \\<and>\n              infinite\n               {n. \\<forall>l\\<in>{1..n}.\n                      - delta l * real l\n                      < u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                        real l * subcocycle_lim u ?x14};\n   (\\<lambda>l. u l ?x14 / real l)\n   \\<longlonglongrightarrow> subcocycle_lim u ?x14\\<rbrakk>\n  \\<Longrightarrow> \\<exists>delta.\n                       (\\<forall>l. 0 < delta l) \\<and>\n                       delta \\<longlonglongrightarrow> 0 \\<and>\n                       infinite\n                        {n. \\<forall>l\\<in>{1..n}.\n                               \\<bar>u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                                     real l * subcocycle_lim u ?x14\\<bar>\n                               < delta l * real l}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<exists>delta.\n              (\\<forall>l. 0 < delta l) \\<and>\n              delta \\<longlonglongrightarrow> 0 \\<and>\n              infinite\n               {n. \\<forall>l\\<in>{1..n}.\n                      - delta l * real l\n                      < u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                        real l * subcocycle_lim u ?x14};\n   (\\<lambda>l. u l ?x14 / real l)\n   \\<longlonglongrightarrow> subcocycle_lim u ?x14\\<rbrakk>\n  \\<Longrightarrow> \\<exists>delta.\n                       (\\<forall>l. 0 < delta l) \\<and>\n                       delta \\<longlonglongrightarrow> 0 \\<and>\n                       infinite\n                        {n. \\<forall>l\\<in>{1..n}.\n                               \\<bar>u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                                     real l * subcocycle_lim u ?x14\\<bar>\n                               < delta l * real l}\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "using Gouezel_Karlsson_Kingman[OF assms] kingman_theorem_nonergodic(1)[OF assms]"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<exists>delta.\n              (\\<forall>l. 0 < delta l) \\<and>\n              delta \\<longlonglongrightarrow> 0 \\<and>\n              infinite\n               {n. \\<forall>l\\<in>{1..n}.\n                      - delta l * real l\n                      < u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                        real l * subcocycle_lim u ?x14};\n   (\\<lambda>l. u l ?x14 / real l)\n   \\<longlonglongrightarrow> subcocycle_lim u ?x14\\<rbrakk>\n  \\<Longrightarrow> \\<exists>delta.\n                       (\\<forall>l. 0 < delta l) \\<and>\n                       delta \\<longlonglongrightarrow> 0 \\<and>\n                       infinite\n                        {n. \\<forall>l\\<in>{1..n}.\n                               \\<bar>u n ?x14 - u (n - l) ((T ^^ l) ?x14) -\n                                     real l * subcocycle_lim u ?x14\\<bar>\n                               < delta l * real l}\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        - delta l * real l\n                        < u n x - u (n - l) ((T ^^ l) x) -\n                          real l * subcocycle_lim u x}\n  AE x in M. (\\<lambda>n. u n x / real n)\n             \\<longlonglongrightarrow> subcocycle_lim u x\n\ngoal (1 subgoal):\n 1. AE x in M. \\<exists>delta.\n                  (\\<forall>l. 0 < delta l) \\<and>\n                  delta \\<longlonglongrightarrow> 0 \\<and>\n                  infinite\n                   {n. \\<forall>l\\<in>{1..n}.\n                          \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                                real l * subcocycle_lim u x\\<bar>\n                          < delta l * real l}", "by auto"], ["proof (state)\nthis:\n  AE x in M. \\<exists>delta.\n                (\\<forall>l. 0 < delta l) \\<and>\n                delta \\<longlonglongrightarrow> 0 \\<and>\n                infinite\n                 {n. \\<forall>l\\<in>{1..n}.\n                        \\<bar>u n x - u (n - l) ((T ^^ l) x) -\n                              real l * subcocycle_lim u x\\<bar>\n                        < delta l * real l}\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "(*of Gouezel_Karlsson.thy*)"]]}