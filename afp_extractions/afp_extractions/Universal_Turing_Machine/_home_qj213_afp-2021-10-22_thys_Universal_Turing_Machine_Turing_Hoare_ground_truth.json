{"file_name": "/home/qj213/afp-2021-10-22/thys/Universal_Turing_Machine/Turing_Hoare.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Universal_Turing_Machine", "problem_names": ["lemma refl_assert[intro, simp]:\n  \"P \\<mapsto> P\"", "lemma is_final_holds[simp]:\n  assumes \"is_final c\"\n  shows \"Q holds_for (steps c p n) = Q holds_for c\"", "lemma Hoare_haltI:\n  assumes \"\\<And>l r. P (l, r) \\<Longrightarrow> \\<exists>n. is_final (steps0 (1, (l, r)) p n) \\<and> Q holds_for (steps0 (1, (l, r)) p n)\"\n  shows \"{P} p {Q}\"", "lemma Hoare_unhaltI:\n  assumes \"\\<And>l r n. P (l, r) \\<Longrightarrow> \\<not> is_final (steps0 (1, (l, r)) p n)\"\n  shows \"{P} p \\<up>\"", "lemma Hoare_plus_halt [case_names A_halt B_halt A_wf]: \n  assumes A_halt : \"{P} A {Q}\"\n    and B_halt : \"{Q} B {S}\"\n    and A_wf : \"tm_wf (A, 0)\"\n  shows \"{P} A |+| B {S}\"", "lemma Hoare_plus_unhalt [case_names A_halt B_unhalt A_wf]:\n  assumes A_halt: \"{P} A {Q}\"\n    and B_uhalt: \"{Q} B \\<up>\"\n    and A_wf : \"tm_wf (A, 0)\"\n  shows \"{P} (A |+| B) \\<up>\"", "lemma Hoare_consequence:\n  assumes \"P' \\<mapsto> P\" \"{P} p {Q}\" \"Q \\<mapsto> Q'\"\n  shows \"{P'} p {Q'}\""], "translations": [["", "lemma refl_assert[intro, simp]:\n  \"P \\<mapsto> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P \\<mapsto> P", "unfolding assert_imp_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l r. P (l, r) \\<longrightarrow> P (l, r)", "by simp"], ["", "fun \n  holds_for :: \"(tape \\<Rightarrow> bool) \\<Rightarrow> config \\<Rightarrow> bool\" (\"_ holds'_for _\" [100, 99] 100)\n  where\n    \"P holds_for (s, l, r) = P (l, r)\""], ["", "lemma is_final_holds[simp]:\n  assumes \"is_final c\"\n  shows \"Q holds_for (steps c p n) = Q holds_for c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Q holds_for steps c p n = Q holds_for c", "using assms"], ["proof (prove)\nusing this:\n  is_final c\n\ngoal (1 subgoal):\n 1. Q holds_for steps c p n = Q holds_for c", "by(induct n;cases c,auto)"], ["", "(* Hoare Rules *)\n\n(* halting case *)"], ["", "definition\n  Hoare_halt :: \"assert \\<Rightarrow> tprog0 \\<Rightarrow> assert \\<Rightarrow> bool\" (\"({(1_)}/ (_)/ {(1_)})\" 50)\n  where\n    \"{P} p {Q} \\<equiv> (\\<forall>tp. P tp \\<longrightarrow> (\\<exists>n. is_final (steps0 (1, tp) p n) \\<and> Q holds_for (steps0 (1, tp) p n)))\""], ["", "(* not halting case *)"], ["", "definition\n  Hoare_unhalt :: \"assert \\<Rightarrow> tprog0 \\<Rightarrow> bool\" (\"({(1_)}/ (_)) \\<up>\" 50)\n  where\n    \"{P} p \\<up> \\<equiv> \\<forall>tp. P tp \\<longrightarrow> (\\<forall> n . \\<not> (is_final (steps0 (1, tp) p n)))\""], ["", "lemma Hoare_haltI:\n  assumes \"\\<And>l r. P (l, r) \\<Longrightarrow> \\<exists>n. is_final (steps0 (1, (l, r)) p n) \\<and> Q holds_for (steps0 (1, (l, r)) p n)\"\n  shows \"{P} p {Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {P} p {Q}", "unfolding Hoare_halt_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>tp.\n       P tp \\<longrightarrow>\n       (\\<exists>n.\n           is_final (steps0 (1, tp) p n) \\<and>\n           Q holds_for steps0 (1, tp) p n)", "using assms"], ["proof (prove)\nusing this:\n  P (?l, ?r) \\<Longrightarrow>\n  \\<exists>n.\n     is_final (steps0 (1, ?l, ?r) p n) \\<and>\n     Q holds_for steps0 (1, ?l, ?r) p n\n\ngoal (1 subgoal):\n 1. \\<forall>tp.\n       P tp \\<longrightarrow>\n       (\\<exists>n.\n           is_final (steps0 (1, tp) p n) \\<and>\n           Q holds_for steps0 (1, tp) p n)", "by auto"], ["", "lemma Hoare_unhaltI:\n  assumes \"\\<And>l r n. P (l, r) \\<Longrightarrow> \\<not> is_final (steps0 (1, (l, r)) p n)\"\n  shows \"{P} p \\<up>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {P} p \\<up>", "unfolding Hoare_unhalt_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>tp.\n       P tp \\<longrightarrow>\n       (\\<forall>n. \\<not> is_final (steps0 (1, tp) p n))", "using assms"], ["proof (prove)\nusing this:\n  P (?l, ?r) \\<Longrightarrow> \\<not> is_final (steps0 (1, ?l, ?r) p ?n)\n\ngoal (1 subgoal):\n 1. \\<forall>tp.\n       P tp \\<longrightarrow>\n       (\\<forall>n. \\<not> is_final (steps0 (1, tp) p n))", "by auto"], ["", "text \\<open>\n  {P} A {Q}   {Q} B {S}  A well-formed\n  -----------------------------------------\n  {P} A |+| B {S}\n\\<close>"], ["", "lemma Hoare_plus_halt [case_names A_halt B_halt A_wf]: \n  assumes A_halt : \"{P} A {Q}\"\n    and B_halt : \"{Q} B {S}\"\n    and A_wf : \"tm_wf (A, 0)\"\n  shows \"{P} A |+| B {S}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {P} A |+| B {S}", "proof(rule Hoare_haltI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "fix l r"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "assume h: \"P (l, r)\""], ["proof (state)\nthis:\n  P (l, r)\n\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "then"], ["proof (chain)\npicking this:\n  P (l, r)", "obtain n1 l' r' \n    where \"is_final (steps0 (1, l, r) A n1)\"  \n      and a1: \"Q holds_for (steps0 (1, l, r) A n1)\"\n      and a2: \"steps0 (1, l, r) A n1 = (0, l', r')\""], ["proof (prove)\nusing this:\n  P (l, r)\n\ngoal (1 subgoal):\n 1. (\\<And>n1 l' r'.\n        \\<lbrakk>is_final (steps0 (1, l, r) A n1);\n         Q holds_for steps0 (1, l, r) A n1;\n         steps0 (1, l, r) A n1 = (0, l', r')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using A_halt"], ["proof (prove)\nusing this:\n  P (l, r)\n  {P} A {Q}\n\ngoal (1 subgoal):\n 1. (\\<And>n1 l' r'.\n        \\<lbrakk>is_final (steps0 (1, l, r) A n1);\n         Q holds_for steps0 (1, l, r) A n1;\n         steps0 (1, l, r) A n1 = (0, l', r')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding Hoare_halt_def"], ["proof (prove)\nusing this:\n  P (l, r)\n  \\<forall>tp.\n     P tp \\<longrightarrow>\n     (\\<exists>n.\n         is_final (steps0 (1, tp) A n) \\<and>\n         Q holds_for steps0 (1, tp) A n)\n\ngoal (1 subgoal):\n 1. (\\<And>n1 l' r'.\n        \\<lbrakk>is_final (steps0 (1, l, r) A n1);\n         Q holds_for steps0 (1, l, r) A n1;\n         steps0 (1, l, r) A n1 = (0, l', r')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis is_final_eq surj_pair)"], ["proof (state)\nthis:\n  is_final (steps0 (1, l, r) A n1)\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')\n\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "then"], ["proof (chain)\npicking this:\n  is_final (steps0 (1, l, r) A n1)\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')", "obtain n2 \n    where \"steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\""], ["proof (prove)\nusing this:\n  is_final (steps0 (1, l, r) A n1)\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')\n\ngoal (1 subgoal):\n 1. (\\<And>n2.\n        steps0 (1, l, r) (A |+| B) n2 =\n        (Suc (length A div 2), l', r') \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using A_wf"], ["proof (prove)\nusing this:\n  is_final (steps0 (1, l, r) A n1)\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')\n  tm_wf0 A\n\ngoal (1 subgoal):\n 1. (\\<And>n2.\n        steps0 (1, l, r) (A |+| B) n2 =\n        (Suc (length A div 2), l', r') \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (rule_tac tm_comp_next)"], ["proof (state)\nthis:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "moreover"], ["proof (state)\nthis:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "from a1 a2"], ["proof (chain)\npicking this:\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')", "have \"Q (l', r')\""], ["proof (prove)\nusing this:\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')\n\ngoal (1 subgoal):\n 1. Q (l', r')", "by (simp)"], ["proof (state)\nthis:\n  Q (l', r')\n\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "then"], ["proof (chain)\npicking this:\n  Q (l', r')", "obtain n3 l'' r''\n    where \"is_final (steps0 (1, l', r') B n3)\" \n      and b1: \"S holds_for (steps0 (1, l', r') B n3)\"\n      and b2: \"steps0 (1, l', r') B n3 = (0, l'', r'')\""], ["proof (prove)\nusing this:\n  Q (l', r')\n\ngoal (1 subgoal):\n 1. (\\<And>n3 l'' r''.\n        \\<lbrakk>is_final (steps0 (1, l', r') B n3);\n         S holds_for steps0 (1, l', r') B n3;\n         steps0 (1, l', r') B n3 = (0, l'', r'')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using B_halt"], ["proof (prove)\nusing this:\n  Q (l', r')\n  {Q} B {S}\n\ngoal (1 subgoal):\n 1. (\\<And>n3 l'' r''.\n        \\<lbrakk>is_final (steps0 (1, l', r') B n3);\n         S holds_for steps0 (1, l', r') B n3;\n         steps0 (1, l', r') B n3 = (0, l'', r'')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding Hoare_halt_def"], ["proof (prove)\nusing this:\n  Q (l', r')\n  \\<forall>tp.\n     Q tp \\<longrightarrow>\n     (\\<exists>n.\n         is_final (steps0 (1, tp) B n) \\<and>\n         S holds_for steps0 (1, tp) B n)\n\ngoal (1 subgoal):\n 1. (\\<And>n3 l'' r''.\n        \\<lbrakk>is_final (steps0 (1, l', r') B n3);\n         S holds_for steps0 (1, l', r') B n3;\n         steps0 (1, l', r') B n3 = (0, l'', r'')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis is_final_eq surj_pair)"], ["proof (state)\nthis:\n  is_final (steps0 (1, l', r') B n3)\n  S holds_for steps0 (1, l', r') B n3\n  steps0 (1, l', r') B n3 = (0, l'', r'')\n\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "then"], ["proof (chain)\npicking this:\n  is_final (steps0 (1, l', r') B n3)\n  S holds_for steps0 (1, l', r') B n3\n  steps0 (1, l', r') B n3 = (0, l'', r'')", "have \"steps0 (Suc (length A div 2), l', r')  (A |+| B) n3 = (0, l'', r'')\""], ["proof (prove)\nusing this:\n  is_final (steps0 (1, l', r') B n3)\n  S holds_for steps0 (1, l', r') B n3\n  steps0 (1, l', r') B n3 = (0, l'', r'')\n\ngoal (1 subgoal):\n 1. steps0 (Suc (length A div 2), l', r') (A |+| B) n3 = (0, l'', r'')", "using A_wf"], ["proof (prove)\nusing this:\n  is_final (steps0 (1, l', r') B n3)\n  S holds_for steps0 (1, l', r') B n3\n  steps0 (1, l', r') B n3 = (0, l'', r'')\n  tm_wf0 A\n\ngoal (1 subgoal):\n 1. steps0 (Suc (length A div 2), l', r') (A |+| B) n3 = (0, l'', r'')", "by (rule_tac tm_comp_final)"], ["proof (state)\nthis:\n  steps0 (Suc (length A div 2), l', r') (A |+| B) n3 = (0, l'', r'')\n\ngoal (1 subgoal):\n 1. \\<And>l r.\n       P (l, r) \\<Longrightarrow>\n       \\<exists>n.\n          is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n          S holds_for steps0 (1, l, r) (A |+| B) n", "ultimately"], ["proof (chain)\npicking this:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n  steps0 (Suc (length A div 2), l', r') (A |+| B) n3 = (0, l'', r'')", "show \n    \"\\<exists>n. is_final (steps0 (1, l, r) (A |+| B) n) \\<and> S holds_for (steps0 (1, l, r) (A |+| B) n)\""], ["proof (prove)\nusing this:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n  steps0 (Suc (length A div 2), l', r') (A |+| B) n3 = (0, l'', r'')\n\ngoal (1 subgoal):\n 1. \\<exists>n.\n       is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n       S holds_for steps0 (1, l, r) (A |+| B) n", "using b1 b2"], ["proof (prove)\nusing this:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n  steps0 (Suc (length A div 2), l', r') (A |+| B) n3 = (0, l'', r'')\n  S holds_for steps0 (1, l', r') B n3\n  steps0 (1, l', r') B n3 = (0, l'', r'')\n\ngoal (1 subgoal):\n 1. \\<exists>n.\n       is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n       S holds_for steps0 (1, l, r) (A |+| B) n", "by (rule_tac x = \"n2 + n3\" in exI) (simp)"], ["proof (state)\nthis:\n  \\<exists>n.\n     is_final (steps0 (1, l, r) (A |+| B) n) \\<and>\n     S holds_for steps0 (1, l, r) (A |+| B) n\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  {P} A {Q}   {Q} B loops   A well-formed\n  ------------------------------------------\n          {P} A |+| B  loops\n\\<close>"], ["", "lemma Hoare_plus_unhalt [case_names A_halt B_unhalt A_wf]:\n  assumes A_halt: \"{P} A {Q}\"\n    and B_uhalt: \"{Q} B \\<up>\"\n    and A_wf : \"tm_wf (A, 0)\"\n  shows \"{P} (A |+| B) \\<up>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {P} A |+| B \\<up>", "proof(rule_tac Hoare_unhaltI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l r n.\n       P (l, r) \\<Longrightarrow>\n       \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "fix n l r"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l r n.\n       P (l, r) \\<Longrightarrow>\n       \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "assume h: \"P (l, r)\""], ["proof (state)\nthis:\n  P (l, r)\n\ngoal (1 subgoal):\n 1. \\<And>l r n.\n       P (l, r) \\<Longrightarrow>\n       \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  P (l, r)", "obtain n1 l' r'\n    where a: \"is_final (steps0 (1, l, r) A n1)\" \n      and b: \"Q holds_for (steps0 (1, l, r) A n1)\"\n      and c: \"steps0 (1, l, r) A n1 = (0, l', r')\""], ["proof (prove)\nusing this:\n  P (l, r)\n\ngoal (1 subgoal):\n 1. (\\<And>n1 l' r'.\n        \\<lbrakk>is_final (steps0 (1, l, r) A n1);\n         Q holds_for steps0 (1, l, r) A n1;\n         steps0 (1, l, r) A n1 = (0, l', r')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using A_halt"], ["proof (prove)\nusing this:\n  P (l, r)\n  {P} A {Q}\n\ngoal (1 subgoal):\n 1. (\\<And>n1 l' r'.\n        \\<lbrakk>is_final (steps0 (1, l, r) A n1);\n         Q holds_for steps0 (1, l, r) A n1;\n         steps0 (1, l, r) A n1 = (0, l', r')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding Hoare_halt_def"], ["proof (prove)\nusing this:\n  P (l, r)\n  \\<forall>tp.\n     P tp \\<longrightarrow>\n     (\\<exists>n.\n         is_final (steps0 (1, tp) A n) \\<and>\n         Q holds_for steps0 (1, tp) A n)\n\ngoal (1 subgoal):\n 1. (\\<And>n1 l' r'.\n        \\<lbrakk>is_final (steps0 (1, l, r) A n1);\n         Q holds_for steps0 (1, l, r) A n1;\n         steps0 (1, l, r) A n1 = (0, l', r')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis is_final_eq surj_pair)"], ["proof (state)\nthis:\n  is_final (steps0 (1, l, r) A n1)\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')\n\ngoal (1 subgoal):\n 1. \\<And>l r n.\n       P (l, r) \\<Longrightarrow>\n       \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  is_final (steps0 (1, l, r) A n1)\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')", "obtain n2 where eq: \"steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\""], ["proof (prove)\nusing this:\n  is_final (steps0 (1, l, r) A n1)\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')\n\ngoal (1 subgoal):\n 1. (\\<And>n2.\n        steps0 (1, l, r) (A |+| B) n2 =\n        (Suc (length A div 2), l', r') \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using A_wf"], ["proof (prove)\nusing this:\n  is_final (steps0 (1, l, r) A n1)\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')\n  tm_wf0 A\n\ngoal (1 subgoal):\n 1. (\\<And>n2.\n        steps0 (1, l, r) (A |+| B) n2 =\n        (Suc (length A div 2), l', r') \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (rule_tac tm_comp_next)"], ["proof (state)\nthis:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n\ngoal (1 subgoal):\n 1. \\<And>l r n.\n       P (l, r) \\<Longrightarrow>\n       \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')", "show \"\\<not> is_final (steps0 (1, l, r) (A |+| B) n)\""], ["proof (prove)\nusing this:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n\ngoal (1 subgoal):\n 1. \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "proof(cases \"n2 \\<le> n\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n 2. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "case True"], ["proof (state)\nthis:\n  n2 \\<le> n\n\ngoal (2 subgoals):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n 2. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "from b c"], ["proof (chain)\npicking this:\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')", "have \"Q (l', r')\""], ["proof (prove)\nusing this:\n  Q holds_for steps0 (1, l, r) A n1\n  steps0 (1, l, r) A n1 = (0, l', r')\n\ngoal (1 subgoal):\n 1. Q (l', r')", "by simp"], ["proof (state)\nthis:\n  Q (l', r')\n\ngoal (2 subgoals):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n 2. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  Q (l', r')", "have \"\\<forall> n. \\<not> is_final (steps0 (1, l', r') B n)  \""], ["proof (prove)\nusing this:\n  Q (l', r')\n\ngoal (1 subgoal):\n 1. \\<forall>n. \\<not> is_final (steps0 (1, l', r') B n)", "using B_uhalt"], ["proof (prove)\nusing this:\n  Q (l', r')\n  {Q} B \\<up>\n\ngoal (1 subgoal):\n 1. \\<forall>n. \\<not> is_final (steps0 (1, l', r') B n)", "unfolding Hoare_unhalt_def"], ["proof (prove)\nusing this:\n  Q (l', r')\n  \\<forall>tp.\n     Q tp \\<longrightarrow>\n     (\\<forall>n. \\<not> is_final (steps0 (1, tp) B n))\n\ngoal (1 subgoal):\n 1. \\<forall>n. \\<not> is_final (steps0 (1, l', r') B n)", "by simp"], ["proof (state)\nthis:\n  \\<forall>n. \\<not> is_final (steps0 (1, l', r') B n)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n 2. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  \\<forall>n. \\<not> is_final (steps0 (1, l', r') B n)", "have \"\\<not> is_final (steps0 (1, l', r') B (n - n2))\""], ["proof (prove)\nusing this:\n  \\<forall>n. \\<not> is_final (steps0 (1, l', r') B n)\n\ngoal (1 subgoal):\n 1. \\<not> is_final (steps0 (1, l', r') B (n - n2))", "by auto"], ["proof (state)\nthis:\n  \\<not> is_final (steps0 (1, l', r') B (n - n2))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n 2. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  \\<not> is_final (steps0 (1, l', r') B (n - n2))", "obtain s'' l'' r'' \n      where \"steps0 (1, l', r') B (n - n2) = (s'', l'', r'')\" \n        and \"\\<not> is_final (s'', l'', r'')\""], ["proof (prove)\nusing this:\n  \\<not> is_final (steps0 (1, l', r') B (n - n2))\n\ngoal (1 subgoal):\n 1. (\\<And>s'' l'' r''.\n        \\<lbrakk>steps0 (1, l', r') B (n - n2) = (s'', l'', r'');\n         \\<not> is_final (s'', l'', r'')\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis surj_pair)"], ["proof (state)\nthis:\n  steps0 (1, l', r') B (n - n2) = (s'', l'', r'')\n  \\<not> is_final (s'', l'', r'')\n\ngoal (2 subgoals):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n 2. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  steps0 (1, l', r') B (n - n2) = (s'', l'', r'')\n  \\<not> is_final (s'', l'', r'')", "have \"steps0 (Suc (length A div 2), l', r') (A |+| B) (n - n2) = (s''+ length A div 2, l'', r'')\""], ["proof (prove)\nusing this:\n  steps0 (1, l', r') B (n - n2) = (s'', l'', r'')\n  \\<not> is_final (s'', l'', r'')\n\ngoal (1 subgoal):\n 1. steps0 (Suc (length A div 2), l', r') (A |+| B) (n - n2) =\n    (s'' + length A div 2, l'', r'')", "using A_wf"], ["proof (prove)\nusing this:\n  steps0 (1, l', r') B (n - n2) = (s'', l'', r'')\n  \\<not> is_final (s'', l'', r'')\n  tm_wf0 A\n\ngoal (1 subgoal):\n 1. steps0 (Suc (length A div 2), l', r') (A |+| B) (n - n2) =\n    (s'' + length A div 2, l'', r'')", "by (auto dest: tm_comp_second simp del: tm_wf.simps)"], ["proof (state)\nthis:\n  steps0 (Suc (length A div 2), l', r') (A |+| B) (n - n2) =\n  (s'' + length A div 2, l'', r'')\n\ngoal (2 subgoals):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n 2. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  steps0 (Suc (length A div 2), l', r') (A |+| B) (n - n2) =\n  (s'' + length A div 2, l'', r'')", "have \"\\<not> is_final (steps0 (1, l, r) (A |+| B) (n2 + (n  - n2)))\""], ["proof (prove)\nusing this:\n  steps0 (Suc (length A div 2), l', r') (A |+| B) (n - n2) =\n  (s'' + length A div 2, l'', r'')\n\ngoal (1 subgoal):\n 1. \\<not> is_final (steps0 (1, l, r) (A |+| B) (n2 + (n - n2)))", "using A_wf"], ["proof (prove)\nusing this:\n  steps0 (Suc (length A div 2), l', r') (A |+| B) (n - n2) =\n  (s'' + length A div 2, l'', r'')\n  tm_wf0 A\n\ngoal (1 subgoal):\n 1. \\<not> is_final (steps0 (1, l, r) (A |+| B) (n2 + (n - n2)))", "by (simp only: steps_add eq) simp"], ["proof (state)\nthis:\n  \\<not> is_final (steps0 (1, l, r) (A |+| B) (n2 + (n - n2)))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n 2. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  \\<not> is_final (steps0 (1, l, r) (A |+| B) (n2 + (n - n2)))", "show \"\\<not> is_final (steps0 (1, l, r) (A |+| B) n)\""], ["proof (prove)\nusing this:\n  \\<not> is_final (steps0 (1, l, r) (A |+| B) (n2 + (n - n2)))\n\ngoal (1 subgoal):\n 1. \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "using \\<open>n2 \\<le> n\\<close>"], ["proof (prove)\nusing this:\n  \\<not> is_final (steps0 (1, l, r) (A |+| B) (n2 + (n - n2)))\n  n2 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "by simp"], ["proof (state)\nthis:\n  \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "case False"], ["proof (state)\nthis:\n  \\<not> n2 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "then"], ["proof (chain)\npicking this:\n  \\<not> n2 \\<le> n", "obtain n3 where \"n = n2 - n3\""], ["proof (prove)\nusing this:\n  \\<not> n2 \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<And>n3. n = n2 - n3 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using diff_le_self le_imp_diff_is_add nat_le_linear\n        add.commute"], ["proof (prove)\nusing this:\n  \\<not> n2 \\<le> n\n  ?m - ?n \\<le> ?m\n  ?i \\<le> ?j \\<Longrightarrow> (?j - ?i = ?k) = (?j = ?k + ?i)\n  ?m \\<le> ?n \\<or> ?n \\<le> ?m\n  ?a + ?b = ?b + ?a\n\ngoal (1 subgoal):\n 1. (\\<And>n3. n = n2 - n3 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  n = n2 - n3\n\ngoal (1 subgoal):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "moreover"], ["proof (state)\nthis:\n  n = n2 - n3\n\ngoal (1 subgoal):\n 1. \\<lbrakk>steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r');\n     \\<not> n2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "with eq"], ["proof (chain)\npicking this:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n  n = n2 - n3", "show \"\\<not> is_final (steps0 (1, l, r) (A |+| B) n)\""], ["proof (prove)\nusing this:\n  steps0 (1, l, r) (A |+| B) n2 = (Suc (length A div 2), l', r')\n  n = n2 - n3\n\ngoal (1 subgoal):\n 1. \\<not> is_final (steps0 (1, l, r) (A |+| B) n)", "by (simp add: not_is_final[where ?n1.0=\"n2\"])"], ["proof (state)\nthis:\n  \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<not> is_final (steps0 (1, l, r) (A |+| B) n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Hoare_consequence:\n  assumes \"P' \\<mapsto> P\" \"{P} p {Q}\" \"Q \\<mapsto> Q'\"\n  shows \"{P'} p {Q'}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {P'} p {Q'}", "using assms"], ["proof (prove)\nusing this:\n  P' \\<mapsto> P\n  {P} p {Q}\n  Q \\<mapsto> Q'\n\ngoal (1 subgoal):\n 1. {P'} p {Q'}", "unfolding Hoare_halt_def assert_imp_def"], ["proof (prove)\nusing this:\n  \\<forall>l r. P' (l, r) \\<longrightarrow> P (l, r)\n  \\<forall>tp.\n     P tp \\<longrightarrow>\n     (\\<exists>n.\n         is_final (steps0 (1, tp) p n) \\<and>\n         Q holds_for steps0 (1, tp) p n)\n  \\<forall>l r. Q (l, r) \\<longrightarrow> Q' (l, r)\n\ngoal (1 subgoal):\n 1. \\<forall>tp.\n       P' tp \\<longrightarrow>\n       (\\<exists>n.\n           is_final (steps0 (1, tp) p n) \\<and>\n           Q' holds_for steps0 (1, tp) p n)", "by (metis holds_for.simps surj_pair)"], ["", "end"]]}