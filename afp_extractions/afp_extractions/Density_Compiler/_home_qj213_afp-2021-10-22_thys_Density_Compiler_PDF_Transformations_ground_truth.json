{"file_name": "/home/qj213/afp-2021-10-22/thys/Density_Compiler/PDF_Transformations.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Density_Compiler", "problem_names": ["lemma not_top_le_1_ennreal[simp]: \"\\<not> top \\<le> (1::ennreal)\"", "lemma range_int: \"range int = {n. n \\<ge> 0}\"", "lemma range_exp: \"range (exp :: real \\<Rightarrow> real) = {x. x > 0}\"", "lemma Int_stable_Icc: \"Int_stable (range (\\<lambda>(a, b). {a .. b::real}))\"", "lemma distr_mult_real:\n  assumes \"c \\<noteq> 0\" \"has_density M lborel (f :: real \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M borel ((*) c)) lborel (\\<lambda>x. f (x / c) * inverse (abs c))\"\n            (is \"has_density ?M' _ ?f'\")", "lemma distr_uminus_real:\n  assumes \"has_density M lborel (f :: real \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))\"", "lemma distr_plus_real:\n  assumes \"has_density M lborel (f :: real \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M borel ((+) c)) lborel (\\<lambda>x. f (x - c))\"", "lemma count_space_uminus:\n  \"count_space UNIV = distr (count_space UNIV) (count_space UNIV) (uminus :: ('a :: ring \\<Rightarrow> _))\"", "lemma count_space_plus:\n  \"count_space UNIV = distr (count_space UNIV) (count_space UNIV) ((+) (c :: ('a :: ring)))\"", "lemma distr_uminus_ring_count_space:\n  assumes \"has_density M (count_space UNIV) (f :: _ :: ring \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M (count_space UNIV) uminus) (count_space UNIV) (\\<lambda>x. f (- x))\"", "lemma distr_plus_ring_count_space:\n  assumes \"has_density M (count_space UNIV) (f :: _ :: ring \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M (count_space UNIV) ((+) c)) (count_space UNIV) (\\<lambda>x. f (x - c))\"", "lemma subprob_density_distr_real_eq:\n  assumes dens: \"has_subprob_density M lborel f\"\n  assumes Mh: \"h \\<in> borel_measurable borel\"\n  assumes Mg: \"g \\<in> borel_measurable borel\"\n  assumes measure_eq:\n    \"\\<And>a b. a \\<le> b \\<Longrightarrow> emeasure (distr (density lborel f) lborel h) {a..b} =\n                          emeasure (density lborel g) {a..b}\"\n  shows \"has_subprob_density (distr M borel (h :: real \\<Rightarrow> real)) lborel g\"", "lemma subprob_density_distr_real_exp:\n  assumes dens: \"has_subprob_density M lborel f\"\n  shows \"has_subprob_density (distr M borel exp) lborel\n           (\\<lambda>x. if x > 0 then f (ln x) * ennreal (inverse x) else 0)\"\n           (is \"has_subprob_density _ _ ?g\")", "lemma subprob_density_distr_real_inverse_aux:\n  assumes dens: \"has_subprob_density M lborel f\"\n  shows \"has_subprob_density (distr M borel (\\<lambda>x. - inverse x)) lborel\n              (\\<lambda>x. f (-inverse x) * ennreal (inverse (x * x)))\"\n           (is \"has_subprob_density _ _ ?g\")", "lemma subprob_density_distr_real_inverse:\n  assumes dens: \"has_subprob_density M lborel f\"\n  shows \"has_subprob_density (distr M borel inverse) lborel (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\"", "lemma distr_convolution_real:\n  assumes \"has_density M lborel (f :: (real \\<times> real) \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M borel (case_prod (+))) lborel (\\<lambda>z. \\<integral>\\<^sup>+x. f (x, z - x) \\<partial>lborel)\"\n            (is \"has_density ?M' _ ?f'\")", "lemma distr_convolution_ring_count_space:\n  assumes C: \"countable (UNIV :: 'a set)\"\n  assumes \"has_density M (count_space UNIV) (f :: (('a :: ring) \\<times> 'a) \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M (count_space UNIV) (case_prod (+))) (count_space UNIV)\n             (\\<lambda>z. \\<integral>\\<^sup>+x. f (x, z - x) \\<partial>count_space UNIV)\"\n            (is \"has_density ?M' _ ?f'\")"], "translations": [["", "lemma not_top_le_1_ennreal[simp]: \"\\<not> top \\<le> (1::ennreal)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> \\<top> \\<le> 1", "by (simp add: top_unique)"], ["", "lemma range_int: \"range int = {n. n \\<ge> 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range int = {n. 0 \\<le> n}", "proof (intro equalityI subsetI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> range int \\<Longrightarrow> x \\<in> {n. 0 \\<le> n}\n 2. \\<And>x. x \\<in> {n. 0 \\<le> n} \\<Longrightarrow> x \\<in> range int", "fix n :: int"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> range int \\<Longrightarrow> x \\<in> {n. 0 \\<le> n}\n 2. \\<And>x. x \\<in> {n. 0 \\<le> n} \\<Longrightarrow> x \\<in> range int", "assume \"n \\<in> {n. n \\<ge> 0}\""], ["proof (state)\nthis:\n  n \\<in> {n. 0 \\<le> n}\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> range int \\<Longrightarrow> x \\<in> {n. 0 \\<le> n}\n 2. \\<And>x. x \\<in> {n. 0 \\<le> n} \\<Longrightarrow> x \\<in> range int", "hence \"n = int (nat n)\""], ["proof (prove)\nusing this:\n  n \\<in> {n. 0 \\<le> n}\n\ngoal (1 subgoal):\n 1. n = int (nat n)", "by simp"], ["proof (state)\nthis:\n  n = int (nat n)\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> range int \\<Longrightarrow> x \\<in> {n. 0 \\<le> n}\n 2. \\<And>x. x \\<in> {n. 0 \\<le> n} \\<Longrightarrow> x \\<in> range int", "thus \"n \\<in> range int\""], ["proof (prove)\nusing this:\n  n = int (nat n)\n\ngoal (1 subgoal):\n 1. n \\<in> range int", "by blast"], ["proof (state)\nthis:\n  n \\<in> range int\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> range int \\<Longrightarrow> x \\<in> {n. 0 \\<le> n}", "qed auto"], ["", "lemma range_exp: \"range (exp :: real \\<Rightarrow> real) = {x. x > 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range exp = {x. 0 < x}", "proof (intro equalityI subsetI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> range exp \\<Longrightarrow> x \\<in> {x. 0 < x}\n 2. \\<And>x. x \\<in> {x. 0 < x} \\<Longrightarrow> x \\<in> range exp", "fix x :: real"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> range exp \\<Longrightarrow> x \\<in> {x. 0 < x}\n 2. \\<And>x. x \\<in> {x. 0 < x} \\<Longrightarrow> x \\<in> range exp", "assume \"x \\<in> {x. x > 0}\""], ["proof (state)\nthis:\n  x \\<in> {x. 0 < x}\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> range exp \\<Longrightarrow> x \\<in> {x. 0 < x}\n 2. \\<And>x. x \\<in> {x. 0 < x} \\<Longrightarrow> x \\<in> range exp", "hence \"x = exp (ln x)\""], ["proof (prove)\nusing this:\n  x \\<in> {x. 0 < x}\n\ngoal (1 subgoal):\n 1. x = exp (ln x)", "by simp"], ["proof (state)\nthis:\n  x = exp (ln x)\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> range exp \\<Longrightarrow> x \\<in> {x. 0 < x}\n 2. \\<And>x. x \\<in> {x. 0 < x} \\<Longrightarrow> x \\<in> range exp", "thus \"x \\<in> range exp\""], ["proof (prove)\nusing this:\n  x = exp (ln x)\n\ngoal (1 subgoal):\n 1. x \\<in> range exp", "by blast"], ["proof (state)\nthis:\n  x \\<in> range exp\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> range exp \\<Longrightarrow> x \\<in> {x. 0 < x}", "qed auto"], ["", "lemma Int_stable_Icc: \"Int_stable (range (\\<lambda>(a, b). {a .. b::real}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Int_stable (range (\\<lambda>(a, b). {a..b}))", "by (auto simp: Int_stable_def)"], ["", "lemma distr_mult_real:\n  assumes \"c \\<noteq> 0\" \"has_density M lborel (f :: real \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M borel ((*) c)) lborel (\\<lambda>x. f (x / c) * inverse (abs c))\"\n            (is \"has_density ?M' _ ?f'\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. has_density (distr M borel ((*) c)) lborel\n     (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n    \\<in> borel_measurable lborel\n 2. distr M borel ((*) c) =\n    density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n 3. space lborel \\<noteq> {}", "from assms(2)"], ["proof (chain)\npicking this:\n  has_density M lborel f", "have \"M = density lborel f\""], ["proof (prove)\nusing this:\n  has_density M lborel f\n\ngoal (1 subgoal):\n 1. M = density lborel f", "by (rule has_densityD)"], ["proof (state)\nthis:\n  M = density lborel f\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n    \\<in> borel_measurable lborel\n 2. distr M borel ((*) c) =\n    density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n 3. space lborel \\<noteq> {}", "also"], ["proof (state)\nthis:\n  M = density lborel f\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n    \\<in> borel_measurable lborel\n 2. distr M borel ((*) c) =\n    density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n 3. space lborel \\<noteq> {}", "from assms"], ["proof (chain)\npicking this:\n  c \\<noteq> 0\n  has_density M lborel f", "have Mf[measurable]: \"f \\<in> borel_measurable borel\""], ["proof (prove)\nusing this:\n  c \\<noteq> 0\n  has_density M lborel f\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable borel", "by (auto dest: has_densityD)"], ["proof (state)\nthis:\n  f \\<in> borel_measurable borel\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n    \\<in> borel_measurable lborel\n 2. distr M borel ((*) c) =\n    density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n 3. space lborel \\<noteq> {}", "hence \"distr (density lborel f) borel ((*) c) = density lborel ?f'\" (is \"?M1 = ?M2\")"], ["proof (prove)\nusing this:\n  f \\<in> borel_measurable borel\n\ngoal (1 subgoal):\n 1. distr (density lborel f) borel ((*) c) =\n    density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))", "proof (intro measure_eqI)"], ["proof (state)\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((*) c))\n                          A =\n                         emeasure\n                          (density lborel\n                            (\\<lambda>x.\n                                f (x / c) *\n                                ennreal (inverse \\<bar>c\\<bar>)))\n                          A", "fix X"], ["proof (state)\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((*) c))\n                          A =\n                         emeasure\n                          (density lborel\n                            (\\<lambda>x.\n                                f (x / c) *\n                                ennreal (inverse \\<bar>c\\<bar>)))\n                          A", "assume X[measurable]: \"X \\<in> sets (distr (density lborel f) borel ((*) c))\""], ["proof (state)\nthis:\n  X \\<in> sets (distr (density lborel f) borel ((*) c))\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((*) c))\n                          A =\n                         emeasure\n                          (density lborel\n                            (\\<lambda>x.\n                                f (x / c) *\n                                ennreal (inverse \\<bar>c\\<bar>)))\n                          A", "with assms"], ["proof (chain)\npicking this:\n  c \\<noteq> 0\n  has_density M lborel f\n  X \\<in> sets (distr (density lborel f) borel ((*) c))", "have \"emeasure ?M1 X = \\<integral>\\<^sup>+x. f x * indicator X (c * x) \\<partial>lborel\""], ["proof (prove)\nusing this:\n  c \\<noteq> 0\n  has_density M lborel f\n  X \\<in> sets (distr (density lborel f) borel ((*) c))\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) borel ((*) c)) X =\n    \\<integral>\\<^sup>+ x. f x * indicator X (c * x) \\<partial>lborel", "by (subst emeasure_distr, simp, simp, subst emeasure_density)\n         (auto dest: has_densityD intro!: measurable_sets_borel nn_integral_cong\n               split: split_indicator)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) borel ((*) c)) X =\n  \\<integral>\\<^sup>+ x. f x * indicator X (c * x) \\<partial>lborel\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((*) c))\n                          A =\n                         emeasure\n                          (density lborel\n                            (\\<lambda>x.\n                                f (x / c) *\n                                ennreal (inverse \\<bar>c\\<bar>)))\n                          A", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) borel ((*) c)) X =\n  \\<integral>\\<^sup>+ x. f x * indicator X (c * x) \\<partial>lborel\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((*) c))\n                          A =\n                         emeasure\n                          (density lborel\n                            (\\<lambda>x.\n                                f (x / c) *\n                                ennreal (inverse \\<bar>c\\<bar>)))\n                          A", "from assms(1) and X"], ["proof (chain)\npicking this:\n  c \\<noteq> 0\n  X \\<in> sets (distr (density lborel f) borel ((*) c))", "have \"... = \\<integral>\\<^sup>+x. ?f' x * indicator X x \\<partial>lborel\""], ["proof (prove)\nusing this:\n  c \\<noteq> 0\n  X \\<in> sets (distr (density lborel f) borel ((*) c))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. f x * indicator X (c * x) \\<partial>lborel =\n    \\<integral>\\<^sup>+x\\<in>X.\n                       (f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n    \\<partial>lborel", "apply (subst lborel_distr_mult'[of \"inverse c\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>c \\<noteq> 0;\n     X \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n    \\<Longrightarrow> inverse c \\<noteq> 0\n 2. \\<lbrakk>c \\<noteq> 0;\n     X \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n    \\<Longrightarrow> \\<integral>\\<^sup>+ x. f x * indicator X (c * x)\n   \\<partial>density (distr lborel borel ((*) (inverse c)))\n              (\\<lambda>x. ennreal \\<bar>inverse c\\<bar>) =\n                      \\<integral>\\<^sup>+x\\<in>X.\n   (f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n                      \\<partial>lborel", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>c \\<noteq> 0;\n     X \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n    \\<Longrightarrow> \\<integral>\\<^sup>+ x. f x * indicator X (c * x)\n   \\<partial>density (distr lborel borel ((*) (inverse c)))\n              (\\<lambda>x. ennreal \\<bar>inverse c\\<bar>) =\n                      \\<integral>\\<^sup>+x\\<in>X.\n   (f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n                      \\<partial>lborel", "apply (subst nn_integral_density)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>c \\<noteq> 0;\n     X \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x. ennreal \\<bar>inverse c\\<bar>)\n                      \\<in> borel_measurable\n                             (distr lborel borel ((*) (inverse c)))\n 2. \\<lbrakk>c \\<noteq> 0;\n     X \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x. f x * indicator X (c * x))\n                      \\<in> borel_measurable\n                             (distr lborel borel ((*) (inverse c)))\n 3. \\<lbrakk>c \\<noteq> 0;\n     X \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n    \\<Longrightarrow> \\<integral>\\<^sup>+ x.\n     ennreal \\<bar>inverse c\\<bar> * (f x * indicator X (c * x))\n   \\<partial>distr lborel borel ((*) (inverse c)) =\n                      \\<integral>\\<^sup>+x\\<in>X.\n   (f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n                      \\<partial>lborel", "apply (simp_all add: nn_integral_distr field_simps)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. f x * indicator X (c * x) \\<partial>lborel =\n  \\<integral>\\<^sup>+x\\<in>X. (f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n  \\<partial>lborel\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((*) c))\n                          A =\n                         emeasure\n                          (density lborel\n                            (\\<lambda>x.\n                                f (x / c) *\n                                ennreal (inverse \\<bar>c\\<bar>)))\n                          A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. f x * indicator X (c * x) \\<partial>lborel =\n  \\<integral>\\<^sup>+x\\<in>X. (f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n  \\<partial>lborel\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((*) c))\n                          A =\n                         emeasure\n                          (density lborel\n                            (\\<lambda>x.\n                                f (x / c) *\n                                ennreal (inverse \\<bar>c\\<bar>)))\n                          A", "from X"], ["proof (chain)\npicking this:\n  X \\<in> sets (distr (density lborel f) borel ((*) c))", "have \"... = emeasure ?M2 X\""], ["proof (prove)\nusing this:\n  X \\<in> sets (distr (density lborel f) borel ((*) c))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>X.\n                       (f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n    \\<partial>lborel =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n     X", "by (subst emeasure_density) auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>X. (f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n  \\<partial>lborel =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n   X\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((*) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((*) c))\n                          A =\n                         emeasure\n                          (density lborel\n                            (\\<lambda>x.\n                                f (x / c) *\n                                ennreal (inverse \\<bar>c\\<bar>)))\n                          A", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density lborel f) borel ((*) c)) X =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n   X", "show \"emeasure ?M1 X = emeasure ?M2 X\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) borel ((*) c)) X =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n   X\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) borel ((*) c)) X =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n     X", "."], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) borel ((*) c)) X =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))\n   X\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((*) c)) =\n    sets\n     (density lborel\n       (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>)))", "qed simp"], ["proof (state)\nthis:\n  distr (density lborel f) borel ((*) c) =\n  density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n    \\<in> borel_measurable lborel\n 2. distr M borel ((*) c) =\n    density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n 3. space lborel \\<noteq> {}", "finally"], ["proof (chain)\npicking this:\n  distr M borel ((*) c) =\n  density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))", "show \"distr M borel ((*) c) = density lborel ?f'\""], ["proof (prove)\nusing this:\n  distr M borel ((*) c) =\n  density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n\ngoal (1 subgoal):\n 1. distr M borel ((*) c) =\n    density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))", "."], ["proof (state)\nthis:\n  distr M borel ((*) c) =\n  density lborel (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. f (x / c) * ennreal (inverse \\<bar>c\\<bar>))\n    \\<in> borel_measurable lborel\n 2. space lborel \\<noteq> {}", "qed (insert assms, auto dest: has_densityD)"], ["", "lemma distr_uminus_real:\n  assumes \"has_density M lborel (f :: real \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "from assms"], ["proof (chain)\npicking this:\n  has_density M lborel f", "have \"has_density (distr M borel ((*) (- 1))) lborel\n                       (\\<lambda>x. f (x / -1) * ennreal (inverse (abs (-1))))\""], ["proof (prove)\nusing this:\n  has_density M lborel f\n\ngoal (1 subgoal):\n 1. has_density (distr M borel ((*) (- 1))) lborel\n     (\\<lambda>x. f (x / - 1) * ennreal (inverse \\<bar>- 1\\<bar>))", "by (intro distr_mult_real) simp_all"], ["proof (state)\nthis:\n  has_density (distr M borel ((*) (- 1))) lborel\n   (\\<lambda>x. f (x / - 1) * ennreal (inverse \\<bar>- 1\\<bar>))\n\ngoal (1 subgoal):\n 1. has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "also"], ["proof (state)\nthis:\n  has_density (distr M borel ((*) (- 1))) lborel\n   (\\<lambda>x. f (x / - 1) * ennreal (inverse \\<bar>- 1\\<bar>))\n\ngoal (1 subgoal):\n 1. has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "have \"(*) (-1) = (uminus :: real \\<Rightarrow> real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (*) (- 1) = uminus", "by (intro ext) simp"], ["proof (state)\nthis:\n  (*) (- 1) = uminus\n\ngoal (1 subgoal):\n 1. has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "also"], ["proof (state)\nthis:\n  (*) (- 1) = uminus\n\ngoal (1 subgoal):\n 1. has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "have \"(\\<lambda>x. f (x / -1) * ennreal (inverse (abs (-1)))) = (\\<lambda>x. f (-x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. f (x / - 1) * ennreal (inverse \\<bar>- 1\\<bar>)) =\n    (\\<lambda>x. f (- x))", "by (intro ext) (simp add: one_ennreal_def[symmetric])"], ["proof (state)\nthis:\n  (\\<lambda>x. f (x / - 1) * ennreal (inverse \\<bar>- 1\\<bar>)) =\n  (\\<lambda>x. f (- x))\n\ngoal (1 subgoal):\n 1. has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "finally"], ["proof (chain)\npicking this:\n  has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "show ?thesis"], ["proof (prove)\nusing this:\n  has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))\n\ngoal (1 subgoal):\n 1. has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))", "."], ["proof (state)\nthis:\n  has_density (distr M borel uminus) lborel (\\<lambda>x. f (- x))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma distr_plus_real:\n  assumes \"has_density M lborel (f :: real \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M borel ((+) c)) lborel (\\<lambda>x. f (x - c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_density (distr M borel ((+) c)) lborel (\\<lambda>x. f (x - c))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable lborel\n 2. distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\n 3. space lborel \\<noteq> {}", "from assms"], ["proof (chain)\npicking this:\n  has_density M lborel f", "have \"M = density lborel f\""], ["proof (prove)\nusing this:\n  has_density M lborel f\n\ngoal (1 subgoal):\n 1. M = density lborel f", "by (rule has_densityD)"], ["proof (state)\nthis:\n  M = density lborel f\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable lborel\n 2. distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\n 3. space lborel \\<noteq> {}", "also"], ["proof (state)\nthis:\n  M = density lborel f\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable lborel\n 2. distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\n 3. space lborel \\<noteq> {}", "from assms"], ["proof (chain)\npicking this:\n  has_density M lborel f", "have Mf[measurable]: \"f \\<in> borel_measurable borel\""], ["proof (prove)\nusing this:\n  has_density M lborel f\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable borel", "by (auto dest: has_densityD)"], ["proof (state)\nthis:\n  f \\<in> borel_measurable borel\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable lborel\n 2. distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\n 3. space lborel \\<noteq> {}", "hence \"distr (density lborel f) borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\" (is \"?M1 = ?M2\")"], ["proof (prove)\nusing this:\n  f \\<in> borel_measurable borel\n\ngoal (1 subgoal):\n 1. distr (density lborel f) borel ((+) c) =\n    density lborel (\\<lambda>x. f (x - c))", "proof (intro measure_eqI)"], ["proof (state)\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((+) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((+) c))\n                          A =\n                         emeasure (density lborel (\\<lambda>x. f (x - c))) A", "fix X"], ["proof (state)\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((+) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((+) c))\n                          A =\n                         emeasure (density lborel (\\<lambda>x. f (x - c))) A", "assume X: \"X \\<in> sets (distr (density lborel f) borel ((+) c))\""], ["proof (state)\nthis:\n  X \\<in> sets (distr (density lborel f) borel ((+) c))\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((+) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((+) c))\n                          A =\n                         emeasure (density lborel (\\<lambda>x. f (x - c))) A", "with assms"], ["proof (chain)\npicking this:\n  has_density M lborel f\n  X \\<in> sets (distr (density lborel f) borel ((+) c))", "have \"emeasure ?M1 X = \\<integral>\\<^sup>+x. f x * indicator X (c + x) \\<partial>lborel\""], ["proof (prove)\nusing this:\n  has_density M lborel f\n  X \\<in> sets (distr (density lborel f) borel ((+) c))\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) borel ((+) c)) X =\n    \\<integral>\\<^sup>+ x. f x * indicator X (c + x) \\<partial>lborel", "by (subst emeasure_distr, simp, simp, subst emeasure_density)\n         (auto dest: has_densityD intro!: measurable_sets_borel nn_integral_cong\n               split: split_indicator)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) borel ((+) c)) X =\n  \\<integral>\\<^sup>+ x. f x * indicator X (c + x) \\<partial>lborel\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((+) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((+) c))\n                          A =\n                         emeasure (density lborel (\\<lambda>x. f (x - c))) A", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) borel ((+) c)) X =\n  \\<integral>\\<^sup>+ x. f x * indicator X (c + x) \\<partial>lborel\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((+) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((+) c))\n                          A =\n                         emeasure (density lborel (\\<lambda>x. f (x - c))) A", "from X"], ["proof (chain)\npicking this:\n  X \\<in> sets (distr (density lborel f) borel ((+) c))", "have \"... = \\<integral>\\<^sup>+x. f (x - c) * indicator X x \\<partial>lborel\""], ["proof (prove)\nusing this:\n  X \\<in> sets (distr (density lborel f) borel ((+) c))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. f x * indicator X (c + x) \\<partial>lborel =\n    \\<integral>\\<^sup>+x\\<in>X. f (x - c)\\<partial>lborel", "by (subst lborel_distr_plus[where c = \"-c\", symmetric], subst nn_integral_distr) auto"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. f x * indicator X (c + x) \\<partial>lborel =\n  \\<integral>\\<^sup>+x\\<in>X. f (x - c)\\<partial>lborel\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((+) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((+) c))\n                          A =\n                         emeasure (density lborel (\\<lambda>x. f (x - c))) A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. f x * indicator X (c + x) \\<partial>lborel =\n  \\<integral>\\<^sup>+x\\<in>X. f (x - c)\\<partial>lborel\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((+) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((+) c))\n                          A =\n                         emeasure (density lborel (\\<lambda>x. f (x - c))) A", "from X"], ["proof (chain)\npicking this:\n  X \\<in> sets (distr (density lborel f) borel ((+) c))", "have \"... = emeasure ?M2 X\""], ["proof (prove)\nusing this:\n  X \\<in> sets (distr (density lborel f) borel ((+) c))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+x\\<in>X. f (x - c)\\<partial>lborel =\n    emeasure (density lborel (\\<lambda>x. f (x - c))) X", "by (subst emeasure_density)\n         (auto simp: emeasure_density intro!: measurable_compose[OF borel_measurable_diff Mf])"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+x\\<in>X. f (x - c)\\<partial>lborel =\n  emeasure (density lborel (\\<lambda>x. f (x - c))) X\n\ngoal (2 subgoals):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       \\<lbrakk>f \\<in> borel_measurable borel;\n        A \\<in> sets (distr (density lborel f) borel ((+) c))\\<rbrakk>\n       \\<Longrightarrow> emeasure (distr (density lborel f) borel ((+) c))\n                          A =\n                         emeasure (density lborel (\\<lambda>x. f (x - c))) A", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density lborel f) borel ((+) c)) X =\n  emeasure (density lborel (\\<lambda>x. f (x - c))) X", "show \"emeasure ?M1 X = emeasure ?M2 X\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) borel ((+) c)) X =\n  emeasure (density lborel (\\<lambda>x. f (x - c))) X\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) borel ((+) c)) X =\n    emeasure (density lborel (\\<lambda>x. f (x - c))) X", "."], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) borel ((+) c)) X =\n  emeasure (density lborel (\\<lambda>x. f (x - c))) X\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable borel \\<Longrightarrow>\n    sets (distr (density lborel f) borel ((+) c)) =\n    sets (density lborel (\\<lambda>x. f (x - c)))", "qed simp"], ["proof (state)\nthis:\n  distr (density lborel f) borel ((+) c) =\n  density lborel (\\<lambda>x. f (x - c))\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable lborel\n 2. distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\n 3. space lborel \\<noteq> {}", "finally"], ["proof (chain)\npicking this:\n  distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))", "show \"distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\""], ["proof (prove)\nusing this:\n  distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\n\ngoal (1 subgoal):\n 1. distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))", "."], ["proof (state)\nthis:\n  distr M borel ((+) c) = density lborel (\\<lambda>x. f (x - c))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable lborel\n 2. space lborel \\<noteq> {}", "qed (insert assms, auto dest: has_densityD)"], ["", "lemma count_space_uminus:\n  \"count_space UNIV = distr (count_space UNIV) (count_space UNIV) (uminus :: ('a :: ring \\<Rightarrow> _))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. count_space UNIV = distr (count_space UNIV) (count_space UNIV) uminus", "proof (rule distr_bij_count_space[symmetric])"], ["proof (state)\ngoal (1 subgoal):\n 1. bij uminus", "show \"bij (uminus :: 'a \\<Rightarrow> 'a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij uminus", "by (auto intro!: o_bij[where g=uminus])"], ["proof (state)\nthis:\n  bij uminus\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma count_space_plus:\n  \"count_space UNIV = distr (count_space UNIV) (count_space UNIV) ((+) (c :: ('a :: ring)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. count_space UNIV = distr (count_space UNIV) (count_space UNIV) ((+) c)", "by (rule distr_bij_count_space [symmetric]) simp"], ["", "lemma distr_uminus_ring_count_space:\n  assumes \"has_density M (count_space UNIV) (f :: _ :: ring \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M (count_space UNIV) uminus) (count_space UNIV) (\\<lambda>x. f (- x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_density (distr M (count_space UNIV) uminus) (count_space UNIV)\n     (\\<lambda>x. f (- x))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (- x)) \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) uminus =\n    density (count_space UNIV) (\\<lambda>x. f (- x))\n 3. space (count_space UNIV) \\<noteq> {}", "from assms"], ["proof (chain)\npicking this:\n  has_density M (count_space UNIV) f", "have \"M = density (count_space UNIV) f\""], ["proof (prove)\nusing this:\n  has_density M (count_space UNIV) f\n\ngoal (1 subgoal):\n 1. M = density (count_space UNIV) f", "by (rule has_densityD)"], ["proof (state)\nthis:\n  M = density (count_space UNIV) f\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (- x)) \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) uminus =\n    density (count_space UNIV) (\\<lambda>x. f (- x))\n 3. space (count_space UNIV) \\<noteq> {}", "also"], ["proof (state)\nthis:\n  M = density (count_space UNIV) f\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (- x)) \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) uminus =\n    density (count_space UNIV) (\\<lambda>x. f (- x))\n 3. space (count_space UNIV) \\<noteq> {}", "have \"distr (density (count_space UNIV) f) (count_space UNIV) uminus =\n               density (count_space UNIV)(\\<lambda>x. f (- x))\" (is \"?M1 = ?M2\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. distr (density (count_space UNIV) f) (count_space UNIV) uminus =\n    density (count_space UNIV) (\\<lambda>x. f (- x))", "proof (intro measure_eqI)"], ["proof (state)\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) uminus) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (- x)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  uminus) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) uminus) A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) A", "fix X"], ["proof (state)\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) uminus) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (- x)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  uminus) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) uminus) A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) A", "assume X: \"X \\<in> sets (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\""], ["proof (state)\nthis:\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\n\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) uminus) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (- x)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  uminus) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) uminus) A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) A", "with assms"], ["proof (chain)\npicking this:\n  has_density M (count_space UNIV) f\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) uminus)", "have \"emeasure ?M1 X = \\<integral>\\<^sup>+x. f x * indicator X (-x) \\<partial>count_space UNIV\""], ["proof (prove)\nusing this:\n  has_density M (count_space UNIV) f\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\n\ngoal (1 subgoal):\n 1. emeasure\n     (distr (density (count_space UNIV) f) (count_space UNIV) uminus) X =\n    \\<integral>\\<^sup>+ x. f x * indicator X (- x)\n                       \\<partial>count_space UNIV", "by (subst emeasure_distr, simp, simp, subst emeasure_density)\n         (auto dest: has_densityD intro!: measurable_sets_borel nn_integral_cong\n               split: split_indicator)"], ["proof (state)\nthis:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\n   X =\n  \\<integral>\\<^sup>+ x. f x * indicator X (- x) \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) uminus) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (- x)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  uminus) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) uminus) A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) A", "also"], ["proof (state)\nthis:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\n   X =\n  \\<integral>\\<^sup>+ x. f x * indicator X (- x) \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) uminus) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (- x)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  uminus) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) uminus) A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) A", "from X"], ["proof (chain)\npicking this:\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) uminus)", "have \"... = emeasure ?M2 X\""], ["proof (prove)\nusing this:\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. f x * indicator X (- x)\n                       \\<partial>count_space UNIV =\n    emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) X", "by (subst count_space_uminus) (simp_all add: nn_integral_distr emeasure_density)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. f x * indicator X (- x)\n                     \\<partial>count_space UNIV =\n  emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) X\n\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) uminus) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (- x)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  uminus) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) uminus) A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) A", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\n   X =\n  emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) X", "show \"emeasure ?M1 X = emeasure ?M2 X\""], ["proof (prove)\nusing this:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\n   X =\n  emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) X\n\ngoal (1 subgoal):\n 1. emeasure\n     (distr (density (count_space UNIV) f) (count_space UNIV) uminus) X =\n    emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) X", "."], ["proof (state)\nthis:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) uminus)\n   X =\n  emeasure (density (count_space UNIV) (\\<lambda>x. f (- x))) X\n\ngoal (1 subgoal):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) uminus) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (- x)))", "qed simp"], ["proof (state)\nthis:\n  distr (density (count_space UNIV) f) (count_space UNIV) uminus =\n  density (count_space UNIV) (\\<lambda>x. f (- x))\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (- x)) \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) uminus =\n    density (count_space UNIV) (\\<lambda>x. f (- x))\n 3. space (count_space UNIV) \\<noteq> {}", "finally"], ["proof (chain)\npicking this:\n  distr M (count_space UNIV) uminus =\n  density (count_space UNIV) (\\<lambda>x. f (- x))", "show \"distr M (count_space UNIV) uminus = density (count_space UNIV) (\\<lambda>x. f (- x))\""], ["proof (prove)\nusing this:\n  distr M (count_space UNIV) uminus =\n  density (count_space UNIV) (\\<lambda>x. f (- x))\n\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) uminus =\n    density (count_space UNIV) (\\<lambda>x. f (- x))", "."], ["proof (state)\nthis:\n  distr M (count_space UNIV) uminus =\n  density (count_space UNIV) (\\<lambda>x. f (- x))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. f (- x)) \\<in> borel_measurable (count_space UNIV)\n 2. space (count_space UNIV) \\<noteq> {}", "qed (insert assms, auto dest: has_densityD)"], ["", "lemma distr_plus_ring_count_space:\n  assumes \"has_density M (count_space UNIV) (f :: _ :: ring \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M (count_space UNIV) ((+) c)) (count_space UNIV) (\\<lambda>x. f (x - c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_density (distr M (count_space UNIV) ((+) c)) (count_space UNIV)\n     (\\<lambda>x. f (x - c))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) ((+) c) =\n    density (count_space UNIV) (\\<lambda>x. f (x - c))\n 3. space (count_space UNIV) \\<noteq> {}", "from assms"], ["proof (chain)\npicking this:\n  has_density M (count_space UNIV) f", "have \"M = density (count_space UNIV) f\""], ["proof (prove)\nusing this:\n  has_density M (count_space UNIV) f\n\ngoal (1 subgoal):\n 1. M = density (count_space UNIV) f", "by (rule has_densityD)"], ["proof (state)\nthis:\n  M = density (count_space UNIV) f\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) ((+) c) =\n    density (count_space UNIV) (\\<lambda>x. f (x - c))\n 3. space (count_space UNIV) \\<noteq> {}", "also"], ["proof (state)\nthis:\n  M = density (count_space UNIV) f\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) ((+) c) =\n    density (count_space UNIV) (\\<lambda>x. f (x - c))\n 3. space (count_space UNIV) \\<noteq> {}", "have \"distr (density (count_space UNIV) f) (count_space UNIV) ((+) c) =\n               density (count_space UNIV)(\\<lambda>x. f (x - c))\" (is \"?M1 = ?M2\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. distr (density (count_space UNIV) f) (count_space UNIV) ((+) c) =\n    density (count_space UNIV) (\\<lambda>x. f (x - c))", "proof (intro measure_eqI)"], ["proof (state)\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  ((+) c)) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n        A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) A", "fix X"], ["proof (state)\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  ((+) c)) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n        A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) A", "assume X: \"X \\<in> sets (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\""], ["proof (state)\nthis:\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  ((+) c)) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n        A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) A", "with assms"], ["proof (chain)\npicking this:\n  has_density M (count_space UNIV) f\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))", "have \"emeasure ?M1 X = \\<integral>\\<^sup>+x. f x * indicator X (c + x) \\<partial>count_space UNIV\""], ["proof (prove)\nusing this:\n  has_density M (count_space UNIV) f\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n\ngoal (1 subgoal):\n 1. emeasure\n     (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) X =\n    \\<integral>\\<^sup>+ x. f x * indicator X (c + x)\n                       \\<partial>count_space UNIV", "by (subst emeasure_distr, simp, simp, subst emeasure_density)\n         (auto dest: has_densityD intro!: measurable_sets_borel nn_integral_cong\n               split: split_indicator)"], ["proof (state)\nthis:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n   X =\n  \\<integral>\\<^sup>+ x. f x * indicator X (c + x)\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  ((+) c)) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n        A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) A", "also"], ["proof (state)\nthis:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n   X =\n  \\<integral>\\<^sup>+ x. f x * indicator X (c + x)\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  ((+) c)) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n        A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) A", "from X"], ["proof (chain)\npicking this:\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))", "have \"... = emeasure ?M2 X\""], ["proof (prove)\nusing this:\n  X \\<in> sets\n           (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. f x * indicator X (c + x)\n                       \\<partial>count_space UNIV =\n    emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) X", "by (subst count_space_plus[of \"-c\"]) (simp_all add: nn_integral_distr emeasure_density)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. f x * indicator X (c + x)\n                     \\<partial>count_space UNIV =\n  emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) X\n\ngoal (2 subgoals):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (x - c)))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr (density (count_space UNIV) f) (count_space UNIV)\n                  ((+) c)) \\<Longrightarrow>\n       emeasure\n        (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n        A =\n       emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) A", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n   X =\n  emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) X", "show \"emeasure ?M1 X = emeasure ?M2 X\""], ["proof (prove)\nusing this:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n   X =\n  emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) X\n\ngoal (1 subgoal):\n 1. emeasure\n     (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) X =\n    emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) X", "."], ["proof (state)\nthis:\n  emeasure (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c))\n   X =\n  emeasure (density (count_space UNIV) (\\<lambda>x. f (x - c))) X\n\ngoal (1 subgoal):\n 1. sets (distr (density (count_space UNIV) f) (count_space UNIV) ((+) c)) =\n    sets (density (count_space UNIV) (\\<lambda>x. f (x - c)))", "qed simp"], ["proof (state)\nthis:\n  distr (density (count_space UNIV) f) (count_space UNIV) ((+) c) =\n  density (count_space UNIV) (\\<lambda>x. f (x - c))\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) ((+) c) =\n    density (count_space UNIV) (\\<lambda>x. f (x - c))\n 3. space (count_space UNIV) \\<noteq> {}", "finally"], ["proof (chain)\npicking this:\n  distr M (count_space UNIV) ((+) c) =\n  density (count_space UNIV) (\\<lambda>x. f (x - c))", "show \"distr M (count_space UNIV) ((+) c) = density (count_space UNIV) (\\<lambda>x. f (x - c))\""], ["proof (prove)\nusing this:\n  distr M (count_space UNIV) ((+) c) =\n  density (count_space UNIV) (\\<lambda>x. f (x - c))\n\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) ((+) c) =\n    density (count_space UNIV) (\\<lambda>x. f (x - c))", "."], ["proof (state)\nthis:\n  distr M (count_space UNIV) ((+) c) =\n  density (count_space UNIV) (\\<lambda>x. f (x - c))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. f (x - c)) \\<in> borel_measurable (count_space UNIV)\n 2. space (count_space UNIV) \\<noteq> {}", "qed (insert assms, auto dest: has_densityD)"], ["", "lemma subprob_density_distr_real_eq:\n  assumes dens: \"has_subprob_density M lborel f\"\n  assumes Mh: \"h \\<in> borel_measurable borel\"\n  assumes Mg: \"g \\<in> borel_measurable borel\"\n  assumes measure_eq:\n    \"\\<And>a b. a \\<le> b \\<Longrightarrow> emeasure (distr (density lborel f) lborel h) {a..b} =\n                          emeasure (density lborel g) {a..b}\"\n  shows \"has_subprob_density (distr M borel (h :: real \\<Rightarrow> real)) lborel g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_subprob_density (distr M borel h) lborel g", "proof (rule has_subprob_densityI)"], ["proof (state)\ngoal (3 subgoals):\n 1. g \\<in> borel_measurable lborel\n 2. distr M borel h = density lborel g\n 3. subprob_space (distr M borel h)", "from dens"], ["proof (chain)\npicking this:\n  has_subprob_density M lborel f", "have sets_M: \"sets M = sets borel\""], ["proof (prove)\nusing this:\n  has_subprob_density M lborel f\n\ngoal (1 subgoal):\n 1. sets M = sets borel", "by (auto dest: has_subprob_densityD)"], ["proof (state)\nthis:\n  sets M = sets borel\n\ngoal (3 subgoals):\n 1. g \\<in> borel_measurable lborel\n 2. distr M borel h = density lborel g\n 3. subprob_space (distr M borel h)", "have meas_M[simp]: \"measurable M = measurable borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<rightarrow>\\<^sub>M) M = (\\<rightarrow>\\<^sub>M) borel", "by (intro ext, subst measurable_cong_sets[OF sets_M refl]) auto"], ["proof (state)\nthis:\n  (\\<rightarrow>\\<^sub>M) M = (\\<rightarrow>\\<^sub>M) borel\n\ngoal (3 subgoals):\n 1. g \\<in> borel_measurable lborel\n 2. distr M borel h = density lborel g\n 3. subprob_space (distr M borel h)", "from Mh and dens"], ["proof (chain)\npicking this:\n  h \\<in> borel_measurable borel\n  has_subprob_density M lborel f", "show subprob_space: \"subprob_space (distr M borel h)\""], ["proof (prove)\nusing this:\n  h \\<in> borel_measurable borel\n  has_subprob_density M lborel f\n\ngoal (1 subgoal):\n 1. subprob_space (distr M borel h)", "by (intro subprob_space.subprob_space_distr) (auto dest: has_subprob_densityD)"], ["proof (state)\nthis:\n  subprob_space (distr M borel h)\n\ngoal (2 subgoals):\n 1. g \\<in> borel_measurable lborel\n 2. distr M borel h = density lborel g", "show \"distr M borel h = density lborel g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M borel h = density lborel g", "proof (rule measure_eqI_generator_eq[OF Int_stable_Icc, of UNIV])"], ["proof (state)\ngoal (7 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range ?A \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<Union> (range ?A) = UNIV\n 7. \\<And>i. emeasure (distr M borel h) (?A i) \\<noteq> \\<infinity>", "{"], ["proof (state)\ngoal (7 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range ?A \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<Union> (range ?A) = UNIV\n 7. \\<And>i. emeasure (distr M borel h) (?A i) \\<noteq> \\<infinity>", "fix x :: real"], ["proof (state)\ngoal (7 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range ?A \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<Union> (range ?A) = UNIV\n 7. \\<And>i. emeasure (distr M borel h) (?A i) \\<noteq> \\<infinity>", "obtain n :: nat where \"n > abs x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n.\n        \\<bar>x\\<bar> < real n \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using reals_Archimedean2"], ["proof (prove)\nusing this:\n  \\<exists>n. ?x < of_nat n\n\ngoal (1 subgoal):\n 1. (\\<And>n.\n        \\<bar>x\\<bar> < real n \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  \\<bar>x\\<bar> < real n\n\ngoal (7 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range ?A \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<Union> (range ?A) = UNIV\n 7. \\<And>i. emeasure (distr M borel h) (?A i) \\<noteq> \\<infinity>", "hence \"\\<exists>n::nat. x \\<in> {-real n..real n}\""], ["proof (prove)\nusing this:\n  \\<bar>x\\<bar> < real n\n\ngoal (1 subgoal):\n 1. \\<exists>n. x \\<in> {- real n..real n}", "by (intro exI[of _ n]) auto"], ["proof (state)\nthis:\n  \\<exists>n. x \\<in> {- real n..real n}\n\ngoal (7 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range ?A \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<Union> (range ?A) = UNIV\n 7. \\<And>i. emeasure (distr M borel h) (?A i) \\<noteq> \\<infinity>", "}"], ["proof (state)\nthis:\n  \\<exists>n. ?x3 \\<in> {- real n..real n}\n\ngoal (7 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range ?A \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<Union> (range ?A) = UNIV\n 7. \\<And>i. emeasure (distr M borel h) (?A i) \\<noteq> \\<infinity>", "thus \"(\\<Union>i::nat. {-real i..real i}) = UNIV\""], ["proof (prove)\nusing this:\n  \\<exists>n. ?x3 \\<in> {- real n..real n}\n\ngoal (1 subgoal):\n 1. (\\<Union>i. {- real i..real i}) = UNIV", "by blast"], ["proof (state)\nthis:\n  (\\<Union>i. {- real i..real i}) = UNIV\n\ngoal (6 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<And>i.\n       emeasure (distr M borel h) {- real i..real i} \\<noteq> \\<infinity>", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<And>i.\n       emeasure (distr M borel h) {- real i..real i} \\<noteq> \\<infinity>", "fix i :: nat"], ["proof (state)\ngoal (6 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<And>i.\n       emeasure (distr M borel h) {- real i..real i} \\<noteq> \\<infinity>", "from subprob_space"], ["proof (chain)\npicking this:\n  subprob_space (distr M borel h)", "have \"emeasure (distr M borel h) {-real i..real i} \\<le> 1\""], ["proof (prove)\nusing this:\n  subprob_space (distr M borel h)\n\ngoal (1 subgoal):\n 1. emeasure (distr M borel h) {- real i..real i} \\<le> 1", "by (intro subprob_space.subprob_emeasure_le_1) (auto dest: has_subprob_densityD)"], ["proof (state)\nthis:\n  emeasure (distr M borel h) {- real i..real i} \\<le> 1\n\ngoal (6 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})\n 6. \\<And>i.\n       emeasure (distr M borel h) {- real i..real i} \\<noteq> \\<infinity>", "thus \"emeasure (distr M borel h) {- real i..real i} \\<noteq> \\<infinity>\""], ["proof (prove)\nusing this:\n  emeasure (distr M borel h) {- real i..real i} \\<le> 1\n\ngoal (1 subgoal):\n 1. emeasure (distr M borel h) {- real i..real i} \\<noteq> \\<infinity>", "by auto"], ["proof (state)\nthis:\n  emeasure (distr M borel h) {- real i..real i} \\<noteq> \\<infinity>\n\ngoal (5 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "next"], ["proof (state)\ngoal (5 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "fix X :: \"real set\""], ["proof (state)\ngoal (5 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "assume \"X \\<in> range (\\<lambda>(a,b). {a..b})\""], ["proof (state)\nthis:\n  X \\<in> range (\\<lambda>(a, b). {a..b})\n\ngoal (5 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "then"], ["proof (chain)\npicking this:\n  X \\<in> range (\\<lambda>(a, b). {a..b})", "obtain a b where \"X = {a..b}\""], ["proof (prove)\nusing this:\n  X \\<in> range (\\<lambda>(a, b). {a..b})\n\ngoal (1 subgoal):\n 1. (\\<And>a b. X = {a..b} \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  X = {a..b}\n\ngoal (5 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "with dens"], ["proof (chain)\npicking this:\n  has_subprob_density M lborel f\n  X = {a..b}", "have \"emeasure (distr M lborel h) X = emeasure (density lborel g) X\""], ["proof (prove)\nusing this:\n  has_subprob_density M lborel f\n  X = {a..b}\n\ngoal (1 subgoal):\n 1. emeasure (distr M lborel h) X = emeasure (density lborel g) X", "by (cases \"a \\<le> b\") (auto simp: measure_eq dest: has_subprob_densityD)"], ["proof (state)\nthis:\n  emeasure (distr M lborel h) X = emeasure (density lborel g) X\n\ngoal (5 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "also"], ["proof (state)\nthis:\n  emeasure (distr M lborel h) X = emeasure (density lborel g) X\n\ngoal (5 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "have \"distr M lborel h = distr M borel h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M lborel h = distr M borel h", "by (rule distr_cong) auto"], ["proof (state)\nthis:\n  distr M lborel h = distr M borel h\n\ngoal (5 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. \\<And>X.\n       X \\<in> range (\\<lambda>(a, b). {a..b}) \\<Longrightarrow>\n       emeasure (distr M borel h) X = emeasure (density lborel g) X\n 3. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 5. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr M borel h) X = emeasure (density lborel g) X", "show \"emeasure (distr M borel h) X = emeasure (density lborel g) X\""], ["proof (prove)\nusing this:\n  emeasure (distr M borel h) X = emeasure (density lborel g) X\n\ngoal (1 subgoal):\n 1. emeasure (distr M borel h) X = emeasure (density lborel g) X", "."], ["proof (state)\nthis:\n  emeasure (distr M borel h) X = emeasure (density lborel g) X\n\ngoal (4 subgoals):\n 1. range (\\<lambda>(a, b). {a..b}) \\<subseteq> Pow UNIV\n 2. sets (distr M borel h) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 3. sets (density lborel g) =\n    sigma_sets UNIV (range (\\<lambda>(a, b). {a..b}))\n 4. range (\\<lambda>i. {- real i..real i})\n    \\<subseteq> range (\\<lambda>(a, b). {a..b})", "qed (auto simp: borel_eq_atLeastAtMost)"], ["proof (state)\nthis:\n  distr M borel h = density lborel g\n\ngoal (1 subgoal):\n 1. g \\<in> borel_measurable lborel", "qed (insert assms, auto)"], ["", "lemma subprob_density_distr_real_exp:\n  assumes dens: \"has_subprob_density M lborel f\"\n  shows \"has_subprob_density (distr M borel exp) lborel\n           (\\<lambda>x. if x > 0 then f (ln x) * ennreal (inverse x) else 0)\"\n           (is \"has_subprob_density _ _ ?g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. has_subprob_density (distr M borel exp) lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)", "proof (rule subprob_density_distr_real_eq[OF dens])"], ["proof (state)\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "from dens"], ["proof (chain)\npicking this:\n  has_subprob_density M lborel f", "have [measurable]: \"f \\<in> borel_measurable borel\""], ["proof (prove)\nusing this:\n  has_subprob_density M lborel f\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable borel", "by (auto dest: has_subprob_densityD)"], ["proof (state)\nthis:\n  f \\<in> borel_measurable borel\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "have Mf: \"(\\<lambda>x. f (ln x) * ennreal (inverse x)) \\<in> borel_measurable borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. f (ln x) * ennreal (inverse x))\n    \\<in> borel_measurable borel", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>x. f (ln x) * ennreal (inverse x)) \\<in> borel_measurable borel\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "fix a b :: real"], ["proof (state)\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "assume \"a \\<le> b\""], ["proof (state)\nthis:\n  a \\<le> b\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "let ?A = \"\\<lambda>i. {inverse (Suc i) :: real ..}\""], ["proof (state)\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "let ?M1 = \"distr (density lborel f) lborel exp\" and ?M2 = \"density lborel ?g\""], ["proof (state)\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "{"], ["proof (state)\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "fix x :: real"], ["proof (state)\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "assume \"\\<forall>i. x < inverse (Suc i)\""], ["proof (state)\nthis:\n  \\<forall>i. x < inverse (real (Suc i))\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "hence \"x \\<le> 0\""], ["proof (prove)\nusing this:\n  \\<forall>i. x < inverse (real (Suc i))\n\ngoal (1 subgoal):\n 1. x \\<le> 0", "by (intro tendsto_lowerbound[OF LIMSEQ_inverse_real_of_nat])\n                     (auto intro!: always_eventually less_imp_le)"], ["proof (state)\nthis:\n  x \\<le> 0\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "}"], ["proof (state)\nthis:\n  \\<forall>i. ?x2 < inverse (real (Suc i)) \\<Longrightarrow> ?x2 \\<le> 0\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "hence decomp: \"{a..b} = {x\\<in>{a..b}. x \\<le> 0} \\<union> (\\<Union>i. ?A i \\<inter> {a..b})\" (is \"_ = ?C \\<union> ?D\")"], ["proof (prove)\nusing this:\n  \\<forall>i. ?x2 < inverse (real (Suc i)) \\<Longrightarrow> ?x2 \\<le> 0\n\ngoal (1 subgoal):\n 1. {a..b} =\n    {x \\<in> {a..b}. x \\<le> 0} \\<union>\n    (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})", "by (auto simp: not_le)"], ["proof (state)\nthis:\n  {a..b} =\n  {x \\<in> {a..b}. x \\<le> 0} \\<union>\n  (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "have inv_le: \"\\<And>x i. x \\<ge> inverse (real (Suc i)) \\<Longrightarrow> \\<not>(x \\<le> 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x i.\n       inverse (real (Suc i)) \\<le> x \\<Longrightarrow> \\<not> x \\<le> 0", "by (subst not_le, erule dual_order.strict_trans1, simp)"], ["proof (state)\nthis:\n  inverse (real (Suc ?i)) \\<le> ?x \\<Longrightarrow> \\<not> ?x \\<le> 0\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "hence \"emeasure ?M1 {a..b} = emeasure ?M1 ?C + emeasure ?M1 ?D\""], ["proof (prove)\nusing this:\n  inverse (real (Suc ?i)) \\<le> ?x \\<Longrightarrow> \\<not> ?x \\<le> 0\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel exp) {a..b} =\n    emeasure (distr (density lborel f) lborel exp)\n     {x \\<in> {a..b}. x \\<le> 0} +\n    emeasure (distr (density lborel f) lborel exp)\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})", "by (subst decomp, intro plus_emeasure[symmetric]) auto"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp) {a..b} =\n  emeasure (distr (density lborel f) lborel exp)\n   {x \\<in> {a..b}. x \\<le> 0} +\n  emeasure (distr (density lborel f) lborel exp)\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp) {a..b} =\n  emeasure (distr (density lborel f) lborel exp)\n   {x \\<in> {a..b}. x \\<le> 0} +\n  emeasure (distr (density lborel f) lborel exp)\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "have \"emeasure ?M1 ?C = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel exp)\n     {x \\<in> {a..b}. x \\<le> 0} =\n    0", "by (subst emeasure_distr) auto"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   {x \\<in> {a..b}. x \\<le> 0} =\n  0\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   {x \\<in> {a..b}. x \\<le> 0} =\n  0\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "have \"0 = emeasure ?M2 ?C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 =\n    emeasure\n     (density lborel\n       (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n     {x \\<in> {a..b}. x \\<le> 0}", "by (subst emeasure_density, simp, simp, rule sym, subst nn_integral_0_iff) auto"], ["proof (state)\nthis:\n  0 =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   {x \\<in> {a..b}. x \\<le> 0}\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "also"], ["proof (state)\nthis:\n  0 =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   {x \\<in> {a..b}. x \\<le> 0}\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "have \"emeasure ?M1 (\\<Union>i. ?A i \\<inter> {a..b}) = (SUP i. emeasure ?M1 (?A i \\<inter> {a..b}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel exp)\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n    (\\<Squnion>i.\n        emeasure (distr (density lborel f) lborel exp)\n         ({inverse (real (Suc i))..} \\<inter> {a..b}))", "by (rule SUP_emeasure_incseq[symmetric])\n       (auto simp: incseq_def max_def not_le dest: order.strict_trans1)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel exp)\n       ({inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel exp)\n       ({inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "have \"\\<And>i. emeasure ?M1 (?A i \\<inter> {a..b}) = emeasure ?M2 (?A i \\<inter> {a..b})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "proof (case_tac \"inverse (Suc i) \\<le> b\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "fix i"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "assume True: \"inverse (Suc i) \\<le> b\""], ["proof (state)\nthis:\n  inverse (real (Suc i)) \\<le> b\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "let ?a = \"inverse (Suc i)\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "from \\<open>a \\<le> b\\<close>"], ["proof (chain)\npicking this:\n  a \\<le> b", "have A: \"?A i \\<inter> {a..b} = {max ?a a..b}\" (is \"?E = ?F\")"], ["proof (prove)\nusing this:\n  a \\<le> b\n\ngoal (1 subgoal):\n 1. {inverse (real (Suc i))..} \\<inter> {a..b} =\n    {max (inverse (real (Suc i))) a..b}", "by auto"], ["proof (state)\nthis:\n  {inverse (real (Suc i))..} \\<inter> {a..b} =\n  {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "hence \"emeasure ?M1 ?E = emeasure ?M1 ?F\""], ["proof (prove)\nusing this:\n  {inverse (real (Suc i))..} \\<inter> {a..b} =\n  {max (inverse (real (Suc i))) a..b}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel exp)\n     ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n    emeasure (distr (density lborel f) lborel exp)\n     {max (inverse (real (Suc i))) a..b}", "by simp"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure (distr (density lborel f) lborel exp)\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure (distr (density lborel f) lborel exp)\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "have \"strict_mono_on ln {max (inverse (real (Suc i))) a..b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. strict_mono_on ln {max (inverse (real (Suc i))) a..b}", "by (rule strict_mono_onI, subst ln_less_cancel_iff)\n         (auto dest: inv_le simp del: of_nat_Suc)"], ["proof (state)\nthis:\n  strict_mono_on ln {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "with \\<open>a \\<le> b\\<close> True dens"], ["proof (chain)\npicking this:\n  a \\<le> b\n  inverse (real (Suc i)) \\<le> b\n  has_subprob_density M lborel f\n  strict_mono_on ln {max (inverse (real (Suc i))) a..b}", "have \"emeasure ?M1 ?F = emeasure (density lborel (\\<lambda>x. f (ln x) * inverse x)) ?F\""], ["proof (prove)\nusing this:\n  a \\<le> b\n  inverse (real (Suc i)) \\<le> b\n  has_subprob_density M lborel f\n  strict_mono_on ln {max (inverse (real (Suc i))) a..b}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel exp)\n     {max (inverse (real (Suc i))) a..b} =\n    emeasure (density lborel (\\<lambda>x. f (ln x) * ennreal (inverse x)))\n     {max (inverse (real (Suc i))) a..b}", "by (intro emeasure_density_distr_interval)\n         (auto simp: Mf not_less not_le range_exp dest: has_subprob_densityD dest!: inv_le\n               intro!: DERIV_ln continuous_on_inverse continuous_on_id simp del: of_nat_Suc)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   {max (inverse (real (Suc i))) a..b} =\n  emeasure (density lborel (\\<lambda>x. f (ln x) * ennreal (inverse x)))\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   {max (inverse (real (Suc i))) a..b} =\n  emeasure (density lborel (\\<lambda>x. f (ln x) * ennreal (inverse x)))\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "note A[symmetric]"], ["proof (state)\nthis:\n  {max (inverse (real (Suc i))) a..b} =\n  {inverse (real (Suc i))..} \\<inter> {a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "also"], ["proof (state)\nthis:\n  {max (inverse (real (Suc i))) a..b} =\n  {inverse (real (Suc i))..} \\<inter> {a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "have \"emeasure (density lborel (\\<lambda>x. f (ln x) * inverse x)) ?E = emeasure ?M2 ?E\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (density lborel (\\<lambda>x. f (ln x) * ennreal (inverse x)))\n     ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n     ({inverse (real (Suc i))..} \\<inter> {a..b})", "by (subst (1 2) emeasure_density)\n         (auto intro!: nn_integral_cong split: split_indicator dest!: inv_le simp del: of_nat_Suc)"], ["proof (state)\nthis:\n  emeasure (density lborel (\\<lambda>x. f (ln x) * ennreal (inverse x)))\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   ({inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density lborel f) lborel exp)\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   ({inverse (real (Suc i))..} \\<inter> {a..b})", "show \"emeasure ?M1 (?A i \\<inter> {a..b}) = emeasure ?M2 (?A i \\<inter> {a..b})\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) lborel exp)\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   ({inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel exp)\n     ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n     ({inverse (real (Suc i))..} \\<inter> {a..b})", "."], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   ({inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp)\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "qed simp"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp)\n   ({inverse (real (Suc ?i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   ({inverse (real (Suc ?i))..} \\<inter> {a..b})\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "hence \"(SUP i. emeasure ?M1 (?A i \\<inter> {a..b})) = (SUP i. emeasure ?M2 (?A i \\<inter> {a..b}))\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) lborel exp)\n   ({inverse (real (Suc ?i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   ({inverse (real (Suc ?i))..} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. (\\<Squnion>i.\n        emeasure (distr (density lborel f) lborel exp)\n         ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n    (\\<Squnion>i.\n        emeasure\n         (density lborel\n           (\\<lambda>x.\n               if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n         ({inverse (real (Suc i))..} \\<inter> {a..b}))", "by simp"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel exp)\n       ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n       ({inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "also"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel exp)\n       ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n       ({inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "have \"... = emeasure ?M2 (\\<Union>i. ?A i \\<inter> {a..b})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Squnion>i.\n        emeasure\n         (density lborel\n           (\\<lambda>x.\n               if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n         ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})", "by (rule SUP_emeasure_incseq)\n       (auto simp: incseq_def max_def not_le dest: order.strict_trans1)"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n       ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "also"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n       ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "have \"emeasure ?M2 ?C + emeasure ?M2 ?D = emeasure ?M2 (?C \\<union> ?D)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure\n     (density lborel\n       (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n     {x \\<in> {a..b}. x \\<le> 0} +\n    emeasure\n     (density lborel\n       (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n     ({x \\<in> {a..b}. x \\<le> 0} \\<union>\n      (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}))", "by (rule plus_emeasure) (auto dest: inv_le simp del: of_nat_Suc)"], ["proof (state)\nthis:\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   {x \\<in> {a..b}. x \\<le> 0} +\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   ({x \\<in> {a..b}. x \\<le> 0} \\<union>\n    (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "also"], ["proof (state)\nthis:\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   {x \\<in> {a..b}. x \\<le> 0} +\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   ({x \\<in> {a..b}. x \\<le> 0} \\<union>\n    (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "note decomp[symmetric]"], ["proof (state)\nthis:\n  {x \\<in> {a..b}. x \\<le> 0} \\<union>\n  (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n  {a..b}\n\ngoal (3 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel exp) {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n        {a..b}", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density lborel f) lborel exp) {a..b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   {a..b}", "show \"emeasure ?M1 {a..b} = emeasure ?M2 {a..b}\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) lborel exp) {a..b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   {a..b}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel exp) {a..b} =\n    emeasure\n     (density lborel\n       (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n     {a..b}", "."], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel exp) {a..b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0))\n   {a..b}\n\ngoal (2 subgoals):\n 1. exp \\<in> borel_measurable borel\n 2. (\\<lambda>x. if 0 < x then f (ln x) * ennreal (inverse x) else 0)\n    \\<in> borel_measurable borel", "qed (insert dens, auto dest!: has_subprob_densityD(1))"], ["", "lemma subprob_density_distr_real_inverse_aux:\n  assumes dens: \"has_subprob_density M lborel f\"\n  shows \"has_subprob_density (distr M borel (\\<lambda>x. - inverse x)) lborel\n              (\\<lambda>x. f (-inverse x) * ennreal (inverse (x * x)))\"\n           (is \"has_subprob_density _ _ ?g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. has_subprob_density (distr M borel (\\<lambda>x. - inverse x)) lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))", "proof (rule subprob_density_distr_real_eq[OF dens])"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "from dens"], ["proof (chain)\npicking this:\n  has_subprob_density M lborel f", "have Mf[measurable]: \"f \\<in> borel_measurable borel\""], ["proof (prove)\nusing this:\n  has_subprob_density M lborel f\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable borel", "by (auto dest: has_subprob_densityD)"], ["proof (state)\nthis:\n  f \\<in> borel_measurable borel\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))\n    \\<in> borel_measurable borel\n 3. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "show Mg: \"?g \\<in> borel_measurable borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))\n    \\<in> borel_measurable borel", "by measurable"], ["proof (state)\nthis:\n  (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))\n  \\<in> borel_measurable borel\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have surj[simp]: \"surj (\\<lambda>x. - inverse x :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. surj (\\<lambda>x. - inverse x)", "by (intro surjI[of _ \"\\<lambda>x. - inverse x\"]) (simp add: field_simps)"], ["proof (state)\nthis:\n  surj (\\<lambda>x. - inverse x)\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "fix a b :: real"], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "assume \"a \\<le> b\""], ["proof (state)\nthis:\n  a \\<le> b\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "let ?A1 = \"\\<lambda>i. {..-inverse (Suc i) :: real}\" and  ?A2 = \"\\<lambda>i. {inverse (Suc i) :: real ..}\""], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "let ?C = \"if 0 \\<in> {a..b} then {0} else {}\""], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "let ?M1 = \"distr (density lborel f) lborel (\\<lambda>x. - inverse x)\" and ?M2 = \"density lborel ?g\""], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have inv_le: \"\\<And>x i. x \\<ge> inverse (real (Suc i)) \\<Longrightarrow> \\<not>(x \\<le> 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x i.\n       inverse (real (Suc i)) \\<le> x \\<Longrightarrow> \\<not> x \\<le> 0", "by (subst not_le, erule dual_order.strict_trans1, simp)"], ["proof (state)\nthis:\n  inverse (real (Suc ?i1)) \\<le> ?x1 \\<Longrightarrow> \\<not> ?x1 \\<le> 0\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"\\<And>x. x > 0 \\<Longrightarrow> \\<exists>i. x \\<ge> inverse (Suc i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow> \\<exists>i. inverse (real (Suc i)) \\<le> x", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>0 < x; \\<nexists>i. inverse (real (Suc i)) \\<le> x\\<rbrakk>\n       \\<Longrightarrow> False", "fix x :: real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>0 < x; \\<nexists>i. inverse (real (Suc i)) \\<le> x\\<rbrakk>\n       \\<Longrightarrow> False", "assume \"x > 0\" \"\\<not>(\\<exists>i. x \\<ge> inverse (Suc i))\""], ["proof (state)\nthis:\n  0 < x\n  \\<nexists>i. inverse (real (Suc i)) \\<le> x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>0 < x; \\<nexists>i. inverse (real (Suc i)) \\<le> x\\<rbrakk>\n       \\<Longrightarrow> False", "hence \"x \\<le> 0\""], ["proof (prove)\nusing this:\n  0 < x\n  \\<nexists>i. inverse (real (Suc i)) \\<le> x\n\ngoal (1 subgoal):\n 1. x \\<le> 0", "by (intro tendsto_lowerbound[OF LIMSEQ_inverse_real_of_nat])\n                      (auto intro!: always_eventually less_imp_le simp: not_le)"], ["proof (state)\nthis:\n  x \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>0 < x; \\<nexists>i. inverse (real (Suc i)) \\<le> x\\<rbrakk>\n       \\<Longrightarrow> False", "with \\<open>x > 0\\<close>"], ["proof (chain)\npicking this:\n  0 < x\n  x \\<le> 0", "show False"], ["proof (prove)\nusing this:\n  0 < x\n  x \\<le> 0\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  0 < ?x1 \\<Longrightarrow> \\<exists>i. inverse (real (Suc i)) \\<le> ?x1\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "hence A: \"(\\<Union>i. ?A2 i) = {0<..}\""], ["proof (prove)\nusing this:\n  0 < ?x1 \\<Longrightarrow> \\<exists>i. inverse (real (Suc i)) \\<le> ?x1\n\ngoal (1 subgoal):\n 1. (\\<Union>i. {inverse (real (Suc i))..}) = {0<..}", "by (auto dest: inv_le simp del: of_nat_Suc)"], ["proof (state)\nthis:\n  (\\<Union>i. {inverse (real (Suc i))..}) = {0<..}\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "moreover"], ["proof (state)\nthis:\n  (\\<Union>i. {inverse (real (Suc i))..}) = {0<..}\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"\\<And>x. x < 0 \\<Longrightarrow> \\<exists>i. x \\<le> -inverse (Suc i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x < 0 \\<Longrightarrow> \\<exists>i. x \\<le> - inverse (real (Suc i))", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x < 0;\n        \\<nexists>i. x \\<le> - inverse (real (Suc i))\\<rbrakk>\n       \\<Longrightarrow> False", "fix x :: real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x < 0;\n        \\<nexists>i. x \\<le> - inverse (real (Suc i))\\<rbrakk>\n       \\<Longrightarrow> False", "assume \"x < 0\" \"\\<not>(\\<exists>i. x \\<le> -inverse (Suc i))\""], ["proof (state)\nthis:\n  x < 0\n  \\<nexists>i. x \\<le> - inverse (real (Suc i))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x < 0;\n        \\<nexists>i. x \\<le> - inverse (real (Suc i))\\<rbrakk>\n       \\<Longrightarrow> False", "hence \"x \\<ge> 0\""], ["proof (prove)\nusing this:\n  x < 0\n  \\<nexists>i. x \\<le> - inverse (real (Suc i))\n\ngoal (1 subgoal):\n 1. 0 \\<le> x", "by (intro tendsto_upperbound, simp)\n         (auto intro!: always_eventually less_imp_le LIMSEQ_inverse_real_of_nat_add_minus simp: not_le)"], ["proof (state)\nthis:\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x < 0;\n        \\<nexists>i. x \\<le> - inverse (real (Suc i))\\<rbrakk>\n       \\<Longrightarrow> False", "with \\<open>x < 0\\<close>"], ["proof (chain)\npicking this:\n  x < 0\n  0 \\<le> x", "show False"], ["proof (prove)\nusing this:\n  x < 0\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x1 < 0 \\<Longrightarrow> \\<exists>i. ?x1 \\<le> - inverse (real (Suc i))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "hence B: \"(\\<Union>i. ?A1 i) = {..<0}\""], ["proof (prove)\nusing this:\n  ?x1 < 0 \\<Longrightarrow> \\<exists>i. ?x1 \\<le> - inverse (real (Suc i))\n\ngoal (1 subgoal):\n 1. (\\<Union>i. {..- inverse (real (Suc i))}) = {..<0}", "by (auto simp: le_minus_iff[of _ \"inverse x\" for x] dest!: inv_le simp del: of_nat_Suc)"], ["proof (state)\nthis:\n  (\\<Union>i. {..- inverse (real (Suc i))}) = {..<0}\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Union>i. {inverse (real (Suc i))..}) = {0<..}\n  (\\<Union>i. {..- inverse (real (Suc i))}) = {..<0}", "have C: \"UNIV = (\\<Union>i. ?A1 i) \\<union> (\\<Union>i. ?A2 i) \\<union> {0}\""], ["proof (prove)\nusing this:\n  (\\<Union>i. {inverse (real (Suc i))..}) = {0<..}\n  (\\<Union>i. {..- inverse (real (Suc i))}) = {..<0}\n\ngoal (1 subgoal):\n 1. UNIV =\n    (\\<Union>i. {..- inverse (real (Suc i))}) \\<union>\n    (\\<Union>i. {inverse (real (Suc i))..}) \\<union>\n    {0}", "by (subst A, subst B) force"], ["proof (state)\nthis:\n  UNIV =\n  (\\<Union>i. {..- inverse (real (Suc i))}) \\<union>\n  (\\<Union>i. {inverse (real (Suc i))..}) \\<union>\n  {0}\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have UN_Int_distrib: \"\\<And>f A. (\\<Union>i. f i) \\<inter> A = (\\<Union>i. f i \\<inter> A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f A. \\<Union> (range f) \\<inter> A = (\\<Union>i. f i \\<inter> A)", "by blast"], ["proof (state)\nthis:\n  \\<Union> (range ?f1) \\<inter> ?A1 = (\\<Union>i. ?f1 i \\<inter> ?A1)\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have decomp: \"{a..b} = (\\<Union>i. ?A1 i \\<inter> {a..b}) \\<union> (\\<Union>i. ?A2 i \\<inter> {a..b}) \\<union> ?C\" (is \"_ = ?D \\<union> ?E \\<union> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. {a..b} =\n    (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<union>\n    (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) \\<union>\n    (if 0 \\<in> {a..b} then {0} else {})", "by (subst Int_UNIV_left[symmetric], simp only: C Int_Un_distrib2 UN_Int_distrib)\n       (simp split: if_split)"], ["proof (state)\nthis:\n  {a..b} =\n  (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<union>\n  (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) \\<union>\n  (if 0 \\<in> {a..b} then {0} else {})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"emeasure ?M1 {a..b} = emeasure ?M1 ?D + emeasure ?M1 ?E + emeasure ?M1 ?C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     {a..b} =\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (if 0 \\<in> {a..b} then {0} else {})", "apply (subst decomp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     ((\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<union>\n      (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) \\<union>\n      (if 0 \\<in> {a..b} then {0} else {})) =\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (if 0 \\<in> {a..b} then {0} else {})", "apply (subst plus_emeasure[symmetric], simp, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     ((\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<union>\n      (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (if 0 \\<in> {a..b} then {0} else {}) =\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (if 0 \\<in> {a..b} then {0} else {})", "apply (subst plus_emeasure[symmetric])"], ["proof (prove)\ngoal (4 subgoals):\n 1. (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b})\n    \\<in> sets (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n 2. (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})\n    \\<in> sets (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n 3. (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<inter>\n    (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n    {}\n 4. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (if 0 \\<in> {a..b} then {0} else {}) =\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (if 0 \\<in> {a..b} then {0} else {})", "apply (auto dest!: inv_le simp: not_le le_minus_iff[of _ \"inverse x\" for x] simp del: of_nat_Suc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..b} =\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (if 0 \\<in> {a..b} then {0} else {})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..b} =\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (if 0 \\<in> {a..b} then {0} else {})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"(\\<lambda>x. - inverse x) -` {0 :: real} = {0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. - inverse x) -` {0} = {0}", "by (auto simp: field_simps)"], ["proof (state)\nthis:\n  (\\<lambda>x. - inverse x) -` {0} = {0}\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "hence \"emeasure ?M1 ?C = 0\""], ["proof (prove)\nusing this:\n  (\\<lambda>x. - inverse x) -` {0} = {0}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (if 0 \\<in> {a..b} then {0} else {}) =\n    0", "by (subst emeasure_distr)  (auto split: if_split simp: emeasure_density Mf)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (if 0 \\<in> {a..b} then {0} else {}) =\n  0\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (if 0 \\<in> {a..b} then {0} else {}) =\n  0\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"emeasure ?M2 {0} = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     {0} =\n    0", "by (simp add: emeasure_density)"], ["proof (state)\nthis:\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {0} =\n  0\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "hence \"0 = emeasure ?M2 ?C\""], ["proof (prove)\nusing this:\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {0} =\n  0\n\ngoal (1 subgoal):\n 1. 0 =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (if 0 \\<in> {a..b} then {0} else {})", "by (rule_tac sym, rule_tac order.antisym, rule_tac order.trans, rule_tac emeasure_mono[of _ \"{0}\"]) simp_all"], ["proof (state)\nthis:\n  0 =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (if 0 \\<in> {a..b} then {0} else {})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  0 =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (if 0 \\<in> {a..b} then {0} else {})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"emeasure ?M1 (\\<Union>i. ?A1 i \\<inter> {a..b}) = (SUP i. emeasure ?M1 (?A1 i \\<inter> {a..b}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) =\n    (\\<Squnion>i.\n        emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n         ({..- inverse (real (Suc i))} \\<inter> {a..b}))", "by (rule SUP_emeasure_incseq[symmetric])\n       (auto simp: incseq_def max_def not_le dest: order.strict_trans1)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) =\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n       ({..- inverse (real (Suc i))} \\<inter> {a..b}))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) =\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n       ({..- inverse (real (Suc i))} \\<inter> {a..b}))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"\\<And>i. emeasure ?M1 (?A1 i \\<inter> {a..b}) = emeasure ?M2 (?A1 i \\<inter> {a..b})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "proof (case_tac \"-inverse (Suc i) \\<ge> a\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "fix i"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "assume True: \"-inverse (Suc i) \\<ge> a\""], ["proof (state)\nthis:\n  a \\<le> - inverse (real (Suc i))\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "let ?a = \"-inverse (Suc i)\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "from \\<open>a \\<le> b\\<close>"], ["proof (chain)\npicking this:\n  a \\<le> b", "have A: \"?A1 i \\<inter> {a..b} = {a..min ?a b}\" (is \"?F = ?G\")"], ["proof (prove)\nusing this:\n  a \\<le> b\n\ngoal (1 subgoal):\n 1. {..- inverse (real (Suc i))} \\<inter> {a..b} =\n    {a..min (- inverse (real (Suc i))) b}", "by auto"], ["proof (state)\nthis:\n  {..- inverse (real (Suc i))} \\<inter> {a..b} =\n  {a..min (- inverse (real (Suc i))) b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "hence \"emeasure ?M1 ?F = emeasure ?M1 ?G\""], ["proof (prove)\nusing this:\n  {..- inverse (real (Suc i))} \\<inter> {a..b} =\n  {a..min (- inverse (real (Suc i))) b}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     {a..min (- inverse (real (Suc i))) b}", "by simp"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..min (- inverse (real (Suc i))) b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..min (- inverse (real (Suc i))) b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "have \"strict_mono_on (\\<lambda>x. -inverse x) {a..min ?a b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. strict_mono_on (\\<lambda>x. - inverse x)\n     {a..min (- inverse (real (Suc i))) b}", "by (rule strict_mono_onI)\n         (auto simp: le_minus_iff[of _ \"inverse x\" for x] dest!: inv_le simp del: of_nat_Suc)"], ["proof (state)\nthis:\n  strict_mono_on (\\<lambda>x. - inverse x)\n   {a..min (- inverse (real (Suc i))) b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "with \\<open>a \\<le> b\\<close> True dens"], ["proof (chain)\npicking this:\n  a \\<le> b\n  a \\<le> - inverse (real (Suc i))\n  has_subprob_density M lborel f\n  strict_mono_on (\\<lambda>x. - inverse x)\n   {a..min (- inverse (real (Suc i))) b}", "have \"emeasure ?M1 ?G = emeasure ?M2 ?G\""], ["proof (prove)\nusing this:\n  a \\<le> b\n  a \\<le> - inverse (real (Suc i))\n  has_subprob_density M lborel f\n  strict_mono_on (\\<lambda>x. - inverse x)\n   {a..min (- inverse (real (Suc i))) b}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     {a..min (- inverse (real (Suc i))) b} =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     {a..min (- inverse (real (Suc i))) b}", "by (intro emeasure_density_distr_interval)\n         (auto simp: Mf not_less dest: has_subprob_densityD inv_le\n               intro!: derivative_eq_intros continuous_on_mult continuous_on_inverse continuous_on_id)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..min (- inverse (real (Suc i))) b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {a..min (- inverse (real (Suc i))) b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..min (- inverse (real (Suc i))) b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {a..min (- inverse (real (Suc i))) b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "note A[symmetric]"], ["proof (state)\nthis:\n  {a..min (- inverse (real (Suc i))) b} =\n  {..- inverse (real (Suc i))} \\<inter> {a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({..- inverse (real (Suc i))} \\<inter> {a..b})", "show \"emeasure ?M1 (?A1 i \\<inter> {a..b}) = emeasure ?M2 (?A1 i \\<inter> {a..b})\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({..- inverse (real (Suc i))} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     ({..- inverse (real (Suc i))} \\<inter> {a..b})", "."], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({..- inverse (real (Suc i))} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<not> a \\<le> - inverse (real (Suc i)) \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({..- inverse (real (Suc i))} \\<inter> {a..b})", "qed simp"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({..- inverse (real (Suc ?i2))} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({..- inverse (real (Suc ?i2))} \\<inter> {a..b})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "hence \"(SUP i. emeasure ?M1 (?A1 i \\<inter> {a..b})) = (SUP i. emeasure ?M2 (?A1 i \\<inter> {a..b}))\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({..- inverse (real (Suc ?i2))} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({..- inverse (real (Suc ?i2))} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. (\\<Squnion>i.\n        emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n         ({..- inverse (real (Suc i))} \\<inter> {a..b})) =\n    (\\<Squnion>i.\n        emeasure\n         (density lborel\n           (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n         ({..- inverse (real (Suc i))} \\<inter> {a..b}))", "by simp"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n       ({..- inverse (real (Suc i))} \\<inter> {a..b})) =\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n       ({..- inverse (real (Suc i))} \\<inter> {a..b}))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n       ({..- inverse (real (Suc i))} \\<inter> {a..b})) =\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n       ({..- inverse (real (Suc i))} \\<inter> {a..b}))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"... = emeasure ?M2 (\\<Union>i. ?A1 i \\<inter> {a..b})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Squnion>i.\n        emeasure\n         (density lborel\n           (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n         ({..- inverse (real (Suc i))} \\<inter> {a..b})) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b})", "by (rule SUP_emeasure_incseq)\n       (auto simp: incseq_def max_def not_le dest: order.strict_trans1)"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n       ({..- inverse (real (Suc i))} \\<inter> {a..b})) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n       ({..- inverse (real (Suc i))} \\<inter> {a..b})) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"emeasure ?M1 (\\<Union>i. ?A2 i \\<inter> {a..b}) = (SUP i. emeasure ?M1 (?A2 i \\<inter> {a..b}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n    (\\<Squnion>i.\n        emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n         ({inverse (real (Suc i))..} \\<inter> {a..b}))", "by (rule SUP_emeasure_incseq[symmetric])\n       (auto simp: incseq_def max_def not_le dest: order.strict_trans1)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n       ({inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n       ({inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"\\<And>i. emeasure ?M1 (?A2 i \\<inter> {a..b}) = emeasure ?M2 (?A2 i \\<inter> {a..b})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "proof (case_tac \"inverse (Suc i) \\<le> b\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "fix i"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "assume True: \"inverse (Suc i) \\<le> b\""], ["proof (state)\nthis:\n  inverse (real (Suc i)) \\<le> b\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "let ?a = \"inverse (Suc i)\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "from \\<open>a \\<le> b\\<close>"], ["proof (chain)\npicking this:\n  a \\<le> b", "have A: \"?A2 i \\<inter> {a..b} = {max ?a a..b}\" (is \"?F = ?G\")"], ["proof (prove)\nusing this:\n  a \\<le> b\n\ngoal (1 subgoal):\n 1. {inverse (real (Suc i))..} \\<inter> {a..b} =\n    {max (inverse (real (Suc i))) a..b}", "by auto"], ["proof (state)\nthis:\n  {inverse (real (Suc i))..} \\<inter> {a..b} =\n  {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "hence \"emeasure ?M1 ?F = emeasure ?M1 ?G\""], ["proof (prove)\nusing this:\n  {inverse (real (Suc i))..} \\<inter> {a..b} =\n  {max (inverse (real (Suc i))) a..b}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n    emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     {max (inverse (real (Suc i))) a..b}", "by simp"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "have \"strict_mono_on (\\<lambda>x. -inverse x) {max ?a a..b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. strict_mono_on (\\<lambda>x. - inverse x)\n     {max (inverse (real (Suc i))) a..b}", "by (rule strict_mono_onI) (auto dest!: inv_le simp: not_le simp del: of_nat_Suc)"], ["proof (state)\nthis:\n  strict_mono_on (\\<lambda>x. - inverse x)\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "with \\<open>a \\<le> b\\<close> True dens"], ["proof (chain)\npicking this:\n  a \\<le> b\n  inverse (real (Suc i)) \\<le> b\n  has_subprob_density M lborel f\n  strict_mono_on (\\<lambda>x. - inverse x)\n   {max (inverse (real (Suc i))) a..b}", "have \"emeasure ?M1 ?G = emeasure ?M2 ?G\""], ["proof (prove)\nusing this:\n  a \\<le> b\n  inverse (real (Suc i)) \\<le> b\n  has_subprob_density M lborel f\n  strict_mono_on (\\<lambda>x. - inverse x)\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     {max (inverse (real (Suc i))) a..b} =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     {max (inverse (real (Suc i))) a..b}", "by (intro emeasure_density_distr_interval)\n         (auto simp: Mf not_less dest: has_subprob_densityD inv_le\n               intro!: derivative_eq_intros continuous_on_mult continuous_on_inverse continuous_on_id)"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {max (inverse (real (Suc i))) a..b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "also"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {max (inverse (real (Suc i))) a..b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {max (inverse (real (Suc i))) a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "note A[symmetric]"], ["proof (state)\nthis:\n  {max (inverse (real (Suc i))) a..b} =\n  {inverse (real (Suc i))..} \\<inter> {a..b}\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})\n 2. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({inverse (real (Suc i))..} \\<inter> {a..b})", "show \"emeasure ?M1 (?A2 i \\<inter> {a..b}) = emeasure ?M2 (?A2 i \\<inter> {a..b})\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     ({inverse (real (Suc i))..} \\<inter> {a..b})", "."], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<not> inverse (real (Suc i)) \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        ({inverse (real (Suc i))..} \\<inter> {a..b}) =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        ({inverse (real (Suc i))..} \\<inter> {a..b})", "qed simp"], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({inverse (real (Suc ?i2))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({inverse (real (Suc ?i2))..} \\<inter> {a..b})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "hence \"(SUP i. emeasure ?M1 (?A2 i \\<inter> {a..b})) = (SUP i. emeasure ?M2 (?A2 i \\<inter> {a..b}))\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   ({inverse (real (Suc ?i2))..} \\<inter> {a..b}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   ({inverse (real (Suc ?i2))..} \\<inter> {a..b})\n\ngoal (1 subgoal):\n 1. (\\<Squnion>i.\n        emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n         ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n    (\\<Squnion>i.\n        emeasure\n         (density lborel\n           (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n         ({inverse (real (Suc i))..} \\<inter> {a..b}))", "by simp"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n       ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n       ({inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n       ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n       ({inverse (real (Suc i))..} \\<inter> {a..b}))\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"... = emeasure ?M2 (\\<Union>i. ?A2 i \\<inter> {a..b})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Squnion>i.\n        emeasure\n         (density lborel\n           (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n         ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})", "by (rule SUP_emeasure_incseq)\n       (auto simp: incseq_def max_def not_le dest: order.strict_trans1)"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n       ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "also"], ["proof (state)\nthis:\n  (\\<Squnion>i.\n      emeasure\n       (density lborel\n         (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n       ({inverse (real (Suc i))..} \\<inter> {a..b})) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "have \"emeasure ?M2 ?D + emeasure ?M2 ?E + emeasure ?M2 ?C = emeasure ?M2 {a..b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (if 0 \\<in> {a..b} then {0} else {}) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     {a..b}", "apply (subst (4) decomp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (if 0 \\<in> {a..b} then {0} else {}) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     ((\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<union>\n      (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) \\<union>\n      (if 0 \\<in> {a..b} then {0} else {}))", "apply (subst plus_emeasure, simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<inter>\n    (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) =\n    {}\n 2. emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     ((\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<union>\n      (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b})) +\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     (if 0 \\<in> {a..b} then {0} else {}) =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     ((\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) \\<union>\n      (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) \\<union>\n      (if 0 \\<in> {a..b} then {0} else {}))", "apply (auto dest!: inv_le simp: not_le le_minus_iff[of _ \"inverse x\" for x] simp del: of_nat_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<le> 0; 0 \\<le> b\\<rbrakk>\n    \\<Longrightarrow> emeasure\n                       (density lborel\n                         (\\<lambda>x.\n                             f (- inverse x) *\n                             ennreal (inverse x * inverse x)))\n                       ((\\<Union>x.\n                            {a..min (- inverse (real (Suc x))) b}) \\<union>\n                        (\\<Union>x. {max (inverse (real (Suc x))) a..b})) +\n                      emeasure\n                       (density lborel\n                         (\\<lambda>x.\n                             f (- inverse x) *\n                             ennreal (inverse x * inverse x)))\n                       {0} =\n                      emeasure\n                       (density lborel\n                         (\\<lambda>x.\n                             f (- inverse x) *\n                             ennreal (inverse x * inverse x)))\n                       (insert 0\n                         ((\\<Union>x.\n                              {a..min (- inverse (real (Suc x)))\n                                   b}) \\<union>\n                          (\\<Union>x. {max (inverse (real (Suc x))) a..b})))", "apply (subst plus_emeasure)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>a \\<le> 0; 0 \\<le> b\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x.\n                          {a..min (- inverse (real (Suc x))) b}) \\<union>\n                      (\\<Union>x. {max (inverse (real (Suc x))) a..b})\n                      \\<in> sets\n                             (density lborel\n                               (\\<lambda>x.\n                                   f (- inverse x) *\n                                   ennreal (inverse x * inverse x)))\n 2. \\<lbrakk>a \\<le> 0; 0 \\<le> b\\<rbrakk>\n    \\<Longrightarrow> {0}\n                      \\<in> sets\n                             (density lborel\n                               (\\<lambda>x.\n                                   f (- inverse x) *\n                                   ennreal (inverse x * inverse x)))\n 3. \\<lbrakk>a \\<le> 0; 0 \\<le> b\\<rbrakk>\n    \\<Longrightarrow> ((\\<Union>x.\n                           {a..min (- inverse (real (Suc x))) b}) \\<union>\n                       (\\<Union>x.\n                           {max (inverse (real (Suc x))) a..b})) \\<inter>\n                      {0} =\n                      {}\n 4. \\<lbrakk>a \\<le> 0; 0 \\<le> b\\<rbrakk>\n    \\<Longrightarrow> emeasure\n                       (density lborel\n                         (\\<lambda>x.\n                             f (- inverse x) *\n                             ennreal (inverse x * inverse x)))\n                       ((\\<Union>x.\n                            {a..min (- inverse (real (Suc x))) b}) \\<union>\n                        (\\<Union>x.\n                            {max (inverse (real (Suc x))) a..b}) \\<union>\n                        {0}) =\n                      emeasure\n                       (density lborel\n                         (\\<lambda>x.\n                             f (- inverse x) *\n                             ennreal (inverse x * inverse x)))\n                       (insert 0\n                         ((\\<Union>x.\n                              {a..min (- inverse (real (Suc x)))\n                                   b}) \\<union>\n                          (\\<Union>x. {max (inverse (real (Suc x))) a..b})))", "apply (auto dest!: inv_le simp: not_le le_minus_iff[of _ \"inverse x\" for x])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (\\<Union>i. {..- inverse (real (Suc i))} \\<inter> {a..b}) +\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (\\<Union>i. {inverse (real (Suc i))..} \\<inter> {a..b}) +\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   (if 0 \\<in> {a..b} then {0} else {}) =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {a..b}\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel\n 2. \\<And>a b.\n       a \\<le> b \\<Longrightarrow>\n       emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n        {a..b} =\n       emeasure\n        (density lborel\n          (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n        {a..b}", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {a..b}", "show \"emeasure ?M1 {a..b} = emeasure ?M2 {a..b}\""], ["proof (prove)\nusing this:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {a..b}\n\ngoal (1 subgoal):\n 1. emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n     {a..b} =\n    emeasure\n     (density lborel\n       (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n     {a..b}", "."], ["proof (state)\nthis:\n  emeasure (distr (density lborel f) lborel (\\<lambda>x. - inverse x))\n   {a..b} =\n  emeasure\n   (density lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))))\n   {a..b}\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. - inverse x) \\<in> borel_measurable borel", "qed simp"], ["", "lemma subprob_density_distr_real_inverse:\n  assumes dens: \"has_subprob_density M lborel f\"\n  shows \"has_subprob_density (distr M borel inverse) lborel (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_subprob_density (distr M borel inverse) lborel\n     (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))", "proof (unfold has_subprob_density_def, intro conjI)"], ["proof (state)\ngoal (2 subgoals):\n 1. has_density (distr M borel inverse) lborel\n     (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\n 2. subprob_space (distr M borel inverse)", "let ?g' = \"(\\<lambda>x. f (-inverse x) * ennreal (inverse (x * x)))\""], ["proof (state)\ngoal (2 subgoals):\n 1. has_density (distr M borel inverse) lborel\n     (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\n 2. subprob_space (distr M borel inverse)", "have prob: \"has_subprob_density (distr M borel (\\<lambda>x. -inverse x)) lborel ?g'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_subprob_density (distr M borel (\\<lambda>x. - inverse x)) lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))", "by (rule subprob_density_distr_real_inverse_aux[OF assms])"], ["proof (state)\nthis:\n  has_subprob_density (distr M borel (\\<lambda>x. - inverse x)) lborel\n   (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))\n\ngoal (2 subgoals):\n 1. has_density (distr M borel inverse) lborel\n     (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\n 2. subprob_space (distr M borel inverse)", "from assms"], ["proof (chain)\npicking this:\n  has_subprob_density M lborel f", "have sets_M: \"sets M = sets borel\""], ["proof (prove)\nusing this:\n  has_subprob_density M lborel f\n\ngoal (1 subgoal):\n 1. sets M = sets borel", "by (auto dest: has_subprob_densityD)"], ["proof (state)\nthis:\n  sets M = sets borel\n\ngoal (2 subgoals):\n 1. has_density (distr M borel inverse) lborel\n     (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\n 2. subprob_space (distr M borel inverse)", "have [simp]: \"measurable M = measurable borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<rightarrow>\\<^sub>M) M = (\\<rightarrow>\\<^sub>M) borel", "by (intro ext, subst measurable_cong_sets[OF sets_M refl]) auto"], ["proof (state)\nthis:\n  (\\<rightarrow>\\<^sub>M) M = (\\<rightarrow>\\<^sub>M) borel\n\ngoal (2 subgoals):\n 1. has_density (distr M borel inverse) lborel\n     (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\n 2. subprob_space (distr M borel inverse)", "from prob"], ["proof (chain)\npicking this:\n  has_subprob_density (distr M borel (\\<lambda>x. - inverse x)) lborel\n   (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))", "have dens: \"has_density (distr M lborel (\\<lambda>x. -inverse x)) lborel\n                 (\\<lambda>x. f (-inverse x) * ennreal (inverse (x * x)))\""], ["proof (prove)\nusing this:\n  has_subprob_density (distr M borel (\\<lambda>x. - inverse x)) lborel\n   (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))\n\ngoal (1 subgoal):\n 1. has_density (distr M lborel (\\<lambda>x. - inverse x)) lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))", "unfolding has_subprob_density_def"], ["proof (prove)\nusing this:\n  has_density (distr M borel (\\<lambda>x. - inverse x)) lborel\n   (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x))) \\<and>\n  subprob_space (distr M borel (\\<lambda>x. - inverse x))\n\ngoal (1 subgoal):\n 1. has_density (distr M lborel (\\<lambda>x. - inverse x)) lborel\n     (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))", "by (simp cong: distr_cong)"], ["proof (state)\nthis:\n  has_density (distr M lborel (\\<lambda>x. - inverse x)) lborel\n   (\\<lambda>x. f (- inverse x) * ennreal (inverse (x * x)))\n\ngoal (2 subgoals):\n 1. has_density (distr M borel inverse) lborel\n     (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\n 2. subprob_space (distr M borel inverse)", "from distr_uminus_real[OF this]"], ["proof (chain)\npicking this:\n  has_density\n   (distr (distr M lborel (\\<lambda>x. - inverse x)) borel uminus) lborel\n   (\\<lambda>x. f (- inverse (- x)) * ennreal (inverse (- x * - x)))", "show \"has_density (distr M borel inverse) lborel\n              (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\""], ["proof (prove)\nusing this:\n  has_density\n   (distr (distr M lborel (\\<lambda>x. - inverse x)) borel uminus) lborel\n   (\\<lambda>x. f (- inverse (- x)) * ennreal (inverse (- x * - x)))\n\ngoal (1 subgoal):\n 1. has_density (distr M borel inverse) lborel\n     (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))", "by (simp add: distr_distr o_def cong: distr_cong)"], ["proof (state)\nthis:\n  has_density (distr M borel inverse) lborel\n   (\\<lambda>x. f (inverse x) * ennreal (inverse (x * x)))\n\ngoal (1 subgoal):\n 1. subprob_space (distr M borel inverse)", "show \"subprob_space (distr M borel inverse)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subprob_space (distr M borel inverse)", "by (intro subprob_space.subprob_space_distr has_subprob_densityD[OF assms]) simp_all"], ["proof (state)\nthis:\n  subprob_space (distr M borel inverse)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma distr_convolution_real:\n  assumes \"has_density M lborel (f :: (real \\<times> real) \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M borel (case_prod (+))) lborel (\\<lambda>z. \\<integral>\\<^sup>+x. f (x, z - x) \\<partial>lborel)\"\n            (is \"has_density ?M' _ ?f'\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. has_density (distr M borel (\\<lambda>(x, y). x + y)) lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n    \\<in> borel_measurable lborel\n 2. distr M borel (\\<lambda>(x, y). x + y) =\n    density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n 3. space lborel \\<noteq> {}", "from has_densityD[OF assms]"], ["proof (chain)\npicking this:\n  f \\<in> borel_measurable lborel\n  M = density lborel f\n  space lborel \\<noteq> {}", "have Mf[measurable]: \"f \\<in> borel_measurable borel\""], ["proof (prove)\nusing this:\n  f \\<in> borel_measurable lborel\n  M = density lborel f\n  space lborel \\<noteq> {}\n\ngoal (1 subgoal):\n 1. f \\<in> borel_measurable borel", "by simp"], ["proof (state)\nthis:\n  f \\<in> borel_measurable borel\n\ngoal (3 subgoals):\n 1. (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n    \\<in> borel_measurable lborel\n 2. distr M borel (\\<lambda>(x, y). x + y) =\n    density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n 3. space lborel \\<noteq> {}", "show Mf': \"(\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel) \\<in> borel_measurable lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n    \\<in> borel_measurable lborel", "by measurable"], ["proof (state)\nthis:\n  (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n  \\<in> borel_measurable lborel\n\ngoal (2 subgoals):\n 1. distr M borel (\\<lambda>(x, y). x + y) =\n    density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n 2. space lborel \\<noteq> {}", "from assms"], ["proof (chain)\npicking this:\n  has_density M lborel f", "have sets_M: \"sets M = sets borel\""], ["proof (prove)\nusing this:\n  has_density M lborel f\n\ngoal (1 subgoal):\n 1. sets M = sets borel", "by (auto dest: has_densityD)"], ["proof (state)\nthis:\n  sets M = sets borel\n\ngoal (2 subgoals):\n 1. distr M borel (\\<lambda>(x, y). x + y) =\n    density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n 2. space lborel \\<noteq> {}", "hence [simp]: \"space M = UNIV\""], ["proof (prove)\nusing this:\n  sets M = sets borel\n\ngoal (1 subgoal):\n 1. space M = UNIV", "by (subst sets_eq_imp_space_eq[OF sets_M]) simp"], ["proof (state)\nthis:\n  space M = UNIV\n\ngoal (2 subgoals):\n 1. distr M borel (\\<lambda>(x, y). x + y) =\n    density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n 2. space lborel \\<noteq> {}", "from sets_M"], ["proof (chain)\npicking this:\n  sets M = sets borel", "have [simp]: \"measurable M = measurable borel\""], ["proof (prove)\nusing this:\n  sets M = sets borel\n\ngoal (1 subgoal):\n 1. (\\<rightarrow>\\<^sub>M) M = (\\<rightarrow>\\<^sub>M) borel", "by (intro ext measurable_cong_sets) simp_all"], ["proof (state)\nthis:\n  (\\<rightarrow>\\<^sub>M) M = (\\<rightarrow>\\<^sub>M) borel\n\ngoal (2 subgoals):\n 1. distr M borel (\\<lambda>(x, y). x + y) =\n    density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n 2. space lborel \\<noteq> {}", "have M_add: \"case_prod (+) \\<in> borel_measurable (borel :: (real \\<times> real) measure)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>(x, y). x + y) \\<in> borel_measurable borel", "by (simp add: borel_prod[symmetric])"], ["proof (state)\nthis:\n  (\\<lambda>(x, y). x + y) \\<in> borel_measurable borel\n\ngoal (2 subgoals):\n 1. distr M borel (\\<lambda>(x, y). x + y) =\n    density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n 2. space lborel \\<noteq> {}", "show \"distr M borel (case_prod (+)) = density lborel ?f'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M borel (\\<lambda>(x, y). x + y) =\n    density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)", "proof (rule measure_eqI)"], ["proof (state)\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "fix X :: \"real set\""], ["proof (state)\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "assume X[measurable]: \"X \\<in> sets (distr M borel (case_prod (+)))\""], ["proof (state)\nthis:\n  X \\<in> sets (distr M borel (\\<lambda>(x, y). x + y))\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "hence \"emeasure (distr M borel (case_prod (+))) X = emeasure M ((\\<lambda>(x, y). x + y) -` X)\""], ["proof (prove)\nusing this:\n  X \\<in> sets (distr M borel (\\<lambda>(x, y). x + y))\n\ngoal (1 subgoal):\n 1. emeasure (distr M borel (\\<lambda>(x, y). x + y)) X =\n    emeasure M ((\\<lambda>(x, y). x + y) -` X)", "by (simp_all add: M_add emeasure_distr)"], ["proof (state)\nthis:\n  emeasure (distr M borel (\\<lambda>(x, y). x + y)) X =\n  emeasure M ((\\<lambda>(x, y). x + y) -` X)\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "also"], ["proof (state)\nthis:\n  emeasure (distr M borel (\\<lambda>(x, y). x + y)) X =\n  emeasure M ((\\<lambda>(x, y). x + y) -` X)\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "from X"], ["proof (chain)\npicking this:\n  X \\<in> sets (distr M borel (\\<lambda>(x, y). x + y))", "have \"... = \\<integral>\\<^sup>+z. f z * indicator ((\\<lambda>(x, y). x + y) -` X) z \\<partial>(lborel \\<Otimes>\\<^sub>M lborel)\""], ["proof (prove)\nusing this:\n  X \\<in> sets (distr M borel (\\<lambda>(x, y). x + y))\n\ngoal (1 subgoal):\n 1. emeasure M ((\\<lambda>(x, y). x + y) -` X) =\n    set_nn_integral (lborel \\<Otimes>\\<^sub>M lborel)\n     ((\\<lambda>(x, y). x + y) -` X) f", "by (simp add: emeasure_density has_densityD[OF assms]\n                     measurable_sets_borel[OF M_add] lborel_prod)"], ["proof (state)\nthis:\n  emeasure M ((\\<lambda>(x, y). x + y) -` X) =\n  set_nn_integral (lborel \\<Otimes>\\<^sub>M lborel)\n   ((\\<lambda>(x, y). x + y) -` X) f\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "also"], ["proof (state)\nthis:\n  emeasure M ((\\<lambda>(x, y). x + y) -` X) =\n  set_nn_integral (lborel \\<Otimes>\\<^sub>M lborel)\n   ((\\<lambda>(x, y). x + y) -` X) f\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "have \"... = \\<integral>\\<^sup>+x. \\<integral>\\<^sup>+y. f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x,y) \\<partial>lborel \\<partial>lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_nn_integral (lborel \\<Otimes>\\<^sub>M lborel)\n     ((\\<lambda>(x, y). x + y) -` X) f =\n    \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n          f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n        \\<partial>lborel\n                       \\<partial>lborel", "apply (rule lborel.nn_integral_fst[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>z. f z * indicator ((\\<lambda>(x, y). x + y) -` X) z)\n    \\<in> borel_measurable (lborel \\<Otimes>\\<^sub>M lborel)", "apply measurable"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>x. x) \\<in> borel_measurable (borel \\<Otimes>\\<^sub>M borel)\n 2. indicator ((\\<lambda>(x, y). x + y) -` X)\n    \\<in> borel_measurable (lborel \\<Otimes>\\<^sub>M lborel)", "apply (simp_all add: borel_prod)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  set_nn_integral (lborel \\<Otimes>\\<^sub>M lborel)\n   ((\\<lambda>(x, y). x + y) -` X) f =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>lborel\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "also"], ["proof (state)\nthis:\n  set_nn_integral (lborel \\<Otimes>\\<^sub>M lborel)\n   ((\\<lambda>(x, y). x + y) -` X) f =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>lborel\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "have \"... = \\<integral>\\<^sup>+x. \\<integral>\\<^sup>+y. f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x,y)\n                          \\<partial>distr lborel borel ((+) (-x)) \\<partial>lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n          f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n        \\<partial>lborel\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n          f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n        \\<partial>distr lborel borel ((+) (- x))\n                       \\<partial>lborel", "by (rule nn_integral_cong, subst lborel_distr_plus) simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>lborel\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>distr lborel borel ((+) (- x))\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>lborel\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>distr lborel borel ((+) (- x))\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "have \"... = \\<integral>\\<^sup>+x. \\<integral>\\<^sup>+z. f (x, z-x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z-x)\n                          \\<partial>lborel \\<partial>lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n          f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n        \\<partial>distr lborel borel ((+) (- x))\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n          f (x, z - x) *\n          indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n        \\<partial>lborel\n                       \\<partial>lborel", "apply (rule nn_integral_cong)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> space lborel \\<Longrightarrow>\n       \\<integral>\\<^sup>+ y. f (x, y) *\n                              indicator ((\\<lambda>(x, y). x + y) -` X)\n                               (x, y)\n                          \\<partial>distr lborel borel ((+) (- x)) =\n       \\<integral>\\<^sup>+ z. f (x, z - x) *\n                              indicator ((\\<lambda>(x, y). x + y) -` X)\n                               (x, z - x)\n                          \\<partial>lborel", "apply (subst nn_integral_distr)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> space lborel \\<Longrightarrow>\n       (+) (- x) \\<in> borel_measurable lborel\n 2. \\<And>x.\n       x \\<in> space lborel \\<Longrightarrow>\n       (\\<lambda>y.\n           f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y))\n       \\<in> borel_measurable (distr lborel borel ((+) (- x)))\n 3. \\<And>x.\n       x \\<in> space lborel \\<Longrightarrow>\n       \\<integral>\\<^sup>+ xa. f (x, - x + xa) *\n                               indicator ((\\<lambda>(x, y). x + y) -` X)\n                                (x, - x + xa)\n                          \\<partial>lborel =\n       \\<integral>\\<^sup>+ z. f (x, z - x) *\n                              indicator ((\\<lambda>(x, y). x + y) -` X)\n                               (x, z - x)\n                          \\<partial>lborel", "apply simp_all"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       (\\<lambda>y.\n           f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y))\n       \\<in> borel_measurable borel", "apply measurable"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> space (?M1.20 x)\n 2. \\<And>x. (\\<lambda>x. x) \\<in> borel_measurable borel", "apply (subst space_count_space)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> ?y24 x x\n 2. \\<And>x. (\\<lambda>x. x) \\<in> borel_measurable borel", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>distr lborel borel ((+) (- x))\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n        f (x, z - x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n      \\<partial>lborel\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>distr lborel borel ((+) (- x))\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n        f (x, z - x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n      \\<partial>lborel\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "have \"... = \\<integral>\\<^sup>+x. \\<integral>\\<^sup>+z. f (x, z-x) * indicator X z \\<partial>lborel \\<partial>lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n          f (x, z - x) *\n          indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n        \\<partial>lborel\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                            \\<partial>lborel)\n                       \\<partial>lborel", "by (intro nn_integral_cong) (simp split: split_indicator)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n        f (x, z - x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n      \\<partial>lborel\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                          \\<partial>lborel)\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n        f (x, z - x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n      \\<partial>lborel\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                          \\<partial>lborel)\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "have \"... = \\<integral>\\<^sup>+z. \\<integral>\\<^sup>+x. f (x, z-x) * indicator X z \\<partial>lborel \\<partial>lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                            \\<partial>lborel)\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x.\n          f (x, z - x) * indicator X z\n        \\<partial>lborel\n                       \\<partial>lborel", "using X"], ["proof (prove)\nusing this:\n  X \\<in> sets (distr M borel (\\<lambda>(x, y). x + y))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                            \\<partial>lborel)\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x.\n          f (x, z - x) * indicator X z\n        \\<partial>lborel\n                       \\<partial>lborel", "by (subst lborel_pair.Fubini')\n         (simp_all add: pair_sigma_finite_def)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                          \\<partial>lborel)\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x. f (x, z - x) * indicator X z\n      \\<partial>lborel\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                          \\<partial>lborel)\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x. f (x, z - x) * indicator X z\n      \\<partial>lborel\n                     \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "have \"... = \\<integral>\\<^sup>+z. (\\<integral>\\<^sup>+x. f (x, z-x) \\<partial>lborel) * indicator X z \\<partial>lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x.\n          f (x, z - x) * indicator X z\n        \\<partial>lborel\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+z\\<in>X.\n                       \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel\n    \\<partial>lborel", "by (rule nn_integral_cong) (simp split: split_indicator)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x. f (x, z - x) * indicator X z\n      \\<partial>lborel\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+z\\<in>X.\n                     \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel\n  \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x. f (x, z - x) * indicator X z\n      \\<partial>lborel\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+z\\<in>X.\n                     \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel\n  \\<partial>lborel\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "have \"... = emeasure (density lborel ?f') X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+z\\<in>X.\n                       \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel\n    \\<partial>lborel =\n    emeasure\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n     X", "using X"], ["proof (prove)\nusing this:\n  X \\<in> sets (distr M borel (\\<lambda>(x, y). x + y))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+z\\<in>X.\n                       \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel\n    \\<partial>lborel =\n    emeasure\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n     X", "by (simp add: emeasure_density)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+z\\<in>X.\n                     \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel\n  \\<partial>lborel =\n  emeasure\n   (density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n   X\n\ngoal (2 subgoals):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M borel (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M borel (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density lborel\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n        A", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr M borel (\\<lambda>(x, y). x + y)) X =\n  emeasure\n   (density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n   X", "show \"emeasure (distr M borel (case_prod (+))) X = emeasure (density lborel ?f') X\""], ["proof (prove)\nusing this:\n  emeasure (distr M borel (\\<lambda>(x, y). x + y)) X =\n  emeasure\n   (density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n   X\n\ngoal (1 subgoal):\n 1. emeasure (distr M borel (\\<lambda>(x, y). x + y)) X =\n    emeasure\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n     X", "."], ["proof (state)\nthis:\n  emeasure (distr M borel (\\<lambda>(x, y). x + y)) X =\n  emeasure\n   (density lborel\n     (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))\n   X\n\ngoal (1 subgoal):\n 1. sets (distr M borel (\\<lambda>(x, y). x + y)) =\n    sets\n     (density lborel\n       (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel))", "qed (insert assms, auto dest: has_densityD)"], ["proof (state)\nthis:\n  distr M borel (\\<lambda>(x, y). x + y) =\n  density lborel\n   (\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>lborel)\n\ngoal (1 subgoal):\n 1. space lborel \\<noteq> {}", "qed simp_all"], ["", "lemma distr_convolution_ring_count_space:\n  assumes C: \"countable (UNIV :: 'a set)\"\n  assumes \"has_density M (count_space UNIV) (f :: (('a :: ring) \\<times> 'a) \\<Rightarrow> ennreal)\"\n  shows \"has_density (distr M (count_space UNIV) (case_prod (+))) (count_space UNIV)\n             (\\<lambda>z. \\<integral>\\<^sup>+x. f (x, z - x) \\<partial>count_space UNIV)\"\n            (is \"has_density ?M' _ ?f'\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. has_density (distr M (count_space UNIV) (\\<lambda>(x, y). x + y))\n     (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>z.\n        \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n    \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) (\\<lambda>(x, y). x + y) =\n    density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n 3. space (count_space UNIV) \\<noteq> {}", "let ?CS = \"count_space UNIV :: 'a measure\" and ?CSP = \"count_space UNIV :: ('a \\<times> 'a) measure\""], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>z.\n        \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n    \\<in> borel_measurable (count_space UNIV)\n 2. distr M (count_space UNIV) (\\<lambda>(x, y). x + y) =\n    density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n 3. space (count_space UNIV) \\<noteq> {}", "show Mf': \"(\\<lambda>z. \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV) \\<in> borel_measurable ?CS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>z.\n        \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n    \\<in> borel_measurable (count_space UNIV)", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>z.\n      \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n  \\<in> borel_measurable (count_space UNIV)\n\ngoal (2 subgoals):\n 1. distr M (count_space UNIV) (\\<lambda>(x, y). x + y) =\n    density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n 2. space (count_space UNIV) \\<noteq> {}", "from assms"], ["proof (chain)\npicking this:\n  countable UNIV\n  has_density M (count_space UNIV) f", "have sets_M: \"sets M = UNIV\" and [simp]: \"space M = UNIV\""], ["proof (prove)\nusing this:\n  countable UNIV\n  has_density M (count_space UNIV) f\n\ngoal (1 subgoal):\n 1. sets M = UNIV &&& space M = UNIV", "by (auto dest: has_densityD)"], ["proof (state)\nthis:\n  sets M = UNIV\n  space M = UNIV\n\ngoal (2 subgoals):\n 1. distr M (count_space UNIV) (\\<lambda>(x, y). x + y) =\n    density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n 2. space (count_space UNIV) \\<noteq> {}", "from assms"], ["proof (chain)\npicking this:\n  countable UNIV\n  has_density M (count_space UNIV) f", "have [simp]: \"measurable M = measurable (count_space UNIV)\""], ["proof (prove)\nusing this:\n  countable UNIV\n  has_density M (count_space UNIV) f\n\ngoal (1 subgoal):\n 1. (\\<rightarrow>\\<^sub>M) M = (\\<rightarrow>\\<^sub>M) (count_space UNIV)", "by (intro ext measurable_cong_sets) (simp_all add: sets_M)"], ["proof (state)\nthis:\n  (\\<rightarrow>\\<^sub>M) M = (\\<rightarrow>\\<^sub>M) (count_space UNIV)\n\ngoal (2 subgoals):\n 1. distr M (count_space UNIV) (\\<lambda>(x, y). x + y) =\n    density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n 2. space (count_space UNIV) \\<noteq> {}", "interpret sigma_finite_measure ?CS"], ["proof (prove)\ngoal (1 subgoal):\n 1. sigma_finite_measure (count_space UNIV)", "by (rule sigma_finite_measure_count_space_countable[OF C])"], ["proof (state)\ngoal (2 subgoals):\n 1. distr M (count_space UNIV) (\\<lambda>(x, y). x + y) =\n    density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n 2. space (count_space UNIV) \\<noteq> {}", "show \"distr M ?CS (case_prod (+)) = density ?CS ?f'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M (count_space UNIV) (\\<lambda>(x, y). x + y) =\n    density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)", "proof (rule measure_eqI)"], ["proof (state)\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "fix X :: \"'a set\""], ["proof (state)\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "assume X: \"X \\<in> sets (distr M ?CS (case_prod (+)))\""], ["proof (state)\nthis:\n  X \\<in> sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y))\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "hence \"emeasure (distr M ?CS (case_prod (+))) X = emeasure M ((\\<lambda>(x, y). x + y) -` X)\""], ["proof (prove)\nusing this:\n  X \\<in> sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y))\n\ngoal (1 subgoal):\n 1. emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) X =\n    emeasure M ((\\<lambda>(x, y). x + y) -` X)", "by (simp_all add: emeasure_distr)"], ["proof (state)\nthis:\n  emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) X =\n  emeasure M ((\\<lambda>(x, y). x + y) -` X)\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "also"], ["proof (state)\nthis:\n  emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) X =\n  emeasure M ((\\<lambda>(x, y). x + y) -` X)\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "from X"], ["proof (chain)\npicking this:\n  X \\<in> sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y))", "have \"... = \\<integral>\\<^sup>+z. f z * indicator ((\\<lambda>(x, y). x + y) -` X) z \\<partial>(?CS \\<Otimes>\\<^sub>M ?CS)\""], ["proof (prove)\nusing this:\n  X \\<in> sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y))\n\ngoal (1 subgoal):\n 1. emeasure M ((\\<lambda>(x, y). x + y) -` X) =\n    set_nn_integral (count_space UNIV \\<Otimes>\\<^sub>M count_space UNIV)\n     ((\\<lambda>(x, y). x + y) -` X) f", "by (simp add: emeasure_density has_densityD[OF assms(2)]\n                     sets_M pair_measure_countable C)"], ["proof (state)\nthis:\n  emeasure M ((\\<lambda>(x, y). x + y) -` X) =\n  set_nn_integral (count_space UNIV \\<Otimes>\\<^sub>M count_space UNIV)\n   ((\\<lambda>(x, y). x + y) -` X) f\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "also"], ["proof (state)\nthis:\n  emeasure M ((\\<lambda>(x, y). x + y) -` X) =\n  set_nn_integral (count_space UNIV \\<Otimes>\\<^sub>M count_space UNIV)\n   ((\\<lambda>(x, y). x + y) -` X) f\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "have \"... = \\<integral>\\<^sup>+x. \\<integral>\\<^sup>+y. f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x,y) \\<partial>?CS \\<partial>?CS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_nn_integral (count_space UNIV \\<Otimes>\\<^sub>M count_space UNIV)\n     ((\\<lambda>(x, y). x + y) -` X) f =\n    \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n          f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n        \\<partial>count_space UNIV\n                       \\<partial>count_space UNIV", "by (rule nn_integral_fst[symmetric]) (simp add: pair_measure_countable C)"], ["proof (state)\nthis:\n  set_nn_integral (count_space UNIV \\<Otimes>\\<^sub>M count_space UNIV)\n   ((\\<lambda>(x, y). x + y) -` X) f =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "also"], ["proof (state)\nthis:\n  set_nn_integral (count_space UNIV \\<Otimes>\\<^sub>M count_space UNIV)\n   ((\\<lambda>(x, y). x + y) -` X) f =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "have \"... = \\<integral>\\<^sup>+x. \\<integral>\\<^sup>+y. f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x,y)\n                          \\<partial>distr ?CS ?CS ((+) (-x)) \\<partial>?CS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n          f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n        \\<partial>count_space UNIV\n                       \\<partial>count_space UNIV =\n    \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n          f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n        \\<partial>distr (count_space UNIV) (count_space UNIV) ((+) (- x))\n                       \\<partial>count_space UNIV", "by (rule nn_integral_cong, subst count_space_plus) simp"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>distr (count_space UNIV) (count_space UNIV) ((+) (- x))\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>distr (count_space UNIV) (count_space UNIV) ((+) (- x))\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "have \"... = \\<integral>\\<^sup>+x. \\<integral>\\<^sup>+z. f (x, z-x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z-x) \\<partial>?CS \\<partial>?CS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n          f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n        \\<partial>distr (count_space UNIV) (count_space UNIV) ((+) (- x))\n                       \\<partial>count_space UNIV =\n    \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n          f (x, z - x) *\n          indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n        \\<partial>count_space UNIV\n                       \\<partial>count_space UNIV", "by (rule nn_integral_cong) (simp_all add: nn_integral_distr)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>distr (count_space UNIV) (count_space UNIV) ((+) (- x))\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n        f (x, z - x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ y.\n        f (x, y) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, y)\n      \\<partial>distr (count_space UNIV) (count_space UNIV) ((+) (- x))\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n        f (x, z - x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "have \"... = \\<integral>\\<^sup>+x. \\<integral>\\<^sup>+z. f (x, z-x) * indicator X z \\<partial>?CS \\<partial>?CS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n          f (x, z - x) *\n          indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n        \\<partial>count_space UNIV\n                       \\<partial>count_space UNIV =\n    \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                            \\<partial>count_space UNIV)\n                       \\<partial>count_space UNIV", "by (intro nn_integral_cong) (simp split: split_indicator)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n        f (x, z - x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                          \\<partial>count_space UNIV)\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. \\<integral>\\<^sup>+ z.\n        f (x, z - x) * indicator ((\\<lambda>(x, y). x + y) -` X) (x, z - x)\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                          \\<partial>count_space UNIV)\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "have \"... = \\<integral>\\<^sup>+z. \\<integral>\\<^sup>+x. f (x, z-x) * indicator X z \\<partial>?CS \\<partial>?CS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                            \\<partial>count_space UNIV)\n                       \\<partial>count_space UNIV =\n    \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x.\n          f (x, z - x) * indicator X z\n        \\<partial>count_space UNIV\n                       \\<partial>count_space UNIV", "using X"], ["proof (prove)\nusing this:\n  X \\<in> sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                            \\<partial>count_space UNIV)\n                       \\<partial>count_space UNIV =\n    \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x.\n          f (x, z - x) * indicator X z\n        \\<partial>count_space UNIV\n                       \\<partial>count_space UNIV", "by (subst pair_sigma_finite.Fubini')\n         (simp_all add: pair_sigma_finite_def sigma_finite_measure_count_space_countable\n                        C pair_measure_countable)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                          \\<partial>count_space UNIV)\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x. f (x, z - x) * indicator X z\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ x. (\\<integral>\\<^sup>+z\\<in>X. f (x, z - x)\n                          \\<partial>count_space UNIV)\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x. f (x, z - x) * indicator X z\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "have \"... = \\<integral>\\<^sup>+z. (\\<integral>\\<^sup>+x. f (x, z-x) \\<partial>?CS) * indicator X z \\<partial>?CS\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x.\n          f (x, z - x) * indicator X z\n        \\<partial>count_space UNIV\n                       \\<partial>count_space UNIV =\n    \\<integral>\\<^sup>+z\\<in>X.\n                       \\<integral>\\<^sup>+ x. f (x, z - x)\n    \\<partial>count_space UNIV\n    \\<partial>count_space UNIV", "by (rule nn_integral_cong) (simp split: split_indicator)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x. f (x, z - x) * indicator X z\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+z\\<in>X.\n                     \\<integral>\\<^sup>+ x. f (x, z - x)\n  \\<partial>count_space UNIV\n  \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ z. \\<integral>\\<^sup>+ x. f (x, z - x) * indicator X z\n      \\<partial>count_space UNIV\n                     \\<partial>count_space UNIV =\n  \\<integral>\\<^sup>+z\\<in>X.\n                     \\<integral>\\<^sup>+ x. f (x, z - x)\n  \\<partial>count_space UNIV\n  \\<partial>count_space UNIV\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "have \"... = emeasure (density ?CS ?f') X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+z\\<in>X.\n                       \\<integral>\\<^sup>+ x. f (x, z - x)\n    \\<partial>count_space UNIV\n    \\<partial>count_space UNIV =\n    emeasure\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n     X", "using X"], ["proof (prove)\nusing this:\n  X \\<in> sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+z\\<in>X.\n                       \\<integral>\\<^sup>+ x. f (x, z - x)\n    \\<partial>count_space UNIV\n    \\<partial>count_space UNIV =\n    emeasure\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n     X", "by (simp add: emeasure_density)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+z\\<in>X.\n                     \\<integral>\\<^sup>+ x. f (x, z - x)\n  \\<partial>count_space UNIV\n  \\<partial>count_space UNIV =\n  emeasure\n   (density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n   X\n\ngoal (2 subgoals):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n 2. \\<And>A.\n       A \\<in> sets\n                (distr M (count_space UNIV)\n                  (\\<lambda>(x, y). x + y)) \\<Longrightarrow>\n       emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) A =\n       emeasure\n        (density (count_space UNIV)\n          (\\<lambda>z.\n              \\<integral>\\<^sup>+ x. f (x, z - x)\n                                 \\<partial>count_space UNIV))\n        A", "finally"], ["proof (chain)\npicking this:\n  emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) X =\n  emeasure\n   (density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n   X", "show \"emeasure (distr M ?CS (case_prod (+))) X = emeasure (density ?CS ?f') X\""], ["proof (prove)\nusing this:\n  emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) X =\n  emeasure\n   (density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n   X\n\ngoal (1 subgoal):\n 1. emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) X =\n    emeasure\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n     X", "."], ["proof (state)\nthis:\n  emeasure (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) X =\n  emeasure\n   (density (count_space UNIV)\n     (\\<lambda>z.\n         \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))\n   X\n\ngoal (1 subgoal):\n 1. sets (distr M (count_space UNIV) (\\<lambda>(x, y). x + y)) =\n    sets\n     (density (count_space UNIV)\n       (\\<lambda>z.\n           \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV))", "qed (insert assms, auto dest: has_densityD)"], ["proof (state)\nthis:\n  distr M (count_space UNIV) (\\<lambda>(x, y). x + y) =\n  density (count_space UNIV)\n   (\\<lambda>z.\n       \\<integral>\\<^sup>+ x. f (x, z - x) \\<partial>count_space UNIV)\n\ngoal (1 subgoal):\n 1. space (count_space UNIV) \\<noteq> {}", "qed simp_all"], ["", "end"]]}