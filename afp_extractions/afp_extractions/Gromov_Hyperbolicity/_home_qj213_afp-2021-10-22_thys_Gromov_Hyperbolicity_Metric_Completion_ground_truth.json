{"file_name": "/home/qj213/afp-2021-10-22/thys/Gromov_Hyperbolicity/Metric_Completion.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Gromov_Hyperbolicity", "problem_names": ["lemma convergent_Cauchy_dist:\n  fixes u v::\"nat \\<Rightarrow> ('a::metric_space)\"\n  assumes \"Cauchy u\" \"Cauchy v\"\n  shows \"convergent (\\<lambda>n. dist (u n) (v n))\"", "lemma convergent_add_null:\n  fixes u v::\"nat \\<Rightarrow> ('a::real_normed_vector)\"\n  assumes \"convergent u\"\n          \"(\\<lambda>n. v n - u n) \\<longlonglongrightarrow> 0\"\n  shows \"convergent v\" \"lim v = lim u\"", "lemma dist_metric_completion_limit:\n  fixes x y::\"'a metric_completion\"\n  shows \"(\\<lambda>n. dist (rep_metric_completion x n) (rep_metric_completion y n)) \\<longlonglongrightarrow> dist x y\"", "lemma dist_metric_completion_limit':\n  fixes x y::\"nat \\<Rightarrow> 'a\"\n  assumes \"Cauchy x\" \"Cauchy y\"\n  shows \"(\\<lambda>n. dist (x n) (y n)) \\<longlonglongrightarrow> dist (abs_metric_completion x) (abs_metric_completion y)\"", "lemma to_metric_completion_isometry:\n  \"isometry_on UNIV to_metric_completion\"", "lemma to_metric_completion_dense:\n  assumes \"open U\" \"U \\<noteq> {}\"\n  shows \"\\<exists>x. to_metric_completion x \\<in> U\"", "lemma to_metric_completion_dense':\n  \"closure (range to_metric_completion) = UNIV\"", "lemma lift_to_metric_completion:\n  fixes f::\"('a::metric_space) \\<Rightarrow> ('b::complete_space)\"\n  assumes \"uniformly_continuous_on UNIV f\"\n  shows \"\\<exists>g. (uniformly_continuous_on UNIV g)\n            \\<and> (f = g o to_metric_completion)\n            \\<and> (\\<forall>x \\<in> range to_metric_completion. g x = f (inv to_metric_completion x))\"", "lemma lift_to_metric_completion_isometry:\n  fixes f::\"('a::metric_space) \\<Rightarrow> ('b::complete_space)\"\n  assumes \"isometry_on UNIV f\"\n  shows \"\\<exists>g. isometry_on UNIV g\n          \\<and> range g = closure(range f)\n          \\<and> f = g o to_metric_completion\n          \\<and> (\\<forall>x \\<in> range to_metric_completion. g x = f (inv to_metric_completion x))\"", "lemma second_countable_iff_dense_countable_subset:\n  \"(\\<exists>B::'a::metric_space set set. countable B \\<and> topological_basis B)\n    \\<longleftrightarrow> (\\<exists>A::'a set. countable A \\<and> closure A = UNIV)\"", "lemma second_countable_metric_dense_subset:\n  \"\\<exists>A::'a::{metric_space, second_countable_topology} set. countable A \\<and> closure A = UNIV\""], "translations": [["", "lemma convergent_Cauchy_dist:\n  fixes u v::\"nat \\<Rightarrow> ('a::metric_space)\"\n  assumes \"Cauchy u\" \"Cauchy v\"\n  shows \"convergent (\\<lambda>n. dist (u n) (v n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. convergent (\\<lambda>n. dist (u n) (v n))", "proof (rule real_Cauchy_convergent, intro CauchyI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "fix e::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "assume \"e > 0\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "obtain Nu where Nu: \"\\<forall>n \\<ge> Nu. \\<forall>m \\<ge> Nu. dist (u n) (u m) < e/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Nu.\n        \\<forall>n\\<ge>Nu.\n           \\<forall>m\\<ge>Nu. dist (u n) (u m) < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using assms(1)"], ["proof (prove)\nusing this:\n  Cauchy u\n\ngoal (1 subgoal):\n 1. (\\<And>Nu.\n        \\<forall>n\\<ge>Nu.\n           \\<forall>m\\<ge>Nu. dist (u n) (u m) < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (metis \\<open>0 < e\\<close> less_divide_eq_numeral1(1) metric_CauchyD mult_zero_left)"], ["proof (state)\nthis:\n  \\<forall>n\\<ge>Nu. \\<forall>m\\<ge>Nu. dist (u n) (u m) < e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "obtain Nv where Nv: \"\\<forall>n \\<ge> Nv. \\<forall>m \\<ge> Nv. dist (v n) (v m) < e/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Nv.\n        \\<forall>n\\<ge>Nv.\n           \\<forall>m\\<ge>Nv. dist (v n) (v m) < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using assms(2)"], ["proof (prove)\nusing this:\n  Cauchy v\n\ngoal (1 subgoal):\n 1. (\\<And>Nv.\n        \\<forall>n\\<ge>Nv.\n           \\<forall>m\\<ge>Nv. dist (v n) (v m) < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (metis \\<open>0 < e\\<close> less_divide_eq_numeral1(1) metric_CauchyD mult_zero_left)"], ["proof (state)\nthis:\n  \\<forall>n\\<ge>Nv. \\<forall>m\\<ge>Nv. dist (v n) (v m) < e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "define M where \"M = max Nu Nv\""], ["proof (state)\nthis:\n  M = max Nu Nv\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "{"], ["proof (state)\nthis:\n  M = max Nu Nv\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "fix n m"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "assume H: \"n \\<ge> M\" \"m \\<ge> M\""], ["proof (state)\nthis:\n  M \\<le> n\n  M \\<le> m\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "have *: \"dist (u n) (u m) < e/2\" \"dist (v n) (v m) < e/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u n) (u m) < e / 2 &&& dist (v n) (v m) < e / 2", "using Nu Nv H"], ["proof (prove)\nusing this:\n  \\<forall>n\\<ge>Nu. \\<forall>m\\<ge>Nu. dist (u n) (u m) < e / 2\n  \\<forall>n\\<ge>Nv. \\<forall>m\\<ge>Nv. dist (v n) (v m) < e / 2\n  M \\<le> n\n  M \\<le> m\n\ngoal (1 subgoal):\n 1. dist (u n) (u m) < e / 2 &&& dist (v n) (v m) < e / 2", "unfolding M_def"], ["proof (prove)\nusing this:\n  \\<forall>n\\<ge>Nu. \\<forall>m\\<ge>Nu. dist (u n) (u m) < e / 2\n  \\<forall>n\\<ge>Nv. \\<forall>m\\<ge>Nv. dist (v n) (v m) < e / 2\n  max Nu Nv \\<le> n\n  max Nu Nv \\<le> m\n\ngoal (1 subgoal):\n 1. dist (u n) (u m) < e / 2 &&& dist (v n) (v m) < e / 2", "by auto"], ["proof (state)\nthis:\n  dist (u n) (u m) < e / 2\n  dist (v n) (v m) < e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "have \"dist (u m) (v m) - dist (u n) (v n) \\<le> dist (u m) (u n) + dist (v n) (v m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u m) (v m) - dist (u n) (v n)\n    \\<le> dist (u m) (u n) + dist (v n) (v m)", "by (simp add: algebra_simps) (metis add_le_cancel_left dist_commute dist_triangle2 dist_triangle_le)"], ["proof (state)\nthis:\n  dist (u m) (v m) - dist (u n) (v n)\n  \\<le> dist (u m) (u n) + dist (v n) (v m)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "also"], ["proof (state)\nthis:\n  dist (u m) (v m) - dist (u n) (v n)\n  \\<le> dist (u m) (u n) + dist (v n) (v m)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "have \"... < e/2 + e/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u m) (u n) + dist (v n) (v m) < e / 2 + e / 2", "using *"], ["proof (prove)\nusing this:\n  dist (u n) (u m) < e / 2\n  dist (v n) (v m) < e / 2\n\ngoal (1 subgoal):\n 1. dist (u m) (u n) + dist (v n) (v m) < e / 2 + e / 2", "by (simp add: dist_commute)"], ["proof (state)\nthis:\n  dist (u m) (u n) + dist (v n) (v m) < e / 2 + e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "finally"], ["proof (chain)\npicking this:\n  dist (u m) (v m) - dist (u n) (v n) < e / 2 + e / 2", "have A: \"dist (u m) (v m) - dist (u n) (v n) < e\""], ["proof (prove)\nusing this:\n  dist (u m) (v m) - dist (u n) (v n) < e / 2 + e / 2\n\ngoal (1 subgoal):\n 1. dist (u m) (v m) - dist (u n) (v n) < e", "by simp"], ["proof (state)\nthis:\n  dist (u m) (v m) - dist (u n) (v n) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "have \"dist (u n) (v n) - dist (u m) (v m) \\<le> dist (u m) (u n) + dist (v n) (v m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u n) (v n) - dist (u m) (v m)\n    \\<le> dist (u m) (u n) + dist (v n) (v m)", "by (simp add: algebra_simps) (metis add_le_cancel_left dist_commute dist_triangle2 dist_triangle_le)"], ["proof (state)\nthis:\n  dist (u n) (v n) - dist (u m) (v m)\n  \\<le> dist (u m) (u n) + dist (v n) (v m)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "also"], ["proof (state)\nthis:\n  dist (u n) (v n) - dist (u m) (v m)\n  \\<le> dist (u m) (u n) + dist (v n) (v m)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "have \"... < e/2 + e/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u m) (u n) + dist (v n) (v m) < e / 2 + e / 2", "using *"], ["proof (prove)\nusing this:\n  dist (u n) (u m) < e / 2\n  dist (v n) (v m) < e / 2\n\ngoal (1 subgoal):\n 1. dist (u m) (u n) + dist (v n) (v m) < e / 2 + e / 2", "by (simp add: dist_commute)"], ["proof (state)\nthis:\n  dist (u m) (u n) + dist (v n) (v m) < e / 2 + e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "finally"], ["proof (chain)\npicking this:\n  dist (u n) (v n) - dist (u m) (v m) < e / 2 + e / 2", "have \"dist (u n) (v n) - dist (u m) (v m) < e\""], ["proof (prove)\nusing this:\n  dist (u n) (v n) - dist (u m) (v m) < e / 2 + e / 2\n\ngoal (1 subgoal):\n 1. dist (u n) (v n) - dist (u m) (v m) < e", "by simp"], ["proof (state)\nthis:\n  dist (u n) (v n) - dist (u m) (v m) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "then"], ["proof (chain)\npicking this:\n  dist (u n) (v n) - dist (u m) (v m) < e", "have \"norm(dist (u m) (v m) - dist (u n) (v n)) < e\""], ["proof (prove)\nusing this:\n  dist (u n) (v n) - dist (u m) (v m) < e\n\ngoal (1 subgoal):\n 1. norm (dist (u m) (v m) - dist (u n) (v n)) < e", "using A"], ["proof (prove)\nusing this:\n  dist (u n) (v n) - dist (u m) (v m) < e\n  dist (u m) (v m) - dist (u n) (v n) < e\n\ngoal (1 subgoal):\n 1. norm (dist (u m) (v m) - dist (u n) (v n)) < e", "by auto"], ["proof (state)\nthis:\n  norm (dist (u m) (v m) - dist (u n) (v n)) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "}"], ["proof (state)\nthis:\n  \\<lbrakk>M \\<le> ?n2; M \\<le> ?m2\\<rbrakk>\n  \\<Longrightarrow> norm (dist (u ?m2) (v ?m2) - dist (u ?n2) (v ?n2)) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                norm (dist (u m) (v m) - dist (u n) (v n)) < e", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>M \\<le> ?n2; M \\<le> ?m2\\<rbrakk>\n  \\<Longrightarrow> norm (dist (u ?m2) (v ?m2) - dist (u ?n2) (v ?n2)) < e", "show \"\\<exists>M. \\<forall>m \\<ge> M. \\<forall>n \\<ge> M. norm (dist (u m) (v m) - dist (u n) (v n)) < e\""], ["proof (prove)\nusing this:\n  \\<lbrakk>M \\<le> ?n2; M \\<le> ?m2\\<rbrakk>\n  \\<Longrightarrow> norm (dist (u ?m2) (v ?m2) - dist (u ?n2) (v ?n2)) < e\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       \\<forall>m\\<ge>M.\n          \\<forall>n\\<ge>M. norm (dist (u m) (v m) - dist (u n) (v n)) < e", "by auto"], ["proof (state)\nthis:\n  \\<exists>M.\n     \\<forall>m\\<ge>M.\n        \\<forall>n\\<ge>M. norm (dist (u m) (v m) - dist (u n) (v n)) < e\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma convergent_add_null:\n  fixes u v::\"nat \\<Rightarrow> ('a::real_normed_vector)\"\n  assumes \"convergent u\"\n          \"(\\<lambda>n. v n - u n) \\<longlonglongrightarrow> 0\"\n  shows \"convergent v\" \"lim v = lim u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. convergent v &&& lim v = lim u", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. convergent v\n 2. lim v = lim u", "have \"(\\<lambda>n. u n + (v n - u n)) \\<longlonglongrightarrow> lim u + 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. u n + (v n - u n))\n    \\<longlonglongrightarrow> lim u + (0::'a)", "apply (rule tendsto_add)"], ["proof (prove)\ngoal (2 subgoals):\n 1. u \\<longlonglongrightarrow> lim u\n 2. (\\<lambda>x. v x - u x) \\<longlonglongrightarrow> (0::'a)", "using assms convergent_LIMSEQ_iff"], ["proof (prove)\nusing this:\n  convergent u\n  (\\<lambda>n. v n - u n) \\<longlonglongrightarrow> (0::'a)\n  convergent ?X = ?X \\<longlonglongrightarrow> lim ?X\n\ngoal (2 subgoals):\n 1. u \\<longlonglongrightarrow> lim u\n 2. (\\<lambda>x. v x - u x) \\<longlonglongrightarrow> (0::'a)", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. u n + (v n - u n)) \\<longlonglongrightarrow> lim u + (0::'a)\n\ngoal (2 subgoals):\n 1. convergent v\n 2. lim v = lim u", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. u n + (v n - u n)) \\<longlonglongrightarrow> lim u + (0::'a)", "have *: \"v \\<longlonglongrightarrow> lim u\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. u n + (v n - u n)) \\<longlonglongrightarrow> lim u + (0::'a)\n\ngoal (1 subgoal):\n 1. v \\<longlonglongrightarrow> lim u", "by auto"], ["proof (state)\nthis:\n  v \\<longlonglongrightarrow> lim u\n\ngoal (2 subgoals):\n 1. convergent v\n 2. lim v = lim u", "show \"convergent v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. convergent v", "using *"], ["proof (prove)\nusing this:\n  v \\<longlonglongrightarrow> lim u\n\ngoal (1 subgoal):\n 1. convergent v", "by (simp add: Lim_def convergentI)"], ["proof (state)\nthis:\n  convergent v\n\ngoal (1 subgoal):\n 1. lim v = lim u", "show \"lim v = lim u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lim v = lim u", "using *"], ["proof (prove)\nusing this:\n  v \\<longlonglongrightarrow> lim u\n\ngoal (1 subgoal):\n 1. lim v = lim u", "by (simp add: limI)"], ["proof (state)\nthis:\n  lim v = lim u\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Let us now prove that the metric completion is a metric space: the distance between two\nCauchy sequences is the limit of the distances of points in the sequence. The convergence follows\nfrom Lemma~\\verb+convergent_Cauchy_dist+ above.\\<close>"], ["", "instantiation metric_completion :: (metric_space) metric_space\nbegin"], ["", "lift_definition dist_metric_completion::\"('a::metric_space) metric_completion \\<Rightarrow> 'a metric_completion \\<Rightarrow> real\"\n  is \"\\<lambda>x y. lim (\\<lambda>n. dist (x n) (y n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>fun1 fun2 fun3 fun4.\n       \\<lbrakk>Cauchy fun1 \\<and>\n                Cauchy fun2 \\<and>\n                (\\<lambda>n. dist (fun1 n) (fun2 n))\n                \\<longlonglongrightarrow> 0;\n        Cauchy fun3 \\<and>\n        Cauchy fun4 \\<and>\n        (\\<lambda>n. dist (fun3 n) (fun4 n))\n        \\<longlonglongrightarrow> 0\\<rbrakk>\n       \\<Longrightarrow> lim (\\<lambda>n. dist (fun1 n) (fun3 n)) =\n                         lim (\\<lambda>n. dist (fun2 n) (fun4 n))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>fun1 fun2 fun3 fun4.\n       \\<lbrakk>Cauchy fun1 \\<and>\n                Cauchy fun2 \\<and>\n                (\\<lambda>n. dist (fun1 n) (fun2 n))\n                \\<longlonglongrightarrow> 0;\n        Cauchy fun3 \\<and>\n        Cauchy fun4 \\<and>\n        (\\<lambda>n. dist (fun3 n) (fun4 n))\n        \\<longlonglongrightarrow> 0\\<rbrakk>\n       \\<Longrightarrow> lim (\\<lambda>n. dist (fun1 n) (fun3 n)) =\n                         lim (\\<lambda>n. dist (fun2 n) (fun4 n))", "fix x y z t::\"nat \\<Rightarrow> 'a\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>fun1 fun2 fun3 fun4.\n       \\<lbrakk>Cauchy fun1 \\<and>\n                Cauchy fun2 \\<and>\n                (\\<lambda>n. dist (fun1 n) (fun2 n))\n                \\<longlonglongrightarrow> 0;\n        Cauchy fun3 \\<and>\n        Cauchy fun4 \\<and>\n        (\\<lambda>n. dist (fun3 n) (fun4 n))\n        \\<longlonglongrightarrow> 0\\<rbrakk>\n       \\<Longrightarrow> lim (\\<lambda>n. dist (fun1 n) (fun3 n)) =\n                         lim (\\<lambda>n. dist (fun2 n) (fun4 n))", "assume H: \"Cauchy x \\<and> Cauchy y \\<and> (\\<lambda>n. dist (x n) (y n)) \\<longlonglongrightarrow> 0\"\n                                     \"Cauchy z \\<and> Cauchy t \\<and> (\\<lambda>n. dist (z n) (t n)) \\<longlonglongrightarrow> 0\""], ["proof (state)\nthis:\n  Cauchy x \\<and>\n  Cauchy y \\<and> (\\<lambda>n. dist (x n) (y n)) \\<longlonglongrightarrow> 0\n  Cauchy z \\<and>\n  Cauchy t \\<and> (\\<lambda>n. dist (z n) (t n)) \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<And>fun1 fun2 fun3 fun4.\n       \\<lbrakk>Cauchy fun1 \\<and>\n                Cauchy fun2 \\<and>\n                (\\<lambda>n. dist (fun1 n) (fun2 n))\n                \\<longlonglongrightarrow> 0;\n        Cauchy fun3 \\<and>\n        Cauchy fun4 \\<and>\n        (\\<lambda>n. dist (fun3 n) (fun4 n))\n        \\<longlonglongrightarrow> 0\\<rbrakk>\n       \\<Longrightarrow> lim (\\<lambda>n. dist (fun1 n) (fun3 n)) =\n                         lim (\\<lambda>n. dist (fun2 n) (fun4 n))", "show \"lim (\\<lambda>n. dist (x n) (z n)) = lim (\\<lambda>n. dist (y n) (t n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lim (\\<lambda>n. dist (x n) (z n)) = lim (\\<lambda>n. dist (y n) (t n))", "proof (rule convergent_add_null(2))"], ["proof (state)\ngoal (2 subgoals):\n 1. convergent (\\<lambda>n. dist (y n) (t n))\n 2. (\\<lambda>n. dist (x n) (z n) - dist (y n) (t n))\n    \\<longlonglongrightarrow> 0", "show \"convergent (\\<lambda>n. dist (y n) (t n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. convergent (\\<lambda>n. dist (y n) (t n))", "apply (rule convergent_Cauchy_dist)"], ["proof (prove)\ngoal (2 subgoals):\n 1. Cauchy y\n 2. Cauchy t", "using H"], ["proof (prove)\nusing this:\n  Cauchy x \\<and>\n  Cauchy y \\<and> (\\<lambda>n. dist (x n) (y n)) \\<longlonglongrightarrow> 0\n  Cauchy z \\<and>\n  Cauchy t \\<and> (\\<lambda>n. dist (z n) (t n)) \\<longlonglongrightarrow> 0\n\ngoal (2 subgoals):\n 1. Cauchy y\n 2. Cauchy t", "by auto"], ["proof (state)\nthis:\n  convergent (\\<lambda>n. dist (y n) (t n))\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist (x n) (z n) - dist (y n) (t n))\n    \\<longlonglongrightarrow> 0", "have a: \"(\\<lambda>n. - dist (t n) (z n) - dist (x n) (y n)) \\<longlonglongrightarrow> -0 -0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. - dist (t n) (z n) - dist (x n) (y n))\n    \\<longlonglongrightarrow> - 0 - 0", "apply (intro tendsto_intros)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>x. dist (t x) (z x)) \\<longlonglongrightarrow> 0\n 2. (\\<lambda>xa. dist (x xa) (y xa)) \\<longlonglongrightarrow> 0", "using H"], ["proof (prove)\nusing this:\n  Cauchy x \\<and>\n  Cauchy y \\<and> (\\<lambda>n. dist (x n) (y n)) \\<longlonglongrightarrow> 0\n  Cauchy z \\<and>\n  Cauchy t \\<and> (\\<lambda>n. dist (z n) (t n)) \\<longlonglongrightarrow> 0\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. dist (t x) (z x)) \\<longlonglongrightarrow> 0\n 2. (\\<lambda>xa. dist (x xa) (y xa)) \\<longlonglongrightarrow> 0", "by (auto simp add: dist_commute)"], ["proof (state)\nthis:\n  (\\<lambda>n. - dist (t n) (z n) - dist (x n) (y n))\n  \\<longlonglongrightarrow> - 0 - 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist (x n) (z n) - dist (y n) (t n))\n    \\<longlonglongrightarrow> 0", "have b:\"(\\<lambda>n. dist (t n) (z n) + dist (x n) (y n)) \\<longlonglongrightarrow> 0 + 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist (t n) (z n) + dist (x n) (y n))\n    \\<longlonglongrightarrow> 0 + 0", "apply (rule tendsto_add)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>x. dist (t x) (z x)) \\<longlonglongrightarrow> 0\n 2. (\\<lambda>xa. dist (x xa) (y xa)) \\<longlonglongrightarrow> 0", "using H"], ["proof (prove)\nusing this:\n  Cauchy x \\<and>\n  Cauchy y \\<and> (\\<lambda>n. dist (x n) (y n)) \\<longlonglongrightarrow> 0\n  Cauchy z \\<and>\n  Cauchy t \\<and> (\\<lambda>n. dist (z n) (t n)) \\<longlonglongrightarrow> 0\n\ngoal (2 subgoals):\n 1. (\\<lambda>x. dist (t x) (z x)) \\<longlonglongrightarrow> 0\n 2. (\\<lambda>xa. dist (x xa) (y xa)) \\<longlonglongrightarrow> 0", "by (auto simp add: dist_commute)"], ["proof (state)\nthis:\n  (\\<lambda>n. dist (t n) (z n) + dist (x n) (y n))\n  \\<longlonglongrightarrow> 0 + 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist (x n) (z n) - dist (y n) (t n))\n    \\<longlonglongrightarrow> 0", "have I: \"dist (x n) (z n) \\<le> dist (t n) (y n) + (dist (t n) (z n) + dist (x n) (y n))\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (x n) (z n)\n    \\<le> dist (t n) (y n) + (dist (t n) (z n) + dist (x n) (y n))", "using dist_triangle[of \"x n\" \"z n\" \"y n\"] dist_triangle[of \"y n\" \"z n\" \"t n\"]"], ["proof (prove)\nusing this:\n  dist (x n) (z n) \\<le> dist (x n) (y n) + dist (y n) (z n)\n  dist (y n) (z n) \\<le> dist (y n) (t n) + dist (t n) (z n)\n\ngoal (1 subgoal):\n 1. dist (x n) (z n)\n    \\<le> dist (t n) (y n) + (dist (t n) (z n) + dist (x n) (y n))", "by (auto simp add: dist_commute add.commute)"], ["proof (state)\nthis:\n  dist (x ?n) (z ?n)\n  \\<le> dist (t ?n) (y ?n) + (dist (t ?n) (z ?n) + dist (x ?n) (y ?n))\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist (x n) (z n) - dist (y n) (t n))\n    \\<longlonglongrightarrow> 0", "show \"(\\<lambda>n. dist (x n) (z n) - dist (y n) (t n)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist (x n) (z n) - dist (y n) (t n))\n    \\<longlonglongrightarrow> 0", "apply (rule tendsto_sandwich[of \"\\<lambda>n. -(dist (x n) (y n) + dist (z n) (t n))\" _ _ \"\\<lambda>n. dist (x n) (y n) + dist (z n) (t n)\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       - (dist (x n) (y n) + dist (z n) (t n))\n       \\<le> dist (x n) (z n) - dist (y n) (t n)\n 2. \\<forall>\\<^sub>F n in sequentially.\n       dist (x n) (z n) - dist (y n) (t n)\n       \\<le> dist (x n) (y n) + dist (z n) (t n)\n 3. (\\<lambda>n. - (dist (x n) (y n) + dist (z n) (t n)))\n    \\<longlonglongrightarrow> 0\n 4. (\\<lambda>n. dist (x n) (y n) + dist (z n) (t n))\n    \\<longlonglongrightarrow> 0", "apply (auto intro!: always_eventually simp add: algebra_simps dist_commute I)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa.\n       dist (t xa) (y xa)\n       \\<le> dist (t xa) (z xa) + (dist (x xa) (y xa) + dist (x xa) (z xa))\n 2. (\\<lambda>n. - dist (t n) (z n) - dist (x n) (y n))\n    \\<longlonglongrightarrow> 0\n 3. (\\<lambda>n. dist (t n) (z n) + dist (x n) (y n))\n    \\<longlonglongrightarrow> 0", "apply (meson add_left_mono dist_triangle3 dist_triangle_le)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>n. - dist (t n) (z n) - dist (x n) (y n))\n    \\<longlonglongrightarrow> 0\n 2. (\\<lambda>n. dist (t n) (z n) + dist (x n) (y n))\n    \\<longlonglongrightarrow> 0", "using a b"], ["proof (prove)\nusing this:\n  (\\<lambda>n. - dist (t n) (z n) - dist (x n) (y n))\n  \\<longlonglongrightarrow> - 0 - 0\n  (\\<lambda>n. dist (t n) (z n) + dist (x n) (y n))\n  \\<longlonglongrightarrow> 0 + 0\n\ngoal (2 subgoals):\n 1. (\\<lambda>n. - dist (t n) (z n) - dist (x n) (y n))\n    \\<longlonglongrightarrow> 0\n 2. (\\<lambda>n. dist (t n) (z n) + dist (x n) (y n))\n    \\<longlonglongrightarrow> 0", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. dist (x n) (z n) - dist (y n) (t n))\n  \\<longlonglongrightarrow> 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  lim (\\<lambda>n. dist (x n) (z n)) = lim (\\<lambda>n. dist (y n) (t n))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma dist_metric_completion_limit:\n  fixes x y::\"'a metric_completion\"\n  shows \"(\\<lambda>n. dist (rep_metric_completion x n) (rep_metric_completion y n)) \\<longlonglongrightarrow> dist x y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist x y", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist x y", "have C: \"Cauchy (rep_metric_completion x)\" \"Cauchy (rep_metric_completion y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Cauchy (rep_metric_completion x) &&& Cauchy (rep_metric_completion y)", "using Quotient3_metric_completion Quotient3_rep_reflp"], ["proof (prove)\nusing this:\n  Quotient3\n   (\\<lambda>u v.\n       Cauchy u \\<and>\n       Cauchy v \\<and>\n       (\\<lambda>n. dist (u n) (v n)) \\<longlonglongrightarrow> 0)\n   abs_metric_completion rep_metric_completion\n  Quotient3 ?R ?Abs ?Rep \\<Longrightarrow> ?R (?Rep ?a) (?Rep ?a)\n\ngoal (1 subgoal):\n 1. Cauchy (rep_metric_completion x) &&& Cauchy (rep_metric_completion y)", "by fastforce+"], ["proof (state)\nthis:\n  Cauchy (rep_metric_completion x)\n  Cauchy (rep_metric_completion y)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist x y", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist x y", "unfolding dist_metric_completion_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion y n))\n    \\<longlonglongrightarrow> map_fun rep_metric_completion\n                               (map_fun rep_metric_completion id)\n                               (\\<lambda>x y.\n                                   lim (\\<lambda>n. dist (x n) (y n)))\n                               x y", "using C"], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion x)\n  Cauchy (rep_metric_completion y)\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion y n))\n    \\<longlonglongrightarrow> map_fun rep_metric_completion\n                               (map_fun rep_metric_completion id)\n                               (\\<lambda>x y.\n                                   lim (\\<lambda>n. dist (x n) (y n)))\n                               x y", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Cauchy (rep_metric_completion x);\n     Cauchy (rep_metric_completion y)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>n.\n                          dist (rep_metric_completion x n)\n                           (rep_metric_completion y n))\n                      \\<longlonglongrightarrow> lim\n           (\\<lambda>n.\n               dist (rep_metric_completion x n) (rep_metric_completion y n))", "using convergent_Cauchy_dist[OF C] convergent_LIMSEQ_iff"], ["proof (prove)\nusing this:\n  convergent\n   (\\<lambda>n.\n       dist (rep_metric_completion x n) (rep_metric_completion y n))\n  convergent ?X = ?X \\<longlonglongrightarrow> lim ?X\n\ngoal (1 subgoal):\n 1. \\<lbrakk>Cauchy (rep_metric_completion x);\n     Cauchy (rep_metric_completion y)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>n.\n                          dist (rep_metric_completion x n)\n                           (rep_metric_completion y n))\n                      \\<longlonglongrightarrow> lim\n           (\\<lambda>n.\n               dist (rep_metric_completion x n) (rep_metric_completion y n))", "by force"], ["proof (state)\nthis:\n  (\\<lambda>n. dist (rep_metric_completion x n) (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist x y\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma dist_metric_completion_limit':\n  fixes x y::\"nat \\<Rightarrow> 'a\"\n  assumes \"Cauchy x\" \"Cauchy y\"\n  shows \"(\\<lambda>n. dist (x n) (y n)) \\<longlonglongrightarrow> dist (abs_metric_completion x) (abs_metric_completion y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist (x n) (y n))\n    \\<longlonglongrightarrow> dist (abs_metric_completion x)\n                               (abs_metric_completion y)", "apply (subst dist_metric_completion.abs_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. Cauchy x \\<and>\n    Cauchy x \\<and>\n    (\\<lambda>n. dist (x n) (x n)) \\<longlonglongrightarrow> 0\n 2. Cauchy y \\<and>\n    Cauchy y \\<and>\n    (\\<lambda>n. dist (y n) (y n)) \\<longlonglongrightarrow> 0\n 3. (\\<lambda>n. dist (x n) (y n))\n    \\<longlonglongrightarrow> lim (\\<lambda>n. dist (x n) (y n))", "using assms convergent_Cauchy_dist[OF assms]"], ["proof (prove)\nusing this:\n  Cauchy x\n  Cauchy y\n  convergent (\\<lambda>n. dist (x n) (y n))\n\ngoal (3 subgoals):\n 1. Cauchy x \\<and>\n    Cauchy x \\<and>\n    (\\<lambda>n. dist (x n) (x n)) \\<longlonglongrightarrow> 0\n 2. Cauchy y \\<and>\n    Cauchy y \\<and>\n    (\\<lambda>n. dist (y n) (y n)) \\<longlonglongrightarrow> 0\n 3. (\\<lambda>n. dist (x n) (y n))\n    \\<longlonglongrightarrow> lim (\\<lambda>n. dist (x n) (y n))", "by (auto simp add: convergent_LIMSEQ_iff)"], ["", "text \\<open>To define a metric space in the current library of Isabelle/HOL, one should also introduce\na uniformity structure and a topology, as follows (they are prescribed by the distance):\\<close>"], ["", "definition uniformity_metric_completion::\"(('a metric_completion) \\<times> ('a metric_completion)) filter\"\n  where \"uniformity_metric_completion = (INF e\\<in>{0 <..}. principal {(x, y). dist x y < e})\""], ["", "definition open_metric_completion :: \"'a metric_completion set \\<Rightarrow> bool\"\n  where \"open_metric_completion U = (\\<forall>x\\<in>U. eventually (\\<lambda>(x', y). x' = x \\<longrightarrow> y \\<in> U) uniformity)\""], ["", "instance"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a metric_completion, metric_space_class)", "proof"], ["proof (state)\ngoal (4 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)\n 3. \\<And>x y. (dist x y = 0) = (x = y)\n 4. \\<And>x y z. dist x y \\<le> dist x z + dist y z", "fix x y::\"'a metric_completion\""], ["proof (state)\ngoal (4 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)\n 3. \\<And>x y. (dist x y = 0) = (x = y)\n 4. \\<And>x y z. dist x y \\<le> dist x z + dist y z", "have C: \"Cauchy (rep_metric_completion x)\" \"Cauchy (rep_metric_completion y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Cauchy (rep_metric_completion x) &&& Cauchy (rep_metric_completion y)", "using Quotient3_metric_completion Quotient3_rep_reflp"], ["proof (prove)\nusing this:\n  Quotient3\n   (\\<lambda>u v.\n       Cauchy u \\<and>\n       Cauchy v \\<and>\n       (\\<lambda>n. dist (u n) (v n)) \\<longlonglongrightarrow> 0)\n   abs_metric_completion rep_metric_completion\n  Quotient3 ?R ?Abs ?Rep \\<Longrightarrow> ?R (?Rep ?a) (?Rep ?a)\n\ngoal (1 subgoal):\n 1. Cauchy (rep_metric_completion x) &&& Cauchy (rep_metric_completion y)", "by fastforce+"], ["proof (state)\nthis:\n  Cauchy (rep_metric_completion x)\n  Cauchy (rep_metric_completion y)\n\ngoal (4 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)\n 3. \\<And>x y. (dist x y = 0) = (x = y)\n 4. \\<And>x y z. dist x y \\<le> dist x z + dist y z", "show \"(dist x y = 0) = (x = y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (dist x y = 0) = (x = y)", "apply (subst Quotient3_rel_rep[OF Quotient3_metric_completion, symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. (dist x y = 0) =\n    (Cauchy (rep_metric_completion x) \\<and>\n     Cauchy (rep_metric_completion y) \\<and>\n     (\\<lambda>n.\n         dist (rep_metric_completion x n) (rep_metric_completion y n))\n     \\<longlonglongrightarrow> 0)", "unfolding dist_metric_completion_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (map_fun rep_metric_completion (map_fun rep_metric_completion id)\n      (\\<lambda>x y. lim (\\<lambda>n. dist (x n) (y n))) x y =\n     0) =\n    (Cauchy (rep_metric_completion x) \\<and>\n     Cauchy (rep_metric_completion y) \\<and>\n     (\\<lambda>n.\n         dist (rep_metric_completion x n) (rep_metric_completion y n))\n     \\<longlonglongrightarrow> 0)", "using C"], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion x)\n  Cauchy (rep_metric_completion y)\n\ngoal (1 subgoal):\n 1. (map_fun rep_metric_completion (map_fun rep_metric_completion id)\n      (\\<lambda>x y. lim (\\<lambda>n. dist (x n) (y n))) x y =\n     0) =\n    (Cauchy (rep_metric_completion x) \\<and>\n     Cauchy (rep_metric_completion y) \\<and>\n     (\\<lambda>n.\n         dist (rep_metric_completion x n) (rep_metric_completion y n))\n     \\<longlonglongrightarrow> 0)", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Cauchy (rep_metric_completion x);\n     Cauchy (rep_metric_completion y);\n     lim (\\<lambda>n.\n             dist (rep_metric_completion x n) (rep_metric_completion y n)) =\n     0\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>n.\n                          dist (rep_metric_completion x n)\n                           (rep_metric_completion y n))\n                      \\<longlonglongrightarrow> 0\n 2. \\<lbrakk>Cauchy (rep_metric_completion x);\n     Cauchy (rep_metric_completion y);\n     (\\<lambda>n.\n         dist (rep_metric_completion x n) (rep_metric_completion y n))\n     \\<longlonglongrightarrow> 0\\<rbrakk>\n    \\<Longrightarrow> lim (\\<lambda>n.\n                              dist (rep_metric_completion x n)\n                               (rep_metric_completion y n)) =\n                      0", "using convergent_Cauchy_dist[OF C] convergent_LIMSEQ_iff"], ["proof (prove)\nusing this:\n  convergent\n   (\\<lambda>n.\n       dist (rep_metric_completion x n) (rep_metric_completion y n))\n  convergent ?X = ?X \\<longlonglongrightarrow> lim ?X\n\ngoal (2 subgoals):\n 1. \\<lbrakk>Cauchy (rep_metric_completion x);\n     Cauchy (rep_metric_completion y);\n     lim (\\<lambda>n.\n             dist (rep_metric_completion x n) (rep_metric_completion y n)) =\n     0\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>n.\n                          dist (rep_metric_completion x n)\n                           (rep_metric_completion y n))\n                      \\<longlonglongrightarrow> 0\n 2. \\<lbrakk>Cauchy (rep_metric_completion x);\n     Cauchy (rep_metric_completion y);\n     (\\<lambda>n.\n         dist (rep_metric_completion x n) (rep_metric_completion y n))\n     \\<longlonglongrightarrow> 0\\<rbrakk>\n    \\<Longrightarrow> lim (\\<lambda>n.\n                              dist (rep_metric_completion x n)\n                               (rep_metric_completion y n)) =\n                      0", "apply force"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Cauchy (rep_metric_completion x);\n     Cauchy (rep_metric_completion y);\n     (\\<lambda>n.\n         dist (rep_metric_completion x n) (rep_metric_completion y n))\n     \\<longlonglongrightarrow> 0\\<rbrakk>\n    \\<Longrightarrow> lim (\\<lambda>n.\n                              dist (rep_metric_completion x n)\n                               (rep_metric_completion y n)) =\n                      0", "by (simp add: limI)"], ["proof (state)\nthis:\n  (dist x y = 0) = (x = y)\n\ngoal (3 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)\n 3. \\<And>x y z. dist x y \\<le> dist x z + dist y z", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)\n 3. \\<And>x y z. dist x y \\<le> dist x z + dist y z", "fix x y z::\"'a metric_completion\""], ["proof (state)\ngoal (3 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)\n 3. \\<And>x y z. dist x y \\<le> dist x z + dist y z", "have a: \"(\\<lambda>n. dist (rep_metric_completion x n) (rep_metric_completion y n)) \\<longlonglongrightarrow> dist x y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist x y", "using dist_metric_completion_limit"], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      dist (rep_metric_completion ?x n) (rep_metric_completion ?y n))\n  \\<longlonglongrightarrow> dist ?x ?y\n\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist x y", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. dist (rep_metric_completion x n) (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist x y\n\ngoal (3 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)\n 3. \\<And>x y z. dist x y \\<le> dist x z + dist y z", "have b: \"(\\<lambda>n. dist (rep_metric_completion x n) (rep_metric_completion z n) + dist (rep_metric_completion y n) (rep_metric_completion z n))\n      \\<longlonglongrightarrow> dist x z + dist y z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n.\n        dist (rep_metric_completion x n) (rep_metric_completion z n) +\n        dist (rep_metric_completion y n) (rep_metric_completion z n))\n    \\<longlonglongrightarrow> dist x z + dist y z", "apply (rule tendsto_add)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>xa.\n        dist (rep_metric_completion x xa) (rep_metric_completion z xa))\n    \\<longlonglongrightarrow> dist x z\n 2. (\\<lambda>x.\n        dist (rep_metric_completion y x) (rep_metric_completion z x))\n    \\<longlonglongrightarrow> dist y z", "using dist_metric_completion_limit"], ["proof (prove)\nusing this:\n  (\\<lambda>n.\n      dist (rep_metric_completion ?x n) (rep_metric_completion ?y n))\n  \\<longlonglongrightarrow> dist ?x ?y\n\ngoal (2 subgoals):\n 1. (\\<lambda>xa.\n        dist (rep_metric_completion x xa) (rep_metric_completion z xa))\n    \\<longlonglongrightarrow> dist x z\n 2. (\\<lambda>x.\n        dist (rep_metric_completion y x) (rep_metric_completion z x))\n    \\<longlonglongrightarrow> dist y z", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n.\n      dist (rep_metric_completion x n) (rep_metric_completion z n) +\n      dist (rep_metric_completion y n) (rep_metric_completion z n))\n  \\<longlonglongrightarrow> dist x z + dist y z\n\ngoal (3 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)\n 3. \\<And>x y z. dist x y \\<le> dist x z + dist y z", "show \"dist x y \\<le> dist x z + dist y z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist x y \\<le> dist x z + dist y z", "by (rule LIMSEQ_le[OF a b], rule exI[of _ 0], auto simp add: dist_triangle2)"], ["proof (state)\nthis:\n  dist x y \\<le> dist x z + dist y z\n\ngoal (2 subgoals):\n 1. uniformity = (INF e\\<in>{0<..}. principal {(x, y). dist x y < e})\n 2. \\<And>U.\n       open U =\n       (\\<forall>x\\<in>U.\n           \\<forall>\\<^sub>F (x', y) in uniformity.\n              x' = x \\<longrightarrow> y \\<in> U)", "qed (auto simp add: uniformity_metric_completion_def open_metric_completion_def)"], ["", "end"], ["", "text \\<open>Let us now show that the distance thus defined on the metric completion is indeed complete.\nThis is essentially by design.\\<close>"], ["", "instance metric_completion :: (metric_space) complete_space"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a metric_completion, complete_space_class)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "fix X::\"nat \\<Rightarrow> 'a metric_completion\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "assume \"Cauchy X\""], ["proof (state)\nthis:\n  Cauchy X\n\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "have *: \"\\<exists>N. \\<forall>n \\<ge> N. dist (rep_metric_completion (X k) N) (rep_metric_completion (X k) n) < (1/Suc k)\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>n\\<ge>N.\n          dist (rep_metric_completion (X k) N)\n           (rep_metric_completion (X k) n)\n          < 1 / real (Suc k)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>n\\<ge>N.\n          dist (rep_metric_completion (X k) N)\n           (rep_metric_completion (X k) n)\n          < 1 / real (Suc k)", "have \"Cauchy (rep_metric_completion (X k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Cauchy (rep_metric_completion (X k))", "using Quotient3_metric_completion Quotient3_rep_reflp"], ["proof (prove)\nusing this:\n  Quotient3\n   (\\<lambda>u v.\n       Cauchy u \\<and>\n       Cauchy v \\<and>\n       (\\<lambda>n. dist (u n) (v n)) \\<longlonglongrightarrow> 0)\n   abs_metric_completion rep_metric_completion\n  Quotient3 ?R ?Abs ?Rep \\<Longrightarrow> ?R (?Rep ?a) (?Rep ?a)\n\ngoal (1 subgoal):\n 1. Cauchy (rep_metric_completion (X k))", "by fastforce+"], ["proof (state)\nthis:\n  Cauchy (rep_metric_completion (X k))\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>n\\<ge>N.\n          dist (rep_metric_completion (X k) N)\n           (rep_metric_completion (X k) n)\n          < 1 / real (Suc k)", "then"], ["proof (chain)\npicking this:\n  Cauchy (rep_metric_completion (X k))", "have \"\\<exists>N. \\<forall>m \\<ge> N. \\<forall>n \\<ge> N. dist (rep_metric_completion (X k) m) (rep_metric_completion (X k) n) < (1/Suc k)\""], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion (X k))\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>m\\<ge>N.\n          \\<forall>n\\<ge>N.\n             dist (rep_metric_completion (X k) m)\n              (rep_metric_completion (X k) n)\n             < 1 / real (Suc k)", "unfolding Cauchy_def"], ["proof (prove)\nusing this:\n  \\<forall>e>0.\n     \\<exists>M.\n        \\<forall>m\\<ge>M.\n           \\<forall>n\\<ge>M.\n              dist (rep_metric_completion (X k) m)\n               (rep_metric_completion (X k) n)\n              < e\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>m\\<ge>N.\n          \\<forall>n\\<ge>N.\n             dist (rep_metric_completion (X k) m)\n              (rep_metric_completion (X k) n)\n             < 1 / real (Suc k)", "by auto"], ["proof (state)\nthis:\n  \\<exists>N.\n     \\<forall>m\\<ge>N.\n        \\<forall>n\\<ge>N.\n           dist (rep_metric_completion (X k) m)\n            (rep_metric_completion (X k) n)\n           < 1 / real (Suc k)\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>n\\<ge>N.\n          dist (rep_metric_completion (X k) N)\n           (rep_metric_completion (X k) n)\n          < 1 / real (Suc k)", "then"], ["proof (chain)\npicking this:\n  \\<exists>N.\n     \\<forall>m\\<ge>N.\n        \\<forall>n\\<ge>N.\n           dist (rep_metric_completion (X k) m)\n            (rep_metric_completion (X k) n)\n           < 1 / real (Suc k)", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>N.\n     \\<forall>m\\<ge>N.\n        \\<forall>n\\<ge>N.\n           dist (rep_metric_completion (X k) m)\n            (rep_metric_completion (X k) n)\n           < 1 / real (Suc k)\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>n\\<ge>N.\n          dist (rep_metric_completion (X k) N)\n           (rep_metric_completion (X k) n)\n          < 1 / real (Suc k)", "by auto"], ["proof (state)\nthis:\n  \\<exists>N.\n     \\<forall>n\\<ge>N.\n        dist (rep_metric_completion (X k) N) (rep_metric_completion (X k) n)\n        < 1 / real (Suc k)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>N.\n     \\<forall>n\\<ge>N.\n        dist (rep_metric_completion (X ?k) N)\n         (rep_metric_completion (X ?k) n)\n        < 1 / real (Suc ?k)\n\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "have \"\\<exists>N. \\<forall>k. \\<forall>n \\<ge> N k. dist (rep_metric_completion (X k) (N k)) (rep_metric_completion (X k) n) < (1/Suc k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>k n.\n          N k \\<le> n \\<longrightarrow>\n          dist (rep_metric_completion (X k) (N k))\n           (rep_metric_completion (X k) n)\n          < 1 / real (Suc k)", "apply (rule choice)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k.\n       \\<exists>y.\n          \\<forall>n\\<ge>y.\n             dist (rep_metric_completion (X k) y)\n              (rep_metric_completion (X k) n)\n             < 1 / real (Suc k)", "using *"], ["proof (prove)\nusing this:\n  \\<exists>N.\n     \\<forall>n\\<ge>N.\n        dist (rep_metric_completion (X ?k) N)\n         (rep_metric_completion (X ?k) n)\n        < 1 / real (Suc ?k)\n\ngoal (1 subgoal):\n 1. \\<forall>k.\n       \\<exists>y.\n          \\<forall>n\\<ge>y.\n             dist (rep_metric_completion (X k) y)\n              (rep_metric_completion (X k) n)\n             < 1 / real (Suc k)", "by auto"], ["proof (state)\nthis:\n  \\<exists>N.\n     \\<forall>k n.\n        N k \\<le> n \\<longrightarrow>\n        dist (rep_metric_completion (X k) (N k))\n         (rep_metric_completion (X k) n)\n        < 1 / real (Suc k)\n\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "then"], ["proof (chain)\npicking this:\n  \\<exists>N.\n     \\<forall>k n.\n        N k \\<le> n \\<longrightarrow>\n        dist (rep_metric_completion (X k) (N k))\n         (rep_metric_completion (X k) n)\n        < 1 / real (Suc k)", "obtain N::\"nat \\<Rightarrow> nat\" where\n    N: \"dist (rep_metric_completion (X k) (N k)) (rep_metric_completion (X k) n) < (1/Suc k)\" if \"n \\<ge> N k\" for n k"], ["proof (prove)\nusing this:\n  \\<exists>N.\n     \\<forall>k n.\n        N k \\<le> n \\<longrightarrow>\n        dist (rep_metric_completion (X k) (N k))\n         (rep_metric_completion (X k) n)\n        < 1 / real (Suc k)\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        (\\<And>n k.\n            N k \\<le> n \\<Longrightarrow>\n            dist (rep_metric_completion (X k) (N k))\n             (rep_metric_completion (X k) n)\n            < 1 / real (Suc k)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  N ?k \\<le> ?n \\<Longrightarrow>\n  dist (rep_metric_completion (X ?k) (N ?k))\n   (rep_metric_completion (X ?k) ?n)\n  < 1 / real (Suc ?k)\n\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "define u where \"u = (\\<lambda>k. rep_metric_completion (X k) (N k))\""], ["proof (state)\nthis:\n  u = (\\<lambda>k. rep_metric_completion (X k) (N k))\n\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "have \"Cauchy u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Cauchy u", "proof (rule metric_CauchyI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "fix e::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "assume \"e > 0\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "obtain K::nat where \"K > 4/e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>K. 4 / e < real K \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using reals_Archimedean2"], ["proof (prove)\nusing this:\n  \\<exists>n. ?x < of_nat n\n\ngoal (1 subgoal):\n 1. (\\<And>K. 4 / e < real K \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  4 / e < real K\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "obtain L::nat where L: \"\\<forall>m \\<ge> L. \\<forall>n \\<ge> L. dist (X m) (X n) < e/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>L.\n        \\<forall>m\\<ge>L.\n           \\<forall>n\\<ge>L. dist (X m) (X n) < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using metric_CauchyD[OF \\<open>Cauchy X\\<close>, of \"e/2\"] \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < e / 2 \\<Longrightarrow>\n  \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (X m) (X n) < e / 2\n  0 < e\n\ngoal (1 subgoal):\n 1. (\\<And>L.\n        \\<forall>m\\<ge>L.\n           \\<forall>n\\<ge>L. dist (X m) (X n) < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  \\<forall>m\\<ge>L. \\<forall>n\\<ge>L. dist (X m) (X n) < e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "{"], ["proof (state)\nthis:\n  \\<forall>m\\<ge>L. \\<forall>n\\<ge>L. dist (X m) (X n) < e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "fix m n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "assume \"m \\<ge> max K L\" \"n \\<ge> max K L\""], ["proof (state)\nthis:\n  max K L \\<le> m\n  max K L \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "then"], ["proof (chain)\npicking this:\n  max K L \\<le> m\n  max K L \\<le> n", "have \"dist (X m) (X n) < e/2\""], ["proof (prove)\nusing this:\n  max K L \\<le> m\n  max K L \\<le> n\n\ngoal (1 subgoal):\n 1. dist (X m) (X n) < e / 2", "using L"], ["proof (prove)\nusing this:\n  max K L \\<le> m\n  max K L \\<le> n\n  \\<forall>m\\<ge>L. \\<forall>n\\<ge>L. dist (X m) (X n) < e / 2\n\ngoal (1 subgoal):\n 1. dist (X m) (X n) < e / 2", "by auto"], ["proof (state)\nthis:\n  dist (X m) (X n) < e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "then"], ["proof (chain)\npicking this:\n  dist (X m) (X n) < e / 2", "have \"eventually (\\<lambda>p. dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p) < e/2) sequentially\""], ["proof (prove)\nusing this:\n  dist (X m) (X n) < e / 2\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F p in sequentially.\n       dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p)\n       < e / 2", "using dist_metric_completion_limit[of \"X m\" \"X n\"]"], ["proof (prove)\nusing this:\n  dist (X m) (X n) < e / 2\n  (\\<lambda>na.\n      dist (rep_metric_completion (X m) na)\n       (rep_metric_completion (X n) na))\n  \\<longlonglongrightarrow> dist (X m) (X n)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F p in sequentially.\n       dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p)\n       < e / 2", "by (metis order_tendsto_iff)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F p in sequentially.\n     dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p)\n     < e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "then"], ["proof (chain)\npicking this:\n  \\<forall>\\<^sub>F p in sequentially.\n     dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p)\n     < e / 2", "obtain p where p: \"p \\<ge> max (N m) (N n)\" \"dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p) < e/2\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F p in sequentially.\n     dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p)\n     < e / 2\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>max (N m) (N n) \\<le> p;\n         dist (rep_metric_completion (X m) p)\n          (rep_metric_completion (X n) p)\n         < e / 2\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using eventually_False_sequentially eventually_elim2 eventually_ge_at_top"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F p in sequentially.\n     dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p)\n     < e / 2\n  \\<not> (\\<forall>\\<^sub>F n in sequentially. False)\n  \\<lbrakk>eventually ?P ?F; eventually ?Q ?F;\n   \\<And>i. \\<lbrakk>?P i; ?Q i\\<rbrakk> \\<Longrightarrow> ?R i\\<rbrakk>\n  \\<Longrightarrow> eventually ?R ?F\n  eventually ((\\<le>) ?c) at_top\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>max (N m) (N n) \\<le> p;\n         dist (rep_metric_completion (X m) p)\n          (rep_metric_completion (X n) p)\n         < e / 2\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  max (N m) (N n) \\<le> p\n  dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p)\n  < e / 2\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "have \"dist (u m) (rep_metric_completion (X m) p) < 1 / real (Suc m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u m) (rep_metric_completion (X m) p) < 1 / real (Suc m)", "unfolding u_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (rep_metric_completion (X m) (N m)) (rep_metric_completion (X m) p)\n    < 1 / real (Suc m)", "using N[of m p] p(1)"], ["proof (prove)\nusing this:\n  N m \\<le> p \\<Longrightarrow>\n  dist (rep_metric_completion (X m) (N m)) (rep_metric_completion (X m) p)\n  < 1 / real (Suc m)\n  max (N m) (N n) \\<le> p\n\ngoal (1 subgoal):\n 1. dist (rep_metric_completion (X m) (N m)) (rep_metric_completion (X m) p)\n    < 1 / real (Suc m)", "by auto"], ["proof (state)\nthis:\n  dist (u m) (rep_metric_completion (X m) p) < 1 / real (Suc m)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "also"], ["proof (state)\nthis:\n  dist (u m) (rep_metric_completion (X m) p) < 1 / real (Suc m)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "have \"... < e/4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / real (Suc m) < e / 4", "using \\<open>m \\<ge> max K L\\<close> \\<open>K > 4/e\\<close> \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  max K L \\<le> m\n  4 / e < real K\n  0 < e\n\ngoal (1 subgoal):\n 1. 1 / real (Suc m) < e / 4", "apply (auto simp add: divide_simps algebra_simps)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>4 < e * real K; 0 < e; K \\<le> m; L \\<le> m\\<rbrakk>\n    \\<Longrightarrow> 4 < e + e * real m", "by (metis leD le_less_trans less_add_same_cancel2 linear of_nat_le_iff mult_le_cancel_iff2)"], ["proof (state)\nthis:\n  1 / real (Suc m) < e / 4\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "finally"], ["proof (chain)\npicking this:\n  dist (u m) (rep_metric_completion (X m) p) < e / 4", "have Im: \"dist (u m) (rep_metric_completion (X m) p) < e/4\""], ["proof (prove)\nusing this:\n  dist (u m) (rep_metric_completion (X m) p) < e / 4\n\ngoal (1 subgoal):\n 1. dist (u m) (rep_metric_completion (X m) p) < e / 4", "by simp"], ["proof (state)\nthis:\n  dist (u m) (rep_metric_completion (X m) p) < e / 4\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "have \"dist (u n) (rep_metric_completion (X n) p) < 1 / real (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u n) (rep_metric_completion (X n) p) < 1 / real (Suc n)", "unfolding u_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (rep_metric_completion (X n) (N n)) (rep_metric_completion (X n) p)\n    < 1 / real (Suc n)", "using N[of n p] p(1)"], ["proof (prove)\nusing this:\n  N n \\<le> p \\<Longrightarrow>\n  dist (rep_metric_completion (X n) (N n)) (rep_metric_completion (X n) p)\n  < 1 / real (Suc n)\n  max (N m) (N n) \\<le> p\n\ngoal (1 subgoal):\n 1. dist (rep_metric_completion (X n) (N n)) (rep_metric_completion (X n) p)\n    < 1 / real (Suc n)", "by auto"], ["proof (state)\nthis:\n  dist (u n) (rep_metric_completion (X n) p) < 1 / real (Suc n)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "also"], ["proof (state)\nthis:\n  dist (u n) (rep_metric_completion (X n) p) < 1 / real (Suc n)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "have \"... < e/4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / real (Suc n) < e / 4", "using \\<open>n \\<ge> max K L\\<close> \\<open>K > 4/e\\<close> \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  max K L \\<le> n\n  4 / e < real K\n  0 < e\n\ngoal (1 subgoal):\n 1. 1 / real (Suc n) < e / 4", "apply (auto simp add: divide_simps algebra_simps)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>4 < e * real K; 0 < e; K \\<le> n; L \\<le> n\\<rbrakk>\n    \\<Longrightarrow> 4 < e + e * real n", "by (metis leD le_less_trans less_add_same_cancel2 linear of_nat_le_iff mult_le_cancel_iff2)"], ["proof (state)\nthis:\n  1 / real (Suc n) < e / 4\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "finally"], ["proof (chain)\npicking this:\n  dist (u n) (rep_metric_completion (X n) p) < e / 4", "have In: \"dist (u n) (rep_metric_completion (X n) p) < e/4\""], ["proof (prove)\nusing this:\n  dist (u n) (rep_metric_completion (X n) p) < e / 4\n\ngoal (1 subgoal):\n 1. dist (u n) (rep_metric_completion (X n) p) < e / 4", "by simp"], ["proof (state)\nthis:\n  dist (u n) (rep_metric_completion (X n) p) < e / 4\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "have \"dist (u m) (u n) \\<le> dist (u m) (rep_metric_completion (X m) p)\n          + dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p) + dist (rep_metric_completion (X n) p) (u n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u m) (u n)\n    \\<le> dist (u m) (rep_metric_completion (X m) p) +\n          dist (rep_metric_completion (X m) p)\n           (rep_metric_completion (X n) p) +\n          dist (rep_metric_completion (X n) p) (u n)", "by (metis add.commute add_left_mono dist_commute dist_triangle_le dist_triangle)"], ["proof (state)\nthis:\n  dist (u m) (u n)\n  \\<le> dist (u m) (rep_metric_completion (X m) p) +\n        dist (rep_metric_completion (X m) p)\n         (rep_metric_completion (X n) p) +\n        dist (rep_metric_completion (X n) p) (u n)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "also"], ["proof (state)\nthis:\n  dist (u m) (u n)\n  \\<le> dist (u m) (rep_metric_completion (X m) p) +\n        dist (rep_metric_completion (X m) p)\n         (rep_metric_completion (X n) p) +\n        dist (rep_metric_completion (X n) p) (u n)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "have \"... < e/4 + e/2 + e/4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u m) (rep_metric_completion (X m) p) +\n    dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p) +\n    dist (rep_metric_completion (X n) p) (u n)\n    < e / 4 + e / 2 + e / 4", "using In Im p(2)"], ["proof (prove)\nusing this:\n  dist (u n) (rep_metric_completion (X n) p) < e / 4\n  dist (u m) (rep_metric_completion (X m) p) < e / 4\n  dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p)\n  < e / 2\n\ngoal (1 subgoal):\n 1. dist (u m) (rep_metric_completion (X m) p) +\n    dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p) +\n    dist (rep_metric_completion (X n) p) (u n)\n    < e / 4 + e / 2 + e / 4", "by (simp add: dist_commute)"], ["proof (state)\nthis:\n  dist (u m) (rep_metric_completion (X m) p) +\n  dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p) +\n  dist (rep_metric_completion (X n) p) (u n)\n  < e / 4 + e / 2 + e / 4\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "also"], ["proof (state)\nthis:\n  dist (u m) (rep_metric_completion (X m) p) +\n  dist (rep_metric_completion (X m) p) (rep_metric_completion (X n) p) +\n  dist (rep_metric_completion (X n) p) (u n)\n  < e / 4 + e / 2 + e / 4\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "have \"... = e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e / 4 + e / 2 + e / 4 = e", "by auto"], ["proof (state)\nthis:\n  e / 4 + e / 2 + e / 4 = e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "finally"], ["proof (chain)\npicking this:\n  dist (u m) (u n) < e", "have \"dist (u m) (u n) < e\""], ["proof (prove)\nusing this:\n  dist (u m) (u n) < e\n\ngoal (1 subgoal):\n 1. dist (u m) (u n) < e", "by auto"], ["proof (state)\nthis:\n  dist (u m) (u n) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "}"], ["proof (state)\nthis:\n  \\<lbrakk>max K L \\<le> ?m2; max K L \\<le> ?n2\\<rbrakk>\n  \\<Longrightarrow> dist (u ?m2) (u ?n2) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>max K L \\<le> ?m2; max K L \\<le> ?n2\\<rbrakk>\n  \\<Longrightarrow> dist (u ?m2) (u ?n2) < e", "show \"\\<exists>M. \\<forall>m \\<ge> M. \\<forall>n \\<ge> M. dist (u m) (u n) < e\""], ["proof (prove)\nusing this:\n  \\<lbrakk>max K L \\<le> ?m2; max K L \\<le> ?n2\\<rbrakk>\n  \\<Longrightarrow> dist (u ?m2) (u ?n2) < e\n\ngoal (1 subgoal):\n 1. \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e", "by meson"], ["proof (state)\nthis:\n  \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Cauchy u\n\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "have *: \"(\\<lambda>n. dist (abs_metric_completion u) (X n)) \\<longlonglongrightarrow> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist (abs_metric_completion u) (X n))\n    \\<longlonglongrightarrow> 0", "proof (rule order_tendstoI, auto simp add: less_le_trans eventually_sequentially)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "fix e::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "assume \"e > 0\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "obtain K::nat where \"K > 4/e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>K. 4 / e < real K \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using reals_Archimedean2"], ["proof (prove)\nusing this:\n  \\<exists>n. ?x < of_nat n\n\ngoal (1 subgoal):\n 1. (\\<And>K. 4 / e < real K \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  4 / e < real K\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "obtain L::nat where L: \"\\<forall>m \\<ge> L. \\<forall>n \\<ge> L. dist (u m) (u n) < e/4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>L.\n        \\<forall>m\\<ge>L.\n           \\<forall>n\\<ge>L. dist (u m) (u n) < e / 4 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using metric_CauchyD[OF \\<open>Cauchy u\\<close>, of \"e/4\"] \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < e / 4 \\<Longrightarrow>\n  \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist (u m) (u n) < e / 4\n  0 < e\n\ngoal (1 subgoal):\n 1. (\\<And>L.\n        \\<forall>m\\<ge>L.\n           \\<forall>n\\<ge>L. dist (u m) (u n) < e / 4 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  \\<forall>m\\<ge>L. \\<forall>n\\<ge>L. dist (u m) (u n) < e / 4\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "{"], ["proof (state)\nthis:\n  \\<forall>m\\<ge>L. \\<forall>n\\<ge>L. dist (u m) (u n) < e / 4\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "assume n: \"n \\<ge> max K L\""], ["proof (state)\nthis:\n  max K L \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "{"], ["proof (state)\nthis:\n  max K L \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "fix p"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "assume p: \"p \\<ge> max (N n) L\""], ["proof (state)\nthis:\n  max (N n) L \\<le> p\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "have \"dist (u n) (rep_metric_completion (X n) p) < 1/(Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u n) (rep_metric_completion (X n) p) < 1 / real (Suc n)", "unfolding u_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (rep_metric_completion (X n) (N n)) (rep_metric_completion (X n) p)\n    < 1 / real (Suc n)", "using N p"], ["proof (prove)\nusing this:\n  N ?k \\<le> ?n \\<Longrightarrow>\n  dist (rep_metric_completion (X ?k) (N ?k))\n   (rep_metric_completion (X ?k) ?n)\n  < 1 / real (Suc ?k)\n  max (N n) L \\<le> p\n\ngoal (1 subgoal):\n 1. dist (rep_metric_completion (X n) (N n)) (rep_metric_completion (X n) p)\n    < 1 / real (Suc n)", "by simp"], ["proof (state)\nthis:\n  dist (u n) (rep_metric_completion (X n) p) < 1 / real (Suc n)\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "also"], ["proof (state)\nthis:\n  dist (u n) (rep_metric_completion (X n) p) < 1 / real (Suc n)\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "have \"... < e/4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / real (Suc n) < e / 4", "using \\<open>n \\<ge> max K L\\<close> \\<open>K > 4/e\\<close> \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  max K L \\<le> n\n  4 / e < real K\n  0 < e\n\ngoal (1 subgoal):\n 1. 1 / real (Suc n) < e / 4", "apply (auto simp add: divide_simps algebra_simps)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>4 < e * real K; 0 < e; K \\<le> n; L \\<le> n\\<rbrakk>\n    \\<Longrightarrow> 4 < e + e * real n", "by (metis leD le_less_trans less_add_same_cancel2 linear of_nat_le_iff mult_le_cancel_iff2)"], ["proof (state)\nthis:\n  1 / real (Suc n) < e / 4\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "finally"], ["proof (chain)\npicking this:\n  dist (u n) (rep_metric_completion (X n) p) < e / 4", "have *: \"dist (u n) (rep_metric_completion (X n) p) < e/4\""], ["proof (prove)\nusing this:\n  dist (u n) (rep_metric_completion (X n) p) < e / 4\n\ngoal (1 subgoal):\n 1. dist (u n) (rep_metric_completion (X n) p) < e / 4", "by fastforce"], ["proof (state)\nthis:\n  dist (u n) (rep_metric_completion (X n) p) < e / 4\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "have \"dist (u p) (rep_metric_completion (X n) p) \\<le> dist (u p) (u n) + dist (u n) (rep_metric_completion (X n) p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u p) (rep_metric_completion (X n) p)\n    \\<le> dist (u p) (u n) + dist (u n) (rep_metric_completion (X n) p)", "using dist_triangle"], ["proof (prove)\nusing this:\n  dist ?x ?z \\<le> dist ?x ?y + dist ?y ?z\n\ngoal (1 subgoal):\n 1. dist (u p) (rep_metric_completion (X n) p)\n    \\<le> dist (u p) (u n) + dist (u n) (rep_metric_completion (X n) p)", "by auto"], ["proof (state)\nthis:\n  dist (u p) (rep_metric_completion (X n) p)\n  \\<le> dist (u p) (u n) + dist (u n) (rep_metric_completion (X n) p)\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "also"], ["proof (state)\nthis:\n  dist (u p) (rep_metric_completion (X n) p)\n  \\<le> dist (u p) (u n) + dist (u n) (rep_metric_completion (X n) p)\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "have \"... < e/4 + e/4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (u p) (u n) + dist (u n) (rep_metric_completion (X n) p)\n    < e / 4 + e / 4", "using * L n p"], ["proof (prove)\nusing this:\n  dist (u n) (rep_metric_completion (X n) p) < e / 4\n  \\<forall>m\\<ge>L. \\<forall>n\\<ge>L. dist (u m) (u n) < e / 4\n  max K L \\<le> n\n  max (N n) L \\<le> p\n\ngoal (1 subgoal):\n 1. dist (u p) (u n) + dist (u n) (rep_metric_completion (X n) p)\n    < e / 4 + e / 4", "by force"], ["proof (state)\nthis:\n  dist (u p) (u n) + dist (u n) (rep_metric_completion (X n) p)\n  < e / 4 + e / 4\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "finally"], ["proof (chain)\npicking this:\n  dist (u p) (rep_metric_completion (X n) p) < e / 4 + e / 4", "have \"dist (u p) (rep_metric_completion (X n) p) \\<le> e/2\""], ["proof (prove)\nusing this:\n  dist (u p) (rep_metric_completion (X n) p) < e / 4 + e / 4\n\ngoal (1 subgoal):\n 1. dist (u p) (rep_metric_completion (X n) p) \\<le> e / 2", "by auto"], ["proof (state)\nthis:\n  dist (u p) (rep_metric_completion (X n) p) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "}"], ["proof (state)\nthis:\n  max (N n) L \\<le> ?p2 \\<Longrightarrow>\n  dist (u ?p2) (rep_metric_completion (X n) ?p2) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "then"], ["proof (chain)\npicking this:\n  max (N n) L \\<le> ?p2 \\<Longrightarrow>\n  dist (u ?p2) (rep_metric_completion (X n) ?p2) \\<le> e / 2", "have A: \"eventually (\\<lambda>p. dist (u p) (rep_metric_completion (X n) p) \\<le> e/2) sequentially\""], ["proof (prove)\nusing this:\n  max (N n) L \\<le> ?p2 \\<Longrightarrow>\n  dist (u ?p2) (rep_metric_completion (X n) ?p2) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F p in sequentially.\n       dist (u p) (rep_metric_completion (X n) p) \\<le> e / 2", "using eventually_at_top_linorder"], ["proof (prove)\nusing this:\n  max (N n) L \\<le> ?p2 \\<Longrightarrow>\n  dist (u ?p2) (rep_metric_completion (X n) ?p2) \\<le> e / 2\n  eventually ?P at_top = (\\<exists>N. \\<forall>n\\<ge>N. ?P n)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F p in sequentially.\n       dist (u p) (rep_metric_completion (X n) p) \\<le> e / 2", "by blast"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F p in sequentially.\n     dist (u p) (rep_metric_completion (X n) p) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "have B: \"(\\<lambda>p. dist (u p) (rep_metric_completion (X n) p)) \\<longlonglongrightarrow> dist (abs_metric_completion u) (X n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>p. dist (u p) (rep_metric_completion (X n) p))\n    \\<longlonglongrightarrow> dist (abs_metric_completion u) (X n)", "using dist_metric_completion_limit'[OF \\<open>Cauchy u\\<close>, of \"rep_metric_completion (X n)\"]"], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion (X n)) \\<Longrightarrow>\n  (\\<lambda>na. dist (u na) (rep_metric_completion (X n) na))\n  \\<longlonglongrightarrow> dist (abs_metric_completion u)\n                             (abs_metric_completion\n                               (rep_metric_completion (X n)))\n\ngoal (1 subgoal):\n 1. (\\<lambda>p. dist (u p) (rep_metric_completion (X n) p))\n    \\<longlonglongrightarrow> dist (abs_metric_completion u) (X n)", "unfolding Quotient3_abs_rep[OF Quotient3_metric_completion, of \"X n\"]"], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion (X n)) \\<Longrightarrow>\n  (\\<lambda>na. dist (u na) (rep_metric_completion (X n) na))\n  \\<longlonglongrightarrow> dist (abs_metric_completion u) (X n)\n\ngoal (1 subgoal):\n 1. (\\<lambda>p. dist (u p) (rep_metric_completion (X n) p))\n    \\<longlonglongrightarrow> dist (abs_metric_completion u) (X n)", "using Quotient3_rep_reflp[OF Quotient3_metric_completion]"], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion (X n)) \\<Longrightarrow>\n  (\\<lambda>na. dist (u na) (rep_metric_completion (X n) na))\n  \\<longlonglongrightarrow> dist (abs_metric_completion u) (X n)\n  Cauchy (rep_metric_completion ?a) \\<and>\n  Cauchy (rep_metric_completion ?a) \\<and>\n  (\\<lambda>n.\n      dist (rep_metric_completion ?a n) (rep_metric_completion ?a n))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>p. dist (u p) (rep_metric_completion (X n) p))\n    \\<longlonglongrightarrow> dist (abs_metric_completion u) (X n)", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>p. dist (u p) (rep_metric_completion (X n) p))\n  \\<longlonglongrightarrow> dist (abs_metric_completion u) (X n)\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "have \"dist (abs_metric_completion u) (X n) \\<le> e/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist (abs_metric_completion u) (X n) \\<le> e / 2", "apply (rule LIMSEQ_le_const2[OF B])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>na\\<ge>N.\n          dist (u na) (rep_metric_completion (X n) na) \\<le> e / 2", "using A"], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F p in sequentially.\n     dist (u p) (rep_metric_completion (X n) p) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>na\\<ge>N.\n          dist (u na) (rep_metric_completion (X n) na) \\<le> e / 2", "unfolding eventually_sequentially"], ["proof (prove)\nusing this:\n  \\<exists>N.\n     \\<forall>na\\<ge>N.\n        dist (u na) (rep_metric_completion (X n) na) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<exists>N.\n       \\<forall>na\\<ge>N.\n          dist (u na) (rep_metric_completion (X n) na) \\<le> e / 2", "by auto"], ["proof (state)\nthis:\n  dist (abs_metric_completion u) (X n) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "then"], ["proof (chain)\npicking this:\n  dist (abs_metric_completion u) (X n) \\<le> e / 2", "have \"dist (abs_metric_completion u) (X n) < e\""], ["proof (prove)\nusing this:\n  dist (abs_metric_completion u) (X n) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. dist (abs_metric_completion u) (X n) < e", "using \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  dist (abs_metric_completion u) (X n) \\<le> e / 2\n  0 < e\n\ngoal (1 subgoal):\n 1. dist (abs_metric_completion u) (X n) < e", "by auto"], ["proof (state)\nthis:\n  dist (abs_metric_completion u) (X n) < e\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "}"], ["proof (state)\nthis:\n  max K L \\<le> ?n2 \\<Longrightarrow>\n  dist (abs_metric_completion u) (X ?n2) < e\n\ngoal (1 subgoal):\n 1. \\<And>a.\n       0 < a \\<Longrightarrow>\n       \\<exists>N.\n          \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < a", "then"], ["proof (chain)\npicking this:\n  max K L \\<le> ?n2 \\<Longrightarrow>\n  dist (abs_metric_completion u) (X ?n2) < e", "show \"\\<exists>N. \\<forall>n \\<ge> N. dist (abs_metric_completion u) (X n) < e\""], ["proof (prove)\nusing this:\n  max K L \\<le> ?n2 \\<Longrightarrow>\n  dist (abs_metric_completion u) (X ?n2) < e\n\ngoal (1 subgoal):\n 1. \\<exists>N. \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < e", "by blast"], ["proof (state)\nthis:\n  \\<exists>N. \\<forall>n\\<ge>N. dist (abs_metric_completion u) (X n) < e\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>n. dist (abs_metric_completion u) (X n))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "have \"X \\<longlonglongrightarrow> abs_metric_completion u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<longlonglongrightarrow> abs_metric_completion u", "apply (rule tendstoI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<forall>\\<^sub>F x in sequentially.\n          dist (X x) (abs_metric_completion u) < e", "using *"], ["proof (prove)\nusing this:\n  (\\<lambda>n. dist (abs_metric_completion u) (X n))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<forall>\\<^sub>F x in sequentially.\n          dist (X x) (abs_metric_completion u) < e", "by (auto simp add: order_tendsto_iff dist_commute)"], ["proof (state)\nthis:\n  X \\<longlonglongrightarrow> abs_metric_completion u\n\ngoal (1 subgoal):\n 1. \\<And>X. Cauchy X \\<Longrightarrow> convergent X", "then"], ["proof (chain)\npicking this:\n  X \\<longlonglongrightarrow> abs_metric_completion u", "show \"convergent X\""], ["proof (prove)\nusing this:\n  X \\<longlonglongrightarrow> abs_metric_completion u\n\ngoal (1 subgoal):\n 1. convergent X", "unfolding convergent_def"], ["proof (prove)\nusing this:\n  X \\<longlonglongrightarrow> abs_metric_completion u\n\ngoal (1 subgoal):\n 1. \\<exists>L. X \\<longlonglongrightarrow> L", "by auto"], ["proof (state)\nthis:\n  convergent X\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Isometric embedding of a space in its metric completion\\<close>"], ["", "text \\<open>The canonical embedding of a space into its metric completion is obtained by taking\nthe Cauchy sequence which is constant, equal to the given point. This is indeed an isometric\nembedding with dense image, as we prove in the lemmas below.\\<close>"], ["", "definition to_metric_completion::\"('a::metric_space) \\<Rightarrow> 'a metric_completion\"\n  where \"to_metric_completion x = abs_metric_completion (\\<lambda>n. x)\""], ["", "lemma to_metric_completion_isometry:\n  \"isometry_on UNIV to_metric_completion\""], ["proof (prove)\ngoal (1 subgoal):\n 1. isometry_on UNIV to_metric_completion", "proof (rule isometry_onI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> UNIV; y \\<in> UNIV\\<rbrakk>\n       \\<Longrightarrow> dist (to_metric_completion x)\n                          (to_metric_completion y) =\n                         dist x y", "fix x y::'a"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> UNIV; y \\<in> UNIV\\<rbrakk>\n       \\<Longrightarrow> dist (to_metric_completion x)\n                          (to_metric_completion y) =\n                         dist x y", "have \"(\\<lambda>n. dist (x) (y)) \\<longlonglongrightarrow> dist (to_metric_completion x) (to_metric_completion y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist x y)\n    \\<longlonglongrightarrow> dist (to_metric_completion x)\n                               (to_metric_completion y)", "unfolding to_metric_completion_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist x y)\n    \\<longlonglongrightarrow> dist (abs_metric_completion (\\<lambda>n. x))\n                               (abs_metric_completion (\\<lambda>n. y))", "apply (rule dist_metric_completion_limit')"], ["proof (prove)\ngoal (2 subgoals):\n 1. Cauchy (\\<lambda>n. x)\n 2. Cauchy (\\<lambda>n. y)", "unfolding Cauchy_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>e>0.\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist x x < e\n 2. \\<forall>e>0.\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist y y < e", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. dist x y)\n  \\<longlonglongrightarrow> dist (to_metric_completion x)\n                             (to_metric_completion y)\n\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> UNIV; y \\<in> UNIV\\<rbrakk>\n       \\<Longrightarrow> dist (to_metric_completion x)\n                          (to_metric_completion y) =\n                         dist x y", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. dist x y)\n  \\<longlonglongrightarrow> dist (to_metric_completion x)\n                             (to_metric_completion y)", "show \"dist (to_metric_completion x) (to_metric_completion y) = dist x y\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. dist x y)\n  \\<longlonglongrightarrow> dist (to_metric_completion x)\n                             (to_metric_completion y)\n\ngoal (1 subgoal):\n 1. dist (to_metric_completion x) (to_metric_completion y) = dist x y", "by (simp add: LIMSEQ_const_iff)"], ["proof (state)\nthis:\n  dist (to_metric_completion x) (to_metric_completion y) = dist x y\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma to_metric_completion_dense:\n  assumes \"open U\" \"U \\<noteq> {}\"\n  shows \"\\<exists>x. to_metric_completion x \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "obtain y where \"y \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>y. y \\<in> U \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "using \\<open>U \\<noteq> {}\\<close>"], ["proof (prove)\nusing this:\n  U \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (\\<And>y. y \\<in> U \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  y \\<in> U\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "obtain e::real where e: \"e > 0\" \"\\<And>z. dist z y < e \\<Longrightarrow> z \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>e.\n        \\<lbrakk>0 < e;\n         \\<And>z. dist z y < e \\<Longrightarrow> z \\<in> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using \\<open>y \\<in> U\\<close> \\<open>open U\\<close>"], ["proof (prove)\nusing this:\n  y \\<in> U\n  open U\n\ngoal (1 subgoal):\n 1. (\\<And>e.\n        \\<lbrakk>0 < e;\n         \\<And>z. dist z y < e \\<Longrightarrow> z \\<in> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis open_dist)"], ["proof (state)\nthis:\n  0 < e\n  dist ?z y < e \\<Longrightarrow> ?z \\<in> U\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "have *: \"Cauchy (rep_metric_completion y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Cauchy (rep_metric_completion y)", "using Quotient3_metric_completion Quotient3_rep_reflp"], ["proof (prove)\nusing this:\n  Quotient3\n   (\\<lambda>u v.\n       Cauchy u \\<and>\n       Cauchy v \\<and>\n       (\\<lambda>n. dist (u n) (v n)) \\<longlonglongrightarrow> 0)\n   abs_metric_completion rep_metric_completion\n  Quotient3 ?R ?Abs ?Rep \\<Longrightarrow> ?R (?Rep ?a) (?Rep ?a)\n\ngoal (1 subgoal):\n 1. Cauchy (rep_metric_completion y)", "by fastforce"], ["proof (state)\nthis:\n  Cauchy (rep_metric_completion y)\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "then"], ["proof (chain)\npicking this:\n  Cauchy (rep_metric_completion y)", "obtain N where N: \"\\<forall>n \\<ge> N. \\<forall>m \\<ge> N. dist (rep_metric_completion y n) (rep_metric_completion y m) < e/2\""], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion y)\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        \\<forall>n\\<ge>N.\n           \\<forall>m\\<ge>N.\n              dist (rep_metric_completion y n) (rep_metric_completion y m)\n              < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using \\<open>e > 0\\<close>"], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion y)\n  0 < e\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        \\<forall>n\\<ge>N.\n           \\<forall>m\\<ge>N.\n              dist (rep_metric_completion y n) (rep_metric_completion y m)\n              < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "unfolding Cauchy_def"], ["proof (prove)\nusing this:\n  \\<forall>e>0.\n     \\<exists>M.\n        \\<forall>m\\<ge>M.\n           \\<forall>n\\<ge>M.\n              dist (rep_metric_completion y m) (rep_metric_completion y n)\n              < e\n  0 < e\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        \\<forall>n\\<ge>N.\n           \\<forall>m\\<ge>N.\n              dist (rep_metric_completion y n) (rep_metric_completion y m)\n              < e / 2 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (meson divide_pos_pos zero_less_numeral)"], ["proof (state)\nthis:\n  \\<forall>n\\<ge>N.\n     \\<forall>m\\<ge>N.\n        dist (rep_metric_completion y n) (rep_metric_completion y m) < e / 2\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "define x where \"x = rep_metric_completion y N\""], ["proof (state)\nthis:\n  x = rep_metric_completion y N\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "have \"(\\<lambda>n. dist x (rep_metric_completion y n)) \\<longlonglongrightarrow> dist (to_metric_completion x) (abs_metric_completion (rep_metric_completion y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist x (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist (to_metric_completion x)\n                               (abs_metric_completion\n                                 (rep_metric_completion y))", "unfolding to_metric_completion_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist x (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist (abs_metric_completion (\\<lambda>n. x))\n                               (abs_metric_completion\n                                 (rep_metric_completion y))", "apply (rule dist_metric_completion_limit')"], ["proof (prove)\ngoal (2 subgoals):\n 1. Cauchy (\\<lambda>n. x)\n 2. Cauchy (rep_metric_completion y)", "using *"], ["proof (prove)\nusing this:\n  Cauchy (rep_metric_completion y)\n\ngoal (2 subgoals):\n 1. Cauchy (\\<lambda>n. x)\n 2. Cauchy (rep_metric_completion y)", "unfolding Cauchy_def"], ["proof (prove)\nusing this:\n  \\<forall>e>0.\n     \\<exists>M.\n        \\<forall>m\\<ge>M.\n           \\<forall>n\\<ge>M.\n              dist (rep_metric_completion y m) (rep_metric_completion y n)\n              < e\n\ngoal (2 subgoals):\n 1. \\<forall>e>0.\n       \\<exists>M. \\<forall>m\\<ge>M. \\<forall>n\\<ge>M. dist x x < e\n 2. \\<forall>e>0.\n       \\<exists>M.\n          \\<forall>m\\<ge>M.\n             \\<forall>n\\<ge>M.\n                dist (rep_metric_completion y m) (rep_metric_completion y n)\n                < e", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x)\n                             (abs_metric_completion\n                               (rep_metric_completion y))\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "then"], ["proof (chain)\npicking this:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x)\n                             (abs_metric_completion\n                               (rep_metric_completion y))", "have \"(\\<lambda>n. dist x (rep_metric_completion y n)) \\<longlonglongrightarrow> dist (to_metric_completion x) y\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x)\n                             (abs_metric_completion\n                               (rep_metric_completion y))\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist x (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist (to_metric_completion x) y", "unfolding Quotient3_abs_rep[OF Quotient3_metric_completion]"], ["proof (prove)\nusing this:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x) y\n\ngoal (1 subgoal):\n 1. (\\<lambda>n. dist x (rep_metric_completion y n))\n    \\<longlonglongrightarrow> dist (to_metric_completion x) y", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x) y\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x) y\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "have \"eventually (\\<lambda>n. dist x (rep_metric_completion y n) \\<le> e/2) sequentially\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F n in sequentially.\n       dist x (rep_metric_completion y n) \\<le> e / 2", "unfolding eventually_sequentially x_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>Na.\n       \\<forall>n\\<ge>Na.\n          dist (rep_metric_completion y N) (rep_metric_completion y n)\n          \\<le> e / 2", "apply (rule exI[of _ N])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>n\\<ge>N.\n       dist (rep_metric_completion y N) (rep_metric_completion y n)\n       \\<le> e / 2", "using N less_imp_le"], ["proof (prove)\nusing this:\n  \\<forall>n\\<ge>N.\n     \\<forall>m\\<ge>N.\n        dist (rep_metric_completion y n) (rep_metric_completion y m) < e / 2\n  ?x < ?y \\<Longrightarrow> ?x \\<le> ?y\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<ge>N.\n       dist (rep_metric_completion y N) (rep_metric_completion y n)\n       \\<le> e / 2", "by auto"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F n in sequentially.\n     dist x (rep_metric_completion y n) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x) y\n  \\<forall>\\<^sub>F n in sequentially.\n     dist x (rep_metric_completion y n) \\<le> e / 2", "have \"dist (to_metric_completion x) y \\<le> e/2\""], ["proof (prove)\nusing this:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x) y\n  \\<forall>\\<^sub>F n in sequentially.\n     dist x (rep_metric_completion y n) \\<le> e / 2\n\ngoal (1 subgoal):\n 1. dist (to_metric_completion x) y \\<le> e / 2", "using LIMSEQ_le_const2"], ["proof (prove)\nusing this:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x) y\n  \\<forall>\\<^sub>F n in sequentially.\n     dist x (rep_metric_completion y n) \\<le> e / 2\n  \\<lbrakk>?X \\<longlonglongrightarrow> ?x;\n   \\<exists>N. \\<forall>n\\<ge>N. ?X n \\<le> ?a\\<rbrakk>\n  \\<Longrightarrow> ?x \\<le> ?a\n\ngoal (1 subgoal):\n 1. dist (to_metric_completion x) y \\<le> e / 2", "unfolding eventually_sequentially"], ["proof (prove)\nusing this:\n  (\\<lambda>n. dist x (rep_metric_completion y n))\n  \\<longlonglongrightarrow> dist (to_metric_completion x) y\n  \\<exists>N.\n     \\<forall>n\\<ge>N. dist x (rep_metric_completion y n) \\<le> e / 2\n  \\<lbrakk>?X \\<longlonglongrightarrow> ?x;\n   \\<exists>N. \\<forall>n\\<ge>N. ?X n \\<le> ?a\\<rbrakk>\n  \\<Longrightarrow> ?x \\<le> ?a\n\ngoal (1 subgoal):\n 1. dist (to_metric_completion x) y \\<le> e / 2", "by metis"], ["proof (state)\nthis:\n  dist (to_metric_completion x) y \\<le> e / 2\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "then"], ["proof (chain)\npicking this:\n  dist (to_metric_completion x) y \\<le> e / 2", "have \"to_metric_completion x \\<in> U\""], ["proof (prove)\nusing this:\n  dist (to_metric_completion x) y \\<le> e / 2\n\ngoal (1 subgoal):\n 1. to_metric_completion x \\<in> U", "using e"], ["proof (prove)\nusing this:\n  dist (to_metric_completion x) y \\<le> e / 2\n  0 < e\n  dist ?z y < e \\<Longrightarrow> ?z \\<in> U\n\ngoal (1 subgoal):\n 1. to_metric_completion x \\<in> U", "by auto"], ["proof (state)\nthis:\n  to_metric_completion x \\<in> U\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "then"], ["proof (chain)\npicking this:\n  to_metric_completion x \\<in> U", "show ?thesis"], ["proof (prove)\nusing this:\n  to_metric_completion x \\<in> U\n\ngoal (1 subgoal):\n 1. \\<exists>x. to_metric_completion x \\<in> U", "by auto"], ["proof (state)\nthis:\n  \\<exists>x. to_metric_completion x \\<in> U\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma to_metric_completion_dense':\n  \"closure (range to_metric_completion) = UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (range to_metric_completion) = UNIV", "apply (auto simp add: closure_iff_nhds_not_empty)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x A S.\n       \\<lbrakk>S \\<subseteq> A; open S; x \\<in> S;\n        range to_metric_completion \\<inter> A = {}\\<rbrakk>\n       \\<Longrightarrow> False", "using to_metric_completion_dense"], ["proof (prove)\nusing this:\n  \\<lbrakk>open ?U; ?U \\<noteq> {}\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x. to_metric_completion x \\<in> ?U\n\ngoal (1 subgoal):\n 1. \\<And>x A S.\n       \\<lbrakk>S \\<subseteq> A; open S; x \\<in> S;\n        range to_metric_completion \\<inter> A = {}\\<rbrakk>\n       \\<Longrightarrow> False", "by fastforce"], ["", "text \\<open>The main feature of the completion is that a uniformly continuous function on the original space can be extended\nto a uniformly continuous function on the completion, i.e., it can be written as the composition of\na new function and of the inclusion \\verb+to_metric_completion+.\\<close>"], ["", "lemma lift_to_metric_completion:\n  fixes f::\"('a::metric_space) \\<Rightarrow> ('b::complete_space)\"\n  assumes \"uniformly_continuous_on UNIV f\"\n  shows \"\\<exists>g. (uniformly_continuous_on UNIV g)\n            \\<and> (f = g o to_metric_completion)\n            \\<and> (\\<forall>x \\<in> range to_metric_completion. g x = f (inv to_metric_completion x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "define I::\"'a metric_completion \\<Rightarrow> 'a\" where \"I = inv to_metric_completion\""], ["proof (state)\nthis:\n  I = inv to_metric_completion\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have \"uniformly_continuous_on (range to_metric_completion) I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. uniformly_continuous_on (range to_metric_completion) I", "using isometry_on_uniformly_continuous[OF isometry_on_inverse(1)[OF to_metric_completion_isometry]] I_def"], ["proof (prove)\nusing this:\n  uniformly_continuous_on (range to_metric_completion)\n   (inv to_metric_completion)\n  I = inv to_metric_completion\n\ngoal (1 subgoal):\n 1. uniformly_continuous_on (range to_metric_completion) I", "by auto"], ["proof (state)\nthis:\n  uniformly_continuous_on (range to_metric_completion) I\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "then"], ["proof (chain)\npicking this:\n  uniformly_continuous_on (range to_metric_completion) I", "have UC: \"uniformly_continuous_on (range to_metric_completion) (\\<lambda>x. f (I x))\""], ["proof (prove)\nusing this:\n  uniformly_continuous_on (range to_metric_completion) I\n\ngoal (1 subgoal):\n 1. uniformly_continuous_on (range to_metric_completion)\n     (\\<lambda>x. f (I x))", "using assms uniformly_continuous_on_compose"], ["proof (prove)\nusing this:\n  uniformly_continuous_on (range to_metric_completion) I\n  isUCont f\n  \\<lbrakk>uniformly_continuous_on ?s ?g;\n   uniformly_continuous_on (?g ` ?s) ?f\\<rbrakk>\n  \\<Longrightarrow> uniformly_continuous_on ?s (\\<lambda>x. ?f (?g x))\n\ngoal (1 subgoal):\n 1. uniformly_continuous_on (range to_metric_completion)\n     (\\<lambda>x. f (I x))", "by (metis I_def bij_betw_imp_surj_on bij_betw_inv_into isometry_on_inverse(4) to_metric_completion_isometry)"], ["proof (state)\nthis:\n  uniformly_continuous_on (range to_metric_completion) (\\<lambda>x. f (I x))\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "obtain g where g: \"uniformly_continuous_on (closure(range to_metric_completion)) g\"\n                    \"\\<And>x. x \\<in> range to_metric_completion \\<Longrightarrow> f (I x) = g x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>uniformly_continuous_on\n                  (closure (range to_metric_completion)) g;\n         \\<And>x.\n            x \\<in> range to_metric_completion \\<Longrightarrow>\n            f (I x) = g x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using uniformly_continuous_on_extension_on_closure[OF UC]"], ["proof (prove)\nusing this:\n  (\\<And>g.\n      \\<lbrakk>uniformly_continuous_on\n                (closure (range to_metric_completion)) g;\n       \\<And>x.\n          x \\<in> range to_metric_completion \\<Longrightarrow>\n          f (I x) = g x;\n       \\<And>Y h x.\n          \\<lbrakk>range to_metric_completion \\<subseteq> Y;\n           Y \\<subseteq> closure (range to_metric_completion);\n           continuous_on Y h;\n           \\<And>x.\n              x \\<in> range to_metric_completion \\<Longrightarrow>\n              f (I x) = h x;\n           x \\<in> Y\\<rbrakk>\n          \\<Longrightarrow> h x = g x\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>uniformly_continuous_on\n                  (closure (range to_metric_completion)) g;\n         \\<And>x.\n            x \\<in> range to_metric_completion \\<Longrightarrow>\n            f (I x) = g x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  uniformly_continuous_on (closure (range to_metric_completion)) g\n  ?x \\<in> range to_metric_completion \\<Longrightarrow> f (I ?x) = g ?x\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have \"uniformly_continuous_on UNIV g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. isUCont g", "using to_metric_completion_dense' g(1)"], ["proof (prove)\nusing this:\n  closure (range to_metric_completion) = UNIV\n  uniformly_continuous_on (closure (range to_metric_completion)) g\n\ngoal (1 subgoal):\n 1. isUCont g", "by metis"], ["proof (state)\nthis:\n  isUCont g\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "moreover"], ["proof (state)\nthis:\n  isUCont g\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have \"f x = g (to_metric_completion x)\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. f x = g (to_metric_completion x)", "using g(2)"], ["proof (prove)\nusing this:\n  ?x \\<in> range to_metric_completion \\<Longrightarrow> f (I ?x) = g ?x\n\ngoal (1 subgoal):\n 1. f x = g (to_metric_completion x)", "by (metis I_def UNIV_I isometry_on_inverse(2) range_eqI to_metric_completion_isometry)"], ["proof (state)\nthis:\n  f ?x = g (to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "moreover"], ["proof (state)\nthis:\n  f ?x = g (to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have \"g x = f (inv to_metric_completion x)\" if \"x \\<in> range to_metric_completion\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. g x = f (inv to_metric_completion x)", "using I_def g(2) that"], ["proof (prove)\nusing this:\n  I = inv to_metric_completion\n  ?x \\<in> range to_metric_completion \\<Longrightarrow> f (I ?x) = g ?x\n  x \\<in> range to_metric_completion\n\ngoal (1 subgoal):\n 1. g x = f (inv to_metric_completion x)", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> range to_metric_completion \\<Longrightarrow>\n  g ?x = f (inv to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "ultimately"], ["proof (chain)\npicking this:\n  isUCont g\n  f ?x = g (to_metric_completion ?x)\n  ?x \\<in> range to_metric_completion \\<Longrightarrow>\n  g ?x = f (inv to_metric_completion ?x)", "show ?thesis"], ["proof (prove)\nusing this:\n  isUCont g\n  f ?x = g (to_metric_completion ?x)\n  ?x \\<in> range to_metric_completion \\<Longrightarrow>\n  g ?x = f (inv to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "unfolding comp_def"], ["proof (prove)\nusing this:\n  isUCont g\n  f ?x = g (to_metric_completion ?x)\n  ?x \\<in> range to_metric_completion \\<Longrightarrow>\n  g ?x = f (inv to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isUCont g \\<and>\n       f = (\\<lambda>x. g (to_metric_completion x)) \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "by auto"], ["proof (state)\nthis:\n  \\<exists>g.\n     isUCont g \\<and>\n     f = g \\<circ> to_metric_completion \\<and>\n     (\\<forall>x\\<in>range to_metric_completion.\n         g x = f (inv to_metric_completion x))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>When the function is an isometry, the lifted function is also an isometry (and its range is\nthe closure of the range of the original function).\nThis shows that the metric completion is unique, up to isometry:\\<close>"], ["", "lemma lift_to_metric_completion_isometry:\n  fixes f::\"('a::metric_space) \\<Rightarrow> ('b::complete_space)\"\n  assumes \"isometry_on UNIV f\"\n  shows \"\\<exists>g. isometry_on UNIV g\n          \\<and> range g = closure(range f)\n          \\<and> f = g o to_metric_completion\n          \\<and> (\\<forall>x \\<in> range to_metric_completion. g x = f (inv to_metric_completion x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have *: \"uniformly_continuous_on UNIV f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. isUCont f", "using assms isometry_on_uniformly_continuous"], ["proof (prove)\nusing this:\n  isometry_on UNIV f\n  isometry_on ?X ?f \\<Longrightarrow> uniformly_continuous_on ?X ?f\n\ngoal (1 subgoal):\n 1. isUCont f", "by force"], ["proof (state)\nthis:\n  isUCont f\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "obtain g where g: \"uniformly_continuous_on UNIV g\"\n                    \"f = g o to_metric_completion\"\n                    \"\\<And>x. x \\<in> range to_metric_completion \\<Longrightarrow> g x = f (inv to_metric_completion x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>isUCont g; f = g \\<circ> to_metric_completion;\n         \\<And>x.\n            x \\<in> range to_metric_completion \\<Longrightarrow>\n            g x = f (inv to_metric_completion x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using lift_to_metric_completion[OF *]"], ["proof (prove)\nusing this:\n  \\<exists>g.\n     isUCont g \\<and>\n     f = g \\<circ> to_metric_completion \\<and>\n     (\\<forall>x\\<in>range to_metric_completion.\n         g x = f (inv to_metric_completion x))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>isUCont g; f = g \\<circ> to_metric_completion;\n         \\<And>x.\n            x \\<in> range to_metric_completion \\<Longrightarrow>\n            g x = f (inv to_metric_completion x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  isUCont g\n  f = g \\<circ> to_metric_completion\n  ?x \\<in> range to_metric_completion \\<Longrightarrow>\n  g ?x = f (inv to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have *: \"isometry_on (range to_metric_completion) g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. isometry_on (range to_metric_completion) g", "apply (rule isometry_on_cong[OF _ g(3)], rule isometry_on_compose[of _ _ f])"], ["proof (prove)\ngoal (3 subgoals):\n 1. isometry_on (range to_metric_completion) (inv to_metric_completion)\n 2. isometry_on (inv to_metric_completion ` range to_metric_completion) f\n 3. \\<And>x.\n       x \\<in> range to_metric_completion \\<Longrightarrow>\n       x \\<in> range to_metric_completion", "using assms isometry_on_inverse[OF to_metric_completion_isometry] isometry_on_subset"], ["proof (prove)\nusing this:\n  isometry_on UNIV f\n  isometry_on (range to_metric_completion) (inv to_metric_completion)\n  ?x \\<in> UNIV \\<Longrightarrow>\n  inv to_metric_completion (to_metric_completion ?x) = ?x\n  ?y \\<in> range to_metric_completion \\<Longrightarrow>\n  to_metric_completion (inv to_metric_completion ?y) = ?y\n  bij_betw to_metric_completion UNIV (range to_metric_completion)\n  \\<lbrakk>isometry_on ?X ?f; ?Y \\<subseteq> ?X\\<rbrakk>\n  \\<Longrightarrow> isometry_on ?Y ?f\n\ngoal (3 subgoals):\n 1. isometry_on (range to_metric_completion) (inv to_metric_completion)\n 2. isometry_on (inv to_metric_completion ` range to_metric_completion) f\n 3. \\<And>x.\n       x \\<in> range to_metric_completion \\<Longrightarrow>\n       x \\<in> range to_metric_completion", "by (auto) (fastforce)"], ["proof (state)\nthis:\n  isometry_on (range to_metric_completion) g\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "then"], ["proof (chain)\npicking this:\n  isometry_on (range to_metric_completion) g", "have \"isometry_on UNIV g\""], ["proof (prove)\nusing this:\n  isometry_on (range to_metric_completion) g\n\ngoal (1 subgoal):\n 1. isometry_on UNIV g", "unfolding to_metric_completion_dense'[symmetric]"], ["proof (prove)\nusing this:\n  isometry_on (range to_metric_completion) g\n\ngoal (1 subgoal):\n 1. isometry_on (closure (range to_metric_completion)) g", "apply (rule isometry_on_closure)"], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (closure (range to_metric_completion)) g", "using continuous_on_subset[OF uniformly_continuous_imp_continuous[OF g(1)]]"], ["proof (prove)\nusing this:\n  ?t \\<subseteq> UNIV \\<Longrightarrow> continuous_on ?t g\n\ngoal (1 subgoal):\n 1. continuous_on (closure (range to_metric_completion)) g", "by auto"], ["proof (state)\nthis:\n  isometry_on UNIV g\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have \"g`(range to_metric_completion) \\<subseteq> range f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g ` range to_metric_completion \\<subseteq> range f", "using g"], ["proof (prove)\nusing this:\n  isUCont g\n  f = g \\<circ> to_metric_completion\n  ?x \\<in> range to_metric_completion \\<Longrightarrow>\n  g ?x = f (inv to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. g ` range to_metric_completion \\<subseteq> range f", "unfolding comp_def"], ["proof (prove)\nusing this:\n  isUCont g\n  f = (\\<lambda>x. g (to_metric_completion x))\n  ?x \\<in> range to_metric_completion \\<Longrightarrow>\n  g ?x = f (inv to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. g ` range to_metric_completion \\<subseteq> range f", "by auto"], ["proof (state)\nthis:\n  g ` range to_metric_completion \\<subseteq> range f\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "moreover"], ["proof (state)\nthis:\n  g ` range to_metric_completion \\<subseteq> range f\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have \"g`(closure (range to_metric_completion)) \\<subseteq> closure (g`(range to_metric_completion))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g ` closure (range to_metric_completion)\n    \\<subseteq> closure (g ` range to_metric_completion)", "using uniformly_continuous_imp_continuous[OF g(1)]"], ["proof (prove)\nusing this:\n  continuous_on UNIV g\n\ngoal (1 subgoal):\n 1. g ` closure (range to_metric_completion)\n    \\<subseteq> closure (g ` range to_metric_completion)", "by (meson closed_closure closure_subset continuous_on_subset image_closure_subset top_greatest)"], ["proof (state)\nthis:\n  g ` closure (range to_metric_completion)\n  \\<subseteq> closure (g ` range to_metric_completion)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "ultimately"], ["proof (chain)\npicking this:\n  g ` range to_metric_completion \\<subseteq> range f\n  g ` closure (range to_metric_completion)\n  \\<subseteq> closure (g ` range to_metric_completion)", "have \"range g \\<subseteq> closure (range f)\""], ["proof (prove)\nusing this:\n  g ` range to_metric_completion \\<subseteq> range f\n  g ` closure (range to_metric_completion)\n  \\<subseteq> closure (g ` range to_metric_completion)\n\ngoal (1 subgoal):\n 1. range g \\<subseteq> closure (range f)", "unfolding to_metric_completion_dense'"], ["proof (prove)\nusing this:\n  g ` range to_metric_completion \\<subseteq> range f\n  range g \\<subseteq> closure (g ` range to_metric_completion)\n\ngoal (1 subgoal):\n 1. range g \\<subseteq> closure (range f)", "by (simp add: g(2) image_comp)"], ["proof (state)\nthis:\n  range g \\<subseteq> closure (range f)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have \"range f \\<subseteq> range g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range f \\<subseteq> range g", "using g(2)"], ["proof (prove)\nusing this:\n  f = g \\<circ> to_metric_completion\n\ngoal (1 subgoal):\n 1. range f \\<subseteq> range g", "by auto"], ["proof (state)\nthis:\n  range f \\<subseteq> range g\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "moreover"], ["proof (state)\nthis:\n  range f \\<subseteq> range g\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "have \"closed (range g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed (range g)", "using isometry_on_complete_image[OF \\<open>isometry_on UNIV g\\<close>]"], ["proof (prove)\nusing this:\n  complete UNIV \\<Longrightarrow> complete (range g)\n\ngoal (1 subgoal):\n 1. closed (range g)", "by (simp add: complete_eq_closed)"], ["proof (state)\nthis:\n  closed (range g)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "ultimately"], ["proof (chain)\npicking this:\n  range f \\<subseteq> range g\n  closed (range g)", "have \"closure (range f) \\<subseteq> range g\""], ["proof (prove)\nusing this:\n  range f \\<subseteq> range g\n  closed (range g)\n\ngoal (1 subgoal):\n 1. closure (range f) \\<subseteq> range g", "by (simp add: closure_minimal)"], ["proof (state)\nthis:\n  closure (range f) \\<subseteq> range g\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "then"], ["proof (chain)\npicking this:\n  closure (range f) \\<subseteq> range g", "have \"range g = closure (range f)\""], ["proof (prove)\nusing this:\n  closure (range f) \\<subseteq> range g\n\ngoal (1 subgoal):\n 1. range g = closure (range f)", "using \\<open>range g \\<subseteq> closure (range f)\\<close>"], ["proof (prove)\nusing this:\n  closure (range f) \\<subseteq> range g\n  range g \\<subseteq> closure (range f)\n\ngoal (1 subgoal):\n 1. range g = closure (range f)", "by auto"], ["proof (state)\nthis:\n  range g = closure (range f)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "then"], ["proof (chain)\npicking this:\n  range g = closure (range f)", "show ?thesis"], ["proof (prove)\nusing this:\n  range g = closure (range f)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "using \\<open>isometry_on UNIV g\\<close> g"], ["proof (prove)\nusing this:\n  range g = closure (range f)\n  isometry_on UNIV g\n  isUCont g\n  f = g \\<circ> to_metric_completion\n  ?x \\<in> range to_metric_completion \\<Longrightarrow>\n  g ?x = f (inv to_metric_completion ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       isometry_on UNIV g \\<and>\n       range g = closure (range f) \\<and>\n       f = g \\<circ> to_metric_completion \\<and>\n       (\\<forall>x\\<in>range to_metric_completion.\n           g x = f (inv to_metric_completion x))", "by metis"], ["proof (state)\nthis:\n  \\<exists>g.\n     isometry_on UNIV g \\<and>\n     range g = closure (range f) \\<and>\n     f = g \\<circ> to_metric_completion \\<and>\n     (\\<forall>x\\<in>range to_metric_completion.\n         g x = f (inv to_metric_completion x))\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>The metric completion of a second countable space is second countable\\<close>"], ["", "text \\<open>We want to show that the metric completion of a second countable space is still\nsecond countable. This is most easily expressed using the fact that a metric\nspace is second countable if and only if there exists a dense countable subset. We prove\nthe equivalence in the next lemma, and use it then to prove that the metric completion is\nstill second countable.\\<close>"], ["", "lemma second_countable_iff_dense_countable_subset:\n  \"(\\<exists>B::'a::metric_space set set. countable B \\<and> topological_basis B)\n    \\<longleftrightarrow> (\\<exists>A::'a set. countable A \\<and> closure A = UNIV)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>B. countable B \\<and> topological_basis B) =\n    (\\<exists>A. countable A \\<and> closure A = UNIV)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>B. countable B \\<and> topological_basis B \\<Longrightarrow>\n    \\<exists>A. countable A \\<and> closure A = UNIV\n 2. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "assume \"\\<exists>B::'a set set. countable B \\<and> topological_basis B\""], ["proof (state)\nthis:\n  \\<exists>B. countable B \\<and> topological_basis B\n\ngoal (2 subgoals):\n 1. \\<exists>B. countable B \\<and> topological_basis B \\<Longrightarrow>\n    \\<exists>A. countable A \\<and> closure A = UNIV\n 2. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "then"], ["proof (chain)\npicking this:\n  \\<exists>B. countable B \\<and> topological_basis B", "obtain B::\"'a set set\" where \"countable B\" \"topological_basis B\""], ["proof (prove)\nusing this:\n  \\<exists>B. countable B \\<and> topological_basis B\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>countable B; topological_basis B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  countable B\n  topological_basis B\n\ngoal (2 subgoals):\n 1. \\<exists>B. countable B \\<and> topological_basis B \\<Longrightarrow>\n    \\<exists>A. countable A \\<and> closure A = UNIV\n 2. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "define A where \"A = (\\<lambda>U. SOME x. x \\<in> U)`B\""], ["proof (state)\nthis:\n  A = (\\<lambda>U. SOME x. x \\<in> U) ` B\n\ngoal (2 subgoals):\n 1. \\<exists>B. countable B \\<and> topological_basis B \\<Longrightarrow>\n    \\<exists>A. countable A \\<and> closure A = UNIV\n 2. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "have \"countable A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. countable A", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. countable ((\\<lambda>U. SOME x. x \\<in> U) ` B)", "using \\<open>countable B\\<close>"], ["proof (prove)\nusing this:\n  countable B\n\ngoal (1 subgoal):\n 1. countable ((\\<lambda>U. SOME x. x \\<in> U) ` B)", "by auto"], ["proof (state)\nthis:\n  countable A\n\ngoal (2 subgoals):\n 1. \\<exists>B. countable B \\<and> topological_basis B \\<Longrightarrow>\n    \\<exists>A. countable A \\<and> closure A = UNIV\n 2. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "moreover"], ["proof (state)\nthis:\n  countable A\n\ngoal (2 subgoals):\n 1. \\<exists>B. countable B \\<and> topological_basis B \\<Longrightarrow>\n    \\<exists>A. countable A \\<and> closure A = UNIV\n 2. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "have \"closure A = UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure A = UNIV", "proof (auto simp add: closure_approachable)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "fix x::'a and e::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "assume \"e > 0\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "obtain U where \"U \\<in> B\" \"x \\<in> U\" \"U \\<subseteq> ball x e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>U \\<in> B; x \\<in> U; U \\<subseteq> ball x e\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (rule topological_basisE[OF \\<open>topological_basis B\\<close>, of \"ball x e\" x], auto simp add: \\<open>e > 0\\<close>)"], ["proof (state)\nthis:\n  U \\<in> B\n  x \\<in> U\n  U \\<subseteq> ball x e\n\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "define y where \"y = (\\<lambda>U. SOME x. x \\<in> U) U\""], ["proof (state)\nthis:\n  y = (SOME x. x \\<in> U)\n\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "have \"y \\<in> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> U", "unfolding y_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (SOME x. x \\<in> U) \\<in> U", "using \\<open>x \\<in> U\\<close> some_in_eq"], ["proof (prove)\nusing this:\n  x \\<in> U\n  ((SOME x. x \\<in> ?A) \\<in> ?A) = (?A \\<noteq> {})\n\ngoal (1 subgoal):\n 1. (SOME x. x \\<in> U) \\<in> U", "by fastforce"], ["proof (state)\nthis:\n  y \\<in> U\n\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "then"], ["proof (chain)\npicking this:\n  y \\<in> U", "have \"dist y x < e\""], ["proof (prove)\nusing this:\n  y \\<in> U\n\ngoal (1 subgoal):\n 1. dist y x < e", "using \\<open>U \\<subseteq> ball x e\\<close>"], ["proof (prove)\nusing this:\n  y \\<in> U\n  U \\<subseteq> ball x e\n\ngoal (1 subgoal):\n 1. dist y x < e", "by (metis dist_commute mem_ball subset_iff)"], ["proof (state)\nthis:\n  dist y x < e\n\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "moreover"], ["proof (state)\nthis:\n  dist y x < e\n\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "have \"y \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> A", "unfolding A_def y_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (SOME x. x \\<in> U) \\<in> (\\<lambda>U. SOME x. x \\<in> U) ` B", "using \\<open>U \\<in> B\\<close>"], ["proof (prove)\nusing this:\n  U \\<in> B\n\ngoal (1 subgoal):\n 1. (SOME x. x \\<in> U) \\<in> (\\<lambda>U. SOME x. x \\<in> U) ` B", "by auto"], ["proof (state)\nthis:\n  y \\<in> A\n\ngoal (1 subgoal):\n 1. \\<And>x e. 0 < e \\<Longrightarrow> \\<exists>y\\<in>A. dist y x < e", "ultimately"], ["proof (chain)\npicking this:\n  dist y x < e\n  y \\<in> A", "show \"\\<exists>y\\<in>A. dist y x < e\""], ["proof (prove)\nusing this:\n  dist y x < e\n  y \\<in> A\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>A. dist y x < e", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>A. dist y x < e\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  closure A = UNIV\n\ngoal (2 subgoals):\n 1. \\<exists>B. countable B \\<and> topological_basis B \\<Longrightarrow>\n    \\<exists>A. countable A \\<and> closure A = UNIV\n 2. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "ultimately"], ["proof (chain)\npicking this:\n  countable A\n  closure A = UNIV", "show \"\\<exists>A::'a set. countable A \\<and> closure A = UNIV\""], ["proof (prove)\nusing this:\n  countable A\n  closure A = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV", "by auto"], ["proof (state)\nthis:\n  \\<exists>A. countable A \\<and> closure A = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "assume \"\\<exists>A::'a set. countable A \\<and> closure A = UNIV\""], ["proof (state)\nthis:\n  \\<exists>A. countable A \\<and> closure A = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "then"], ["proof (chain)\npicking this:\n  \\<exists>A. countable A \\<and> closure A = UNIV", "obtain A::\"'a set\" where \"countable A\" \"closure A = UNIV\""], ["proof (prove)\nusing this:\n  \\<exists>A. countable A \\<and> closure A = UNIV\n\ngoal (1 subgoal):\n 1. (\\<And>A.\n        \\<lbrakk>countable A; closure A = UNIV\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  countable A\n  closure A = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "define B where \"B = (\\<lambda>(x, (n::nat)). ball x (1/n))`(A \\<times> UNIV)\""], ["proof (state)\nthis:\n  B = (\\<lambda>(xa, x). ball xa (1 / real x)) ` (A \\<times> UNIV)\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "have \"countable B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. countable B", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. countable ((\\<lambda>(xa, x). ball xa (1 / real x)) ` (A \\<times> UNIV))", "using \\<open>countable A\\<close>"], ["proof (prove)\nusing this:\n  countable A\n\ngoal (1 subgoal):\n 1. countable ((\\<lambda>(xa, x). ball xa (1 / real x)) ` (A \\<times> UNIV))", "by auto"], ["proof (state)\nthis:\n  countable B\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "moreover"], ["proof (state)\nthis:\n  countable B\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "have \"topological_basis B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. topological_basis B", "proof (rule topological_basisI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "fix x::'a and U"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "assume \"x \\<in> U\" \"open U\""], ["proof (state)\nthis:\n  x \\<in> U\n  open U\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "then"], ["proof (chain)\npicking this:\n  x \\<in> U\n  open U", "obtain e where \"e > 0\" \"ball x e \\<subseteq> U\""], ["proof (prove)\nusing this:\n  x \\<in> U\n  open U\n\ngoal (1 subgoal):\n 1. (\\<And>e.\n        \\<lbrakk>0 < e; ball x e \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using openE"], ["proof (prove)\nusing this:\n  x \\<in> U\n  open U\n  \\<lbrakk>open ?S; ?x \\<in> ?S;\n   \\<And>e.\n      \\<lbrakk>0 < e; ball ?x e \\<subseteq> ?S\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>e.\n        \\<lbrakk>0 < e; ball x e \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < e\n  ball x e \\<subseteq> U\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "obtain n::nat where \"n > 2/e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n. 2 / e < real n \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using reals_Archimedean2"], ["proof (prove)\nusing this:\n  \\<exists>n. ?x < of_nat n\n\ngoal (1 subgoal):\n 1. (\\<And>n. 2 / e < real n \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  2 / e < real n\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "then"], ["proof (chain)\npicking this:\n  2 / e < real n", "have \"n > 0\""], ["proof (prove)\nusing this:\n  2 / e < real n\n\ngoal (1 subgoal):\n 1. 0 < n", "using \\<open>e > 0\\<close> not_less"], ["proof (prove)\nusing this:\n  2 / e < real n\n  0 < e\n  (\\<not> ?x < ?y) = (?y \\<le> ?x)\n\ngoal (1 subgoal):\n 1. 0 < n", "by fastforce"], ["proof (state)\nthis:\n  0 < n\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "then"], ["proof (chain)\npicking this:\n  0 < n", "have \"1/n > 0\""], ["proof (prove)\nusing this:\n  0 < n\n\ngoal (1 subgoal):\n 1. 0 < 1 / real n", "using zero_less_divide_iff"], ["proof (prove)\nusing this:\n  0 < n\n  ((0::?'a) < ?a / ?b) =\n  ((0::?'a) < ?a \\<and> (0::?'a) < ?b \\<or>\n   ?a < (0::?'a) \\<and> ?b < (0::?'a))\n\ngoal (1 subgoal):\n 1. 0 < 1 / real n", "by fastforce"], ["proof (state)\nthis:\n  0 < 1 / real n\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "then"], ["proof (chain)\npicking this:\n  0 < 1 / real n", "obtain y where y: \"y \\<in> A\" \"dist x y < 1/n\""], ["proof (prove)\nusing this:\n  0 < 1 / real n\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> A; dist x y < 1 / real n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis \\<open>closure A = UNIV\\<close> UNIV_I closure_approachable dist_commute)"], ["proof (state)\nthis:\n  y \\<in> A\n  dist x y < 1 / real n\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "then"], ["proof (chain)\npicking this:\n  y \\<in> A\n  dist x y < 1 / real n", "have \"ball y (1/n) \\<in> B\""], ["proof (prove)\nusing this:\n  y \\<in> A\n  dist x y < 1 / real n\n\ngoal (1 subgoal):\n 1. ball y (1 / real n) \\<in> B", "unfolding B_def"], ["proof (prove)\nusing this:\n  y \\<in> A\n  dist x y < 1 / real n\n\ngoal (1 subgoal):\n 1. ball y (1 / real n)\n    \\<in> (\\<lambda>(xa, x). ball xa (1 / real x)) ` (A \\<times> UNIV)", "by auto"], ["proof (state)\nthis:\n  ball y (1 / real n) \\<in> B\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "moreover"], ["proof (state)\nthis:\n  ball y (1 / real n) \\<in> B\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "have \"x \\<in> ball y (1/n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> ball y (1 / real n)", "using y(2)"], ["proof (prove)\nusing this:\n  dist x y < 1 / real n\n\ngoal (1 subgoal):\n 1. x \\<in> ball y (1 / real n)", "by (auto simp add: dist_commute)"], ["proof (state)\nthis:\n  x \\<in> ball y (1 / real n)\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "moreover"], ["proof (state)\nthis:\n  x \\<in> ball y (1 / real n)\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "have \"ball y (1/n) \\<subseteq> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ball y (1 / real n) \\<subseteq> U", "proof (auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "fix z"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "assume z: \"dist y z < 1/n\""], ["proof (state)\nthis:\n  dist y z < 1 / real n\n\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "have \"dist z x \\<le> dist z y + dist y x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist z x \\<le> dist z y + dist y x", "using dist_triangle"], ["proof (prove)\nusing this:\n  dist ?x ?z \\<le> dist ?x ?y + dist ?y ?z\n\ngoal (1 subgoal):\n 1. dist z x \\<le> dist z y + dist y x", "by auto"], ["proof (state)\nthis:\n  dist z x \\<le> dist z y + dist y x\n\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "also"], ["proof (state)\nthis:\n  dist z x \\<le> dist z y + dist y x\n\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "have \"... < 1/n + 1/n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist z y + dist y x < 1 / real n + 1 / real n", "using z y(2)"], ["proof (prove)\nusing this:\n  dist y z < 1 / real n\n  dist x y < 1 / real n\n\ngoal (1 subgoal):\n 1. dist z y + dist y x < 1 / real n + 1 / real n", "by (auto simp add: dist_commute)"], ["proof (state)\nthis:\n  dist z y + dist y x < 1 / real n + 1 / real n\n\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "also"], ["proof (state)\nthis:\n  dist z y + dist y x < 1 / real n + 1 / real n\n\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "have \"... < e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / real n + 1 / real n < e", "using \\<open>n > 2/e\\<close> \\<open>e > 0\\<close> \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  2 / e < real n\n  0 < e\n  0 < n\n\ngoal (1 subgoal):\n 1. 1 / real n + 1 / real n < e", "by (auto simp add: divide_simps mult.commute)"], ["proof (state)\nthis:\n  1 / real n + 1 / real n < e\n\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "finally"], ["proof (chain)\npicking this:\n  dist z x < e", "have \"z \\<in> ball x e\""], ["proof (prove)\nusing this:\n  dist z x < e\n\ngoal (1 subgoal):\n 1. z \\<in> ball x e", "by (auto simp add: dist_commute)"], ["proof (state)\nthis:\n  z \\<in> ball x e\n\ngoal (1 subgoal):\n 1. \\<And>x. dist y x < 1 / real n \\<Longrightarrow> x \\<in> U", "then"], ["proof (chain)\npicking this:\n  z \\<in> ball x e", "show \"z \\<in> U\""], ["proof (prove)\nusing this:\n  z \\<in> ball x e\n\ngoal (1 subgoal):\n 1. z \\<in> U", "using \\<open>ball x e \\<subseteq> U\\<close>"], ["proof (prove)\nusing this:\n  z \\<in> ball x e\n  ball x e \\<subseteq> U\n\ngoal (1 subgoal):\n 1. z \\<in> U", "by auto"], ["proof (state)\nthis:\n  z \\<in> U\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ball y (1 / real n) \\<subseteq> U\n\ngoal (2 subgoals):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'\n 2. \\<And>O' x.\n       \\<lbrakk>open O'; x \\<in> O'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>B'\\<in>B.\n                            x \\<in> B' \\<and> B' \\<subseteq> O'", "ultimately"], ["proof (chain)\npicking this:\n  ball y (1 / real n) \\<in> B\n  x \\<in> ball y (1 / real n)\n  ball y (1 / real n) \\<subseteq> U", "show \"\\<exists>V\\<in>B. x \\<in> V \\<and> V \\<subseteq> U\""], ["proof (prove)\nusing this:\n  ball y (1 / real n) \\<in> B\n  x \\<in> ball y (1 / real n)\n  ball y (1 / real n) \\<subseteq> U\n\ngoal (1 subgoal):\n 1. \\<exists>V\\<in>B. x \\<in> V \\<and> V \\<subseteq> U", "by metis"], ["proof (state)\nthis:\n  \\<exists>V\\<in>B. x \\<in> V \\<and> V \\<subseteq> U\n\ngoal (1 subgoal):\n 1. \\<And>B'. B' \\<in> B \\<Longrightarrow> open B'", "qed (auto simp add: B_def)"], ["proof (state)\nthis:\n  topological_basis B\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV \\<Longrightarrow>\n    \\<exists>B. countable B \\<and> topological_basis B", "ultimately"], ["proof (chain)\npicking this:\n  countable B\n  topological_basis B", "show \"\\<exists>B::'a set set. countable B \\<and> topological_basis B\""], ["proof (prove)\nusing this:\n  countable B\n  topological_basis B\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> topological_basis B", "by auto"], ["proof (state)\nthis:\n  \\<exists>B. countable B \\<and> topological_basis B\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma second_countable_metric_dense_subset:\n  \"\\<exists>A::'a::{metric_space, second_countable_topology} set. countable A \\<and> closure A = UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV", "using ex_countable_basis"], ["proof (prove)\nusing this:\n  \\<exists>B. countable B \\<and> topological_basis B\n\ngoal (1 subgoal):\n 1. \\<exists>A. countable A \\<and> closure A = UNIV", "by (auto simp add: second_countable_iff_dense_countable_subset[symmetric])"], ["", "instance metric_completion::(\"{metric_space, second_countable_topology}\") second_countable_topology"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a metric_completion, second_countable_topology_class)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "obtain A::\"'a set\" where \"countable A\" \"closure A = UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A.\n        \\<lbrakk>countable A; closure A = UNIV\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using second_countable_metric_dense_subset"], ["proof (prove)\nusing this:\n  \\<exists>A. countable A \\<and> closure A = UNIV\n\ngoal (1 subgoal):\n 1. (\\<And>A.\n        \\<lbrakk>countable A; closure A = UNIV\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  countable A\n  closure A = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "define Ab where \"Ab = to_metric_completion`A\""], ["proof (state)\nthis:\n  Ab = to_metric_completion ` A\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "have \"range to_metric_completion \\<subseteq> closure Ab\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range to_metric_completion \\<subseteq> closure Ab", "unfolding Ab_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. range to_metric_completion\n    \\<subseteq> closure (to_metric_completion ` A)", "by (metis \\<open>closure A = UNIV\\<close> isometry_on_continuous[OF to_metric_completion_isometry] closed_closure closure_subset image_closure_subset)"], ["proof (state)\nthis:\n  range to_metric_completion \\<subseteq> closure Ab\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "then"], ["proof (chain)\npicking this:\n  range to_metric_completion \\<subseteq> closure Ab", "have \"closure Ab = UNIV\""], ["proof (prove)\nusing this:\n  range to_metric_completion \\<subseteq> closure Ab\n\ngoal (1 subgoal):\n 1. closure Ab = UNIV", "by (metis (no_types) to_metric_completion_dense'[symmetric] \\<open>range to_metric_completion \\<subseteq> closure Ab\\<close> closure_closure closure_mono top.extremum_uniqueI)"], ["proof (state)\nthis:\n  closure Ab = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "moreover"], ["proof (state)\nthis:\n  closure Ab = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "have \"countable Ab\""], ["proof (prove)\ngoal (1 subgoal):\n 1. countable Ab", "unfolding Ab_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. countable (to_metric_completion ` A)", "using \\<open>countable A\\<close>"], ["proof (prove)\nusing this:\n  countable A\n\ngoal (1 subgoal):\n 1. countable (to_metric_completion ` A)", "by auto"], ["proof (state)\nthis:\n  countable Ab\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "ultimately"], ["proof (chain)\npicking this:\n  closure Ab = UNIV\n  countable Ab", "have \"\\<exists>Ab::'a metric_completion set. countable Ab \\<and> closure Ab = UNIV\""], ["proof (prove)\nusing this:\n  closure Ab = UNIV\n  countable Ab\n\ngoal (1 subgoal):\n 1. \\<exists>Ab. countable Ab \\<and> closure Ab = UNIV", "by auto"], ["proof (state)\nthis:\n  \\<exists>Ab. countable Ab \\<and> closure Ab = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "then"], ["proof (chain)\npicking this:\n  \\<exists>Ab. countable Ab \\<and> closure Ab = UNIV", "show \"\\<exists>B::'a metric_completion set set. countable B \\<and> open = generate_topology B\""], ["proof (prove)\nusing this:\n  \\<exists>Ab. countable Ab \\<and> closure Ab = UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "using second_countable_iff_dense_countable_subset topological_basis_imp_subbasis"], ["proof (prove)\nusing this:\n  \\<exists>Ab. countable Ab \\<and> closure Ab = UNIV\n  (\\<exists>B. countable B \\<and> topological_basis B) =\n  (\\<exists>A. countable A \\<and> closure A = UNIV)\n  topological_basis ?B \\<Longrightarrow> open = generate_topology ?B\n\ngoal (1 subgoal):\n 1. \\<exists>B. countable B \\<and> open = generate_topology B", "by auto"], ["proof (state)\nthis:\n  \\<exists>B. countable B \\<and> open = generate_topology B\n\ngoal:\nNo subgoals!", "qed"], ["", "instance metric_completion::(\"{metric_space, second_countable_topology}\") polish_space"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a metric_completion, polish_space_class)", "by standard"], ["", "end"], ["", "(*of theory Metric_Completion*)"]]}