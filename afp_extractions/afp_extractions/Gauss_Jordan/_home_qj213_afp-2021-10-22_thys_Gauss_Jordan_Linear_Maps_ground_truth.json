{"file_name": "/home/qj213/afp-2021-10-22/thys/Gauss_Jordan/Linear_Maps.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Gauss_Jordan", "problem_names": ["lemma \"((\\<lambda>(x, y). (x::real , - y::real)) has_derivative (\\<lambda>h. (fst h, - snd h))) (at x)\"", "lemma rank_matrix_dim_range:\nassumes lf: \"linear ((*s)) ((*s)) f\"\nshows \"rank (matrix f::'a::{field}^'cols::{mod_type}^'rows::{mod_type}) = vec.dim (range f)\"", "lemma linear_injective_rank_eq_ncols:\n  assumes lf: \"linear ((*s)) ((*s)) f\"\n  shows \"inj f \\<longleftrightarrow> rank (matrix f::'a::{field}^'cols::{mod_type}^'rows::{mod_type}) = ncols (matrix f)\"", "lemma linear_surjective_rank_eq_ncols:\n  assumes lf: \"linear ((*s)) ((*s)) f\"\n  shows \"surj f \\<longleftrightarrow> rank (matrix f::'a::{field}^'cols::{mod_type}^'rows::{mod_type}) = nrows (matrix f)\"", "lemma linear_bij_rank_eq_ncols:\n  fixes f::\"('a::{field}^'n::{mod_type})=>('a::{field}^'n::{mod_type})\"\n  assumes lf: \"linear ((*s)) ((*s)) f\"\n  shows \"bij f \\<longleftrightarrow> rank (matrix f) = ncols (matrix f)\"", "lemma invertible_lf: \"(\\<exists>g. linear ((*b)) ((*a)) g \\<and> (g \\<circ> f = id) \\<and> (f \\<circ> g = id))\"", "lemma (in Vector_Spaces.linear) invertible_lf_intro[intro]:\n  assumes \"(g \\<circ> f = id)\"  and \"(f \\<circ> g = id)\"\n  shows \"invertible_lf ((*a)) ((*b)) f\"", "lemma invertible_imp_bijective:\n  assumes \"invertible_lf scaleB scaleC f\"\n  shows \"bij f\"", "lemma invertible_matrix_imp_invertible_lf:\n  fixes A::\"'a::{field}^'n^'n\"\n  assumes invertible_A: \"invertible A\"\n  shows \"invertible_lf ((*s)) ((*s)) (\\<lambda>x. A *v x)\"", "lemma invertible_lf_imp_invertible_matrix:\n  fixes f::\"'a::{field}^'n\\<Rightarrow>'a^'n\"\n  assumes invertible_f: \"invertible_lf ((*s)) ((*s)) f\"\n  shows \"invertible (matrix f)\"", "lemma invertible_matrix_iff_invertible_lf:\n  fixes A::\"'a::{field}^'n^'n\"\n  shows \"invertible A \\<longleftrightarrow> invertible_lf ((*s)) ((*s)) (\\<lambda>x. A *v x)\"", "lemma invertible_matrix_iff_invertible_lf':\n  fixes  f::\"'a::{field}^'n\\<Rightarrow>'a^'n\"\n  assumes linear_f: \"linear ((*s)) ((*s)) f\"\n  shows \"invertible (matrix f) \\<longleftrightarrow> invertible_lf ((*s)) ((*s)) f\"", "lemma invertible_matrix_mult_right_rank:\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n    and Q::\"'a::{field}^'n::{mod_type}^'n::{mod_type}\"\n  assumes invertible_Q: \"invertible Q\"\n  shows \"rank (A**Q) = rank A\"", "lemma subspace_image_invertible_mat:\n  fixes P::\"'a::{field}^'m^'m\"\n  assumes inv_P: \"invertible P\"\n    and sub_W: \"vec.subspace W\"\n  shows \"vec.subspace ((\\<lambda>x. P *v x)` W)\"", "lemma dim_image_invertible_mat:\n  fixes P::\"'a::{field}^'m^'m\"\n  assumes inv_P: \"invertible P\"\n  and sub_W: \"vec.subspace W\"\n  shows \"vec.dim ((\\<lambda>x. P *v x)` W) = vec.dim W\"", "lemma invertible_matrix_mult_left_rank:\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n  and P::\"'a::{field}^'m::{mod_type}^'m::{mod_type}\"\n  assumes invertible_P: \"invertible P\"\n  shows \"rank (P**A) = rank A\"", "lemma invertible_matrix_mult_left_rank':\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" and P::\"'a^'m::{mod_type}^'m::{mod_type}\"\n  assumes invertible_P: \"invertible P\" and B_eq_PA: \"B=P**A\"\n  shows \"rank B = rank A\"", "lemma invertible_matrix_mult_right_rank':\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n  and Q::\"'a::{field}^'n::{mod_type}^'n::{mod_type}\"\n  assumes invertible_Q: \"invertible Q\" and B_eq_PA: \"B=A**Q\"\n  shows \"rank B = rank A\"", "lemma invertible_matrices_rank':\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n  and P::\"'a^'m::{mod_type}^'m::{mod_type}\" and Q::\"'a^'n::{mod_type}^'n::{mod_type}\"\n  assumes invertible_P: \"invertible P\" and invertible_Q: \"invertible Q\" and B_eq_PA: \"B = P**A**Q\"\n  shows \"rank B = rank A\"", "lemma cart_basis_eq_set_of_vector_cart_basis': \n  \"cart_basis = set_of_vector (cart_basis')\"", "lemma basis_image_linear:\n  fixes f::\"'b::{field}^'n => 'b^'n\"\n  assumes invertible_lf: \"invertible_lf ((*s)) ((*s)) f\"\n  and basis_X: \"is_basis (set_of_vector X)\"\n  shows \"is_basis (f` (set_of_vector X))\"", "lemma set_of_vector_cart_basis': \n  shows \"(set_of_vector cart_basis') = {axis i 1 :: 'a::{field}^'n | i. i \\<in> (UNIV :: 'n set)}\"", "lemma cart_basis'_i: \"cart_basis' $ i = axis i 1\"", "lemma finite_set_of_vector[intro,simp]: \"finite (set_of_vector X)\"", "lemma is_basis_cart_basis': \"is_basis (set_of_vector cart_basis')\"", "lemma basis_expansion_cart_basis':\"sum (\\<lambda>i. x$i *s cart_basis' $ i) UNIV = x\"", "lemma basis_expansion_unique:\n  \"sum (\\<lambda>i. f i *s axis (i::'n::finite) 1) UNIV = (x::('a::comm_ring_1) ^'n) \\<longleftrightarrow> (\\<forall>i. f i = x$i)\"", "lemma basis_expansion_cart_basis'_unique: \"sum (\\<lambda>i. f (cart_basis' $ i) *s cart_basis' $ i) UNIV = x \\<longleftrightarrow> (\\<forall>i. f (cart_basis' $ i) = x$i)\"", "lemma basis_expansion_cart_basis'_unique': \"sum (\\<lambda>i. f i *s cart_basis' $ i) UNIV = x \\<longleftrightarrow> (\\<forall>i. f i = x$i)\"", "lemma sum_basis_eq:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis:\"is_basis  (set_of_vector X)\"\n  shows \"sum (\\<lambda>x. f x *s x) (set_of_vector X) = sum (\\<lambda>i. f (X$i) *s (X$i)) UNIV\"", "lemma inj_op_nth:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis: \"is_basis (set_of_vector X)\"\n  shows \"inj (($) X)\"", "lemma basis_UNIV:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis: \"is_basis (set_of_vector X)\"\n  shows \"UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X$i) = x}\"", "lemma scalars_zero_if_basis:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis: \"is_basis (set_of_vector X)\" and sum: \"(\\<Sum>i\\<in>(UNIV::'n set). f i *s X$i) = 0\"\n  shows \"\\<forall>i\\<in>(UNIV::'n set). f i = 0\"", "lemma basis_combination_unique:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and sum_eq: \"(\\<Sum>i\\<in>UNIV. g i *s X$i) = (\\<Sum>i\\<in>UNIV. f i *s X$i)\"\n  shows \"f=g\"", "lemma bij_coord:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\"\n  shows \"bij (coord X)\"", "lemma linear_coord:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\"\n  shows \"linear ((*s)) ((*s)) (coord X)\"", "lemma coord_eq:\n  assumes basis_X:\"is_basis (set_of_vector X)\"\n  and coord_eq: \"coord X v = coord X w\"\n  shows \"v = w\"", "lemma matrix'_eq_matrix:\n  defines cart_basis_Rn: \"cart_basis_Rn == (cart_basis')::'a::{field}^'n^'n\" \n  and cart_basis_Rm:\"cart_basis_Rm == (cart_basis')::'a^'m^'m\"  \n  shows \"matrix' (cart_basis_Rn) (cart_basis_Rm) f = matrix f\"", "lemma matrix':\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"f (X$i) = sum (\\<lambda>j. (matrix' X Y f) $ j $ i *s (Y$j)) UNIV\"", "lemma coord_matrix':\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'m^'m\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  and linear_f: \"linear ((*s)) ((*s)) f\"\n  shows \"coord Y (f v) = (matrix' X Y f) *v (coord X v)\"", "lemma matrix'_compose:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'m^'m\" and Z::\"'a^'p^'p\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"  and basis_Z: \"is_basis (set_of_vector Z)\"\n  and linear_f: \"linear ((*s)) ((*s)) f\" and linear_g: \"linear ((*s)) ((*s)) g\"\n  shows \"matrix' X Z (g \\<circ> f) = (matrix' Y Z g) ** (matrix' X Y f)\"", "lemma exists_linear_eq_matrix':\n  fixes A::\"'a::{field}^'m^'n\" and X::\"'a^'m^'m\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"\\<exists>f. matrix' X Y f = A \\<and> linear ((*s)) ((*s)) f\"", "lemma matrix'_surj: \n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"surj (matrix' X Y)\"", "lemma matrix_change_of_basis_works:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" \n  and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"(matrix_change_of_basis X Y) *v (coord X v) = (coord Y v)\"", "lemma matrix_change_of_basis_mat_1:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\"\n  shows \"matrix_change_of_basis X X = mat 1\"", "lemma matrix'_matrix_change_of_basis:\n  fixes B::\"'a::{field}^'n^'n\" and B'::\"'a^'n^'n\" and C::\"'a^'m^'m\" and C'::\"'a^'m^'m\"\n  assumes basis_B: \"is_basis (set_of_vector B)\" and basis_B': \"is_basis (set_of_vector B')\"\n  and basis_C: \"is_basis (set_of_vector C)\" and basis_C': \"is_basis (set_of_vector C')\"\n  and linear_f: \"linear ((*s)) ((*s)) f\"\n  shows \"matrix' B' C' f = matrix_change_of_basis C C' ** matrix' B C f ** matrix_change_of_basis B' B\"", "lemma matrix'_id_eq_matrix_change_of_basis:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"matrix' X Y (id) = matrix_change_of_basis X Y\"", "lemma matrix_inv_matrix_change_of_basis:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows\"matrix_change_of_basis Y X = matrix_inv (matrix_change_of_basis X Y)\"", "lemma invertible_lf_imp_invertible_matrix':\nfixes f:: \"'a::{field}^'b \\<Rightarrow> 'a^'b\"\nassumes \"invertible_lf ((*s)) ((*s)) f\" and basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\nshows \"invertible (matrix' X Y f)\"", "lemma invertible_matrix'_imp_invertible_lf:\nfixes f:: \"'a::{field}^'b \\<Rightarrow> 'a^'b\"\n  assumes \"invertible (matrix' X Y f)\"  and basis_X: \"is_basis (set_of_vector X)\" \n  and linear_f: \"linear ((*s)) ((*s)) f\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"invertible_lf ((*s)) ((*s)) f\"", "lemma invertible_matrix_is_change_of_basis:\n  assumes invertible_P: \"invertible P\" and basis_X: \"is_basis (set_of_vector X)\" \n  shows \"\\<exists>!Y. matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)\"", "lemma exists_basis: \"\\<exists>X::'a::{field}^'n^'n. is_basis (set_of_vector X)\"", "lemma equivalent_implies_exist_matrix':\n  assumes equivalent: \"equivalent_matrices A B\"\n  shows \"\\<exists>X Y X' Y' f::'a::{field}^'n\\<Rightarrow>'a^'m. \n  linear ((*s)) ((*s)) f \\<and> matrix' X Y f = A \\<and> matrix' X' Y' f = B \\<and> is_basis (set_of_vector X) \n  \\<and> is_basis (set_of_vector Y) \\<and> is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')\"", "lemma exist_matrix'_implies_equivalent:\n  assumes A: \"matrix' X Y f = A\"\n  and B: \"matrix' X' Y' f = B\"\n  and X: \"is_basis (set_of_vector X)\"\n  and Y: \"is_basis (set_of_vector Y)\" \n  and X': \"is_basis (set_of_vector X')\"\n  and Y': \"is_basis (set_of_vector Y')\"\n  and linear_f: \"linear ((*s)) ((*s)) f\"\n  shows \"equivalent_matrices A B\"", "lemma similar_implies_exist_matrix':\n  fixes A B::\"'a::{field}^'n^'n\"\n  assumes similar: \"similar_matrices A B\"\n  shows \"\\<exists>X Y f. linear ((*s)) ((*s)) f \\<and> matrix' X X f = A \\<and> matrix' Y Y f = B \n    \\<and> is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)\"", "lemma exist_matrix'_implies_similar:\n  fixes A B::\"'a::{field}^'n^'n\"\n  assumes linear_f: \"linear ((*s)) ((*s)) f\" and A: \"matrix' X X f = A\" and B: \"matrix' Y Y f = B\"\n  and X: \"is_basis (set_of_vector X)\" and Y: \"is_basis (set_of_vector Y)\"\n  shows \"similar_matrices A B\""], "translations": [["", "lemma \"((\\<lambda>(x, y). (x::real , - y::real)) has_derivative (\\<lambda>h. (fst h, - snd h))) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>(x, y). (x, - y)) has_derivative\n     (\\<lambda>h. (fst h, - snd h)))\n     (at x)", "apply (rule has_derivative_eq_rhs)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ((\\<lambda>(x, y). (x, - y)) has_derivative ?f') (at x)\n 2. ?f' = (\\<lambda>h. (fst h, - snd h))", "apply (rule has_derivative_split)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ((\\<lambda>p. (fst p, - snd p)) has_derivative ?f') (at x)\n 2. ?f' = (\\<lambda>h. (fst h, - snd h))", "apply (rule has_derivative_Pair)"], ["proof (prove)\ngoal (3 subgoals):\n 1. (fst has_derivative ?f'5) (at x)\n 2. ((\\<lambda>x. - snd x) has_derivative ?g'5) (at x)\n 3. (\\<lambda>h. (?f'5 h, ?g'5 h)) = (\\<lambda>h. (fst h, - snd h))", "by (auto intro!: derivative_eq_intros)"], ["", "subsection\\<open>Properties about ranks and linear maps\\<close>"], ["", "lemma rank_matrix_dim_range:\nassumes lf: \"linear ((*s)) ((*s)) f\"\nshows \"rank (matrix f::'a::{field}^'cols::{mod_type}^'rows::{mod_type}) = vec.dim (range f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank (matrix f) = vec.dim (range f)", "unfolding rank_col_rank[of \"matrix f\"] col_rank_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim (col_space (matrix f)) = vec.dim (range f)", "unfolding col_space_eq'"], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim (range ((*v) (matrix f))) = vec.dim (range f)", "using matrix_works[OF lf]"], ["proof (prove)\nusing this:\n  matrix f *v ?x = f ?x\n\ngoal (1 subgoal):\n 1. vec.dim (range ((*v) (matrix f))) = vec.dim (range f)", "by metis"], ["", "text\\<open>The following two lemmas are the demonstration of theorem 2.11 that appears the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "lemma linear_injective_rank_eq_ncols:\n  assumes lf: \"linear ((*s)) ((*s)) f\"\n  shows \"inj f \\<longleftrightarrow> rank (matrix f::'a::{field}^'cols::{mod_type}^'rows::{mod_type}) = ncols (matrix f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj f = (rank (matrix f) = ncols (matrix f))", "proof (rule)"], ["proof (state)\ngoal (2 subgoals):\n 1. inj f \\<Longrightarrow> rank (matrix f) = ncols (matrix f)\n 2. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "interpret lf: Vector_Spaces.linear \"((*s))\" \"((*s))\" f"], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) f", "using lf"], ["proof (prove)\nusing this:\n  linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) f", "by simp"], ["proof (state)\ngoal (2 subgoals):\n 1. inj f \\<Longrightarrow> rank (matrix f) = ncols (matrix f)\n 2. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "assume inj: \"inj f\""], ["proof (state)\nthis:\n  inj f\n\ngoal (2 subgoals):\n 1. inj f \\<Longrightarrow> rank (matrix f) = ncols (matrix f)\n 2. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "hence \"{x. f x = 0} = {0}\""], ["proof (prove)\nusing this:\n  inj f\n\ngoal (1 subgoal):\n 1. {x. f x = 0} = {0}", "using lf.linear_injective_ker_0"], ["proof (prove)\nusing this:\n  inj f\n  inj f = ({x. f x = 0} = {0})\n\ngoal (1 subgoal):\n 1. {x. f x = 0} = {0}", "by blast"], ["proof (state)\nthis:\n  {x. f x = 0} = {0}\n\ngoal (2 subgoals):\n 1. inj f \\<Longrightarrow> rank (matrix f) = ncols (matrix f)\n 2. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "hence \"vec.dim {x. f x = 0} = 0\""], ["proof (prove)\nusing this:\n  {x. f x = 0} = {0}\n\ngoal (1 subgoal):\n 1. vec.dim {x. f x = 0} = 0", "using vec.dim_zero_eq'"], ["proof (prove)\nusing this:\n  {x. f x = 0} = {0}\n  ?A = {} \\<or> ?A = {0} \\<Longrightarrow> vec.dim ?A = 0\n\ngoal (1 subgoal):\n 1. vec.dim {x. f x = 0} = 0", "by blast"], ["proof (state)\nthis:\n  vec.dim {x. f x = 0} = 0\n\ngoal (2 subgoals):\n 1. inj f \\<Longrightarrow> rank (matrix f) = ncols (matrix f)\n 2. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "thus \"rank (matrix f) = ncols (matrix f)\""], ["proof (prove)\nusing this:\n  vec.dim {x. f x = 0} = 0\n\ngoal (1 subgoal):\n 1. rank (matrix f) = ncols (matrix f)", "using vec.rank_nullity_theorem"], ["proof (prove)\nusing this:\n  vec.dim {x. f x = 0} = 0\n  linear (*s) ?scaleC ?f \\<Longrightarrow>\n  finite_dimensional_vector_space.dimension cart_basis =\n  vec.dim {x. ?f x = (0::?'c)} + vector_space.dim ?scaleC (range ?f)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = ncols (matrix f)", "unfolding ncols_def"], ["proof (prove)\nusing this:\n  vec.dim {x. f x = 0} = 0\n  linear (*s) ?scaleC ?f \\<Longrightarrow>\n  finite_dimensional_vector_space.dimension cart_basis =\n  vec.dim {x. ?f x = (0::?'c)} + vector_space.dim ?scaleC (range ?f)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = CARD('cols)", "using rank_matrix_dim_range[OF lf]"], ["proof (prove)\nusing this:\n  vec.dim {x. f x = 0} = 0\n  linear (*s) ?scaleC ?f \\<Longrightarrow>\n  finite_dimensional_vector_space.dimension cart_basis =\n  vec.dim {x. ?f x = (0::?'c)} + vector_space.dim ?scaleC (range ?f)\n  rank (matrix f) = vec.dim (range f)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = CARD('cols)", "by (metis add.left_neutral lf.linear_axioms vec.dim_UNIV vec.dimension_def vec_dim_card)"], ["proof (state)\nthis:\n  rank (matrix f) = ncols (matrix f)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "assume eq: \"rank (matrix f::'a::{field}^'cols::{mod_type}^'rows::{mod_type}) = ncols (matrix f)\""], ["proof (state)\nthis:\n  rank (matrix f) = ncols (matrix f)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "have \"vec.dim {x. f x = 0} = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim {x. f x = 0} = 0", "unfolding ncols_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim {x. f x = 0} = 0", "using rank_matrix_dim_range[OF lf] eq"], ["proof (prove)\nusing this:\n  rank (matrix f) = vec.dim (range f)\n  rank (matrix f) = ncols (matrix f)\n\ngoal (1 subgoal):\n 1. vec.dim {x. f x = 0} = 0", "by (metis cancel_comm_monoid_add_class.diff_cancel dim_null_space lf ncols_def\n        null_space_eq_ker vec.dim_UNIV vec.dimension_def vec_dim_card)"], ["proof (state)\nthis:\n  vec.dim {x. f x = 0} = 0\n\ngoal (1 subgoal):\n 1. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "hence \"{x. f x = 0} = {0}\""], ["proof (prove)\nusing this:\n  vec.dim {x. f x = 0} = 0\n\ngoal (1 subgoal):\n 1. {x. f x = 0} = {0}", "using vec.dim_zero_eq"], ["proof (prove)\nusing this:\n  vec.dim {x. f x = 0} = 0\n  vec.dim ?A = 0 \\<Longrightarrow> ?A = {} \\<or> ?A = {0}\n\ngoal (1 subgoal):\n 1. {x. f x = 0} = {0}", "using lf vec.linear_0"], ["proof (prove)\nusing this:\n  vec.dim {x. f x = 0} = 0\n  vec.dim ?A = 0 \\<Longrightarrow> ?A = {} \\<or> ?A = {0}\n  linear (*s) (*s) f\n  linear (*s) (*s) ?f \\<Longrightarrow> ?f 0 = 0\n\ngoal (1 subgoal):\n 1. {x. f x = 0} = {0}", "by auto"], ["proof (state)\nthis:\n  {x. f x = 0} = {0}\n\ngoal (1 subgoal):\n 1. rank (matrix f) = ncols (matrix f) \\<Longrightarrow> inj f", "thus \"inj f\""], ["proof (prove)\nusing this:\n  {x. f x = 0} = {0}\n\ngoal (1 subgoal):\n 1. inj f", "using vec.linear_injective_ker_0[of \"matrix f\"]"], ["proof (prove)\nusing this:\n  {x. f x = 0} = {0}\n  inj ((*v) (matrix f)) = ({x. matrix f *v x = 0} = {0})\n\ngoal (1 subgoal):\n 1. inj f", "unfolding matrix_vector_mul(1)[OF lf]"], ["proof (prove)\nusing this:\n  {x. f x = 0} = {0}\n  inj f = ({x. f x = 0} = {0})\n\ngoal (1 subgoal):\n 1. inj f", "by simp"], ["proof (state)\nthis:\n  inj f\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma linear_surjective_rank_eq_ncols:\n  assumes lf: \"linear ((*s)) ((*s)) f\"\n  shows \"surj f \\<longleftrightarrow> rank (matrix f::'a::{field}^'cols::{mod_type}^'rows::{mod_type}) = nrows (matrix f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. surj f = (rank (matrix f) = nrows (matrix f))", "proof (rule)"], ["proof (state)\ngoal (2 subgoals):\n 1. surj f \\<Longrightarrow> rank (matrix f) = nrows (matrix f)\n 2. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "assume surj: \"surj f\""], ["proof (state)\nthis:\n  surj f\n\ngoal (2 subgoals):\n 1. surj f \\<Longrightarrow> rank (matrix f) = nrows (matrix f)\n 2. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "have \"nrows (matrix f) = CARD ('rows)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. nrows (matrix f) = CARD('rows)", "unfolding nrows_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. CARD('rows) = CARD('rows)", ".."], ["proof (state)\nthis:\n  nrows (matrix f) = CARD('rows)\n\ngoal (2 subgoals):\n 1. surj f \\<Longrightarrow> rank (matrix f) = nrows (matrix f)\n 2. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "also"], ["proof (state)\nthis:\n  nrows (matrix f) = CARD('rows)\n\ngoal (2 subgoals):\n 1. surj f \\<Longrightarrow> rank (matrix f) = nrows (matrix f)\n 2. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "have \"... = vec.dim (range f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. CARD('rows) = vec.dim (range f)", "by (metis surj vec_dim_card)"], ["proof (state)\nthis:\n  CARD('rows) = vec.dim (range f)\n\ngoal (2 subgoals):\n 1. surj f \\<Longrightarrow> rank (matrix f) = nrows (matrix f)\n 2. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "also"], ["proof (state)\nthis:\n  CARD('rows) = vec.dim (range f)\n\ngoal (2 subgoals):\n 1. surj f \\<Longrightarrow> rank (matrix f) = nrows (matrix f)\n 2. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "have \"... = rank (matrix f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim (range f) = rank (matrix f)", "unfolding rank_matrix_dim_range[OF lf]"], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim (range f) = vec.dim (range f)", ".."], ["proof (state)\nthis:\n  vec.dim (range f) = rank (matrix f)\n\ngoal (2 subgoals):\n 1. surj f \\<Longrightarrow> rank (matrix f) = nrows (matrix f)\n 2. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "finally"], ["proof (chain)\npicking this:\n  nrows (matrix f) = rank (matrix f)", "show \"rank (matrix f) = nrows (matrix f)\""], ["proof (prove)\nusing this:\n  nrows (matrix f) = rank (matrix f)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = nrows (matrix f)", ".."], ["proof (state)\nthis:\n  rank (matrix f) = nrows (matrix f)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "assume \"rank (matrix f) = nrows (matrix f)\""], ["proof (state)\nthis:\n  rank (matrix f) = nrows (matrix f)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "hence \"vec.dim (range f) = CARD ('rows)\""], ["proof (prove)\nusing this:\n  rank (matrix f) = nrows (matrix f)\n\ngoal (1 subgoal):\n 1. vec.dim (range f) = CARD('rows)", "unfolding rank_matrix_dim_range[OF lf] nrows_def"], ["proof (prove)\nusing this:\n  vec.dim (range f) = CARD('rows)\n\ngoal (1 subgoal):\n 1. vec.dim (range f) = CARD('rows)", "."], ["proof (state)\nthis:\n  vec.dim (range f) = CARD('rows)\n\ngoal (1 subgoal):\n 1. rank (matrix f) = nrows (matrix f) \\<Longrightarrow> surj f", "thus \"surj f\""], ["proof (prove)\nusing this:\n  vec.dim (range f) = CARD('rows)\n\ngoal (1 subgoal):\n 1. surj f", "using vec.basis_exists independent_is_basis is_basis_def lf\n      vec.subspace_UNIV vec.subspace_image"], ["proof (prove)\nusing this:\n  vec.dim (range f) = CARD('rows)\n  (\\<And>B.\n      \\<lbrakk>B \\<subseteq> ?V; vec.independent B;\n       ?V \\<subseteq> vec.span B; card B = vec.dim ?V\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n  (vec.independent ?B \\<and> card ?B = CARD(?'n)) = is_basis ?B\n  is_basis ?S \\<equiv> vec.independent ?S \\<and> vec.span ?S = UNIV\n  linear (*s) (*s) f\n  vec.subspace UNIV\n  vec.subspace ?S \\<Longrightarrow> vec.subspace ((*v) ?A ` ?S)\n\ngoal (1 subgoal):\n 1. surj f", "by (metis col_space_eq' col_space_eq_range vec.span_subspace)"], ["proof (state)\nthis:\n  surj f\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma linear_bij_rank_eq_ncols:\n  fixes f::\"('a::{field}^'n::{mod_type})=>('a::{field}^'n::{mod_type})\"\n  assumes lf: \"linear ((*s)) ((*s)) f\"\n  shows \"bij f \\<longleftrightarrow> rank (matrix f) = ncols (matrix f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij f = (rank (matrix f) = ncols (matrix f))", "unfolding bij_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (inj f \\<and> surj f) = (rank (matrix f) = ncols (matrix f))", "using lf linear_injective_rank_eq_ncols vec.linear_inj_imp_surj"], ["proof (prove)\nusing this:\n  linear (*s) (*s) f\n  linear (*s) (*s) ?f \\<Longrightarrow>\n  inj ?f = (rank (matrix ?f) = ncols (matrix ?f))\n  \\<lbrakk>linear (*s) (*s) ?f; inj ?f\\<rbrakk> \\<Longrightarrow> surj ?f\n\ngoal (1 subgoal):\n 1. (inj f \\<and> surj f) = (rank (matrix f) = ncols (matrix f))", "by auto"], ["", "subsection\\<open>Invertible linear maps\\<close>"], ["", "locale invertible_lf = Vector_Spaces.linear +\n  assumes invertible: \"(\\<exists>g. g \\<circ> f = id \\<and> f \\<circ> g = id)\"\nbegin"], ["", "lemma invertible_lf: \"(\\<exists>g. linear ((*b)) ((*a)) g \\<and> (g \\<circ> f = id) \\<and> (f \\<circ> g = id))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       linear (*b) (*a) g \\<and> g \\<circ> f = id \\<and> f \\<circ> g = id", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       linear (*b) (*a) g \\<and> g \\<circ> f = id \\<and> f \\<circ> g = id", "have \"inj_on f UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj f", "using invertible"], ["proof (prove)\nusing this:\n  \\<exists>g. g \\<circ> f = id \\<and> f \\<circ> g = id\n\ngoal (1 subgoal):\n 1. inj f", "by (auto simp: o_def id_def inj_on_def fun_eq_iff) metis"], ["proof (state)\nthis:\n  inj f\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       linear (*b) (*a) g \\<and> g \\<circ> f = id \\<and> f \\<circ> g = id", "from linear_exists_left_inverse_on[OF linear_axioms vs1.subspace_UNIV this]"], ["proof (chain)\npicking this:\n  \\<exists>g.\n     range g \\<subseteq> UNIV \\<and>\n     linear (*b) (*a) g \\<and> (\\<forall>v\\<in>UNIV. g (f v) = v)", "obtain g where\n    g: \"linear (*b) (*a) g\" \"g o f = id\""], ["proof (prove)\nusing this:\n  \\<exists>g.\n     range g \\<subseteq> UNIV \\<and>\n     linear (*b) (*a) g \\<and> (\\<forall>v\\<in>UNIV. g (f v) = v)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>linear (*b) (*a) g; g \\<circ> f = id\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: fun_eq_iff id_def module_hom_iff_linear)"], ["proof (state)\nthis:\n  linear (*b) (*a) g\n  g \\<circ> f = id\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       linear (*b) (*a) g \\<and> g \\<circ> f = id \\<and> f \\<circ> g = id", "then"], ["proof (chain)\npicking this:\n  linear (*b) (*a) g\n  g \\<circ> f = id", "have \"f o g = id\""], ["proof (prove)\nusing this:\n  linear (*b) (*a) g\n  g \\<circ> f = id\n\ngoal (1 subgoal):\n 1. f \\<circ> g = id", "using invertible"], ["proof (prove)\nusing this:\n  linear (*b) (*a) g\n  g \\<circ> f = id\n  \\<exists>g. g \\<circ> f = id \\<and> f \\<circ> g = id\n\ngoal (1 subgoal):\n 1. f \\<circ> g = id", "by (auto simp: inj_on_def fun_eq_iff) metis"], ["proof (state)\nthis:\n  f \\<circ> g = id\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       linear (*b) (*a) g \\<and> g \\<circ> f = id \\<and> f \\<circ> g = id", "with g"], ["proof (chain)\npicking this:\n  linear (*b) (*a) g\n  g \\<circ> f = id\n  f \\<circ> g = id", "show ?thesis"], ["proof (prove)\nusing this:\n  linear (*b) (*a) g\n  g \\<circ> f = id\n  f \\<circ> g = id\n\ngoal (1 subgoal):\n 1. \\<exists>g.\n       linear (*b) (*a) g \\<and> g \\<circ> f = id \\<and> f \\<circ> g = id", "by auto"], ["proof (state)\nthis:\n  \\<exists>g.\n     linear (*b) (*a) g \\<and> g \\<circ> f = id \\<and> f \\<circ> g = id\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "lemma (in Vector_Spaces.linear) invertible_lf_intro[intro]:\n  assumes \"(g \\<circ> f = id)\"  and \"(f \\<circ> g = id)\"\n  shows \"invertible_lf ((*a)) ((*b)) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_lf (*a) (*b) f", "using assms"], ["proof (prove)\nusing this:\n  g \\<circ> f = id\n  f \\<circ> g = id\n\ngoal (1 subgoal):\n 1. invertible_lf (*a) (*b) f", "by unfold_locales auto"], ["", "lemma invertible_imp_bijective:\n  assumes \"invertible_lf scaleB scaleC f\"\n  shows \"bij f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij f", "using assms"], ["proof (prove)\nusing this:\n  invertible_lf scaleB scaleC f\n\ngoal (1 subgoal):\n 1. bij f", "unfolding invertible_lf_def invertible_lf_axioms_def"], ["proof (prove)\nusing this:\n  linear scaleB scaleC f \\<and>\n  (\\<exists>g. g \\<circ> f = id \\<and> f \\<circ> g = id)\n\ngoal (1 subgoal):\n 1. bij f", "by (metis bij_betw_comp_iff bij_betw_imp_surj inj_on_imageI2 inj_on_imp_bij_betw inv_id surj_id surj_imp_inj_inv)"], ["", "lemma invertible_matrix_imp_invertible_lf:\n  fixes A::\"'a::{field}^'n^'n\"\n  assumes invertible_A: \"invertible A\"\n  shows \"invertible_lf ((*s)) ((*s)) (\\<lambda>x. A *v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) ((*v) A)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) ((*v) A)", "obtain B where AB: \"A**B=mat 1\" and BA: \"B**A=mat 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>A ** B = mat (1::'a); B ** A = mat (1::'a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using invertible_A"], ["proof (prove)\nusing this:\n  invertible A\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>A ** B = mat (1::'a); B ** A = mat (1::'a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding invertible_def"], ["proof (prove)\nusing this:\n  \\<exists>A'. A ** A' = mat (1::'a) \\<and> A' ** A = mat (1::'a)\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>A ** B = mat (1::'a); B ** A = mat (1::'a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  A ** B = mat (1::'a)\n  B ** A = mat (1::'a)\n\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) ((*v) A)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) ((*v) A)", "proof (rule vec.invertible_lf_intro [of \"(\\<lambda>x. B *v x)\"])"], ["proof (state)\ngoal (2 subgoals):\n 1. (*v) B \\<circ> (*v) A = id\n 2. (*v) A \\<circ> (*v) B = id", "show id1: \"(*v) B \\<circ> (*v) A = id\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (*v) B \\<circ> (*v) A = id", "by (metis (hide_lams, no_types) AB BA isomorphism_expand matrix_vector_mul_assoc matrix_vector_mul_lid)"], ["proof (state)\nthis:\n  (*v) B \\<circ> (*v) A = id\n\ngoal (1 subgoal):\n 1. (*v) A \\<circ> (*v) B = id", "show \"(*v) A \\<circ> (*v) B = id\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (*v) A \\<circ> (*v) B = id", "by (metis (hide_lams, no_types) AB BA isomorphism_expand matrix_vector_mul_assoc matrix_vector_mul_lid)"], ["proof (state)\nthis:\n  (*v) A \\<circ> (*v) B = id\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  invertible_lf (*s) (*s) ((*v) A)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma invertible_lf_imp_invertible_matrix:\n  fixes f::\"'a::{field}^'n\\<Rightarrow>'a^'n\"\n  assumes invertible_f: \"invertible_lf ((*s)) ((*s)) f\"\n  shows \"invertible (matrix f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix f)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. invertible (matrix f)", "interpret i: invertible_lf \"((*s))\" \"((*s))\" f"], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) f", "using invertible_f"], ["proof (prove)\nusing this:\n  invertible_lf (*s) (*s) f\n\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) f", "."], ["proof (state)\ngoal (1 subgoal):\n 1. invertible (matrix f)", "obtain g where linear_g: \"linear ((*s)) ((*s))  g\" and gf: \"(g \\<circ> f = id)\" and fg: \"(f \\<circ> g = id)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>linear (*s) (*s) g; g \\<circ> f = id;\n         f \\<circ> g = id\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis invertible_f invertible_lf.invertible_lf)"], ["proof (state)\nthis:\n  linear (*s) (*s) g\n  g \\<circ> f = id\n  f \\<circ> g = id\n\ngoal (1 subgoal):\n 1. invertible (matrix f)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix f)", "proof (unfold invertible_def, rule exI[of _ \"matrix g\"], rule conjI)"], ["proof (state)\ngoal (2 subgoals):\n 1. matrix f ** matrix g = mat (1::'a)\n 2. matrix g ** matrix f = mat (1::'a)", "show \"matrix f ** matrix g = mat 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix f ** matrix g = mat (1::'a)", "unfolding matrix_eq matrix_vector_mul_assoc[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x. matrix f *v (matrix g *v x) = mat (1::'a) *v x", "by (metis i.linear_axioms matrix_vector_mul_lid pointfree_idE fg linear_g matrix_vector_mul)"], ["proof (state)\nthis:\n  matrix f ** matrix g = mat (1::'a)\n\ngoal (1 subgoal):\n 1. matrix g ** matrix f = mat (1::'a)", "show \"matrix g ** matrix f = mat 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix g ** matrix f = mat (1::'a)", "by (metis \\<open>matrix f ** matrix g = mat 1\\<close> matrix_left_right_inverse)"], ["proof (state)\nthis:\n  matrix g ** matrix f = mat (1::'a)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  invertible (matrix f)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma invertible_matrix_iff_invertible_lf:\n  fixes A::\"'a::{field}^'n^'n\"\n  shows \"invertible A \\<longleftrightarrow> invertible_lf ((*s)) ((*s)) (\\<lambda>x. A *v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible A = invertible_lf (*s) (*s) ((*v) A)", "by (metis invertible_lf_imp_invertible_matrix invertible_matrix_imp_invertible_lf matrix_of_matrix_vector_mul)"], ["", "lemma invertible_matrix_iff_invertible_lf':\n  fixes  f::\"'a::{field}^'n\\<Rightarrow>'a^'n\"\n  assumes linear_f: \"linear ((*s)) ((*s)) f\"\n  shows \"invertible (matrix f) \\<longleftrightarrow> invertible_lf ((*s)) ((*s)) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix f) = invertible_lf (*s) (*s) f", "by (metis (lifting) assms invertible_matrix_iff_invertible_lf matrix_vector_mul)"], ["", "lemma invertible_matrix_mult_right_rank:\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n    and Q::\"'a::{field}^'n::{mod_type}^'n::{mod_type}\"\n  assumes invertible_Q: \"invertible Q\"\n  shows \"rank (A**Q) = rank A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "define TQ where \"TQ x = Q *v x\" for x"], ["proof (state)\nthis:\n  TQ ?x = Q *v ?x\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "define TA where \"TA x = A *v x\" for x"], ["proof (state)\nthis:\n  TA ?x = A *v ?x\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "define TAQ where \"TAQ x = (A**Q) *v x\" for x"], ["proof (state)\nthis:\n  TAQ ?x = A ** Q *v ?x\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "have \"invertible_lf ((*s)) ((*s)) TQ\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) TQ", "using invertible_matrix_imp_invertible_lf[OF invertible_Q]"], ["proof (prove)\nusing this:\n  invertible_lf (*s) (*s) ((*v) Q)\n\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) TQ", "unfolding TQ_def"], ["proof (prove)\nusing this:\n  invertible_lf (*s) (*s) ((*v) Q)\n\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) ((*v) Q)", "."], ["proof (state)\nthis:\n  invertible_lf (*s) (*s) TQ\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "hence bij_TQ: \"bij TQ\""], ["proof (prove)\nusing this:\n  invertible_lf (*s) (*s) TQ\n\ngoal (1 subgoal):\n 1. bij TQ", "using invertible_imp_bijective"], ["proof (prove)\nusing this:\n  invertible_lf (*s) (*s) TQ\n  invertible_lf ?scaleB ?scaleC ?f \\<Longrightarrow> bij ?f\n\ngoal (1 subgoal):\n 1. bij TQ", "by auto"], ["proof (state)\nthis:\n  bij TQ\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "have \"range TAQ = range (TA \\<circ> TQ)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range TAQ = range (TA \\<circ> TQ)", "unfolding TQ_def TA_def TAQ_def o_def matrix_vector_mul_assoc"], ["proof (prove)\ngoal (1 subgoal):\n 1. range ((*v) (A ** Q)) = range ((*v) (A ** Q))", ".."], ["proof (state)\nthis:\n  range TAQ = range (TA \\<circ> TQ)\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "also"], ["proof (state)\nthis:\n  range TAQ = range (TA \\<circ> TQ)\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "have \"... = TA `(range TQ)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range (TA \\<circ> TQ) = TA ` range TQ", "unfolding fun.set_map"], ["proof (prove)\ngoal (1 subgoal):\n 1. TA ` range TQ = TA ` range TQ", ".."], ["proof (state)\nthis:\n  range (TA \\<circ> TQ) = TA ` range TQ\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "also"], ["proof (state)\nthis:\n  range (TA \\<circ> TQ) = TA ` range TQ\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "have \"... = TA ` (UNIV)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. TA ` range TQ = range TA", "using bij_is_surj[OF bij_TQ]"], ["proof (prove)\nusing this:\n  surj TQ\n\ngoal (1 subgoal):\n 1. TA ` range TQ = range TA", "by simp"], ["proof (state)\nthis:\n  TA ` range TQ = range TA\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "finally"], ["proof (chain)\npicking this:\n  range TAQ = range TA", "have \"range TAQ = range TA\""], ["proof (prove)\nusing this:\n  range TAQ = range TA\n\ngoal (1 subgoal):\n 1. range TAQ = range TA", "."], ["proof (state)\nthis:\n  range TAQ = range TA\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "thus ?thesis"], ["proof (prove)\nusing this:\n  range TAQ = range TA\n\ngoal (1 subgoal):\n 1. rank (A ** Q) = rank A", "unfolding rank_eq_dim_image"], ["proof (prove)\nusing this:\n  range TAQ = range TA\n\ngoal (1 subgoal):\n 1. vec.dim (range ((*v) (A ** Q))) = vec.dim (range ((*v) A))", "using TAQ_def [abs_def] TA_def [abs_def]"], ["proof (prove)\nusing this:\n  range TAQ = range TA\n  TAQ \\<equiv> (*v) (A ** Q)\n  TA \\<equiv> (*v) A\n\ngoal (1 subgoal):\n 1. vec.dim (range ((*v) (A ** Q))) = vec.dim (range ((*v) A))", "by auto"], ["proof (state)\nthis:\n  rank (A ** Q) = rank A\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma subspace_image_invertible_mat:\n  fixes P::\"'a::{field}^'m^'m\"\n  assumes inv_P: \"invertible P\"\n    and sub_W: \"vec.subspace W\"\n  shows \"vec.subspace ((\\<lambda>x. P *v x)` W)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.subspace ((*v) P ` W)", "using assms"], ["proof (prove)\nusing this:\n  invertible P\n  vec.subspace W\n\ngoal (1 subgoal):\n 1. vec.subspace ((*v) P ` W)", "by (intro vec.subspace_image)"], ["", "lemma dim_image_invertible_mat:\n  fixes P::\"'a::{field}^'m^'m\"\n  assumes inv_P: \"invertible P\"\n  and sub_W: \"vec.subspace W\"\n  shows \"vec.dim ((\\<lambda>x. P *v x)` W) = vec.dim W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "obtain B where B_in_W: \"B\\<subseteq>W\" and ind_B: \"vec.independent B\" \n    and W_in_span_B: \"W \\<subseteq> vec.span B\" and card_B_eq_dim_W: \"card B = vec.dim W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>B \\<subseteq> W; vec.independent B;\n         W \\<subseteq> vec.span B; card B = vec.dim W\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using vec.basis_exists"], ["proof (prove)\nusing this:\n  (\\<And>B.\n      \\<lbrakk>B \\<subseteq> ?V; vec.independent B;\n       ?V \\<subseteq> vec.span B; card B = vec.dim ?V\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>B \\<subseteq> W; vec.independent B;\n         W \\<subseteq> vec.span B; card B = vec.dim W\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  B \\<subseteq> W\n  vec.independent B\n  W \\<subseteq> vec.span B\n  card B = vec.dim W\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "define L where \"L = (\\<lambda>x. P *v x)\""], ["proof (state)\nthis:\n  L = (*v) P\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "define C where \"C = L`B\""], ["proof (state)\nthis:\n  C = L ` B\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "have finite_B: \"finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite B", "using vec.indep_card_eq_dim_span[OF ind_B]"], ["proof (prove)\nusing this:\n  finite B \\<and> card B = vec.dim (vec.span B)\n\ngoal (1 subgoal):\n 1. finite B", "by simp"], ["proof (state)\nthis:\n  finite B\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "interpret L: Vector_Spaces.linear \"(*s)\" \"(*s)\" L"], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) L", "using matrix_vector_mul_linear_gen"], ["proof (prove)\nusing this:\n  linear (*s) (*s) ((*v) ?A)\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) L", "unfolding L_def"], ["proof (prove)\nusing this:\n  linear (*s) (*s) ((*v) ?A)\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) ((*v) P)", "."], ["proof (state)\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "have finite_C: \"finite C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite C", "using vec.indep_card_eq_dim_span[OF ind_B]"], ["proof (prove)\nusing this:\n  finite B \\<and> card B = vec.dim (vec.span B)\n\ngoal (1 subgoal):\n 1. finite C", "unfolding C_def"], ["proof (prove)\nusing this:\n  finite B \\<and> card B = vec.dim (vec.span B)\n\ngoal (1 subgoal):\n 1. finite (L ` B)", "by simp"], ["proof (state)\nthis:\n  finite C\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "have inv_TP: \"invertible_lf ((*s)) ((*s)) (\\<lambda>x. P *v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) ((*v) P)", "using invertible_matrix_imp_invertible_lf[OF inv_P]"], ["proof (prove)\nusing this:\n  invertible_lf (*s) (*s) ((*v) P)\n\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) ((*v) P)", "."], ["proof (state)\nthis:\n  invertible_lf (*s) (*s) ((*v) P)\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "have inj_on_LW: \"inj_on L W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on L W", "using invertible_imp_bijective[OF inv_TP]"], ["proof (prove)\nusing this:\n  bij ((*v) P)\n\ngoal (1 subgoal):\n 1. inj_on L W", "unfolding bij_def L_def"], ["proof (prove)\nusing this:\n  inj ((*v) P) \\<and> surj ((*v) P)\n\ngoal (1 subgoal):\n 1. inj_on ((*v) P) W", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>UNIV.\n      \\<forall>y\\<in>UNIV. P *v x = P *v y \\<longrightarrow> x = y) \\<and>\n  surj ((*v) P)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>W.\n       \\<forall>y\\<in>W. P *v x = P *v y \\<longrightarrow> x = y", "by blast"], ["proof (state)\nthis:\n  inj_on L W\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "hence inj_on_LB: \"inj_on L B\""], ["proof (prove)\nusing this:\n  inj_on L W\n\ngoal (1 subgoal):\n 1. inj_on L B", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>W. \\<forall>y\\<in>W. L x = L y \\<longrightarrow> x = y\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>B. \\<forall>y\\<in>B. L x = L y \\<longrightarrow> x = y", "using B_in_W"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>W. \\<forall>y\\<in>W. L x = L y \\<longrightarrow> x = y\n  B \\<subseteq> W\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>B. \\<forall>y\\<in>B. L x = L y \\<longrightarrow> x = y", "by auto"], ["proof (state)\nthis:\n  inj_on L B\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "have ind_D: \"vec.independent C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.independent C", "proof (rule vec.independent_if_scalars_zero[OF finite_C])"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "fix f x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "assume sum: \"(\\<Sum>x\\<in>C. f x *s x) = 0\" and x: \"x \\<in> C\""], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>C. f x *s x) = 0\n  x \\<in> C\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "obtain y where Ly_eq_x: \"L y = x\" and y: \"y \\<in> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>L y = x; y \\<in> B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using x"], ["proof (prove)\nusing this:\n  x \\<in> C\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>L y = x; y \\<in> B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding C_def L_def"], ["proof (prove)\nusing this:\n  x \\<in> (*v) P ` B\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>P *v y = x; y \\<in> B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  L y = x\n  y \\<in> B\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "have \"(\\<Sum>x\\<in>C. f x *s x) = sum ((\\<lambda>x. f x *s x) \\<circ> L) B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>C. f x *s x) = sum ((\\<lambda>x. f x *s x) \\<circ> L) B", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>L ` B. f x *s x) = sum ((\\<lambda>x. f x *s x) \\<circ> L) B", "by (rule sum.reindex[OF inj_on_LB])"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>C. f x *s x) = sum ((\\<lambda>x. f x *s x) \\<circ> L) B\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>C. f x *s x) = sum ((\\<lambda>x. f x *s x) \\<circ> L) B\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "have \"... = sum (\\<lambda>x. f (L x) *s L x) B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum ((\\<lambda>x. f x *s x) \\<circ> L) B =\n    (\\<Sum>x\\<in>B. f (L x) *s L x)", "unfolding o_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. f (L x) *s L x) = (\\<Sum>x\\<in>B. f (L x) *s L x)", ".."], ["proof (state)\nthis:\n  sum ((\\<lambda>x. f x *s x) \\<circ> L) B = (\\<Sum>x\\<in>B. f (L x) *s L x)\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "also"], ["proof (state)\nthis:\n  sum ((\\<lambda>x. f x *s x) \\<circ> L) B = (\\<Sum>x\\<in>B. f (L x) *s L x)\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "have \"... =  sum (\\<lambda>x. ((f \\<circ> L) x) *s L x) B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. f (L x) *s L x) =\n    (\\<Sum>x\\<in>B. (f \\<circ> L) x *s L x)", "using o_def"], ["proof (prove)\nusing this:\n  ?f \\<circ> ?g = (\\<lambda>x. ?f (?g x))\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. f (L x) *s L x) =\n    (\\<Sum>x\\<in>B. (f \\<circ> L) x *s L x)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>B. f (L x) *s L x) = (\\<Sum>x\\<in>B. (f \\<circ> L) x *s L x)\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>B. f (L x) *s L x) = (\\<Sum>x\\<in>B. (f \\<circ> L) x *s L x)\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "have \"... = L (sum (\\<lambda>x. ((f \\<circ> L) x) *s x) B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. (f \\<circ> L) x *s L x) =\n    L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)", "by (simp add: L.sum L.scale)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s L x) =\n  L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>C. f x *s x) = L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)", "have rw: \" (\\<Sum>x\\<in>C. f x *s x) = L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>C. f x *s x) = L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>C. f x *s x) = L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)", "."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>C. f x *s x) = L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "have \"(\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) \\<in> W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) \\<in> W", "by (rule vec.subspace_sum[OF sub_W])\n        (simp add: B_in_W rev_subsetD sub_W vec.subspace_scale)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) \\<in> W\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "hence \"(\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)=0\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) \\<in> W\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0", "using sum rw"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) \\<in> W\n  (\\<Sum>x\\<in>C. f x *s x) = 0\n  (\\<Sum>x\\<in>C. f x *s x) = L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0", "using vec.linear_inj_on_iff_eq_0[OF L.linear_axioms sub_W]"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) \\<in> W\n  (\\<Sum>x\\<in>C. f x *s x) = 0\n  (\\<Sum>x\\<in>C. f x *s x) = L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)\n  inj_on L W = (\\<forall>x\\<in>W. L x = 0 \\<longrightarrow> x = 0)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0", "using inj_on_LW"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) \\<in> W\n  (\\<Sum>x\\<in>C. f x *s x) = 0\n  (\\<Sum>x\\<in>C. f x *s x) = L (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x)\n  inj_on L W = (\\<forall>x\\<in>W. L x = 0 \\<longrightarrow> x = 0)\n  inj_on L W\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0", "by (auto simp: L_def)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "hence \"(f \\<circ> L) y = 0\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0\n\ngoal (1 subgoal):\n 1. (f \\<circ> L) y = (0::'a)", "using vec.scalars_zero_if_independent[OF finite_B ind_B, of \"(f \\<circ> L)\"]"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0 \\<Longrightarrow>\n  \\<forall>x\\<in>B. (f \\<circ> L) x = (0::'a)\n\ngoal (1 subgoal):\n 1. (f \\<circ> L) y = (0::'a)", "using y"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0\n  (\\<Sum>x\\<in>B. (f \\<circ> L) x *s x) = 0 \\<Longrightarrow>\n  \\<forall>x\\<in>B. (f \\<circ> L) x = (0::'a)\n  y \\<in> B\n\ngoal (1 subgoal):\n 1. (f \\<circ> L) y = (0::'a)", "by auto"], ["proof (state)\nthis:\n  (f \\<circ> L) y = (0::'a)\n\ngoal (1 subgoal):\n 1. \\<And>f x.\n       \\<lbrakk>(\\<Sum>x\\<in>C. f x *s x) = 0; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f x = (0::'a)", "thus \"f x = 0\""], ["proof (prove)\nusing this:\n  (f \\<circ> L) y = (0::'a)\n\ngoal (1 subgoal):\n 1. f x = (0::'a)", "unfolding o_def Ly_eq_x"], ["proof (prove)\nusing this:\n  f x = (0::'a)\n\ngoal (1 subgoal):\n 1. f x = (0::'a)", "."], ["proof (state)\nthis:\n  f x = (0::'a)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  vec.independent C\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "have \"L` W \\<subseteq> vec.span C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L ` W \\<subseteq> vec.span C", "proof (unfold vec.span_finite[OF finite_C], clarify)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       xa \\<in> W \\<Longrightarrow>\n       L xa \\<in> range (\\<lambda>u. \\<Sum>v\\<in>C. u v *s v)", "fix xa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       xa \\<in> W \\<Longrightarrow>\n       L xa \\<in> range (\\<lambda>u. \\<Sum>v\\<in>C. u v *s v)", "assume xa_in_W: \"xa \\<in> W\""], ["proof (state)\nthis:\n  xa \\<in> W\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       xa \\<in> W \\<Longrightarrow>\n       L xa \\<in> range (\\<lambda>u. \\<Sum>v\\<in>C. u v *s v)", "obtain g where sum_g: \"sum (\\<lambda>x. g x *s x) B = xa\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>B. g x *s x) = xa \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using vec.span_finite[OF finite_B] W_in_span_B xa_in_W"], ["proof (prove)\nusing this:\n  vec.span B = range (\\<lambda>u. \\<Sum>v\\<in>B. u v *s v)\n  W \\<subseteq> vec.span B\n  xa \\<in> W\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>B. g x *s x) = xa \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>B. g x *s x) = xa\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       xa \\<in> W \\<Longrightarrow>\n       L xa \\<in> range (\\<lambda>u. \\<Sum>v\\<in>C. u v *s v)", "show \"L xa \\<in> range (\\<lambda>u. (\\<Sum>v\\<in>C. u v *s v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L xa \\<in> range (\\<lambda>u. \\<Sum>v\\<in>C. u v *s v)", "proof (rule image_eqI[where x=\"\\<lambda>x. g (THE y. y \\<in> B \\<and> x=L y)\"])"], ["proof (state)\ngoal (2 subgoals):\n 1. L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)\n 2. (\\<lambda>x. g (THE y. y \\<in> B \\<and> x = L y)) \\<in> UNIV", "have \"L xa = L (sum (\\<lambda>x. g x *s x) B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L xa = L (\\<Sum>x\\<in>B. g x *s x)", "using sum_g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>B. g x *s x) = xa\n\ngoal (1 subgoal):\n 1. L xa = L (\\<Sum>x\\<in>B. g x *s x)", "by simp"], ["proof (state)\nthis:\n  L xa = L (\\<Sum>x\\<in>B. g x *s x)\n\ngoal (2 subgoals):\n 1. L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)\n 2. (\\<lambda>x. g (THE y. y \\<in> B \\<and> x = L y)) \\<in> UNIV", "also"], ["proof (state)\nthis:\n  L xa = L (\\<Sum>x\\<in>B. g x *s x)\n\ngoal (2 subgoals):\n 1. L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)\n 2. (\\<lambda>x. g (THE y. y \\<in> B \\<and> x = L y)) \\<in> UNIV", "have \"... = sum (\\<lambda>x. g x *s L x) B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L (\\<Sum>x\\<in>B. g x *s x) = (\\<Sum>x\\<in>B. g x *s L x)", "by (simp add: L.sum L.scale)"], ["proof (state)\nthis:\n  L (\\<Sum>x\\<in>B. g x *s x) = (\\<Sum>x\\<in>B. g x *s L x)\n\ngoal (2 subgoals):\n 1. L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)\n 2. (\\<lambda>x. g (THE y. y \\<in> B \\<and> x = L y)) \\<in> UNIV", "also"], ["proof (state)\nthis:\n  L (\\<Sum>x\\<in>B. g x *s x) = (\\<Sum>x\\<in>B. g x *s L x)\n\ngoal (2 subgoals):\n 1. L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)\n 2. (\\<lambda>x. g (THE y. y \\<in> B \\<and> x = L y)) \\<in> UNIV", "have \"... = sum (\\<lambda>x. g (THE y. y \\<in> B \\<and> x=L y) *s x) (L`B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>B. g x *s L x) =\n    (\\<Sum>x\\<in>L ` B. g (THE y. y \\<in> B \\<and> x = L y) *s x)", "proof (unfold sum.reindex[OF inj_on_LB], unfold o_def, rule sum.cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. B = B\n 2. \\<And>x.\n       x \\<in> B \\<Longrightarrow>\n       g x *s L x = g (THE y. y \\<in> B \\<and> L x = L y) *s L x", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. B = B\n 2. \\<And>x.\n       x \\<in> B \\<Longrightarrow>\n       g x *s L x = g (THE y. y \\<in> B \\<and> L x = L y) *s L x", "assume x_in_B: \"x\\<in>B\""], ["proof (state)\nthis:\n  x \\<in> B\n\ngoal (2 subgoals):\n 1. B = B\n 2. \\<And>x.\n       x \\<in> B \\<Longrightarrow>\n       g x *s L x = g (THE y. y \\<in> B \\<and> L x = L y) *s L x", "have x_eq_the:\"x = (THE y. y \\<in> B \\<and> L x = L y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = (THE y. y \\<in> B \\<and> L x = L y)", "proof (rule the_equality[symmetric])"], ["proof (state)\ngoal (2 subgoals):\n 1. x \\<in> B \\<and> L x = L x\n 2. \\<And>y. y \\<in> B \\<and> L x = L y \\<Longrightarrow> y = x", "show \"x \\<in> B \\<and> L x = L x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> B \\<and> L x = L x", "using x_in_B"], ["proof (prove)\nusing this:\n  x \\<in> B\n\ngoal (1 subgoal):\n 1. x \\<in> B \\<and> L x = L x", "by auto"], ["proof (state)\nthis:\n  x \\<in> B \\<and> L x = L x\n\ngoal (1 subgoal):\n 1. \\<And>y. y \\<in> B \\<and> L x = L y \\<Longrightarrow> y = x", "show \"\\<And>y. y \\<in> B \\<and> L x = L y \\<Longrightarrow> y = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y. y \\<in> B \\<and> L x = L y \\<Longrightarrow> y = x", "using inj_on_LB x_in_B"], ["proof (prove)\nusing this:\n  inj_on L B\n  x \\<in> B\n\ngoal (1 subgoal):\n 1. \\<And>y. y \\<in> B \\<and> L x = L y \\<Longrightarrow> y = x", "unfolding inj_on_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>B. \\<forall>y\\<in>B. L x = L y \\<longrightarrow> x = y\n  x \\<in> B\n\ngoal (1 subgoal):\n 1. \\<And>y. y \\<in> B \\<and> L x = L y \\<Longrightarrow> y = x", "by fast"], ["proof (state)\nthis:\n  ?y \\<in> B \\<and> L x = L ?y \\<Longrightarrow> ?y = x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x = (THE y. y \\<in> B \\<and> L x = L y)\n\ngoal (2 subgoals):\n 1. B = B\n 2. \\<And>x.\n       x \\<in> B \\<Longrightarrow>\n       g x *s L x = g (THE y. y \\<in> B \\<and> L x = L y) *s L x", "show \"g x *s L x = g (THE y. y \\<in> B \\<and> L x = L y) *s L x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g x *s L x = g (THE y. y \\<in> B \\<and> L x = L y) *s L x", "using x_eq_the"], ["proof (prove)\nusing this:\n  x = (THE y. y \\<in> B \\<and> L x = L y)\n\ngoal (1 subgoal):\n 1. g x *s L x = g (THE y. y \\<in> B \\<and> L x = L y) *s L x", "by simp"], ["proof (state)\nthis:\n  g x *s L x = g (THE y. y \\<in> B \\<and> L x = L y) *s L x\n\ngoal (1 subgoal):\n 1. B = B", "qed rule"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>B. g x *s L x) =\n  (\\<Sum>x\\<in>L ` B. g (THE y. y \\<in> B \\<and> x = L y) *s x)\n\ngoal (2 subgoals):\n 1. L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)\n 2. (\\<lambda>x. g (THE y. y \\<in> B \\<and> x = L y)) \\<in> UNIV", "finally"], ["proof (chain)\npicking this:\n  L xa = (\\<Sum>x\\<in>L ` B. g (THE y. y \\<in> B \\<and> x = L y) *s x)", "show \"L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)\""], ["proof (prove)\nusing this:\n  L xa = (\\<Sum>x\\<in>L ` B. g (THE y. y \\<in> B \\<and> x = L y) *s x)\n\ngoal (1 subgoal):\n 1. L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)", "unfolding C_def"], ["proof (prove)\nusing this:\n  L xa = (\\<Sum>x\\<in>L ` B. g (THE y. y \\<in> B \\<and> x = L y) *s x)\n\ngoal (1 subgoal):\n 1. L xa = (\\<Sum>v\\<in>L ` B. g (THE y. y \\<in> B \\<and> v = L y) *s v)", "by simp"], ["proof (state)\nthis:\n  L xa = (\\<Sum>v\\<in>C. g (THE y. y \\<in> B \\<and> v = L y) *s v)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. g (THE y. y \\<in> B \\<and> x = L y)) \\<in> UNIV", "qed rule"], ["proof (state)\nthis:\n  L xa \\<in> range (\\<lambda>u. \\<Sum>v\\<in>C. u v *s v)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  L ` W \\<subseteq> vec.span C\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "have \"card C = card B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card C = card B", "using card_image[OF inj_on_LB]"], ["proof (prove)\nusing this:\n  card (L ` B) = card B\n\ngoal (1 subgoal):\n 1. card C = card B", "unfolding C_def"], ["proof (prove)\nusing this:\n  card (L ` B) = card B\n\ngoal (1 subgoal):\n 1. card (L ` B) = card B", "."], ["proof (state)\nthis:\n  card C = card B\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "thus ?thesis"], ["proof (prove)\nusing this:\n  card C = card B\n\ngoal (1 subgoal):\n 1. vec.dim ((*v) P ` W) = vec.dim W", "by (metis B_in_W C_def L.span_image W_in_span_B \\<open>L \\<equiv> (*v) P\\<close> card_B_eq_dim_W ind_D sub_W\n        vec.indep_card_eq_dim_span vec.span_subspace)"], ["proof (state)\nthis:\n  vec.dim ((*v) P ` W) = vec.dim W\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma invertible_matrix_mult_left_rank:\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n  and P::\"'a::{field}^'m::{mod_type}^'m::{mod_type}\"\n  assumes invertible_P: \"invertible P\"\n  shows \"rank (P**A) = rank A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "define TP where \"TP = (\\<lambda>x. P *v x)\""], ["proof (state)\nthis:\n  TP = (*v) P\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "define TA where \"TA = (\\<lambda>x. A *v x)\""], ["proof (state)\nthis:\n  TA = (*v) A\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "define TPA where \"TPA = (\\<lambda>x. (P**A) *v x)\""], ["proof (state)\nthis:\n  TPA = (*v) (P ** A)\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "have sub: \"vec.subspace (range ((*v) A))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.subspace (range ((*v) A))", "by (metis vec.subspace_UNIV vec.subspace_image)"], ["proof (state)\nthis:\n  vec.subspace (range ((*v) A))\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "have \"vec.dim (range TPA) = vec.dim (range (TP \\<circ> TA))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim (range TPA) = vec.dim (range (TP \\<circ> TA))", "unfolding TP_def TA_def TPA_def o_def matrix_vector_mul_assoc"], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim (range ((*v) (P ** A))) = vec.dim (range ((*v) (P ** A)))", ".."], ["proof (state)\nthis:\n  vec.dim (range TPA) = vec.dim (range (TP \\<circ> TA))\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "also"], ["proof (state)\nthis:\n  vec.dim (range TPA) = vec.dim (range (TP \\<circ> TA))\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "have \"... = vec.dim (range TA)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.dim (range (TP \\<circ> TA)) = vec.dim (range TA)", "using dim_image_invertible_mat[OF invertible_P sub]"], ["proof (prove)\nusing this:\n  vec.dim ((*v) P ` range ((*v) A)) = vec.dim (range ((*v) A))\n\ngoal (1 subgoal):\n 1. vec.dim (range (TP \\<circ> TA)) = vec.dim (range TA)", "unfolding TP_def TA_def o_def fun.set_map[symmetric]"], ["proof (prove)\nusing this:\n  vec.dim (range (\\<lambda>x. P *v (A *v x))) = vec.dim (range ((*v) A))\n\ngoal (1 subgoal):\n 1. vec.dim (range (\\<lambda>x. P *v (A *v x))) = vec.dim (range ((*v) A))", "."], ["proof (state)\nthis:\n  vec.dim (range (TP \\<circ> TA)) = vec.dim (range TA)\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "finally"], ["proof (chain)\npicking this:\n  vec.dim (range TPA) = vec.dim (range TA)", "show ?thesis"], ["proof (prove)\nusing this:\n  vec.dim (range TPA) = vec.dim (range TA)\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "unfolding rank_eq_dim_image TPA_def TA_def"], ["proof (prove)\nusing this:\n  vec.dim (range ((*v) (P ** A))) = vec.dim (range ((*v) A))\n\ngoal (1 subgoal):\n 1. vec.dim (range ((*v) (P ** A))) = vec.dim (range ((*v) A))", "."], ["proof (state)\nthis:\n  rank (P ** A) = rank A\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary invertible_matrices_mult_rank:\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n  and P::\"'a^'m::{mod_type}^'m::{mod_type}\" and Q::\"'a^'n::{mod_type}^'n::{mod_type}\"\n  assumes invertible_P: \"invertible P\" \n  and invertible_Q: \"invertible Q\"\n  shows \"rank (P**A**Q) = rank A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank (P ** A ** Q) = rank A", "using invertible_matrix_mult_right_rank[OF invertible_Q]"], ["proof (prove)\nusing this:\n  rank (?A ** Q) = rank ?A\n\ngoal (1 subgoal):\n 1. rank (P ** A ** Q) = rank A", "using invertible_matrix_mult_left_rank[OF invertible_P]"], ["proof (prove)\nusing this:\n  rank (?A ** Q) = rank ?A\n  rank (P ** ?A) = rank ?A\n\ngoal (1 subgoal):\n 1. rank (P ** A ** Q) = rank A", "by metis"], ["", "lemma invertible_matrix_mult_left_rank':\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" and P::\"'a^'m::{mod_type}^'m::{mod_type}\"\n  assumes invertible_P: \"invertible P\" and B_eq_PA: \"B=P**A\"\n  shows \"rank B = rank A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank B = rank A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. rank B = rank A", "have \"rank B = rank (P**A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank B = rank (P ** A)", "using B_eq_PA"], ["proof (prove)\nusing this:\n  B = P ** A\n\ngoal (1 subgoal):\n 1. rank B = rank (P ** A)", "by auto"], ["proof (state)\nthis:\n  rank B = rank (P ** A)\n\ngoal (1 subgoal):\n 1. rank B = rank A", "also"], ["proof (state)\nthis:\n  rank B = rank (P ** A)\n\ngoal (1 subgoal):\n 1. rank B = rank A", "have \"... = rank A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "using invertible_matrix_mult_left_rank[OF invertible_P]"], ["proof (prove)\nusing this:\n  rank (P ** ?A) = rank ?A\n\ngoal (1 subgoal):\n 1. rank (P ** A) = rank A", "by auto"], ["proof (state)\nthis:\n  rank (P ** A) = rank A\n\ngoal (1 subgoal):\n 1. rank B = rank A", "finally"], ["proof (chain)\npicking this:\n  rank B = rank A", "show ?thesis"], ["proof (prove)\nusing this:\n  rank B = rank A\n\ngoal (1 subgoal):\n 1. rank B = rank A", "."], ["proof (state)\nthis:\n  rank B = rank A\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma invertible_matrix_mult_right_rank':\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n  and Q::\"'a::{field}^'n::{mod_type}^'n::{mod_type}\"\n  assumes invertible_Q: \"invertible Q\" and B_eq_PA: \"B=A**Q\"\n  shows \"rank B = rank A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank B = rank A", "by (metis B_eq_PA invertible_Q invertible_matrix_mult_right_rank)"], ["", "lemma invertible_matrices_rank':\n  fixes A::\"'a::{field}^'n::{mod_type}^'m::{mod_type}\" \n  and P::\"'a^'m::{mod_type}^'m::{mod_type}\" and Q::\"'a^'n::{mod_type}^'n::{mod_type}\"\n  assumes invertible_P: \"invertible P\" and invertible_Q: \"invertible Q\" and B_eq_PA: \"B = P**A**Q\"\n  shows \"rank B = rank A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rank B = rank A", "by (metis B_eq_PA invertible_P invertible_Q invertible_matrices_mult_rank)"], ["", "subsection\\<open>Definition and properties of the set of a vector\\<close>"], ["", "text\\<open>Some definitions:\\<close>"], ["", "text\\<open>In the file \\<open>Generalizations.thy\\<close> there exists the following definition: \n  @{thm \"cart_basis_def\"}.\\<close>"], ["", "text\\<open>\\<open>cart_basis\\<close> returns a set which is a basis and it works properly in my development.\n  But in this file, I need to know the order of the elements of the basis, because is very important\n  for the coordenates of a vector and the matrices of change of bases. So, I have defined a new\n  \\<open>cart_basis'\\<close>, which will be a matrix. The columns of this matrix are the elements of\n  the basis.\\<close>"], ["", "definition set_of_vector :: \"'a^'n \\<Rightarrow> 'a set\"\n  where \"set_of_vector A = {A $ i |i. i \\<in> UNIV}\""], ["", "definition cart_basis' :: \" 'a::{field}^'n^'n\"\n  where \"cart_basis' = (\\<chi> i. axis i 1)\""], ["", "lemma cart_basis_eq_set_of_vector_cart_basis': \n  \"cart_basis = set_of_vector (cart_basis')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cart_basis = set_of_vector cart_basis'", "unfolding cart_basis_def cart_basis'_def set_of_vector_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {axis i (1::'a) |i. i \\<in> UNIV} =\n    {(\\<chi>i. axis i (1::'a)) $ i |i. i \\<in> UNIV}", "by auto"], ["", "lemma basis_image_linear:\n  fixes f::\"'b::{field}^'n => 'b^'n\"\n  assumes invertible_lf: \"invertible_lf ((*s)) ((*s)) f\"\n  and basis_X: \"is_basis (set_of_vector X)\"\n  shows \"is_basis (f` (set_of_vector X))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (f ` set_of_vector X)", "proof (rule iffD1[OF independent_is_basis], rule conjI)"], ["proof (state)\ngoal (2 subgoals):\n 1. vec.independent (f ` set_of_vector X)\n 2. card (f ` set_of_vector X) = CARD('n)", "have \"card (f ` set_of_vector X) = card (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (f ` set_of_vector X) = card (set_of_vector X)", "by (rule card_image[of f \"set_of_vector X\"], metis invertible_imp_bijective[OF invertible_lf] bij_def inj_eq inj_on_def)"], ["proof (state)\nthis:\n  card (f ` set_of_vector X) = card (set_of_vector X)\n\ngoal (2 subgoals):\n 1. vec.independent (f ` set_of_vector X)\n 2. card (f ` set_of_vector X) = CARD('n)", "also"], ["proof (state)\nthis:\n  card (f ` set_of_vector X) = card (set_of_vector X)\n\ngoal (2 subgoals):\n 1. vec.independent (f ` set_of_vector X)\n 2. card (f ` set_of_vector X) = CARD('n)", "have \"... = card (UNIV::'n set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "using basis_X"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "unfolding independent_is_basis[symmetric]"], ["proof (prove)\nusing this:\n  vec.independent (set_of_vector X) \\<and> card (set_of_vector X) = CARD('n)\n\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "by auto"], ["proof (state)\nthis:\n  card (set_of_vector X) = CARD('n)\n\ngoal (2 subgoals):\n 1. vec.independent (f ` set_of_vector X)\n 2. card (f ` set_of_vector X) = CARD('n)", "finally"], ["proof (chain)\npicking this:\n  card (f ` set_of_vector X) = CARD('n)", "show \"card (f ` set_of_vector X) = card (UNIV::'n set)\""], ["proof (prove)\nusing this:\n  card (f ` set_of_vector X) = CARD('n)\n\ngoal (1 subgoal):\n 1. card (f ` set_of_vector X) = CARD('n)", "."], ["proof (state)\nthis:\n  card (f ` set_of_vector X) = CARD('n)\n\ngoal (1 subgoal):\n 1. vec.independent (f ` set_of_vector X)", "interpret Vector_Spaces.linear \"(*s)\" \"(*s)\" f"], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) f", "using invertible_lf"], ["proof (prove)\nusing this:\n  invertible_lf (*s) (*s) f\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) f", "unfolding invertible_lf_def"], ["proof (prove)\nusing this:\n  linear (*s) (*s) f \\<and> invertible_lf_axioms f\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) f", "by simp"], ["proof (state)\ngoal (1 subgoal):\n 1. vec.independent (f ` set_of_vector X)", "show \"vec.independent (f ` set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.independent (f ` set_of_vector X)", "proof (rule independent_injective_image)"], ["proof (state)\ngoal (2 subgoals):\n 1. vec.independent (set_of_vector X)\n 2. inj_on f (vec.span (set_of_vector X))", "show \"vec.independent (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "using basis_X"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "unfolding is_basis_def"], ["proof (prove)\nusing this:\n  vec.independent (set_of_vector X) \\<and> vec.span (set_of_vector X) = UNIV\n\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "by simp"], ["proof (state)\nthis:\n  vec.independent (set_of_vector X)\n\ngoal (1 subgoal):\n 1. inj_on f (vec.span (set_of_vector X))", "show \"inj_on f (vec.span (set_of_vector X))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on f (vec.span (set_of_vector X))", "by (metis bij_def injD inj_onI invertible_imp_bijective invertible_lf)"], ["proof (state)\nthis:\n  inj_on f (vec.span (set_of_vector X))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  vec.independent (f ` set_of_vector X)\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>Properties about @{thm \"cart_basis'_def\"}\\<close>"], ["", "lemma set_of_vector_cart_basis': \n  shows \"(set_of_vector cart_basis') = {axis i 1 :: 'a::{field}^'n | i. i \\<in> (UNIV :: 'n set)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_of_vector cart_basis' = {axis i (1::'a) |i. i \\<in> UNIV}", "unfolding set_of_vector_def cart_basis'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(\\<chi>i. axis i (1::'a)) $ i |i. i \\<in> UNIV} =\n    {axis i (1::'a) |i. i \\<in> UNIV}", "by auto"], ["", "lemma cart_basis'_i: \"cart_basis' $ i = axis i 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cart_basis' $ i = axis i (1::'a)", "unfolding cart_basis'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<chi>i. axis i (1::'a)) $ i = axis i (1::'a)", "by simp"], ["", "lemma finite_set_of_vector[intro,simp]: \"finite (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (set_of_vector X)", "unfolding set_of_vector_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {X $ i |i. i \\<in> UNIV}", "using finite_Atleast_Atmost_nat[of \"\\<lambda>i. X $ i\"]"], ["proof (prove)\nusing this:\n  finite {X $ x |x. x \\<in> UNIV}\n\ngoal (1 subgoal):\n 1. finite {X $ i |i. i \\<in> UNIV}", "."], ["", "lemma is_basis_cart_basis': \"is_basis (set_of_vector cart_basis')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis')", "unfolding cart_basis_eq_set_of_vector_cart_basis'[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis cart_basis", "by (metis Miscellaneous.is_basis_def independent_cart_basis span_cart_basis)"], ["", "lemma basis_expansion_cart_basis':\"sum (\\<lambda>i. x$i *s cart_basis' $ i) UNIV = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. x $ i *s cart_basis' $ i) = x", "unfolding cart_basis'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. x $ i *s (\\<chi>i. axis i (1::'a)) $ i) = x", "using basis_expansion"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?x $ i *s axis i (1::?'a)) = ?x\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. x $ i *s (\\<chi>i. axis i (1::'a)) $ i) = x", "by auto"], ["", "lemma basis_expansion_unique:\n  \"sum (\\<lambda>i. f i *s axis (i::'n::finite) 1) UNIV = (x::('a::comm_ring_1) ^'n) \\<longleftrightarrow> (\\<forall>i. f i = x$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) = x) =\n    (\\<forall>i. f i = x $ i)", "proof (auto simp add: basis_expansion)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       x = (\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) \\<Longrightarrow>\n       f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", "fix i::\"'n\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       x = (\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) \\<Longrightarrow>\n       f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", "have univ_rw: \"UNIV = (UNIV - {i}) \\<union> {i}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. UNIV = UNIV - {i} \\<union> {i}", "by fastforce"], ["proof (state)\nthis:\n  UNIV = UNIV - {i} \\<union> {i}\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       x = (\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) \\<Longrightarrow>\n       f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", "have \"(\\<Sum>x\\<in>UNIV. f x * axis x 1 $ i) = sum (\\<lambda>x.  f x * axis x 1 $ i) (UNIV - {i} \\<union> {i})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i) =\n    (\\<Sum>x\\<in>UNIV - {i} \\<union> {i}. f x * axis x (1::'a) $ i)", "using univ_rw"], ["proof (prove)\nusing this:\n  UNIV = UNIV - {i} \\<union> {i}\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i) =\n    (\\<Sum>x\\<in>UNIV - {i} \\<union> {i}. f x * axis x (1::'a) $ i)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i) =\n  (\\<Sum>x\\<in>UNIV - {i} \\<union> {i}. f x * axis x (1::'a) $ i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       x = (\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) \\<Longrightarrow>\n       f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i) =\n  (\\<Sum>x\\<in>UNIV - {i} \\<union> {i}. f x * axis x (1::'a) $ i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       x = (\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) \\<Longrightarrow>\n       f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", "have \"... = sum (\\<lambda>x.  f x * axis x 1 $ i) (UNIV - {i}) +  sum (\\<lambda>x.  f x * axis x 1 $ i) {i}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV - {i} \\<union> {i}. f x * axis x (1::'a) $ i) =\n    (\\<Sum>x\\<in>UNIV - {i}. f x * axis x (1::'a) $ i) +\n    (\\<Sum>x\\<in>{i}. f x * axis x (1::'a) $ i)", "by (rule sum.union_disjoint, auto)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV - {i} \\<union> {i}. f x * axis x (1::'a) $ i) =\n  (\\<Sum>x\\<in>UNIV - {i}. f x * axis x (1::'a) $ i) +\n  (\\<Sum>x\\<in>{i}. f x * axis x (1::'a) $ i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       x = (\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) \\<Longrightarrow>\n       f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV - {i} \\<union> {i}. f x * axis x (1::'a) $ i) =\n  (\\<Sum>x\\<in>UNIV - {i}. f x * axis x (1::'a) $ i) +\n  (\\<Sum>x\\<in>{i}. f x * axis x (1::'a) $ i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       x = (\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) \\<Longrightarrow>\n       f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", "have \"... = f i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV - {i}. f x * axis x (1::'a) $ i) +\n    (\\<Sum>x\\<in>{i}. f x * axis x (1::'a) $ i) =\n    f i", "unfolding axis_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV - {i}.\n       f x * (\\<chi>i. if i = x then 1::'a else (0::'a)) $ i) +\n    (\\<Sum>x\\<in>{i}.\n       f x * (\\<chi>i. if i = x then 1::'a else (0::'a)) $ i) =\n    f i", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV - {i}. f x * axis x (1::'a) $ i) +\n  (\\<Sum>x\\<in>{i}. f x * axis x (1::'a) $ i) =\n  f i\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       x = (\\<Sum>i\\<in>UNIV. f i *s axis i (1::'a)) \\<Longrightarrow>\n       f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i) = f i", "show \"f i = (\\<Sum>x\\<in>UNIV. f x * axis x 1 $ i)\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i) = f i\n\ngoal (1 subgoal):\n 1. f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)", ".."], ["proof (state)\nthis:\n  f i = (\\<Sum>x\\<in>UNIV. f x * axis x (1::'a) $ i)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma basis_expansion_cart_basis'_unique: \"sum (\\<lambda>i. f (cart_basis' $ i) *s cart_basis' $ i) UNIV = x \\<longleftrightarrow> (\\<forall>i. f (cart_basis' $ i) = x$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<Sum>i\\<in>UNIV. f (cart_basis' $ i) *s cart_basis' $ i) = x) =\n    (\\<forall>i. f (cart_basis' $ i) = x $ i)", "using basis_expansion_unique"], ["proof (prove)\nusing this:\n  ((\\<Sum>i\\<in>UNIV. ?f i *s axis i (1::?'a)) = ?x) =\n  (\\<forall>i. ?f i = ?x $ i)\n\ngoal (1 subgoal):\n 1. ((\\<Sum>i\\<in>UNIV. f (cart_basis' $ i) *s cart_basis' $ i) = x) =\n    (\\<forall>i. f (cart_basis' $ i) = x $ i)", "unfolding cart_basis'_def"], ["proof (prove)\nusing this:\n  ((\\<Sum>i\\<in>UNIV. ?f i *s axis i (1::?'a)) = ?x) =\n  (\\<forall>i. ?f i = ?x $ i)\n\ngoal (1 subgoal):\n 1. ((\\<Sum>i\\<in>UNIV.\n        f ((\\<chi>i. axis i (1::'c)) $ i) *s\n        (\\<chi>i. axis i (1::'a)) $ i) =\n     x) =\n    (\\<forall>i. f ((\\<chi>i. axis i (1::'c)) $ i) = x $ i)", "by (simp add: vec_eq_iff if_distrib cong del: if_weak_cong)"], ["", "lemma basis_expansion_cart_basis'_unique': \"sum (\\<lambda>i. f i *s cart_basis' $ i) UNIV = x \\<longleftrightarrow> (\\<forall>i. f i = x$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<Sum>i\\<in>UNIV. f i *s cart_basis' $ i) = x) =\n    (\\<forall>i. f i = x $ i)", "using basis_expansion_unique"], ["proof (prove)\nusing this:\n  ((\\<Sum>i\\<in>UNIV. ?f i *s axis i (1::?'a)) = ?x) =\n  (\\<forall>i. ?f i = ?x $ i)\n\ngoal (1 subgoal):\n 1. ((\\<Sum>i\\<in>UNIV. f i *s cart_basis' $ i) = x) =\n    (\\<forall>i. f i = x $ i)", "unfolding cart_basis'_def"], ["proof (prove)\nusing this:\n  ((\\<Sum>i\\<in>UNIV. ?f i *s axis i (1::?'a)) = ?x) =\n  (\\<forall>i. ?f i = ?x $ i)\n\ngoal (1 subgoal):\n 1. ((\\<Sum>i\\<in>UNIV. f i *s (\\<chi>i. axis i (1::'a)) $ i) = x) =\n    (\\<forall>i. f i = x $ i)", "by (simp add: vec_eq_iff if_distrib cong del: if_weak_cong)"], ["", "text\\<open>Properties of @{thm \"is_basis_def\"}.\\<close>"], ["", "lemma sum_basis_eq:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis:\"is_basis  (set_of_vector X)\"\n  shows \"sum (\\<lambda>x. f x *s x) (set_of_vector X) = sum (\\<lambda>i. f (X$i) *s (X$i)) UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)", "have card_set_of_vector:\"card(set_of_vector X) = CARD('n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "using independent_is_basis[of \"set_of_vector X\"]"], ["proof (prove)\nusing this:\n  (vec.independent (set_of_vector X) \\<and>\n   card (set_of_vector X) = CARD('n)) =\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "using is_basis"], ["proof (prove)\nusing this:\n  (vec.independent (set_of_vector X) \\<and>\n   card (set_of_vector X) = CARD('n)) =\n  is_basis (set_of_vector X)\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "by auto"], ["proof (state)\nthis:\n  card (set_of_vector X) = CARD('n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)", "have fact_1: \"set_of_vector X = range (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_of_vector X = range (($) X)", "unfolding set_of_vector_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {X $ i |i. i \\<in> UNIV} = range (($) X)", "by auto"], ["proof (state)\nthis:\n  set_of_vector X = range (($) X)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)", "have inj: \"inj (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj (($) X)", "proof (rule eq_card_imp_inj_on)"], ["proof (state)\ngoal (2 subgoals):\n 1. finite UNIV\n 2. card (range (($) X)) = CARD('n)", "show \"finite (UNIV::'n set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite UNIV", "using finite_class.finite_UNIV"], ["proof (prove)\nusing this:\n  finite UNIV\n\ngoal (1 subgoal):\n 1. finite UNIV", "."], ["proof (state)\nthis:\n  finite UNIV\n\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "show \"card (range (($) X)) = card (UNIV::'n set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "using card_set_of_vector"], ["proof (prove)\nusing this:\n  card (set_of_vector X) = CARD('n)\n\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "using fact_1"], ["proof (prove)\nusing this:\n  card (set_of_vector X) = CARD('n)\n  set_of_vector X = range (($) X)\n\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "unfolding set_of_vector_def"], ["proof (prove)\nusing this:\n  card {X $ i |i. i \\<in> UNIV} = CARD('n)\n  {X $ i |i. i \\<in> UNIV} = range (($) X)\n\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "by simp"], ["proof (state)\nthis:\n  card (range (($) X)) = CARD('n)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj (($) X)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)", "using sum.reindex[OF inj, of \"(\\<lambda>x. f x *s x)\", unfolded o_def]"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>range (($) X). f x *s x) =\n  (\\<Sum>x\\<in>UNIV. f (X $ x) *s X $ x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)", "unfolding fact_1"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>range (($) X). f x *s x) =\n  (\\<Sum>x\\<in>UNIV. f (X $ x) *s X $ x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>range (($) X). f x *s x) =\n    (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)", "."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n  (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i)\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary sum_basis_eq2:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis:\"is_basis  (set_of_vector X)\"\n  shows \"sum (\\<lambda>x. f x *s x) (set_of_vector X) = sum (\\<lambda>i. (f \\<circ> ($) X) i *s (X$i)) UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. (f \\<circ> ($) X) i *s X $ i)", "using sum_basis_eq[OF is_basis]"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>set_of_vector X. ?f x *s x) =\n  (\\<Sum>i\\<in>UNIV. ?f (X $ i) *s X $ i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>set_of_vector X. f x *s x) =\n    (\\<Sum>i\\<in>UNIV. (f \\<circ> ($) X) i *s X $ i)", "by simp"], ["", "lemma inj_op_nth:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis: \"is_basis (set_of_vector X)\"\n  shows \"inj (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj (($) X)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. inj (($) X)", "have fact_1: \"set_of_vector X = range (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_of_vector X = range (($) X)", "unfolding set_of_vector_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {X $ i |i. i \\<in> UNIV} = range (($) X)", "by auto"], ["proof (state)\nthis:\n  set_of_vector X = range (($) X)\n\ngoal (1 subgoal):\n 1. inj (($) X)", "have card_set_of_vector:\"card(set_of_vector X) = CARD('n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "using independent_is_basis[of \"set_of_vector X\"]"], ["proof (prove)\nusing this:\n  (vec.independent (set_of_vector X) \\<and>\n   card (set_of_vector X) = CARD('n)) =\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "using is_basis"], ["proof (prove)\nusing this:\n  (vec.independent (set_of_vector X) \\<and>\n   card (set_of_vector X) = CARD('n)) =\n  is_basis (set_of_vector X)\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "by auto"], ["proof (state)\nthis:\n  card (set_of_vector X) = CARD('n)\n\ngoal (1 subgoal):\n 1. inj (($) X)", "show \"inj (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj (($) X)", "proof (rule eq_card_imp_inj_on)"], ["proof (state)\ngoal (2 subgoals):\n 1. finite UNIV\n 2. card (range (($) X)) = CARD('n)", "show \"finite (UNIV::'n set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite UNIV", "using finite_class.finite_UNIV"], ["proof (prove)\nusing this:\n  finite UNIV\n\ngoal (1 subgoal):\n 1. finite UNIV", "."], ["proof (state)\nthis:\n  finite UNIV\n\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "show \"card (range (($) X)) = card (UNIV::'n set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "using card_set_of_vector"], ["proof (prove)\nusing this:\n  card (set_of_vector X) = CARD('n)\n\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "using fact_1"], ["proof (prove)\nusing this:\n  card (set_of_vector X) = CARD('n)\n  set_of_vector X = range (($) X)\n\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "unfolding set_of_vector_def"], ["proof (prove)\nusing this:\n  card {X $ i |i. i \\<in> UNIV} = CARD('n)\n  {X $ i |i. i \\<in> UNIV} = range (($) X)\n\ngoal (1 subgoal):\n 1. card (range (($) X)) = CARD('n)", "by simp"], ["proof (state)\nthis:\n  card (range (($) X)) = CARD('n)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj (($) X)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma basis_UNIV:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis: \"is_basis (set_of_vector X)\"\n  shows \"UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X$i) = x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}", "have \"UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>(set_of_vector X). g i *s i) = x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>set_of_vector X. g i *s i) = x}", "using vec.span_finite[OF basis_finite[OF is_basis]]"], ["proof (prove)\nusing this:\n  vec.span (set_of_vector X) =\n  range (\\<lambda>u. \\<Sum>v\\<in>set_of_vector X. u v *s v)\n\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>set_of_vector X. g i *s i) = x}", "using is_basis"], ["proof (prove)\nusing this:\n  vec.span (set_of_vector X) =\n  range (\\<lambda>u. \\<Sum>v\\<in>set_of_vector X. u v *s v)\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>set_of_vector X. g i *s i) = x}", "unfolding is_basis_def"], ["proof (prove)\nusing this:\n  vec.span (set_of_vector X) =\n  range (\\<lambda>u. \\<Sum>v\\<in>set_of_vector X. u v *s v)\n  vec.independent (set_of_vector X) \\<and> vec.span (set_of_vector X) = UNIV\n\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>set_of_vector X. g i *s i) = x}", "by (auto simp: set_eq_iff\n        intro!: vec.sum_representation_eq exI[where x=\"vec.representation (set_of_vector X) x\" for x])"], ["proof (state)\nthis:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>set_of_vector X. g i *s i) = x}\n\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}", "also"], ["proof (state)\nthis:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>set_of_vector X. g i *s i) = x}\n\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}", "have \"... \\<subseteq> {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X$i) = x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. \\<exists>g. (\\<Sum>i\\<in>set_of_vector X. g i *s i) = x}\n    \\<subseteq> {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}", "proof (clarify)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x g.\n       \\<exists>ga.\n          (\\<Sum>i\\<in>UNIV. ga i *s X $ i) =\n          (\\<Sum>i\\<in>set_of_vector X. g i *s i)", "fix f"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x g.\n       \\<exists>ga.\n          (\\<Sum>i\\<in>UNIV. ga i *s X $ i) =\n          (\\<Sum>i\\<in>set_of_vector X. g i *s i)", "show \"\\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = (\\<Sum>i\\<in>set_of_vector X. f i *s i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g.\n       (\\<Sum>i\\<in>UNIV. g i *s X $ i) =\n       (\\<Sum>i\\<in>set_of_vector X. f i *s i)", "proof (rule exI[of _ \"(\\<lambda>i. (f \\<circ> ($) X) i)\"], unfold o_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) =\n    (\\<Sum>i\\<in>set_of_vector X. f i *s i)", "have fact_1: \"set_of_vector X = range (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_of_vector X = range (($) X)", "unfolding set_of_vector_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {X $ i |i. i \\<in> UNIV} = range (($) X)", "by auto"], ["proof (state)\nthis:\n  set_of_vector X = range (($) X)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) =\n    (\\<Sum>i\\<in>set_of_vector X. f i *s i)", "have card_set_of_vector:\"card(set_of_vector X) = CARD('n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "using independent_is_basis[of \"set_of_vector X\"]"], ["proof (prove)\nusing this:\n  (vec.independent (set_of_vector X) \\<and>\n   card (set_of_vector X) = CARD('n)) =\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "using is_basis"], ["proof (prove)\nusing this:\n  (vec.independent (set_of_vector X) \\<and>\n   card (set_of_vector X) = CARD('n)) =\n  is_basis (set_of_vector X)\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. card (set_of_vector X) = CARD('n)", "by auto"], ["proof (state)\nthis:\n  card (set_of_vector X) = CARD('n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) =\n    (\\<Sum>i\\<in>set_of_vector X. f i *s i)", "have inj: \"inj (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj (($) X)", "using inj_op_nth[OF is_basis]"], ["proof (prove)\nusing this:\n  inj (($) X)\n\ngoal (1 subgoal):\n 1. inj (($) X)", "."], ["proof (state)\nthis:\n  inj (($) X)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) =\n    (\\<Sum>i\\<in>set_of_vector X. f i *s i)", "show \" (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) = (\\<Sum>i\\<in>set_of_vector X. f i *s i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) =\n    (\\<Sum>i\\<in>set_of_vector X. f i *s i)", "using sum.reindex[symmetric, OF inj, of \"\\<lambda>i. f i *s i\"]"], ["proof (prove)\nusing this:\n  sum ((\\<lambda>i. f i *s i) \\<circ> ($) X) UNIV =\n  (\\<Sum>i\\<in>range (($) X). f i *s i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) =\n    (\\<Sum>i\\<in>set_of_vector X. f i *s i)", "unfolding fact_1"], ["proof (prove)\nusing this:\n  sum ((\\<lambda>i. f i *s i) \\<circ> ($) X) UNIV =\n  (\\<Sum>i\\<in>range (($) X). f i *s i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) =\n    (\\<Sum>i\\<in>range (($) X). f i *s i)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. f (X $ i) *s X $ i) =\n  (\\<Sum>i\\<in>set_of_vector X. f i *s i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>g.\n     (\\<Sum>i\\<in>UNIV. g i *s X $ i) =\n     (\\<Sum>i\\<in>set_of_vector X. f i *s i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  {x. \\<exists>g. (\\<Sum>i\\<in>set_of_vector X. g i *s i) = x}\n  \\<subseteq> {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}", "finally"], ["proof (chain)\npicking this:\n  UNIV \\<subseteq> {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}", "show ?thesis"], ["proof (prove)\nusing this:\n  UNIV \\<subseteq> {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}", "by auto"], ["proof (state)\nthis:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma scalars_zero_if_basis:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes is_basis: \"is_basis (set_of_vector X)\" and sum: \"(\\<Sum>i\\<in>(UNIV::'n set). f i *s X$i) = 0\"\n  shows \"\\<forall>i\\<in>(UNIV::'n set). f i = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "have ind_X: \"vec.independent (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "using is_basis"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "unfolding is_basis_def"], ["proof (prove)\nusing this:\n  vec.independent (set_of_vector X) \\<and> vec.span (set_of_vector X) = UNIV\n\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "by simp"], ["proof (state)\nthis:\n  vec.independent (set_of_vector X)\n\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "have finite_X:\"finite (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (set_of_vector X)", "using basis_finite[OF is_basis]"], ["proof (prove)\nusing this:\n  finite (set_of_vector X)\n\ngoal (1 subgoal):\n 1. finite (set_of_vector X)", "."], ["proof (state)\nthis:\n  finite (set_of_vector X)\n\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "have 1: \"(\\<forall>g. (\\<Sum>v\\<in>(set_of_vector X). g v *s v) = 0 \\<longrightarrow> (\\<forall>v\\<in>(set_of_vector X). g v = 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>g.\n       (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0 \\<longrightarrow>\n       (\\<forall>v\\<in>set_of_vector X. g v = (0::'a))", "using ind_X"], ["proof (prove)\nusing this:\n  vec.independent (set_of_vector X)\n\ngoal (1 subgoal):\n 1. \\<forall>g.\n       (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0 \\<longrightarrow>\n       (\\<forall>v\\<in>set_of_vector X. g v = (0::'a))", "unfolding vec.independent_explicit"], ["proof (prove)\nusing this:\n  finite (set_of_vector X) \\<and>\n  (\\<forall>c.\n      (\\<Sum>v\\<in>set_of_vector X. c v *s v) = 0 \\<longrightarrow>\n      (\\<forall>v\\<in>set_of_vector X. c v = (0::'a)))\n\ngoal (1 subgoal):\n 1. \\<forall>g.\n       (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0 \\<longrightarrow>\n       (\\<forall>v\\<in>set_of_vector X. g v = (0::'a))", "using finite_X"], ["proof (prove)\nusing this:\n  finite (set_of_vector X) \\<and>\n  (\\<forall>c.\n      (\\<Sum>v\\<in>set_of_vector X. c v *s v) = 0 \\<longrightarrow>\n      (\\<forall>v\\<in>set_of_vector X. c v = (0::'a)))\n  finite (set_of_vector X)\n\ngoal (1 subgoal):\n 1. \\<forall>g.\n       (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0 \\<longrightarrow>\n       (\\<forall>v\\<in>set_of_vector X. g v = (0::'a))", "by auto"], ["proof (state)\nthis:\n  \\<forall>g.\n     (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0 \\<longrightarrow>\n     (\\<forall>v\\<in>set_of_vector X. g v = (0::'a))\n\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "define g where \"g v = f (THE i. X $ i = v)\" for v"], ["proof (state)\nthis:\n  g ?v = f (THE i. X $ i = ?v)\n\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "have \"(\\<Sum>v\\<in>(set_of_vector X). g v *s v) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0", "have \"(\\<Sum>v\\<in>(set_of_vector X). g v *s v)  = (\\<Sum>i\\<in>(UNIV::'n set). f i *s X$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "have inj: \"inj (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj (($) X)", "using inj_op_nth[OF is_basis]"], ["proof (prove)\nusing this:\n  inj (($) X)\n\ngoal (1 subgoal):\n 1. inj (($) X)", "."], ["proof (state)\nthis:\n  inj (($) X)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "have rw: \"set_of_vector X = range (($) X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_of_vector X = range (($) X)", "unfolding set_of_vector_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {X $ i |i. i \\<in> UNIV} = range (($) X)", "by auto"], ["proof (state)\nthis:\n  set_of_vector X = range (($) X)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "{"], ["proof (state)\nthis:\n  set_of_vector X = range (($) X)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "fix a"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "have \"f a = g (X $ a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f a = g (X $ a)", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. f a = f (THE i. X $ i = X $ a)", "using inj_op_nth[OF is_basis]"], ["proof (prove)\nusing this:\n  inj (($) X)\n\ngoal (1 subgoal):\n 1. f a = f (THE i. X $ i = X $ a)", "by (metis (lifting, mono_tags) injD the_equality)"], ["proof (state)\nthis:\n  f a = g (X $ a)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "}"], ["proof (state)\nthis:\n  f ?a2 = g (X $ ?a2)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "thus ?thesis"], ["proof (prove)\nusing this:\n  f ?a2 = g (X $ ?a2)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "using sum.reindex[OF inj, of \"\\<lambda>v. g v *s v\"]"], ["proof (prove)\nusing this:\n  f ?a2 = g (X $ ?a2)\n  (\\<Sum>v\\<in>range (($) X). g v *s v) =\n  sum ((\\<lambda>v. g v *s v) \\<circ> ($) X) UNIV\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) =\n    (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "unfolding rw o_def"], ["proof (prove)\nusing this:\n  f ?a2 = g (X $ ?a2)\n  (\\<Sum>v\\<in>range (($) X). g v *s v) =\n  (\\<Sum>x\\<in>UNIV. g (X $ x) *s X $ x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>range (($) X). g v *s v) = (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>v\\<in>set_of_vector X. g v *s v) = (\\<Sum>i\\<in>UNIV. f i *s X $ i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>v\\<in>set_of_vector X. g v *s v) = (\\<Sum>i\\<in>UNIV. f i *s X $ i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>v\\<in>set_of_vector X. g v *s v) = (\\<Sum>i\\<in>UNIV. f i *s X $ i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0", "unfolding sum"], ["proof (prove)\nusing this:\n  (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0", "."], ["proof (state)\nthis:\n  (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0\n\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "hence 2: \"\\<forall>v\\<in>(set_of_vector X). g v = 0\""], ["proof (prove)\nusing this:\n  (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0\n\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>set_of_vector X. g v = (0::'a)", "using 1"], ["proof (prove)\nusing this:\n  (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0\n  \\<forall>g.\n     (\\<Sum>v\\<in>set_of_vector X. g v *s v) = 0 \\<longrightarrow>\n     (\\<forall>v\\<in>set_of_vector X. g v = (0::'a))\n\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>set_of_vector X. g v = (0::'a)", "by auto"], ["proof (state)\nthis:\n  \\<forall>v\\<in>set_of_vector X. g v = (0::'a)\n\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. f i = (0::'a)", "proof (clarify)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i. i \\<in> UNIV \\<Longrightarrow> f i = (0::'a)", "fix a"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i. i \\<in> UNIV \\<Longrightarrow> f i = (0::'a)", "have \"g (X$a) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g (X $ a) = (0::'a)", "using 2"], ["proof (prove)\nusing this:\n  \\<forall>v\\<in>set_of_vector X. g v = (0::'a)\n\ngoal (1 subgoal):\n 1. g (X $ a) = (0::'a)", "unfolding set_of_vector_def"], ["proof (prove)\nusing this:\n  \\<forall>v\\<in>{X $ i |i. i \\<in> UNIV}. g v = (0::'a)\n\ngoal (1 subgoal):\n 1. g (X $ a) = (0::'a)", "by auto"], ["proof (state)\nthis:\n  g (X $ a) = (0::'a)\n\ngoal (1 subgoal):\n 1. \\<And>i. i \\<in> UNIV \\<Longrightarrow> f i = (0::'a)", "thus \"f a = 0\""], ["proof (prove)\nusing this:\n  g (X $ a) = (0::'a)\n\ngoal (1 subgoal):\n 1. f a = (0::'a)", "unfolding g_def"], ["proof (prove)\nusing this:\n  f (THE i. X $ i = X $ a) = (0::'a)\n\ngoal (1 subgoal):\n 1. f a = (0::'a)", "using inj_op_nth[OF is_basis]"], ["proof (prove)\nusing this:\n  f (THE i. X $ i = X $ a) = (0::'a)\n  inj (($) X)\n\ngoal (1 subgoal):\n 1. f a = (0::'a)", "by (metis (lifting, mono_tags) injD the_equality)"], ["proof (state)\nthis:\n  f a = (0::'a)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>i\\<in>UNIV. f i = (0::'a)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma basis_combination_unique:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and sum_eq: \"(\\<Sum>i\\<in>UNIV. g i *s X$i) = (\\<Sum>i\\<in>UNIV. f i *s X$i)\"\n  shows \"f=g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f = g", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "assume \"f\\<noteq>g\""], ["proof (state)\nthis:\n  f \\<noteq> g\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "from this"], ["proof (chain)\npicking this:\n  f \\<noteq> g", "obtain x where fx_gx: \"f x \\<noteq> g x\""], ["proof (prove)\nusing this:\n  f \\<noteq> g\n\ngoal (1 subgoal):\n 1. (\\<And>x. f x \\<noteq> g x \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fast"], ["proof (state)\nthis:\n  f x \\<noteq> g x\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "have \"0=(\\<Sum>i\\<in>UNIV. g i *s X$i) - (\\<Sum>i\\<in>UNIV. f i *s X$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 = (\\<Sum>i\\<in>UNIV. g i *s X $ i) - (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "using sum_eq"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. g i *s X $ i) = (\\<Sum>i\\<in>UNIV. f i *s X $ i)\n\ngoal (1 subgoal):\n 1. 0 = (\\<Sum>i\\<in>UNIV. g i *s X $ i) - (\\<Sum>i\\<in>UNIV. f i *s X $ i)", "by simp"], ["proof (state)\nthis:\n  0 = (\\<Sum>i\\<in>UNIV. g i *s X $ i) - (\\<Sum>i\\<in>UNIV. f i *s X $ i)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  0 = (\\<Sum>i\\<in>UNIV. g i *s X $ i) - (\\<Sum>i\\<in>UNIV. f i *s X $ i)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "have \"... = (\\<Sum>i\\<in>UNIV. g i *s X$i - f i *s X$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. g i *s X $ i) - (\\<Sum>i\\<in>UNIV. f i *s X $ i) =\n    (\\<Sum>i\\<in>UNIV. g i *s X $ i - f i *s X $ i)", "unfolding sum_subtractf[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s X $ x - f x *s X $ x) =\n    (\\<Sum>i\\<in>UNIV. g i *s X $ i - f i *s X $ i)", ".."], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. g i *s X $ i) - (\\<Sum>i\\<in>UNIV. f i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. g i *s X $ i - f i *s X $ i)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. g i *s X $ i) - (\\<Sum>i\\<in>UNIV. f i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. g i *s X $ i - f i *s X $ i)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "have \"... = (\\<Sum>i\\<in>UNIV. (g i - f i) *s X$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. g i *s X $ i - f i *s X $ i) =\n    (\\<Sum>i\\<in>UNIV. (g i - f i) *s X $ i)", "by (rule sum.cong, auto simp add: scaleR_diff_left)"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. g i *s X $ i - f i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. (g i - f i) *s X $ i)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. g i *s X $ i - f i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. (g i - f i) *s X $ i)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "have \"... = (\\<Sum>i\\<in>UNIV. (g - f) i *s X$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. (g i - f i) *s X $ i) =\n    (\\<Sum>i\\<in>UNIV. (g - f) i *s X $ i)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. (g i - f i) *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. (g - f) i *s X $ i)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "finally"], ["proof (chain)\npicking this:\n  0 = (\\<Sum>i\\<in>UNIV. (g - f) i *s X $ i)", "have sum_eq_1: \"0 = (\\<Sum>i\\<in>UNIV. (g - f) i *s X$i)\""], ["proof (prove)\nusing this:\n  0 = (\\<Sum>i\\<in>UNIV. (g - f) i *s X $ i)\n\ngoal (1 subgoal):\n 1. 0 = (\\<Sum>i\\<in>UNIV. (g - f) i *s X $ i)", "by simp"], ["proof (state)\nthis:\n  0 = (\\<Sum>i\\<in>UNIV. (g - f) i *s X $ i)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "have \"\\<forall>i\\<in>UNIV. (g - f) i = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>UNIV. (g - f) i = (0::'a)", "by (rule scalars_zero_if_basis[OF basis_X sum_eq_1[symmetric]])"], ["proof (state)\nthis:\n  \\<forall>i\\<in>UNIV. (g - f) i = (0::'a)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "hence \"(g - f) x = 0\""], ["proof (prove)\nusing this:\n  \\<forall>i\\<in>UNIV. (g - f) i = (0::'a)\n\ngoal (1 subgoal):\n 1. (g - f) x = (0::'a)", "by simp"], ["proof (state)\nthis:\n  (g - f) x = (0::'a)\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "hence \"f x = g x\""], ["proof (prove)\nusing this:\n  (g - f) x = (0::'a)\n\ngoal (1 subgoal):\n 1. f x = g x", "by simp"], ["proof (state)\nthis:\n  f x = g x\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow> False", "thus False"], ["proof (prove)\nusing this:\n  f x = g x\n\ngoal (1 subgoal):\n 1. False", "using fx_gx"], ["proof (prove)\nusing this:\n  f x = g x\n  f x \\<noteq> g x\n\ngoal (1 subgoal):\n 1. False", "by contradiction"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection\\<open>Coordinates of a vector\\<close>"], ["", "text\\<open>Definition and properties of the coordinates of a vector (in terms of a particular ordered basis).\\<close>"], ["", "definition coord :: \"'a::{field}^'n^'n\\<Rightarrow>'a::{field}^'n\\<Rightarrow>'a::{field}^'n\"\nwhere \"coord X v = (\\<chi> i. (THE f. v = sum (\\<lambda>x. f x *s X$x) UNIV) i)\""], ["", "text\\<open>@{term \"coord X v\"} are the coordinates of vector @{term \"v\"} with respect to the basis @{term \"X\"}\\<close>"], ["", "lemma bij_coord:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\"\n  shows \"bij (coord X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij (coord X)", "proof (unfold bij_def, auto)"], ["proof (state)\ngoal (2 subgoals):\n 1. inj (coord X)\n 2. \\<And>x. x \\<in> range (coord X)", "show inj: \"inj (coord X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj (coord X)", "proof (unfold inj_on_def, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "fix x y"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "assume coord_eq: \"coord X x = coord X y\""], ["proof (state)\nthis:\n  coord X x = coord X y\n\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "obtain f where f: \"(\\<Sum>x\\<in>UNIV. f x *s X $ x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>x\\<in>UNIV. f x *s X $ x) = x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>x\\<in>UNIV. f x *s X $ x) = x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "obtain g where g:  \"(\\<Sum>x\\<in>UNIV. g x *s X $ x) = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = y \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = y \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = y\n\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "have the_f: \"(THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\n 2. \\<And>fa. x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "show \"x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)", "using f"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa. x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "show \"\\<And>fa. x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>fa. x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "using basis_combination_unique[OF basis_X] f"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. \\<And>fa. x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "by simp"], ["proof (state)\nthis:\n  x = (\\<Sum>x\\<in>UNIV. ?fa x *s X $ x) \\<Longrightarrow> ?fa = f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f\n\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "have the_g: \"(THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n 2. \\<And>ga. y = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "show \"y = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x)", "using g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = y\n\ngoal (1 subgoal):\n 1. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  y = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>ga. y = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "show \"\\<And>ga. y = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ga. y = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "using basis_combination_unique[OF basis_X] g"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = y\n\ngoal (1 subgoal):\n 1. \\<And>ga. y = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "by simp"], ["proof (state)\nthis:\n  y = (\\<Sum>x\\<in>UNIV. ?ga x *s X $ x) \\<Longrightarrow> ?ga = g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g\n\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "have \"(THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n    (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x))", "using coord_eq"], ["proof (prove)\nusing this:\n  coord X x = coord X y\n\ngoal (1 subgoal):\n 1. (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n    (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x))", "unfolding coord_def"], ["proof (prove)\nusing this:\n  vec_lambda (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n  vec_lambda (THE f. y = (\\<Sum>x\\<in>UNIV. f x *s X $ x))\n\ngoal (1 subgoal):\n 1. (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n    (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x))", "using vec_lambda_inject[of \"(THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) \"  \"(THE f. y = (\\<Sum>x\\<in>UNIV. f x *s X $ x))\"]"], ["proof (prove)\nusing this:\n  vec_lambda (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n  vec_lambda (THE f. y = (\\<Sum>x\\<in>UNIV. f x *s X $ x))\n  \\<lbrakk>(THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) \\<in> UNIV;\n   (THE f. y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) \\<in> UNIV\\<rbrakk>\n  \\<Longrightarrow> (vec_lambda\n                      (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n                     vec_lambda\n                      (THE f. y = (\\<Sum>x\\<in>UNIV. f x *s X $ x))) =\n                    ((THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n                     (THE f. y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)))\n\ngoal (1 subgoal):\n 1. (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n    (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x))", "by auto"], ["proof (state)\nthis:\n  (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n  (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x))\n\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "hence \"f = g\""], ["proof (prove)\nusing this:\n  (THE f. x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n  (THE g. y = (\\<Sum>x\\<in>UNIV. g x *s X $ x))\n\ngoal (1 subgoal):\n 1. f = g", "unfolding the_f the_g"], ["proof (prove)\nusing this:\n  f = g\n\ngoal (1 subgoal):\n 1. f = g", "."], ["proof (state)\nthis:\n  f = g\n\ngoal (1 subgoal):\n 1. \\<And>x y. coord X x = coord X y \\<Longrightarrow> x = y", "thus \"x=y\""], ["proof (prove)\nusing this:\n  f = g\n\ngoal (1 subgoal):\n 1. x = y", "using f g"], ["proof (prove)\nusing this:\n  f = g\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = x\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = y\n\ngoal (1 subgoal):\n 1. x = y", "by simp"], ["proof (state)\nthis:\n  x = y\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inj (coord X)\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> range (coord X)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> range (coord X)", "fix x::\"('a, 'n) vec\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> range (coord X)", "show \"x \\<in> range (coord X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> range (coord X)", "proof (unfold image_def, auto, rule exI[of _ \"sum (\\<lambda>i. x$i *s X$i) UNIV\"], unfold coord_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. x =\n    vec_lambda\n     (THE f.\n         (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n         (\\<Sum>x\\<in>UNIV. f x *s X $ x))", "define f where \"f i = x$i\" for i"], ["proof (state)\nthis:\n  f ?i = x $ ?i\n\ngoal (1 subgoal):\n 1. x =\n    vec_lambda\n     (THE f.\n         (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n         (\\<Sum>x\\<in>UNIV. f x *s X $ x))", "have the_f: \" (THE f. (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f.\n        (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n        (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n    f", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\n 2. \\<And>fa.\n       (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n       (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow>\n       fa = f", "show \"(\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. f x *s X $ x)", "unfolding f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n    (\\<Sum>xa\\<in>UNIV. x $ xa *s X $ xa)", ".."], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n       (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow>\n       fa = f", "fix g"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>fa.\n       (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n       (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow>\n       fa = f", "assume sum_eq:\"(\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\""], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n       (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow>\n       fa = f", "show \"g = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g = f", "using  basis_combination_unique[OF basis_X]"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n\ngoal (1 subgoal):\n 1. g = f", "using sum_eq"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. g = f", "unfolding f_def"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. g = ($) x", "by simp"], ["proof (state)\nthis:\n  g = f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f.\n      (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n      (\\<Sum>x\\<in>UNIV. f x *s X $ x)) =\n  f\n\ngoal (1 subgoal):\n 1. x =\n    vec_lambda\n     (THE f.\n         (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n         (\\<Sum>x\\<in>UNIV. f x *s X $ x))", "show \" x = vec_lambda (THE f. (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) = (\\<Sum>x\\<in>UNIV. f x *s X $ x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x =\n    vec_lambda\n     (THE f.\n         (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n         (\\<Sum>x\\<in>UNIV. f x *s X $ x))", "unfolding the_f"], ["proof (prove)\ngoal (1 subgoal):\n 1. x = vec_lambda f", "unfolding f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. x = (\\<chi>i. x $ i)", "using vec_lambda_eta[of x]"], ["proof (prove)\nusing this:\n  (\\<chi>i. x $ i) = x\n\ngoal (1 subgoal):\n 1. x = (\\<chi>i. x $ i)", "by simp"], ["proof (state)\nthis:\n  x =\n  vec_lambda\n   (THE f.\n       (\\<Sum>i\\<in>UNIV. x $ i *s X $ i) =\n       (\\<Sum>x\\<in>UNIV. f x *s X $ x))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x \\<in> range (coord X)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma linear_coord:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\"\n  shows \"linear ((*s)) ((*s)) (coord X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) (coord X)", "proof unfold_locales"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>b1 b2. coord X (b1 + b2) = coord X b1 + coord X b2\n 2. \\<And>r b. coord X (r *s b) = r *s coord X b", "fix x y::\"('a, 'n) vec\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>b1 b2. coord X (b1 + b2) = coord X b1 + coord X b2\n 2. \\<And>r b. coord X (r *s b) = r *s coord X b", "show  \"coord X (x + y) = coord X x + coord X y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "obtain f where f: \"(\\<Sum>a\\<in>(UNIV::'n set). f a *s X $ a) = x + y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>a\\<in>UNIV. f a *s X $ a) = x + y \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>a\\<in>UNIV. f a *s X $ a) = x + y \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = x + y\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "obtain g where g: \" (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "obtain h where h: \"(\\<Sum>x\\<in>UNIV. h x *s X $ x) = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>h.\n        (\\<Sum>x\\<in>UNIV. h x *s X $ x) = y \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>h.\n        (\\<Sum>x\\<in>UNIV. h x *s X $ x) = y \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. h x *s X $ x) = y\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "define t where \"t i = g i + h i\" for i"], ["proof (state)\nthis:\n  t ?i = g ?i + h ?i\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "have the_f: \"(THE f. x + y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. x + y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. x + y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\n 2. \\<And>fa.\n       x + y = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "show \" x + y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x + y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)", "using f"], ["proof (prove)\nusing this:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = x + y\n\ngoal (1 subgoal):\n 1. x + y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  x + y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       x + y = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "show \"\\<And>fa. x + y = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>fa.\n       x + y = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "using basis_combination_unique[OF basis_X] f"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = x + y\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       x + y = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "by simp"], ["proof (state)\nthis:\n  x + y = (\\<Sum>x\\<in>UNIV. ?fa x *s X $ x) \\<Longrightarrow> ?fa = f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. x + y = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "have the_g: \"(THE g. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE g. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n 2. \\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "show \"x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)", "using g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "show \"\\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "using basis_combination_unique[OF basis_X] g"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. \\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "by simp"], ["proof (state)\nthis:\n  x = (\\<Sum>x\\<in>UNIV. ?ga x *s X $ x) \\<Longrightarrow> ?ga = g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE g. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "have the_h: \"(THE h. y = (\\<Sum>x\\<in>UNIV. h x *s X $ x)) = h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE h. y = (\\<Sum>x\\<in>UNIV. h x *s X $ x)) = h", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. y = (\\<Sum>x\\<in>UNIV. h x *s X $ x)\n 2. \\<And>ha. y = (\\<Sum>x\\<in>UNIV. ha x *s X $ x) \\<Longrightarrow> ha = h", "show \"y = (\\<Sum>x\\<in>UNIV. h x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y = (\\<Sum>x\\<in>UNIV. h x *s X $ x)", "using h"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. h x *s X $ x) = y\n\ngoal (1 subgoal):\n 1. y = (\\<Sum>x\\<in>UNIV. h x *s X $ x)", ".."], ["proof (state)\nthis:\n  y = (\\<Sum>x\\<in>UNIV. h x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>ha. y = (\\<Sum>x\\<in>UNIV. ha x *s X $ x) \\<Longrightarrow> ha = h", "show \"\\<And>ha. y = (\\<Sum>x\\<in>UNIV. ha x *s X $ x) \\<Longrightarrow> ha = h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha. y = (\\<Sum>x\\<in>UNIV. ha x *s X $ x) \\<Longrightarrow> ha = h", "using basis_combination_unique[OF basis_X] h"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>x\\<in>UNIV. h x *s X $ x) = y\n\ngoal (1 subgoal):\n 1. \\<And>ha. y = (\\<Sum>x\\<in>UNIV. ha x *s X $ x) \\<Longrightarrow> ha = h", "by simp"], ["proof (state)\nthis:\n  y = (\\<Sum>x\\<in>UNIV. ?ha x *s X $ x) \\<Longrightarrow> ?ha = h\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE h. y = (\\<Sum>x\\<in>UNIV. h x *s X $ x)) = h\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "have \"(\\<Sum>a\\<in>(UNIV::'n set). f a *s X $ a) =  (\\<Sum>x\\<in>UNIV. g x *s X $ x) + (\\<Sum>x\\<in>UNIV. h x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>a\\<in>UNIV. f a *s X $ a) =\n    (\\<Sum>x\\<in>UNIV. g x *s X $ x) + (\\<Sum>x\\<in>UNIV. h x *s X $ x)", "using f g h"], ["proof (prove)\nusing this:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = x + y\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\n  (\\<Sum>x\\<in>UNIV. h x *s X $ x) = y\n\ngoal (1 subgoal):\n 1. (\\<Sum>a\\<in>UNIV. f a *s X $ a) =\n    (\\<Sum>x\\<in>UNIV. g x *s X $ x) + (\\<Sum>x\\<in>UNIV. h x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) =\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) + (\\<Sum>x\\<in>UNIV. h x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "also"], ["proof (state)\nthis:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) =\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) + (\\<Sum>x\\<in>UNIV. h x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "have \"... = (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s X $ x) + (\\<Sum>x\\<in>UNIV. h x *s X $ x) =\n    (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x)", "unfolding sum.distrib[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x) =\n    (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x)", ".."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) + (\\<Sum>x\\<in>UNIV. h x *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) + (\\<Sum>x\\<in>UNIV. h x *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "have \"... = (\\<Sum>x\\<in>UNIV. (g x + h x) *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x) =\n    (\\<Sum>x\\<in>UNIV. (g x + h x) *s X $ x)", "by (rule sum.cong, auto simp add: scaleR_left_distrib)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. (g x + h x) *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x + h x *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. (g x + h x) *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "have \"... = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. (g x + h x) *s X $ x) =\n    (\\<Sum>x\\<in>UNIV. t x *s X $ x)", "unfolding t_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. (g x + h x) *s X $ x) =\n    (\\<Sum>x\\<in>UNIV. (g x + h x) *s X $ x)", ".."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. (g x + h x) *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)", "have \"(\\<Sum>a\\<in>UNIV. f a *s X $ a) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\""], ["proof (prove)\nusing this:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>a\\<in>UNIV. f a *s X $ a) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)", "."], ["proof (state)\nthis:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "hence \"f=t\""], ["proof (prove)\nusing this:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n\ngoal (1 subgoal):\n 1. f = t", "using basis_combination_unique[OF basis_X]"], ["proof (prove)\nusing this:\n  (\\<Sum>a\\<in>UNIV. f a *s X $ a) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n\ngoal (1 subgoal):\n 1. f = t", "by auto"], ["proof (state)\nthis:\n  f = t\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "thus ?thesis"], ["proof (prove)\nusing this:\n  f = t\n\ngoal (1 subgoal):\n 1. coord X (x + y) = coord X x + coord X y", "by (unfold coord_def the_f the_g the_h, vector, auto, unfold f g h t_def, simp)"], ["proof (state)\nthis:\n  coord X (x + y) = coord X x + coord X y\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  coord X (x + y) = coord X x + coord X y\n\ngoal (1 subgoal):\n 1. \\<And>r b. coord X (r *s b) = r *s coord X b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>r b. coord X (r *s b) = r *s coord X b", "fix c::'a and x::\"'a^'n\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>r b. coord X (r *s b) = r *s coord X b", "show \"coord X (c *s x) = c *s coord X x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "obtain f where f: \"(\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s x\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "obtain g where g: \"(\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "define t where \"t i = c * g i\" for i"], ["proof (state)\nthis:\n  t ?i = c * g ?i\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "have the_f: \"(THE f. c *s x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. c *s x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. c *s x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\n 2. \\<And>fa.\n       c *s x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "show \" c *s x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c *s x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)", "using f"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s x\n\ngoal (1 subgoal):\n 1. c *s x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)", ".."], ["proof (state)\nthis:\n  c *s x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       c *s x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "show \"\\<And>fa. c *s x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>fa.\n       c *s x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "using basis_combination_unique[OF basis_X] f"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s x\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       c *s x = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) \\<Longrightarrow> fa = f", "by simp"], ["proof (state)\nthis:\n  c *s x = (\\<Sum>x\\<in>UNIV. ?fa x *s X $ x) \\<Longrightarrow> ?fa = f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. c *s x = (\\<Sum>x\\<in>UNIV. f x *s X $ x)) = f\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "have the_g: \"(THE g. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE g. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n 2. \\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "show \" x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)", "using g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)", ".."], ["proof (state)\nthis:\n  x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "show \"\\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "using basis_combination_unique[OF basis_X] g"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. \\<And>ga. x = (\\<Sum>x\\<in>UNIV. ga x *s X $ x) \\<Longrightarrow> ga = g", "by simp"], ["proof (state)\nthis:\n  x = (\\<Sum>x\\<in>UNIV. ?ga x *s X $ x) \\<Longrightarrow> ?ga = g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE g. x = (\\<Sum>x\\<in>UNIV. g x *s X $ x)) = g\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "have \"(\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s (\\<Sum>x\\<in>UNIV. g x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s (\\<Sum>x\\<in>UNIV. g x *s X $ x)", "using f g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s x\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = x\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s (\\<Sum>x\\<in>UNIV. g x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = c *s (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "have \"... = (\\<Sum>x\\<in>UNIV. c *s (g x *s X $ x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c *s (\\<Sum>x\\<in>UNIV. g x *s X $ x) =\n    (\\<Sum>x\\<in>UNIV. c *s (g x *s X $ x))", "by (rule vec.scale_sum_right)"], ["proof (state)\nthis:\n  c *s (\\<Sum>x\\<in>UNIV. g x *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. c *s (g x *s X $ x))\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "also"], ["proof (state)\nthis:\n  c *s (\\<Sum>x\\<in>UNIV. g x *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. c *s (g x *s X $ x))\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "have \"... =  (\\<Sum>x\\<in>UNIV. t x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. c *s (g x *s X $ x)) =\n    (\\<Sum>x\\<in>UNIV. t x *s X $ x)", "unfolding t_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. c *s (g x *s X $ x)) =\n    (\\<Sum>x\\<in>UNIV. c * g x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. c *s (g x *s X $ x)) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)", "have \" (\\<Sum>x\\<in>UNIV. f x *s X $ x) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x *s X $ x) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)", "."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "hence \"f=t\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n\ngoal (1 subgoal):\n 1. f = t", "using basis_combination_unique[OF basis_X]"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = (\\<Sum>x\\<in>UNIV. t x *s X $ x)\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n\ngoal (1 subgoal):\n 1. f = t", "by auto"], ["proof (state)\nthis:\n  f = t\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "thus ?thesis"], ["proof (prove)\nusing this:\n  f = t\n\ngoal (1 subgoal):\n 1. coord X (c *s x) = c *s coord X x", "by (unfold coord_def the_f the_g, vector, auto, unfold t_def, auto)"], ["proof (state)\nthis:\n  coord X (c *s x) = c *s coord X x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  coord X (c *s x) = c *s coord X x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma coord_eq:\n  assumes basis_X:\"is_basis (set_of_vector X)\"\n  and coord_eq: \"coord X v = coord X w\"\n  shows \"v = w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v = w", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. v = w", "have \"\\<forall>i. (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i = (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i.\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i =\n       (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i", "using coord_eq"], ["proof (prove)\nusing this:\n  coord X v = coord X w\n\ngoal (1 subgoal):\n 1. \\<forall>i.\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i =\n       (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i", "unfolding coord_eq coord_def vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     vec_lambda\n      (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x *s X $ x) $ i) $\n     i =\n     vec_lambda\n      (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x *s X $ x) $ i) $\n     i\n\ngoal (1 subgoal):\n 1. \\<forall>i.\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i =\n       (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i", "by simp"], ["proof (state)\nthis:\n  \\<forall>i.\n     (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i =\n     (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i\n\ngoal (1 subgoal):\n 1. v = w", "hence the_eq: \"(THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i =\n     (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i\n\ngoal (1 subgoal):\n 1. (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) =\n    (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))", "by auto"], ["proof (state)\nthis:\n  (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) =\n  (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n\ngoal (1 subgoal):\n 1. v = w", "obtain f where  f: \"(\\<Sum>x\\<in>UNIV. f x *s X $ x)= v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>x\\<in>UNIV. f x *s X $ x) = v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>x\\<in>UNIV. f x *s X $ x) = v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = v\n\ngoal (1 subgoal):\n 1. v = w", "obtain g where  g: \"(\\<Sum>x\\<in>UNIV. g x *s X $ x)= w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = w \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = w \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = w\n\ngoal (1 subgoal):\n 1. v = w", "have the_f: \"(THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = f", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)\n 2. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "show \" \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)", "using f"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = v\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)", "by auto"], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "fix fa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "assume \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\""], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "hence \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\""], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. (fa x *s X $ x) $ i)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "hence fa:\" v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\""], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i", "."], ["proof (state)\nthis:\n  v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "show \"fa = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fa = f", "using basis_combination_unique[OF basis_X] f fa"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = v\n  v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n\ngoal (1 subgoal):\n 1. fa = f", "by simp"], ["proof (state)\nthis:\n  fa = f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = f\n\ngoal (1 subgoal):\n 1. v = w", "have the_g: \"(THE g. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)) = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE g. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)) = g", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)\n 2. \\<And>ga.\n       \\<forall>i.\n          w $ i = (\\<Sum>x\\<in>UNIV. ga x * X $ x $ i) \\<Longrightarrow>\n       ga = g", "show \" \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)", "using g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = w\n\ngoal (1 subgoal):\n 1. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)", "by auto"], ["proof (state)\nthis:\n  \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>i.\n          w $ i = (\\<Sum>x\\<in>UNIV. ga x * X $ x $ i) \\<Longrightarrow>\n       ga = g", "fix fa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>i.\n          w $ i = (\\<Sum>x\\<in>UNIV. ga x * X $ x $ i) \\<Longrightarrow>\n       ga = g", "assume \"\\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\""], ["proof (state)\nthis:\n  \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>i.\n          w $ i = (\\<Sum>x\\<in>UNIV. ga x * X $ x $ i) \\<Longrightarrow>\n       ga = g", "hence \"\\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\""], ["proof (prove)\nusing this:\n  \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. (fa x *s X $ x) $ i)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>i.\n          w $ i = (\\<Sum>x\\<in>UNIV. ga x * X $ x $ i) \\<Longrightarrow>\n       ga = g", "hence fa:\" w = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\""], ["proof (prove)\nusing this:\n  \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. w = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i", "."], ["proof (state)\nthis:\n  w = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>i.\n          w $ i = (\\<Sum>x\\<in>UNIV. ga x * X $ x $ i) \\<Longrightarrow>\n       ga = g", "show \"fa = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fa = g", "using basis_combination_unique[OF basis_X] g fa"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = w\n  w = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n\ngoal (1 subgoal):\n 1. fa = g", "by simp"], ["proof (state)\nthis:\n  fa = g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE g. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)) = g\n\ngoal (1 subgoal):\n 1. v = w", "have \"f=g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f = g", "using the_eq"], ["proof (prove)\nusing this:\n  (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) =\n  (THE f. \\<forall>i. w $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n\ngoal (1 subgoal):\n 1. f = g", "unfolding the_f the_g"], ["proof (prove)\nusing this:\n  f = g\n\ngoal (1 subgoal):\n 1. f = g", "."], ["proof (state)\nthis:\n  f = g\n\ngoal (1 subgoal):\n 1. v = w", "thus \"v=w\""], ["proof (prove)\nusing this:\n  f = g\n\ngoal (1 subgoal):\n 1. v = w", "using f g"], ["proof (prove)\nusing this:\n  f = g\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = v\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = w\n\ngoal (1 subgoal):\n 1. v = w", "by blast"], ["proof (state)\nthis:\n  v = w\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection\\<open>Matrix of change of basis and coordinate matrix of a linear map\\<close>"], ["", "text\\<open>Definitions of matrix of change of basis and matrix of a linear transformation with respect to two bases:\\<close>"], ["", "definition matrix_change_of_basis :: \"'a::{field}^'n^'n \\<Rightarrow>'a^'n^'n\\<Rightarrow>'a^'n^'n\"\n  where \"matrix_change_of_basis X Y = (\\<chi> i j. (coord Y (X$j)) $ i)\""], ["", "text\\<open>There exists in the library the definition @{thm \"matrix_def\"}, which is the coordinate matrix of a linear map with respect to the standard bases.\n      Now we generalise that concept to the coordinate matrix of a linear map with respect to any two bases.\\<close>"], ["", "definition matrix' :: \"'a::{field}^'n^'n \\<Rightarrow> 'a^'m^'m \\<Rightarrow> ('a^'n => 'a^'m) \\<Rightarrow> 'a^'n^'m\"\n  where \"matrix' X Y f= (\\<chi> i j. (coord Y (f(X$j))) $ i)\""], ["", "text\\<open>Properties of @{thm \"matrix'_def\"}\\<close>"], ["", "lemma matrix'_eq_matrix:\n  defines cart_basis_Rn: \"cart_basis_Rn == (cart_basis')::'a::{field}^'n^'n\" \n  and cart_basis_Rm:\"cart_basis_Rm == (cart_basis')::'a^'m^'m\"  \n  shows \"matrix' (cart_basis_Rn) (cart_basis_Rm) f = matrix f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' cart_basis_Rn cart_basis_Rm f = matrix f", "proof (unfold matrix_def matrix'_def coord_def, vector, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       (THE fa.\n           \\<forall>i.\n              f (cart_basis_Rn $ ia) $ i =\n              (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i))\n        i =\n       f (axis ia (1::'a)) $ i", "fix i j"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       (THE fa.\n           \\<forall>i.\n              f (cart_basis_Rn $ ia) $ i =\n              (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i))\n        i =\n       f (axis ia (1::'a)) $ i", "have basis_Rn:\"is_basis (set_of_vector cart_basis_Rn)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis_Rn)", "using is_basis_cart_basis'"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector cart_basis')\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis_Rn)", "unfolding cart_basis_Rn"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector cart_basis')\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis')", "."], ["proof (state)\nthis:\n  is_basis (set_of_vector cart_basis_Rn)\n\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       (THE fa.\n           \\<forall>i.\n              f (cart_basis_Rn $ ia) $ i =\n              (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i))\n        i =\n       f (axis ia (1::'a)) $ i", "have basis_Rm:\"is_basis (set_of_vector cart_basis_Rm)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis_Rm)", "using is_basis_cart_basis'"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector cart_basis')\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis_Rm)", "unfolding cart_basis_Rm"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector cart_basis')\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis')", "."], ["proof (state)\nthis:\n  is_basis (set_of_vector cart_basis_Rm)\n\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       (THE fa.\n           \\<forall>i.\n              f (cart_basis_Rn $ ia) $ i =\n              (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i))\n        i =\n       f (axis ia (1::'a)) $ i", "obtain g where sum_g: \"(\\<Sum>x\\<in>UNIV. g x *s (cart_basis_Rm $ x)) = f (cart_basis_Rn $ j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s cart_basis_Rm $ x) =\n        f (cart_basis_Rn $ j) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_Rm]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s cart_basis_Rm $ x) =\n        f (cart_basis_Rn $ j) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s cart_basis_Rm $ x) = f (cart_basis_Rn $ j)\n\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       (THE fa.\n           \\<forall>i.\n              f (cart_basis_Rn $ ia) $ i =\n              (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i))\n        i =\n       f (axis ia (1::'a)) $ i", "have the_g: \"(THE g. \\<forall>a. f (cart_basis_Rn $ j) $ a = (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)) = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE g.\n        \\<forall>a.\n           f (cart_basis_Rn $ j) $ a =\n           (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)) =\n    g", "proof (rule the_equality, clarify)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>a.\n       f (cart_basis_Rn $ j) $ a =\n       (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\n 2. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "fix a"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>a.\n       f (cart_basis_Rn $ j) $ a =\n       (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\n 2. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "have \"f (cart_basis_Rn $ j) $ a = (\\<Sum>i\\<in>UNIV. g i *s (cart_basis_Rm $ i)) $ a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (cart_basis_Rn $ j) $ a =\n    (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) $ a", "using sum_g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s cart_basis_Rm $ x) = f (cart_basis_Rn $ j)\n\ngoal (1 subgoal):\n 1. f (cart_basis_Rn $ j) $ a =\n    (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) $ a", "by simp"], ["proof (state)\nthis:\n  f (cart_basis_Rn $ j) $ a =\n  (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) $ a\n\ngoal (2 subgoals):\n 1. \\<And>a.\n       f (cart_basis_Rn $ j) $ a =\n       (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\n 2. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "also"], ["proof (state)\nthis:\n  f (cart_basis_Rn $ j) $ a =\n  (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) $ a\n\ngoal (2 subgoals):\n 1. \\<And>a.\n       f (cart_basis_Rn $ j) $ a =\n       (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\n 2. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "have \"... = (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) $ a =\n    (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)", "unfolding sum_component"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. (g x *s cart_basis_Rm $ x) $ a) =\n    (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) $ a =\n  (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\n\ngoal (2 subgoals):\n 1. \\<And>a.\n       f (cart_basis_Rn $ j) $ a =\n       (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\n 2. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "finally"], ["proof (chain)\npicking this:\n  f (cart_basis_Rn $ j) $ a =\n  (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)", "show \"f (cart_basis_Rn $ j) $ a = (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\""], ["proof (prove)\nusing this:\n  f (cart_basis_Rn $ j) $ a =\n  (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\n\ngoal (1 subgoal):\n 1. f (cart_basis_Rn $ j) $ a =\n    (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)", "."], ["proof (state)\nthis:\n  f (cart_basis_Rn $ j) $ a =\n  (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)\n\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "fix ga"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "assume \"\\<forall>a. f (cart_basis_Rn $ j) $ a = (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a)\""], ["proof (state)\nthis:\n  \\<forall>a.\n     f (cart_basis_Rn $ j) $ a =\n     (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a)\n\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "hence sum_ga: \"f (cart_basis_Rn $ j) = (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)\""], ["proof (prove)\nusing this:\n  \\<forall>a.\n     f (cart_basis_Rn $ j) $ a =\n     (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a)\n\ngoal (1 subgoal):\n 1. f (cart_basis_Rn $ j) = (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)", "by (vector, auto)"], ["proof (state)\nthis:\n  f (cart_basis_Rn $ j) = (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)\n\ngoal (1 subgoal):\n 1. \\<And>ga.\n       \\<forall>a.\n          f (cart_basis_Rn $ j) $ a =\n          (\\<Sum>x\\<in>UNIV. ga x * cart_basis_Rm $ x $ a) \\<Longrightarrow>\n       ga = g", "show \"ga = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ga = g", "proof (rule basis_combination_unique)"], ["proof (state)\ngoal (2 subgoals):\n 1. is_basis (set_of_vector ?X)\n 2. (\\<Sum>i\\<in>UNIV. g i *s ?X $ i) = (\\<Sum>i\\<in>UNIV. ga i *s ?X $ i)", "show \"is_basis (set_of_vector (cart_basis_Rm))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis_Rm)", "using basis_Rm"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector cart_basis_Rm)\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector cart_basis_Rm)", "."], ["proof (state)\nthis:\n  is_basis (set_of_vector cart_basis_Rm)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) =\n    (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)", "show \" (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) = (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) =\n    (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)", "using sum_g sum_ga"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s cart_basis_Rm $ x) = f (cart_basis_Rn $ j)\n  f (cart_basis_Rn $ j) = (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) =\n    (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. g i *s cart_basis_Rm $ i) =\n  (\\<Sum>i\\<in>UNIV. ga i *s cart_basis_Rm $ i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ga = g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE g.\n      \\<forall>a.\n         f (cart_basis_Rn $ j) $ a =\n         (\\<Sum>x\\<in>UNIV. g x * cart_basis_Rm $ x $ a)) =\n  g\n\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       (THE fa.\n           \\<forall>i.\n              f (cart_basis_Rn $ ia) $ i =\n              (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i))\n        i =\n       f (axis ia (1::'a)) $ i", "show \" (THE fa. \\<forall>i. f (cart_basis_Rn $ j) $ i = (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i)) i = f (axis j 1) $ i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE fa.\n        \\<forall>i.\n           f (cart_basis_Rn $ j) $ i =\n           (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i))\n     i =\n    f (axis j (1::'a)) $ i", "unfolding the_g"], ["proof (prove)\ngoal (1 subgoal):\n 1. g i = f (axis j (1::'a)) $ i", "using sum_g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s cart_basis_Rm $ x) = f (cart_basis_Rn $ j)\n\ngoal (1 subgoal):\n 1. g i = f (axis j (1::'a)) $ i", "unfolding cart_basis_Rm cart_basis_Rn cart_basis'_def"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s (\\<chi>i. axis i (1::'a)) $ x) =\n  f ((\\<chi>i. axis i (1::'a)) $ j)\n\ngoal (1 subgoal):\n 1. g i = f (axis j (1::'a)) $ i", "using basis_expansion_unique[of g \"f (axis j 1)\"]"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s (\\<chi>i. axis i (1::'a)) $ x) =\n  f ((\\<chi>i. axis i (1::'a)) $ j)\n  ((\\<Sum>i\\<in>UNIV. g i *s axis i (1::'a)) = f (axis j (1::'a))) =\n  (\\<forall>i. g i = f (axis j (1::'a)) $ i)\n\ngoal (1 subgoal):\n 1. g i = f (axis j (1::'a)) $ i", "unfolding scalar_mult_eq_scaleR"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s (\\<chi>i. axis i (1::'a)) $ x) =\n  f ((\\<chi>i. axis i (1::'a)) $ j)\n  ((\\<Sum>i\\<in>UNIV. g i *s axis i (1::'a)) = f (axis j (1::'a))) =\n  (\\<forall>i. g i = f (axis j (1::'a)) $ i)\n\ngoal (1 subgoal):\n 1. g i = f (axis j (1::'a)) $ i", "by auto"], ["proof (state)\nthis:\n  (THE fa.\n      \\<forall>i.\n         f (cart_basis_Rn $ j) $ i =\n         (\\<Sum>x\\<in>UNIV. fa x * cart_basis_Rm $ x $ i))\n   i =\n  f (axis j (1::'a)) $ i\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma matrix':\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"f (X$i) = sum (\\<lambda>j. (matrix' X Y f) $ j $ i *s (Y$j)) UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)", "proof (unfold matrix'_def coord_def matrix_mult_sum column_def, vector, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ia.\n       f (X $ i) $ ia =\n       (\\<Sum>x\\<in>UNIV.\n          (THE fa.\n              \\<forall>ia.\n                 f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia))\n           x *\n          Y $ x $ ia)", "fix j"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ia.\n       f (X $ i) $ ia =\n       (\\<Sum>x\\<in>UNIV.\n          (THE fa.\n              \\<forall>ia.\n                 f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia))\n           x *\n          Y $ x $ ia)", "obtain g where  g: \"(\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f (X $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f (X $ i) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_Y]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s Y $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f (X $ i) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f (X $ i)\n\ngoal (1 subgoal):\n 1. \\<And>ia.\n       f (X $ i) $ ia =\n       (\\<Sum>x\\<in>UNIV.\n          (THE fa.\n              \\<forall>ia.\n                 f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia))\n           x *\n          Y $ x $ ia)", "have the_g: \"(THE fa. \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia)) = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE fa.\n        \\<forall>ia.\n           f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia)) =\n    g", "proof (rule the_equality, clarify)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ ia)\n 2. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "fix a"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ ia)\n 2. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "have \"f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a", "using g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f (X $ i)\n\ngoal (1 subgoal):\n 1. f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a", "by simp"], ["proof (state)\nthis:\n  f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a\n\ngoal (2 subgoals):\n 1. \\<And>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ ia)\n 2. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "also"], ["proof (state)\nthis:\n  f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a\n\ngoal (2 subgoals):\n 1. \\<And>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ ia)\n 2. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "have \"... = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a =\n    (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)", "unfolding sum_component"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. (g x *s Y $ x) $ a) =\n    (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\n\ngoal (2 subgoals):\n 1. \\<And>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ ia)\n 2. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "finally"], ["proof (chain)\npicking this:\n  f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)", "show \"f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\""], ["proof (prove)\nusing this:\n  f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\n\ngoal (1 subgoal):\n 1. f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)", "."], ["proof (state)\nthis:\n  f (X $ i) $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "fix fa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "assume  \"\\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia)\""], ["proof (state)\nthis:\n  \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "hence \" \\<forall>ia. f (X $ i) $ ia =  (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ ia\""], ["proof (prove)\nusing this:\n  \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia)\n\ngoal (1 subgoal):\n 1. \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ ia", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia)\n\ngoal (1 subgoal):\n 1. \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. (fa x *s Y $ x) $ ia)", "by simp"], ["proof (state)\nthis:\n  \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ ia\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "hence fa:\"f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)\""], ["proof (prove)\nusing this:\n  \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ ia\n\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ ia\n\ngoal (1 subgoal):\n 1. \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ ia", "."], ["proof (state)\nthis:\n  f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>ia.\n          f (X $ i) $ ia =\n          (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia) \\<Longrightarrow>\n       fa = g", "show \"fa = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fa = g", "by (rule basis_combination_unique[OF basis_Y], simp add: fa g)"], ["proof (state)\nthis:\n  fa = g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE fa.\n      \\<forall>ia. f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia)) =\n  g\n\ngoal (1 subgoal):\n 1. \\<And>ia.\n       f (X $ i) $ ia =\n       (\\<Sum>x\\<in>UNIV.\n          (THE fa.\n              \\<forall>ia.\n                 f (X $ i) $ ia = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ ia))\n           x *\n          Y $ x $ ia)", "show \" f (X $ i) $ j = (\\<Sum>x\\<in>UNIV. (THE fa. \\<forall>j. f (X $ i) $ j = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ j)) x * Y $ x $ j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X $ i) $ j =\n    (\\<Sum>x\\<in>UNIV.\n       (THE fa.\n           \\<forall>j. f (X $ i) $ j = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ j))\n        x *\n       Y $ x $ j)", "unfolding the_g"], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X $ i) $ j = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ j)", "unfolding g[symmetric] sum_component"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. (g x *s Y $ x) $ j) =\n    (\\<Sum>x\\<in>UNIV. g x * Y $ x $ j)", "by simp"], ["proof (state)\nthis:\n  f (X $ i) $ j =\n  (\\<Sum>x\\<in>UNIV.\n     (THE fa.\n         \\<forall>j. f (X $ i) $ j = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ j))\n      x *\n     Y $ x $ j)\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary matrix'2:\n  assumes  basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  and eq_f: \"\\<forall>i. f (X$i) = sum (\\<lambda>j. A $ j $ i *s (Y$j)) UNIV\"\n  shows \"matrix' X Y f = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Y f = A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. matrix' X Y f = A", "have eq_f': \"\\<forall>i. f (X$i) = sum (\\<lambda>j. (matrix' X Y f) $ j $ i *s (Y$j)) UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i.\n       f (X $ i) = (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)", "using matrix'[OF basis_X basis_Y]"], ["proof (prove)\nusing this:\n  ?f (X $ ?i) = (\\<Sum>j\\<in>UNIV. matrix' X Y ?f $ j $ ?i *s Y $ j)\n\ngoal (1 subgoal):\n 1. \\<forall>i.\n       f (X $ i) = (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)", "by auto"], ["proof (state)\nthis:\n  \\<forall>i. f (X $ i) = (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)\n\ngoal (1 subgoal):\n 1. matrix' X Y f = A", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Y f = A", "proof (vector, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i ia. matrix' X Y f $ i $ ia = A $ i $ ia", "fix i j"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i ia. matrix' X Y f $ i $ ia = A $ i $ ia", "define a where \"a x = (matrix' X Y f) $ x $ i\" for x"], ["proof (state)\nthis:\n  a ?x = matrix' X Y f $ ?x $ i\n\ngoal (1 subgoal):\n 1. \\<And>i ia. matrix' X Y f $ i $ ia = A $ i $ ia", "define b where \"b x = A $ x $ i\" for x"], ["proof (state)\nthis:\n  b ?x = A $ ?x $ i\n\ngoal (1 subgoal):\n 1. \\<And>i ia. matrix' X Y f $ i $ ia = A $ i $ ia", "have  fxi_1:\"f (X$i) = sum (\\<lambda>j. a j *s (Y$j)) UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>j\\<in>UNIV. a j *s Y $ j)", "using eq_f'"], ["proof (prove)\nusing this:\n  \\<forall>i. f (X $ i) = (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)\n\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>j\\<in>UNIV. a j *s Y $ j)", "unfolding a_def"], ["proof (prove)\nusing this:\n  \\<forall>i. f (X $ i) = (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)\n\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)", "by simp"], ["proof (state)\nthis:\n  f (X $ i) = (\\<Sum>j\\<in>UNIV. a j *s Y $ j)\n\ngoal (1 subgoal):\n 1. \\<And>i ia. matrix' X Y f $ i $ ia = A $ i $ ia", "have  fxi_2: \"f (X$i) = sum (\\<lambda>j. b j *s(Y$j)) UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>j\\<in>UNIV. b j *s Y $ j)", "using eq_f"], ["proof (prove)\nusing this:\n  \\<forall>i. f (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)\n\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>j\\<in>UNIV. b j *s Y $ j)", "unfolding b_def"], ["proof (prove)\nusing this:\n  \\<forall>i. f (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)\n\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "by simp"], ["proof (state)\nthis:\n  f (X $ i) = (\\<Sum>j\\<in>UNIV. b j *s Y $ j)\n\ngoal (1 subgoal):\n 1. \\<And>i ia. matrix' X Y f $ i $ ia = A $ i $ ia", "have \"a=b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a = b", "using basis_combination_unique[OF basis_Y] fxi_1 fxi_2"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s Y $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s Y $ i) \\<Longrightarrow>\n  ?f = ?g\n  f (X $ i) = (\\<Sum>j\\<in>UNIV. a j *s Y $ j)\n  f (X $ i) = (\\<Sum>j\\<in>UNIV. b j *s Y $ j)\n\ngoal (1 subgoal):\n 1. a = b", "by auto"], ["proof (state)\nthis:\n  a = b\n\ngoal (1 subgoal):\n 1. \\<And>i ia. matrix' X Y f $ i $ ia = A $ i $ ia", "thus \"(matrix' X Y f) $ j $ i = A $ j $ i\""], ["proof (prove)\nusing this:\n  a = b\n\ngoal (1 subgoal):\n 1. matrix' X Y f $ j $ i = A $ j $ i", "unfolding a_def b_def"], ["proof (prove)\nusing this:\n  (\\<lambda>x. matrix' X Y f $ x $ i) = (\\<lambda>x. A $ x $ i)\n\ngoal (1 subgoal):\n 1. matrix' X Y f $ j $ i = A $ j $ i", "by metis"], ["proof (state)\nthis:\n  matrix' X Y f $ j $ i = A $ j $ i\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  matrix' X Y f = A\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>This is the theorem 2.14 in the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "lemma coord_matrix':\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'m^'m\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  and linear_f: \"linear ((*s)) ((*s)) f\"\n  shows \"coord Y (f v) = (matrix' X Y f) *v (coord X v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coord Y (f v) = matrix' X Y f *v coord X v", "proof (unfold matrix_mult_sum matrix'_def column_def coord_def, vector, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "interpret Vector_Spaces.linear \"(*s)\" \"(*s)\" f"], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) f", "by fact"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "obtain g where g: \"(\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_Y]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s Y $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "obtain s where s: \"(\\<Sum>x\\<in>UNIV. s x *s X $ x) = v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>s.\n        (\\<Sum>x\\<in>UNIV. s x *s X $ x) = v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        (\\<Sum>x\\<in>UNIV. s x *s X $ x) = v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. s x *s X $ x) = v\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have the_g: \"(THE fa. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a)) = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE fa. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a)) = g", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\n 2. \\<And>fa.\n       \\<forall>a.\n          f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a) \\<Longrightarrow>\n       fa = g", "have \"\\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x  *s Y $ x) $ a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a", "using g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v\n\ngoal (1 subgoal):\n 1. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a", "by simp"], ["proof (state)\nthis:\n  \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a\n\ngoal (2 subgoals):\n 1. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\n 2. \\<And>fa.\n       \\<forall>a.\n          f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a) \\<Longrightarrow>\n       fa = g", "thus \" \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\""], ["proof (prove)\nusing this:\n  \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x *s Y $ x) $ a\n\ngoal (1 subgoal):\n 1. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. (g x *s Y $ x) $ a)\n\ngoal (1 subgoal):\n 1. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)", "by simp"], ["proof (state)\nthis:\n  \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. g x * Y $ x $ a)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>a.\n          f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a) \\<Longrightarrow>\n       fa = g", "fix fa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>a.\n          f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a) \\<Longrightarrow>\n       fa = g", "assume \" \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a)\""], ["proof (state)\nthis:\n  \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>a.\n          f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a) \\<Longrightarrow>\n       fa = g", "hence  fa: \"f v = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)\""], ["proof (prove)\nusing this:\n  \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a)\n\ngoal (1 subgoal):\n 1. f v = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)", "by (vector, auto)"], ["proof (state)\nthis:\n  f v = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>a.\n          f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a) \\<Longrightarrow>\n       fa = g", "show \"fa=g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fa = g", "by (rule basis_combination_unique[OF basis_Y], simp add: fa g)"], ["proof (state)\nthis:\n  fa = g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE fa. \\<forall>a. f v $ a = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ a)) = g\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have the_s: \"(THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))=s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = s", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x * X $ x $ i)\n 2. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = s", "have \" \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x *s X $ x) $ i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x *s X $ x) $ i", "using s"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. s x *s X $ x) = v\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x *s X $ x) $ i", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x *s X $ x) $ i\n\ngoal (2 subgoals):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x * X $ x $ i)\n 2. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = s", "thus \" \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x * X $ x $ i)\""], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x * X $ x $ i)", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. (s x *s X $ x) $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x * X $ x $ i)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. s x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = s", "fix fa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = s", "assume \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\""], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = s", "hence fa: \"v=(\\<Sum>x\\<in>UNIV. fa x *s X $ x)\""], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)", "by (vector, auto)"], ["proof (state)\nthis:\n  v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = s", "show \"fa=s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fa = s", "by (rule basis_combination_unique[OF basis_X], simp add: fa s)"], ["proof (state)\nthis:\n  fa = s\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = s\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "define t where \"t x = (\\<Sum>i\\<in>UNIV. (s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x))\" for x"], ["proof (state)\nthis:\n  t ?x =\n  (\\<Sum>i\\<in>UNIV.\n     s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) ?x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"(\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v", "using g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = f v\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"... = f (\\<Sum>x\\<in>UNIV. s x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f v = f (\\<Sum>x\\<in>UNIV. s x *s X $ x)", "using s"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. s x *s X $ x) = v\n\ngoal (1 subgoal):\n 1. f v = f (\\<Sum>x\\<in>UNIV. s x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  f v = f (\\<Sum>x\\<in>UNIV. s x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "also"], ["proof (state)\nthis:\n  f v = f (\\<Sum>x\\<in>UNIV. s x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"... = (\\<Sum>x\\<in>UNIV. s x *s f (X $ x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (\\<Sum>x\\<in>UNIV. s x *s X $ x) =\n    (\\<Sum>x\\<in>UNIV. s x *s f (X $ x))", "by (simp add: sum scale)"], ["proof (state)\nthis:\n  f (\\<Sum>x\\<in>UNIV. s x *s X $ x) = (\\<Sum>x\\<in>UNIV. s x *s f (X $ x))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "also"], ["proof (state)\nthis:\n  f (\\<Sum>x\\<in>UNIV. s x *s X $ x) = (\\<Sum>x\\<in>UNIV. s x *s f (X $ x))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"... = (\\<Sum>i\\<in>UNIV. s i *s sum (\\<lambda>j. (matrix' X Y f)$j$i *s (Y$j)) UNIV)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. s x *s f (X $ x)) =\n    (\\<Sum>i\\<in>UNIV.\n       s i *s (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j))", "using matrix'[OF basis_X basis_Y]"], ["proof (prove)\nusing this:\n  ?f (X $ ?i) = (\\<Sum>j\\<in>UNIV. matrix' X Y ?f $ j $ ?i *s Y $ j)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. s x *s f (X $ x)) =\n    (\\<Sum>i\\<in>UNIV.\n       s i *s (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j))", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. s x *s f (X $ x)) =\n  (\\<Sum>i\\<in>UNIV.\n     s i *s (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. s x *s f (X $ x)) =\n  (\\<Sum>i\\<in>UNIV.\n     s i *s (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"... =  (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV.\n       s i *s (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)) =\n    (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x))", "unfolding vec.scale_sum_right"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x)) =\n    (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x))", ".."], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV.\n     s i *s (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)) =\n  (\\<Sum>i\\<in>UNIV.\n     \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV.\n     s i *s (\\<Sum>j\\<in>UNIV. matrix' X Y f $ j $ i *s Y $ j)) =\n  (\\<Sum>i\\<in>UNIV.\n     \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"... = (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. (s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s Y $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x)) =\n    (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV.\n         s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n         Y $ x)", "unfolding matrix'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV.\n         s i *s ((\\<chi>i j. coord Y (f (X $ j)) $ i) $ x $ i *s Y $ x)) =\n    (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV.\n         s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n         Y $ x)", "unfolding coord_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV.\n         s i *s\n         ((\\<chi>i j.\n              vec_lambda\n               (THE fa. f (X $ j) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) $\n              i) $\n          x $\n          i *s\n          Y $ x)) =\n    (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV.\n         s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n         Y $ x)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV.\n     \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x)) =\n  (\\<Sum>i\\<in>UNIV.\n     \\<Sum>x\\<in>UNIV.\n       s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n       Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV.\n     \\<Sum>x\\<in>UNIV. s i *s (matrix' X Y f $ x $ i *s Y $ x)) =\n  (\\<Sum>i\\<in>UNIV.\n     \\<Sum>x\\<in>UNIV.\n       s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n       Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"... = (\\<Sum>x\\<in>UNIV. (\\<Sum>i\\<in>UNIV. (s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s Y $ x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV.\n       \\<Sum>x\\<in>UNIV.\n         s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n         Y $ x) =\n    (\\<Sum>x\\<in>UNIV.\n       \\<Sum>i\\<in>UNIV.\n         s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n         Y $ x)", "by (rule sum.swap)"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV.\n     \\<Sum>x\\<in>UNIV.\n       s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n       Y $ x) =\n  (\\<Sum>x\\<in>UNIV.\n     \\<Sum>i\\<in>UNIV.\n       s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n       Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV.\n     \\<Sum>x\\<in>UNIV.\n       s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n       Y $ x) =\n  (\\<Sum>x\\<in>UNIV.\n     \\<Sum>i\\<in>UNIV.\n       s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n       Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"... =  (\\<Sum>x\\<in>UNIV. (\\<Sum>i\\<in>UNIV. (s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x)) *s Y $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       \\<Sum>i\\<in>UNIV.\n         s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n         Y $ x) =\n    (\\<Sum>x\\<in>UNIV.\n       (\\<Sum>i\\<in>UNIV.\n          s i *\n          (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s\n       Y $ x)", "unfolding vec.scale_sum_left"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       \\<Sum>i\\<in>UNIV.\n         s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n         Y $ x) =\n    (\\<Sum>x\\<in>UNIV.\n       \\<Sum>a\\<in>UNIV.\n         s a * (THE fa. f (X $ a) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n         Y $ x)", ".."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV.\n     \\<Sum>i\\<in>UNIV.\n       s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n       Y $ x) =\n  (\\<Sum>x\\<in>UNIV.\n     (\\<Sum>i\\<in>UNIV.\n        s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s\n     Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV.\n     \\<Sum>i\\<in>UNIV.\n       s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x *s\n       Y $ x) =\n  (\\<Sum>x\\<in>UNIV.\n     (\\<Sum>i\\<in>UNIV.\n        s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s\n     Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "have \"... =  (\\<Sum>x\\<in>UNIV. t x *s Y $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       (\\<Sum>i\\<in>UNIV.\n          s i *\n          (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s\n       Y $ x) =\n    (\\<Sum>x\\<in>UNIV. t x *s Y $ x)", "unfolding t_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       (\\<Sum>i\\<in>UNIV.\n          s i *\n          (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s\n       Y $ x) =\n    (\\<Sum>x\\<in>UNIV.\n       (\\<Sum>i\\<in>UNIV.\n          s i *\n          (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s\n       Y $ x)", ".."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV.\n     (\\<Sum>i\\<in>UNIV.\n        s i * (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) x) *s\n     Y $ x) =\n  (\\<Sum>x\\<in>UNIV. t x *s Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = (\\<Sum>x\\<in>UNIV. t x *s Y $ x)", "have \"(\\<Sum>x\\<in>UNIV. g x *s Y $ x) = (\\<Sum>x\\<in>UNIV. t x *s Y $ x)\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = (\\<Sum>x\\<in>UNIV. t x *s Y $ x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = (\\<Sum>x\\<in>UNIV. t x *s Y $ x)", "."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = (\\<Sum>x\\<in>UNIV. t x *s Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "hence \"g=t\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = (\\<Sum>x\\<in>UNIV. t x *s Y $ x)\n\ngoal (1 subgoal):\n 1. g = t", "using basis_combination_unique[OF basis_Y]"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s Y $ x) = (\\<Sum>x\\<in>UNIV. t x *s Y $ x)\n  (\\<Sum>i\\<in>UNIV. ?g i *s Y $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s Y $ i) \\<Longrightarrow>\n  ?f = ?g\n\ngoal (1 subgoal):\n 1. g = t", "by simp"], ["proof (state)\nthis:\n  g = t\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i =\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE fa.\n              \\<forall>i.\n                 f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n           i)", "thus \"(THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)) i =\n    (\\<Sum>x\\<in>UNIV. (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) x * (THE fa. \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)) i)\""], ["proof (prove)\nusing this:\n  g = t\n\ngoal (1 subgoal):\n 1. (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)) i =\n    (\\<Sum>x\\<in>UNIV.\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) x *\n       (THE fa.\n           \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i)", "proof (unfold  the_g the_s t_def, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>t =\n             (\\<lambda>x.\n                 \\<Sum>i\\<in>UNIV.\n                   s i *\n                   (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n                    x);\n     g =\n     (\\<lambda>x.\n         \\<Sum>i\\<in>UNIV.\n           s i *\n           (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n            x)\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>ia\\<in>UNIV.\n                         s ia *\n                         (THE fa.\n                             f (X $ ia) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n                          i) =\n                      (\\<Sum>x\\<in>UNIV.\n                         s x *\n                         (THE fa.\n                             \\<forall>i.\n                                f (X $ x) $ i =\n                                (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n                          i)", "have \" (\\<Sum>x\\<in>UNIV. s x * (THE fa. \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)) i) = \n      (\\<Sum>x\\<in>UNIV. s x * (THE fa. \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x  *s Y $ x) $ i) i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       s x *\n       (THE fa.\n           \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i) =\n    (\\<Sum>x\\<in>UNIV.\n       s x *\n       (THE fa.\n           \\<forall>i.\n              f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i)\n        i)", "unfolding sum_component"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       s x *\n       (THE fa.\n           \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i) =\n    (\\<Sum>x\\<in>UNIV.\n       s x *\n       (THE fa.\n           \\<forall>i.\n              f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. (fa x *s Y $ x) $ i))\n        i)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV.\n     s x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n      i) =\n  (\\<Sum>x\\<in>UNIV.\n     s x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i)\n      i)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>t =\n             (\\<lambda>x.\n                 \\<Sum>i\\<in>UNIV.\n                   s i *\n                   (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n                    x);\n     g =\n     (\\<lambda>x.\n         \\<Sum>i\\<in>UNIV.\n           s i *\n           (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n            x)\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>ia\\<in>UNIV.\n                         s ia *\n                         (THE fa.\n                             f (X $ ia) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n                          i) =\n                      (\\<Sum>x\\<in>UNIV.\n                         s x *\n                         (THE fa.\n                             \\<forall>i.\n                                f (X $ x) $ i =\n                                (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n                          i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV.\n     s x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n      i) =\n  (\\<Sum>x\\<in>UNIV.\n     s x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i)\n      i)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>t =\n             (\\<lambda>x.\n                 \\<Sum>i\\<in>UNIV.\n                   s i *\n                   (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n                    x);\n     g =\n     (\\<lambda>x.\n         \\<Sum>i\\<in>UNIV.\n           s i *\n           (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n            x)\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>ia\\<in>UNIV.\n                         s ia *\n                         (THE fa.\n                             f (X $ ia) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n                          i) =\n                      (\\<Sum>x\\<in>UNIV.\n                         s x *\n                         (THE fa.\n                             \\<forall>i.\n                                f (X $ x) $ i =\n                                (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n                          i)", "have \"... = (\\<Sum>x\\<in>UNIV. s x * (THE fa. f (X $ x) = (\\<Sum>x\\<in>UNIV. fa x  *s Y $ x)) i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       s x *\n       (THE fa.\n           \\<forall>i.\n              f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i)\n        i) =\n    (\\<Sum>x\\<in>UNIV.\n       s x * (THE fa. f (X $ x) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) i)", "by (rule sum.cong, auto simp add: vec_eq_iff)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV.\n     s x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i)\n      i) =\n  (\\<Sum>x\\<in>UNIV.\n     s x * (THE fa. f (X $ x) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) i)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>t =\n             (\\<lambda>x.\n                 \\<Sum>i\\<in>UNIV.\n                   s i *\n                   (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n                    x);\n     g =\n     (\\<lambda>x.\n         \\<Sum>i\\<in>UNIV.\n           s i *\n           (THE fa. f (X $ i) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n            x)\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>ia\\<in>UNIV.\n                         s ia *\n                         (THE fa.\n                             f (X $ ia) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x))\n                          i) =\n                      (\\<Sum>x\\<in>UNIV.\n                         s x *\n                         (THE fa.\n                             \\<forall>i.\n                                f (X $ x) $ i =\n                                (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n                          i)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>UNIV.\n     s x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n      i) =\n  (\\<Sum>x\\<in>UNIV.\n     s x * (THE fa. f (X $ x) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) i)", "show \" (\\<Sum>ia\\<in>UNIV. s ia * (THE fa. f (X $ ia) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) i) = (\\<Sum>x\\<in>UNIV. s x * (THE fa. \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)) i)\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV.\n     s x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n      i) =\n  (\\<Sum>x\\<in>UNIV.\n     s x * (THE fa. f (X $ x) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>ia\\<in>UNIV.\n       s ia * (THE fa. f (X $ ia) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) i) =\n    (\\<Sum>x\\<in>UNIV.\n       s x *\n       (THE fa.\n           \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n        i)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>ia\\<in>UNIV.\n     s ia * (THE fa. f (X $ ia) = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)) i) =\n  (\\<Sum>x\\<in>UNIV.\n     s x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n      i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE fa. \\<forall>i. f v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)) i =\n  (\\<Sum>x\\<in>UNIV.\n     (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) x *\n     (THE fa.\n         \\<forall>i. f (X $ x) $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i))\n      i)\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>This is the second part of the theorem 2.15 in the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "lemma matrix'_compose:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'m^'m\" and Z::\"'a^'p^'p\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"  and basis_Z: \"is_basis (set_of_vector Z)\"\n  and linear_f: \"linear ((*s)) ((*s)) f\" and linear_g: \"linear ((*s)) ((*s)) g\"\n  shows \"matrix' X Z (g \\<circ> f) = (matrix' Y Z g) ** (matrix' X Y f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Z (g \\<circ> f) = matrix' Y Z g ** matrix' X Y f", "proof (unfold matrix_eq, clarify)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "fix a::\"('a, 'n) vec\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "obtain v where v: \"a = coord X v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>v. a = coord X v \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using bij_coord[OF basis_X]"], ["proof (prove)\nusing this:\n  bij (coord X)\n\ngoal (1 subgoal):\n 1. (\\<And>v. a = coord X v \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (meson bij_pointE)"], ["proof (state)\nthis:\n  a = coord X v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "have linear_gf: \"linear ((*s)) ((*s)) (g \\<circ> f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) (g \\<circ> f)", "using Vector_Spaces.linear_compose[OF linear_f linear_g]"], ["proof (prove)\nusing this:\n  linear (*s) (*s) (g \\<circ> f)\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) (g \\<circ> f)", "."], ["proof (state)\nthis:\n  linear (*s) (*s) (g \\<circ> f)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "have \"matrix' X Z (g \\<circ> f) *v a = matrix' X Z (g \\<circ> f) *v (coord X v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Z (g \\<circ> f) *v a = matrix' X Z (g \\<circ> f) *v coord X v", "unfolding v"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Z (g \\<circ> f) *v coord X v =\n    matrix' X Z (g \\<circ> f) *v coord X v", ".."], ["proof (state)\nthis:\n  matrix' X Z (g \\<circ> f) *v a = matrix' X Z (g \\<circ> f) *v coord X v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "also"], ["proof (state)\nthis:\n  matrix' X Z (g \\<circ> f) *v a = matrix' X Z (g \\<circ> f) *v coord X v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "have \"... = coord Z ((g \\<circ> f) v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Z (g \\<circ> f) *v coord X v = coord Z ((g \\<circ> f) v)", "unfolding coord_matrix'[OF basis_X basis_Z linear_gf, symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. coord Z ((g \\<circ> f) v) = coord Z ((g \\<circ> f) v)", ".."], ["proof (state)\nthis:\n  matrix' X Z (g \\<circ> f) *v coord X v = coord Z ((g \\<circ> f) v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "also"], ["proof (state)\nthis:\n  matrix' X Z (g \\<circ> f) *v coord X v = coord Z ((g \\<circ> f) v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "have \"... = coord Z (g (f v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coord Z ((g \\<circ> f) v) = coord Z (g (f v))", "unfolding o_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. coord Z (g (f v)) = coord Z (g (f v))", ".."], ["proof (state)\nthis:\n  coord Z ((g \\<circ> f) v) = coord Z (g (f v))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "also"], ["proof (state)\nthis:\n  coord Z ((g \\<circ> f) v) = coord Z (g (f v))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "have \"... = (matrix' Y Z g) *v (coord Y (f v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coord Z (g (f v)) = matrix' Y Z g *v coord Y (f v)", "unfolding coord_matrix'[OF basis_Y basis_Z linear_g]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' Y Z g *v coord Y (f v) = matrix' Y Z g *v coord Y (f v)", ".."], ["proof (state)\nthis:\n  coord Z (g (f v)) = matrix' Y Z g *v coord Y (f v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "also"], ["proof (state)\nthis:\n  coord Z (g (f v)) = matrix' Y Z g *v coord Y (f v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "have \"... = (matrix' Y Z g) *v ((matrix' X Y f) *v (coord X v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' Y Z g *v coord Y (f v) =\n    matrix' Y Z g *v (matrix' X Y f *v coord X v)", "unfolding coord_matrix'[OF basis_X basis_Y linear_f]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' Y Z g *v (matrix' X Y f *v coord X v) =\n    matrix' Y Z g *v (matrix' X Y f *v coord X v)", ".."], ["proof (state)\nthis:\n  matrix' Y Z g *v coord Y (f v) =\n  matrix' Y Z g *v (matrix' X Y f *v coord X v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "also"], ["proof (state)\nthis:\n  matrix' Y Z g *v coord Y (f v) =\n  matrix' Y Z g *v (matrix' X Y f *v coord X v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "have \"... = ((matrix' Y Z g) ** (matrix' X Y f)) *v (coord X v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' Y Z g *v (matrix' X Y f *v coord X v) =\n    matrix' Y Z g ** matrix' X Y f *v coord X v", "unfolding matrix_vector_mul_assoc"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' Y Z g ** matrix' X Y f *v coord X v =\n    matrix' Y Z g ** matrix' X Y f *v coord X v", ".."], ["proof (state)\nthis:\n  matrix' Y Z g *v (matrix' X Y f *v coord X v) =\n  matrix' Y Z g ** matrix' X Y f *v coord X v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' X Z (g \\<circ> f) *v x = matrix' Y Z g ** matrix' X Y f *v x", "finally"], ["proof (chain)\npicking this:\n  matrix' X Z (g \\<circ> f) *v a =\n  matrix' Y Z g ** matrix' X Y f *v coord X v", "show \"matrix' X Z (g \\<circ> f) *v a = matrix' Y Z g ** matrix' X Y f *v a\""], ["proof (prove)\nusing this:\n  matrix' X Z (g \\<circ> f) *v a =\n  matrix' Y Z g ** matrix' X Y f *v coord X v\n\ngoal (1 subgoal):\n 1. matrix' X Z (g \\<circ> f) *v a = matrix' Y Z g ** matrix' X Y f *v a", "unfolding v"], ["proof (prove)\nusing this:\n  matrix' X Z (g \\<circ> f) *v coord X v =\n  matrix' Y Z g ** matrix' X Y f *v coord X v\n\ngoal (1 subgoal):\n 1. matrix' X Z (g \\<circ> f) *v coord X v =\n    matrix' Y Z g ** matrix' X Y f *v coord X v", "."], ["proof (state)\nthis:\n  matrix' X Z (g \\<circ> f) *v a = matrix' Y Z g ** matrix' X Y f *v a\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma exists_linear_eq_matrix':\n  fixes A::\"'a::{field}^'m^'n\" and X::\"'a^'m^'m\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"\\<exists>f. matrix' X Y f = A \\<and> linear ((*s)) ((*s)) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f", "define f where \"f v = sum (\\<lambda>j. A $ j $ (THE k. v = X $ k) *s Y $ j) UNIV\" for v"], ["proof (state)\nthis:\n  f ?v = (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. ?v = X $ k) *s Y $ j)\n\ngoal (1 subgoal):\n 1. \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f", "have indep: \"vec.independent (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "using basis_X"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "unfolding is_basis_def"], ["proof (prove)\nusing this:\n  vec.independent (set_of_vector X) \\<and> vec.span (set_of_vector X) = UNIV\n\ngoal (1 subgoal):\n 1. vec.independent (set_of_vector X)", "by auto"], ["proof (state)\nthis:\n  vec.independent (set_of_vector X)\n\ngoal (1 subgoal):\n 1. \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f", "define g where \"g = vec.construct (set_of_vector X) f\""], ["proof (state)\nthis:\n  g = vec.construct (set_of_vector X) f\n\ngoal (1 subgoal):\n 1. \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f", "have linear_g: \"linear ((*s)) ((*s)) g\" and f_eq_g: \"(\\<forall>x \\<in> (set_of_vector X). g x = f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) g &&& \\<forall>x\\<in>set_of_vector X. g x = f x", "using vec.linear_construct[OF indep] vec.construct_basis[OF indep]"], ["proof (prove)\nusing this:\n  linear (*s) (*s) (vec.construct (set_of_vector X) ?f)\n  ?b \\<in> set_of_vector X \\<Longrightarrow>\n  vec.construct (set_of_vector X) ?f ?b = ?f ?b\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) g &&& \\<forall>x\\<in>set_of_vector X. g x = f x", "unfolding g_def module_hom_iff_linear"], ["proof (prove)\nusing this:\n  linear (*s) (*s) (vec.construct (set_of_vector X) ?f)\n  ?b \\<in> set_of_vector X \\<Longrightarrow>\n  vec.construct (set_of_vector X) ?f ?b = ?f ?b\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) (vec.construct (set_of_vector X) f) &&&\n    \\<forall>x\\<in>set_of_vector X.\n       vec.construct (set_of_vector X) f x = f x", "by auto"], ["proof (state)\nthis:\n  linear (*s) (*s) g\n  \\<forall>x\\<in>set_of_vector X. g x = f x\n\ngoal (1 subgoal):\n 1. \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f", "proof (rule exI[of _ g], rule conjI)"], ["proof (state)\ngoal (2 subgoals):\n 1. matrix' X Y g = A\n 2. linear (*s) (*s) g", "show \"matrix' X Y g = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Y g = A", "proof (rule matrix'2)"], ["proof (state)\ngoal (3 subgoals):\n 1. is_basis (set_of_vector X)\n 2. is_basis (set_of_vector Y)\n 3. \\<forall>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "show \"is_basis (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (set_of_vector X)", "using basis_X"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector X)", "."], ["proof (state)\nthis:\n  is_basis (set_of_vector X)\n\ngoal (2 subgoals):\n 1. is_basis (set_of_vector Y)\n 2. \\<forall>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "show \"is_basis (set_of_vector Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (set_of_vector Y)", "using basis_Y"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector Y)\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector Y)", "."], ["proof (state)\nthis:\n  is_basis (set_of_vector Y)\n\ngoal (1 subgoal):\n 1. \\<forall>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "show \"\\<forall>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "proof (clarify)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "have the_k_eq_i: \"(THE k. X $ i = X $ k) = i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE k. X $ i = X $ k) = i", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. X $ i = X $ i\n 2. \\<And>k. X $ i = X $ k \\<Longrightarrow> k = i", "show \"X $ i = X $ i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X $ i = X $ i", ".."], ["proof (state)\nthis:\n  X $ i = X $ i\n\ngoal (1 subgoal):\n 1. \\<And>k. X $ i = X $ k \\<Longrightarrow> k = i", "fix k"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k. X $ i = X $ k \\<Longrightarrow> k = i", "assume Xi_Xk: \"X $ i = X $ k\""], ["proof (state)\nthis:\n  X $ i = X $ k\n\ngoal (1 subgoal):\n 1. \\<And>k. X $ i = X $ k \\<Longrightarrow> k = i", "show \"k = i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k = i", "using Xi_Xk basis_X inj_eq inj_op_nth"], ["proof (prove)\nusing this:\n  X $ i = X $ k\n  is_basis (set_of_vector X)\n  inj ?f \\<Longrightarrow> (?f ?x = ?f ?y) = (?x = ?y)\n  is_basis (set_of_vector ?X) \\<Longrightarrow> inj (($) ?X)\n\ngoal (1 subgoal):\n 1. k = i", "by metis"], ["proof (state)\nthis:\n  k = i\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE k. X $ i = X $ k) = i\n\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "have Xi_in_X:\"X$i \\<in> (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X $ i \\<in> set_of_vector X", "unfolding set_of_vector_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. X $ i \\<in> {X $ i |i. i \\<in> UNIV}", "by auto"], ["proof (state)\nthis:\n  X $ i \\<in> set_of_vector X\n\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "have \"g (X$i) = f (X$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g (X $ i) = f (X $ i)", "using f_eq_g Xi_in_X"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>set_of_vector X. g x = f x\n  X $ i \\<in> set_of_vector X\n\ngoal (1 subgoal):\n 1. g (X $ i) = f (X $ i)", "by simp"], ["proof (state)\nthis:\n  g (X $ i) = f (X $ i)\n\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "also"], ["proof (state)\nthis:\n  g (X $ i) = f (X $ i)\n\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "have \"... = (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. X $ i = X $ k) *s Y $ j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. X $ i = X $ k) *s Y $ j)", "unfolding f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. X $ i = X $ k) *s Y $ j) =\n    (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. X $ i = X $ k) *s Y $ j)", ".."], ["proof (state)\nthis:\n  f (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. X $ i = X $ k) *s Y $ j)\n\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "also"], ["proof (state)\nthis:\n  f (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. X $ i = X $ k) *s Y $ j)\n\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "have \"... = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. X $ i = X $ k) *s Y $ j) =\n    (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "unfolding the_k_eq_i"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j) =\n    (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", ".."], ["proof (state)\nthis:\n  (\\<Sum>j\\<in>UNIV. A $ j $ (THE k. X $ i = X $ k) *s Y $ j) =\n  (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)\n\ngoal (1 subgoal):\n 1. \\<And>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "finally"], ["proof (chain)\npicking this:\n  g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "show \"g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s  Y $ j)\""], ["proof (prove)\nusing this:\n  g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)\n\ngoal (1 subgoal):\n 1. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)", "."], ["proof (state)\nthis:\n  g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>i. g (X $ i) = (\\<Sum>j\\<in>UNIV. A $ j $ i *s Y $ j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  matrix' X Y g = A\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) g", "show \"linear ((*s)) ((*s)) g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) g", "using linear_g"], ["proof (prove)\nusing this:\n  linear (*s) (*s) g\n\ngoal (1 subgoal):\n 1. linear (*s) (*s) g", "."], ["proof (state)\nthis:\n  linear (*s) (*s) g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma matrix'_surj: \n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"surj (matrix' X Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. surj (matrix' X Y)", "proof (unfold surj_def, clarify)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y. \\<exists>x. y = matrix' X Y x", "fix A"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y. \\<exists>x. y = matrix' X Y x", "show \"\\<exists>f. A = matrix' X Y f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f. A = matrix' X Y f", "using exists_linear_eq_matrix'[OF basis_X basis_Y, of A]"], ["proof (prove)\nusing this:\n  \\<exists>f. matrix' X Y f = A \\<and> linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. \\<exists>f. A = matrix' X Y f", "unfolding matrix'_def"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     (\\<chi>i j. coord Y (f (X $ j)) $ i) = A \\<and> linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. \\<exists>f. A = (\\<chi>i j. coord Y (f (X $ j)) $ i)", "by auto"], ["proof (state)\nthis:\n  \\<exists>f. A = matrix' X Y f\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>Properties of @{thm \"matrix_change_of_basis_def\"}.\\<close>"], ["", "text\\<open>This is the first part of the theorem 2.12 in the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "lemma matrix_change_of_basis_works:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" \n  and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"(matrix_change_of_basis X Y) *v (coord X v) = (coord Y v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y *v coord X v = coord Y v", "proof (unfold matrix_mult_sum matrix_change_of_basis_def column_def coord_def, vector, auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "obtain f where f: \"(\\<Sum>x\\<in>UNIV. f x *s Y $ x) = v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>x\\<in>UNIV. f x *s Y $ x) = v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_Y]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s Y $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        (\\<Sum>x\\<in>UNIV. f x *s Y $ x) = v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) = v\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "obtain g where g: \"(\\<Sum>x\\<in>UNIV. g x *s X $ x) = v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_X]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s X $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        (\\<Sum>x\\<in>UNIV. g x *s X $ x) = v \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = v\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "define t where \"t x = (THE f. X $ x= (\\<Sum>a\\<in>UNIV. f a *s Y $ a))\" for x"], ["proof (state)\nthis:\n  t ?x = (THE f. X $ ?x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "define w where \"w i = (\\<Sum>x\\<in>UNIV. g x * t x i)\" for i"], ["proof (state)\nthis:\n  w ?i = (\\<Sum>x\\<in>UNIV. g x * t x ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "have the_f:\"(THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) = f", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)\n 2. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i) \\<Longrightarrow>\n       fa = f", "show \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)", "using f"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) = v\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)", "by auto"], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i) \\<Longrightarrow>\n       fa = f", "fix fa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i) \\<Longrightarrow>\n       fa = f", "assume \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)\""], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i) \\<Longrightarrow>\n       fa = f", "hence \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i\""], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. (fa x *s Y $ x) $ i)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i) \\<Longrightarrow>\n       fa = f", "hence fa: \" v = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)\""], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i\n\ngoal (1 subgoal):\n 1. v = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x) $ i", "."], ["proof (state)\nthis:\n  v = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. fa x * Y $ x $ i) \\<Longrightarrow>\n       fa = f", "show \"fa = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fa = f", "using basis_combination_unique[OF basis_Y] fa f"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s Y $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s Y $ i) \\<Longrightarrow>\n  ?f = ?g\n  v = (\\<Sum>x\\<in>UNIV. fa x *s Y $ x)\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) = v\n\ngoal (1 subgoal):\n 1. fa = f", "by simp"], ["proof (state)\nthis:\n  fa = f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) = f\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "have the_g: \"(THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = g", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)\n 2. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = g", "show \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)", "using g"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = v\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)", "by auto"], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. g x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = g", "fix fa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = g", "assume \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\""], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = g", "hence \"\\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\""], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. (fa x *s X $ x) $ i)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = g", "hence fa: \" v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\""], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i", "."], ["proof (state)\nthis:\n  v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i) \\<Longrightarrow>\n       f = g", "show \"fa = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fa = g", "using basis_combination_unique[OF basis_X] fa g"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  v = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) = v\n\ngoal (1 subgoal):\n 1. fa = g", "by simp"], ["proof (state)\nthis:\n  fa = g\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = g\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "have \"(\\<Sum>x\\<in>UNIV. f x *s Y $ x) = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x *s Y $ x) = (\\<Sum>x\\<in>UNIV. g x *s X $ x)", "unfolding f g"], ["proof (prove)\ngoal (1 subgoal):\n 1. v = v", ".."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) = (\\<Sum>x\\<in>UNIV. g x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "have \"... = (\\<Sum>x\\<in>UNIV. g x *s (sum  (\\<lambda>i. (t x i) *s Y $ i) UNIV))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s X $ x) =\n    (\\<Sum>x\\<in>UNIV. g x *s (\\<Sum>i\\<in>UNIV. t x i *s Y $ i))", "unfolding t_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s X $ x) =\n    (\\<Sum>x\\<in>UNIV.\n       g x *s\n       (\\<Sum>i\\<in>UNIV.\n          (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i *s Y $ i))", "proof (rule sum.cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. UNIV = UNIV\n 2. \\<And>x.\n       x \\<in> UNIV \\<Longrightarrow>\n       g x *s X $ x =\n       g x *s\n       (\\<Sum>i\\<in>UNIV.\n          (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i *s Y $ i)", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. UNIV = UNIV\n 2. \\<And>x.\n       x \\<in> UNIV \\<Longrightarrow>\n       g x *s X $ x =\n       g x *s\n       (\\<Sum>i\\<in>UNIV.\n          (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i *s Y $ i)", "obtain h where h: \"(\\<Sum>a\\<in>UNIV. h a *s Y $ a) = X$x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>h.\n        (\\<Sum>a\\<in>UNIV. h a *s Y $ a) = X $ x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using basis_UNIV[OF basis_Y]"], ["proof (prove)\nusing this:\n  UNIV = {x. \\<exists>g. (\\<Sum>i\\<in>UNIV. g i *s Y $ i) = x}\n\ngoal (1 subgoal):\n 1. (\\<And>h.\n        (\\<Sum>a\\<in>UNIV. h a *s Y $ a) = X $ x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>a\\<in>UNIV. h a *s Y $ a) = X $ x\n\ngoal (2 subgoals):\n 1. UNIV = UNIV\n 2. \\<And>x.\n       x \\<in> UNIV \\<Longrightarrow>\n       g x *s X $ x =\n       g x *s\n       (\\<Sum>i\\<in>UNIV.\n          (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i *s Y $ i)", "have the_h: \"(THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a))=h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) = h", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. X $ x = (\\<Sum>a\\<in>UNIV. h a *s Y $ a)\n 2. \\<And>f.\n       X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a) \\<Longrightarrow> f = h", "show \" X $ x = (\\<Sum>a\\<in>UNIV. h a *s Y $ a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X $ x = (\\<Sum>a\\<in>UNIV. h a *s Y $ a)", "using h"], ["proof (prove)\nusing this:\n  (\\<Sum>a\\<in>UNIV. h a *s Y $ a) = X $ x\n\ngoal (1 subgoal):\n 1. X $ x = (\\<Sum>a\\<in>UNIV. h a *s Y $ a)", "by simp"], ["proof (state)\nthis:\n  X $ x = (\\<Sum>a\\<in>UNIV. h a *s Y $ a)\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a) \\<Longrightarrow> f = h", "fix f"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a) \\<Longrightarrow> f = h", "assume f: \"X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)\""], ["proof (state)\nthis:\n  X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a) \\<Longrightarrow> f = h", "show \"f = h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f = h", "using basis_combination_unique[OF basis_Y] f h"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s Y $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s Y $ i) \\<Longrightarrow>\n  ?f = ?g\n  X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)\n  (\\<Sum>a\\<in>UNIV. h a *s Y $ a) = X $ x\n\ngoal (1 subgoal):\n 1. f = h", "by simp"], ["proof (state)\nthis:\n  f = h\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) = h\n\ngoal (2 subgoals):\n 1. UNIV = UNIV\n 2. \\<And>x.\n       x \\<in> UNIV \\<Longrightarrow>\n       g x *s X $ x =\n       g x *s\n       (\\<Sum>i\\<in>UNIV.\n          (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i *s Y $ i)", "show \" g x *s X $ x = g x *s (\\<Sum>i\\<in>UNIV. (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i *s Y $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g x *s X $ x =\n    g x *s\n    (\\<Sum>i\\<in>UNIV.\n       (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i *s Y $ i)", "unfolding the_h h"], ["proof (prove)\ngoal (1 subgoal):\n 1. g x *s X $ x = g x *s X $ x", ".."], ["proof (state)\nthis:\n  g x *s X $ x =\n  g x *s\n  (\\<Sum>i\\<in>UNIV.\n     (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i *s Y $ i)\n\ngoal (1 subgoal):\n 1. UNIV = UNIV", "qed rule"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. g x *s (\\<Sum>i\\<in>UNIV. t x i *s Y $ i))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s X $ x) =\n  (\\<Sum>x\\<in>UNIV. g x *s (\\<Sum>i\\<in>UNIV. t x i *s Y $ i))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "have \"... = (\\<Sum>x\\<in>UNIV. (sum  (\\<lambda>i. g x *s ((t x i) *s Y $ i)) UNIV))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. g x *s (\\<Sum>i\\<in>UNIV. t x i *s Y $ i)) =\n    (\\<Sum>x\\<in>UNIV. \\<Sum>i\\<in>UNIV. g x *s (t x i *s Y $ i))", "unfolding vec.scale_sum_right"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. \\<Sum>xa\\<in>UNIV. g x *s (t x xa *s Y $ xa)) =\n    (\\<Sum>x\\<in>UNIV. \\<Sum>i\\<in>UNIV. g x *s (t x i *s Y $ i))", ".."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s (\\<Sum>i\\<in>UNIV. t x i *s Y $ i)) =\n  (\\<Sum>x\\<in>UNIV. \\<Sum>i\\<in>UNIV. g x *s (t x i *s Y $ i))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. g x *s (\\<Sum>i\\<in>UNIV. t x i *s Y $ i)) =\n  (\\<Sum>x\\<in>UNIV. \\<Sum>i\\<in>UNIV. g x *s (t x i *s Y $ i))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "have \"... = (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. g x *s (t x i *s Y $ i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. \\<Sum>i\\<in>UNIV. g x *s (t x i *s Y $ i)) =\n    (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. g x *s (t x i *s Y $ i))", "by (rule sum.swap)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. \\<Sum>i\\<in>UNIV. g x *s (t x i *s Y $ i)) =\n  (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. g x *s (t x i *s Y $ i))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. \\<Sum>i\\<in>UNIV. g x *s (t x i *s Y $ i)) =\n  (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. g x *s (t x i *s Y $ i))\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "have \"... =  (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. g x *s (t x i *s Y $ i)) =\n    (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)", "unfolding vec.scale_sum_left"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. g x *s (t x i *s Y $ i)) =\n    (\\<Sum>i\\<in>UNIV. \\<Sum>a\\<in>UNIV. g a * t a i *s Y $ i)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>UNIV. \\<Sum>x\\<in>UNIV. g x *s (t x i *s Y $ i)) =\n  (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) =\n  (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)", "have \"(\\<Sum>x\\<in>UNIV. f x *s Y $ x) = (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i) \""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) =\n  (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x *s Y $ x) =\n    (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)", "."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) =\n  (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "hence \"f=w\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) =\n  (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)\n\ngoal (1 subgoal):\n 1. f = w", "using basis_combination_unique[OF basis_Y]"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) =\n  (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)\n  (\\<Sum>i\\<in>UNIV. ?g i *s Y $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s Y $ i) \\<Longrightarrow>\n  ?f = ?g\n\ngoal (1 subgoal):\n 1. f = w", "unfolding w_def"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s Y $ x) =\n  (\\<Sum>i\\<in>UNIV. (\\<Sum>x\\<in>UNIV. g x * t x i) *s Y $ i)\n  (\\<Sum>i\\<in>UNIV. ?g i *s Y $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s Y $ i) \\<Longrightarrow>\n  ?f = ?g\n\ngoal (1 subgoal):\n 1. f = (\\<lambda>i. \\<Sum>x\\<in>UNIV. g x * t x i)", "by auto"], ["proof (state)\nthis:\n  f = w\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       (\\<Sum>x\\<in>UNIV.\n          (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n           x *\n          (THE f.\n              \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n           i) =\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "thus \"(\\<Sum>x\\<in>UNIV. (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) x * (THE f. \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i) =\n    (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i\""], ["proof (prove)\nusing this:\n  f = w\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) x *\n       (THE f. \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n        i) =\n    (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i", "unfolding the_f the_g"], ["proof (prove)\nusing this:\n  f = w\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       g x *\n       (THE f. \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n        i) =\n    f i", "unfolding w_def t_def"], ["proof (prove)\nusing this:\n  f =\n  (\\<lambda>i.\n      \\<Sum>x\\<in>UNIV.\n        g x * (THE f. X $ x = (\\<Sum>a\\<in>UNIV. f a *s Y $ a)) i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       g x *\n       (THE f. \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n        i) =\n    f i", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  f =\n  (\\<lambda>i.\n      \\<Sum>x\\<in>UNIV.\n        g x *\n        (THE f.\n            \\<forall>i. X $ x $ i = (\\<Sum>a\\<in>UNIV. f a *s Y $ a) $ i)\n         i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV.\n       g x *\n       (THE f. \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n        i) =\n    f i", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV.\n     (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) x *\n     (THE f. \\<forall>i. X $ x $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i))\n      i) =\n  (THE f. \\<forall>i. v $ i = (\\<Sum>x\\<in>UNIV. f x * Y $ x $ i)) i\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma matrix_change_of_basis_mat_1:\n  fixes X::\"'a::{field}^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\"\n  shows \"matrix_change_of_basis X X = mat 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X X = mat (1::'a)", "proof (unfold matrix_change_of_basis_def coord_def mat_def, vector, auto)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "fix j::\"'n\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "define f :: \"'n \\<Rightarrow> 'a\" where \"f i = (if i=j then 1 else 0)\" for i"], ["proof (state)\nthis:\n  f ?i = (if ?i = j then 1::'a else (0::'a))\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "have UNIV_rw: \"UNIV = insert j (UNIV-{j})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. UNIV = insert j (UNIV - {j})", "by auto"], ["proof (state)\nthis:\n  UNIV = insert j (UNIV - {j})\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "have \"(\\<Sum>x\\<in>UNIV. f x *s X $ x) = (\\<Sum>x\\<in>(insert j (UNIV-{j})). f x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x *s X $ x) =\n    (\\<Sum>x\\<in>insert j (UNIV - {j}). f x *s X $ x)", "using UNIV_rw"], ["proof (prove)\nusing this:\n  UNIV = insert j (UNIV - {j})\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x *s X $ x) =\n    (\\<Sum>x\\<in>insert j (UNIV - {j}). f x *s X $ x)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) =\n  (\\<Sum>x\\<in>insert j (UNIV - {j}). f x *s X $ x)\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) =\n  (\\<Sum>x\\<in>insert j (UNIV - {j}). f x *s X $ x)\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "have \"... = (\\<lambda>x. f x *s X $ x) j + (\\<Sum>x\\<in>(UNIV-{j}). f x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>insert j (UNIV - {j}). f x *s X $ x) =\n    f j *s X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x)", "by (rule sum.insert, simp+)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>insert j (UNIV - {j}). f x *s X $ x) =\n  f j *s X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x)\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>insert j (UNIV - {j}). f x *s X $ x) =\n  f j *s X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x)\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "have \"... = X$j + (\\<Sum>x\\<in>(UNIV-{j}). f x *s X $ x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f j *s X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x) =\n    X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x)", "unfolding f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if j = j then 1::'a else (0::'a)) *s X $ j +\n    (\\<Sum>x\\<in>UNIV - {j}. (if x = j then 1::'a else (0::'a)) *s X $ x) =\n    X $ j +\n    (\\<Sum>x\\<in>UNIV - {j}. (if x = j then 1::'a else (0::'a)) *s X $ x)", "by simp"], ["proof (state)\nthis:\n  f j *s X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x) =\n  X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x)\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "also"], ["proof (state)\nthis:\n  f j *s X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x) =\n  X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x)\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "have \"... = X$j + 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x) = X $ j + 0", "unfolding add_left_cancel f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV - {j}. (if x = j then 1::'a else (0::'a)) *s X $ x) =\n    0", "by (rule sum.neutral, simp)"], ["proof (state)\nthis:\n  X $ j + (\\<Sum>x\\<in>UNIV - {j}. f x *s X $ x) = X $ j + 0\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = X $ j + 0", "have f: \"(\\<Sum>x\\<in>UNIV. f x *s X $ x) = X$j\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = X $ j + 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>UNIV. f x *s X $ x) = X $ j", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = X $ j\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "have the_f: \"(THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = f", "proof (rule the_equality)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)\n 2. \\<And>fa.\n       \\<forall>i.\n          X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "show \"\\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)", "using f"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = X $ j\n\ngoal (1 subgoal):\n 1. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>i. (\\<Sum>x\\<in>UNIV. f x *s X $ x) $ i = X $ j $ i\n\ngoal (1 subgoal):\n 1. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>i. (\\<Sum>x\\<in>UNIV. (f x *s X $ x) $ i) = X $ j $ i\n\ngoal (1 subgoal):\n 1. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "fix fa"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "assume \"\\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\""], ["proof (state)\nthis:\n  \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "hence \"\\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\""], ["proof (prove)\nusing this:\n  \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i", "unfolding sum_component"], ["proof (prove)\nusing this:\n  \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. (fa x *s X $ x) $ i)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "hence fa: \"X $ j =  (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\""], ["proof (prove)\nusing this:\n  \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. X $ j = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i\n\ngoal (1 subgoal):\n 1. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x *s X $ x) $ i", "."], ["proof (state)\nthis:\n  X $ j = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n\ngoal (1 subgoal):\n 1. \\<And>fa.\n       \\<forall>i.\n          X $ j $ i = (\\<Sum>x\\<in>UNIV. fa x * X $ x $ i) \\<Longrightarrow>\n       fa = f", "show \"fa = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fa = f", "using basis_combination_unique[OF basis_X] fa f"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. ?g i *s X $ i) =\n  (\\<Sum>i\\<in>UNIV. ?f i *s X $ i) \\<Longrightarrow>\n  ?f = ?g\n  X $ j = (\\<Sum>x\\<in>UNIV. fa x *s X $ x)\n  (\\<Sum>x\\<in>UNIV. f x *s X $ x) = X $ j\n\ngoal (1 subgoal):\n 1. fa = f", "by simp"], ["proof (state)\nthis:\n  fa = f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) = f\n\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        ia =\n       (1::'a)\n 2. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "show \"(THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) j = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) j =\n    (1::'a)", "unfolding the_f f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if j = j then 1::'a else (0::'a)) = (1::'a)", "by simp"], ["proof (state)\nthis:\n  (THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) j =\n  (1::'a)\n\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "assume i_not_j: \"i \\<noteq> j\""], ["proof (state)\nthis:\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. \\<And>i ia.\n       i \\<noteq> ia \\<Longrightarrow>\n       (THE f. \\<forall>i. X $ ia $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i))\n        i =\n       (0::'a)", "show \"(THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i =\n    (0::'a)", "unfolding the_f f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if i = j then 1::'a else (0::'a)) = (0::'a)", "using i_not_j"], ["proof (prove)\nusing this:\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. (if i = j then 1::'a else (0::'a)) = (0::'a)", "by simp"], ["proof (state)\nthis:\n  (THE f. \\<forall>i. X $ j $ i = (\\<Sum>x\\<in>UNIV. f x * X $ x $ i)) i =\n  (0::'a)\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>Relationships between @{thm \"matrix'_def\"} and @{thm \"matrix_change_of_basis_def\"}.\n      This is the theorem 2.16 in the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "lemma matrix'_matrix_change_of_basis:\n  fixes B::\"'a::{field}^'n^'n\" and B'::\"'a^'n^'n\" and C::\"'a^'m^'m\" and C'::\"'a^'m^'m\"\n  assumes basis_B: \"is_basis (set_of_vector B)\" and basis_B': \"is_basis (set_of_vector B')\"\n  and basis_C: \"is_basis (set_of_vector C)\" and basis_C': \"is_basis (set_of_vector C')\"\n  and linear_f: \"linear ((*s)) ((*s)) f\"\n  shows \"matrix' B' C' f = matrix_change_of_basis C C' ** matrix' B C f ** matrix_change_of_basis B' B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' B' C' f =\n    matrix_change_of_basis C C' ** matrix' B C f **\n    matrix_change_of_basis B' B", "proof (unfold matrix_eq, clarify)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "obtain v where v: \"x=coord B' v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>v. x = coord B' v \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using bij_coord[OF basis_B']"], ["proof (prove)\nusing this:\n  bij (coord B')\n\ngoal (1 subgoal):\n 1. (\\<And>v. x = coord B' v \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (meson bij_pointE)"], ["proof (state)\nthis:\n  x = coord B' v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "have \"matrix_change_of_basis C C' ** matrix' B C f** matrix_change_of_basis B' B *v (coord B' v) \n    = matrix_change_of_basis C C' ** matrix' B C f *v (matrix_change_of_basis B' B *v (coord B' v)) \""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' ** matrix' B C f **\n    matrix_change_of_basis B' B *v\n    coord B' v =\n    matrix_change_of_basis C C' ** matrix' B C f *v\n    (matrix_change_of_basis B' B *v coord B' v)", "unfolding matrix_vector_mul_assoc"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' ** matrix' B C f **\n    matrix_change_of_basis B' B *v\n    coord B' v =\n    matrix_change_of_basis C C' ** matrix' B C f **\n    matrix_change_of_basis B' B *v\n    coord B' v", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis C C' ** matrix' B C f **\n  matrix_change_of_basis B' B *v\n  coord B' v =\n  matrix_change_of_basis C C' ** matrix' B C f *v\n  (matrix_change_of_basis B' B *v coord B' v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis C C' ** matrix' B C f **\n  matrix_change_of_basis B' B *v\n  coord B' v =\n  matrix_change_of_basis C C' ** matrix' B C f *v\n  (matrix_change_of_basis B' B *v coord B' v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "have \"... = matrix_change_of_basis C C' ** matrix' B C f *v (coord B v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' ** matrix' B C f *v\n    (matrix_change_of_basis B' B *v coord B' v) =\n    matrix_change_of_basis C C' ** matrix' B C f *v coord B v", "unfolding matrix_change_of_basis_works[OF basis_B' basis_B]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' ** matrix' B C f *v coord B v =\n    matrix_change_of_basis C C' ** matrix' B C f *v coord B v", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis C C' ** matrix' B C f *v\n  (matrix_change_of_basis B' B *v coord B' v) =\n  matrix_change_of_basis C C' ** matrix' B C f *v coord B v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis C C' ** matrix' B C f *v\n  (matrix_change_of_basis B' B *v coord B' v) =\n  matrix_change_of_basis C C' ** matrix' B C f *v coord B v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "have \"... = matrix_change_of_basis C C' *v (matrix' B C f *v (coord B v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' ** matrix' B C f *v coord B v =\n    matrix_change_of_basis C C' *v (matrix' B C f *v coord B v)", "unfolding matrix_vector_mul_assoc"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' ** matrix' B C f *v coord B v =\n    matrix_change_of_basis C C' ** matrix' B C f *v coord B v", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis C C' ** matrix' B C f *v coord B v =\n  matrix_change_of_basis C C' *v (matrix' B C f *v coord B v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis C C' ** matrix' B C f *v coord B v =\n  matrix_change_of_basis C C' *v (matrix' B C f *v coord B v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "have \"... = matrix_change_of_basis C C' *v (coord C (f v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' *v (matrix' B C f *v coord B v) =\n    matrix_change_of_basis C C' *v coord C (f v)", "unfolding coord_matrix'[OF basis_B basis_C linear_f]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' *v (matrix' B C f *v coord B v) =\n    matrix_change_of_basis C C' *v (matrix' B C f *v coord B v)", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis C C' *v (matrix' B C f *v coord B v) =\n  matrix_change_of_basis C C' *v coord C (f v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis C C' *v (matrix' B C f *v coord B v) =\n  matrix_change_of_basis C C' *v coord C (f v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "have \"... = coord C' (f v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis C C' *v coord C (f v) = coord C' (f v)", "unfolding matrix_change_of_basis_works[OF basis_C basis_C']"], ["proof (prove)\ngoal (1 subgoal):\n 1. coord C' (f v) = coord C' (f v)", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis C C' *v coord C (f v) = coord C' (f v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis C C' *v coord C (f v) = coord C' (f v)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "have \"... = matrix' B' C' f *v coord B' v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coord C' (f v) = matrix' B' C' f *v coord B' v", "unfolding coord_matrix'[OF basis_B' basis_C' linear_f]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' B' C' f *v coord B' v = matrix' B' C' f *v coord B' v", ".."], ["proof (state)\nthis:\n  coord C' (f v) = matrix' B' C' f *v coord B' v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       matrix' B' C' f *v x =\n       matrix_change_of_basis C C' ** matrix' B C f **\n       matrix_change_of_basis B' B *v\n       x", "finally"], ["proof (chain)\npicking this:\n  matrix_change_of_basis C C' ** matrix' B C f **\n  matrix_change_of_basis B' B *v\n  coord B' v =\n  matrix' B' C' f *v coord B' v", "show \" matrix' B' C' f *v x = matrix_change_of_basis C C' ** matrix' B C f ** matrix_change_of_basis B' B *v x\""], ["proof (prove)\nusing this:\n  matrix_change_of_basis C C' ** matrix' B C f **\n  matrix_change_of_basis B' B *v\n  coord B' v =\n  matrix' B' C' f *v coord B' v\n\ngoal (1 subgoal):\n 1. matrix' B' C' f *v x =\n    matrix_change_of_basis C C' ** matrix' B C f **\n    matrix_change_of_basis B' B *v\n    x", "unfolding v"], ["proof (prove)\nusing this:\n  matrix_change_of_basis C C' ** matrix' B C f **\n  matrix_change_of_basis B' B *v\n  coord B' v =\n  matrix' B' C' f *v coord B' v\n\ngoal (1 subgoal):\n 1. matrix' B' C' f *v coord B' v =\n    matrix_change_of_basis C C' ** matrix' B C f **\n    matrix_change_of_basis B' B *v\n    coord B' v", ".."], ["proof (state)\nthis:\n  matrix' B' C' f *v x =\n  matrix_change_of_basis C C' ** matrix' B C f **\n  matrix_change_of_basis B' B *v\n  x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma matrix'_id_eq_matrix_change_of_basis:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"matrix' X Y (id) = matrix_change_of_basis X Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Y id = matrix_change_of_basis X Y", "unfolding matrix'_def matrix_change_of_basis_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<chi>i j. coord Y (id (X $ j)) $ i) = (\\<chi>i j. coord Y (X $ j) $ i)", "unfolding id_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<chi>i j. coord Y (X $ j) $ i) = (\\<chi>i j. coord Y (X $ j) $ i)", ".."], ["", "text\\<open>Relationships among @{thm \"invertible_lf_def\"}, @{thm \"matrix_change_of_basis_def\"}, @{thm \"matrix'_def\"} and @{thm \"invertible_def\"}.\\<close>"], ["", "text\\<open>This is the second part of the theorem 2.12 in the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "lemma matrix_inv_matrix_change_of_basis:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows\"matrix_change_of_basis Y X = matrix_inv (matrix_change_of_basis X Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y X = matrix_inv (matrix_change_of_basis X Y)", "proof (rule matrix_inv_unique[symmetric])"], ["proof (state)\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "have linear_id: \"linear ((*s)) ((*s)) id\""], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (*s) (*s) id", "by (metis vec.linear_id)"], ["proof (state)\nthis:\n  linear (*s) (*s) id\n\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "have \"(matrix_change_of_basis Y X) ** (matrix_change_of_basis X Y) = (matrix' Y X id) ** (matrix' X Y id)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y X ** matrix_change_of_basis X Y =\n    matrix' Y X id ** matrix' X Y id", "unfolding matrix'_id_eq_matrix_change_of_basis[OF basis_X basis_Y]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y X ** matrix_change_of_basis X Y =\n    matrix' Y X id ** matrix_change_of_basis X Y", "unfolding matrix'_id_eq_matrix_change_of_basis[OF basis_Y basis_X]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y X ** matrix_change_of_basis X Y =\n    matrix_change_of_basis Y X ** matrix_change_of_basis X Y", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis Y X ** matrix_change_of_basis X Y =\n  matrix' Y X id ** matrix' X Y id\n\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis Y X ** matrix_change_of_basis X Y =\n  matrix' Y X id ** matrix' X Y id\n\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "have \"... = matrix' X X (id \\<circ> id)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' Y X id ** matrix' X Y id = matrix' X X (id \\<circ> id)", "using matrix'_compose[OF basis_X basis_Y basis_X linear_id linear_id]"], ["proof (prove)\nusing this:\n  matrix' X X (id \\<circ> id) = matrix' Y X id ** matrix' X Y id\n\ngoal (1 subgoal):\n 1. matrix' Y X id ** matrix' X Y id = matrix' X X (id \\<circ> id)", ".."], ["proof (state)\nthis:\n  matrix' Y X id ** matrix' X Y id = matrix' X X (id \\<circ> id)\n\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "also"], ["proof (state)\nthis:\n  matrix' Y X id ** matrix' X Y id = matrix' X X (id \\<circ> id)\n\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "have \"... = matrix_change_of_basis X X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X X (id \\<circ> id) = matrix_change_of_basis X X", "using  matrix'_id_eq_matrix_change_of_basis[OF basis_X basis_X]"], ["proof (prove)\nusing this:\n  matrix' X X id = matrix_change_of_basis X X\n\ngoal (1 subgoal):\n 1. matrix' X X (id \\<circ> id) = matrix_change_of_basis X X", "unfolding o_def id_def"], ["proof (prove)\nusing this:\n  matrix' X X (\\<lambda>x. x) = matrix_change_of_basis X X\n\ngoal (1 subgoal):\n 1. matrix' X X (\\<lambda>x. x) = matrix_change_of_basis X X", "."], ["proof (state)\nthis:\n  matrix' X X (id \\<circ> id) = matrix_change_of_basis X X\n\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "also"], ["proof (state)\nthis:\n  matrix' X X (id \\<circ> id) = matrix_change_of_basis X X\n\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "have \"... = mat 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X X = mat (1::'a)", "using matrix_change_of_basis_mat_1[OF basis_X]"], ["proof (prove)\nusing this:\n  matrix_change_of_basis X X = mat (1::'a)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X X = mat (1::'a)", "."], ["proof (state)\nthis:\n  matrix_change_of_basis X X = mat (1::'a)\n\ngoal (2 subgoals):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n 2. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "finally"], ["proof (chain)\npicking this:\n  matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "show \"matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat 1\""], ["proof (prove)\nusing this:\n  matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)", "."], ["proof (state)\nthis:\n  matrix_change_of_basis Y X ** matrix_change_of_basis X Y = mat (1::'a)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "have \"(matrix_change_of_basis X Y) ** (matrix_change_of_basis Y X) = (matrix' X Y id) ** (matrix' Y X id)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X =\n    matrix' X Y id ** matrix' Y X id", "unfolding matrix'_id_eq_matrix_change_of_basis[OF basis_X basis_Y]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X =\n    matrix_change_of_basis X Y ** matrix' Y X id", "unfolding matrix'_id_eq_matrix_change_of_basis[OF basis_Y basis_X]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X =\n    matrix_change_of_basis X Y ** matrix_change_of_basis Y X", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis X Y ** matrix_change_of_basis Y X =\n  matrix' X Y id ** matrix' Y X id\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis X Y ** matrix_change_of_basis Y X =\n  matrix' X Y id ** matrix' Y X id\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "have \"... = matrix' Y Y (id \\<circ> id)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X Y id ** matrix' Y X id = matrix' Y Y (id \\<circ> id)", "using matrix'_compose[OF basis_Y basis_X basis_Y linear_id linear_id]"], ["proof (prove)\nusing this:\n  matrix' Y Y (id \\<circ> id) = matrix' X Y id ** matrix' Y X id\n\ngoal (1 subgoal):\n 1. matrix' X Y id ** matrix' Y X id = matrix' Y Y (id \\<circ> id)", ".."], ["proof (state)\nthis:\n  matrix' X Y id ** matrix' Y X id = matrix' Y Y (id \\<circ> id)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "also"], ["proof (state)\nthis:\n  matrix' X Y id ** matrix' Y X id = matrix' Y Y (id \\<circ> id)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "have \"... = matrix_change_of_basis Y Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' Y Y (id \\<circ> id) = matrix_change_of_basis Y Y", "using  matrix'_id_eq_matrix_change_of_basis[OF basis_Y basis_Y]"], ["proof (prove)\nusing this:\n  matrix' Y Y id = matrix_change_of_basis Y Y\n\ngoal (1 subgoal):\n 1. matrix' Y Y (id \\<circ> id) = matrix_change_of_basis Y Y", "unfolding o_def id_def"], ["proof (prove)\nusing this:\n  matrix' Y Y (\\<lambda>x. x) = matrix_change_of_basis Y Y\n\ngoal (1 subgoal):\n 1. matrix' Y Y (\\<lambda>x. x) = matrix_change_of_basis Y Y", "."], ["proof (state)\nthis:\n  matrix' Y Y (id \\<circ> id) = matrix_change_of_basis Y Y\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "also"], ["proof (state)\nthis:\n  matrix' Y Y (id \\<circ> id) = matrix_change_of_basis Y Y\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "have \"... = mat 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y Y = mat (1::'a)", "using matrix_change_of_basis_mat_1[OF basis_Y]"], ["proof (prove)\nusing this:\n  matrix_change_of_basis Y Y = mat (1::'a)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y Y = mat (1::'a)", "."], ["proof (state)\nthis:\n  matrix_change_of_basis Y Y = mat (1::'a)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "finally"], ["proof (chain)\npicking this:\n  matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "show \"matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat 1\""], ["proof (prove)\nusing this:\n  matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)", "."], ["proof (state)\nthis:\n  matrix_change_of_basis X Y ** matrix_change_of_basis Y X = mat (1::'a)\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>The following four lemmas are the proof of the theorem 2.13 in the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "corollary invertible_matrix_change_of_basis:\n  fixes X::\"'a::{field}^'n^'n\" and Y::\"'a^'n^'n\"\n  assumes basis_X: \"is_basis (set_of_vector X)\" and  basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"invertible (matrix_change_of_basis X Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix_change_of_basis X Y)", "by (metis basis_X basis_Y invertible_left_inverse vec.linear_id \n    matrix'_id_eq_matrix_change_of_basis matrix'_matrix_change_of_basis \n    matrix_change_of_basis_mat_1)"], ["", "lemma invertible_lf_imp_invertible_matrix':\nfixes f:: \"'a::{field}^'b \\<Rightarrow> 'a^'b\"\nassumes \"invertible_lf ((*s)) ((*s)) f\" and basis_X: \"is_basis (set_of_vector X)\" and basis_Y: \"is_basis (set_of_vector Y)\"\nshows \"invertible (matrix' X Y f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix' X Y f)", "by (metis (lifting) assms(1) basis_X basis_Y invertible_lf_def invertible_lf_imp_invertible_matrix\n    invertible_matrix_change_of_basis invertible_mult is_basis_cart_basis' matrix'_eq_matrix matrix'_matrix_change_of_basis)"], ["", "lemma invertible_matrix'_imp_invertible_lf:\nfixes f:: \"'a::{field}^'b \\<Rightarrow> 'a^'b\"\n  assumes \"invertible (matrix' X Y f)\"  and basis_X: \"is_basis (set_of_vector X)\" \n  and linear_f: \"linear ((*s)) ((*s)) f\" and basis_Y: \"is_basis (set_of_vector Y)\"\n  shows \"invertible_lf ((*s)) ((*s)) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) f", "unfolding invertible_matrix_iff_invertible_lf'[OF linear_f, symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix f)", "by (metis assms(1) basis_X basis_Y id_o invertible_matrix_change_of_basis \n     invertible_mult is_basis_cart_basis' linear_f vec.linear_id \n    matrix'_compose matrix'_eq_matrix matrix'_id_eq_matrix_change_of_basis matrix'_matrix_change_of_basis)"], ["", "lemma invertible_matrix_is_change_of_basis:\n  assumes invertible_P: \"invertible P\" and basis_X: \"is_basis (set_of_vector X)\" \n  shows \"\\<exists>!Y. matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>!Y.\n       matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)", "proof (auto)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>Y.\n       matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)\n 2. \\<And>Y y.\n       \\<lbrakk>is_basis (set_of_vector Y); P = matrix_change_of_basis Y X;\n        matrix_change_of_basis y X = matrix_change_of_basis Y X;\n        is_basis (set_of_vector y)\\<rbrakk>\n       \\<Longrightarrow> Y = y", "show \"\\<exists>Y. matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>Y.\n       matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>Y.\n       matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)", "fix i j"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>Y.\n       matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)", "obtain f where P: \"P = matrix' X X f\" and linear_f: \"linear ((*s)) ((*s)) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>P = matrix' X X f; linear (*s) (*s) f\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using exists_linear_eq_matrix'[OF basis_X basis_X, of P]"], ["proof (prove)\nusing this:\n  \\<exists>f. matrix' X X f = P \\<and> linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>P = matrix' X X f; linear (*s) (*s) f\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  P = matrix' X X f\n  linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. \\<exists>Y.\n       matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>Y.\n       matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)", "proof (rule exI[of _ \"\\<chi> j. f (X$j)\"], rule conjI)"], ["proof (state)\ngoal (2 subgoals):\n 1. matrix_change_of_basis (\\<chi>j. f (X $ j)) X = P\n 2. is_basis (set_of_vector (\\<chi>j. f (X $ j)))", "show \"matrix_change_of_basis (\\<chi> j. f (X $ j)) X = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis (\\<chi>j. f (X $ j)) X = P", "unfolding matrix_change_of_basis_def P matrix'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<chi>i j. coord X ((\\<chi>j. f (X $ j)) $ j) $ i) =\n    (\\<chi>i j. coord X (f (X $ j)) $ i)", "by vector"], ["proof (state)\nthis:\n  matrix_change_of_basis (\\<chi>j. f (X $ j)) X = P\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector (\\<chi>j. f (X $ j)))", "have invertible_f: \"invertible_lf ((*s)) ((*s)) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) f", "using invertible_matrix'_imp_invertible_lf[OF _ basis_X linear_f basis_X]"], ["proof (prove)\nusing this:\n  invertible (matrix' X X f) \\<Longrightarrow> invertible_lf (*s) (*s) f\n\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) f", "using invertible_P"], ["proof (prove)\nusing this:\n  invertible (matrix' X X f) \\<Longrightarrow> invertible_lf (*s) (*s) f\n  invertible P\n\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) f", "unfolding P"], ["proof (prove)\nusing this:\n  invertible (matrix' X X f) \\<Longrightarrow> invertible_lf (*s) (*s) f\n  invertible (matrix' X X f)\n\ngoal (1 subgoal):\n 1. invertible_lf (*s) (*s) f", "by simp"], ["proof (state)\nthis:\n  invertible_lf (*s) (*s) f\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector (\\<chi>j. f (X $ j)))", "have rw: \"set_of_vector (\\<chi> j. f (X $ j)) = f`(set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_of_vector (\\<chi>j. f (X $ j)) = f ` set_of_vector X", "unfolding set_of_vector_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(\\<chi>j. f (X $ j)) $ i |i. i \\<in> UNIV} =\n    f ` {X $ i |i. i \\<in> UNIV}", "by auto"], ["proof (state)\nthis:\n  set_of_vector (\\<chi>j. f (X $ j)) = f ` set_of_vector X\n\ngoal (1 subgoal):\n 1. is_basis (set_of_vector (\\<chi>j. f (X $ j)))", "show \"is_basis (set_of_vector (\\<chi> j. f (X $ j)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (set_of_vector (\\<chi>j. f (X $ j)))", "unfolding rw"], ["proof (prove)\ngoal (1 subgoal):\n 1. is_basis (f ` set_of_vector X)", "using basis_image_linear[OF invertible_f basis_X]"], ["proof (prove)\nusing this:\n  is_basis (f ` set_of_vector X)\n\ngoal (1 subgoal):\n 1. is_basis (f ` set_of_vector X)", "."], ["proof (state)\nthis:\n  is_basis (set_of_vector (\\<chi>j. f (X $ j)))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>Y.\n     matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>Y.\n     matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)\n\ngoal (1 subgoal):\n 1. \\<And>Y y.\n       \\<lbrakk>is_basis (set_of_vector Y); P = matrix_change_of_basis Y X;\n        matrix_change_of_basis y X = matrix_change_of_basis Y X;\n        is_basis (set_of_vector y)\\<rbrakk>\n       \\<Longrightarrow> Y = y", "fix Y Z"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>Y y.\n       \\<lbrakk>is_basis (set_of_vector Y); P = matrix_change_of_basis Y X;\n        matrix_change_of_basis y X = matrix_change_of_basis Y X;\n        is_basis (set_of_vector y)\\<rbrakk>\n       \\<Longrightarrow> Y = y", "assume basis_Y:\"is_basis (set_of_vector Y)\" and eq: \"matrix_change_of_basis Z X = matrix_change_of_basis Y X\" and basis_Z: \"is_basis (set_of_vector Z)\""], ["proof (state)\nthis:\n  is_basis (set_of_vector Y)\n  matrix_change_of_basis Z X = matrix_change_of_basis Y X\n  is_basis (set_of_vector Z)\n\ngoal (1 subgoal):\n 1. \\<And>Y y.\n       \\<lbrakk>is_basis (set_of_vector Y); P = matrix_change_of_basis Y X;\n        matrix_change_of_basis y X = matrix_change_of_basis Y X;\n        is_basis (set_of_vector y)\\<rbrakk>\n       \\<Longrightarrow> Y = y", "have ZY_coord: \"\\<forall>i. coord X (Z$i) = coord X (Y$i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. coord X (Z $ i) = coord X (Y $ i)", "using eq"], ["proof (prove)\nusing this:\n  matrix_change_of_basis Z X = matrix_change_of_basis Y X\n\ngoal (1 subgoal):\n 1. \\<forall>i. coord X (Z $ i) = coord X (Y $ i)", "unfolding matrix_change_of_basis_def"], ["proof (prove)\nusing this:\n  (\\<chi>i j. coord X (Z $ j) $ i) = (\\<chi>i j. coord X (Y $ j) $ i)\n\ngoal (1 subgoal):\n 1. \\<forall>i. coord X (Z $ i) = coord X (Y $ i)", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<forall>i ia.\n     (\\<chi>i j. coord X (Z $ j) $ i) $ i $ ia =\n     (\\<chi>i j. coord X (Y $ j) $ i) $ i $ ia\n\ngoal (1 subgoal):\n 1. \\<forall>i ia. coord X (Z $ i) $ ia = coord X (Y $ i) $ ia", "by vector"], ["proof (state)\nthis:\n  \\<forall>i. coord X (Z $ i) = coord X (Y $ i)\n\ngoal (1 subgoal):\n 1. \\<And>Y y.\n       \\<lbrakk>is_basis (set_of_vector Y); P = matrix_change_of_basis Y X;\n        matrix_change_of_basis y X = matrix_change_of_basis Y X;\n        is_basis (set_of_vector y)\\<rbrakk>\n       \\<Longrightarrow> Y = y", "show \"Y=Z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y = Z", "by (vector, metis ZY_coord coord_eq[OF basis_X])"], ["proof (state)\nthis:\n  Y = Z\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection\\<open>Equivalent Matrices\\<close>"], ["", "text\\<open>Next definition follows the one presented in Modern Algebra by Seth Warner.\\<close>"], ["", "definition \"equivalent_matrices A B = (\\<exists>P Q. invertible P \\<and> invertible Q \\<and> B = (matrix_inv P)**A**Q)\""], ["", "lemma exists_basis: \"\\<exists>X::'a::{field}^'n^'n. is_basis (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>X. is_basis (set_of_vector X)", "using is_basis_cart_basis'"], ["proof (prove)\nusing this:\n  is_basis (set_of_vector cart_basis')\n\ngoal (1 subgoal):\n 1. \\<exists>X. is_basis (set_of_vector X)", "by auto"], ["", "lemma equivalent_implies_exist_matrix':\n  assumes equivalent: \"equivalent_matrices A B\"\n  shows \"\\<exists>X Y X' Y' f::'a::{field}^'n\\<Rightarrow>'a^'m. \n  linear ((*s)) ((*s)) f \\<and> matrix' X Y f = A \\<and> matrix' X' Y' f = B \\<and> is_basis (set_of_vector X) \n  \\<and> is_basis (set_of_vector Y) \\<and> is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "obtain X::\"'a^'n^'n\" where X: \"is_basis (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X.\n        is_basis (set_of_vector X) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using exists_basis"], ["proof (prove)\nusing this:\n  \\<exists>X. is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. (\\<And>X.\n        is_basis (set_of_vector X) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "obtain Y::\"'a^'m^'m\" where Y: \"is_basis (set_of_vector Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Y.\n        is_basis (set_of_vector Y) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using exists_basis"], ["proof (prove)\nusing this:\n  \\<exists>X. is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. (\\<And>Y.\n        is_basis (set_of_vector Y) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  is_basis (set_of_vector Y)\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "obtain P Q where B_PAQ: \"B=(matrix_inv P)**A**Q\" and inv_P: \"invertible P\" and inv_Q: \"invertible Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>P Q.\n        \\<lbrakk>B = matrix_inv P ** A ** Q; invertible P;\n         invertible Q\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using equivalent"], ["proof (prove)\nusing this:\n  equivalent_matrices A B\n\ngoal (1 subgoal):\n 1. (\\<And>P Q.\n        \\<lbrakk>B = matrix_inv P ** A ** Q; invertible P;\n         invertible Q\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding equivalent_matrices_def"], ["proof (prove)\nusing this:\n  \\<exists>P Q.\n     invertible P \\<and> invertible Q \\<and> B = matrix_inv P ** A ** Q\n\ngoal (1 subgoal):\n 1. (\\<And>P Q.\n        \\<lbrakk>B = matrix_inv P ** A ** Q; invertible P;\n         invertible Q\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  B = matrix_inv P ** A ** Q\n  invertible P\n  invertible Q\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "obtain f where f_A: \"matrix' X Y f = A\" and linear_f: \"linear ((*s)) ((*s)) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>matrix' X Y f = A; linear (*s) (*s) f\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using exists_linear_eq_matrix'[OF X Y]"], ["proof (prove)\nusing this:\n  \\<exists>f. matrix' X Y f = ?A \\<and> linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>matrix' X Y f = A; linear (*s) (*s) f\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  matrix' X Y f = A\n  linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "obtain X'::\"'a^'n^'n\" where X': \"is_basis (set_of_vector X')\" and Q:\"matrix_change_of_basis X' X = Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X'.\n        \\<lbrakk>is_basis (set_of_vector X');\n         matrix_change_of_basis X' X = Q\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using invertible_matrix_is_change_of_basis[OF inv_Q X]"], ["proof (prove)\nusing this:\n  \\<exists>!Y.\n     matrix_change_of_basis Y X = Q \\<and> is_basis (set_of_vector Y)\n\ngoal (1 subgoal):\n 1. (\\<And>X'.\n        \\<lbrakk>is_basis (set_of_vector X');\n         matrix_change_of_basis X' X = Q\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fast"], ["proof (state)\nthis:\n  is_basis (set_of_vector X')\n  matrix_change_of_basis X' X = Q\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "obtain Y'::\"'a^'m^'m\" where Y': \"is_basis (set_of_vector Y')\" and P: \"matrix_change_of_basis Y' Y = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Y'.\n        \\<lbrakk>is_basis (set_of_vector Y');\n         matrix_change_of_basis Y' Y = P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using invertible_matrix_is_change_of_basis[OF inv_P Y]"], ["proof (prove)\nusing this:\n  \\<exists>!Ya.\n     matrix_change_of_basis Ya Y = P \\<and> is_basis (set_of_vector Ya)\n\ngoal (1 subgoal):\n 1. (\\<And>Y'.\n        \\<lbrakk>is_basis (set_of_vector Y');\n         matrix_change_of_basis Y' Y = P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fast"], ["proof (state)\nthis:\n  is_basis (set_of_vector Y')\n  matrix_change_of_basis Y' Y = P\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "have matrix_inv_P: \"matrix_change_of_basis Y Y' = matrix_inv P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y Y' = matrix_inv P", "using matrix_inv_matrix_change_of_basis[OF Y' Y] P"], ["proof (prove)\nusing this:\n  matrix_change_of_basis Y Y' = matrix_inv (matrix_change_of_basis Y' Y)\n  matrix_change_of_basis Y' Y = P\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y Y' = matrix_inv P", "by simp"], ["proof (state)\nthis:\n  matrix_change_of_basis Y Y' = matrix_inv P\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "have \"matrix' X' Y' f = matrix_change_of_basis Y Y' ** matrix' X Y f ** matrix_change_of_basis X' X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X' Y' f =\n    matrix_change_of_basis Y Y' ** matrix' X Y f **\n    matrix_change_of_basis X' X", "using matrix'_matrix_change_of_basis[OF X X' Y Y' linear_f]"], ["proof (prove)\nusing this:\n  matrix' X' Y' f =\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X\n\ngoal (1 subgoal):\n 1. matrix' X' Y' f =\n    matrix_change_of_basis Y Y' ** matrix' X Y f **\n    matrix_change_of_basis X' X", "."], ["proof (state)\nthis:\n  matrix' X' Y' f =\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "also"], ["proof (state)\nthis:\n  matrix' X' Y' f =\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "have \"... = (matrix_inv P) ** A ** Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y Y' ** matrix' X Y f **\n    matrix_change_of_basis X' X =\n    matrix_inv P ** A ** Q", "unfolding matrix_inv_P f_A Q"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_inv P ** A ** Q = matrix_inv P ** A ** Q", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X =\n  matrix_inv P ** A ** Q\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X =\n  matrix_inv P ** A ** Q\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "have \"... = B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_inv P ** A ** Q = B", "using B_PAQ"], ["proof (prove)\nusing this:\n  B = matrix_inv P ** A ** Q\n\ngoal (1 subgoal):\n 1. matrix_inv P ** A ** Q = B", ".."], ["proof (state)\nthis:\n  matrix_inv P ** A ** Q = B\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "finally"], ["proof (chain)\npicking this:\n  matrix' X' Y' f = B", "show ?thesis"], ["proof (prove)\nusing this:\n  matrix' X' Y' f = B\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "using f_A X X' Y Y' linear_f"], ["proof (prove)\nusing this:\n  matrix' X' Y' f = B\n  matrix' X Y f = A\n  is_basis (set_of_vector X)\n  is_basis (set_of_vector X')\n  is_basis (set_of_vector Y)\n  is_basis (set_of_vector Y')\n  linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. \\<exists>X Y X' Y' f.\n       linear (*s) (*s) f \\<and>\n       matrix' X Y f = A \\<and>\n       matrix' X' Y' f = B \\<and>\n       is_basis (set_of_vector X) \\<and>\n       is_basis (set_of_vector Y) \\<and>\n       is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')", "by fast"], ["proof (state)\nthis:\n  \\<exists>X Y X' Y' f.\n     linear (*s) (*s) f \\<and>\n     matrix' X Y f = A \\<and>\n     matrix' X' Y' f = B \\<and>\n     is_basis (set_of_vector X) \\<and>\n     is_basis (set_of_vector Y) \\<and>\n     is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y')\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma exist_matrix'_implies_equivalent:\n  assumes A: \"matrix' X Y f = A\"\n  and B: \"matrix' X' Y' f = B\"\n  and X: \"is_basis (set_of_vector X)\"\n  and Y: \"is_basis (set_of_vector Y)\" \n  and X': \"is_basis (set_of_vector X')\"\n  and Y': \"is_basis (set_of_vector Y')\"\n  and linear_f: \"linear ((*s)) ((*s)) f\"\n  shows \"equivalent_matrices A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. equivalent_matrices A B", "proof (unfold equivalent_matrices_def, rule exI[of _ \"matrix_change_of_basis Y' Y\"], rule exI[of _ \"matrix_change_of_basis X' X\"], auto)"], ["proof (state)\ngoal (3 subgoals):\n 1. invertible (matrix_change_of_basis Y' Y)\n 2. invertible (matrix_change_of_basis X' X)\n 3. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "have inv: \"matrix_change_of_basis Y Y' = matrix_inv (matrix_change_of_basis Y' Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y Y' = matrix_inv (matrix_change_of_basis Y' Y)", "using matrix_inv_matrix_change_of_basis[OF Y' Y]"], ["proof (prove)\nusing this:\n  matrix_change_of_basis Y Y' = matrix_inv (matrix_change_of_basis Y' Y)\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis Y Y' = matrix_inv (matrix_change_of_basis Y' Y)", "."], ["proof (state)\nthis:\n  matrix_change_of_basis Y Y' = matrix_inv (matrix_change_of_basis Y' Y)\n\ngoal (3 subgoals):\n 1. invertible (matrix_change_of_basis Y' Y)\n 2. invertible (matrix_change_of_basis X' X)\n 3. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "show \"invertible (matrix_change_of_basis Y' Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix_change_of_basis Y' Y)", "using invertible_matrix_change_of_basis[OF Y' Y]"], ["proof (prove)\nusing this:\n  invertible (matrix_change_of_basis Y' Y)\n\ngoal (1 subgoal):\n 1. invertible (matrix_change_of_basis Y' Y)", "."], ["proof (state)\nthis:\n  invertible (matrix_change_of_basis Y' Y)\n\ngoal (2 subgoals):\n 1. invertible (matrix_change_of_basis X' X)\n 2. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "show \"invertible (matrix_change_of_basis X' X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix_change_of_basis X' X)", "using invertible_matrix_change_of_basis[OF X' X]"], ["proof (prove)\nusing this:\n  invertible (matrix_change_of_basis X' X)\n\ngoal (1 subgoal):\n 1. invertible (matrix_change_of_basis X' X)", "."], ["proof (state)\nthis:\n  invertible (matrix_change_of_basis X' X)\n\ngoal (1 subgoal):\n 1. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "have \"B = matrix' X' Y' f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B = matrix' X' Y' f", "using B"], ["proof (prove)\nusing this:\n  matrix' X' Y' f = B\n\ngoal (1 subgoal):\n 1. B = matrix' X' Y' f", ".."], ["proof (state)\nthis:\n  B = matrix' X' Y' f\n\ngoal (1 subgoal):\n 1. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "also"], ["proof (state)\nthis:\n  B = matrix' X' Y' f\n\ngoal (1 subgoal):\n 1. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "have \"... =  matrix_change_of_basis Y Y' ** matrix' X Y f ** matrix_change_of_basis X' X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' X' Y' f =\n    matrix_change_of_basis Y Y' ** matrix' X Y f **\n    matrix_change_of_basis X' X", "using matrix'_matrix_change_of_basis[OF X X' Y Y' linear_f]"], ["proof (prove)\nusing this:\n  matrix' X' Y' f =\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X\n\ngoal (1 subgoal):\n 1. matrix' X' Y' f =\n    matrix_change_of_basis Y Y' ** matrix' X Y f **\n    matrix_change_of_basis X' X", "."], ["proof (state)\nthis:\n  matrix' X' Y' f =\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X\n\ngoal (1 subgoal):\n 1. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "finally"], ["proof (chain)\npicking this:\n  B =\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X", "show \"B = matrix_inv (matrix_change_of_basis Y' Y) ** A ** matrix_change_of_basis X' X\""], ["proof (prove)\nusing this:\n  B =\n  matrix_change_of_basis Y Y' ** matrix' X Y f **\n  matrix_change_of_basis X' X\n\ngoal (1 subgoal):\n 1. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "unfolding inv"], ["proof (prove)\nusing this:\n  B =\n  matrix_inv (matrix_change_of_basis Y' Y) ** matrix' X Y f **\n  matrix_change_of_basis X' X\n\ngoal (1 subgoal):\n 1. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "unfolding A"], ["proof (prove)\nusing this:\n  B =\n  matrix_inv (matrix_change_of_basis Y' Y) ** A **\n  matrix_change_of_basis X' X\n\ngoal (1 subgoal):\n 1. B =\n    matrix_inv (matrix_change_of_basis Y' Y) ** A **\n    matrix_change_of_basis X' X", "."], ["proof (state)\nthis:\n  B =\n  matrix_inv (matrix_change_of_basis Y' Y) ** A **\n  matrix_change_of_basis X' X\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>This is the proof of the theorem 2.18 in the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "corollary equivalent_iff_exist_matrix':\n  shows \"equivalent_matrices A B \\<longleftrightarrow> (\\<exists>X Y X' Y' f::'a::{field}^'n\\<Rightarrow>'a^'m. \n  linear ((*s)) ((*s)) f \\<and> matrix' X Y f = A \\<and> matrix' X' Y' f = B \n  \\<and> is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y) \n  \\<and> is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y'))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. equivalent_matrices A B =\n    (\\<exists>X Y X' Y' f.\n        linear (*s) (*s) f \\<and>\n        matrix' X Y f = A \\<and>\n        matrix' X' Y' f = B \\<and>\n        is_basis (set_of_vector X) \\<and>\n        is_basis (set_of_vector Y) \\<and>\n        is_basis (set_of_vector X') \\<and> is_basis (set_of_vector Y'))", "by (rule, auto simp add: exist_matrix'_implies_equivalent equivalent_implies_exist_matrix')"], ["", "subsection\\<open>Similar matrices\\<close>"], ["", "definition similar_matrices :: \"'a::{semiring_1}^'n^'n \\<Rightarrow> 'a::{semiring_1}^'n^'n \\<Rightarrow> bool\"\n  where \"similar_matrices A B = (\\<exists>P. invertible P \\<and> B=(matrix_inv P)**A**P)\""], ["", "lemma similar_implies_exist_matrix':\n  fixes A B::\"'a::{field}^'n^'n\"\n  assumes similar: \"similar_matrices A B\"\n  shows \"\\<exists>X Y f. linear ((*s)) ((*s)) f \\<and> matrix' X X f = A \\<and> matrix' Y Y f = B \n    \\<and> is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "obtain P where inv_P: \"invertible P\" and B_PAP: \"B=(matrix_inv P)**A**P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>P.\n        \\<lbrakk>invertible P; B = matrix_inv P ** A ** P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using similar"], ["proof (prove)\nusing this:\n  similar_matrices A B\n\ngoal (1 subgoal):\n 1. (\\<And>P.\n        \\<lbrakk>invertible P; B = matrix_inv P ** A ** P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding similar_matrices_def"], ["proof (prove)\nusing this:\n  \\<exists>P. invertible P \\<and> B = matrix_inv P ** A ** P\n\ngoal (1 subgoal):\n 1. (\\<And>P.\n        \\<lbrakk>invertible P; B = matrix_inv P ** A ** P\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  invertible P\n  B = matrix_inv P ** A ** P\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "obtain X::\"'a^'n^'n\" where X: \"is_basis (set_of_vector X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X.\n        is_basis (set_of_vector X) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using exists_basis"], ["proof (prove)\nusing this:\n  \\<exists>X. is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. (\\<And>X.\n        is_basis (set_of_vector X) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  is_basis (set_of_vector X)\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "obtain f where linear_f: \"linear ((*s)) ((*s)) f\" and A: \"matrix' X X f = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>linear (*s) (*s) f; matrix' X X f = A\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using exists_linear_eq_matrix'[OF X X]"], ["proof (prove)\nusing this:\n  \\<exists>f. matrix' X X f = ?A \\<and> linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. (\\<And>f.\n        \\<lbrakk>linear (*s) (*s) f; matrix' X X f = A\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  linear (*s) (*s) f\n  matrix' X X f = A\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "obtain Y::\"'a^'n^'n\" where Y: \"is_basis (set_of_vector Y)\" and P: \"P = matrix_change_of_basis Y X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Y.\n        \\<lbrakk>is_basis (set_of_vector Y);\n         P = matrix_change_of_basis Y X\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using invertible_matrix_is_change_of_basis[OF inv_P X]"], ["proof (prove)\nusing this:\n  \\<exists>!Y.\n     matrix_change_of_basis Y X = P \\<and> is_basis (set_of_vector Y)\n\ngoal (1 subgoal):\n 1. (\\<And>Y.\n        \\<lbrakk>is_basis (set_of_vector Y);\n         P = matrix_change_of_basis Y X\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fast"], ["proof (state)\nthis:\n  is_basis (set_of_vector Y)\n  P = matrix_change_of_basis Y X\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "have P': \"matrix_inv P = matrix_change_of_basis X Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_inv P = matrix_change_of_basis X Y", "by (metis (lifting) P X Y matrix_inv_matrix_change_of_basis)"], ["proof (state)\nthis:\n  matrix_inv P = matrix_change_of_basis X Y\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "have \"B = (matrix_inv P)**A**P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B = matrix_inv P ** A ** P", "using B_PAP"], ["proof (prove)\nusing this:\n  B = matrix_inv P ** A ** P\n\ngoal (1 subgoal):\n 1. B = matrix_inv P ** A ** P", "."], ["proof (state)\nthis:\n  B = matrix_inv P ** A ** P\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "also"], ["proof (state)\nthis:\n  B = matrix_inv P ** A ** P\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "have \"... =  matrix_change_of_basis X Y ** matrix' X X f ** P \""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_inv P ** A ** P =\n    matrix_change_of_basis X Y ** matrix' X X f ** P", "unfolding P' A"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** A ** P =\n    matrix_change_of_basis X Y ** A ** P", ".."], ["proof (state)\nthis:\n  matrix_inv P ** A ** P = matrix_change_of_basis X Y ** matrix' X X f ** P\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "also"], ["proof (state)\nthis:\n  matrix_inv P ** A ** P = matrix_change_of_basis X Y ** matrix' X X f ** P\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "have \"... = matrix_change_of_basis X Y ** matrix' X X f ** matrix_change_of_basis Y X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix' X X f ** P =\n    matrix_change_of_basis X Y ** matrix' X X f **\n    matrix_change_of_basis Y X", "unfolding P"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix' X X f **\n    matrix_change_of_basis Y X =\n    matrix_change_of_basis X Y ** matrix' X X f **\n    matrix_change_of_basis Y X", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis X Y ** matrix' X X f ** P =\n  matrix_change_of_basis X Y ** matrix' X X f ** matrix_change_of_basis Y X\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "also"], ["proof (state)\nthis:\n  matrix_change_of_basis X Y ** matrix' X X f ** P =\n  matrix_change_of_basis X Y ** matrix' X X f ** matrix_change_of_basis Y X\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "have \"... = matrix' Y Y f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix' X X f **\n    matrix_change_of_basis Y X =\n    matrix' Y Y f", "using matrix'_matrix_change_of_basis[OF X Y X Y linear_f]"], ["proof (prove)\nusing this:\n  matrix' Y Y f =\n  matrix_change_of_basis X Y ** matrix' X X f ** matrix_change_of_basis Y X\n\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix' X X f **\n    matrix_change_of_basis Y X =\n    matrix' Y Y f", "by simp"], ["proof (state)\nthis:\n  matrix_change_of_basis X Y ** matrix' X X f **\n  matrix_change_of_basis Y X =\n  matrix' Y Y f\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "finally"], ["proof (chain)\npicking this:\n  B = matrix' Y Y f", "show ?thesis"], ["proof (prove)\nusing this:\n  B = matrix' Y Y f\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "using X Y A linear_f"], ["proof (prove)\nusing this:\n  B = matrix' Y Y f\n  is_basis (set_of_vector X)\n  is_basis (set_of_vector Y)\n  matrix' X X f = A\n  linear (*s) (*s) f\n\ngoal (1 subgoal):\n 1. \\<exists>X Y f.\n       linear (*s) (*s) f \\<and>\n       matrix' X X f = A \\<and>\n       matrix' Y Y f = B \\<and>\n       is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)", "by fast"], ["proof (state)\nthis:\n  \\<exists>X Y f.\n     linear (*s) (*s) f \\<and>\n     matrix' X X f = A \\<and>\n     matrix' Y Y f = B \\<and>\n     is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma exist_matrix'_implies_similar:\n  fixes A B::\"'a::{field}^'n^'n\"\n  assumes linear_f: \"linear ((*s)) ((*s)) f\" and A: \"matrix' X X f = A\" and B: \"matrix' Y Y f = B\"\n  and X: \"is_basis (set_of_vector X)\" and Y: \"is_basis (set_of_vector Y)\"\n  shows \"similar_matrices A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. similar_matrices A B", "proof (unfold similar_matrices_def, rule exI[of _ \"matrix_change_of_basis Y X\"], rule conjI)"], ["proof (state)\ngoal (2 subgoals):\n 1. invertible (matrix_change_of_basis Y X)\n 2. B =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", "have \"B=matrix' Y Y f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B = matrix' Y Y f", "using B"], ["proof (prove)\nusing this:\n  matrix' Y Y f = B\n\ngoal (1 subgoal):\n 1. B = matrix' Y Y f", ".."], ["proof (state)\nthis:\n  B = matrix' Y Y f\n\ngoal (2 subgoals):\n 1. invertible (matrix_change_of_basis Y X)\n 2. B =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", "also"], ["proof (state)\nthis:\n  B = matrix' Y Y f\n\ngoal (2 subgoals):\n 1. invertible (matrix_change_of_basis Y X)\n 2. B =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", "have \"... = matrix_change_of_basis X Y ** matrix' X X f ** matrix_change_of_basis Y X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix' Y Y f =\n    matrix_change_of_basis X Y ** matrix' X X f **\n    matrix_change_of_basis Y X", "using matrix'_matrix_change_of_basis[OF X Y X Y linear_f]"], ["proof (prove)\nusing this:\n  matrix' Y Y f =\n  matrix_change_of_basis X Y ** matrix' X X f ** matrix_change_of_basis Y X\n\ngoal (1 subgoal):\n 1. matrix' Y Y f =\n    matrix_change_of_basis X Y ** matrix' X X f **\n    matrix_change_of_basis Y X", "by simp"], ["proof (state)\nthis:\n  matrix' Y Y f =\n  matrix_change_of_basis X Y ** matrix' X X f ** matrix_change_of_basis Y X\n\ngoal (2 subgoals):\n 1. invertible (matrix_change_of_basis Y X)\n 2. B =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", "also"], ["proof (state)\nthis:\n  matrix' Y Y f =\n  matrix_change_of_basis X Y ** matrix' X X f ** matrix_change_of_basis Y X\n\ngoal (2 subgoals):\n 1. invertible (matrix_change_of_basis Y X)\n 2. B =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", "have \"... =  matrix_inv (matrix_change_of_basis Y X) ** A ** matrix_change_of_basis Y X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_change_of_basis X Y ** matrix' X X f **\n    matrix_change_of_basis Y X =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", "unfolding A matrix_inv_matrix_change_of_basis[OF Y X]"], ["proof (prove)\ngoal (1 subgoal):\n 1. matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", ".."], ["proof (state)\nthis:\n  matrix_change_of_basis X Y ** matrix' X X f **\n  matrix_change_of_basis Y X =\n  matrix_inv (matrix_change_of_basis Y X) ** A ** matrix_change_of_basis Y X\n\ngoal (2 subgoals):\n 1. invertible (matrix_change_of_basis Y X)\n 2. B =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", "finally"], ["proof (chain)\npicking this:\n  B =\n  matrix_inv (matrix_change_of_basis Y X) ** A ** matrix_change_of_basis Y X", "show \"B = matrix_inv (matrix_change_of_basis Y X) ** A ** matrix_change_of_basis Y X\""], ["proof (prove)\nusing this:\n  B =\n  matrix_inv (matrix_change_of_basis Y X) ** A ** matrix_change_of_basis Y X\n\ngoal (1 subgoal):\n 1. B =\n    matrix_inv (matrix_change_of_basis Y X) ** A **\n    matrix_change_of_basis Y X", "."], ["proof (state)\nthis:\n  B =\n  matrix_inv (matrix_change_of_basis Y X) ** A ** matrix_change_of_basis Y X\n\ngoal (1 subgoal):\n 1. invertible (matrix_change_of_basis Y X)", "show \"invertible (matrix_change_of_basis Y X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. invertible (matrix_change_of_basis Y X)", "using invertible_matrix_change_of_basis[OF Y X]"], ["proof (prove)\nusing this:\n  invertible (matrix_change_of_basis Y X)\n\ngoal (1 subgoal):\n 1. invertible (matrix_change_of_basis Y X)", "."], ["proof (state)\nthis:\n  invertible (matrix_change_of_basis Y X)\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>This is the proof of the theorem 2.19 in the book \"Advanced Linear Algebra\" by Steven Roman.\\<close>"], ["", "corollary similar_iff_exist_matrix':\n  fixes A B::\"'a::{field}^'n^'n\"\n  shows \"similar_matrices A B \\<longleftrightarrow> (\\<exists>X Y f. linear ((*s)) ((*s)) f \\<and> matrix' X X f = A \n    \\<and> matrix' Y Y f = B \\<and> is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. similar_matrices A B =\n    (\\<exists>X Y f.\n        linear (*s) (*s) f \\<and>\n        matrix' X X f = A \\<and>\n        matrix' Y Y f = B \\<and>\n        is_basis (set_of_vector X) \\<and> is_basis (set_of_vector Y))", "by (rule, auto simp add: exist_matrix'_implies_similar similar_implies_exist_matrix')"], ["", "end"]]}