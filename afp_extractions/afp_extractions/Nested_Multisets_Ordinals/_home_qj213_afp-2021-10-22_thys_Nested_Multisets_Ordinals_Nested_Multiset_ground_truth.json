{"file_name": "/home/qj213/afp-2021-10-22/thys/Nested_Multisets_Ordinals/Nested_Multiset.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Nested_Multisets_Ordinals", "problem_names": ["lemma wf_sub_nmset[simp]: \"wf sub_nmset\"", "lemma depth_nmset_MSet: \"x \\<in># M \\<Longrightarrow> |x| < |MSet M|\"", "lemma less_multiset_ext\\<^sub>D\\<^sub>M_imp_mult:\n  assumes\n    N_A: \"set_mset N \\<subseteq> A\" and M_A: \"set_mset M \\<subseteq> A\" and less: \"less_multiset_ext\\<^sub>D\\<^sub>M R M N\"\n  shows \"(M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\"", "lemma mult_imp_less_multiset_ext\\<^sub>D\\<^sub>M:\n  assumes\n    N_A: \"set_mset N \\<subseteq> A\" and M_A: \"set_mset M \\<subseteq> A\" and\n    trans: \"\\<forall>x \\<in> A. \\<forall>y \\<in> A. \\<forall>z \\<in> A. R x y \\<longrightarrow> R y z \\<longrightarrow> R x z\" and\n    in_mult: \"(M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\"\n  shows \"less_multiset_ext\\<^sub>D\\<^sub>M R M N\"", "lemma less_multiset_ext\\<^sub>D\\<^sub>M_iff_mult:\n  assumes\n    N_A: \"set_mset N \\<subseteq> A\" and M_A: \"set_mset M \\<subseteq> A\" and\n    trans: \"\\<forall>x \\<in> A. \\<forall>y \\<in> A. \\<forall>z \\<in> A. R x y \\<longrightarrow> R y z \\<longrightarrow> R x z\"\n  shows \"less_multiset_ext\\<^sub>D\\<^sub>M R M N \\<longleftrightarrow> (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\"", "lemma less_multiset_ext\\<^sub>D\\<^sub>M_cong[fundef_cong]:\n  \"(\\<And>X Y k a. X \\<noteq> {#} \\<Longrightarrow> X \\<subseteq># N \\<Longrightarrow> M = (N - X) + Y \\<Longrightarrow> k \\<in># Y \\<Longrightarrow> R k a = S k a) \\<Longrightarrow>\n  less_multiset_ext\\<^sub>D\\<^sub>M R M N = less_multiset_ext\\<^sub>D\\<^sub>M S M N\"", "lemmas less_nmultiset_induct =\n  less_nmultiset.induct[case_names Elem_Elem Elem_MSet MSet_Elem MSet_MSet]", "lemmas less_nmultiset_cases =\n  less_nmultiset.cases[case_names Elem_Elem Elem_MSet MSet_Elem MSet_MSet]", "lemma trans_less_nmultiset: \"X < Y \\<Longrightarrow> Y < Z \\<Longrightarrow> X < Z\" for X Y Z :: \"'a nmultiset\"", "lemma irrefl_less_nmultiset:\n  fixes X :: \"'a nmultiset\"\n  shows \"X < X \\<Longrightarrow> False\"", "lemma antisym_less_nmultiset:\n  fixes X Y :: \"'a nmultiset\"\n  shows \"X < Y \\<Longrightarrow> Y < X \\<Longrightarrow> False\"", "lemma less_multiset_ext\\<^sub>D\\<^sub>M_less: \"less_multiset_ext\\<^sub>D\\<^sub>M (<) = (<)\"", "lemma total_less_nmultiset:\n  fixes X Y :: \"'a nmultiset\"\n  shows \"\\<not> X < Y \\<Longrightarrow> Y \\<noteq> X \\<Longrightarrow> Y < X\"", "lemma less_depth_nmset_imp_less_nmultiset: \"|X| < |Y| \\<Longrightarrow> X < Y\"", "lemma less_nmultiset_imp_le_depth_nmset: \"X < Y \\<Longrightarrow> |X| \\<le> |Y|\"", "lemma eq_mlex_I:\n  fixes f :: \"'a \\<Rightarrow> nat\" and R :: \"'a \\<Rightarrow> 'a \\<Rightarrow> bool\"\n  assumes \"\\<And>X Y. f X < f Y \\<Longrightarrow> R X Y\" and \"antisymp R\"\n  shows \"{(X, Y). R X Y} = f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\"", "lemma depth_nmset_eq_0[simp]: \"|X| = 0 \\<longleftrightarrow> (X = MSet {#} \\<or> (\\<exists>x. X = Elem x))\"", "lemma depth_nmset_eq_Suc[simp]: \"|X| = Suc n \\<longleftrightarrow>\n  (\\<exists>N. X = MSet N \\<and> (\\<exists>Y \\<in># N. |Y| = n) \\<and> (\\<forall>Y \\<in># N. |Y| \\<le> n))\"", "lemma wf_less_nmultiset_depth:\n  \"wf {(X :: 'a nmultiset, Y). |X| = i \\<and> |Y| = i \\<and> X < Y}\"", "lemma wf_less_nmultiset: \"wf {(X :: 'a nmultiset, Y :: 'a nmultiset). X < Y}\" (is \"wf ?R\")"], "translations": [["", "lemma wf_sub_nmset[simp]: \"wf sub_nmset\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf sub_nmset", "proof (rule wfUNIVI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P x.\n       \\<forall>x.\n          (\\<forall>y.\n              (y, x) \\<in> sub_nmset \\<longrightarrow>\n              P y) \\<longrightarrow>\n          P x \\<Longrightarrow>\n       P x", "fix P :: \"'a nmultiset \\<Rightarrow> bool\" and M :: \"'a nmultiset\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P x.\n       \\<forall>x.\n          (\\<forall>y.\n              (y, x) \\<in> sub_nmset \\<longrightarrow>\n              P y) \\<longrightarrow>\n          P x \\<Longrightarrow>\n       P x", "assume IH: \"\\<forall>M. (\\<forall>N. (N, M) \\<in> sub_nmset \\<longrightarrow> P N) \\<longrightarrow> P M\""], ["proof (state)\nthis:\n  \\<forall>M.\n     (\\<forall>N.\n         (N, M) \\<in> sub_nmset \\<longrightarrow> P N) \\<longrightarrow>\n     P M\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       \\<forall>x.\n          (\\<forall>y.\n              (y, x) \\<in> sub_nmset \\<longrightarrow>\n              P y) \\<longrightarrow>\n          P x \\<Longrightarrow>\n       P x", "show \"P M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P M", "by (induct M; rule IH[rule_format]) (auto simp: sub_nmset.simps)"], ["proof (state)\nthis:\n  P M\n\ngoal:\nNo subgoals!", "qed"], ["", "primrec depth_nmset :: \"'a nmultiset \\<Rightarrow> nat\" (\"|_|\") where\n  \"|Elem a| = 0\"\n| \"|MSet M| = (let X = set_mset (image_mset depth_nmset M) in if X = {} then 0 else Suc (Max X))\""], ["", "lemma depth_nmset_MSet: \"x \\<in># M \\<Longrightarrow> |x| < |MSet M|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in># M \\<Longrightarrow> |x| < |MSet M|", "by (auto simp: less_Suc_eq_le)"], ["", "declare depth_nmset.simps(2)[simp del]"], ["", "subsection \\<open>Dershowitz and Manna's Nested Multiset Order\\<close>"], ["", "text \\<open>The Dershowitz--Manna extension:\\<close>"], ["", "definition less_multiset_ext\\<^sub>D\\<^sub>M :: \"('a \\<Rightarrow> 'a \\<Rightarrow> bool) \\<Rightarrow> 'a multiset \\<Rightarrow> 'a multiset \\<Rightarrow> bool\" where\n  \"less_multiset_ext\\<^sub>D\\<^sub>M R M N \\<longleftrightarrow>\n   (\\<exists>X Y. X \\<noteq> {#} \\<and> X \\<subseteq># N \\<and> M = (N - X) + Y \\<and> (\\<forall>k. k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a)))\""], ["", "lemma less_multiset_ext\\<^sub>D\\<^sub>M_imp_mult:\n  assumes\n    N_A: \"set_mset N \\<subseteq> A\" and M_A: \"set_mset M \\<subseteq> A\" and less: \"less_multiset_ext\\<^sub>D\\<^sub>M R M N\"\n  shows \"(M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}", "from less"], ["proof (chain)\npicking this:\n  less_multiset_ext\\<^sub>D\\<^sub>M R M N", "obtain X Y where\n    \"X \\<noteq> {#}\" and \"X \\<subseteq># N\" and \"M = N - X + Y\" and \"\\<forall>k. k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a)\""], ["proof (prove)\nusing this:\n  less_multiset_ext\\<^sub>D\\<^sub>M R M N\n\ngoal (1 subgoal):\n 1. (\\<And>X Y.\n        \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n         \\<forall>k.\n            k \\<in># Y \\<longrightarrow>\n            (\\<exists>a. a \\<in># X \\<and> R k a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding less_multiset_ext\\<^sub>D\\<^sub>M_def"], ["proof (prove)\nusing this:\n  \\<exists>X Y.\n     X \\<noteq> {#} \\<and>\n     X \\<subseteq># N \\<and>\n     M = N - X + Y \\<and>\n     (\\<forall>k.\n         k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a))\n\ngoal (1 subgoal):\n 1. (\\<And>X Y.\n        \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n         \\<forall>k.\n            k \\<in># Y \\<longrightarrow>\n            (\\<exists>a. a \\<in># X \\<and> R k a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  X \\<noteq> {#}\n  X \\<subseteq># N\n  M = N - X + Y\n  \\<forall>k.\n     k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a)\n\ngoal (1 subgoal):\n 1. (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}", "with N_A M_A"], ["proof (chain)\npicking this:\n  set_mset N \\<subseteq> A\n  set_mset M \\<subseteq> A\n  X \\<noteq> {#}\n  X \\<subseteq># N\n  M = N - X + Y\n  \\<forall>k.\n     k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a)", "have \"(N - X + Y, N - X + X) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\""], ["proof (prove)\nusing this:\n  set_mset N \\<subseteq> A\n  set_mset M \\<subseteq> A\n  X \\<noteq> {#}\n  X \\<subseteq># N\n  M = N - X + Y\n  \\<forall>k.\n     k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a)\n\ngoal (1 subgoal):\n 1. (N - X + Y, N - X + X)\n    \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}", "by (intro one_step_implies_mult, blast,\n      metis (mono_tags, lifting) case_prodI mem_Collect_eq mset_subset_eqD mset_subset_eq_add_right\n        subsetCE)"], ["proof (state)\nthis:\n  (N - X + Y, N - X + X)\n  \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n\ngoal (1 subgoal):\n 1. (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}", "with \\<open>M = N - X + Y\\<close> \\<open>X \\<subseteq># N\\<close>"], ["proof (chain)\npicking this:\n  M = N - X + Y\n  X \\<subseteq># N\n  (N - X + Y, N - X + X)\n  \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}", "show \"(M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\""], ["proof (prove)\nusing this:\n  M = N - X + Y\n  X \\<subseteq># N\n  (N - X + Y, N - X + X)\n  \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n\ngoal (1 subgoal):\n 1. (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}", "by (simp add: subset_mset.diff_add)"], ["proof (state)\nthis:\n  (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma mult_imp_less_multiset_ext\\<^sub>D\\<^sub>M:\n  assumes\n    N_A: \"set_mset N \\<subseteq> A\" and M_A: \"set_mset M \\<subseteq> A\" and\n    trans: \"\\<forall>x \\<in> A. \\<forall>y \\<in> A. \\<forall>z \\<in> A. R x y \\<longrightarrow> R y z \\<longrightarrow> R x z\" and\n    in_mult: \"(M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\"\n  shows \"less_multiset_ext\\<^sub>D\\<^sub>M R M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. less_multiset_ext\\<^sub>D\\<^sub>M R M N", "using in_mult N_A M_A"], ["proof (prove)\nusing this:\n  (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n  set_mset N \\<subseteq> A\n  set_mset M \\<subseteq> A\n\ngoal (1 subgoal):\n 1. less_multiset_ext\\<^sub>D\\<^sub>M R M N", "unfolding mult_def less_multiset_ext\\<^sub>D\\<^sub>M_def"], ["proof (prove)\nusing this:\n  (M, N)\n  \\<in> (mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+\n  set_mset N \\<subseteq> A\n  set_mset M \\<subseteq> A\n\ngoal (1 subgoal):\n 1. \\<exists>X Y.\n       X \\<noteq> {#} \\<and>\n       X \\<subseteq># N \\<and>\n       M = N - X + Y \\<and>\n       (\\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> R k a))", "proof induct"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>(M, y)\n                \\<in> mult1\n                       {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># y \\<and>\n                            M = y - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))\n 2. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "case (base N)"], ["proof (state)\nthis:\n  (M, N) \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n  set_mset N \\<subseteq> A\n  set_mset M \\<subseteq> A\n\ngoal (2 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>(M, y)\n                \\<in> mult1\n                       {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># y \\<and>\n                            M = y - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))\n 2. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "then"], ["proof (chain)\npicking this:\n  (M, N) \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n  set_mset N \\<subseteq> A\n  set_mset M \\<subseteq> A", "obtain y M0 X where \"N = add_mset y M0\" and \"M = M0 + X\" and \"\\<forall>a. a \\<in># X \\<longrightarrow> R a y\""], ["proof (prove)\nusing this:\n  (M, N) \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n  set_mset N \\<subseteq> A\n  set_mset M \\<subseteq> A\n\ngoal (1 subgoal):\n 1. (\\<And>y M0 X.\n        \\<lbrakk>N = add_mset y M0; M = M0 + X;\n         \\<forall>a. a \\<in># X \\<longrightarrow> R a y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding mult1_def"], ["proof (prove)\nusing this:\n  (M, N)\n  \\<in> {(N, M).\n         \\<exists>a M0 K.\n            M = add_mset a M0 \\<and>\n            N = M0 + K \\<and>\n            (\\<forall>b.\n                b \\<in># K \\<longrightarrow>\n                (b, a)\n                \\<in> {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y})}\n  set_mset N \\<subseteq> A\n  set_mset M \\<subseteq> A\n\ngoal (1 subgoal):\n 1. (\\<And>y M0 X.\n        \\<lbrakk>N = add_mset y M0; M = M0 + X;\n         \\<forall>a. a \\<in># X \\<longrightarrow> R a y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  N = add_mset y M0\n  M = M0 + X\n  \\<forall>a. a \\<in># X \\<longrightarrow> R a y\n\ngoal (2 subgoals):\n 1. \\<And>y.\n       \\<lbrakk>(M, y)\n                \\<in> mult1\n                       {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># y \\<and>\n                            M = y - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))\n 2. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "thus ?case"], ["proof (prove)\nusing this:\n  N = add_mset y M0\n  M = M0 + X\n  \\<forall>a. a \\<in># X \\<longrightarrow> R a y\n\ngoal (1 subgoal):\n 1. \\<exists>X Y.\n       X \\<noteq> {#} \\<and>\n       X \\<subseteq># N \\<and>\n       M = N - X + Y \\<and>\n       (\\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> R k a))", "by (auto intro: exI[of _ \"{#y#}\"])"], ["proof (state)\nthis:\n  \\<exists>X Y.\n     X \\<noteq> {#} \\<and>\n     X \\<subseteq># N \\<and>\n     M = N - X + Y \\<and>\n     (\\<forall>k.\n         k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a))\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "case (step N N')"], ["proof (state)\nthis:\n  (M, N)\n  \\<in> (mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+\n  (N, N') \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n  \\<lbrakk>set_mset N \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n  \\<Longrightarrow> \\<exists>X Y.\n                       X \\<noteq> {#} \\<and>\n                       X \\<subseteq># N \\<and>\n                       M = N - X + Y \\<and>\n                       (\\<forall>k.\n                           k \\<in># Y \\<longrightarrow>\n                           (\\<exists>a. a \\<in># X \\<and> R k a))\n  set_mset N' \\<subseteq> A\n  set_mset M \\<subseteq> A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "note N_N'_in_mult1 = this(2) and ih = this(3) and N'_A = this(4) and M_A = this(5)"], ["proof (state)\nthis:\n  (N, N') \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n  \\<lbrakk>set_mset N \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n  \\<Longrightarrow> \\<exists>X Y.\n                       X \\<noteq> {#} \\<and>\n                       X \\<subseteq># N \\<and>\n                       M = N - X + Y \\<and>\n                       (\\<forall>k.\n                           k \\<in># Y \\<longrightarrow>\n                           (\\<exists>a. a \\<in># X \\<and> R k a))\n  set_mset N' \\<subseteq> A\n  set_mset M \\<subseteq> A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "have N_A: \"set_mset N \\<subseteq> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_mset N \\<subseteq> A", "using N_N'_in_mult1 N'_A"], ["proof (prove)\nusing this:\n  (N, N') \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\n  set_mset N' \\<subseteq> A\n\ngoal (1 subgoal):\n 1. set_mset N \\<subseteq> A", "unfolding mult1_def"], ["proof (prove)\nusing this:\n  (N, N')\n  \\<in> {(N, M).\n         \\<exists>a M0 K.\n            M = add_mset a M0 \\<and>\n            N = M0 + K \\<and>\n            (\\<forall>b.\n                b \\<in># K \\<longrightarrow>\n                (b, a)\n                \\<in> {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y})}\n  set_mset N' \\<subseteq> A\n\ngoal (1 subgoal):\n 1. set_mset N \\<subseteq> A", "by auto"], ["proof (state)\nthis:\n  set_mset N \\<subseteq> A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "obtain Y X where y_nemp: \"Y \\<noteq> {#}\" and y_sub_N: \"Y \\<subseteq># N\" and M_eq: \"M = N - Y + X\" and\n    ex_y: \"\\<forall>x. x \\<in># X \\<longrightarrow> (\\<exists>y. y \\<in># Y \\<and> R x y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Y X.\n        \\<lbrakk>Y \\<noteq> {#}; Y \\<subseteq># N; M = N - Y + X;\n         \\<forall>x.\n            x \\<in># X \\<longrightarrow>\n            (\\<exists>y. y \\<in># Y \\<and> R x y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using ih[OF N_A M_A]"], ["proof (prove)\nusing this:\n  \\<exists>X Y.\n     X \\<noteq> {#} \\<and>\n     X \\<subseteq># N \\<and>\n     M = N - X + Y \\<and>\n     (\\<forall>k.\n         k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a))\n\ngoal (1 subgoal):\n 1. (\\<And>Y X.\n        \\<lbrakk>Y \\<noteq> {#}; Y \\<subseteq># N; M = N - Y + X;\n         \\<forall>x.\n            x \\<in># X \\<longrightarrow>\n            (\\<exists>y. y \\<in># Y \\<and> R x y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  Y \\<noteq> {#}\n  Y \\<subseteq># N\n  M = N - Y + X\n  \\<forall>x.\n     x \\<in># X \\<longrightarrow> (\\<exists>y. y \\<in># Y \\<and> R x y)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "obtain z M0 Ya where N'_eq: \"N' = M0 + {#z#}\" and N_eq: \"N = M0 + Ya\" and\n    z_gt: \"\\<forall>y. y \\<in># Ya \\<longrightarrow> y \\<in> A \\<and> z \\<in> A \\<and> R y z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>M0 z Ya.\n        \\<lbrakk>N' = M0 + {#z#}; N = M0 + Ya;\n         \\<forall>y.\n            y \\<in># Ya \\<longrightarrow>\n            y \\<in> A \\<and> z \\<in> A \\<and> R y z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using N_N'_in_mult1[unfolded mult1_def]"], ["proof (prove)\nusing this:\n  (N, N')\n  \\<in> {(N, M).\n         \\<exists>a M0 K.\n            M = add_mset a M0 \\<and>\n            N = M0 + K \\<and>\n            (\\<forall>b.\n                b \\<in># K \\<longrightarrow>\n                (b, a)\n                \\<in> {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y})}\n\ngoal (1 subgoal):\n 1. (\\<And>M0 z Ya.\n        \\<lbrakk>N' = M0 + {#z#}; N = M0 + Ya;\n         \\<forall>y.\n            y \\<in># Ya \\<longrightarrow>\n            y \\<in> A \\<and> z \\<in> A \\<and> R y z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  N' = M0 + {#z#}\n  N = M0 + Ya\n  \\<forall>y.\n     y \\<in># Ya \\<longrightarrow> y \\<in> A \\<and> z \\<in> A \\<and> R y z\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "let ?Za = \"Y - Ya + {#z#}\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "let ?Xa = \"X + Ya + (Y - Ya) - Y\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "have xa_sub_x_ya: \"set_mset ?Xa \\<subseteq> set_mset (X + Ya)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_mset (X + Ya + (Y - Ya) - Y) \\<subseteq> set_mset (X + Ya)", "by (metis diff_subset_eq_self in_diffD subsetI subset_mset.diff_diff_right)"], ["proof (state)\nthis:\n  set_mset (X + Ya + (Y - Ya) - Y) \\<subseteq> set_mset (X + Ya)\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "have x_A: \"set_mset X \\<subseteq> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_mset X \\<subseteq> A", "using M_A M_eq"], ["proof (prove)\nusing this:\n  set_mset M \\<subseteq> A\n  M = N - Y + X\n\ngoal (1 subgoal):\n 1. set_mset X \\<subseteq> A", "by auto"], ["proof (state)\nthis:\n  set_mset X \\<subseteq> A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "have ya_A: \"set_mset Ya \\<subseteq> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_mset Ya \\<subseteq> A", "by (simp add: subsetI z_gt)"], ["proof (state)\nthis:\n  set_mset Ya \\<subseteq> A\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "have ex_y': \"\\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\" if x_in: \"x \\<in># X + Ya\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "proof (cases \"x \\<in># X\")"], ["proof (state)\ngoal (2 subgoals):\n 1. x \\<in># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n 2. x \\<notin># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "case True"], ["proof (state)\nthis:\n  x \\<in># X\n\ngoal (2 subgoals):\n 1. x \\<in># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n 2. x \\<notin># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "then"], ["proof (chain)\npicking this:\n  x \\<in># X", "obtain y where y_in: \"y \\<in># Y\" and y_gt_x: \"R x y\""], ["proof (prove)\nusing this:\n  x \\<in># X\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in># Y; R x y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using ex_y"], ["proof (prove)\nusing this:\n  x \\<in># X\n  \\<forall>x.\n     x \\<in># X \\<longrightarrow> (\\<exists>y. y \\<in># Y \\<and> R x y)\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in># Y; R x y\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  y \\<in># Y\n  R x y\n\ngoal (2 subgoals):\n 1. x \\<in># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n 2. x \\<notin># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "proof (cases \"y \\<in># Ya\")"], ["proof (state)\ngoal (2 subgoals):\n 1. y \\<in># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n 2. y \\<notin># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "case False"], ["proof (state)\nthis:\n  y \\<notin># Ya\n\ngoal (2 subgoals):\n 1. y \\<in># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n 2. y \\<notin># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "hence \"y \\<in># Y - Ya + {#z#}\""], ["proof (prove)\nusing this:\n  y \\<notin># Ya\n\ngoal (1 subgoal):\n 1. y \\<in># Y - Ya + {#z#}", "using y_in count_greater_zero_iff in_diff_count"], ["proof (prove)\nusing this:\n  y \\<notin># Ya\n  y \\<in># Y\n  (0 < count ?M ?x) = (?x \\<in># ?M)\n  (?a \\<in># ?M - ?N) = (count ?N ?a < count ?M ?a)\n\ngoal (1 subgoal):\n 1. y \\<in># Y - Ya + {#z#}", "by fastforce"], ["proof (state)\nthis:\n  y \\<in># Y - Ya + {#z#}\n\ngoal (2 subgoals):\n 1. y \\<in># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n 2. y \\<notin># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "thus ?thesis"], ["proof (prove)\nusing this:\n  y \\<in># Y - Ya + {#z#}\n\ngoal (1 subgoal):\n 1. \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "using y_gt_x"], ["proof (prove)\nusing this:\n  y \\<in># Y - Ya + {#z#}\n  R x y\n\ngoal (1 subgoal):\n 1. \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "by blast"], ["proof (state)\nthis:\n  \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n\ngoal (1 subgoal):\n 1. y \\<in># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. y \\<in># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "case True"], ["proof (state)\nthis:\n  y \\<in># Ya\n\ngoal (1 subgoal):\n 1. y \\<in># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "hence \"y \\<in> A\" and \"z \\<in> A\" and \"R y z\""], ["proof (prove)\nusing this:\n  y \\<in># Ya\n\ngoal (1 subgoal):\n 1. y \\<in> A &&& z \\<in> A &&& R y z", "using z_gt"], ["proof (prove)\nusing this:\n  y \\<in># Ya\n  \\<forall>y.\n     y \\<in># Ya \\<longrightarrow> y \\<in> A \\<and> z \\<in> A \\<and> R y z\n\ngoal (1 subgoal):\n 1. y \\<in> A &&& z \\<in> A &&& R y z", "by blast+"], ["proof (state)\nthis:\n  y \\<in> A\n  z \\<in> A\n  R y z\n\ngoal (1 subgoal):\n 1. y \\<in># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "hence \"R x z\""], ["proof (prove)\nusing this:\n  y \\<in> A\n  z \\<in> A\n  R y z\n\ngoal (1 subgoal):\n 1. R x z", "using trans y_gt_x x_A ya_A x_in"], ["proof (prove)\nusing this:\n  y \\<in> A\n  z \\<in> A\n  R y z\n  \\<forall>x\\<in>A.\n     \\<forall>y\\<in>A.\n        \\<forall>z\\<in>A.\n           R x y \\<longrightarrow> R y z \\<longrightarrow> R x z\n  R x y\n  set_mset X \\<subseteq> A\n  set_mset Ya \\<subseteq> A\n  x \\<in># X + Ya\n\ngoal (1 subgoal):\n 1. R x z", "by (meson subsetCE union_iff)"], ["proof (state)\nthis:\n  R x z\n\ngoal (1 subgoal):\n 1. y \\<in># Ya \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "thus ?thesis"], ["proof (prove)\nusing this:\n  R x z\n\ngoal (1 subgoal):\n 1. \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n\ngoal (1 subgoal):\n 1. x \\<notin># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<notin># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "case False"], ["proof (state)\nthis:\n  x \\<notin># X\n\ngoal (1 subgoal):\n 1. x \\<notin># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "hence \"x \\<in># Ya\""], ["proof (prove)\nusing this:\n  x \\<notin># X\n\ngoal (1 subgoal):\n 1. x \\<in># Ya", "using x_in"], ["proof (prove)\nusing this:\n  x \\<notin># X\n  x \\<in># X + Ya\n\ngoal (1 subgoal):\n 1. x \\<in># Ya", "by auto"], ["proof (state)\nthis:\n  x \\<in># Ya\n\ngoal (1 subgoal):\n 1. x \\<notin># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "hence \"x \\<in> A\" and \"z \\<in> A\" and \"R x z\""], ["proof (prove)\nusing this:\n  x \\<in># Ya\n\ngoal (1 subgoal):\n 1. x \\<in> A &&& z \\<in> A &&& R x z", "using z_gt"], ["proof (prove)\nusing this:\n  x \\<in># Ya\n  \\<forall>y.\n     y \\<in># Ya \\<longrightarrow> y \\<in> A \\<and> z \\<in> A \\<and> R y z\n\ngoal (1 subgoal):\n 1. x \\<in> A &&& z \\<in> A &&& R x z", "by blast+"], ["proof (state)\nthis:\n  x \\<in> A\n  z \\<in> A\n  R x z\n\ngoal (1 subgoal):\n 1. x \\<notin># X \\<Longrightarrow>\n    \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "thus ?thesis"], ["proof (prove)\nusing this:\n  x \\<in> A\n  z \\<in> A\n  R x z\n\ngoal (1 subgoal):\n 1. \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x \\<in># X + Ya \\<Longrightarrow>\n  \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R ?x y\n\ngoal (1 subgoal):\n 1. \\<And>y z.\n       \\<lbrakk>(M, y)\n                \\<in> (mult1\n                        {(x, y).\n                         x \\<in> A \\<and> y \\<in> A \\<and> R x y})\\<^sup>+;\n        (y, z)\n        \\<in> mult1 {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y};\n        \\<lbrakk>set_mset y \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n        \\<Longrightarrow> \\<exists>X Y.\n                             X \\<noteq> {#} \\<and>\n                             X \\<subseteq># y \\<and>\n                             M = y - X + Y \\<and>\n                             (\\<forall>k.\n                                 k \\<in># Y \\<longrightarrow>\n                                 (\\<exists>a. a \\<in># X \\<and> R k a));\n        set_mset z \\<subseteq> A; set_mset M \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X Y.\n                            X \\<noteq> {#} \\<and>\n                            X \\<subseteq># z \\<and>\n                            M = z - X + Y \\<and>\n                            (\\<forall>k.\n                                k \\<in># Y \\<longrightarrow>\n                                (\\<exists>a. a \\<in># X \\<and> R k a))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>X Y.\n       X \\<noteq> {#} \\<and>\n       X \\<subseteq># N' \\<and>\n       M = N' - X + Y \\<and>\n       (\\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> R k a))", "proof (rule exI[of _ ?Za], rule exI[of _ ?Xa], intro conjI)"], ["proof (state)\ngoal (4 subgoals):\n 1. Y - Ya + {#z#} \\<noteq> {#}\n 2. Y - Ya + {#z#} \\<subseteq># N'\n 3. M = N' - (Y - Ya + {#z#}) + (X + Ya + (Y - Ya) - Y)\n 4. \\<forall>k.\n       k \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow>\n       (\\<exists>a. a \\<in># Y - Ya + {#z#} \\<and> R k a)", "show \"Y - Ya + {#z#} \\<subseteq># N'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y - Ya + {#z#} \\<subseteq># N'", "using mset_subset_eq_mono_add subset_eq_diff_conv y_sub_N N_eq N'_eq"], ["proof (prove)\nusing this:\n  \\<lbrakk>?A \\<subseteq># ?B; ?C \\<subseteq># ?D\\<rbrakk>\n  \\<Longrightarrow> ?A + ?C \\<subseteq># ?B + ?D\n  (?A - ?C \\<subseteq># ?B) = (?A \\<subseteq># ?B + ?C)\n  Y \\<subseteq># N\n  N = M0 + Ya\n  N' = M0 + {#z#}\n\ngoal (1 subgoal):\n 1. Y - Ya + {#z#} \\<subseteq># N'", "by (simp add: subset_eq_diff_conv)"], ["proof (state)\nthis:\n  Y - Ya + {#z#} \\<subseteq># N'\n\ngoal (3 subgoals):\n 1. Y - Ya + {#z#} \\<noteq> {#}\n 2. M = N' - (Y - Ya + {#z#}) + (X + Ya + (Y - Ya) - Y)\n 3. \\<forall>k.\n       k \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow>\n       (\\<exists>a. a \\<in># Y - Ya + {#z#} \\<and> R k a)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. Y - Ya + {#z#} \\<noteq> {#}\n 2. M = N' - (Y - Ya + {#z#}) + (X + Ya + (Y - Ya) - Y)\n 3. \\<forall>k.\n       k \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow>\n       (\\<exists>a. a \\<in># Y - Ya + {#z#} \\<and> R k a)", "show \"M = N' - (Y - Ya + {#z#}) + (X + Ya + (Y - Ya) - Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M = N' - (Y - Ya + {#z#}) + (X + Ya + (Y - Ya) - Y)", "unfolding M_eq N_eq N'_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. M0 + Ya - Y + X =\n    M0 + {#z#} - (Y - Ya + {#z#}) + (X + Ya + (Y - Ya) - Y)", "by (auto simp: multiset_eq_iff)"], ["proof (state)\nthis:\n  M = N' - (Y - Ya + {#z#}) + (X + Ya + (Y - Ya) - Y)\n\ngoal (2 subgoals):\n 1. Y - Ya + {#z#} \\<noteq> {#}\n 2. \\<forall>k.\n       k \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow>\n       (\\<exists>a. a \\<in># Y - Ya + {#z#} \\<and> R k a)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. Y - Ya + {#z#} \\<noteq> {#}\n 2. \\<forall>k.\n       k \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow>\n       (\\<exists>a. a \\<in># Y - Ya + {#z#} \\<and> R k a)", "show \"\\<forall>x. x \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow> (\\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x.\n       x \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow>\n       (\\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y)", "using ex_y' xa_sub_x_ya"], ["proof (prove)\nusing this:\n  ?x \\<in># X + Ya \\<Longrightarrow>\n  \\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R ?x y\n  set_mset (X + Ya + (Y - Ya) - Y) \\<subseteq> set_mset (X + Ya)\n\ngoal (1 subgoal):\n 1. \\<forall>x.\n       x \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow>\n       (\\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y)", "by blast"], ["proof (state)\nthis:\n  \\<forall>x.\n     x \\<in># X + Ya + (Y - Ya) - Y \\<longrightarrow>\n     (\\<exists>y. y \\<in># Y - Ya + {#z#} \\<and> R x y)\n\ngoal (1 subgoal):\n 1. Y - Ya + {#z#} \\<noteq> {#}", "qed auto"], ["proof (state)\nthis:\n  \\<exists>X Y.\n     X \\<noteq> {#} \\<and>\n     X \\<subseteq># N' \\<and>\n     M = N' - X + Y \\<and>\n     (\\<forall>k.\n         k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> R k a))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma less_multiset_ext\\<^sub>D\\<^sub>M_iff_mult:\n  assumes\n    N_A: \"set_mset N \\<subseteq> A\" and M_A: \"set_mset M \\<subseteq> A\" and\n    trans: \"\\<forall>x \\<in> A. \\<forall>y \\<in> A. \\<forall>z \\<in> A. R x y \\<longrightarrow> R y z \\<longrightarrow> R x z\"\n  shows \"less_multiset_ext\\<^sub>D\\<^sub>M R M N \\<longleftrightarrow> (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. less_multiset_ext\\<^sub>D\\<^sub>M R M N =\n    ((M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y})", "using mult_imp_less_multiset_ext\\<^sub>D\\<^sub>M[OF assms] less_multiset_ext\\<^sub>D\\<^sub>M_imp_mult[OF N_A M_A]"], ["proof (prove)\nusing this:\n  (M, N)\n  \\<in> mult\n         {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y} \\<Longrightarrow>\n  less_multiset_ext\\<^sub>D\\<^sub>M R M N\n  less_multiset_ext\\<^sub>D\\<^sub>M ?R M N \\<Longrightarrow>\n  (M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> ?R x y}\n\ngoal (1 subgoal):\n 1. less_multiset_ext\\<^sub>D\\<^sub>M R M N =\n    ((M, N) \\<in> mult {(x, y). x \\<in> A \\<and> y \\<in> A \\<and> R x y})", "by blast"], ["", "instantiation nmultiset :: (preorder) preorder\nbegin"], ["", "lemma less_multiset_ext\\<^sub>D\\<^sub>M_cong[fundef_cong]:\n  \"(\\<And>X Y k a. X \\<noteq> {#} \\<Longrightarrow> X \\<subseteq># N \\<Longrightarrow> M = (N - X) + Y \\<Longrightarrow> k \\<in># Y \\<Longrightarrow> R k a = S k a) \\<Longrightarrow>\n  less_multiset_ext\\<^sub>D\\<^sub>M R M N = less_multiset_ext\\<^sub>D\\<^sub>M S M N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X Y k a.\n        \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n         k \\<in># Y\\<rbrakk>\n        \\<Longrightarrow> R k a = S k a) \\<Longrightarrow>\n    less_multiset_ext\\<^sub>D\\<^sub>M R M N =\n    less_multiset_ext\\<^sub>D\\<^sub>M S M N", "unfolding less_multiset_ext\\<^sub>D\\<^sub>M_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X Y k a.\n        \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n         k \\<in># Y\\<rbrakk>\n        \\<Longrightarrow> R k a = S k a) \\<Longrightarrow>\n    (\\<exists>X Y.\n        X \\<noteq> {#} \\<and>\n        X \\<subseteq># N \\<and>\n        M = N - X + Y \\<and>\n        (\\<forall>k.\n            k \\<in># Y \\<longrightarrow>\n            (\\<exists>a. a \\<in># X \\<and> R k a))) =\n    (\\<exists>X Y.\n        X \\<noteq> {#} \\<and>\n        X \\<subseteq># N \\<and>\n        M = N - X + Y \\<and>\n        (\\<forall>k.\n            k \\<in># Y \\<longrightarrow>\n            (\\<exists>a. a \\<in># X \\<and> S k a)))", "by metis"], ["", "function less_nmultiset :: \"'a nmultiset \\<Rightarrow> 'a nmultiset \\<Rightarrow> bool\" where\n  \"less_nmultiset (Elem a) (Elem b) \\<longleftrightarrow> a < b\"\n| \"less_nmultiset (Elem a) (MSet M) \\<longleftrightarrow> True\"\n| \"less_nmultiset (MSet M) (Elem a) \\<longleftrightarrow> False\"\n| \"less_nmultiset (MSet M) (MSet N) \\<longleftrightarrow> less_multiset_ext\\<^sub>D\\<^sub>M less_nmultiset M N\""], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>P x.\n       \\<lbrakk>\\<And>a b. x = (Elem a, Elem b) \\<Longrightarrow> P;\n        \\<And>a M. x = (Elem a, MSet M) \\<Longrightarrow> P;\n        \\<And>M a. x = (MSet M, Elem a) \\<Longrightarrow> P;\n        \\<And>M N. x = (MSet M, MSet N) \\<Longrightarrow> P\\<rbrakk>\n       \\<Longrightarrow> P\n 2. \\<And>a b aa ba.\n       (Elem a, Elem b) = (Elem aa, Elem ba) \\<Longrightarrow>\n       (a < b) = (aa < ba)\n 3. \\<And>a b aa M.\n       (Elem a, Elem b) = (Elem aa, MSet M) \\<Longrightarrow> (a < b) = True\n 4. \\<And>a b M aa.\n       (Elem a, Elem b) = (MSet M, Elem aa) \\<Longrightarrow>\n       (a < b) = False\n 5. \\<And>a b M N.\n       (Elem a, Elem b) = (MSet M, MSet N) \\<Longrightarrow>\n       (a < b) =\n       less_multiset_ext\\<^sub>D\\<^sub>M\n        (\\<lambda>x0 x1. less_nmultiset_sumC (x0, x1)) M N\n 6. \\<And>a M aa Ma.\n       (Elem a, MSet M) = (Elem aa, MSet Ma) \\<Longrightarrow> True = True\n 7. \\<And>a M Ma aa.\n       (Elem a, MSet M) = (MSet Ma, Elem aa) \\<Longrightarrow> True = False\n 8. \\<And>a M Ma N.\n       (Elem a, MSet M) = (MSet Ma, MSet N) \\<Longrightarrow>\n       True =\n       less_multiset_ext\\<^sub>D\\<^sub>M\n        (\\<lambda>x0 x1. less_nmultiset_sumC (x0, x1)) Ma N\n 9. \\<And>M a Ma aa.\n       (MSet M, Elem a) = (MSet Ma, Elem aa) \\<Longrightarrow> False = False\n 10. \\<And>M a Ma N.\n        (MSet M, Elem a) = (MSet Ma, MSet N) \\<Longrightarrow>\n        False =\n        less_multiset_ext\\<^sub>D\\<^sub>M\n         (\\<lambda>x0 x1. less_nmultiset_sumC (x0, x1)) Ma N\nA total of 11 subgoals...", "by pat_completeness auto"], ["", "termination"], ["proof (prove)\ngoal (1 subgoal):\n 1. All local.less_nmultiset_dom", "by (relation \"sub_nmset <*lex*> sub_nmset\", fastforce,\n    metis sub_nmset.simps in_lex_prod mset_subset_eqD mset_subset_eq_add_right)"], ["", "lemmas less_nmultiset_induct =\n  less_nmultiset.induct[case_names Elem_Elem Elem_MSet MSet_Elem MSet_MSet]"], ["", "lemmas less_nmultiset_cases =\n  less_nmultiset.cases[case_names Elem_Elem Elem_MSet MSet_Elem MSet_MSet]"], ["", "lemma trans_less_nmultiset: \"X < Y \\<Longrightarrow> Y < Z \\<Longrightarrow> X < Z\" for X Y Z :: \"'a nmultiset\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X < Y; Y < Z\\<rbrakk> \\<Longrightarrow> X < Z", "proof (induct \"Max {|X|, |Y|, |Z|}\" arbitrary: X Y Z\n    rule: less_induct)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X Y Z.\n       \\<lbrakk>\\<And>Xa Ya Za.\n                   \\<lbrakk>Max {|Xa|, |Ya|, |Za|} < Max {|X|, |Y|, |Z|};\n                    Xa < Ya; Ya < Za\\<rbrakk>\n                   \\<Longrightarrow> Xa < Za;\n        X < Y; Y < Z\\<rbrakk>\n       \\<Longrightarrow> X < Z", "case less"], ["proof (state)\nthis:\n  \\<lbrakk>Max {|?X|, |?Y|, |?Z|} < Max {|X|, |Y|, |Z|}; ?X < ?Y;\n   ?Y < ?Z\\<rbrakk>\n  \\<Longrightarrow> ?X < ?Z\n  X < Y\n  Y < Z\n\ngoal (1 subgoal):\n 1. \\<And>X Y Z.\n       \\<lbrakk>\\<And>Xa Ya Za.\n                   \\<lbrakk>Max {|Xa|, |Ya|, |Za|} < Max {|X|, |Y|, |Z|};\n                    Xa < Ya; Ya < Za\\<rbrakk>\n                   \\<Longrightarrow> Xa < Za;\n        X < Y; Y < Z\\<rbrakk>\n       \\<Longrightarrow> X < Z", "from less(2,3)"], ["proof (chain)\npicking this:\n  X < Y\n  Y < Z", "show ?case"], ["proof (prove)\nusing this:\n  X < Y\n  Y < Z\n\ngoal (1 subgoal):\n 1. X < Z", "proof (cases X; cases Y; cases Z)"], ["proof (state)\ngoal (8 subgoals):\n 1. \\<And>x1 x1a x1b.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = Elem x1b\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 2. \\<And>x1 x1a x2.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = MSet x2\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 3. \\<And>x1 x2 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 4. \\<And>x1 x2 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 5. \\<And>x2 x1 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 6. \\<And>x2 x1 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 7. \\<And>x2 x2a x1.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = Elem x1\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 8. \\<And>x2 x2a x2b.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = MSet x2b\\<rbrakk>\n       \\<Longrightarrow> X < Z", "fix M N N' :: \"'a nmultiset multiset\""], ["proof (state)\ngoal (8 subgoals):\n 1. \\<And>x1 x1a x1b.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = Elem x1b\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 2. \\<And>x1 x1a x2.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = MSet x2\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 3. \\<And>x1 x2 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 4. \\<And>x1 x2 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 5. \\<And>x2 x1 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 6. \\<And>x2 x1 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 7. \\<And>x2 x2a x1.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = Elem x1\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 8. \\<And>x2 x2a x2b.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = MSet x2b\\<rbrakk>\n       \\<Longrightarrow> X < Z", "define A where \"A = set_mset M \\<union> set_mset N \\<union> set_mset N'\""], ["proof (state)\nthis:\n  A = set_mset M \\<union> set_mset N \\<union> set_mset N'\n\ngoal (8 subgoals):\n 1. \\<And>x1 x1a x1b.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = Elem x1b\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 2. \\<And>x1 x1a x2.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = MSet x2\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 3. \\<And>x1 x2 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 4. \\<And>x1 x2 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 5. \\<And>x2 x1 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 6. \\<And>x2 x1 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 7. \\<And>x2 x2a x1.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = Elem x1\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 8. \\<And>x2 x2a x2b.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = MSet x2b\\<rbrakk>\n       \\<Longrightarrow> X < Z", "assume XYZ: \"X = MSet M\" \"Y = MSet N\" \"Z = MSet N'\""], ["proof (state)\nthis:\n  X = MSet M\n  Y = MSet N\n  Z = MSet N'\n\ngoal (8 subgoals):\n 1. \\<And>x1 x1a x1b.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = Elem x1b\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 2. \\<And>x1 x1a x2.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = MSet x2\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 3. \\<And>x1 x2 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 4. \\<And>x1 x2 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 5. \\<And>x2 x1 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 6. \\<And>x2 x1 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 7. \\<And>x2 x2a x1.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = Elem x1\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 8. \\<And>x2 x2a x2b.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = MSet x2b\\<rbrakk>\n       \\<Longrightarrow> X < Z", "then"], ["proof (chain)\npicking this:\n  X = MSet M\n  Y = MSet N\n  Z = MSet N'", "have trans: \"\\<forall>x \\<in> A. \\<forall>y \\<in> A. \\<forall>z \\<in> A. x < y \\<longrightarrow> y < z \\<longrightarrow> x < z\""], ["proof (prove)\nusing this:\n  X = MSet M\n  Y = MSet N\n  Z = MSet N'\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>A.\n       \\<forall>y\\<in>A.\n          \\<forall>z\\<in>A.\n             x < y \\<longrightarrow> y < z \\<longrightarrow> x < z", "by (auto elim!: less(1)[rotated -1] dest!: depth_nmset_MSet simp add: A_def)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>A.\n     \\<forall>y\\<in>A.\n        \\<forall>z\\<in>A.\n           x < y \\<longrightarrow> y < z \\<longrightarrow> x < z\n\ngoal (8 subgoals):\n 1. \\<And>x1 x1a x1b.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = Elem x1b\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 2. \\<And>x1 x1a x2.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = MSet x2\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 3. \\<And>x1 x2 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 4. \\<And>x1 x2 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 5. \\<And>x2 x1 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 6. \\<And>x2 x1 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 7. \\<And>x2 x2a x1.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = Elem x1\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 8. \\<And>x2 x2a x2b.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = MSet x2b\\<rbrakk>\n       \\<Longrightarrow> X < Z", "have \"set_mset M \\<subseteq> A\" \"set_mset N \\<subseteq> A\" \"set_mset N' \\<subseteq> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_mset M \\<subseteq> A &&&\n    set_mset N \\<subseteq> A &&& set_mset N' \\<subseteq> A", "unfolding A_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. set_mset M\n    \\<subseteq> set_mset M \\<union> set_mset N \\<union> set_mset N' &&&\n    set_mset N\n    \\<subseteq> set_mset M \\<union> set_mset N \\<union> set_mset N' &&&\n    set_mset N'\n    \\<subseteq> set_mset M \\<union> set_mset N \\<union> set_mset N'", "by auto"], ["proof (state)\nthis:\n  set_mset M \\<subseteq> A\n  set_mset N \\<subseteq> A\n  set_mset N' \\<subseteq> A\n\ngoal (8 subgoals):\n 1. \\<And>x1 x1a x1b.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = Elem x1b\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 2. \\<And>x1 x1a x2.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = MSet x2\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 3. \\<And>x1 x2 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 4. \\<And>x1 x2 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 5. \\<And>x2 x1 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 6. \\<And>x2 x1 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 7. \\<And>x2 x2a x1.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = Elem x1\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 8. \\<And>x2 x2a x2b.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = MSet x2b\\<rbrakk>\n       \\<Longrightarrow> X < Z", "with less(2,3) XYZ"], ["proof (chain)\npicking this:\n  X < Y\n  Y < Z\n  X = MSet M\n  Y = MSet N\n  Z = MSet N'\n  set_mset M \\<subseteq> A\n  set_mset N \\<subseteq> A\n  set_mset N' \\<subseteq> A", "show \"X < Z\""], ["proof (prove)\nusing this:\n  X < Y\n  Y < Z\n  X = MSet M\n  Y = MSet N\n  Z = MSet N'\n  set_mset M \\<subseteq> A\n  set_mset N \\<subseteq> A\n  set_mset N' \\<subseteq> A\n\ngoal (1 subgoal):\n 1. X < Z", "by (auto simp: less_multiset_ext\\<^sub>D\\<^sub>M_iff_mult[OF _ _ trans] mult_def)"], ["proof (state)\nthis:\n  X < Z\n\ngoal (7 subgoals):\n 1. \\<And>x1 x1a x1b.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = Elem x1b\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 2. \\<And>x1 x1a x2.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = Elem x1a;\n        X < Y; Y < Z; Z = MSet x2\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 3. \\<And>x1 x2 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 4. \\<And>x1 x2 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = Elem x1; X < Y; Y < Z; Y = MSet x2; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 5. \\<And>x2 x1 x1a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = Elem x1a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 6. \\<And>x2 x1 x2a.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = Elem x1; X < Y;\n        Y < Z; Z = MSet x2a\\<rbrakk>\n       \\<Longrightarrow> X < Z\n 7. \\<And>x2 x2a x1.\n       \\<lbrakk>X < Y; Y < Z; X = MSet x2; X < Y; Y < Z; Y = MSet x2a;\n        X < Y; Y < Z; Z = Elem x1\\<rbrakk>\n       \\<Longrightarrow> X < Z", "qed (auto elim: less_trans)"], ["proof (state)\nthis:\n  X < Z\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma irrefl_less_nmultiset:\n  fixes X :: \"'a nmultiset\"\n  shows \"X < X \\<Longrightarrow> False\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X < X \\<Longrightarrow> False", "proof (induct X)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. Elem x < Elem x \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>\\<And>xa.\n                   \\<lbrakk>xa \\<in># x; xa < xa\\<rbrakk>\n                   \\<Longrightarrow> False;\n        MSet x < MSet x\\<rbrakk>\n       \\<Longrightarrow> False", "case (MSet M)"], ["proof (state)\nthis:\n  \\<lbrakk>?xa \\<in># M; ?xa < ?xa\\<rbrakk> \\<Longrightarrow> False\n  MSet M < MSet M\n\ngoal (2 subgoals):\n 1. \\<And>x. Elem x < Elem x \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>\\<And>xa.\n                   \\<lbrakk>xa \\<in># x; xa < xa\\<rbrakk>\n                   \\<Longrightarrow> False;\n        MSet x < MSet x\\<rbrakk>\n       \\<Longrightarrow> False", "from MSet(2)"], ["proof (chain)\npicking this:\n  MSet M < MSet M", "show ?case"], ["proof (prove)\nusing this:\n  MSet M < MSet M\n\ngoal (1 subgoal):\n 1. False", "unfolding less_nmultiset.simps less_multiset_ext\\<^sub>D\\<^sub>M_def"], ["proof (prove)\nusing this:\n  \\<exists>X Y.\n     X \\<noteq> {#} \\<and>\n     X \\<subseteq># M \\<and>\n     M = M - X + Y \\<and>\n     (\\<forall>k.\n         k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> k < a))\n\ngoal (1 subgoal):\n 1. False", "proof safe"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "fix X Y :: \"'a nmultiset multiset\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "define XY where \"XY = {(x, y). x \\<in># X \\<and> y \\<in># Y \\<and> y < x}\""], ["proof (state)\nthis:\n  XY = {(x, y). x \\<in># X \\<and> y \\<in># Y \\<and> y < x}\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  XY = {(x, y). x \\<in># X \\<and> y \\<in># Y \\<and> y < x}", "have fin: \"finite XY\" and trans: \"trans XY\""], ["proof (prove)\nusing this:\n  XY = {(x, y). x \\<in># X \\<and> y \\<in># Y \\<and> y < x}\n\ngoal (1 subgoal):\n 1. finite XY &&& trans XY", "by (auto simp: trans_def intro: trans_less_nmultiset\n        finite_subset[OF _ finite_cartesian_product])"], ["proof (state)\nthis:\n  finite XY\n  trans XY\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "assume \"X \\<noteq> {#}\" \"X \\<subseteq># M\" \"M = M - X + Y\""], ["proof (state)\nthis:\n  X \\<noteq> {#}\n  X \\<subseteq># M\n  M = M - X + Y\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  X \\<noteq> {#}\n  X \\<subseteq># M\n  M = M - X + Y", "have \"X = Y\""], ["proof (prove)\nusing this:\n  X \\<noteq> {#}\n  X \\<subseteq># M\n  M = M - X + Y\n\ngoal (1 subgoal):\n 1. X = Y", "by (auto simp: mset_subset_eq_exists_conv)"], ["proof (state)\nthis:\n  X = Y\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "with MSet(1) \\<open>X \\<subseteq># M\\<close>"], ["proof (chain)\npicking this:\n  \\<lbrakk>?xa \\<in># M; ?xa < ?xa\\<rbrakk> \\<Longrightarrow> False\n  X \\<subseteq># M\n  X = Y", "have \"irrefl XY\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?xa \\<in># M; ?xa < ?xa\\<rbrakk> \\<Longrightarrow> False\n  X \\<subseteq># M\n  X = Y\n\ngoal (1 subgoal):\n 1. irrefl XY", "unfolding XY_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>?xa \\<in># M; ?xa < ?xa\\<rbrakk> \\<Longrightarrow> False\n  X \\<subseteq># M\n  X = Y\n\ngoal (1 subgoal):\n 1. irrefl {(x, y). x \\<in># X \\<and> y \\<in># Y \\<and> y < x}", "by (force dest: mset_subset_eqD simp: irrefl_def)"], ["proof (state)\nthis:\n  irrefl XY\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "with trans"], ["proof (chain)\npicking this:\n  trans XY\n  irrefl XY", "have \"acyclic XY\""], ["proof (prove)\nusing this:\n  trans XY\n  irrefl XY\n\ngoal (1 subgoal):\n 1. acyclic XY", "by (simp add: acyclic_irrefl)"], ["proof (state)\nthis:\n  acyclic XY\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  acyclic XY\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "assume \"\\<forall>k. k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> k < a)\""], ["proof (state)\nthis:\n  \\<forall>k.\n     k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> k < a)\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "with \\<open>X = Y\\<close> \\<open>X \\<noteq> {#}\\<close>"], ["proof (chain)\npicking this:\n  X = Y\n  X \\<noteq> {#}\n  \\<forall>k.\n     k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> k < a)", "have \"\\<not> acyclic XY\""], ["proof (prove)\nusing this:\n  X = Y\n  X \\<noteq> {#}\n  \\<forall>k.\n     k \\<in># Y \\<longrightarrow> (\\<exists>a. a \\<in># X \\<and> k < a)\n\ngoal (1 subgoal):\n 1. \\<not> acyclic XY", "by (intro notI, elim finite_acyclic_wf[OF fin, elim_format])\n        (auto dest!: spec[of _ \"set_mset Y\"] simp: wf_eq_minimal XY_def)"], ["proof (state)\nthis:\n  \\<not> acyclic XY\n\ngoal (1 subgoal):\n 1. \\<And>X Y.\n       \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># M; M = M - X + Y;\n        \\<forall>k.\n           k \\<in># Y \\<longrightarrow>\n           (\\<exists>a. a \\<in># X \\<and> k < a)\\<rbrakk>\n       \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  acyclic XY\n  \\<not> acyclic XY", "show False"], ["proof (prove)\nusing this:\n  acyclic XY\n  \\<not> acyclic XY\n\ngoal (1 subgoal):\n 1. False", "by blast"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  False\n\ngoal (1 subgoal):\n 1. \\<And>x. Elem x < Elem x \\<Longrightarrow> False", "qed simp"], ["", "lemma antisym_less_nmultiset:\n  fixes X Y :: \"'a nmultiset\"\n  shows \"X < Y \\<Longrightarrow> Y < X \\<Longrightarrow> False\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X < Y; Y < X\\<rbrakk> \\<Longrightarrow> False", "using trans_less_nmultiset irrefl_less_nmultiset"], ["proof (prove)\nusing this:\n  \\<lbrakk>?X < ?Y; ?Y < ?Z\\<rbrakk> \\<Longrightarrow> ?X < ?Z\n  ?X < ?X \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. \\<lbrakk>X < Y; Y < X\\<rbrakk> \\<Longrightarrow> False", "by blast"], ["", "definition less_eq_nmultiset :: \"'a nmultiset \\<Rightarrow> 'a nmultiset \\<Rightarrow> bool\" where\n  \"less_eq_nmultiset X Y = (X < Y \\<or> X = Y)\""], ["", "instance"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a nmultiset, preorder_class)", "proof (intro_classes, goal_cases less_def refl trans)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x y. (x < y) = (x \\<le> y \\<and> \\<not> y \\<le> x)\n 2. \\<And>x. x \\<le> x\n 3. \\<And>x y z.\n       \\<lbrakk>x \\<le> y; y \\<le> z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "case (less_def x y)"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. \\<And>x y. (x < y) = (x \\<le> y \\<and> \\<not> y \\<le> x)\n 2. \\<And>x. x \\<le> x\n 3. \\<And>x y z.\n       \\<lbrakk>x \\<le> y; y \\<le> z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x < y) = (x \\<le> y \\<and> \\<not> y \\<le> x)", "unfolding less_eq_nmultiset_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x < y) = ((x < y \\<or> x = y) \\<and> \\<not> (y < x \\<or> y = x))", "by (metis irrefl_less_nmultiset antisym_less_nmultiset)"], ["proof (state)\nthis:\n  (x < y) = (x \\<le> y \\<and> \\<not> y \\<le> x)\n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<le> x\n 2. \\<And>x y z.\n       \\<lbrakk>x \\<le> y; y \\<le> z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<le> x\n 2. \\<And>x y z.\n       \\<lbrakk>x \\<le> y; y \\<le> z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "case (refl x)"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<And>x. x \\<le> x\n 2. \\<And>x y z.\n       \\<lbrakk>x \\<le> y; y \\<le> z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le> x", "unfolding less_eq_nmultiset_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. x < x \\<or> x = x", "by blast"], ["proof (state)\nthis:\n  x \\<le> x\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<le> y; y \\<le> z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<le> y; y \\<le> z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "case (trans x y z)"], ["proof (state)\nthis:\n  x \\<le> y\n  y \\<le> z\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<le> y; y \\<le> z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "then"], ["proof (chain)\npicking this:\n  x \\<le> y\n  y \\<le> z", "show ?case"], ["proof (prove)\nusing this:\n  x \\<le> y\n  y \\<le> z\n\ngoal (1 subgoal):\n 1. x \\<le> z", "unfolding less_eq_nmultiset_def"], ["proof (prove)\nusing this:\n  x < y \\<or> x = y\n  y < z \\<or> y = z\n\ngoal (1 subgoal):\n 1. x < z \\<or> x = z", "by (metis trans_less_nmultiset)"], ["proof (state)\nthis:\n  x \\<le> z\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma less_multiset_ext\\<^sub>D\\<^sub>M_less: \"less_multiset_ext\\<^sub>D\\<^sub>M (<) = (<)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. less_multiset_ext\\<^sub>D\\<^sub>M (<) = (<)", "unfolding fun_eq_iff less_multiset_ext\\<^sub>D\\<^sub>M_def less_multiset\\<^sub>D\\<^sub>M"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x xa.\n       (\\<exists>X Y.\n           X \\<noteq> {#} \\<and>\n           X \\<subseteq># xa \\<and>\n           x = xa - X + Y \\<and>\n           (\\<forall>k.\n               k \\<in># Y \\<longrightarrow>\n               (\\<exists>a. a \\<in># X \\<and> k < a))) =\n       (\\<exists>X Y.\n           X \\<noteq> {#} \\<and>\n           X \\<subseteq># xa \\<and>\n           x = xa - X + Y \\<and>\n           (\\<forall>k.\n               k \\<in># Y \\<longrightarrow>\n               (\\<exists>a. a \\<in># X \\<and> k < a)))", "by blast"], ["", "end"], ["", "instantiation nmultiset :: (order) order\nbegin"], ["", "instance"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a nmultiset, order_class)", "proof (intro_classes, goal_cases antisym)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> x = y", "case (antisym x y)"], ["proof (state)\nthis:\n  x \\<le> y\n  y \\<le> x\n\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<le> y; y \\<le> x\\<rbrakk> \\<Longrightarrow> x = y", "then"], ["proof (chain)\npicking this:\n  x \\<le> y\n  y \\<le> x", "show ?case"], ["proof (prove)\nusing this:\n  x \\<le> y\n  y \\<le> x\n\ngoal (1 subgoal):\n 1. x = y", "unfolding less_eq_nmultiset_def"], ["proof (prove)\nusing this:\n  x < y \\<or> x = y\n  y < x \\<or> y = x\n\ngoal (1 subgoal):\n 1. x = y", "by (metis trans_less_nmultiset irrefl_less_nmultiset)"], ["proof (state)\nthis:\n  x = y\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "instantiation nmultiset :: (linorder) linorder\nbegin"], ["", "lemma total_less_nmultiset:\n  fixes X Y :: \"'a nmultiset\"\n  shows \"\\<not> X < Y \\<Longrightarrow> Y \\<noteq> X \\<Longrightarrow> Y < X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> X < Y; Y \\<noteq> X\\<rbrakk> \\<Longrightarrow> Y < X", "proof (induct X Y rule: less_nmultiset_induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<not> Elem a < Elem b; Elem b \\<noteq> Elem a\\<rbrakk>\n       \\<Longrightarrow> Elem b < Elem a\n 2. \\<And>a M.\n       \\<lbrakk>\\<not> Elem a < MSet M; MSet M \\<noteq> Elem a\\<rbrakk>\n       \\<Longrightarrow> MSet M < Elem a\n 3. \\<And>M a.\n       \\<lbrakk>\\<not> MSet M < Elem a; Elem a \\<noteq> MSet M\\<rbrakk>\n       \\<Longrightarrow> Elem a < MSet M\n 4. \\<And>M N.\n       \\<lbrakk>\\<And>X Y k a.\n                   \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                    k \\<in># Y; \\<not> k < a; a \\<noteq> k\\<rbrakk>\n                   \\<Longrightarrow> a < k;\n        \\<not> MSet M < MSet N; MSet N \\<noteq> MSet M\\<rbrakk>\n       \\<Longrightarrow> MSet N < MSet M", "case (MSet_MSet M N)"], ["proof (state)\nthis:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; \\<not> ?k < ?a; ?a \\<noteq> ?k\\<rbrakk>\n  \\<Longrightarrow> ?a < ?k\n  \\<not> MSet M < MSet N\n  MSet N \\<noteq> MSet M\n\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<not> Elem a < Elem b; Elem b \\<noteq> Elem a\\<rbrakk>\n       \\<Longrightarrow> Elem b < Elem a\n 2. \\<And>a M.\n       \\<lbrakk>\\<not> Elem a < MSet M; MSet M \\<noteq> Elem a\\<rbrakk>\n       \\<Longrightarrow> MSet M < Elem a\n 3. \\<And>M a.\n       \\<lbrakk>\\<not> MSet M < Elem a; Elem a \\<noteq> MSet M\\<rbrakk>\n       \\<Longrightarrow> Elem a < MSet M\n 4. \\<And>M N.\n       \\<lbrakk>\\<And>X Y k a.\n                   \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                    k \\<in># Y; \\<not> k < a; a \\<noteq> k\\<rbrakk>\n                   \\<Longrightarrow> a < k;\n        \\<not> MSet M < MSet N; MSet N \\<noteq> MSet M\\<rbrakk>\n       \\<Longrightarrow> MSet N < MSet M", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; \\<not> ?k < ?a; ?a \\<noteq> ?k\\<rbrakk>\n  \\<Longrightarrow> ?a < ?k\n  \\<not> MSet M < MSet N\n  MSet N \\<noteq> MSet M", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; \\<not> ?k < ?a; ?a \\<noteq> ?k\\<rbrakk>\n  \\<Longrightarrow> ?a < ?k\n  \\<not> MSet M < MSet N\n  MSet N \\<noteq> MSet M\n\ngoal (1 subgoal):\n 1. MSet N < MSet M", "unfolding nmultiset.inject less_nmultiset.simps less_multiset_ext\\<^sub>D\\<^sub>M_less less_multiset\\<^sub>H\\<^sub>O"], ["proof (prove)\nusing this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; \\<not> ?k < ?a; ?a \\<noteq> ?k\\<rbrakk>\n  \\<Longrightarrow> ?a < ?k\n  \\<not> (M \\<noteq> N \\<and>\n          (\\<forall>y.\n              count N y < count M y \\<longrightarrow>\n              (\\<exists>x>y. count M x < count N x)))\n  N \\<noteq> M\n\ngoal (1 subgoal):\n 1. N \\<noteq> M \\<and>\n    (\\<forall>y.\n        count M y < count N y \\<longrightarrow>\n        (\\<exists>x>y. count N x < count M x))", "by (metis add_diff_cancel_left' count_inI diff_add_zero in_diff_count less_imp_not_less\n      mset_subset_eq_multiset_union_diff_commute subset_mset.order.refl)"], ["proof (state)\nthis:\n  MSet N < MSet M\n\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<not> Elem a < Elem b; Elem b \\<noteq> Elem a\\<rbrakk>\n       \\<Longrightarrow> Elem b < Elem a\n 2. \\<And>a M.\n       \\<lbrakk>\\<not> Elem a < MSet M; MSet M \\<noteq> Elem a\\<rbrakk>\n       \\<Longrightarrow> MSet M < Elem a\n 3. \\<And>M a.\n       \\<lbrakk>\\<not> MSet M < Elem a; Elem a \\<noteq> MSet M\\<rbrakk>\n       \\<Longrightarrow> Elem a < MSet M", "qed auto"], ["", "instance"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a nmultiset, linorder_class)", "proof (intro_classes, goal_cases total)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y. x \\<le> y \\<or> y \\<le> x", "case (total x y)"], ["proof (state)\nthis:\n  \n\ngoal (1 subgoal):\n 1. \\<And>x y. x \\<le> y \\<or> y \\<le> x", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le> y \\<or> y \\<le> x", "unfolding less_eq_nmultiset_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x < y \\<or> x = y) \\<or> y < x \\<or> y = x", "by (metis total_less_nmultiset)"], ["proof (state)\nthis:\n  x \\<le> y \\<or> y \\<le> x\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "lemma less_depth_nmset_imp_less_nmultiset: \"|X| < |Y| \\<Longrightarrow> X < Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. |X| < |Y| \\<Longrightarrow> X < Y", "proof (induct X Y rule: less_nmultiset_induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>a b. |Elem a| < |Elem b| \\<Longrightarrow> Elem a < Elem b\n 2. \\<And>a M. |Elem a| < |MSet M| \\<Longrightarrow> Elem a < MSet M\n 3. \\<And>M a. |MSet M| < |Elem a| \\<Longrightarrow> MSet M < Elem a\n 4. \\<And>M N.\n       \\<lbrakk>\\<And>X Y k a.\n                   \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                    k \\<in># Y; |k| < |a|\\<rbrakk>\n                   \\<Longrightarrow> k < a;\n        |MSet M| < |MSet N|\\<rbrakk>\n       \\<Longrightarrow> MSet M < MSet N", "case (MSet_MSet M N)"], ["proof (state)\nthis:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; |?k| < |?a|\\<rbrakk>\n  \\<Longrightarrow> ?k < ?a\n  |MSet M| < |MSet N|\n\ngoal (4 subgoals):\n 1. \\<And>a b. |Elem a| < |Elem b| \\<Longrightarrow> Elem a < Elem b\n 2. \\<And>a M. |Elem a| < |MSet M| \\<Longrightarrow> Elem a < MSet M\n 3. \\<And>M a. |MSet M| < |Elem a| \\<Longrightarrow> MSet M < Elem a\n 4. \\<And>M N.\n       \\<lbrakk>\\<And>X Y k a.\n                   \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                    k \\<in># Y; |k| < |a|\\<rbrakk>\n                   \\<Longrightarrow> k < a;\n        |MSet M| < |MSet N|\\<rbrakk>\n       \\<Longrightarrow> MSet M < MSet N", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; |?k| < |?a|\\<rbrakk>\n  \\<Longrightarrow> ?k < ?a\n  |MSet M| < |MSet N|", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; |?k| < |?a|\\<rbrakk>\n  \\<Longrightarrow> ?k < ?a\n  |MSet M| < |MSet N|\n\ngoal (1 subgoal):\n 1. MSet M < MSet N", "proof (cases \"M = {#}\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>X Y k a.\n                \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                 k \\<in># Y; |k| < |a|\\<rbrakk>\n                \\<Longrightarrow> k < a;\n     |MSet M| < |MSet N|; M = {#}\\<rbrakk>\n    \\<Longrightarrow> MSet M < MSet N\n 2. \\<lbrakk>\\<And>X Y k a.\n                \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                 k \\<in># Y; |k| < |a|\\<rbrakk>\n                \\<Longrightarrow> k < a;\n     |MSet M| < |MSet N|; M \\<noteq> {#}\\<rbrakk>\n    \\<Longrightarrow> MSet M < MSet N", "case False"], ["proof (state)\nthis:\n  M \\<noteq> {#}\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>X Y k a.\n                \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                 k \\<in># Y; |k| < |a|\\<rbrakk>\n                \\<Longrightarrow> k < a;\n     |MSet M| < |MSet N|; M = {#}\\<rbrakk>\n    \\<Longrightarrow> MSet M < MSet N\n 2. \\<lbrakk>\\<And>X Y k a.\n                \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                 k \\<in># Y; |k| < |a|\\<rbrakk>\n                \\<Longrightarrow> k < a;\n     |MSet M| < |MSet N|; M \\<noteq> {#}\\<rbrakk>\n    \\<Longrightarrow> MSet M < MSet N", "with MSet_MSet"], ["proof (chain)\npicking this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; |?k| < |?a|\\<rbrakk>\n  \\<Longrightarrow> ?k < ?a\n  |MSet M| < |MSet N|\n  M \\<noteq> {#}", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; |?k| < |?a|\\<rbrakk>\n  \\<Longrightarrow> ?k < ?a\n  |MSet M| < |MSet N|\n  M \\<noteq> {#}\n\ngoal (1 subgoal):\n 1. MSet M < MSet N", "by (auto 0 4 simp: depth_nmset.simps(2) less_multiset_ext\\<^sub>D\\<^sub>M_def not_le Max_gr_iff\n        intro: exI[of _ N] split: if_splits)"], ["proof (state)\nthis:\n  MSet M < MSet N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>X Y k a.\n                \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                 k \\<in># Y; |k| < |a|\\<rbrakk>\n                \\<Longrightarrow> k < a;\n     |MSet M| < |MSet N|; M = {#}\\<rbrakk>\n    \\<Longrightarrow> MSet M < MSet N", "qed (auto simp: depth_nmset.simps(2) less_multiset_ext\\<^sub>D\\<^sub>M_less split: if_splits)"], ["proof (state)\nthis:\n  MSet M < MSet N\n\ngoal (3 subgoals):\n 1. \\<And>a b. |Elem a| < |Elem b| \\<Longrightarrow> Elem a < Elem b\n 2. \\<And>a M. |Elem a| < |MSet M| \\<Longrightarrow> Elem a < MSet M\n 3. \\<And>M a. |MSet M| < |Elem a| \\<Longrightarrow> MSet M < Elem a", "qed simp_all"], ["", "lemma less_nmultiset_imp_le_depth_nmset: \"X < Y \\<Longrightarrow> |X| \\<le> |Y|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X < Y \\<Longrightarrow> |X| \\<le> |Y|", "proof (induct X Y rule: less_nmultiset_induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>a b. Elem a < Elem b \\<Longrightarrow> |Elem a| \\<le> |Elem b|\n 2. \\<And>a M. Elem a < MSet M \\<Longrightarrow> |Elem a| \\<le> |MSet M|\n 3. \\<And>M a. MSet M < Elem a \\<Longrightarrow> |MSet M| \\<le> |Elem a|\n 4. \\<And>M N.\n       \\<lbrakk>\\<And>X Y k a.\n                   \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                    k \\<in># Y; k < a\\<rbrakk>\n                   \\<Longrightarrow> |k| \\<le> |a|;\n        MSet M < MSet N\\<rbrakk>\n       \\<Longrightarrow> |MSet M| \\<le> |MSet N|", "case (MSet_MSet M N)"], ["proof (state)\nthis:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; ?k < ?a\\<rbrakk>\n  \\<Longrightarrow> |?k| \\<le> |?a|\n  MSet M < MSet N\n\ngoal (4 subgoals):\n 1. \\<And>a b. Elem a < Elem b \\<Longrightarrow> |Elem a| \\<le> |Elem b|\n 2. \\<And>a M. Elem a < MSet M \\<Longrightarrow> |Elem a| \\<le> |MSet M|\n 3. \\<And>M a. MSet M < Elem a \\<Longrightarrow> |MSet M| \\<le> |Elem a|\n 4. \\<And>M N.\n       \\<lbrakk>\\<And>X Y k a.\n                   \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                    k \\<in># Y; k < a\\<rbrakk>\n                   \\<Longrightarrow> |k| \\<le> |a|;\n        MSet M < MSet N\\<rbrakk>\n       \\<Longrightarrow> |MSet M| \\<le> |MSet N|", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; ?k < ?a\\<rbrakk>\n  \\<Longrightarrow> |?k| \\<le> |?a|\n  MSet M < MSet N", "have \"M < N\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?X \\<noteq> {#}; ?X \\<subseteq># N; M = N - ?X + ?Y;\n   ?k \\<in># ?Y; ?k < ?a\\<rbrakk>\n  \\<Longrightarrow> |?k| \\<le> |?a|\n  MSet M < MSet N\n\ngoal (1 subgoal):\n 1. M < N", "by (simp add: less_multiset_ext\\<^sub>D\\<^sub>M_less)"], ["proof (state)\nthis:\n  M < N\n\ngoal (4 subgoals):\n 1. \\<And>a b. Elem a < Elem b \\<Longrightarrow> |Elem a| \\<le> |Elem b|\n 2. \\<And>a M. Elem a < MSet M \\<Longrightarrow> |Elem a| \\<le> |MSet M|\n 3. \\<And>M a. MSet M < Elem a \\<Longrightarrow> |MSet M| \\<le> |Elem a|\n 4. \\<And>M N.\n       \\<lbrakk>\\<And>X Y k a.\n                   \\<lbrakk>X \\<noteq> {#}; X \\<subseteq># N; M = N - X + Y;\n                    k \\<in># Y; k < a\\<rbrakk>\n                   \\<Longrightarrow> |k| \\<le> |a|;\n        MSet M < MSet N\\<rbrakk>\n       \\<Longrightarrow> |MSet M| \\<le> |MSet N|", "then"], ["proof (chain)\npicking this:\n  M < N", "show ?case"], ["proof (prove)\nusing this:\n  M < N\n\ngoal (1 subgoal):\n 1. |MSet M| \\<le> |MSet N|", "proof (cases \"M = {#}\" \"N = {#}\" rule: bool.exhaust[case_product bool.exhaust])"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<lbrakk>M < N; (M = {#}) = True; (N = {#}) = True\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|\n 2. \\<lbrakk>M < N; (M = {#}) = True; (N = {#}) = False\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|\n 3. \\<lbrakk>M < N; (M = {#}) = False; (N = {#}) = True\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|\n 4. \\<lbrakk>M < N; (M = {#}) = False; (N = {#}) = False\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|", "case [simp]: False_False"], ["proof (state)\nthis:\n  (M = {#}) = False\n  (N = {#}) = False\n\ngoal (4 subgoals):\n 1. \\<lbrakk>M < N; (M = {#}) = True; (N = {#}) = True\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|\n 2. \\<lbrakk>M < N; (M = {#}) = True; (N = {#}) = False\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|\n 3. \\<lbrakk>M < N; (M = {#}) = False; (N = {#}) = True\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|\n 4. \\<lbrakk>M < N; (M = {#}) = False; (N = {#}) = False\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. |MSet M| \\<le> |MSet N|", "unfolding depth_nmset.simps(2) Let_def False_False Suc_le_mono set_image_mset image_is_empty\n      set_mset_eq_empty_iff if_False"], ["proof (prove)\ngoal (1 subgoal):\n 1. Max (depth_nmset ` set_mset M) \\<le> Max (depth_nmset ` set_mset N)", "proof (intro iffD2[OF Max_le_iff] ballI iffD2[OF Max_ge_iff]; (elim imageE)?; simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<lbrakk>a = |x|; x \\<in># M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>#N. |x| \\<le> |xa|", "fix X"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<lbrakk>a = |x|; x \\<in># M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>#N. |x| \\<le> |xa|", "assume [simp]: \"X \\<in># M\""], ["proof (state)\nthis:\n  X \\<in># M\n\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<lbrakk>a = |x|; x \\<in># M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>#N. |x| \\<le> |xa|", "with MSet_MSet(1)[of N M X, simplified] \\<open>M < N\\<close>"], ["proof (chain)\npicking this:\n  X < ?a \\<Longrightarrow> |X| \\<le> |?a|\n  M < N\n  X \\<in># M", "show \"\\<exists>Y\\<in>#N. |X| \\<le> |Y|\""], ["proof (prove)\nusing this:\n  X < ?a \\<Longrightarrow> |X| \\<le> |?a|\n  M < N\n  X \\<in># M\n\ngoal (1 subgoal):\n 1. \\<exists>Y\\<in>#N. |X| \\<le> |Y|", "by (meson ex_gt_imp_less_multiset less_asym' less_depth_nmset_imp_less_nmultiset\n          not_le_imp_less)"], ["proof (state)\nthis:\n  \\<exists>Y\\<in>#N. |X| \\<le> |Y|\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  |MSet M| \\<le> |MSet N|\n\ngoal (3 subgoals):\n 1. \\<lbrakk>M < N; (M = {#}) = True; (N = {#}) = True\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|\n 2. \\<lbrakk>M < N; (M = {#}) = True; (N = {#}) = False\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|\n 3. \\<lbrakk>M < N; (M = {#}) = False; (N = {#}) = True\\<rbrakk>\n    \\<Longrightarrow> |MSet M| \\<le> |MSet N|", "qed (auto simp: depth_nmset.simps(2))"], ["proof (state)\nthis:\n  |MSet M| \\<le> |MSet N|\n\ngoal (3 subgoals):\n 1. \\<And>a b. Elem a < Elem b \\<Longrightarrow> |Elem a| \\<le> |Elem b|\n 2. \\<And>a M. Elem a < MSet M \\<Longrightarrow> |Elem a| \\<le> |MSet M|\n 3. \\<And>M a. MSet M < Elem a \\<Longrightarrow> |MSet M| \\<le> |Elem a|", "qed simp_all"], ["", "lemma eq_mlex_I:\n  fixes f :: \"'a \\<Rightarrow> nat\" and R :: \"'a \\<Rightarrow> 'a \\<Rightarrow> bool\"\n  assumes \"\\<And>X Y. f X < f Y \\<Longrightarrow> R X Y\" and \"antisymp R\"\n  shows \"{(X, Y). R X Y} = f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {(X, Y). R X Y} = f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "proof safe"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       R a b \\<Longrightarrow>\n       (a, b) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 2. \\<And>a b.\n       (a, b)\n       \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y} \\<Longrightarrow>\n       R a b", "fix X Y"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       R a b \\<Longrightarrow>\n       (a, b) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 2. \\<And>a b.\n       (a, b)\n       \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y} \\<Longrightarrow>\n       R a b", "assume \"R X Y\""], ["proof (state)\nthis:\n  R X Y\n\ngoal (2 subgoals):\n 1. \\<And>a b.\n       R a b \\<Longrightarrow>\n       (a, b) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 2. \\<And>a b.\n       (a, b)\n       \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y} \\<Longrightarrow>\n       R a b", "show \"(X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "proof (cases \"f X\" \"f Y\" rule: linorder_cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. f X < f Y \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 2. f X = f Y \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 3. f Y < f X \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "case less"], ["proof (state)\nthis:\n  f X < f Y\n\ngoal (3 subgoals):\n 1. f X < f Y \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 2. f X = f Y \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 3. f Y < f X \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "with \\<open>R X Y\\<close>"], ["proof (chain)\npicking this:\n  R X Y\n  f X < f Y", "show ?thesis"], ["proof (prove)\nusing this:\n  R X Y\n  f X < f Y\n\ngoal (1 subgoal):\n 1. (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "by (elim mlex_less)"], ["proof (state)\nthis:\n  (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n\ngoal (2 subgoals):\n 1. f X = f Y \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 2. f Y < f X \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. f X = f Y \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 2. f Y < f X \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "case equal"], ["proof (state)\nthis:\n  f X = f Y\n\ngoal (2 subgoals):\n 1. f X = f Y \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n 2. f Y < f X \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "with \\<open>R X Y\\<close>"], ["proof (chain)\npicking this:\n  R X Y\n  f X = f Y", "show ?thesis"], ["proof (prove)\nusing this:\n  R X Y\n  f X = f Y\n\ngoal (1 subgoal):\n 1. (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "by (intro mlex_leq) auto"], ["proof (state)\nthis:\n  (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n\ngoal (1 subgoal):\n 1. f Y < f X \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f Y < f X \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "case greater"], ["proof (state)\nthis:\n  f Y < f X\n\ngoal (1 subgoal):\n 1. f Y < f X \\<Longrightarrow>\n    (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "from \\<open>R X Y\\<close> assms(1)[OF greater] \\<open>antisymp R\\<close> greater"], ["proof (chain)\npicking this:\n  R X Y\n  R Y X\n  antisymp R\n  f Y < f X", "show ?thesis"], ["proof (prove)\nusing this:\n  R X Y\n  R Y X\n  antisymp R\n  f Y < f X\n\ngoal (1 subgoal):\n 1. (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "unfolding antisymp_def"], ["proof (prove)\nusing this:\n  R X Y\n  R Y X\n  \\<forall>x y. R x y \\<longrightarrow> R y x \\<longrightarrow> x = y\n  f Y < f X\n\ngoal (1 subgoal):\n 1. (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "by auto"], ["proof (state)\nthis:\n  (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b)\n       \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y} \\<Longrightarrow>\n       R a b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b)\n       \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y} \\<Longrightarrow>\n       R a b", "fix X Y"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b)\n       \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y} \\<Longrightarrow>\n       R a b", "assume \"(X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\""], ["proof (state)\nthis:\n  (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       (a, b)\n       \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y} \\<Longrightarrow>\n       R a b", "then"], ["proof (chain)\npicking this:\n  (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}", "show \"R X Y\""], ["proof (prove)\nusing this:\n  (X, Y) \\<in> f <*mlex*> {(X, Y). f X = f Y \\<and> R X Y}\n\ngoal (1 subgoal):\n 1. R X Y", "unfolding mlex_prod_def"], ["proof (prove)\nusing this:\n  (X, Y)\n  \\<in> inv_image (less_than <*lex*> {(X, Y). f X = f Y \\<and> R X Y})\n         (\\<lambda>x. (f x, x))\n\ngoal (1 subgoal):\n 1. R X Y", "by (auto simp: assms(1))"], ["proof (state)\nthis:\n  R X Y\n\ngoal:\nNo subgoals!", "qed"], ["", "instantiation nmultiset :: (wellorder) wellorder\nbegin"], ["", "lemma depth_nmset_eq_0[simp]: \"|X| = 0 \\<longleftrightarrow> (X = MSet {#} \\<or> (\\<exists>x. X = Elem x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (|X| = 0) = (X = MSet {#} \\<or> (\\<exists>x. X = Elem x))", "by (cases X; simp add: depth_nmset.simps(2))"], ["", "lemma depth_nmset_eq_Suc[simp]: \"|X| = Suc n \\<longleftrightarrow>\n  (\\<exists>N. X = MSet N \\<and> (\\<exists>Y \\<in># N. |Y| = n) \\<and> (\\<forall>Y \\<in># N. |Y| \\<le> n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (|X| = Suc n) =\n    (\\<exists>N.\n        X = MSet N \\<and>\n        (\\<exists>Y\\<in>#N. |Y| = n) \\<and>\n        (\\<forall>Y\\<in>#N. |Y| \\<le> n))", "by (cases X; auto simp add: depth_nmset.simps(2) intro!: Max_eqI)\n    (metis (no_types, lifting) Max_in finite_imageI finite_set_mset imageE image_is_empty\n      set_mset_eq_empty_iff)"], ["", "lemma wf_less_nmultiset_depth:\n  \"wf {(X :: 'a nmultiset, Y). |X| = i \\<and> |Y| = i \\<and> X < Y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf {(X, Y). |X| = i \\<and> |Y| = i \\<and> X < Y}", "proof (induct i rule: less_induct)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       (\\<And>y.\n           y < x \\<Longrightarrow>\n           wf {a. case a of\n                  (X, Y) \\<Rightarrow>\n                    |X| = y \\<and> |Y| = y \\<and> X < Y}) \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = x \\<and> |Y| = x \\<and> X < Y}", "case (less i)"], ["proof (state)\nthis:\n  ?y < i \\<Longrightarrow>\n  wf {a. case a of\n         (X, Y) \\<Rightarrow> |X| = ?y \\<and> |Y| = ?y \\<and> X < Y}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       (\\<And>y.\n           y < x \\<Longrightarrow>\n           wf {a. case a of\n                  (X, Y) \\<Rightarrow>\n                    |X| = y \\<and> |Y| = y \\<and> X < Y}) \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = x \\<and> |Y| = x \\<and> X < Y}", "define A :: \"'a nmultiset set\" where \"A = {X. |X| < i}\""], ["proof (state)\nthis:\n  A = {X. |X| < i}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       (\\<And>y.\n           y < x \\<Longrightarrow>\n           wf {a. case a of\n                  (X, Y) \\<Rightarrow>\n                    |X| = y \\<and> |Y| = y \\<and> X < Y}) \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = x \\<and> |Y| = x \\<and> X < Y}", "from less"], ["proof (chain)\npicking this:\n  ?y < i \\<Longrightarrow>\n  wf {a. case a of\n         (X, Y) \\<Rightarrow> |X| = ?y \\<and> |Y| = ?y \\<and> X < Y}", "have \"wf ((depth_nmset :: 'a nmultiset \\<Rightarrow> nat) <*mlex*>\n      (\\<Union>j < i. {(X, Y). |X| = j \\<and> |Y| = j \\<and> X < Y}))\""], ["proof (prove)\nusing this:\n  ?y < i \\<Longrightarrow>\n  wf {a. case a of\n         (X, Y) \\<Rightarrow> |X| = ?y \\<and> |Y| = ?y \\<and> X < Y}\n\ngoal (1 subgoal):\n 1. wf (depth_nmset <*mlex*>\n        (\\<Union>j<i. {(X, Y). |X| = j \\<and> |Y| = j \\<and> X < Y}))", "by (intro wf_UN wf_mlex) auto"], ["proof (state)\nthis:\n  wf (depth_nmset <*mlex*>\n      (\\<Union>j<i. {(X, Y). |X| = j \\<and> |Y| = j \\<and> X < Y}))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       (\\<And>y.\n           y < x \\<Longrightarrow>\n           wf {a. case a of\n                  (X, Y) \\<Rightarrow>\n                    |X| = y \\<and> |Y| = y \\<and> X < Y}) \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = x \\<and> |Y| = x \\<and> X < Y}", "then"], ["proof (chain)\npicking this:\n  wf (depth_nmset <*mlex*>\n      (\\<Union>j<i. {(X, Y). |X| = j \\<and> |Y| = j \\<and> X < Y}))", "have *: \"wf (mult {(X :: 'a nmultiset, Y). X \\<in> A \\<and> Y \\<in> A \\<and> X < Y})\""], ["proof (prove)\nusing this:\n  wf (depth_nmset <*mlex*>\n      (\\<Union>j<i. {(X, Y). |X| = j \\<and> |Y| = j \\<and> X < Y}))\n\ngoal (1 subgoal):\n 1. wf (mult {(X, Y). X \\<in> A \\<and> Y \\<in> A \\<and> X < Y})", "by (intro wf_mult, elim wf_subset) (force simp: A_def mlex_prod_def not_less_iff_gr_or_eq\n      dest!: less_depth_nmset_imp_less_nmultiset)"], ["proof (state)\nthis:\n  wf (mult {(X, Y). X \\<in> A \\<and> Y \\<in> A \\<and> X < Y})\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       (\\<And>y.\n           y < x \\<Longrightarrow>\n           wf {a. case a of\n                  (X, Y) \\<Rightarrow>\n                    |X| = y \\<and> |Y| = y \\<and> X < Y}) \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = x \\<and> |Y| = x \\<and> X < Y}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. wf {a. case a of\n           (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}", "proof (cases i)"], ["proof (state)\ngoal (2 subgoals):\n 1. i = 0 \\<Longrightarrow>\n    wf {a. case a of\n           (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}\n 2. \\<And>nat.\n       i = Suc nat \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}", "case 0"], ["proof (state)\nthis:\n  i = 0\n\ngoal (2 subgoals):\n 1. i = 0 \\<Longrightarrow>\n    wf {a. case a of\n           (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}\n 2. \\<And>nat.\n       i = Suc nat \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}", "then"], ["proof (chain)\npicking this:\n  i = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  i = 0\n\ngoal (1 subgoal):\n 1. wf {a. case a of\n           (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}", "by (auto simp: inj_on_def intro!: wf_subset[OF\n        wf_Un[OF wf_map_prod_image[OF wf, of Elem] wf_UN[of \"Elem ` UNIV\" \"\\<lambda>x. {(x, MSet {#})}\"]]])"], ["proof (state)\nthis:\n  wf {a. case a of (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}\n\ngoal (1 subgoal):\n 1. \\<And>nat.\n       i = Suc nat \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>nat.\n       i = Suc nat \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}", "case (Suc n)"], ["proof (state)\nthis:\n  i = Suc n\n\ngoal (1 subgoal):\n 1. \\<And>nat.\n       i = Suc nat \\<Longrightarrow>\n       wf {a. case a of\n              (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}", "then"], ["proof (chain)\npicking this:\n  i = Suc n", "show ?thesis"], ["proof (prove)\nusing this:\n  i = Suc n\n\ngoal (1 subgoal):\n 1. wf {a. case a of\n           (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}", "by (intro wf_subset[OF wf_map_prod_image[OF *, of MSet]])\n        (auto 0 4 simp: map_prod_def image_iff inj_on_def A_def\n          dest!: less_multiset_ext\\<^sub>D\\<^sub>M_imp_mult[of _ A, rotated -1] split: prod.splits)"], ["proof (state)\nthis:\n  wf {a. case a of (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  wf {a. case a of (X, Y) \\<Rightarrow> |X| = i \\<and> |Y| = i \\<and> X < Y}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wf_less_nmultiset: \"wf {(X :: 'a nmultiset, Y :: 'a nmultiset). X < Y}\" (is \"wf ?R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. wf {(X, Y). X < Y}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. wf {(X, Y). X < Y}", "have \"?R = depth_nmset <*mlex*> {(X, Y). |X| = |Y| \\<and> X < Y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {(X, Y). X < Y} = depth_nmset <*mlex*> {(X, Y). |X| = |Y| \\<and> X < Y}", "by (rule eq_mlex_I) (auto simp: antisymp_def less_depth_nmset_imp_less_nmultiset)"], ["proof (state)\nthis:\n  {(X, Y). X < Y} = depth_nmset <*mlex*> {(X, Y). |X| = |Y| \\<and> X < Y}\n\ngoal (1 subgoal):\n 1. wf {(X, Y). X < Y}", "also"], ["proof (state)\nthis:\n  {(X, Y). X < Y} = depth_nmset <*mlex*> {(X, Y). |X| = |Y| \\<and> X < Y}\n\ngoal (1 subgoal):\n 1. wf {(X, Y). X < Y}", "have \"{(X, Y). |X| = |Y| \\<and> X < Y} = (\\<Union>i. {(X, Y). |X| = i \\<and> |Y| = i \\<and> X < Y})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {(X, Y). |X| = |Y| \\<and> X < Y} =\n    (\\<Union>i. {(X, Y). |X| = i \\<and> |Y| = i \\<and> X < Y})", "by auto"], ["proof (state)\nthis:\n  {(X, Y). |X| = |Y| \\<and> X < Y} =\n  (\\<Union>i. {(X, Y). |X| = i \\<and> |Y| = i \\<and> X < Y})\n\ngoal (1 subgoal):\n 1. wf {(X, Y). X < Y}", "finally"], ["proof (chain)\npicking this:\n  {a. case a of (X, Y) \\<Rightarrow> X < Y} =\n  depth_nmset <*mlex*>\n  (\\<Union>i. {(X, Y). |X| = i \\<and> |Y| = i \\<and> X < Y})", "show ?thesis"], ["proof (prove)\nusing this:\n  {a. case a of (X, Y) \\<Rightarrow> X < Y} =\n  depth_nmset <*mlex*>\n  (\\<Union>i. {(X, Y). |X| = i \\<and> |Y| = i \\<and> X < Y})\n\ngoal (1 subgoal):\n 1. wf {(X, Y). X < Y}", "by (fastforce intro: wf_mlex wf_Union wf_less_nmultiset_depth)"], ["proof (state)\nthis:\n  wf {(X, Y). X < Y}\n\ngoal:\nNo subgoals!", "qed"], ["", "instance"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a nmultiset, wellorder_class)", "using wf_less_nmultiset"], ["proof (prove)\nusing this:\n  wf {(X, Y). X < Y}\n\ngoal (1 subgoal):\n 1. OFCLASS('a nmultiset, wellorder_class)", "unfolding wf_def mem_Collect_eq prod.case"], ["proof (prove)\nusing this:\n  \\<forall>P.\n     (\\<forall>x.\n         (\\<forall>y<x. P y) \\<longrightarrow> P x) \\<longrightarrow>\n     All P\n\ngoal (1 subgoal):\n 1. OFCLASS('a nmultiset, wellorder_class)", "by intro_classes metis"], ["", "end"], ["", "end"]]}