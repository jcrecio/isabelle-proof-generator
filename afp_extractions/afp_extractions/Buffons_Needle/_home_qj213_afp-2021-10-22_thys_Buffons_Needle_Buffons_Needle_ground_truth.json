{"file_name": "/home/qj213/afp-2021-10-22/thys/Buffons_Needle/Buffons_Needle.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Buffons_Needle", "problem_names": ["lemma sin_le_zero': \"sin x \\<le> 0\" if \"x \\<ge> -pi\" \"x \\<le> 0\" for x", "lemma buffon_altdef:\n  \"buffon l d =\n     do {\n       (x, \\<phi>) \\<leftarrow> uniform_measure lborel ({-d/2..d/2} \\<times> {-pi..pi});\n       return (count_space UNIV) \n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in  min a b + d/2 \\<le> 0 \\<and> max a b + d/2 \\<ge> 0 \\<or> min a b - d/2 \\<le> 0 \\<and> max a b - d/2 \\<ge> 0)\n     }\"", "lemma closed_buffon_set [simp, intro, measurable]: \"closed (buffon_set l d)\"", "lemma closed_buffon_set' [simp, intro, measurable]: \"closed (buffon_set' l d)\"", "lemma measurable_buffon_set [measurable]: \"buffon_set l d \\<in> sets borel\"", "lemma measurable_buffon_set' [measurable]: \"buffon_set' l d \\<in> sets borel\"", "lemma buffon_altdef':\n  \"buffon l d = distr (uniform_measure lborel ({-d/2..d/2} \\<times> {-pi..pi}))\n                  (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)\"", "lemma buffon_prob_aux:\n  \"emeasure (buffon l d) {True} = emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)\"", "lemma emeasure_buffon_set_conv_buffon_set':\n  \"emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)\"", "lemma emeasure_buffon_set':\n  \"emeasure lborel (buffon_set' l d) = \n     ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\"\n  (is \"emeasure lborel ?A = _\")", "lemma emeasure_buffon_set'_short: \"emeasure lborel (buffon_set' l d) = ennreal l\"", "lemma emeasure_buffon_set_short: \"emeasure lborel (buffon_set l d) = 4 * ennreal l\"", "theorem buffon_short: \"emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))\"", "lemma emeasure_buffon_set'_long: \n  \"emeasure lborel (buffon_set' l d) =\n     ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)\"", "lemma emeasure_buffon_set_long: \"emeasure lborel (buffon_set l d) = \n        4 * ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)\"", "theorem buffon_long: \n  \"emeasure (buffon l d) {True} = \n     ennreal (2 / pi * ((l / d) - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))\""], "translations": [["", "lemma sin_le_zero': \"sin x \\<le> 0\" if \"x \\<ge> -pi\" \"x \\<le> 0\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. sin x \\<le> 0", "by (metis minus_le_iff neg_0_le_iff_le sin_ge_zero sin_minus that(1) that(2))"], ["", "subsection \\<open>Problem definition\\<close>"], ["", "text \\<open>\n  Consider a needle of length $l$ whose centre has the $x$-coordinate $x$. The following then\n  defines the set of all $x$-coordinates that the needle covers \n  (i.e. the projection of the needle onto the $x$-axis.)\n\\<close>"], ["", "definition needle :: \"real \\<Rightarrow> real \\<Rightarrow> real \\<Rightarrow> real set\" where\n  \"needle l x \\<phi> = closed_segment (x - l / 2 * sin \\<phi>) (x + l / 2 * sin \\<phi>)\""], ["", "text \\<open>\n  Buffon's Needle problem is then this: Assuming the needle's $x$ position is chosen uniformly\n  at random in a strip of width $d$ centred at the origin, what is the probability that the \n  needle crosses at least one of the left/right boundaries of that strip (located at \n  $x = \\pm\\frac{1}{2}d$)?\n\\<close>"], ["", "definition buffon :: \"real \\<Rightarrow> real \\<Rightarrow> bool measure\" where\n  \"buffon l d = \n     do {\n       (x, \\<phi>) \\<leftarrow> uniform_measure lborel ({-d/2..d/2} \\<times> {-pi..pi});\n       return (count_space UNIV) (needle l x \\<phi> \\<inter> {-d/2, d/2} \\<noteq> {})\n     }\""], ["", "subsection \\<open>Derivation of the solution\\<close>"], ["", "text \\<open>\n  The following form is a bit easier to handle.\n\\<close>"], ["", "lemma buffon_altdef:\n  \"buffon l d =\n     do {\n       (x, \\<phi>) \\<leftarrow> uniform_measure lborel ({-d/2..d/2} \\<times> {-pi..pi});\n       return (count_space UNIV) \n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in  min a b + d/2 \\<le> 0 \\<and> max a b + d/2 \\<ge> 0 \\<or> min a b - d/2 \\<le> 0 \\<and> max a b - d/2 \\<ge> 0)\n     }\""], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "note buffon_def[of l d]"], ["proof (state)\nthis:\n  buffon l d =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>(x, \\<phi>).\n      return (count_space UNIV)\n       (needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {}))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "also"], ["proof (state)\nthis:\n  buffon l d =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>(x, \\<phi>).\n      return (count_space UNIV)\n       (needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {}))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "{"], ["proof (state)\nthis:\n  buffon l d =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>(x, \\<phi>).\n      return (count_space UNIV)\n       (needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {}))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "have \"(\\<lambda>(x,\\<phi>). needle l x \\<phi> \\<inter> {-d/2, d/2} \\<noteq> {}) =\n        (\\<lambda>(x,\\<phi>). let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n                 in  -d/2 \\<ge> min a b \\<and> -d/2 \\<le> max a b \\<or> min a b \\<le> d/2 \\<and> max a b \\<ge> d/2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>(x, \\<phi>).\n        needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {}) =\n    (\\<lambda>(x, \\<phi>).\n        let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n        in min a b \\<le> - d / 2 \\<and> - d / 2 \\<le> max a b \\<or>\n           min a b \\<le> d / 2 \\<and> d / 2 \\<le> max a b)", "by (auto simp: needle_def Let_def closed_segment_eq_real_ivl min_def max_def)"], ["proof (state)\nthis:\n  (\\<lambda>(x, \\<phi>).\n      needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {}) =\n  (\\<lambda>(x, \\<phi>).\n      let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n      in min a b \\<le> - d / 2 \\<and> - d / 2 \\<le> max a b \\<or>\n         min a b \\<le> d / 2 \\<and> d / 2 \\<le> max a b)\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "also"], ["proof (state)\nthis:\n  (\\<lambda>(x, \\<phi>).\n      needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {}) =\n  (\\<lambda>(x, \\<phi>).\n      let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n      in min a b \\<le> - d / 2 \\<and> - d / 2 \\<le> max a b \\<or>\n         min a b \\<le> d / 2 \\<and> d / 2 \\<le> max a b)\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "have \"\\<dots> = \n      (\\<lambda>(x,\\<phi>). let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n               in  min a b + d/2 \\<le> 0 \\<and> max a b + d/2 \\<ge> 0 \\<or> min a b - d/2 \\<le> 0 \\<and> max a b - d/2 \\<ge> 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>(x, \\<phi>).\n        let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n        in min a b \\<le> - d / 2 \\<and> - d / 2 \\<le> max a b \\<or>\n           min a b \\<le> d / 2 \\<and> d / 2 \\<le> max a b) =\n    (\\<lambda>(x, \\<phi>).\n        let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n        in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n           min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2)", "by (auto simp add: algebra_simps Let_def)"], ["proof (state)\nthis:\n  (\\<lambda>(x, \\<phi>).\n      let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n      in min a b \\<le> - d / 2 \\<and> - d / 2 \\<le> max a b \\<or>\n         min a b \\<le> d / 2 \\<and> d / 2 \\<le> max a b) =\n  (\\<lambda>(x, \\<phi>).\n      let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n      in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n         min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2)\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>(x, \\<phi>).\n      needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {}) =\n  (\\<lambda>(x, \\<phi>).\n      let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n      in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n         min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2)", "have \"(\\<lambda>(x, \\<phi>). return (count_space UNIV) (needle l x \\<phi> \\<inter> {- d/2, d/2} \\<noteq> {})) =\n                  (\\<lambda>(x,\\<phi>). return (count_space UNIV) \n                    (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n                     in  min a b + d/2 \\<le> 0 \\<and> max a b + d/2 \\<ge> 0 \\<or> min a b - d/2 \\<le> 0 \\<and> max a b - d/2 \\<ge> 0))\""], ["proof (prove)\nusing this:\n  (\\<lambda>(x, \\<phi>).\n      needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {}) =\n  (\\<lambda>(x, \\<phi>).\n      let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n      in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n         min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2)\n\ngoal (1 subgoal):\n 1. (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {})) =\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "by (simp add: case_prod_unfold fun_eq_iff)"], ["proof (state)\nthis:\n  (\\<lambda>(x, \\<phi>).\n      return (count_space UNIV)\n       (needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {})) =\n  (\\<lambda>(x, \\<phi>).\n      return (count_space UNIV)\n       (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n        in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n           min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "}"], ["proof (state)\nthis:\n  (\\<lambda>(x, \\<phi>).\n      return (count_space UNIV)\n       (needle l x \\<phi> \\<inter> {- d / 2, d / 2} \\<noteq> {})) =\n  (\\<lambda>(x, \\<phi>).\n      return (count_space UNIV)\n       (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n        in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n           min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "finally"], ["proof (chain)\npicking this:\n  buffon l d =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>a.\n      case a of\n      (x, \\<phi>) \\<Rightarrow>\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "show ?thesis"], ["proof (prove)\nusing this:\n  buffon l d =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>a.\n      case a of\n      (x, \\<phi>) \\<Rightarrow>\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>(x, \\<phi>).\n        return (count_space UNIV)\n         (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "."], ["proof (state)\nthis:\n  buffon l d =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>(x, \\<phi>).\n      return (count_space UNIV)\n       (let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n        in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n           min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  It is obvious that the problem boils down to determining the measure of the following set:\n\\<close>"], ["", "definition buffon_set :: \"real \\<Rightarrow> real \\<Rightarrow> (real \\<times> real) set\" where\n  \"buffon_set l d = {(x,\\<phi>) \\<in> {-d/2..d/2} \\<times> {-pi..pi}. abs x \\<ge> d / 2 - abs (sin \\<phi>) * l / 2}\""], ["", "text \\<open>\n  By using the symmetry inherent in the problem, we can reduce the problem to the following \n  set, which corresponds to one quadrant of the original set:\n\\<close>"], ["", "definition buffon_set' :: \"real \\<Rightarrow> real \\<Rightarrow> (real \\<times> real) set\" where\n  \"buffon_set' l d = {(x,\\<phi>) \\<in> {0..d/2} \\<times> {0..pi}. x \\<ge> d / 2 - sin \\<phi> * l / 2}\""], ["", "lemma closed_buffon_set [simp, intro, measurable]: \"closed (buffon_set l d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed (buffon_set l d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. closed (buffon_set l d)", "have \"buffon_set l d = ({-d/2..d/2} \\<times> {-pi..pi}) \\<inter> \n          (\\<lambda>z. abs (fst z) + abs (sin (snd z)) * l / 2 - d / 2) -` {0..}\" \n    (is \"_ = ?A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon_set l d =\n    {- d / 2..d / 2} \\<times> {- pi..pi} \\<inter>\n    (\\<lambda>z.\n        \\<bar>fst z\\<bar> + \\<bar>sin (snd z)\\<bar> * l / 2 - d / 2) -`\n    {0..}", "unfolding buffon_set_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(x, \\<phi>).\n     (x, \\<phi>) \\<in> {- d / 2..d / 2} \\<times> {- pi..pi} \\<and>\n     d / 2 - \\<bar>sin \\<phi>\\<bar> * l / 2 \\<le> \\<bar>x\\<bar>} =\n    {- d / 2..d / 2} \\<times> {- pi..pi} \\<inter>\n    (\\<lambda>z.\n        \\<bar>fst z\\<bar> + \\<bar>sin (snd z)\\<bar> * l / 2 - d / 2) -`\n    {0..}", "by auto"], ["proof (state)\nthis:\n  buffon_set l d =\n  {- d / 2..d / 2} \\<times> {- pi..pi} \\<inter>\n  (\\<lambda>z.\n      \\<bar>fst z\\<bar> + \\<bar>sin (snd z)\\<bar> * l / 2 - d / 2) -`\n  {0..}\n\ngoal (1 subgoal):\n 1. closed (buffon_set l d)", "also"], ["proof (state)\nthis:\n  buffon_set l d =\n  {- d / 2..d / 2} \\<times> {- pi..pi} \\<inter>\n  (\\<lambda>z.\n      \\<bar>fst z\\<bar> + \\<bar>sin (snd z)\\<bar> * l / 2 - d / 2) -`\n  {0..}\n\ngoal (1 subgoal):\n 1. closed (buffon_set l d)", "have \"closed \\<dots>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed\n     ({- d / 2..d / 2} \\<times> {- pi..pi} \\<inter>\n      (\\<lambda>z.\n          \\<bar>fst z\\<bar> + \\<bar>sin (snd z)\\<bar> * l / 2 - d / 2) -`\n      {0..})", "by (intro closed_Int closed_vimage closed_Times) (auto intro!: continuous_intros)"], ["proof (state)\nthis:\n  closed\n   ({- d / 2..d / 2} \\<times> {- pi..pi} \\<inter>\n    (\\<lambda>z.\n        \\<bar>fst z\\<bar> + \\<bar>sin (snd z)\\<bar> * l / 2 - d / 2) -`\n    {0..})\n\ngoal (1 subgoal):\n 1. closed (buffon_set l d)", "finally"], ["proof (chain)\npicking this:\n  closed (buffon_set l d)", "show ?thesis"], ["proof (prove)\nusing this:\n  closed (buffon_set l d)\n\ngoal (1 subgoal):\n 1. closed (buffon_set l d)", "by simp"], ["proof (state)\nthis:\n  closed (buffon_set l d)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma closed_buffon_set' [simp, intro, measurable]: \"closed (buffon_set' l d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed (buffon_set' l d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. closed (buffon_set' l d)", "have \"buffon_set' l d = ({0..d/2} \\<times> {0..pi}) \\<inter> \n          (\\<lambda>z. fst z + sin (snd z) * l / 2 - d / 2) -` {0..}\" \n    (is \"_ = ?A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon_set' l d =\n    {0..d / 2} \\<times> {0..pi} \\<inter>\n    (\\<lambda>z. fst z + sin (snd z) * l / 2 - d / 2) -` {0..}", "unfolding buffon_set'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(x, \\<phi>).\n     (x, \\<phi>) \\<in> {0..d / 2} \\<times> {0..pi} \\<and>\n     d / 2 - sin \\<phi> * l / 2 \\<le> x} =\n    {0..d / 2} \\<times> {0..pi} \\<inter>\n    (\\<lambda>z. fst z + sin (snd z) * l / 2 - d / 2) -` {0..}", "by auto"], ["proof (state)\nthis:\n  buffon_set' l d =\n  {0..d / 2} \\<times> {0..pi} \\<inter>\n  (\\<lambda>z. fst z + sin (snd z) * l / 2 - d / 2) -` {0..}\n\ngoal (1 subgoal):\n 1. closed (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  buffon_set' l d =\n  {0..d / 2} \\<times> {0..pi} \\<inter>\n  (\\<lambda>z. fst z + sin (snd z) * l / 2 - d / 2) -` {0..}\n\ngoal (1 subgoal):\n 1. closed (buffon_set' l d)", "have \"closed \\<dots>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed\n     ({0..d / 2} \\<times> {0..pi} \\<inter>\n      (\\<lambda>z. fst z + sin (snd z) * l / 2 - d / 2) -` {0..})", "by (intro closed_Int closed_vimage closed_Times) (auto intro!: continuous_intros)"], ["proof (state)\nthis:\n  closed\n   ({0..d / 2} \\<times> {0..pi} \\<inter>\n    (\\<lambda>z. fst z + sin (snd z) * l / 2 - d / 2) -` {0..})\n\ngoal (1 subgoal):\n 1. closed (buffon_set' l d)", "finally"], ["proof (chain)\npicking this:\n  closed (buffon_set' l d)", "show ?thesis"], ["proof (prove)\nusing this:\n  closed (buffon_set' l d)\n\ngoal (1 subgoal):\n 1. closed (buffon_set' l d)", "by simp"], ["proof (state)\nthis:\n  closed (buffon_set' l d)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma measurable_buffon_set [measurable]: \"buffon_set l d \\<in> sets borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon_set l d \\<in> sets borel", "by measurable"], ["", "lemma measurable_buffon_set' [measurable]: \"buffon_set' l d \\<in> sets borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon_set' l d \\<in> sets borel", "by measurable"], ["", "context\n  fixes d l :: real\n  assumes d: \"d > 0\" and l: \"l > 0\"\nbegin"], ["", "lemma buffon_altdef':\n  \"buffon l d = distr (uniform_measure lborel ({-d/2..d/2} \\<times> {-pi..pi}))\n                  (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "let ?P = \"\\<lambda>(x,\\<phi>). let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n                    in  min a b + d/2 \\<le> 0 \\<and> max a b + d/2 \\<ge> 0 \\<or> min a b - d/2 \\<le> 0 \\<and> max a b - d/2 \\<ge> 0\""], ["proof (state)\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "have \"buffon l d = \n          uniform_measure lborel ({- d / 2..d / 2} \\<times> {-pi..pi}) \\<bind>\n          (\\<lambda>z. return (count_space UNIV) (?P z))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon l d =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>z.\n        return (count_space UNIV)\n         (case z of\n          (x, \\<phi>) \\<Rightarrow>\n            let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n            in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n               min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "unfolding buffon_altdef case_prod_unfold"], ["proof (prove)\ngoal (1 subgoal):\n 1. uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>p.\n        return (count_space UNIV)\n         (let a = fst p - l / 2 * sin (snd p);\n              b = fst p + l / 2 * sin (snd p)\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2)) =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>z.\n        return (count_space UNIV)\n         (let a = fst z - l / 2 * sin (snd z);\n              b = fst z + l / 2 * sin (snd z)\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))", "by simp"], ["proof (state)\nthis:\n  buffon l d =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>z.\n      return (count_space UNIV)\n       (case z of\n        (x, \\<phi>) \\<Rightarrow>\n          let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "also"], ["proof (state)\nthis:\n  buffon l d =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>z.\n      return (count_space UNIV)\n       (case z of\n        (x, \\<phi>) \\<Rightarrow>\n          let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "have \"\\<dots> = uniform_measure lborel ({- d / 2..d / 2} \\<times> {-pi..pi}) \\<bind>\n          (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>z.\n        return (count_space UNIV)\n         (case z of\n          (x, \\<phi>) \\<Rightarrow>\n            let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n            in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n               min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2)) =\n    uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))", "proof (intro bind_cong_AE AE_uniform_measureI AE_I2 impI refl return_measurable, goal_cases)"], ["proof (state)\ngoal (4 subgoals):\n 1. (\\<lambda>z.\n        return (count_space UNIV)\n         (case z of\n          (x, \\<phi>) \\<Rightarrow>\n            let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n            in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n               min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n    \\<in> uniform_measure lborel\n           ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n          subprob_algebra ?B\n 2. (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))\n    \\<in> uniform_measure lborel\n           ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n          subprob_algebra ?B\n 3. {- d / 2..d / 2} \\<times> {- pi..pi} \\<in> sets lborel\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> space lborel;\n        x \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\\<rbrakk>\n       \\<Longrightarrow> return (count_space UNIV)\n                          (case x of\n                           (x, \\<phi>) \\<Rightarrow>\n                             let a = x - l / 2 * sin \\<phi>;\n                                 b = x + l / 2 * sin \\<phi>\n                             in min a b + d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b + d / 2 \\<or>\n                                min a b - d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b - d / 2) =\n                         return (count_space UNIV) (x \\<in> buffon_set l d)", "show \"(\\<lambda>z. return (count_space UNIV) (?P z))\n             \\<in> uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n                 subprob_algebra (count_space UNIV)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>z.\n        return (count_space UNIV)\n         (case z of\n          (x, \\<phi>) \\<Rightarrow>\n            let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n            in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n               min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n    \\<in> uniform_measure lborel\n           ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n          subprob_algebra (count_space UNIV)", "unfolding Let_def case_prod_unfold lborel_prod [symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>z.\n        return (count_space UNIV)\n         (min (fst z - l / 2 * sin (snd z)) (fst z + l / 2 * sin (snd z)) +\n          d / 2\n          \\<le> 0 \\<and>\n          0 \\<le> max (fst z - l / 2 * sin (snd z))\n                   (fst z + l / 2 * sin (snd z)) +\n                  d / 2 \\<or>\n          min (fst z - l / 2 * sin (snd z)) (fst z + l / 2 * sin (snd z)) -\n          d / 2\n          \\<le> 0 \\<and>\n          0 \\<le> max (fst z - l / 2 * sin (snd z))\n                   (fst z + l / 2 * sin (snd z)) -\n                  d / 2))\n    \\<in> uniform_measure (lborel \\<Otimes>\\<^sub>M lborel)\n           ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n          subprob_algebra (count_space UNIV)", "by measurable"], ["proof (state)\nthis:\n  (\\<lambda>z.\n      return (count_space UNIV)\n       (case z of\n        (x, \\<phi>) \\<Rightarrow>\n          let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2))\n  \\<in> uniform_measure lborel\n         ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n        subprob_algebra (count_space UNIV)\n\ngoal (3 subgoals):\n 1. (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))\n    \\<in> uniform_measure lborel\n           ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n          subprob_algebra (count_space UNIV)\n 2. {- d / 2..d / 2} \\<times> {- pi..pi} \\<in> sets lborel\n 3. \\<And>x.\n       \\<lbrakk>x \\<in> space lborel;\n        x \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\\<rbrakk>\n       \\<Longrightarrow> return (count_space UNIV)\n                          (case x of\n                           (x, \\<phi>) \\<Rightarrow>\n                             let a = x - l / 2 * sin \\<phi>;\n                                 b = x + l / 2 * sin \\<phi>\n                             in min a b + d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b + d / 2 \\<or>\n                                min a b - d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b - d / 2) =\n                         return (count_space UNIV) (x \\<in> buffon_set l d)", "show \"(\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))\n            \\<in> uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n                subprob_algebra (count_space UNIV)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))\n    \\<in> uniform_measure lborel\n           ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n          subprob_algebra (count_space UNIV)", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))\n  \\<in> uniform_measure lborel\n         ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<rightarrow>\\<^sub>M\n        subprob_algebra (count_space UNIV)\n\ngoal (2 subgoals):\n 1. {- d / 2..d / 2} \\<times> {- pi..pi} \\<in> sets lborel\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> space lborel;\n        x \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\\<rbrakk>\n       \\<Longrightarrow> return (count_space UNIV)\n                          (case x of\n                           (x, \\<phi>) \\<Rightarrow>\n                             let a = x - l / 2 * sin \\<phi>;\n                                 b = x + l / 2 * sin \\<phi>\n                             in min a b + d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b + d / 2 \\<or>\n                                min a b - d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b - d / 2) =\n                         return (count_space UNIV) (x \\<in> buffon_set l d)", "case (4 z)"], ["proof (state)\nthis:\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n\ngoal (2 subgoals):\n 1. {- d / 2..d / 2} \\<times> {- pi..pi} \\<in> sets lborel\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> space lborel;\n        x \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\\<rbrakk>\n       \\<Longrightarrow> return (count_space UNIV)\n                          (case x of\n                           (x, \\<phi>) \\<Rightarrow>\n                             let a = x - l / 2 * sin \\<phi>;\n                                 b = x + l / 2 * sin \\<phi>\n                             in min a b + d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b + d / 2 \\<or>\n                                min a b - d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b - d / 2) =\n                         return (count_space UNIV) (x \\<in> buffon_set l d)", "hence \"?P z \\<longleftrightarrow> z \\<in> buffon_set l d\""], ["proof (prove)\nusing this:\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n\ngoal (1 subgoal):\n 1. (case z of\n     (x, \\<phi>) \\<Rightarrow>\n       let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n       in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n          min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    (z \\<in> buffon_set l d)", "proof (cases \"snd z \\<ge> 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)\n 2. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "case True"], ["proof (state)\nthis:\n  0 \\<le> snd z\n\ngoal (2 subgoals):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)\n 2. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "with 4"], ["proof (chain)\npicking this:\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  0 \\<le> snd z", "have \"fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)\""], ["proof (prove)\nusing this:\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)", "using l"], ["proof (prove)\nusing this:\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  0 \\<le> snd z\n  0 < l\n\ngoal (1 subgoal):\n 1. fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)", "by (auto simp: sin_ge_zero)"], ["proof (state)\nthis:\n  fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)\n 2. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "moreover"], ["proof (state)\nthis:\n  fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)\n 2. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "from True and 4"], ["proof (chain)\npicking this:\n  0 \\<le> snd z\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}", "have \"sin (snd z) \\<ge> 0\""], ["proof (prove)\nusing this:\n  0 \\<le> snd z\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n\ngoal (1 subgoal):\n 1. 0 \\<le> sin (snd z)", "by (auto simp: sin_ge_zero)"], ["proof (state)\nthis:\n  0 \\<le> sin (snd z)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)\n 2. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "ultimately"], ["proof (chain)\npicking this:\n  fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)\n  0 \\<le> sin (snd z)", "show ?thesis"], ["proof (prove)\nusing this:\n  fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)\n  0 \\<le> sin (snd z)\n\ngoal (1 subgoal):\n 1. (case z of\n     (x, \\<phi>) \\<Rightarrow>\n       let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n       in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n          min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    (z \\<in> buffon_set l d)", "using 4 True"], ["proof (prove)\nusing this:\n  fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)\n  0 \\<le> sin (snd z)\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. (case z of\n     (x, \\<phi>) \\<Rightarrow>\n       let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n       in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n          min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    (z \\<in> buffon_set l d)", "unfolding buffon_set_def"], ["proof (prove)\nusing this:\n  fst z - l / 2 * sin (snd z) \\<le> fst z + l / 2 * sin (snd z)\n  0 \\<le> sin (snd z)\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. (case z of\n     (x, \\<phi>) \\<Rightarrow>\n       let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n       in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n          min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    (z \\<in> {(x, \\<phi>).\n              (x, \\<phi>) \\<in> {- d / 2..d / 2} \\<times> {- pi..pi} \\<and>\n              d / 2 - \\<bar>sin \\<phi>\\<bar> * l / 2 \\<le> \\<bar>x\\<bar>})", "by (force simp: field_simps Let_def min_def max_def case_prod_unfold abs_if)"], ["proof (state)\nthis:\n  (case z of\n   (x, \\<phi>) \\<Rightarrow>\n     let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n     in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n        min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n  (z \\<in> buffon_set l d)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "case False"], ["proof (state)\nthis:\n  \\<not> 0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "with 4"], ["proof (chain)\npicking this:\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  \\<not> 0 \\<le> snd z", "have \"fst z - l / 2 * sin (snd z) \\<ge> fst z + l / 2 * sin (snd z)\""], ["proof (prove)\nusing this:\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  \\<not> 0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)", "using l"], ["proof (prove)\nusing this:\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  \\<not> 0 \\<le> snd z\n  0 < l\n\ngoal (1 subgoal):\n 1. fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)", "by (auto simp: sin_le_zero' mult_nonneg_nonpos)"], ["proof (state)\nthis:\n  fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "moreover"], ["proof (state)\nthis:\n  fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "from False and 4"], ["proof (chain)\npicking this:\n  \\<not> 0 \\<le> snd z\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}", "have \"sin (snd z) \\<le> 0\""], ["proof (prove)\nusing this:\n  \\<not> 0 \\<le> snd z\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n\ngoal (1 subgoal):\n 1. sin (snd z) \\<le> 0", "by (auto simp: sin_le_zero')"], ["proof (state)\nthis:\n  sin (snd z) \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<in> space lborel;\n     z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi};\n     \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> (case z of\n                       (x, \\<phi>) \\<Rightarrow>\n                         let a = x - l / 2 * sin \\<phi>;\n                             b = x + l / 2 * sin \\<phi>\n                         in min a b + d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b + d / 2 \\<or>\n                            min a b - d / 2 \\<le> 0 \\<and>\n                            0 \\<le> max a b - d / 2) =\n                      (z \\<in> buffon_set l d)", "ultimately"], ["proof (chain)\npicking this:\n  fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)\n  sin (snd z) \\<le> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)\n  sin (snd z) \\<le> 0\n\ngoal (1 subgoal):\n 1. (case z of\n     (x, \\<phi>) \\<Rightarrow>\n       let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n       in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n          min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    (z \\<in> buffon_set l d)", "using 4 and False"], ["proof (prove)\nusing this:\n  fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)\n  sin (snd z) \\<le> 0\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  \\<not> 0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. (case z of\n     (x, \\<phi>) \\<Rightarrow>\n       let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n       in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n          min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    (z \\<in> buffon_set l d)", "unfolding buffon_set_def"], ["proof (prove)\nusing this:\n  fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)\n  sin (snd z) \\<le> 0\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  \\<not> 0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. (case z of\n     (x, \\<phi>) \\<Rightarrow>\n       let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n       in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n          min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    (z \\<in> {(x, \\<phi>).\n              (x, \\<phi>) \\<in> {- d / 2..d / 2} \\<times> {- pi..pi} \\<and>\n              d / 2 - \\<bar>sin \\<phi>\\<bar> * l / 2 \\<le> \\<bar>x\\<bar>})", "using l d"], ["proof (prove)\nusing this:\n  fst z + l / 2 * sin (snd z) \\<le> fst z - l / 2 * sin (snd z)\n  sin (snd z) \\<le> 0\n  z \\<in> space lborel\n  z \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\n  \\<not> 0 \\<le> snd z\n  0 < l\n  0 < d\n\ngoal (1 subgoal):\n 1. (case z of\n     (x, \\<phi>) \\<Rightarrow>\n       let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n       in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n          min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    (z \\<in> {(x, \\<phi>).\n              (x, \\<phi>) \\<in> {- d / 2..d / 2} \\<times> {- pi..pi} \\<and>\n              d / 2 - \\<bar>sin \\<phi>\\<bar> * l / 2 \\<le> \\<bar>x\\<bar>})", "by (force simp: field_simps Let_def min_def max_def case_prod_unfold abs_if)"], ["proof (state)\nthis:\n  (case z of\n   (x, \\<phi>) \\<Rightarrow>\n     let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n     in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n        min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n  (z \\<in> buffon_set l d)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (case z of\n   (x, \\<phi>) \\<Rightarrow>\n     let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n     in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n        min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n  (z \\<in> buffon_set l d)\n\ngoal (2 subgoals):\n 1. {- d / 2..d / 2} \\<times> {- pi..pi} \\<in> sets lborel\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> space lborel;\n        x \\<in> {- d / 2..d / 2} \\<times> {- pi..pi}\\<rbrakk>\n       \\<Longrightarrow> return (count_space UNIV)\n                          (case x of\n                           (x, \\<phi>) \\<Rightarrow>\n                             let a = x - l / 2 * sin \\<phi>;\n                                 b = x + l / 2 * sin \\<phi>\n                             in min a b + d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b + d / 2 \\<or>\n                                min a b - d / 2 \\<le> 0 \\<and>\n                                0 \\<le> max a b - d / 2) =\n                         return (count_space UNIV) (x \\<in> buffon_set l d)", "thus ?case"], ["proof (prove)\nusing this:\n  (case z of\n   (x, \\<phi>) \\<Rightarrow>\n     let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n     in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n        min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n  (z \\<in> buffon_set l d)\n\ngoal (1 subgoal):\n 1. return (count_space UNIV)\n     (case z of\n      (x, \\<phi>) \\<Rightarrow>\n        let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n        in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n           min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n    return (count_space UNIV) (z \\<in> buffon_set l d)", "by (simp only: )"], ["proof (state)\nthis:\n  return (count_space UNIV)\n   (case z of\n    (x, \\<phi>) \\<Rightarrow>\n      let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n      in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n         min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2) =\n  return (count_space UNIV) (z \\<in> buffon_set l d)\n\ngoal (1 subgoal):\n 1. {- d / 2..d / 2} \\<times> {- pi..pi} \\<in> sets lborel", "qed (simp_all add: borel_prod [symmetric])"], ["proof (state)\nthis:\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>z.\n      return (count_space UNIV)\n       (case z of\n        (x, \\<phi>) \\<Rightarrow>\n          let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2)) =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "also"], ["proof (state)\nthis:\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>z.\n      return (count_space UNIV)\n       (case z of\n        (x, \\<phi>) \\<Rightarrow>\n          let a = x - l / 2 * sin \\<phi>; b = x + l / 2 * sin \\<phi>\n          in min a b + d / 2 \\<le> 0 \\<and> 0 \\<le> max a b + d / 2 \\<or>\n             min a b - d / 2 \\<le> 0 \\<and> 0 \\<le> max a b - d / 2)) =\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d))\n\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "have \"\\<dots> = distr (uniform_measure lborel ({-d/2..d/2} \\<times> {-pi..pi})) \n                    (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n    (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d)) =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "by (rule bind_return_distr') simp_all"], ["proof (state)\nthis:\n  uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}) \\<bind>\n  (\\<lambda>z. return (count_space UNIV) (z \\<in> buffon_set l d)) =\n  distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n   (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)\n\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "finally"], ["proof (chain)\npicking this:\n  buffon l d =\n  distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n   (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "show ?thesis"], ["proof (prove)\nusing this:\n  buffon l d =\n  distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n   (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)\n\ngoal (1 subgoal):\n 1. buffon l d =\n    distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n     (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)", "."], ["proof (state)\nthis:\n  buffon l d =\n  distr (uniform_measure lborel ({- d / 2..d / 2} \\<times> {- pi..pi}))\n   (count_space UNIV) (\\<lambda>z. z \\<in> buffon_set l d)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma buffon_prob_aux:\n  \"emeasure (buffon l d) {True} = emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "have [measurable]: \"A \\<times> B \\<in> sets borel\" if \"A \\<in> sets borel\" \"B \\<in> sets borel\" \n    for A B :: \"real set\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<times> B \\<in> sets borel", "using that"], ["proof (prove)\nusing this:\n  A \\<in> sets borel\n  B \\<in> sets borel\n\ngoal (1 subgoal):\n 1. A \\<times> B \\<in> sets borel", "unfolding borel_prod [symmetric]"], ["proof (prove)\nusing this:\n  A \\<in> sets borel\n  B \\<in> sets borel\n\ngoal (1 subgoal):\n 1. A \\<times> B \\<in> sets (borel \\<Otimes>\\<^sub>M borel)", "by simp"], ["proof (state)\nthis:\n  \\<lbrakk>?A \\<in> sets borel; ?B \\<in> sets borel\\<rbrakk>\n  \\<Longrightarrow> ?A \\<times> ?B \\<in> sets borel\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "have \"emeasure (buffon l d) {True} = \n          emeasure (uniform_measure lborel ({- (d / 2)..d / 2} \\<times> {-pi..pi}))\n          ((\\<lambda>z. z \\<in> buffon_set l d) -` {True})\" (is \"_ = emeasure ?M _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure\n     (uniform_measure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}))\n     ((\\<lambda>z. z \\<in> buffon_set l d) -` {True})", "by (simp add: buffon_altdef' emeasure_distr)"], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} =\n  emeasure (uniform_measure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}))\n   ((\\<lambda>z. z \\<in> buffon_set l d) -` {True})\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "also"], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} =\n  emeasure (uniform_measure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}))\n   ((\\<lambda>z. z \\<in> buffon_set l d) -` {True})\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "have \"(\\<lambda>z. z \\<in> buffon_set l d) -` {True} = buffon_set l d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>z. z \\<in> buffon_set l d) -` {True} = buffon_set l d", "by auto"], ["proof (state)\nthis:\n  (\\<lambda>z. z \\<in> buffon_set l d) -` {True} = buffon_set l d\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "also"], ["proof (state)\nthis:\n  (\\<lambda>z. z \\<in> buffon_set l d) -` {True} = buffon_set l d\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "have \"buffon_set l d \\<subseteq> {-d/2..d/2} \\<times> {-pi..pi}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon_set l d \\<subseteq> {- d / 2..d / 2} \\<times> {- pi..pi}", "using l d"], ["proof (prove)\nusing this:\n  0 < l\n  0 < d\n\ngoal (1 subgoal):\n 1. buffon_set l d \\<subseteq> {- d / 2..d / 2} \\<times> {- pi..pi}", "by (auto simp: buffon_set_def)"], ["proof (state)\nthis:\n  buffon_set l d \\<subseteq> {- d / 2..d / 2} \\<times> {- pi..pi}\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "hence \"emeasure ?M (buffon_set l d) = \n           emeasure lborel (buffon_set l d) / emeasure lborel ({- (d / 2)..d / 2} \\<times> {-pi..pi})\""], ["proof (prove)\nusing this:\n  buffon_set l d \\<subseteq> {- d / 2..d / 2} \\<times> {- pi..pi}\n\ngoal (1 subgoal):\n 1. emeasure\n     (uniform_measure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}))\n     (buffon_set l d) =\n    emeasure lborel (buffon_set l d) /\n    emeasure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi})", "by (subst emeasure_uniform_measure) (simp_all add: Int_absorb1)"], ["proof (state)\nthis:\n  emeasure (uniform_measure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}))\n   (buffon_set l d) =\n  emeasure lborel (buffon_set l d) /\n  emeasure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi})\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "also"], ["proof (state)\nthis:\n  emeasure (uniform_measure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}))\n   (buffon_set l d) =\n  emeasure lborel (buffon_set l d) /\n  emeasure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi})\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "have \"emeasure lborel ({- (d / 2)..d / 2} \\<times> {-pi..pi}) = ennreal (2 * pi * d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}) =\n    ennreal (2 * pi * d)", "using d"], ["proof (prove)\nusing this:\n  0 < d\n\ngoal (1 subgoal):\n 1. emeasure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}) =\n    ennreal (2 * pi * d)", "by (simp add: lborel_prod [symmetric] lborel.emeasure_pair_measure_Times\n                          ennreal_mult algebra_simps)"], ["proof (state)\nthis:\n  emeasure lborel ({- (d / 2)..d / 2} \\<times> {- pi..pi}) =\n  ennreal (2 * pi * d)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "finally"], ["proof (chain)\npicking this:\n  emeasure (buffon l d) {True} =\n  emeasure lborel (buffon_set l d) / ennreal (2 * pi * d)", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure (buffon l d) {True} =\n  emeasure lborel (buffon_set l d) / ennreal (2 * pi * d)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)", "by (simp add: mult_ac)"], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} =\n  emeasure lborel (buffon_set l d) / ennreal (2 * d * pi)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma emeasure_buffon_set_conv_buffon_set':\n  \"emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have distr_lborel [simp]: \"distr M lborel f = distr M borel f\" for M and f :: \"real \\<Rightarrow> real\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr M lborel f = distr M borel f", "by (rule distr_cong) simp_all"], ["proof (state)\nthis:\n  distr ?M lborel ?f = distr ?M borel ?f\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "define A where \"A = buffon_set' l d\""], ["proof (state)\nthis:\n  A = buffon_set' l d\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "define B C D where \"B = (\\<lambda>x. (-fst x, snd x)) -` A\" and \"C = (\\<lambda>x. (fst x, -snd x)) -` A\" and\n      \"D = (\\<lambda>x. (-fst x, -snd x)) -` A\""], ["proof (state)\nthis:\n  B = (\\<lambda>x. (- fst x, snd x)) -` A\n  C = (\\<lambda>x. (fst x, - snd x)) -` A\n  D = (\\<lambda>x. (- fst x, - snd x)) -` A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have meas [measurable]:\n     \"(\\<lambda>x::real \\<times> real. (-fst x, snd x)) \\<in> borel_measurable borel\"\n     \"(\\<lambda>x::real \\<times> real. (fst x, -snd x)) \\<in> borel_measurable borel\"\n     \"(\\<lambda>x::real \\<times> real. (-fst x, -snd x)) \\<in> borel_measurable borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. (- fst x, snd x)) \\<in> borel_measurable borel &&&\n    (\\<lambda>x. (fst x, - snd x)) \\<in> borel_measurable borel &&&\n    (\\<lambda>x. (- fst x, - snd x)) \\<in> borel_measurable borel", "unfolding borel_prod [symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. (- fst x, snd x))\n    \\<in> borel \\<Otimes>\\<^sub>M borel \\<rightarrow>\\<^sub>M\n          borel \\<Otimes>\\<^sub>M borel &&&\n    (\\<lambda>x. (fst x, - snd x))\n    \\<in> borel \\<Otimes>\\<^sub>M borel \\<rightarrow>\\<^sub>M\n          borel \\<Otimes>\\<^sub>M borel &&&\n    (\\<lambda>x. (- fst x, - snd x))\n    \\<in> borel \\<Otimes>\\<^sub>M borel \\<rightarrow>\\<^sub>M\n          borel \\<Otimes>\\<^sub>M borel", "by measurable"], ["proof (state)\nthis:\n  (\\<lambda>x. (- fst x, snd x)) \\<in> borel_measurable borel\n  (\\<lambda>x. (fst x, - snd x)) \\<in> borel_measurable borel\n  (\\<lambda>x. (- fst x, - snd x)) \\<in> borel_measurable borel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have meas' [measurable]: \"A \\<in> sets borel\" \"B \\<in> sets borel\" \"C \\<in> sets borel\" \"D \\<in> sets borel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (A \\<in> sets borel &&& B \\<in> sets borel) &&&\n    C \\<in> sets borel &&& D \\<in> sets borel", "unfolding A_def B_def C_def D_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (buffon_set' l d \\<in> sets borel &&&\n     (\\<lambda>x. (- fst x, snd x)) -` buffon_set' l d \\<in> sets borel) &&&\n    (\\<lambda>x. (fst x, - snd x)) -` buffon_set' l d \\<in> sets borel &&&\n    (\\<lambda>x. (- fst x, - snd x)) -` buffon_set' l d \\<in> sets borel", "by (rule measurable_buffon_set' measurable_sets_borel meas)+"], ["proof (state)\nthis:\n  A \\<in> sets borel\n  B \\<in> sets borel\n  C \\<in> sets borel\n  D \\<in> sets borel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have *: \"buffon_set l d = A \\<union> B \\<union> C \\<union> D\""], ["proof (prove)\ngoal (1 subgoal):\n 1. buffon_set l d = A \\<union> B \\<union> C \\<union> D", "proof (intro equalityI subsetI, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> buffon_set l d \\<Longrightarrow>\n       x \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<And>x.\n       x \\<in> A \\<union> B \\<union> C \\<union> D \\<Longrightarrow>\n       x \\<in> buffon_set l d", "case (1 z)"], ["proof (state)\nthis:\n  z \\<in> buffon_set l d\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> buffon_set l d \\<Longrightarrow>\n       x \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<And>x.\n       x \\<in> A \\<union> B \\<union> C \\<union> D \\<Longrightarrow>\n       x \\<in> buffon_set l d", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. z \\<in> A \\<union> B \\<union> C \\<union> D", "proof (cases \"fst z \\<ge> 0\"; cases \"snd z \\<ge> 0\")"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 3. \\<lbrakk>\\<not> 0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 4. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "assume \"fst z \\<ge> 0\" \"snd z \\<ge> 0\""], ["proof (state)\nthis:\n  0 \\<le> fst z\n  0 \\<le> snd z\n\ngoal (4 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 3. \\<lbrakk>\\<not> 0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 4. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "with 1"], ["proof (chain)\npicking this:\n  z \\<in> buffon_set l d\n  0 \\<le> fst z\n  0 \\<le> snd z", "have \"z \\<in> A\""], ["proof (prove)\nusing this:\n  z \\<in> buffon_set l d\n  0 \\<le> fst z\n  0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. z \\<in> A", "by (auto split: prod.splits simp: buffon_set_def buffon_set'_def sin_ge_zero A_def)"], ["proof (state)\nthis:\n  z \\<in> A\n\ngoal (4 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 3. \\<lbrakk>\\<not> 0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 4. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "thus ?thesis"], ["proof (prove)\nusing this:\n  z \\<in> A\n\ngoal (1 subgoal):\n 1. z \\<in> A \\<union> B \\<union> C \\<union> D", "by blast"], ["proof (state)\nthis:\n  z \\<in> A \\<union> B \\<union> C \\<union> D\n\ngoal (3 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>\\<not> 0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 3. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>\\<not> 0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 3. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "assume \"\\<not>(fst z \\<ge> 0)\" \"snd z \\<ge> 0\""], ["proof (state)\nthis:\n  \\<not> 0 \\<le> fst z\n  0 \\<le> snd z\n\ngoal (3 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>\\<not> 0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 3. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "with 1"], ["proof (chain)\npicking this:\n  z \\<in> buffon_set l d\n  \\<not> 0 \\<le> fst z\n  0 \\<le> snd z", "have \"z \\<in> B\""], ["proof (prove)\nusing this:\n  z \\<in> buffon_set l d\n  \\<not> 0 \\<le> fst z\n  0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. z \\<in> B", "by (auto split: prod.splits simp: buffon_set_def buffon_set'_def sin_ge_zero A_def B_def)"], ["proof (state)\nthis:\n  z \\<in> B\n\ngoal (3 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>\\<not> 0 \\<le> fst z; 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 3. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "thus ?thesis"], ["proof (prove)\nusing this:\n  z \\<in> B\n\ngoal (1 subgoal):\n 1. z \\<in> A \\<union> B \\<union> C \\<union> D", "by blast"], ["proof (state)\nthis:\n  z \\<in> A \\<union> B \\<union> C \\<union> D\n\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "assume \"fst z \\<ge> 0\" \"\\<not>(snd z \\<ge> 0)\""], ["proof (state)\nthis:\n  0 \\<le> fst z\n  \\<not> 0 \\<le> snd z\n\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "with 1"], ["proof (chain)\npicking this:\n  z \\<in> buffon_set l d\n  0 \\<le> fst z\n  \\<not> 0 \\<le> snd z", "have \"z \\<in> C\""], ["proof (prove)\nusing this:\n  z \\<in> buffon_set l d\n  0 \\<le> fst z\n  \\<not> 0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. z \\<in> C", "by (auto split: prod.splits simp: buffon_set_def buffon_set'_def sin_le_zero' A_def C_def)"], ["proof (state)\nthis:\n  z \\<in> C\n\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D\n 2. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "thus ?thesis"], ["proof (prove)\nusing this:\n  z \\<in> C\n\ngoal (1 subgoal):\n 1. z \\<in> A \\<union> B \\<union> C \\<union> D", "by blast"], ["proof (state)\nthis:\n  z \\<in> A \\<union> B \\<union> C \\<union> D\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "assume \"\\<not>(fst z \\<ge> 0)\" \"\\<not>(snd z \\<ge> 0)\""], ["proof (state)\nthis:\n  \\<not> 0 \\<le> fst z\n  \\<not> 0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "with 1"], ["proof (chain)\npicking this:\n  z \\<in> buffon_set l d\n  \\<not> 0 \\<le> fst z\n  \\<not> 0 \\<le> snd z", "have \"z \\<in> D\""], ["proof (prove)\nusing this:\n  z \\<in> buffon_set l d\n  \\<not> 0 \\<le> fst z\n  \\<not> 0 \\<le> snd z\n\ngoal (1 subgoal):\n 1. z \\<in> D", "by (auto split: prod.splits simp: buffon_set_def buffon_set'_def sin_le_zero' A_def D_def)"], ["proof (state)\nthis:\n  z \\<in> D\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> 0 \\<le> fst z; \\<not> 0 \\<le> snd z\\<rbrakk>\n    \\<Longrightarrow> z \\<in> A \\<union> B \\<union> C \\<union> D", "thus ?thesis"], ["proof (prove)\nusing this:\n  z \\<in> D\n\ngoal (1 subgoal):\n 1. z \\<in> A \\<union> B \\<union> C \\<union> D", "by blast"], ["proof (state)\nthis:\n  z \\<in> A \\<union> B \\<union> C \\<union> D\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  z \\<in> A \\<union> B \\<union> C \\<union> D\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> A \\<union> B \\<union> C \\<union> D \\<Longrightarrow>\n       x \\<in> buffon_set l d", "qed (auto simp: buffon_set_def buffon_set'_def sin_ge_zero sin_le_zero'  A_def B_def C_def D_def)"], ["proof (state)\nthis:\n  buffon_set l d = A \\<union> B \\<union> C \\<union> D\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"A \\<inter> B = {0} \\<times> ({0..pi} \\<inter> {\\<phi>. sin \\<phi> * l - d \\<ge> 0})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<inter> B =\n    {0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. A \\<inter> B =\n    {0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})", "by (auto simp: buffon_set'_def  A_def B_def C_def D_def)"], ["proof (state)\nthis:\n  A \\<inter> B =\n  {0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "moreover"], ["proof (state)\nthis:\n  A \\<inter> B =\n  {0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"emeasure lborel \\<dots> = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel\n     ({0} \\<times>\n      ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})) =\n    0", "unfolding lborel_prod [symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (lborel \\<Otimes>\\<^sub>M lborel)\n     ({0} \\<times>\n      ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})) =\n    0", "by (subst lborel.emeasure_pair_measure_Times) simp_all"], ["proof (state)\nthis:\n  emeasure lborel\n   ({0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})) =\n  0\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "ultimately"], ["proof (chain)\npicking this:\n  A \\<inter> B =\n  {0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})\n  emeasure lborel\n   ({0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})) =\n  0", "have AB: \"(A \\<inter> B) \\<in> null_sets lborel\""], ["proof (prove)\nusing this:\n  A \\<inter> B =\n  {0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})\n  emeasure lborel\n   ({0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})) =\n  0\n\ngoal (1 subgoal):\n 1. A \\<inter> B \\<in> null_sets lborel", "unfolding lborel_prod [symmetric]"], ["proof (prove)\nusing this:\n  A \\<inter> B =\n  {0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})\n  emeasure (lborel \\<Otimes>\\<^sub>M lborel)\n   ({0} \\<times> ({0..pi} \\<inter> {\\<phi>. 0 \\<le> sin \\<phi> * l - d})) =\n  0\n\ngoal (1 subgoal):\n 1. A \\<inter> B \\<in> null_sets (lborel \\<Otimes>\\<^sub>M lborel)", "by (simp add: null_sets_def)"], ["proof (state)\nthis:\n  A \\<inter> B \\<in> null_sets lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"C \\<inter> D = {0} \\<times> ({-pi..0} \\<inter> {\\<phi>. -sin \\<phi> * l - d \\<ge> 0})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C \\<inter> D =\n    {0} \\<times> ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. C \\<inter> D =\n    {0} \\<times> ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})", "by (auto simp: buffon_set'_def  A_def B_def C_def D_def)"], ["proof (state)\nthis:\n  C \\<inter> D =\n  {0} \\<times> ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "moreover"], ["proof (state)\nthis:\n  C \\<inter> D =\n  {0} \\<times> ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"emeasure lborel \\<dots> = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel\n     ({0} \\<times>\n      ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})) =\n    0", "unfolding lborel_prod [symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (lborel \\<Otimes>\\<^sub>M lborel)\n     ({0} \\<times>\n      ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})) =\n    0", "by (subst lborel.emeasure_pair_measure_Times) simp_all"], ["proof (state)\nthis:\n  emeasure lborel\n   ({0} \\<times>\n    ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})) =\n  0\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "ultimately"], ["proof (chain)\npicking this:\n  C \\<inter> D =\n  {0} \\<times> ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})\n  emeasure lborel\n   ({0} \\<times>\n    ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})) =\n  0", "have CD: \"(C \\<inter> D) \\<in> null_sets lborel\""], ["proof (prove)\nusing this:\n  C \\<inter> D =\n  {0} \\<times> ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})\n  emeasure lborel\n   ({0} \\<times>\n    ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})) =\n  0\n\ngoal (1 subgoal):\n 1. C \\<inter> D \\<in> null_sets lborel", "unfolding lborel_prod [symmetric]"], ["proof (prove)\nusing this:\n  C \\<inter> D =\n  {0} \\<times> ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})\n  emeasure (lborel \\<Otimes>\\<^sub>M lborel)\n   ({0} \\<times>\n    ({- pi..0} \\<inter> {\\<phi>. 0 \\<le> - sin \\<phi> * l - d})) =\n  0\n\ngoal (1 subgoal):\n 1. C \\<inter> D \\<in> null_sets (lborel \\<Otimes>\\<^sub>M lborel)", "by (simp add: null_sets_def)"], ["proof (state)\nthis:\n  C \\<inter> D \\<in> null_sets lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"A \\<inter> D = {}\" \"B \\<inter> C = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<inter> D = {} &&& B \\<inter> C = {}", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. A \\<inter> D = {} &&& B \\<inter> C = {}", "by (auto simp: buffon_set'_def A_def D_def B_def C_def)"], ["proof (state)\nthis:\n  A \\<inter> D = {}\n  B \\<inter> C = {}\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "moreover"], ["proof (state)\nthis:\n  A \\<inter> D = {}\n  B \\<inter> C = {}\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"A \\<inter> C = {(d/2, 0)}\" \"B \\<inter> D = {(-d/2, 0)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<inter> C = {(d / 2, 0)} &&& B \\<inter> D = {(- d / 2, 0)}", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. A \\<inter> C = {(d / 2, 0)} &&& B \\<inter> D = {(- d / 2, 0)}", "by (auto simp: case_prod_unfold buffon_set'_def A_def B_def C_def D_def)"], ["proof (state)\nthis:\n  A \\<inter> C = {(d / 2, 0)}\n  B \\<inter> D = {(- d / 2, 0)}\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "ultimately"], ["proof (chain)\npicking this:\n  A \\<inter> D = {}\n  B \\<inter> C = {}\n  A \\<inter> C = {(d / 2, 0)}\n  B \\<inter> D = {(- d / 2, 0)}", "have AD: \"A \\<inter> D \\<in> null_sets lborel\" and BC: \"B \\<inter> C \\<in> null_sets lborel\" and\n    AC: \"A \\<inter> C \\<in> null_sets lborel\" and BD: \"B \\<inter> D \\<in> null_sets lborel\""], ["proof (prove)\nusing this:\n  A \\<inter> D = {}\n  B \\<inter> C = {}\n  A \\<inter> C = {(d / 2, 0)}\n  B \\<inter> D = {(- d / 2, 0)}\n\ngoal (1 subgoal):\n 1. (A \\<inter> D \\<in> null_sets lborel &&&\n     B \\<inter> C \\<in> null_sets lborel) &&&\n    A \\<inter> C \\<in> null_sets lborel &&&\n    B \\<inter> D \\<in> null_sets lborel", "by auto"], ["proof (state)\nthis:\n  A \\<inter> D \\<in> null_sets lborel\n  B \\<inter> C \\<in> null_sets lborel\n  A \\<inter> C \\<in> null_sets lborel\n  B \\<inter> D \\<in> null_sets lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "note *"], ["proof (state)\nthis:\n  buffon_set l d = A \\<union> B \\<union> C \\<union> D\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  buffon_set l d = A \\<union> B \\<union> C \\<union> D\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"emeasure lborel (A \\<union> B \\<union> C \\<union> D) = emeasure lborel (A \\<union> B \\<union> C) + emeasure lborel D\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (A \\<union> B \\<union> C \\<union> D) =\n    emeasure lborel (A \\<union> B \\<union> C) + emeasure lborel D", "using AB AC AD BC BD CD"], ["proof (prove)\nusing this:\n  A \\<inter> B \\<in> null_sets lborel\n  A \\<inter> C \\<in> null_sets lborel\n  A \\<inter> D \\<in> null_sets lborel\n  B \\<inter> C \\<in> null_sets lborel\n  B \\<inter> D \\<in> null_sets lborel\n  C \\<inter> D \\<in> null_sets lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (A \\<union> B \\<union> C \\<union> D) =\n    emeasure lborel (A \\<union> B \\<union> C) + emeasure lborel D", "by (intro emeasure_Un') (auto simp: Int_Un_distrib2)"], ["proof (state)\nthis:\n  emeasure lborel (A \\<union> B \\<union> C \\<union> D) =\n  emeasure lborel (A \\<union> B \\<union> C) + emeasure lborel D\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  emeasure lborel (A \\<union> B \\<union> C \\<union> D) =\n  emeasure lborel (A \\<union> B \\<union> C) + emeasure lborel D\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"emeasure lborel (A \\<union> B \\<union> C) = emeasure lborel (A \\<union> B) + emeasure lborel C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (A \\<union> B \\<union> C) =\n    emeasure lborel (A \\<union> B) + emeasure lborel C", "using AB AC BC"], ["proof (prove)\nusing this:\n  A \\<inter> B \\<in> null_sets lborel\n  A \\<inter> C \\<in> null_sets lborel\n  B \\<inter> C \\<in> null_sets lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (A \\<union> B \\<union> C) =\n    emeasure lborel (A \\<union> B) + emeasure lborel C", "using AB AC AD BC BD CD"], ["proof (prove)\nusing this:\n  A \\<inter> B \\<in> null_sets lborel\n  A \\<inter> C \\<in> null_sets lborel\n  B \\<inter> C \\<in> null_sets lborel\n  A \\<inter> B \\<in> null_sets lborel\n  A \\<inter> C \\<in> null_sets lborel\n  A \\<inter> D \\<in> null_sets lborel\n  B \\<inter> C \\<in> null_sets lborel\n  B \\<inter> D \\<in> null_sets lborel\n  C \\<inter> D \\<in> null_sets lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (A \\<union> B \\<union> C) =\n    emeasure lborel (A \\<union> B) + emeasure lborel C", "by (intro emeasure_Un') (auto simp: Int_Un_distrib2)"], ["proof (state)\nthis:\n  emeasure lborel (A \\<union> B \\<union> C) =\n  emeasure lborel (A \\<union> B) + emeasure lborel C\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  emeasure lborel (A \\<union> B \\<union> C) =\n  emeasure lborel (A \\<union> B) + emeasure lborel C\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"emeasure lborel (A \\<union> B) = emeasure lborel A + emeasure lborel B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (A \\<union> B) = emeasure lborel A + emeasure lborel B", "using AB"], ["proof (prove)\nusing this:\n  A \\<inter> B \\<in> null_sets lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (A \\<union> B) = emeasure lborel A + emeasure lborel B", "using AB AC AD BC BD CD"], ["proof (prove)\nusing this:\n  A \\<inter> B \\<in> null_sets lborel\n  A \\<inter> B \\<in> null_sets lborel\n  A \\<inter> C \\<in> null_sets lborel\n  A \\<inter> D \\<in> null_sets lborel\n  B \\<inter> C \\<in> null_sets lborel\n  B \\<inter> D \\<in> null_sets lborel\n  C \\<inter> D \\<in> null_sets lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (A \\<union> B) = emeasure lborel A + emeasure lborel B", "by (intro emeasure_Un') (auto simp: Int_Un_distrib2)"], ["proof (state)\nthis:\n  emeasure lborel (A \\<union> B) = emeasure lborel A + emeasure lborel B\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  emeasure lborel (A \\<union> B) = emeasure lborel A + emeasure lborel B\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"emeasure lborel B = emeasure (distr lborel lborel (\\<lambda>(x,y). (-x, y))) A\"\n    (is \"_ = emeasure ?M _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel B =\n    emeasure (distr lborel lborel (\\<lambda>(x, y). (- x, y))) A", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel ((\\<lambda>x. (- fst x, snd x)) -` A) =\n    emeasure (distr lborel lborel (\\<lambda>(x, y). (- x, y))) A", "by (subst emeasure_distr) (simp_all add: case_prod_unfold)"], ["proof (state)\nthis:\n  emeasure lborel B =\n  emeasure (distr lborel lborel (\\<lambda>(x, y). (- x, y))) A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  emeasure lborel B =\n  emeasure (distr lborel lborel (\\<lambda>(x, y). (- x, y))) A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"?M = lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr lborel lborel (\\<lambda>(x, y). (- x, y)) = lborel", "unfolding lborel_prod [symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. distr (lborel \\<Otimes>\\<^sub>M lborel)\n     (lborel \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (- x, y)) =\n    lborel \\<Otimes>\\<^sub>M lborel", "by (subst pair_measure_distr [symmetric]) (simp_all add: sigma_finite_lborel lborel_distr_uminus)"], ["proof (state)\nthis:\n  distr lborel lborel (\\<lambda>(x, y). (- x, y)) = lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  distr lborel lborel (\\<lambda>(x, y). (- x, y)) = lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"emeasure lborel C = emeasure (distr lborel lborel (\\<lambda>(x,y). (x, -y))) A\"\n    (is \"_ = emeasure ?M _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel C =\n    emeasure (distr lborel lborel (\\<lambda>(x, y). (x, - y))) A", "unfolding C_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel ((\\<lambda>x. (fst x, - snd x)) -` A) =\n    emeasure (distr lborel lborel (\\<lambda>(x, y). (x, - y))) A", "by (subst emeasure_distr) (simp_all add: case_prod_unfold)"], ["proof (state)\nthis:\n  emeasure lborel C =\n  emeasure (distr lborel lborel (\\<lambda>(x, y). (x, - y))) A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  emeasure lborel C =\n  emeasure (distr lborel lborel (\\<lambda>(x, y). (x, - y))) A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"?M = lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr lborel lborel (\\<lambda>(x, y). (x, - y)) = lborel", "unfolding lborel_prod [symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. distr (lborel \\<Otimes>\\<^sub>M lborel)\n     (lborel \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (x, - y)) =\n    lborel \\<Otimes>\\<^sub>M lborel", "by (subst pair_measure_distr [symmetric]) (simp_all add: sigma_finite_lborel lborel_distr_uminus)"], ["proof (state)\nthis:\n  distr lborel lborel (\\<lambda>(x, y). (x, - y)) = lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  distr lborel lborel (\\<lambda>(x, y). (x, - y)) = lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"emeasure lborel D = emeasure (distr lborel lborel (\\<lambda>(x,y). (-x, -y))) A\"\n    (is \"_ = emeasure ?M _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel D =\n    emeasure (distr lborel lborel (\\<lambda>(x, y). (- x, - y))) A", "unfolding D_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel ((\\<lambda>x. (- fst x, - snd x)) -` A) =\n    emeasure (distr lborel lborel (\\<lambda>(x, y). (- x, - y))) A", "by (subst emeasure_distr) (simp_all add: case_prod_unfold)"], ["proof (state)\nthis:\n  emeasure lborel D =\n  emeasure (distr lborel lborel (\\<lambda>(x, y). (- x, - y))) A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  emeasure lborel D =\n  emeasure (distr lborel lborel (\\<lambda>(x, y). (- x, - y))) A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"?M = lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. distr lborel lborel (\\<lambda>(x, y). (- x, - y)) = lborel", "unfolding lborel_prod [symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. distr (lborel \\<Otimes>\\<^sub>M lborel)\n     (lborel \\<Otimes>\\<^sub>M lborel) (\\<lambda>(x, y). (- x, - y)) =\n    lborel \\<Otimes>\\<^sub>M lborel", "by (subst pair_measure_distr [symmetric]) (simp_all add: sigma_finite_lborel lborel_distr_uminus)"], ["proof (state)\nthis:\n  distr lborel lborel (\\<lambda>(x, y). (- x, - y)) = lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "finally"], ["proof (chain)\npicking this:\n  emeasure lborel (buffon_set l d) =\n  emeasure lborel A + emeasure lborel A + emeasure lborel A +\n  emeasure lborel A", "have \"emeasure lborel (buffon_set l d) = \n                  of_nat (Suc (Suc (Suc (Suc 0)))) * emeasure lborel A\""], ["proof (prove)\nusing this:\n  emeasure lborel (buffon_set l d) =\n  emeasure lborel A + emeasure lborel A + emeasure lborel A +\n  emeasure lborel A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) =\n    of_nat (Suc (Suc (Suc (Suc 0)))) * emeasure lborel A", "unfolding of_nat_Suc ring_distribs"], ["proof (prove)\nusing this:\n  emeasure lborel (buffon_set l d) =\n  emeasure lborel A + emeasure lborel A + emeasure lborel A +\n  emeasure lborel A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) =\n    1 * emeasure lborel A +\n    (1 * emeasure lborel A +\n     (1 * emeasure lborel A +\n      (1 * emeasure lborel A + of_nat 0 * emeasure lborel A)))", "by simp"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set l d) =\n  of_nat (Suc (Suc (Suc (Suc 0)))) * emeasure lborel A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "also"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set l d) =\n  of_nat (Suc (Suc (Suc (Suc 0)))) * emeasure lborel A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "have \"of_nat (Suc (Suc (Suc (Suc 0)))) = (4 :: ennreal)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_nat (Suc (Suc (Suc (Suc 0)))) = 4", "by simp"], ["proof (state)\nthis:\n  of_nat (Suc (Suc (Suc (Suc 0)))) = 4\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "finally"], ["proof (chain)\npicking this:\n  emeasure lborel (buffon_set l d) = 4 * emeasure lborel A", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure lborel (buffon_set l d) = 4 * emeasure lborel A\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "unfolding A_def"], ["proof (prove)\nusing this:\n  emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)", "."], ["proof (state)\nthis:\n  emeasure lborel (buffon_set l d) = 4 * emeasure lborel (buffon_set' l d)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  It only remains now to compute the measure of @{const buffon_set'}. We first reduce this\n  problem to a relatively simple integral:\n\\<close>"], ["", "lemma emeasure_buffon_set':\n  \"emeasure lborel (buffon_set' l d) = \n     ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\"\n  (is \"emeasure lborel ?A = _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "have \"emeasure lborel ?A = nn_integral lborel (\\<lambda>x. indicator ?A x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    integral\\<^sup>N lborel (indicator (buffon_set' l d))", "by (intro nn_integral_indicator [symmetric]) simp_all"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) =\n  integral\\<^sup>N lborel (indicator (buffon_set' l d))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "also"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) =\n  integral\\<^sup>N lborel (indicator (buffon_set' l d))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "have \"(lborel :: (real \\<times> real) measure) = lborel \\<Otimes>\\<^sub>M lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lborel = lborel \\<Otimes>\\<^sub>M lborel", "by (simp only: lborel_prod)"], ["proof (state)\nthis:\n  lborel = lborel \\<Otimes>\\<^sub>M lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "also"], ["proof (state)\nthis:\n  lborel = lborel \\<Otimes>\\<^sub>M lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "have \"nn_integral \\<dots> (indicator ?A) = (\\<integral>\\<^sup>+\\<phi>. \\<integral>\\<^sup>+x. indicator ?A (x, \\<phi>) \\<partial>lborel \\<partial>lborel)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral\\<^sup>N (lborel \\<Otimes>\\<^sub>M lborel)\n     (indicator (buffon_set' l d)) =\n    \\<integral>\\<^sup>+ \\<phi>.\n                         \\<integral>\\<^sup>+ x.\n        indicator (buffon_set' l d) (x, \\<phi>)\n      \\<partial>lborel\n                       \\<partial>lborel", "by (subst lborel_pair.nn_integral_snd [symmetric]) (simp_all add: lborel_prod borel_prod)"], ["proof (state)\nthis:\n  integral\\<^sup>N (lborel \\<Otimes>\\<^sub>M lborel)\n   (indicator (buffon_set' l d)) =\n  \\<integral>\\<^sup>+ \\<phi>.\n                       \\<integral>\\<^sup>+ x.\n      indicator (buffon_set' l d) (x, \\<phi>)\n    \\<partial>lborel\n                     \\<partial>lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "also"], ["proof (state)\nthis:\n  integral\\<^sup>N (lborel \\<Otimes>\\<^sub>M lborel)\n   (indicator (buffon_set' l d)) =\n  \\<integral>\\<^sup>+ \\<phi>.\n                       \\<integral>\\<^sup>+ x.\n      indicator (buffon_set' l d) (x, \\<phi>)\n    \\<partial>lborel\n                     \\<partial>lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "have \"\\<dots> = (\\<integral>\\<^sup>+\\<phi>. \\<integral>\\<^sup>+x. indicator {0..pi} \\<phi> * indicator {max 0 (d/2 - sin \\<phi> * l / 2) .. d/2} x \\<partial>lborel \\<partial>lborel)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ \\<phi>.\n                         \\<integral>\\<^sup>+ x.\n        indicator (buffon_set' l d) (x, \\<phi>)\n      \\<partial>lborel\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ \\<phi>.\n                         (\\<integral>\\<^sup>+x\\<in>{max 0\n               (d / 2 - sin \\<phi> * l / 2)..d / 2}.\n       indicator {0..pi} \\<phi>\n                          \\<partial>lborel)\n                       \\<partial>lborel", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ \\<phi>.\n                         \\<integral>\\<^sup>+ x.\n        indicator (buffon_set' l d) (x, \\<phi>)\n      \\<partial>lborel\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ \\<phi>.\n                         (\\<integral>\\<^sup>+x\\<in>{max 0\n               (d / 2 - sin \\<phi> * l / 2)..d / 2}.\n       indicator {0..pi} \\<phi>\n                          \\<partial>lborel)\n                       \\<partial>lborel", "by (intro nn_integral_cong) (auto simp: indicator_def field_simps buffon_set'_def)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ \\<phi>.\n                       \\<integral>\\<^sup>+ x.\n      indicator (buffon_set' l d) (x, \\<phi>)\n    \\<partial>lborel\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ \\<phi>.\n                       (\\<integral>\\<^sup>+x\\<in>{max 0\n             (d / 2 - sin \\<phi> * l / 2)..d / 2}.\n     indicator {0..pi} \\<phi>\n                        \\<partial>lborel)\n                     \\<partial>lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ \\<phi>.\n                       \\<integral>\\<^sup>+ x.\n      indicator (buffon_set' l d) (x, \\<phi>)\n    \\<partial>lborel\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ \\<phi>.\n                       (\\<integral>\\<^sup>+x\\<in>{max 0\n             (d / 2 - sin \\<phi> * l / 2)..d / 2}.\n     indicator {0..pi} \\<phi>\n                        \\<partial>lborel)\n                     \\<partial>lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "have \"\\<dots> = \\<integral>\\<^sup>+ \\<phi>. indicator {0..pi} \\<phi> * emeasure lborel {max 0 (d / 2 - sin \\<phi> * l / 2)..d / 2} \\<partial>lborel\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ \\<phi>.\n                         (\\<integral>\\<^sup>+x\\<in>{max 0\n               (d / 2 - sin \\<phi> * l / 2)..d / 2}.\n       indicator {0..pi} \\<phi>\n                          \\<partial>lborel)\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ \\<phi>.\n                         indicator {0..pi} \\<phi> *\n                         emeasure lborel\n                          {max 0 (d / 2 - sin \\<phi> * l / 2)..d / 2}\n                       \\<partial>lborel", "by (subst nn_integral_cmult) simp_all"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ \\<phi>.\n                       (\\<integral>\\<^sup>+x\\<in>{max 0\n             (d / 2 - sin \\<phi> * l / 2)..d / 2}.\n     indicator {0..pi} \\<phi>\n                        \\<partial>lborel)\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ \\<phi>.\n                       indicator {0..pi} \\<phi> *\n                       emeasure lborel\n                        {max 0 (d / 2 - sin \\<phi> * l / 2)..d / 2}\n                     \\<partial>lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ \\<phi>.\n                       (\\<integral>\\<^sup>+x\\<in>{max 0\n             (d / 2 - sin \\<phi> * l / 2)..d / 2}.\n     indicator {0..pi} \\<phi>\n                        \\<partial>lborel)\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ \\<phi>.\n                       indicator {0..pi} \\<phi> *\n                       emeasure lborel\n                        {max 0 (d / 2 - sin \\<phi> * l / 2)..d / 2}\n                     \\<partial>lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "have \"\\<dots> = \\<integral>\\<^sup>+ \\<phi>. ennreal (indicator {0..pi} \\<phi> * min (d / 2) (sin \\<phi> * l / 2)) \\<partial>lborel\"\n    (is \"_ = ?I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ \\<phi>.\n                         indicator {0..pi} \\<phi> *\n                         emeasure lborel\n                          {max 0 (d / 2 - sin \\<phi> * l / 2)..d / 2}\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ \\<phi>.\n                         ennreal\n                          (indicat_real {0..pi} \\<phi> *\n                           min (d / 2) (sin \\<phi> * l / 2))\n                       \\<partial>lborel", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ \\<phi>.\n                         indicator {0..pi} \\<phi> *\n                         emeasure lborel\n                          {max 0 (d / 2 - sin \\<phi> * l / 2)..d / 2}\n                       \\<partial>lborel =\n    \\<integral>\\<^sup>+ \\<phi>.\n                         ennreal\n                          (indicat_real {0..pi} \\<phi> *\n                           min (d / 2) (sin \\<phi> * l / 2))\n                       \\<partial>lborel", "by (intro nn_integral_cong) (auto simp: indicator_def sin_ge_zero max_def min_def)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ \\<phi>.\n                       indicator {0..pi} \\<phi> *\n                       emeasure lborel\n                        {max 0 (d / 2 - sin \\<phi> * l / 2)..d / 2}\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ \\<phi>.\n                       ennreal\n                        (indicat_real {0..pi} \\<phi> *\n                         min (d / 2) (sin \\<phi> * l / 2))\n                     \\<partial>lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ \\<phi>.\n                       indicator {0..pi} \\<phi> *\n                       emeasure lborel\n                        {max 0 (d / 2 - sin \\<phi> * l / 2)..d / 2}\n                     \\<partial>lborel =\n  \\<integral>\\<^sup>+ \\<phi>.\n                       ennreal\n                        (indicat_real {0..pi} \\<phi> *\n                         min (d / 2) (sin \\<phi> * l / 2))\n                     \\<partial>lborel\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "have \"integrable lborel (\\<lambda>\\<phi>. (d / 2) * indicator {0..pi} \\<phi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integrable lborel (\\<lambda>\\<phi>. d / 2 * indicat_real {0..pi} \\<phi>)", "by simp"], ["proof (state)\nthis:\n  integrable lborel (\\<lambda>\\<phi>. d / 2 * indicat_real {0..pi} \\<phi>)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "hence int: \"integrable lborel (\\<lambda>\\<phi>. indicator {0..pi} \\<phi> * min (d / 2) (sin \\<phi> * l / 2))\""], ["proof (prove)\nusing this:\n  integrable lborel (\\<lambda>\\<phi>. d / 2 * indicat_real {0..pi} \\<phi>)\n\ngoal (1 subgoal):\n 1. integrable lborel\n     (\\<lambda>\\<phi>.\n         indicat_real {0..pi} \\<phi> * min (d / 2) (sin \\<phi> * l / 2))", "by (rule Bochner_Integration.integrable_bound)\n       (insert l d, auto intro!: AE_I2 simp: indicator_def min_def sin_ge_zero)"], ["proof (state)\nthis:\n  integrable lborel\n   (\\<lambda>\\<phi>.\n       indicat_real {0..pi} \\<phi> * min (d / 2) (sin \\<phi> * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "hence \"?I = set_lebesgue_integral lborel {0..pi} (\\<lambda>\\<phi>. min (d / 2) (sin \\<phi> * l / 2))\""], ["proof (prove)\nusing this:\n  integrable lborel\n   (\\<lambda>\\<phi>.\n       indicat_real {0..pi} \\<phi> * min (d / 2) (sin \\<phi> * l / 2))\n\ngoal (1 subgoal):\n 1. \\<integral>\\<^sup>+ \\<phi>.\n                         ennreal\n                          (indicat_real {0..pi} \\<phi> *\n                           min (d / 2) (sin \\<phi> * l / 2))\n                       \\<partial>lborel =\n    ennreal (LBINT \\<phi>:{0..pi}. min (d / 2) (sin \\<phi> * l / 2))", "by (subst nn_integral_eq_integral, assumption)\n       (insert d l, auto intro!: AE_I2 simp: sin_ge_zero min_def indicator_def set_lebesgue_integral_def)"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ \\<phi>.\n                       ennreal\n                        (indicat_real {0..pi} \\<phi> *\n                         min (d / 2) (sin \\<phi> * l / 2))\n                     \\<partial>lborel =\n  ennreal (LBINT \\<phi>:{0..pi}. min (d / 2) (sin \\<phi> * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "also"], ["proof (state)\nthis:\n  \\<integral>\\<^sup>+ \\<phi>.\n                       ennreal\n                        (indicat_real {0..pi} \\<phi> *\n                         min (d / 2) (sin \\<phi> * l / 2))\n                     \\<partial>lborel =\n  ennreal (LBINT \\<phi>:{0..pi}. min (d / 2) (sin \\<phi> * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "have \"\\<dots> = ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\"\n    (is \"_ = ennreal ?I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (LBINT \\<phi>:{0..pi}. min (d / 2) (sin \\<phi> * l / 2)) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "using int"], ["proof (prove)\nusing this:\n  integrable lborel\n   (\\<lambda>\\<phi>.\n       indicat_real {0..pi} \\<phi> * min (d / 2) (sin \\<phi> * l / 2))\n\ngoal (1 subgoal):\n 1. ennreal (LBINT \\<phi>:{0..pi}. min (d / 2) (sin \\<phi> * l / 2)) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "by (subst set_borel_integral_eq_integral) (simp_all add: set_integrable_def)"], ["proof (state)\nthis:\n  ennreal (LBINT \\<phi>:{0..pi}. min (d / 2) (sin \\<phi> * l / 2)) =\n  ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "finally"], ["proof (chain)\npicking this:\n  emeasure (lborel \\<Otimes>\\<^sub>M lborel) (buffon_set' l d) =\n  ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure (lborel \\<Otimes>\\<^sub>M lborel) (buffon_set' l d) =\n  ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "by (simp add: lborel_prod)"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) =\n  ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  We now have to distinguish two cases: The first and easier one is that where the length \n  of the needle, $l$, is less than or equal to the strip width, $d$:\n\\<close>"], ["", "context\n  assumes l_le_d: \"l \\<le> d\"\nbegin"], ["", "lemma emeasure_buffon_set'_short: \"emeasure lborel (buffon_set' l d) = ennreal l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "have \"emeasure lborel (buffon_set' l d) =\n          ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\" (is \"_ = ennreal ?I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "by (rule emeasure_buffon_set')"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) =\n  ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "also"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) =\n  ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "have *: \"sin \\<phi> * l \\<le> d\" if \"\\<phi> \\<ge> 0\" \"\\<phi> \\<le> pi\" for \\<phi>"], ["proof (prove)\ngoal (1 subgoal):\n 1. sin \\<phi> * l \\<le> d", "using mult_mono[OF l_le_d sin_le_one _ sin_ge_zero] that d"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> d; 0 \\<le> ?x1; ?x1 \\<le> pi\\<rbrakk>\n  \\<Longrightarrow> l * sin ?x1 \\<le> d * 1\n  0 \\<le> \\<phi>\n  \\<phi> \\<le> pi\n  0 < d\n\ngoal (1 subgoal):\n 1. sin \\<phi> * l \\<le> d", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?\\<phi>; ?\\<phi> \\<le> pi\\<rbrakk>\n  \\<Longrightarrow> sin ?\\<phi> * l \\<le> d\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "have \"?I = integral {0..pi} (\\<lambda>x. (l / 2) * sin x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {0..pi} (\\<lambda>x. l / 2 * sin x)", "using l d l_le_d"], ["proof (prove)\nusing this:\n  0 < l\n  0 < d\n  l \\<le> d\n\ngoal (1 subgoal):\n 1. integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {0..pi} (\\<lambda>x. l / 2 * sin x)", "by (intro integral_cong) (auto dest: * simp: min_def sin_ge_zero)"], ["proof (state)\nthis:\n  integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {0..pi} (\\<lambda>x. l / 2 * sin x)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "also"], ["proof (state)\nthis:\n  integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {0..pi} (\\<lambda>x. l / 2 * sin x)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "have \"\\<dots> = l / 2 * integral {0..pi} sin\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..pi} (\\<lambda>x. l / 2 * sin x) =\n    l / 2 * integral {0..pi} sin", "by simp"], ["proof (state)\nthis:\n  integral {0..pi} (\\<lambda>x. l / 2 * sin x) =\n  l / 2 * integral {0..pi} sin\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "also"], ["proof (state)\nthis:\n  integral {0..pi} (\\<lambda>x. l / 2 * sin x) =\n  l / 2 * integral {0..pi} sin\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "have \"(sin has_integral (-cos pi - (- cos 0))) {0..pi}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (sin has_integral - cos pi - - cos 0) {0..pi}", "by (intro fundamental_theorem_of_calculus)\n       (auto intro!: derivative_eq_intros simp: has_field_derivative_iff_has_vector_derivative [symmetric])"], ["proof (state)\nthis:\n  (sin has_integral - cos pi - - cos 0) {0..pi}\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "hence \"integral {0..pi} sin = -cos pi - (-cos 0)\""], ["proof (prove)\nusing this:\n  (sin has_integral - cos pi - - cos 0) {0..pi}\n\ngoal (1 subgoal):\n 1. integral {0..pi} sin = - cos pi - - cos 0", "by (simp add: has_integral_iff)"], ["proof (state)\nthis:\n  integral {0..pi} sin = - cos pi - - cos 0\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "finally"], ["proof (chain)\npicking this:\n  emeasure lborel (buffon_set' l d) = ennreal (l / 2 * (- cos pi - - cos 0))", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure lborel (buffon_set' l d) = ennreal (l / 2 * (- cos pi - - cos 0))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) = ennreal l", "by (simp add: lborel_prod)"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) = ennreal l\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma emeasure_buffon_set_short: \"emeasure lborel (buffon_set l d) = 4 * ennreal l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) = 4 * ennreal l", "by (simp add: emeasure_buffon_set_conv_buffon_set' emeasure_buffon_set'_short l_le_d)"], ["", "theorem buffon_short: \"emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "have \"emeasure (buffon l d) {True} = ennreal (4 * l) / ennreal (2 * d * pi)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (4 * l) / ennreal (2 * d * pi)", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (4 * l) / ennreal (2 * d * pi)", "by (subst buffon_prob_aux) (simp add: emeasure_buffon_set_short ennreal_mult)"], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} = ennreal (4 * l) / ennreal (2 * d * pi)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "also"], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} = ennreal (4 * l) / ennreal (2 * d * pi)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "have \"\\<dots> = ennreal (4 * l / (2 * d * pi))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal (4 * l) / ennreal (2 * d * pi) = ennreal (4 * l / (2 * d * pi))", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. ennreal (4 * l) / ennreal (2 * d * pi) = ennreal (4 * l / (2 * d * pi))", "by (subst divide_ennreal) simp_all"], ["proof (state)\nthis:\n  ennreal (4 * l) / ennreal (2 * d * pi) = ennreal (4 * l / (2 * d * pi))\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "also"], ["proof (state)\nthis:\n  ennreal (4 * l) / ennreal (2 * d * pi) = ennreal (4 * l / (2 * d * pi))\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "have \"4 * l / (2 * d * pi) = 2 * l / (d * pi)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 4 * l / (2 * d * pi) = 2 * l / (d * pi)", "by simp"], ["proof (state)\nthis:\n  4 * l / (2 * d * pi) = 2 * l / (d * pi)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "finally"], ["proof (chain)\npicking this:\n  emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))", "."], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} = ennreal (2 * l / (d * pi))\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "text \\<open>\n  The other case where the needle is at least as long as the strip width is more complicated:\n\\<close>"], ["", "context\n  assumes l_ge_d: \"l \\<ge> d\"\nbegin"], ["", "lemma emeasure_buffon_set'_long: \n  \"emeasure lborel (buffon_set' l d) =\n     ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "define \\<phi>' where \"\\<phi>' = arcsin (d / l)\""], ["proof (state)\nthis:\n  \\<phi>' = arcsin (d / l)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \\<phi>'_nonneg: \"\\<phi>' \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> \\<phi>'", "unfolding \\<phi>'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> arcsin (d / l)", "using d l l_ge_d arcsin_le_mono[of 0 \"d/l\"]"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n  d \\<le> l\n  \\<lbrakk>\\<bar>0\\<bar> \\<le> 1; \\<bar>d / l\\<bar> \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> (arcsin 0 \\<le> arcsin (d / l)) = (0 \\<le> d / l)\n\ngoal (1 subgoal):\n 1. 0 \\<le> arcsin (d / l)", "by (simp add: \\<phi>'_def)"], ["proof (state)\nthis:\n  0 \\<le> \\<phi>'\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \\<phi>'_le: \"\\<phi>' \\<le> pi / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<phi>' \\<le> pi / 2", "unfolding \\<phi>'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. arcsin (d / l) \\<le> pi / 2", "using arcsin_bounded[of \"d/l\"] d l l_ge_d"], ["proof (prove)\nusing this:\n  \\<lbrakk>- 1 \\<le> d / l; d / l \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> - (pi / 2) \\<le> arcsin (d / l) \\<and>\n                    arcsin (d / l) \\<le> pi / 2\n  0 < d\n  0 < l\n  d \\<le> l\n\ngoal (1 subgoal):\n 1. arcsin (d / l) \\<le> pi / 2", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  \\<phi>' \\<le> pi / 2\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have ge_phi': \"sin \\<phi> \\<ge> d / l\" if \"\\<phi> \\<ge> \\<phi>'\" \"\\<phi> \\<le> pi / 2\" for \\<phi>"], ["proof (prove)\ngoal (1 subgoal):\n 1. d / l \\<le> sin \\<phi>", "using arcsin_le_iff[of \"d / l\" \"\\<phi>\"] d l_ge_d that \\<phi>'_nonneg"], ["proof (prove)\nusing this:\n  \\<lbrakk>- 1 \\<le> d / l; d / l \\<le> 1; - pi / 2 \\<le> \\<phi>;\n   \\<phi> \\<le> pi / 2\\<rbrakk>\n  \\<Longrightarrow> (arcsin (d / l) \\<le> \\<phi>) = (d / l \\<le> sin \\<phi>)\n  0 < d\n  d \\<le> l\n  \\<phi>' \\<le> \\<phi>\n  \\<phi> \\<le> pi / 2\n  0 \\<le> \\<phi>'\n\ngoal (1 subgoal):\n 1. d / l \\<le> sin \\<phi>", "by (auto simp: \\<phi>'_def field_simps)"], ["proof (state)\nthis:\n  \\<lbrakk>\\<phi>' \\<le> ?\\<phi>; ?\\<phi> \\<le> pi / 2\\<rbrakk>\n  \\<Longrightarrow> d / l \\<le> sin ?\\<phi>\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have le_phi': \"sin \\<phi> \\<le> d / l\" if \"\\<phi> \\<le> \\<phi>'\" \"\\<phi> \\<ge> 0\" for \\<phi>"], ["proof (prove)\ngoal (1 subgoal):\n 1. sin \\<phi> \\<le> d / l", "using le_arcsin_iff[of \"d / l\" \"\\<phi>\"] d l_ge_d that \\<phi>'_le"], ["proof (prove)\nusing this:\n  \\<lbrakk>- 1 \\<le> d / l; d / l \\<le> 1; - pi / 2 \\<le> \\<phi>;\n   \\<phi> \\<le> pi / 2\\<rbrakk>\n  \\<Longrightarrow> (\\<phi> \\<le> arcsin (d / l)) = (sin \\<phi> \\<le> d / l)\n  0 < d\n  d \\<le> l\n  \\<phi> \\<le> \\<phi>'\n  0 \\<le> \\<phi>\n  \\<phi>' \\<le> pi / 2\n\ngoal (1 subgoal):\n 1. sin \\<phi> \\<le> d / l", "by (auto simp: \\<phi>'_def field_simps)"], ["proof (state)\nthis:\n  \\<lbrakk>?\\<phi> \\<le> \\<phi>'; 0 \\<le> ?\\<phi>\\<rbrakk>\n  \\<Longrightarrow> sin ?\\<phi> \\<le> d / l\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "let ?f = \"(\\<lambda>x. min (d / 2) (sin x * l / 2))\""], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"emeasure lborel (buffon_set' l d) = ennreal (integral {0..pi} ?f)\" (is \"_ = ennreal ?I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))", "by (rule emeasure_buffon_set')"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) =\n  ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) =\n  ennreal (integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"?I = integral {0..pi/2} ?f + integral {pi/2..pi} ?f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n    integral {pi / 2..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2))", "by (rule Henstock_Kurzweil_Integration.integral_combine [symmetric]) (auto intro!: integrable_continuous_real continuous_intros)"], ["proof (state)\nthis:\n  integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n  integral {pi / 2..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {0..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n  integral {pi / 2..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"integral {pi/2..pi} ?f = integral {-pi/2..0} (?f \\<circ> (\\<lambda>\\<phi>. \\<phi> + pi))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {pi / 2..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {- pi / 2..0}\n     ((\\<lambda>x. min (d / 2) (sin x * l / 2)) \\<circ>\n      (\\<lambda>\\<phi>. \\<phi> + pi))", "by (subst integral_shift) (auto intro!: continuous_intros)"], ["proof (state)\nthis:\n  integral {pi / 2..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {- pi / 2..0}\n   ((\\<lambda>x. min (d / 2) (sin x * l / 2)) \\<circ>\n    (\\<lambda>\\<phi>. \\<phi> + pi))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {pi / 2..pi} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {- pi / 2..0}\n   ((\\<lambda>x. min (d / 2) (sin x * l / 2)) \\<circ>\n    (\\<lambda>\\<phi>. \\<phi> + pi))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"\\<dots> = integral {-(pi/2)..-0} (\\<lambda>x. min (d / 2) (sin (-x) * l / 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {- pi / 2..0}\n     ((\\<lambda>x. min (d / 2) (sin x * l / 2)) \\<circ>\n      (\\<lambda>\\<phi>. \\<phi> + pi)) =\n    integral {- (pi / 2)..- 0} (\\<lambda>x. min (d / 2) (sin (- x) * l / 2))", "by (simp add: o_def)"], ["proof (state)\nthis:\n  integral {- pi / 2..0}\n   ((\\<lambda>x. min (d / 2) (sin x * l / 2)) \\<circ>\n    (\\<lambda>\\<phi>. \\<phi> + pi)) =\n  integral {- (pi / 2)..- 0} (\\<lambda>x. min (d / 2) (sin (- x) * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {- pi / 2..0}\n   ((\\<lambda>x. min (d / 2) (sin x * l / 2)) \\<circ>\n    (\\<lambda>\\<phi>. \\<phi> + pi)) =\n  integral {- (pi / 2)..- 0} (\\<lambda>x. min (d / 2) (sin (- x) * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"\\<dots> = integral {0..pi/2} ?f\" (is \"_ = ?I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {- (pi / 2)..- 0}\n     (\\<lambda>x. min (d / 2) (sin (- x) * l / 2)) =\n    integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))", "by (subst Henstock_Kurzweil_Integration.integral_reflect_real) simp_all"], ["proof (state)\nthis:\n  integral {- (pi / 2)..- 0} (\\<lambda>x. min (d / 2) (sin (- x) * l / 2)) =\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {- (pi / 2)..- 0} (\\<lambda>x. min (d / 2) (sin (- x) * l / 2)) =\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"\\<dots> + \\<dots> = 2 * \\<dots>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n    integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    2 * integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))", "by simp"], ["proof (state)\nthis:\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  2 * integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  2 * integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"?I = integral {0..\\<phi>'} ?f + integral {\\<phi>'..pi/2} ?f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {0..\\<phi>'} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n    integral {\\<phi>'..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))", "using l d l_ge_d \\<phi>'_nonneg \\<phi>'_le"], ["proof (prove)\nusing this:\n  0 < l\n  0 < d\n  d \\<le> l\n  0 \\<le> \\<phi>'\n  \\<phi>' \\<le> pi / 2\n\ngoal (1 subgoal):\n 1. integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {0..\\<phi>'} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n    integral {\\<phi>'..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))", "by (intro Henstock_Kurzweil_Integration.integral_combine [symmetric]) (auto intro!: integrable_continuous_real continuous_intros)"], ["proof (state)\nthis:\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {0..\\<phi>'} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n  integral {\\<phi>'..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {0..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {0..\\<phi>'} (\\<lambda>x. min (d / 2) (sin x * l / 2)) +\n  integral {\\<phi>'..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2))\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"integral {0..\\<phi>'} ?f = integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..\\<phi>'} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x)", "using l"], ["proof (prove)\nusing this:\n  0 < l\n\ngoal (1 subgoal):\n 1. integral {0..\\<phi>'} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x)", "by (intro integral_cong) (auto simp: min_def field_simps dest: le_phi')"], ["proof (state)\nthis:\n  integral {0..\\<phi>'} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {0..\\<phi>'} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"((\\<lambda>x. l / 2 * sin x) has_integral (- (l / 2 * cos \\<phi>') - (- (l / 2 * cos 0)))) {0..\\<phi>'}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. l / 2 * sin x) has_integral\n     - (l / 2 * cos \\<phi>') - - (l / 2 * cos 0))\n     {0..\\<phi>'}", "using \\<phi>'_nonneg"], ["proof (prove)\nusing this:\n  0 \\<le> \\<phi>'\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. l / 2 * sin x) has_integral\n     - (l / 2 * cos \\<phi>') - - (l / 2 * cos 0))\n     {0..\\<phi>'}", "by (intro fundamental_theorem_of_calculus)\n       (auto simp: has_field_derivative_iff_has_vector_derivative [symmetric] intro!: derivative_eq_intros)"], ["proof (state)\nthis:\n  ((\\<lambda>x. l / 2 * sin x) has_integral\n   - (l / 2 * cos \\<phi>') - - (l / 2 * cos 0))\n   {0..\\<phi>'}\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "hence \"integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x) = (1 - cos \\<phi>') * l / 2\""], ["proof (prove)\nusing this:\n  ((\\<lambda>x. l / 2 * sin x) has_integral\n   - (l / 2 * cos \\<phi>') - - (l / 2 * cos 0))\n   {0..\\<phi>'}\n\ngoal (1 subgoal):\n 1. integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x) =\n    (1 - cos \\<phi>') * l / 2", "by (simp add: has_integral_iff algebra_simps)"], ["proof (state)\nthis:\n  integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x) =\n  (1 - cos \\<phi>') * l / 2\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {0..\\<phi>'} (\\<lambda>x. l / 2 * sin x) =\n  (1 - cos \\<phi>') * l / 2\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"integral {\\<phi>'..pi/2} ?f = integral {\\<phi>'..pi/2} (\\<lambda>_. d / 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {\\<phi>'..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {\\<phi>'..pi / 2} (\\<lambda>_. d / 2)", "using l"], ["proof (prove)\nusing this:\n  0 < l\n\ngoal (1 subgoal):\n 1. integral {\\<phi>'..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n    integral {\\<phi>'..pi / 2} (\\<lambda>_. d / 2)", "by (intro integral_cong) (auto simp: min_def field_simps dest: ge_phi')"], ["proof (state)\nthis:\n  integral {\\<phi>'..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {\\<phi>'..pi / 2} (\\<lambda>_. d / 2)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {\\<phi>'..pi / 2} (\\<lambda>x. min (d / 2) (sin x * l / 2)) =\n  integral {\\<phi>'..pi / 2} (\\<lambda>_. d / 2)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"\\<dots> = arccos (d / l) * d / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {\\<phi>'..pi / 2} (\\<lambda>_. d / 2) = arccos (d / l) * d / 2", "using \\<phi>'_le d l l_ge_d"], ["proof (prove)\nusing this:\n  \\<phi>' \\<le> pi / 2\n  0 < d\n  0 < l\n  d \\<le> l\n\ngoal (1 subgoal):\n 1. integral {\\<phi>'..pi / 2} (\\<lambda>_. d / 2) = arccos (d / l) * d / 2", "by (subst arccos_arcsin_eq) (auto simp: field_simps \\<phi>'_def)"], ["proof (state)\nthis:\n  integral {\\<phi>'..pi / 2} (\\<lambda>_. d / 2) = arccos (d / l) * d / 2\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  integral {\\<phi>'..pi / 2} (\\<lambda>_. d / 2) = arccos (d / l) * d / 2\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"cos \\<phi>' = sqrt (1 - (d / l)^2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cos \\<phi>' = sqrt (1 - (d / l)\\<^sup>2)", "unfolding \\<phi>'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. cos (arcsin (d / l)) = sqrt (1 - (d / l)\\<^sup>2)", "by (rule cos_arcsin) (insert d l l_ge_d, auto simp: field_simps)"], ["proof (state)\nthis:\n  cos \\<phi>' = sqrt (1 - (d / l)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "also"], ["proof (state)\nthis:\n  cos \\<phi>' = sqrt (1 - (d / l)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "have \"2 * ((1 - sqrt (1 - (d / l)\\<^sup>2)) * l / 2 + arccos (d / l) * d / 2) = \n               l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 *\n    ((1 - sqrt (1 - (d / l)\\<^sup>2)) * l / 2 + arccos (d / l) * d / 2) =\n    l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. 2 *\n    ((1 - sqrt (1 - (d / l)\\<^sup>2)) * l / 2 + arccos (d / l) * d / 2) =\n    l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  2 * ((1 - sqrt (1 - (d / l)\\<^sup>2)) * l / 2 + arccos (d / l) * d / 2) =\n  l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "finally"], ["proof (chain)\npicking this:\n  emeasure lborel (buffon_set' l d) =\n  ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure lborel (buffon_set' l d) =\n  ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)\n\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set' l d) =\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "."], ["proof (state)\nthis:\n  emeasure lborel (buffon_set' l d) =\n  ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma emeasure_buffon_set_long: \"emeasure lborel (buffon_set l d) = \n        4 * ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure lborel (buffon_set l d) =\n    4 * ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d)", "by (simp add: emeasure_buffon_set_conv_buffon_set' emeasure_buffon_set'_long l_ge_d)"], ["", "theorem buffon_long: \n  \"emeasure (buffon l d) {True} = \n     ennreal (2 / pi * ((l / d) - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "have *: \"l * sqrt ((l\\<^sup>2 - d\\<^sup>2) / l\\<^sup>2) + 0 \\<le> l + d * arccos (d / l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l * sqrt ((l\\<^sup>2 - d\\<^sup>2) / l\\<^sup>2) + 0\n    \\<le> l + d * arccos (d / l)", "using d l_ge_d"], ["proof (prove)\nusing this:\n  0 < d\n  d \\<le> l\n\ngoal (1 subgoal):\n 1. l * sqrt ((l\\<^sup>2 - d\\<^sup>2) / l\\<^sup>2) + 0\n    \\<le> l + d * arccos (d / l)", "by (intro add_mono mult_nonneg_nonneg arccos_lbound) (auto simp: field_simps)"], ["proof (state)\nthis:\n  l * sqrt ((l\\<^sup>2 - d\\<^sup>2) / l\\<^sup>2) + 0\n  \\<le> l + d * arccos (d / l)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "have \"emeasure (buffon l d) {True} = \n          ennreal (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) / ennreal (2 * d * pi)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal\n     (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n    ennreal (2 * d * pi)", "using d l l_ge_d *"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n  d \\<le> l\n  l * sqrt ((l\\<^sup>2 - d\\<^sup>2) / l\\<^sup>2) + 0\n  \\<le> l + d * arccos (d / l)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal\n     (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n    ennreal (2 * d * pi)", "unfolding buffon_prob_aux emeasure_buffon_set_long ennreal_numeral [symmetric]"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n  d \\<le> l\n  l * sqrt ((l\\<^sup>2 - d\\<^sup>2) / l\\<^sup>2) + 0\n  \\<le> l + d * arccos (d / l)\n\ngoal (1 subgoal):\n 1. ennreal 4 *\n    ennreal (l * (1 - sqrt (1 - (d / l)\\<^sup>2)) + arccos (d / l) * d) /\n    ennreal (2 * d * pi) =\n    ennreal\n     (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n    ennreal (2 * d * pi)", "by (subst ennreal_mult [symmetric])\n       (auto intro!: add_nonneg_nonneg mult_nonneg_nonneg simp: field_simps)"], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} =\n  ennreal (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n  ennreal (2 * d * pi)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "also"], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} =\n  ennreal (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n  ennreal (2 * d * pi)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "have \"\\<dots> = ennreal ((4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) / (2 * d * pi))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ennreal\n     (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n    ennreal (2 * d * pi) =\n    ennreal\n     (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d) /\n      (2 * d * pi))", "using d l *"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n  l * sqrt ((l\\<^sup>2 - d\\<^sup>2) / l\\<^sup>2) + 0\n  \\<le> l + d * arccos (d / l)\n\ngoal (1 subgoal):\n 1. ennreal\n     (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n    ennreal (2 * d * pi) =\n    ennreal\n     (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d) /\n      (2 * d * pi))", "by (subst divide_ennreal) (auto simp: field_simps)"], ["proof (state)\nthis:\n  ennreal (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n  ennreal (2 * d * pi) =\n  ennreal\n   (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d) /\n    (2 * d * pi))\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "also"], ["proof (state)\nthis:\n  ennreal (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) /\n  ennreal (2 * d * pi) =\n  ennreal\n   (4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d) /\n    (2 * d * pi))\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "have \"(4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d)) / (2 * d * pi) =\n               2 / pi * (l / d - l / d * sqrt ((d / l)^2 * ((l / d)^2 - 1)) + arccos (d / l))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d) /\n    (2 * d * pi) =\n    2 / pi *\n    (l / d - l / d * sqrt ((d / l)\\<^sup>2 * ((l / d)\\<^sup>2 - 1)) +\n     arccos (d / l))", "using d l"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n\ngoal (1 subgoal):\n 1. 4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d) /\n    (2 * d * pi) =\n    2 / pi *\n    (l / d - l / d * sqrt ((d / l)\\<^sup>2 * ((l / d)\\<^sup>2 - 1)) +\n     arccos (d / l))", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d) /\n  (2 * d * pi) =\n  2 / pi *\n  (l / d - l / d * sqrt ((d / l)\\<^sup>2 * ((l / d)\\<^sup>2 - 1)) +\n   arccos (d / l))\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "also"], ["proof (state)\nthis:\n  4 * (l - l * sqrt (1 - (d / l)\\<^sup>2) + arccos (d / l) * d) /\n  (2 * d * pi) =\n  2 / pi *\n  (l / d - l / d * sqrt ((d / l)\\<^sup>2 * ((l / d)\\<^sup>2 - 1)) +\n   arccos (d / l))\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "have \"l / d * sqrt ((d / l)^2 * ((l / d)^2 - 1)) = sqrt ((l / d) ^ 2 - 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l / d * sqrt ((d / l)\\<^sup>2 * ((l / d)\\<^sup>2 - 1)) =\n    sqrt ((l / d)\\<^sup>2 - 1)", "using d l l_ge_d"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n  d \\<le> l\n\ngoal (1 subgoal):\n 1. l / d * sqrt ((d / l)\\<^sup>2 * ((l / d)\\<^sup>2 - 1)) =\n    sqrt ((l / d)\\<^sup>2 - 1)", "unfolding real_sqrt_mult real_sqrt_abs"], ["proof (prove)\nusing this:\n  0 < d\n  0 < l\n  d \\<le> l\n\ngoal (1 subgoal):\n 1. l / d * (\\<bar>d / l\\<bar> * sqrt ((l / d)\\<^sup>2 - 1)) =\n    sqrt ((l / d)\\<^sup>2 - 1)", "by simp"], ["proof (state)\nthis:\n  l / d * sqrt ((d / l)\\<^sup>2 * ((l / d)\\<^sup>2 - 1)) =\n  sqrt ((l / d)\\<^sup>2 - 1)\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "finally"], ["proof (chain)\npicking this:\n  emeasure (buffon l d) {True} =\n  ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "show ?thesis"], ["proof (prove)\nusing this:\n  emeasure (buffon l d) {True} =\n  ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))\n\ngoal (1 subgoal):\n 1. emeasure (buffon l d) {True} =\n    ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))", "."], ["proof (state)\nthis:\n  emeasure (buffon l d) {True} =\n  ennreal (2 / pi * (l / d - sqrt ((l / d)\\<^sup>2 - 1) + arccos (d / l)))\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"], ["", "end"]]}