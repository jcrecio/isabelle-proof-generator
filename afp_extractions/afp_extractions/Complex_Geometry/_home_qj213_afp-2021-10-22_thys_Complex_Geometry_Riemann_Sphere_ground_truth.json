{"file_name": "/home/qj213/afp-2021-10-22/thys/Complex_Geometry/Riemann_Sphere.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Complex_Geometry", "problem_names": ["lemma sphere_bounds':\n  assumes \"x*x + y*y + z*z = (1::real)\"\n  shows \"-1 \\<le> x \\<and> x \\<le> 1\"", "lemma sphere_bounds:\n  assumes \"x*x + y*y + z*z = (1::real)\"\n  shows \"-1 \\<le> x \\<and> x \\<le> 1\"  \"-1 \\<le> y \\<and> y \\<le> 1\"  \"-1 \\<le> z \\<and> z \\<le> 1\"", "lemma sphere_params_on_sphere:\n  fixes \\<alpha> \\<beta> :: real\n  assumes \"x = cos \\<alpha> * cos \\<beta>\" and \"y = cos \\<alpha> * sin \\<beta>\" \"z = sin \\<alpha>\"\n  shows \"x*x + y*y + z*z = 1\"", "lemma sphere_params:\n  fixes x y z :: real\n  assumes \"x*x + y*y + z*z = 1\"\n  shows \"x = cos (arcsin z) * cos (atan2 y x) \\<and> y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)\"", "lemma ex_sphere_params:\n  assumes \"x*x + y*y + z*z = 1\"\n  shows \"\\<exists> \\<alpha> \\<beta>. x = cos \\<alpha> * cos \\<beta> \\<and> y = cos \\<alpha> * sin \\<beta> \\<and> z = sin \\<alpha> \\<and> -pi / 2 \\<le> \\<alpha> \\<and> \\<alpha> \\<le> pi / 2 \\<and> -pi \\<le> \\<beta> \\<and> \\<beta> < pi\"", "lemma Re_stereographic:\n  shows \"Re (2 * z / (1 + z * cnj z)) = 2 * Re z / (1 + (cmod z)\\<^sup>2)\"", "lemma Im_stereographic: \n  shows \"Im (2 * z / (1 + z * cnj z)) = 2 * Im z / (1 + (cmod z)\\<^sup>2)\"", "lemma inv_stereographic_on_sphere:\n  assumes \"X = Re (2*z / (1 + z*cnj z))\" and \"Y = Im (2*z / (1 + z*cnj z))\" and \"Z = ((cmod z)\\<^sup>2 - 1) / (1 + (cmod z)\\<^sup>2)\"\n  shows \"X*X + Y*Y + Z*Z = 1\"", "lemma stereographic_North: \n  shows \"stereographic x = \\<infinity>\\<^sub>h \\<longleftrightarrow> x = North\"", "lemma stereographic_inv_stereographic':\n  assumes\n  z: \"z = z1/z2\" and \"z2 \\<noteq> 0\" and\n  X: \"X = Re (2*z / (1 + z*cnj z))\" and Y: \"Y = Im (2*z / (1 + z*cnj z))\" and Z: \"Z = ((cmod z)\\<^sup>2 - 1) / (1 + (cmod z)\\<^sup>2)\"\n  shows \"\\<exists> k. k \\<noteq> 0 \\<and> (X + \\<i>*Y, complex_of_real (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)\"", "lemma stereographic_inv_stereographic [simp]:\n  shows \"stereographic (inv_stereographic w) = w\"", "lemma bij_stereographic:\n  shows \"bij stereographic\"", "lemma inv_stereographic_stereographic [simp]: \n  shows \"inv_stereographic (stereographic x) = x\"", "lemma inv_stereographic_is_inv:\n  shows \"inv_stereographic = inv stereographic\"", "lemma mult_sv_one [simp]:\n  shows \"1 *\\<^sub>s\\<^sub>v\\<^sub>4 x = x\"", "lemma mult_sv_distb [simp]:\n  shows \"x *\\<^sub>s\\<^sub>v\\<^sub>4 (y *\\<^sub>s\\<^sub>v\\<^sub>4 v) = (x*y) *\\<^sub>s\\<^sub>v\\<^sub>4 v\"", "lemma stereographic_circline_inv_stereographic_circline:\n  shows \"stereographic_circline \\<circ> inv_stereographic_circline = id\"", "lemma inv_stereographic_circline_stereographic_circline:\n  \"inv_stereographic_circline \\<circ> stereographic_circline = id\"", "lemma stereographic_sphere_circle_set'':\n  shows \"on_sphere_circle (inv_stereographic_circline H) z \\<longleftrightarrow>\n         on_circline H (stereographic z)\"", "lemma stereographic_sphere_circle_set' [simp]:\n  shows \"stereographic ` sphere_circle_set (inv_stereographic_circline H) =\n         circline_set H\"", "lemma stereographic_sphere_circle_set:\n  shows \"stereographic ` sphere_circle_set H = circline_set (stereographic_circline H)\"", "lemma bij_stereographic_circline:\n  shows \"bij stereographic_circline\"", "lemma bij_inv_stereographic_circline:\n  shows \"bij inv_stereographic_circline\""], "translations": [["", "lemma sphere_bounds':\n  assumes \"x*x + y*y + z*z = (1::real)\"\n  shows \"-1 \\<le> x \\<and> x \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "from assms"], ["proof (chain)\npicking this:\n  x * x + y * y + z * z = 1", "have \"x*x \\<le> 1\""], ["proof (prove)\nusing this:\n  x * x + y * y + z * z = 1\n\ngoal (1 subgoal):\n 1. x * x \\<le> 1", "by (smt real_minus_mult_self_le)"], ["proof (state)\nthis:\n  x * x \\<le> 1\n\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "hence \"x\\<^sup>2 \\<le> 1\\<^sup>2\" \"(- x)\\<^sup>2 \\<le> 1\\<^sup>2\""], ["proof (prove)\nusing this:\n  x * x \\<le> 1\n\ngoal (1 subgoal):\n 1. x\\<^sup>2 \\<le> 1\\<^sup>2 &&& (- x)\\<^sup>2 \\<le> 1\\<^sup>2", "by (auto simp add: power2_eq_square)"], ["proof (state)\nthis:\n  x\\<^sup>2 \\<le> 1\\<^sup>2\n  (- x)\\<^sup>2 \\<le> 1\\<^sup>2\n\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "show \"-1 \\<le> x \\<and> x \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "proof (cases \"x \\<ge> 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 \\<le> x \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1\n 2. \\<not> 0 \\<le> x \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1", "case True"], ["proof (state)\nthis:\n  0 \\<le> x\n\ngoal (2 subgoals):\n 1. 0 \\<le> x \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1\n 2. \\<not> 0 \\<le> x \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1", "thus ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "using \\<open>x\\<^sup>2 \\<le> 1\\<^sup>2\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> x\n  x\\<^sup>2 \\<le> 1\\<^sup>2\n\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "by (smt power2_le_imp_le)"], ["proof (state)\nthis:\n  - 1 \\<le> x \\<and> x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<not> 0 \\<le> x \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> 0 \\<le> x \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1", "case False"], ["proof (state)\nthis:\n  \\<not> 0 \\<le> x\n\ngoal (1 subgoal):\n 1. \\<not> 0 \\<le> x \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<not> 0 \\<le> x\n\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "using \\<open>(-x)\\<^sup>2 \\<le> 1\\<^sup>2\\<close>"], ["proof (prove)\nusing this:\n  \\<not> 0 \\<le> x\n  (- x)\\<^sup>2 \\<le> 1\\<^sup>2\n\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1", "by (smt power2_le_imp_le)"], ["proof (state)\nthis:\n  - 1 \\<le> x \\<and> x \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  - 1 \\<le> x \\<and> x \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma sphere_bounds:\n  assumes \"x*x + y*y + z*z = (1::real)\"\n  shows \"-1 \\<le> x \\<and> x \\<le> 1\"  \"-1 \\<le> y \\<and> y \\<le> 1\"  \"-1 \\<le> z \\<and> z \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1 &&&\n    - 1 \\<le> y \\<and> y \\<le> 1 &&& - 1 \\<le> z \\<and> z \\<le> 1", "using assms"], ["proof (prove)\nusing this:\n  x * x + y * y + z * z = 1\n\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1 &&&\n    - 1 \\<le> y \\<and> y \\<le> 1 &&& - 1 \\<le> z \\<and> z \\<le> 1", "using sphere_bounds'[of x y z] sphere_bounds'[of y x z] sphere_bounds'[of z x y]"], ["proof (prove)\nusing this:\n  x * x + y * y + z * z = 1\n  x * x + y * y + z * z = 1 \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1\n  y * y + x * x + z * z = 1 \\<Longrightarrow> - 1 \\<le> y \\<and> y \\<le> 1\n  z * z + x * x + y * y = 1 \\<Longrightarrow> - 1 \\<le> z \\<and> z \\<le> 1\n\ngoal (1 subgoal):\n 1. - 1 \\<le> x \\<and> x \\<le> 1 &&&\n    - 1 \\<le> y \\<and> y \\<le> 1 &&& - 1 \\<le> z \\<and> z \\<le> 1", "by (auto simp add: field_simps)"], ["", "(* ---------------------------------------------------------------------------- *)"], ["", "subsection \\<open>Parametrization of the unit sphere in polar coordinates\\<close>"], ["", "(* ---------------------------------------------------------------------------- *)"], ["", "lemma sphere_params_on_sphere:\n  fixes \\<alpha> \\<beta> :: real\n  assumes \"x = cos \\<alpha> * cos \\<beta>\" and \"y = cos \\<alpha> * sin \\<beta>\" \"z = sin \\<alpha>\"\n  shows \"x*x + y*y + z*z = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x * x + y * y + z * z = 1", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. x * x + y * y + z * z = 1", "have \"x*x + y*y = (cos \\<alpha> * cos \\<alpha>) * (cos \\<beta> * cos \\<beta>) + (cos \\<alpha> * cos \\<alpha>) * (sin \\<beta> * sin \\<beta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x * x + y * y =\n    cos \\<alpha> * cos \\<alpha> * (cos \\<beta> * cos \\<beta>) +\n    cos \\<alpha> * cos \\<alpha> * (sin \\<beta> * sin \\<beta>)", "using assms"], ["proof (prove)\nusing this:\n  x = cos \\<alpha> * cos \\<beta>\n  y = cos \\<alpha> * sin \\<beta>\n  z = sin \\<alpha>\n\ngoal (1 subgoal):\n 1. x * x + y * y =\n    cos \\<alpha> * cos \\<alpha> * (cos \\<beta> * cos \\<beta>) +\n    cos \\<alpha> * cos \\<alpha> * (sin \\<beta> * sin \\<beta>)", "by simp"], ["proof (state)\nthis:\n  x * x + y * y =\n  cos \\<alpha> * cos \\<alpha> * (cos \\<beta> * cos \\<beta>) +\n  cos \\<alpha> * cos \\<alpha> * (sin \\<beta> * sin \\<beta>)\n\ngoal (1 subgoal):\n 1. x * x + y * y + z * z = 1", "hence \"x*x + y*y = cos \\<alpha> * cos \\<alpha>\""], ["proof (prove)\nusing this:\n  x * x + y * y =\n  cos \\<alpha> * cos \\<alpha> * (cos \\<beta> * cos \\<beta>) +\n  cos \\<alpha> * cos \\<alpha> * (sin \\<beta> * sin \\<beta>)\n\ngoal (1 subgoal):\n 1. x * x + y * y = cos \\<alpha> * cos \\<alpha>", "using sin_cos_squared_add3[of \\<beta>]"], ["proof (prove)\nusing this:\n  x * x + y * y =\n  cos \\<alpha> * cos \\<alpha> * (cos \\<beta> * cos \\<beta>) +\n  cos \\<alpha> * cos \\<alpha> * (sin \\<beta> * sin \\<beta>)\n  cos \\<beta> * cos \\<beta> + sin \\<beta> * sin \\<beta> = 1\n\ngoal (1 subgoal):\n 1. x * x + y * y = cos \\<alpha> * cos \\<alpha>", "by (subst (asm) distrib_left[symmetric]) (simp add: field_simps)"], ["proof (state)\nthis:\n  x * x + y * y = cos \\<alpha> * cos \\<alpha>\n\ngoal (1 subgoal):\n 1. x * x + y * y + z * z = 1", "thus ?thesis"], ["proof (prove)\nusing this:\n  x * x + y * y = cos \\<alpha> * cos \\<alpha>\n\ngoal (1 subgoal):\n 1. x * x + y * y + z * z = 1", "using assms"], ["proof (prove)\nusing this:\n  x * x + y * y = cos \\<alpha> * cos \\<alpha>\n  x = cos \\<alpha> * cos \\<beta>\n  y = cos \\<alpha> * sin \\<beta>\n  z = sin \\<alpha>\n\ngoal (1 subgoal):\n 1. x * x + y * y + z * z = 1", "using sin_cos_squared_add3[of \\<alpha>]"], ["proof (prove)\nusing this:\n  x * x + y * y = cos \\<alpha> * cos \\<alpha>\n  x = cos \\<alpha> * cos \\<beta>\n  y = cos \\<alpha> * sin \\<beta>\n  z = sin \\<alpha>\n  cos \\<alpha> * cos \\<alpha> + sin \\<alpha> * sin \\<alpha> = 1\n\ngoal (1 subgoal):\n 1. x * x + y * y + z * z = 1", "by simp"], ["proof (state)\nthis:\n  x * x + y * y + z * z = 1\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma sphere_params:\n  fixes x y z :: real\n  assumes \"x*x + y*y + z*z = 1\"\n  shows \"x = cos (arcsin z) * cos (atan2 y x) \\<and> y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "proof (cases \"z=1 \\<or> z = -1\")"], ["proof (state)\ngoal (2 subgoals):\n 1. z = 1 \\<or> z = - 1 \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)\n 2. \\<not> (z = 1 \\<or> z = - 1) \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "case True"], ["proof (state)\nthis:\n  z = 1 \\<or> z = - 1\n\ngoal (2 subgoals):\n 1. z = 1 \\<or> z = - 1 \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)\n 2. \\<not> (z = 1 \\<or> z = - 1) \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "hence \"x = 0 \\<and> y = 0\""], ["proof (prove)\nusing this:\n  z = 1 \\<or> z = - 1\n\ngoal (1 subgoal):\n 1. x = 0 \\<and> y = 0", "using assms"], ["proof (prove)\nusing this:\n  z = 1 \\<or> z = - 1\n  x * x + y * y + z * z = 1\n\ngoal (1 subgoal):\n 1. x = 0 \\<and> y = 0", "by auto"], ["proof (state)\nthis:\n  x = 0 \\<and> y = 0\n\ngoal (2 subgoals):\n 1. z = 1 \\<or> z = - 1 \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)\n 2. \\<not> (z = 1 \\<or> z = - 1) \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "thus ?thesis"], ["proof (prove)\nusing this:\n  x = 0 \\<and> y = 0\n\ngoal (1 subgoal):\n 1. x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "using \\<open>z = 1 \\<or> z = -1\\<close>"], ["proof (prove)\nusing this:\n  x = 0 \\<and> y = 0\n  z = 1 \\<or> z = - 1\n\ngoal (1 subgoal):\n 1. x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "by (auto simp add: cos_arcsin)"], ["proof (state)\nthis:\n  x = cos (arcsin z) * cos (atan2 y x) \\<and>\n  y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)\n\ngoal (1 subgoal):\n 1. \\<not> (z = 1 \\<or> z = - 1) \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (z = 1 \\<or> z = - 1) \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "case False"], ["proof (state)\nthis:\n  \\<not> (z = 1 \\<or> z = - 1)\n\ngoal (1 subgoal):\n 1. \\<not> (z = 1 \\<or> z = - 1) \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "hence \"x \\<noteq> 0 \\<or> y \\<noteq> 0\""], ["proof (prove)\nusing this:\n  \\<not> (z = 1 \\<or> z = - 1)\n\ngoal (1 subgoal):\n 1. x \\<noteq> 0 \\<or> y \\<noteq> 0", "using assms"], ["proof (prove)\nusing this:\n  \\<not> (z = 1 \\<or> z = - 1)\n  x * x + y * y + z * z = 1\n\ngoal (1 subgoal):\n 1. x \\<noteq> 0 \\<or> y \\<noteq> 0", "by (auto simp add: square_eq_1_iff)"], ["proof (state)\nthis:\n  x \\<noteq> 0 \\<or> y \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<not> (z = 1 \\<or> z = - 1) \\<Longrightarrow>\n    x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "thus ?thesis"], ["proof (prove)\nusing this:\n  x \\<noteq> 0 \\<or> y \\<noteq> 0\n\ngoal (1 subgoal):\n 1. x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "using real_sqrt_unique[of y \"1 - z*z\"]"], ["proof (prove)\nusing this:\n  x \\<noteq> 0 \\<or> y \\<noteq> 0\n  \\<lbrakk>y\\<^sup>2 = 1 - z * z; 0 \\<le> y\\<rbrakk>\n  \\<Longrightarrow> sqrt (1 - z * z) = y\n\ngoal (1 subgoal):\n 1. x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "using real_sqrt_unique[of \"-y\" \"1 - z*z\"]"], ["proof (prove)\nusing this:\n  x \\<noteq> 0 \\<or> y \\<noteq> 0\n  \\<lbrakk>y\\<^sup>2 = 1 - z * z; 0 \\<le> y\\<rbrakk>\n  \\<Longrightarrow> sqrt (1 - z * z) = y\n  \\<lbrakk>(- y)\\<^sup>2 = 1 - z * z; 0 \\<le> - y\\<rbrakk>\n  \\<Longrightarrow> sqrt (1 - z * z) = - y\n\ngoal (1 subgoal):\n 1. x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "using sphere_bounds[OF assms] assms"], ["proof (prove)\nusing this:\n  x \\<noteq> 0 \\<or> y \\<noteq> 0\n  \\<lbrakk>y\\<^sup>2 = 1 - z * z; 0 \\<le> y\\<rbrakk>\n  \\<Longrightarrow> sqrt (1 - z * z) = y\n  \\<lbrakk>(- y)\\<^sup>2 = 1 - z * z; 0 \\<le> - y\\<rbrakk>\n  \\<Longrightarrow> sqrt (1 - z * z) = - y\n  - 1 \\<le> x \\<and> x \\<le> 1\n  - 1 \\<le> y \\<and> y \\<le> 1\n  - 1 \\<le> z \\<and> z \\<le> 1\n  x * x + y * y + z * z = 1\n\ngoal (1 subgoal):\n 1. x = cos (arcsin z) * cos (atan2 y x) \\<and>\n    y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)", "by (auto simp add: cos_arcsin cos_arctan sin_arctan power2_eq_square field_simps real_sqrt_divide atan2_def)"], ["proof (state)\nthis:\n  x = cos (arcsin z) * cos (atan2 y x) \\<and>\n  y = cos (arcsin z) * sin (atan2 y x) \\<and> z = sin (arcsin z)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ex_sphere_params:\n  assumes \"x*x + y*y + z*z = 1\"\n  shows \"\\<exists> \\<alpha> \\<beta>. x = cos \\<alpha> * cos \\<beta> \\<and> y = cos \\<alpha> * sin \\<beta> \\<and> z = sin \\<alpha> \\<and> -pi / 2 \\<le> \\<alpha> \\<and> \\<alpha> \\<le> pi / 2 \\<and> -pi \\<le> \\<beta> \\<and> \\<beta> < pi\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<alpha> \\<beta>.\n       x = cos \\<alpha> * cos \\<beta> \\<and>\n       y = cos \\<alpha> * sin \\<beta> \\<and>\n       z = sin \\<alpha> \\<and>\n       - pi / 2 \\<le> \\<alpha> \\<and>\n       \\<alpha> \\<le> pi / 2 \\<and> - pi \\<le> \\<beta> \\<and> \\<beta> < pi", "using assms arcsin_bounded[of z] sphere_bounds[of x y z]"], ["proof (prove)\nusing this:\n  x * x + y * y + z * z = 1\n  \\<lbrakk>- 1 \\<le> z; z \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> - (pi / 2) \\<le> arcsin z \\<and> arcsin z \\<le> pi / 2\n  x * x + y * y + z * z = 1 \\<Longrightarrow> - 1 \\<le> x \\<and> x \\<le> 1\n  x * x + y * y + z * z = 1 \\<Longrightarrow> - 1 \\<le> y \\<and> y \\<le> 1\n  x * x + y * y + z * z = 1 \\<Longrightarrow> - 1 \\<le> z \\<and> z \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>\\<alpha> \\<beta>.\n       x = cos \\<alpha> * cos \\<beta> \\<and>\n       y = cos \\<alpha> * sin \\<beta> \\<and>\n       z = sin \\<alpha> \\<and>\n       - pi / 2 \\<le> \\<alpha> \\<and>\n       \\<alpha> \\<le> pi / 2 \\<and> - pi \\<le> \\<beta> \\<and> \\<beta> < pi", "by (rule_tac x=\"arcsin z\" in exI, rule_tac x=\"atan2 y x\" in exI) (simp add: sphere_params arcsin_bounded atan2_bounded)"], ["", "(* ----------------------------------------------------------------- *)"], ["", "subsection \\<open>Stereographic and inverse stereographic projection\\<close>"], ["", "(* ----------------------------------------------------------------- *)"], ["", "text \\<open>Stereographic projection\\<close>"], ["", "definition stereographic_r3_cvec :: \"R3 \\<Rightarrow> complex_vec\" where\n[simp]: \"stereographic_r3_cvec M = (let (x, y, z) =  M in\n     (if (x, y, z) \\<noteq> (0, 0, 1) then\n           (x + \\<i> * y, cor (1 - z))\n      else\n           (1, 0)\n     ))\""], ["", "lift_definition stereographic_r3_hcoords :: \"R3 \\<Rightarrow> complex_homo_coords\" is stereographic_r3_cvec"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>prod. stereographic_r3_cvec prod \\<noteq> vec_zero", "by (auto split: if_split_asm simp add: cor_eq_0)"], ["", "lift_definition stereographic :: \"riemann_sphere \\<Rightarrow> complex_homo\" is stereographic_r3_hcoords"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text \\<open>Inverse stereographic projection\\<close>"], ["", "definition inv_stereographic_cvec_r3 :: \"complex_vec \\<Rightarrow> R3\" where [simp]:\n  \"inv_stereographic_cvec_r3 z = (\n     let (z1, z2) = z\n       in if z2 = 0 then\n              (0, 0, 1)\n          else\n             let z = z1/z2;\n                 X = Re (2*z / (1 + z*cnj z));\n                 Y = Im (2*z / (1 + z*cnj z));\n                 Z = ((cmod z)\\<^sup>2 - 1) / (1 + (cmod z)\\<^sup>2)\n               in (X, Y, Z))\""], ["", "lemma Re_stereographic:\n  shows \"Re (2 * z / (1 + z * cnj z)) = 2 * Re z / (1 + (cmod z)\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Re (2 * z / (1 + z * cnj z)) = 2 * Re z / (1 + (cmod z)\\<^sup>2)", "using one_plus_square_neq_zero"], ["proof (prove)\nusing this:\n  1 + (cor ?x)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. Re (2 * z / (1 + z * cnj z)) = 2 * Re z / (1 + (cmod z)\\<^sup>2)", "by (subst complex_mult_cnj_cmod, subst Re_divide_real) (auto simp add: power2_eq_square)"], ["", "lemma Im_stereographic: \n  shows \"Im (2 * z / (1 + z * cnj z)) = 2 * Im z / (1 + (cmod z)\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Im (2 * z / (1 + z * cnj z)) = 2 * Im z / (1 + (cmod z)\\<^sup>2)", "using one_plus_square_neq_zero"], ["proof (prove)\nusing this:\n  1 + (cor ?x)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. Im (2 * z / (1 + z * cnj z)) = 2 * Im z / (1 + (cmod z)\\<^sup>2)", "by (subst complex_mult_cnj_cmod, subst Im_divide_real) (auto simp add: power2_eq_square)"], ["", "lemma inv_stereographic_on_sphere:\n  assumes \"X = Re (2*z / (1 + z*cnj z))\" and \"Y = Im (2*z / (1 + z*cnj z))\" and \"Z = ((cmod z)\\<^sup>2 - 1) / (1 + (cmod z)\\<^sup>2)\"\n  shows \"X*X + Y*Y + Z*Z = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X * X + Y * Y + Z * Z = 1", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. X * X + Y * Y + Z * Z = 1", "have \"1 + (cmod z)\\<^sup>2 \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + (cmod z)\\<^sup>2 \\<noteq> 0", "by (smt power2_less_0)"], ["proof (state)\nthis:\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. X * X + Y * Y + Z * Z = 1", "thus ?thesis"], ["proof (prove)\nusing this:\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. X * X + Y * Y + Z * Z = 1", "using assms"], ["proof (prove)\nusing this:\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n  X = Re (2 * z / (1 + z * cnj z))\n  Y = Im (2 * z / (1 + z * cnj z))\n  Z = ((cmod z)\\<^sup>2 - 1) / (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. X * X + Y * Y + Z * Z = 1", "by (simp add: Re_stereographic Im_stereographic)\n       (cases z, simp add: power2_eq_square real_sqrt_mult[symmetric] add_divide_distrib[symmetric], simp add: complex_norm power2_eq_square field_simps)"], ["proof (state)\nthis:\n  X * X + Y * Y + Z * Z = 1\n\ngoal:\nNo subgoals!", "qed"], ["", "lift_definition inv_stereographic_hcoords_r3 :: \"complex_homo_coords \\<Rightarrow> R3\" is inv_stereographic_cvec_r3"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lift_definition inv_stereographic :: \"complex_homo \\<Rightarrow> riemann_sphere\" is inv_stereographic_hcoords_r3"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       complex_homo_coords1 \\<approx> complex_homo_coords2 \\<Longrightarrow>\n       inv_stereographic_hcoords_r3 complex_homo_coords1\n       \\<in> unit_sphere \\<and>\n       inv_stereographic_hcoords_r3 complex_homo_coords1 =\n       inv_stereographic_hcoords_r3 complex_homo_coords2", "proof transfer"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       \\<lbrakk>complex_homo_coords1 \\<noteq> vec_zero;\n        complex_homo_coords2 \\<noteq> vec_zero;\n        complex_homo_coords1 \\<approx>\\<^sub>v complex_homo_coords2\\<rbrakk>\n       \\<Longrightarrow> inv_stereographic_cvec_r3 complex_homo_coords1\n                         \\<in> unit_sphere \\<and>\n                         inv_stereographic_cvec_r3 complex_homo_coords1 =\n                         inv_stereographic_cvec_r3 complex_homo_coords2", "fix v v'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       \\<lbrakk>complex_homo_coords1 \\<noteq> vec_zero;\n        complex_homo_coords2 \\<noteq> vec_zero;\n        complex_homo_coords1 \\<approx>\\<^sub>v complex_homo_coords2\\<rbrakk>\n       \\<Longrightarrow> inv_stereographic_cvec_r3 complex_homo_coords1\n                         \\<in> unit_sphere \\<and>\n                         inv_stereographic_cvec_r3 complex_homo_coords1 =\n                         inv_stereographic_cvec_r3 complex_homo_coords2", "assume 1: \"v \\<noteq> vec_zero\" \"v' \\<noteq> vec_zero\" \"v \\<approx>\\<^sub>v v'\""], ["proof (state)\nthis:\n  v \\<noteq> vec_zero\n  v' \\<noteq> vec_zero\n  v \\<approx>\\<^sub>v v'\n\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       \\<lbrakk>complex_homo_coords1 \\<noteq> vec_zero;\n        complex_homo_coords2 \\<noteq> vec_zero;\n        complex_homo_coords1 \\<approx>\\<^sub>v complex_homo_coords2\\<rbrakk>\n       \\<Longrightarrow> inv_stereographic_cvec_r3 complex_homo_coords1\n                         \\<in> unit_sphere \\<and>\n                         inv_stereographic_cvec_r3 complex_homo_coords1 =\n                         inv_stereographic_cvec_r3 complex_homo_coords2", "obtain v1 v2 v'1 v'2 where *: \"v = (v1, v2)\" \"v' = (v'1, v'2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>v1 v2 v'1 v'2.\n        \\<lbrakk>v = (v1, v2); v' = (v'1, v'2)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases v, cases v', auto)"], ["proof (state)\nthis:\n  v = (v1, v2)\n  v' = (v'1, v'2)\n\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       \\<lbrakk>complex_homo_coords1 \\<noteq> vec_zero;\n        complex_homo_coords2 \\<noteq> vec_zero;\n        complex_homo_coords1 \\<approx>\\<^sub>v complex_homo_coords2\\<rbrakk>\n       \\<Longrightarrow> inv_stereographic_cvec_r3 complex_homo_coords1\n                         \\<in> unit_sphere \\<and>\n                         inv_stereographic_cvec_r3 complex_homo_coords1 =\n                         inv_stereographic_cvec_r3 complex_homo_coords2", "obtain x y z where\n    **: \"inv_stereographic_cvec_r3 v = (x, y, z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x y z.\n        inv_stereographic_cvec_r3 v = (x, y, z) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (cases \"inv_stereographic_cvec_r3 v\", blast)"], ["proof (state)\nthis:\n  inv_stereographic_cvec_r3 v = (x, y, z)\n\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       \\<lbrakk>complex_homo_coords1 \\<noteq> vec_zero;\n        complex_homo_coords2 \\<noteq> vec_zero;\n        complex_homo_coords1 \\<approx>\\<^sub>v complex_homo_coords2\\<rbrakk>\n       \\<Longrightarrow> inv_stereographic_cvec_r3 complex_homo_coords1\n                         \\<in> unit_sphere \\<and>\n                         inv_stereographic_cvec_r3 complex_homo_coords1 =\n                         inv_stereographic_cvec_r3 complex_homo_coords2", "have \"inv_stereographic_cvec_r3 v \\<in> unit_sphere\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_stereographic_cvec_r3 v \\<in> unit_sphere", "proof (cases \"v2 = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. v2 = 0 \\<Longrightarrow> inv_stereographic_cvec_r3 v \\<in> unit_sphere\n 2. v2 \\<noteq> 0 \\<Longrightarrow>\n    inv_stereographic_cvec_r3 v \\<in> unit_sphere", "case True"], ["proof (state)\nthis:\n  v2 = 0\n\ngoal (2 subgoals):\n 1. v2 = 0 \\<Longrightarrow> inv_stereographic_cvec_r3 v \\<in> unit_sphere\n 2. v2 \\<noteq> 0 \\<Longrightarrow>\n    inv_stereographic_cvec_r3 v \\<in> unit_sphere", "thus ?thesis"], ["proof (prove)\nusing this:\n  v2 = 0\n\ngoal (1 subgoal):\n 1. inv_stereographic_cvec_r3 v \\<in> unit_sphere", "using *"], ["proof (prove)\nusing this:\n  v2 = 0\n  v = (v1, v2)\n  v' = (v'1, v'2)\n\ngoal (1 subgoal):\n 1. inv_stereographic_cvec_r3 v \\<in> unit_sphere", "by simp"], ["proof (state)\nthis:\n  inv_stereographic_cvec_r3 v \\<in> unit_sphere\n\ngoal (1 subgoal):\n 1. v2 \\<noteq> 0 \\<Longrightarrow>\n    inv_stereographic_cvec_r3 v \\<in> unit_sphere", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. v2 \\<noteq> 0 \\<Longrightarrow>\n    inv_stereographic_cvec_r3 v \\<in> unit_sphere", "case False"], ["proof (state)\nthis:\n  v2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. v2 \\<noteq> 0 \\<Longrightarrow>\n    inv_stereographic_cvec_r3 v \\<in> unit_sphere", "thus ?thesis"], ["proof (prove)\nusing this:\n  v2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. inv_stereographic_cvec_r3 v \\<in> unit_sphere", "using * ** inv_stereographic_on_sphere[of x \"v1 / v2\" y z]"], ["proof (prove)\nusing this:\n  v2 \\<noteq> 0\n  v = (v1, v2)\n  v' = (v'1, v'2)\n  inv_stereographic_cvec_r3 v = (x, y, z)\n  \\<lbrakk>x = Re (2 * (v1 / v2) / (1 + v1 / v2 * cnj (v1 / v2)));\n   y = Im (2 * (v1 / v2) / (1 + v1 / v2 * cnj (v1 / v2)));\n   z =\n   ((cmod (v1 / v2))\\<^sup>2 - 1) / (1 + (cmod (v1 / v2))\\<^sup>2)\\<rbrakk>\n  \\<Longrightarrow> x * x + y * y + z * z = 1\n\ngoal (1 subgoal):\n 1. inv_stereographic_cvec_r3 v \\<in> unit_sphere", "by simp"], ["proof (state)\nthis:\n  inv_stereographic_cvec_r3 v \\<in> unit_sphere\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inv_stereographic_cvec_r3 v \\<in> unit_sphere\n\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       \\<lbrakk>complex_homo_coords1 \\<noteq> vec_zero;\n        complex_homo_coords2 \\<noteq> vec_zero;\n        complex_homo_coords1 \\<approx>\\<^sub>v complex_homo_coords2\\<rbrakk>\n       \\<Longrightarrow> inv_stereographic_cvec_r3 complex_homo_coords1\n                         \\<in> unit_sphere \\<and>\n                         inv_stereographic_cvec_r3 complex_homo_coords1 =\n                         inv_stereographic_cvec_r3 complex_homo_coords2", "moreover"], ["proof (state)\nthis:\n  inv_stereographic_cvec_r3 v \\<in> unit_sphere\n\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       \\<lbrakk>complex_homo_coords1 \\<noteq> vec_zero;\n        complex_homo_coords2 \\<noteq> vec_zero;\n        complex_homo_coords1 \\<approx>\\<^sub>v complex_homo_coords2\\<rbrakk>\n       \\<Longrightarrow> inv_stereographic_cvec_r3 complex_homo_coords1\n                         \\<in> unit_sphere \\<and>\n                         inv_stereographic_cvec_r3 complex_homo_coords1 =\n                         inv_stereographic_cvec_r3 complex_homo_coords2", "have \"inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'", "using 1 * **"], ["proof (prove)\nusing this:\n  v \\<noteq> vec_zero\n  v' \\<noteq> vec_zero\n  v \\<approx>\\<^sub>v v'\n  v = (v1, v2)\n  v' = (v'1, v'2)\n  inv_stereographic_cvec_r3 v = (x, y, z)\n\ngoal (1 subgoal):\n 1. inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'", "by (auto split: if_split if_split_asm)"], ["proof (state)\nthis:\n  inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'\n\ngoal (1 subgoal):\n 1. \\<And>complex_homo_coords1 complex_homo_coords2.\n       \\<lbrakk>complex_homo_coords1 \\<noteq> vec_zero;\n        complex_homo_coords2 \\<noteq> vec_zero;\n        complex_homo_coords1 \\<approx>\\<^sub>v complex_homo_coords2\\<rbrakk>\n       \\<Longrightarrow> inv_stereographic_cvec_r3 complex_homo_coords1\n                         \\<in> unit_sphere \\<and>\n                         inv_stereographic_cvec_r3 complex_homo_coords1 =\n                         inv_stereographic_cvec_r3 complex_homo_coords2", "ultimately"], ["proof (chain)\npicking this:\n  inv_stereographic_cvec_r3 v \\<in> unit_sphere\n  inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'", "show \"inv_stereographic_cvec_r3 v \\<in> unit_sphere \\<and>\n        inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'\""], ["proof (prove)\nusing this:\n  inv_stereographic_cvec_r3 v \\<in> unit_sphere\n  inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'\n\ngoal (1 subgoal):\n 1. inv_stereographic_cvec_r3 v \\<in> unit_sphere \\<and>\n    inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'", "by simp"], ["proof (state)\nthis:\n  inv_stereographic_cvec_r3 v \\<in> unit_sphere \\<and>\n  inv_stereographic_cvec_r3 v = inv_stereographic_cvec_r3 v'\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>North pole\\<close>"], ["", "definition North_R3 :: R3 where\n  [simp]: \"North_R3 = (0, 0, 1)\""], ["", "lift_definition North :: \"riemann_sphere\" is North_R3"], ["proof (prove)\ngoal (1 subgoal):\n 1. North_R3 \\<in> unit_sphere", "by simp"], ["", "lemma stereographic_North: \n  shows \"stereographic x = \\<infinity>\\<^sub>h \\<longleftrightarrow> x = North\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (stereographic x = \\<infinity>\\<^sub>h) = (x = North)", "by (transfer, transfer, auto split: if_split_asm)"], ["", "text \\<open>Stereographic and inverse stereographic projection are mutually inverse.\\<close>"], ["", "lemma stereographic_inv_stereographic':\n  assumes\n  z: \"z = z1/z2\" and \"z2 \\<noteq> 0\" and\n  X: \"X = Re (2*z / (1 + z*cnj z))\" and Y: \"Y = Im (2*z / (1 + z*cnj z))\" and Z: \"Z = ((cmod z)\\<^sup>2 - 1) / (1 + (cmod z)\\<^sup>2)\"\n  shows \"\\<exists> k. k \\<noteq> 0 \\<and> (X + \\<i>*Y, complex_of_real (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "have \"1 + (cmod z)\\<^sup>2 \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + (cmod z)\\<^sup>2 \\<noteq> 0", "by (metis one_power2 sum_power2_eq_zero_iff zero_neq_one)"], ["proof (state)\nthis:\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "hence \"(1 - Z) = 2 / (1 + (cmod z)\\<^sup>2)\""], ["proof (prove)\nusing this:\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 1 - Z = 2 / (1 + (cmod z)\\<^sup>2)", "using Z"], ["proof (prove)\nusing this:\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n  Z = ((cmod z)\\<^sup>2 - 1) / (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. 1 - Z = 2 / (1 + (cmod z)\\<^sup>2)", "by (auto simp add: field_simps)"], ["proof (state)\nthis:\n  1 - Z = 2 / (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "hence \"cor (1 - Z) = 2 / cor (1 + (cmod z)\\<^sup>2)\""], ["proof (prove)\nusing this:\n  1 - Z = 2 / (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. cor (1 - Z) = 2 / cor (1 + (cmod z)\\<^sup>2)", "by auto"], ["proof (state)\nthis:\n  cor (1 - Z) = 2 / cor (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "moreover"], ["proof (state)\nthis:\n  cor (1 - Z) = 2 / cor (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "have \"X = 2 * Re(z) / (1 + (cmod z)\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X = 2 * Re z / (1 + (cmod z)\\<^sup>2)", "using X"], ["proof (prove)\nusing this:\n  X = Re (2 * z / (1 + z * cnj z))\n\ngoal (1 subgoal):\n 1. X = 2 * Re z / (1 + (cmod z)\\<^sup>2)", "by (simp add: Re_stereographic)"], ["proof (state)\nthis:\n  X = 2 * Re z / (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "have \"Y = 2 * Im(z) / (1 + (cmod z)\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y = 2 * Im z / (1 + (cmod z)\\<^sup>2)", "using Y"], ["proof (prove)\nusing this:\n  Y = Im (2 * z / (1 + z * cnj z))\n\ngoal (1 subgoal):\n 1. Y = 2 * Im z / (1 + (cmod z)\\<^sup>2)", "by (simp add: Im_stereographic)"], ["proof (state)\nthis:\n  Y = 2 * Im z / (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "have \"X + \\<i>*Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cor X + \\<i> * cor Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)", "using \\<open>1 + (cmod z)\\<^sup>2 \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. cor X + \\<i> * cor Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)", "unfolding Complex_eq[of X Y, symmetric]"], ["proof (prove)\nusing this:\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. Complex X Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)", "by (subst \\<open>X = 2*Re(z) / (1 + (cmod z)\\<^sup>2)\\<close>, subst \\<open>Y = 2*Im(z) / (1 + (cmod z)\\<^sup>2)\\<close>, simp add: Complex_scale4 Complex_scale1)"], ["proof (state)\nthis:\n  cor X + \\<i> * cor Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "moreover"], ["proof (state)\nthis:\n  cor X + \\<i> * cor Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "have \"1 + (cor (cmod (z1 / z2)))\\<^sup>2 \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + (cor (cmod (z1 / z2)))\\<^sup>2 \\<noteq> 0", "by (rule one_plus_square_neq_zero)"], ["proof (state)\nthis:\n  1 + (cor (cmod (z1 / z2)))\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "ultimately"], ["proof (chain)\npicking this:\n  cor (1 - Z) = 2 / cor (1 + (cmod z)\\<^sup>2)\n  cor X + \\<i> * cor Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)\n  1 + (cor (cmod (z1 / z2)))\\<^sup>2 \\<noteq> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  cor (1 - Z) = 2 / cor (1 + (cmod z)\\<^sup>2)\n  cor X + \\<i> * cor Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)\n  1 + (cor (cmod (z1 / z2)))\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "using \\<open>z2 \\<noteq> 0\\<close> \\<open>1 + (cmod z)\\<^sup>2 \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  cor (1 - Z) = 2 / cor (1 + (cmod z)\\<^sup>2)\n  cor X + \\<i> * cor Y = 2 * z / cor (1 + (cmod z)\\<^sup>2)\n  1 + (cor (cmod (z1 / z2)))\\<^sup>2 \\<noteq> 0\n  z2 \\<noteq> 0\n  1 + (cmod z)\\<^sup>2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)", "by (simp, subst z)+\n       (rule_tac x=\"(2 / (1 + (cor (cmod (z1 / z2)))\\<^sup>2)) / z2\" in exI, auto)"], ["proof (state)\nthis:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     (cor X + \\<i> * cor Y, cor (1 - Z)) = k *\\<^sub>s\\<^sub>v (z1, z2)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma stereographic_inv_stereographic [simp]:\n  shows \"stereographic (inv_stereographic w) = w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. stereographic (inv_stereographic w) = w", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. stereographic (inv_stereographic w) = w", "have \"w = stereographic (inv_stereographic w)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w = stereographic (inv_stereographic w)", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w.\n       w \\<noteq> vec_zero \\<Longrightarrow>\n       w \\<approx>\\<^sub>v\n       stereographic_r3_cvec (inv_stereographic_cvec_r3 w)", "fix w"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w.\n       w \\<noteq> vec_zero \\<Longrightarrow>\n       w \\<approx>\\<^sub>v\n       stereographic_r3_cvec (inv_stereographic_cvec_r3 w)", "assume \"w \\<noteq> vec_zero\""], ["proof (state)\nthis:\n  w \\<noteq> vec_zero\n\ngoal (1 subgoal):\n 1. \\<And>w.\n       w \\<noteq> vec_zero \\<Longrightarrow>\n       w \\<approx>\\<^sub>v\n       stereographic_r3_cvec (inv_stereographic_cvec_r3 w)", "obtain w1 w2 where *: \"w = (w1, w2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>w1 w2. w = (w1, w2) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases w, auto)"], ["proof (state)\nthis:\n  w = (w1, w2)\n\ngoal (1 subgoal):\n 1. \\<And>w.\n       w \\<noteq> vec_zero \\<Longrightarrow>\n       w \\<approx>\\<^sub>v\n       stereographic_r3_cvec (inv_stereographic_cvec_r3 w)", "obtain x y z where **: \"inv_stereographic_cvec_r3 w = (x, y, z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x y z.\n        inv_stereographic_cvec_r3 w = (x, y, z) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (cases \"inv_stereographic_cvec_r3 w\", blast)"], ["proof (state)\nthis:\n  inv_stereographic_cvec_r3 w = (x, y, z)\n\ngoal (1 subgoal):\n 1. \\<And>w.\n       w \\<noteq> vec_zero \\<Longrightarrow>\n       w \\<approx>\\<^sub>v\n       stereographic_r3_cvec (inv_stereographic_cvec_r3 w)", "show \"w \\<approx>\\<^sub>v stereographic_r3_cvec (inv_stereographic_cvec_r3 w)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. w \\<approx>\\<^sub>v stereographic_r3_cvec (inv_stereographic_cvec_r3 w)", "using \\<open>w \\<noteq> vec_zero\\<close> stereographic_inv_stereographic'[of \"w1/w2\" w1 w2 x y z] * **"], ["proof (prove)\nusing this:\n  w \\<noteq> vec_zero\n  \\<lbrakk>w1 / w2 = w1 / w2; w2 \\<noteq> 0;\n   x = Re (2 * (w1 / w2) / (1 + w1 / w2 * cnj (w1 / w2)));\n   y = Im (2 * (w1 / w2) / (1 + w1 / w2 * cnj (w1 / w2)));\n   z =\n   ((cmod (w1 / w2))\\<^sup>2 - 1) / (1 + (cmod (w1 / w2))\\<^sup>2)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>k.\n                       k \\<noteq> 0 \\<and>\n                       (cor x + \\<i> * cor y, cor (1 - z)) =\n                       k *\\<^sub>s\\<^sub>v (w1, w2)\n  w = (w1, w2)\n  inv_stereographic_cvec_r3 w = (x, y, z)\n\ngoal (1 subgoal):\n 1. w \\<approx>\\<^sub>v stereographic_r3_cvec (inv_stereographic_cvec_r3 w)", "by (auto simp add: split_def Let_def split: if_split_asm)"], ["proof (state)\nthis:\n  w \\<approx>\\<^sub>v stereographic_r3_cvec (inv_stereographic_cvec_r3 w)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  w = stereographic (inv_stereographic w)\n\ngoal (1 subgoal):\n 1. stereographic (inv_stereographic w) = w", "thus ?thesis"], ["proof (prove)\nusing this:\n  w = stereographic (inv_stereographic w)\n\ngoal (1 subgoal):\n 1. stereographic (inv_stereographic w) = w", "by simp"], ["proof (state)\nthis:\n  stereographic (inv_stereographic w) = w\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Stereographic projection is bijective function\\<close>"], ["", "lemma bij_stereographic:\n  shows \"bij stereographic\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij stereographic", "unfolding bij_def inj_on_def surj_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>UNIV.\n        \\<forall>y\\<in>UNIV.\n           stereographic x = stereographic y \\<longrightarrow> x = y) \\<and>\n    (\\<forall>y. \\<exists>x. y = stereographic x)", "proof (safe)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> UNIV; y \\<in> UNIV;\n        stereographic x = stereographic y\\<rbrakk>\n       \\<Longrightarrow> x = y\n 2. \\<And>y. \\<exists>x. y = stereographic x", "fix a b"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> UNIV; y \\<in> UNIV;\n        stereographic x = stereographic y\\<rbrakk>\n       \\<Longrightarrow> x = y\n 2. \\<And>y. \\<exists>x. y = stereographic x", "assume \"stereographic a = stereographic b\""], ["proof (state)\nthis:\n  stereographic a = stereographic b\n\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> UNIV; y \\<in> UNIV;\n        stereographic x = stereographic y\\<rbrakk>\n       \\<Longrightarrow> x = y\n 2. \\<And>y. \\<exists>x. y = stereographic x", "thus \"a = b\""], ["proof (prove)\nusing this:\n  stereographic a = stereographic b\n\ngoal (1 subgoal):\n 1. a = b", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b aa ba.\n       \\<lbrakk>a \\<in> unit_sphere; b \\<in> unit_sphere;\n        stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b;\n        aa \\<in> unit_sphere; ba \\<in> unit_sphere;\n        stereographic_r3_hcoords aa \\<approx>\n        stereographic_r3_hcoords ba\\<rbrakk>\n       \\<Longrightarrow> a = b", "fix a b :: R3"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b aa ba.\n       \\<lbrakk>a \\<in> unit_sphere; b \\<in> unit_sphere;\n        stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b;\n        aa \\<in> unit_sphere; ba \\<in> unit_sphere;\n        stereographic_r3_hcoords aa \\<approx>\n        stereographic_r3_hcoords ba\\<rbrakk>\n       \\<Longrightarrow> a = b", "obtain xa ya za xb yb zb where\n      *: \"a = (xa, ya, za)\" \"b = (xb, yb, zb)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>xa ya za xb yb zb.\n        \\<lbrakk>a = (xa, ya, za); b = (xb, yb, zb)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases a, cases b, auto)"], ["proof (state)\nthis:\n  a = (xa, ya, za)\n  b = (xb, yb, zb)\n\ngoal (1 subgoal):\n 1. \\<And>a b aa ba.\n       \\<lbrakk>a \\<in> unit_sphere; b \\<in> unit_sphere;\n        stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b;\n        aa \\<in> unit_sphere; ba \\<in> unit_sphere;\n        stereographic_r3_hcoords aa \\<approx>\n        stereographic_r3_hcoords ba\\<rbrakk>\n       \\<Longrightarrow> a = b", "assume **: \"a \\<in> unit_sphere\" \"b \\<in> unit_sphere\" \"stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b\""], ["proof (state)\nthis:\n  a \\<in> unit_sphere\n  b \\<in> unit_sphere\n  stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b\n\ngoal (1 subgoal):\n 1. \\<And>a b aa ba.\n       \\<lbrakk>a \\<in> unit_sphere; b \\<in> unit_sphere;\n        stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b;\n        aa \\<in> unit_sphere; ba \\<in> unit_sphere;\n        stereographic_r3_hcoords aa \\<approx>\n        stereographic_r3_hcoords ba\\<rbrakk>\n       \\<Longrightarrow> a = b", "show \"a = b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a = b", "proof (cases \"a = (0, 0, 1) \\<or> b = (0, 0, 1)\")"], ["proof (state)\ngoal (2 subgoals):\n 1. a = (0, 0, 1) \\<or> b = (0, 0, 1) \\<Longrightarrow> a = b\n 2. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "case True"], ["proof (state)\nthis:\n  a = (0, 0, 1) \\<or> b = (0, 0, 1)\n\ngoal (2 subgoals):\n 1. a = (0, 0, 1) \\<or> b = (0, 0, 1) \\<Longrightarrow> a = b\n 2. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "thus ?thesis"], ["proof (prove)\nusing this:\n  a = (0, 0, 1) \\<or> b = (0, 0, 1)\n\ngoal (1 subgoal):\n 1. a = b", "using * **"], ["proof (prove)\nusing this:\n  a = (0, 0, 1) \\<or> b = (0, 0, 1)\n  a = (xa, ya, za)\n  b = (xb, yb, zb)\n  a \\<in> unit_sphere\n  b \\<in> unit_sphere\n  stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b\n\ngoal (1 subgoal):\n 1. a = b", "by (simp split: if_split_asm) force+"], ["proof (state)\nthis:\n  a = b\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "case False"], ["proof (state)\nthis:\n  \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1))\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "then"], ["proof (chain)\npicking this:\n  \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1))", "obtain k where ++: \"k \\<noteq> 0\" \"cor xb + \\<i> * cor yb = k * (cor xa + \\<i> * cor ya)\" \"1 - cor zb = k * (1 - cor za)\""], ["proof (prove)\nusing this:\n  \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1))\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         cor xb + \\<i> * cor yb = k * (cor xa + \\<i> * cor ya);\n         1 - cor zb = k * (1 - cor za)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using * **"], ["proof (prove)\nusing this:\n  \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1))\n  a = (xa, ya, za)\n  b = (xb, yb, zb)\n  a \\<in> unit_sphere\n  b \\<in> unit_sphere\n  stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         cor xb + \\<i> * cor yb = k * (cor xa + \\<i> * cor ya);\n         1 - cor zb = k * (1 - cor za)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto split: if_split_asm)"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  cor xb + \\<i> * cor yb = k * (cor xa + \\<i> * cor ya)\n  1 - cor zb = k * (1 - cor za)\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "{"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  cor xb + \\<i> * cor yb = k * (cor xa + \\<i> * cor ya)\n  1 - cor zb = k * (1 - cor za)\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "assume \"xb + xa*zb = xa + xb*za\"\n                 \"yb + ya*zb = ya + yb*za\"\n                 \"xa*xa + ya*ya + za*za = 1\" \"xb*xb + yb*yb + zb*zb = 1\"\n                 \"za \\<noteq> 1\" \"zb \\<noteq> 1\""], ["proof (state)\nthis:\n  xb + xa * zb = xa + xb * za\n  yb + ya * zb = ya + yb * za\n  xa * xa + ya * ya + za * za = 1\n  xb * xb + yb * yb + zb * zb = 1\n  za \\<noteq> 1\n  zb \\<noteq> 1\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "hence \"xa = xb \\<and> ya = yb \\<and> za = zb\""], ["proof (prove)\nusing this:\n  xb + xa * zb = xa + xb * za\n  yb + ya * zb = ya + yb * za\n  xa * xa + ya * ya + za * za = 1\n  xb * xb + yb * yb + zb * zb = 1\n  za \\<noteq> 1\n  zb \\<noteq> 1\n\ngoal (1 subgoal):\n 1. xa = xb \\<and> ya = yb \\<and> za = zb", "by algebra"], ["proof (state)\nthis:\n  xa = xb \\<and> ya = yb \\<and> za = zb\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "}"], ["proof (state)\nthis:\n  \\<lbrakk>xb + xa * zb = xa + xb * za; yb + ya * zb = ya + yb * za;\n   xa * xa + ya * ya + za * za = 1; xb * xb + yb * yb + zb * zb = 1;\n   za \\<noteq> 1; zb \\<noteq> 1\\<rbrakk>\n  \\<Longrightarrow> xa = xb \\<and> ya = yb \\<and> za = zb\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "note *** = this"], ["proof (state)\nthis:\n  \\<lbrakk>xb + xa * zb = xa + xb * za; yb + ya * zb = ya + yb * za;\n   xa * xa + ya * ya + za * za = 1; xb * xb + yb * yb + zb * zb = 1;\n   za \\<noteq> 1; zb \\<noteq> 1\\<rbrakk>\n  \\<Longrightarrow> xa = xb \\<and> ya = yb \\<and> za = zb\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "have \"za \\<noteq> 1\" \"zb \\<noteq> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. za \\<noteq> 1 &&& zb \\<noteq> 1", "using False * **"], ["proof (prove)\nusing this:\n  \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1))\n  a = (xa, ya, za)\n  b = (xb, yb, zb)\n  a \\<in> unit_sphere\n  b \\<in> unit_sphere\n  stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b\n\ngoal (1 subgoal):\n 1. za \\<noteq> 1 &&& zb \\<noteq> 1", "by auto"], ["proof (state)\nthis:\n  za \\<noteq> 1\n  zb \\<noteq> 1\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "have \"k = (1 - cor zb) / (1 - cor za)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k = (1 - cor zb) / (1 - cor za)", "using \\<open>1 - cor zb = k * (1 - cor za)\\<close> \\<open>za \\<noteq> 1\\<close>"], ["proof (prove)\nusing this:\n  1 - cor zb = k * (1 - cor za)\n  za \\<noteq> 1\n\ngoal (1 subgoal):\n 1. k = (1 - cor zb) / (1 - cor za)", "by simp"], ["proof (state)\nthis:\n  k = (1 - cor zb) / (1 - cor za)\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "hence \"(1 - cor za) * (cor xb + \\<i> * cor yb) = (1 - cor zb) * (cor xa + \\<i> * cor ya)\""], ["proof (prove)\nusing this:\n  k = (1 - cor zb) / (1 - cor za)\n\ngoal (1 subgoal):\n 1. (1 - cor za) * (cor xb + \\<i> * cor yb) =\n    (1 - cor zb) * (cor xa + \\<i> * cor ya)", "using \\<open>za \\<noteq> 1\\<close> ++(2)"], ["proof (prove)\nusing this:\n  k = (1 - cor zb) / (1 - cor za)\n  za \\<noteq> 1\n  cor xb + \\<i> * cor yb = k * (cor xa + \\<i> * cor ya)\n\ngoal (1 subgoal):\n 1. (1 - cor za) * (cor xb + \\<i> * cor yb) =\n    (1 - cor zb) * (cor xa + \\<i> * cor ya)", "by simp"], ["proof (state)\nthis:\n  (1 - cor za) * (cor xb + \\<i> * cor yb) =\n  (1 - cor zb) * (cor xa + \\<i> * cor ya)\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "hence \"xb + xa*zb = xa + xb*za\"\n            \"yb + ya*zb = ya + yb*za\"\n            \"xa*xa + ya*ya + za*za = 1\" \"xb*xb + yb*yb + zb*zb = 1\""], ["proof (prove)\nusing this:\n  (1 - cor za) * (cor xb + \\<i> * cor yb) =\n  (1 - cor zb) * (cor xa + \\<i> * cor ya)\n\ngoal (1 subgoal):\n 1. (xb + xa * zb = xa + xb * za &&& yb + ya * zb = ya + yb * za) &&&\n    xa * xa + ya * ya + za * za = 1 &&& xb * xb + yb * yb + zb * zb = 1", "using * ** \\<open>za \\<noteq> 1\\<close>"], ["proof (prove)\nusing this:\n  (1 - cor za) * (cor xb + \\<i> * cor yb) =\n  (1 - cor zb) * (cor xa + \\<i> * cor ya)\n  a = (xa, ya, za)\n  b = (xb, yb, zb)\n  a \\<in> unit_sphere\n  b \\<in> unit_sphere\n  stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b\n  za \\<noteq> 1\n\ngoal (1 subgoal):\n 1. (xb + xa * zb = xa + xb * za &&& yb + ya * zb = ya + yb * za) &&&\n    xa * xa + ya * ya + za * za = 1 &&& xb * xb + yb * yb + zb * zb = 1", "apply (simp_all add: field_simps)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>cor xb +\n             (\\<i> * cor yb +\n              (cor xa * cor zb + \\<i> * (cor ya * cor zb))) =\n             cor xa +\n             (\\<i> * cor ya + (cor xb * cor za + \\<i> * (cor yb * cor za)));\n     a = (xa, ya, za); b = (xb, yb, zb); xa * xa + (ya * ya + za * za) = 1;\n     xb * xb + (yb * yb + zb * zb) = 1;\n     \\<exists>k.\n        k \\<noteq> 0 \\<and>\n        (if yb = 0 \\<longrightarrow> xb = 0 \\<longrightarrow> zb \\<noteq> 1\n         then (cor xb + \\<i> * cor yb, cor (1 - zb)) else (1, 0)) =\n        (k * cor xa + k * (\\<i> * cor ya), k - k * cor za);\n     za \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> xb + xa * zb = xa + xb * za\n 2. \\<lbrakk>cor xb +\n             (\\<i> * cor yb +\n              (cor xa * cor zb + \\<i> * (cor ya * cor zb))) =\n             cor xa +\n             (\\<i> * cor ya + (cor xb * cor za + \\<i> * (cor yb * cor za)));\n     a = (xa, ya, za); b = (xb, yb, zb); xa * xa + (ya * ya + za * za) = 1;\n     xb * xb + (yb * yb + zb * zb) = 1;\n     \\<exists>k.\n        k \\<noteq> 0 \\<and>\n        (if yb = 0 \\<longrightarrow> xb = 0 \\<longrightarrow> zb \\<noteq> 1\n         then (cor xb + \\<i> * cor yb, cor (1 - zb)) else (1, 0)) =\n        (k * cor xa + k * (\\<i> * cor ya), k - k * cor za);\n     za \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> yb + ya * zb = ya + yb * za", "unfolding complex_of_real_def imaginary_unit.ctr"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Complex xb 0 +\n             (Complex 0 1 * Complex yb 0 +\n              (Complex xa 0 * Complex zb 0 +\n               Complex 0 1 * (Complex ya 0 * Complex zb 0))) =\n             Complex xa 0 +\n             (Complex 0 1 * Complex ya 0 +\n              (Complex xb 0 * Complex za 0 +\n               Complex 0 1 * (Complex yb 0 * Complex za 0)));\n     a = (xa, ya, za); b = (xb, yb, zb); xa * xa + (ya * ya + za * za) = 1;\n     xb * xb + (yb * yb + zb * zb) = 1;\n     \\<exists>k.\n        k \\<noteq> 0 \\<and>\n        (if yb = 0 \\<longrightarrow> xb = 0 \\<longrightarrow> zb \\<noteq> 1\n         then (Complex xb 0 + Complex 0 1 * Complex yb 0,\n               Complex (1 - zb) 0)\n         else (1, 0)) =\n        (k * Complex xa 0 + k * (Complex 0 1 * Complex ya 0),\n         k - k * Complex za 0);\n     za \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> xb + xa * zb = xa + xb * za\n 2. \\<lbrakk>Complex xb 0 +\n             (Complex 0 1 * Complex yb 0 +\n              (Complex xa 0 * Complex zb 0 +\n               Complex 0 1 * (Complex ya 0 * Complex zb 0))) =\n             Complex xa 0 +\n             (Complex 0 1 * Complex ya 0 +\n              (Complex xb 0 * Complex za 0 +\n               Complex 0 1 * (Complex yb 0 * Complex za 0)));\n     a = (xa, ya, za); b = (xb, yb, zb); xa * xa + (ya * ya + za * za) = 1;\n     xb * xb + (yb * yb + zb * zb) = 1;\n     \\<exists>k.\n        k \\<noteq> 0 \\<and>\n        (if yb = 0 \\<longrightarrow> xb = 0 \\<longrightarrow> zb \\<noteq> 1\n         then (Complex xb 0 + Complex 0 1 * Complex yb 0,\n               Complex (1 - zb) 0)\n         else (1, 0)) =\n        (k * Complex xa 0 + k * (Complex 0 1 * Complex ya 0),\n         k - k * Complex za 0);\n     za \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> yb + ya * zb = ya + yb * za", "by (simp_all add: legacy_Complex_simps)"], ["proof (state)\nthis:\n  xb + xa * zb = xa + xb * za\n  yb + ya * zb = ya + yb * za\n  xa * xa + ya * ya + za * za = 1\n  xb * xb + yb * yb + zb * zb = 1\n\ngoal (1 subgoal):\n 1. \\<not> (a = (0, 0, 1) \\<or> b = (0, 0, 1)) \\<Longrightarrow> a = b", "thus ?thesis"], ["proof (prove)\nusing this:\n  xb + xa * zb = xa + xb * za\n  yb + ya * zb = ya + yb * za\n  xa * xa + ya * ya + za * za = 1\n  xb * xb + yb * yb + zb * zb = 1\n\ngoal (1 subgoal):\n 1. a = b", "using * ** *** \\<open>za \\<noteq> 1\\<close> \\<open>zb \\<noteq> 1\\<close>"], ["proof (prove)\nusing this:\n  xb + xa * zb = xa + xb * za\n  yb + ya * zb = ya + yb * za\n  xa * xa + ya * ya + za * za = 1\n  xb * xb + yb * yb + zb * zb = 1\n  a = (xa, ya, za)\n  b = (xb, yb, zb)\n  a \\<in> unit_sphere\n  b \\<in> unit_sphere\n  stereographic_r3_cvec a \\<approx>\\<^sub>v stereographic_r3_cvec b\n  \\<lbrakk>xb + xa * zb = xa + xb * za; yb + ya * zb = ya + yb * za;\n   xa * xa + ya * ya + za * za = 1; xb * xb + yb * yb + zb * zb = 1;\n   za \\<noteq> 1; zb \\<noteq> 1\\<rbrakk>\n  \\<Longrightarrow> xa = xb \\<and> ya = yb \\<and> za = zb\n  za \\<noteq> 1\n  zb \\<noteq> 1\n\ngoal (1 subgoal):\n 1. a = b", "by simp"], ["proof (state)\nthis:\n  a = b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  a = b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  a = b\n\ngoal (1 subgoal):\n 1. \\<And>y. \\<exists>x. y = stereographic x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y. \\<exists>x. y = stereographic x", "fix y"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y. \\<exists>x. y = stereographic x", "show \"\\<exists> x. y = stereographic x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x. y = stereographic x", "by (rule_tac x=\"inv_stereographic y\" in exI, simp)"], ["proof (state)\nthis:\n  \\<exists>x. y = stereographic x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma inv_stereographic_stereographic [simp]: \n  shows \"inv_stereographic (stereographic x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_stereographic (stereographic x) = x", "using stereographic_inv_stereographic[of \"stereographic x\"]"], ["proof (prove)\nusing this:\n  stereographic (inv_stereographic (stereographic x)) = stereographic x\n\ngoal (1 subgoal):\n 1. inv_stereographic (stereographic x) = x", "using bij_stereographic"], ["proof (prove)\nusing this:\n  stereographic (inv_stereographic (stereographic x)) = stereographic x\n  bij stereographic\n\ngoal (1 subgoal):\n 1. inv_stereographic (stereographic x) = x", "unfolding bij_def inj_on_def"], ["proof (prove)\nusing this:\n  stereographic (inv_stereographic (stereographic x)) = stereographic x\n  (\\<forall>x\\<in>UNIV.\n      \\<forall>y\\<in>UNIV.\n         stereographic x = stereographic y \\<longrightarrow> x = y) \\<and>\n  surj stereographic\n\ngoal (1 subgoal):\n 1. inv_stereographic (stereographic x) = x", "by simp"], ["", "lemma inv_stereographic_is_inv:\n  shows \"inv_stereographic = inv stereographic\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_stereographic = inv stereographic", "by (rule inv_equality[symmetric], simp_all)"], ["", "(* ----------------------------------------------------------------- *)"], ["", "subsection \\<open>Circles on the sphere\\<close>"], ["", "(* ----------------------------------------------------------------- *)"], ["", "text \\<open>Circlines in the plane correspond to circles on the Riemann sphere, and we formally establish\nthis connection. Every circle in three--dimensional space can be obtained as the intersection of a\nsphere and a plane. We establish a one-to-one correspondence between circles on the Riemann sphere\nand planes in space. Note that the plane need not intersect the sphere, but we will still say that\nit defines a single imaginary circle. However, for one special circline (the one with the identity\nrepresentative matrix), there does not exist a plane in $\\mathbb{R}^3$ that would correspond to it\n--- in order to have this, instead of considering planes in $\\mathbb{R}^3$, we must consider three\ndimensional projective space and consider the infinite (hyper)plane.\\<close>"], ["", "text \\<open>Planes in $R^3$ are given by equations $ax+by+cz=d$. Two four-tuples of coefficients $(a, b, c,\nd)$ give the same plane iff they are proportional.\\<close>"], ["", "type_synonym R4 = \"real \\<times> real \\<times> real \\<times> real\""], ["", "fun mult_sv :: \"real \\<Rightarrow> R4 \\<Rightarrow> R4\" (infixl \"*\\<^sub>s\\<^sub>v\\<^sub>4\" 100) where\n  \"k *\\<^sub>s\\<^sub>v\\<^sub>4 (a, b, c, d) = (k*a, k*b, k*c, k*d)\""], ["", "abbreviation plane_vectors where\n  \"plane_vectors \\<equiv> {(a::real, b::real, c::real, d::real). a \\<noteq> 0 \\<or> b \\<noteq> 0 \\<or> c \\<noteq> 0 \\<or> d \\<noteq> 0}\""], ["", "typedef plane_vec = \"plane_vectors\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x. x \\<in> plane_vectors", "by (rule_tac x=\"(1, 1, 1, 1)\" in exI) simp"], ["", "setup_lifting type_definition_plane_vec"], ["", "definition plane_vec_eq_r4 :: \"R4 \\<Rightarrow> R4 \\<Rightarrow> bool\" where\n  [simp]: \"plane_vec_eq_r4 v1 v2 \\<longleftrightarrow> (\\<exists> k. k \\<noteq> 0 \\<and> v2 = k *\\<^sub>s\\<^sub>v\\<^sub>4 v1)\""], ["", "lift_definition plane_vec_eq :: \"plane_vec \\<Rightarrow> plane_vec \\<Rightarrow> bool\" is plane_vec_eq_r4"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma mult_sv_one [simp]:\n  shows \"1 *\\<^sub>s\\<^sub>v\\<^sub>4 x = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 *\\<^sub>s\\<^sub>v\\<^sub>4 x = x", "by (cases x) simp"], ["", "lemma mult_sv_distb [simp]:\n  shows \"x *\\<^sub>s\\<^sub>v\\<^sub>4 (y *\\<^sub>s\\<^sub>v\\<^sub>4 v) = (x*y) *\\<^sub>s\\<^sub>v\\<^sub>4 v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x *\\<^sub>s\\<^sub>v\\<^sub>4 (y *\\<^sub>s\\<^sub>v\\<^sub>4 v) =\n    (x * y) *\\<^sub>s\\<^sub>v\\<^sub>4 v", "by (cases v) simp"], ["", "quotient_type plane = plane_vec / plane_vec_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. equivp plane_vec_eq", "proof (rule equivpI)"], ["proof (state)\ngoal (3 subgoals):\n 1. reflp plane_vec_eq\n 2. symp plane_vec_eq\n 3. transp plane_vec_eq", "show \"reflp plane_vec_eq\""], ["proof (prove)\ngoal (1 subgoal):\n 1. reflp plane_vec_eq", "unfolding reflp_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x. plane_vec_eq x x", "by (auto simp add: plane_vec_eq_def) (rule_tac x=\"1\" in exI, simp)"], ["proof (state)\nthis:\n  reflp plane_vec_eq\n\ngoal (2 subgoals):\n 1. symp plane_vec_eq\n 2. transp plane_vec_eq", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. symp plane_vec_eq\n 2. transp plane_vec_eq", "show \"symp plane_vec_eq\""], ["proof (prove)\ngoal (1 subgoal):\n 1. symp plane_vec_eq", "unfolding symp_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x y. plane_vec_eq x y \\<longrightarrow> plane_vec_eq y x", "by (auto simp add: plane_vec_eq_def) (rule_tac x=\"1/k\" in exI, simp)"], ["proof (state)\nthis:\n  symp plane_vec_eq\n\ngoal (1 subgoal):\n 1. transp plane_vec_eq", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. transp plane_vec_eq", "show \"transp plane_vec_eq\""], ["proof (prove)\ngoal (1 subgoal):\n 1. transp plane_vec_eq", "unfolding transp_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x y z.\n       plane_vec_eq x y \\<longrightarrow>\n       plane_vec_eq y z \\<longrightarrow> plane_vec_eq x z", "by (auto simp add: plane_vec_eq_def) (rule_tac x=\"ka*k\" in exI, simp)"], ["proof (state)\nthis:\n  transp plane_vec_eq\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Plane coefficients give a linear equation and the point on the Riemann sphere lies on the\ncircle determined by the plane iff its representation satisfies that linear equation.\\<close>"], ["", "definition on_sphere_circle_r4_r3 :: \"R4 \\<Rightarrow> R3 \\<Rightarrow> bool\" where\n  [simp]: \"on_sphere_circle_r4_r3 \\<alpha> A \\<longleftrightarrow>\n      (let (X, Y, Z) = A;\n           (a, b, c, d) = \\<alpha>\n        in a*X + b*Y + c*Z + d = 0)\""], ["", "lift_definition on_sphere_circle_vec :: \"plane_vec \\<Rightarrow> R3 \\<Rightarrow> bool\" is on_sphere_circle_r4_r3"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lift_definition on_sphere_circle :: \"plane \\<Rightarrow> riemann_sphere \\<Rightarrow> bool\" is on_sphere_circle_vec"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2 prod.\n       \\<lbrakk>plane_vec_eq plane_vec1 plane_vec2;\n        prod \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_vec plane_vec1 prod =\n                         on_sphere_circle_vec plane_vec2 prod", "proof (transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2 prod.\n       \\<lbrakk>plane_vec1 \\<in> plane_vectors;\n        plane_vec2 \\<in> plane_vectors;\n        plane_vec_eq_r4 plane_vec1 plane_vec2;\n        prod \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3 plane_vec1 prod =\n                         on_sphere_circle_r4_r3 plane_vec2 prod", "fix pv1 pv2 :: R4 and w :: R3"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2 prod.\n       \\<lbrakk>plane_vec1 \\<in> plane_vectors;\n        plane_vec2 \\<in> plane_vectors;\n        plane_vec_eq_r4 plane_vec1 plane_vec2;\n        prod \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3 plane_vec1 prod =\n                         on_sphere_circle_r4_r3 plane_vec2 prod", "obtain a1 b1 c1 d1 a2 b2 c2 d2 x y z where\n    *: \"pv1 = (a1, b1, c1, d1)\" \"pv2 = (a2, b2, c2, d2)\" \"w = (x, y, z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>a1 b1 c1 d1 a2 b2 c2 d2 x y z.\n        \\<lbrakk>pv1 = (a1, b1, c1, d1); pv2 = (a2, b2, c2, d2);\n         w = (x, y, z)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases pv1, cases pv2, cases w, auto)"], ["proof (state)\nthis:\n  pv1 = (a1, b1, c1, d1)\n  pv2 = (a2, b2, c2, d2)\n  w = (x, y, z)\n\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2 prod.\n       \\<lbrakk>plane_vec1 \\<in> plane_vectors;\n        plane_vec2 \\<in> plane_vectors;\n        plane_vec_eq_r4 plane_vec1 plane_vec2;\n        prod \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3 plane_vec1 prod =\n                         on_sphere_circle_r4_r3 plane_vec2 prod", "assume \"pv1 \\<in> plane_vectors\" \"pv2 \\<in> plane_vectors\" \"w \\<in> unit_sphere\" \"plane_vec_eq_r4 pv1 pv2\""], ["proof (state)\nthis:\n  pv1 \\<in> plane_vectors\n  pv2 \\<in> plane_vectors\n  w \\<in> unit_sphere\n  plane_vec_eq_r4 pv1 pv2\n\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2 prod.\n       \\<lbrakk>plane_vec1 \\<in> plane_vectors;\n        plane_vec2 \\<in> plane_vectors;\n        plane_vec_eq_r4 plane_vec1 plane_vec2;\n        prod \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3 plane_vec1 prod =\n                         on_sphere_circle_r4_r3 plane_vec2 prod", "then"], ["proof (chain)\npicking this:\n  pv1 \\<in> plane_vectors\n  pv2 \\<in> plane_vectors\n  w \\<in> unit_sphere\n  plane_vec_eq_r4 pv1 pv2", "obtain k where **: \"a2 = k*a1\" \"b2 = k*b1\" \"c2 = k*c1\" \"d2 = k*d1\" \"k \\<noteq> 0\""], ["proof (prove)\nusing this:\n  pv1 \\<in> plane_vectors\n  pv2 \\<in> plane_vectors\n  w \\<in> unit_sphere\n  plane_vec_eq_r4 pv1 pv2\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>a2 = k * a1; b2 = k * b1; c2 = k * c1; d2 = k * d1;\n         k \\<noteq> 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using *"], ["proof (prove)\nusing this:\n  pv1 \\<in> plane_vectors\n  pv2 \\<in> plane_vectors\n  w \\<in> unit_sphere\n  plane_vec_eq_r4 pv1 pv2\n  pv1 = (a1, b1, c1, d1)\n  pv2 = (a2, b2, c2, d2)\n  w = (x, y, z)\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>a2 = k * a1; b2 = k * b1; c2 = k * c1; d2 = k * d1;\n         k \\<noteq> 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  a2 = k * a1\n  b2 = k * b1\n  c2 = k * c1\n  d2 = k * d1\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2 prod.\n       \\<lbrakk>plane_vec1 \\<in> plane_vectors;\n        plane_vec2 \\<in> plane_vectors;\n        plane_vec_eq_r4 plane_vec1 plane_vec2;\n        prod \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3 plane_vec1 prod =\n                         on_sphere_circle_r4_r3 plane_vec2 prod", "have \"k * a1 * x + k * b1 * y + k * c1 * z + k * d1 = k*(a1*x + b1*y + c1*z + d1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * a1 * x + k * b1 * y + k * c1 * z + k * d1 =\n    k * (a1 * x + b1 * y + c1 * z + d1)", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  k * a1 * x + k * b1 * y + k * c1 * z + k * d1 =\n  k * (a1 * x + b1 * y + c1 * z + d1)\n\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2 prod.\n       \\<lbrakk>plane_vec1 \\<in> plane_vectors;\n        plane_vec2 \\<in> plane_vectors;\n        plane_vec_eq_r4 plane_vec1 plane_vec2;\n        prod \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3 plane_vec1 prod =\n                         on_sphere_circle_r4_r3 plane_vec2 prod", "thus \"on_sphere_circle_r4_r3 pv1 w = on_sphere_circle_r4_r3 pv2 w\""], ["proof (prove)\nusing this:\n  k * a1 * x + k * b1 * y + k * c1 * z + k * d1 =\n  k * (a1 * x + b1 * y + c1 * z + d1)\n\ngoal (1 subgoal):\n 1. on_sphere_circle_r4_r3 pv1 w = on_sphere_circle_r4_r3 pv2 w", "using * **"], ["proof (prove)\nusing this:\n  k * a1 * x + k * b1 * y + k * c1 * z + k * d1 =\n  k * (a1 * x + b1 * y + c1 * z + d1)\n  pv1 = (a1, b1, c1, d1)\n  pv2 = (a2, b2, c2, d2)\n  w = (x, y, z)\n  a2 = k * a1\n  b2 = k * b1\n  c2 = k * c1\n  d2 = k * d1\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. on_sphere_circle_r4_r3 pv1 w = on_sphere_circle_r4_r3 pv2 w", "by simp"], ["proof (state)\nthis:\n  on_sphere_circle_r4_r3 pv1 w = on_sphere_circle_r4_r3 pv2 w\n\ngoal:\nNo subgoals!", "qed"], ["", "definition sphere_circle_set where\n  \"sphere_circle_set \\<alpha> = {A. on_sphere_circle \\<alpha> A}\""], ["", "(* ----------------------------------------------------------------- *)"], ["", "subsection \\<open>Connections of circlines in the plane and circles on the Riemann sphere\\<close>"], ["", "(* ----------------------------------------------------------------- *)"], ["", "text \\<open>We introduce stereographic and inverse stereographic projection between circles on the Riemann\nsphere and circlines in the extended complex plane.\\<close>"], ["", "definition inv_stereographic_circline_cmat_r4 :: \"complex_mat \\<Rightarrow> R4\" where\n  [simp]: \"inv_stereographic_circline_cmat_r4 H  =\n            (let (A, B, C, D) = H\n              in (Re (B+C), Re(\\<i>*(C-B)), Re(A-D), Re(D+A)))\""], ["", "lift_definition inv_stereographic_circline_clmat_pv :: \"circline_mat \\<Rightarrow> plane_vec\" is inv_stereographic_circline_cmat_r4"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>prod.\n       hermitean prod \\<and> prod \\<noteq> mat_zero \\<Longrightarrow>\n       inv_stereographic_circline_cmat_r4 prod \\<in> plane_vectors", "by (auto simp add: hermitean_def mat_adj_def mat_cnj_def real_imag_0 eq_cnj_iff_real)"], ["", "lift_definition inv_stereographic_circline :: \"circline \\<Rightarrow> plane\" is inv_stereographic_circline_clmat_pv"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>circline_mat1 circline_mat2.\n       circline_eq_clmat circline_mat1 circline_mat2 \\<Longrightarrow>\n       plane_vec_eq (inv_stereographic_circline_clmat_pv circline_mat1)\n        (inv_stereographic_circline_clmat_pv circline_mat2)", "apply transfer"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>circline_mat1 circline_mat2.\n       \\<lbrakk>hermitean circline_mat1 \\<and>\n                circline_mat1 \\<noteq> mat_zero;\n        hermitean circline_mat2 \\<and> circline_mat2 \\<noteq> mat_zero;\n        circline_eq_cmat circline_mat1 circline_mat2\\<rbrakk>\n       \\<Longrightarrow> plane_vec_eq_r4\n                          (inv_stereographic_circline_cmat_r4 circline_mat1)\n                          (inv_stereographic_circline_cmat_r4 circline_mat2)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>circline_mat1 circline_mat2.\n       \\<lbrakk>hermitean circline_mat1 \\<and>\n                circline_mat1 \\<noteq> (0, 0, 0, 0);\n        hermitean circline_mat2 \\<and> circline_mat2 \\<noteq> (0, 0, 0, 0);\n        \\<exists>k.\n           k \\<noteq> 0 \\<and>\n           circline_mat2 = cor k *\\<^sub>s\\<^sub>m circline_mat1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            k \\<noteq> 0 \\<and>\n                            (case circline_mat2 of\n                             (A, B, C, D) \\<Rightarrow>\n                               (Re B + Re C, Im B - Im C, Re A - Re D,\n                                Re D + Re A)) =\n                            k *\\<^sub>s\\<^sub>v\\<^sub>4\n                            (case circline_mat1 of\n                             (A, B, C, D) \\<Rightarrow>\n                               (Re B + Re C, Im B - Im C, Re A - Re D,\n                                Re D + Re A))", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>circline_mat1 circline_mat2 k.\n       \\<lbrakk>hermitean circline_mat1 \\<and>\n                circline_mat1 \\<noteq> (0, 0, 0, 0);\n        hermitean circline_mat2 \\<and> circline_mat2 \\<noteq> (0, 0, 0, 0);\n        k \\<noteq> 0 \\<and>\n        circline_mat2 = cor k *\\<^sub>s\\<^sub>m circline_mat1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            k \\<noteq> 0 \\<and>\n                            (case circline_mat2 of\n                             (A, B, C, D) \\<Rightarrow>\n                               (Re B + Re C, Im B - Im C, Re A - Re D,\n                                Re D + Re A)) =\n                            k *\\<^sub>s\\<^sub>v\\<^sub>4\n                            (case circline_mat1 of\n                             (A, B, C, D) \\<Rightarrow>\n                               (Re B + Re C, Im B - Im C, Re A - Re D,\n                                Re D + Re A))", "apply (rule_tac x=\"k\" in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>circline_mat1 circline_mat2 k.\n       \\<lbrakk>hermitean circline_mat1 \\<and>\n                circline_mat1 \\<noteq> (0, 0, 0, 0);\n        hermitean circline_mat2 \\<and> circline_mat2 \\<noteq> (0, 0, 0, 0);\n        k \\<noteq> 0 \\<and>\n        circline_mat2 = cor k *\\<^sub>s\\<^sub>m circline_mat1\\<rbrakk>\n       \\<Longrightarrow> k \\<noteq> 0 \\<and>\n                         (case circline_mat2 of\n                          (A, B, C, D) \\<Rightarrow>\n                            (Re B + Re C, Im B - Im C, Re A - Re D,\n                             Re D + Re A)) =\n                         k *\\<^sub>s\\<^sub>v\\<^sub>4\n                         (case circline_mat1 of\n                          (A, B, C, D) \\<Rightarrow>\n                            (Re B + Re C, Im B - Im C, Re A - Re D,\n                             Re D + Re A))", "apply (case_tac \"circline_mat1\", case_tac \"circline_mat2\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>circline_mat1 circline_mat2 k a b c d aa ba ca da.\n       \\<lbrakk>hermitean circline_mat1 \\<and>\n                circline_mat1 \\<noteq> (0, 0, 0, 0);\n        hermitean circline_mat2 \\<and> circline_mat2 \\<noteq> (0, 0, 0, 0);\n        k \\<noteq> 0 \\<and>\n        circline_mat2 = cor k *\\<^sub>s\\<^sub>m circline_mat1;\n        circline_mat1 = (a, b, c, d);\n        circline_mat2 = (aa, ba, ca, da)\\<rbrakk>\n       \\<Longrightarrow> k \\<noteq> 0 \\<and>\n                         (case circline_mat2 of\n                          (A, B, C, D) \\<Rightarrow>\n                            (Re B + Re C, Im B - Im C, Re A - Re D,\n                             Re D + Re A)) =\n                         k *\\<^sub>s\\<^sub>v\\<^sub>4\n                         (case circline_mat1 of\n                          (A, B, C, D) \\<Rightarrow>\n                            (Re B + Re C, Im B - Im C, Re A - Re D,\n                             Re D + Re A))", "apply (simp add: field_simps)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition stereographic_circline_r4_cmat :: \"R4 \\<Rightarrow> complex_mat\" where\n[simp]: \"stereographic_circline_r4_cmat \\<alpha> =\n         (let (a, b, c, d) = \\<alpha>\n           in (cor ((c+d)/2) , ((cor a + \\<i> * cor b)/2), ((cor a - \\<i> * cor b)/2), cor ((d-c)/2)))\""], ["", "lift_definition stereographic_circline_pv_clmat :: \"plane_vec \\<Rightarrow> circline_mat\" is stereographic_circline_r4_cmat"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>prod.\n       prod \\<in> plane_vectors \\<Longrightarrow>\n       hermitean (stereographic_circline_r4_cmat prod) \\<and>\n       stereographic_circline_r4_cmat prod \\<noteq> mat_zero", "by (auto simp add: hermitean_def mat_adj_def mat_cnj_def)"], ["", "lift_definition stereographic_circline :: \"plane \\<Rightarrow> circline\" is stereographic_circline_pv_clmat"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2.\n       plane_vec_eq plane_vec1 plane_vec2 \\<Longrightarrow>\n       circline_eq_clmat (stereographic_circline_pv_clmat plane_vec1)\n        (stereographic_circline_pv_clmat plane_vec2)", "apply transfer"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2.\n       \\<lbrakk>plane_vec1 \\<in> plane_vectors;\n        plane_vec2 \\<in> plane_vectors;\n        plane_vec_eq_r4 plane_vec1 plane_vec2\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (stereographic_circline_r4_cmat plane_vec1)\n                          (stereographic_circline_r4_cmat plane_vec2)", "apply transfer"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>plane_vec1 plane_vec2.\n       \\<lbrakk>plane_vec1 \\<in> plane_vectors;\n        plane_vec2 \\<in> plane_vectors;\n        plane_vec_eq_r4 plane_vec1 plane_vec2\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (stereographic_circline_r4_cmat plane_vec1)\n                          (stereographic_circline_r4_cmat plane_vec2)", "apply (case_tac plane_vec1, case_tac plane_vec2, simp, erule exE, rule_tac x=k in exI, simp add: field_simps)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text \\<open>Stereographic and inverse stereographic projection of circlines are mutually inverse.\\<close>"], ["", "lemma stereographic_circline_inv_stereographic_circline:\n  shows \"stereographic_circline \\<circ> inv_stereographic_circline = id\""], ["proof (prove)\ngoal (1 subgoal):\n 1. stereographic_circline \\<circ> inv_stereographic_circline = id", "proof (rule ext, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. stereographic_circline (inv_stereographic_circline x) = x", "fix H"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. stereographic_circline (inv_stereographic_circline x) = x", "show \"stereographic_circline (inv_stereographic_circline H) = H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. stereographic_circline (inv_stereographic_circline H) = H", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>H.\n       hermitean H \\<and> H \\<noteq> mat_zero \\<Longrightarrow>\n       circline_eq_cmat\n        (stereographic_circline_r4_cmat\n          (inv_stereographic_circline_cmat_r4 H))\n        H", "fix H"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>H.\n       hermitean H \\<and> H \\<noteq> mat_zero \\<Longrightarrow>\n       circline_eq_cmat\n        (stereographic_circline_r4_cmat\n          (inv_stereographic_circline_cmat_r4 H))\n        H", "assume hh: \"hermitean H \\<and> H \\<noteq> mat_zero\""], ["proof (state)\nthis:\n  hermitean H \\<and> H \\<noteq> mat_zero\n\ngoal (1 subgoal):\n 1. \\<And>H.\n       hermitean H \\<and> H \\<noteq> mat_zero \\<Longrightarrow>\n       circline_eq_cmat\n        (stereographic_circline_r4_cmat\n          (inv_stereographic_circline_cmat_r4 H))\n        H", "obtain A B C D where HH: \"H = (A, B, C, D)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A B C D.\n        H = (A, B, C, D) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases \"H\") auto"], ["proof (state)\nthis:\n  H = (A, B, C, D)\n\ngoal (1 subgoal):\n 1. \\<And>H.\n       hermitean H \\<and> H \\<noteq> mat_zero \\<Longrightarrow>\n       circline_eq_cmat\n        (stereographic_circline_r4_cmat\n          (inv_stereographic_circline_cmat_r4 H))\n        H", "have \"is_real A\" \"is_real D\" \"C = cnj B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_real A &&& is_real D &&& C = cnj B", "using HH hh hermitean_elems[of A B C D]"], ["proof (prove)\nusing this:\n  H = (A, B, C, D)\n  hermitean H \\<and> H \\<noteq> mat_zero\n  hermitean (A, B, C, D) \\<Longrightarrow> is_real A\n  hermitean (A, B, C, D) \\<Longrightarrow> is_real D\n  hermitean (A, B, C, D) \\<Longrightarrow> B = cnj C\n  hermitean (A, B, C, D) \\<Longrightarrow> cnj B = C\n\ngoal (1 subgoal):\n 1. is_real A &&& is_real D &&& C = cnj B", "by auto"], ["proof (state)\nthis:\n  is_real A\n  is_real D\n  C = cnj B\n\ngoal (1 subgoal):\n 1. \\<And>H.\n       hermitean H \\<and> H \\<noteq> mat_zero \\<Longrightarrow>\n       circline_eq_cmat\n        (stereographic_circline_r4_cmat\n          (inv_stereographic_circline_cmat_r4 H))\n        H", "thus \"circline_eq_cmat (stereographic_circline_r4_cmat (inv_stereographic_circline_cmat_r4 H)) H\""], ["proof (prove)\nusing this:\n  is_real A\n  is_real D\n  C = cnj B\n\ngoal (1 subgoal):\n 1. circline_eq_cmat\n     (stereographic_circline_r4_cmat (inv_stereographic_circline_cmat_r4 H))\n     H", "using HH"], ["proof (prove)\nusing this:\n  is_real A\n  is_real D\n  C = cnj B\n  H = (A, B, C, D)\n\ngoal (1 subgoal):\n 1. circline_eq_cmat\n     (stereographic_circline_r4_cmat (inv_stereographic_circline_cmat_r4 H))\n     H", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>is_real A; is_real D; C = cnj B; H = (A, B, cnj B, D)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k.\n                         k \\<noteq> 0 \\<and>\n                         (A = 0 \\<or> k = 1) \\<and>\n                         B * 2 =\n                         cor k *\n                         (2 * cor (Re B) + \\<i> * (2 * cor (Im B))) \\<and>\n                         cnj B * 2 =\n                         cor k *\n                         (2 * cor (Re B) - \\<i> * (2 * cor (Im B))) \\<and>\n                         (D = 0 \\<or> k = 1)", "apply (rule_tac x=1 in exI, cases B)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x1 x2.\n       \\<lbrakk>is_real A; is_real D; C = cnj B; H = (A, B, cnj B, D);\n        B = Complex x1 x2\\<rbrakk>\n       \\<Longrightarrow> 1 \\<noteq> 0 \\<and>\n                         (A = 0 \\<or> 1 = 1) \\<and>\n                         B * 2 =\n                         cor 1 *\n                         (2 * cor (Re B) + \\<i> * (2 * cor (Im B))) \\<and>\n                         cnj B * 2 =\n                         cor 1 *\n                         (2 * cor (Re B) - \\<i> * (2 * cor (Im B))) \\<and>\n                         (D = 0 \\<or> 1 = 1)", "by (smt add_uminus_conv_diff complex_cnj_add complex_cnj_complex_of_real complex_cnj_i complex_cnj_mult complex_cnj_one complex_eq distrib_left_numeral mult.commute mult.left_commute mult.left_neutral mult_cancel_right2 mult_minus_left of_real_1 one_add_one)"], ["proof (state)\nthis:\n  circline_eq_cmat\n   (stereographic_circline_r4_cmat (inv_stereographic_circline_cmat_r4 H)) H\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  stereographic_circline (inv_stereographic_circline H) = H\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Stereographic and inverse stereographic projection of circlines are mutually inverse.\\<close>"], ["", "lemma inv_stereographic_circline_stereographic_circline:\n  \"inv_stereographic_circline \\<circ> stereographic_circline = id\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_stereographic_circline \\<circ> stereographic_circline = id", "proof (rule ext, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. inv_stereographic_circline (stereographic_circline x) = x", "fix \\<alpha>"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. inv_stereographic_circline (stereographic_circline x) = x", "show \"inv_stereographic_circline (stereographic_circline \\<alpha>) = \\<alpha>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_stereographic_circline (stereographic_circline \\<alpha>) = \\<alpha>", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>\\<alpha>.\n       \\<alpha> \\<in> plane_vectors \\<Longrightarrow>\n       plane_vec_eq_r4\n        (inv_stereographic_circline_cmat_r4\n          (stereographic_circline_r4_cmat \\<alpha>))\n        \\<alpha>", "fix \\<alpha>"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>\\<alpha>.\n       \\<alpha> \\<in> plane_vectors \\<Longrightarrow>\n       plane_vec_eq_r4\n        (inv_stereographic_circline_cmat_r4\n          (stereographic_circline_r4_cmat \\<alpha>))\n        \\<alpha>", "assume aa: \"\\<alpha> \\<in> plane_vectors\""], ["proof (state)\nthis:\n  \\<alpha> \\<in> plane_vectors\n\ngoal (1 subgoal):\n 1. \\<And>\\<alpha>.\n       \\<alpha> \\<in> plane_vectors \\<Longrightarrow>\n       plane_vec_eq_r4\n        (inv_stereographic_circline_cmat_r4\n          (stereographic_circline_r4_cmat \\<alpha>))\n        \\<alpha>", "obtain a b c d where AA: \"\\<alpha> = (a, b, c, d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>a b c d.\n        \\<alpha> = (a, b, c, d) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases \"\\<alpha>\") auto"], ["proof (state)\nthis:\n  \\<alpha> = (a, b, c, d)\n\ngoal (1 subgoal):\n 1. \\<And>\\<alpha>.\n       \\<alpha> \\<in> plane_vectors \\<Longrightarrow>\n       plane_vec_eq_r4\n        (inv_stereographic_circline_cmat_r4\n          (stereographic_circline_r4_cmat \\<alpha>))\n        \\<alpha>", "thus \"plane_vec_eq_r4 (inv_stereographic_circline_cmat_r4 (stereographic_circline_r4_cmat \\<alpha>)) \\<alpha>\""], ["proof (prove)\nusing this:\n  \\<alpha> = (a, b, c, d)\n\ngoal (1 subgoal):\n 1. plane_vec_eq_r4\n     (inv_stereographic_circline_cmat_r4\n       (stereographic_circline_r4_cmat \\<alpha>))\n     \\<alpha>", "using AA"], ["proof (prove)\nusing this:\n  \\<alpha> = (a, b, c, d)\n  \\<alpha> = (a, b, c, d)\n\ngoal (1 subgoal):\n 1. plane_vec_eq_r4\n     (inv_stereographic_circline_cmat_r4\n       (stereographic_circline_r4_cmat \\<alpha>))\n     \\<alpha>", "by simp (rule_tac x=1 in exI, auto simp add: field_simps complex_of_real_def)"], ["proof (state)\nthis:\n  plane_vec_eq_r4\n   (inv_stereographic_circline_cmat_r4\n     (stereographic_circline_r4_cmat \\<alpha>))\n   \\<alpha>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inv_stereographic_circline (stereographic_circline \\<alpha>) = \\<alpha>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma stereographic_sphere_circle_set'':\n  shows \"on_sphere_circle (inv_stereographic_circline H) z \\<longleftrightarrow>\n         on_circline H (stereographic z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. on_sphere_circle (inv_stereographic_circline H) z =\n    on_circline H (stereographic z)", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>H z.\n       \\<lbrakk>hermitean H \\<and> H \\<noteq> mat_zero;\n        z \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3\n                          (inv_stereographic_circline_cmat_r4 H) z =\n                         on_circline_cmat_cvec H (stereographic_r3_cvec z)", "fix M :: R3 and H :: complex_mat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>H z.\n       \\<lbrakk>hermitean H \\<and> H \\<noteq> mat_zero;\n        z \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3\n                          (inv_stereographic_circline_cmat_r4 H) z =\n                         on_circline_cmat_cvec H (stereographic_r3_cvec z)", "assume hh: \"hermitean H \\<and> H \\<noteq> mat_zero\" \"M \\<in> unit_sphere\""], ["proof (state)\nthis:\n  hermitean H \\<and> H \\<noteq> mat_zero\n  M \\<in> unit_sphere\n\ngoal (1 subgoal):\n 1. \\<And>H z.\n       \\<lbrakk>hermitean H \\<and> H \\<noteq> mat_zero;\n        z \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3\n                          (inv_stereographic_circline_cmat_r4 H) z =\n                         on_circline_cmat_cvec H (stereographic_r3_cvec z)", "obtain A B C D where HH: \"H = (A, B, C, D)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A B C D.\n        H = (A, B, C, D) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases \"H\") auto"], ["proof (state)\nthis:\n  H = (A, B, C, D)\n\ngoal (1 subgoal):\n 1. \\<And>H z.\n       \\<lbrakk>hermitean H \\<and> H \\<noteq> mat_zero;\n        z \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3\n                          (inv_stereographic_circline_cmat_r4 H) z =\n                         on_circline_cmat_cvec H (stereographic_r3_cvec z)", "have *: \"is_real A\" \"is_real D\" \"C = cnj B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_real A &&& is_real D &&& C = cnj B", "using hh HH hermitean_elems[of A B C D]"], ["proof (prove)\nusing this:\n  hermitean H \\<and> H \\<noteq> mat_zero\n  M \\<in> unit_sphere\n  H = (A, B, C, D)\n  hermitean (A, B, C, D) \\<Longrightarrow> is_real A\n  hermitean (A, B, C, D) \\<Longrightarrow> is_real D\n  hermitean (A, B, C, D) \\<Longrightarrow> B = cnj C\n  hermitean (A, B, C, D) \\<Longrightarrow> cnj B = C\n\ngoal (1 subgoal):\n 1. is_real A &&& is_real D &&& C = cnj B", "by auto"], ["proof (state)\nthis:\n  is_real A\n  is_real D\n  C = cnj B\n\ngoal (1 subgoal):\n 1. \\<And>H z.\n       \\<lbrakk>hermitean H \\<and> H \\<noteq> mat_zero;\n        z \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3\n                          (inv_stereographic_circline_cmat_r4 H) z =\n                         on_circline_cmat_cvec H (stereographic_r3_cvec z)", "obtain x y z where MM: \"M = (x, y, z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x y z. M = (x, y, z) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases \"M\") auto"], ["proof (state)\nthis:\n  M = (x, y, z)\n\ngoal (1 subgoal):\n 1. \\<And>H z.\n       \\<lbrakk>hermitean H \\<and> H \\<noteq> mat_zero;\n        z \\<in> unit_sphere\\<rbrakk>\n       \\<Longrightarrow> on_sphere_circle_r4_r3\n                          (inv_stereographic_circline_cmat_r4 H) z =\n                         on_circline_cmat_cvec H (stereographic_r3_cvec z)", "show \"on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M \\<longleftrightarrow>\n        on_circline_cmat_cvec H (stereographic_r3_cvec M)\" (is \"?lhs = ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M =\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H)\n     M \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)\n 2. on_circline_cmat_cvec H (stereographic_r3_cvec M) \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "assume ?lhs"], ["proof (state)\nthis:\n  on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n\ngoal (2 subgoals):\n 1. on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H)\n     M \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)\n 2. on_circline_cmat_cvec H (stereographic_r3_cvec M) \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "show ?rhs"], ["proof (prove)\ngoal (1 subgoal):\n 1. on_circline_cmat_cvec H (stereographic_r3_cvec M)", "proof (cases \"z=1\")"], ["proof (state)\ngoal (2 subgoals):\n 1. z = 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)\n 2. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "case True"], ["proof (state)\nthis:\n  z = 1\n\ngoal (2 subgoals):\n 1. z = 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)\n 2. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "hence \"x = 0\" \"y = 0\""], ["proof (prove)\nusing this:\n  z = 1\n\ngoal (1 subgoal):\n 1. x = 0 &&& y = 0", "using MM hh"], ["proof (prove)\nusing this:\n  z = 1\n  M = (x, y, z)\n  hermitean H \\<and> H \\<noteq> mat_zero\n  M \\<in> unit_sphere\n\ngoal (1 subgoal):\n 1. x = 0 &&& y = 0", "by auto"], ["proof (state)\nthis:\n  x = 0\n  y = 0\n\ngoal (2 subgoals):\n 1. z = 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)\n 2. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "thus ?thesis"], ["proof (prove)\nusing this:\n  x = 0\n  y = 0\n\ngoal (1 subgoal):\n 1. on_circline_cmat_cvec H (stereographic_r3_cvec M)", "using * \\<open>?lhs\\<close> HH MM \\<open>z=1\\<close>"], ["proof (prove)\nusing this:\n  x = 0\n  y = 0\n  is_real A\n  is_real D\n  C = cnj B\n  on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n  H = (A, B, C, D)\n  M = (x, y, z)\n  z = 1\n\ngoal (1 subgoal):\n 1. on_circline_cmat_cvec H (stereographic_r3_cvec M)", "by (cases A, simp add: vec_cnj_def Complex_eq Let_def)"], ["proof (state)\nthis:\n  on_circline_cmat_cvec H (stereographic_r3_cvec M)\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "case False"], ["proof (state)\nthis:\n  z \\<noteq> 1\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "hence \"Re A*(1+z) + 2*Re B*x + 2*Im B*y + Re D*(1-z) = 0\""], ["proof (prove)\nusing this:\n  z \\<noteq> 1\n\ngoal (1 subgoal):\n 1. Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0", "using * \\<open>?lhs\\<close> HH MM"], ["proof (prove)\nusing this:\n  z \\<noteq> 1\n  is_real A\n  is_real D\n  C = cnj B\n  on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n  H = (A, B, C, D)\n  M = (x, y, z)\n\ngoal (1 subgoal):\n 1. Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0", "by (simp add: Let_def field_simps)"], ["proof (state)\nthis:\n  Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "hence \"(Re A*(1+z) + 2*Re B*x + 2*Im B*y + Re D*(1-z))*(1-z) = 0\""], ["proof (prove)\nusing this:\n  Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0\n\ngoal (1 subgoal):\n 1. (Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z)) *\n    (1 - z) =\n    0", "by simp"], ["proof (state)\nthis:\n  (Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z)) *\n  (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "hence \"Re A*(1+z)*(1-z) + 2*Re B*x*(1-z) + 2*Im B*y*(1-z) + Re D*(1-z)*(1-z) = 0\""], ["proof (prove)\nusing this:\n  (Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z)) *\n  (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. Re A * (1 + z) * (1 - z) + 2 * Re B * x * (1 - z) +\n    2 * Im B * y * (1 - z) +\n    Re D * (1 - z) * (1 - z) =\n    0", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  Re A * (1 + z) * (1 - z) + 2 * Re B * x * (1 - z) +\n  2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "moreover"], ["proof (state)\nthis:\n  Re A * (1 + z) * (1 - z) + 2 * Re B * x * (1 - z) +\n  2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "have \"x*x+y*y = (1+z)*(1-z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x * x + y * y = (1 + z) * (1 - z)", "using MM hh"], ["proof (prove)\nusing this:\n  M = (x, y, z)\n  hermitean H \\<and> H \\<noteq> mat_zero\n  M \\<in> unit_sphere\n\ngoal (1 subgoal):\n 1. x * x + y * y = (1 + z) * (1 - z)", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  x * x + y * y = (1 + z) * (1 - z)\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "ultimately"], ["proof (chain)\npicking this:\n  Re A * (1 + z) * (1 - z) + 2 * Re B * x * (1 - z) +\n  2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n  x * x + y * y = (1 + z) * (1 - z)", "have \"Re A*(x*x+y*y) + 2*Re B*x*(1-z) + 2*Im B*y*(1-z) + Re D*(1-z)*(1-z) = 0\""], ["proof (prove)\nusing this:\n  Re A * (1 + z) * (1 - z) + 2 * Re B * x * (1 - z) +\n  2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n  x * x + y * y = (1 + z) * (1 - z)\n\ngoal (1 subgoal):\n 1. Re A * (x * x + y * y) + 2 * Re B * x * (1 - z) +\n    2 * Im B * y * (1 - z) +\n    Re D * (1 - z) * (1 - z) =\n    0", "by simp"], ["proof (state)\nthis:\n  Re A * (x * x + y * y) + 2 * Re B * x * (1 - z) + 2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "hence \"(x * Re A + (1 - z) * Re B) * x - (- (y * Re A) + - ((1 - z) * Im B)) * y + (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) = 0\""], ["proof (prove)\nusing this:\n  Re A * (x * x + y * y) + 2 * Re B * x * (1 - z) + 2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. (x * Re A + (1 - z) * Re B) * x -\n    (- (y * Re A) + - ((1 - z) * Im B)) * y +\n    (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n    0", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  (x * Re A + (1 - z) * Re B) * x -\n  (- (y * Re A) + - ((1 - z) * Im B)) * y +\n  (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_circline_cmat_cvec H (stereographic_r3_cvec M)", "thus ?thesis"], ["proof (prove)\nusing this:\n  (x * Re A + (1 - z) * Re B) * x -\n  (- (y * Re A) + - ((1 - z) * Im B)) * y +\n  (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. on_circline_cmat_cvec H (stereographic_r3_cvec M)", "using \\<open>z \\<noteq> 1\\<close> HH MM * \\<open>Re A*(1+z) + 2*Re B*x + 2*Im B*y + Re D*(1-z) = 0\\<close>"], ["proof (prove)\nusing this:\n  (x * Re A + (1 - z) * Re B) * x -\n  (- (y * Re A) + - ((1 - z) * Im B)) * y +\n  (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n  0\n  z \\<noteq> 1\n  H = (A, B, C, D)\n  M = (x, y, z)\n  is_real A\n  is_real D\n  C = cnj B\n  Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0\n\ngoal (1 subgoal):\n 1. on_circline_cmat_cvec H (stereographic_r3_cvec M)", "apply (simp add: Let_def vec_cnj_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(x * Re A + (1 - z) * Re B) * x -\n             (- (y * Re A) - (1 - z) * Im B) * y +\n             (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n             0;\n     z \\<noteq> 1; H = (A, B, cnj B, D); M = (x, y, z); is_real A;\n     is_real D; C = cnj B;\n     Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) =\n     0\\<rbrakk>\n    \\<Longrightarrow> ((cor x - \\<i> * cor y) * A + (1 - cor z) * cnj B) *\n                      (cor x + \\<i> * cor y) +\n                      ((cor x - \\<i> * cor y) * B + (1 - cor z) * D) *\n                      (1 - cor z) =\n                      0", "apply (subst complex_eq_iff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(x * Re A + (1 - z) * Re B) * x -\n             (- (y * Re A) - (1 - z) * Im B) * y +\n             (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n             0;\n     z \\<noteq> 1; H = (A, B, cnj B, D); M = (x, y, z); is_real A;\n     is_real D; C = cnj B;\n     Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) =\n     0\\<rbrakk>\n    \\<Longrightarrow> Re (((cor x - \\<i> * cor y) * A +\n                           (1 - cor z) * cnj B) *\n                          (cor x + \\<i> * cor y) +\n                          ((cor x - \\<i> * cor y) * B + (1 - cor z) * D) *\n                          (1 - cor z)) =\n                      Re 0 \\<and>\n                      Im (((cor x - \\<i> * cor y) * A +\n                           (1 - cor z) * cnj B) *\n                          (cor x + \\<i> * cor y) +\n                          ((cor x - \\<i> * cor y) * B + (1 - cor z) * D) *\n                          (1 - cor z)) =\n                      Im 0", "apply (simp add: field_simps)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  on_circline_cmat_cvec H (stereographic_r3_cvec M)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  on_circline_cmat_cvec H (stereographic_r3_cvec M)\n\ngoal (1 subgoal):\n 1. on_circline_cmat_cvec H (stereographic_r3_cvec M) \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. on_circline_cmat_cvec H (stereographic_r3_cvec M) \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "assume ?rhs"], ["proof (state)\nthis:\n  on_circline_cmat_cvec H (stereographic_r3_cvec M)\n\ngoal (1 subgoal):\n 1. on_circline_cmat_cvec H (stereographic_r3_cvec M) \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "show ?lhs"], ["proof (prove)\ngoal (1 subgoal):\n 1. on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "proof (cases \"z=1\")"], ["proof (state)\ngoal (2 subgoals):\n 1. z = 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n 2. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "case True"], ["proof (state)\nthis:\n  z = 1\n\ngoal (2 subgoals):\n 1. z = 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n 2. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "hence \"x = 0\" \"y = 0\""], ["proof (prove)\nusing this:\n  z = 1\n\ngoal (1 subgoal):\n 1. x = 0 &&& y = 0", "using MM hh"], ["proof (prove)\nusing this:\n  z = 1\n  M = (x, y, z)\n  hermitean H \\<and> H \\<noteq> mat_zero\n  M \\<in> unit_sphere\n\ngoal (1 subgoal):\n 1. x = 0 &&& y = 0", "by auto"], ["proof (state)\nthis:\n  x = 0\n  y = 0\n\ngoal (2 subgoals):\n 1. z = 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n 2. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "thus ?thesis"], ["proof (prove)\nusing this:\n  x = 0\n  y = 0\n\ngoal (1 subgoal):\n 1. on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "using HH MM \\<open>?rhs\\<close> \\<open>z = 1\\<close>"], ["proof (prove)\nusing this:\n  x = 0\n  y = 0\n  H = (A, B, C, D)\n  M = (x, y, z)\n  on_circline_cmat_cvec H (stereographic_r3_cvec M)\n  z = 1\n\ngoal (1 subgoal):\n 1. on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "by (simp add: Let_def vec_cnj_def)"], ["proof (state)\nthis:\n  on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "case False"], ["proof (state)\nthis:\n  z \\<noteq> 1\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "hence \"(x * Re A + (1 - z) * Re B) * x - (- (y * Re A) + - ((1 - z) * Im B)) * y + (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) = 0\""], ["proof (prove)\nusing this:\n  z \\<noteq> 1\n\ngoal (1 subgoal):\n 1. (x * Re A + (1 - z) * Re B) * x -\n    (- (y * Re A) + - ((1 - z) * Im B)) * y +\n    (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n    0", "using HH MM * \\<open>?rhs\\<close>"], ["proof (prove)\nusing this:\n  z \\<noteq> 1\n  H = (A, B, C, D)\n  M = (x, y, z)\n  is_real A\n  is_real D\n  C = cnj B\n  on_circline_cmat_cvec H (stereographic_r3_cvec M)\n\ngoal (1 subgoal):\n 1. (x * Re A + (1 - z) * Re B) * x -\n    (- (y * Re A) + - ((1 - z) * Im B)) * y +\n    (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n    0", "by (simp add: Let_def vec_cnj_def complex_eq_iff)"], ["proof (state)\nthis:\n  (x * Re A + (1 - z) * Re B) * x -\n  (- (y * Re A) + - ((1 - z) * Im B)) * y +\n  (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "hence \"Re A*(x*x+y*y) + 2*Re B*x*(1-z) + 2*Im B*y*(1-z) + Re D*(1-z)*(1-z) = 0\""], ["proof (prove)\nusing this:\n  (x * Re A + (1 - z) * Re B) * x -\n  (- (y * Re A) + - ((1 - z) * Im B)) * y +\n  (x * Re B + y * Im B + (1 - z) * Re D) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. Re A * (x * x + y * y) + 2 * Re B * x * (1 - z) +\n    2 * Im B * y * (1 - z) +\n    Re D * (1 - z) * (1 - z) =\n    0", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  Re A * (x * x + y * y) + 2 * Re B * x * (1 - z) + 2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "moreover"], ["proof (state)\nthis:\n  Re A * (x * x + y * y) + 2 * Re B * x * (1 - z) + 2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "have \"x*x + y*y = (1+z)*(1-z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x * x + y * y = (1 + z) * (1 - z)", "using MM hh"], ["proof (prove)\nusing this:\n  M = (x, y, z)\n  hermitean H \\<and> H \\<noteq> mat_zero\n  M \\<in> unit_sphere\n\ngoal (1 subgoal):\n 1. x * x + y * y = (1 + z) * (1 - z)", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  x * x + y * y = (1 + z) * (1 - z)\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "ultimately"], ["proof (chain)\npicking this:\n  Re A * (x * x + y * y) + 2 * Re B * x * (1 - z) + 2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n  x * x + y * y = (1 + z) * (1 - z)", "have \"Re A*(1+z)*(1-z) + 2*Re B*x*(1-z) + 2*Im B*y*(1-z) + Re D*(1-z)*(1-z) = 0\""], ["proof (prove)\nusing this:\n  Re A * (x * x + y * y) + 2 * Re B * x * (1 - z) + 2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n  x * x + y * y = (1 + z) * (1 - z)\n\ngoal (1 subgoal):\n 1. Re A * (1 + z) * (1 - z) + 2 * Re B * x * (1 - z) +\n    2 * Im B * y * (1 - z) +\n    Re D * (1 - z) * (1 - z) =\n    0", "by simp"], ["proof (state)\nthis:\n  Re A * (1 + z) * (1 - z) + 2 * Re B * x * (1 - z) +\n  2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "hence \"(Re A*(1+z) + 2*Re B*x + 2*Im B*y + Re D*(1-z))*(1-z) = 0\""], ["proof (prove)\nusing this:\n  Re A * (1 + z) * (1 - z) + 2 * Re B * x * (1 - z) +\n  2 * Im B * y * (1 - z) +\n  Re D * (1 - z) * (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. (Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z)) *\n    (1 - z) =\n    0", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  (Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z)) *\n  (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "hence \"Re A*(1+z) + 2*Re B*x + 2*Im B*y + Re D*(1-z) = 0\""], ["proof (prove)\nusing this:\n  (Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z)) *\n  (1 - z) =\n  0\n\ngoal (1 subgoal):\n 1. Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0", "using \\<open>z \\<noteq> 1\\<close>"], ["proof (prove)\nusing this:\n  (Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z)) *\n  (1 - z) =\n  0\n  z \\<noteq> 1\n\ngoal (1 subgoal):\n 1. Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0", "by simp"], ["proof (state)\nthis:\n  Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0\n\ngoal (1 subgoal):\n 1. z \\<noteq> 1 \\<Longrightarrow>\n    on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "thus ?thesis"], ["proof (prove)\nusing this:\n  Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0\n\ngoal (1 subgoal):\n 1. on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "using MM HH *"], ["proof (prove)\nusing this:\n  Re A * (1 + z) + 2 * Re B * x + 2 * Im B * y + Re D * (1 - z) = 0\n  M = (x, y, z)\n  H = (A, B, C, D)\n  is_real A\n  is_real D\n  C = cnj B\n\ngoal (1 subgoal):\n 1. on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  on_sphere_circle_r4_r3 (inv_stereographic_circline_cmat_r4 H) M =\n  on_circline_cmat_cvec H (stereographic_r3_cvec M)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma stereographic_sphere_circle_set' [simp]:\n  shows \"stereographic ` sphere_circle_set (inv_stereographic_circline H) =\n         circline_set H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. stereographic ` sphere_circle_set (inv_stereographic_circline H) =\n    circline_set H", "unfolding sphere_circle_set_def circline_set_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. stereographic `\n    Collect (on_sphere_circle (inv_stereographic_circline H)) =\n    Collect (on_circline H)", "apply safe"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       on_sphere_circle (inv_stereographic_circline H) xa \\<Longrightarrow>\n       on_circline H (stereographic xa)\n 2. \\<And>x.\n       on_circline H x \\<Longrightarrow>\n       x \\<in> stereographic `\n               Collect (on_sphere_circle (inv_stereographic_circline H))", "proof-"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       on_sphere_circle (inv_stereographic_circline H) xa \\<Longrightarrow>\n       on_circline H (stereographic xa)\n 2. \\<And>x.\n       on_circline H x \\<Longrightarrow>\n       x \\<in> stereographic `\n               Collect (on_sphere_circle (inv_stereographic_circline H))", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       on_sphere_circle (inv_stereographic_circline H) xa \\<Longrightarrow>\n       on_circline H (stereographic xa)\n 2. \\<And>x.\n       on_circline H x \\<Longrightarrow>\n       x \\<in> stereographic `\n               Collect (on_sphere_circle (inv_stereographic_circline H))", "assume \"on_sphere_circle (inv_stereographic_circline H) x\""], ["proof (state)\nthis:\n  on_sphere_circle (inv_stereographic_circline H) x\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       on_sphere_circle (inv_stereographic_circline H) xa \\<Longrightarrow>\n       on_circline H (stereographic xa)\n 2. \\<And>x.\n       on_circline H x \\<Longrightarrow>\n       x \\<in> stereographic `\n               Collect (on_sphere_circle (inv_stereographic_circline H))", "thus \"on_circline H (stereographic x)\""], ["proof (prove)\nusing this:\n  on_sphere_circle (inv_stereographic_circline H) x\n\ngoal (1 subgoal):\n 1. on_circline H (stereographic x)", "using stereographic_sphere_circle_set''"], ["proof (prove)\nusing this:\n  on_sphere_circle (inv_stereographic_circline H) x\n  on_sphere_circle (inv_stereographic_circline ?H) ?z =\n  on_circline ?H (stereographic ?z)\n\ngoal (1 subgoal):\n 1. on_circline H (stereographic x)", "by simp"], ["proof (state)\nthis:\n  on_circline H (stereographic x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       on_circline H x \\<Longrightarrow>\n       x \\<in> stereographic `\n               Collect (on_sphere_circle (inv_stereographic_circline H))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       on_circline H x \\<Longrightarrow>\n       x \\<in> stereographic `\n               Collect (on_sphere_circle (inv_stereographic_circline H))", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       on_circline H x \\<Longrightarrow>\n       x \\<in> stereographic `\n               Collect (on_sphere_circle (inv_stereographic_circline H))", "assume \"on_circline H x\""], ["proof (state)\nthis:\n  on_circline H x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       on_circline H x \\<Longrightarrow>\n       x \\<in> stereographic `\n               Collect (on_sphere_circle (inv_stereographic_circline H))", "show \"x \\<in> stereographic ` {z. on_sphere_circle (inv_stereographic_circline H) z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> stereographic `\n            {z. on_sphere_circle (inv_stereographic_circline H) z}", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. x = stereographic ?x\n 2. ?x \\<in> {z. on_sphere_circle (inv_stereographic_circline H) z}", "show \"x = stereographic (inv_stereographic x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = stereographic (inv_stereographic x)", "by simp"], ["proof (state)\nthis:\n  x = stereographic (inv_stereographic x)\n\ngoal (1 subgoal):\n 1. inv_stereographic x\n    \\<in> {z. on_sphere_circle (inv_stereographic_circline H) z}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. inv_stereographic x\n    \\<in> {z. on_sphere_circle (inv_stereographic_circline H) z}", "show \"inv_stereographic x \\<in> {z. on_sphere_circle (inv_stereographic_circline H) z}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_stereographic x\n    \\<in> {z. on_sphere_circle (inv_stereographic_circline H) z}", "using stereographic_sphere_circle_set''[of H \"inv_stereographic x\"] \\<open>on_circline H x\\<close>"], ["proof (prove)\nusing this:\n  on_sphere_circle (inv_stereographic_circline H) (inv_stereographic x) =\n  on_circline H (stereographic (inv_stereographic x))\n  on_circline H x\n\ngoal (1 subgoal):\n 1. inv_stereographic x\n    \\<in> {z. on_sphere_circle (inv_stereographic_circline H) z}", "by simp"], ["proof (state)\nthis:\n  inv_stereographic x\n  \\<in> {z. on_sphere_circle (inv_stereographic_circline H) z}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x \\<in> stereographic `\n          {z. on_sphere_circle (inv_stereographic_circline H) z}\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The projection of the set of points on a circle on the Riemann sphere is exactly the set of\npoints on the circline obtained by the just introduced circle stereographic projection.\\<close>"], ["", "lemma stereographic_sphere_circle_set:\n  shows \"stereographic ` sphere_circle_set H = circline_set (stereographic_circline H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. stereographic ` sphere_circle_set H =\n    circline_set (stereographic_circline H)", "using stereographic_sphere_circle_set'[of \"stereographic_circline H\"]"], ["proof (prove)\nusing this:\n  stereographic `\n  sphere_circle_set\n   (inv_stereographic_circline (stereographic_circline H)) =\n  circline_set (stereographic_circline H)\n\ngoal (1 subgoal):\n 1. stereographic ` sphere_circle_set H =\n    circline_set (stereographic_circline H)", "using inv_stereographic_circline_stereographic_circline"], ["proof (prove)\nusing this:\n  stereographic `\n  sphere_circle_set\n   (inv_stereographic_circline (stereographic_circline H)) =\n  circline_set (stereographic_circline H)\n  inv_stereographic_circline \\<circ> stereographic_circline = id\n\ngoal (1 subgoal):\n 1. stereographic ` sphere_circle_set H =\n    circline_set (stereographic_circline H)", "unfolding comp_def"], ["proof (prove)\nusing this:\n  stereographic `\n  sphere_circle_set\n   (inv_stereographic_circline (stereographic_circline H)) =\n  circline_set (stereographic_circline H)\n  (\\<lambda>x. inv_stereographic_circline (stereographic_circline x)) = id\n\ngoal (1 subgoal):\n 1. stereographic ` sphere_circle_set H =\n    circline_set (stereographic_circline H)", "by (metis id_apply)"], ["", "text \\<open>Stereographic projection of circlines is bijective.\\<close>"], ["", "lemma bij_stereographic_circline:\n  shows \"bij stereographic_circline\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij stereographic_circline", "using stereographic_circline_inv_stereographic_circline inv_stereographic_circline_stereographic_circline"], ["proof (prove)\nusing this:\n  stereographic_circline \\<circ> inv_stereographic_circline = id\n  inv_stereographic_circline \\<circ> stereographic_circline = id\n\ngoal (1 subgoal):\n 1. bij stereographic_circline", "using o_bij"], ["proof (prove)\nusing this:\n  stereographic_circline \\<circ> inv_stereographic_circline = id\n  inv_stereographic_circline \\<circ> stereographic_circline = id\n  \\<lbrakk>?g \\<circ> ?f = id; ?f \\<circ> ?g = id\\<rbrakk>\n  \\<Longrightarrow> bij ?f\n\ngoal (1 subgoal):\n 1. bij stereographic_circline", "by blast"], ["", "text \\<open>Inverse stereographic projection is bijective.\\<close>"], ["", "lemma bij_inv_stereographic_circline:\n  shows \"bij inv_stereographic_circline\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij inv_stereographic_circline", "using stereographic_circline_inv_stereographic_circline inv_stereographic_circline_stereographic_circline"], ["proof (prove)\nusing this:\n  stereographic_circline \\<circ> inv_stereographic_circline = id\n  inv_stereographic_circline \\<circ> stereographic_circline = id\n\ngoal (1 subgoal):\n 1. bij inv_stereographic_circline", "using o_bij"], ["proof (prove)\nusing this:\n  stereographic_circline \\<circ> inv_stereographic_circline = id\n  inv_stereographic_circline \\<circ> stereographic_circline = id\n  \\<lbrakk>?g \\<circ> ?f = id; ?f \\<circ> ?g = id\\<rbrakk>\n  \\<Longrightarrow> bij ?f\n\ngoal (1 subgoal):\n 1. bij inv_stereographic_circline", "by blast"], ["", "end"]]}