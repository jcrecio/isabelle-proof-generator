{"file_name": "/home/qj213/afp-2021-10-22/thys/Complex_Geometry/Unit_Circle_Preserving_Moebius.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Complex_Geometry", "problem_names": ["lemma unit_circle_fix_iff:\n  shows \"unit_circle_fix M \\<longleftrightarrow> \n         moebius_circline M unit_circle = unit_circle\" (is \"?rhs = ?lhs\")", "lemma circline_set_fix_iff_circline_fix:\n  assumes \"circline_set H' \\<noteq> {}\"\n  shows \"circline_set (moebius_circline M H) = circline_set H' \\<longleftrightarrow> \n         moebius_circline M H = H'\"", "lemma unit_circle_fix_iff_unit_circle_set:\n  shows \"unit_circle_fix M \\<longleftrightarrow> moebius_pt M ` unit_circle_set = unit_circle_set\"", "lemma unit_circle_fix_id_moebius [simp]:\n  shows \"unit_circle_fix id_moebius\"", "lemma unit_circle_fix_moebius_add [simp]:\n  assumes \"unit_circle_fix M1\" and \"unit_circle_fix M2\"\n  shows \"unit_circle_fix (M1 + M2)\"", "lemma unit_circle_fix_moebius_comp [simp]:\n  assumes \"unit_circle_fix M1\" and \"unit_circle_fix M2\"\n  shows \"unit_circle_fix (moebius_comp M1 M2)\"", "lemma unit_circle_fix_moebius_uminus [simp]:\n  assumes \"unit_circle_fix M\"\n  shows \"unit_circle_fix (-M)\"", "lemma unit_circle_fix_moebius_inv [simp]:\n  assumes \"unit_circle_fix M\"\n  shows \"unit_circle_fix (moebius_inv M)\"", "lemma unit_circle_fix_moebius_pt_inversion [simp]:\n  assumes \"unit_circle_fix M\"\n  shows \"moebius_pt M (inversion z) = inversion (moebius_pt M z)\"", "lemma imag_unit_circle_fixed_iff_unitary_gen:\n  assumes \"mat_det (A, B, C, D) \\<noteq> 0\"\n  shows \"moebius_circline (mk_moebius A B C D) imag_unit_circle = imag_unit_circle \\<longleftrightarrow>\n         unitary_gen (A, B, C, D)\" (is \"?lhs = ?rhs\")", "lemma unit_disc_fix_unit_circle_fix [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_circle_fix M\"", "lemma unit_disc_fix_iff_ounit_circle:\n  shows \"unit_disc_fix M \\<longleftrightarrow> \n         moebius_ocircline M ounit_circle = ounit_circle\" (is \"?rhs \\<longleftrightarrow> ?lhs\")", "lemma unit_disc_fix_iff [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"moebius_pt M ` unit_disc = unit_disc\"", "lemma unit_disc_fix_discI [simp]:\n  assumes \"unit_disc_fix M\" and \"u \\<in> unit_disc\"\n  shows \"moebius_pt M u \\<in> unit_disc\"", "lemma unit_disc_fix_id_moebius [simp]:\n  shows \"unit_disc_fix id_moebius\"", "lemma unit_disc_fix_moebius_add [simp]:\n  assumes \"unit_disc_fix M1\" and \"unit_disc_fix M2\"\n  shows \"unit_disc_fix (M1 + M2)\"", "lemma unit_disc_fix_moebius_comp [simp]:\n  assumes \"unit_disc_fix M1\" and \"unit_disc_fix M2\"\n  shows \"unit_disc_fix (moebius_comp M1 M2)\"", "lemma unit_disc_fix_moebius_uminus [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix (-M)\"", "lemma unit_disc_fix_moebius_inv [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix (moebius_inv M)\"", "lemma unit_disc_fix_rotation [simp]:\n  shows \"unit_disc_fix (moebius_rotation \\<phi>)\"", "lemma moebius_rotation_unit_circle_fix [simp]:\n  shows \"moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_circle_set \\<longleftrightarrow> u \\<in> unit_circle_set\"", "lemma ex_rotation_mapping_u_to_positive_x_axis:\n  assumes \"u \\<noteq> 0\\<^sub>h\" and \"u \\<noteq> \\<infinity>\\<^sub>h\"\n  shows \"\\<exists> \\<phi>. moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\"", "lemma ex_rotation_mapping_u_to_positive_y_axis:\n  assumes \"u \\<noteq> 0\\<^sub>h\" and \"u \\<noteq> \\<infinity>\\<^sub>h\"\n  shows \"\\<exists> \\<phi>. moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis\"", "lemma wlog_rotation_to_positive_x_axis:\n  assumes in_disc: \"u \\<in> unit_disc\" and not_zero: \"u \\<noteq> 0\\<^sub>h\"\n  assumes preserving: \"\\<And>\\<phi> u. \\<lbrakk>u \\<in> unit_disc; u \\<noteq> 0\\<^sub>h; P (moebius_pt (moebius_rotation \\<phi>) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes x_axis: \"\\<And>x. \\<lbrakk>is_real x; 0 < Re x; Re x < 1\\<rbrakk> \\<Longrightarrow> P (of_complex x)\"\n  shows \"P u\"", "lemma wlog_rotation_to_positive_x_axis':\n  assumes not_zero: \"u \\<noteq> 0\\<^sub>h\" and not_inf: \"u \\<noteq> \\<infinity>\\<^sub>h\"\n  assumes preserving: \"\\<And>\\<phi> u. \\<lbrakk>u \\<noteq> 0\\<^sub>h; u \\<noteq> \\<infinity>\\<^sub>h; P (moebius_pt (moebius_rotation \\<phi>) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes x_axis: \"\\<And>x. \\<lbrakk>is_real x; 0 < Re x\\<rbrakk> \\<Longrightarrow> P (of_complex x)\"\n  shows \"P u\"", "lemma wlog_rotation_to_positive_y_axis:\n  assumes in_disc: \"u \\<in> unit_disc\" and not_zero: \"u \\<noteq> 0\\<^sub>h\"\n  assumes preserving: \"\\<And>\\<phi> u. \\<lbrakk>u \\<in> unit_disc; u \\<noteq> 0\\<^sub>h; P (moebius_pt (moebius_rotation \\<phi>) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes y_axis: \"\\<And>x. \\<lbrakk>is_imag x; 0 < Im x; Im x < 1\\<rbrakk> \\<Longrightarrow> P (of_complex x)\"\n  shows \"P u\"", "lemma blaschke_0_id [simp]: \"blaschke 0 = id_moebius\"", "lemma blaschke_a_to_zero [simp]:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h\"", "lemma blaschke_inv_a_inf [simp]:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"moebius_pt (blaschke a) (inversion (of_complex a)) = \\<infinity>\\<^sub>h\"", "lemma blaschke_inf [simp]:\n  assumes \"cmod a < 1\" and \"a \\<noteq> 0\"\n  shows \"moebius_pt (blaschke a) \\<infinity>\\<^sub>h = of_complex (- 1 / cnj a)\"", "lemma blaschke_0_minus_a [simp]:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"moebius_pt (blaschke a) 0\\<^sub>h = ~\\<^sub>h (of_complex a)\"", "lemma blaschke_unit_circle_fix [simp]:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"unit_circle_fix (blaschke a)\"", "lemma blaschke_unit_disc_fix [simp]:\n  assumes \"cmod a < 1\"\n  shows \"unit_disc_fix (blaschke a)\"", "lemma blaschke_unit_circle_fix':\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"moebius_circline (blaschke a) unit_circle = unit_circle\"", "lemma blaschke_ounit_circle_fix':\n  assumes \"cmod a < 1\"\n  shows \"moebius_ocircline (blaschke a) ounit_circle = ounit_circle\"", "lemma moebius_pt_blaschke [simp]:\n  assumes \"cmod a \\<noteq> 1\" and \"z \\<noteq> 1 / cnj a\"\n  shows \"moebius_pt (blaschke a) (of_complex z) = of_complex ((z - a) / (1 - cnj a * z))\"", "lemma blaschke_real_preserve_x_axis [simp]:\n  assumes \"is_real a\" and \"cmod a < 1\"\n  shows \"moebius_pt (blaschke a) z \\<in> circline_set x_axis \\<longleftrightarrow> z \\<in> circline_set x_axis\"", "lemma blaschke_real_preserve_sgn_Im [simp]:\n  assumes \"is_real a\" and \"cmod a < 1\" and \"z \\<noteq> \\<infinity>\\<^sub>h\" and \"z \\<noteq> inversion (of_complex a)\"\n  shows \"sgn (Im (to_complex (moebius_pt (blaschke a) z))) = sgn (Im (to_complex z))\"", "lemma blaschke_real_preserve_sgn_arg [simp]:\n  assumes \"is_real a\" and \"cmod a < 1\" and \"z \\<notin> circline_set x_axis\"\n  shows \"sgn (arg (to_complex (moebius_pt (blaschke a) z))) = sgn (arg (to_complex z))\"", "lemma inv_blaschke_neg [simp]: \"inv_blaschke a = blaschke (-a)\"", "lemma inv_blaschke:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"blaschke a + inv_blaschke a = 0\"", "lemma ex_unit_disc_fix_mapping_u_to_zero:\n  assumes \"u \\<in> unit_disc\"\n  shows \"\\<exists> M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h\"", "lemma wlog_zero:\n  assumes in_disc: \"u \\<in> unit_disc\"\n  assumes preserving: \"\\<And> a u. \\<lbrakk>u \\<in> unit_disc; cmod a < 1; P (moebius_pt (blaschke a) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes zero: \"P 0\\<^sub>h\"\n  shows \"P u\"", "lemma wlog_real_zero:\n  assumes in_disc: \"u \\<in> unit_disc\" and real: \"is_real (to_complex u)\"\n  assumes preserving: \"\\<And> a u. \\<lbrakk>u \\<in> unit_disc; is_real a; cmod a < 1; P (moebius_pt (blaschke a) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes zero: \"P 0\\<^sub>h\"\n  shows \"P u\"", "lemma unit_disc_fix_transitive:\n  assumes in_disc: \"u \\<in> unit_disc\" and \"u' \\<in> unit_disc\"\n  shows \"\\<exists> M. unit_disc_fix M \\<and> moebius_pt M u = u'\"", "lemma unit_disc_fix_decompose_blaschke_rotation:\n  assumes \"unit_disc_fix M\"\n  shows \"\\<exists> k \\<phi>. cmod k < 1 \\<and> M = moebius_rotation \\<phi> + blaschke k\"", "lemma wlog_unit_disc_fix:\n  assumes \"unit_disc_fix M\"\n  assumes b: \"\\<And> k. cmod k < 1 \\<Longrightarrow> P (blaschke k)\"\n  assumes r: \"\\<And> \\<phi>. P (moebius_rotation \\<phi>)\"\n  assumes comp: \"\\<And>M1 M2. \\<lbrakk>unit_disc_fix M1; P M1; unit_disc_fix M2; P M2\\<rbrakk> \\<Longrightarrow> P (M1 + M2)\"\n  shows \"P M\"", "lemma ex_unit_disc_fix_to_zero_positive_x_axis:\n  assumes \"u \\<in> unit_disc\" and \"v \\<in> unit_disc\" and \"u \\<noteq> v\"\n  shows \"\\<exists> M. unit_disc_fix M \\<and>\n              moebius_pt M u = 0\\<^sub>h \\<and> moebius_pt M v \\<in> positive_x_axis\"", "lemma wlog_x_axis:\n  assumes in_disc: \"u \\<in> unit_disc\" \"v \\<in> unit_disc\"\n  assumes preserved: \"\\<And> M u v. \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc; P (moebius_pt M u) (moebius_pt M v)\\<rbrakk> \\<Longrightarrow> P u v\"\n  assumes axis: \"\\<And> x. \\<lbrakk>is_real x; 0 \\<le> Re x;  Re x < 1\\<rbrakk> \\<Longrightarrow> P 0\\<^sub>h (of_complex x)\"\n  shows \"P u v\"", "lemma wlog_positive_x_axis:\n  assumes in_disc: \"u \\<in> unit_disc\" \"v \\<in> unit_disc\" \"u \\<noteq> v\"\n  assumes preserved: \"\\<And> M u v. \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc; u \\<noteq> v; P (moebius_pt M u) (moebius_pt M v)\\<rbrakk> \\<Longrightarrow> P u v\"\n  assumes axis: \"\\<And> x. \\<lbrakk>is_real x; 0 < Re x;  Re x < 1\\<rbrakk> \\<Longrightarrow> P 0\\<^sub>h (of_complex x)\"\n  shows \"P u v\"", "lemma unit_disc_fix_f_unit_disc:\n  assumes \"unit_disc_fix_f M\"\n  shows \"M ` unit_disc = unit_disc\"", "lemma unit_disc_fix_f_moebius_pt [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix_f (moebius_pt M)\"", "lemma unit_disc_fix_conjugate_moebius [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix (conjugate_moebius M)\"", "lemma unit_disc_fix_conjugate_comp_moebius [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix_f (conjugate \\<circ> moebius_pt M)\"", "lemma unit_disc_fix_f_comp [simp]:\n  assumes \"unit_disc_fix_f f1\" and \"unit_disc_fix_f f2\"\n  shows \"unit_disc_fix_f (f1 \\<circ> f2)\"", "lemma unit_disc_fix_f_inv:\n  assumes \"unit_disc_fix_f M\"\n  shows \"unit_disc_fix_f (inv M)\"", "lemma unique_moebius_pt_conjugate:\n  assumes \"moebius_pt M1 \\<circ> conjugate = moebius_pt M2 \\<circ> conjugate\"\n  shows \"M1 = M2\"", "lemma unit_disc_fix_f_circline_direct:\n  assumes \"unit_disc_fix M\" and \"f = moebius_pt M\"\n  shows \"unit_disc_fix_f_circline f H = moebius_circline M H\"", "lemma unit_disc_fix_f_circline_indirect:\n  assumes \"unit_disc_fix M\" and \"f = moebius_pt M \\<circ> conjugate\"\n  shows \"unit_disc_fix_f_circline f H = ((moebius_circline M) \\<circ> conjugate_circline) H\""], "translations": [["", "lemma unit_circle_fix_iff:\n  shows \"unit_circle_fix M \\<longleftrightarrow> \n         moebius_circline M unit_circle = unit_circle\" (is \"?rhs = ?lhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix M = (moebius_circline M unit_circle = unit_circle)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. unit_circle_fix M \\<Longrightarrow>\n    moebius_circline M unit_circle = unit_circle\n 2. moebius_circline M unit_circle = unit_circle \\<Longrightarrow>\n    unit_circle_fix M", "assume ?lhs"], ["proof (state)\nthis:\n  moebius_circline M unit_circle = unit_circle\n\ngoal (2 subgoals):\n 1. unit_circle_fix M \\<Longrightarrow>\n    moebius_circline M unit_circle = unit_circle\n 2. moebius_circline M unit_circle = unit_circle \\<Longrightarrow>\n    unit_circle_fix M", "thus ?rhs"], ["proof (prove)\nusing this:\n  moebius_circline M unit_circle = unit_circle\n\ngoal (1 subgoal):\n 1. unit_circle_fix M", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0;\n        circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        circline_eq_clmat (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unitary11_gen M", "fix M :: complex_mat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0;\n        circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        circline_eq_clmat (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unitary11_gen M", "assume \"mat_det M \\<noteq> 0\""], ["proof (state)\nthis:\n  mat_det M \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0;\n        circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        circline_eq_clmat (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unitary11_gen M", "assume \"circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat) unit_circle_cmat\""], ["proof (state)\nthis:\n  circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n   unit_circle_cmat\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0;\n        circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        circline_eq_clmat (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unitary11_gen M", "then"], ["proof (chain)\npicking this:\n  circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n   unit_circle_cmat", "obtain k where \"k \\<noteq> 0\" \"(1, 0, 0, -1) = cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, -1)\""], ["proof (prove)\nusing this:\n  circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n   unit_circle_cmat\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         (1, 0, 0, - 1) =\n         cor k *\\<^sub>s\\<^sub>m\n         congruence (mat_inv M) (1, 0, 0, - 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0;\n        circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        circline_eq_clmat (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unitary11_gen M", "hence \"(1/cor k, 0, 0, -1/cor k) = congruence (mat_inv M) (1, 0, 0, -1)\""], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. (1 / cor k, 0, 0, - 1 / cor k) = congruence (mat_inv M) (1, 0, 0, - 1)", "using mult_sm_inv_l[of \"cor k\" \"congruence (mat_inv M) (1, 0, 0, -1)\" ]"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n  \\<lbrakk>cor k \\<noteq> 0;\n   cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1) =\n   ?B\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv M) (1, 0, 0, - 1) =\n                    (1 / cor k) *\\<^sub>s\\<^sub>m ?B\n\ngoal (1 subgoal):\n 1. (1 / cor k, 0, 0, - 1 / cor k) = congruence (mat_inv M) (1, 0, 0, - 1)", "by simp"], ["proof (state)\nthis:\n  (1 / cor k, 0, 0, - 1 / cor k) = congruence (mat_inv M) (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0;\n        circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        circline_eq_clmat (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unitary11_gen M", "hence \"congruence M (1/cor k, 0, 0, -1/cor k) = (1, 0, 0, -1)\""], ["proof (prove)\nusing this:\n  (1 / cor k, 0, 0, - 1 / cor k) = congruence (mat_inv M) (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. congruence M (1 / cor k, 0, 0, - 1 / cor k) = (1, 0, 0, - 1)", "using \\<open>mat_det M \\<noteq> 0\\<close> mat_det_inv[of M]"], ["proof (prove)\nusing this:\n  (1 / cor k, 0, 0, - 1 / cor k) = congruence (mat_inv M) (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n  mat_det M \\<noteq> 0 \\<Longrightarrow> mat_det (mat_inv M) = 1 / mat_det M\n\ngoal (1 subgoal):\n 1. congruence M (1 / cor k, 0, 0, - 1 / cor k) = (1, 0, 0, - 1)", "using congruence_inv[of \"mat_inv M\" \"(1, 0, 0, -1)\" \"(1/cor k, 0, 0, -1/cor k)\"]"], ["proof (prove)\nusing this:\n  (1 / cor k, 0, 0, - 1 / cor k) = congruence (mat_inv M) (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n  mat_det M \\<noteq> 0 \\<Longrightarrow> mat_det (mat_inv M) = 1 / mat_det M\n  \\<lbrakk>mat_det (mat_inv M) \\<noteq> 0;\n   congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1 / cor k, 0, 0, - 1 / cor k)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv (mat_inv M))\n                     (1 / cor k, 0, 0, - 1 / cor k) =\n                    (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. congruence M (1 / cor k, 0, 0, - 1 / cor k) = (1, 0, 0, - 1)", "by simp"], ["proof (state)\nthis:\n  congruence M (1 / cor k, 0, 0, - 1 / cor k) = (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0;\n        circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        circline_eq_clmat (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unitary11_gen M", "hence \"congruence M (1, 0, 0, -1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, -1)\""], ["proof (prove)\nusing this:\n  congruence M (1 / cor k, 0, 0, - 1 / cor k) = (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "using congruence_scale_m[of \"M\" \"1/cor k\" \"(1, 0, 0, -1)\"]"], ["proof (prove)\nusing this:\n  congruence M (1 / cor k, 0, 0, - 1 / cor k) = (1, 0, 0, - 1)\n  congruence M ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n  (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "using mult_sm_inv_l[of \"1/ cor k\" \"congruence M (1, 0, 0, -1)\"  \"(1, 0, 0, -1)\"] \\<open>k \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  congruence M (1 / cor k, 0, 0, - 1 / cor k) = (1, 0, 0, - 1)\n  congruence M ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n  (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1)\n  \\<lbrakk>1 / cor k \\<noteq> 0;\n   (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1) =\n   (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence M (1, 0, 0, - 1) =\n                    (1 / (1 / cor k)) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "by simp"], ["proof (state)\nthis:\n  congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0;\n        circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        circline_eq_clmat (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unitary11_gen M", "thus \"unitary11_gen M\""], ["proof (prove)\nusing this:\n  congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. unitary11_gen M", "using \\<open>k \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. unitary11_gen M", "unfolding unitary11_gen_def"], ["proof (prove)\nusing this:\n  congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       congruence M (1, 0, 0, - 1) = k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "by simp"], ["proof (state)\nthis:\n  unitary11_gen M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  unit_circle_fix M\n\ngoal (1 subgoal):\n 1. unit_circle_fix M \\<Longrightarrow>\n    moebius_circline M unit_circle = unit_circle", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. unit_circle_fix M \\<Longrightarrow>\n    moebius_circline M unit_circle = unit_circle", "assume ?rhs"], ["proof (state)\nthis:\n  unit_circle_fix M\n\ngoal (1 subgoal):\n 1. unit_circle_fix M \\<Longrightarrow>\n    moebius_circline M unit_circle = unit_circle", "thus ?lhs"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n\ngoal (1 subgoal):\n 1. moebius_circline M unit_circle = unit_circle", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        unit_circle_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "fix M :: complex_mat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        unit_circle_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "assume \"mat_det M \\<noteq> 0\""], ["proof (state)\nthis:\n  mat_det M \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        unit_circle_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "assume \"unitary11_gen M\""], ["proof (state)\nthis:\n  unitary11_gen M\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        unit_circle_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "hence \"unitary11_gen (mat_inv M)\""], ["proof (prove)\nusing this:\n  unitary11_gen M\n\ngoal (1 subgoal):\n 1. unitary11_gen (mat_inv M)", "using \\<open>mat_det M \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  unitary11_gen M\n  mat_det M \\<noteq> 0\n\ngoal (1 subgoal):\n 1. unitary11_gen (mat_inv M)", "using unitary11_gen_mat_inv"], ["proof (prove)\nusing this:\n  unitary11_gen M\n  mat_det M \\<noteq> 0\n  \\<lbrakk>unitary11_gen ?M; mat_det ?M \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> unitary11_gen (mat_inv ?M)\n\ngoal (1 subgoal):\n 1. unitary11_gen (mat_inv M)", "by simp"], ["proof (state)\nthis:\n  unitary11_gen (mat_inv M)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        unit_circle_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "thus \" circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat) unit_circle_cmat\""], ["proof (prove)\nusing this:\n  unitary11_gen (mat_inv M)\n\ngoal (1 subgoal):\n 1. circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n     unit_circle_cmat", "unfolding unitary11_gen_real"], ["proof (prove)\nusing this:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     congruence (mat_inv M) (1, 0, 0, - 1) =\n     cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n     unit_circle_cmat", "by auto (rule_tac x=\"1/k\" in exI, simp)"], ["proof (state)\nthis:\n  circline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n   unit_circle_cmat\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  moebius_circline M unit_circle = unit_circle\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma circline_set_fix_iff_circline_fix:\n  assumes \"circline_set H' \\<noteq> {}\"\n  shows \"circline_set (moebius_circline M H) = circline_set H' \\<longleftrightarrow> \n         moebius_circline M H = H'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (circline_set (moebius_circline M H) = circline_set H') =\n    (moebius_circline M H = H')", "using assms"], ["proof (prove)\nusing this:\n  circline_set H' \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (circline_set (moebius_circline M H) = circline_set H') =\n    (moebius_circline M H = H')", "by auto (rule inj_circline_set, auto)"], ["", "lemma unit_circle_fix_iff_unit_circle_set:\n  shows \"unit_circle_fix M \\<longleftrightarrow> moebius_pt M ` unit_circle_set = unit_circle_set\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix M = (moebius_pt M ` unit_circle_set = unit_circle_set)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. unit_circle_fix M = (moebius_pt M ` unit_circle_set = unit_circle_set)", "have \"circline_set unit_circle \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. circline_set unit_circle \\<noteq> {}", "using one_in_unit_circle_set"], ["proof (prove)\nusing this:\n  1\\<^sub>h \\<in> circline_set unit_circle\n\ngoal (1 subgoal):\n 1. circline_set unit_circle \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  circline_set unit_circle \\<noteq> {}\n\ngoal (1 subgoal):\n 1. unit_circle_fix M = (moebius_pt M ` unit_circle_set = unit_circle_set)", "thus ?thesis"], ["proof (prove)\nusing this:\n  circline_set unit_circle \\<noteq> {}\n\ngoal (1 subgoal):\n 1. unit_circle_fix M = (moebius_pt M ` unit_circle_set = unit_circle_set)", "using unit_circle_fix_iff[of M] circline_set_fix_iff_circline_fix[of unit_circle M unit_circle]"], ["proof (prove)\nusing this:\n  circline_set unit_circle \\<noteq> {}\n  unit_circle_fix M = (moebius_circline M unit_circle = unit_circle)\n  circline_set unit_circle \\<noteq> {} \\<Longrightarrow>\n  (circline_set (moebius_circline M unit_circle) =\n   circline_set unit_circle) =\n  (moebius_circline M unit_circle = unit_circle)\n\ngoal (1 subgoal):\n 1. unit_circle_fix M = (moebius_pt M ` unit_circle_set = unit_circle_set)", "by (simp add: unit_circle_set_def)"], ["proof (state)\nthis:\n  unit_circle_fix M = (moebius_pt M ` unit_circle_set = unit_circle_set)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Unit circle preserving M?bius transformations form a group. \\<close>"], ["", "lemma unit_circle_fix_id_moebius [simp]:\n  shows \"unit_circle_fix id_moebius\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix id_moebius", "by (transfer, transfer, simp add: unitary11_gen_def mat_adj_def mat_cnj_def)"], ["", "lemma unit_circle_fix_moebius_add [simp]:\n  assumes \"unit_circle_fix M1\" and \"unit_circle_fix M2\"\n  shows \"unit_circle_fix (M1 + M2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix (M1 + M2)", "using assms"], ["proof (prove)\nusing this:\n  unit_circle_fix M1\n  unit_circle_fix M2\n\ngoal (1 subgoal):\n 1. unit_circle_fix (M1 + M2)", "unfolding unit_circle_fix_iff"], ["proof (prove)\nusing this:\n  moebius_circline M1 unit_circle = unit_circle\n  moebius_circline M2 unit_circle = unit_circle\n\ngoal (1 subgoal):\n 1. moebius_circline (M1 + M2) unit_circle = unit_circle", "by auto"], ["", "lemma unit_circle_fix_moebius_comp [simp]:\n  assumes \"unit_circle_fix M1\" and \"unit_circle_fix M2\"\n  shows \"unit_circle_fix (moebius_comp M1 M2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix (moebius_comp M1 M2)", "using unit_circle_fix_moebius_add[OF assms]"], ["proof (prove)\nusing this:\n  unit_circle_fix (M1 + M2)\n\ngoal (1 subgoal):\n 1. unit_circle_fix (moebius_comp M1 M2)", "by simp"], ["", "lemma unit_circle_fix_moebius_uminus [simp]:\n  assumes \"unit_circle_fix M\"\n  shows \"unit_circle_fix (-M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix (- M)", "using assms"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n\ngoal (1 subgoal):\n 1. unit_circle_fix (- M)", "unfolding unit_circle_fix_iff"], ["proof (prove)\nusing this:\n  moebius_circline M unit_circle = unit_circle\n\ngoal (1 subgoal):\n 1. moebius_circline (- M) unit_circle = unit_circle", "by (metis moebius_circline_comp_inv_left uminus_moebius_def)"], ["", "lemma unit_circle_fix_moebius_inv [simp]:\n  assumes \"unit_circle_fix M\"\n  shows \"unit_circle_fix (moebius_inv M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix (moebius_inv M)", "using unit_circle_fix_moebius_uminus[OF assms]"], ["proof (prove)\nusing this:\n  unit_circle_fix (- M)\n\ngoal (1 subgoal):\n 1. unit_circle_fix (moebius_inv M)", "by simp"], ["", "text \\<open>Unit circle fixing transforms preserve inverse points.\\<close>"], ["", "lemma unit_circle_fix_moebius_pt_inversion [simp]:\n  assumes \"unit_circle_fix M\"\n  shows \"moebius_pt M (inversion z) = inversion (moebius_pt M z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt M (inversion z) = inversion (moebius_pt M z)", "using assms"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n\ngoal (1 subgoal):\n 1. moebius_pt M (inversion z) = inversion (moebius_pt M z)", "using symmetry_principle[of z \"inversion z\" unit_circle M]"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n  circline_symmetric z (inversion z) unit_circle \\<Longrightarrow>\n  circline_symmetric (moebius_pt M z) (moebius_pt M (inversion z))\n   (moebius_circline M unit_circle)\n\ngoal (1 subgoal):\n 1. moebius_pt M (inversion z) = inversion (moebius_pt M z)", "using unit_circle_fix_iff[of M, symmetric]"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n  circline_symmetric z (inversion z) unit_circle \\<Longrightarrow>\n  circline_symmetric (moebius_pt M z) (moebius_pt M (inversion z))\n   (moebius_circline M unit_circle)\n  (moebius_circline M unit_circle = unit_circle) = unit_circle_fix M\n\ngoal (1 subgoal):\n 1. moebius_pt M (inversion z) = inversion (moebius_pt M z)", "using circline_symmetric_inv_homo_disc[of z]"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n  circline_symmetric z (inversion z) unit_circle \\<Longrightarrow>\n  circline_symmetric (moebius_pt M z) (moebius_pt M (inversion z))\n   (moebius_circline M unit_circle)\n  (moebius_circline M unit_circle = unit_circle) = unit_circle_fix M\n  circline_symmetric z (inversion z) unit_circle\n\ngoal (1 subgoal):\n 1. moebius_pt M (inversion z) = inversion (moebius_pt M z)", "using circline_symmetric_inv_homo_disc'[of \"moebius_pt M z\" \"moebius_pt M (inversion z)\"]"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n  circline_symmetric z (inversion z) unit_circle \\<Longrightarrow>\n  circline_symmetric (moebius_pt M z) (moebius_pt M (inversion z))\n   (moebius_circline M unit_circle)\n  (moebius_circline M unit_circle = unit_circle) = unit_circle_fix M\n  circline_symmetric z (inversion z) unit_circle\n  circline_symmetric (moebius_pt M z) (moebius_pt M (inversion z))\n   unit_circle \\<Longrightarrow>\n  moebius_pt M (inversion z) = inversion (moebius_pt M z)\n\ngoal (1 subgoal):\n 1. moebius_pt M (inversion z) = inversion (moebius_pt M z)", "by metis"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsection \\<open>M?bius transformations that fix the imaginary unit circle\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "text \\<open>Only for completeness we show that M?bius transformations that preserve the imaginary unit\ncircle are exactly those characterised by generalized unitary matrices (with the (2, 0) signature).\\<close>"], ["", "lemma imag_unit_circle_fixed_iff_unitary_gen:\n  assumes \"mat_det (A, B, C, D) \\<noteq> 0\"\n  shows \"moebius_circline (mk_moebius A B C D) imag_unit_circle = imag_unit_circle \\<longleftrightarrow>\n         unitary_gen (A, B, C, D)\" (is \"?lhs = ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (moebius_circline (mk_moebius A B C D) imag_unit_circle =\n     imag_unit_circle) =\n    unitary_gen (A, B, C, D)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle \\<Longrightarrow>\n    unitary_gen (A, B, C, D)\n 2. unitary_gen (A, B, C, D) \\<Longrightarrow>\n    moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle", "assume ?lhs"], ["proof (state)\nthis:\n  moebius_circline (mk_moebius A B C D) imag_unit_circle = imag_unit_circle\n\ngoal (2 subgoals):\n 1. moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle \\<Longrightarrow>\n    unitary_gen (A, B, C, D)\n 2. unitary_gen (A, B, C, D) \\<Longrightarrow>\n    moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle", "thus ?rhs"], ["proof (prove)\nusing this:\n  moebius_circline (mk_moebius A B C D) imag_unit_circle = imag_unit_circle\n\ngoal (1 subgoal):\n 1. unitary_gen (A, B, C, D)", "using assms"], ["proof (prove)\nusing this:\n  moebius_circline (mk_moebius A B C D) imag_unit_circle = imag_unit_circle\n  mat_det (A, B, C, D) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. unitary_gen (A, B, C, D)", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>circline_eq_cmat\n                 (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n                   imag_unit_circle_cmat)\n                 imag_unit_circle_cmat;\n        mat_det (A, B, C, D) \\<noteq> 0;\n        circline_eq_clmat\n         (moebius_circline_mmat_clmat (mk_moebius_mat Aa Ba Ca Da)\n           imag_unit_circle_clmat)\n         imag_unit_circle_clmat;\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> unitary_gen (A, B, C, D)", "fix A B C D :: complex"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>circline_eq_cmat\n                 (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n                   imag_unit_circle_cmat)\n                 imag_unit_circle_cmat;\n        mat_det (A, B, C, D) \\<noteq> 0;\n        circline_eq_clmat\n         (moebius_circline_mmat_clmat (mk_moebius_mat Aa Ba Ca Da)\n           imag_unit_circle_clmat)\n         imag_unit_circle_clmat;\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> unitary_gen (A, B, C, D)", "let ?M = \"(A, B, C, D)\" and ?E = \"(1, 0, 0, 1)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>circline_eq_cmat\n                 (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n                   imag_unit_circle_cmat)\n                 imag_unit_circle_cmat;\n        mat_det (A, B, C, D) \\<noteq> 0;\n        circline_eq_clmat\n         (moebius_circline_mmat_clmat (mk_moebius_mat Aa Ba Ca Da)\n           imag_unit_circle_clmat)\n         imag_unit_circle_clmat;\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> unitary_gen (A, B, C, D)", "assume \"circline_eq_cmat (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D) imag_unit_circle_cmat) imag_unit_circle_cmat\"\n           \"mat_det ?M \\<noteq> 0\""], ["proof (state)\nthis:\n  circline_eq_cmat\n   (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n     imag_unit_circle_cmat)\n   imag_unit_circle_cmat\n  mat_det (A, B, C, D) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>circline_eq_cmat\n                 (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n                   imag_unit_circle_cmat)\n                 imag_unit_circle_cmat;\n        mat_det (A, B, C, D) \\<noteq> 0;\n        circline_eq_clmat\n         (moebius_circline_mmat_clmat (mk_moebius_mat Aa Ba Ca Da)\n           imag_unit_circle_clmat)\n         imag_unit_circle_clmat;\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> unitary_gen (A, B, C, D)", "then"], ["proof (chain)\npicking this:\n  circline_eq_cmat\n   (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n     imag_unit_circle_cmat)\n   imag_unit_circle_cmat\n  mat_det (A, B, C, D) \\<noteq> 0", "obtain k where \"k \\<noteq> 0\" \"?E = cor k *\\<^sub>s\\<^sub>m congruence (mat_inv ?M) ?E\""], ["proof (prove)\nusing this:\n  circline_eq_cmat\n   (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n     imag_unit_circle_cmat)\n   imag_unit_circle_cmat\n  mat_det (A, B, C, D) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         (1, 0, 0, 1) =\n         cor k *\\<^sub>s\\<^sub>m\n         congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  (1, 0, 0, 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1)\n\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>circline_eq_cmat\n                 (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n                   imag_unit_circle_cmat)\n                 imag_unit_circle_cmat;\n        mat_det (A, B, C, D) \\<noteq> 0;\n        circline_eq_clmat\n         (moebius_circline_mmat_clmat (mk_moebius_mat Aa Ba Ca Da)\n           imag_unit_circle_clmat)\n         imag_unit_circle_clmat;\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> unitary_gen (A, B, C, D)", "hence \"unitary_gen (mat_inv ?M)\""], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  (1, 0, 0, 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1)\n\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv (A, B, C, D))", "using mult_sm_inv_l[of \"cor k\" \"congruence (mat_inv ?M) ?E\" \"?E\"]"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  (1, 0, 0, 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1)\n  \\<lbrakk>cor k \\<noteq> 0;\n   cor k *\\<^sub>s\\<^sub>m congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1) =\n   (1, 0, 0, 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1) =\n                    (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, 1)\n\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv (A, B, C, D))", "unfolding unitary_gen_def"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  (1, 0, 0, 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1)\n  \\<lbrakk>cor k \\<noteq> 0;\n   cor k *\\<^sub>s\\<^sub>m congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1) =\n   (1, 0, 0, 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv (A, B, C, D)) (1, 0, 0, 1) =\n                    (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, 1)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n       mat_inv (A, B, C, D) =\n       k *\\<^sub>s\\<^sub>m eye", "by (metis congruence_def divide_eq_0_iff eye_def mat_eye_r of_real_eq_0_iff one_neq_zero)"], ["proof (state)\nthis:\n  unitary_gen (mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>circline_eq_cmat\n                 (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n                   imag_unit_circle_cmat)\n                 imag_unit_circle_cmat;\n        mat_det (A, B, C, D) \\<noteq> 0;\n        circline_eq_clmat\n         (moebius_circline_mmat_clmat (mk_moebius_mat Aa Ba Ca Da)\n           imag_unit_circle_clmat)\n         imag_unit_circle_clmat;\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> unitary_gen (A, B, C, D)", "thus \"unitary_gen ?M\""], ["proof (prove)\nusing this:\n  unitary_gen (mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. unitary_gen (A, B, C, D)", "using unitary_gen_inv[of \"mat_inv ?M\"] \\<open>mat_det ?M \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  unitary_gen (mat_inv (A, B, C, D))\n  unitary_gen (mat_inv (A, B, C, D)) \\<Longrightarrow>\n  unitary_gen (mat_inv (mat_inv (A, B, C, D)))\n  mat_det (A, B, C, D) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. unitary_gen (A, B, C, D)", "by (simp del: mat_inv.simps)"], ["proof (state)\nthis:\n  unitary_gen (A, B, C, D)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  unitary_gen (A, B, C, D)\n\ngoal (1 subgoal):\n 1. unitary_gen (A, B, C, D) \\<Longrightarrow>\n    moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. unitary_gen (A, B, C, D) \\<Longrightarrow>\n    moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle", "assume ?rhs"], ["proof (state)\nthis:\n  unitary_gen (A, B, C, D)\n\ngoal (1 subgoal):\n 1. unitary_gen (A, B, C, D) \\<Longrightarrow>\n    moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle", "thus ?lhs"], ["proof (prove)\nusing this:\n  unitary_gen (A, B, C, D)\n\ngoal (1 subgoal):\n 1. moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle", "using assms"], ["proof (prove)\nusing this:\n  unitary_gen (A, B, C, D)\n  mat_det (A, B, C, D) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. moebius_circline (mk_moebius A B C D) imag_unit_circle =\n    imag_unit_circle", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>unitary_gen (A, B, C, D); mat_det (A, B, C, D) \\<noteq> 0;\n        unitary_gen (Aa, Ba, Ca, Da);\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat\n                            (mk_moebius_cmat A B C D) imag_unit_circle_cmat)\n                          imag_unit_circle_cmat", "fix A B C D :: complex"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>unitary_gen (A, B, C, D); mat_det (A, B, C, D) \\<noteq> 0;\n        unitary_gen (Aa, Ba, Ca, Da);\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat\n                            (mk_moebius_cmat A B C D) imag_unit_circle_cmat)\n                          imag_unit_circle_cmat", "let ?M = \"(A, B, C, D)\" and ?E = \"(1, 0, 0, 1)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>unitary_gen (A, B, C, D); mat_det (A, B, C, D) \\<noteq> 0;\n        unitary_gen (Aa, Ba, Ca, Da);\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat\n                            (mk_moebius_cmat A B C D) imag_unit_circle_cmat)\n                          imag_unit_circle_cmat", "assume \"unitary_gen ?M\" \"mat_det ?M \\<noteq> 0\""], ["proof (state)\nthis:\n  unitary_gen (A, B, C, D)\n  mat_det (A, B, C, D) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>unitary_gen (A, B, C, D); mat_det (A, B, C, D) \\<noteq> 0;\n        unitary_gen (Aa, Ba, Ca, Da);\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat\n                            (mk_moebius_cmat A B C D) imag_unit_circle_cmat)\n                          imag_unit_circle_cmat", "hence \"unitary_gen (mat_inv ?M)\""], ["proof (prove)\nusing this:\n  unitary_gen (A, B, C, D)\n  mat_det (A, B, C, D) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv (A, B, C, D))", "using unitary_gen_inv[of ?M]"], ["proof (prove)\nusing this:\n  unitary_gen (A, B, C, D)\n  mat_det (A, B, C, D) \\<noteq> 0\n  unitary_gen (A, B, C, D) \\<Longrightarrow>\n  unitary_gen (mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv (A, B, C, D))", "by simp"], ["proof (state)\nthis:\n  unitary_gen (mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>unitary_gen (A, B, C, D); mat_det (A, B, C, D) \\<noteq> 0;\n        unitary_gen (Aa, Ba, Ca, Da);\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat\n                            (mk_moebius_cmat A B C D) imag_unit_circle_cmat)\n                          imag_unit_circle_cmat", "then"], ["proof (chain)\npicking this:\n  unitary_gen (mat_inv (A, B, C, D))", "obtain k where \"k \\<noteq> 0\" \"mat_adj (mat_inv ?M) *\\<^sub>m\\<^sub>m (mat_inv ?M) = cor k *\\<^sub>s\\<^sub>m eye\""], ["proof (prove)\nusing this:\n  unitary_gen (mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n         mat_inv (A, B, C, D) =\n         cor k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using unitary_gen_real[of \"mat_inv ?M\"] mat_det_inv[of ?M]"], ["proof (prove)\nusing this:\n  unitary_gen (mat_inv (A, B, C, D))\n  unitary_gen (mat_inv (A, B, C, D)) \\<Longrightarrow>\n  \\<exists>k>0.\n     mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m mat_inv (A, B, C, D) =\n     cor k *\\<^sub>s\\<^sub>m eye\n  mat_det (A, B, C, D) \\<noteq> 0 \\<Longrightarrow>\n  mat_det (mat_inv (A, B, C, D)) = 1 / mat_det (A, B, C, D)\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n         mat_inv (A, B, C, D) =\n         cor k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m mat_inv (A, B, C, D) =\n  cor k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>unitary_gen (A, B, C, D); mat_det (A, B, C, D) \\<noteq> 0;\n        unitary_gen (Aa, Ba, Ca, Da);\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat\n                            (mk_moebius_cmat A B C D) imag_unit_circle_cmat)\n                          imag_unit_circle_cmat", "hence *: \"?E = (1 / cor k) *\\<^sub>s\\<^sub>m (mat_adj (mat_inv ?M) *\\<^sub>m\\<^sub>m (mat_inv ?M))\""], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m mat_inv (A, B, C, D) =\n  cor k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. (1, 0, 0, 1) =\n    (1 / cor k) *\\<^sub>s\\<^sub>m\n    (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m mat_inv (A, B, C, D))", "using mult_sm_inv_l[of \"cor k\" eye \"mat_adj (mat_inv ?M) *\\<^sub>m\\<^sub>m (mat_inv ?M)\"]"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m mat_inv (A, B, C, D) =\n  cor k *\\<^sub>s\\<^sub>m eye\n  \\<lbrakk>cor k \\<noteq> 0;\n   cor k *\\<^sub>s\\<^sub>m eye =\n   mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n   mat_inv (A, B, C, D)\\<rbrakk>\n  \\<Longrightarrow> eye =\n                    (1 / cor k) *\\<^sub>s\\<^sub>m\n                    (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n                     mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. (1, 0, 0, 1) =\n    (1 / cor k) *\\<^sub>s\\<^sub>m\n    (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m mat_inv (A, B, C, D))", "by simp"], ["proof (state)\nthis:\n  (1, 0, 0, 1) =\n  (1 / cor k) *\\<^sub>s\\<^sub>m\n  (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>unitary_gen (A, B, C, D); mat_det (A, B, C, D) \\<noteq> 0;\n        unitary_gen (Aa, Ba, Ca, Da);\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat\n                            (mk_moebius_cmat A B C D) imag_unit_circle_cmat)\n                          imag_unit_circle_cmat", "have \"\\<exists>k. k \\<noteq> 0 \\<and>\n            (1, 0, 0, 1) = cor k *\\<^sub>s\\<^sub>m (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m (1, 0, 0, 1) *\\<^sub>m\\<^sub>m mat_inv (A, B, C, D))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (1, 0, 0, 1) =\n       cor k *\\<^sub>s\\<^sub>m\n       (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n        (1, 0, 0, 1) *\\<^sub>m\\<^sub>m\n        mat_inv (A, B, C, D))", "using \\<open>mat_det ?M \\<noteq> 0\\<close> \\<open>k \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  mat_det (A, B, C, D) \\<noteq> 0\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       (1, 0, 0, 1) =\n       cor k *\\<^sub>s\\<^sub>m\n       (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n        (1, 0, 0, 1) *\\<^sub>m\\<^sub>m\n        mat_inv (A, B, C, D))", "by (metis \"*\" Im_complex_of_real Re_complex_of_real \\<open>mat_adj (mat_inv ?M) *\\<^sub>m\\<^sub>m mat_inv ?M = cor k *\\<^sub>s\\<^sub>m eye\\<close> complex_of_real_Re eye_def mat_eye_l mult_mm_assoc mult_mm_sm mult_sm_eye_mm of_real_1 of_real_divide of_real_eq_1_iff zero_eq_1_divide_iff)"], ["proof (state)\nthis:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     (1, 0, 0, 1) =\n     cor k *\\<^sub>s\\<^sub>m\n     (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n      (1, 0, 0, 1) *\\<^sub>m\\<^sub>m\n      mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. \\<And>A B C D Aa Ba Ca Da.\n       \\<lbrakk>unitary_gen (A, B, C, D); mat_det (A, B, C, D) \\<noteq> 0;\n        unitary_gen (Aa, Ba, Ca, Da);\n        mat_det (Aa, Ba, Ca, Da) \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> circline_eq_cmat\n                          (moebius_circline_cmat_cmat\n                            (mk_moebius_cmat A B C D) imag_unit_circle_cmat)\n                          imag_unit_circle_cmat", "thus \"circline_eq_cmat (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D) imag_unit_circle_cmat) imag_unit_circle_cmat\""], ["proof (prove)\nusing this:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     (1, 0, 0, 1) =\n     cor k *\\<^sub>s\\<^sub>m\n     (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n      (1, 0, 0, 1) *\\<^sub>m\\<^sub>m\n      mat_inv (A, B, C, D))\n\ngoal (1 subgoal):\n 1. circline_eq_cmat\n     (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n       imag_unit_circle_cmat)\n     imag_unit_circle_cmat", "using \\<open>mat_det ?M \\<noteq> 0\\<close> \\<open>k \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     (1, 0, 0, 1) =\n     cor k *\\<^sub>s\\<^sub>m\n     (mat_adj (mat_inv (A, B, C, D)) *\\<^sub>m\\<^sub>m\n      (1, 0, 0, 1) *\\<^sub>m\\<^sub>m\n      mat_inv (A, B, C, D))\n  mat_det (A, B, C, D) \\<noteq> 0\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. circline_eq_cmat\n     (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n       imag_unit_circle_cmat)\n     imag_unit_circle_cmat", "by (simp del: mat_inv.simps)"], ["proof (state)\nthis:\n  circline_eq_cmat\n   (moebius_circline_cmat_cmat (mk_moebius_cmat A B C D)\n     imag_unit_circle_cmat)\n   imag_unit_circle_cmat\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  moebius_circline (mk_moebius A B C D) imag_unit_circle = imag_unit_circle\n\ngoal:\nNo subgoals!", "qed"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsection \\<open>M?bius transformations that fix the oriented unit circle and the unit disc\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "text \\<open>M?bius transformations that fix the unit circle either map the unit disc onto itself or\nexchange it with its exterior. The transformations that fix the unit disc can be recognized from\ntheir matrices -- they have the form as before, but additionally it must hold that $|a|^2 > |b|^2$.\\<close>"], ["", "definition unit_disc_fix_cmat :: \"complex_mat \\<Rightarrow> bool\" where\n [simp]: \"unit_disc_fix_cmat M \\<longleftrightarrow>\n          (let (A, B, C, D) = M\n            in unitary11_gen (A, B, C, D) \\<and> (B = 0 \\<or> Re ((A*D)/(B*C)) > 1))\""], ["", "lift_definition unit_disc_fix_mmat :: \"moebius_mat \\<Rightarrow> bool\" is unit_disc_fix_cmat"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lift_definition unit_disc_fix :: \"moebius \\<Rightarrow> bool\" is unit_disc_fix_mmat"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       moebius_mat_eq moebius_mat1 moebius_mat2 \\<Longrightarrow>\n       unit_disc_fix_mmat moebius_mat1 = unit_disc_fix_mmat moebius_mat2", "proof transfer"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       \\<lbrakk>mat_det moebius_mat1 \\<noteq> 0;\n        mat_det moebius_mat2 \\<noteq> 0;\n        moebius_cmat_eq moebius_mat1 moebius_mat2\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat moebius_mat1 =\n                         unit_disc_fix_cmat moebius_mat2", "fix M M' :: complex_mat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       \\<lbrakk>mat_det moebius_mat1 \\<noteq> 0;\n        mat_det moebius_mat2 \\<noteq> 0;\n        moebius_cmat_eq moebius_mat1 moebius_mat2\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat moebius_mat1 =\n                         unit_disc_fix_cmat moebius_mat2", "assume det: \"mat_det M \\<noteq> 0\" \"mat_det M' \\<noteq> 0\""], ["proof (state)\nthis:\n  mat_det M \\<noteq> 0\n  mat_det M' \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       \\<lbrakk>mat_det moebius_mat1 \\<noteq> 0;\n        mat_det moebius_mat2 \\<noteq> 0;\n        moebius_cmat_eq moebius_mat1 moebius_mat2\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat moebius_mat1 =\n                         unit_disc_fix_cmat moebius_mat2", "assume \"moebius_cmat_eq M M'\""], ["proof (state)\nthis:\n  moebius_cmat_eq M M'\n\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       \\<lbrakk>mat_det moebius_mat1 \\<noteq> 0;\n        mat_det moebius_mat2 \\<noteq> 0;\n        moebius_cmat_eq moebius_mat1 moebius_mat2\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat moebius_mat1 =\n                         unit_disc_fix_cmat moebius_mat2", "then"], ["proof (chain)\npicking this:\n  moebius_cmat_eq M M'", "obtain k where *: \"k \\<noteq> 0\" \"M' = k *\\<^sub>s\\<^sub>m M\""], ["proof (prove)\nusing this:\n  moebius_cmat_eq M M'\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0; M' = k *\\<^sub>s\\<^sub>m M\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  M' = k *\\<^sub>s\\<^sub>m M\n\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       \\<lbrakk>mat_det moebius_mat1 \\<noteq> 0;\n        mat_det moebius_mat2 \\<noteq> 0;\n        moebius_cmat_eq moebius_mat1 moebius_mat2\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat moebius_mat1 =\n                         unit_disc_fix_cmat moebius_mat2", "hence **: \"unitary11_gen M \\<longleftrightarrow> unitary11_gen M'\""], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  M' = k *\\<^sub>s\\<^sub>m M\n\ngoal (1 subgoal):\n 1. unitary11_gen M = unitary11_gen M'", "using unitary11_gen_mult_sm[of k M] unitary11_gen_div_sm[of k M]"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  M' = k *\\<^sub>s\\<^sub>m M\n  \\<lbrakk>k \\<noteq> 0; unitary11_gen M\\<rbrakk>\n  \\<Longrightarrow> unitary11_gen (k *\\<^sub>s\\<^sub>m M)\n  \\<lbrakk>k \\<noteq> 0; unitary11_gen (k *\\<^sub>s\\<^sub>m M)\\<rbrakk>\n  \\<Longrightarrow> unitary11_gen M\n\ngoal (1 subgoal):\n 1. unitary11_gen M = unitary11_gen M'", "by auto"], ["proof (state)\nthis:\n  unitary11_gen M = unitary11_gen M'\n\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       \\<lbrakk>mat_det moebius_mat1 \\<noteq> 0;\n        mat_det moebius_mat2 \\<noteq> 0;\n        moebius_cmat_eq moebius_mat1 moebius_mat2\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat moebius_mat1 =\n                         unit_disc_fix_cmat moebius_mat2", "obtain A B C D where MM: \"(A, B, C, D) = M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A B C D.\n        (A, B, C, D) = M \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases M) auto"], ["proof (state)\nthis:\n  (A, B, C, D) = M\n\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       \\<lbrakk>mat_det moebius_mat1 \\<noteq> 0;\n        mat_det moebius_mat2 \\<noteq> 0;\n        moebius_cmat_eq moebius_mat1 moebius_mat2\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat moebius_mat1 =\n                         unit_disc_fix_cmat moebius_mat2", "obtain A' B' C' D' where MM': \"(A', B', C', D') = M'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A' B' C' D'.\n        (A', B', C', D') = M' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases M') auto"], ["proof (state)\nthis:\n  (A', B', C', D') = M'\n\ngoal (1 subgoal):\n 1. \\<And>moebius_mat1 moebius_mat2.\n       \\<lbrakk>mat_det moebius_mat1 \\<noteq> 0;\n        mat_det moebius_mat2 \\<noteq> 0;\n        moebius_cmat_eq moebius_mat1 moebius_mat2\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat moebius_mat1 =\n                         unit_disc_fix_cmat moebius_mat2", "show \"unit_disc_fix_cmat M = unit_disc_fix_cmat M'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix_cmat M = unit_disc_fix_cmat M'", "using * ** MM MM'"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  M' = k *\\<^sub>s\\<^sub>m M\n  unitary11_gen M = unitary11_gen M'\n  (A, B, C, D) = M\n  (A', B', C', D') = M'\n\ngoal (1 subgoal):\n 1. unit_disc_fix_cmat M = unit_disc_fix_cmat M'", "by auto"], ["proof (state)\nthis:\n  unit_disc_fix_cmat M = unit_disc_fix_cmat M'\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Transformations that fix the unit disc also fix the unit circle.\\<close>"], ["", "lemma unit_disc_fix_unit_circle_fix [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_circle_fix M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix M", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_circle_fix M", "by (transfer, transfer, auto)"], ["", "text \\<open>Transformations that preserve the unit disc preserve the orientation of the unit circle.\\<close>"], ["", "lemma unit_disc_fix_iff_ounit_circle:\n  shows \"unit_disc_fix M \\<longleftrightarrow> \n         moebius_ocircline M ounit_circle = ounit_circle\" (is \"?rhs \\<longleftrightarrow> ?lhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix M = (moebius_ocircline M ounit_circle = ounit_circle)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. unit_disc_fix M \\<Longrightarrow>\n    moebius_ocircline M ounit_circle = ounit_circle\n 2. moebius_ocircline M ounit_circle = ounit_circle \\<Longrightarrow>\n    unit_disc_fix M", "assume *: ?lhs"], ["proof (state)\nthis:\n  moebius_ocircline M ounit_circle = ounit_circle\n\ngoal (2 subgoals):\n 1. unit_disc_fix M \\<Longrightarrow>\n    moebius_ocircline M ounit_circle = ounit_circle\n 2. moebius_ocircline M ounit_circle = ounit_circle \\<Longrightarrow>\n    unit_disc_fix M", "have \"moebius_circline M unit_circle = unit_circle\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_circline M unit_circle = unit_circle", "apply (subst moebius_circline_ocircline[of M unit_circle])"], ["proof (prove)\ngoal (1 subgoal):\n 1. of_ocircline (moebius_ocircline M (of_circline unit_circle)) =\n    unit_circle", "apply (subst of_circline_unit_circle)"], ["proof (prove)\ngoal (1 subgoal):\n 1. of_ocircline (moebius_ocircline M ounit_circle) = unit_circle", "apply (subst *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. of_ocircline ounit_circle = unit_circle", "by simp"], ["proof (state)\nthis:\n  moebius_circline M unit_circle = unit_circle\n\ngoal (2 subgoals):\n 1. unit_disc_fix M \\<Longrightarrow>\n    moebius_ocircline M ounit_circle = ounit_circle\n 2. moebius_ocircline M ounit_circle = ounit_circle \\<Longrightarrow>\n    unit_disc_fix M", "hence \"unit_circle_fix M\""], ["proof (prove)\nusing this:\n  moebius_circline M unit_circle = unit_circle\n\ngoal (1 subgoal):\n 1. unit_circle_fix M", "by (simp add: unit_circle_fix_iff)"], ["proof (state)\nthis:\n  unit_circle_fix M\n\ngoal (2 subgoals):\n 1. unit_disc_fix M \\<Longrightarrow>\n    moebius_ocircline M ounit_circle = ounit_circle\n 2. moebius_ocircline M ounit_circle = ounit_circle \\<Longrightarrow>\n    unit_disc_fix M", "thus ?rhs"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix M", "using *"], ["proof (prove)\nusing this:\n  unit_circle_fix M\n  moebius_ocircline M ounit_circle = ounit_circle\n\ngoal (1 subgoal):\n 1. unit_disc_fix M", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "fix M :: complex_mat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "assume \"mat_det M \\<noteq> 0\""], ["proof (state)\nthis:\n  mat_det M \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "let ?H = \"(1, 0, 0, -1)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "obtain A B C D where MM: \"(A, B, C, D) = M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A B C D.\n        (A, B, C, D) = M \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases M) auto"], ["proof (state)\nthis:\n  (A, B, C, D) = M\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "assume \"unitary11_gen M\" \"ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat) unit_circle_cmat\""], ["proof (state)\nthis:\n  unitary11_gen M\n  ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n   unit_circle_cmat\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "then"], ["proof (chain)\npicking this:\n  unitary11_gen M\n  ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n   unit_circle_cmat", "obtain k where \"0 < k\" \"?H = cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) ?H\""], ["proof (prove)\nusing this:\n  unitary11_gen M\n  ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n   unit_circle_cmat\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>0 < k;\n         (1, 0, 0, - 1) =\n         cor k *\\<^sub>s\\<^sub>m\n         congruence (mat_inv M) (1, 0, 0, - 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < k\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "hence \"congruence M ?H = cor k *\\<^sub>s\\<^sub>m ?H\""], ["proof (prove)\nusing this:\n  0 < k\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "using congruence_inv[of \"mat_inv M\" \"?H\" \"(1/cor k) *\\<^sub>s\\<^sub>m ?H\"] \\<open>mat_det M \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  0 < k\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n  \\<lbrakk>mat_det (mat_inv M) \\<noteq> 0;\n   congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv (mat_inv M))\n                     ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n                    (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "using mult_sm_inv_l[of \"cor k\" \"congruence (mat_inv M) ?H\" \"?H\"]"], ["proof (prove)\nusing this:\n  0 < k\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n  \\<lbrakk>mat_det (mat_inv M) \\<noteq> 0;\n   congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv (mat_inv M))\n                     ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n                    (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n  \\<lbrakk>cor k \\<noteq> 0;\n   cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv M) (1, 0, 0, - 1) =\n                    (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "using mult_sm_inv_l[of \"1/cor k\" \"congruence M ?H\"]"], ["proof (prove)\nusing this:\n  0 < k\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n  \\<lbrakk>mat_det (mat_inv M) \\<noteq> 0;\n   congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv (mat_inv M))\n                     ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n                    (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n  \\<lbrakk>cor k \\<noteq> 0;\n   cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv M) (1, 0, 0, - 1) =\n                    (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  \\<lbrakk>1 / cor k \\<noteq> 0;\n   (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1) = ?B\\<rbrakk>\n  \\<Longrightarrow> congruence M (1, 0, 0, - 1) =\n                    (1 / (1 / cor k)) *\\<^sub>s\\<^sub>m ?B\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "using congruence_scale_m[of M \"1/cor k\" \"?H\"]"], ["proof (prove)\nusing this:\n  0 < k\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n  \\<lbrakk>mat_det (mat_inv M) \\<noteq> 0;\n   congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv (mat_inv M))\n                     ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n                    (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n  \\<lbrakk>cor k \\<noteq> 0;\n   cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv M) (1, 0, 0, - 1) =\n                    (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  \\<lbrakk>1 / cor k \\<noteq> 0;\n   (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1) = ?B\\<rbrakk>\n  \\<Longrightarrow> congruence M (1, 0, 0, - 1) =\n                    (1 / (1 / cor k)) *\\<^sub>s\\<^sub>m ?B\n  congruence M ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n  (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "using \\<open>\\<And>B. \\<lbrakk>1 / cor k \\<noteq> 0; (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1) = B\\<rbrakk> \\<Longrightarrow> congruence M (1, 0, 0, - 1) = (1 / (1 / cor k)) *\\<^sub>s\\<^sub>m B\\<close>"], ["proof (prove)\nusing this:\n  0 < k\n  (1, 0, 0, - 1) =\n  cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n  \\<lbrakk>mat_det (mat_inv M) \\<noteq> 0;\n   congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv (mat_inv M))\n                     ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n                    (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n  \\<lbrakk>cor k \\<noteq> 0;\n   cor k *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1) =\n   (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv M) (1, 0, 0, - 1) =\n                    (1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  \\<lbrakk>1 / cor k \\<noteq> 0;\n   (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1) = ?B\\<rbrakk>\n  \\<Longrightarrow> congruence M (1, 0, 0, - 1) =\n                    (1 / (1 / cor k)) *\\<^sub>s\\<^sub>m ?B\n  congruence M ((1 / cor k) *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n  (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1)\n  \\<lbrakk>1 / cor k \\<noteq> 0;\n   (1 / cor k) *\\<^sub>s\\<^sub>m congruence M (1, 0, 0, - 1) = ?B\\<rbrakk>\n  \\<Longrightarrow> congruence M (1, 0, 0, - 1) =\n                    (1 / (1 / cor k)) *\\<^sub>s\\<^sub>m ?B\n\ngoal (1 subgoal):\n 1. congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "by (auto simp add: mat_det_inv)"], ["proof (state)\nthis:\n  congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "then"], ["proof (chain)\npicking this:\n  congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)", "obtain a b k' where \"k' \\<noteq> 0\" \"M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\" \"sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\""], ["proof (prove)\nusing this:\n  congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. (\\<And>k' a b.\n        \\<lbrakk>k' \\<noteq> 0;\n         M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a);\n         sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using unitary11_sgn_det_orientation'[of M k] \\<open>k > 0\\<close>"], ["proof (prove)\nusing this:\n  congruence M (1, 0, 0, - 1) = cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  \\<lbrakk>congruence M (1, 0, 0, - 1) =\n           cor k *\\<^sub>s\\<^sub>m (1, 0, 0, - 1);\n   k \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> \\<exists>a b ka.\n                       ka \\<noteq> 0 \\<and>\n                       M = ka *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a) \\<and>\n                       sgn k = sgn (Re (mat_det (a, b, cnj b, cnj a)))\n  0 < k\n\ngoal (1 subgoal):\n 1. (\\<And>k' a b.\n        \\<lbrakk>k' \\<noteq> 0;\n         M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a);\n         sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k' \\<noteq> 0\n  M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n  sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "moreover"], ["proof (state)\nthis:\n  k' \\<noteq> 0\n  M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n  sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "have \"mat_det (a, b, cnj b, cnj a) \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_det (a, b, cnj b, cnj a) \\<noteq> 0", "using \\<open>sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\\<close>"], ["proof (prove)\nusing this:\n  sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\n\ngoal (1 subgoal):\n 1. mat_det (a, b, cnj b, cnj a) \\<noteq> 0", "by (smt sgn_0 zero_complex.simps(1))"], ["proof (state)\nthis:\n  mat_det (a, b, cnj b, cnj a) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unitary11_gen M;\n        ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n         unit_circle_cmat;\n        unit_circle_fix_mmat Ma;\n        ocircline_eq_clmat\n         (moebius_circline_mmat_clmat Ma unit_circle_clmat)\n         unit_circle_clmat\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat M", "ultimately"], ["proof (chain)\npicking this:\n  k' \\<noteq> 0\n  M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n  sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\n  mat_det (a, b, cnj b, cnj a) \\<noteq> 0", "show \"unit_disc_fix_cmat M\""], ["proof (prove)\nusing this:\n  k' \\<noteq> 0\n  M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n  sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\n  mat_det (a, b, cnj b, cnj a) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. unit_disc_fix_cmat M", "using unitary11_sgn_det[of k' a b M A B C D]"], ["proof (prove)\nusing this:\n  k' \\<noteq> 0\n  M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n  sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\n  mat_det (a, b, cnj b, cnj a) \\<noteq> 0\n  \\<lbrakk>k' \\<noteq> 0; mat_det (a, b, cnj b, cnj a) \\<noteq> 0;\n   M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a); M = (A, B, C, D)\\<rbrakk>\n  \\<Longrightarrow> sgn (Re (mat_det (a, b, cnj b, cnj a))) =\n                    (if b = 0 then 1 else sgn (Re (A * D / (B * C)) - 1))\n\ngoal (1 subgoal):\n 1. unit_disc_fix_cmat M", "using MM[symmetric] \\<open>k > 0\\<close> \\<open>unitary11_gen M\\<close>"], ["proof (prove)\nusing this:\n  k' \\<noteq> 0\n  M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n  sgn (Re (mat_det (a, b, cnj b, cnj a))) = 1\n  mat_det (a, b, cnj b, cnj a) \\<noteq> 0\n  \\<lbrakk>k' \\<noteq> 0; mat_det (a, b, cnj b, cnj a) \\<noteq> 0;\n   M = k' *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a); M = (A, B, C, D)\\<rbrakk>\n  \\<Longrightarrow> sgn (Re (mat_det (a, b, cnj b, cnj a))) =\n                    (if b = 0 then 1 else sgn (Re (A * D / (B * C)) - 1))\n  M = (A, B, C, D)\n  0 < k\n  unitary11_gen M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_cmat M", "by (simp add: sgn_1_pos split: if_split_asm)"], ["proof (state)\nthis:\n  unit_disc_fix_cmat M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix M \\<Longrightarrow>\n    moebius_ocircline M ounit_circle = ounit_circle", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. unit_disc_fix M \\<Longrightarrow>\n    moebius_ocircline M ounit_circle = ounit_circle", "assume ?rhs"], ["proof (state)\nthis:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix M \\<Longrightarrow>\n    moebius_ocircline M ounit_circle = ounit_circle", "thus ?lhs"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. moebius_ocircline M ounit_circle = ounit_circle", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> ocircline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "fix M :: complex_mat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> ocircline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "assume \"mat_det M \\<noteq> 0\""], ["proof (state)\nthis:\n  mat_det M \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> ocircline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "obtain A B C D where MM: \"(A, B, C, D) = M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A B C D.\n        (A, B, C, D) = M \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases M) auto"], ["proof (state)\nthis:\n  (A, B, C, D) = M\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> ocircline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "assume \"unit_disc_fix_cmat M\""], ["proof (state)\nthis:\n  unit_disc_fix_cmat M\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> ocircline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "hence \"unitary11_gen M\" \"B = 0 \\<or> 1 < Re (A * D / (B * C))\""], ["proof (prove)\nusing this:\n  unit_disc_fix_cmat M\n\ngoal (1 subgoal):\n 1. unitary11_gen M &&& B = 0 \\<or> 1 < Re (A * D / (B * C))", "using MM[symmetric]"], ["proof (prove)\nusing this:\n  unit_disc_fix_cmat M\n  M = (A, B, C, D)\n\ngoal (1 subgoal):\n 1. unitary11_gen M &&& B = 0 \\<or> 1 < Re (A * D / (B * C))", "by auto"], ["proof (state)\nthis:\n  unitary11_gen M\n  B = 0 \\<or> 1 < Re (A * D / (B * C))\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> ocircline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "have \"sgn (if B = 0 then 1 else sgn (Re (A * D / (B * C)) - 1)) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sgn (if B = 0 then 1 else sgn (Re (A * D / (B * C)) - 1)) = 1", "using \\<open>B = 0 \\<or> 1 < Re (A * D / (B * C))\\<close>"], ["proof (prove)\nusing this:\n  B = 0 \\<or> 1 < Re (A * D / (B * C))\n\ngoal (1 subgoal):\n 1. sgn (if B = 0 then 1 else sgn (Re (A * D / (B * C)) - 1)) = 1", "by auto"], ["proof (state)\nthis:\n  sgn (if B = 0 then 1 else sgn (Re (A * D / (B * C)) - 1)) = 1\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> ocircline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "then"], ["proof (chain)\npicking this:\n  sgn (if B = 0 then 1 else sgn (Re (A * D / (B * C)) - 1)) = 1", "obtain k' where \"k' > 0\" \"congruence M (1, 0, 0, -1) = cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, -1)\""], ["proof (prove)\nusing this:\n  sgn (if B = 0 then 1 else sgn (Re (A * D / (B * C)) - 1)) = 1\n\ngoal (1 subgoal):\n 1. (\\<And>k'.\n        \\<lbrakk>0 < k';\n         congruence M (1, 0, 0, - 1) =\n         cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using unitary11_orientation[OF \\<open>unitary11_gen M\\<close> MM[symmetric]]"], ["proof (prove)\nusing this:\n  sgn (if B = 0 then 1 else sgn (Re (A * D / (B * C)) - 1)) = 1\n  \\<exists>k'.\n     sgn k' =\n     sgn (if B = 0 then 1 else sgn (Re (A * D / (B * C)) - 1)) \\<and>\n     congruence M (1, 0, 0, - 1) = cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. (\\<And>k'.\n        \\<lbrakk>0 < k';\n         congruence M (1, 0, 0, - 1) =\n         cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp add: sgn_1_pos)"], ["proof (state)\nthis:\n  0 < k'\n  congruence M (1, 0, 0, - 1) = cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> ocircline_eq_cmat\n                          (moebius_circline_cmat_cmat M unit_circle_cmat)\n                          unit_circle_cmat", "thus \"ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat) unit_circle_cmat\""], ["proof (prove)\nusing this:\n  0 < k'\n  congruence M (1, 0, 0, - 1) = cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n     unit_circle_cmat", "using congruence_inv[of M \"(1, 0, 0, -1)\" \"cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, -1)\"] \\<open>mat_det M \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  0 < k'\n  congruence M (1, 0, 0, - 1) = cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  \\<lbrakk>mat_det M \\<noteq> 0;\n   congruence M (1, 0, 0, - 1) =\n   cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv M)\n                     (cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n                    (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n\ngoal (1 subgoal):\n 1. ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n     unit_circle_cmat", "using congruence_scale_m[of \"mat_inv M\" \"cor k'\" \"(1, 0, 0, -1)\"]"], ["proof (prove)\nusing this:\n  0 < k'\n  congruence M (1, 0, 0, - 1) = cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\n  \\<lbrakk>mat_det M \\<noteq> 0;\n   congruence M (1, 0, 0, - 1) =\n   cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)\\<rbrakk>\n  \\<Longrightarrow> congruence (mat_inv M)\n                     (cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n                    (1, 0, 0, - 1)\n  mat_det M \\<noteq> 0\n  congruence (mat_inv M) (cor k' *\\<^sub>s\\<^sub>m (1, 0, 0, - 1)) =\n  cor k' *\\<^sub>s\\<^sub>m congruence (mat_inv M) (1, 0, 0, - 1)\n\ngoal (1 subgoal):\n 1. ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n     unit_circle_cmat", "by auto"], ["proof (state)\nthis:\n  ocircline_eq_cmat (moebius_circline_cmat_cmat M unit_circle_cmat)\n   unit_circle_cmat\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  moebius_ocircline M ounit_circle = ounit_circle\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Our algebraic characterisation (by matrices) is geometrically correct.\\<close>"], ["", "lemma unit_disc_fix_iff [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"moebius_pt M ` unit_disc = unit_disc\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt M ` unit_disc = unit_disc", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. moebius_pt M ` unit_disc = unit_disc", "using unit_disc_fix_iff_ounit_circle[of M]"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M = (moebius_ocircline M ounit_circle = ounit_circle)\n\ngoal (1 subgoal):\n 1. moebius_pt M ` unit_disc = unit_disc", "unfolding unit_disc_def"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M = (moebius_ocircline M ounit_circle = ounit_circle)\n\ngoal (1 subgoal):\n 1. moebius_pt M ` disc ounit_circle = disc ounit_circle", "by (subst disc_moebius_ocircline[symmetric], simp)"], ["", "lemma unit_disc_fix_discI [simp]:\n  assumes \"unit_disc_fix M\" and \"u \\<in> unit_disc\"\n  shows \"moebius_pt M u \\<in> unit_disc\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt M u \\<in> unit_disc", "using unit_disc_fix_iff assms"], ["proof (prove)\nusing this:\n  unit_disc_fix ?M \\<Longrightarrow> moebius_pt ?M ` unit_disc = unit_disc\n  unit_disc_fix M\n  u \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. moebius_pt M u \\<in> unit_disc", "by blast"], ["", "text \\<open>Unit disc preserving transformations form a group.\\<close>"], ["", "lemma unit_disc_fix_id_moebius [simp]:\n  shows \"unit_disc_fix id_moebius\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix id_moebius", "by (transfer, transfer, simp add: unitary11_gen_def mat_adj_def mat_cnj_def)"], ["", "lemma unit_disc_fix_moebius_add [simp]:\n  assumes \"unit_disc_fix M1\" and \"unit_disc_fix M2\"\n  shows \"unit_disc_fix (M1 + M2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix (M1 + M2)", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M1\n  unit_disc_fix M2\n\ngoal (1 subgoal):\n 1. unit_disc_fix (M1 + M2)", "unfolding unit_disc_fix_iff_ounit_circle"], ["proof (prove)\nusing this:\n  moebius_ocircline M1 ounit_circle = ounit_circle\n  moebius_ocircline M2 ounit_circle = ounit_circle\n\ngoal (1 subgoal):\n 1. moebius_ocircline (M1 + M2) ounit_circle = ounit_circle", "by auto"], ["", "lemma unit_disc_fix_moebius_comp [simp]:\n  assumes \"unit_disc_fix M1\" and \"unit_disc_fix M2\"\n  shows \"unit_disc_fix (moebius_comp M1 M2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix (moebius_comp M1 M2)", "using unit_disc_fix_moebius_add[OF assms]"], ["proof (prove)\nusing this:\n  unit_disc_fix (M1 + M2)\n\ngoal (1 subgoal):\n 1. unit_disc_fix (moebius_comp M1 M2)", "by simp"], ["", "lemma unit_disc_fix_moebius_uminus [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix (-M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix (- M)", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix (- M)", "unfolding unit_disc_fix_iff_ounit_circle"], ["proof (prove)\nusing this:\n  moebius_ocircline M ounit_circle = ounit_circle\n\ngoal (1 subgoal):\n 1. moebius_ocircline (- M) ounit_circle = ounit_circle", "by (metis moebius_ocircline_comp_inv_left uminus_moebius_def)"], ["", "lemma unit_disc_fix_moebius_inv [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix (moebius_inv M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix (moebius_inv M)", "using unit_disc_fix_moebius_uminus[OF assms]"], ["proof (prove)\nusing this:\n  unit_disc_fix (- M)\n\ngoal (1 subgoal):\n 1. unit_disc_fix (moebius_inv M)", "by simp"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsection \\<open>Rotations are unit disc preserving transformations\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "lemma unit_disc_fix_rotation [simp]:\n  shows \"unit_disc_fix (moebius_rotation \\<phi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix (moebius_rotation \\<phi>)", "unfolding moebius_rotation_def moebius_similarity_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix (mk_moebius (cis \\<phi>) 0 0 1)", "by (transfer, transfer, simp add: unitary11_gen_def mat_adj_def mat_cnj_def cis_mult)"], ["", "lemma moebius_rotation_unit_circle_fix [simp]:\n  shows \"moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_circle_set \\<longleftrightarrow> u \\<in> unit_circle_set\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_circle_set) =\n    (u \\<in> unit_circle_set)", "using moebius_pt_moebius_inv_in_set unit_circle_fix_iff_unit_circle_set"], ["proof (prove)\nusing this:\n  moebius_pt ?M ?z \\<in> ?A \\<Longrightarrow>\n  ?z \\<in> moebius_pt (moebius_inv ?M) ` ?A\n  unit_circle_fix ?M = (moebius_pt ?M ` unit_circle_set = unit_circle_set)\n\ngoal (1 subgoal):\n 1. (moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_circle_set) =\n    (u \\<in> unit_circle_set)", "by fastforce"], ["", "lemma ex_rotation_mapping_u_to_positive_x_axis:\n  assumes \"u \\<noteq> 0\\<^sub>h\" and \"u \\<noteq> \\<infinity>\\<^sub>h\"\n  shows \"\\<exists> \\<phi>. moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis", "from assms"], ["proof (chain)\npicking this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h", "obtain c where *: \"u = of_complex c\""], ["proof (prove)\nusing this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. (\\<And>c. u = of_complex c \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using inf_or_of_complex"], ["proof (prove)\nusing this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n  ?z = \\<infinity>\\<^sub>h \\<or> (\\<exists>x. ?z = of_complex x)\n\ngoal (1 subgoal):\n 1. (\\<And>c. u = of_complex c \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  u = of_complex c\n\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis", "have \"is_real (cis (- arg c) * c)\" \"Re (cis (-arg c) * c) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_real (cis (- arg c) * c) &&& 0 < Re (cis (- arg c) * c)", "using \"*\" assms is_real_rot_to_x_axis positive_rot_to_x_axis of_complex_zero_iff"], ["proof (prove)\nusing this:\n  u = of_complex c\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n  ?z \\<noteq> 0 \\<Longrightarrow> is_real (cis (- arg ?z) * ?z)\n  ?z \\<noteq> 0 \\<Longrightarrow> 0 < Re (cis (- arg ?z) * ?z)\n  (of_complex ?x = 0\\<^sub>h) = (?x = 0)\n\ngoal (1 subgoal):\n 1. is_real (cis (- arg c) * c) &&& 0 < Re (cis (- arg c) * c)", "by blast+"], ["proof (state)\nthis:\n  is_real (cis (- arg c) * c)\n  0 < Re (cis (- arg c) * c)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis", "thus ?thesis"], ["proof (prove)\nusing this:\n  is_real (cis (- arg c) * c)\n  0 < Re (cis (- arg c) * c)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis", "using *"], ["proof (prove)\nusing this:\n  is_real (cis (- arg c) * c)\n  0 < Re (cis (- arg c) * c)\n  u = of_complex c\n\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis", "by (rule_tac x=\"-arg c\" in exI) (simp add: positive_x_axis_def circline_set_x_axis)"], ["proof (state)\nthis:\n  \\<exists>\\<phi>.\n     moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ex_rotation_mapping_u_to_positive_y_axis:\n  assumes \"u \\<noteq> 0\\<^sub>h\" and \"u \\<noteq> \\<infinity>\\<^sub>h\"\n  shows \"\\<exists> \\<phi>. moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis", "from assms"], ["proof (chain)\npicking this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h", "obtain c where *: \"u = of_complex c\""], ["proof (prove)\nusing this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. (\\<And>c. u = of_complex c \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using inf_or_of_complex"], ["proof (prove)\nusing this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n  ?z = \\<infinity>\\<^sub>h \\<or> (\\<exists>x. ?z = of_complex x)\n\ngoal (1 subgoal):\n 1. (\\<And>c. u = of_complex c \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  u = of_complex c\n\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis", "have \"is_imag (cis (pi/2 - arg c) * c)\" \"Im (cis (pi/2 - arg c) * c) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_imag (cis (pi / 2 - arg c) * c) &&& 0 < Im (cis (pi / 2 - arg c) * c)", "using \"*\" assms is_real_rot_to_x_axis positive_rot_to_x_axis of_complex_zero_iff"], ["proof (prove)\nusing this:\n  u = of_complex c\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n  ?z \\<noteq> 0 \\<Longrightarrow> is_real (cis (- arg ?z) * ?z)\n  ?z \\<noteq> 0 \\<Longrightarrow> 0 < Re (cis (- arg ?z) * ?z)\n  (of_complex ?x = 0\\<^sub>h) = (?x = 0)\n\ngoal (1 subgoal):\n 1. is_imag (cis (pi / 2 - arg c) * c) &&& 0 < Im (cis (pi / 2 - arg c) * c)", "by - (simp, simp, simp add: field_simps)"], ["proof (state)\nthis:\n  is_imag (cis (pi / 2 - arg c) * c)\n  0 < Im (cis (pi / 2 - arg c) * c)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis", "thus ?thesis"], ["proof (prove)\nusing this:\n  is_imag (cis (pi / 2 - arg c) * c)\n  0 < Im (cis (pi / 2 - arg c) * c)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis", "using *"], ["proof (prove)\nusing this:\n  is_imag (cis (pi / 2 - arg c) * c)\n  0 < Im (cis (pi / 2 - arg c) * c)\n  u = of_complex c\n\ngoal (1 subgoal):\n 1. \\<exists>\\<phi>.\n       moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis", "by (rule_tac x=\"pi/2-arg c\" in exI) (simp add: positive_y_axis_def circline_set_y_axis)"], ["proof (state)\nthis:\n  \\<exists>\\<phi>.\n     moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wlog_rotation_to_positive_x_axis:\n  assumes in_disc: \"u \\<in> unit_disc\" and not_zero: \"u \\<noteq> 0\\<^sub>h\"\n  assumes preserving: \"\\<And>\\<phi> u. \\<lbrakk>u \\<in> unit_disc; u \\<noteq> 0\\<^sub>h; P (moebius_pt (moebius_rotation \\<phi>) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes x_axis: \"\\<And>x. \\<lbrakk>is_real x; 0 < Re x; Re x < 1\\<rbrakk> \\<Longrightarrow> P (of_complex x)\"\n  shows \"P u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P u", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P u", "from in_disc"], ["proof (chain)\npicking this:\n  u \\<in> unit_disc", "obtain \\<phi> where *:\n    \"moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\""], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_x_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using ex_rotation_mapping_u_to_positive_x_axis[of u]"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  \\<lbrakk>u \\<noteq> 0\\<^sub>h; u \\<noteq> \\<infinity>\\<^sub>h\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<phi>.\n                       moebius_pt (moebius_rotation \\<phi>) u\n                       \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_x_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using inf_notin_unit_disc not_zero"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  \\<lbrakk>u \\<noteq> 0\\<^sub>h; u \\<noteq> \\<infinity>\\<^sub>h\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<phi>.\n                       moebius_pt (moebius_rotation \\<phi>) u\n                       \\<in> positive_x_axis\n  \\<infinity>\\<^sub>h \\<notin> unit_disc\n  u \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_x_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. P u", "let ?Mu = \"moebius_pt (moebius_rotation \\<phi>) u\""], ["proof (state)\ngoal (1 subgoal):\n 1. P u", "have \"P ?Mu\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "let ?x = \"to_complex ?Mu\""], ["proof (state)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "have \"?Mu \\<in> unit_disc\" \"?Mu \\<noteq> 0\\<^sub>h\" \"?Mu \\<noteq> \\<infinity>\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h", "using \\<open>u \\<in> unit_disc\\<close> \\<open>u \\<noteq> 0\\<^sub>h\\<close>"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  u \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h", "by auto"], ["proof (state)\nthis:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "hence \"is_real (to_complex ?Mu)\"  \"0 < Re ?x\" \"Re ?x < 1\""], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1", "using *"], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1", "unfolding positive_x_axis_def circline_set_x_axis"], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u\n  \\<in> {z \\<in> of_complex ` {x. is_real x} \\<union> {\\<infinity>\\<^sub>h}.\n         z \\<noteq> \\<infinity>\\<^sub>h \\<and> 0 < Re (to_complex z)}\n\ngoal (1 subgoal):\n 1. is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1", "by (auto simp add: cmod_eq_Re)"], ["proof (state)\nthis:\n  is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "thus ?thesis"], ["proof (prove)\nusing this:\n  is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "using x_axis[of ?x] \\<open>?Mu \\<noteq> \\<infinity>\\<^sub>h\\<close>"], ["proof (prove)\nusing this:\n  is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1\n  \\<lbrakk>is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u));\n   0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u));\n   Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1\\<rbrakk>\n  \\<Longrightarrow> P (of_complex\n                        (to_complex\n                          (moebius_pt (moebius_rotation \\<phi>) u)))\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "by simp"], ["proof (state)\nthis:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal (1 subgoal):\n 1. P u", "thus ?thesis"], ["proof (prove)\nusing this:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal (1 subgoal):\n 1. P u", "using preserving[OF in_disc] not_zero"], ["proof (prove)\nusing this:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n  \\<lbrakk>u \\<noteq> 0\\<^sub>h;\n   P (moebius_pt (moebius_rotation ?\\<phi>) u)\\<rbrakk>\n  \\<Longrightarrow> P u\n  u \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. P u", "by simp"], ["proof (state)\nthis:\n  P u\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wlog_rotation_to_positive_x_axis':\n  assumes not_zero: \"u \\<noteq> 0\\<^sub>h\" and not_inf: \"u \\<noteq> \\<infinity>\\<^sub>h\"\n  assumes preserving: \"\\<And>\\<phi> u. \\<lbrakk>u \\<noteq> 0\\<^sub>h; u \\<noteq> \\<infinity>\\<^sub>h; P (moebius_pt (moebius_rotation \\<phi>) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes x_axis: \"\\<And>x. \\<lbrakk>is_real x; 0 < Re x\\<rbrakk> \\<Longrightarrow> P (of_complex x)\"\n  shows \"P u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P u", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P u", "from not_zero and not_inf"], ["proof (chain)\npicking this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h", "obtain \\<phi> where *:\n    \"moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\""], ["proof (prove)\nusing this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_x_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using ex_rotation_mapping_u_to_positive_x_axis[of u]"], ["proof (prove)\nusing this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n  \\<lbrakk>u \\<noteq> 0\\<^sub>h; u \\<noteq> \\<infinity>\\<^sub>h\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<phi>.\n                       moebius_pt (moebius_rotation \\<phi>) u\n                       \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_x_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using inf_notin_unit_disc"], ["proof (prove)\nusing this:\n  u \\<noteq> 0\\<^sub>h\n  u \\<noteq> \\<infinity>\\<^sub>h\n  \\<lbrakk>u \\<noteq> 0\\<^sub>h; u \\<noteq> \\<infinity>\\<^sub>h\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<phi>.\n                       moebius_pt (moebius_rotation \\<phi>) u\n                       \\<in> positive_x_axis\n  \\<infinity>\\<^sub>h \\<notin> unit_disc\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_x_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. P u", "let ?Mu = \"moebius_pt (moebius_rotation \\<phi>) u\""], ["proof (state)\ngoal (1 subgoal):\n 1. P u", "have \"P ?Mu\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "let ?x = \"to_complex ?Mu\""], ["proof (state)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "have \"?Mu \\<noteq> 0\\<^sub>h\" \"?Mu \\<noteq> \\<infinity>\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h", "using \\<open>u \\<noteq> \\<infinity>\\<^sub>h\\<close> \\<open>u \\<noteq> 0\\<^sub>h\\<close>"], ["proof (prove)\nusing this:\n  u \\<noteq> \\<infinity>\\<^sub>h\n  u \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h", "by auto"], ["proof (state)\nthis:\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "hence \"is_real (to_complex ?Mu)\"  \"0 < Re ?x\""], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))", "using *"], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))", "unfolding positive_x_axis_def circline_set_x_axis"], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u\n  \\<in> {z \\<in> of_complex ` {x. is_real x} \\<union> {\\<infinity>\\<^sub>h}.\n         z \\<noteq> \\<infinity>\\<^sub>h \\<and> 0 < Re (to_complex z)}\n\ngoal (1 subgoal):\n 1. is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))", "by (auto simp add: cmod_eq_Re)"], ["proof (state)\nthis:\n  is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "thus ?thesis"], ["proof (prove)\nusing this:\n  is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "using x_axis[of ?x] \\<open>?Mu \\<noteq> \\<infinity>\\<^sub>h\\<close>"], ["proof (prove)\nusing this:\n  is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  \\<lbrakk>is_real (to_complex (moebius_pt (moebius_rotation \\<phi>) u));\n   0 < Re (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\\<rbrakk>\n  \\<Longrightarrow> P (of_complex\n                        (to_complex\n                          (moebius_pt (moebius_rotation \\<phi>) u)))\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "by simp"], ["proof (state)\nthis:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal (1 subgoal):\n 1. P u", "thus ?thesis"], ["proof (prove)\nusing this:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal (1 subgoal):\n 1. P u", "using preserving[OF not_zero not_inf]"], ["proof (prove)\nusing this:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n  P (moebius_pt (moebius_rotation ?\\<phi>) u) \\<Longrightarrow> P u\n\ngoal (1 subgoal):\n 1. P u", "by simp"], ["proof (state)\nthis:\n  P u\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wlog_rotation_to_positive_y_axis:\n  assumes in_disc: \"u \\<in> unit_disc\" and not_zero: \"u \\<noteq> 0\\<^sub>h\"\n  assumes preserving: \"\\<And>\\<phi> u. \\<lbrakk>u \\<in> unit_disc; u \\<noteq> 0\\<^sub>h; P (moebius_pt (moebius_rotation \\<phi>) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes y_axis: \"\\<And>x. \\<lbrakk>is_imag x; 0 < Im x; Im x < 1\\<rbrakk> \\<Longrightarrow> P (of_complex x)\"\n  shows \"P u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P u", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P u", "from in_disc and not_zero"], ["proof (chain)\npicking this:\n  u \\<in> unit_disc\n  u \\<noteq> 0\\<^sub>h", "obtain \\<phi> where *:\n    \"moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis\""], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  u \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_y_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using ex_rotation_mapping_u_to_positive_y_axis[of u]"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  u \\<noteq> 0\\<^sub>h\n  \\<lbrakk>u \\<noteq> 0\\<^sub>h; u \\<noteq> \\<infinity>\\<^sub>h\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<phi>.\n                       moebius_pt (moebius_rotation \\<phi>) u\n                       \\<in> positive_y_axis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_y_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using inf_notin_unit_disc"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  u \\<noteq> 0\\<^sub>h\n  \\<lbrakk>u \\<noteq> 0\\<^sub>h; u \\<noteq> \\<infinity>\\<^sub>h\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<phi>.\n                       moebius_pt (moebius_rotation \\<phi>) u\n                       \\<in> positive_y_axis\n  \\<infinity>\\<^sub>h \\<notin> unit_disc\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        moebius_pt (moebius_rotation \\<phi>) u\n        \\<in> positive_y_axis \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis\n\ngoal (1 subgoal):\n 1. P u", "let ?Mu = \"moebius_pt (moebius_rotation \\<phi>) u\""], ["proof (state)\ngoal (1 subgoal):\n 1. P u", "have \"P ?Mu\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "let ?y = \"to_complex ?Mu\""], ["proof (state)\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "have \"?Mu \\<in> unit_disc\" \"?Mu \\<noteq> 0\\<^sub>h\" \"?Mu \\<noteq> \\<infinity>\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h", "using \\<open>u \\<in> unit_disc\\<close> \\<open>u \\<noteq> 0\\<^sub>h\\<close>"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  u \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h &&&\n    moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h", "by auto"], ["proof (state)\nthis:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "hence \"is_imag (to_complex ?Mu)\"  \"0 < Im ?y\" \"Im ?y < 1\""], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. is_imag (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1", "using *"], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> positive_y_axis\n\ngoal (1 subgoal):\n 1. is_imag (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1", "unfolding positive_y_axis_def circline_set_y_axis"], ["proof (prove)\nusing this:\n  moebius_pt (moebius_rotation \\<phi>) u \\<in> unit_disc\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> 0\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n  moebius_pt (moebius_rotation \\<phi>) u\n  \\<in> {z \\<in> of_complex ` {x. is_imag x} \\<union> {\\<infinity>\\<^sub>h}.\n         z \\<noteq> \\<infinity>\\<^sub>h \\<and> 0 < Im (to_complex z)}\n\ngoal (1 subgoal):\n 1. is_imag (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    0 < Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) &&&\n    Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1", "by (auto simp add: cmod_eq_Im)"], ["proof (state)\nthis:\n  is_imag (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "thus ?thesis"], ["proof (prove)\nusing this:\n  is_imag (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "using y_axis[of ?y] \\<open>?Mu \\<noteq> \\<infinity>\\<^sub>h\\<close>"], ["proof (prove)\nusing this:\n  is_imag (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  0 < Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u))\n  Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1\n  \\<lbrakk>is_imag (to_complex (moebius_pt (moebius_rotation \\<phi>) u));\n   0 < Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u));\n   Im (to_complex (moebius_pt (moebius_rotation \\<phi>) u)) < 1\\<rbrakk>\n  \\<Longrightarrow> P (of_complex\n                        (to_complex\n                          (moebius_pt (moebius_rotation \\<phi>) u)))\n  moebius_pt (moebius_rotation \\<phi>) u \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. P (moebius_pt (moebius_rotation \\<phi>) u)", "by simp"], ["proof (state)\nthis:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal (1 subgoal):\n 1. P u", "thus ?thesis"], ["proof (prove)\nusing this:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n\ngoal (1 subgoal):\n 1. P u", "using preserving[OF in_disc not_zero]"], ["proof (prove)\nusing this:\n  P (moebius_pt (moebius_rotation \\<phi>) u)\n  P (moebius_pt (moebius_rotation ?\\<phi>) u) \\<Longrightarrow> P u\n\ngoal (1 subgoal):\n 1. P u", "by simp"], ["proof (state)\nthis:\n  P u\n\ngoal:\nNo subgoals!", "qed"], ["", "(* ---------------------------------------------------------------------------- *)"], ["", "subsection \\<open>Blaschke factors are unit disc preserving transformations\\<close>"], ["", "(* ---------------------------------------------------------------------------- *)"], ["", "text \\<open>For a given point $a$, Blaschke factor transformations are of the form $k \\cdot\n\\left(\\begin{array}{cc}1 & -a\\\\ -\\overline{a} & 1\\end{array}\\right)$. It is a disc preserving\nM?bius transformation that maps the point $a$ to zero (by the symmetry principle, it must map the\ninverse point of $a$ to infinity).\\<close>"], ["", "definition blaschke_cmat :: \"complex \\<Rightarrow> complex_mat\" where\n [simp]: \"blaschke_cmat a = (if cmod a \\<noteq> 1 then (1, -a, -cnj a, 1) else eye)\""], ["", "lift_definition blaschke_mmat :: \"complex \\<Rightarrow> moebius_mat\" is blaschke_cmat"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>complex. mat_det (blaschke_cmat complex) \\<noteq> 0", "by simp"], ["", "lift_definition blaschke :: \"complex \\<Rightarrow> moebius\" is blaschke_mmat"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma blaschke_0_id [simp]: \"blaschke 0 = id_moebius\""], ["proof (prove)\ngoal (1 subgoal):\n 1. blaschke 0 = id_moebius", "by (transfer, transfer, simp)"], ["", "lemma blaschke_a_to_zero [simp]:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h", "using assms"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h", "by (transfer, transfer, simp)"], ["", "lemma blaschke_inv_a_inf [simp]:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"moebius_pt (blaschke a) (inversion (of_complex a)) = \\<infinity>\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (inversion (of_complex a)) = \\<infinity>\\<^sub>h", "using assms"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (inversion (of_complex a)) = \\<infinity>\\<^sub>h", "unfolding inversion_def"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a)\n     ((conjugate \\<circ> reciprocal) (of_complex a)) =\n    \\<infinity>\\<^sub>h", "by (transfer, transfer) (simp add: vec_cnj_def, rule_tac x=\"1/(1 - a*cnj a)\" in exI, simp)"], ["", "lemma blaschke_inf [simp]:\n  assumes \"cmod a < 1\" and \"a \\<noteq> 0\"\n  shows \"moebius_pt (blaschke a) \\<infinity>\\<^sub>h = of_complex (- 1 / cnj a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) \\<infinity>\\<^sub>h = of_complex (- 1 / cnj a)", "using assms"], ["proof (prove)\nusing this:\n  cmod a < 1\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) \\<infinity>\\<^sub>h = of_complex (- 1 / cnj a)", "by (transfer, transfer, simp add: complex_mod_sqrt_Re_mult_cnj)"], ["", "lemma blaschke_0_minus_a [simp]:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"moebius_pt (blaschke a) 0\\<^sub>h = ~\\<^sub>h (of_complex a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) 0\\<^sub>h = ~\\<^sub>h (of_complex a)", "using assms"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) 0\\<^sub>h = ~\\<^sub>h (of_complex a)", "by (transfer, transfer, simp)"], ["", "lemma blaschke_unit_circle_fix [simp]:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"unit_circle_fix (blaschke a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_circle_fix (blaschke a)", "using assms"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. unit_circle_fix (blaschke a)", "by (transfer, transfer) (simp add: unitary11_gen_def mat_adj_def mat_cnj_def)"], ["", "lemma blaschke_unit_disc_fix [simp]:\n  assumes \"cmod a < 1\"\n  shows \"unit_disc_fix (blaschke a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix (blaschke a)", "using assms"], ["proof (prove)\nusing this:\n  cmod a < 1\n\ngoal (1 subgoal):\n 1. unit_disc_fix (blaschke a)", "proof (transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>cmod a < 1; cmod aa < 1\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "fix a"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>cmod a < 1; cmod aa < 1\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "assume *: \"cmod a < 1\""], ["proof (state)\nthis:\n  cmod a < 1\n\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>cmod a < 1; cmod aa < 1\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "show \"unit_disc_fix_cmat (blaschke_cmat a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix_cmat (blaschke_cmat a)", "proof (cases \"a = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. a = 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)\n 2. a \\<noteq> 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "case True"], ["proof (state)\nthis:\n  a = 0\n\ngoal (2 subgoals):\n 1. a = 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)\n 2. a \\<noteq> 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "thus ?thesis"], ["proof (prove)\nusing this:\n  a = 0\n\ngoal (1 subgoal):\n 1. unit_disc_fix_cmat (blaschke_cmat a)", "by (simp add: unitary11_gen_def mat_adj_def mat_cnj_def)"], ["proof (state)\nthis:\n  unit_disc_fix_cmat (blaschke_cmat a)\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "case False"], ["proof (state)\nthis:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "hence \"Re (a * cnj a) < 1\""], ["proof (prove)\nusing this:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. Re (a * cnj a) < 1", "using *"], ["proof (prove)\nusing this:\n  a \\<noteq> 0\n  cmod a < 1\n\ngoal (1 subgoal):\n 1. Re (a * cnj a) < 1", "by (metis complex_mod_sqrt_Re_mult_cnj real_sqrt_lt_1_iff)"], ["proof (state)\nthis:\n  Re (a * cnj a) < 1\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "hence \"1 / Re (a * cnj a) > 1\""], ["proof (prove)\nusing this:\n  Re (a * cnj a) < 1\n\ngoal (1 subgoal):\n 1. 1 < 1 / Re (a * cnj a)", "using False"], ["proof (prove)\nusing this:\n  Re (a * cnj a) < 1\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 1 < 1 / Re (a * cnj a)", "by (smt complex_div_gt_0 less_divide_eq_1_pos one_complex.simps(1) right_inverse_eq)"], ["proof (state)\nthis:\n  1 < 1 / Re (a * cnj a)\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "hence \"Re (1 / (a * cnj a)) > 1\""], ["proof (prove)\nusing this:\n  1 < 1 / Re (a * cnj a)\n\ngoal (1 subgoal):\n 1. 1 < Re (1 / (a * cnj a))", "by (simp add: complex_is_Real_iff)"], ["proof (state)\nthis:\n  1 < Re (1 / (a * cnj a))\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow> unit_disc_fix_cmat (blaschke_cmat a)", "thus ?thesis"], ["proof (prove)\nusing this:\n  1 < Re (1 / (a * cnj a))\n\ngoal (1 subgoal):\n 1. unit_disc_fix_cmat (blaschke_cmat a)", "by (simp add: unitary11_gen_def mat_adj_def mat_cnj_def)"], ["proof (state)\nthis:\n  unit_disc_fix_cmat (blaschke_cmat a)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  unit_disc_fix_cmat (blaschke_cmat a)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma blaschke_unit_circle_fix':\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"moebius_circline (blaschke a) unit_circle = unit_circle\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_circline (blaschke a) unit_circle = unit_circle", "using assms"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. moebius_circline (blaschke a) unit_circle = unit_circle", "using blaschke_unit_circle_fix unit_circle_fix_iff"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n  cmod ?a \\<noteq> 1 \\<Longrightarrow> unit_circle_fix (blaschke ?a)\n  unit_circle_fix ?M = (moebius_circline ?M unit_circle = unit_circle)\n\ngoal (1 subgoal):\n 1. moebius_circline (blaschke a) unit_circle = unit_circle", "by simp"], ["", "lemma blaschke_ounit_circle_fix':\n  assumes \"cmod a < 1\"\n  shows \"moebius_ocircline (blaschke a) ounit_circle = ounit_circle\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_ocircline (blaschke a) ounit_circle = ounit_circle", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. moebius_ocircline (blaschke a) ounit_circle = ounit_circle", "have \"Re (a * cnj a) < 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Re (a * cnj a) < 1", "using assms"], ["proof (prove)\nusing this:\n  cmod a < 1\n\ngoal (1 subgoal):\n 1. Re (a * cnj a) < 1", "by (metis complex_mod_sqrt_Re_mult_cnj real_sqrt_lt_1_iff)"], ["proof (state)\nthis:\n  Re (a * cnj a) < 1\n\ngoal (1 subgoal):\n 1. moebius_ocircline (blaschke a) ounit_circle = ounit_circle", "thus ?thesis"], ["proof (prove)\nusing this:\n  Re (a * cnj a) < 1\n\ngoal (1 subgoal):\n 1. moebius_ocircline (blaschke a) ounit_circle = ounit_circle", "using assms"], ["proof (prove)\nusing this:\n  Re (a * cnj a) < 1\n  cmod a < 1\n\ngoal (1 subgoal):\n 1. moebius_ocircline (blaschke a) ounit_circle = ounit_circle", "using blaschke_unit_disc_fix unit_disc_fix_iff_ounit_circle"], ["proof (prove)\nusing this:\n  Re (a * cnj a) < 1\n  cmod a < 1\n  cmod ?a < 1 \\<Longrightarrow> unit_disc_fix (blaschke ?a)\n  unit_disc_fix ?M = (moebius_ocircline ?M ounit_circle = ounit_circle)\n\ngoal (1 subgoal):\n 1. moebius_ocircline (blaschke a) ounit_circle = ounit_circle", "by simp"], ["proof (state)\nthis:\n  moebius_ocircline (blaschke a) ounit_circle = ounit_circle\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma moebius_pt_blaschke [simp]:\n  assumes \"cmod a \\<noteq> 1\" and \"z \\<noteq> 1 / cnj a\"\n  shows \"moebius_pt (blaschke a) (of_complex z) = of_complex ((z - a) / (1 - cnj a * z))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex z) =\n    of_complex ((z - a) / (1 - cnj a * z))", "using assms"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n  z \\<noteq> 1 / cnj a\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex z) =\n    of_complex ((z - a) / (1 - cnj a * z))", "proof (cases \"a = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>cmod a \\<noteq> 1; z \\<noteq> 1 / cnj a; a = 0\\<rbrakk>\n    \\<Longrightarrow> moebius_pt (blaschke a) (of_complex z) =\n                      of_complex ((z - a) / (1 - cnj a * z))\n 2. \\<lbrakk>cmod a \\<noteq> 1; z \\<noteq> 1 / cnj a; a \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> moebius_pt (blaschke a) (of_complex z) =\n                      of_complex ((z - a) / (1 - cnj a * z))", "case True"], ["proof (state)\nthis:\n  a = 0\n\ngoal (2 subgoals):\n 1. \\<lbrakk>cmod a \\<noteq> 1; z \\<noteq> 1 / cnj a; a = 0\\<rbrakk>\n    \\<Longrightarrow> moebius_pt (blaschke a) (of_complex z) =\n                      of_complex ((z - a) / (1 - cnj a * z))\n 2. \\<lbrakk>cmod a \\<noteq> 1; z \\<noteq> 1 / cnj a; a \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> moebius_pt (blaschke a) (of_complex z) =\n                      of_complex ((z - a) / (1 - cnj a * z))", "thus ?thesis"], ["proof (prove)\nusing this:\n  a = 0\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex z) =\n    of_complex ((z - a) / (1 - cnj a * z))", "by auto"], ["proof (state)\nthis:\n  moebius_pt (blaschke a) (of_complex z) =\n  of_complex ((z - a) / (1 - cnj a * z))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>cmod a \\<noteq> 1; z \\<noteq> 1 / cnj a; a \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> moebius_pt (blaschke a) (of_complex z) =\n                      of_complex ((z - a) / (1 - cnj a * z))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>cmod a \\<noteq> 1; z \\<noteq> 1 / cnj a; a \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> moebius_pt (blaschke a) (of_complex z) =\n                      of_complex ((z - a) / (1 - cnj a * z))", "case False"], ["proof (state)\nthis:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>cmod a \\<noteq> 1; z \\<noteq> 1 / cnj a; a \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> moebius_pt (blaschke a) (of_complex z) =\n                      of_complex ((z - a) / (1 - cnj a * z))", "thus ?thesis"], ["proof (prove)\nusing this:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex z) =\n    of_complex ((z - a) / (1 - cnj a * z))", "using assms"], ["proof (prove)\nusing this:\n  a \\<noteq> 0\n  cmod a \\<noteq> 1\n  z \\<noteq> 1 / cnj a\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex z) =\n    of_complex ((z - a) / (1 - cnj a * z))", "apply (transfer, transfer)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a z aa za.\n       \\<lbrakk>a \\<noteq> 0; cmod a \\<noteq> 1; z \\<noteq> 1 / cnj a;\n        aa \\<noteq> 0; cmod aa \\<noteq> 1; za \\<noteq> 1 / cnj aa\\<rbrakk>\n       \\<Longrightarrow> moebius_pt_cmat_cvec (blaschke_cmat a)\n                          (of_complex_cvec z) \\<approx>\\<^sub>v\n                         of_complex_cvec ((z - a) / (1 - cnj a * z))", "apply (simp add: complex_mod_sqrt_Re_mult_cnj)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a z aa za.\n       \\<lbrakk>a \\<noteq> 0; Re a * Re a + Im a * Im a \\<noteq> 1;\n        z \\<noteq> 1 / cnj a; aa \\<noteq> 0;\n        Re aa * Re aa + Im aa * Im aa \\<noteq> 1;\n        za \\<noteq> 1 / cnj aa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            k \\<noteq> 0 \\<and>\n                            (z - a) / (1 - cnj a * z) = k * (z - a) \\<and>\n                            k * (1 - z * cnj a) = 1", "apply (rule_tac x=\"1 / (1 - cnj a * z)\" in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a z aa za.\n       \\<lbrakk>a \\<noteq> 0; Re a * Re a + Im a * Im a \\<noteq> 1;\n        z \\<noteq> 1 / cnj a; aa \\<noteq> 0;\n        Re aa * Re aa + Im aa * Im aa \\<noteq> 1;\n        za \\<noteq> 1 / cnj aa\\<rbrakk>\n       \\<Longrightarrow> 1 / (1 - cnj a * z) \\<noteq> 0 \\<and>\n                         (z - a) / (1 - cnj a * z) =\n                         1 / (1 - cnj a * z) * (z - a) \\<and>\n                         1 / (1 - cnj a * z) * (1 - z * cnj a) = 1", "apply (simp add: field_simps)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  moebius_pt (blaschke a) (of_complex z) =\n  of_complex ((z - a) / (1 - cnj a * z))\n\ngoal:\nNo subgoals!", "qed"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsubsection \\<open>Blaschke factors for a real point $a$\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "text \\<open>If the point $a$ is real, the Blaschke factor preserve x-axis and the upper and the lower\nhalfplane.\\<close>"], ["", "lemma blaschke_real_preserve_x_axis [simp]:\n  assumes \"is_real a\" and \"cmod a < 1\"\n  shows \"moebius_pt (blaschke a) z \\<in> circline_set x_axis \\<longleftrightarrow> z \\<in> circline_set x_axis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "proof (cases \"a = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. a = 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)\n 2. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "case True"], ["proof (state)\nthis:\n  a = 0\n\ngoal (2 subgoals):\n 1. a = 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)\n 2. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "thus ?thesis"], ["proof (prove)\nusing this:\n  a = 0\n\ngoal (1 subgoal):\n 1. (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "by simp"], ["proof (state)\nthis:\n  (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n  (z \\<in> circline_set x_axis)\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "case False"], ["proof (state)\nthis:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "have \"cmod a \\<noteq> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod a \\<noteq> 1", "using assms"], ["proof (prove)\nusing this:\n  is_real a\n  cmod a < 1\n\ngoal (1 subgoal):\n 1. cmod a \\<noteq> 1", "by linarith"], ["proof (state)\nthis:\n  cmod a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "let ?a = \"of_complex a\""], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "let ?i = \"inversion ?a\""], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "let ?M = \"moebius_pt (blaschke a)\""], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "have *: \"?M ?a = 0\\<^sub>h\" \"?M ?i = \\<infinity>\\<^sub>h\" \"?M 0\\<^sub>h = of_complex (-a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h &&&\n    moebius_pt (blaschke a) (inversion (of_complex a)) =\n    \\<infinity>\\<^sub>h &&&\n    moebius_pt (blaschke a) 0\\<^sub>h = of_complex (- a)", "using \\<open>cmod a \\<noteq> 1\\<close> blaschke_a_to_zero[of a] blaschke_inv_a_inf[of a] blaschke_0_minus_a[of a]"], ["proof (prove)\nusing this:\n  cmod a \\<noteq> 1\n  cmod a \\<noteq> 1 \\<Longrightarrow>\n  moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h\n  cmod a \\<noteq> 1 \\<Longrightarrow>\n  moebius_pt (blaschke a) (inversion (of_complex a)) = \\<infinity>\\<^sub>h\n  cmod a \\<noteq> 1 \\<Longrightarrow>\n  moebius_pt (blaschke a) 0\\<^sub>h = ~\\<^sub>h (of_complex a)\n\ngoal (1 subgoal):\n 1. moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h &&&\n    moebius_pt (blaschke a) (inversion (of_complex a)) =\n    \\<infinity>\\<^sub>h &&&\n    moebius_pt (blaschke a) 0\\<^sub>h = of_complex (- a)", "by auto"], ["proof (state)\nthis:\n  moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h\n  moebius_pt (blaschke a) (inversion (of_complex a)) = \\<infinity>\\<^sub>h\n  moebius_pt (blaschke a) 0\\<^sub>h = of_complex (- a)\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "let ?Mx = \"moebius_circline (blaschke a) x_axis\""], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "have \"?a \\<in> circline_set x_axis\" \"?i \\<in> circline_set x_axis\" \"0\\<^sub>h \\<in> circline_set x_axis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_complex a \\<in> circline_set x_axis &&&\n    inversion (of_complex a) \\<in> circline_set x_axis &&&\n    0\\<^sub>h \\<in> circline_set x_axis", "using \\<open>is_real a\\<close> \\<open>a \\<noteq> 0\\<close> eq_cnj_iff_real[of a]"], ["proof (prove)\nusing this:\n  is_real a\n  a \\<noteq> 0\n  (cnj a = a) = is_real a\n\ngoal (1 subgoal):\n 1. of_complex a \\<in> circline_set x_axis &&&\n    inversion (of_complex a) \\<in> circline_set x_axis &&&\n    0\\<^sub>h \\<in> circline_set x_axis", "by auto"], ["proof (state)\nthis:\n  of_complex a \\<in> circline_set x_axis\n  inversion (of_complex a) \\<in> circline_set x_axis\n  0\\<^sub>h \\<in> circline_set x_axis\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "hence \"0\\<^sub>h \\<in> circline_set ?Mx\" \"\\<infinity>\\<^sub>h \\<in> circline_set ?Mx\" \"of_complex (-a) \\<in> circline_set ?Mx\""], ["proof (prove)\nusing this:\n  of_complex a \\<in> circline_set x_axis\n  inversion (of_complex a) \\<in> circline_set x_axis\n  0\\<^sub>h \\<in> circline_set x_axis\n\ngoal (1 subgoal):\n 1. 0\\<^sub>h \\<in> circline_set (moebius_circline (blaschke a) x_axis) &&&\n    \\<infinity>\\<^sub>h\n    \\<in> circline_set (moebius_circline (blaschke a) x_axis) &&&\n    of_complex (- a)\n    \\<in> circline_set (moebius_circline (blaschke a) x_axis)", "using *"], ["proof (prove)\nusing this:\n  of_complex a \\<in> circline_set x_axis\n  inversion (of_complex a) \\<in> circline_set x_axis\n  0\\<^sub>h \\<in> circline_set x_axis\n  moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h\n  moebius_pt (blaschke a) (inversion (of_complex a)) = \\<infinity>\\<^sub>h\n  moebius_pt (blaschke a) 0\\<^sub>h = of_complex (- a)\n\ngoal (1 subgoal):\n 1. 0\\<^sub>h \\<in> circline_set (moebius_circline (blaschke a) x_axis) &&&\n    \\<infinity>\\<^sub>h\n    \\<in> circline_set (moebius_circline (blaschke a) x_axis) &&&\n    of_complex (- a)\n    \\<in> circline_set (moebius_circline (blaschke a) x_axis)", "apply -"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>of_complex a \\<in> circline_set x_axis;\n     inversion (of_complex a) \\<in> circline_set x_axis;\n     0\\<^sub>h \\<in> circline_set x_axis;\n     moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h;\n     moebius_pt (blaschke a) (inversion (of_complex a)) =\n     \\<infinity>\\<^sub>h;\n     moebius_pt (blaschke a) 0\\<^sub>h = of_complex (- a)\\<rbrakk>\n    \\<Longrightarrow> 0\\<^sub>h\n                      \\<in> circline_set\n                             (moebius_circline (blaschke a) x_axis)\n 2. \\<lbrakk>of_complex a \\<in> circline_set x_axis;\n     inversion (of_complex a) \\<in> circline_set x_axis;\n     0\\<^sub>h \\<in> circline_set x_axis;\n     moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h;\n     moebius_pt (blaschke a) (inversion (of_complex a)) =\n     \\<infinity>\\<^sub>h;\n     moebius_pt (blaschke a) 0\\<^sub>h = of_complex (- a)\\<rbrakk>\n    \\<Longrightarrow> \\<infinity>\\<^sub>h\n                      \\<in> circline_set\n                             (moebius_circline (blaschke a) x_axis)\n 3. \\<lbrakk>of_complex a \\<in> circline_set x_axis;\n     inversion (of_complex a) \\<in> circline_set x_axis;\n     0\\<^sub>h \\<in> circline_set x_axis;\n     moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h;\n     moebius_pt (blaschke a) (inversion (of_complex a)) =\n     \\<infinity>\\<^sub>h;\n     moebius_pt (blaschke a) 0\\<^sub>h = of_complex (- a)\\<rbrakk>\n    \\<Longrightarrow> of_complex (- a)\n                      \\<in> circline_set\n                             (moebius_circline (blaschke a) x_axis)", "apply (force simp add: image_iff)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>of_complex a \\<in> circline_set x_axis;\n     inversion (of_complex a) \\<in> circline_set x_axis;\n     0\\<^sub>h \\<in> circline_set x_axis;\n     moebius_pt (blaschke a) (of_complex a) = 0\\<^sub>h;\n     moebius_pt (blaschke a) (inversion (of_complex a)) =\n     \\<infinity>\\<^sub>h;\n     moebius_pt (blaschke a) 0\\<^sub>h = of_complex (- a)\\<rbrakk>\n    \\<Longrightarrow> of_complex (- a)\n                      \\<in> circline_set\n                             (moebius_circline (blaschke a) x_axis)", "apply (simp add: image_iff, rule_tac x=\"0\\<^sub>h\" in bexI, simp_all)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  0\\<^sub>h \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  \\<infinity>\\<^sub>h\n  \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  of_complex (- a) \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "moreover"], ["proof (state)\nthis:\n  0\\<^sub>h \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  \\<infinity>\\<^sub>h\n  \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  of_complex (- a) \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "have \"0\\<^sub>h \\<in> circline_set x_axis\" \"\\<infinity>\\<^sub>h \\<in> circline_set x_axis\" \"of_complex (-a) \\<in> circline_set x_axis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0\\<^sub>h \\<in> circline_set x_axis &&&\n    \\<infinity>\\<^sub>h \\<in> circline_set x_axis &&&\n    of_complex (- a) \\<in> circline_set x_axis", "using \\<open>is_real a\\<close>"], ["proof (prove)\nusing this:\n  is_real a\n\ngoal (1 subgoal):\n 1. 0\\<^sub>h \\<in> circline_set x_axis &&&\n    \\<infinity>\\<^sub>h \\<in> circline_set x_axis &&&\n    of_complex (- a) \\<in> circline_set x_axis", "by auto"], ["proof (state)\nthis:\n  0\\<^sub>h \\<in> circline_set x_axis\n  \\<infinity>\\<^sub>h \\<in> circline_set x_axis\n  of_complex (- a) \\<in> circline_set x_axis\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "moreover"], ["proof (state)\nthis:\n  0\\<^sub>h \\<in> circline_set x_axis\n  \\<infinity>\\<^sub>h \\<in> circline_set x_axis\n  of_complex (- a) \\<in> circline_set x_axis\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "have \"of_complex (-a) \\<noteq> 0\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_complex (- a) \\<noteq> 0\\<^sub>h", "using \\<open>a \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. of_complex (- a) \\<noteq> 0\\<^sub>h", "by simp"], ["proof (state)\nthis:\n  of_complex (- a) \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "hence \"0\\<^sub>h \\<noteq> of_complex (-a)\""], ["proof (prove)\nusing this:\n  of_complex (- a) \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. 0\\<^sub>h \\<noteq> of_complex (- a)", "by metis"], ["proof (state)\nthis:\n  0\\<^sub>h \\<noteq> of_complex (- a)\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "hence \"\\<exists>!H. 0\\<^sub>h \\<in> circline_set H \\<and> \\<infinity>\\<^sub>h \\<in> circline_set H \\<and> of_complex (- a) \\<in> circline_set H\""], ["proof (prove)\nusing this:\n  0\\<^sub>h \\<noteq> of_complex (- a)\n\ngoal (1 subgoal):\n 1. \\<exists>!H.\n       0\\<^sub>h \\<in> circline_set H \\<and>\n       \\<infinity>\\<^sub>h \\<in> circline_set H \\<and>\n       of_complex (- a) \\<in> circline_set H", "using unique_circline_set[of \"0\\<^sub>h\" \"\\<infinity>\\<^sub>h\" \"of_complex (-a)\"] \\<open>a \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  0\\<^sub>h \\<noteq> of_complex (- a)\n  \\<lbrakk>0\\<^sub>h \\<noteq> \\<infinity>\\<^sub>h;\n   0\\<^sub>h \\<noteq> of_complex (- a);\n   \\<infinity>\\<^sub>h \\<noteq> of_complex (- a)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>!H.\n                       0\\<^sub>h \\<in> circline_set H \\<and>\n                       \\<infinity>\\<^sub>h \\<in> circline_set H \\<and>\n                       of_complex (- a) \\<in> circline_set H\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>!H.\n       0\\<^sub>h \\<in> circline_set H \\<and>\n       \\<infinity>\\<^sub>h \\<in> circline_set H \\<and>\n       of_complex (- a) \\<in> circline_set H", "by simp"], ["proof (state)\nthis:\n  \\<exists>!H.\n     0\\<^sub>h \\<in> circline_set H \\<and>\n     \\<infinity>\\<^sub>h \\<in> circline_set H \\<and>\n     of_complex (- a) \\<in> circline_set H\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "ultimately"], ["proof (chain)\npicking this:\n  0\\<^sub>h \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  \\<infinity>\\<^sub>h\n  \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  of_complex (- a) \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  0\\<^sub>h \\<in> circline_set x_axis\n  \\<infinity>\\<^sub>h \\<in> circline_set x_axis\n  of_complex (- a) \\<in> circline_set x_axis\n  \\<exists>!H.\n     0\\<^sub>h \\<in> circline_set H \\<and>\n     \\<infinity>\\<^sub>h \\<in> circline_set H \\<and>\n     of_complex (- a) \\<in> circline_set H", "have \"moebius_circline (blaschke a) x_axis = x_axis\""], ["proof (prove)\nusing this:\n  0\\<^sub>h \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  \\<infinity>\\<^sub>h\n  \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  of_complex (- a) \\<in> circline_set (moebius_circline (blaschke a) x_axis)\n  0\\<^sub>h \\<in> circline_set x_axis\n  \\<infinity>\\<^sub>h \\<in> circline_set x_axis\n  of_complex (- a) \\<in> circline_set x_axis\n  \\<exists>!H.\n     0\\<^sub>h \\<in> circline_set H \\<and>\n     \\<infinity>\\<^sub>h \\<in> circline_set H \\<and>\n     of_complex (- a) \\<in> circline_set H\n\ngoal (1 subgoal):\n 1. moebius_circline (blaschke a) x_axis = x_axis", "by auto"], ["proof (state)\nthis:\n  moebius_circline (blaschke a) x_axis = x_axis\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "thus ?thesis"], ["proof (prove)\nusing this:\n  moebius_circline (blaschke a) x_axis = x_axis\n\ngoal (1 subgoal):\n 1. (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n    (z \\<in> circline_set x_axis)", "by (metis circline_set_moebius_circline_iff)"], ["proof (state)\nthis:\n  (moebius_pt (blaschke a) z \\<in> circline_set x_axis) =\n  (z \\<in> circline_set x_axis)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma blaschke_real_preserve_sgn_Im [simp]:\n  assumes \"is_real a\" and \"cmod a < 1\" and \"z \\<noteq> \\<infinity>\\<^sub>h\" and \"z \\<noteq> inversion (of_complex a)\"\n  shows \"sgn (Im (to_complex (moebius_pt (blaschke a) z))) = sgn (Im (to_complex z))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "proof (cases \"a = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. a = 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))\n 2. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "case True"], ["proof (state)\nthis:\n  a = 0\n\ngoal (2 subgoals):\n 1. a = 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))\n 2. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "thus ?thesis"], ["proof (prove)\nusing this:\n  a = 0\n\ngoal (1 subgoal):\n 1. sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "by simp"], ["proof (state)\nthis:\n  sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n  sgn (Im (to_complex z))\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "case False"], ["proof (state)\nthis:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "obtain z' where z': \"z = of_complex z'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>z'. z = of_complex z' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using inf_or_of_complex[of z] \\<open>z \\<noteq> \\<infinity>\\<^sub>h\\<close>"], ["proof (prove)\nusing this:\n  z = \\<infinity>\\<^sub>h \\<or> (\\<exists>x. z = of_complex x)\n  z \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. (\\<And>z'. z = of_complex z' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  z = of_complex z'\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "have \"z' \\<noteq> 1 / cnj a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z' \\<noteq> 1 / cnj a", "using assms z' \\<open>a \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  is_real a\n  cmod a < 1\n  z \\<noteq> \\<infinity>\\<^sub>h\n  z \\<noteq> inversion (of_complex a)\n  z = of_complex z'\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. z' \\<noteq> 1 / cnj a", "by (auto simp add: of_complex_inj)"], ["proof (state)\nthis:\n  z' \\<noteq> 1 / cnj a\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "moreover"], ["proof (state)\nthis:\n  z' \\<noteq> 1 / cnj a\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "have \"a * cnj a \\<noteq> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a * cnj a \\<noteq> 1", "using \\<open>cmod a < 1\\<close>"], ["proof (prove)\nusing this:\n  cmod a < 1\n\ngoal (1 subgoal):\n 1. a * cnj a \\<noteq> 1", "by auto (simp add: complex_mod_sqrt_Re_mult_cnj)"], ["proof (state)\nthis:\n  a * cnj a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "moreover"], ["proof (state)\nthis:\n  a * cnj a \\<noteq> 1\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "have \"sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "have \"a * z' \\<noteq> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a * z' \\<noteq> 1", "using \\<open>is_real a\\<close> \\<open>z' \\<noteq> 1 / cnj a\\<close> \\<open>a \\<noteq> 0\\<close> eq_cnj_iff_real[of a]"], ["proof (prove)\nusing this:\n  is_real a\n  z' \\<noteq> 1 / cnj a\n  a \\<noteq> 0\n  (cnj a = a) = is_real a\n\ngoal (1 subgoal):\n 1. a * z' \\<noteq> 1", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  a * z' \\<noteq> 1\n\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "moreover"], ["proof (state)\nthis:\n  a * z' \\<noteq> 1\n\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "have \"Re (1 - a\\<^sup>2) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < Re (1 - a\\<^sup>2)", "using \\<open>is_real a\\<close> \\<open>cmod a < 1\\<close>"], ["proof (prove)\nusing this:\n  is_real a\n  cmod a < 1\n\ngoal (1 subgoal):\n 1. 0 < Re (1 - a\\<^sup>2)", "by (smt Re_power2 minus_complex.simps(1) norm_complex_def one_complex.simps(1) power2_less_0 real_sqrt_lt_1_iff)"], ["proof (state)\nthis:\n  0 < Re (1 - a\\<^sup>2)\n\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "moreover"], ["proof (state)\nthis:\n  0 < Re (1 - a\\<^sup>2)\n\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "have \"Im ((z' - a) / (1 - a * z')) = Re (((1 - a\\<^sup>2) * Im z') / (cmod (1 - a*z'))\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))", "have \"1 - a * cnj z' \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 - a * cnj z' \\<noteq> 0", "using \\<open>z' \\<noteq> 1 / cnj a\\<close>"], ["proof (prove)\nusing this:\n  z' \\<noteq> 1 / cnj a\n\ngoal (1 subgoal):\n 1. 1 - a * cnj z' \\<noteq> 0", "by (metis Im_complex_div_eq_0  complex_cnj_zero_iff diff_eq_diff_eq diff_numeral_special(9) eq_divide_imp is_real_div mult_not_zero one_complex.simps(2) zero_neq_one)"], ["proof (state)\nthis:\n  1 - a * cnj z' \\<noteq> 0\n\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))", "hence \"Im ((z' - a) / (1 - a * z')) = Im (((z' - a) * (1 - a * cnj z')) / ((1 - a * z') * cnj (1 - a * z')))\""], ["proof (prove)\nusing this:\n  1 - a * cnj z' \\<noteq> 0\n\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Im ((z' - a) * (1 - a * cnj z') / ((1 - a * z') * cnj (1 - a * z')))", "using \\<open>is_real a\\<close> eq_cnj_iff_real[of a]"], ["proof (prove)\nusing this:\n  1 - a * cnj z' \\<noteq> 0\n  is_real a\n  (cnj a = a) = is_real a\n\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Im ((z' - a) * (1 - a * cnj z') / ((1 - a * z') * cnj (1 - a * z')))", "by simp"], ["proof (state)\nthis:\n  Im ((z' - a) / (1 - a * z')) =\n  Im ((z' - a) * (1 - a * cnj z') / ((1 - a * z') * cnj (1 - a * z')))\n\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))", "also"], ["proof (state)\nthis:\n  Im ((z' - a) / (1 - a * z')) =\n  Im ((z' - a) * (1 - a * cnj z') / ((1 - a * z') * cnj (1 - a * z')))\n\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))", "have \"... = Im ((z' - a - a * z' * cnj z' + a\\<^sup>2 * cnj z') / (cmod (1 - a*z'))\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Im ((z' - a) * (1 - a * cnj z') / ((1 - a * z') * cnj (1 - a * z'))) =\n    Im ((z' - a - a * z' * cnj z' + a\\<^sup>2 * cnj z') /\n        cor ((cmod (1 - a * z'))\\<^sup>2))", "unfolding complex_mult_cnj_cmod"], ["proof (prove)\ngoal (1 subgoal):\n 1. Im ((z' - a) * (1 - a * cnj z') / cor ((cmod (1 - a * z'))\\<^sup>2)) =\n    Im ((z' - a - a * z' * cnj z' + a\\<^sup>2 * cnj z') /\n        cor ((cmod (1 - a * z'))\\<^sup>2))", "by (simp add: power2_eq_square field_simps)"], ["proof (state)\nthis:\n  Im ((z' - a) * (1 - a * cnj z') / ((1 - a * z') * cnj (1 - a * z'))) =\n  Im ((z' - a - a * z' * cnj z' + a\\<^sup>2 * cnj z') /\n      cor ((cmod (1 - a * z'))\\<^sup>2))\n\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))", "finally"], ["proof (chain)\npicking this:\n  Im ((z' - a) / (1 - a * z')) =\n  Im ((z' - a - a * z' * cnj z' + a\\<^sup>2 * cnj z') /\n      cor ((cmod (1 - a * z'))\\<^sup>2))", "show ?thesis"], ["proof (prove)\nusing this:\n  Im ((z' - a) / (1 - a * z')) =\n  Im ((z' - a - a * z' * cnj z' + a\\<^sup>2 * cnj z') /\n      cor ((cmod (1 - a * z'))\\<^sup>2))\n\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))", "using \\<open>is_real a\\<close>"], ["proof (prove)\nusing this:\n  Im ((z' - a) / (1 - a * z')) =\n  Im ((z' - a - a * z' * cnj z' + a\\<^sup>2 * cnj z') /\n      cor ((cmod (1 - a * z'))\\<^sup>2))\n  is_real a\n\ngoal (1 subgoal):\n 1. Im ((z' - a) / (1 - a * z')) =\n    Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  Im ((z' - a) / (1 - a * z')) =\n  Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Im ((z' - a) / (1 - a * z')) =\n  Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))\n\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "moreover"], ["proof (state)\nthis:\n  Im ((z' - a) / (1 - a * z')) =\n  Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))\n\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "have \"0 < (1 - (Re a)\\<^sup>2) * Im z' / (cmod (1 - a * z'))\\<^sup>2 \\<Longrightarrow> Im z' > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < (1 - (Re a)\\<^sup>2) * Im z' /\n        (cmod (1 - a * z'))\\<^sup>2 \\<Longrightarrow>\n    0 < Im z'", "using \\<open>is_real a\\<close> \\<open>0 < Re (1 - a\\<^sup>2)\\<close>"], ["proof (prove)\nusing this:\n  is_real a\n  0 < Re (1 - a\\<^sup>2)\n\ngoal (1 subgoal):\n 1. 0 < (1 - (Re a)\\<^sup>2) * Im z' /\n        (cmod (1 - a * z'))\\<^sup>2 \\<Longrightarrow>\n    0 < Im z'", "by (smt Re_power_real divide_le_0_iff minus_complex.simps(1) not_sum_power2_lt_zero one_complex.simps(1) zero_less_mult_pos)"], ["proof (state)\nthis:\n  0 < (1 - (Re a)\\<^sup>2) * Im z' /\n      (cmod (1 - a * z'))\\<^sup>2 \\<Longrightarrow>\n  0 < Im z'\n\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "ultimately"], ["proof (chain)\npicking this:\n  a * z' \\<noteq> 1\n  0 < Re (1 - a\\<^sup>2)\n  Im ((z' - a) / (1 - a * z')) =\n  Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))\n  0 < (1 - (Re a)\\<^sup>2) * Im z' /\n      (cmod (1 - a * z'))\\<^sup>2 \\<Longrightarrow>\n  0 < Im z'", "show ?thesis"], ["proof (prove)\nusing this:\n  a * z' \\<noteq> 1\n  0 < Re (1 - a\\<^sup>2)\n  Im ((z' - a) / (1 - a * z')) =\n  Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))\n  0 < (1 - (Re a)\\<^sup>2) * Im z' /\n      (cmod (1 - a * z'))\\<^sup>2 \\<Longrightarrow>\n  0 < Im z'\n\ngoal (1 subgoal):\n 1. sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "unfolding sgn_real_def"], ["proof (prove)\nusing this:\n  a * z' \\<noteq> 1\n  0 < Re (1 - a\\<^sup>2)\n  Im ((z' - a) / (1 - a * z')) =\n  Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))\n  0 < (1 - (Re a)\\<^sup>2) * Im z' /\n      (cmod (1 - a * z'))\\<^sup>2 \\<Longrightarrow>\n  0 < Im z'\n\ngoal (1 subgoal):\n 1. (if is_real ((z' - a) / (1 - a * z')) then 0\n     else sgn_bool (0 < Im ((z' - a) / (1 - a * z')))) =\n    (if is_real z' then 0 else sgn_bool (0 < Im z'))", "using \\<open>cmod a < 1\\<close> \\<open>a * z' \\<noteq> 1\\<close> \\<open>is_real a\\<close>"], ["proof (prove)\nusing this:\n  a * z' \\<noteq> 1\n  0 < Re (1 - a\\<^sup>2)\n  Im ((z' - a) / (1 - a * z')) =\n  Re ((1 - a\\<^sup>2) * cor (Im z') / cor ((cmod (1 - a * z'))\\<^sup>2))\n  0 < (1 - (Re a)\\<^sup>2) * Im z' /\n      (cmod (1 - a * z'))\\<^sup>2 \\<Longrightarrow>\n  0 < Im z'\n  cmod a < 1\n  a * z' \\<noteq> 1\n  is_real a\n\ngoal (1 subgoal):\n 1. (if is_real ((z' - a) / (1 - a * z')) then 0\n     else sgn_bool (0 < Im ((z' - a) / (1 - a * z')))) =\n    (if is_real z' then 0 else sgn_bool (0 < Im z'))", "by (auto simp add: cmod_eq_Re)"], ["proof (state)\nthis:\n  sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 \\<Longrightarrow>\n    sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "ultimately"], ["proof (chain)\npicking this:\n  z' \\<noteq> 1 / cnj a\n  a * cnj a \\<noteq> 1\n  sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')", "show ?thesis"], ["proof (prove)\nusing this:\n  z' \\<noteq> 1 / cnj a\n  a * cnj a \\<noteq> 1\n  sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')\n\ngoal (1 subgoal):\n 1. sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "using assms z' moebius_pt_blaschke[of a z'] \\<open>is_real a\\<close> eq_cnj_iff_real[of a]"], ["proof (prove)\nusing this:\n  z' \\<noteq> 1 / cnj a\n  a * cnj a \\<noteq> 1\n  sgn (Im ((z' - a) / (1 - a * z'))) = sgn (Im z')\n  is_real a\n  cmod a < 1\n  z \\<noteq> \\<infinity>\\<^sub>h\n  z \\<noteq> inversion (of_complex a)\n  z = of_complex z'\n  \\<lbrakk>cmod a \\<noteq> 1; z' \\<noteq> 1 / cnj a\\<rbrakk>\n  \\<Longrightarrow> moebius_pt (blaschke a) (of_complex z') =\n                    of_complex ((z' - a) / (1 - cnj a * z'))\n  is_real a\n  (cnj a = a) = is_real a\n\ngoal (1 subgoal):\n 1. sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (Im (to_complex z))", "by simp"], ["proof (state)\nthis:\n  sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n  sgn (Im (to_complex z))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma blaschke_real_preserve_sgn_arg [simp]:\n  assumes \"is_real a\" and \"cmod a < 1\" and \"z \\<notin> circline_set x_axis\"\n  shows \"sgn (arg (to_complex (moebius_pt (blaschke a) z))) = sgn (arg (to_complex z))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sgn (arg (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (arg (to_complex z))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. sgn (arg (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (arg (to_complex z))", "have \"z \\<noteq> \\<infinity>\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z \\<noteq> \\<infinity>\\<^sub>h", "using assms"], ["proof (prove)\nusing this:\n  is_real a\n  cmod a < 1\n  z \\<notin> circline_set x_axis\n\ngoal (1 subgoal):\n 1. z \\<noteq> \\<infinity>\\<^sub>h", "using special_points_on_x_axis''(3)"], ["proof (prove)\nusing this:\n  is_real a\n  cmod a < 1\n  z \\<notin> circline_set x_axis\n  \\<infinity>\\<^sub>h \\<in> circline_set x_axis\n\ngoal (1 subgoal):\n 1. z \\<noteq> \\<infinity>\\<^sub>h", "by blast"], ["proof (state)\nthis:\n  z \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. sgn (arg (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (arg (to_complex z))", "moreover"], ["proof (state)\nthis:\n  z \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. sgn (arg (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (arg (to_complex z))", "have \"z \\<noteq> inversion (of_complex a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z \\<noteq> inversion (of_complex a)", "using assms"], ["proof (prove)\nusing this:\n  is_real a\n  cmod a < 1\n  z \\<notin> circline_set x_axis\n\ngoal (1 subgoal):\n 1. z \\<noteq> inversion (of_complex a)", "by (metis calculation circline_equation_x_axis circline_set_x_axis_I conjugate_of_complex inversion_of_complex inversion_sym is_real_inversion o_apply of_complex_zero reciprocal_zero to_complex_of_complex)"], ["proof (state)\nthis:\n  z \\<noteq> inversion (of_complex a)\n\ngoal (1 subgoal):\n 1. sgn (arg (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (arg (to_complex z))", "ultimately"], ["proof (chain)\npicking this:\n  z \\<noteq> \\<infinity>\\<^sub>h\n  z \\<noteq> inversion (of_complex a)", "show ?thesis"], ["proof (prove)\nusing this:\n  z \\<noteq> \\<infinity>\\<^sub>h\n  z \\<noteq> inversion (of_complex a)\n\ngoal (1 subgoal):\n 1. sgn (arg (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (arg (to_complex z))", "using blaschke_real_preserve_sgn_Im[OF assms(1) assms(2), of z]"], ["proof (prove)\nusing this:\n  z \\<noteq> \\<infinity>\\<^sub>h\n  z \\<noteq> inversion (of_complex a)\n  \\<lbrakk>z \\<noteq> \\<infinity>\\<^sub>h;\n   z \\<noteq> inversion (of_complex a)\\<rbrakk>\n  \\<Longrightarrow> sgn (Im (to_complex (moebius_pt (blaschke a) z))) =\n                    sgn (Im (to_complex z))\n\ngoal (1 subgoal):\n 1. sgn (arg (to_complex (moebius_pt (blaschke a) z))) =\n    sgn (arg (to_complex z))", "by (smt arg_Im_sgn assms(3) circline_set_x_axis_I norm_sgn of_complex_to_complex)"], ["proof (state)\nthis:\n  sgn (arg (to_complex (moebius_pt (blaschke a) z))) =\n  sgn (arg (to_complex z))\n\ngoal:\nNo subgoals!", "qed"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsubsection \\<open>Inverse Blaschke transform\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "definition inv_blaschke_cmat :: \"complex \\<Rightarrow> complex_mat\" where\n [simp]: \"inv_blaschke_cmat a = (if cmod a \\<noteq> 1 then (1, a, cnj a, 1) else eye)\""], ["", "lift_definition inv_blaschke_mmat :: \"complex \\<Rightarrow> moebius_mat\" is inv_blaschke_cmat"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>complex. mat_det (inv_blaschke_cmat complex) \\<noteq> 0", "by simp"], ["", "lift_definition inv_blaschke :: \"complex \\<Rightarrow> moebius\" is inv_blaschke_mmat"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma inv_blaschke_neg [simp]: \"inv_blaschke a = blaschke (-a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_blaschke a = blaschke (- a)", "by (transfer, transfer) simp"], ["", "lemma inv_blaschke:\n  assumes \"cmod a \\<noteq> 1\"\n  shows \"blaschke a + inv_blaschke a = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. blaschke a + inv_blaschke a = 0", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_comp (blaschke a) (blaschke (- a)) = id_moebius", "apply (transfer, transfer)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       moebius_cmat_eq\n        (moebius_comp_cmat (blaschke_cmat a) (blaschke_cmat (- a)))\n        id_moebius_cmat", "by auto (rule_tac x=\"1/(1 - a*cnj a)\" in exI, simp)"], ["", "lemma ex_unit_disc_fix_mapping_u_to_zero:\n  assumes \"u \\<in> unit_disc\"\n  shows \"\\<exists> M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "from assms"], ["proof (chain)\npicking this:\n  u \\<in> unit_disc", "obtain c where *: \"u = of_complex c\""], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. (\\<And>c. u = of_complex c \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis inf_notin_unit_disc inf_or_of_complex)"], ["proof (state)\nthis:\n  u = of_complex c\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "hence \"cmod c < 1\""], ["proof (prove)\nusing this:\n  u = of_complex c\n\ngoal (1 subgoal):\n 1. cmod c < 1", "using assms unit_disc_iff_cmod_lt_1"], ["proof (prove)\nusing this:\n  u = of_complex c\n  u \\<in> unit_disc\n  (of_complex ?c \\<in> unit_disc) = (cmod ?c < 1)\n\ngoal (1 subgoal):\n 1. cmod c < 1", "by simp"], ["proof (state)\nthis:\n  cmod c < 1\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "thus ?thesis"], ["proof (prove)\nusing this:\n  cmod c < 1\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "using *"], ["proof (prove)\nusing this:\n  cmod c < 1\n  u = of_complex c\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "by (rule_tac x=\"blaschke c\" in exI)\n       (smt blaschke_a_to_zero blaschke_ounit_circle_fix' unit_disc_fix_iff_ounit_circle)"], ["proof (state)\nthis:\n  \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wlog_zero:\n  assumes in_disc: \"u \\<in> unit_disc\"\n  assumes preserving: \"\\<And> a u. \\<lbrakk>u \\<in> unit_disc; cmod a < 1; P (moebius_pt (blaschke a) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes zero: \"P 0\\<^sub>h\"\n  shows \"P u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P u", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P u", "have *: \"moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h", "by (smt blaschke_a_to_zero in_disc inf_notin_unit_disc of_complex_to_complex unit_disc_iff_cmod_lt_1)"], ["proof (state)\nthis:\n  moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. P u", "thus ?thesis"], ["proof (prove)\nusing this:\n  moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. P u", "using preserving[of u \"to_complex u\"] in_disc zero"], ["proof (prove)\nusing this:\n  moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\n  \\<lbrakk>u \\<in> unit_disc; cmod (to_complex u) < 1;\n   P (moebius_pt (blaschke (to_complex u)) u)\\<rbrakk>\n  \\<Longrightarrow> P u\n  u \\<in> unit_disc\n  P 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. P u", "using inf_or_of_complex[of u]"], ["proof (prove)\nusing this:\n  moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\n  \\<lbrakk>u \\<in> unit_disc; cmod (to_complex u) < 1;\n   P (moebius_pt (blaschke (to_complex u)) u)\\<rbrakk>\n  \\<Longrightarrow> P u\n  u \\<in> unit_disc\n  P 0\\<^sub>h\n  u = \\<infinity>\\<^sub>h \\<or> (\\<exists>x. u = of_complex x)\n\ngoal (1 subgoal):\n 1. P u", "by auto"], ["proof (state)\nthis:\n  P u\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wlog_real_zero:\n  assumes in_disc: \"u \\<in> unit_disc\" and real: \"is_real (to_complex u)\"\n  assumes preserving: \"\\<And> a u. \\<lbrakk>u \\<in> unit_disc; is_real a; cmod a < 1; P (moebius_pt (blaschke a) u)\\<rbrakk> \\<Longrightarrow> P u\"\n  assumes zero: \"P 0\\<^sub>h\"\n  shows \"P u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P u", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P u", "have *: \"moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h", "by (smt blaschke_a_to_zero in_disc inf_notin_unit_disc of_complex_to_complex unit_disc_iff_cmod_lt_1)"], ["proof (state)\nthis:\n  moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. P u", "thus ?thesis"], ["proof (prove)\nusing this:\n  moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. P u", "using preserving[of u \"to_complex u\"] in_disc zero real"], ["proof (prove)\nusing this:\n  moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\n  \\<lbrakk>u \\<in> unit_disc; is_real (to_complex u);\n   cmod (to_complex u) < 1;\n   P (moebius_pt (blaschke (to_complex u)) u)\\<rbrakk>\n  \\<Longrightarrow> P u\n  u \\<in> unit_disc\n  P 0\\<^sub>h\n  is_real (to_complex u)\n\ngoal (1 subgoal):\n 1. P u", "using inf_or_of_complex[of u]"], ["proof (prove)\nusing this:\n  moebius_pt (blaschke (to_complex u)) u = 0\\<^sub>h\n  \\<lbrakk>u \\<in> unit_disc; is_real (to_complex u);\n   cmod (to_complex u) < 1;\n   P (moebius_pt (blaschke (to_complex u)) u)\\<rbrakk>\n  \\<Longrightarrow> P u\n  u \\<in> unit_disc\n  P 0\\<^sub>h\n  is_real (to_complex u)\n  u = \\<infinity>\\<^sub>h \\<or> (\\<exists>x. u = of_complex x)\n\ngoal (1 subgoal):\n 1. P u", "by auto"], ["proof (state)\nthis:\n  P u\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma unit_disc_fix_transitive:\n  assumes in_disc: \"u \\<in> unit_disc\" and \"u' \\<in> unit_disc\"\n  shows \"\\<exists> M. unit_disc_fix M \\<and> moebius_pt M u = u'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'", "have \"\\<forall> u \\<in> unit_disc. \\<exists> M. unit_disc_fix M \\<and> moebius_pt M u = u'\" (is \"?P u'\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u\\<in>unit_disc.\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'", "proof (rule wlog_zero)"], ["proof (state)\ngoal (3 subgoals):\n 1. u' \\<in> unit_disc\n 2. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        \\<forall>ua\\<in>unit_disc.\n           \\<exists>M.\n              unit_disc_fix M \\<and>\n              moebius_pt M ua = moebius_pt (blaschke a) u\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ua\\<in>unit_disc.\n                            \\<exists>M.\n                               unit_disc_fix M \\<and> moebius_pt M ua = u\n 3. \\<forall>u\\<in>unit_disc.\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "show \"u' \\<in> unit_disc\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u' \\<in> unit_disc", "by fact"], ["proof (state)\nthis:\n  u' \\<in> unit_disc\n\ngoal (2 subgoals):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        \\<forall>ua\\<in>unit_disc.\n           \\<exists>M.\n              unit_disc_fix M \\<and>\n              moebius_pt M ua = moebius_pt (blaschke a) u\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ua\\<in>unit_disc.\n                            \\<exists>M.\n                               unit_disc_fix M \\<and> moebius_pt M ua = u\n 2. \\<forall>u\\<in>unit_disc.\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        \\<forall>ua\\<in>unit_disc.\n           \\<exists>M.\n              unit_disc_fix M \\<and>\n              moebius_pt M ua = moebius_pt (blaschke a) u\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ua\\<in>unit_disc.\n                            \\<exists>M.\n                               unit_disc_fix M \\<and> moebius_pt M ua = u\n 2. \\<forall>u\\<in>unit_disc.\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "show \"?P 0\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u\\<in>unit_disc.\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h", "by (simp add: ex_unit_disc_fix_mapping_u_to_zero)"], ["proof (state)\nthis:\n  \\<forall>u\\<in>unit_disc.\n     \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        \\<forall>ua\\<in>unit_disc.\n           \\<exists>M.\n              unit_disc_fix M \\<and>\n              moebius_pt M ua = moebius_pt (blaschke a) u\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ua\\<in>unit_disc.\n                            \\<exists>M.\n                               unit_disc_fix M \\<and> moebius_pt M ua = u", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        \\<forall>ua\\<in>unit_disc.\n           \\<exists>M.\n              unit_disc_fix M \\<and>\n              moebius_pt M ua = moebius_pt (blaschke a) u\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ua\\<in>unit_disc.\n                            \\<exists>M.\n                               unit_disc_fix M \\<and> moebius_pt M ua = u", "fix a u"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        \\<forall>ua\\<in>unit_disc.\n           \\<exists>M.\n              unit_disc_fix M \\<and>\n              moebius_pt M ua = moebius_pt (blaschke a) u\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ua\\<in>unit_disc.\n                            \\<exists>M.\n                               unit_disc_fix M \\<and> moebius_pt M ua = u", "assume \"cmod a < 1\" and *: \"?P (moebius_pt (blaschke a) u)\""], ["proof (state)\nthis:\n  cmod a < 1\n  \\<forall>u\\<in>unit_disc.\n     \\<exists>M.\n        unit_disc_fix M \\<and> moebius_pt M u = moebius_pt (blaschke a) u\n\ngoal (1 subgoal):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        \\<forall>ua\\<in>unit_disc.\n           \\<exists>M.\n              unit_disc_fix M \\<and>\n              moebius_pt M ua = moebius_pt (blaschke a) u\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ua\\<in>unit_disc.\n                            \\<exists>M.\n                               unit_disc_fix M \\<and> moebius_pt M ua = u", "show \"?P u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u\\<in>unit_disc.\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       u \\<in> unit_disc \\<Longrightarrow>\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u", "fix u'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       u \\<in> unit_disc \\<Longrightarrow>\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u", "assume \"u' \\<in> unit_disc\""], ["proof (state)\nthis:\n  u' \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       u \\<in> unit_disc \\<Longrightarrow>\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u", "then"], ["proof (chain)\npicking this:\n  u' \\<in> unit_disc", "obtain M' where \"unit_disc_fix M'\" \"moebius_pt M' u' = moebius_pt (blaschke a) u\""], ["proof (prove)\nusing this:\n  u' \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. (\\<And>M'.\n        \\<lbrakk>unit_disc_fix M';\n         moebius_pt M' u' = moebius_pt (blaschke a) u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using *"], ["proof (prove)\nusing this:\n  u' \\<in> unit_disc\n  \\<forall>u\\<in>unit_disc.\n     \\<exists>M.\n        unit_disc_fix M \\<and> moebius_pt M u = moebius_pt (blaschke a) u\n\ngoal (1 subgoal):\n 1. (\\<And>M'.\n        \\<lbrakk>unit_disc_fix M';\n         moebius_pt M' u' = moebius_pt (blaschke a) u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  unit_disc_fix M'\n  moebius_pt M' u' = moebius_pt (blaschke a) u\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       u \\<in> unit_disc \\<Longrightarrow>\n       \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u", "thus \"\\<exists>M. unit_disc_fix M \\<and> moebius_pt M u' = u\""], ["proof (prove)\nusing this:\n  unit_disc_fix M'\n  moebius_pt M' u' = moebius_pt (blaschke a) u\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u' = u", "using \\<open>cmod a < 1\\<close> blaschke_unit_disc_fix[of a]"], ["proof (prove)\nusing this:\n  unit_disc_fix M'\n  moebius_pt M' u' = moebius_pt (blaschke a) u\n  cmod a < 1\n  cmod a < 1 \\<Longrightarrow> unit_disc_fix (blaschke a)\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u' = u", "using unit_disc_fix_moebius_comp[of \"- blaschke a\" \"M'\"]"], ["proof (prove)\nusing this:\n  unit_disc_fix M'\n  moebius_pt M' u' = moebius_pt (blaschke a) u\n  cmod a < 1\n  cmod a < 1 \\<Longrightarrow> unit_disc_fix (blaschke a)\n  \\<lbrakk>unit_disc_fix (- blaschke a); unit_disc_fix M'\\<rbrakk>\n  \\<Longrightarrow> unit_disc_fix (moebius_comp (- blaschke a) M')\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u' = u", "using unit_disc_fix_moebius_inv[of \"blaschke a\"]"], ["proof (prove)\nusing this:\n  unit_disc_fix M'\n  moebius_pt M' u' = moebius_pt (blaschke a) u\n  cmod a < 1\n  cmod a < 1 \\<Longrightarrow> unit_disc_fix (blaschke a)\n  \\<lbrakk>unit_disc_fix (- blaschke a); unit_disc_fix M'\\<rbrakk>\n  \\<Longrightarrow> unit_disc_fix (moebius_comp (- blaschke a) M')\n  unit_disc_fix (blaschke a) \\<Longrightarrow>\n  unit_disc_fix (moebius_inv (blaschke a))\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u' = u", "by (rule_tac x=\"(- (blaschke a)) + M'\" in exI, simp)"], ["proof (state)\nthis:\n  \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u' = u\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>u\\<in>unit_disc.\n     \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>u\\<in>unit_disc.\n     \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>unit_disc.\n     \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>unit_disc.\n     \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'\n  u \\<in> unit_disc\n  u' \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'", "by auto"], ["proof (state)\nthis:\n  \\<exists>M. unit_disc_fix M \\<and> moebius_pt M u = u'\n\ngoal:\nNo subgoals!", "qed"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsection \\<open>Decomposition of unit disc preserving M?bius transforms\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "text \\<open>Each transformation preserving unit disc can be decomposed to a rotation around the origin and\na Blaschke factors that maps a point within the unit disc to zero.\\<close>"], ["", "lemma unit_disc_fix_decompose_blaschke_rotation:\n  assumes \"unit_disc_fix M\"\n  shows \"\\<exists> k \\<phi>. cmod k < 1 \\<and> M = moebius_rotation \\<phi> + blaschke k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k \\<phi>.\n       cmod k < 1 \\<and> M = moebius_rotation \\<phi> + blaschke k", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. \\<exists>k \\<phi>.\n       cmod k < 1 \\<and> M = moebius_rotation \\<phi> + blaschke k", "unfolding moebius_rotation_def moebius_similarity_def"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. \\<exists>k \\<phi>.\n       cmod k < 1 \\<and> M = mk_moebius (cis \\<phi>) 0 0 1 + blaschke k", "proof (simp, transfer, transfer)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_cmat M; unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            cmod k < 1 \\<and>\n                            (\\<exists>\\<phi>.\n                                moebius_cmat_eq M\n                                 (moebius_comp_cmat\n                                   (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                                   (blaschke_cmat k)))", "fix M"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_cmat M; unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            cmod k < 1 \\<and>\n                            (\\<exists>\\<phi>.\n                                moebius_cmat_eq M\n                                 (moebius_comp_cmat\n                                   (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                                   (blaschke_cmat k)))", "assume *: \"mat_det M \\<noteq> 0\" \"unit_disc_fix_cmat M\""], ["proof (state)\nthis:\n  mat_det M \\<noteq> 0\n  unit_disc_fix_cmat M\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_cmat M; unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            cmod k < 1 \\<and>\n                            (\\<exists>\\<phi>.\n                                moebius_cmat_eq M\n                                 (moebius_comp_cmat\n                                   (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                                   (blaschke_cmat k)))", "then"], ["proof (chain)\npicking this:\n  mat_det M \\<noteq> 0\n  unit_disc_fix_cmat M", "obtain k a b :: complex where\n    **: \"k \\<noteq> 0\" \"mat_det (a, b, cnj b, cnj a) \\<noteq> 0\" \"M = k *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\""], ["proof (prove)\nusing this:\n  mat_det M \\<noteq> 0\n  unit_disc_fix_cmat M\n\ngoal (1 subgoal):\n 1. (\\<And>k a b.\n        \\<lbrakk>k \\<noteq> 0; mat_det (a, b, cnj b, cnj a) \\<noteq> 0;\n         M = k *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using unitary11_gen_iff[of M]"], ["proof (prove)\nusing this:\n  mat_det M \\<noteq> 0\n  unit_disc_fix_cmat M\n  unitary11_gen M =\n  (\\<exists>k a b.\n      k \\<noteq> 0 \\<and>\n      mat_det (a, b, cnj b, cnj a) \\<noteq> 0 \\<and>\n      M = k *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a))\n\ngoal (1 subgoal):\n 1. (\\<And>k a b.\n        \\<lbrakk>k \\<noteq> 0; mat_det (a, b, cnj b, cnj a) \\<noteq> 0;\n         M = k *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  mat_det (a, b, cnj b, cnj a) \\<noteq> 0\n  M = k *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_cmat M; unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            cmod k < 1 \\<and>\n                            (\\<exists>\\<phi>.\n                                moebius_cmat_eq M\n                                 (moebius_comp_cmat\n                                   (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                                   (blaschke_cmat k)))", "have \"a \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> 0", "using * **"], ["proof (prove)\nusing this:\n  mat_det M \\<noteq> 0\n  unit_disc_fix_cmat M\n  k \\<noteq> 0\n  mat_det (a, b, cnj b, cnj a) \\<noteq> 0\n  M = k *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_cmat M; unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            cmod k < 1 \\<and>\n                            (\\<exists>\\<phi>.\n                                moebius_cmat_eq M\n                                 (moebius_comp_cmat\n                                   (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                                   (blaschke_cmat k)))", "then"], ["proof (chain)\npicking this:\n  a \\<noteq> 0", "obtain a' k' \\<phi>\n    where ***: \"k' \\<noteq> 0 \\<and> a' * cnj a' \\<noteq> 1 \\<and> M = k' *\\<^sub>s\\<^sub>m (cis \\<phi>, 0, 0, 1) *\\<^sub>m\\<^sub>m (1, - a', - cnj a', 1)\""], ["proof (prove)\nusing this:\n  a \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<And>k' a' \\<phi>.\n        k' \\<noteq> 0 \\<and>\n        a' * cnj a' \\<noteq> 1 \\<and>\n        M =\n        k' *\\<^sub>s\\<^sub>m (cis \\<phi>, 0, 0, 1) *\\<^sub>m\\<^sub>m\n        (1, - a', - cnj a', 1) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using ** unitary11_gen_cis_blaschke[of k M a b]"], ["proof (prove)\nusing this:\n  a \\<noteq> 0\n  k \\<noteq> 0\n  mat_det (a, b, cnj b, cnj a) \\<noteq> 0\n  M = k *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a)\n  \\<lbrakk>k \\<noteq> 0; M = k *\\<^sub>s\\<^sub>m (a, b, cnj b, cnj a);\n   a \\<noteq> 0; mat_det (a, b, cnj b, cnj a) \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> \\<exists>k' \\<phi> a'.\n                       k' \\<noteq> 0 \\<and>\n                       a' * cnj a' \\<noteq> 1 \\<and>\n                       M =\n                       k' *\\<^sub>s\\<^sub>m\n                       (cis \\<phi>, 0, 0, 1) *\\<^sub>m\\<^sub>m\n                       (1, - a', - cnj a', 1)\n\ngoal (1 subgoal):\n 1. (\\<And>k' a' \\<phi>.\n        k' \\<noteq> 0 \\<and>\n        a' * cnj a' \\<noteq> 1 \\<and>\n        M =\n        k' *\\<^sub>s\\<^sub>m (cis \\<phi>, 0, 0, 1) *\\<^sub>m\\<^sub>m\n        (1, - a', - cnj a', 1) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto blast"], ["proof (state)\nthis:\n  k' \\<noteq> 0 \\<and>\n  a' * cnj a' \\<noteq> 1 \\<and>\n  M =\n  k' *\\<^sub>s\\<^sub>m (cis \\<phi>, 0, 0, 1) *\\<^sub>m\\<^sub>m\n  (1, - a', - cnj a', 1)\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_cmat M; unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            cmod k < 1 \\<and>\n                            (\\<exists>\\<phi>.\n                                moebius_cmat_eq M\n                                 (moebius_comp_cmat\n                                   (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                                   (blaschke_cmat k)))", "have \"a' = 0 \\<or> 1 < 1 / (cmod a')\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a' = 0 \\<or> 1 < 1 / (cmod a')\\<^sup>2", "using * *** complex_mult_cnj_cmod[of a']"], ["proof (prove)\nusing this:\n  mat_det M \\<noteq> 0\n  unit_disc_fix_cmat M\n  k' \\<noteq> 0 \\<and>\n  a' * cnj a' \\<noteq> 1 \\<and>\n  M =\n  k' *\\<^sub>s\\<^sub>m (cis \\<phi>, 0, 0, 1) *\\<^sub>m\\<^sub>m\n  (1, - a', - cnj a', 1)\n  a' * cnj a' = cor ((cmod a')\\<^sup>2)\n\ngoal (1 subgoal):\n 1. a' = 0 \\<or> 1 < 1 / (cmod a')\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  a' = 0 \\<or> 1 < 1 / (cmod a')\\<^sup>2\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_cmat M; unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            cmod k < 1 \\<and>\n                            (\\<exists>\\<phi>.\n                                moebius_cmat_eq M\n                                 (moebius_comp_cmat\n                                   (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                                   (blaschke_cmat k)))", "hence \"cmod a' < 1\""], ["proof (prove)\nusing this:\n  a' = 0 \\<or> 1 < 1 / (cmod a')\\<^sup>2\n\ngoal (1 subgoal):\n 1. cmod a' < 1", "by (smt less_divide_eq_1_pos norm_zero one_less_power one_power2 pos2)"], ["proof (state)\nthis:\n  cmod a' < 1\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>mat_det M \\<noteq> 0; unit_disc_fix_cmat M;\n        unit_disc_fix_cmat M; unit_disc_fix_mmat Ma\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k.\n                            cmod k < 1 \\<and>\n                            (\\<exists>\\<phi>.\n                                moebius_cmat_eq M\n                                 (moebius_comp_cmat\n                                   (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                                   (blaschke_cmat k)))", "thus \"\\<exists>k. cmod k < 1 \\<and>\n            (\\<exists>\\<phi>. moebius_cmat_eq M (moebius_comp_cmat (mk_moebius_cmat (cis \\<phi>) 0 0 1) (blaschke_cmat k)))\""], ["proof (prove)\nusing this:\n  cmod a' < 1\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       cmod k < 1 \\<and>\n       (\\<exists>\\<phi>.\n           moebius_cmat_eq M\n            (moebius_comp_cmat (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n              (blaschke_cmat k)))", "using ***"], ["proof (prove)\nusing this:\n  cmod a' < 1\n  k' \\<noteq> 0 \\<and>\n  a' * cnj a' \\<noteq> 1 \\<and>\n  M =\n  k' *\\<^sub>s\\<^sub>m (cis \\<phi>, 0, 0, 1) *\\<^sub>m\\<^sub>m\n  (1, - a', - cnj a', 1)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       cmod k < 1 \\<and>\n       (\\<exists>\\<phi>.\n           moebius_cmat_eq M\n            (moebius_comp_cmat (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n              (blaschke_cmat k)))", "apply (rule_tac x=a' in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>cmod a' < 1;\n     k' \\<noteq> 0 \\<and>\n     a' * cnj a' \\<noteq> 1 \\<and>\n     M =\n     k' *\\<^sub>s\\<^sub>m (cis \\<phi>, 0, 0, 1) *\\<^sub>m\\<^sub>m\n     (1, - a', - cnj a', 1)\\<rbrakk>\n    \\<Longrightarrow> cmod a' < 1 \\<and>\n                      (\\<exists>\\<phi>.\n                          moebius_cmat_eq M\n                           (moebius_comp_cmat\n                             (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n                             (blaschke_cmat a')))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>cmod a' < 1;\n     k' \\<noteq> 0 \\<and>\n     a' * cnj a' \\<noteq> 1 \\<and>\n     M =\n     (k' * cis \\<phi>, - (k' * cis \\<phi> * a'), - (k' * cnj a'),\n      k')\\<rbrakk>\n    \\<Longrightarrow> \\<exists>\\<phi>' k.\n                         k \\<noteq> 0 \\<and>\n                         cis \\<phi>' = k * (k' * cis \\<phi>) \\<and>\n                         (a' = 0 \\<or>\n                          cis \\<phi>' = k * (k' * cis \\<phi>)) \\<and>\n                         (a' = 0 \\<or> k * k' = 1) \\<and> k * k' = 1", "apply (rule_tac x=\\<phi> in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>cmod a' < 1;\n     k' \\<noteq> 0 \\<and>\n     a' * cnj a' \\<noteq> 1 \\<and>\n     M =\n     (k' * cis \\<phi>, - (k' * cis \\<phi> * a'), - (k' * cnj a'),\n      k')\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k.\n                         k \\<noteq> 0 \\<and>\n                         cis \\<phi> = k * (k' * cis \\<phi>) \\<and>\n                         (a' = 0 \\<or>\n                          cis \\<phi> = k * (k' * cis \\<phi>)) \\<and>\n                         (a' = 0 \\<or> k * k' = 1) \\<and> k * k' = 1", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>cmod a' < 1;\n     k' \\<noteq> 0 \\<and>\n     a' * cnj a' \\<noteq> 1 \\<and>\n     M =\n     (k' * cis \\<phi>, - (k' * cis \\<phi> * a'), - (k' * cnj a'),\n      k')\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k.\n                         k \\<noteq> 0 \\<and>\n                         k * k' = 1 \\<and>\n                         (a' = 0 \\<or> k * k' = 1) \\<and> k * k' = 1", "apply (rule_tac x=\"1/k'\" in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>cmod a' < 1;\n     k' \\<noteq> 0 \\<and>\n     a' * cnj a' \\<noteq> 1 \\<and>\n     M =\n     (k' * cis \\<phi>, - (k' * cis \\<phi> * a'), - (k' * cnj a'),\n      k')\\<rbrakk>\n    \\<Longrightarrow> 1 / k' \\<noteq> 0 \\<and>\n                      1 / k' * k' = 1 \\<and>\n                      (a' = 0 \\<or> 1 / k' * k' = 1) \\<and> 1 / k' * k' = 1", "by auto"], ["proof (state)\nthis:\n  \\<exists>k.\n     cmod k < 1 \\<and>\n     (\\<exists>\\<phi>.\n         moebius_cmat_eq M\n          (moebius_comp_cmat (mk_moebius_cmat (cis \\<phi>) 0 0 1)\n            (blaschke_cmat k)))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wlog_unit_disc_fix:\n  assumes \"unit_disc_fix M\"\n  assumes b: \"\\<And> k. cmod k < 1 \\<Longrightarrow> P (blaschke k)\"\n  assumes r: \"\\<And> \\<phi>. P (moebius_rotation \\<phi>)\"\n  assumes comp: \"\\<And>M1 M2. \\<lbrakk>unit_disc_fix M1; P M1; unit_disc_fix M2; P M2\\<rbrakk> \\<Longrightarrow> P (M1 + M2)\"\n  shows \"P M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P M", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  cmod ?k < 1 \\<Longrightarrow> P (blaschke ?k)\n  P (moebius_rotation ?\\<phi>)\n  \\<lbrakk>unit_disc_fix ?M1.0; P ?M1.0; unit_disc_fix ?M2.0;\n   P ?M2.0\\<rbrakk>\n  \\<Longrightarrow> P (?M1.0 + ?M2.0)\n\ngoal (1 subgoal):\n 1. P M", "using unit_disc_fix_decompose_blaschke_rotation[OF assms(1)]"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  cmod ?k < 1 \\<Longrightarrow> P (blaschke ?k)\n  P (moebius_rotation ?\\<phi>)\n  \\<lbrakk>unit_disc_fix ?M1.0; P ?M1.0; unit_disc_fix ?M2.0;\n   P ?M2.0\\<rbrakk>\n  \\<Longrightarrow> P (?M1.0 + ?M2.0)\n  \\<exists>k \\<phi>.\n     cmod k < 1 \\<and> M = moebius_rotation \\<phi> + blaschke k\n\ngoal (1 subgoal):\n 1. P M", "using blaschke_unit_disc_fix"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  cmod ?k < 1 \\<Longrightarrow> P (blaschke ?k)\n  P (moebius_rotation ?\\<phi>)\n  \\<lbrakk>unit_disc_fix ?M1.0; P ?M1.0; unit_disc_fix ?M2.0;\n   P ?M2.0\\<rbrakk>\n  \\<Longrightarrow> P (?M1.0 + ?M2.0)\n  \\<exists>k \\<phi>.\n     cmod k < 1 \\<and> M = moebius_rotation \\<phi> + blaschke k\n  cmod ?a < 1 \\<Longrightarrow> unit_disc_fix (blaschke ?a)\n\ngoal (1 subgoal):\n 1. P M", "by auto"], ["", "lemma ex_unit_disc_fix_to_zero_positive_x_axis:\n  assumes \"u \\<in> unit_disc\" and \"v \\<in> unit_disc\" and \"u \\<noteq> v\"\n  shows \"\\<exists> M. unit_disc_fix M \\<and>\n              moebius_pt M u = 0\\<^sub>h \\<and> moebius_pt M v \\<in> positive_x_axis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "from assms"], ["proof (chain)\npicking this:\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n  u \\<noteq> v", "obtain B where\n    *: \"unit_disc_fix B\" \"moebius_pt B u = 0\\<^sub>h\""], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n  u \\<noteq> v\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>unit_disc_fix B; moebius_pt B u = 0\\<^sub>h\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using ex_unit_disc_fix_mapping_u_to_zero"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n  u \\<noteq> v\n  ?u \\<in> unit_disc \\<Longrightarrow>\n  \\<exists>M. unit_disc_fix M \\<and> moebius_pt M ?u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>unit_disc_fix B; moebius_pt B u = 0\\<^sub>h\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  unit_disc_fix B\n  moebius_pt B u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "let ?v = \"moebius_pt B v\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "have \"?v \\<in> unit_disc\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt B v \\<in> unit_disc", "using \\<open>v \\<in> unit_disc\\<close> *"], ["proof (prove)\nusing this:\n  v \\<in> unit_disc\n  unit_disc_fix B\n  moebius_pt B u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. moebius_pt B v \\<in> unit_disc", "by auto"], ["proof (state)\nthis:\n  moebius_pt B v \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "hence \"?v \\<noteq> \\<infinity>\\<^sub>h\""], ["proof (prove)\nusing this:\n  moebius_pt B v \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. moebius_pt B v \\<noteq> \\<infinity>\\<^sub>h", "using inf_notin_unit_disc"], ["proof (prove)\nusing this:\n  moebius_pt B v \\<in> unit_disc\n  \\<infinity>\\<^sub>h \\<notin> unit_disc\n\ngoal (1 subgoal):\n 1. moebius_pt B v \\<noteq> \\<infinity>\\<^sub>h", "by auto"], ["proof (state)\nthis:\n  moebius_pt B v \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "have \"?v \\<noteq> 0\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. moebius_pt B v \\<noteq> 0\\<^sub>h", "using \\<open>u \\<noteq> v\\<close> *"], ["proof (prove)\nusing this:\n  u \\<noteq> v\n  unit_disc_fix B\n  moebius_pt B u = 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. moebius_pt B v \\<noteq> 0\\<^sub>h", "by (metis moebius_pt_invert)"], ["proof (state)\nthis:\n  moebius_pt B v \\<noteq> 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "obtain R where\n    \"unit_disc_fix R\"\n    \"moebius_pt R 0\\<^sub>h = 0\\<^sub>h\" \"moebius_pt R ?v \\<in> positive_x_axis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>R.\n        \\<lbrakk>unit_disc_fix R; moebius_pt R 0\\<^sub>h = 0\\<^sub>h;\n         moebius_pt R (moebius_pt B v) \\<in> positive_x_axis\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using ex_rotation_mapping_u_to_positive_x_axis[of ?v] \\<open>?v \\<noteq> 0\\<^sub>h\\<close> \\<open>?v \\<noteq> \\<infinity>\\<^sub>h\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>moebius_pt B v \\<noteq> 0\\<^sub>h;\n   moebius_pt B v \\<noteq> \\<infinity>\\<^sub>h\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<phi>.\n                       moebius_pt (moebius_rotation \\<phi>) (moebius_pt B v)\n                       \\<in> positive_x_axis\n  moebius_pt B v \\<noteq> 0\\<^sub>h\n  moebius_pt B v \\<noteq> \\<infinity>\\<^sub>h\n\ngoal (1 subgoal):\n 1. (\\<And>R.\n        \\<lbrakk>unit_disc_fix R; moebius_pt R 0\\<^sub>h = 0\\<^sub>h;\n         moebius_pt R (moebius_pt B v) \\<in> positive_x_axis\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using moebius_pt_rotation_inf_iff moebius_pt_moebius_rotation_zero unit_disc_fix_rotation"], ["proof (prove)\nusing this:\n  \\<lbrakk>moebius_pt B v \\<noteq> 0\\<^sub>h;\n   moebius_pt B v \\<noteq> \\<infinity>\\<^sub>h\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<phi>.\n                       moebius_pt (moebius_rotation \\<phi>) (moebius_pt B v)\n                       \\<in> positive_x_axis\n  moebius_pt B v \\<noteq> 0\\<^sub>h\n  moebius_pt B v \\<noteq> \\<infinity>\\<^sub>h\n  (moebius_pt (moebius_rotation ?v) ?x = \\<infinity>\\<^sub>h) =\n  (?x = \\<infinity>\\<^sub>h)\n  moebius_pt (moebius_rotation ?\\<phi>) 0\\<^sub>h = 0\\<^sub>h\n  unit_disc_fix (moebius_rotation ?\\<phi>)\n\ngoal (1 subgoal):\n 1. (\\<And>R.\n        \\<lbrakk>unit_disc_fix R; moebius_pt R 0\\<^sub>h = 0\\<^sub>h;\n         moebius_pt R (moebius_pt B v) \\<in> positive_x_axis\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  unit_disc_fix R\n  moebius_pt R 0\\<^sub>h = 0\\<^sub>h\n  moebius_pt R (moebius_pt B v) \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "thus ?thesis"], ["proof (prove)\nusing this:\n  unit_disc_fix R\n  moebius_pt R 0\\<^sub>h = 0\\<^sub>h\n  moebius_pt R (moebius_pt B v) \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "using * moebius_comp[of R B, symmetric]"], ["proof (prove)\nusing this:\n  unit_disc_fix R\n  moebius_pt R 0\\<^sub>h = 0\\<^sub>h\n  moebius_pt R (moebius_pt B v) \\<in> positive_x_axis\n  unit_disc_fix B\n  moebius_pt B u = 0\\<^sub>h\n  moebius_pt R \\<circ> moebius_pt B = moebius_pt (moebius_comp R B)\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "using unit_disc_fix_moebius_comp"], ["proof (prove)\nusing this:\n  unit_disc_fix R\n  moebius_pt R 0\\<^sub>h = 0\\<^sub>h\n  moebius_pt R (moebius_pt B v) \\<in> positive_x_axis\n  unit_disc_fix B\n  moebius_pt B u = 0\\<^sub>h\n  moebius_pt R \\<circ> moebius_pt B = moebius_pt (moebius_comp R B)\n  \\<lbrakk>unit_disc_fix ?M1.0; unit_disc_fix ?M2.0\\<rbrakk>\n  \\<Longrightarrow> unit_disc_fix (moebius_comp ?M1.0 ?M2.0)\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       moebius_pt M u = 0\\<^sub>h \\<and>\n       moebius_pt M v \\<in> positive_x_axis", "by (rule_tac x=\"R + B\" in exI) (simp add: comp_def)"], ["proof (state)\nthis:\n  \\<exists>M.\n     unit_disc_fix M \\<and>\n     moebius_pt M u = 0\\<^sub>h \\<and> moebius_pt M v \\<in> positive_x_axis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wlog_x_axis:\n  assumes in_disc: \"u \\<in> unit_disc\" \"v \\<in> unit_disc\"\n  assumes preserved: \"\\<And> M u v. \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc; P (moebius_pt M u) (moebius_pt M v)\\<rbrakk> \\<Longrightarrow> P u v\"\n  assumes axis: \"\\<And> x. \\<lbrakk>is_real x; 0 \\<le> Re x;  Re x < 1\\<rbrakk> \\<Longrightarrow> P 0\\<^sub>h (of_complex x)\"\n  shows \"P u v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P u v", "proof (cases \"u = v\")"], ["proof (state)\ngoal (2 subgoals):\n 1. u = v \\<Longrightarrow> P u v\n 2. u \\<noteq> v \\<Longrightarrow> P u v", "case True"], ["proof (state)\nthis:\n  u = v\n\ngoal (2 subgoals):\n 1. u = v \\<Longrightarrow> P u v\n 2. u \\<noteq> v \\<Longrightarrow> P u v", "have \"P u u\" (is \"?Q u\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. P u u", "proof (rule wlog_zero[where P=\"?Q\"])"], ["proof (state)\ngoal (3 subgoals):\n 1. u \\<in> unit_disc\n 2. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n       \\<Longrightarrow> P u u\n 3. P 0\\<^sub>h 0\\<^sub>h", "show \"u \\<in> unit_disc\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> unit_disc", "by fact"], ["proof (state)\nthis:\n  u \\<in> unit_disc\n\ngoal (2 subgoals):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n       \\<Longrightarrow> P u u\n 2. P 0\\<^sub>h 0\\<^sub>h", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n       \\<Longrightarrow> P u u\n 2. P 0\\<^sub>h 0\\<^sub>h", "show \"?Q 0\\<^sub>h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P 0\\<^sub>h 0\\<^sub>h", "using axis[of 0]"], ["proof (prove)\nusing this:\n  \\<lbrakk>is_real 0; 0 \\<le> Re 0; Re 0 < 1\\<rbrakk>\n  \\<Longrightarrow> P 0\\<^sub>h (of_complex 0)\n\ngoal (1 subgoal):\n 1. P 0\\<^sub>h 0\\<^sub>h", "by simp"], ["proof (state)\nthis:\n  P 0\\<^sub>h 0\\<^sub>h\n\ngoal (1 subgoal):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n       \\<Longrightarrow> P u u", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n       \\<Longrightarrow> P u u", "fix a u"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n       \\<Longrightarrow> P u u", "assume \"u \\<in> unit_disc\" \"cmod a < 1\" \"?Q (moebius_pt (blaschke a) u)\""], ["proof (state)\nthis:\n  u \\<in> unit_disc\n  cmod a < 1\n  P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\n\ngoal (1 subgoal):\n 1. \\<And>a u.\n       \\<lbrakk>u \\<in> unit_disc; cmod a < 1;\n        P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n       \\<Longrightarrow> P u u", "thus \"?Q u\""], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  cmod a < 1\n  P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\n\ngoal (1 subgoal):\n 1. P u u", "using preserved[of \"blaschke a\" u u]"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  cmod a < 1\n  P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\n  \\<lbrakk>unit_disc_fix (blaschke a); u \\<in> unit_disc; u \\<in> unit_disc;\n   P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n  \\<Longrightarrow> P u u\n\ngoal (1 subgoal):\n 1. P u u", "using blaschke_unit_disc_fix[of a]"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  cmod a < 1\n  P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\n  \\<lbrakk>unit_disc_fix (blaschke a); u \\<in> unit_disc; u \\<in> unit_disc;\n   P (moebius_pt (blaschke a) u) (moebius_pt (blaschke a) u)\\<rbrakk>\n  \\<Longrightarrow> P u u\n  cmod a < 1 \\<Longrightarrow> unit_disc_fix (blaschke a)\n\ngoal (1 subgoal):\n 1. P u u", "by simp"], ["proof (state)\nthis:\n  P u u\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  P u u\n\ngoal (2 subgoals):\n 1. u = v \\<Longrightarrow> P u v\n 2. u \\<noteq> v \\<Longrightarrow> P u v", "thus ?thesis"], ["proof (prove)\nusing this:\n  P u u\n\ngoal (1 subgoal):\n 1. P u v", "using True"], ["proof (prove)\nusing this:\n  P u u\n  u = v\n\ngoal (1 subgoal):\n 1. P u v", "by simp"], ["proof (state)\nthis:\n  P u v\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "case False"], ["proof (state)\nthis:\n  u \\<noteq> v\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "from in_disc"], ["proof (chain)\npicking this:\n  u \\<in> unit_disc\n  v \\<in> unit_disc", "obtain M where\n    *: \"unit_disc_fix M\" \"moebius_pt M u = 0\\<^sub>h\" \"moebius_pt M v \\<in> positive_x_axis\""], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. (\\<And>M.\n        \\<lbrakk>unit_disc_fix M; moebius_pt M u = 0\\<^sub>h;\n         moebius_pt M v \\<in> positive_x_axis\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using ex_unit_disc_fix_to_zero_positive_x_axis False"], ["proof (prove)\nusing this:\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n  \\<lbrakk>?u \\<in> unit_disc; ?v \\<in> unit_disc; ?u \\<noteq> ?v\\<rbrakk>\n  \\<Longrightarrow> \\<exists>M.\n                       unit_disc_fix M \\<and>\n                       moebius_pt M ?u = 0\\<^sub>h \\<and>\n                       moebius_pt M ?v \\<in> positive_x_axis\n  u \\<noteq> v\n\ngoal (1 subgoal):\n 1. (\\<And>M.\n        \\<lbrakk>unit_disc_fix M; moebius_pt M u = 0\\<^sub>h;\n         moebius_pt M v \\<in> positive_x_axis\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  unit_disc_fix M\n  moebius_pt M u = 0\\<^sub>h\n  moebius_pt M v \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "then"], ["proof (chain)\npicking this:\n  unit_disc_fix M\n  moebius_pt M u = 0\\<^sub>h\n  moebius_pt M v \\<in> positive_x_axis", "obtain x where **: \"moebius_pt M v = of_complex x\" \"is_real x\""], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  moebius_pt M u = 0\\<^sub>h\n  moebius_pt M v \\<in> positive_x_axis\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>moebius_pt M v = of_complex x; is_real x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding positive_x_axis_def circline_set_x_axis"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  moebius_pt M u = 0\\<^sub>h\n  moebius_pt M v\n  \\<in> {z \\<in> of_complex ` {x. is_real x} \\<union> {\\<infinity>\\<^sub>h}.\n         z \\<noteq> \\<infinity>\\<^sub>h \\<and> 0 < Re (to_complex z)}\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>moebius_pt M v = of_complex x; is_real x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  moebius_pt M v = of_complex x\n  is_real x\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "moreover"], ["proof (state)\nthis:\n  moebius_pt M v = of_complex x\n  is_real x\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "have \"of_complex x \\<in> unit_disc\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_complex x \\<in> unit_disc", "using \\<open>unit_disc_fix M\\<close> \\<open>v \\<in> unit_disc\\<close> **"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  v \\<in> unit_disc\n  moebius_pt M v = of_complex x\n  is_real x\n\ngoal (1 subgoal):\n 1. of_complex x \\<in> unit_disc", "using unit_disc_fix_discI"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  v \\<in> unit_disc\n  moebius_pt M v = of_complex x\n  is_real x\n  \\<lbrakk>unit_disc_fix ?M; ?u \\<in> unit_disc\\<rbrakk>\n  \\<Longrightarrow> moebius_pt ?M ?u \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. of_complex x \\<in> unit_disc", "by fastforce"], ["proof (state)\nthis:\n  of_complex x \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "hence \"0 < Re x\" \"Re x < 1\""], ["proof (prove)\nusing this:\n  of_complex x \\<in> unit_disc\n\ngoal (1 subgoal):\n 1. 0 < Re x &&& Re x < 1", "using \\<open>moebius_pt M v \\<in> positive_x_axis\\<close> **"], ["proof (prove)\nusing this:\n  of_complex x \\<in> unit_disc\n  moebius_pt M v \\<in> positive_x_axis\n  moebius_pt M v = of_complex x\n  is_real x\n\ngoal (1 subgoal):\n 1. 0 < Re x &&& Re x < 1", "by (auto simp add: positive_x_axis_def cmod_eq_Re)"], ["proof (state)\nthis:\n  0 < Re x\n  Re x < 1\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "ultimately"], ["proof (chain)\npicking this:\n  moebius_pt M v = of_complex x\n  is_real x\n  0 < Re x\n  Re x < 1", "have \"P 0\\<^sub>h (of_complex x)\""], ["proof (prove)\nusing this:\n  moebius_pt M v = of_complex x\n  is_real x\n  0 < Re x\n  Re x < 1\n\ngoal (1 subgoal):\n 1. P 0\\<^sub>h (of_complex x)", "using \\<open>is_real x\\<close> axis"], ["proof (prove)\nusing this:\n  moebius_pt M v = of_complex x\n  is_real x\n  0 < Re x\n  Re x < 1\n  is_real x\n  \\<lbrakk>is_real ?x; 0 \\<le> Re ?x; Re ?x < 1\\<rbrakk>\n  \\<Longrightarrow> P 0\\<^sub>h (of_complex ?x)\n\ngoal (1 subgoal):\n 1. P 0\\<^sub>h (of_complex x)", "by auto"], ["proof (state)\nthis:\n  P 0\\<^sub>h (of_complex x)\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<Longrightarrow> P u v", "thus ?thesis"], ["proof (prove)\nusing this:\n  P 0\\<^sub>h (of_complex x)\n\ngoal (1 subgoal):\n 1. P u v", "using preserved[OF *(1) assms(1-2)] *(2) **(1)"], ["proof (prove)\nusing this:\n  P 0\\<^sub>h (of_complex x)\n  P (moebius_pt M u) (moebius_pt M v) \\<Longrightarrow> P u v\n  moebius_pt M u = 0\\<^sub>h\n  moebius_pt M v = of_complex x\n\ngoal (1 subgoal):\n 1. P u v", "by simp"], ["proof (state)\nthis:\n  P u v\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wlog_positive_x_axis:\n  assumes in_disc: \"u \\<in> unit_disc\" \"v \\<in> unit_disc\" \"u \\<noteq> v\"\n  assumes preserved: \"\\<And> M u v. \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc; u \\<noteq> v; P (moebius_pt M u) (moebius_pt M v)\\<rbrakk> \\<Longrightarrow> P u v\"\n  assumes axis: \"\\<And> x. \\<lbrakk>is_real x; 0 < Re x;  Re x < 1\\<rbrakk> \\<Longrightarrow> P 0\\<^sub>h (of_complex x)\"\n  shows \"P u v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P u v", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. P u v", "have \"u \\<noteq> v \\<longrightarrow> P u v\" (is \"?Q u v\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<longrightarrow> P u v", "proof (rule wlog_x_axis)"], ["proof (state)\ngoal (4 subgoals):\n 1. u \\<in> unit_disc\n 2. v \\<in> unit_disc\n 3. \\<And>M u v.\n       \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc;\n        moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n        P (moebius_pt M u) (moebius_pt M v)\\<rbrakk>\n       \\<Longrightarrow> u \\<noteq> v \\<longrightarrow> P u v\n 4. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "show \"u \\<in> unit_disc\" \"v \\<in> unit_disc\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> unit_disc &&& v \\<in> unit_disc", "by fact+"], ["proof (state)\nthis:\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n\ngoal (2 subgoals):\n 1. \\<And>M u v.\n       \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc;\n        moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n        P (moebius_pt M u) (moebius_pt M v)\\<rbrakk>\n       \\<Longrightarrow> u \\<noteq> v \\<longrightarrow> P u v\n 2. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>M u v.\n       \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc;\n        moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n        P (moebius_pt M u) (moebius_pt M v)\\<rbrakk>\n       \\<Longrightarrow> u \\<noteq> v \\<longrightarrow> P u v\n 2. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "fix M u v"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>M u v.\n       \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc;\n        moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n        P (moebius_pt M u) (moebius_pt M v)\\<rbrakk>\n       \\<Longrightarrow> u \\<noteq> v \\<longrightarrow> P u v\n 2. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "assume \"unit_disc_fix M\" \"u \\<in> unit_disc\" \"v \\<in> unit_disc\"\n           \"?Q (moebius_pt M u) (moebius_pt M v)\""], ["proof (state)\nthis:\n  unit_disc_fix M\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n  moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n  P (moebius_pt M u) (moebius_pt M v)\n\ngoal (2 subgoals):\n 1. \\<And>M u v.\n       \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc;\n        moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n        P (moebius_pt M u) (moebius_pt M v)\\<rbrakk>\n       \\<Longrightarrow> u \\<noteq> v \\<longrightarrow> P u v\n 2. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "thus \"?Q u v\""], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n  moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n  P (moebius_pt M u) (moebius_pt M v)\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<longrightarrow> P u v", "using preserved[of M u v]"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n  moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n  P (moebius_pt M u) (moebius_pt M v)\n  \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc;\n   u \\<noteq> v; P (moebius_pt M u) (moebius_pt M v)\\<rbrakk>\n  \\<Longrightarrow> P u v\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<longrightarrow> P u v", "using moebius_pt_invert"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  u \\<in> unit_disc\n  v \\<in> unit_disc\n  moebius_pt M u \\<noteq> moebius_pt M v \\<longrightarrow>\n  P (moebius_pt M u) (moebius_pt M v)\n  \\<lbrakk>unit_disc_fix M; u \\<in> unit_disc; v \\<in> unit_disc;\n   u \\<noteq> v; P (moebius_pt M u) (moebius_pt M v)\\<rbrakk>\n  \\<Longrightarrow> P u v\n  moebius_pt ?M ?z1.0 = ?z2.0 \\<Longrightarrow>\n  moebius_pt (moebius_inv ?M) ?z2.0 = ?z1.0\n\ngoal (1 subgoal):\n 1. u \\<noteq> v \\<longrightarrow> P u v", "by blast"], ["proof (state)\nthis:\n  u \\<noteq> v \\<longrightarrow> P u v\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "assume \"is_real x\" \"0 \\<le> Re x\" \"Re x < 1\""], ["proof (state)\nthis:\n  is_real x\n  0 \\<le> Re x\n  Re x < 1\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>is_real x; 0 \\<le> Re x; Re x < 1\\<rbrakk>\n       \\<Longrightarrow> 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n                         P 0\\<^sub>h (of_complex x)", "thus \"?Q 0\\<^sub>h (of_complex x)\""], ["proof (prove)\nusing this:\n  is_real x\n  0 \\<le> Re x\n  Re x < 1\n\ngoal (1 subgoal):\n 1. 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n    P 0\\<^sub>h (of_complex x)", "using axis[of x] of_complex_zero_iff[of x] complex.expand[of x 0]"], ["proof (prove)\nusing this:\n  is_real x\n  0 \\<le> Re x\n  Re x < 1\n  \\<lbrakk>is_real x; 0 < Re x; Re x < 1\\<rbrakk>\n  \\<Longrightarrow> P 0\\<^sub>h (of_complex x)\n  (of_complex x = 0\\<^sub>h) = (x = 0)\n  Re x = Re 0 \\<and> Im x = Im 0 \\<Longrightarrow> x = 0\n\ngoal (1 subgoal):\n 1. 0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n    P 0\\<^sub>h (of_complex x)", "by fastforce"], ["proof (state)\nthis:\n  0\\<^sub>h \\<noteq> of_complex x \\<longrightarrow>\n  P 0\\<^sub>h (of_complex x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u \\<noteq> v \\<longrightarrow> P u v\n\ngoal (1 subgoal):\n 1. P u v", "thus ?thesis"], ["proof (prove)\nusing this:\n  u \\<noteq> v \\<longrightarrow> P u v\n\ngoal (1 subgoal):\n 1. P u v", "using \\<open>u \\<noteq> v\\<close>"], ["proof (prove)\nusing this:\n  u \\<noteq> v \\<longrightarrow> P u v\n  u \\<noteq> v\n\ngoal (1 subgoal):\n 1. P u v", "by simp"], ["proof (state)\nthis:\n  P u v\n\ngoal:\nNo subgoals!", "qed"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsection \\<open>All functions that fix the unit disc\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "text \\<open>It can be proved that continuous functions that fix the unit disc are either actions of\nM?bius transformations that fix the unit disc (homographies), or are compositions of actions of\nM?bius transformations that fix the unit disc and the conjugation (antihomographies). We postulate\nthis as a definition, but it this characterisation could also be formally shown (we do not need this\nfor our further applications).\\<close>"], ["", "definition unit_disc_fix_f where\n  \"unit_disc_fix_f f \\<longleftrightarrow> \n   (\\<exists> M. unit_disc_fix M \\<and> (f = moebius_pt M \\<or> f = moebius_pt M \\<circ> conjugate))\""], ["", "text \\<open>Unit disc fixing functions really fix unit disc.\\<close>"], ["", "lemma unit_disc_fix_f_unit_disc:\n  assumes \"unit_disc_fix_f M\"\n  shows \"M ` unit_disc = unit_disc\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M ` unit_disc = unit_disc", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix_f M\n\ngoal (1 subgoal):\n 1. M ` unit_disc = unit_disc", "unfolding unit_disc_fix_f_def"], ["proof (prove)\nusing this:\n  \\<exists>Ma.\n     unit_disc_fix Ma \\<and>\n     (M = moebius_pt Ma \\<or> M = moebius_pt Ma \\<circ> conjugate)\n\ngoal (1 subgoal):\n 1. M ` unit_disc = unit_disc", "using image_comp"], ["proof (prove)\nusing this:\n  \\<exists>Ma.\n     unit_disc_fix Ma \\<and>\n     (M = moebius_pt Ma \\<or> M = moebius_pt Ma \\<circ> conjugate)\n  ?f ` ?g ` ?r = (?f \\<circ> ?g) ` ?r\n\ngoal (1 subgoal):\n 1. M ` unit_disc = unit_disc", "by force"], ["", "text \\<open>Actions of unit disc fixing M?bius transformations (unit disc fixing homographies) are unit\ndisc fixing functions.\\<close>"], ["", "lemma unit_disc_fix_f_moebius_pt [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix_f (moebius_pt M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix_f (moebius_pt M)", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (moebius_pt M)", "unfolding unit_disc_fix_f_def"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. \\<exists>Ma.\n       unit_disc_fix Ma \\<and>\n       (moebius_pt M = moebius_pt Ma \\<or>\n        moebius_pt M = moebius_pt Ma \\<circ> conjugate)", "by auto"], ["", "text \\<open>Compositions of unit disc fixing M?bius transformations and conjugation (unit disc fixing\nantihomographies) are unit disc fixing functions.\\<close>"], ["", "lemma unit_disc_fix_conjugate_moebius [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix (conjugate_moebius M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix (conjugate_moebius M)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. unit_disc_fix (conjugate_moebius M)", "have \"\\<And>a aa ab b. \\<lbrakk>1 < Re (a * b / (aa * ab)); \\<not> 1 < Re (cnj a * cnj b / (cnj aa * cnj ab))\\<rbrakk> \\<Longrightarrow> aa = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa ab b.\n       \\<lbrakk>1 < Re (a * b / (aa * ab));\n        \\<not> 1 < Re (cnj a * cnj b / (cnj aa * cnj ab))\\<rbrakk>\n       \\<Longrightarrow> aa = 0", "by (metis cnj.simps(1) complex_cnj_divide complex_cnj_mult)"], ["proof (state)\nthis:\n  \\<lbrakk>1 < Re (?a * ?b / (?aa * ?ab));\n   \\<not> 1 < Re (cnj ?a * cnj ?b / (cnj ?aa * cnj ?ab))\\<rbrakk>\n  \\<Longrightarrow> ?aa = 0\n\ngoal (1 subgoal):\n 1. unit_disc_fix (conjugate_moebius M)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>1 < Re (?a * ?b / (?aa * ?ab));\n   \\<not> 1 < Re (cnj ?a * cnj ?b / (cnj ?aa * cnj ?ab))\\<rbrakk>\n  \\<Longrightarrow> ?aa = 0\n\ngoal (1 subgoal):\n 1. unit_disc_fix (conjugate_moebius M)", "using assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>1 < Re (?a * ?b / (?aa * ?ab));\n   \\<not> 1 < Re (cnj ?a * cnj ?b / (cnj ?aa * cnj ?ab))\\<rbrakk>\n  \\<Longrightarrow> ?aa = 0\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix (conjugate_moebius M)", "by (transfer, transfer)\n       (auto simp add: mat_cnj_def unitary11_gen_def mat_adj_def field_simps)"], ["proof (state)\nthis:\n  unit_disc_fix (conjugate_moebius M)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma unit_disc_fix_conjugate_comp_moebius [simp]:\n  assumes \"unit_disc_fix M\"\n  shows \"unit_disc_fix_f (conjugate \\<circ> moebius_pt M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix_f (conjugate \\<circ> moebius_pt M)", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (conjugate \\<circ> moebius_pt M)", "apply (subst conjugate_moebius)"], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix M \\<Longrightarrow>\n    unit_disc_fix_f (moebius_pt (conjugate_moebius M) \\<circ> conjugate)", "apply (simp add: unit_disc_fix_f_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix M \\<Longrightarrow>\n    \\<exists>Ma.\n       unit_disc_fix Ma \\<and>\n       (moebius_pt (conjugate_moebius M) \\<circ> conjugate =\n        moebius_pt Ma \\<or>\n        moebius_pt (conjugate_moebius M) \\<circ> conjugate =\n        moebius_pt Ma \\<circ> conjugate)", "apply (rule_tac x=\"conjugate_moebius M\" in exI, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text \\<open>Uniti disc fixing functions form a group under function composition.\\<close>"], ["", "lemma unit_disc_fix_f_comp [simp]:\n  assumes \"unit_disc_fix_f f1\" and \"unit_disc_fix_f f2\"\n  shows \"unit_disc_fix_f (f1 \\<circ> f2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix_f (f1 \\<circ> f2)", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix_f f1\n  unit_disc_fix_f f2\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (f1 \\<circ> f2)", "apply (subst (asm) unit_disc_fix_f_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<exists>M.\n                unit_disc_fix M \\<and>\n                (f1 = moebius_pt M \\<or>\n                 f1 = moebius_pt M \\<circ> conjugate);\n     unit_disc_fix_f f2\\<rbrakk>\n    \\<Longrightarrow> unit_disc_fix_f (f1 \\<circ> f2)", "apply (subst (asm) unit_disc_fix_f_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<exists>M.\n                unit_disc_fix M \\<and>\n                (f1 = moebius_pt M \\<or>\n                 f1 = moebius_pt M \\<circ> conjugate);\n     \\<exists>M.\n        unit_disc_fix M \\<and>\n        (f2 = moebius_pt M \\<or>\n         f2 = moebius_pt M \\<circ> conjugate)\\<rbrakk>\n    \\<Longrightarrow> unit_disc_fix_f (f1 \\<circ> f2)", "proof safe"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> moebius_pt Ma)\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))\n 3. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 4. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "fix M M'"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> moebius_pt Ma)\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))\n 3. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 4. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "assume \"unit_disc_fix M\" \"unit_disc_fix M'\""], ["proof (state)\nthis:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (4 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> moebius_pt Ma)\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))\n 3. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 4. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "thus \"unit_disc_fix_f (moebius_pt M \\<circ> moebius_pt M')\""], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (moebius_pt M \\<circ> moebius_pt M')", "unfolding unit_disc_fix_f_def"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (1 subgoal):\n 1. \\<exists>Ma.\n       unit_disc_fix Ma \\<and>\n       (moebius_pt M \\<circ> moebius_pt M' = moebius_pt Ma \\<or>\n        moebius_pt M \\<circ> moebius_pt M' =\n        moebius_pt Ma \\<circ> conjugate)", "by (rule_tac x=\"M + M'\" in exI) auto"], ["proof (state)\nthis:\n  unit_disc_fix_f (moebius_pt M \\<circ> moebius_pt M')\n\ngoal (3 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 3. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 3. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "fix M M'"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 3. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "assume \"unit_disc_fix M\" \"unit_disc_fix M'\""], ["proof (state)\nthis:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (3 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma; f1 = moebius_pt M;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 3. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "thus \"unit_disc_fix_f (moebius_pt M \\<circ> (moebius_pt M' \\<circ> conjugate))\""], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (moebius_pt M \\<circ> (moebius_pt M' \\<circ> conjugate))", "unfolding unit_disc_fix_f_def"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (1 subgoal):\n 1. \\<exists>Ma.\n       unit_disc_fix Ma \\<and>\n       (moebius_pt M \\<circ> (moebius_pt M' \\<circ> conjugate) =\n        moebius_pt Ma \\<or>\n        moebius_pt M \\<circ> (moebius_pt M' \\<circ> conjugate) =\n        moebius_pt Ma \\<circ> conjugate)", "by (subst comp_assoc[symmetric])+\n       (rule_tac x=\"M + M'\" in exI, auto)"], ["proof (state)\nthis:\n  unit_disc_fix_f (moebius_pt M \\<circ> (moebius_pt M' \\<circ> conjugate))\n\ngoal (2 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "fix M M'"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "assume \"unit_disc_fix M\" \"unit_disc_fix M'\""], ["proof (state)\nthis:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (2 subgoals):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate; f2 = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           moebius_pt Ma)\n 2. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "thus \"unit_disc_fix_f ((moebius_pt M \\<circ> conjugate) \\<circ> moebius_pt M')\""], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (moebius_pt M \\<circ> conjugate \\<circ> moebius_pt M')", "unfolding unit_disc_fix_f_def"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (1 subgoal):\n 1. \\<exists>Ma.\n       unit_disc_fix Ma \\<and>\n       (moebius_pt M \\<circ> conjugate \\<circ> moebius_pt M' =\n        moebius_pt Ma \\<or>\n        moebius_pt M \\<circ> conjugate \\<circ> moebius_pt M' =\n        moebius_pt Ma \\<circ> conjugate)", "by (subst comp_assoc, subst conjugate_moebius, subst comp_assoc[symmetric])+\n       (rule_tac x=\"M + conjugate_moebius M'\" in exI, auto)"], ["proof (state)\nthis:\n  unit_disc_fix_f (moebius_pt M \\<circ> conjugate \\<circ> moebius_pt M')\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "fix M M'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "assume \"unit_disc_fix M\" \"unit_disc_fix M'\""], ["proof (state)\nthis:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (1 subgoal):\n 1. \\<And>M Ma.\n       \\<lbrakk>unit_disc_fix M; unit_disc_fix Ma;\n        f1 = moebius_pt M \\<circ> conjugate;\n        f2 = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (moebius_pt M \\<circ> conjugate \\<circ>\n                           (moebius_pt Ma \\<circ> conjugate))", "thus \"unit_disc_fix_f ((moebius_pt M \\<circ> conjugate) \\<circ> (moebius_pt M' \\<circ> conjugate))\""], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  unit_disc_fix M'\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f\n     (moebius_pt M \\<circ> conjugate \\<circ>\n      (moebius_pt M' \\<circ> conjugate))", "apply (subst comp_assoc[symmetric], subst comp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>unit_disc_fix M; unit_disc_fix M'; unit_disc_fix M;\n     unit_disc_fix M'\\<rbrakk>\n    \\<Longrightarrow> unit_disc_fix_f\n                       (moebius_pt M \\<circ>\n                        (conjugate \\<circ> moebius_pt M') \\<circ>\n                        conjugate)", "apply (subst conjugate_moebius, subst comp_assoc, subst comp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>unit_disc_fix M; unit_disc_fix M'; unit_disc_fix M;\n     unit_disc_fix M'\\<rbrakk>\n    \\<Longrightarrow> unit_disc_fix_f\n                       (moebius_pt M \\<circ>\n                        (moebius_pt (conjugate_moebius M') \\<circ>\n                         (conjugate \\<circ> conjugate)))", "apply (simp add: unit_disc_fix_f_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>unit_disc_fix M; unit_disc_fix M'\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Ma.\n                         unit_disc_fix Ma \\<and>\n                         (moebius_pt M \\<circ>\n                          moebius_pt (conjugate_moebius M') =\n                          moebius_pt Ma \\<or>\n                          moebius_pt M \\<circ>\n                          moebius_pt (conjugate_moebius M') =\n                          moebius_pt Ma \\<circ> conjugate)", "apply (rule_tac x=\"M + conjugate_moebius M'\" in exI, auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  unit_disc_fix_f\n   (moebius_pt M \\<circ> conjugate \\<circ>\n    (moebius_pt M' \\<circ> conjugate))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma unit_disc_fix_f_inv:\n  assumes \"unit_disc_fix_f M\"\n  shows \"unit_disc_fix_f (inv M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix_f (inv M)", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix_f M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (inv M)", "apply (subst (asm) unit_disc_fix_f_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>Ma.\n       unit_disc_fix Ma \\<and>\n       (M = moebius_pt Ma \\<or>\n        M = moebius_pt Ma \\<circ> conjugate) \\<Longrightarrow>\n    unit_disc_fix_f (inv M)", "proof safe"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma; M = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f (inv (moebius_pt Ma))\n 2. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "fix M"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma; M = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f (inv (moebius_pt Ma))\n 2. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "assume \"unit_disc_fix M\""], ["proof (state)\nthis:\n  unit_disc_fix M\n\ngoal (2 subgoals):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma; M = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f (inv (moebius_pt Ma))\n 2. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "have \"inv (moebius_pt M) = moebius_pt (-M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv (moebius_pt M) = moebius_pt (- M)", "by (rule ext) (simp add: moebius_inv)"], ["proof (state)\nthis:\n  inv (moebius_pt M) = moebius_pt (- M)\n\ngoal (2 subgoals):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma; M = moebius_pt Ma\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f (inv (moebius_pt Ma))\n 2. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "thus \"unit_disc_fix_f (inv (moebius_pt M))\""], ["proof (prove)\nusing this:\n  inv (moebius_pt M) = moebius_pt (- M)\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (inv (moebius_pt M))", "using \\<open>unit_disc_fix M\\<close>"], ["proof (prove)\nusing this:\n  inv (moebius_pt M) = moebius_pt (- M)\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (inv (moebius_pt M))", "unfolding unit_disc_fix_f_def"], ["proof (prove)\nusing this:\n  inv (moebius_pt M) = moebius_pt (- M)\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       (inv (moebius_pt M) = moebius_pt M \\<or>\n        inv (moebius_pt M) = moebius_pt M \\<circ> conjugate)", "by (rule_tac x=\"-M\" in exI, simp)"], ["proof (state)\nthis:\n  unit_disc_fix_f (inv (moebius_pt M))\n\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "fix M"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "assume \"unit_disc_fix M\""], ["proof (state)\nthis:\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "have \"inv (moebius_pt M \\<circ> conjugate) = conjugate \\<circ> inv (moebius_pt M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv (moebius_pt M \\<circ> conjugate) =\n    conjugate \\<circ> inv (moebius_pt M)", "by (subst o_inv_distrib, simp_all)"], ["proof (state)\nthis:\n  inv (moebius_pt M \\<circ> conjugate) =\n  conjugate \\<circ> inv (moebius_pt M)\n\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "also"], ["proof (state)\nthis:\n  inv (moebius_pt M \\<circ> conjugate) =\n  conjugate \\<circ> inv (moebius_pt M)\n\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "have \"... = conjugate \\<circ> (moebius_pt (-M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. conjugate \\<circ> inv (moebius_pt M) =\n    conjugate \\<circ> moebius_pt (- M)", "using moebius_inv"], ["proof (prove)\nusing this:\n  moebius_pt (moebius_inv ?M) = inv (moebius_pt ?M)\n\ngoal (1 subgoal):\n 1. conjugate \\<circ> inv (moebius_pt M) =\n    conjugate \\<circ> moebius_pt (- M)", "by auto"], ["proof (state)\nthis:\n  conjugate \\<circ> inv (moebius_pt M) = conjugate \\<circ> moebius_pt (- M)\n\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "also"], ["proof (state)\nthis:\n  conjugate \\<circ> inv (moebius_pt M) = conjugate \\<circ> moebius_pt (- M)\n\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "have \"... = moebius_pt (conjugate_moebius (-M)) \\<circ> conjugate\""], ["proof (prove)\ngoal (1 subgoal):\n 1. conjugate \\<circ> moebius_pt (- M) =\n    moebius_pt (conjugate_moebius (- M)) \\<circ> conjugate", "by (simp add: conjugate_moebius)"], ["proof (state)\nthis:\n  conjugate \\<circ> moebius_pt (- M) =\n  moebius_pt (conjugate_moebius (- M)) \\<circ> conjugate\n\ngoal (1 subgoal):\n 1. \\<And>Ma.\n       \\<lbrakk>unit_disc_fix Ma;\n        M = moebius_pt Ma \\<circ> conjugate\\<rbrakk>\n       \\<Longrightarrow> unit_disc_fix_f\n                          (inv (moebius_pt Ma \\<circ> conjugate))", "finally"], ["proof (chain)\npicking this:\n  inv (moebius_pt M \\<circ> conjugate) =\n  moebius_pt (conjugate_moebius (- M)) \\<circ> conjugate", "show \"unit_disc_fix_f (inv (moebius_pt M \\<circ> conjugate))\""], ["proof (prove)\nusing this:\n  inv (moebius_pt M \\<circ> conjugate) =\n  moebius_pt (conjugate_moebius (- M)) \\<circ> conjugate\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (inv (moebius_pt M \\<circ> conjugate))", "using \\<open>unit_disc_fix M\\<close>"], ["proof (prove)\nusing this:\n  inv (moebius_pt M \\<circ> conjugate) =\n  moebius_pt (conjugate_moebius (- M)) \\<circ> conjugate\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f (inv (moebius_pt M \\<circ> conjugate))", "unfolding unit_disc_fix_f_def"], ["proof (prove)\nusing this:\n  inv (moebius_pt M \\<circ> conjugate) =\n  moebius_pt (conjugate_moebius (- M)) \\<circ> conjugate\n  unit_disc_fix M\n\ngoal (1 subgoal):\n 1. \\<exists>M.\n       unit_disc_fix M \\<and>\n       (inv (moebius_pt M \\<circ> conjugate) = moebius_pt M \\<or>\n        inv (moebius_pt M \\<circ> conjugate) =\n        moebius_pt M \\<circ> conjugate)", "by (rule_tac x=\"conjugate_moebius (-M)\" in exI, simp)"], ["proof (state)\nthis:\n  unit_disc_fix_f (inv (moebius_pt M \\<circ> conjugate))\n\ngoal:\nNo subgoals!", "qed"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsubsection \\<open>Action of unit disc fixing functions on circlines\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "definition unit_disc_fix_f_circline where\n  \"unit_disc_fix_f_circline f H = \n      (if \\<exists> M. unit_disc_fix M \\<and> f = moebius_pt M then\n          moebius_circline (THE M. unit_disc_fix M \\<and> f = moebius_pt M) H\n       else if \\<exists> M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate then\n          (moebius_circline (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate) \\<circ> conjugate_circline) H\n       else\n          H)\""], ["", "lemma unique_moebius_pt_conjugate:\n  assumes \"moebius_pt M1 \\<circ> conjugate = moebius_pt M2 \\<circ> conjugate\"\n  shows \"M1 = M2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M1 = M2", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. M1 = M2", "from assms"], ["proof (chain)\npicking this:\n  moebius_pt M1 \\<circ> conjugate = moebius_pt M2 \\<circ> conjugate", "have \"moebius_pt M1 = moebius_pt M2\""], ["proof (prove)\nusing this:\n  moebius_pt M1 \\<circ> conjugate = moebius_pt M2 \\<circ> conjugate\n\ngoal (1 subgoal):\n 1. moebius_pt M1 = moebius_pt M2", "using conjugate_conjugate_comp rewriteL_comp_comp2"], ["proof (prove)\nusing this:\n  moebius_pt M1 \\<circ> conjugate = moebius_pt M2 \\<circ> conjugate\n  conjugate \\<circ> conjugate = id\n  \\<lbrakk>?f \\<circ> ?g = ?l1.0 \\<circ> ?l2.0;\n   ?l2.0 \\<circ> ?h = ?r\\<rbrakk>\n  \\<Longrightarrow> ?f \\<circ> (?g \\<circ> ?h) = ?l1.0 \\<circ> ?r\n\ngoal (1 subgoal):\n 1. moebius_pt M1 = moebius_pt M2", "by fastforce"], ["proof (state)\nthis:\n  moebius_pt M1 = moebius_pt M2\n\ngoal (1 subgoal):\n 1. M1 = M2", "thus ?thesis"], ["proof (prove)\nusing this:\n  moebius_pt M1 = moebius_pt M2\n\ngoal (1 subgoal):\n 1. M1 = M2", "using unique_moebius_pt"], ["proof (prove)\nusing this:\n  moebius_pt M1 = moebius_pt M2\n  moebius_pt ?M1.0 = moebius_pt ?M2.0 \\<Longrightarrow> ?M1.0 = ?M2.0\n\ngoal (1 subgoal):\n 1. M1 = M2", "by auto"], ["proof (state)\nthis:\n  M1 = M2\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma unit_disc_fix_f_circline_direct:\n  assumes \"unit_disc_fix M\" and \"f = moebius_pt M\"\n  shows \"unit_disc_fix_f_circline f H = moebius_circline M H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H = moebius_circline M H", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H = moebius_circline M H", "have \"M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  f = moebius_pt M\n\ngoal (1 subgoal):\n 1. M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)", "using theI_unique[of \"\\<lambda> M. unit_disc_fix M \\<and> f = moebius_pt M\" M]"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  f = moebius_pt M\n  \\<exists>!x. unit_disc_fix x \\<and> f = moebius_pt x \\<Longrightarrow>\n  (unit_disc_fix M \\<and> f = moebius_pt M) =\n  (M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M))\n\ngoal (1 subgoal):\n 1. M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)", "using unique_moebius_pt[of M]"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  f = moebius_pt M\n  \\<exists>!x. unit_disc_fix x \\<and> f = moebius_pt x \\<Longrightarrow>\n  (unit_disc_fix M \\<and> f = moebius_pt M) =\n  (M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M))\n  moebius_pt M = moebius_pt ?M2.0 \\<Longrightarrow> M = ?M2.0\n\ngoal (1 subgoal):\n 1. M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)", "by auto"], ["proof (state)\nthis:\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H = moebius_circline M H", "thus ?thesis"], ["proof (prove)\nusing this:\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H = moebius_circline M H", "using assms"], ["proof (prove)\nusing this:\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)\n  unit_disc_fix M\n  f = moebius_pt M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H = moebius_circline M H", "unfolding unit_disc_fix_f_circline_def"], ["proof (prove)\nusing this:\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M)\n  unit_disc_fix M\n  f = moebius_pt M\n\ngoal (1 subgoal):\n 1. (if \\<exists>M. unit_disc_fix M \\<and> f = moebius_pt M\n     then moebius_circline (THE M. unit_disc_fix M \\<and> f = moebius_pt M)\n           H\n     else if \\<exists>M.\n                unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate\n          then (moebius_circline\n                 (THE M.\n                     unit_disc_fix M \\<and>\n                     f = moebius_pt M \\<circ> conjugate) \\<circ>\n                conjugate_circline)\n                H\n          else H) =\n    moebius_circline M H", "by auto"], ["proof (state)\nthis:\n  unit_disc_fix_f_circline f H = moebius_circline M H\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma unit_disc_fix_f_circline_indirect:\n  assumes \"unit_disc_fix M\" and \"f = moebius_pt M \\<circ> conjugate\"\n  shows \"unit_disc_fix_f_circline f H = ((moebius_circline M) \\<circ> conjugate_circline) H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H =\n    (moebius_circline M \\<circ> conjugate_circline) H", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H =\n    (moebius_circline M \\<circ> conjugate_circline) H", "have \"\\<not> (\\<exists> M. unit_disc_fix M \\<and> f = moebius_pt M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M", "using assms homography_antihomography_exclusive[of f]"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  f = moebius_pt M \\<circ> conjugate\n  is_antihomography f \\<Longrightarrow> \\<not> is_homography f\n\ngoal (1 subgoal):\n 1. \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M", "unfolding is_homography_def is_antihomography_def is_moebius_def"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  f = moebius_pt M \\<circ> conjugate\n  \\<exists>f'.\n     (\\<exists>M. f' = moebius_pt M) \\<and>\n     f = f' \\<circ> conjugate \\<Longrightarrow>\n  \\<nexists>M. f = moebius_pt M\n\ngoal (1 subgoal):\n 1. \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M", "by auto"], ["proof (state)\nthis:\n  \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H =\n    (moebius_circline M \\<circ> conjugate_circline) H", "moreover"], ["proof (state)\nthis:\n  \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H =\n    (moebius_circline M \\<circ> conjugate_circline) H", "have \"M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)", "using assms"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  f = moebius_pt M \\<circ> conjugate\n\ngoal (1 subgoal):\n 1. M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)", "using theI_unique[of \"\\<lambda> M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate\" M]"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  f = moebius_pt M \\<circ> conjugate\n  \\<exists>!x.\n     unit_disc_fix x \\<and>\n     f = moebius_pt x \\<circ> conjugate \\<Longrightarrow>\n  (unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate) =\n  (M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate))\n\ngoal (1 subgoal):\n 1. M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)", "using unique_moebius_pt_conjugate[of M]"], ["proof (prove)\nusing this:\n  unit_disc_fix M\n  f = moebius_pt M \\<circ> conjugate\n  \\<exists>!x.\n     unit_disc_fix x \\<and>\n     f = moebius_pt x \\<circ> conjugate \\<Longrightarrow>\n  (unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate) =\n  (M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate))\n  moebius_pt M \\<circ> conjugate =\n  moebius_pt ?M2.0 \\<circ> conjugate \\<Longrightarrow>\n  M = ?M2.0\n\ngoal (1 subgoal):\n 1. M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)", "by auto"], ["proof (state)\nthis:\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H =\n    (moebius_circline M \\<circ> conjugate_circline) H", "ultimately"], ["proof (chain)\npicking this:\n  \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H =\n    (moebius_circline M \\<circ> conjugate_circline) H", "using assms"], ["proof (prove)\nusing this:\n  \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)\n  unit_disc_fix M\n  f = moebius_pt M \\<circ> conjugate\n\ngoal (1 subgoal):\n 1. unit_disc_fix_f_circline f H =\n    (moebius_circline M \\<circ> conjugate_circline) H", "unfolding unit_disc_fix_f_circline_def"], ["proof (prove)\nusing this:\n  \\<nexists>M. unit_disc_fix M \\<and> f = moebius_pt M\n  M = (THE M. unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate)\n  unit_disc_fix M\n  f = moebius_pt M \\<circ> conjugate\n\ngoal (1 subgoal):\n 1. (if \\<exists>M. unit_disc_fix M \\<and> f = moebius_pt M\n     then moebius_circline (THE M. unit_disc_fix M \\<and> f = moebius_pt M)\n           H\n     else if \\<exists>M.\n                unit_disc_fix M \\<and> f = moebius_pt M \\<circ> conjugate\n          then (moebius_circline\n                 (THE M.\n                     unit_disc_fix M \\<and>\n                     f = moebius_pt M \\<circ> conjugate) \\<circ>\n                conjugate_circline)\n                H\n          else H) =\n    (moebius_circline M \\<circ> conjugate_circline) H", "by metis"], ["proof (state)\nthis:\n  unit_disc_fix_f_circline f H =\n  (moebius_circline M \\<circ> conjugate_circline) H\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Disc automorphisms - it would be nice to show that there are no disc automorphisms other than\nunit disc fixing homographies and antihomographies, but this part of the theory is not yet\ndeveloped.\\<close>"], ["", "definition is_disc_aut where \"is_disc_aut f \\<longleftrightarrow> bij_betw f unit_disc unit_disc\""], ["", "end"]]}