{"file_name": "/home/qj213/afp-2021-10-22/thys/Complex_Geometry/Unitary_Matrices.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Complex_Geometry", "problem_names": ["lemma unitary_gen_real:\n  assumes \"unitary_gen M\"\n  shows \"(\\<exists> k::real. k > 0 \\<and> mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye)\"", "lemma unitary_gen_unitary:\n  shows \"unitary_gen M \\<longleftrightarrow>\n         (\\<exists> k M'. k > 0 \\<and> unitary M' \\<and> M = (cor k *\\<^sub>s\\<^sub>m eye) *\\<^sub>m\\<^sub>m M')\" (is \"?lhs = ?rhs\")", "lemma unitary_gen_iff':\n  shows \"unitary_gen M \\<longleftrightarrow> \n         (\\<exists> k::complex. k \\<noteq> 0 \\<and> congruence M (1, 0, 0, 1) = k *\\<^sub>s\\<^sub>m (1, 0, 0, 1))\"", "lemma unitary_unitary_gen [simp]:\n  assumes \"unitary M\" \n  shows \"unitary_gen M\"", "lemma unitary_gen_regular:\n  assumes \"unitary_gen M\"\n  shows \"mat_det M \\<noteq> 0\"", "lemmas unitary_regular = unitary_gen_regular[OF unitary_unitary_gen]", "lemma unitary_gen_scale [simp]:\n  assumes \"unitary_gen M\" and \"k \\<noteq> 0\"\n  shows \"unitary_gen (k *\\<^sub>s\\<^sub>m M)\"", "lemma unitary_comp:\n  assumes \"unitary M1\" and \"unitary M2\"\n  shows \"unitary (M1 *\\<^sub>m\\<^sub>m M2)\"", "lemma unitary_gen_comp:\n  assumes \"unitary_gen M1\" and \"unitary_gen M2\"\n  shows \"unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)\"", "lemma unitary_adj_eq_inv:\n  shows \"unitary M \\<longleftrightarrow> mat_det M \\<noteq> 0 \\<and> mat_adj M = mat_inv M\"", "lemma unitary_inv:\n  assumes \"unitary M\"\n  shows \"unitary (mat_inv M)\"", "lemma unitary_gen_inv:\n  assumes \"unitary_gen M\"\n  shows \"unitary_gen (mat_inv M)\"", "lemma unitary_special:\n  assumes \"unitary M\" and \"mat_det M = 1\"\n  shows \"\\<exists> a b. M = (a, b, -cnj b, cnj a)\"", "lemma unitary_gen_special:\n  assumes \"unitary_gen M\" and \"mat_det M = 1\"\n  shows \"\\<exists> a b. M = (a, b, -cnj b, cnj a)\"", "lemma unitary_gen_iff:\n  shows \"unitary_gen M \\<longleftrightarrow> \n         (\\<exists> a b k. k \\<noteq> 0 \\<and> mat_det (a, b, -cnj b, cnj a) \\<noteq> 0 \\<and>\n                           M = k *\\<^sub>s\\<^sub>m (a, b, -cnj b, cnj a))\" (is \"?lhs = ?rhs\")", "lemma unitary_iff:\n  shows \"unitary M \\<longleftrightarrow>\n         (\\<exists> a b k. (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and> \n                           (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n                           M = k *\\<^sub>s\\<^sub>m (a, b, -cnj b, cnj a))\" (is \"?lhs = ?rhs\")"], "translations": [["", "lemma unitary_gen_real:\n  assumes \"unitary_gen M\"\n  shows \"(\\<exists> k::real. k > 0 \\<and> mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye", "obtain k where *: \"mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\" \"k \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye;\n         k \\<noteq> 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms"], ["proof (prove)\nusing this:\n  unitary_gen M\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye;\n         k \\<noteq> 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp add: unitary_gen_def)"], ["proof (state)\nthis:\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye", "obtain a b c d where \"M = (a, b, c, d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>a b c d.\n        M = (a, b, c, d) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases M) auto"], ["proof (state)\nthis:\n  M = (a, b, c, d)\n\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye", "hence \"k = cor ((cmod a)\\<^sup>2) + cor ((cmod c)\\<^sup>2)\""], ["proof (prove)\nusing this:\n  M = (a, b, c, d)\n\ngoal (1 subgoal):\n 1. k = cor ((cmod a)\\<^sup>2) + cor ((cmod c)\\<^sup>2)", "using *"], ["proof (prove)\nusing this:\n  M = (a, b, c, d)\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k = cor ((cmod a)\\<^sup>2) + cor ((cmod c)\\<^sup>2)", "by (subst  complex_mult_cnj_cmod[symmetric])+ (auto simp add: mat_adj_def mat_cnj_def)"], ["proof (state)\nthis:\n  k = cor ((cmod a)\\<^sup>2) + cor ((cmod c)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye", "hence \"is_real k \\<and> Re k > 0\""], ["proof (prove)\nusing this:\n  k = cor ((cmod a)\\<^sup>2) + cor ((cmod c)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. is_real k \\<and> 0 < Re k", "using \\<open>k \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  k = cor ((cmod a)\\<^sup>2) + cor ((cmod c)\\<^sup>2)\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. is_real k \\<and> 0 < Re k", "by (smt add_cancel_left_left arg_0_iff arg_complex_of_real_positive not_sum_power2_lt_zero of_real_0 plus_complex.simps(1) plus_complex.simps(2))"], ["proof (state)\nthis:\n  is_real k \\<and> 0 < Re k\n\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye", "thus ?thesis"], ["proof (prove)\nusing this:\n  is_real k \\<and> 0 < Re k\n\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye", "using *"], ["proof (prove)\nusing this:\n  is_real k \\<and> 0 < Re k\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye", "by (rule_tac x=\"Re k\" in exI) simp"], ["proof (state)\nthis:\n  \\<exists>k>0. mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Generalized unitary matrices can be factored into a product of a unitary matrix and a real\npositive scalar multiple of the identity matrix\\<close>"], ["", "lemma unitary_gen_unitary:\n  shows \"unitary_gen M \\<longleftrightarrow>\n         (\\<exists> k M'. k > 0 \\<and> unitary M' \\<and> M = (cor k *\\<^sub>s\\<^sub>m eye) *\\<^sub>m\\<^sub>m M')\" (is \"?lhs = ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary_gen M =\n    (\\<exists>k M'.\n        0 < k \\<and>\n        unitary M' \\<and>\n        M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M')", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n 2. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "assume ?lhs"], ["proof (state)\nthis:\n  unitary_gen M\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n 2. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "then"], ["proof (chain)\npicking this:\n  unitary_gen M", "obtain k where *: \"k>0\" \"mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye\""], ["proof (prove)\nusing this:\n  unitary_gen M\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>0 < k;\n         mat_adj M *\\<^sub>m\\<^sub>m M =\n         cor k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using unitary_gen_real[of M]"], ["proof (prove)\nusing this:\n  unitary_gen M\n  unitary_gen M \\<Longrightarrow>\n  \\<exists>k>0. mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>0 < k;\n         mat_adj M *\\<^sub>m\\<^sub>m M =\n         cor k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < k\n  mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n 2. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "let ?k' = \"cor (sqrt k)\""], ["proof (state)\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n 2. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "have \"?k' * cnj ?k' = cor k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cor (sqrt k) * cnj (cor (sqrt k)) = cor k", "using \\<open>k > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < k\n\ngoal (1 subgoal):\n 1. cor (sqrt k) * cnj (cor (sqrt k)) = cor k", "by simp"], ["proof (state)\nthis:\n  cor (sqrt k) * cnj (cor (sqrt k)) = cor k\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n 2. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "moreover"], ["proof (state)\nthis:\n  cor (sqrt k) * cnj (cor (sqrt k)) = cor k\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n 2. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "have \"Re ?k' > 0\" \"is_real ?k'\" \"?k' \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < Re (cor (sqrt k)) &&&\n    is_real (cor (sqrt k)) &&& cor (sqrt k) \\<noteq> 0", "using \\<open>k > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < k\n\ngoal (1 subgoal):\n 1. 0 < Re (cor (sqrt k)) &&&\n    is_real (cor (sqrt k)) &&& cor (sqrt k) \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  0 < Re (cor (sqrt k))\n  is_real (cor (sqrt k))\n  cor (sqrt k) \\<noteq> 0\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n 2. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "ultimately"], ["proof (chain)\npicking this:\n  cor (sqrt k) * cnj (cor (sqrt k)) = cor k\n  0 < Re (cor (sqrt k))\n  is_real (cor (sqrt k))\n  cor (sqrt k) \\<noteq> 0", "show ?rhs"], ["proof (prove)\nusing this:\n  cor (sqrt k) * cnj (cor (sqrt k)) = cor k\n  0 < Re (cor (sqrt k))\n  is_real (cor (sqrt k))\n  cor (sqrt k) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'", "using * mat_eye_l"], ["proof (prove)\nusing this:\n  cor (sqrt k) * cnj (cor (sqrt k)) = cor k\n  0 < Re (cor (sqrt k))\n  is_real (cor (sqrt k))\n  cor (sqrt k) \\<noteq> 0\n  0 < k\n  mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye\n  eye *\\<^sub>m\\<^sub>m ?A = ?A\n\ngoal (1 subgoal):\n 1. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'", "unfolding unitary_gen_def unitary_def"], ["proof (prove)\nusing this:\n  cor (sqrt k) * cnj (cor (sqrt k)) = cor k\n  0 < Re (cor (sqrt k))\n  is_real (cor (sqrt k))\n  cor (sqrt k) \\<noteq> 0\n  0 < k\n  mat_adj M *\\<^sub>m\\<^sub>m M = cor k *\\<^sub>s\\<^sub>m eye\n  eye *\\<^sub>m\\<^sub>m ?A = ?A\n\ngoal (1 subgoal):\n 1. \\<exists>k M'.\n       0 < k \\<and>\n       mat_adj M' *\\<^sub>m\\<^sub>m M' = eye \\<and>\n       M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'", "by (rule_tac x=\"Re ?k'\" in exI) (rule_tac x=\"(1/?k')*\\<^sub>s\\<^sub>mM\" in exI, simp add: mult_sm_mm[symmetric])"], ["proof (state)\nthis:\n  \\<exists>k M'.\n     0 < k \\<and>\n     unitary M' \\<and> M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "assume ?rhs"], ["proof (state)\nthis:\n  \\<exists>k M'.\n     0 < k \\<and>\n     unitary M' \\<and> M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "then"], ["proof (chain)\npicking this:\n  \\<exists>k M'.\n     0 < k \\<and>\n     unitary M' \\<and> M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'", "obtain k M' where \"k > 0\" \"unitary M'\" \"M = (cor k *\\<^sub>s\\<^sub>m eye) *\\<^sub>m\\<^sub>m M'\""], ["proof (prove)\nusing this:\n  \\<exists>k M'.\n     0 < k \\<and>\n     unitary M' \\<and> M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. (\\<And>k M'.\n        \\<lbrakk>0 < k; unitary M';\n         M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < k\n  unitary M'\n  M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "hence \"M = cor k *\\<^sub>s\\<^sub>m M'\""], ["proof (prove)\nusing this:\n  0 < k\n  unitary M'\n  M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. M = cor k *\\<^sub>s\\<^sub>m M'", "using mult_sm_mm[of \"cor k\" eye M'] mat_eye_l"], ["proof (prove)\nusing this:\n  0 < k\n  unitary M'\n  M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n  cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' =\n  cor k *\\<^sub>s\\<^sub>m (eye *\\<^sub>m\\<^sub>m M')\n  eye *\\<^sub>m\\<^sub>m ?A = ?A\n\ngoal (1 subgoal):\n 1. M = cor k *\\<^sub>s\\<^sub>m M'", "by simp"], ["proof (state)\nthis:\n  M = cor k *\\<^sub>s\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. \\<exists>k M'.\n       0 < k \\<and>\n       unitary M' \\<and>\n       M =\n       cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M' \\<Longrightarrow>\n    unitary_gen M", "thus ?lhs"], ["proof (prove)\nusing this:\n  M = cor k *\\<^sub>s\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. unitary_gen M", "using \\<open>unitary M'\\<close> \\<open>k > 0\\<close>"], ["proof (prove)\nusing this:\n  M = cor k *\\<^sub>s\\<^sub>m M'\n  unitary M'\n  0 < k\n\ngoal (1 subgoal):\n 1. unitary_gen M", "by (simp add: unitary_gen_def unitary_def)"], ["proof (state)\nthis:\n  unitary_gen M\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>When they represent M?bius transformations, eneralized unitary matrices fix the imaginary unit circle. Therefore, they\nfix a Hermitean form with (2, 0) signature (two positive and no negative diagonal elements).\\<close>"], ["", "lemma unitary_gen_iff':\n  shows \"unitary_gen M \\<longleftrightarrow> \n         (\\<exists> k::complex. k \\<noteq> 0 \\<and> congruence M (1, 0, 0, 1) = k *\\<^sub>s\\<^sub>m (1, 0, 0, 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary_gen M =\n    (\\<exists>k.\n        k \\<noteq> 0 \\<and>\n        congruence M (1, 0, 0, 1) = k *\\<^sub>s\\<^sub>m (1, 0, 0, 1))", "unfolding unitary_gen_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>k.\n        k \\<noteq> 0 \\<and>\n        mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye) =\n    (\\<exists>k.\n        k \\<noteq> 0 \\<and>\n        congruence M (1, 0, 0, 1) = k *\\<^sub>s\\<^sub>m (1, 0, 0, 1))", "using mat_eye_r"], ["proof (prove)\nusing this:\n  ?A *\\<^sub>m\\<^sub>m eye = ?A\n\ngoal (1 subgoal):\n 1. (\\<exists>k.\n        k \\<noteq> 0 \\<and>\n        mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye) =\n    (\\<exists>k.\n        k \\<noteq> 0 \\<and>\n        congruence M (1, 0, 0, 1) = k *\\<^sub>s\\<^sub>m (1, 0, 0, 1))", "by (auto simp add: mult.assoc)"], ["", "text \\<open>Unitary matrices are special cases of general unitary matrices\\<close>"], ["", "lemma unitary_unitary_gen [simp]:\n  assumes \"unitary M\" \n  shows \"unitary_gen M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary_gen M", "using assms"], ["proof (prove)\nusing this:\n  unitary M\n\ngoal (1 subgoal):\n 1. unitary_gen M", "unfolding unitary_gen_def unitary_def"], ["proof (prove)\nusing this:\n  mat_adj M *\\<^sub>m\\<^sub>m M = eye\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye", "by auto"], ["", "text \\<open>Generalized unitary matrices are regular\\<close>"], ["", "lemma unitary_gen_regular:\n  assumes \"unitary_gen M\"\n  shows \"mat_det M \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_det M \\<noteq> 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. mat_det M \\<noteq> 0", "from assms"], ["proof (chain)\npicking this:\n  unitary_gen M", "obtain k where\n    \"k \\<noteq> 0\" \"mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\""], ["proof (prove)\nusing this:\n  unitary_gen M\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding unitary_gen_def"], ["proof (prove)\nusing this:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. mat_det M \\<noteq> 0", "hence \"mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) \\<noteq> 0\""], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) \\<noteq> 0", "by simp"], ["proof (state)\nthis:\n  mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. mat_det M \\<noteq> 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. mat_det M \\<noteq> 0", "by (simp add: mat_det_adj)"], ["proof (state)\nthis:\n  mat_det M \\<noteq> 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas unitary_regular = unitary_gen_regular[OF unitary_unitary_gen]"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsubsection \\<open>Group properties\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "text \\<open>Generalized $2\\times 2$ unitary matrices form a group under\nmultiplication (usually denoted by $GU(2, \\mathbb{C})$). The group is closed\nunder non-zero complex scalar multiplication. Since these matrices are\nalways regular, they form a subgroup of general linear group (usually\ndenoted by $GL(2, \\mathbb{C})$) of all regular matrices.\\<close>"], ["", "lemma unitary_gen_scale [simp]:\n  assumes \"unitary_gen M\" and \"k \\<noteq> 0\"\n  shows \"unitary_gen (k *\\<^sub>s\\<^sub>m M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary_gen (k *\\<^sub>s\\<^sub>m M)", "using assms"], ["proof (prove)\nusing this:\n  unitary_gen M\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. unitary_gen (k *\\<^sub>s\\<^sub>m M)", "unfolding unitary_gen_def"], ["proof (prove)\nusing this:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>ka.\n       ka \\<noteq> 0 \\<and>\n       mat_adj (k *\\<^sub>s\\<^sub>m M) *\\<^sub>m\\<^sub>m\n       (k *\\<^sub>s\\<^sub>m M) =\n       ka *\\<^sub>s\\<^sub>m eye", "by auto"], ["", "lemma unitary_comp:\n  assumes \"unitary M1\" and \"unitary M2\"\n  shows \"unitary (M1 *\\<^sub>m\\<^sub>m M2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary (M1 *\\<^sub>m\\<^sub>m M2)", "using assms"], ["proof (prove)\nusing this:\n  unitary M1\n  unitary M2\n\ngoal (1 subgoal):\n 1. unitary (M1 *\\<^sub>m\\<^sub>m M2)", "unfolding unitary_def"], ["proof (prove)\nusing this:\n  mat_adj M1 *\\<^sub>m\\<^sub>m M1 = eye\n  mat_adj M2 *\\<^sub>m\\<^sub>m M2 = eye\n\ngoal (1 subgoal):\n 1. mat_adj (M1 *\\<^sub>m\\<^sub>m M2) *\\<^sub>m\\<^sub>m\n    (M1 *\\<^sub>m\\<^sub>m M2) =\n    eye", "by (metis mat_adj_mult_mm mat_eye_l mult_mm_assoc)"], ["", "lemma unitary_gen_comp:\n  assumes \"unitary_gen M1\" and \"unitary_gen M2\"\n  shows \"unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "obtain k1 k2 where *: \"k1 * k2 \\<noteq> 0\" \"mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye\" \"mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>k1 k2.\n        \\<lbrakk>k1 * k2 \\<noteq> 0;\n         mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye;\n         mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms"], ["proof (prove)\nusing this:\n  unitary_gen M1\n  unitary_gen M2\n\ngoal (1 subgoal):\n 1. (\\<And>k1 k2.\n        \\<lbrakk>k1 * k2 \\<noteq> 0;\n         mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye;\n         mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding unitary_gen_def"], ["proof (prove)\nusing this:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k *\\<^sub>s\\<^sub>m eye\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. (\\<And>k1 k2.\n        \\<lbrakk>k1 * k2 \\<noteq> 0;\n         mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye;\n         mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k1 * k2 \\<noteq> 0\n  mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye\n  mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "have \"mat_adj M2 *\\<^sub>m\\<^sub>m mat_adj M1 *\\<^sub>m\\<^sub>m (M1 *\\<^sub>m\\<^sub>m M2) = mat_adj M2 *\\<^sub>m\\<^sub>m (mat_adj M1 *\\<^sub>m\\<^sub>m M1) *\\<^sub>m\\<^sub>m M2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_adj M2 *\\<^sub>m\\<^sub>m mat_adj M1 *\\<^sub>m\\<^sub>m\n    (M1 *\\<^sub>m\\<^sub>m M2) =\n    mat_adj M2 *\\<^sub>m\\<^sub>m\n    (mat_adj M1 *\\<^sub>m\\<^sub>m M1) *\\<^sub>m\\<^sub>m\n    M2", "by (auto simp add: mult_mm_assoc)"], ["proof (state)\nthis:\n  mat_adj M2 *\\<^sub>m\\<^sub>m mat_adj M1 *\\<^sub>m\\<^sub>m\n  (M1 *\\<^sub>m\\<^sub>m M2) =\n  mat_adj M2 *\\<^sub>m\\<^sub>m\n  (mat_adj M1 *\\<^sub>m\\<^sub>m M1) *\\<^sub>m\\<^sub>m\n  M2\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "also"], ["proof (state)\nthis:\n  mat_adj M2 *\\<^sub>m\\<^sub>m mat_adj M1 *\\<^sub>m\\<^sub>m\n  (M1 *\\<^sub>m\\<^sub>m M2) =\n  mat_adj M2 *\\<^sub>m\\<^sub>m\n  (mat_adj M1 *\\<^sub>m\\<^sub>m M1) *\\<^sub>m\\<^sub>m\n  M2\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "have \"... = mat_adj M2 *\\<^sub>m\\<^sub>m ((k1 *\\<^sub>s\\<^sub>m eye) *\\<^sub>m\\<^sub>m M2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_adj M2 *\\<^sub>m\\<^sub>m\n    (mat_adj M1 *\\<^sub>m\\<^sub>m M1) *\\<^sub>m\\<^sub>m\n    M2 =\n    mat_adj M2 *\\<^sub>m\\<^sub>m\n    (k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2)", "using *"], ["proof (prove)\nusing this:\n  k1 * k2 \\<noteq> 0\n  mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye\n  mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. mat_adj M2 *\\<^sub>m\\<^sub>m\n    (mat_adj M1 *\\<^sub>m\\<^sub>m M1) *\\<^sub>m\\<^sub>m\n    M2 =\n    mat_adj M2 *\\<^sub>m\\<^sub>m\n    (k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2)", "by (auto simp add: mult_mm_assoc)"], ["proof (state)\nthis:\n  mat_adj M2 *\\<^sub>m\\<^sub>m\n  (mat_adj M1 *\\<^sub>m\\<^sub>m M1) *\\<^sub>m\\<^sub>m\n  M2 =\n  mat_adj M2 *\\<^sub>m\\<^sub>m\n  (k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2)\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "also"], ["proof (state)\nthis:\n  mat_adj M2 *\\<^sub>m\\<^sub>m\n  (mat_adj M1 *\\<^sub>m\\<^sub>m M1) *\\<^sub>m\\<^sub>m\n  M2 =\n  mat_adj M2 *\\<^sub>m\\<^sub>m\n  (k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2)\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "have \"... = mat_adj M2 *\\<^sub>m\\<^sub>m (k1 *\\<^sub>s\\<^sub>m M2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_adj M2 *\\<^sub>m\\<^sub>m\n    (k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2) =\n    mat_adj M2 *\\<^sub>m\\<^sub>m (k1 *\\<^sub>s\\<^sub>m M2)", "using mult_sm_eye_mm[of k1 M2]"], ["proof (prove)\nusing this:\n  k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2 = k1 *\\<^sub>s\\<^sub>m M2\n\ngoal (1 subgoal):\n 1. mat_adj M2 *\\<^sub>m\\<^sub>m\n    (k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2) =\n    mat_adj M2 *\\<^sub>m\\<^sub>m (k1 *\\<^sub>s\\<^sub>m M2)", "by (simp del: eye_def)"], ["proof (state)\nthis:\n  mat_adj M2 *\\<^sub>m\\<^sub>m\n  (k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2) =\n  mat_adj M2 *\\<^sub>m\\<^sub>m (k1 *\\<^sub>s\\<^sub>m M2)\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "also"], ["proof (state)\nthis:\n  mat_adj M2 *\\<^sub>m\\<^sub>m\n  (k1 *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M2) =\n  mat_adj M2 *\\<^sub>m\\<^sub>m (k1 *\\<^sub>s\\<^sub>m M2)\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "have \"... = k1 *\\<^sub>s\\<^sub>m (k2 *\\<^sub>s\\<^sub>m eye)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_adj M2 *\\<^sub>m\\<^sub>m (k1 *\\<^sub>s\\<^sub>m M2) =\n    k1 *\\<^sub>s\\<^sub>m (k2 *\\<^sub>s\\<^sub>m eye)", "using *"], ["proof (prove)\nusing this:\n  k1 * k2 \\<noteq> 0\n  mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye\n  mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. mat_adj M2 *\\<^sub>m\\<^sub>m (k1 *\\<^sub>s\\<^sub>m M2) =\n    k1 *\\<^sub>s\\<^sub>m (k2 *\\<^sub>s\\<^sub>m eye)", "by auto"], ["proof (state)\nthis:\n  mat_adj M2 *\\<^sub>m\\<^sub>m (k1 *\\<^sub>s\\<^sub>m M2) =\n  k1 *\\<^sub>s\\<^sub>m (k2 *\\<^sub>s\\<^sub>m eye)\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "finally"], ["proof (chain)\npicking this:\n  mat_adj M2 *\\<^sub>m\\<^sub>m mat_adj M1 *\\<^sub>m\\<^sub>m\n  (M1 *\\<^sub>m\\<^sub>m M2) =\n  k1 *\\<^sub>s\\<^sub>m (k2 *\\<^sub>s\\<^sub>m eye)", "show ?thesis"], ["proof (prove)\nusing this:\n  mat_adj M2 *\\<^sub>m\\<^sub>m mat_adj M1 *\\<^sub>m\\<^sub>m\n  (M1 *\\<^sub>m\\<^sub>m M2) =\n  k1 *\\<^sub>s\\<^sub>m (k2 *\\<^sub>s\\<^sub>m eye)\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "using *"], ["proof (prove)\nusing this:\n  mat_adj M2 *\\<^sub>m\\<^sub>m mat_adj M1 *\\<^sub>m\\<^sub>m\n  (M1 *\\<^sub>m\\<^sub>m M2) =\n  k1 *\\<^sub>s\\<^sub>m (k2 *\\<^sub>s\\<^sub>m eye)\n  k1 * k2 \\<noteq> 0\n  mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye\n  mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)", "unfolding unitary_gen_def"], ["proof (prove)\nusing this:\n  mat_adj M2 *\\<^sub>m\\<^sub>m mat_adj M1 *\\<^sub>m\\<^sub>m\n  (M1 *\\<^sub>m\\<^sub>m M2) =\n  k1 *\\<^sub>s\\<^sub>m (k2 *\\<^sub>s\\<^sub>m eye)\n  k1 * k2 \\<noteq> 0\n  mat_adj M1 *\\<^sub>m\\<^sub>m M1 = k1 *\\<^sub>s\\<^sub>m eye\n  mat_adj M2 *\\<^sub>m\\<^sub>m M2 = k2 *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       mat_adj (M1 *\\<^sub>m\\<^sub>m M2) *\\<^sub>m\\<^sub>m\n       (M1 *\\<^sub>m\\<^sub>m M2) =\n       k *\\<^sub>s\\<^sub>m eye", "by (rule_tac x=\"k1*k2\" in exI, simp del: eye_def)"], ["proof (state)\nthis:\n  unitary_gen (M1 *\\<^sub>m\\<^sub>m M2)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma unitary_adj_eq_inv:\n  shows \"unitary M \\<longleftrightarrow> mat_det M \\<noteq> 0 \\<and> mat_adj M = mat_inv M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary M = (mat_det M \\<noteq> 0 \\<and> mat_adj M = mat_inv M)", "using  unitary_regular[of M] mult_mm_inv_r[of M \"mat_adj M\" eye]  mat_eye_l[of \"mat_inv M\"] mat_inv_l[of M]"], ["proof (prove)\nusing this:\n  unitary M \\<Longrightarrow> mat_det M \\<noteq> 0\n  \\<lbrakk>mat_det M \\<noteq> 0;\n   mat_adj M *\\<^sub>m\\<^sub>m M = eye\\<rbrakk>\n  \\<Longrightarrow> mat_adj M = eye *\\<^sub>m\\<^sub>m mat_inv M\n  eye *\\<^sub>m\\<^sub>m mat_inv M = mat_inv M\n  mat_det M \\<noteq> 0 \\<Longrightarrow> mat_inv M *\\<^sub>m\\<^sub>m M = eye\n\ngoal (1 subgoal):\n 1. unitary M = (mat_det M \\<noteq> 0 \\<and> mat_adj M = mat_inv M)", "unfolding unitary_def"], ["proof (prove)\nusing this:\n  mat_adj M *\\<^sub>m\\<^sub>m M = eye \\<Longrightarrow> mat_det M \\<noteq> 0\n  \\<lbrakk>mat_det M \\<noteq> 0;\n   mat_adj M *\\<^sub>m\\<^sub>m M = eye\\<rbrakk>\n  \\<Longrightarrow> mat_adj M = eye *\\<^sub>m\\<^sub>m mat_inv M\n  eye *\\<^sub>m\\<^sub>m mat_inv M = mat_inv M\n  mat_det M \\<noteq> 0 \\<Longrightarrow> mat_inv M *\\<^sub>m\\<^sub>m M = eye\n\ngoal (1 subgoal):\n 1. (mat_adj M *\\<^sub>m\\<^sub>m M = eye) =\n    (mat_det M \\<noteq> 0 \\<and> mat_adj M = mat_inv M)", "by - (rule, simp_all)"], ["", "lemma unitary_inv:\n  assumes \"unitary M\"\n  shows \"unitary (mat_inv M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary (mat_inv M)", "using assms"], ["proof (prove)\nusing this:\n  unitary M\n\ngoal (1 subgoal):\n 1. unitary (mat_inv M)", "unfolding unitary_adj_eq_inv"], ["proof (prove)\nusing this:\n  mat_det M \\<noteq> 0 \\<and> mat_adj M = mat_inv M\n\ngoal (1 subgoal):\n 1. mat_det (mat_inv M) \\<noteq> 0 \\<and>\n    mat_adj (mat_inv M) = mat_inv (mat_inv M)", "using mat_adj_inv[of M] mat_det_inv[of M]"], ["proof (prove)\nusing this:\n  mat_det M \\<noteq> 0 \\<and> mat_adj M = mat_inv M\n  mat_det M \\<noteq> 0 \\<Longrightarrow>\n  mat_adj (mat_inv M) = mat_inv (mat_adj M)\n  mat_det M \\<noteq> 0 \\<Longrightarrow> mat_det (mat_inv M) = 1 / mat_det M\n\ngoal (1 subgoal):\n 1. mat_det (mat_inv M) \\<noteq> 0 \\<and>\n    mat_adj (mat_inv M) = mat_inv (mat_inv M)", "by simp"], ["", "lemma unitary_gen_inv:\n  assumes \"unitary_gen M\"\n  shows \"unitary_gen (mat_inv M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv M)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv M)", "obtain k M' where \"0 < k\" \"unitary M'\" \"M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>k M'.\n        \\<lbrakk>0 < k; unitary M';\n         M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using unitary_gen_unitary[of M] assms"], ["proof (prove)\nusing this:\n  unitary_gen M =\n  (\\<exists>k M'.\n      0 < k \\<and>\n      unitary M' \\<and>\n      M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M')\n  unitary_gen M\n\ngoal (1 subgoal):\n 1. (\\<And>k M'.\n        \\<lbrakk>0 < k; unitary M';\n         M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < k\n  unitary M'\n  M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv M)", "hence \"mat_inv M = cor (1/k) *\\<^sub>s\\<^sub>m mat_inv M'\""], ["proof (prove)\nusing this:\n  0 < k\n  unitary M'\n  M = cor k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m M'\n\ngoal (1 subgoal):\n 1. mat_inv M = cor (1 / k) *\\<^sub>s\\<^sub>m mat_inv M'", "by (metis mat_inv_mult_sm mult_sm_eye_mm norm_not_less_zero of_real_1 of_real_divide of_real_eq_0_iff sgn_1_neg sgn_greater sgn_if sgn_pos sgn_sgn)"], ["proof (state)\nthis:\n  mat_inv M = cor (1 / k) *\\<^sub>s\\<^sub>m mat_inv M'\n\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv M)", "thus ?thesis"], ["proof (prove)\nusing this:\n  mat_inv M = cor (1 / k) *\\<^sub>s\\<^sub>m mat_inv M'\n\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv M)", "using \\<open>k > 0\\<close> \\<open>unitary M'\\<close>"], ["proof (prove)\nusing this:\n  mat_inv M = cor (1 / k) *\\<^sub>s\\<^sub>m mat_inv M'\n  0 < k\n  unitary M'\n\ngoal (1 subgoal):\n 1. unitary_gen (mat_inv M)", "by (subst unitary_gen_unitary[of \"mat_inv M\"]) (rule_tac x=\"1/k\" in exI, rule_tac x=\"mat_inv M'\" in exI, metis divide_pos_pos mult_sm_eye_mm unitary_inv zero_less_one)"], ["proof (state)\nthis:\n  unitary_gen (mat_inv M)\n\ngoal:\nNo subgoals!", "qed"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "subsubsection \\<open>The characterization in terms of matrix elements\\<close>"], ["", "(* -------------------------------------------------------------------------- *)"], ["", "text \\<open>Special matrices are those having the determinant equal to 1. We first give their characterization.\\<close>"], ["", "lemma unitary_special:\n  assumes \"unitary M\" and \"mat_det M = 1\"\n  shows \"\\<exists> a b. M = (a, b, -cnj b, cnj a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "have \"mat_adj M = mat_inv M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_adj M = mat_inv M", "using assms mult_mm_inv_r[of M \"mat_adj M\" \"eye\"] mat_eye_r mat_eye_l"], ["proof (prove)\nusing this:\n  unitary M\n  mat_det M = 1\n  \\<lbrakk>mat_det M \\<noteq> 0;\n   mat_adj M *\\<^sub>m\\<^sub>m M = eye\\<rbrakk>\n  \\<Longrightarrow> mat_adj M = eye *\\<^sub>m\\<^sub>m mat_inv M\n  ?A *\\<^sub>m\\<^sub>m eye = ?A\n  eye *\\<^sub>m\\<^sub>m ?A = ?A\n\ngoal (1 subgoal):\n 1. mat_adj M = mat_inv M", "by (simp add: unitary_def)"], ["proof (state)\nthis:\n  mat_adj M = mat_inv M\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "thus ?thesis"], ["proof (prove)\nusing this:\n  mat_adj M = mat_inv M\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "using \\<open>mat_det M = 1\\<close>"], ["proof (prove)\nusing this:\n  mat_adj M = mat_inv M\n  mat_det M = 1\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "by (cases M) (auto simp add: mat_adj_def mat_cnj_def)"], ["proof (state)\nthis:\n  \\<exists>a b. M = (a, b, - cnj b, cnj a)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma unitary_gen_special:\n  assumes \"unitary_gen M\" and \"mat_det M = 1\"\n  shows \"\\<exists> a b. M = (a, b, -cnj b, cnj a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "from assms"], ["proof (chain)\npicking this:\n  unitary_gen M\n  mat_det M = 1", "obtain k where *: \"k \\<noteq> 0\" \"mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\""], ["proof (prove)\nusing this:\n  unitary_gen M\n  mat_det M = 1\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding unitary_gen_def"], ["proof (prove)\nusing this:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n  mat_det M = 1\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "hence \"mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) = k*k\""], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) = k * k", "by simp"], ["proof (state)\nthis:\n  mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) = k * k\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "hence \"k*k = 1\""], ["proof (prove)\nusing this:\n  mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) = k * k\n\ngoal (1 subgoal):\n 1. k * k = 1", "using assms(2)"], ["proof (prove)\nusing this:\n  mat_det (mat_adj M *\\<^sub>m\\<^sub>m M) = k * k\n  mat_det M = 1\n\ngoal (1 subgoal):\n 1. k * k = 1", "by (simp add: mat_det_adj)"], ["proof (state)\nthis:\n  k * k = 1\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "hence \"k = 1 \\<or> k = -1\""], ["proof (prove)\nusing this:\n  k * k = 1\n\ngoal (1 subgoal):\n 1. k = 1 \\<or> k = - 1", "using square_eq_1_iff[of k]"], ["proof (prove)\nusing this:\n  k * k = 1\n  (k * k = 1) = (k = 1 \\<or> k = - 1)\n\ngoal (1 subgoal):\n 1. k = 1 \\<or> k = - 1", "by simp"], ["proof (state)\nthis:\n  k = 1 \\<or> k = - 1\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "moreover"], ["proof (state)\nthis:\n  k = 1 \\<or> k = - 1\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "have \"mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M", "using *"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M", "using assms mult_mm_inv_r[of M \"mat_adj M\" \"k *\\<^sub>s\\<^sub>m eye\"] mat_eye_r mat_eye_l"], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n  unitary_gen M\n  mat_det M = 1\n  \\<lbrakk>mat_det M \\<noteq> 0;\n   mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n  \\<Longrightarrow> mat_adj M =\n                    k *\\<^sub>s\\<^sub>m eye *\\<^sub>m\\<^sub>m mat_inv M\n  ?A *\\<^sub>m\\<^sub>m eye = ?A\n  eye *\\<^sub>m\\<^sub>m ?A = ?A\n\ngoal (1 subgoal):\n 1. mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M", "by simp (metis mult_sm_eye_mm *(2))"], ["proof (state)\nthis:\n  mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "moreover"], ["proof (state)\nthis:\n  mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "obtain a b c d where \"M = (a, b, c, d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>a b c d.\n        M = (a, b, c, d) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases M) auto"], ["proof (state)\nthis:\n  M = (a, b, c, d)\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "ultimately"], ["proof (chain)\npicking this:\n  k = 1 \\<or> k = - 1\n  mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M\n  M = (a, b, c, d)", "have \"M = (a, b, -cnj b, cnj a) \\<or> M = (a, b, cnj b, -cnj a)\""], ["proof (prove)\nusing this:\n  k = 1 \\<or> k = - 1\n  mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M\n  M = (a, b, c, d)\n\ngoal (1 subgoal):\n 1. M = (a, b, - cnj b, cnj a) \\<or> M = (a, b, cnj b, - cnj a)", "using assms(2)"], ["proof (prove)\nusing this:\n  k = 1 \\<or> k = - 1\n  mat_adj M = k *\\<^sub>s\\<^sub>m mat_inv M\n  M = (a, b, c, d)\n  mat_det M = 1\n\ngoal (1 subgoal):\n 1. M = (a, b, - cnj b, cnj a) \\<or> M = (a, b, cnj b, - cnj a)", "by (auto simp add: mat_adj_def mat_cnj_def)"], ["proof (state)\nthis:\n  M = (a, b, - cnj b, cnj a) \\<or> M = (a, b, cnj b, - cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "moreover"], ["proof (state)\nthis:\n  M = (a, b, - cnj b, cnj a) \\<or> M = (a, b, cnj b, - cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "have \"Re (- (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2) < 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Re (- (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2) < 1", "by (smt cmod_square complex_norm_square minus_complex.simps(1) of_real_power realpow_square_minus_le uminus_complex.simps(1))"], ["proof (state)\nthis:\n  Re (- (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2) < 1\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "hence \"- (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2 \\<noteq> 1\""], ["proof (prove)\nusing this:\n  Re (- (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2) < 1\n\ngoal (1 subgoal):\n 1. - (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2 \\<noteq> 1", "by force"], ["proof (state)\nthis:\n  - (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2 \\<noteq> 1\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "hence \"M \\<noteq> (a, b, cnj b, -cnj a)\""], ["proof (prove)\nusing this:\n  - (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2 \\<noteq> 1\n\ngoal (1 subgoal):\n 1. M \\<noteq> (a, b, cnj b, - cnj a)", "using \\<open>mat_det M = 1\\<close> complex_mult_cnj_cmod[of a] complex_mult_cnj_cmod[of b]"], ["proof (prove)\nusing this:\n  - (cor (cmod a))\\<^sup>2 - (cor (cmod b))\\<^sup>2 \\<noteq> 1\n  mat_det M = 1\n  a * cnj a = cor ((cmod a)\\<^sup>2)\n  b * cnj b = cor ((cmod b)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. M \\<noteq> (a, b, cnj b, - cnj a)", "by auto"], ["proof (state)\nthis:\n  M \\<noteq> (a, b, cnj b, - cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "ultimately"], ["proof (chain)\npicking this:\n  M = (a, b, - cnj b, cnj a) \\<or> M = (a, b, cnj b, - cnj a)\n  M \\<noteq> (a, b, cnj b, - cnj a)", "show ?thesis"], ["proof (prove)\nusing this:\n  M = (a, b, - cnj b, cnj a) \\<or> M = (a, b, cnj b, - cnj a)\n  M \\<noteq> (a, b, cnj b, - cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b. M = (a, b, - cnj b, cnj a)", "by auto"], ["proof (state)\nthis:\n  \\<exists>a b. M = (a, b, - cnj b, cnj a)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>A characterization of all generalized unitary matrices\\<close>"], ["", "lemma unitary_gen_iff:\n  shows \"unitary_gen M \\<longleftrightarrow> \n         (\\<exists> a b k. k \\<noteq> 0 \\<and> mat_det (a, b, -cnj b, cnj a) \\<noteq> 0 \\<and>\n                           M = k *\\<^sub>s\\<^sub>m (a, b, -cnj b, cnj a))\" (is \"?lhs = ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary_gen M =\n    (\\<exists>a b k.\n        k \\<noteq> 0 \\<and>\n        mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n        M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "assume ?lhs"], ["proof (state)\nthis:\n  unitary_gen M\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "obtain d where *: \"d*d = mat_det M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>d. d * d = mat_det M \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using ex_complex_sqrt"], ["proof (prove)\nusing this:\n  \\<exists>s. s * s = ?z\n\ngoal (1 subgoal):\n 1. (\\<And>d. d * d = mat_det M \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  d * d = mat_det M\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "hence \"d \\<noteq> 0\""], ["proof (prove)\nusing this:\n  d * d = mat_det M\n\ngoal (1 subgoal):\n 1. d \\<noteq> 0", "using unitary_gen_regular[OF \\<open>unitary_gen M\\<close>]"], ["proof (prove)\nusing this:\n  d * d = mat_det M\n  mat_det M \\<noteq> 0\n\ngoal (1 subgoal):\n 1. d \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  d \\<noteq> 0\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "from \\<open>unitary_gen M\\<close>"], ["proof (chain)\npicking this:\n  unitary_gen M", "obtain k where \"k \\<noteq> 0\" \"mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\""], ["proof (prove)\nusing this:\n  unitary_gen M\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding unitary_gen_def"], ["proof (prove)\nusing this:\n  \\<exists>k.\n     k \\<noteq> 0 \\<and>\n     mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>k \\<noteq> 0;\n         mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "hence \"mat_adj ((1/d)*\\<^sub>s\\<^sub>mM) *\\<^sub>m\\<^sub>m ((1/d)*\\<^sub>s\\<^sub>mM) = (k / (d*cnj d)) *\\<^sub>s\\<^sub>m eye\""], ["proof (prove)\nusing this:\n  k \\<noteq> 0\n  mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye\n\ngoal (1 subgoal):\n 1. mat_adj ((1 / d) *\\<^sub>s\\<^sub>m M) *\\<^sub>m\\<^sub>m\n    ((1 / d) *\\<^sub>s\\<^sub>m M) =\n    (k / (d * cnj d)) *\\<^sub>s\\<^sub>m eye", "by simp"], ["proof (state)\nthis:\n  mat_adj ((1 / d) *\\<^sub>s\\<^sub>m M) *\\<^sub>m\\<^sub>m\n  ((1 / d) *\\<^sub>s\\<^sub>m M) =\n  (k / (d * cnj d)) *\\<^sub>s\\<^sub>m eye\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "obtain a b where \"(a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>a b.\n        (a, b, - cnj b, cnj a) =\n        (1 / d) *\\<^sub>s\\<^sub>m M \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using unitary_gen_special[of \"(1 / d) *\\<^sub>s\\<^sub>m M\"]  \\<open>unitary_gen M\\<close> *  unitary_gen_regular[of M] \\<open>d \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>unitary_gen ((1 / d) *\\<^sub>s\\<^sub>m M);\n   mat_det ((1 / d) *\\<^sub>s\\<^sub>m M) = 1\\<rbrakk>\n  \\<Longrightarrow> \\<exists>a b.\n                       (1 / d) *\\<^sub>s\\<^sub>m M = (a, b, - cnj b, cnj a)\n  unitary_gen M\n  d * d = mat_det M\n  unitary_gen M \\<Longrightarrow> mat_det M \\<noteq> 0\n  d \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<And>a b.\n        (a, b, - cnj b, cnj a) =\n        (1 / d) *\\<^sub>s\\<^sub>m M \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "moreover"], ["proof (state)\nthis:\n  (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "hence \"mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\""], ["proof (prove)\nusing this:\n  (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M\n\ngoal (1 subgoal):\n 1. mat_det (a, b, - cnj b, cnj a) \\<noteq> 0", "using unitary_gen_regular[OF \\<open>unitary_gen M\\<close>] \\<open>d \\<noteq> 0\\<close>"], ["proof (prove)\nusing this:\n  (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M\n  mat_det M \\<noteq> 0\n  d \\<noteq> 0\n\ngoal (1 subgoal):\n 1. mat_det (a, b, - cnj b, cnj a) \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\n\ngoal (2 subgoals):\n 1. unitary_gen M \\<Longrightarrow>\n    \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "ultimately"], ["proof (chain)\npicking this:\n  (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0", "show ?rhs"], ["proof (prove)\nusing this:\n  (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)", "apply (rule_tac x=\"a\" in exI, rule_tac x=\"b\" in exI, rule_tac x=\"d\" in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0;\n     (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0;\n     (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> d \\<noteq> 0 \\<and>\n                      mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n                      M = d *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)", "using mult_sm_inv_l[of \"1/d\" M]"], ["proof (prove)\nusing this:\n  \\<lbrakk>1 / d \\<noteq> 0; (1 / d) *\\<^sub>s\\<^sub>m M = ?B\\<rbrakk>\n  \\<Longrightarrow> M = (1 / (1 / d)) *\\<^sub>s\\<^sub>m ?B\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0;\n     (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0;\n     (a, b, - cnj b, cnj a) = (1 / d) *\\<^sub>s\\<^sub>m M;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> d \\<noteq> 0 \\<and>\n                      mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n                      M = d *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)", "by (auto simp add: field_simps)"], ["proof (state)\nthis:\n  \\<exists>a b k.\n     k \\<noteq> 0 \\<and>\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "assume ?rhs"], ["proof (state)\nthis:\n  \\<exists>a b k.\n     k \\<noteq> 0 \\<and>\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "then"], ["proof (chain)\npicking this:\n  \\<exists>a b k.\n     k \\<noteq> 0 \\<and>\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)", "obtain a b k where \"k \\<noteq> 0 \\<and> mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and> M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\""], ["proof (prove)\nusing this:\n  \\<exists>a b k.\n     k \\<noteq> 0 \\<and>\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. (\\<And>k a b.\n        k \\<noteq> 0 \\<and>\n        mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n        M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k \\<noteq> 0 \\<and>\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       k \\<noteq> 0 \\<and>\n       mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary_gen M", "thus ?lhs"], ["proof (prove)\nusing this:\n  k \\<noteq> 0 \\<and>\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. unitary_gen M", "unfolding unitary_gen_def"], ["proof (prove)\nusing this:\n  k \\<noteq> 0 \\<and>\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>k.\n       k \\<noteq> 0 \\<and>\n       mat_adj M *\\<^sub>m\\<^sub>m M = k *\\<^sub>s\\<^sub>m eye", "apply (auto simp add: mat_adj_def mat_cnj_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<noteq> 0; a * cnj a + b * cnj b \\<noteq> 0;\n     M = (k * a, k * b, - (k * cnj b), k * cnj a);\n     cnj k * cnj a * (k * a) + cnj k * b * (k * cnj b) = 0\\<rbrakk>\n    \\<Longrightarrow> False", "using mult_eq_0_iff[of \"cnj k * k\" \"cnj a * a + cnj b * b\"]"], ["proof (prove)\nusing this:\n  (cnj k * k * (cnj a * a + cnj b * b) = 0) =\n  (cnj k * k = 0 \\<or> cnj a * a + cnj b * b = 0)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<noteq> 0; a * cnj a + b * cnj b \\<noteq> 0;\n     M = (k * a, k * b, - (k * cnj b), k * cnj a);\n     cnj k * cnj a * (k * a) + cnj k * b * (k * cnj b) = 0\\<rbrakk>\n    \\<Longrightarrow> False", "by (auto simp add: field_simps)"], ["proof (state)\nthis:\n  unitary_gen M\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>A characterization of unitary matrices\\<close>"], ["", "lemma unitary_iff:\n  shows \"unitary M \\<longleftrightarrow>\n         (\\<exists> a b k. (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and> \n                           (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n                           M = k *\\<^sub>s\\<^sub>m (a, b, -cnj b, cnj a))\" (is \"?lhs = ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary M =\n    (\\<exists>a b k.\n        (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n        (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n        M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. unitary M \\<Longrightarrow>\n    \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "assume ?lhs"], ["proof (state)\nthis:\n  unitary M\n\ngoal (2 subgoals):\n 1. unitary M \\<Longrightarrow>\n    \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "obtain k a b where *: \"M = k *\\<^sub>s\\<^sub>m (a, b, -cnj b, cnj a)\" \"k \\<noteq> 0\" \"mat_det (a, b, -cnj b, cnj a) \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>k a b.\n        \\<lbrakk>M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a);\n         k \\<noteq> 0; mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using unitary_gen_iff  unitary_unitary_gen[OF \\<open>unitary M\\<close>]"], ["proof (prove)\nusing this:\n  unitary_gen ?M =\n  (\\<exists>a b k.\n      k \\<noteq> 0 \\<and>\n      mat_det (a, b, - cnj b, cnj a) \\<noteq> 0 \\<and>\n      ?M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a))\n  unitary_gen M\n\ngoal (1 subgoal):\n 1. (\\<And>k a b.\n        \\<lbrakk>M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a);\n         k \\<noteq> 0; mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n  k \\<noteq> 0\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\n\ngoal (2 subgoals):\n 1. unitary M \\<Longrightarrow>\n    \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "have md: \"mat_det (a, b, -cnj b, cnj a) = cor ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mat_det (a, b, - cnj b, cnj a) =\n    cor ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)", "by (auto simp add: complex_mult_cnj_cmod)"], ["proof (state)\nthis:\n  mat_det (a, b, - cnj b, cnj a) = cor ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)\n\ngoal (2 subgoals):\n 1. unitary M \\<Longrightarrow>\n    \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "have \"k * cnj k * mat_det (a, b, -cnj b, cnj a) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * cnj k * mat_det (a, b, - cnj b, cnj a) = 1", "using \\<open>unitary M\\<close> *"], ["proof (prove)\nusing this:\n  unitary M\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n  k \\<noteq> 0\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k * cnj k * mat_det (a, b, - cnj b, cnj a) = 1", "unfolding unitary_def"], ["proof (prove)\nusing this:\n  mat_adj M *\\<^sub>m\\<^sub>m M = eye\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n  k \\<noteq> 0\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k * cnj k * mat_det (a, b, - cnj b, cnj a) = 1", "by (auto simp add: mat_adj_def mat_cnj_def field_simps)"], ["proof (state)\nthis:\n  k * cnj k * mat_det (a, b, - cnj b, cnj a) = 1\n\ngoal (2 subgoals):\n 1. unitary M \\<Longrightarrow>\n    \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "hence \"(cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1\""], ["proof (prove)\nusing this:\n  k * cnj k * mat_det (a, b, - cnj b, cnj a) = 1\n\ngoal (1 subgoal):\n 1. (cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1", "by (subst (asm) complex_mult_cnj_cmod, subst (asm) md, subst (asm) cor_mult[symmetric]) (metis of_real_1 of_real_eq_iff)"], ["proof (state)\nthis:\n  (cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1\n\ngoal (2 subgoals):\n 1. unitary M \\<Longrightarrow>\n    \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n 2. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "thus ?rhs"], ["proof (prove)\nusing this:\n  (cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)", "using * mat_eye_l"], ["proof (prove)\nusing this:\n  (cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n  k \\<noteq> 0\n  mat_det (a, b, - cnj b, cnj a) \\<noteq> 0\n  eye *\\<^sub>m\\<^sub>m ?A = ?A\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)", "apply (rule_tac x=\"a\" in exI, rule_tac x=\"b\" in exI, rule_tac x=\"k\" in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1;\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a); k \\<noteq> 0;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0;\n     \\<And>A. eye *\\<^sub>m\\<^sub>m A = A;\n     (cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1;\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a); k \\<noteq> 0;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0;\n     \\<And>A. eye *\\<^sub>m\\<^sub>m A = A;\n     (cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1;\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a); k \\<noteq> 0;\n     mat_det (a, b, - cnj b, cnj a) \\<noteq> 0;\n     \\<And>A. eye *\\<^sub>m\\<^sub>m A = A\\<rbrakk>\n    \\<Longrightarrow> (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n                      (cmod k)\\<^sup>2 =\n                      1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n                      M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)", "apply (auto simp add: complex_mult_cnj_cmod)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(cor (cmod a))\\<^sup>2 + (cor (cmod b))\\<^sup>2 \\<noteq> 0;\n     (cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1;\n     M = (k * a, k * b, - (k * cnj b), k * cnj a); k \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> (cmod k)\\<^sup>2 =\n                      1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)", "by (metis \\<open>(cmod k)\\<^sup>2 * ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) = 1\\<close> mult_eq_0_iff nonzero_eq_divide_eq zero_neq_one)"], ["proof (state)\nthis:\n  \\<exists>a b k.\n     (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n     (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "assume ?rhs"], ["proof (state)\nthis:\n  \\<exists>a b k.\n     (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n     (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "then"], ["proof (chain)\npicking this:\n  \\<exists>a b k.\n     (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n     (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)", "obtain a b k where  *: \"(cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0\" \"(cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)\" \"M = k *\\<^sub>s\\<^sub>m (a, b, -cnj b, cnj a)\""], ["proof (prove)\nusing this:\n  \\<exists>a b k.\n     (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n     (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n     M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. (\\<And>a b k.\n        \\<lbrakk>(cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0;\n         (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2);\n         M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0\n  (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "have \"(k * cnj k) * (a * cnj a) + (k * cnj k) * (b * cnj b) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * cnj k * (a * cnj a) + k * cnj k * (b * cnj b) = 1", "apply (subst complex_mult_cnj_cmod)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. cor ((cmod k)\\<^sup>2) * cor ((cmod a)\\<^sup>2) +\n    cor ((cmod k)\\<^sup>2) * cor ((cmod b)\\<^sup>2) =\n    1", "using *(1-2)"], ["proof (prove)\nusing this:\n  (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0\n  (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)\n\ngoal (1 subgoal):\n 1. cor ((cmod k)\\<^sup>2) * cor ((cmod a)\\<^sup>2) +\n    cor ((cmod k)\\<^sup>2) * cor ((cmod b)\\<^sup>2) =\n    1", "by (metis (no_types, lifting) distrib_left nonzero_eq_divide_eq of_real_1 of_real_add of_real_divide of_real_eq_0_iff)"], ["proof (state)\nthis:\n  k * cnj k * (a * cnj a) + k * cnj k * (b * cnj b) = 1\n\ngoal (1 subgoal):\n 1. \\<exists>a b k.\n       (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0 \\<and>\n       (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2) \\<and>\n       M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a) \\<Longrightarrow>\n    unitary M", "thus ?lhs"], ["proof (prove)\nusing this:\n  k * cnj k * (a * cnj a) + k * cnj k * (b * cnj b) = 1\n\ngoal (1 subgoal):\n 1. unitary M", "using *"], ["proof (prove)\nusing this:\n  k * cnj k * (a * cnj a) + k * cnj k * (b * cnj b) = 1\n  (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0\n  (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. unitary M", "unfolding unitary_def"], ["proof (prove)\nusing this:\n  k * cnj k * (a * cnj a) + k * cnj k * (b * cnj b) = 1\n  (cmod a)\\<^sup>2 + (cmod b)\\<^sup>2 \\<noteq> 0\n  (cmod k)\\<^sup>2 = 1 / ((cmod a)\\<^sup>2 + (cmod b)\\<^sup>2)\n  M = k *\\<^sub>s\\<^sub>m (a, b, - cnj b, cnj a)\n\ngoal (1 subgoal):\n 1. mat_adj M *\\<^sub>m\\<^sub>m M = eye", "by (simp add: mat_adj_def mat_cnj_def field_simps)"], ["proof (state)\nthis:\n  unitary M\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}