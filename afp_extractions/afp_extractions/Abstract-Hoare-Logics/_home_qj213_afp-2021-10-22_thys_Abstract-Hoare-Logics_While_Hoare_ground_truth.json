{"file_name": "/home/qj213/afp-2021-10-22/thys/Abstract-Hoare-Logics/While/Hoare.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Abstract-Hoare-Logics", "problem_names": ["theorem hoare_sound: \"\\<turnstile> {P}c{Q}  \\<Longrightarrow>  \\<Turnstile> {P}c{Q}\"", "lemma [simp]: \"wp (Do f) Q = (\\<lambda>s. \\<forall>t \\<in> f s. Q(t))\"", "lemma [simp]: \"wp (c\\<^sub>1;c\\<^sub>2) R = wp c\\<^sub>1 (wp c\\<^sub>2 R)\"", "lemma [simp]:\n \"wp (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2) Q = (\\<lambda>s. wp (if b s then c\\<^sub>1 else c\\<^sub>2) Q s)\"", "lemma wp_while:\n \"wp (WHILE b DO c) Q =\n           (\\<lambda>s. if b s then wp (c;WHILE b DO c) Q s else Q s)\"", "lemma [simp]:\n \"wp (LOCAL f;c;g) Q = (\\<lambda>s. wp c (Q o (g s)) (f s))\"", "lemma strengthen_pre: \"\\<lbrakk> \\<forall>s. P' s \\<longrightarrow> P s; \\<turnstile> {P}c{Q}  \\<rbrakk> \\<Longrightarrow> \\<turnstile> {P'}c{Q}\"", "lemma weaken_post: \"\\<lbrakk> \\<turnstile> {P}c{Q}; \\<forall>s. Q s \\<longrightarrow> Q' s  \\<rbrakk> \\<Longrightarrow> \\<turnstile> {P}c{Q'}\"", "lemma wp_is_pre[rule_format]: \"\\<turnstile> {wp c Q} c {Q}\"", "theorem hoare_relative_complete: \"\\<Turnstile> {P}c{Q}  \\<Longrightarrow>  \\<turnstile> {P}c{Q}\""], "translations": [["", "theorem hoare_sound: \"\\<turnstile> {P}c{Q}  \\<Longrightarrow>  \\<Turnstile> {P}c{Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile> {P} c {Q} \\<Longrightarrow> \\<Turnstile> {P} c {Q}", "apply(unfold hoare_valid_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile> {P} c {Q} \\<Longrightarrow>\n    \\<forall>s t.\n       s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply(erule hoare.induct)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>f P.\n       \\<forall>s t.\n          s -Do f\\<rightarrow> t \\<longrightarrow>\n          (\\<forall>t\\<in>f s. P t) \\<longrightarrow> P t\n 2. \\<And>P c1 Q c2 R.\n       \\<lbrakk>\\<turnstile> {P} c1 {Q};\n        \\<forall>s t.\n           s -c1\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<turnstile> {Q} c2 {R};\n        \\<forall>s t.\n           s -c2\\<rightarrow> t \\<longrightarrow>\n           Q s \\<longrightarrow> R t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c1; c2\\<rightarrow> t \\<longrightarrow>\n                            P s \\<longrightarrow> R t\n 3. \\<And>P b c1 Q c2.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c1 {Q};\n        \\<forall>s t.\n           s -c1\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> Q t;\n        \\<turnstile> {\\<lambda>s. P s \\<and> \\<not> b s} c2 {Q};\n        \\<forall>s t.\n           s -c2\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> \\<not> b s \\<longrightarrow> Q t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -IF b THEN c1 ELSE c2\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t\n 4. \\<And>P b c.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -WHILE b DO c\\<rightarrow> t \\<longrightarrow>\n                            P s \\<longrightarrow> P t \\<and> \\<not> b t\n 5. \\<And>P' P c Q Q'.\n       \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n        \\<turnstile> {P} c {Q};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c\\<rightarrow> t \\<longrightarrow>\n                            P' s \\<longrightarrow> Q' t\n 6. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply blast"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>P c1 Q c2 R.\n       \\<lbrakk>\\<turnstile> {P} c1 {Q};\n        \\<forall>s t.\n           s -c1\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<turnstile> {Q} c2 {R};\n        \\<forall>s t.\n           s -c2\\<rightarrow> t \\<longrightarrow>\n           Q s \\<longrightarrow> R t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c1; c2\\<rightarrow> t \\<longrightarrow>\n                            P s \\<longrightarrow> R t\n 2. \\<And>P b c1 Q c2.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c1 {Q};\n        \\<forall>s t.\n           s -c1\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> Q t;\n        \\<turnstile> {\\<lambda>s. P s \\<and> \\<not> b s} c2 {Q};\n        \\<forall>s t.\n           s -c2\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> \\<not> b s \\<longrightarrow> Q t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -IF b THEN c1 ELSE c2\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t\n 3. \\<And>P b c.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -WHILE b DO c\\<rightarrow> t \\<longrightarrow>\n                            P s \\<longrightarrow> P t \\<and> \\<not> b t\n 4. \\<And>P' P c Q Q'.\n       \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n        \\<turnstile> {P} c {Q};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c\\<rightarrow> t \\<longrightarrow>\n                            P' s \\<longrightarrow> Q' t\n 5. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply blast"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>P b c1 Q c2.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c1 {Q};\n        \\<forall>s t.\n           s -c1\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> Q t;\n        \\<turnstile> {\\<lambda>s. P s \\<and> \\<not> b s} c2 {Q};\n        \\<forall>s t.\n           s -c2\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> \\<not> b s \\<longrightarrow> Q t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -IF b THEN c1 ELSE c2\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t\n 2. \\<And>P b c.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -WHILE b DO c\\<rightarrow> t \\<longrightarrow>\n                            P s \\<longrightarrow> P t \\<and> \\<not> b t\n 3. \\<And>P' P c Q Q'.\n       \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n        \\<turnstile> {P} c {Q};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c\\<rightarrow> t \\<longrightarrow>\n                            P' s \\<longrightarrow> Q' t\n 4. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply clarsimp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>P b c.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -WHILE b DO c\\<rightarrow> t \\<longrightarrow>\n                            P s \\<longrightarrow> P t \\<and> \\<not> b t\n 2. \\<And>P' P c Q Q'.\n       \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n        \\<turnstile> {P} c {Q};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c\\<rightarrow> t \\<longrightarrow>\n                            P' s \\<longrightarrow> Q' t\n 3. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply clarify"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>P b c s t.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t;\n        s -WHILE b DO c\\<rightarrow> t; P s\\<rbrakk>\n       \\<Longrightarrow> P t \\<and> \\<not> b t\n 2. \\<And>P' P c Q Q'.\n       \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n        \\<turnstile> {P} c {Q};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c\\<rightarrow> t \\<longrightarrow>\n                            P' s \\<longrightarrow> Q' t\n 3. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply(drule while_rule)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>P b c s t.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t;\n        P s\\<rbrakk>\n       \\<Longrightarrow> ?P55 P b c s t s\n 2. \\<And>P b c s t.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t;\n        P s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>sa s'.\n                            ?P55 P b c s t sa \\<and>\n                            b sa \\<and> sa -c\\<rightarrow>\n                            s' \\<longrightarrow>\n                            ?P55 P b c s t s'\n 3. \\<And>P b c s t.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t;\n        P s; ?P55 P b c s t t \\<and> \\<not> b t\\<rbrakk>\n       \\<Longrightarrow> P t \\<and> \\<not> b t\n 4. \\<And>P' P c Q Q'.\n       \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n        \\<turnstile> {P} c {Q};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c\\<rightarrow> t \\<longrightarrow>\n                            P' s \\<longrightarrow> Q' t\n 5. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "prefer 3"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>P b c s t.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t;\n        P s; ?P55 P b c s t t \\<and> \\<not> b t\\<rbrakk>\n       \\<Longrightarrow> P t \\<and> \\<not> b t\n 2. \\<And>P b c s t.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t;\n        P s\\<rbrakk>\n       \\<Longrightarrow> ?P55 P b c s t s\n 3. \\<And>P b c s t.\n       \\<lbrakk>\\<turnstile> {\\<lambda>s. P s \\<and> b s} c {P};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow>\n           P s \\<and> b s \\<longrightarrow> P t;\n        P s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>sa s'.\n                            ?P55 P b c s t sa \\<and>\n                            b sa \\<and> sa -c\\<rightarrow>\n                            s' \\<longrightarrow>\n                            ?P55 P b c s t s'\n 4. \\<And>P' P c Q Q'.\n       \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n        \\<turnstile> {P} c {Q};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c\\<rightarrow> t \\<longrightarrow>\n                            P' s \\<longrightarrow> Q' t\n 5. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply (assumption, assumption, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>P' P c Q Q'.\n       \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n        \\<turnstile> {P} c {Q};\n        \\<forall>s t.\n           s -c\\<rightarrow> t \\<longrightarrow> P s \\<longrightarrow> Q t;\n        \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -c\\<rightarrow> t \\<longrightarrow>\n                            P' s \\<longrightarrow> Q' t\n 2. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s t.\n                            s -LOCAL f; c; g\\<rightarrow>\n                            t \\<longrightarrow> P s \\<longrightarrow> Q t", "apply clarify"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        \\<forall>s.\n           \\<turnstile> {P' s} c {Q \\<circ> g s} \\<and>\n           (\\<forall>sa t.\n               sa -c\\<rightarrow> t \\<longrightarrow>\n               P' s sa \\<longrightarrow> (Q \\<circ> g s) t);\n        f s -c\\<rightarrow> ta; P s\\<rbrakk>\n       \\<Longrightarrow> Q (g s ta)", "apply(erule allE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' (?s104 P P' f c Q g s t ta)} c\n                     {Q \\<circ> g (?s104 P P' f c Q g s t ta)} \\<and>\n        (\\<forall>sa tb.\n            sa -c\\<rightarrow> tb \\<longrightarrow>\n            P' (?s104 P P' f c Q g s t ta) sa \\<longrightarrow>\n            (Q \\<circ> g (?s104 P P' f c Q g s t ta)) tb)\\<rbrakk>\n       \\<Longrightarrow> Q (g s ta)", "apply clarify"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' (?s104 P P' f c Q g s t ta)} c\n                     {Q \\<circ> g (?s104 P P' f c Q g s t ta)};\n        \\<forall>sa tb.\n           sa -c\\<rightarrow> tb \\<longrightarrow>\n           P' (?s104 P P' f c Q g s t ta) sa \\<longrightarrow>\n           (Q \\<circ> g (?s104 P P' f c Q g s t ta)) tb\\<rbrakk>\n       \\<Longrightarrow> Q (g s ta)", "apply(erule allE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' (?s104 P P' f c Q g s t ta)} c\n                     {Q \\<circ> g (?s104 P P' f c Q g s t ta)};\n        \\<forall>tb.\n           ?s107 P P' f c Q g s t ta -c\\<rightarrow> tb \\<longrightarrow>\n           P' (?s104 P P' f c Q g s t ta)\n            (?s107 P P' f c Q g s t ta) \\<longrightarrow>\n           (Q \\<circ> g (?s104 P P' f c Q g s t ta)) tb\\<rbrakk>\n       \\<Longrightarrow> Q (g s ta)", "apply(erule allE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' (?s104 P P' f c Q g s t ta)} c\n                     {Q \\<circ> g (?s104 P P' f c Q g s t ta)};\n        ?s107 P P' f c Q g s t ta -c\\<rightarrow>\n        ?t109 P P' f c Q g s t ta \\<longrightarrow>\n        P' (?s104 P P' f c Q g s t ta)\n         (?s107 P P' f c Q g s t ta) \\<longrightarrow>\n        (Q \\<circ> g (?s104 P P' f c Q g s t ta))\n         (?t109 P P' f c Q g s t ta)\\<rbrakk>\n       \\<Longrightarrow> Q (g s ta)", "apply(erule impE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' (?s104 P P' f c Q g s t ta)} c\n                     {Q \\<circ> g (?s104 P P' f c Q g s t ta)}\\<rbrakk>\n       \\<Longrightarrow> ?s107 P P' f c Q g s t ta -c\\<rightarrow>\n                         ?t109 P P' f c Q g s t ta\n 2. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' (?s104 P P' f c Q g s t ta)} c\n                     {Q \\<circ> g (?s104 P P' f c Q g s t ta)};\n        P' (?s104 P P' f c Q g s t ta)\n         (?s107 P P' f c Q g s t ta) \\<longrightarrow>\n        (Q \\<circ> g (?s104 P P' f c Q g s t ta))\n         (?t109 P P' f c Q g s t ta)\\<rbrakk>\n       \\<Longrightarrow> Q (g s ta)", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' (?s104 P P' f c Q g s t ta)} c\n                     {Q \\<circ> g (?s104 P P' f c Q g s t ta)};\n        P' (?s104 P P' f c Q g s t ta) (f s) \\<longrightarrow>\n        (Q \\<circ> g (?s104 P P' f c Q g s t ta)) ta\\<rbrakk>\n       \\<Longrightarrow> Q (g s ta)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' (?s104 P P' f c Q g s t ta)} c\n                     {Q \\<circ> g (?s104 P P' f c Q g s t ta)};\n        P' (?s104 P P' f c Q g s t ta) (f s) \\<longrightarrow>\n        Q (g (?s104 P P' f c Q g s t ta) ta)\\<rbrakk>\n       \\<Longrightarrow> Q (g s ta)", "apply(erule mp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P P' f c Q g s t ta.\n       \\<lbrakk>\\<And>s. P s \\<Longrightarrow> P' s (f s);\n        f s -c\\<rightarrow> ta; P s;\n        \\<turnstile> {P' s} c {Q \\<circ> g s}\\<rbrakk>\n       \\<Longrightarrow> P' s (f s)", "apply(simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>\nCompleteness is not quite as straightforward, but still easy. The\nproof is best explained in terms of the \\emph{weakest precondition}:\\<close>"], ["", "definition\n wp :: \"com \\<Rightarrow> assn \\<Rightarrow> assn\" where\n \"wp c Q = (\\<lambda>s. \\<forall>t. s -c\\<rightarrow> t \\<longrightarrow> Q t)\""], ["", "text\\<open>\\noindent Dijkstra calls this the weakest \\emph{liberal}\nprecondition to emphasize that it corresponds to partial\ncorrectness. We use ``weakest precondition'' all the time and let the\ncontext determine if we talk about partial or total correctness ---\nthe latter is introduced further below.\n\nThe following lemmas about @{term wp} are easily derived:\n\\<close>"], ["", "lemma [simp]: \"wp (Do f) Q = (\\<lambda>s. \\<forall>t \\<in> f s. Q(t))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (Do f) Q = (\\<lambda>s. \\<forall>t\\<in>f s. Q t)", "apply(unfold wp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>s. \\<forall>t. s -Do f\\<rightarrow> t \\<longrightarrow> Q t) =\n    (\\<lambda>s. \\<forall>t\\<in>f s. Q t)", "apply(rule ext)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>t. s -Do f\\<rightarrow> t \\<longrightarrow> Q t) =\n       (\\<forall>t\\<in>f s. Q t)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma [simp]: \"wp (c\\<^sub>1;c\\<^sub>2) R = wp c\\<^sub>1 (wp c\\<^sub>2 R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (c\\<^sub>1; c\\<^sub>2) R = wp c\\<^sub>1 (wp c\\<^sub>2 R)", "apply(unfold wp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>s.\n        \\<forall>t.\n           s -c\\<^sub>1; c\\<^sub>2\\<rightarrow> t \\<longrightarrow> R t) =\n    (\\<lambda>s.\n        \\<forall>t.\n           s -c\\<^sub>1\\<rightarrow> t \\<longrightarrow>\n           (\\<forall>ta.\n               t -c\\<^sub>2\\<rightarrow> ta \\<longrightarrow> R ta))", "apply(rule ext)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>t.\n           s -c\\<^sub>1; c\\<^sub>2\\<rightarrow> t \\<longrightarrow> R t) =\n       (\\<forall>t.\n           s -c\\<^sub>1\\<rightarrow> t \\<longrightarrow>\n           (\\<forall>ta.\n               t -c\\<^sub>2\\<rightarrow> ta \\<longrightarrow> R ta))", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma [simp]:\n \"wp (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2) Q = (\\<lambda>s. wp (if b s then c\\<^sub>1 else c\\<^sub>2) Q s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2) Q =\n    (\\<lambda>s. wp (if b s then c\\<^sub>1 else c\\<^sub>2) Q s)", "apply(unfold wp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>s.\n        \\<forall>t.\n           s -IF b THEN c\\<^sub>1 ELSE c\\<^sub>2\\<rightarrow>\n           t \\<longrightarrow> Q t) =\n    (\\<lambda>s.\n        \\<forall>t.\n           s -if b s then c\\<^sub>1 else c\\<^sub>2\\<rightarrow>\n           t \\<longrightarrow> Q t)", "apply(rule ext)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>t.\n           s -IF b THEN c\\<^sub>1 ELSE c\\<^sub>2\\<rightarrow>\n           t \\<longrightarrow> Q t) =\n       (\\<forall>t.\n           s -if b s then c\\<^sub>1 else c\\<^sub>2\\<rightarrow>\n           t \\<longrightarrow> Q t)", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma wp_while:\n \"wp (WHILE b DO c) Q =\n           (\\<lambda>s. if b s then wp (c;WHILE b DO c) Q s else Q s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (WHILE b DO c) Q =\n    (\\<lambda>s. if b s then wp (c; WHILE b DO c) Q s else Q s)", "apply(rule ext)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       wp (WHILE b DO c) Q s =\n       (if b s then wp (c; WHILE b DO c) Q s else Q s)", "apply(unfold wp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>t. s -WHILE b DO c\\<rightarrow> t \\<longrightarrow> Q t) =\n       (if b s\n        then \\<forall>t.\n                s -c; WHILE b DO c\\<rightarrow> t \\<longrightarrow> Q t\n        else Q s)", "apply auto"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>s t ta.\n       \\<lbrakk>b s;\n        \\<forall>t. s -WHILE b DO c\\<rightarrow> t \\<longrightarrow> Q t;\n        s -c\\<rightarrow> ta; ta -WHILE b DO c\\<rightarrow> t\\<rbrakk>\n       \\<Longrightarrow> Q t\n 2. \\<And>s t.\n       \\<lbrakk>b s;\n        \\<forall>t.\n           (\\<exists>ta.\n               s -c\\<rightarrow> ta \\<and> ta -WHILE b DO c\\<rightarrow>\n               t) \\<longrightarrow>\n           Q t;\n        s -WHILE b DO c\\<rightarrow> t\\<rbrakk>\n       \\<Longrightarrow> Q t\n 3. \\<And>s.\n       \\<lbrakk>\\<not> b s;\n        \\<forall>t.\n           s -WHILE b DO c\\<rightarrow> t \\<longrightarrow> Q t\\<rbrakk>\n       \\<Longrightarrow> Q s\n 4. \\<And>s t.\n       \\<lbrakk>\\<not> b s; Q s; s -WHILE b DO c\\<rightarrow> t\\<rbrakk>\n       \\<Longrightarrow> Q t", "apply(blast intro:exec.intros)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>s t.\n       \\<lbrakk>b s;\n        \\<forall>t.\n           (\\<exists>ta.\n               s -c\\<rightarrow> ta \\<and> ta -WHILE b DO c\\<rightarrow>\n               t) \\<longrightarrow>\n           Q t;\n        s -WHILE b DO c\\<rightarrow> t\\<rbrakk>\n       \\<Longrightarrow> Q t\n 2. \\<And>s.\n       \\<lbrakk>\\<not> b s;\n        \\<forall>t.\n           s -WHILE b DO c\\<rightarrow> t \\<longrightarrow> Q t\\<rbrakk>\n       \\<Longrightarrow> Q s\n 3. \\<And>s t.\n       \\<lbrakk>\\<not> b s; Q s; s -WHILE b DO c\\<rightarrow> t\\<rbrakk>\n       \\<Longrightarrow> Q t", "apply(simp add:unfold_while)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s.\n       \\<lbrakk>\\<not> b s;\n        \\<forall>t.\n           s -WHILE b DO c\\<rightarrow> t \\<longrightarrow> Q t\\<rbrakk>\n       \\<Longrightarrow> Q s\n 2. \\<And>s t.\n       \\<lbrakk>\\<not> b s; Q s; s -WHILE b DO c\\<rightarrow> t\\<rbrakk>\n       \\<Longrightarrow> Q t", "apply(blast intro:exec.intros)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>\\<not> b s; Q s; s -WHILE b DO c\\<rightarrow> t\\<rbrakk>\n       \\<Longrightarrow> Q t", "apply(simp add:unfold_while)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma [simp]:\n \"wp (LOCAL f;c;g) Q = (\\<lambda>s. wp c (Q o (g s)) (f s))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (LOCAL f; c; g) Q = (\\<lambda>s. wp c (Q \\<circ> g s) (f s))", "apply(unfold wp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>s.\n        \\<forall>t. s -LOCAL f; c; g\\<rightarrow> t \\<longrightarrow> Q t) =\n    (\\<lambda>s.\n        \\<forall>t.\n           f s -c\\<rightarrow> t \\<longrightarrow> (Q \\<circ> g s) t)", "apply(rule ext)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>t. s -LOCAL f; c; g\\<rightarrow> t \\<longrightarrow> Q t) =\n       (\\<forall>t.\n           f s -c\\<rightarrow> t \\<longrightarrow> (Q \\<circ> g s) t)", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma strengthen_pre: \"\\<lbrakk> \\<forall>s. P' s \\<longrightarrow> P s; \\<turnstile> {P}c{Q}  \\<rbrakk> \\<Longrightarrow> \\<turnstile> {P'}c{Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>s. P' s \\<longrightarrow> P s;\n     \\<turnstile> {P} c {Q}\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile> {P'} c {Q}", "by(erule hoare.Conseq, assumption, blast)"], ["", "lemma weaken_post: \"\\<lbrakk> \\<turnstile> {P}c{Q}; \\<forall>s. Q s \\<longrightarrow> Q' s  \\<rbrakk> \\<Longrightarrow> \\<turnstile> {P}c{Q'}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<turnstile> {P} c {Q};\n     \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile> {P} c {Q'}", "apply(rule hoare.Conseq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<turnstile> {P} c {Q};\n     \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s. P s \\<longrightarrow> ?P s\n 2. \\<lbrakk>\\<turnstile> {P} c {Q};\n     \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile> {?P} c {?Q}\n 3. \\<lbrakk>\\<turnstile> {P} c {Q};\n     \\<forall>s. Q s \\<longrightarrow> Q' s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s. ?Q s \\<longrightarrow> Q' s", "apply(fast, assumption, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>By induction on @{term c} one can easily prove\\<close>"], ["", "lemma wp_is_pre[rule_format]: \"\\<turnstile> {wp c Q} c {Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile> {wp c Q} c {Q}", "apply (induct c arbitrary: Q)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x Q. \\<turnstile> {wp (Do x) Q} Do x {Q}\n 2. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c1 Q} c1 {Q};\n        \\<And>Q. \\<turnstile> {wp c2 Q} c2 {Q}\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile> {wp (c1; c2) Q} c1; c2 {Q}\n 3. \\<And>x1a c1 c2 Q.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c1 Q} c1 {Q};\n        \\<And>Q. \\<turnstile> {wp c2 Q} c2 {Q}\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile> {wp (IF x1a THEN c1 ELSE c2) Q}\nIF x1a THEN c1 ELSE c2 {Q}\n 4. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {wp (WHILE x1a DO c) Q} WHILE x1a DO c {Q}\n 5. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {wp (LOCAL x1a; c; x3) Q} LOCAL x1a; c; x3 {Q}", "apply simp_all"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x Q. \\<turnstile> {\\<lambda>s. \\<forall>t\\<in>x s. Q t} Do x {Q}\n 2. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c1 Q} c1 {Q};\n        \\<And>Q. \\<turnstile> {wp c2 Q} c2 {Q}\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile> {wp c1 (wp c2 Q)} c1; c2 {Q}\n 3. \\<And>x1a c1 c2 Q.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c1 Q} c1 {Q};\n        \\<And>Q. \\<turnstile> {wp c2 Q} c2 {Q}\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile> {\\<lambda>s.\n    (x1a s \\<longrightarrow> wp c1 Q s) \\<and>\n    (\\<not> x1a s \\<longrightarrow> wp c2 Q s)}\nIF x1a THEN c1 ELSE c2 {Q}\n 4. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {wp (WHILE x1a DO c) Q} WHILE x1a DO c {Q}\n 5. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(blast intro:hoare.Do hoare.Conseq)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c1 Q} c1 {Q};\n        \\<And>Q. \\<turnstile> {wp c2 Q} c2 {Q}\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile> {wp c1 (wp c2 Q)} c1; c2 {Q}\n 2. \\<And>x1a c1 c2 Q.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c1 Q} c1 {Q};\n        \\<And>Q. \\<turnstile> {wp c2 Q} c2 {Q}\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile> {\\<lambda>s.\n    (x1a s \\<longrightarrow> wp c1 Q s) \\<and>\n    (\\<not> x1a s \\<longrightarrow> wp c2 Q s)}\nIF x1a THEN c1 ELSE c2 {Q}\n 3. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {wp (WHILE x1a DO c) Q} WHILE x1a DO c {Q}\n 4. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(blast intro:hoare.Semi hoare.Conseq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x1a c1 c2 Q.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c1 Q} c1 {Q};\n        \\<And>Q. \\<turnstile> {wp c2 Q} c2 {Q}\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile> {\\<lambda>s.\n    (x1a s \\<longrightarrow> wp c1 Q s) \\<and>\n    (\\<not> x1a s \\<longrightarrow> wp c2 Q s)}\nIF x1a THEN c1 ELSE c2 {Q}\n 2. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {wp (WHILE x1a DO c) Q} WHILE x1a DO c {Q}\n 3. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(blast intro:hoare.If hoare.Conseq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {wp (WHILE x1a DO c) Q} WHILE x1a DO c {Q}\n 2. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(rule weaken_post)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {wp (WHILE x1a DO c) Q} WHILE x1a DO c {?Q90 x1a c Q}\n 2. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s. ?Q90 x1a c Q s \\<longrightarrow> Q s\n 3. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(rule hoare.While)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp (WHILE x1a DO c) Q s \\<and> x1a s} c\n                    {wp (WHILE x1a DO c) Q}\n 2. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> \\<not> x1a s \\<longrightarrow> Q s\n 3. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(rule strengthen_pre)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> x1a s \\<longrightarrow>\n          ?P95 x1a c Q s\n 2. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {?P95 x1a c Q} c {wp (WHILE x1a DO c) Q}\n 3. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> \\<not> x1a s \\<longrightarrow> Q s\n 4. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "prefer 2"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {?P95 x1a c Q} c {wp (WHILE x1a DO c) Q}\n 2. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> x1a s \\<longrightarrow>\n          ?P95 x1a c Q s\n 3. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> \\<not> x1a s \\<longrightarrow> Q s\n 4. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> x1a s \\<longrightarrow>\n          wp c (wp (WHILE x1a DO c) Q) s\n 2. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> \\<not> x1a s \\<longrightarrow> Q s\n 3. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(clarify)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x1a c Q s.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c Q} c {Q};\n        wp (WHILE x1a DO c) Q s; x1a s\\<rbrakk>\n       \\<Longrightarrow> wp c (wp (WHILE x1a DO c) Q) s\n 2. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> \\<not> x1a s \\<longrightarrow> Q s\n 3. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(drule fun_eq_iff[THEN iffD1, OF wp_while, THEN spec, THEN iffD1])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x1a c Q s.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c Q} c {Q}; x1a s;\n        if x1a s then wp (c; WHILE x1a DO c) Q s else Q s\\<rbrakk>\n       \\<Longrightarrow> wp c (wp (WHILE x1a DO c) Q) s\n 2. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> \\<not> x1a s \\<longrightarrow> Q s\n 3. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x1a c Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<forall>s.\n          wp (WHILE x1a DO c) Q s \\<and> \\<not> x1a s \\<longrightarrow> Q s\n 2. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(clarify)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x1a c Q s.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c Q} c {Q};\n        wp (WHILE x1a DO c) Q s; \\<not> x1a s\\<rbrakk>\n       \\<Longrightarrow> Q s\n 2. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(drule fun_eq_iff[THEN iffD1, OF wp_while, THEN spec, THEN iffD1])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x1a c Q s.\n       \\<lbrakk>\\<And>Q. \\<turnstile> {wp c Q} c {Q}; \\<not> x1a s;\n        if x1a s then wp (c; WHILE x1a DO c) Q s else Q s\\<rbrakk>\n       \\<Longrightarrow> Q s\n 2. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(simp split:if_split_asm)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x1a c x3 Q.\n       (\\<And>Q. \\<turnstile> {wp c Q} c {Q}) \\<Longrightarrow>\n       \\<turnstile> {\\<lambda>s. wp c (Q \\<circ> x3 s) (x1a s)}\n                    LOCAL x1a; c; x3 {Q}", "apply(fast intro!: hoare.Local)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>\\noindent\nfrom which completeness follows more or less directly via the\nrule of consequence:\\<close>"], ["", "theorem hoare_relative_complete: \"\\<Turnstile> {P}c{Q}  \\<Longrightarrow>  \\<turnstile> {P}c{Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Turnstile> {P} c {Q} \\<Longrightarrow> \\<turnstile> {P} c {Q}", "apply (rule strengthen_pre[OF _ wp_is_pre])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Turnstile> {P} c {Q} \\<Longrightarrow>\n    \\<forall>s. P s \\<longrightarrow> wp c Q s", "apply(unfold hoare_valid_def wp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s t.\n       s -c\\<rightarrow> t \\<longrightarrow>\n       P s \\<longrightarrow> Q t \\<Longrightarrow>\n    \\<forall>s.\n       P s \\<longrightarrow>\n       (\\<forall>t. s -c\\<rightarrow> t \\<longrightarrow> Q t)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "end"]]}